[{"tags": ["objective-c", "c", "xcode", "compiler-errors"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 4, "creation_date": 1458777101, "post_id": 36190842, "comment_id": 60016612, "body": "Don&#39;t post images of code! Post as text!"}, {"owner": {"reputation": 829, "user_id": 1513610, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/O4P5Z.jpg?s=128&g=1", "display_name": "SwiftMatt", "link": "https://stackoverflow.com/users/1513610/swiftmatt"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1458777225, "post_id": 36190842, "comment_id": 60016642, "body": "In my opinion, the image is more informative, complete, and simple to both look at and paste."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1458777248, "post_id": 36190842, "comment_id": 60016648, "body": "See the site rules! And pasting text out of an image is not really &quot;simple&quot;."}, {"owner": {"reputation": 829, "user_id": 1513610, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/O4P5Z.jpg?s=128&g=1", "display_name": "SwiftMatt", "link": "https://stackoverflow.com/users/1513610/swiftmatt"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1458778366, "post_id": 36190842, "comment_id": 60016961, "body": "That is true.  But my reasoning was just that I&#39;d have to specify where the error occurred, and the context is difficult to capture."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458778552, "post_id": 36190842, "comment_id": 60017005, "body": "See, I will not further discuss this. Point is, this site has certain rules one has to follow. If you don&#39;t agree, this is your problem. Open a meta and try changing these rules. But until then: post text as text! Afaik copy/paste also works on the Mac with 4 keypresses."}], "answers": [{"comments": [{"owner": {"reputation": 829, "user_id": 1513610, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/O4P5Z.jpg?s=128&g=1", "display_name": "SwiftMatt", "link": "https://stackoverflow.com/users/1513610/swiftmatt"}, "edited": false, "score": 0, "creation_date": 1458789243, "post_id": 36192616, "comment_id": 60019806, "body": "I have attempted all three with a clean and build in between each one, but thanks for the attempt"}, {"owner": {"reputation": 829, "user_id": 1513610, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/O4P5Z.jpg?s=128&g=1", "display_name": "SwiftMatt", "link": "https://stackoverflow.com/users/1513610/swiftmatt"}, "edited": false, "score": 0, "creation_date": 1458831676, "post_id": 36192616, "comment_id": 60039900, "body": "Actually, renaming I works.  Changing &quot;I&quot; to &quot;test&quot; or &quot;a&quot; allows it to compile, and it doesn&#39;t seem like other parts of the code try to reference it or something."}], "tags": [], "owner": {"reputation": 4371, "user_id": 5196056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82e60f19699f947713c612d70b80524a?s=128&d=identicon&r=PG&f=1", "display_name": "Anatoli P", "link": "https://stackoverflow.com/users/5196056/anatoli-p"}, "is_accepted": true, "score": 3, "last_activity_date": 1458788893, "creation_date": 1458788893, "answer_id": 36192616, "question_id": 36190842, "link": "https://stackoverflow.com/questions/36190842/xcode-c-compiler-error-expected-member-name-or-after-declaration-specifiers/36192616#36192616", "title": "XCode C Compiler Error Expected member name or &#39;;&#39; after declaration specifiers Expected &#39;)&#39;", "body": "<p>I don't see anything wrong with that line, but of course, I don't see the whole picture.  A few things to try:</p>\n\n<ul>\n<li>Delete everything between <code>double</code> and <code>I</code>, insert just a single\nspace and see if that changes anything.</li>\n<li>Rename I to something else, e.g. <code>JUNK</code>, and see if that error goes\naway.  Other errors are likely to show up, though.  It is possible\nthat <code>I</code> is <code>#defined</code> somewhere in some strange way.</li>\n<li>Change <code>PointInfo</code> to some other type, e.g. <code>int</code>.  Again, this will\nbreak the code elsewhere, but this is a test to see if <code>PointInfo</code> is\nthe problem.</li>\n</ul>\n\n<p>A word of warning: if you are trying to integrate C with Swift, you are likely to run into problems more interesting than this one.  Good luck.</p>\n"}], "owner": {"reputation": 829, "user_id": 1513610, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/O4P5Z.jpg?s=128&g=1", "display_name": "SwiftMatt", "link": "https://stackoverflow.com/users/1513610/swiftmatt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1995, "favorite_count": 0, "closed_date": 1458788929, "accepted_answer_id": 36192616, "answer_count": 1, "score": 0, "last_activity_date": 1458788893, "creation_date": 1458776763, "last_edit_date": 1458780767, "question_id": 36190842, "link": "https://stackoverflow.com/questions/36190842/xcode-c-compiler-error-expected-member-name-or-after-declaration-specifiers", "closed_reason": "Not suitable for this site", "title": "XCode C Compiler Error Expected member name or &#39;;&#39; after declaration specifiers Expected &#39;)&#39;", "body": "<p>I am trying to compile C code and integrate it with Objective-C and Swift.  The C code is the ImageMagick library.</p>\n\n<pre><code>typedef struct _ChannelMoments\n{\n  double\n    I[32];\n\n  PointInfo\n    centroid,\n    ellipse_axis;\n\n  double\n    ellipse_angle,\n    ellipse_eccentricity,\n    ellipse_intensity;\n} ChannelMoments;\n</code></pre>\n\n<p>The errors are on the line I[32];\nExpected member name or ';' after declaration specifiers Expected ')'</p>\n\n<p>Here are two photos of the issue</p>\n\n<p><a href=\"https://i.stack.imgur.com/qlrNY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qlrNY.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/E9Ijm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/E9Ijm.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "struct", "operators", "variable-assignment", "bit-fields"], "comments": [{"owner": {"reputation": 2233, "user_id": 2669128, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/430a24425fb593f00def23e45c454c39?s=128&d=identicon&r=PG", "display_name": "thurizas", "link": "https://stackoverflow.com/users/2669128/thurizas"}, "edited": false, "score": 0, "creation_date": 1458774824, "post_id": 36190374, "comment_id": 60015852, "body": "its declaring a bit-field, see here: <a href=\"https://en.wikipedia.org/wiki/Bit_field\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Bit_field</a>"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1458774927, "post_id": 36190374, "comment_id": 60015901, "body": "Why do you call it &quot;assignment&quot;? Where do you see any similarity to &quot;assignment&quot; here?"}, {"owner": {"reputation": 37, "user_id": 1644224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sQ7ms.jpg?s=128&g=1", "display_name": "clasimoes", "link": "https://stackoverflow.com/users/1644224/clasimoes"}, "edited": false, "score": 0, "creation_date": 1458782976, "post_id": 36190374, "comment_id": 60018212, "body": "My mistake calling it assignement. It was my first impression but I really had no idea of the meaning. Thanks for giving me the right place to look!"}], "answers": [{"comments": [{"owner": {"reputation": 2103, "user_id": 3119050, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/mZahs.jpg?s=128&g=1", "display_name": "fredmaggiowski", "link": "https://stackoverflow.com/users/3119050/fredmaggiowski"}, "edited": false, "score": 0, "creation_date": 1458775411, "post_id": 36190483, "comment_id": 60016073, "body": "downvoter can let me know why?"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 2, "creation_date": 1458775459, "post_id": 36190483, "comment_id": 60016091, "body": "It wasn&#39;t me but perhaps the downvoter though you should have voted to close as a duplicate <i>instead of</i> posting an answer."}, {"owner": {"reputation": 2103, "user_id": 3119050, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/mZahs.jpg?s=128&g=1", "display_name": "fredmaggiowski", "link": "https://stackoverflow.com/users/3119050/fredmaggiowski"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1458775616, "post_id": 36190483, "comment_id": 60016138, "body": "Oh well, i&#39;ve actually flagged the question as duplicate, anyhow I thought that it could be helpful for OP to have a direct hint.."}], "tags": [], "owner": {"reputation": 2103, "user_id": 3119050, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/mZahs.jpg?s=128&g=1", "display_name": "fredmaggiowski", "link": "https://stackoverflow.com/users/3119050/fredmaggiowski"}, "is_accepted": true, "score": 1, "last_activity_date": 1458774855, "last_edit_date": 1495542695, "creation_date": 1458774855, "answer_id": 36190483, "question_id": 36190374, "link": "https://stackoverflow.com/questions/36190374/what-does-it-means-int-i3-in-variable-assignment/36190483#36190483", "title": "What does it means int i:3 in variable assignment?", "body": "<p>The numbers specifies the length in bits for each field. </p>\n\n<p>Hence <code>i</code> and <code>j</code> are represented in 3 bits while <code>k</code> in 2 bits.</p>\n\n<p>By the way this is question is clearly a duplicate of <a href=\"https://stackoverflow.com/questions/1604968/what-does-a-colon-in-a-struct-declaration-mean-such-as-1-7-16-or-3\">this question</a> and there's a very good answer I suggest you to read.</p>\n"}], "owner": {"reputation": 37, "user_id": 1644224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sQ7ms.jpg?s=128&g=1", "display_name": "clasimoes", "link": "https://stackoverflow.com/users/1644224/clasimoes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 468, "favorite_count": 0, "closed_date": 1458774990, "accepted_answer_id": 36190483, "answer_count": 1, "score": -1, "last_activity_date": 1458779723, "creation_date": 1458774232, "last_edit_date": 1458779723, "question_id": 36190374, "link": "https://stackoverflow.com/questions/36190374/what-does-it-means-int-i3-in-variable-assignment", "closed_reason": "Duplicate", "title": "What does it means int i:3 in variable assignment?", "body": "<p>I'm trying to understand the following code in C:</p>\n\n<pre><code>struct values{\n  int i:3;\n  int j:3;\n  int k:2;\n};\n\nint main(){\n    struct values v = {-6,2,5};\n    printf(\"%d %d %d\", v.i,v.j,v.k);\n}\n</code></pre>\n\n<p>This code produces the following output: </p>\n\n<pre><code>2 2 1\n</code></pre>\n\n<p>I'm trying to understand what does it mean the assignment for <code>int</code> values used inside the struct <strong>i.e.:</strong> <code>int i:3</code> ?</p>\n\n<p>I know that <strong>:</strong> is not an operator. So what does it do?\nAlso, can someone explain how this output is achieved?</p>\n\n<p>Thanks very much!</p>\n"}, {"tags": ["c", "stm32"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458774700, "post_id": 36190345, "comment_id": 60015807, "body": "Where do you trigger the EXTI? And why would one want to do that - just call the function from the systick interrupt directly. Less perfomance penalty. And your loop in an interrupt handler is quite a bad idea - to say it carefully."}, {"owner": {"reputation": 96, "user_id": 4707437, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/780b1a8bc3c43f812d060e126b593229?s=128&d=identicon&r=PG&f=1", "display_name": "starter", "link": "https://stackoverflow.com/users/4707437/starter"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458774775, "post_id": 36190345, "comment_id": 60015832, "body": "the extit triggers when a button is pushed"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458774799, "post_id": 36190345, "comment_id": 60015845, "body": "See <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>, provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>! As given you should read more about how to write interrupt handlers and concurrent code on an MCU. And use a debugger, the Cortex-M4 can be debugged quite good."}, {"owner": {"reputation": 622, "user_id": 974625, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/92bf878ce79d9f0bb126248aace083f2?s=128&d=identicon&r=PG", "display_name": "SneakyMummin", "link": "https://stackoverflow.com/users/974625/sneakymummin"}, "edited": false, "score": 0, "creation_date": 1458784250, "post_id": 36190345, "comment_id": 60018557, "body": "Did you initialized it with SysTick_Config?"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1458800442, "post_id": 36190345, "comment_id": 60022594, "body": "Do you not have to explicitly re-enable higher-priority interrupts within your handler, (assuming that SYSTICK is actually a higher priority anyway)?  Also, what Olaf says.  Also poll a free-running timer/counter values instead so that you are not dependent upon another intrrupt.  Also use a real tasker so that you don&#39;t have to busy-wait in interrupt-handlers anyway."}, {"owner": {"reputation": 96, "user_id": 4707437, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/780b1a8bc3c43f812d060e126b593229?s=128&d=identicon&r=PG&f=1", "display_name": "starter", "link": "https://stackoverflow.com/users/4707437/starter"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1458803894, "post_id": 36190345, "comment_id": 60023693, "body": "@MartinJames it is not the case of busy waiting here , also a free-running timer is what i am doing here the problem is the timer stops/interrupted when the exti interruption occurs , i know it&#39;s a priority problem i tried to lower the exti priority but i still had the same problem"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1458810498, "post_id": 36190345, "comment_id": 60026601, "body": "It doesn&#39;t look like polling a free-running timer to me - it looks like polling a variable that is decremented in an interrupt-handler.   By &#39;poll a free-running timer/counter&#39; I meant read the hardware, not poll some volatile that may, or may not, get decremented in an interrupt-handler."}], "owner": {"reputation": 96, "user_id": 4707437, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/780b1a8bc3c43f812d060e126b593229?s=128&d=identicon&r=PG&f=1", "display_name": "starter", "link": "https://stackoverflow.com/users/4707437/starter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 615, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1458774089, "creation_date": 1458774089, "question_id": 36190345, "link": "https://stackoverflow.com/questions/36190345/systick-interruption-doesnt-trigger", "title": "Systick interruption doesn&#39;t trigger", "body": "<p>I am experimenting with the <code>STM32f4</code> discovery and i tried to use a delay (based on <code>SYSTICK</code>) in an <code>EXTI_IRQ</code> handler but i figured out that while the <code>EXTI</code> handler is triggered the the <code>systick</code> handler doesn't trigger , here's my code :</p>\n\n<pre><code>extern volatile int del ;\nvoid EXTI0_IRQHandler(void) {\n\n  if (EXTI_GetITStatus(EXTI_Line0) != RESET ) {\n        /* Do your stuff when PD0 is changed */\n         del=1000 ;\n         while(del)\n       {\n       //do something \n       }\n\n       /* Clear interrupt flag */\n        EXTI_ClearITPendingBit(EXTI_Line0);\n    }\n  }\n</code></pre>\n\n<p>And the systick handler :</p>\n\n<pre><code>void SysTick_Handler(void)\n{\n  if (del--)\n ;\n}\n</code></pre>\n\n<p>So how can i solve this problem .</p>\n"}, {"tags": ["c", "pointers", "malloc"], "comments": [{"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1458774107, "post_id": 36190285, "comment_id": 60015613, "body": "<code>2 * sizeof(char *)</code> on 64BIT means <code>16</code> and <code>4 * sizeof(char *)</code> means <code>32</code>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1458774157, "post_id": 36190285, "comment_id": 60015629, "body": "<code>test t; memset(&amp;t, 0, sizeof(test));</code> - Better use an initialiser: <code>test t = { NULL };</code> <code>memset</code> is not guaranteed to set the pointer to a <i>null pointer</i>. In general don&#39;t use <code>memset</code> explicitly (the compiler might generate code which calls it behind the scenes) if there are better (e.g. type-safe) or equivalent alternatives."}, {"owner": {"reputation": 622, "user_id": 974625, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/92bf878ce79d9f0bb126248aace083f2?s=128&d=identicon&r=PG", "display_name": "SneakyMummin", "link": "https://stackoverflow.com/users/974625/sneakymummin"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1458774327, "post_id": 36190285, "comment_id": 60015690, "body": "@Michi Yes, but why 4 if I want allocate only 2 elements?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458774360, "post_id": 36190285, "comment_id": 60015697, "body": "@Caspinol: Get the types right! <code>p</code> is a pointer to an array. This is typically used to point to a 2D array&#39;s first row (and column)."}, {"owner": {"reputation": 37741, "user_id": 3425536, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/1484495923/picture?type=large", "display_name": "emlai", "link": "https://stackoverflow.com/users/3425536/emlai"}, "edited": false, "score": 0, "creation_date": 1458774369, "post_id": 36190285, "comment_id": 60015701, "body": "@Caspinol Why would you allocate only 2 elements? Your <code>p</code> is a pointer to <i>20</i> elements. Allocating anything other than 20 chars is just asking for trouble."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1458774372, "post_id": 36190285, "comment_id": 60015702, "body": "@Caspinol you nead <code>t.p = malloc(26);</code>. Now try to think Why."}, {"owner": {"reputation": 622, "user_id": 974625, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/92bf878ce79d9f0bb126248aace083f2?s=128&d=identicon&r=PG", "display_name": "SneakyMummin", "link": "https://stackoverflow.com/users/974625/sneakymummin"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458774409, "post_id": 36190285, "comment_id": 60015717, "body": "@Olaf Thanks, didn&#39;t know i could do that."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1458774476, "post_id": 36190285, "comment_id": 60015741, "body": "First check if you can do it type-safe before using hacks. Oh, and general advice: enable all relevant warnings and pay heed to them."}, {"owner": {"reputation": 622, "user_id": 974625, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/92bf878ce79d9f0bb126248aace083f2?s=128&d=identicon&r=PG", "display_name": "SneakyMummin", "link": "https://stackoverflow.com/users/974625/sneakymummin"}, "reply_to_user": {"reputation": 37741, "user_id": 3425536, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/1484495923/picture?type=large", "display_name": "emlai", "link": "https://stackoverflow.com/users/3425536/emlai"}, "edited": false, "score": 0, "creation_date": 1458774731, "post_id": 36190285, "comment_id": 60015815, "body": "@zenith Because the 20 &quot;columns&quot; is static, the dynamic part are the &quot;rows&quot;. And i need 2 of them for this example"}, {"owner": {"reputation": 622, "user_id": 974625, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/92bf878ce79d9f0bb126248aace083f2?s=128&d=identicon&r=PG", "display_name": "SneakyMummin", "link": "https://stackoverflow.com/users/974625/sneakymummin"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458774942, "post_id": 36190285, "comment_id": 60015906, "body": "@Olaf Where is the hack here. This is a valid pointer to a array of 20 chars."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458775095, "post_id": 36190285, "comment_id": 60015960, "body": "All your uses of <code>memcpy</code> are actually hacks. There are better, easier and safer ways for each of them. For the first I already commented what&#39;s hackish about it. For the others, every C book can tell you. No offence, but your code is shooting through the knee in the head. But maybe you just should see <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>."}, {"owner": {"reputation": 622, "user_id": 974625, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/92bf878ce79d9f0bb126248aace083f2?s=128&d=identicon&r=PG", "display_name": "SneakyMummin", "link": "https://stackoverflow.com/users/974625/sneakymummin"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458775242, "post_id": 36190285, "comment_id": 60016014, "body": "@Olaf Ok, thats fine. Noted. But the problem here are the pointers ;)"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458775627, "post_id": 36190285, "comment_id": 60016140, "body": "@Caspinol: Yes. And you would have seen if you would not have silenced compiler warnings with that <code>memcpy</code> hacks! Done the proper way, the compiler will complain about type miss matches. I&#39;m done. Just please <b>learn</b> from your faults!"}, {"owner": {"reputation": 10300, "user_id": 2469027, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b62ce55f4f1a0eff6775e7863850a912?s=128&d=identicon&r=PG", "display_name": "Edward Karak", "link": "https://stackoverflow.com/users/2469027/edward-karak"}, "edited": false, "score": 1, "creation_date": 1458775843, "post_id": 36190285, "comment_id": 60016225, "body": "You should use <code>strcpy</code> instead of <code>memcpy</code>, since you&#39;re dealing with null terminated strings."}, {"owner": {"reputation": 622, "user_id": 974625, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/92bf878ce79d9f0bb126248aace083f2?s=128&d=identicon&r=PG", "display_name": "SneakyMummin", "link": "https://stackoverflow.com/users/974625/sneakymummin"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458775875, "post_id": 36190285, "comment_id": 60016240, "body": "@Olaf Did you try yourself? gcc main.c -g -Wall -o test produces no warnings for the above code."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458776573, "post_id": 36190285, "comment_id": 60016463, "body": "Sure it does not! Because you actively tell your compiler not to help you by using functions which use the &quot;universal&quot; pointer <code>void *</code>, so it <b>cannot</b> warn. Go learn before offending people who just want to help you. Also recommended warnings include <code>-Wextra -Wshadow</code> and <code>-Wpedantic</code> for strict standard compliance."}, {"owner": {"reputation": 622, "user_id": 974625, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/92bf878ce79d9f0bb126248aace083f2?s=128&d=identicon&r=PG", "display_name": "SneakyMummin", "link": "https://stackoverflow.com/users/974625/sneakymummin"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1458777265, "post_id": 36190285, "comment_id": 60016655, "body": "@Olaf Still no warning with those options except the one about arguments to main. So yeah the whole reason i asked the question was for me to learn something...about what i asked. But at this stage lets just go separate ways M&#39;Kay?"}], "answers": [{"comments": [{"owner": {"reputation": 622, "user_id": 974625, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/92bf878ce79d9f0bb126248aace083f2?s=128&d=identicon&r=PG", "display_name": "SneakyMummin", "link": "https://stackoverflow.com/users/974625/sneakymummin"}, "edited": false, "score": 1, "creation_date": 1458777784, "post_id": 36190782, "comment_id": 60016803, "body": "Yes, thanks for that and the code pointers. The comments under the question almost ripped my head off ;) Initially i used memcpy in the example. So cheers for the answer it works."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 1, "last_activity_date": 1458818208, "last_edit_date": 1458818208, "creation_date": 1458776469, "answer_id": 36190782, "question_id": 36190285, "link": "https://stackoverflow.com/questions/36190285/confusion-about-pointer-to-fixed-array/36190782#36190782", "title": "Confusion about pointer to fixed array", "body": "<p><code>t.p</code> is a pointer to an array of arrays of 20 <code>char</code>: you access 2 such arrays in your program, hence you should allocate 40 bytes for these.</p>\n\n<p>There is an easier way to do this: allocate the size of the object <code>p</code> points to times the number of elements in the array:</p>\n\n<pre><code>t.p = malloc(sizeof(*t.p) * 2);\n</code></pre>\n\n<p>This way if you change the definition of <code>struct test_t</code>, the amount allocated by <code>malloc</code> with adjust automatically.</p>\n\n<p>Note that your statements are redundant:</p>\n\n<pre><code>memset(&amp;t, 0, sizeof(test));\n</code></pre>\n\n<p>can be simplified as <code>test t = { NULL };</code>, or <code>t.p = NULL;</code>, or even completely elided since <code>malloc</code> will set the value of <code>t.p</code>.</p>\n\n<pre><code>strcpy(t.p[0], \"hello\");\nt.p[0][strlen(\"hello\")] = '\\0';  // useless: the '\\0' was alread set there by strcpy\n\nstrcpy(t.p[1], \"world\");\nt.p[1][strlen(\"world\")] = '\\0';  // useless: the '\\0' was alread set there by strcpy\n</code></pre>\n\n<p>The whole code can be simplified as:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\ntypedef struct test_t {\n    char (*p)[20];\n} test;\n\nint main(int argc, char **argv) {\n    test t;\n\n    t.p = malloc(sizeof(*t.p) * 2);\n\n    strcpy(t.p[0], \"hello\");\n    strcpy(t.p[1], \"world\");\n\n    printf(\"[%s]\\n\", t.p[0]);\n    printf(\"[%s]\\n\", t.p[1]);\n\n    free(t.p);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 622, "user_id": 974625, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/92bf878ce79d9f0bb126248aace083f2?s=128&d=identicon&r=PG", "display_name": "SneakyMummin", "link": "https://stackoverflow.com/users/974625/sneakymummin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "closed_date": 1458785376, "accepted_answer_id": 36190782, "answer_count": 1, "score": -3, "last_activity_date": 1458818208, "creation_date": 1458773764, "last_edit_date": 1458779319, "question_id": 36190285, "link": "https://stackoverflow.com/questions/36190285/confusion-about-pointer-to-fixed-array", "closed_reason": "Needs details or clarity", "title": "Confusion about pointer to fixed array", "body": "<p>Consider following example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\ntypedef struct test_t {\n    char (*p)[20];\n} test;\n\nint main(int argc, char **argv) {\n    test t;\n\n    t.p = malloc(2 * sizeof(*t.p));\n\n    strcpy(t.p[0], \"hello\");\n\n    strcpy(t.p[1], \"world\");\n\n    printf(\"[%s]\\n\", t.p[0]);\n    printf(\"[%s]\\n\", t.p[1]);\n\n    free(t.p);\n}\n</code></pre>\n\n<p>The above code is incorrect as the <code>malloc</code> is not allocating enough memory for the element with index 1. This can be seen when running it under valgrind. When I double the amount of malloced memory from:</p>\n\n<pre><code>t.p = malloc(2 * sizeof(char *));\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>t.p = malloc(4 * sizeof(char *));\n</code></pre>\n\n<p>the valgrind output no longer shows memory errors.</p>\n\n<p>I understand the reason for the errors however I cannot see how I should be calculating the required memory for the malloc call.</p>\n\n<p>Thanks.</p>\n\n<p>EDITED: The example code</p>\n"}, {"tags": ["c", "glob"], "comments": [{"owner": {"reputation": 18935, "user_id": 19405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72b55a41a43ea0493fc64641a1ed295?s=128&d=identicon&r=PG", "display_name": "nobody", "link": "https://stackoverflow.com/users/19405/nobody"}, "edited": false, "score": 2, "creation_date": 1458771511, "post_id": 36189726, "comment_id": 60014627, "body": "See the <code>fnmatch</code> function listed in the See Also section of the page you linked."}, {"owner": {"reputation": 37702, "user_id": 129805, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/F1gxS.png?s=128&g=1", "display_name": "fadedbee", "link": "https://stackoverflow.com/users/129805/fadedbee"}, "reply_to_user": {"reputation": 18935, "user_id": 19405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72b55a41a43ea0493fc64641a1ed295?s=128&d=identicon&r=PG", "display_name": "nobody", "link": "https://stackoverflow.com/users/19405/nobody"}, "edited": false, "score": 0, "creation_date": 1458771725, "post_id": 36189726, "comment_id": 60014705, "body": "@AndrewMedico Thanks, just what I was looking for.  If you make it an answer I&#39;ll accept it."}], "answers": [{"tags": [], "owner": {"reputation": 18935, "user_id": 19405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72b55a41a43ea0493fc64641a1ed295?s=128&d=identicon&r=PG", "display_name": "nobody", "link": "https://stackoverflow.com/users/19405/nobody"}, "is_accepted": true, "score": 3, "last_activity_date": 1458773655, "creation_date": 1458773655, "answer_id": 36190265, "question_id": 36189726, "link": "https://stackoverflow.com/questions/36189726/globbing-in-c-how-to-exclude-files/36190265#36190265", "title": "Globbing in C, how to exclude files", "body": "<p>Use the <a href=\"http://linux.die.net/man/3/fnmatch\" rel=\"nofollow\">fnmatch</a> function. It compares a filename/path against a given pattern.</p>\n"}], "owner": {"reputation": 37702, "user_id": 129805, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/F1gxS.png?s=128&g=1", "display_name": "fadedbee", "link": "https://stackoverflow.com/users/129805/fadedbee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 36190265, "answer_count": 1, "score": 1, "last_activity_date": 1458773655, "creation_date": 1458771309, "question_id": 36189726, "link": "https://stackoverflow.com/questions/36189726/globbing-in-c-how-to-exclude-files", "title": "Globbing in C, how to exclude files", "body": "<p>I've read <a href=\"http://linux.die.net/man/3/glob\" rel=\"nofollow\">http://linux.die.net/man/3/glob</a> and it seems that glob will do disk access, even though I don't want it to.</p>\n\n<p>Is there a C glob function to compare a string with a glob pattern and tell me if it matches?  i.e. no disk access.</p>\n\n<p>If not, how can I use glob to <em>exclude</em> files when recursively (depth first) traversing a filesystem?</p>\n\n<pre><code>while((entry = readdir(dp))) {\n    // need to continue to next iteration of loop, here, if entry-&gt;d_name matches glob pattern\n\n    // do stuff and recurse\n}\n</code></pre>\n"}, {"tags": ["c", "visual-studio-2015", "libxml2", "iconv"], "comments": [{"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1458770254, "post_id": 36189416, "comment_id": 60014085, "body": "Use <code>#include &quot;file&quot;</code> instead of <code>#include &lt;file&gt;</code>.  Never start with an empty project if you don&#39;t know the basics yet."}, {"owner": {"reputation": 169, "user_id": 6073269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/FULRz.gif?s=128&g=1", "display_name": "Mark Twain", "link": "https://stackoverflow.com/users/6073269/mark-twain"}, "reply_to_user": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1458770585, "post_id": 36189416, "comment_id": 60014227, "body": "@HansPassant I tried what you suggested, that made no difference. The problem is not <code>#include</code> statements, the problem must be in <code>Project Properties</code> and its path, as it&#39;s not able to find the file <code>iconv.h</code> which lies in one of the files inside <code>#included</code> file"}, {"owner": {"reputation": 2233, "user_id": 2669128, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/430a24425fb593f00def23e45c454c39?s=128&d=identicon&r=PG", "display_name": "thurizas", "link": "https://stackoverflow.com/users/2669128/thurizas"}, "edited": false, "score": 0, "creation_date": 1458775126, "post_id": 36189416, "comment_id": 60015974, "body": "where is &quot;iconv.h&quot; located?  Try searching for it with Windows Search.  You will probably need to add this path &quot;workspace\\libxml\\iconv-1.9.2.win32\\iconv-1.9.2.win32\\includ&zwnj;&#8203;e&quot;, to your additional header files.  The additional libraries is where you put the paths to various *.lib files."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1458775741, "post_id": 36189416, "comment_id": 60016187, "body": "when setting up the search paths...  1) for the compiles, there will be 3 search paths, that each end in <code>include</code>.   2) for the libraries, there will be 3 search paths that each end in <code>lib</code>.    So the main problem is the paths to the *.h files needs to be expanded to have all three paths.  The paths to the libraries, needs to be expanded to have all three paths AND those paths needs to end at the directories that contain the libraries, not the directories that contain the header files."}, {"owner": {"reputation": 169, "user_id": 6073269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/FULRz.gif?s=128&g=1", "display_name": "Mark Twain", "link": "https://stackoverflow.com/users/6073269/mark-twain"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1458776335, "post_id": 36189416, "comment_id": 60016389, "body": "@user3629249 I followed what you suggested and that worked. I never knew that we can set multiple paths. The mentioned errors have gone and now I have other new errors, but I&#39;ll take care of them. Thanks for the answer, you could have put this as answer, I&#39;d have accepted it."}], "answers": [{"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": true, "score": 0, "last_activity_date": 1458779126, "creation_date": 1458779126, "answer_id": 36191179, "question_id": 36189416, "link": "https://stackoverflow.com/questions/36189416/why-visual-studio-2015-couldnt-find-iconv-h-a-file-dependency-of-libxml2/36191179#36191179", "title": "Why Visual Studio 2015 couldn&#39;t find iconv.h, a file dependency of libxml2?", "body": "<p>when setting up the search paths... </p>\n\n<p>1) for the compiles, there will be 3 search paths, that each end in include. </p>\n\n<p>2) for the libraries, there will be 3 search paths that each end in lib. </p>\n\n<p>So the main problem is the paths to the *.h files needs to be expanded to have all three paths. </p>\n\n<p>The paths to the libraries, needs to be expanded to have all three paths AND those paths needs to end at the directories that contain the libraries, not the directories that contain the header files. </p>\n"}], "owner": {"reputation": 169, "user_id": 6073269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/FULRz.gif?s=128&g=1", "display_name": "Mark Twain", "link": "https://stackoverflow.com/users/6073269/mark-twain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3285, "favorite_count": 0, "accepted_answer_id": 36191179, "answer_count": 1, "score": 0, "last_activity_date": 1458779126, "creation_date": 1458770019, "question_id": 36189416, "link": "https://stackoverflow.com/questions/36189416/why-visual-studio-2015-couldnt-find-iconv-h-a-file-dependency-of-libxml2", "title": "Why Visual Studio 2015 couldn&#39;t find iconv.h, a file dependency of libxml2?", "body": "<p>I usually code in PHP, and new to Visual Studio and C, I followed the steps here \u2014 <a href=\"http://www.codeguru.com/cpp/data/data-misc/xml/article.php/c14893/Libxml2-Everything-You-Need-in-an-XML-Library.htm\" rel=\"nofollow\">http://www.codeguru.com/cpp/data/data-misc/xml/article.php/c14893/Libxml2-Everything-You-Need-in-an-XML-Library.htm</a> and downloaded three files \u2014 libxml, iconv, zlib. It says, iconv and zlib are dependencies for libxml2. </p>\n\n<p>My code is below:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;libxml/parser.h&gt;\n#include &lt;libxml/tree.h&gt;\n\nstatic void print_element_names(xmlNode * a_node)\n{\n   xmlNode *cur_node = NULL;\n\n   for (cur_node = a_node; cur_node; cur_node = cur_node-&gt;next) {\n       if (cur_node-&gt;type == XML_ELEMENT_NODE) {\n          printf(\"node type: Element, name: %s\\n\",\n               cur_node-&gt;name);\n       }\n       print_element_names(cur_node-&gt;children);\n   }\n}\n\n  int main(int argc, char **argv)\n  {\n    xmlDoc *doc = NULL;\n    xmlNode *root_element = NULL;\n\n    if (argc != 2)  return(1);\n\n    LIBXML_TEST_VERSION    // Macro to check API for match with\n                             // the DLL we are using\n\n    /*parse the file and get the DOM */\n    if (doc = xmlReadFile(\"http://www.w3schools.com/xml/note.xml\", NULL, 0))     == NULL){\n       printf(\"error: could not parse file %s\\n\", argv[1]);\n       exit(-1);\n       }\n\n    /*Get the root element node */\n    root_element = xmlDocGetRootElement(doc);\n    print_element_names(root_element);\n    xmlFreeDoc(doc);       // free document\n    xmlCleanupParser();    // Free globals\n    return 0;\n    }\n</code></pre>\n\n<p>In my downloaded package, I have folders \u2014 iconv-1.9.2.win32, libxml2-2.7.8.win32, zlib-1.2.5.win32. [all these folders are lying side by side inside <code>workspace\\libxml</code> folder]</p>\n\n<p>I downloaded above from here \u2014 <a href=\"ftp://ftp.zlatkovic.com/libxml/\" rel=\"nofollow\">ftp://ftp.zlatkovic.com/libxml/</a></p>\n\n<p>I entered the following path in Project Properties:</p>\n\n<ol>\n<li><p><code>Project &gt; Properties &gt; C/C++-&gt;General &gt; Additional Include Directories</code> \u2014 <code>workspace\\libxml\\libxml2-2.7.8.win32\\libxml2-2.7.8.win32\\include</code></p></li>\n<li><p><code>Project &gt; Properties &gt; Linker &gt; General &gt; Additional Library Directories</code> \u2014 <code>workspace\\libxml\\iconv-1.9.2.win32\\iconv-1.9.2.win32\\include</code></p></li>\n</ol>\n\n<p>I have no idea where to put <code>zlib</code> folder path. (first question)\nI built the solution in Visual Studio Professional 2015 (Windows 8, 64 bit) and got the following errors:</p>\n\n<ol>\n<li><p>cannot open source file \"iconv.h\"</p></li>\n<li><p>C1083    Cannot open include file: 'iconv.h': No such file or directory</p></li>\n</ol>\n\n<p>GTK: I created: File > Project > VC++ > Empty Project</p>\n\n<p>My questions are:</p>\n\n<ol>\n<li><p>Where should I put, which specific path from all the three folders (from the downloaded package)?</p></li>\n<li><p>I have to create standalone application, so I have to statically link the libxml2 Dll, am I going right?</p></li>\n</ol>\n"}, {"tags": ["c", "file-io", "c-strings"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1458770379, "post_id": 36189412, "comment_id": 60014143, "body": "<a href=\"http://stackoverflow.com/questions/5431941/while-feof-file-is-always-wrong\">why <code>while !feof(readPtr)</code> is wrong</a>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1458770467, "post_id": 36189412, "comment_id": 60014183, "body": "Yes, use two strings. Use <code>%s</code> in <code>fscanf</code> to read one word into each string. Then you can use <code>printf</code> to write them to the second file in a different order than you read them."}], "answers": [{"comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1458772024, "post_id": 36189828, "comment_id": 60014817, "body": "<code>fscanf(fp, &quot;%s&quot;, name);</code> is wrong."}, {"owner": {"reputation": 10300, "user_id": 2469027, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b62ce55f4f1a0eff6775e7863850a912?s=128&d=identicon&r=PG", "display_name": "Edward Karak", "link": "https://stackoverflow.com/users/2469027/edward-karak"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1458772423, "post_id": 36189828, "comment_id": 60014970, "body": "What&#39;s wrong with it? @BLUEPIXY Should I add a width specifier to avoid overflows?"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1458772664, "post_id": 36189828, "comment_id": 60015076, "body": "<code>%s</code> of <code>scanf</code> family does not include spaces. So, it does not work as expected. (<i>Should I add a width specifier to avoid overflows?</i> Yes :)"}, {"owner": {"reputation": 10300, "user_id": 2469027, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b62ce55f4f1a0eff6775e7863850a912?s=128&d=identicon&r=PG", "display_name": "Edward Karak", "link": "https://stackoverflow.com/users/2469027/edward-karak"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1458773512, "post_id": 36189828, "comment_id": 60015373, "body": "fixed it @BLUEPIXY"}, {"owner": {"reputation": 3, "user_id": 5511409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71ecea0ad214262e0228e0a43dff1c28?s=128&d=identicon&r=PG&f=1", "display_name": "Teej", "link": "https://stackoverflow.com/users/5511409/teej"}, "edited": false, "score": 0, "creation_date": 1458790785, "post_id": 36189828, "comment_id": 60020210, "body": "Thanks for the help @stackptr I was able to work through it after that!"}], "tags": [], "owner": {"reputation": 10300, "user_id": 2469027, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b62ce55f4f1a0eff6775e7863850a912?s=128&d=identicon&r=PG", "display_name": "Edward Karak", "link": "https://stackoverflow.com/users/2469027/edward-karak"}, "is_accepted": true, "score": 1, "last_activity_date": 1458773499, "last_edit_date": 1458773499, "creation_date": 1458771762, "answer_id": 36189828, "question_id": 36189412, "link": "https://stackoverflow.com/questions/36189412/converting-a-string-in-fn-ln-format-to-ln-fn-john-doe-to-doe-john-in-c/36189828#36189828", "title": "Converting a string in FN LN format to LN, FN (John Doe to Doe, John) in C", "body": "<p>First, you should have the code that converts \"FN LN\" to \"LN, FN\" in a separate function. The function is going to have to allocate memory, since the LN, FN form contains two more characters (the comma and the space).</p>\n\n<pre><code>char *revname(const char *fnln)\n{\n    char *buf;\n\n    /* +2 for space and comma, +1 for null terminator */\n    if ((buf = malloc(strlen(fnln) + 3)) != NULL) {\n        char *p, *q;\n        size_t len;\n\n        /* find the first space in the string */\n        if ((p = strchr(fnln, ' ')) != NULL) {\n            /* copy the text after the space */\n            strcpy(buf, p + 1);\n            strcat(buf, \", \");\n\n            len = strlen(buf);\n\n            /* append the first name */\n            for (q = (char *) fnln; q &lt; p; ++q)\n                buf[len++] = *q;\n        }\n        /* null terminate the string */\n        buf[len] = '\\0';\n    }\n    return buf;\n}\n</code></pre>\n\n<p>Now, for the main code. <code>while (!feof())</code> is wrong, because the EOF indicator is set <strong>after</strong> a reading has failed, not before. Thus, the loop will run once more than intended. The completed code is</p>\n\n<pre><code>void remlast(char *str) { str[strlen(str) - 1] = '\\0'; }\nint main()\n{\n    FILE *fp;\n    char name[20], *newname;\n\n    if ((fp = fopen(\"filename\", \"w\")) != NULL) {\n        /* write the name onto the file */\n        fputs(\"John Doe\", fp);\n\n        /* reuse the same file pointer for reading */\n        if ((fp = freopen(\"filename\", \"r\", fp)) != NULL) {\n            fgets(name, 20, fp);\n\n            /* remove the trailing newline from fgets */\n            remlast(name);\n\n            newname = revname(name);\n            printf(\"%s\\n\", newname);\n\n            /* free memory allocated by revname */\n            free(newname);\n            fclose(fp);\n        } else {\n            perror(\"freopen\");\n            return 1;\n        }\n    } else {\n        perror(\"fopen\");\n        return 1;\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Note: I haven't tested <code>main</code>, so if there are bugs let me know.</p>\n"}, {"tags": [], "owner": {"reputation": 35, "user_id": 5603502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/205e39be38fdfc3c6b3ece2bae5fda78?s=128&d=identicon&r=PG&f=1", "display_name": "SkyPirate", "link": "https://stackoverflow.com/users/5603502/skypirate"}, "is_accepted": false, "score": 0, "last_activity_date": 1458789949, "last_edit_date": 1458789949, "creation_date": 1458788876, "answer_id": 36192614, "question_id": 36189412, "link": "https://stackoverflow.com/questions/36189412/converting-a-string-in-fn-ln-format-to-ln-fn-john-doe-to-doe-john-in-c/36192614#36192614", "title": "Converting a string in FN LN format to LN, FN (John Doe to Doe, John) in C", "body": "<p>Here is one method.  </p>\n\n<ol>\n<li>Name[ ] written to FNLNnamefile.txt</li>\n<li>Name[ ] cleared</li>\n<li>FNLNnameFile.txt read back into Name[ ]</li>\n<li>Name[ ] written out to LNFNnamefile.txt\nName[ ] is printed out at various points.</li>\n</ol>\n\n<p>Yes it is a minor \"cheat\" at the end with simple element reverse, though once read into the Name[ ] the order can by manipulated by another function, be it swap or lexicographically or word length order or whatever by passing it Name[ ].</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define     EXIT_FAIL       0x01\n#define     MAX_WORD_LEN    0x1F\n#define     MAX_WORDS       0x02\n\nint main(void)\n{\n    FILE            *fptr_MyFile;\n    unsigned char   *ucName[MAX_WORDS];\n    unsigned char   ucWord[MAX_WORD_LEN];\n    unsigned int    uiW0;\n\n    ucName[0x00] = \"John\";\n    ucName[0x01] = \"Doe\";\n\n    printf(\"Name array  %s %s\\n\\n\", ucName[0x00], ucName[0x01]);\n\n    fptr_MyFile = fopen(\"FNLNnamefile.txt\", \"w\");\n    if (fptr_MyFile == NULL)\n        {\n        printf(\"Could not create file.  Ending.\\n\");\n        return(EXIT_FAIL);\n        }\n    fprintf(fptr_MyFile, \"%s %s\", ucName[0x00], ucName[0x01]);\n    fclose(fptr_MyFile);\n\n    if ((fptr_MyFile = fopen(\"FNLNnamefile.txt\", \"r\")) == NULL)\n        {\n        printf(\"Could not create file.  Ending.\\n\");\n        return(EXIT_FAIL);\n        }\n\n    ucName[0x00] = NULL;\n    ucName[0x01] = NULL;\n\n    printf(\"Name array  %s %s\\n\\n\", ucName[0x00], ucName[0x01]);\n\n    for (uiW0 = 0x00; ((uiW0 &lt; MAX_WORDS) &amp;&amp; (!feof(fptr_MyFile))); uiW0 = uiW0 + 0x01)\n        {\n        fscanf(fptr_MyFile, \"%s\", ucWord);\n        ucName[uiW0] = calloc(strlen(ucWord) + 1, sizeof(char));\n        strcpy(ucName[uiW0], ucWord);\n        }\n    fclose(fptr_MyFile);\n\n    printf(\"Name array   %s %s\\n\\n\", ucName[0x00], ucName[0x01]);\n\n    fptr_MyFile = fopen(\"LNFNnamefile.txt\", \"w\");\n    if (fptr_MyFile == NULL)\n        {\n        printf(\"Could not create file.  Ending.\\n\");\n        return(EXIT_FAIL);\n        }\n    fprintf(fptr_MyFile, \"%s, %s\", ucName[0x01], ucName[0x00]);\n    fclose(fptr_MyFile);\n\n    printf(\"Final result    %s, %s\\n\", ucName[0x01], ucName[0x00]);\n\n    return(EXIT_SUCCESS);\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5511409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71ecea0ad214262e0228e0a43dff1c28?s=128&d=identicon&r=PG&f=1", "display_name": "Teej", "link": "https://stackoverflow.com/users/5511409/teej"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 1, "closed_date": 1459346935, "accepted_answer_id": 36189828, "answer_count": 2, "score": 0, "last_activity_date": 1458789949, "creation_date": 1458770012, "question_id": 36189412, "link": "https://stackoverflow.com/questions/36189412/converting-a-string-in-fn-ln-format-to-ln-fn-john-doe-to-doe-john-in-c", "closed_reason": "Opinion-based", "title": "Converting a string in FN LN format to LN, FN (John Doe to Doe, John) in C", "body": "<p>I'm fairly new to programming and this is my first question here so hopefully I don't break any (too many) rules! I usually like to figure things out on my own but I'm stumped so here goes:</p>\n\n<p>I have an assignment for my computer science II course that's asking me to create/write my name to a file (let's say John Doe) and then output the contents of that file. This part I've been able to accomplish.</p>\n\n<p>Now the 2nd half of the assignment is telling me to write and use a function that converts my name into Last Name, First name format and write it to a separate file. It doesn't specifically tell me to output the contents of said file but I want to anyway.</p>\n\n<p>I'm not exactly sure how to approach converting the name. Should I create 2 different strings for my first and last name (I thought about doing this but it didn't seem particularly efficient)? It also doesn't seem like a situation that should require utilizing a struct, but I could be (and probably am) completely off on that. Here's what I have so far:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#define SIZE 20\n\n\nint main(void)\n{\n    FILE *readPtr;//readfile.txt file pointer\n    FILE *writePtr;//writefile.txt file pointer\n    char nameFull[SIZE] = \"John Doe\";\n\n\n    readPtr = fopen(\"readfile.txt\", \"w\");//creates readfile.txt file for writing\n    fprintf(readPtr, \"%s\", nameFull);//writes contents of string \"nameFull\" to file\n    fclose(readPtr);//close file\n\n    if((readPtr = fopen(\"readfile.txt\", \"r\")) == NULL){//returns error message if file can't be opened\n        printf(\"Error opening file!\\n\");\n    }\n    else{\n        while(!feof(readPtr)){//end of file check for readPtr file\n\n            fscanf(readPtr, \"%[^\\n]s\", nameFull);\n            printf(\"\\n%s\\n\\n\", nameFull);\n\n        }\n        fclose(readPtr);\n    }\n}\n</code></pre>\n\n<p>Any answers or suggestions are greatly appreciated. Even just a nudge in the right direction would be awesome. Also, any suggestions/criticism about my post are welcome too, so that I may improve them going forward. Thanks for your time!</p>\n"}, {"tags": ["c", "loops", "while-loop", "do-while"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1458769747, "post_id": 36189305, "comment_id": 60013828, "body": "Please show your attempted loop."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1458769945, "post_id": 36189305, "comment_id": 60013913, "body": "Please also check the return value from <code>scanf</code> as well as the scanned input value. If <code>scanf</code> does not return <code>1</code>, you are testing the <i>unintialised variable</i> <code>BPM</code>."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1458770027, "post_id": 36189305, "comment_id": 60013962, "body": "It sounds like you want to put a loop around just the user input part -- the first <code>printf()</code> and <code>scanf()</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6106197"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1458770135, "post_id": 36189305, "comment_id": 60014020, "body": "@kaylum sorry for being slow, I edited the main post to show what I attempted with do while, could you explain me the right way to do it?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1458770179, "post_id": 36189305, "comment_id": 60014043, "body": "Re your loop edit: the division <code>60&#47;BPM</code> will crash because you do it <i>before</i> checking if <code>BPM &gt; 0</code>."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1458770188, "post_id": 36189305, "comment_id": 60014046, "body": "You need to put the <code>scanf</code> inside the loop. And you need to check the <code>BPM</code> value before processing it."}], "answers": [{"comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1458770134, "post_id": 36189421, "comment_id": 60014019, "body": "Also need to initialise <code>BPM</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1458770292, "post_id": 36189421, "comment_id": 60014106, "body": "In fact <code>BPM == 0</code> with a <code>float</code> might be undesirable. Why not pick a realistic value such as <code>BPM &lt; 1.0</code> but even that would be a dirge ;)"}], "tags": [], "owner": {"reputation": 49, "user_id": 4888730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93acc23dc8edbf46901cffd59d6bc3e5?s=128&d=identicon&r=PG&f=1", "display_name": "En-code", "link": "https://stackoverflow.com/users/4888730/en-code"}, "is_accepted": false, "score": 1, "last_activity_date": 1458770039, "creation_date": 1458770039, "answer_id": 36189421, "question_id": 36189305, "link": "https://stackoverflow.com/questions/36189305/making-a-c-program-return-to-the-start-and-ask-for-input-again-if-a-user-did-not/36189421#36189421", "title": "Making a C program return to the start and ask for input again if a user did not input the right value", "body": "<p>You can use a while loop instead of the if to test for your condition</p>\n\n<p>eg</p>\n\n<pre><code>/* while loop execution */\nwhile( BPM == 0 ) {\n/* get my input values */\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1458770438, "post_id": 36189458, "comment_id": 60014169, "body": "Why <code>float fNum= 5.2;</code> ? and not double =&gt;&gt;  <code>5.2</code>...<code>dpNum</code> is not used at all."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1458772883, "post_id": 36189458, "comment_id": 60015153, "body": "@Michi - LOL, just a cut and paste from some existing code.  They just happened to be there.  The source example cpde actually displayed the <code>5.2</code> as a 64 binary.  The short answer, I was lazy."}], "tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": false, "score": 0, "last_activity_date": 1458770151, "creation_date": 1458770151, "answer_id": 36189458, "question_id": 36189305, "link": "https://stackoverflow.com/questions/36189305/making-a-c-program-return-to-the-start-and-ask-for-input-again-if-a-user-did-not/36189458#36189458", "title": "Making a C program return to the start and ask for input again if a user did not input the right value", "body": "<p>A simple example of a user input loop that exits only when user is satisfied:</p>\n\n<pre><code>int main(void)\n{\n    float fNum= 5.2;\n    double dpNum= 5.2;\n    long double ldFloat;\n\n    char quit[]={\" \"};\n\n    while(quit[0] != 'q')\n    {\n        printf(\"\\n\\nEnter a float number: \");\n        scanf(\"%f\", &amp;fNum);\n        printf(\"Enter a double precision number: \");\n        scanf(\"%Lf\", &amp;ldFloat);\n        ... other stuff as needed\n        printf(\"Enter any key to continue or 'q' to exit.\");\n        scanf(\"%s\", quit);\n    }\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1458770395, "post_id": 36189473, "comment_id": 60014150, "body": "I suggest avoiding equality tests in floating point, with <code>while(BPM &lt; 1.0)</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6106197"}, "edited": false, "score": 0, "creation_date": 1458770465, "post_id": 36189473, "comment_id": 60014181, "body": "I did this but I typed while(BPM &lt; 1.0) and it works like I wanted it to. Thank you!"}, {"owner": {"reputation": 1219, "user_id": 4333514, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7213d3f97037113330f793d2aa96efd3?s=128&d=identicon&r=PG&f=1", "display_name": "Denis", "link": "https://stackoverflow.com/users/4333514/denis"}, "edited": false, "score": 0, "creation_date": 1458770483, "post_id": 36189473, "comment_id": 60014190, "body": "You could be right depending on the requirement of user...I don&#39;t know if negetive values are valid or not in this program."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1458770592, "post_id": 36189473, "comment_id": 60014231, "body": "BPM = Beats Per Minute."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6106197"}, "edited": false, "score": 0, "creation_date": 1458770987, "post_id": 36189473, "comment_id": 60014393, "body": "Small edit. This is now asking the user to input again if he inserts a value less than 1. I&#39;d like to know if there is a way to add a simple message that would tell the user that he typed in a wrong value?"}], "tags": [], "owner": {"reputation": 1219, "user_id": 4333514, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7213d3f97037113330f793d2aa96efd3?s=128&d=identicon&r=PG&f=1", "display_name": "Denis", "link": "https://stackoverflow.com/users/4333514/denis"}, "is_accepted": true, "score": 0, "last_activity_date": 1458770209, "creation_date": 1458770209, "answer_id": 36189473, "question_id": 36189305, "link": "https://stackoverflow.com/questions/36189305/making-a-c-program-return-to-the-start-and-ask-for-input-again-if-a-user-did-not/36189473#36189473", "title": "Making a C program return to the start and ask for input again if a user did not input the right value", "body": "<p>Add this code below you BPM declaration.</p>\n\n<pre><code>do{\n    printf(\"Please input the BPM:   \");\n    scanf(\" %f\", &amp;BPM);\n  }while(BPM==0.00);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 10300, "user_id": 2469027, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b62ce55f4f1a0eff6775e7863850a912?s=128&d=identicon&r=PG", "display_name": "Edward Karak", "link": "https://stackoverflow.com/users/2469027/edward-karak"}, "is_accepted": false, "score": 0, "last_activity_date": 1458773893, "creation_date": 1458773893, "answer_id": 36190301, "question_id": 36189305, "link": "https://stackoverflow.com/questions/36189305/making-a-c-program-return-to-the-start-and-ask-for-input-again-if-a-user-did-not/36190301#36190301", "title": "Making a C program return to the start and ask for input again if a user did not input the right value", "body": "<pre><code>do {\n    printf(\"Please input the BPM: \");\n} while (scanf(\"%f\", &amp;bpm) == 0 || bpm &lt; 0);\n</code></pre>\n\n<p>This loop prints the question until the user inputted a valid floating point number and that said number is at least 0.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6106197"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2044, "favorite_count": 0, "accepted_answer_id": 36189473, "answer_count": 4, "score": 0, "last_activity_date": 1458773893, "creation_date": 1458769622, "last_edit_date": 1458770084, "question_id": 36189305, "link": "https://stackoverflow.com/questions/36189305/making-a-c-program-return-to-the-start-and-ask-for-input-again-if-a-user-did-not", "title": "Making a C program return to the start and ask for input again if a user did not input the right value", "body": "<p>it's my first post here so please be gentle to me. I've recently started a C programming class on my university and I got really interested in it. Since I'm working with audio (mixing / mastering music) I decided to try and make a simple program that would calculate the delay times in ms for the user defined BPM (Beats per minute).</p>\n\n<p>What I am currently stuck with is the following: I want the program to return to the start and ask the user to input again if he typed in the wrong BPM (0 in this case).</p>\n\n<p>I tried a <strong>do while loop</strong> however it didn't work quite right, my program would still calculate everything as if a user just typed in 0 and if I typed a correct value it would just loop endlessly.</p>\n\n<p>If I do an <strong>if else statement</strong> it gives the user a message but I'd like to prompt the user for input again together with the message. </p>\n\n<p>I know that this is a pretty simple and basic question but any help would be greatly appreciated.</p>\n\n<p>Here is my code so far:</p>\n\n<pre><code>int main(){\n\n    float BPM;\n\n    printf(\"Please input the BPM:   \");\n    scanf(\" %f\", &amp;BPM);\n\n    do{\n\n    float HZ = 1000;\n    float HZ_Result;\n    float BPM_QuarterNote=(60/BPM)*1000;\n\n    float BPM_WholeNote=BPM_QuarterNote*4;\n    printf(\"\\n\\nDelay time for whole note is: %.2f ms or %.2f Hz\", BPM_WholeNote, 1000/BPM_WholeNote);\n\n    float BPM_HalfNote=BPM_QuarterNote*2.0;\n    printf(\"\\n\\nDelay time for 1/2 note is: %.2f ms or %.2f Hz\", BPM_HalfNote, 1000/BPM_HalfNote);\n\n        printf(\"\\n\\nDelay time for 1/4 note is: %.2f ms or %.2f Hz\", BPM_QuarterNote,  1000/BPM_QuarterNote);\n\n    float BPM_EightNote=BPM_QuarterNote*0.5;\n    printf(\"\\n\\nDelay time for 1/8 note is: %.2f ms or %.2f Hz\", BPM_EightNote, 1000/BPM_EightNote);\n\n    float BPM_SixteenthNote=BPM_QuarterNote*0.25;\n    printf(\"\\n\\nDelay time for 1/16 note is: %.2f ms or %.2f Hz\", BPM_SixteenthNote, 1000/BPM_SixteenthNote);\n\n    float BPM_32ndNote=BPM_QuarterNote*0.125;\n    printf(\"\\n\\nDelay time for 1/32 note is: %.2f ms or %.2f Hz\", BPM_32ndNote, 1000/BPM_32ndNote);\n\n\n    }while(BPM &gt; 0);\n\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 2, "creation_date": 1458769649, "post_id": 36189245, "comment_id": 60013779, "body": "It&#39;s really not clear what you are asking. If you mean just overwrite an array value, then the answer is it depends. If the array is not a literal string then yes, you can change the values in any manner you like as long as the new value fits within the type of the array."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1458769652, "post_id": 36189245, "comment_id": 60013781, "body": "Use an array whose indexes are the character codes, and the values are the counts."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1458769702, "post_id": 36189245, "comment_id": 60013806, "body": "If you just want to count a single character like <code>B</code>, you don&#39;t even need to do that. Just use a variable called <code>count</code>, and whenever you find a <code>B</code>, you increment <code>count</code>."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1458769824, "post_id": 36189245, "comment_id": 60013853, "body": "You seem to be failing to distinguish between strings and characters.  In C, they are very different things."}], "answers": [{"tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 2, "last_activity_date": 1458769831, "creation_date": 1458769831, "answer_id": 36189356, "question_id": 36189245, "link": "https://stackoverflow.com/questions/36189245/is-it-possible-to-make-a-string-such-as-g-equal-a-specific-number-like-50/36189356#36189356", "title": "Is it possible to make a string such as &quot;G&quot; equal a specific number like 50?", "body": "<p>You don't need to assign to a string, just use an ordinary variable.</p>\n\n<pre><code>int b_count = 0;\nchar *string = \"This is a B and this is another B\";\nfor (char *p = string; *p != 0; p++) {\n    if (*p == 'B') {\n        b_count++;\n    }\n}\nprintf(\"There are %d B's in the string\\n\", b_count);\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6105619, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d263dd2082dcd6352d025748e166bac?s=128&d=identicon&r=PG&f=1", "display_name": "What&#39;s_sarcasm", "link": "https://stackoverflow.com/users/6105619/whats-sarcasm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "closed_date": 1458777516, "answer_count": 1, "score": -5, "last_activity_date": 1458769831, "creation_date": 1458769383, "question_id": 36189245, "link": "https://stackoverflow.com/questions/36189245/is-it-possible-to-make-a-string-such-as-g-equal-a-specific-number-like-50", "closed_reason": "Needs details or clarity", "title": "Is it possible to make a string such as &quot;G&quot; equal a specific number like 50?", "body": "<p>For example if I had the letter \"B\" in a array and want to count how many there are,could I make \"B\"=1 so I can easily count the number of b's.I do not think this is typecasting since I am do not want to make \"B\" itself = int B</p>\n"}, {"tags": ["c", "arrays", "readfile"], "comments": [{"owner": {"reputation": 866, "user_id": 2491551, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/wgrbu.png?s=128&g=1", "display_name": "Xzenon", "link": "https://stackoverflow.com/users/2491551/xzenon"}, "edited": false, "score": 0, "creation_date": 1458768983, "post_id": 36189108, "comment_id": 60013474, "body": "Are you using an IDE? It might be you didn&#39;t give it the path for the file."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1458769472, "post_id": 36189108, "comment_id": 60013695, "body": "Similar to <a href=\"http://stackoverflow.com/questions/36187504/reading-an-int-from-a-text-file-into-an-array-in-c\">this recently asked question</a>. What was the function return values from <code>fopen</code> and <code>fscanf</code>?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1458769572, "post_id": 36189108, "comment_id": 60013742, "body": "Aside: <code>int x[5], y[5]</code> --&gt; <code>int x[SIZE], y[SIZE]</code>"}, {"owner": {"reputation": 5, "user_id": 6106663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdf11d5f12ce43b2a1461987434a2df8?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan Posey", "link": "https://stackoverflow.com/users/6106663/dylan-posey"}, "edited": false, "score": 0, "creation_date": 1458770803, "post_id": 36189108, "comment_id": 60014312, "body": "-2 6356704 1961194346 1945845610 1961194589 6356940 4199232 1961218544 6356792 1945843218  Press Enter to return to Quincy..."}, {"owner": {"reputation": 5, "user_id": 6106663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdf11d5f12ce43b2a1461987434a2df8?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan Posey", "link": "https://stackoverflow.com/users/6106663/dylan-posey"}, "edited": false, "score": 0, "creation_date": 1458771074, "post_id": 36189108, "comment_id": 60014430, "body": "And no im not using an IDE"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 6106663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdf11d5f12ce43b2a1461987434a2df8?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan Posey", "link": "https://stackoverflow.com/users/6106663/dylan-posey"}, "edited": false, "score": 0, "creation_date": 1458771636, "post_id": 36189728, "comment_id": 60014676, "body": "Ive put the file in the same folder as my project and changed the permission for fopen to &quot;w+&quot; but it&#39;s still not working"}, {"owner": {"reputation": 103, "user_id": 2470848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a73dc3e74ff0036aa918b4a78f16800?s=128&d=identicon&r=PG", "display_name": "Awad A. Bekhet", "link": "https://stackoverflow.com/users/2470848/awad-a-bekhet"}, "reply_to_user": {"reputation": 5, "user_id": 6106663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdf11d5f12ce43b2a1461987434a2df8?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan Posey", "link": "https://stackoverflow.com/users/6106663/dylan-posey"}, "edited": false, "score": 0, "creation_date": 1458771850, "post_id": 36189728, "comment_id": 60014753, "body": "What I mean if you are not sure where to put your file. Remove all relevant files, then use &quot;w+&quot;. It will create a file. Then replace that file with yours and try again but don&#39;t forget to return permission to &quot;r&quot; again before to avoid your data to be cleaned."}, {"owner": {"reputation": 5, "user_id": 6106663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdf11d5f12ce43b2a1461987434a2df8?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan Posey", "link": "https://stackoverflow.com/users/6106663/dylan-posey"}, "edited": false, "score": 0, "creation_date": 1458772088, "post_id": 36189728, "comment_id": 60014849, "body": "Oh I understand, let me try"}], "tags": [], "owner": {"reputation": 103, "user_id": 2470848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a73dc3e74ff0036aa918b4a78f16800?s=128&d=identicon&r=PG", "display_name": "Awad A. Bekhet", "link": "https://stackoverflow.com/users/2470848/awad-a-bekhet"}, "is_accepted": true, "score": 0, "last_activity_date": 1458772273, "last_edit_date": 1458772273, "creation_date": 1458771312, "answer_id": 36189728, "question_id": 36189108, "link": "https://stackoverflow.com/questions/36189108/very-basic-trying-to-read-from-a-text-file-with-numbers-and-store-them-in-an-ar/36189728#36189728", "title": "Very basic, trying to read from a text file with numbers and store them in an array", "body": "<p>Make sure that your \"pfile1.txt\" file is placed next to your project settings.\nto make sure about the place of your file should be, change the permission of open to \"w+\". This option will try to open that file or create it if not found. The replace that file with yours.\nEverything will be work without any problem :) </p>\n\n<p>Just Hint on the fly:\nDon't make any operation on any pointer unless you make sure that it is not NULL.\nso, surround your code with to avoid any crashing </p>\n\n<pre><code>if( NULL != in)\n{\n\n    for (i=0;i&lt;SIZE;++i){\n        fscanf(in, \"%d %d\", &amp;x[i], &amp;y[i]);\n    }\n\n    for (i=0;i&lt;SIZE;++i){\n        printf(\"%4d %10d\\n\", x[i], y[i]);\n    }\n\n\n    fscanf(in, \"%lf\", &amp;h);\n    printf(\"%lf\\n\", h);\n    fclose(in);\n}\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 6106663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdf11d5f12ce43b2a1461987434a2df8?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan Posey", "link": "https://stackoverflow.com/users/6106663/dylan-posey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 36189728, "answer_count": 1, "score": 0, "last_activity_date": 1458772273, "creation_date": 1458768818, "last_edit_date": 1458770908, "question_id": 36189108, "link": "https://stackoverflow.com/questions/36189108/very-basic-trying-to-read-from-a-text-file-with-numbers-and-store-them-in-an-ar", "title": "Very basic, trying to read from a text file with numbers and store them in an array", "body": "<p>When I run the program, the numbers I'm getting are completely ridiculous such as -39389014 when the number in the text file is 20. Here is what my text file  looks like:</p>\n\n<pre><code>20 20\n40 30\n80 40\n90 20\n60 10\n18.0\n</code></pre>\n\n<p>And the Code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#define SIZE 5\n\nint main(void){\n    FILE *in = fopen(\"pfile1.txt\", \"r\");\n    int x[5], y[5], i;\n    double h;\n\n    for (i=0;i&lt;SIZE;++i){\n        fscanf(in, \"%d %d\", &amp;x[i], &amp;y[i]);\n    }\n\n    for (i=0;i&lt;SIZE;++i){\n        printf(\"%4d %10d\\n\", x[i], y[i]);\n    }\n\n\n    fscanf(in, \"%lf\", &amp;h);\n    printf(\"%lf\\n\", h);\n    fclose(in);\n\n    return(0);\n}\n</code></pre>\n"}, {"tags": ["c", "comparison-operators"], "comments": [{"owner": {"reputation": 20558, "user_id": 2864275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p2xKk.png?s=128&g=1", "display_name": "I\u0142ya Bursov", "link": "https://stackoverflow.com/users/2864275/i%c5%82ya-bursov"}, "edited": false, "score": 0, "creation_date": 1458768201, "post_id": 36188903, "comment_id": 60013168, "body": "<code>In actual code they&#39;re not integer literals</code> what are they in original code?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1458768266, "post_id": 36188903, "comment_id": 60013198, "body": "The <code>&gt;</code> and other such operators evaluate to an int, <code>0</code> or <code>1</code>."}, {"owner": {"reputation": 34083, "user_id": 1287251, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IQkBy.png?s=128&g=1", "display_name": "Cornstalks", "link": "https://stackoverflow.com/users/1287251/cornstalks"}, "edited": false, "score": 1, "creation_date": 1458768279, "post_id": 36188903, "comment_id": 60013204, "body": "It&#39;s valid, it&#39;s not bad practice, and <a href=\"https://github.com/FFmpeg/FFmpeg/blob/99eabcdd5f904e98a02184889ab84cc9d5c17a8c/libavcodec/libopenjpegdec.c#L186-L189\" rel=\"nofollow noreferrer\">it is used</a>."}, {"owner": {"reputation": 45, "user_id": 5884692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03f8d204633c297bdc942929b2610b09?s=128&d=identicon&r=PG&f=1", "display_name": "lorenzownd", "link": "https://stackoverflow.com/users/5884692/lorenzownd"}, "reply_to_user": {"reputation": 20558, "user_id": 2864275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p2xKk.png?s=128&g=1", "display_name": "I\u0142ya Bursov", "link": "https://stackoverflow.com/users/2864275/i%c5%82ya-bursov"}, "edited": false, "score": 0, "creation_date": 1458768908, "post_id": 36188903, "comment_id": 60013451, "body": "@Lashane It was just to point out that <code>a</code> and <code>b</code> wouldn&#39;t be optimized out at compile time. They would be <code>int</code>s coming from functions or user input."}, {"owner": {"reputation": 45, "user_id": 5884692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03f8d204633c297bdc942929b2610b09?s=128&d=identicon&r=PG&f=1", "display_name": "lorenzownd", "link": "https://stackoverflow.com/users/5884692/lorenzownd"}, "edited": false, "score": 0, "creation_date": 1458768963, "post_id": 36188903, "comment_id": 60013467, "body": "Thanks to all for the quick replies!"}, {"owner": {"reputation": 18146, "user_id": 646619, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bd61a0f309ebc135d2661710c2faf379?s=128&d=identicon&r=PG", "display_name": "Colonel Thirty Two", "link": "https://stackoverflow.com/users/646619/colonel-thirty-two"}, "edited": false, "score": 0, "creation_date": 1458771268, "post_id": 36188903, "comment_id": 60014514, "body": "Just because they&#39;re the result of a function doesn&#39;t mean they won&#39;t be optimized out; inlining and link-time optimizations can still optimize them out. Not that it matters as long as your code is well defined."}], "answers": [{"tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": true, "score": 3, "last_activity_date": 1458768413, "last_edit_date": 1495535312, "creation_date": 1458768413, "answer_id": 36189008, "question_id": 36188903, "link": "https://stackoverflow.com/questions/36188903/comparison-in-variable-assignment/36189008#36189008", "title": "Comparison in variable assignment", "body": "<p>This is a perfectly valid C code. The behavior is detailed in section 6.5.8.6 of the C99 standard:</p>\n\n<blockquote>\n  <p>Each of the operators <code>&lt;</code> (less than), <code>&gt;</code> (greater than), <code>&lt;=</code> (less than or equal to), and <code>&gt;=</code> (greater than or equal to) shall yield <code>1</code> if the specified relation is true and <code>0</code> if it is false. The result has type <code>int</code>.</p>\n</blockquote>\n\n<p>Unless you are maintaining legacy code that must be compatible with pre-C99 compilers, <a href=\"https://stackoverflow.com/q/4767923/335858\">consider using <code>&lt;stdbool.h&gt;</code> and <code>bool</code> type</a> instead of an <code>int</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1458769358, "post_id": 36189156, "comment_id": 60013630, "body": "Why would you want to avoid optimization"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1458769433, "post_id": 36189156, "comment_id": 60013670, "body": "Why do you think that <code>volatile</code> might be relevant?  The value assigned to <code>result</code> will be the value of the comparison when the assignment is executed. Even if <code>a</code> or <code>b</code> (or both) subsequently change, that will not change the value in <code>result</code>, whether it is marked <code>volatile</code> or not.  Your &#39;read more about voltatile usage&#39; line isn&#39;t a link, though the content suggests there should be a link there somewhere."}, {"owner": {"reputation": 103, "user_id": 2470848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a73dc3e74ff0036aa918b4a78f16800?s=128&d=identicon&r=PG", "display_name": "Awad A. Bekhet", "link": "https://stackoverflow.com/users/2470848/awad-a-bekhet"}, "edited": false, "score": 0, "creation_date": 1458771683, "post_id": 36189156, "comment_id": 60014686, "body": "In case this variable used later; not assigning to it anymore just usage; this will be optimized."}, {"owner": {"reputation": 103, "user_id": 2470848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a73dc3e74ff0036aa918b4a78f16800?s=128&d=identicon&r=PG", "display_name": "Awad A. Bekhet", "link": "https://stackoverflow.com/users/2470848/awad-a-bekhet"}, "edited": false, "score": 0, "creation_date": 1458771900, "post_id": 36189156, "comment_id": 60014774, "body": "for better understanding, we should have the complete code."}, {"owner": {"reputation": 34083, "user_id": 1287251, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IQkBy.png?s=128&g=1", "display_name": "Cornstalks", "link": "https://stackoverflow.com/users/1287251/cornstalks"}, "edited": false, "score": 0, "creation_date": 1458813927, "post_id": 36189156, "comment_id": 60028449, "body": "<code>volatile</code> actively hinders optimization. Using it will not help the code be optimized. Just the opposite."}, {"owner": {"reputation": 103, "user_id": 2470848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a73dc3e74ff0036aa918b4a78f16800?s=128&d=identicon&r=PG", "display_name": "Awad A. Bekhet", "link": "https://stackoverflow.com/users/2470848/awad-a-bekhet"}, "edited": false, "score": 0, "creation_date": 1458828874, "post_id": 36189156, "comment_id": 60037933, "body": "Actually, that&#39;s what I meant to say."}], "tags": [], "owner": {"reputation": 103, "user_id": 2470848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a73dc3e74ff0036aa918b4a78f16800?s=128&d=identicon&r=PG", "display_name": "Awad A. Bekhet", "link": "https://stackoverflow.com/users/2470848/awad-a-bekhet"}, "is_accepted": false, "score": -3, "last_activity_date": 1458769601, "last_edit_date": 1458769601, "creation_date": 1458769000, "answer_id": 36189156, "question_id": 36188903, "link": "https://stackoverflow.com/questions/36188903/comparison-in-variable-assignment/36189156#36189156", "title": "Comparison in variable assignment", "body": "<p>What @dasblinkenlight said is right. In addition to that, and I am not aware with your code, you may need to define the variable \"result\" as volatile to avoid compiler optimization, where 2 and 3 are magic values and already the result of comparison is known.\nSo, try to replace :</p>\n\n<pre><code>int result = a &gt; b;\n</code></pre>\n\n<p>with </p>\n\n<pre><code>volatile int result = a &gt; b;\n</code></pre>\n\n<p>Read more about volatile usage.</p>\n"}], "owner": {"reputation": 45, "user_id": 5884692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03f8d204633c297bdc942929b2610b09?s=128&d=identicon&r=PG&f=1", "display_name": "lorenzownd", "link": "https://stackoverflow.com/users/5884692/lorenzownd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 377, "favorite_count": 0, "accepted_answer_id": 36189008, "answer_count": 2, "score": 1, "last_activity_date": 1458769948, "creation_date": 1458768056, "last_edit_date": 1458769948, "question_id": 36188903, "link": "https://stackoverflow.com/questions/36188903/comparison-in-variable-assignment", "title": "Comparison in variable assignment", "body": "<p>Sorry if it's a stupid question, but I couldn't find much information.\nI just want to assign the result of a comparison in a variable, like this:</p>\n\n<pre><code>int a = 3, b = 2; // In actual code they're not integer literals\nint result = a &gt; b;\n</code></pre>\n\n<p>When compiling, <code>gcc</code> (with <code>-Wall</code>) doesn't complain, and looking at the assembly output I found it's translated to <code>cmp</code> and <code>setle</code> (or <code>setg</code> etc.). I'm wondering whether it's invalid (C) code or considered bad practice, since I see it's never used.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 12281, "user_id": 1322268, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EfWtq.jpg?s=128&g=1", "display_name": "shawnt00", "link": "https://stackoverflow.com/users/1322268/shawnt00"}, "edited": false, "score": 2, "creation_date": 1458768096, "post_id": 36188896, "comment_id": 60013116, "body": "Try running from a command line."}, {"owner": {"reputation": 2598, "user_id": 1996022, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/de764cb701641bd5ca3419fda6186edb?s=128&d=identicon&r=PG", "display_name": "BrainStone", "link": "https://stackoverflow.com/users/1996022/brainstone"}, "edited": false, "score": 0, "creation_date": 1458768227, "post_id": 36188896, "comment_id": 60013178, "body": "Y&gt;ou could either run the exe from a console window or add <code>system(&quot;pause&quot;)</code> the end. Not trying to be rude but Google would have told you the same..."}, {"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 1, "creation_date": 1458768278, "post_id": 36188896, "comment_id": 60013202, "body": "Use <code>getchar();</code> to pause program execution."}], "answers": [{"comments": [{"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 5, "creation_date": 1458768414, "post_id": 36188994, "comment_id": 60013259, "body": "<code>system(&quot;pause&quot;)</code> isn&#39;t cross platform."}], "tags": [], "owner": {"reputation": 185, "user_id": 3070814, "user_type": "registered", "accept_rate": 11, "profile_image": "https://i.stack.imgur.com/MUYJA.png?s=128&g=1", "display_name": "Mihov", "link": "https://stackoverflow.com/users/3070814/mihov"}, "is_accepted": false, "score": 1, "last_activity_date": 1458768372, "creation_date": 1458768372, "answer_id": 36188994, "question_id": 36188896, "link": "https://stackoverflow.com/questions/36188896/how-do-i-prevent-the-console-application-file-from-closing-itself-immediately/36188994#36188994", "title": "How do I prevent the console (application file) from closing itself immediately after running in windows?", "body": "<p>1)Try to run it natively through the cmd.</p>\n\n<p>Let's say that your file is in C:\\file.exe\nOpen the cmd, type cd C:\\ and then type file.exe</p>\n\n<p>2)Try to add \"system(\"PAUSE\");\" to your program to keep it opened.</p>\n"}, {"tags": [], "owner": {"reputation": 201, "user_id": 4318273, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Zy9f4Vn5044/AAAAAAAAAAI/AAAAAAAAAJQ/nus2KlPMKpo/photo.jpg?sz=128", "display_name": "conrad gardner", "link": "https://stackoverflow.com/users/4318273/conrad-gardner"}, "is_accepted": false, "score": 20, "last_activity_date": 1458768952, "last_edit_date": 1458768952, "creation_date": 1458768557, "answer_id": 36189043, "question_id": 36188896, "link": "https://stackoverflow.com/questions/36188896/how-do-i-prevent-the-console-application-file-from-closing-itself-immediately/36189043#36189043", "title": "How do I prevent the console (application file) from closing itself immediately after running in windows?", "body": "<p>The following two lines will print the message \"Press ENTER key to Continue\" and then pause execution waiting for the enter key. I hope this helps.</p>\n\n<pre><code>printf(\"Press ENTER key to Continue\\n\");  \ngetchar(); \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1995, "user_id": 3492631, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/6X56B.jpg?s=128&g=1", "display_name": "Dendi Suhubdy", "link": "https://stackoverflow.com/users/3492631/dendi-suhubdy"}, "is_accepted": false, "score": 1, "last_activity_date": 1458768828, "creation_date": 1458768828, "answer_id": 36189110, "question_id": 36188896, "link": "https://stackoverflow.com/questions/36188896/how-do-i-prevent-the-console-application-file-from-closing-itself-immediately/36189110#36189110", "title": "How do I prevent the console (application file) from closing itself immediately after running in windows?", "body": "<p>Do this </p>\n\n<pre><code>int main()\n{\n\n   // your code\n\n   system(\"pause\"); // this will stop the pause \n\n   return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 987, "user_id": 2627487, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/17454b0724fc732d0a1e9a708fc1f49b?s=128&d=identicon&r=PG", "display_name": "MrPisarik", "link": "https://stackoverflow.com/users/2627487/mrpisarik"}, "edited": false, "score": 2, "creation_date": 1516981570, "post_id": 36189163, "comment_id": 83922715, "body": "it works only for Windows"}], "tags": [], "owner": {"reputation": 42880, "user_id": 982161, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/kutcC.png?s=128&g=1", "display_name": "\u03a6Xoc\u0119 \uc6c3 \u041fepe&#250;pa \u30c4", "link": "https://stackoverflow.com/users/982161/%ce%a6xoc%c4%99-%ec%9b%83-%d0%9fepe%c3%bapa-%e3%83%84"}, "is_accepted": false, "score": 7, "last_activity_date": 1458769023, "last_edit_date": 1592644375, "creation_date": 1458769023, "answer_id": 36189163, "question_id": 36188896, "link": "https://stackoverflow.com/questions/36188896/how-do-i-prevent-the-console-application-file-from-closing-itself-immediately/36189163#36189163", "title": "How do I prevent the console (application file) from closing itself immediately after running in windows?", "body": "<p>The problem is quite common when starting to learn C/C++..</p>\n<p>the reason is that console applications once finisher return from their main method, the associated console window automatically closes. This behavior has nothing to do with what your app does or not, or if the app is working well or not.</p>\n<p>To &quot;correct&quot; this simple add a pause just before the return statement in the main method</p>\n<h1>Example:</h1>\n<pre><code>....\n   system(&quot;pause&quot;);  \n   return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 6106604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce6a2784eec0449be6088af2b9b3f642?s=128&d=identicon&r=PG&f=1", "display_name": "Ozgur Aydogmus", "link": "https://stackoverflow.com/users/6106604/ozgur-aydogmus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45006, "favorite_count": 5, "closed_date": 1458789698, "answer_count": 4, "score": 7, "last_activity_date": 1608685268, "creation_date": 1458768031, "last_edit_date": 1608685268, "question_id": 36188896, "link": "https://stackoverflow.com/questions/36188896/how-do-i-prevent-the-console-application-file-from-closing-itself-immediately", "closed_reason": "Needs more focus", "title": "How do I prevent the console (application file) from closing itself immediately after running in windows?", "body": "<p>After I compile my program and run the .exe one, it closes after first run. I barely see my output.  Do I need codes to prevent that, if so what are these codes?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1458767933, "post_id": 36188859, "comment_id": 60013028, "body": "Do you have a question?"}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 2, "creation_date": 1458768016, "post_id": 36188859, "comment_id": 60013072, "body": "Incomplete code, but the last test my be false, then the control reaches the end of the function without returning any value; at least the compiler can&#39;t see that <code>c</code> is necessarily 0."}, {"owner": {"reputation": 20558, "user_id": 2864275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p2xKk.png?s=128&g=1", "display_name": "I\u0142ya Bursov", "link": "https://stackoverflow.com/users/2864275/i%c5%82ya-bursov"}, "edited": false, "score": 1, "creation_date": 1458768110, "post_id": 36188859, "comment_id": 60013120, "body": "why do you need variable <code>c</code>? try to remove it. Also you don&#39;t need break after return"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1458769674, "post_id": 36188859, "comment_id": 60013796, "body": "You might find the &quot;error&quot; goes away if you increase the compiler optimization level.    But a good solution anyway would be to remove <code>if(c==0)</code>.  If you are sure that <code>c</code> must be <code>0</code> at that point then the test is redundant anyway."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 6106588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36f8d59482dc1550be06e3b65b537ea2?s=128&d=identicon&r=PG&f=1", "display_name": "user6106588", "link": "https://stackoverflow.com/users/6106588/user6106588"}, "edited": false, "score": 0, "creation_date": 1458800301, "post_id": 36189763, "comment_id": 60022553, "body": "thanks\uff0cthis is really helpful\uff0cI never notice that."}], "tags": [], "owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "is_accepted": false, "score": 1, "last_activity_date": 1458773077, "last_edit_date": 1458773077, "creation_date": 1458771466, "answer_id": 36189763, "question_id": 36188859, "link": "https://stackoverflow.com/questions/36188859/kr-exercise-2-5-error-control-may-reach-end-of-non-void-function-c/36189763#36189763", "title": "K&amp;R exercise 2-5,error control may reach end of non-void function c", "body": "<p>You should start to learn to use <strong>brackets</strong>, this means that if you change this:</p>\n\n<pre><code>if(c==0) \nreturn -1;\n</code></pre>\n\n<p>To this:</p>\n\n<pre><code>if(c==0){\n    return -1;\n}\n</code></pre>\n\n<p>You will easy discover that there is no <code>return</code> if <code>C != 0</code>.</p>\n\n<p>Another problem is here:</p>\n\n<pre><code>if(b[j]==a[i]&amp;&amp;c==0){\n    c = 1;\n    return i;\n    break;\n}\n</code></pre>\n\n<p>First you say <code>return i;</code> and then <code>break</code>, really?</p>\n\n<p>Another thing is about <code>strlen</code> which is defined like this:</p>\n\n<pre><code>size_t strlen(const char * str){\n    const char *s;\n    for (s = str; *s; ++s) {}\n    return(s - str);\n}\n</code></pre>\n\n<p><code>size_t</code> is <code>long unsigned int</code> which means that here:</p>\n\n<pre><code>for(i=0;i&lt;strlen(a);i++)\n</code></pre>\n\n<p>and here:</p>\n\n<pre><code>for(j=0;j&lt;strlen(b);j++)\n</code></pre>\n\n<p>You are comparing an <code>int</code> with an <code>long unsigned int</code>.\nThis means that this line:</p>\n\n<pre><code>int i,j;\n</code></pre>\n\n<p>should be:</p>\n\n<pre><code>size_t i,j;\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>long unsigned i,j;\n</code></pre>\n\n<p>So even if you fix that there are still some casts needed:</p>\n\n<pre><code>int any(string a,string b){\n    size_t i,j;\n    int c = 0;\n    for(i=0;i&lt;strlen(a);i++){\n        for(j=0;j&lt;strlen(b);j++){\n            if(b[j]==a[i]&amp;&amp;c==0){\n                c = 1;\n                break;\n            }\n        }\n    }\n\n    if(c==1){\n        return (int)i;\n    }else{\n        return (int)-1;\n    }\n}\n</code></pre>\n\n<p>Which means that you should reconsider writing in another way the whole program.</p>\n\n<p>Maybe this will be ok for you:</p>\n\n<pre><code>size_t any(string a,string b){\n    size_t i,j;\n    int c = 0;\n    for(i=0;i&lt;strlen(a);i++){\n        for(j=0;j&lt;strlen(b);j++){\n            if(b[j]==a[i]&amp;&amp;c==0){\n                c = 1;\n                break;\n            }\n        }\n    }\n\n    if(c==1){\n        return i;\n    }else{\n        return 1;\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 22751, "user_id": 2399879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UxMS5.jpg?s=128&g=1", "display_name": "Crowman", "link": "https://stackoverflow.com/users/2399879/crowman"}, "is_accepted": false, "score": 0, "last_activity_date": 1458774526, "last_edit_date": 1458774526, "creation_date": 1458773674, "answer_id": 36190268, "question_id": 36188859, "link": "https://stackoverflow.com/questions/36188859/kr-exercise-2-5-error-control-may-reach-end-of-non-void-function-c/36190268#36190268", "title": "K&amp;R exercise 2-5,error control may reach end of non-void function c", "body": "<p>You're getting the error because the compiler is not smart enough to realize that <code>c == 0</code> must be true if you get to the test. For the same reason, the test is completely unnecessary, so removing it and just returning <code>-1</code> at that point will fix the error.</p>\n\n<p>You can simplify greatly by changing to:</p>\n\n<pre><code>int any(char * a, char * b){\n    int i, j;\n\n    for( i = 0; a[i]; ++i ) {\n        for( j = 0; b[j]; ++j ) {\n            if( b[j] == a[i] ) {\n                return i;\n            }  \n        }\n    }\n\n    return -1;\n}\n</code></pre>\n\n<p>This avoids the redundant test(s), avoids the need for your <code>c</code> variable altogether, and avoids the gratuitous and repeated calls to <code>strlen()</code>.</p>\n\n<p><code>typedef</code>ing <code>char *</code> as <code>string</code> is also in rather poor taste.</p>\n\n<p>Probably over the top for this exercise, but by trading some memory efficiency for speed efficiency, you could set up an array as a lookup table and read the characters from <code>b</code> into it, and then step through <code>a</code> until you reach the end or get a match. This would require traversing the characters of <code>b</code> exactly once, and at most one full traversal through <code>a</code>, so you'd get a linear time algorithm rather than the quadratic time one you have now. </p>\n\n<p>For instance:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;limits.h&gt;\n\nint any(char * a, char * b);\n\nint main(void)\n{\n    printf(\"'rifle', 'flog': %d\\n\", any(\"rifle\", \"flog\"));\n    printf(\"'pterodactyl', 'dint': %d\\n\", any(\"pterodactyl\", \"dint\"));\n    printf(\"'xyzzy', 'fish': %d\\n\", any(\"xyzzy\", \"fish\"));\n\n    return 0;\n}\n\nint any(char * a, char * b)\n{\n    int lookup[CHAR_MAX + 1] = {0};\n\n    for ( int i = 0; b[i]; ++i ) {\n        lookup[b[i]] += 1;\n    }\n\n    for ( int i = 0; a[i]; ++i ) {\n        if ( lookup[a[i]] ) {\n            return i;\n        }\n    }\n\n    return -1;\n}\n</code></pre>\n\n<p>with output:</p>\n\n<pre><code>paul@horus:~/Documents/src/sandbox$ ./any\n'rifle', 'flog': 2\n'pterodactyl', 'dint': 1\n'xyzzy', 'fish': -1\npaul@horus:~/Documents/src/sandbox$ \n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 6106588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36f8d59482dc1550be06e3b65b537ea2?s=128&d=identicon&r=PG&f=1", "display_name": "user6106588", "link": "https://stackoverflow.com/users/6106588/user6106588"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "closed_date": 1458789536, "answer_count": 2, "score": -3, "last_activity_date": 1458774526, "creation_date": 1458767881, "last_edit_date": 1458771921, "question_id": 36188859, "link": "https://stackoverflow.com/questions/36188859/kr-exercise-2-5-error-control-may-reach-end-of-non-void-function-c", "closed_reason": "Not suitable for this site", "title": "K&amp;R exercise 2-5,error control may reach end of non-void function c", "body": "<p>\"Write the function any(s1,s2), which returns the first location in the string s1 where any character from the string s2 occurs, or -1 if s1 contains no characters from s2. \nWhen I compile my code, I get \"control may reach end of non void function.which part causing the error\uff0chere\u2019s my code:</p>\n\n<pre><code>int any(string a,string b){\n    int i,j;\n    int c = 0;\n    for(i=0;i&lt;strlen(a);i++){\n        for(j=0;j&lt;strlen(b);j++){\n            if(b[j]==a[i]&amp;&amp;c==0){\n                c = 1;\n                return i;\n                break;\n            }  \n        }\n    }\n\n    if(c==0) \n    return -1;\n}\n</code></pre>\n"}, {"tags": ["c", "multithreading", "pthreads", "shared-memory"], "comments": [{"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 1, "creation_date": 1458767790, "post_id": 36188750, "comment_id": 60012955, "body": "The problem may be due to concurrency, but you didn&#39;t show us the code that populate the segment, etc. Access should be something like <code>(i*WIDTH)+j</code> to be correct, is that the problem ?"}, {"owner": {"reputation": 1247, "user_id": 4284745, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-PPay30ot1_k/AAAAAAAAAAI/AAAAAAAAAFM/j7wqJ8SG30g/photo.jpg?sz=128", "display_name": "Dimitri Danilov", "link": "https://stackoverflow.com/users/4284745/dimitri-danilov"}, "reply_to_user": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1458768010, "post_id": 36188750, "comment_id": 60013070, "body": "@Jean-BaptisteYun&#232;s Maybe I have a problem with access too, but when I try to access the data in my last process the same way I did in the thread, it works fine."}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1458768067, "post_id": 36188750, "comment_id": 60013099, "body": "Concurrency, if you use thread may I suspect that the reader is concurrent with the writer?"}, {"owner": {"reputation": 1247, "user_id": 4284745, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-PPay30ot1_k/AAAAAAAAAAI/AAAAAAAAAFM/j7wqJ8SG30g/photo.jpg?sz=128", "display_name": "Dimitri Danilov", "link": "https://stackoverflow.com/users/4284745/dimitri-danilov"}, "reply_to_user": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1458768317, "post_id": 36188750, "comment_id": 60013219, "body": "Yes, they are running at the same time. First I create my shared memory with <code>shm_id = shmget(key, WIDTH * HEIGHT * sizeof(struct s_case), IPC_CREAT | SHM_R | SHM_W);</code> then i launch my thread. After that I launch all my processes that write the data."}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 2, "creation_date": 1458768847, "post_id": 36188750, "comment_id": 60013426, "body": "Then you cannot ensure that the writers finished before reader reads... It seems that you need to use some producer/consumer pattern."}, {"owner": {"reputation": 37256, "user_id": 736308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/o5EqQ.jpg?s=128&g=1", "display_name": "cdarke", "link": "https://stackoverflow.com/users/736308/cdarke"}, "edited": false, "score": 0, "creation_date": 1458773839, "post_id": 36188750, "comment_id": 60015491, "body": "You do know that you only need shared memory when sharing between processes?  For sharing between threads you can use any off-stack data area, like the heap (malloc).  You still need concurrency checks though."}, {"owner": {"reputation": 1247, "user_id": 4284745, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-PPay30ot1_k/AAAAAAAAAAI/AAAAAAAAAFM/j7wqJ8SG30g/photo.jpg?sz=128", "display_name": "Dimitri Danilov", "link": "https://stackoverflow.com/users/4284745/dimitri-danilov"}, "reply_to_user": {"reputation": 37256, "user_id": 736308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/o5EqQ.jpg?s=128&g=1", "display_name": "cdarke", "link": "https://stackoverflow.com/users/736308/cdarke"}, "edited": false, "score": 0, "creation_date": 1458775910, "post_id": 36188750, "comment_id": 60016250, "body": "@cdarke my goal is to get data from processes to my display thread."}, {"owner": {"reputation": 37256, "user_id": 736308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/o5EqQ.jpg?s=128&g=1", "display_name": "cdarke", "link": "https://stackoverflow.com/users/736308/cdarke"}, "edited": false, "score": 0, "creation_date": 1458808867, "post_id": 36188750, "comment_id": 60025777, "body": "@DimitriDanilov: in that case you will probably need to make sure that the processes are synchronised as well.  You will need to use a kernel object, probably semaphores (not all implementations of pthreads support cross-process mutexes).  Have you considered message queues instead?"}], "owner": {"reputation": 1247, "user_id": 4284745, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-PPay30ot1_k/AAAAAAAAAAI/AAAAAAAAAFM/j7wqJ8SG30g/photo.jpg?sz=128", "display_name": "Dimitri Danilov", "link": "https://stackoverflow.com/users/4284745/dimitri-danilov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1458767436, "creation_date": 1458767436, "question_id": 36188750, "link": "https://stackoverflow.com/questions/36188750/why-the-shared-memory-i-get-in-my-thread-is-not-good", "title": "Why the shared memory I get in my thread is not good?", "body": "<p>I have a thread that display some data I have on my shared memory </p>\n\n<pre><code>void *display_map(void *data)\n{\n  struct s_case *map;\n  int i;\n  int j;\n  int shm_id;\n\n  while (1)\n  {\n    i = 0;\n    shm_id = shmget(*(int *)data, WIDTH * HEIGHT * sizeof(struct s_case), SHM_R | SHM_W);\n    map = shmat(shm_id, NULL, SHM_W | SHM_R);\n    while (i &lt; HEIGHT)\n      {\n        j = 0;\n        while (j &lt; WIDTH)\n        {\n          printf(\"%d\", map[(i + 1) * j].nteam);\n          j++;\n        }\n        printf(\"\\n\");\n        i++;\n      }\n    printf(\"\\033[H\\033[J\");\n    usleep(10000);\n  }\n  pthread_exit(NULL);\n}\n</code></pre>\n\n<p>Problem is, the data is display is not complete, some informations are missing.\nWhen I print these informations in the last of my processes, all works fine.</p>\n\n<p><code>data</code> contains the key returned by <code>ftok</code></p>\n\n<p>Have an idea what I do wrong ? </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1458766302, "post_id": 36188318, "comment_id": 60012168, "body": "why do you have a while loop nested inside your for loop?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1458766449, "post_id": 36188318, "comment_id": 60012268, "body": "<code>scanf(&quot;%s&quot;)</code> reads one &#39;word&#39; at a time, separated by spaces.  Use <code>fgets()</code> to read a whole line, and then split it with <code>strtok()</code>.  You could help yourself by printing out what the computer reads immediately after reading it; this is the most basic form of debugging, but nonetheless extremely valuable; it would have told you what was going on (you enter 6 words for 2 users, so the loop to 5 is satisfied before the second number is read)."}], "answers": [{"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1458767397, "post_id": 36188486, "comment_id": 60012755, "body": "I would add <code>\\r\\n</code> to the separator string, if using <code>fgets</code>."}], "tags": [], "owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "is_accepted": false, "score": 0, "last_activity_date": 1458766450, "creation_date": 1458766450, "answer_id": 36188486, "question_id": 36188318, "link": "https://stackoverflow.com/questions/36188318/scanf-and-strtok-not-working-properly-for-me/36188486#36188486", "title": "scanf and strtok not working properly for me", "body": "<p>First off, use <code>fgets()</code> not <code>scanf()</code></p>\n\n<p>Next, you don't need the for <code>(j=0; j&lt;3; j++)</code> part, that's handled by <code>strtok</code>. Instead use the following:</p>\n\n<pre><code>token = strtok(tempArr, \" \");\nwhile (token != NULL) {\n    people[i][j] = *token;\n    printf(\"%s\\n\", token); // this is here to as a test case to see if my data was being stored.\n    token = strtok(NULL, \" \");\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1458788579, "post_id": 36188494, "comment_id": 60019616, "body": "Note that you should check the <code>scanf()</code> return value each time (make sure it is <code>1</code>), and <code>getchar()</code> will return EOF on EOF and that is not a newline, so that loop could run for a long time too.  Note that <code>strncpy()</code> does not guarantee null termination if the source string is too long for the target string.  You should detect EOF from <code>fgets()</code>.  Should you worry about the user only typing <code>Fred</code> where <code>Fred Bloggs 23</code> is expected?  The loop stops (which is good), but it doesn&#39;t report that data was missing, which might be better. This is much better, but there&#39;s still room for improvement."}, {"owner": {"reputation": 32921, "user_id": 5771269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be6a5b618f5bd197150a6186318beba7?s=128&d=identicon&r=PG&f=1", "display_name": "cdlane", "link": "https://stackoverflow.com/users/5771269/cdlane"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1458791818, "post_id": 36188494, "comment_id": 60020395, "body": "@JonathanLeffler, I agree that every result should be checked for errors -- even a simple program like this requires relentless attention to detail.  My goal was to get something that would actually run and allocate the memory it needed.  (It amazes me how it&#39;s possible to make such a serious memory allocation error in C and still get something that looks like it&#39;s close to working!  Sigh.)"}], "tags": [], "owner": {"reputation": 32921, "user_id": 5771269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be6a5b618f5bd197150a6186318beba7?s=128&d=identicon&r=PG&f=1", "display_name": "cdlane", "link": "https://stackoverflow.com/users/5771269/cdlane"}, "is_accepted": true, "score": 2, "last_activity_date": 1458787483, "last_edit_date": 1458787483, "creation_date": 1458766474, "answer_id": 36188494, "question_id": 36188318, "link": "https://stackoverflow.com/questions/36188318/scanf-and-strtok-not-working-properly-for-me/36188494#36188494", "title": "scanf and strtok not working properly for me", "body": "<p>One problem is you're using <code>scanf()</code> to read in the entire input line which has spaces between the first name, last name and grade:</p>\n\n<pre><code>for (i = 0; i &lt; numberPeople; i++) {\n    scanf(\"%s\", tempArr);\n}\n</code></pre>\n\n<p><code>scanf(\"%s\", tempArr)</code> quits reading as soon as it hits the first space.  For this loop you want to use <code>fgets()</code>:</p>\n\n<pre><code>for (i = 0; i &lt; numberPeople; i++) {\n    fgets(tempArr, 20, stdin);\n}\n</code></pre>\n\n<p>But as @Pooya notes, this string size is too small for what you're doing. Although you allocate the two dimensional array of students and information fields, you never allocate the string space to hold their names and grades:</p>\n\n<pre><code>char people[15][3]\n</code></pre>\n\n<p>If you're doing this on the stack, it becomes conceptually a third dimension:</p>\n\n<pre><code>char people[15][3][24]\n</code></pre>\n\n<p>After this <code>scanf()</code>, there's still a return character left in the buffer:</p>\n\n<pre><code>scanf(\"%d\", &amp;temp);\n</code></pre>\n\n<p>it probably should be cleared out.  @KevinDTimm and @bruceg hint at a problem here:</p>\n\n<pre><code>for (j = 0; j &lt; 3; j++) {\n    while (token != NULL) {\n        people[i][j] = *token;\n</code></pre>\n\n<p>But I don't think Kevin's suggestion accounts for the index j.  @Weather_Vane suggests adding <code>\\r\\n</code> to the <code>strtok()</code> separator string:</p>\n\n<pre><code>token = strtok(NULL, \" \")\n</code></pre>\n\n<p>Otherwise your grade string (last field) will have a dangling newline.  Also, you need to make a copy of the token returned by <code>strtok()</code>, you shouldn't store it directly.</p>\n\n<p>Putting all these suggestions together and cleaning/fixing anything else I ran into, I offer the following rework:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define MINIMUM_STUDENTS 5\n#define MAXIMUM_STUDENTS 15\n#define DATA_FIELDS 3\n\n#define MAXIMUM_LINE_LENGTH 100\n#define MAXIMUM_DATA_LENGTH 50\n\nint main(int argc, char **argv) {\n\n    int numberPeople;\n    char people[MAXIMUM_STUDENTS][DATA_FIELDS][MAXIMUM_DATA_LENGTH];\n\n    printf(\"Please indicate number of records you want to enter (min %d, max %d): \", MINIMUM_STUDENTS, MAXIMUM_STUDENTS);\n\n    scanf(\"%d\", &amp;numberPeople);\n\n    while ((numberPeople &lt; MINIMUM_STUDENTS) || (numberPeople &gt; MAXIMUM_STUDENTS)) {\n        printf(\"\\nNumber not in specified range, try again.\\n\");\n        printf(\"Please indicate number of records you want to enter (min %d, max %d): \", MINIMUM_STUDENTS, MAXIMUM_STUDENTS);\n        scanf(\"%d\", &amp;numberPeople);\n    }\n\n    printf(\"\\n\");\n\n    while ((getchar()) != '\\n'); // flush the return (and anything else) after the number input above\n\n    printf(\"Enter the first name, last name, and grade (put a space in between each): \\n\");\n\n    for (int i = 0; i &lt; numberPeople; i++) {\n        char tempArr[MAXIMUM_LINE_LENGTH];\n\n        fgets(tempArr, MAXIMUM_LINE_LENGTH, stdin);\n\n        char *token = strtok(tempArr, \" \");\n\n        for (int j = 0; j &lt; DATA_FIELDS &amp;&amp; token != NULL; j++) {\n            strncpy(people[i][j], token, MAXIMUM_DATA_LENGTH);\n\n            // this is here to as a test case to see if my data was being stored.\n            printf(\"%s\\n\", people[i][j]);\n\n            token = strtok(NULL, \" \\r\\n\");\n        }\n\n    }\n\n    // do what you need to do with the data here!\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5563, "user_id": 5808727, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a8de86a7bb2dbb67425971abc1e1cef8?s=128&d=identicon&r=PG&f=1", "display_name": "Pooya", "link": "https://stackoverflow.com/users/5808727/pooya"}, "is_accepted": false, "score": 0, "last_activity_date": 1458766592, "creation_date": 1458766592, "answer_id": 36188534, "question_id": 36188318, "link": "https://stackoverflow.com/questions/36188318/scanf-and-strtok-not-working-properly-for-me/36188534#36188534", "title": "scanf and strtok not working properly for me", "body": "<p>According to your sample, your input takes about <code>24</code> character but you defined <code>tempArr[20]</code>. because you overwrite something else in memory if you scan something more than <code>20</code> characters, it is better to have <code>tempArr[100]</code> or any number that makes sense for your tests.</p>\n"}], "owner": {"reputation": 115, "user_id": 4126220, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2eb4a7cc02ffe8b9a5f986051649307b?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4126220/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 434, "favorite_count": 0, "accepted_answer_id": 36188494, "answer_count": 3, "score": 0, "last_activity_date": 1458787483, "creation_date": 1458765720, "last_edit_date": 1458767673, "question_id": 36188318, "link": "https://stackoverflow.com/questions/36188318/scanf-and-strtok-not-working-properly-for-me", "title": "scanf and strtok not working properly for me", "body": "<p>I'm trying to write a small menu based program to maintain records.\nThe user inputs a number to be used for the total amount of people to be stored (first name, last name, score). User enters info all on one line, separated by spaces, and I split them up into 3 columns (first name, last name, score), then presses enter and continues to enter more info until the max people is hit.</p>\n\n<p>My problem being, when I run it, it doesn't work properly; it runs and accepts user input, but only for two students (even though I've been using numbers greater than 5 for test cases), then the program immediately ends (no error codes, just ends...) and it doesn't even make it to the menu. Can someone tell me what is wrong with my code?</p>\n\n<pre><code>int i, j, count, numberPeople, temp, choice;\nchar people[15][3], tempArr[20];\nchar *token;\n\nprintf(\"Please indicate number of records you want to enter (min 5, max 15): \");\nscanf(\"%d\", &amp;temp);\n\nwhile ((temp &gt; 15) || (temp &lt; 5)) {\n    printf(\"\\nNumber not in specified range, try again.\\n\");\n    printf(\"Please indicate number of records you want to enter (min 5, max 15): \");\n    scanf(\"%d\", &amp;temp);\n}\n\n\nnumberPeople = temp;\n\n\nprintf(\"\\nEnter the first name, last name, and grade (put a space in between each): \");\n    for (i = 0; i &lt; numberPeople; i++) {\n        fgets(tempArr, 20, stdin);\n\n    token = strtok(tempArr, \" \");\n\n    for (j = 0; j &lt; 3; j++) {\n        while (token != NULL) {\n            people[i][j] = *token;\n            printf(\"%s\\n\", token); // this is here to as a test case to see if my data was being stored.\n            token = strtok(NULL, \" \");\n        }\n    }\n\n}\n</code></pre>\n\n<p><strong>EDITED: changed scanf to fgets</strong></p>\n\n<p>OUTPUT </p>\n\n<pre><code>Please indicate number of records you want to enter (min 5, max 15): 5\n\nEnter the first name, last name, and grade (put a space in between each): firstname1 lastname1 85\nfirstname1\nlastname1\n85\n\nfirstname2 lastname2 84\nfirstname2\nlastname2\n\nProgram ended with exit code: 0\n</code></pre>\n"}, {"tags": ["c", "algorithm", "serialization", "arduino", "bit-manipulation"], "comments": [{"owner": {"reputation": 20558, "user_id": 2864275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p2xKk.png?s=128&g=1", "display_name": "I\u0142ya Bursov", "link": "https://stackoverflow.com/users/2864275/i%c5%82ya-bursov"}, "edited": false, "score": 0, "creation_date": 1458765433, "post_id": 36188155, "comment_id": 60011723, "body": "<code>i need to print that (64bit) number as Decimal on Serial port only. </code> why?"}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 2, "creation_date": 1458765929, "post_id": 36188155, "comment_id": 60011960, "body": "You are very confused. Bits are just bits. Send any of them in any order you like, as long as the guy on the other side knows, and he can reassemble them. A serial port by definition only sends one bit at a time, though most (including the Arduino&#39;s) have an 8-bit shift register so that you can send and receive 8 bits in software. But again, which ones you send and in which order are entirely up to you."}, {"owner": {"reputation": 1014, "user_id": 6047952, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a56a0a74a9848b8796170a9bce83e9fa?s=128&d=identicon&r=PG", "display_name": "infixed", "link": "https://stackoverflow.com/users/6047952/infixed"}, "edited": false, "score": 0, "creation_date": 1458766808, "post_id": 36188155, "comment_id": 60012461, "body": "Are you saying that <code>Serial.print(N)</code> does not work for N being a  <code>long long</code> 64 bit number?   If that is your problem, then splitting at a bit boundaries is not going to help.    That&#39;s equivalent to dividing and getting remainders of a power of 2.   To get decimal you need to think about powers of 10.  You may even be better off breaking your number into single digits and printing them one at a time."}, {"owner": {"reputation": 1014, "user_id": 6047952, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a56a0a74a9848b8796170a9bce83e9fa?s=128&d=identicon&r=PG", "display_name": "infixed", "link": "https://stackoverflow.com/users/6047952/infixed"}, "edited": false, "score": 0, "creation_date": 1458769226, "post_id": 36188155, "comment_id": 60013573, "body": "I think he&#39;s looking for something like this: <a href=\"http://forum.arduino.cc/index.php?topic=58697.msg422207#msg422207\" rel=\"nofollow noreferrer\">forum.arduino.cc/index.php?topic=58697.msg422207#msg422207</a> but I&#39;m not making it an answer until the question is clearer."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2073384"}, "reply_to_user": {"reputation": 1014, "user_id": 6047952, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a56a0a74a9848b8796170a9bce83e9fa?s=128&d=identicon&r=PG", "display_name": "infixed", "link": "https://stackoverflow.com/users/6047952/infixed"}, "edited": false, "score": 0, "creation_date": 1458773255, "post_id": 36188155, "comment_id": 60015293, "body": "@infixed i don&#39;t understand at which part of the topic you linked you refers. Please give me your solution and i tell you if is what i&#39;m searching for. thanks"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1458774493, "post_id": 36188155, "comment_id": 60015748, "body": "Will something like this work for you?  <code>uint64_t n = foo(); do { send (n%10 + &#39;0)&#39;; n &#47;= 10; ) while (n);</code>  Of course it sends the digits in reverse order, but that is easy to fix."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2073384"}, "reply_to_user": {"reputation": 20558, "user_id": 2864275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p2xKk.png?s=128&g=1", "display_name": "I\u0142ya Bursov", "link": "https://stackoverflow.com/users/2864275/i%c5%82ya-bursov"}, "edited": false, "score": 0, "creation_date": 1458782777, "post_id": 36188155, "comment_id": 60018154, "body": "@Lashane for check some eeproms data with the serial monitor on Arduino IDE"}, {"owner": {"reputation": 2356, "user_id": 2966337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b530afb5e73055843ece98a2dab90585?s=128&d=identicon&r=PG&f=1", "display_name": "Craig.Feied", "link": "https://stackoverflow.com/users/2966337/craig-feied"}, "edited": false, "score": 0, "creation_date": 1503266389, "post_id": 36188155, "comment_id": 78532047, "body": "The question is well-stated given an arduino context, and quite clear to those who are familiar with the arduino world. For folks who arrive here having the same issue: ignore all the comments, as they reflect a deep misunderstanding of the issue. The accepted answer is correct and solves the problem as a workaround for most cases.  Those who maintain the Arduino print libraries are well aware of this problem, but chose not to include support for printing 64 bit numbers because it makes sketches much, much larger."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2073384"}, "edited": false, "score": 0, "creation_date": 1458783987, "post_id": 36190693, "comment_id": 60018486, "body": "Thanks man, I&#39;m trying... Good solution but this need a fix because i&#39;m using streaming.h for serial output. Another problem is that it split the number in the wrong position. 100000 need to be changed in 1000000000L. So the formula for each buffer should be (uint32_t)(x/10000000000L) and (uint32_t)(x%10000000000L). char buffer is not needed. It can be outputted directly (at least with streaming.h module).  please can you change it? So i can use this as a solution. thanks"}, {"owner": {"reputation": 1014, "user_id": 6047952, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a56a0a74a9848b8796170a9bce83e9fa?s=128&d=identicon&r=PG", "display_name": "infixed", "link": "https://stackoverflow.com/users/6047952/infixed"}, "edited": false, "score": 0, "creation_date": 1458815006, "post_id": 36190693, "comment_id": 60029095, "body": "I do not have an arduino.  The character buffer is used with the sprintf call to give you the &#39;leading zero&#39; characters on the string for the remainder part.  Without that, te two strings will not read together right when the least significant part drops leading zeros"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2073384"}, "edited": false, "score": 0, "creation_date": 1458925031, "post_id": 36190693, "comment_id": 60079753, "body": "as you mentioned in your edited answer, the billion division do not resolve completely my problem (thanks for raise this,  I had not paid much attention), al least in theory isn&#39;t completly correct. But for some reason the output with this formula: MSBval = (uint32_t)(val / 10000000000LL); LSBval = (uint32_t)(val % 10000000000LL); Serial &lt;&lt; MSBval &lt;&lt; LSBval; give me the right results with 64bit higher numbers (like 255 255 255 255 255 255 255 255 [18446744073709551615] ). I&#39;m trying to investigate on it and searching for a better solution. thanks"}, {"owner": {"reputation": 1014, "user_id": 6047952, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a56a0a74a9848b8796170a9bce83e9fa?s=128&d=identicon&r=PG", "display_name": "infixed", "link": "https://stackoverflow.com/users/6047952/infixed"}, "edited": false, "score": 1, "creation_date": 1458927426, "post_id": 36190693, "comment_id": 60081009, "body": "So modulus 10 billion.  let N = 18446744073709551615.  MS part is 1844674407, LS remainder is 3709551615, which can fit in 32 bits.  But recall there will be numbers where the remainder is greater than 4294967296.   For instance, try your program with 18440000009000000000LL and see how it works."}, {"owner": {"reputation": 1014, "user_id": 6047952, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a56a0a74a9848b8796170a9bce83e9fa?s=128&d=identicon&r=PG", "display_name": "infixed", "link": "https://stackoverflow.com/users/6047952/infixed"}, "edited": false, "score": 1, "creation_date": 1458927639, "post_id": 36190693, "comment_id": 60081106, "body": "You may want to consider thinking smaller instead of larger.  Review the comment made by @chux on the question , and think about doing things mod 10.  10 is still a power of ten."}, {"owner": {"reputation": 1014, "user_id": 6047952, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a56a0a74a9848b8796170a9bce83e9fa?s=128&d=identicon&r=PG", "display_name": "infixed", "link": "https://stackoverflow.com/users/6047952/infixed"}, "edited": false, "score": 1, "creation_date": 1458928153, "post_id": 36190693, "comment_id": 60081380, "body": "I&#39;m going to try editing your question to see if they will take it off hold"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2073384"}, "edited": false, "score": 0, "creation_date": 1458929571, "post_id": 36190693, "comment_id": 60082038, "body": "I tested it and you have right. With 18440000009000000000LL it return a wrong number. I&#39;m testing for other algorithms and check the answer that you suggest. Thank you for what you&#39;re doing."}, {"owner": {"reputation": 1014, "user_id": 6047952, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a56a0a74a9848b8796170a9bce83e9fa?s=128&d=identicon&r=PG", "display_name": "infixed", "link": "https://stackoverflow.com/users/6047952/infixed"}, "edited": false, "score": 0, "creation_date": 1458930359, "post_id": 36190693, "comment_id": 60082428, "body": "Well, they took my edit of the question (they made some style changes).  But I don&#39;t know if you have to appeal somehow to get it off hold"}, {"owner": {"reputation": 1014, "user_id": 6047952, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a56a0a74a9848b8796170a9bce83e9fa?s=128&d=identicon&r=PG", "display_name": "infixed", "link": "https://stackoverflow.com/users/6047952/infixed"}, "edited": false, "score": 0, "creation_date": 1458952057, "post_id": 36190693, "comment_id": 60091471, "body": "@Tungsteno, sorry, got tired of waiting"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2073384"}, "edited": false, "score": 0, "creation_date": 1458954196, "post_id": 36190693, "comment_id": 60091961, "body": "oh, lol, we posted a solution at the same time! :D"}], "tags": [], "owner": {"reputation": 1014, "user_id": 6047952, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a56a0a74a9848b8796170a9bce83e9fa?s=128&d=identicon&r=PG", "display_name": "infixed", "link": "https://stackoverflow.com/users/6047952/infixed"}, "is_accepted": true, "score": 3, "last_activity_date": 1493046460, "last_edit_date": 1493046460, "creation_date": 1458775969, "answer_id": 36190693, "question_id": 36188155, "link": "https://stackoverflow.com/questions/36188155/how-do-i-output-a-64bit-number-on-arduino-if-its-libraries-have-32-bit-restricti/36190693#36190693", "title": "How do I output a 64bit number on Arduino if its libraries have 32 bit restrictions?", "body": "<p>The answer to the question really depends on what is receiving the data being sent by the Serial class.</p>\n\n<p>If it's human eyes reading, then you apparently are looking to actually print a decimal number.</p>\n\n<p>If you are trying to pass it to another program who will reassemble two or more messages into a 64bit number, that's a different problem.</p>\n\n<p>But if it's for a human to read, from the arduino forums comes this example sketch on how to print a <code>long long</code></p>\n\n<pre><code>long long x = 999999999999LL;  // note the double LL\n\nvoid setup()\n{\n  Serial.begin(115200);\n  Serial.println(\"I am Arduino\");\n  char buffer[100];\n  sprintf(buffer, \"%0ld\", x/1000000L);\n  Serial.print(buffer); \n  sprintf(buffer, \"%0ld\", x%1000000L);\n  Serial.println(buffer); \n}\n\nvoid loop() {}\n</code></pre>\n\n<p><a href=\"http://forum.arduino.cc/index.php?topic=58697.msg422207#msg422207\" rel=\"nofollow noreferrer\">http://forum.arduino.cc/index.php?topic=58697.msg422207#msg422207</a></p>\n\n<p>EDIT\nThe observation in the comments that the modulus of 1,000,000,000 (a billion) can be used instead of 1,000,000 (a million) to allow a larger range is correct. But since an unsigned 64 bit number can represent up to 18446744073709551615, that is still more than 18 times a billion squared.   So even a modulus of a billion isn't perfect, After dividing by a billion, the result will not fit into a 32 bit integer.  A billion billion can fit into a 60 bit number</p>\n\n<p>[ACADEMIC ANNEX because the question does not seem to be coming off hold ]</p>\n\n<p>Three ways it can be done, geared more to look how, rather than optimized\nThe third one is probably good enough to be a real answer</p>\n\n<pre><code>// Here is the totally unoptimized version to help you understand\n// the low level of what needs to be done.   Lots of leading zeros\n// because its easier that way.\n// no one would do it this way except to learn the basic idea\nvoid PrintNumberV1(unsigned long long num)\n{\n    Serial.print((unsigned)((num / 10000000000000000000LL) % 10));\n    Serial.print((unsigned)((num /  1000000000000000000LL) % 10));\n    Serial.print((unsigned)((num /   100000000000000000LL) % 10));\n    Serial.print((unsigned)((num /    10000000000000000LL) % 10));\n    Serial.print((unsigned)((num /     1000000000000000LL) % 10));\n    Serial.print((unsigned)((num /      100000000000000LL) % 10));\n    Serial.print((unsigned)((num /       10000000000000LL) % 10));\n    Serial.print((unsigned)((num /        1000000000000LL) % 10));\n    Serial.print((unsigned)((num /         100000000000LL) % 10));\n    Serial.print((unsigned)((num /          10000000000LL) % 10));\n    Serial.print((unsigned)((num /           1000000000LL) % 10));\n    Serial.print((unsigned)((num /            100000000LL) % 10));\n    Serial.print((unsigned)((num /             10000000LL) % 10));\n    Serial.print((unsigned)((num /              1000000LL) % 10));\n    Serial.print((unsigned)((num /               100000LL) % 10));\n    Serial.print((unsigned)((num /                10000LL) % 10));\n    Serial.print((unsigned)((num /                 1000LL) % 10));\n    Serial.print((unsigned)((num /                  100LL) % 10));\n    Serial.print((unsigned)((num /                   10LL) % 10));\n    Serial.print((unsigned)((num /                    1LL) % 10));\n}\n\n// This is the way they'll show you in CompSci 101 when they want to\n// to teach you about recursion, neglecting to mention how much stack\n// and time it takes.  No leading zeros, because it's easier that way\nvoid PrintNumberV2(unsigned long long num)\n{\n    int digit = num % 10;\n\n    // do any more significant digits\n    if (num &gt; 9) PrintNumberV2(num / 10);\n\n    // Print the digit this level of recursion has decided on\n    Serial.print(digit);\n}\n\n// The way a C programmer might do it if he didn't have printf right there\n// For extra fun you can use any base between 2 and 16\n// No leading zeros because its easier\nvoid PrintNumberV3(int base, unsigned long long num )\n{\n    const static char toAscii[] = \"0123456789ABCDEF\";\n\n    if ((base &lt; 2) || (base&gt;16))\n    {\n        Serial.print(\"[DON'T USE THAT BASE!!!]\");\n        return;\n    }\n\n    char buffer[65];            //because you might be doing binary\n    char* p = &amp;buffer[64];      //this pointer writes into the buffer, starting at the END\n\n    // zero to terminate a C type string\n    *p = 0;\n\n    // do digits until the number reaches zero\n    do\n    {\n        // working on the least significant digit\n        //put an ASCII digit at the front of the string\n        *(--p) = toAscii[(int)(num % base)];\n\n        //knock the least significant digit off the number\n        num = num / base;\n    } while (num != 0);\n\n    //print the whole string\n    Serial.print(s);\n}\n</code></pre>\n\n<p>Warning:  None of these have been tried on an actual Arduino</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2073384"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7785, "favorite_count": 0, "closed_date": 1458789611, "accepted_answer_id": 36190693, "answer_count": 1, "score": 2, "last_activity_date": 1493046460, "creation_date": 1458765141, "last_edit_date": 1492991937, "question_id": 36188155, "link": "https://stackoverflow.com/questions/36188155/how-do-i-output-a-64bit-number-on-arduino-if-its-libraries-have-32-bit-restricti", "closed_reason": "Needs details or clarity", "title": "How do I output a 64bit number on Arduino if its libraries have 32 bit restrictions?", "body": "<p>The compiler provided for Arduino seems to generate code that can work with 64 bit numbers, but the I/O classes, for instance <code>Serial.Print()</code>, seem to not work beyond 32 bit numbers.</p>\n\n<p>How can I overcome these limitations and print all possible 64 bit unsigned integers as decimal numbers?</p>\n\n<p>A bit of background:</p>\n\n<p>For an Arduino project I need to send a number on Serial that fits on a uint64_t variable type, but for some reason the Arduino Serial port can't handle a type bigger than 32 bit (but the device supports a 6-bit type).</p>\n\n<p>Thus, I need to print that (64-bit) number as Decimal on Serial port only. To do this I was thinking of dividing the number in two blocks of 32 bit each with a bitwise operation. Then send each number in sequence on the Serial port, but obviously the resulting number is different from the original 64-bit number.</p>\n\n<p>For example, I use an unsigned 8-bit number as follows:</p>\n\n<pre><code>11100010 &lt;- 226 in Decimal\n</code></pre>\n\n<p>And I need to send it to my serial port, but it can only handle 4-bit numbers at max.</p>\n\n<p>Thus I try to split the number in two parts with a bitwise mask:</p>\n\n<pre><code>1110 &lt;- MSBs (14 in Decimal)\n0010 &lt;- LSBs (2 in Decimal)\n</code></pre>\n\n<p>So when I send it in sequence on the Serial I see a 142, but instead what I would is 226.</p>\n\n<p>So, is there an algorithm that given a number as input, the returned result are two numbers that are the breakdown of the previous binary number in MSBs and LSBs?</p>\n\n<p>Appendix:</p>\n\n<p>I'm using streaming.h for serial communication.</p>\n\n<hr>\n\n<p>As properly guessed by @Infixed I'm trying to:</p>\n\n<blockquote>\n  <p>How do I print a 64 bit number in decimal given 32 bit integer\n  limitations on formatted decimal output?</p>\n</blockquote>\n\n<p>And up to now I found:</p>\n\n<pre><code>uint64_t val;\nuint32_t MSBval, LSBval;\nMSBval = (uint32_t)(val / 10000000000LL);\nLSBval = (uint32_t)(val % 10000000000LL);\nSerial &lt;&lt; F(\"[\") &lt;&lt; MSBval &lt;&lt; LSBval &lt;&lt; F(\"]\") &lt;&lt; endl;\n</code></pre>\n\n<p>As you can see I have not yet found the right solution. For higher numbers the formula should not work correctly, but for some reason (I'm still trying to figure out why) when I send the result on the Serial it returns the right number even with the highest number (255 255 255 255 255 255 255 255 [18446744073709551615]).</p>\n\n<hr>\n\n<p>Check the accepted answer for more solutions that do not relies on Streaming.h library.</p>\n\n<hr>\n\n<p><strong>THE SOLUTION</strong></p>\n\n<p>This solution is not very elegant, but at least works well for my purpose.\nIf desired, it can be generalized to be used with all types of integers (depends on your Arduino board microcontroller type).</p>\n\n<p>For now is tested only with <code>uint64_t</code> on Arduino Uno R3 (ATmega328P).</p>\n\n<p>Since it seems to be the only complete solution to solve this kind of problem that I was able to find on the web then, if anyone finds any bugs or like to improve it, feel free to reply to (or edit) this post.</p>\n\n<p>Here's the code:</p>\n\n<pre><code>uint8_t MLSBval;\nuint64_t val;\nchar buffer[11];\n\n//val = 18440000009000100000LL; // Test 64bit split\nval = 18440000009099999999LL;   // Test 64bit split\n\nsprintf(buffer, \"%010lu\", MLSBval); // Formatting zeros\nSerial &lt;&lt; F(\"[\") &lt;&lt; (uint32_t)(val / 10000000000LL); // Output MSBval\n\nval = val % 10000000000LL;                         // Calculate LSBval\nif (val != 0){\n    MLSBval = (uint8_t)(val / 100000000LL);\n    val = (val % 100000000LL);\n    sprintf(buffer, \"%02u\", MLSBval); // Formatting zeros\n    Serial &lt;&lt; buffer;\n}\nsprintf(buffer, \"%08lu\", (uint32_t)(val));    // Formatting zeros\nSerial &lt;&lt; (buffer) &lt;&lt; F(\"]\") &lt;&lt; endl;         // Data to Serial Monitor;\n</code></pre>\n\n<p>Then a little explanation:</p>\n\n<p>The biggest problem lies in the length of the decimal number. If the length of the number (e.g. 99 length is 2; 1294 length is 4; etc.) is odd we need to put the <code>if statement</code> code with the <code>MSBval</code> result and then use it in the serial.</p>\n\n<p>Conversely (as showed in the code), if the number is even we need to put the <code>if statement</code> code with the <code>LSBval</code> and then use the result.</p>\n\n<p>This applies to all types of integers.</p>\n\n<p>If you use another <code>int</code> type (32 bit, 16 bit, etc.) as a <code>val</code> type you need to change (reduce) the divider and module number in relation to the above example.</p>\n\n<p>In this case the numbers of zeros of the divider and module before the <code>if statement</code> corresponds to the half the length of the largest number that fit the uint64 type (in Decimal, then ten zeroes). Instead those contained inside the <code>if statement</code> have two zeros in less (eight zeroes).</p>\n\n<p>Obviously I have not tested the code with all the numbers involved, but I hope this work with all!</p>\n"}, {"tags": ["c", "linux", "x11"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1458818279, "post_id": 36188154, "comment_id": 60031085, "body": "That answer is of course not right."}], "answers": [{"tags": [], "owner": {"reputation": 42737, "user_id": 4518274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UPurS.png?s=128&g=1", "display_name": "Thomas Dickey", "link": "https://stackoverflow.com/users/4518274/thomas-dickey"}, "is_accepted": false, "score": 2, "last_activity_date": 1458767226, "last_edit_date": 1492086988, "creation_date": 1458767226, "answer_id": 36188688, "question_id": 36188154, "link": "https://stackoverflow.com/questions/36188154/get-x11-window-caption-height/36188688#36188688", "title": "Get X11 window caption height", "body": "<p><code>XGetWindowAttributes</code> returns a pointer to a <code>XWindowAttributes</code> structurex, which looks like this:</p>\n\n<pre><code>typedef struct {\n    int x, y;                   /* location of window */\n    int width, height;          /* width and height of window */\n    int border_width;           /* border width of window */\n    int depth;                  /* depth of window */\n    Visual *visual;             /* the associated visual structure */\n    Window root;                /* root of screen containing window */\n#if defined(__cplusplus) || defined(c_plusplus)\n    int c_class;                /* C++ InputOutput, InputOnly*/\n#else\n    int class;                  /* InputOutput, InputOnly*/\n#endif\n    int bit_gravity;            /* one of bit gravity values */\n    int win_gravity;            /* one of the window gravity values */\n    int backing_store;          /* NotUseful, WhenMapped, Always */\n    unsigned long backing_planes;/* planes to be preserved if possible */\n    unsigned long backing_pixel;/* value to be used when restoring planes */\n    Bool save_under;            /* boolean, should bits under be saved? */\n    Colormap colormap;          /* color map to be associated with window */\n    Bool map_installed;         /* boolean, is color map currently installed*/\n    int map_state;              /* IsUnmapped, IsUnviewable, IsViewable */\n    long all_event_masks;       /* set of events all people have interest in*/\n    long your_event_mask;       /* my event mask */\n    long do_not_propagate_mask; /* set of events that should not propagate */\n    Bool override_redirect;     /* boolean value for override-redirect */\n    Screen *screen;             /* back pointer to correct screen */\n} XWindowAttributes;\n</code></pre>\n\n<p>The only interesting parts are at the beginning, giving the position and size of the widget's window. The <em>title</em> is not part of that window.  It is managed by the window manager, and is part of what is called \"decoration\".</p>\n\n<p>Further reading:</p>\n\n<ul>\n<li><a href=\"http://lesstif.sourceforge.net/doc/super-ux/g1ae03e/part1/chap4.html\" rel=\"nofollow noreferrer\">Shell Widgets </a></li>\n<li><a href=\"https://unix.stackexchange.com/questions/77198/launch-an-application-with-window-decorator-hints-x-y-coordinates-size-etc\">Launch an application with window decorator hints, x/y coordinates, size, etc</a></li>\n<li><a href=\"https://unix.stackexchange.com/questions/14159/how-do-i-find-the-window-dimensions-and-position-accurately-including-decoration\">How do I find the window dimensions and position accurately including decorations?</a></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 22804, "user_id": 705115, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/212db408fb84ef88b9d5c6b543076c1d?s=128&d=identicon&r=PG", "display_name": "Andrey Sidorov", "link": "https://stackoverflow.com/users/705115/andrey-sidorov"}, "is_accepted": true, "score": 1, "last_activity_date": 1589717465, "last_edit_date": 1589717465, "creation_date": 1458779962, "answer_id": 36191294, "question_id": 36188154, "link": "https://stackoverflow.com/questions/36188154/get-x11-window-caption-height/36191294#36191294", "title": "Get X11 window caption height", "body": "<p>The answers depends really on the window managers used, but most of the WMs reparent target windows to be child of a frame, so the algorithm would be:</p>\n\n<ul>\n<li>walk to parent windows until you reach root. The one before root is likely frame</li>\n<li>compare your target window rectangle with frame rectangle. Frame top minus target top would give you caption height</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 22043, "user_id": 87973, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/abc7768058e25c1382df18414db72a10?s=128&d=identicon&r=PG", "display_name": "Jonas Bystr&#246;m", "link": "https://stackoverflow.com/users/87973/jonas-bystr%c3%b6m"}, "edited": false, "score": 0, "creation_date": 1458846587, "post_id": 36198958, "comment_id": 60049716, "body": "I&#39;m a total X11 n00b, and would greatly appreciate a minimal (pseudo?) code sample, thank you!"}], "tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": false, "score": 3, "last_activity_date": 1458850586, "last_edit_date": 1458850586, "creation_date": 1458818467, "answer_id": 36198958, "question_id": 36188154, "link": "https://stackoverflow.com/questions/36188154/get-x11-window-caption-height/36198958#36198958", "title": "Get X11 window caption height", "body": "<p>Modern window managers abide by <a href=\"https://specifications.freedesktop.org/wm-spec/wm-spec-latest.html#idm140200472552416\" rel=\"nofollow\">Extended Window Manager Hints</a> specifications, so you just need to check the <code>_NET_FRAME_EXTENTS</code> property. </p>\n\n<pre><code>#include &lt;X11/Xlib.h&gt;\n#include &lt;stdio.h&gt;\n\nint main ()\n{\n    Display* d;\n    Window w, root;\n    Atom a, t;\n    int s;\n    long fg, bg;\n    int f;\n    unsigned long n, b;\n    unsigned char *data = 0;\n    long* extents;\n    XEvent e;\n\n    d = XOpenDisplay(0);\n    s = DefaultScreen(d);\n    root = DefaultRootWindow(d);\n    fg = BlackPixel(d, s);\n    bg = WhitePixel(d, s);\n    w = XCreateSimpleWindow(d, root, 0, 0, 200, 200, 0, fg, bg);\n    XSelectInput(d, w, ExposureMask|ButtonPressMask|KeyPressMask|PropertyChangeMask);\n\n    XMapWindow(d,w);\n\n    a = XInternAtom(d, \"_NET_FRAME_EXTENTS\", True); /* Property to check */\n\n    /* Window manager doesn't set up the extents immediately */\n    /* Wait until they are set up and there are 4 of them */\n    while (XGetWindowProperty(d, w, a,\n                   0, 4, False, AnyPropertyType,\n                   &amp;t, &amp;f,\n                   &amp;n, &amp;b, &amp;data) != Success || n != 4 || b != 0) \n    {\n        printf (\"Waiting for extents\\n\");\n        XNextEvent(d, &amp;e);\n    }\n\n    /* OK got extents */\n    extents = (long*) data;\n    printf (\"Got frame extents: left %ld right %ld top %ld bottom %ld\\n\",\n            extents[0], extents[1], extents[2], extents[3]);\n\n    return 0;\n}\n</code></pre>\n\n<p>If you are using a less modern WM, you are on your own. Try walking up the window tree as suggested in Andrey's answer. This is likely to work, but it's not guaranteed. Some window managers don't use separate \"frame\" windows at all (e.g. they can draw all frames on a single window in an overlay visual).</p>\n"}], "owner": {"reputation": 22043, "user_id": 87973, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/abc7768058e25c1382df18414db72a10?s=128&d=identicon&r=PG", "display_name": "Jonas Bystr&#246;m", "link": "https://stackoverflow.com/users/87973/jonas-bystr%c3%b6m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1179, "favorite_count": 0, "accepted_answer_id": 36191294, "answer_count": 3, "score": 0, "last_activity_date": 1589717465, "creation_date": 1458765136, "last_edit_date": 1495539997, "question_id": 36188154, "link": "https://stackoverflow.com/questions/36188154/get-x11-window-caption-height", "title": "Get X11 window caption height", "body": "<p>How can I get the title/caption height of a window in X11? I'm using the following to get the border thickness:</p>\n\n<pre><code>XWindowAttributes wndattr;\n::XGetWindowAttributes(display, wnd, &amp;wndattr)\n... = lWndAttr-&gt;border_width;\n</code></pre>\n\n<p>I can't seem to find anything as straight-forward for the title bar. (<a href=\"https://stackoverflow.com/questions/19822935/x11-getting-title-bar-size#19823049\">This</a> answer seems to imply I need to go through a font, but that can't be right, right?)</p>\n"}, {"tags": ["c", "lseek"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1458764645, "post_id": 36187975, "comment_id": 60011249, "body": "Posting the text rather than a picture of text is more useful (cut/paste, searching)"}, {"owner": {"reputation": 20558, "user_id": 2864275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p2xKk.png?s=128&g=1", "display_name": "I\u0142ya Bursov", "link": "https://stackoverflow.com/users/2864275/i%c5%82ya-bursov"}, "edited": false, "score": 0, "creation_date": 1458764653, "post_id": 36187975, "comment_id": 60011256, "body": "<a href=\"http://stackoverflow.com/questions/36185820/lseek-doesnt-do-what-its-supposed\" title=\"lseek doesnt do what its supposed\">stackoverflow.com/questions/36185820/&hellip;</a>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1458764807, "post_id": 36187975, "comment_id": 60011345, "body": "A question is required to have the code <b>in</b> the question itself!"}, {"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "reply_to_user": {"reputation": 20558, "user_id": 2864275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p2xKk.png?s=128&g=1", "display_name": "I\u0142ya Bursov", "link": "https://stackoverflow.com/users/2864275/i%c5%82ya-bursov"}, "edited": false, "score": 0, "creation_date": 1458764813, "post_id": 36187975, "comment_id": 60011347, "body": "@Lashane - I remembered this one too, but he described it better here"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 20558, "user_id": 2864275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p2xKk.png?s=128&g=1", "display_name": "I\u0142ya Bursov", "link": "https://stackoverflow.com/users/2864275/i%c5%82ya-bursov"}, "edited": false, "score": 0, "creation_date": 1458764861, "post_id": 36187975, "comment_id": 60011375, "body": "@Lashane: The question is apparently deleted, so no one with rep &lt;10k can see it."}, {"owner": {"reputation": 249, "user_id": 5155992, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/df62819614c9e65173472e5171246027?s=128&d=identicon&r=PG&f=1", "display_name": "C&#233;sar Pereira", "link": "https://stackoverflow.com/users/5155992/c%c3%a9sar-pereira"}, "edited": false, "score": 0, "creation_date": 1458765120, "post_id": 36187975, "comment_id": 60011524, "body": "It&#39;s a different example.. I deleted the other because i actually solved it right away. Sorry for that..  I now am having trouble doing this problem now"}, {"owner": {"reputation": 249, "user_id": 5155992, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/df62819614c9e65173472e5171246027?s=128&d=identicon&r=PG&f=1", "display_name": "C&#233;sar Pereira", "link": "https://stackoverflow.com/users/5155992/c%c3%a9sar-pereira"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458765327, "post_id": 36187975, "comment_id": 60011650, "body": "@Olaf already posted the code, srry"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458766842, "post_id": 36187975, "comment_id": 60012474, "body": "Don&#39;t delete a question once you have the answer unless it is rubbish! There Q&amp;A might help other users. And if you did not get the answer, don&#39;t re-post."}, {"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 0, "creation_date": 1459170793, "post_id": 36187975, "comment_id": 60154175, "body": "Please reopen.  This question fulfills ALL of the requirements ; desired behavior &amp; an MVC are all present.  I honestly think this was ninja closed because the OP originally had a picture rather than the code which he fixed immediately."}], "answers": [{"comments": [{"owner": {"reputation": 249, "user_id": 5155992, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/df62819614c9e65173472e5171246027?s=128&d=identicon&r=PG&f=1", "display_name": "C&#233;sar Pereira", "link": "https://stackoverflow.com/users/5155992/c%c3%a9sar-pereira"}, "edited": false, "score": 0, "creation_date": 1458765591, "post_id": 36188017, "comment_id": 60011816, "body": "I still don&#39;t have the skill to really understand what&#39;s going on.. I following examples and trying to do it."}, {"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "reply_to_user": {"reputation": 249, "user_id": 5155992, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/df62819614c9e65173472e5171246027?s=128&d=identicon&r=PG&f=1", "display_name": "C&#233;sar Pereira", "link": "https://stackoverflow.com/users/5155992/c%c3%a9sar-pereira"}, "edited": false, "score": 0, "creation_date": 1458765898, "post_id": 36188017, "comment_id": 60011947, "body": "read the end of my answer (the <code>code</code> part)"}, {"owner": {"reputation": 249, "user_id": 5155992, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/df62819614c9e65173472e5171246027?s=128&d=identicon&r=PG&f=1", "display_name": "C&#233;sar Pereira", "link": "https://stackoverflow.com/users/5155992/c%c3%a9sar-pereira"}, "edited": false, "score": 0, "creation_date": 1458766508, "post_id": 36188017, "comment_id": 60012308, "body": "Oh ok, i&#39;m following.. So how can i read all the file?"}, {"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "reply_to_user": {"reputation": 249, "user_id": 5155992, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/df62819614c9e65173472e5171246027?s=128&d=identicon&r=PG&f=1", "display_name": "C&#233;sar Pereira", "link": "https://stackoverflow.com/users/5155992/c%c3%a9sar-pereira"}, "edited": false, "score": 0, "creation_date": 1458766878, "post_id": 36188017, "comment_id": 60012493, "body": "You have to position the cursor before each read and write.  Look at what I wrote and ascertain what seeks will be necessary to be positioned correctly for what you want to do."}], "tags": [], "owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "is_accepted": true, "score": 0, "last_activity_date": 1458765873, "last_edit_date": 1458765873, "creation_date": 1458764643, "answer_id": 36188017, "question_id": 36187975, "link": "https://stackoverflow.com/questions/36187975/trouble-working-with-file-using-lseek-read-and-write/36188017#36188017", "title": "Trouble working with file using lseek() read() and write()", "body": "<p>You read a byte and then write a byte without repositioning the offset within the file.  Then you seek backwards 2 positions.</p>\n\n<p>Write down what you're doing on a piece of paper to understand what's wrong.</p>\n\n<p>P.S. That last line - you should do that for everything you write from now until you don't write code anymore ;)</p>\n\n<pre><code>you seek to EOF - 1, you're before the last byte in the file.  \nyou read a byte, you're now at EOF.  \nThen you write a byte (you've extended the file by one), you're positioned again @ EOF.  \nyou now seek backwards 2 bytes, which puts you back to where you began.  \n</code></pre>\n"}], "owner": {"reputation": 249, "user_id": 5155992, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/df62819614c9e65173472e5171246027?s=128&d=identicon&r=PG&f=1", "display_name": "C&#233;sar Pereira", "link": "https://stackoverflow.com/users/5155992/c%c3%a9sar-pereira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1463, "favorite_count": 0, "closed_date": 1458788475, "accepted_answer_id": 36188017, "answer_count": 1, "score": -1, "last_activity_date": 1458765873, "creation_date": 1458764475, "last_edit_date": 1458765301, "question_id": 36187975, "link": "https://stackoverflow.com/questions/36187975/trouble-working-with-file-using-lseek-read-and-write", "closed_reason": "Not suitable for this site", "title": "Trouble working with file using lseek() read() and write()", "body": "<p>i'm working on C in my university, i'm at the beggining working with buffers and this function so apolagize my lack of knowledge that i might show.\nI gotta do this project using lseek(), write() and read(). I wanted to read a file, and every letter 'a' that i find i would change it to '?'. My code so far is:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;fcntl.h&gt;\n\nint main () {\n  int fd = open(\"problema4file\", O_RDWR);\n  int fptr = lseek(fd, (off_t)(-1), SEEK_END);\n  char buffer;\n  while(fptr!=-1){\n    read(fd, &amp;buffer, 1);\n    char changeTo = '?';\n    if(buffer == 'a'){\n       write(fd, &amp;changeTo,1);\n    }\n    fptr=lseek(fd, (off_t)(-2), SEEK_CUR);\n  }\n  close(fd);\n}\n</code></pre>\n\n<p>But this changed the first 'a' (last, because i start from the end) and no more. It stops changing. Oh and it doesn't change the 'a', changes the letter after, but that has to do with the buffer movements right? i might think about that later.. I just wanted to know why this doesn't read all the file and changes everything, it stops in the first finding.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458762975, "post_id": 36187504, "comment_id": 60010292, "body": "<a href=\"http://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">why-is-while-feof-file-always-wrong</a>. And &quot;I&#39;m having some trouble doing this&quot; is not really <i>*specific</i>. See <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1458763131, "post_id": 36187504, "comment_id": 60010381, "body": "<code>fscanf</code> returns <i>the number of items successfully scanned</i>, not the scanned value. <code>if(fscanf(file, &quot;%d&quot;, &amp;pID[i]) != 1) exit(1);</code>"}, {"owner": {"reputation": 3, "user_id": 6106212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71bd168707c8ea73eff9f25afd97b3f1?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gonzales", "link": "https://stackoverflow.com/users/6106212/christian-gonzales"}, "edited": false, "score": 0, "creation_date": 1458763164, "post_id": 36187504, "comment_id": 60010400, "body": "Sorry, the values that are put into the arrays are no where near what is from the file.  Thanks for the article. If !feof(file) is incorrect, what is the correct way to loop through each line of the file?"}, {"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 0, "creation_date": 1458765099, "post_id": 36187504, "comment_id": 60011509, "body": "Please read the post"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1458771197, "post_id": 36187504, "comment_id": 60014483, "body": "Note that for interactive inputs, a trailing blank in a format string is a disaster; the <code>scanf()</code> operation won&#39;t return until the user types a non-blank (tab, newline) character after the end of the relevant data.  That means they have to predict what you&#39;re going to request next \u2014 not good."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6106212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71bd168707c8ea73eff9f25afd97b3f1?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gonzales", "link": "https://stackoverflow.com/users/6106212/christian-gonzales"}, "edited": false, "score": 0, "creation_date": 1458764439, "post_id": 36187871, "comment_id": 60011130, "body": "Thank you so much! This solved my problem, everything is being read in how it should be."}, {"owner": {"reputation": 3, "user_id": 6106212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71bd168707c8ea73eff9f25afd97b3f1?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gonzales", "link": "https://stackoverflow.com/users/6106212/christian-gonzales"}, "edited": false, "score": 0, "creation_date": 1458764675, "post_id": 36187871, "comment_id": 60011268, "body": "So the sscanf line is checking to make sure there are four values in each line of the file, while also putting the respective values in the arrays?  Sorry I keep asking so many questions, I&#39;m just trying to fully understand how this solved my problem."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 3, "user_id": 6106212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71bd168707c8ea73eff9f25afd97b3f1?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gonzales", "link": "https://stackoverflow.com/users/6106212/christian-gonzales"}, "edited": false, "score": 0, "creation_date": 1458766517, "post_id": 36187871, "comment_id": 60012311, "body": "Yes, that is correct. It is always a good idea to check whatever you can check: assume nothing for robust code, especially when the input source may not be within your control. Although note: this would simply ignore any other data in that text line if there were more than 4 numbers, but it <i>would</i> trap anything that wasn&#39;t a number."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1458775603, "post_id": 36187871, "comment_id": 60016134, "body": "For ditching <code>fscanf()</code> and embracing <code>fgets()</code> when data is per <i>line</i> --&gt; upvote."}], "tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": true, "score": 1, "last_activity_date": 1458764083, "creation_date": 1458764083, "answer_id": 36187871, "question_id": 36187504, "link": "https://stackoverflow.com/questions/36187504/reading-an-int-from-a-text-file-into-an-array-in-c/36187871#36187871", "title": "Reading an int from a text file into an array in C", "body": "<p>You are using <code>feof</code> and <code>fscanf</code> in the wrong way. I suggest you read one line from file at a time, checking it was read, and then scanning the values from the buffer, also checking that the array index is still ok, and the correct number of fields were scanned.</p>\n\n<pre><code>void readFile(int n, int pID[], int arrival[], int bursts[], int priority[]) {\n    FILE *file;\n    int i = 0;\n    char buffer[100];\n    file = fopen(\"Process.txt\", \"r\");\n    if (file){\n        while (i &lt; n &amp;&amp; fgets(buffer, sizeof buffer, file) != NULL) {\n            if(sscanf(buffer, \"%d%d%d%d\", &amp;pID[i], &amp;arrival[i], &amp;bursts[i], &amp;priority[i]) != 4) {\n                exit(1);                // or recovery strategy\n            }\n            i++;\n        }\n        fclose(file);\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6106212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71bd168707c8ea73eff9f25afd97b3f1?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gonzales", "link": "https://stackoverflow.com/users/6106212/christian-gonzales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 410, "favorite_count": 0, "closed_date": 1458789889, "accepted_answer_id": 36187871, "answer_count": 1, "score": -1, "last_activity_date": 1458764090, "creation_date": 1458762868, "question_id": 36187504, "link": "https://stackoverflow.com/questions/36187504/reading-an-int-from-a-text-file-into-an-array-in-c", "closed_reason": "Not suitable for this site", "title": "Reading an int from a text file into an array in C", "body": "<p>I've got a text file formatted like this:</p>\n\n<pre><code>100 0 10 1\n101 6 10 1\n102 8 4 1\n103 12 20 1\n104 19 15 1\n105 30 5 1\n106 35 10 1\n</code></pre>\n\n<p>I need to put these numbers into the arrays pID[], arrival[], bursts[], and priority[], respectively.  C is not my strongest language, so I'm having some trouble doing this.</p>\n\n<p>Here's my current code:</p>\n\n<pre><code>void readFile(int n, int pID[], int arrival[], int bursts[], int priority[]){\nFILE *file;\nint i = 0;\nfile = fopen(\"Process.txt\", \"r\");\n\n//File format is pID, arrival, bursts, and priority\nif (file){\n    while (!feof(file)){\n        pID[i] = fscanf(file, \"%d \", &amp;i);\n        arrival[i] = fscanf(file, \"%d \", &amp;i);\n        bursts[i] = fscanf(file, \"%d \", &amp;i);\n        priority[i] = fscanf(file, \"%d \", &amp;i);\n    }\n    fclose(file);\n}\n</code></pre>\n\n<p>Thanks for any help!</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 339644, "user_id": 118068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077db5466d3b58e7bbbd498dca173f04?s=128&d=identicon&r=PG", "display_name": "Marc B", "link": "https://stackoverflow.com/users/118068/marc-b"}, "edited": false, "score": 0, "creation_date": 1458762601, "post_id": 36187421, "comment_id": 60010078, "body": "<code>+</code> is not a number, so <code>%d</code> in your scanf is not going to recognize it."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 2, "creation_date": 1458762713, "post_id": 36187421, "comment_id": 60010148, "body": "<i>the program never enters this loop</i>. Print <code>opC</code> as an integer, <code>printf(&quot;%d&quot;, opC);</code> and check whether you get <code>43</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1458762734, "post_id": 36187421, "comment_id": 60010159, "body": "If that code is in a loop, you need a space <i>before</i> the format specifier, as in <code>scanf(&quot; %c%d&quot;,&amp;opC, &amp;opN);</code> not <i>after</i> it, to remove the <code>newline</code> following the previous <code>%d</code> format entry."}, {"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 2, "creation_date": 1458763341, "post_id": 36187421, "comment_id": 60010512, "body": "To make this easier for yourself you should use character literals instead of numbers. i.e. <code>&#39;+&#39;</code> instead of <code>43</code>."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 3, "creation_date": 1458763436, "post_id": 36187421, "comment_id": 60010565, "body": "That&#39;s not a loop."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1458765537, "post_id": 36187421, "comment_id": 60011783, "body": "Certainly <a href=\"http://stackoverflow.com/questions/36187421/problems-getting-recognized-as-in-a-if-comparison#comment60010159_36187421\">@Weather Vane</a> has IDed the problem."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1458766646, "post_id": 36187421, "comment_id": 60012378, "body": "Is it just me, or would millions of hours of beginning C programmer&#39;s time (not to mention those of us trying to help them) be saved if only standard C had some decent higher-level input methods, other than lame old <code>scanf</code>?"}, {"owner": {"reputation": 9, "user_id": 4730561, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HwsJ7x6JlC8/AAAAAAAAAAI/AAAAAAAAAC0/9TXWfERYDK4/photo.jpg?sz=128", "display_name": "Orange Lash", "link": "https://stackoverflow.com/users/4730561/orange-lash"}, "edited": false, "score": 0, "creation_date": 1458766802, "post_id": 36187421, "comment_id": 60012457, "body": "yes, that would be wonderfull Steve. But i dont understand why putting the whitespace before the %c fixes the problem but the getchar(); does not. Dont they both clear the input buffer?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1458766868, "post_id": 36187421, "comment_id": 60012483, "body": "@SteveSummit or even decent lowlevel ones. Coming originally from Borland Turbo C to MSVC, there was unbuffered character input available, with or without echo, that didn&#39;t require <code>enter</code> to be pressed, and I think that&#39;s a terrible oversight in standard C, which requires faffing around with OS, I think, to achieve what ought to be perfectly simple."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1458766936, "post_id": 36187421, "comment_id": 60012512, "body": "@OrangeLash the <code>%d</code> and <code>%s</code> etc format specifiers consume leading whitespace automatically, but <code>%c</code> does not, because you might actually want to enter a space character. Note that <code>getchar</code> does not clear the input buffer: the same thing would happen using <code>getchar</code> after a <code>%d</code> scanf - the <code>enter</code> remaining in the buffer would be read. It&#39;s horrible."}, {"owner": {"reputation": 9, "user_id": 4730561, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HwsJ7x6JlC8/AAAAAAAAAAI/AAAAAAAAAC0/9TXWfERYDK4/photo.jpg?sz=128", "display_name": "Orange Lash", "link": "https://stackoverflow.com/users/4730561/orange-lash"}, "edited": false, "score": 0, "creation_date": 1458767153, "post_id": 36187421, "comment_id": 60012625, "body": "So using the getchar() i was actually consuming more stuff than i should?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1458767196, "post_id": 36187421, "comment_id": 60012647, "body": "@OrangeLash <code>getchar</code> takes the next input from the input buffer, if any. If none, it waits until there is."}], "answers": [{"tags": [], "owner": {"reputation": 2093, "user_id": 3153883, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/xVr3z.jpg?s=128&g=1", "display_name": "LawfulEvil", "link": "https://stackoverflow.com/users/3153883/lawfulevil"}, "is_accepted": false, "score": 1, "last_activity_date": 1458764633, "creation_date": 1458764633, "answer_id": 36188015, "question_id": 36187421, "link": "https://stackoverflow.com/questions/36187421/problems-getting-recognized-as-in-a-if-comparison/36188015#36188015", "title": "Problems getting + recognized as &#39;+&#39; in a if comparison", "body": "<p>When I run this with input of :</p>\n\n<pre><code>+ 7\n</code></pre>\n\n<p>With a carriage return after the 7.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) {\n    char opC;\n    int opN;\n\n    scanf(\"%c %d\\n\", &amp;opC, &amp;opN); /* you are reading + and a number */\n\n    switch(opC) {\n\n    case('+'):  /* 43 works fine too */\n        printf(\"Here %d\\n\", opN); \n        break;\n    }\n    printf(\"Done\\n\");\n    return 0;\n}\n</code></pre>\n\n<p>I get :</p>\n\n<pre><code>Here 7\nDone\n</code></pre>\n\n<p>I'm guessing the basic problem is that you are trying to provide + without the second parameter that scanf is looking for, so it hangs wait for more input.</p>\n"}], "owner": {"reputation": 9, "user_id": 4730561, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HwsJ7x6JlC8/AAAAAAAAAAI/AAAAAAAAAC0/9TXWfERYDK4/photo.jpg?sz=128", "display_name": "Orange Lash", "link": "https://stackoverflow.com/users/4730561/orange-lash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "closed_date": 1458765036, "answer_count": 1, "score": -1, "last_activity_date": 1458766706, "creation_date": 1458762528, "last_edit_date": 1458766706, "question_id": 36187421, "link": "https://stackoverflow.com/questions/36187421/problems-getting-recognized-as-in-a-if-comparison", "closed_reason": "Not suitable for this site", "title": "Problems getting + recognized as &#39;+&#39; in a if comparison", "body": "<p>im having problems with the following code and i have no idea why this is happening, so i would appreciate some help.</p>\n\n<p>The problem is the following: I have to read two variables, a char and an int, to operate in a file. When I input one of those (a '+'), the program does not recognize it as the actual symbol of '+', but as something else and the program never enters the desired if. But if I alter the if to recognize another char (like 'a') the program works fine. I have tried to solve it in two ways: one was to use ('+') and the other was to use the ASCII code (43). Neither of them worked.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>char opC;\nprintf(\"%c\",43); //this test ensures that 43 is recognized as '+'\n\nscanf(\"%c %d\",&amp;opC, &amp;opN);\n\nswitch(opC) {\n\ncase(43): lseek(fd,opN,SEEK_CUR); break; //the program never enters this loop\n</code></pre>\n\n<p>So my copy paste was incomplete, this code is indeed in a while loop. </p>\n\n<pre><code>while(end!=SIM) {\nscanf(\" %c %d\",&amp;opC, &amp;opN);\n\nswitch(opC) {\n    case('+'): lseek(fd,opN,SEEK_CUR); break;\n    case('-'): lseek(fd,-opN,SEEK_CUR); break;\n    case('i'): lseek(fd,opN,SEEK_SET); break;\n    case('f'): lseek(fd,-opN,SEEK_END); break;\n    case('r'): read(fd,aux,opN); strcat(out,aux); break;\n    case('s'): if(opN==0) end=SIM; break;\n\n}      \n}\n</code></pre>\n\n<p>I had tried to put a getchar(); as the starting instruction on the loop but then the output was wrong. </p>\n\n<p>What solved the issue was adding the whitespace before the %c, making the code run smoothly. Thank you.</p>\n"}, {"tags": ["c", "windows"], "comments": [{"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1458762857, "post_id": 36187320, "comment_id": 60010224, "body": "Nothing very magical, it knows which one is appropriate from the symbols in your obj file(s).  If it sees _wmain then it knows that wmainCRTStartup is best choice."}], "answers": [{"tags": [], "owner": {"reputation": 71, "user_id": 3810610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aff9e290123ee30dfe843be1c1a8b08?s=128&d=identicon&r=PG&f=1", "display_name": "toejam", "link": "https://stackoverflow.com/users/3810610/toejam"}, "is_accepted": true, "score": 3, "last_activity_date": 1500668889, "creation_date": 1500668889, "answer_id": 45246224, "question_id": 36187320, "link": "https://stackoverflow.com/questions/36187320/maincrtstartup-vs-wmaincrtstartup/45246224#45246224", "title": "mainCRTStartup vs wmainCRTStartup", "body": "<p>The linker will attempt to infer which entry point routine is needed by walking the symbol table of your objs.  It searches for _wmain before _main, which is why the former was selected even though you have both.  The linker then pulls the appropriate startup routine from your default libc static library.</p>\n\n<p>You can override much of this by supplying the /ENTRY, /DEFAULTLIB, and /NODEFAULTLIB options to your linker.  But normally, you let the linker handle this automatically.  </p>\n\n<p>Also, you should only have one main C function in your program.  Either explicitly define one or the other, or go the TCHAR route and let your compiler replace _tmain() with either the main() or wmain() depending on if UNICODE is defined.</p>\n"}], "owner": {"reputation": 2091, "user_id": 158474, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aH7rO.jpg?s=128&g=1", "display_name": "cuteCAT", "link": "https://stackoverflow.com/users/158474/cutecat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 890, "favorite_count": 0, "accepted_answer_id": 45246224, "answer_count": 1, "score": 1, "last_activity_date": 1500668889, "creation_date": 1458762225, "last_edit_date": 1458762563, "question_id": 36187320, "link": "https://stackoverflow.com/questions/36187320/maincrtstartup-vs-wmaincrtstartup", "title": "mainCRTStartup vs wmainCRTStartup", "body": "<p>I understand that Visual C++ Linker chooses <code>mainCRTStartup</code>/<code>wmainCRTStartup</code> when option <code>/SUBSYSTEM</code> is set to <code>CONSOLE</code>.</p>\n\n<p>What I do not understand is how the linker chooses between the two.</p>\n\n<p>I tested with a simple program on VC 2015. If wmain exists (even main also exists), wmain is called. Otherwise main is called. </p>\n"}, {"tags": ["c", "apache"], "comments": [{"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1458761667, "post_id": 36187137, "comment_id": 60009630, "body": "Why not just use <code>fopen</code> etc instead of <code>system</code>?"}, {"owner": {"reputation": 166, "user_id": 5216339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af604e7f3e483c24078b1c028856c6ef?s=128&d=identicon&r=PG&f=1", "display_name": "archlyfe", "link": "https://stackoverflow.com/users/5216339/archlyfe"}, "reply_to_user": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1458762045, "post_id": 36187137, "comment_id": 60009825, "body": "@EdHeal, I&#39;m not the one writing these scripts or meaning to find a better way. I&#39;m saying that I have quite a number of scripts laying around which already use this syntax on the other server, and we don&#39;t want to go through and find/rewrite many dozens of scripts."}, {"owner": {"reputation": 481, "user_id": 5916150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c209005186a84dd1820b220d7b78527e?s=128&d=identicon&r=PG&f=1", "display_name": "Arif Burhan", "link": "https://stackoverflow.com/users/5916150/arif-burhan"}, "edited": false, "score": 0, "creation_date": 1458762279, "post_id": 36187137, "comment_id": 60009938, "body": "Apache configuration file will have list of filetypes which are executable: .php .cgi and so on.  Either edit your config file, or alter the file extension on your cgi scripts."}, {"owner": {"reputation": 166, "user_id": 5216339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af604e7f3e483c24078b1c028856c6ef?s=128&d=identicon&r=PG&f=1", "display_name": "archlyfe", "link": "https://stackoverflow.com/users/5216339/archlyfe"}, "reply_to_user": {"reputation": 481, "user_id": 5916150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c209005186a84dd1820b220d7b78527e?s=128&d=identicon&r=PG&f=1", "display_name": "Arif Burhan", "link": "https://stackoverflow.com/users/5916150/arif-burhan"}, "edited": false, "score": 0, "creation_date": 1458762431, "post_id": 36187137, "comment_id": 60010006, "body": "@ArifBurhan The C program is compiled and named as a cgi, as is my perl example above. They both run, but C doesn&#39;t show the the content of the cat while the perl script does."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5443453"}, "edited": false, "score": 0, "creation_date": 1458813911, "post_id": 36187137, "comment_id": 60028439, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/3998228/how-can-i-store-the-output-of-system-function-to-a-string\">How can I store the Output of System function to a string</a>"}], "answers": [{"comments": [{"owner": {"reputation": 166, "user_id": 5216339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af604e7f3e483c24078b1c028856c6ef?s=128&d=identicon&r=PG&f=1", "display_name": "archlyfe", "link": "https://stackoverflow.com/users/5216339/archlyfe"}, "edited": false, "score": 0, "creation_date": 1458766324, "post_id": 36188309, "comment_id": 60012186, "body": "Thank you. I realize that this is the proper way to get the content and print it, and whomever wrote my example script in the past did it quite an odd way. I&#39;m not a C programmer, per se, just an admin trying to work it out without having to rewrite a ridiculous amount of scripts. I actually did figure out how to get my program to do what you want with minimal work: I just had to add &quot;fflush(stdout)&quot; before the strcopy and it works like magic."}, {"owner": {"reputation": 1075, "user_id": 2539954, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/1ef914985b0030db224fbb296d0c9d0a?s=128&d=identicon&r=PG", "display_name": "Erik Nyquist", "link": "https://stackoverflow.com/users/2539954/erik-nyquist"}, "reply_to_user": {"reputation": 166, "user_id": 5216339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af604e7f3e483c24078b1c028856c6ef?s=128&d=identicon&r=PG&f=1", "display_name": "archlyfe", "link": "https://stackoverflow.com/users/5216339/archlyfe"}, "edited": false, "score": 0, "creation_date": 1458766435, "post_id": 36188309, "comment_id": 60012258, "body": "strcpy? there&#39;s no strcpy in the code you posted above"}], "tags": [], "owner": {"reputation": 1075, "user_id": 2539954, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/1ef914985b0030db224fbb296d0c9d0a?s=128&d=identicon&r=PG", "display_name": "Erik Nyquist", "link": "https://stackoverflow.com/users/2539954/erik-nyquist"}, "is_accepted": false, "score": 0, "last_activity_date": 1458766090, "last_edit_date": 1458766090, "creation_date": 1458765693, "answer_id": 36188309, "question_id": 36187137, "link": "https://stackoverflow.com/questions/36187137/how-to-get-output-from-systemcat-to-show-on-apache-web-page/36188309#36188309", "title": "How to get output from system(&#39;cat&#39;) to show on apache web page?", "body": "<p>From the <a href=\"http://linux.die.net/man/3/system\" rel=\"nofollow\">system() man page</a>: \"system() executes a command specified in command by calling /bin/sh -c command, and returns after the command has been completed.\"</p>\n\n<p>And that's about all it does. You want something like <code>popen</code>, which can start another process and will return an IO stream so you can read from / write to the process.</p>\n\n<p>BUT! if all you want is a C program that displays the contents of a text file, then using <code>system()</code> to run <code>cat</code> is a bit excessive. Just use C:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main (void)\n{\n    FILE *fp;\n    char c;\n\n    /* Open the file */\n    if ((fp = fopen(\"/path/to/file\", \"r\")) == NULL) {\n        printf(\"failed to open file\\n\");\n        return 1;\n    }\n\n    printf(\"content-type: text/plain\\n\\n\");\n    printf(\"Normal Output...\\n\");\n\n    /* Print each character in the file */\n    while ((c = fgetc(fp)) != EOF) {\n        printf(\"%c\", c);\n    }\n    printf(\"\\n\");\n\n    fclose(fp); /* close the file */\n    printf(\"Done...\\n\");\n    return 0;\n}\n</code></pre>\n\n<p>You could also use <code>fgets()</code> (<a href=\"http://linux.die.net/man/3/fgets\" rel=\"nofollow\">man page here</a>) instead of <code>fgetc</code>, if you know your file will contain newline-seperated text and you want to read whole lines at a time.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5443453"}, "is_accepted": false, "score": 0, "last_activity_date": 1458817567, "last_edit_date": 1458817567, "creation_date": 1458793793, "answer_id": 36193311, "question_id": 36187137, "link": "https://stackoverflow.com/questions/36187137/how-to-get-output-from-systemcat-to-show-on-apache-web-page/36193311#36193311", "title": "How to get output from system(&#39;cat&#39;) to show on apache web page?", "body": "<p>You can use popen instead of system.</p>\n\n<p>Here is the popen code,</p>\n\n<pre><code>#include \"stdio.h\"\n#include &lt;strings.h&gt;\n#include \"stdlib.h\"\n\nint main()\n{\n        printf(\"content-type: text/plain\\n\\n\");\n        printf(\"Normal Output...\\n\");\n        FILE *fp;\n        char buffer[1024];\n        if((fp = popen(\"cat /path/to/file\", \"r\")) != NULL)\n        {\n                while(fgets(buffer, 1024, fp) != NULL)\n                {\n                        printf(\"%s\", buffer);\n                }\n                printf(\"\\n\");\n                printf(\"Done...\\n\");\n        }\n}\n</code></pre>\n\n<p>The popen function executes that command and store the output to the Temporary file. And it returns the file pointer to that temporary file.</p>\n\n<p><strong>UPDATE:-</strong></p>\n\n<p>There is a second method is also there to do this.\nThat is,</p>\n\n<p>Store the system output to a file, and read that file.</p>\n\n<p>Here is the code for second method.</p>\n\n<pre><code>#include \"stdio.h\"\n#include &lt;strings.h&gt;\n#include \"stdlib.h\"\n\nint main()\n{\n        printf(\"content-type: text/plain\\n\\n\");\n        printf(\"Normal Output...\\n\");\n        FILE *fp;\n        char buffer[1024];\n        system(\"cat file.txt &gt; output.txt\");\n        if((fp = fopen(\"output.txt\", \"r\")) != NULL)\n        {\n                while(fgets(buffer, 1024, fp) != NULL)\n                {\n                        printf(\"%s\", buffer);\n                }\n                printf(\"\\n\");\n                printf(\"Done...\\n\");\n        }\n}\n</code></pre>\n"}], "owner": {"reputation": 166, "user_id": 5216339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af604e7f3e483c24078b1c028856c6ef?s=128&d=identicon&r=PG&f=1", "display_name": "archlyfe", "link": "https://stackoverflow.com/users/5216339/archlyfe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 632, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1459051814, "creation_date": 1458761542, "last_edit_date": 1459051814, "question_id": 36187137, "link": "https://stackoverflow.com/questions/36187137/how-to-get-output-from-systemcat-to-show-on-apache-web-page", "title": "How to get output from system(&#39;cat&#39;) to show on apache web page?", "body": "<p>I've been tasked with upgrading some old servers (ubuntu 9 -> ubuntu 14). On our old server, we have some C scripts which use this format to output file content:</p>\n\n<pre><code>#include \"stdio.h\"\n#include &lt;strings.h&gt;\n#include \"stdlib.h\"\n\nmain(argc, argv)\n    int argc;\n    int argv;\n{\n    printf(\"content-type: text/plain\\n\\n\");\n    printf(\"Normal Output...\\n\");\n    system(\"cat /path/to/file\");\n    printf(\"Done...\\n\");\n}\n</code></pre>\n\n<p>Now, if I compile this into a cgi script and run it from the web on our old server, I see the content of /path/to/file. However on any newer apache server, it doesn't show me the cat output. I know it shows when it runs on the command line and I know the command actually runs from the web because I can use \"> log\" to redirect the cat output. Does anybody know what I can do to make these system cat outputs work with apache?</p>\n\n<p>EDIT:\nIt seems I can do that with perl in a very similar fashion and get what I am looking for, so I would imagine it's a C-specific problem and not apache. Here's a perl script which does do what I expect:</p>\n\n<pre><code>#!/usr/bin/perl\nuse strict;\nuse warnings;\n\nprint \"Content-type: text/plain\\n\\n\";\nprint \"Normal Output...\\n\";\nsystem(\"cat /path/to/file\");\nprint \"Done...\\n\";\n</code></pre>\n\n<p>EDIT 2:</p>\n\n<p>I figured out a way to get the original code to work as expected without utilizing an alternate method of reading file. I wasn't looking for how to read the content of the text files, but rather what I would have to do to make this script, and others like it, work. I figured out that adding fflush makes the above code work as expected. I'm sorry if my question was vague, I was just trying find a quick solution for a problem that will be dealt with by other people at another time.</p>\n\n<pre><code>#include \"stdio.h\"\n#include &lt;strings.h&gt;\n#include \"stdlib.h\"\n\nmain(argc, argv)\n    int argc;\n    int argv;\n{\n    printf(\"content-type: text/plain\\n\\n\");\n    fflush(stdout);\n    printf(\"Normal Output...\\n\");\n    system(\"cat /path/to/file\");\n    printf(\"Done...\\n\");\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "c++11", "design-patterns"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1458759952, "post_id": 36186577, "comment_id": 60008540, "body": "template and Function pointer ?"}, {"owner": {"reputation": 5197, "user_id": 59775, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ef840b42249ae3f3ca8475a305599397?s=128&d=identicon&r=PG", "display_name": "celavek", "link": "https://stackoverflow.com/users/59775/celavek"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1458760173, "post_id": 36186577, "comment_id": 60008675, "body": "I do not understand the downvotes. Please be at least polite and explain."}, {"owner": {"reputation": 5197, "user_id": 59775, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ef840b42249ae3f3ca8475a305599397?s=128&d=identicon&r=PG", "display_name": "celavek", "link": "https://stackoverflow.com/users/59775/celavek"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1458760209, "post_id": 36186577, "comment_id": 60008696, "body": "@Jarod42 could you provide an example?"}, {"owner": {"reputation": 5197, "user_id": 59775, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ef840b42249ae3f3ca8475a305599397?s=128&d=identicon&r=PG", "display_name": "celavek", "link": "https://stackoverflow.com/users/59775/celavek"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1458763475, "post_id": 36186577, "comment_id": 60010593, "body": "Either is the wrong time of the day for some people or there must be something really wrong with the question and I am blind."}], "answers": [{"comments": [{"owner": {"reputation": 5197, "user_id": 59775, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ef840b42249ae3f3ca8475a305599397?s=128&d=identicon&r=PG", "display_name": "celavek", "link": "https://stackoverflow.com/users/59775/celavek"}, "edited": false, "score": 0, "creation_date": 1458763350, "post_id": 36187274, "comment_id": 60010520, "body": "But there is more than one function in the API. Should I pass function pointers for each and everyone of them? How does that scale if I add more functions to the API?"}, {"owner": {"reputation": 420, "user_id": 5747844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c47f253367f6ff02da1fe8f521a77057?s=128&d=identicon&r=PG&f=1", "display_name": "nissefors", "link": "https://stackoverflow.com/users/5747844/nissefors"}, "reply_to_user": {"reputation": 5197, "user_id": 59775, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ef840b42249ae3f3ca8475a305599397?s=128&d=identicon&r=PG", "display_name": "celavek", "link": "https://stackoverflow.com/users/59775/celavek"}, "edited": false, "score": 0, "creation_date": 1458802195, "post_id": 36187274, "comment_id": 60023182, "body": "If the component class youd have to mirror each type, as long as the interface of your different types doesn&#39;t diverge from eachother the scaling would be linear with the size of the interface. You should look at the code @Jarod42 supplied though since it puts the functions into the template declaration wich would allow you to make a nice typedef to reduce each instanciation a lot."}], "tags": [], "owner": {"reputation": 420, "user_id": 5747844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c47f253367f6ff02da1fe8f521a77057?s=128&d=identicon&r=PG&f=1", "display_name": "nissefors", "link": "https://stackoverflow.com/users/5747844/nissefors"}, "is_accepted": false, "score": 1, "last_activity_date": 1458762018, "creation_date": 1458762018, "answer_id": 36187274, "question_id": 36186577, "link": "https://stackoverflow.com/questions/36186577/strategies-to-wrap-c-api-for-c-consumption/36187274#36187274", "title": "Strategies to wrap C API for C++ consumption", "body": "<p>I am thinking that @Jarod42 was implying something </p>\n\n<pre><code>template &lt;typename T&gt;\nclass component\n{\nprivate:\n    typedef void (*destroyMethod)(T*,error_details_t*);\n    ...\npublic:\n    component(destroyMethod,...)\n    {\n        destroy = destroyMethod;\n        ...\n    }\n    void Destroy()\n    {\n        error_details_t err;\n        destroy(handle, err);\n    }\n    ...\nprivate:\n    destroyMethod destroy;\n    T * handle;\n};\n</code></pre>\n\n<p>then instanciate with something like:</p>\n\n<pre><code>component&lt;bull_handle_t&gt; yourBull(bull_destroy, ...)\n</code></pre>\n\n<p>And you could probably wrap away the last part with some extra work</p>\n"}, {"comments": [{"owner": {"reputation": 5197, "user_id": 59775, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ef840b42249ae3f3ca8475a305599397?s=128&d=identicon&r=PG", "display_name": "celavek", "link": "https://stackoverflow.com/users/59775/celavek"}, "edited": false, "score": 0, "creation_date": 1458763655, "post_id": 36187690, "comment_id": 60010686, "body": "I have not rejected anything yet. I&#39;m weighing the alternatives and I&#39;m also wondering if people have come with better ideas, hence the question."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 5197, "user_id": 59775, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ef840b42249ae3f3ca8475a305599397?s=128&d=identicon&r=PG", "display_name": "celavek", "link": "https://stackoverflow.com/users/59775/celavek"}, "edited": false, "score": 0, "creation_date": 1458764241, "post_id": 36187690, "comment_id": 60011010, "body": "@celavek, there are no other options, just variations on the ones you already know."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 0, "last_activity_date": 1458763472, "creation_date": 1458763472, "answer_id": 36187690, "question_id": 36186577, "link": "https://stackoverflow.com/questions/36186577/strategies-to-wrap-c-api-for-c-consumption/36187690#36187690", "title": "Strategies to wrap C API for C++ consumption", "body": "<p>You have a collection of C functions arranged in groups, with names and signatures that follow a consistent pattern.  If you want your C++ wrapper to call one of those functions, the function's name must appear one way or another in the C++ code.  Your choices for accomplishing that are to insert the names literally in the appropriate places in your wrapper code, or to generate them systematically via macros.  You have rejected both alternatives.</p>\n\n<p>If you insist on avoiding macros, you could consider writing a code generator to output C++ sources for all the class definitions (that call the needed functions literally).  Perhaps that would be more satisfying than coding it all by hand, and it would allow you to easily regenerate the classes if they turn out to be flawed, if the C library changes or adds functions, or for any other reason.</p>\n"}, {"comments": [{"owner": {"reputation": 5197, "user_id": 59775, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ef840b42249ae3f3ca8475a305599397?s=128&d=identicon&r=PG", "display_name": "celavek", "link": "https://stackoverflow.com/users/59775/celavek"}, "edited": false, "score": 0, "creation_date": 1458809839, "post_id": 36188524, "comment_id": 60026295, "body": "This is indeed interesting. I think I can work further with that. I was already thinking about function pointers but I was not sure how and with what to &quot;combine&quot; them."}], "tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": true, "score": 3, "last_activity_date": 1458809808, "last_edit_date": 1458809808, "creation_date": 1458766572, "answer_id": 36188524, "question_id": 36186577, "link": "https://stackoverflow.com/questions/36186577/strategies-to-wrap-c-api-for-c-consumption/36188524#36188524", "title": "Strategies to wrap C API for C++ consumption", "body": "<p>What I have in mind is</p>\n\n<pre><code>template &lt;typename H&gt; using create_t = void (*)(H**, error_details_t*);\ntemplate &lt;typename H&gt; using destroy_t = void (*)(H*, error_details_t*);\ntemplate &lt;typename H&gt; using get_data_t = void (*)(H*, uint8_t* buffer, error_details_t*);\n\ntemplate &lt;typename H,\n          create_t&lt;H&gt; create,\n          destroy_t&lt;H&gt; destroy,\n          get_data_t&lt;H&gt; get_data&gt;\nclass backend\n{\n    backend() { error_details_t err; create(&amp;handle, err);}\n    ~backend() {  error_details_t err; destroy(handle, err);}\n\n    backend(const backend&amp;) = delete;\n    backend&amp; operator =(const backend&amp;) = delete;\n    backend(backend&amp;&amp;) = delete;\n    backend&amp; operator =(backend&amp;&amp;) = delete;\n\n    void get_data(uint8_t* buffer)\n    {\n         error_details_t err;\n         get_data(handle, buffer, &amp;err);\n    }\n\nprivate:\n   H* handle = nullptr;\n};\n\nusing bull = backend&lt;bull_handle_t, &amp;bull_create, &amp;bull_destroy, &amp;bull_get_data&gt;;\nusing frog = backend&lt;frog_handle_t, &amp;frog_create, &amp;frog_destroy, &amp;frog_get_data&gt;;\nusing bullfrog = backend&lt;bullfrog_handle_t,\n                         &amp;bullfrog_create,\n                         &amp;bullfrog_destroy,\n                         &amp;bull_get_data&gt;;\n</code></pre>\n\n<p>Maybe <code>error_details_t</code> can be a member,\nand you should also handle error.</p>\n"}], "owner": {"reputation": 5197, "user_id": 59775, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ef840b42249ae3f3ca8475a305599397?s=128&d=identicon&r=PG", "display_name": "celavek", "link": "https://stackoverflow.com/users/59775/celavek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 339, "favorite_count": 0, "accepted_answer_id": 36188524, "answer_count": 3, "score": 0, "last_activity_date": 1544137510, "creation_date": 1458759670, "last_edit_date": 1544137510, "question_id": 36186577, "link": "https://stackoverflow.com/questions/36186577/strategies-to-wrap-c-api-for-c-consumption", "title": "Strategies to wrap C API for C++ consumption", "body": "<p>In a C++ app I have to interface with a C library. This library has several components each with its own API. The APIs are very similar and differ just in the prefix of the functions and in some handler type. E.g.:</p>\n\n<pre><code>// bull component\nvoid bull_create(bull_handle_t** handle, error_details_t* error_details);\nvoid bull_destroy(bull_handle_t* handle, error_details_t* error_details);\nvoid bull_get_data(bull_handle_t* handle, uint8_t* buffer, error_details_t* error_details);\n\n// frog component\nvoid frog_create(frog_handle_t** handle, error_details_t* error_details);\nvoid frog_destroy(frog_handle_t* handle, error_details_t* error_details);\nvoid frog_get_data(frog_handle_t* handle, uint8_t* buffer, error_details_t* error_details);\n\n// bullfrog component\nvoid bullfrog_create(bullfrog_handle_t** handle, error_details_t* error_details);\nvoid bullfrog_destroy(bullfrog_handle_t* handle, error_details_t* error_details);\nvoid bullfrog_get_data(bullfrog_handle_t* handle, uint8_t* buffer, error_details_t* error_details);\n\n// NOTE: components can and will be added at any time following the same pattern.\n</code></pre>\n\n<p>I want to wrap this for C++ consumption in a generic way with minimal code duplication. \nSo first the naive approach:</p>\n\n<pre><code>class bull_backend\n{\npublic:\n   ...\n   void get_data (uint8_t* buffer)\n   {\n       error_details_t err;\n       bull_get_data(handle, buffer, &amp;err);\n   }\n   ...\n\nprivate:\n    bull_handle_t* handle;\n};\n\nclass frog_backend\n{\npublic:\n   ...\n   void get_data (uint8_t* buffer)\n   {\n       error_details_t err;\n       frog_get_data(handle, buffer, &amp;err);\n   }\n   ...\n\nprivate:\n    frog_handle_t* handle;\n};\n\nclass bullfrog_backend\n{\npublic:\n   ...\n   void get_data (uint8_t* buffer)\n   {\n       error_details_t err;\n       bullfrog_get_data(handle, buffer, &amp;err);\n   }\n   ...\n\nprivate:\n    bullfrog_handle_t* handle;\n};\n</code></pre>\n\n<p>That does not quite cut it. I will be just duplicating the C API but now in the form of classes.\nThe only thing that is different is just the prefix which identifies the C entities.</p>\n\n<p>The next thing on my mind was a, be prepared, a macro e.g.</p>\n\n<pre><code>#define GENERATE_BACKEND(...)\n    ...\n</code></pre>\n\n<p>that would just substitute for the prefix. But I do not like that. It does not feel like \nmodern C++.</p>\n\n<p>One other thing I could do is group everything toghether in one class template and \ndo tag dispatching or use enable_if, e.g.</p>\n\n<pre><code>template &lt;typename Component&gt;\nclass backend\n{\npublic:\n\n    ...\n    template&lt;typename = typename std::enable_if&lt;std::is_same&lt;Component, bull_component&gt;::value&gt;::type&gt;\n    void get_data (uint8_t* buffer)\n    {\n       error_details_t err;\n       bull_get_data(handle, buffer, &amp;err);\n    }\n\n    template&lt;typename = typename std::enable_if&lt;std::is_same&lt;Component, frog_component&gt;::value&gt;::type&gt;\n    void get_data (uint8_t* buffer)\n    {\n       error_details_t err;\n       frog_get_data(handle, buffer, &amp;err);\n    }\n\n    template&lt;typename = typename std::enable_if&lt;std::is_same&lt;Component, bullfrog_component&gt;::value&gt;::type&gt;\n    void get_data (uint8_t* buffer)\n    {\n       error_details_t err;\n       bullfrog_get_data(handle, buffer, &amp;err);\n    }\n    ...\n\nprivate:\n    typename Component::handle_type handle;\n};\n\nstruct frog_component\n{\n   using handle_type = frog_handle_t*;\n};\n\nstruct bull_component\n{\n   using handle_type = bull_handle_t*;\n};\n\nstruct bullfrog_component\n{\n   using handle_type = bullfrog_handle_t*;\n};\n\nusing frog_backend = backend&lt;frog_component&gt;;\nusing bull_backend = backend&lt;bull_component&gt;;\nusing bullfrog_backend = backend&lt;bullfrog_component&gt;;\n</code></pre>\n\n<p>Still it doesn't feel right. One other thing that bothers me besides the apparent code \nduplication is that, except for the macro version :), they do not scale nice with \nthe addition of C components. </p>\n\n<p>I'm always under the impression that there must be something else which is better.\nSo, does anyone know of a better, worthier of the modern C++ name, technique to handle \nthis type of situation?</p>\n"}, {"tags": ["c", "struct", "typedef"], "comments": [{"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 0, "creation_date": 1458758283, "post_id": 36185976, "comment_id": 60007610, "body": "declaring the structure requires no extra space, it doesn&#39;t take space until you instantiate it. Since you need them both, just declare them both."}, {"owner": {"reputation": 1952, "user_id": 3037766, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/PPfnV.png?s=128&g=1", "display_name": "slightlynybbled", "link": "https://stackoverflow.com/users/3037766/slightlynybbled"}, "reply_to_user": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 0, "creation_date": 1458759113, "post_id": 36185976, "comment_id": 60008056, "body": "@KevinDTimm Thank you for looking at this.  If I declare <code>Buffer buf1</code> and <code>Buffer buf2</code>, then my compiler will allocate the full <code>BUFFER_LENGTH</code> to each.  This will functionally work, but will use much more RAM than I am interested in."}, {"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 0, "creation_date": 1458759227, "post_id": 36185976, "comment_id": 60008125, "body": "Yes, I see this (especially after looking @ the answer from WeatherVan). I was off in my interpretation of the problem"}, {"owner": {"reputation": 1952, "user_id": 3037766, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/PPfnV.png?s=128&g=1", "display_name": "slightlynybbled", "link": "https://stackoverflow.com/users/3037766/slightlynybbled"}, "reply_to_user": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 0, "creation_date": 1458759567, "post_id": 36185976, "comment_id": 60008322, "body": "@KevinDTimm could I add wording to clear up the interpretation?"}, {"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 0, "creation_date": 1458759766, "post_id": 36185976, "comment_id": 60008425, "body": "No, the question is clear (I was just lazy in reading)"}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1458761446, "post_id": 36185976, "comment_id": 60009504, "body": "Another common trick is to make the put the buffer array as the last element of the structure as a 0-length array, then just malloc the whole structure at whatever size needed. Saves the indirection of a pointer."}], "answers": [{"comments": [{"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 0, "creation_date": 1458758396, "post_id": 36186186, "comment_id": 60007670, "body": "and, if the OP is so worried about space (and the variable is only one of 2 values SMALL_ and LARGE_) the buffer_size could be just a <code>char</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 0, "creation_date": 1458758489, "post_id": 36186186, "comment_id": 60007717, "body": "@KevinDTimm but OP does not want to use <code>malloc</code>."}, {"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 0, "creation_date": 1458758496, "post_id": 36186186, "comment_id": 60007720, "body": "or, even better, to save even more space, have a union with elements <code>data_small[SMALL_BUFFER_LENGTH]</code> and <code>data_large[LARGE_BUFFER_LENGTH]</code>"}, {"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 0, "creation_date": 1458758553, "post_id": 36186186, "comment_id": 60007747, "body": "no <code>malloc</code> needed, set <code>buffer_size</code> to the size used and perform all operations based upon that value."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 1, "creation_date": 1458758578, "post_id": 36186186, "comment_id": 60007762, "body": "@KevinDTimm a union will use unnecessary memory in the small case."}, {"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 0, "creation_date": 1458758645, "post_id": 36186186, "comment_id": 60007806, "body": "ah, yes - of course. in the case of SMALL data, unnecessary data is running around."}, {"owner": {"reputation": 1952, "user_id": 3037766, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/PPfnV.png?s=128&g=1", "display_name": "slightlynybbled", "link": "https://stackoverflow.com/users/3037766/slightlynybbled"}, "edited": false, "score": 0, "creation_date": 1458758961, "post_id": 36186186, "comment_id": 60007975, "body": "@WeatherVane Is there a way to use a MACRO to emulate this answer?  This type of solution had struck me, but it is somewhat less maintainable than a single struct definition that I was hoping for.  Thanks!"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 0, "creation_date": 1458759030, "post_id": 36186186, "comment_id": 60008013, "body": "@KevinDTimm I misread your very first comment, thinking you meant <code>data[1]</code>. If a small buffer only needs 8-bit control fields, then the handler functions cannot be shared."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1458759170, "post_id": 36186186, "comment_id": 60008091, "body": "@WeatherVane, this is a violation of type aliasing rule."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 1952, "user_id": 3037766, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/PPfnV.png?s=128&g=1", "display_name": "slightlynybbled", "link": "https://stackoverflow.com/users/3037766/slightlynybbled"}, "edited": false, "score": 0, "creation_date": 1458759242, "post_id": 36186186, "comment_id": 60008131, "body": "@slightlynybbled I don&#39;t know, but if you only have one of each buffer for the lifetime of the program, could you define <code>data[1]</code> and use <code>malloc</code>. I can understand the aversion, but it&#39;s not like you would be using it dynamically."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1458759303, "post_id": 36186186, "comment_id": 60008172, "body": "@SergeyA my last remark would overcome your very valid objection."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1458759368, "post_id": 36186186, "comment_id": 60008205, "body": "@WeatherVane, which one?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1458759432, "post_id": 36186186, "comment_id": 60008252, "body": "@SergeyA I can only see one: the violation of type aliasing rule. And my remark about defining <code>data[1]</code>. So there would be only one struct type."}, {"owner": {"reputation": 1952, "user_id": 3037766, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/PPfnV.png?s=128&g=1", "display_name": "slightlynybbled", "link": "https://stackoverflow.com/users/3037766/slightlynybbled"}, "edited": false, "score": 0, "creation_date": 1458759483, "post_id": 36186186, "comment_id": 60008277, "body": "Thank you both.  In that case, it looks like I may want to just declare a data buffer at compile time and - instead of placing the size in the struct - place a length in the struct and a pointer to the each data buffer in the struct instead of the buffer itself.  Objections?"}, {"owner": {"reputation": 1952, "user_id": 3037766, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/PPfnV.png?s=128&g=1", "display_name": "slightlynybbled", "link": "https://stackoverflow.com/users/3037766/slightlynybbled"}, "edited": false, "score": 0, "creation_date": 1458759849, "post_id": 36186186, "comment_id": 60008470, "body": "I added a potential clarification to my last comment."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1458759860, "post_id": 36186186, "comment_id": 60008478, "body": "@WeatherVane, but this is not what your answer calls for. If you are suggesting <code>data[1]</code>, you should have it in your answer (in which case I would suggest <code>data[]</code>, btw)"}, {"owner": {"reputation": 1952, "user_id": 3037766, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/PPfnV.png?s=128&g=1", "display_name": "slightlynybbled", "link": "https://stackoverflow.com/users/3037766/slightlynybbled"}, "edited": false, "score": 0, "creation_date": 1458760128, "post_id": 36186186, "comment_id": 60008643, "body": "I appreciate the effort.  I think this gives me the best directon thus far.  Thank you!"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1458768231, "post_id": 36186186, "comment_id": 60013181, "body": "You cannot use the same tag <code>struct buffer</code> for two different structs"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1458768278, "post_id": 36186186, "comment_id": 60013201, "body": "@M.M thank you mybad."}], "tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": true, "score": 2, "last_activity_date": 1458758455, "last_edit_date": 1458758455, "creation_date": 1458758267, "answer_id": 36186186, "question_id": 36185976, "link": "https://stackoverflow.com/questions/36185976/declare-two-different-struct-sizes/36186186#36186186", "title": "Declare two different struct sizes", "body": "<p>You can define two structs like this:</p>\n\n<pre><code>#define LARGE_BUFFER_LENGTH   256\n#define SMALL_BUFFER_LENGTH   32\n\ntypedef struct buffer {\n    uint16_t buffer_size;\n    uint16_t newest_index;\n    uint16_t oldest_index;\n    BufferStatus status;\n    uint8_t data[LARGE_BUFFER_LENGTH];\n} Large_Buffer;\n\ntypedef struct buffer {\n    uint16_t buffer_size;\n    uint16_t newest_index;\n    uint16_t oldest_index;\n    BufferStatus status;\n    uint8_t data[SMALL_BUFFER_LENGTH];\n} Small_Buffer;\n</code></pre>\n\n<p>with the <code>data</code> member moved to the end, and adding a <code>buffer_size</code> member. You should be able to share the handler functions, by casting the pointer to the smaller type to make it acceptable to the compiler. C does not care if you apparently overflow an array, and the <code>buffer_size</code> field will take care of the implementation difference. You would use <code>buffer_size</code> (initialised of course) wherever you previously used <code>BUFFER_LENGTH</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1458768177, "post_id": 36186235, "comment_id": 60013156, "body": "The &quot;compatible defined types&quot; are not compatible (in C, structs are only <i>compatible</i> if they are exactly the same).  Also you need to use different struct tags (not <code>struct buffer</code> for all)."}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1458768725, "post_id": 36186235, "comment_id": 60013381, "body": "No rules for <i>compatible types</i> (std 6.2.7) and <i>flexible array members</i> (6.7.2.1/18) applies. Did I misinterpret them?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1458769314, "post_id": 36186235, "comment_id": 60013607, "body": "compatibility requirement for structs includes &quot;If one is declared with a tag, the other shall be declared with the same tag.&quot;.  (Even having the same list of members is not sufficient).   BTW I think your idea does work, was just commenting on the word &#39;compatible&#39;."}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1458770027, "post_id": 36186235, "comment_id": 60013963, "body": "You are right Example 6.7.2.1/20 clearly stated it. But I would be surprised if it really happens..."}], "tags": [], "owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "is_accepted": false, "score": 1, "last_activity_date": 1458768358, "last_edit_date": 1458768358, "creation_date": 1458758437, "answer_id": 36186235, "question_id": 36185976, "link": "https://stackoverflow.com/questions/36185976/declare-two-different-struct-sizes/36186235#36186235", "title": "Declare two different struct sizes", "body": "<p>If you don't want dynamic allocation you may use a definition like:</p>\n\n<pre><code>typedef struct buffer {\n    uint16_t newest_index;\n    uint16_t oldest_index;\n    BufferStatus status;\n    int length;\n    uint8_t data[];\n} Buffer;\n</code></pre>\n\n<p>and then two compatible defined types:</p>\n\n<pre><code>typedef struct buffer1 {\n    uint16_t newest_index;\n    uint16_t oldest_index;\n    BufferStatus status;\n    int length;\n    uint8_t data[LENGHT1];\n} Buffer1_t;\n</code></pre>\n\n<p>and:</p>\n\n<pre><code>typedef struct buffer2 {\n    uint16_t newest_index;\n    uint16_t oldest_index;\n    BufferStatus status;\n    int length; // may be useful...\n    uint8_t data[LENGHT2];\n} Buffer2_t;\n</code></pre>\n\n<p>Then you can use pointers to play with:</p>\n\n<pre><code>Buffer *allocate_buffer(int type) {\n    if (type==1) {\n      return (Buffer *)malloc(sizeof(Buffer1_t));\n    } else ...\n}    \n</code></pre>\n\n<p>If you don't want dynamic allocation you may play with statically pre-allocated such structures.</p>\n"}], "owner": {"reputation": 1952, "user_id": 3037766, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/PPfnV.png?s=128&g=1", "display_name": "slightlynybbled", "link": "https://stackoverflow.com/users/3037766/slightlynybbled"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "closed_date": 1458768678, "accepted_answer_id": 36186186, "answer_count": 2, "score": 2, "last_activity_date": 1458768358, "creation_date": 1458757593, "last_edit_date": 1458759811, "question_id": 36185976, "link": "https://stackoverflow.com/questions/36185976/declare-two-different-struct-sizes", "closed_reason": "Needs details or clarity", "title": "Declare two different struct sizes", "body": "<p>This is on a microcontroller platform, so RAM use is important.</p>\n\n<p>I have a nice little library that I use for circular buffers.  For the circular buffer, I declare a struct typedef:</p>\n\n<pre><code>typedef struct buffer {\n    uint8_t data[BUFFER_LENGTH];\n    uint16_t newest_index;\n    uint16_t oldest_index;\n    BufferStatus status;\n} Buffer;\n</code></pre>\n\n<p>Normally, I only need one of these per application, so defining the <code>BUFFER_LENGTH</code> to a particular value is not a big deal, but I have an application that requires two of them... one of relatively short length (32 bytes) and one of relatively long length (256 bytes).</p>\n\n<p>Is there an easy technique that I can use that doesn't involve <code>malloc()</code> that would allow me to declare two variables of two different lengths?</p>\n\n<p>The only think that I have come up with thus far is to make the data in the struct a pointer, declare the array when I declare the buffer, and add the buffer length to the Buffer typedef:</p>\n\n<pre><code>typedef struct buffer {\n    uint8_t dataPtr*;\n    uint16_t length;\n    uint16_t newest_index;\n    uint16_t oldest_index;\n    BufferStatus status;\n} Buffer;\n\nuint8_t dataBuf1[256]\nuint8_t dataBuf2[32]\n\nBuffer buf1, buf2;\n\nbuf1.dataPtr = dataBuf1;\nbuf1.length = 256;\n\nbuf2.dataPtr = dataBuf2;\nbuf2.length = 32;\n</code></pre>\n\n<p>This will work, but is there a better solution?</p>\n"}, {"tags": ["c", "pointers", "memcpy", "bluetooth-lowenergy"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458757938, "post_id": 36185972, "comment_id": 60007385, "body": "Both invoke undefined behaviour."}, {"owner": {"reputation": 3, "user_id": 6105945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/425a812a42302d148fd9c99a4336ca83?s=128&d=identicon&r=PG&f=1", "display_name": "M. Richards", "link": "https://stackoverflow.com/users/6105945/m-richards"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458769565, "post_id": 36185972, "comment_id": 60013734, "body": "@Olaf care to elaborate? What would be the correct way to get the float value then?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458770007, "post_id": 36185972, "comment_id": 60013947, "body": "<a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.5p6\" rel=\"nofollow noreferrer\">port70.net/~nsz/c/c11/n1570.html#6.5p6</a> . To be strictly conforming, you can use functions of the standard library and normal operators. You can also check the math lib if there are reinterpretation functions. I&#39;m well aware this is a dilemma. But note you don&#39;t even specify if the float-format is the same on your platform and from the sensor. Not to mention alignment and endianess."}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458759884, "post_id": 36186097, "comment_id": 60008495, "body": "No, the behaviour is undefined. Violation of effective type rule."}], "tags": [], "owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "is_accepted": true, "score": 2, "last_activity_date": 1458757940, "creation_date": 1458757940, "answer_id": 36186097, "question_id": 36185972, "link": "https://stackoverflow.com/questions/36185972/memcpy-vs-pointer-cast-for-reading-ble-sensor-float/36186097#36186097", "title": "memcpy vs pointer cast for reading BLE sensor float", "body": "<p>&amp;data is a pointer to a uint32_t.  So, (float *)&amp;data casts it as a pointer to a float.  Finally, *(float *)&amp;data dereferences that pointer.</p>\n\n<p>You could do the same thing as:</p>\n\n<pre><code>uint32_t *ui32 = &amp;data\nfloat *f = (float *) ui32;\nsensorValue = *f;\n</code></pre>\n\n<p>But, the exact behavior is likely to be platform dependent.</p>\n"}], "owner": {"reputation": 3, "user_id": 6105945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/425a812a42302d148fd9c99a4336ca83?s=128&d=identicon&r=PG&f=1", "display_name": "M. Richards", "link": "https://stackoverflow.com/users/6105945/m-richards"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 282, "favorite_count": 0, "accepted_answer_id": 36186097, "answer_count": 1, "score": 0, "last_activity_date": 1458757940, "creation_date": 1458757582, "question_id": 36185972, "link": "https://stackoverflow.com/questions/36185972/memcpy-vs-pointer-cast-for-reading-ble-sensor-float", "title": "memcpy vs pointer cast for reading BLE sensor float", "body": "<p>I came across two solutions for reading the float value of a BLE sensor. The memcpy method is straightforward and makes sense, however the other method I came across is not very clear to me. Can someone clarify exactly how the pointer casting method works? </p>\n\n<pre><code>    // Represents data read from BLE device. Float value of 1.5\n    uint32_t data = 0x3fc00000;\n    float sensorValue;\n\n    // Memcpy method, makes sense and is straightforward\n    memcpy(&amp;sensorValue, &amp;data, sizeof(sensorValue));\n\n    // Works, but don't fully understand exactly how\n    sensorValue = *(float *)&amp;data;\n</code></pre>\n"}, {"tags": ["c", "gcc"], "comments": [{"owner": {"reputation": 6533, "user_id": 1918193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b70a14318e0f417ecac47809f38fafc?s=128&d=identicon&r=PG", "display_name": "Marc Glisse", "link": "https://stackoverflow.com/users/1918193/marc-glisse"}, "edited": false, "score": 0, "creation_date": 1458757259, "post_id": 36185782, "comment_id": 60006974, "body": "It cannot be negative on the current platform, but it could be on another one. The warning remains consistent across platforms, helping you write portable code. (I am not saying if I agree or not)"}, {"owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "edited": false, "score": 1, "creation_date": 1458757340, "post_id": 36185782, "comment_id": 60007022, "body": "Because it is exactly how <code>-Wchar-subscripts</code> is specified?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458758282, "post_id": 36185782, "comment_id": 60007609, "body": "Either use an <code>signed char</code> and cast to <code>size_t</code> if you definitively know it is not negative, or use <code>unsigned char</code> variables and remove the then useless test. In other words: don&#39;t fiddle on symptoms, but fix the actual fault."}], "answers": [{"tags": [], "owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "is_accepted": true, "score": 4, "last_activity_date": 1458758805, "last_edit_date": 1458758805, "creation_date": 1458757649, "answer_id": 36186002, "question_id": 36185782, "link": "https://stackoverflow.com/questions/36185782/gcc-using-funsigned-char-still-results-in-wchar-subscripts-warnings/36186002#36186002", "title": "gcc - Using &quot;-funsigned-char&quot; still results in &quot;-Wchar-subscripts&quot; warnings", "body": "<p><code>-Wchar-subscripts</code> is intended as a portability warning. It tells you that <em>in general case</em> <code>char</code> can be signed. The fact that it is unsigned in your case is not relevant. If you don't care about general case - disable the warning.</p>\n\n<p>Note, for example, that you will not receive a warning for <code>int</code> subscripts, even though <code>int</code> can be negative. The compiler assumes that you know what you are doing when you are using <code>int</code> for subscripts. But for <code>char</code> it wants to warn.</p>\n\n<p>Note also that if you explicitly use <code>signed char</code> for subscripts in your code, the warning will disappear, even though <code>signed char</code> can definitely be negative. The compiler again assumes that you know what you are doing.</p>\n"}], "owner": {"reputation": 18466, "user_id": 477563, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/07a89fb7b2fd8ece1e9e39e95e004a36?s=128&d=identicon&r=PG", "display_name": "Mr. Llama", "link": "https://stackoverflow.com/users/477563/mr-llama"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "accepted_answer_id": 36186002, "answer_count": 1, "score": 1, "last_activity_date": 1458758805, "creation_date": 1458757049, "last_edit_date": 1458758018, "question_id": 36185782, "link": "https://stackoverflow.com/questions/36185782/gcc-using-funsigned-char-still-results-in-wchar-subscripts-warnings", "title": "gcc - Using &quot;-funsigned-char&quot; still results in &quot;-Wchar-subscripts&quot; warnings", "body": "<p>This isn't a question on how to prevent this warning but rather as to <strong>why</strong> I receive the warning at all.</p>\n\n<p>Consider the following program:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main() {\n    char *str = \"Hello World!\";\n    int   len = strlen(str);\n\n    // Yes, a char, bare with me\n    char index = 6;\n    char seek  = 'Z';\n\n    // Reject the string if str[index] != seek\n    // Include some bounds checks for safety\n    if (index &lt; 0 || index &gt;= len || str[index] != seek) {\n        puts(\"Rejected\");\n\n    } else {\n        puts(\"Kept\");\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>If you compile it with all warnings enabled, you get the following:</p>\n\n<pre><code>$ gcc -Wall -Wextra char.c -o char\nchar.c: In function \u2018main\u2019:\nchar.c:15:5: warning: array subscript has type \u2018char\u2019 [-Wchar-subscripts]\n     if (index &lt; 0 || index &gt;= len || str[index] != seek) {\n     ^\n</code></pre>\n\n<p>Good!  By default, <code>char</code> can be signed and contain a negative value, so <code>str[index]</code> can cause problems if <code>index</code> is negative.  </p>\n\n<p>What if we force all <code>char</code>s to be unsigned with <code>-funsigned-char</code>?<br>\nThat will guarantee that they will never be negative and should prevent the warning.</p>\n\n<pre><code>$ gcc -Wall -Wextra -funsigned-char char.c -o char\nchar.c: In function \u2018main\u2019:\nchar.c:15:15: warning: comparison is always false due to limited range of data type [-Wtype-limits]\n     if (index &lt; 0 || index &gt;= len || str[index] != seek) {\n               ^\nchar.c:15:5: warning: array subscript has type \u2018char\u2019 [-Wchar-subscripts]\n     if (index &lt; 0 || index &gt;= len || str[index] != seek) {\n     ^\n</code></pre>\n\n<p><code>gcc</code> seems to be aware that <code>index &lt; 0</code> will always be false because <code>index</code> is unsigned.  This explains the first warning.<br>\nHowever, it still warns about <code>str[index]</code> even though it knows that <code>index</code> will never be negative.</p>\n\n<p><strong>Why does <code>gcc</code> still warn about char indexes when it already knows that it can never be negative?</strong></p>\n"}, {"tags": ["c", "arrays", "sorting"], "comments": [{"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 0, "creation_date": 1458759257, "post_id": 36185749, "comment_id": 60008144, "body": "add &#39;debug&#39; code to print your rows and columns (I think you&#39;ll find you don&#39;t have what you think you have)"}], "answers": [{"tags": [], "owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "is_accepted": true, "score": 1, "last_activity_date": 1458759770, "creation_date": 1458759770, "answer_id": 36186606, "question_id": 36185749, "link": "https://stackoverflow.com/questions/36185749/sorting-an-array-replaces-values-with-zeros/36186606#36186606", "title": "Sorting an array replaces values with zeros", "body": "<p>Your temporary variable for swapping is an integer, but the values you swap are floats between 0 and 1, which will become zero on conversion to <code>int</code>.</p>\n\n<p>The error is hard to spot, because the temporary variable in declared at the top of the long <code>main</code> function, far away from the actual swapping code. You could make the temporary variable a local variable to the swapping scope:</p>\n\n<pre><code>for (x = 0; x &lt; 3; x++) {\n    for (y = 0; y &lt; (3 - x); y++) {\n        if (percent[y] &gt; percent[y + 1]) {\n            float swap = percent[y];\n\n            percent[y] = percent[y + 1];\n            percent[y + 1] = swap;\n        }\n    }\n}\n</code></pre>\n\n<p>Other issues:</p>\n\n<ul>\n<li><p>Your <code>total_votes</code> isn't initialised to zero.</p></li>\n<li><p>Please consider writing your loops as</p>\n\n<pre><code>for (row = 0; row &lt; nrows; row++) ...\n</code></pre>\n\n<p>instead of</p>\n\n<pre><code>for (row = 0; row &lt;= nrows - 1; row++) ...\n</code></pre>\n\n<p>This is a common C idiom. Your loops use hard-coded values, but later you might want to have variable limits as in the two examples above, where the \"less than the number of items\" variant is more readable.</p></li>\n<li><p>When you print, new-lines should be at the end of your print formats, not at the beginning. This is the natural way of printing. It also has the benefit that the output buffer will be flushed when printing a newline to the console.</p></li>\n<li><p>This is minor, but pick one floating-point type. You use <code>float</code>, but calculate your percentage with <code>double</code>. I recommend <code>double</code>, which is the standard floating-point type on modern machines.</p></li>\n</ul>\n"}], "owner": {"reputation": 27, "user_id": 5834252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee721d63546fe016c3d191bafe7fdc83?s=128&d=identicon&r=PG&f=1", "display_name": "Wearin", "link": "https://stackoverflow.com/users/5834252/wearin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 36186606, "answer_count": 1, "score": 0, "last_activity_date": 1458759770, "creation_date": 1458756931, "question_id": 36185749, "link": "https://stackoverflow.com/questions/36185749/sorting-an-array-replaces-values-with-zeros", "title": "Sorting an array replaces values with zeros", "body": "<p>The problem starts near the very bottom of the array. I print percent[x] values to make sure they are there, and then after the sort, three of them are filled with zeros. I've been looking around for awhile but I can't find anything.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    int votes[5][4]={192,48,206,37,\n                     147,90,312,21,\n                     186,12,121,38,\n                     114,21,408,39,\n                     267,13,382,29};\n\n    char cand[4]={'A','B','C','D'};\n\n    int row_totals[5];\n    int col_totals[4]; //This is left for you to do\n                       //see code below to see how\n                       //row_totals were calculated.\n\n    int total_votes; \n                        //use a for loop to calculate \n                     //using either row_totals or col_totals   \n\n\n    float percent[4]; //use a for loop to calculate based on\n\n    int swap;  //total_votes and col_totals\n\n    //be sure to print the totals for the candidates\n\n\n    //at the end, you will need to sort the percent array\n    //bringing along the values from the cand array. That is\n    //if a swap is made in the percent array, do the same \n    //swap in the cand array.\n\n    //then if percent[3] is greater than 50, declare cand[3] the winner\n    //if percent[3] is not greater than 50, declare a run-off\n    //between cand[2] and cand[3]\n\n    int row,col;\n\n    for(row=0;row&lt;=4;row++)                     // used to find the row total\n    {\n        row_totals[row]=0;\n\n        for(col=0;col&lt;=3;col++)\n        {\n            row_totals[row] += votes[row][col];\n        }\n    }\n\n    for(col=0; col &lt;=3; col++)\n    {\n        col_totals[col]=0;\n        for(row =0; row &lt;= 4; row++)            // used to find the column total\n    {\n          col_totals[col] += votes[row][col];\n        }\n    }\n\n    for(row =0; row&lt;=4; row++)\n    {\n        total_votes += row_totals[row]; //finds the total amount of the votes\n    }\n\n\n    printf(\"            Candidate   Candidate   Candidate   Candidate   Total\\n\");\n    printf(\" Precinct:       A           B           C           D       Votes\\n\");  \n    for(row=0;row&lt;=4;row++)\n    {\n        printf(\"%6d\",row+1);\n        for(col=0;col&lt;=3;col++)\n        {\n            printf(\"%12d\",votes[row][col]);\n\n        }\n        printf(\"%11d\\n\",row_totals[row]);\n\n    } \n\n\n\n\nprintf(\"Total\\nVotes:\");\n    for(col=0; col&lt;=3; col++)\n    {\n        printf(\"%12d\", col_totals[col]);\n\n    }\n    printf(\"       %d\", total_votes);\n    printf(\"\\nPrecentage:\");\n    for(col=0; col &lt;= 3; col++)\n    {\n        percent[col] = (col_totals[col] / (double)total_votes);  //calculates percentages\n        printf(\"%11f\", percent[col]);\n    }\nint x,y;\n    for(x=0; x&lt;=3; x++)\n    {\n\nprintf(\"\\n%f\", percent[x]);\n    }\n\n\n\n for(x=0; x&lt;3; x++)\n    {\n        for(y=0;y&lt;(3-x); y++)\n        {\n            if(percent[y] &gt; percent[y+1])\n            {\n                swap = percent[y];\n                percent[y] = percent[y+1];\n                percent[y+1]= swap;\n\n            }\n        }\n    }\n\n    for(col=0; col&lt;4; col++)\n    {\n\nprintf(\"\\n%f\", percent[col]);\n    }\n    return 0;\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 2, "creation_date": 1458756485, "post_id": 36185580, "comment_id": 60006521, "body": "Isn&#39;t it simply the bit-wise OR&#39;ing of the two masks?"}, {"owner": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "edited": false, "score": 0, "creation_date": 1458756708, "post_id": 36185580, "comment_id": 60006664, "body": "Can&#39;t these be hard-coded?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1458931911, "post_id": 36185580, "comment_id": 60083230, "body": "the posted code 1) does not compile. 2) after inserting the statement: #include &lt;stdio.h&gt; and #include &lt;stdint.h&gt; does compile. Then add a main() that calls the function, (which results in a clean compile) then try to execute the code. The resulting masks are not correct . See my answer for the details"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6052509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XrXUJ.jpg?s=128&g=1", "display_name": "BitF", "link": "https://stackoverflow.com/users/6052509/bitf"}, "edited": false, "score": 0, "creation_date": 1458757455, "post_id": 36185688, "comment_id": 60007097, "body": "Oh yes!  I just realized too. And that was pretty dumb of me, to think that some kind of for loop had to be done to generate for the queen&#39;s.  Anyway, thanks for the enlightenment."}], "tags": [], "owner": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "is_accepted": true, "score": 3, "last_activity_date": 1458756756, "creation_date": 1458756756, "answer_id": 36185688, "question_id": 36185580, "link": "https://stackoverflow.com/questions/36185580/how-to-generate-bit-board-occupancy-mask-for-the-queens-move-in-chess/36185688#36185688", "title": "How to generate bit board occupancy mask for the Queen&#39;s move in Chess?", "body": "<p>I think that you can simply take the bit-wise OR'ing of these two masks:</p>\n\n<pre><code>for (bitRef=0; bitRef&lt;=63; bitRef++)\n{\n    occupancyMaskQueen[bitRef] = occupancyMaskRook[bitRef] | occupancyMaskBishop[bitRef];\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1458932375, "creation_date": 1458932375, "answer_id": 36226227, "question_id": 36185580, "link": "https://stackoverflow.com/questions/36185580/how-to-generate-bit-board-occupancy-mask-for-the-queens-move-in-chess/36226227#36226227", "title": "How to generate bit board occupancy mask for the Queen&#39;s move in Chess?", "body": "<p>The posted code contains some errors in the logic for generating the masks  </p>\n\n<p>The following code is for examining the masks.</p>\n\n<p>I have also included some example bad masks.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n\nuint64_t occupancyMaskRook[64];\nuint64_t occupancyMaskBishop[64];\n\nvoid generateOccupancyMasks()\n{\n    int i;\n    int bitRef;\n    uint64_t mask;\n\n    for (bitRef=0; bitRef&lt;=63; bitRef++)\n    {\n        mask = 0;\n        for (i=bitRef+8; i&lt;=55; i+=8) mask |= (((uint64_t)1) &lt;&lt; i);\n        for (i=bitRef-8; i&gt;=8; i-=8) mask |= (((uint64_t)1) &lt;&lt; i);\n        for (i=bitRef+1; i%8!=7 &amp;&amp; i%8!=0 ; i++) mask |= (((uint64_t)1) &lt;&lt; i);\n        for (i=bitRef-1; i%8!=7 &amp;&amp; i%8!=0; i--) mask |= (((uint64_t)1) &lt;&lt; i);\n        occupancyMaskRook[bitRef] = mask;\n\n\n\n        mask = 0;\n        for (i=bitRef+9; i%8!=7 &amp;&amp; i%8!=0 &amp;&amp; i&lt;=55; i+=9) mask |= (((uint64_t)1) &lt;&lt; i);\n        for (i=bitRef-9; i%8!=7 &amp;&amp; i%8!=0 &amp;&amp; i&gt;=8; i-=9) mask |= (((uint64_t)1) &lt;&lt; i);\n        for (i=bitRef+7; i%8!=7 &amp;&amp; i%8!=0 &amp;&amp; i&lt;=55; i+=7) mask |= (((uint64_t)1) &lt;&lt; i);\n        for (i=bitRef-7; i%8!=7 &amp;&amp; i%8!=0 &amp;&amp; i&gt;=8; i-=7) mask |= (((uint64_t)1) &lt;&lt; i);\n        occupancyMaskBishop[bitRef] = mask;\n    }\n\n\n    printf( \"\\n the possible Rook masks\\n\");\n    for( bitRef=0; bitRef &lt; 64; bitRef++ )\n    {\n        for( i = 0; i&lt;8; i++ )\n        {\n            for( int j=0; j&lt;8; j++ )\n            {\n                putchar( occupancyMaskRook[bitRef] &amp; (((uint64_t)1) &lt;&lt; (i*8+j))? '1' : '0');\n            }\n            putchar( '\\n' );\n        }\n        puts( \"\\n\" );\n    }\n\n    printf( \"\\n the possible bishop masks\\n\");\n    for( bitRef=0; bitRef &lt; 64; bitRef++ )\n    {\n        for( i = 0; i&lt;8; i++ )\n        {\n            for( int j=0; j&lt;8; j++ )\n            {\n                putchar( occupancyMaskBishop[bitRef] &amp; (((uint64_t)1) &lt;&lt; (i*8+j))? '1' : '0');\n            }\n            putchar( '\\n' );\n        }\n        puts(\"\\n\");\n    }\n}\n\nint main( void )\n{\n    generateOccupancyMasks();\n    return 0;\n}\n</code></pre>\n\n<p>the following bad mask is for a bishop in row 6, column 1</p>\n\n<p>Note the missing coverage in the row 8, column 3 and the missing coverage in row 1, column 6</p>\n\n<pre><code>00000000\n00001000\n00010000\n00100000\n01000000\n00000000\n01000000\n00000000\n</code></pre>\n\n<p>The above is just an example, there are LOTS more bad masks</p>\n"}], "owner": {"reputation": 3, "user_id": 6052509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XrXUJ.jpg?s=128&g=1", "display_name": "BitF", "link": "https://stackoverflow.com/users/6052509/bitf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 239, "favorite_count": 1, "accepted_answer_id": 36185688, "answer_count": 2, "score": 0, "last_activity_date": 1458932375, "creation_date": 1458756396, "question_id": 36185580, "link": "https://stackoverflow.com/questions/36185580/how-to-generate-bit-board-occupancy-mask-for-the-queens-move-in-chess", "title": "How to generate bit board occupancy mask for the Queen&#39;s move in Chess?", "body": "<p>Recently, I've been studying magic bit boards in the hope of trying to develop my own Chess engine.  I've come across the concept of bit boards.  One of the helpful topics was from the site <a href=\"http://www.rivalchess.com/magic-bitboards/\" rel=\"nofollow\">http://www.rivalchess.com/magic-bitboards/</a> but the example given there are only for Rook and Bishop movement.  Is there by chance anybody who could share the concept to generate the occupancy mask for the Queen?  I paste here the code that was used for Rook and Bishop:</p>\n\n<pre><code>void generateOccupancyMasks()\n    {\n        int i, bitRef;\n        uint64_t mask;\n        for (bitRef=0; bitRef&lt;=63; bitRef++)\n        {\n            mask = 0;\n            for (i=bitRef+8; i&lt;=55; i+=8) mask |= (((uint64_t)1) &lt;&lt; i);\n            for (i=bitRef-8; i&gt;=8; i-=8) mask |= (((uint64_t)1) &lt;&lt; i);\n            for (i=bitRef+1; i%8!=7 &amp;&amp; i%8!=0 ; i++) mask |= (((uint64_t)1) &lt;&lt; i);\n            for (i=bitRef-1; i%8!=7 &amp;&amp; i%8!=0 &amp;&amp; i&gt;=0; i--) mask |= (((uint64_t)1) &lt;&lt; i);\n            occupancyMaskRook[bitRef] = mask;\n\n            mask = 0;\n            for (i=bitRef+9; i%8!=7 &amp;&amp; i%8!=0 &amp;&amp; i&lt;=55; i+=9) mask |= (((uint64_t)1) &lt;&lt; i);\n            for (i=bitRef-9; i%8!=7 &amp;&amp; i%8!=0 &amp;&amp; i&gt;=8; i-=9) mask |= (((uint64_t)1) &lt;&lt; i);\n            for (i=bitRef+7; i%8!=7 &amp;&amp; i%8!=0 &amp;&amp; i&lt;=55; i+=7) mask |= (((uint64_t)1) &lt;&lt; i);\n            for (i=bitRef-7; i%8!=7 &amp;&amp; i%8!=0 &amp;&amp; i&gt;=8; i-=7) mask |= (((uint64_t)1) &lt;&lt; i);\n            occupancyMaskBishop[bitRef] = mask;\n        }\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "function", "pointers", "struct"], "comments": [{"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1458757231, "post_id": 36185473, "comment_id": 60006952, "body": "The function read has to return something.  You don&#39;t need to return a struct human pointer.  You are already passing in a pointer to the struct to be filled in.  You&#39;d be better off returning 0 if success or a non-zero error code in the case of failure. That&#39;s a typical behavior."}], "answers": [{"tags": [], "owner": {"reputation": 32921, "user_id": 5771269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be6a5b618f5bd197150a6186318beba7?s=128&d=identicon&r=PG&f=1", "display_name": "cdlane", "link": "https://stackoverflow.com/users/5771269/cdlane"}, "is_accepted": true, "score": 2, "last_activity_date": 1458781551, "last_edit_date": 1458781551, "creation_date": 1458757884, "answer_id": 36186074, "question_id": 36185473, "link": "https://stackoverflow.com/questions/36185473/pass-array-of-struct-and-return-array-of-struct-using-pointers-function/36186074#36186074", "title": "Pass array of struct and return array of struct using pointers - function", "body": "<p>Your code is close but the pointer logic in the subroutine that fills in the human structure is incorrect.  See if the following rework, and slight simplification, helps you understand how to pass the structure:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define MAXIMUM_HUMANS 90\n#define MAXIMUM_INPUT_STRING_LENGTH 200\n#define MAXIMUM_STRING_LENGTH 40\n\nstruct human {\n    char name[MAXIMUM_STRING_LENGTH];\n    char surname[MAXIMUM_STRING_LENGTH];\n    int age;\n    float weight;\n};\n\nvoid initialize_human(char *string, struct human *man, char *delimiter, char *end) {\n    char *token;\n\n    token = strtok(string, delimiter);\n    strcpy(man-&gt;name, token);\n\n    token = strtok(NULL, delimiter);\n    strcpy(man-&gt;surname, token);\n\n    token = strtok(NULL, delimiter);\n    man-&gt;age = atoi(token);\n\n    token = strtok(NULL, end);\n    man-&gt;weight = atof(token);\n}\n\nint main(int argc, char *argv[]) {\n    char *dlim= \" \", *end = \"\\n\";\n    char string[MAXIMUM_INPUT_STRING_LENGTH];\n    struct human humans[MAXIMUM_HUMANS];\n\n    FILE *fin = fopen(\"data.txt\", \"r\");\n\n    if (fin == NULL) {\n        fprintf(stderr, \"Cannot open file\\n\");\n        exit(1);\n    }\n\n    int population; // after loop, this contains total body count\n\n    for (population = 0; fgets(string, MAXIMUM_INPUT_STRING_LENGTH, fin); population ++) {\n        initialize_human(string, &amp;humans[population], dlim, end);\n    }\n\n    printf(\"population: %d\\n\", population);\n    printf(\"last added: %s who weighs %f\\n\", humans[population - 1].surname, humans[population - 1].weight);  // test if we loaded it up correctly\n\n    fclose(fin);\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 5601732, "user_type": "registered", "accept_rate": 27, "profile_image": "https://lh6.googleusercontent.com/-TiNzHzxbVdQ/AAAAAAAAAAI/AAAAAAAAABE/9GwNCtv0iOU/photo.jpg?sz=128", "display_name": "stellarhawk 34", "link": "https://stackoverflow.com/users/5601732/stellarhawk-34"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1513, "favorite_count": 0, "accepted_answer_id": 36186074, "answer_count": 1, "score": 0, "last_activity_date": 1458781551, "creation_date": 1458756072, "question_id": 36185473, "link": "https://stackoverflow.com/questions/36185473/pass-array-of-struct-and-return-array-of-struct-using-pointers-function", "title": "Pass array of struct and return array of struct using pointers - function", "body": "<p>I realize this question has been asked often but I still dont really understand how it works. I want to try and read my file into my structures, inside a function and pass the structures through pointers to the function. I am unsure about how to even write the function prototype. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define MAX 90\n#define STR 200\n#define MAXLEN 40\n\nstruct human {\n    char name[MAXLEN];\n    char surname[MAXLEN];\n    int age;\n    float weight;\n};\nint main(int argc, char *argv[]) {\n    char *dlim= \" \", *end = \"\\n\";\n    char *string;\n    string = (char *)malloc(sizeof(char) * STR);\n    int i = 0, j = 0;\n    struct human *man = malloc(sizeof(struct human) * MAX);\n\n    FILE *fin = fopen(\"data.txt\", \"r\");\n    if (fin == NULL) {\n        printf(\"Cannot open file\\n\");\n        exit(0);\n    }\n    while (fgets (string, STR, fin)){\n        read (string, &amp;man[i], dlim, end);\n        i++;\n    }\n    fclose(fin);\n\n    free(string);\n    free(man);\n\n  return 0;\n}\n\nstruct human *man read(char *fstring, struct *man, char *div, char *end){\n   int i=0;\n   char *tok;\n\n        tok = strtok(string, dlim);\n        strcpy(man[i].name, tok);\n\n        tok = strtok(NULL, dlim);\n        strcpy(man[i].surname,tok);\n\n        tok = strtok(NULL, dlim);\n        man[i].age = atoi(tok);\n\n        tok = strtok(NULL, end);\n        man[i].weight = atof(tok);\n\n   return man[i];\n\n}\n</code></pre>\n\n<p>Whats the function meant to look like? And am i correct in assuming that through the use of pointers, the struct will be automatically be updated in main, without needing to return something in the function?</p>\n\n<p>Can the function also return nothing (void), because the use of pointers will automatically pass onto main?</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["c", "delphi", "type-conversion"], "comments": [{"owner": {"reputation": 27437, "user_id": 95954, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iD0qO.png?s=128&g=1", "display_name": "Rudy Velthuis", "link": "https://stackoverflow.com/users/95954/rudy-velthuis"}, "edited": false, "score": 0, "creation_date": 1458758247, "post_id": 36185326, "comment_id": 60007586, "body": "FWIW, I recommend reading my article about such conversions, <a href=\"http://rvelthuis.de/articles/articles-convert.html\" rel=\"nofollow noreferrer\">Pitfalls of Converting</a>. It handles these things in depth."}, {"owner": {"reputation": 775, "user_id": 5177407, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/--lRWubl5sJo/AAAAAAAAAAI/AAAAAAAAAB8/vvHal6dWqQE/photo.jpg?sz=128", "display_name": "Denis Petrov", "link": "https://stackoverflow.com/users/5177407/denis-petrov"}, "reply_to_user": {"reputation": 27437, "user_id": 95954, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iD0qO.png?s=128&g=1", "display_name": "Rudy Velthuis", "link": "https://stackoverflow.com/users/95954/rudy-velthuis"}, "edited": false, "score": 0, "creation_date": 1458834006, "post_id": 36185326, "comment_id": 60041657, "body": "Thank you! Awesome article! There&#39;re many usefull things. Why didn&#39;t Google Search find it for me earlier..."}], "answers": [{"comments": [{"owner": {"reputation": 775, "user_id": 5177407, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/--lRWubl5sJo/AAAAAAAAAAI/AAAAAAAAAB8/vvHal6dWqQE/photo.jpg?sz=128", "display_name": "Denis Petrov", "link": "https://stackoverflow.com/users/5177407/denis-petrov"}, "edited": false, "score": 0, "creation_date": 1458832881, "post_id": 36185640, "comment_id": 60040815, "body": "Thnx! I modified 1st function as:  <code>procedure paprika_set_apikey(key: PAnsiChar); cdecl; external &#39;sendanywhere.dll&#39;;</code>  And what do you meen when advice me to remove <code>PAnsiChar</code> and <code>PWideChar</code>? Could you give an example at this function:  <code>PaprikaTask paprika_create_download(const wchar_t* key, const wchar_t* destDirPath);</code> Will it look like <code>function paprika_create_download(key: Pointer; destDirPath: Pointer): PaprikaTask;</code>?"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "reply_to_user": {"reputation": 775, "user_id": 5177407, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/--lRWubl5sJo/AAAAAAAAAAI/AAAAAAAAAB8/vvHal6dWqQE/photo.jpg?sz=128", "display_name": "Denis Petrov", "link": "https://stackoverflow.com/users/5177407/denis-petrov"}, "edited": false, "score": 0, "creation_date": 1458832991, "post_id": 36185640, "comment_id": 60040907, "body": "I didn&#39;t say that. I said &quot;you don&#39;t need the <code>PAnsiChar</code> or <code>PWideChar</code> casts&quot;. Do you know what a cast is? If not, you should look it up. I mean that you don&#39;t need to write <code>PWideChar(&#39;correct_key&#39;)</code> and can write <code>&#39;correct_key&#39;</code>"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "reply_to_user": {"reputation": 775, "user_id": 5177407, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/--lRWubl5sJo/AAAAAAAAAAI/AAAAAAAAAB8/vvHal6dWqQE/photo.jpg?sz=128", "display_name": "Denis Petrov", "link": "https://stackoverflow.com/users/5177407/denis-petrov"}, "edited": false, "score": 0, "creation_date": 1458833067, "post_id": 36185640, "comment_id": 60040964, "body": "So that function can be <code>function paprika_create_download(key: PWideChar; destDirPath: PWideChar): PaprikaTask; cdecl; external &#39;sendanywhere.dll&#39;;</code> since the <code>const</code> serves no purpose, and when you call it you don&#39;t need to cast the literals. Do you know what a literal is? Again, if you don&#39;t you need to know. This terminology is critical."}, {"owner": {"reputation": 775, "user_id": 5177407, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/--lRWubl5sJo/AAAAAAAAAAI/AAAAAAAAAB8/vvHal6dWqQE/photo.jpg?sz=128", "display_name": "Denis Petrov", "link": "https://stackoverflow.com/users/5177407/denis-petrov"}, "edited": false, "score": 0, "creation_date": 1458838657, "post_id": 36185640, "comment_id": 60044836, "body": "Thanks a lot. I know what it&#39;s mean. It was just my bad english interpretation. Sorry."}], "tags": [], "owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "is_accepted": false, "score": 1, "last_activity_date": 1458757433, "last_edit_date": 1458757433, "creation_date": 1458756578, "answer_id": 36185640, "question_id": 36185326, "link": "https://stackoverflow.com/questions/36185326/converting-c-functions-in-delphi-10-seattle/36185640#36185640", "title": "Converting C functions in Delphi 10 Seattle", "body": "<pre><code>procedure paprika_set_apikey(const key: PChar); cdecl; external 'sendanywhere.dll';\n</code></pre>\n\n<p>This is wrong. <code>PChar</code> is an alias to <code>PWideChar</code>. The type should be <code>PAnsiChar</code>. </p>\n\n<p>As an aside you don't need the <code>PAnsiChar</code> or <code>PWideChar</code> casts when passing literals. Remove them to simplify the code. </p>\n\n<p>Further, your use of <code>const</code> in parameters has a different meaning from that in the C++ code, and is in any case meaningless in an external declaration. I personally would remove those modifiers and pass the pointers as plain value params. </p>\n"}], "owner": {"reputation": 775, "user_id": 5177407, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/--lRWubl5sJo/AAAAAAAAAAI/AAAAAAAAAB8/vvHal6dWqQE/photo.jpg?sz=128", "display_name": "Denis Petrov", "link": "https://stackoverflow.com/users/5177407/denis-petrov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1458831143, "creation_date": 1458755542, "last_edit_date": 1458831143, "question_id": 36185326, "link": "https://stackoverflow.com/questions/36185326/converting-c-functions-in-delphi-10-seattle", "title": "Converting C functions in Delphi 10 Seattle", "body": "<p>I'm trying to convert <a href=\"https://github.com/estmob/SendAnywhere-Desktop-SDK/blob/master/SDK/include/internal/paprika.h\" rel=\"nofollow\">API SendAnywhere header file</a> from C to Delphi 10 code for Windows.</p>\n\n<p>Using <a href=\"http://docwiki.embarcadero.com/RADStudio/Seattle/en/Delphi_to_C%2B%2B_types_mapping\" rel=\"nofollow\">presented table of Embarcadero</a> I successfully convert some of the functions:</p>\n\n<pre><code>typedef void* PaprikaTask;\ntypedef void* PaprikaAuthToken;\n\n__declspec(dllexport) void paprika_set_apikey(const char* key);\n__declspec(dllexport) PaprikaAuthToken paprika_auth_create();\n__declspec(dllexport) PaprikaAuthToken paprika_auth_create_with_deviceid(const char* id, const char* password);\n__declspec(dllexport) void paprika_auth_close(PaprikaAuthToken auth);\n__declspec(dllexport) bool paprika_is_running(PaprikaTask task);\n__declspec(dllexport) PaprikaTask paprika_create_download(const wchar_t* key, const wchar_t* destDirPath);\n__declspec(dllexport) void paprika_start(PaprikaTask task);\n</code></pre>\n\n<p>This is my conversion:</p>\n\n<pre><code>PaprikaAuthToken = Pointer;\nPaprikaTask = Pointer;\n\nprocedure paprika_set_apikey(const key: PChar); cdecl; external 'sendanywhere.dll';\nfunction paprika_auth_create: PaprikaAuthToken; cdecl; external 'sendanywhere.dll';\nfunction paprika_auth_create_with_deviceid(const id: PAnsiChar; const password: PAnsiChar): PaprikaAuthToken; cdecl; external 'sendanywhere.dll';\nprocedure paprika_auth_close(auth: PaprikaAuthToken); cdecl; external 'sendanywhere.dll';\nfunction paprika_is_running(task: PaprikaTask): Boolean; cdecl; external 'sendanywhere.dll';\nfunction paprika_create_download(const key: PWideChar; const destDirPath: PWideChar): PaprikaTask; cdecl; external 'sendanywhere.dll';\nprocedure paprika_start(task: PaprikaTask); cdecl; external 'sendanywhere.dll';\n</code></pre>\n\n<p>Example from SendAnywhere uses these functions as follows:</p>\n\n<pre><code>PaprikaTask pTask;\nPaprikaAuthToken gToken;\n\npaprika_set_apikey(\"YOUR_API_KEY\");\ngToken = paprika_auth_create();\npTask = paprika_create_download(L\"KEY\", L\"/tmp\"); \npaprika_set_auth(pTask, gToken);\npaprika_start(pTask);\n</code></pre>\n\n<p>This is how I interpreted the proper code:</p>\n\n<pre><code>var\nFAuthToken: PaprikaAuthToken;\nFOption: PaprikaOption;   \n\npaprika_set_apikey(PChar('my_correct_api_key'));\nFAuthToken = paprika_auth_create();\n// backslash for windows\nFTask := paprika_create_download(PWideChar('correct_key'), PWideChar('\\tmp')); //directory exists\npaprika_set_auth(FTask, FAuthToken);\npaprika_start(FTask);\n</code></pre>\n\n<p>I checked the work of the task by function <strong>paprika_is_running</strong>. It returns <strong>FALSE</strong> before calling <strong>paprika_start_function</strong>. It begins to return <strong>TRUE</strong> after calling <strong>paprika_start_function</strong> but after 1-2 seconds (regardless of the size of the transferring file) it returns <strong>FALSE</strong>.\nThis means that the function is working, but it seems that the problem is in the arguments.</p>\n\n<p><em>Please tell me where I am going wrong?</em></p>\n\n<p>Maybe there is an incorrect conversion from <strong>string</strong> to <strong>TWideChar</strong>.\nOr the path of the directory is passed incorrectly, for example and used an incorrect slash. I've tried different paths:</p>\n\n<p>('C:/', 'C:\\', 'C:', 'file://C:', 'file://C:/', '/', '\\', '')</p>\n\n<p><em>What is incorrect? Help please. I need your assistance.</em></p>\n"}, {"tags": ["c", "bash", "fgets"], "comments": [{"owner": {"reputation": 51553, "user_id": 557306, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/OAmpG.jpg?s=128&g=1", "display_name": "sidyll", "link": "https://stackoverflow.com/users/557306/sidyll"}, "edited": false, "score": 0, "creation_date": 1458756249, "post_id": 36185321, "comment_id": 60006380, "body": "It depends on your terminal (or other input system you&#39;re using)."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1458757938, "post_id": 36185321, "comment_id": 60007386, "body": "Are you having the problem that <code>0x04</code> is control-D is EOF?"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1458759865, "post_id": 36185321, "comment_id": 60008480, "body": "@SteveSummit 0x04 is described as EOT in the ascii table, this is a char used by various serial transmission protocols as end of transmission. This, however, has nothing to do with ctrl+d on the console which on many systems results in an EOF on the input stream."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1458760935, "post_id": 36185321, "comment_id": 60009160, "body": "@Ctx Sure, but if I wanted to send the byte represented by hex \\x04 to my program, I&#39;d simply type control-D, and unless I was careful I&#39;d get EOF instead, and that <i>might</i> be user6105782&#39;s problem."}], "answers": [{"tags": [], "owner": {"reputation": 57412, "user_id": 236465, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IoAkG.jpg?s=128&g=1", "display_name": "Diego Torres Milano", "link": "https://stackoverflow.com/users/236465/diego-torres-milano"}, "is_accepted": false, "score": 2, "last_activity_date": 1458756883, "creation_date": 1458756883, "answer_id": 36185732, "question_id": 36185321, "link": "https://stackoverflow.com/questions/36185321/sending-arbitrary-bytes-to-fgets-from-stdin/36185732#36185732", "title": "Sending arbitrary bytes to fgets from stdin", "body": "<p>You can do</p>\n\n<pre><code>$ echo -n -e '\\x04' | your-program\n</code></pre>\n\n<p><em>NOTE:</em> On POSIX <code>echo</code> only octal values are allowed.</p>\n"}, {"tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": false, "score": 1, "last_activity_date": 1458757880, "creation_date": 1458757880, "answer_id": 36186072, "question_id": 36185321, "link": "https://stackoverflow.com/questions/36185321/sending-arbitrary-bytes-to-fgets-from-stdin/36186072#36186072", "title": "Sending arbitrary bytes to fgets from stdin", "body": "<p>If you can get the bytes you want into a file, you can run</p>\n\n<pre><code>your-program &lt; file\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6105782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49c3847fa47e699c30f622898ed9ce3d?s=128&d=identicon&r=PG&f=1", "display_name": "user6105782", "link": "https://stackoverflow.com/users/6105782/user6105782"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 732, "favorite_count": 0, "closed_date": 1458766152, "answer_count": 2, "score": -1, "last_activity_date": 1458757880, "creation_date": 1458755516, "question_id": 36185321, "link": "https://stackoverflow.com/questions/36185321/sending-arbitrary-bytes-to-fgets-from-stdin", "closed_reason": "Needs more focus", "title": "Sending arbitrary bytes to fgets from stdin", "body": "<p>I'm prompting for a user supplied string using fgets(user_input, input_len, stdin).  How can I send, for instance, the byte represented by hex \\x04 to the program?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 3, "creation_date": 1458755308, "post_id": 36185199, "comment_id": 60005819, "body": "<code>*MyArray[499]</code> should be <code>MyArray[499]</code>."}, {"owner": {"reputation": 2405, "user_id": 2216129, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/U0xqx.jpg?s=128&g=1", "display_name": "Topological Sort", "link": "https://stackoverflow.com/users/2216129/topological-sort"}, "edited": false, "score": 0, "creation_date": 1458763898, "post_id": 36185199, "comment_id": 60010825, "body": "MyArray is initialized, but its members are not.  So you&#39;ll be printing an uninitialized variable, that is, garbage.  Quite aside from the syntax error."}], "answers": [{"tags": [], "owner": {"reputation": 414, "user_id": 4880090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9731995440b63d4cbf69257df481c87?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Kolokowsky", "link": "https://stackoverflow.com/users/4880090/steve-kolokowsky"}, "is_accepted": true, "score": 1, "last_activity_date": 1458762489, "last_edit_date": 1458762489, "creation_date": 1458762287, "answer_id": 36187344, "question_id": 36185199, "link": "https://stackoverflow.com/questions/36185199/how-do-i-print-the-memory-address-of-void/36187344#36187344", "title": "How do i print the memory address of void**?", "body": "<p>You allocate memory to hold an array to hold a bunch of void pointers.  This array doesn't contain any pointers yet.  If you want the address of the last position in the array, do this:</p>\n\n<pre><code>int main(){\n    void** MyArray = malloc(500 * sizeof(void*));\n    printf(\"Last pointer is located at: %p\\n\", (void *)&amp;(MyArray[499]));\n    free(MyArray);\n    return 0;\n\n}\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 6105697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3461e8fc6a2bb298434151921a297e3f?s=128&d=identicon&r=PG&f=1", "display_name": "Magic code", "link": "https://stackoverflow.com/users/6105697/magic-code"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 626, "favorite_count": 0, "closed_date": 1458768431, "accepted_answer_id": 36187344, "answer_count": 1, "score": -2, "last_activity_date": 1458762489, "creation_date": 1458755115, "last_edit_date": 1458755696, "question_id": 36185199, "link": "https://stackoverflow.com/questions/36185199/how-do-i-print-the-memory-address-of-void", "closed_reason": "Duplicate", "title": "How do i print the memory address of void**?", "body": "<p>I am trying to print the void* memory address inside void**, like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(){\n\n    void** MyArray = malloc(500 * sizeof(void*));\n    printf(\"Last pointer: %p\\n\", *MyArray[499]);\n    free(MyArray);\n    return 0;\n\n}\n</code></pre>\n\n<p>But when i try to compile I get a warning and an error:</p>\n\n<blockquote>\n  <ol>\n  <li>Line: 6   Col: 31 in D:\\C\\test.c  [Warning] dereferencing 'void *' pointer</li>\n  <li>Line: 6 Col: 2 in D:\\C\\test.c [Error] invalid use of void expression</li>\n  </ol>\n</blockquote>\n\n<p>What I'm doing wrong? Thanks</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 56328, "user_id": 4265352, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lzAUc5pYb24/AAAAAAAAAAI/AAAAAAAAAGQ/q3h7bZUnqrs/photo.jpg?sz=128", "display_name": "axiac", "link": "https://stackoverflow.com/users/4265352/axiac"}, "edited": false, "score": 1, "creation_date": 1458754898, "post_id": 36185082, "comment_id": 60005558, "body": "<i><code>int BinaryRepForDisk1=1101</code></i> -- this is not a number represented in binary. It is one thousand one hundred and one."}, {"owner": {"reputation": 1077, "user_id": 4420609, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xB2by.png?s=128&g=1", "display_name": "jadhachem", "link": "https://stackoverflow.com/users/4420609/jadhachem"}, "edited": false, "score": 1, "creation_date": 1458754950, "post_id": 36185082, "comment_id": 60005583, "body": "<code>111</code> and <code>0111</code> are equal."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 1077, "user_id": 4420609, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xB2by.png?s=128&g=1", "display_name": "jadhachem", "link": "https://stackoverflow.com/users/4420609/jadhachem"}, "edited": false, "score": 1, "creation_date": 1458754983, "post_id": 36185082, "comment_id": 60005604, "body": "@jadhachem: Ehm... no!"}, {"owner": {"reputation": 21, "user_id": 6080164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d4306ab6416534028150f2abd22f3e6?s=128&d=identicon&r=PG&f=1", "display_name": "user302686", "link": "https://stackoverflow.com/users/6080164/user302686"}, "edited": false, "score": 0, "creation_date": 1458754991, "post_id": 36185082, "comment_id": 60005611, "body": "yes but think as if it is binary"}, {"owner": {"reputation": 12144, "user_id": 72882, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9d17e71eae127205da470fffa2dba899?s=128&d=identicon&r=PG", "display_name": "dandan78", "link": "https://stackoverflow.com/users/72882/dandan78"}, "edited": false, "score": 0, "creation_date": 1458755017, "post_id": 36185082, "comment_id": 60005625, "body": "Please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>. <i>How can I fix it</i> says absoluely nothing about the problem you&#39;re having. Your question itself is basically a debugging request with very little information, which makes it off-topic here."}, {"owner": {"reputation": 20558, "user_id": 2864275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p2xKk.png?s=128&g=1", "display_name": "I\u0142ya Bursov", "link": "https://stackoverflow.com/users/2864275/i%c5%82ya-bursov"}, "edited": false, "score": 0, "creation_date": 1458755027, "post_id": 36185082, "comment_id": 60005632, "body": "why it should give <code>0111</code>?"}, {"owner": {"reputation": 1077, "user_id": 4420609, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xB2by.png?s=128&g=1", "display_name": "jadhachem", "link": "https://stackoverflow.com/users/4420609/jadhachem"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458755052, "post_id": 36185082, "comment_id": 60005650, "body": "@Olaf yes, seeing as the result <code>Disk3</code> is being printed as <code>printf(&quot;%d&quot;)</code>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 1077, "user_id": 4420609, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xB2by.png?s=128&g=1", "display_name": "jadhachem", "link": "https://stackoverflow.com/users/4420609/jadhachem"}, "edited": false, "score": 0, "creation_date": 1458755100, "post_id": 36185082, "comment_id": 60005687, "body": "@jadhachem: Ok, as an output it is. Sorry, the question is a bit confusing."}, {"owner": {"reputation": 12144, "user_id": 72882, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9d17e71eae127205da470fffa2dba899?s=128&d=identicon&r=PG", "display_name": "dandan78", "link": "https://stackoverflow.com/users/72882/dandan78"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458755148, "post_id": 36185082, "comment_id": 60005722, "body": "@olaf If it&#39;s confusing, don&#39;t answer it. We have close reasons for confusing questions."}, {"owner": {"reputation": 21, "user_id": 6080164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d4306ab6416534028150f2abd22f3e6?s=128&d=identicon&r=PG&f=1", "display_name": "user302686", "link": "https://stackoverflow.com/users/6080164/user302686"}, "edited": false, "score": 1, "creation_date": 1458755218, "post_id": 36185082, "comment_id": 60005768, "body": "sorry i m new here"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1458755238, "post_id": 36185082, "comment_id": 60005777, "body": "Note that <code>int %2</code> will result in <code>0,1,-1</code>.  Recommend using <code>unsigned</code> types or <code>&amp;1</code> to get only 2 different results <code>0,1</code>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 12144, "user_id": 72882, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9d17e71eae127205da470fffa2dba899?s=128&d=identicon&r=PG", "display_name": "dandan78", "link": "https://stackoverflow.com/users/72882/dandan78"}, "edited": false, "score": 0, "creation_date": 1458755249, "post_id": 36185082, "comment_id": 60005782, "body": "@dandan78: Thanks for the info. I really was not aware. Oh, and comments are not to be used for answers. Sorry, if that looked like an answer to you."}], "answers": [{"comments": [{"owner": {"reputation": 51553, "user_id": 557306, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/OAmpG.jpg?s=128&g=1", "display_name": "sidyll", "link": "https://stackoverflow.com/users/557306/sidyll"}, "edited": false, "score": 0, "creation_date": 1458755047, "post_id": 36185172, "comment_id": 60005648, "body": "But I recommend using real binary representations and xor operation, unless you&#39;re doing this for some other purpose."}, {"owner": {"reputation": 21, "user_id": 6080164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d4306ab6416534028150f2abd22f3e6?s=128&d=identicon&r=PG&f=1", "display_name": "user302686", "link": "https://stackoverflow.com/users/6080164/user302686"}, "edited": false, "score": 0, "creation_date": 1458755392, "post_id": 36185172, "comment_id": 60005864, "body": "but value of BinaryRepForDisk1 and BinaryRepForDisk2 is changeable. I wrote these values as an example"}], "tags": [], "owner": {"reputation": 51553, "user_id": 557306, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/OAmpG.jpg?s=128&g=1", "display_name": "sidyll", "link": "https://stackoverflow.com/users/557306/sidyll"}, "is_accepted": false, "score": 0, "last_activity_date": 1458755038, "creation_date": 1458755038, "answer_id": 36185172, "question_id": 36185082, "link": "https://stackoverflow.com/questions/36185082/c-comparing-binary-numbers-with-xor/36185172#36185172", "title": "C comparing binary numbers with xor", "body": "<p>It is the same number, because you're working with decimals. The only thing is that, if you want the print result to be enforced to be 4 digits and padded with zeroes, use a different print formatter instead:</p>\n\n<pre><code>printf(\"%04d\",Disk3);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3330, "user_id": 5684370, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/17e28adec94010c4a5b5a21af7b15745?s=128&d=identicon&r=PG", "display_name": "ganchito55", "link": "https://stackoverflow.com/users/5684370/ganchito55"}, "is_accepted": false, "score": 0, "last_activity_date": 1458755348, "creation_date": 1458755348, "answer_id": 36185270, "question_id": 36185082, "link": "https://stackoverflow.com/questions/36185082/c-comparing-binary-numbers-with-xor/36185270#36185270", "title": "C comparing binary numbers with xor", "body": "<p>If you are working with binary numbers, you need to use <strong>0b</strong> before the number:</p>\n\n<pre><code>int BinaryDisk1 = 0b1101, BinaryDisk2 = 0b1010;\n</code></pre>\n\n<p>C also have a xor bit a bit:</p>\n\n<pre><code>int result = BinaryDisk1 ^ BinaryDisk2;\n</code></pre>\n\n<p>I hope this can help you.</p>\n"}, {"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 0, "last_activity_date": 1458755392, "creation_date": 1458755392, "answer_id": 36185290, "question_id": 36185082, "link": "https://stackoverflow.com/questions/36185082/c-comparing-binary-numbers-with-xor/36185290#36185290", "title": "C comparing binary numbers with xor", "body": "<p>When you use</p>\n\n<pre><code>int BinaryRepForDisk1=1101, BinaryRepForDisk2=1010;\n</code></pre>\n\n<p>You are initializing <code>BinaryRepForDisk1</code> to the decimal number <code>1101</code>, not the binary number <code>1101</code>. To get the decimal equivalent of the binary <code>1101</code>, you can use:</p>\n\n<pre><code>int BinaryRepForDisk1= ( (1 &lt;&lt; 3) + (1 &lt;&lt; 2) + 0 + 1);\n// You can use (0 &lt;&lt; 1) to keep the familiar structure but its not needed.\n</code></pre>\n\n<p>If your compiler supports binary literals, you can use:</p>\n\n<pre><code>int BinaryRepForDisk1= 0b1101;\n</code></pre>\n\n<p>You can make similar adjustments to the value of <code>BinaryRepForDisk2</code>.</p>\n"}], "owner": {"reputation": 21, "user_id": 6080164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d4306ab6416534028150f2abd22f3e6?s=128&d=identicon&r=PG&f=1", "display_name": "user302686", "link": "https://stackoverflow.com/users/6080164/user302686"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 734, "favorite_count": 0, "closed_date": 1458764166, "answer_count": 3, "score": -4, "last_activity_date": 1458755581, "creation_date": 1458754775, "last_edit_date": 1458755581, "question_id": 36185082, "link": "https://stackoverflow.com/questions/36185082/c-comparing-binary-numbers-with-xor", "closed_reason": "Duplicate", "title": "C comparing binary numbers with xor", "body": "<p>this is part of the code. Here, I want to compare digits by xor.\nSo it suppose to give \"0111\" but it gives \"111\" as result.\nHow can I fix it?\nSo it suppose to give \"0111\" but it gives \"111\" as result.\nHow can I fix it?</p>\n\n<pre><code>1 and 1 = 0\n1 and 0 = 1\n0 and 1 = 1\n0 and 0 = 0\n\n\n\n#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;math.h&gt;\nint main()\n\n{   \n    int BinaryRepForDisk1=1101, BinaryRepForDisk2=1010, Disk3=0, xor1, xor2, power=0;\n\n    while(BinaryRepForDisk1!=0)\n    {\n        xor1=BinaryRepForDisk1%2;\n        xor2=BinaryRepForDisk2%2;\n\n        if(xor1==xor2)\n        {\n            Disk3=Disk3+pow(10,power)*0;\n            power++;\n        }\n\n        else\n        {\n            Disk3=Disk3+pow(10,power)*1;\n            power++;        \n        }   \n\n        BinaryRepForDisk1=BinaryRepForDisk1/10;\n        BinaryRepForDisk2=BinaryRepForDisk2/10;\n    }   \n    printf(\"%d\",Disk3);\n\n\n\n    system(\"pause\");\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "strtok"], "comments": [{"owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "reply_to_user": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "edited": false, "score": 0, "creation_date": 1458754232, "post_id": 36184826, "comment_id": 60005132, "body": "@user3121023 I think that&#39;s worth an answer"}, {"owner": {"reputation": 29, "user_id": 5459876, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/981f2193cb7e3f97a4d0b43455e82426?s=128&d=identicon&r=PG&f=1", "display_name": "Dragos2795", "link": "https://stackoverflow.com/users/5459876/dragos2795"}, "reply_to_user": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "edited": false, "score": 0, "creation_date": 1458754391, "post_id": 36184826, "comment_id": 60005243, "body": "@user3121023 Oh my God, you are right... I was not accounting a trivial fact. Thank you so much"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1458755178, "post_id": 36184826, "comment_id": 60005745, "body": "Use <code>fgets</code> and add <code>\\n</code> to the <code>strtok</code> separators."}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1458779305, "post_id": 36184826, "comment_id": 60017172, "body": "Beware that if you want to handle escaped characters and quoted arguments, you will need something a bit better than <code>strtok</code> or <code>sscanf</code>.  Still, it&#39;s pretty straight-forward to roll something like that."}], "answers": [{"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1458778657, "creation_date": 1458778657, "answer_id": 36191123, "question_id": 36184826, "link": "https://stackoverflow.com/questions/36184826/strtok-does-not-returns-all-the-tokens/36191123#36191123", "title": "strtok does not returns all the tokens", "body": "<p>Given the following code:</p>\n\n<pre><code>char *buffer2 = malloc(1024*sizeof(char));\nscanf(\"%s\",buffer2);\nchar *command = strtok(buffer2,\" \");\n\nif (strcmp(command,\"INFO\") == 0)\n{\n    char *file_path = strtok(NULL,\" \");\n    if (file_path != NULL)\n     {\n        info(file_path);\n     }\n}\n</code></pre>\n\n<p>the expression 'sizeof(char)' is defined by the standard as 1.\nMultiplying anything by 1 will not change its' value\nand has no effect on the parameter passed to <code>malloc()</code>.</p>\n\n<p>However, it does clutter the code, making understanding, debugging, and maintenance more difficult.</p>\n\n<p>Suggest removing that expression.</p>\n\n<p>when calling <code>scanf()</code></p>\n\n<ol>\n<li>always check the returned value to assure the operation was successful.</li>\n<li>when using the \"%s\" format specifier..\nmust use a max input characters modifier, so the user cannot overrun the input <code>buffer2</code></li>\n<li>the \"%s\" format specifier will stop inputting when encountering any 'white space'\nThe call to <code>strtok()</code> will not find anything but the whole input line.\nbecause the input will have stopped before inputting any spaces\nbecause a <code>space</code> is one of the 'white space' characters.</li>\n</ol>\n\n<p>Suggest the following code:</p>\n\n<pre><code>#define BUFFER_LEN (1024)\nchar *buffer2 = NULL;\nif( NULL == (buffer2 = malloc( BUFFER_LEN ) ) )\n{ // then malloc failed\n    perror( \"malloc for 1024 bytes failed\")\n    exit( EXIT_FAILURE );\n}\n\n// implied else, malloc successful\n\nif( !fgets( buffer2, BUFFER_LEN, stdin ) )\n{// then, fgets failed\n    perror( \"fgets from stdin failed\");\n    exit( EXIT_FAILURE )''\n}\n\n// implied else, fgets successful\n\nchar *command = NULL;\n\nif( NULL != (command = strtok(buffer2,\" \\n\") ) )\n{\n    if (strcmp(command,\"INFO\") == 0)\n    {\n        char *file_path = NULL;\n        if( NULL != (file_path = strtok(NULL,\" \\n\") ) )\n        {\n            info(file_path);\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 5459876, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/981f2193cb7e3f97a4d0b43455e82426?s=128&d=identicon&r=PG&f=1", "display_name": "Dragos2795", "link": "https://stackoverflow.com/users/5459876/dragos2795"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 250, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1458778657, "creation_date": 1458753957, "question_id": 36184826, "link": "https://stackoverflow.com/questions/36184826/strtok-does-not-returns-all-the-tokens", "title": "strtok does not returns all the tokens", "body": "<p>I have the following snippet of code:</p>\n\n<pre><code>char *buffer2 = malloc(1024*sizeof(char));\n    scanf(\"%s\",buffer2);\n    char *command = strtok(buffer2,\" \");\n\n    if (strcmp(command,\"INFO\") == 0)\n    {\n        char *file_path = strtok(NULL,\" \");\n        if (file_path != NULL)\n         {\n            info(file_path);\n         }\n    }\n</code></pre>\n\n<p>My goal is : given a string like \"CMD_NAME ARG1 ARG2\" ... to tokenize the string according this format. So far so good, I have written the above code, it compiles, the program does not crash ,but the outcome is ,however, wrong in the sense that if I input the string \"INFO work/file1.sf\" the command is parsed properly but for the file_path the strtok function returns a NULL pointer. I have been struggling with this for hours , I have read the documentation for this function, I have searched other responses on this subject ,but none of the them were satisfactory. If you have a clue of what I'm doing wrong please help me. </p>\n"}, {"tags": ["c", "debugging", "atoi"], "comments": [{"owner": {"reputation": 2223, "user_id": 325181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26de4aa17ab84757b1233714af5fec84?s=128&d=identicon&r=PG", "display_name": "Clarus", "link": "https://stackoverflow.com/users/325181/clarus"}, "edited": false, "score": 1, "creation_date": 1458753899, "post_id": 36184742, "comment_id": 60004902, "body": "You need atoi(ptr) or atoi(ptr+index);"}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "reply_to_user": {"reputation": 2223, "user_id": 325181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26de4aa17ab84757b1233714af5fec84?s=128&d=identicon&r=PG", "display_name": "Clarus", "link": "https://stackoverflow.com/users/325181/clarus"}, "edited": false, "score": 0, "creation_date": 1458754005, "post_id": 36184742, "comment_id": 60004970, "body": "@Claris, I think OP is trying to convert single characters to integers, <code>ptr+index</code> will convert the remainder of the string"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 3, "creation_date": 1458754116, "post_id": 36184742, "comment_id": 60005051, "body": "Don&#39;t post images of text!"}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 1, "creation_date": 1458754677, "post_id": 36184742, "comment_id": 60005437, "body": "<code>if(comp&lt;min) min=value;</code> &lt;-- where&#39;s <code>comp</code> coming from, and what&#39;s the type of <code>min</code>?"}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1458756285, "post_id": 36184742, "comment_id": 60006405, "body": "Please only post real code - the code above does not even compile (where is <code>t1</code> defined, for example ?)."}], "answers": [{"comments": [{"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1458756163, "post_id": 36184833, "comment_id": 60006329, "body": "@chux: Changed to double quotes, I do mention <i>&quot;The C standard requires numeric characters to be sequential&quot;</i>, and I then go on to use the ASCII values as an example. No need to bombard the OP with info about various character sets like EBCDIC :)"}], "tags": [], "owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "is_accepted": false, "score": 3, "last_activity_date": 1458756111, "last_edit_date": 1592644375, "creation_date": 1458753969, "answer_id": 36184833, "question_id": 36184742, "link": "https://stackoverflow.com/questions/36184742/c-atoi-function-not-working/36184833#36184833", "title": "c atoi() function not working", "body": "<p>Look at the signature of <code>atoi</code>:</p>\n<pre><code>int atoi(const char *);\n</code></pre>\n<p>The function expects the argument to be of the type <code>char *</code>. You're passing <code>ptr[index]</code>, which is of the type <code>char</code>.<br>\nThe simple solution would be to use a local variable:</p>\n<pre><code>char digit[2] = &quot;&quot;;\n</code></pre>\n<p>And then set the first character to the value you want to process:</p>\n<pre><code>digit[0] = ptr[index];\nint value = atoi(digit);\n</code></pre>\n<p>because <code>digit</code> is of the type <code>char[]</code>, it will decay into a pointer when passing it to the function</p>\n<hr />\n<p>But that would be messy. There's an easier way. The C standard requires numeric characters to be sequential, so a common trick to convert numeric characters to their integer values is to write this:</p>\n<pre><code>int value = ptr[index] - '0';\n</code></pre>\n<p>This works because, in ASCII for example, the numeric value of <code>'0'</code> is 48, <code>'1'</code> is 49, 2 is 50 and so on. Therefore, if you have a string like this:</p>\n<pre><code>&quot;1234&quot;\n</code></pre>\n<p>and you iterate over each character, subtracting <code>'0'</code> from each, you'll get:</p>\n<pre><code>49 - 48 = 1\n50 - 48 = 2\n51 - 48 = 3\n52 - 48 = 4\n</code></pre>\n<p>Basically doing what you want/need</p>\n<hr />\n<h1>Hang on</h1>\n<p>I just noticed you're actually iterating over <code>argv</code>. Your <em>cast</em> is incorrect!</p>\n<pre><code>char *ptr=(char *) param;\n</code></pre>\n<p>Should actually be:</p>\n<pre><code>char **ptr = param;\n</code></pre>\n<p>Because <code>argv</code> is a <code>char **</code> (pointer to pointer).</p>\n<p>You're also doing some weird things here:</p>\n<p>If what you're actually trying to do is compare all arguments that were passed and pick the lowest number from them, then this is what you should write:</p>\n<pre><code>char **ptr= param; //no need for cast, void * is compatible with char **\nint i = 1;\nmin = atoi(ptr[1]);//assuming min is int, because you're assigning value to it later on\nfor(i; i&lt;num; ++i)\n{\n     int value = atoi(ptr[i]);\n     if(value &lt; min)//replaced comp with value, because I can't see the comp variable anywhere\n         min = value;\n}\n</code></pre>\n"}], "owner": {"reputation": 191, "user_id": 5401992, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/Ao2WK.jpg?s=128&g=1", "display_name": "Aisha Javed", "link": "https://stackoverflow.com/users/5401992/aisha-javed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1459, "favorite_count": 1, "closed_date": 1458764642, "answer_count": 1, "score": -1, "last_activity_date": 1458756111, "creation_date": 1458753707, "question_id": 36184742, "link": "https://stackoverflow.com/questions/36184742/c-atoi-function-not-working", "closed_reason": "Not suitable for this site", "title": "c atoi() function not working", "body": "<p>Here is my code. The statement, int value=atoi(ptr[index]) in findMin() function ,gives an error as shown in screenshot. </p>\n\n<p><a href=\"https://i.stack.imgur.com/drRaB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/drRaB.png\" alt=\"enter image description here\"></a></p>\n\n<p>The strange thing is that when I use the same atoi() function in main, everything works pretty fine but it screams in findMin!</p>\n\n<pre><code>CODE:\nvoid* findMin(void *param); \n\nint main(int argc, char *argv[])\n{\n\n    pthread_t t2; //for min\n    num=argc;\n\n    /*int index=1; THIS WORKS \n    int value=atoi(argv[index]);*/\n\n    //creating worker thread\n    pthread_create(&amp;t1,NULL,findMin,argv);\n\n    pthread_join(t2,NULL); //wait for min\n    printf(\"The minimum value is %d\\n\",min);\n\n\n    return 0;\n}\n\nvoid* findMin(void *param) \n{\n    char *ptr=(char *) param; //casting \n    int index=1;\n    min=ptr[1];\n    for(index; index&lt;num; index++)\n    {\n         int value=atoi(ptr[index]); //THIS SCREAMS LIKE HELL!\n         if(comp&lt;min) min=value;\n\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "gcc", "compiler-optimization"], "comments": [{"owner": {"reputation": 1867, "user_id": 4483861, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/2dtp8.jpg?s=128&g=1", "display_name": "Jonatan &#214;str&#246;m", "link": "https://stackoverflow.com/users/4483861/jonatan-%c3%96str%c3%b6m"}, "edited": false, "score": 0, "creation_date": 1593160435, "post_id": 36184449, "comment_id": 110688214, "body": "GCC recommends -Og over -O0 for debug. Then you probably don&#39;t need different flags. But -O2 or -O3 for opt.c, could help a lot unless it compiles too slowly."}], "answers": [{"comments": [{"owner": {"reputation": 1907, "user_id": 95880, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/BjZGr.jpg?s=128&g=1", "display_name": "kp11", "link": "https://stackoverflow.com/users/95880/kp11"}, "edited": false, "score": 0, "creation_date": 1458753174, "post_id": 36184466, "comment_id": 60004452, "body": "As it is a large application, there could be a possibility of error introduction (?) and would require additional testing. To avoid this, it is applied on one file."}, {"owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "reply_to_user": {"reputation": 1907, "user_id": 95880, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/BjZGr.jpg?s=128&g=1", "display_name": "kp11", "link": "https://stackoverflow.com/users/95880/kp11"}, "edited": false, "score": 4, "creation_date": 1458760766, "post_id": 36184466, "comment_id": 60009044, "body": "@kp11 Optimizations causes problems only when either there are bugs in the code or, much less likely, there are bugs in the compiler or the toolchain. It&#39;s highly recommended that you maximally optimize all your code and resolve any resulting issues. That said, I approve this answer."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "edited": false, "score": 2, "creation_date": 1460573962, "post_id": 36184466, "comment_id": 60811343, "body": "@HadiBrais: In some cases, optimizations can also wreak havoc on code written for dialects of C which offer useful behaviors and guarantees beyond those mandated by the Standard; in some cases, the runtime cost of disabling an obtuse compiler&#39;s &quot;optimization&quot; may be less than the cost of the code which would otherwise be required to guard against it."}], "tags": [], "owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "is_accepted": true, "score": 6, "last_activity_date": 1458752834, "creation_date": 1458752834, "answer_id": 36184466, "question_id": 36184449, "link": "https://stackoverflow.com/questions/36184449/is-it-ok-to-compile-files-with-different-gcc-optimization-levels-for-same-applic/36184466#36184466", "title": "Is it ok to compile files with different gcc optimization levels for same application?", "body": "<p>Yes, that's absolutely fine.  I'm curious why you don't wan't all of your code optimized?  We typically optimize everything, except a few files where optimization causes problems.</p>\n"}], "owner": {"reputation": 1907, "user_id": 95880, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/BjZGr.jpg?s=128&g=1", "display_name": "kp11", "link": "https://stackoverflow.com/users/95880/kp11"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 391, "favorite_count": 0, "accepted_answer_id": 36184466, "answer_count": 1, "score": 5, "last_activity_date": 1458752834, "creation_date": 1458752751, "question_id": 36184449, "link": "https://stackoverflow.com/questions/36184449/is-it-ok-to-compile-files-with-different-gcc-optimization-levels-for-same-applic", "title": "Is it ok to compile files with different gcc optimization levels for same application?", "body": "<p>I have an application which generally used the gcc optimization flag -O0 (no optimization). Now I have a file opt.c which I would like to compile with -O1, and leave rest of the files with -O0. </p>\n\n<p>To be more specific, opt.c has a large for loop, which performs some simple arithmetic.</p>\n\n<p>Finally only 1 executable is created which has all the files plus the opt.c. I am not sure if this causes any issue!</p>\n"}, {"tags": ["python", "c", "pointers", "swig"], "comments": [{"owner": {"reputation": 119, "user_id": 978399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/884a4c3f5f67f5eb01659e27fee0de70?s=128&d=identicon&r=PG", "display_name": "jada12276", "link": "https://stackoverflow.com/users/978399/jada12276"}, "edited": false, "score": 0, "creation_date": 1458753753, "post_id": 36184402, "comment_id": 60004808, "body": "I have no knowledge of SWIG, but looking at the function call, are you sure you are passing the double pointer correctly? It seems you are not passing the address of <code>tracks</code> but the value itself."}, {"owner": {"reputation": 9246, "user_id": 1041868, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6d476b07acb3919c356015e11ad97608?s=128&d=identicon&r=PG", "display_name": "bph", "link": "https://stackoverflow.com/users/1041868/bph"}, "reply_to_user": {"reputation": 119, "user_id": 978399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/884a4c3f5f67f5eb01659e27fee0de70?s=128&d=identicon&r=PG", "display_name": "jada12276", "link": "https://stackoverflow.com/users/978399/jada12276"}, "edited": false, "score": 0, "creation_date": 1458760121, "post_id": 36184402, "comment_id": 60008639, "body": "TBH if you have no knowledge of SWIG you&#39;re prob not going to be able to shed much light. The typemap is attempting to convert the tracks pointer to a double pointer. It gets incorporated into the auto generated wrapper code I believe"}, {"owner": {"reputation": 2883, "user_id": 5162389, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FTqjP.jpg?s=128&g=1", "display_name": "m7thon", "link": "https://stackoverflow.com/users/5162389/m7thon"}, "edited": false, "score": 1, "creation_date": 1458781987, "post_id": 36184402, "comment_id": 60017905, "body": "Can you give an example in C of how you would use <code>update_tracks</code>? Currently, your typemap passes a <code>track_t**</code> to an uninitialized <code>track_t *</code>, and does not use the <code>track_t**</code> after the function has completed. If you can get your hands on a <code>track_t**</code> using the C library, then SWIG should just wrap this, and you can simply pass it into the <code>update_tracks</code> function (without any typemaps). Perhaps you can write a helper function in C: <code>track_t** make_phash_tracks(track_t* tracks) { return &amp;tracks; }</code>."}, {"owner": {"reputation": 9246, "user_id": 1041868, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6d476b07acb3919c356015e11ad97608?s=128&d=identicon&r=PG", "display_name": "bph", "link": "https://stackoverflow.com/users/1041868/bph"}, "edited": false, "score": 0, "creation_date": 1459868340, "post_id": 36184402, "comment_id": 60474342, "body": "I&#39;ve been trying to build the same interface but for java rather than python - should this be possible? I&#39;m getting a lot of compile time errors, things like SWIG_ConvertPtr, SWIG_POINTER_OWN, SWIG_POINTER_DISOWN are undeclared"}, {"owner": {"reputation": 9246, "user_id": 1041868, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6d476b07acb3919c356015e11ad97608?s=128&d=identicon&r=PG", "display_name": "bph", "link": "https://stackoverflow.com/users/1041868/bph"}, "edited": false, "score": 0, "creation_date": 1459868527, "post_id": 36184402, "comment_id": 60474500, "body": "I also noted that the %append_output appears &#39;unsubstituted&#39; in the output c wrapper code when java is the target - that can&#39;t be right.."}], "answers": [{"comments": [{"owner": {"reputation": 9246, "user_id": 1041868, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6d476b07acb3919c356015e11ad97608?s=128&d=identicon&r=PG", "display_name": "bph", "link": "https://stackoverflow.com/users/1041868/bph"}, "edited": false, "score": 0, "creation_date": 1458815877, "post_id": 36193093, "comment_id": 60029606, "body": "thanks for this, i have updated the OP with some additional detail"}, {"owner": {"reputation": 9246, "user_id": 1041868, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6d476b07acb3919c356015e11ad97608?s=128&d=identicon&r=PG", "display_name": "bph", "link": "https://stackoverflow.com/users/1041868/bph"}, "edited": false, "score": 0, "creation_date": 1458824707, "post_id": 36193093, "comment_id": 60035042, "body": "should there be an &#39;&amp;&#39; somewhere in the &#39;in&#39; typemap if we are trying to convert the track_t* tracks arg to track_t**? i.e. we are trying to get the address of tracks.."}, {"owner": {"reputation": 2883, "user_id": 5162389, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FTqjP.jpg?s=128&g=1", "display_name": "m7thon", "link": "https://stackoverflow.com/users/5162389/m7thon"}, "reply_to_user": {"reputation": 9246, "user_id": 1041868, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6d476b07acb3919c356015e11ad97608?s=128&d=identicon&r=PG", "display_name": "bph", "link": "https://stackoverflow.com/users/1041868/bph"}, "edited": false, "score": 1, "creation_date": 1458826082, "post_id": 36193093, "comment_id": 60036024, "body": "Yes, maybe the temporary <code>track_t* tracks</code> is required. I added it, and updated my answer with more explanations. Also, you can have a look at the generated wrapper code to see what exactly is happening (if you understand what typemaps basically do, you will be able to read the code)."}, {"owner": {"reputation": 9246, "user_id": 1041868, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6d476b07acb3919c356015e11ad97608?s=128&d=identicon&r=PG", "display_name": "bph", "link": "https://stackoverflow.com/users/1041868/bph"}, "edited": false, "score": 0, "creation_date": 1458826343, "post_id": 36193093, "comment_id": 60036200, "body": "your right - 1st time update_tracks() is called there is no track hash table, just the null pointer, so this is when the hash table is created, every subsequent call to update_tracks() just updates the existing track hash table. I&#39;ve just been looking at the SWIG generated .py and .c code - will update my .i file with your update, rebuild and take another look.."}, {"owner": {"reputation": 9246, "user_id": 1041868, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6d476b07acb3919c356015e11ad97608?s=128&d=identicon&r=PG", "display_name": "bph", "link": "https://stackoverflow.com/users/1041868/bph"}, "edited": false, "score": 0, "creation_date": 1458828702, "post_id": 36193093, "comment_id": 60037819, "body": "I think that the helper function &#39;return NULL&#39; is equivalent to tracks = None in python (see another of my questions <a href=\"http://stackoverflow.com/questions/19726689/swig-python-initialise-a-pointer-to-null\" title=\"swig python initialise a pointer to null\">stackoverflow.com/questions/19726689/&hellip;</a>) you can see I&#39;ve been trying to solve this problem for a long time!"}, {"owner": {"reputation": 9246, "user_id": 1041868, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6d476b07acb3919c356015e11ad97608?s=128&d=identicon&r=PG", "display_name": "bph", "link": "https://stackoverflow.com/users/1041868/bph"}, "edited": false, "score": 0, "creation_date": 1458829145, "post_id": 36193093, "comment_id": 60038116, "body": "for the typemap in (3) and (4) I get the error: TypeError: &quot;&#39;int&#39; object is not iterable&quot; when executing the python call to update_tracks()"}, {"owner": {"reputation": 2883, "user_id": 5162389, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FTqjP.jpg?s=128&g=1", "display_name": "m7thon", "link": "https://stackoverflow.com/users/5162389/m7thon"}, "reply_to_user": {"reputation": 9246, "user_id": 1041868, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6d476b07acb3919c356015e11ad97608?s=128&d=identicon&r=PG", "display_name": "bph", "link": "https://stackoverflow.com/users/1041868/bph"}, "edited": false, "score": 1, "creation_date": 1458831942, "post_id": 36193093, "comment_id": 60040097, "body": "You need the &quot;argout&quot; typemap in all cases, in addition to an &quot;in&quot; typemap. Are you using it that way? Otherwise the function just returns an <code>int</code>, which is not iterable."}, {"owner": {"reputation": 9246, "user_id": 1041868, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6d476b07acb3919c356015e11ad97608?s=128&d=identicon&r=PG", "display_name": "bph", "link": "https://stackoverflow.com/users/1041868/bph"}, "edited": false, "score": 0, "creation_date": 1458833082, "post_id": 36193093, "comment_id": 60040973, "body": "you sir are a genius - I think it is working, it has been 2 and a bit years but worth the wait! I also wrote another type of helper fn, track_t *update_tracks_swig(track_t *hash_tracks, ...) but I think this might be haemorrhaging memory"}, {"owner": {"reputation": 2883, "user_id": 5162389, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FTqjP.jpg?s=128&g=1", "display_name": "m7thon", "link": "https://stackoverflow.com/users/5162389/m7thon"}, "reply_to_user": {"reputation": 9246, "user_id": 1041868, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6d476b07acb3919c356015e11ad97608?s=128&d=identicon&r=PG", "display_name": "bph", "link": "https://stackoverflow.com/users/1041868/bph"}, "edited": false, "score": 1, "creation_date": 1458844688, "post_id": 36193093, "comment_id": 60048637, "body": "Getting the memory management right is also an issue, but hard to do from afar, since it really depends on how you use the functions and where the memory gets allocated and deallocated. Probably, you never want Python to own a <code>tracks_t*</code> that represents a hash table, so better replace <code>SWIG_POINTER_OWN</code> with <code>0</code> in the argout typemap. For your helper function, if you do want Python to take ownership, use the <code>%newobject</code> directive. Also, you can check and set ownership from Python with <code>.thisown</code>, <code>.own()</code> and <code>.disown()</code>. Glad if these hints help get it working for you :-)"}], "tags": [], "owner": {"reputation": 2883, "user_id": 5162389, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FTqjP.jpg?s=128&g=1", "display_name": "m7thon", "link": "https://stackoverflow.com/users/5162389/m7thon"}, "is_accepted": true, "score": 6, "last_activity_date": 1458825728, "last_edit_date": 1458825728, "creation_date": 1458792258, "answer_id": 36193093, "question_id": 36184402, "link": "https://stackoverflow.com/questions/36184402/how-to-apply-a-swig-typemap-for-a-double-pointer-struct-argument/36193093#36193093", "title": "How to apply a SWIG typemap for a double pointer struct argument", "body": "<p>EDIT: Ok, I think I now understand what <code>update_tracks</code>does. It seems you can use the function in two ways. Either to update existing <code>tracks</code>, or to create <code>tracks</code> if you pass a pointer to a <code>NULL</code> pointer. I am not sure about the most elegant way to handle both cases in SWIG (or if this is even a problem), but here are some options.</p>\n\n<h3>1. <code>phash_tracks</code> is an output argument</h3>\n\n<p>First, you <strong>must</strong> pass <code>*phash_tracks</code> back to Python as a return value, and use the function in some form like</p>\n\n<pre><code>&gt;&gt;&gt; int_res, tracks = g3.update_tracks(tracks, pdw_frame, rdw_frame, lib, lib_meta, cfg)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>&gt;&gt;&gt; int_res, tracks = g3.update_tracks(pdw_frame, rdw_frame, lib, lib_meta, cfg)\n</code></pre>\n\n<p>This is accomplished by the following \"argout\" typemap:</p>\n\n<pre><code>%typemap(argout) track_t **phash_tracks {\n  %append_output(SWIG_NewPointerObj(%as_voidptr(*$1), $*1_descriptor, SWIG_POINTER_OWN));\n}\n</code></pre>\n\n<p>Maybe you don't want Python to take ownership of the <code>track_t*</code>, then replace <code>SWIG_POINTER_OWN</code> by <code>0</code>.</p>\n\n<h3>2. Passing an empty <code>phash_tracks</code></h3>\n\n<p>If you only want to use the <code>update_tracks</code> function to <em>create</em> <code>tracks</code>, you can do essentially what you are already doing. Use the following \"in\" typemap, and use the function as in the second example above (without the <code>tracks</code> parameter).</p>\n\n<pre><code>%typemap(in, numinputs=0) track_t **phash_tracks (track_t *tracks) {\n  tracks = NULL;\n  $1 = &amp;tracks;\n}\n</code></pre>\n\n<h3>3. <code>phash_tracks</code> as an input (and output) argument</h3>\n\n<p>If you want to use <code>update_tracks</code> to update <em>existing</em> <code>tracks</code>, you should be able to use the \"in\" typemap I suggested before, and use the function from Python as in the first example (including the <code>tracks</code> parameter).</p>\n\n<pre><code>%typemap(in) track_t **phash_tracks (track_t *tracks) {\n  if ((SWIG_ConvertPtr($input, (void **) &amp;tracks, $*1_descriptor, SWIG_POINTER_EXCEPTION | SWIG_POINTER_DISOWN)) == -1)\n    return NULL;\n  $1 = &amp;tracks;\n}\n</code></pre>\n\n<p>Note that it is important that Python disowns its <code>tracks_t*</code>.</p>\n\n<h3>4. Enabling both (2) and (3) above</h3>\n\n<p>You could basically use version (3) also to <em>create</em> <code>tracks</code>, if you could get swig to pass a wrapped <code>NULL</code> <code>tracks_t*</code>. I am not sure if SWIG allows this -- but maybe it does. Try using a helper function:</p>\n\n<pre><code>tracks_t* empty_tracks() { return NULL; }\n</code></pre>\n\n<p>Alternatively, you can modify the \"in\" typemap along the following lines, attempting to convert the provided argument to a <code>track_t*</code> and passing its address, or alternatively passing the address of a <code>NULL</code> <code>track_t*</code>.</p>\n\n<pre><code>%typemap(in) track_t **phash_tracks (track_t *tracks) {\n  // Alternatively, check if $input is a 0 integer `PyObject`...\n  if ((SWIG_ConvertPtr($input, (void **) &amp;tracks, $*1_descriptor, SWIG_POINTER_DISOWN)) == -1)\n    tracks = NULL;\n  $1 = &amp;tracks;\n}\n</code></pre>\n\n<p>Then, from Python, just pass something else to create <code>tracks</code>:</p>\n\n<pre><code>&gt;&gt;&gt; int_res, tracks = g3.update_tracks(0, pdw_frame, rdw_frame, lib, lib_meta, cfg)\n</code></pre>\n"}], "owner": {"reputation": 9246, "user_id": 1041868, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6d476b07acb3919c356015e11ad97608?s=128&d=identicon&r=PG", "display_name": "bph", "link": "https://stackoverflow.com/users/1041868/bph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1449, "favorite_count": 1, "accepted_answer_id": 36193093, "answer_count": 1, "score": 2, "last_activity_date": 1458829379, "creation_date": 1458752588, "last_edit_date": 1458829379, "question_id": 36184402, "link": "https://stackoverflow.com/questions/36184402/how-to-apply-a-swig-typemap-for-a-double-pointer-struct-argument", "title": "How to apply a SWIG typemap for a double pointer struct argument", "body": "<p>I have an API that I am trying to wrap using SWIG such that I can call the underlying C library from python.</p>\n\n<p>I have got stuck with a particular API fn:</p>\n\n<pre><code>int update_tracks(track_t **phash_tracks,\n                  const pdws_t *pdw_frame,\n                  const rdws_t *rdw_frame,\n                  lib_t *lib,\n                  lib_meta_t *lib_meta,\n                  const cfg_t *cfg);\n</code></pre>\n\n<p>Its the double pointer to <code>track_t</code> data structure that I can't handle.</p>\n\n<p>All the single pointers work fine.</p>\n\n<p>This is the only API fn that has a double pointer to <code>track_t</code></p>\n\n<p>All the others only have a single pointer, e.g.</p>\n\n<pre><code>void print_hash_tracks(const track_t *hash_tracks, const cfg_t *cfg,\n                       enum TRKTYPE trktype);\n</code></pre>\n\n<p>I'm pretty sure I need to make a typemap in my SWIG interface file (interface.i) but I am finding the SWIG docs impenetrable.</p>\n\n<p>What I think I need to do is create a typemap that whenever it sees the <code>track_t**</code> type, it takes a <code>track_t*</code> and converts it to its address, something like:</p>\n\n<pre><code>/* provide typemap to handle instances of track_t** parameters */\n%typemap(in) track_t** (track_t *tracks) {\n    $1 = &amp;tracks;\n}\n</code></pre>\n\n<p>but I'm just getting segmentation faults when I run:</p>\n\n<pre><code>tracks = g3.track_t()\ng3.update_tracks(tracks, pdw_frame, rdw_frame, lib, lib_meta, cfg)\n</code></pre>\n\n<p>on the python side.</p>\n\n<p>I feel like I've almost solved this but can't quite get the typemap specification right and at the same time struggling to understand the relevant documentation.</p>\n\n<p>flexo - if you're out there - maybe you can shed some light on this, you seem to be the SO expert in this area..</p>\n\n<p>UPDATE - m7ython (brilliant! another SWIG expert on SO)</p>\n\n<p>Usage in C is pretty straigthforward</p>\n\n<p>declare and initialise a track_t pointer to NULL:</p>\n\n<pre><code>track_t *hash_tracks = NULL;\n</code></pre>\n\n<p>then:</p>\n\n<pre><code>update_tracks(&amp;hash_tracks, &amp;pdw_frame, &amp;rdw_frame,\n              &amp;lib, &amp;lib_meta, &amp;cfg);\n</code></pre>\n\n<p>So the address of the pointer to <code>track_t</code> is passed as an arg to <code>update_tracks()</code>. The <code>update_tracks()</code> fn takes care of all the necessary mallocs for the data that gets put into <code>hash_tracks</code>, i.e. the hash table of <code>track_t</code> structs</p>\n\n<p>All the other args are single pointers and I can create and populate them with no issues on the python side.</p>\n\n<p><code>track_t</code> is a struct containing a bunch of ints, floats, char* etc. e.g.</p>\n\n<pre><code>typedef struct\n{\n/* make struct hashable */\nUT_hash_handle hh;\n\nint id;\n...\nchar name[MAX_BUF];\n...\n} track_t;\n</code></pre>\n\n<p>The reason that the track_t arg is a <code>track_t**</code> and not just a <code>track_t*</code> is because <code>hash_tracks</code> is a pointer to a hash table (using the UTHash library). <code>hash_tracks</code> points to the 1st track_t in the hash table. In the body of the <code>update_tracks()</code> fn track_t structs can be added/removed from the hash table, such that the pointer to the 1st track_t may change, i.e. <code>hash_tracks</code> may point to something else after the call to <code>update_tracks()</code>, hence the reason for passing a pointer to the pointer.</p>\n\n<p>In other words, the <code>track_t**</code> arg, <code>phash_tracks</code> is being used both as an input and output type arg, hence the pointer to a pointer. All the other args are simply inputs, they don't change so they can be passed in as single pointers. </p>\n\n<p>I attempted the 'helper fn' route with the following C fn:</p>\n\n<pre><code>track_t** make_phash_tracks(void)\n{\n    track_t **phash_tracks;\n\n    phash_tracks = calloc(1, sizeof(track_t*));\n\n    return phash_tracks;\n}\n</code></pre>\n\n<p>the use of calloc should ensure that *phash_tracks is NULL</p>\n\n<p>this compiled and wrapped with no errors, but when I used it from the python side it segfaulted, e.g.</p>\n\n<pre><code>phash_tracks = g3.make_phash_tracks()\ng3.update_tracks(phash_tracks, pdw_frame, rdw_frame, lib, lib_meta, cfg)\n</code></pre>\n\n<p>checking the <code>phash_tracks</code> var just prior to calling <code>update_tracks</code> gave:</p>\n\n<pre><code>(Pdb) p phash_tracks\n&lt;Swig Object of type 'track_t **' at 0x7fb9e37c9030&gt;\n</code></pre>\n"}, {"tags": ["c", "for-loop", "while-loop", "comma-operator"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1458752856, "post_id": 36184369, "comment_id": 60004229, "body": "For the same reason you can&#39;t write a lot of things - it&#39;s not valid C syntax."}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1458752859, "post_id": 36184369, "comment_id": 60004231, "body": "Short answer - because the language grammar won&#39;t allow it; the control expressions in a <code>for</code> statement cannot be other <i>statements</i>.  As for <i>why</i> the grammar is that way, you&#39;d have to ask Dennis Ritchie, and he&#39;s not around anymore."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1458752861, "post_id": 36184369, "comment_id": 60004234, "body": "Because the language only allows <i>expressions</i> and not statements."}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 1, "creation_date": 1458752962, "post_id": 36184369, "comment_id": 60004298, "body": "Read about <code>for</code> loop syntax. <code>for ( expression; expression; expression ) statement</code>."}], "answers": [{"tags": [], "owner": {"reputation": 181, "user_id": 6105522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5e3fd96658ebf3eb58fe14ab81ef9b3?s=128&d=identicon&r=PG&f=1", "display_name": "monsterkrampe", "link": "https://stackoverflow.com/users/6105522/monsterkrampe"}, "is_accepted": true, "score": 0, "last_activity_date": 1458754677, "last_edit_date": 1458754677, "creation_date": 1458753037, "answer_id": 36184529, "question_id": 36184369, "link": "https://stackoverflow.com/questions/36184369/c-while-operator-in-for-loop-initializer/36184529#36184529", "title": "C - while operator in for loop initializer", "body": "<p>This is just no valid syntax in C.</p>\n\n<p>A Solution for what you want might be:</p>\n\n<pre><code>int i, size;\nint *arr;\n...\nfor(i = size - 1; i &gt;= 0; i--) {\n    if (arr[i] == 0)\n        continue;\n    ...\n}\n</code></pre>\n"}], "owner": {"reputation": 177, "user_id": 3241942, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/rDSQl.jpg?s=128&g=1", "display_name": "dm-kiselev", "link": "https://stackoverflow.com/users/3241942/dm-kiselev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "closed_date": 1458765269, "accepted_answer_id": 36184529, "answer_count": 1, "score": -2, "last_activity_date": 1458754677, "creation_date": 1458752504, "question_id": 36184369, "link": "https://stackoverflow.com/questions/36184369/c-while-operator-in-for-loop-initializer", "closed_reason": "Not suitable for this site", "title": "C - while operator in for loop initializer", "body": "<p>Why I cannot write smthng like this?</p>\n\n<pre><code>int i, size;\nint *arr;\n...\nfor(i = size - 1, while(arr[i] == 0) i--; i &gt;= 0; i--) { ... }\n</code></pre>\n"}, {"tags": ["c", "encoding", "utf-8", "character-encoding"], "comments": [{"owner": {"reputation": 22778, "user_id": 1554386, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bfe99a3a73b9284d16127418399762ff?s=128&d=identicon&r=PG", "display_name": "Alastair McCormack", "link": "https://stackoverflow.com/users/1554386/alastair-mccormack"}, "edited": false, "score": 0, "creation_date": 1458761726, "post_id": 36184019, "comment_id": 60009658, "body": "You may change the locale, but the encoding in locale is just a hint for the user&#39;s terminal encoding."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1458765130, "post_id": 36184019, "comment_id": 60011529, "body": "Could you elaborate a bit and mention what kind of problems your application would encounter if given non-UTF-8 input or if output is not to a UTF-8 device or file? I could amend my answer to show how to fix such issues <i>properly</i>, without proverbially slapping us non-English-speaking-non-USians (<code>en_US.UTF-8</code> etc.) in the face. (The fact that some here are content to just offer advice on how &quot;hard&quot; you should slap, is disheartening.)"}, {"owner": {"reputation": 76876, "user_id": 287586, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/tB5AG.png?s=128&g=1", "display_name": "dan04", "link": "https://stackoverflow.com/users/287586/dan04"}, "edited": false, "score": 0, "creation_date": 1459196969, "post_id": 36184019, "comment_id": 60168232, "body": "On *nix or on Windows?"}, {"owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "reply_to_user": {"reputation": 76876, "user_id": 287586, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/tB5AG.png?s=128&g=1", "display_name": "dan04", "link": "https://stackoverflow.com/users/287586/dan04"}, "edited": false, "score": 0, "creation_date": 1459214926, "post_id": 36184019, "comment_id": 60174599, "body": "@dan04 Both. In fact, I&#39;m looking for a generic way to &quot;standardise&quot; character encoding."}], "answers": [{"comments": [{"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1458752191, "post_id": 36184144, "comment_id": 60003778, "body": "On my system it&#39;s <code>en_US.utf8</code>."}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "reply_to_user": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1458752589, "post_id": 36184144, "comment_id": 60004062, "body": "@LeeDanielCrocker - thanks. I edited my answer to reflect the alternate spelling."}], "tags": [], "owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "is_accepted": false, "score": 2, "last_activity_date": 1458752555, "last_edit_date": 1458752555, "creation_date": 1458751887, "answer_id": 36184144, "question_id": 36184019, "link": "https://stackoverflow.com/questions/36184019/is-it-possible-force-utf-8-in-a-c-program/36184144#36184144", "title": "Is it possible &quot;force&quot; UTF-8 in a C program?", "body": "<p>Try:</p>\n\n<pre><code>setlocale(LC_ALL, \"en_US.UTF-8\");\n</code></pre>\n\n<p>You can run <code>locale -a</code> in the terminal to get a full list of locales supported by your system (\"en_US.UTF-8\" should be supported by most/all UTF-8 supporting systems).</p>\n\n<p><strong>EDIT 1</strong> (alternate spelling)</p>\n\n<p>In the comments, Lee points out that some systems have an alternate spelling, <code>\"en_US.utf8\"</code> (which surprised me, but we learn new stuff every day).</p>\n\n<p>Since <code>setlocale</code> returns NULL when it fails, you can chain these calls:</p>\n\n<pre><code>if(!setlocale(LC_ALL, \"en_US.UTF-8\") &amp;&amp; !setlocale(LC_ALL, \"en_US.utf8\"))\n   printf(\"failed to set locale to UTF-8\");\n</code></pre>\n\n<p><strong>EDIT 2</strong> (finding out if we're using UTF-8)</p>\n\n<p>To find out if the locale is set to UFT-8 (after attempting to set it), you can either check for the returned value (<code>NULL</code> means the call failed) or check the locale used.</p>\n\n<p>Option 1:</p>\n\n<pre><code>char * result;\nif((result = setlocale (LC_ALL, \"en_US.UTF-8\")) == NULL)\n   printf(\"failed to set locale to UTF-8\");\n</code></pre>\n\n<p>Option 2:</p>\n\n<pre><code>setlocale (LC_ALL, \"en_US.UTF-8\"); // set\nchar * result = setlocale (LC_ALL, NULL); // review\nif(!strstr(result, \"UTF-8\"))\n   printf(\"failed to set locale to UTF-8\");\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "edited": false, "score": 1, "creation_date": 1458773342, "post_id": 36188053, "comment_id": 60015315, "body": "It&#39;ll be nice if you can add some examples! Can you give me the simplest example code that the program asks the user to input a string(maybe in Chinese or Japanese), and print it both on the screen and in a file? I know I can make use of functions in <code>wchar.h</code> to do this, but I want to know more about such character-set-sensible problems."}], "tags": [], "owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "is_accepted": true, "score": 2, "last_activity_date": 1458815029, "last_edit_date": 1458815029, "creation_date": 1458764799, "answer_id": 36188053, "question_id": 36184019, "link": "https://stackoverflow.com/questions/36184019/is-it-possible-force-utf-8-in-a-c-program/36188053#36188053", "title": "Is it possible &quot;force&quot; UTF-8 in a C program?", "body": "<p>It is possible, but it is the completely wrong thing to do.</p>\n\n<p>First of all, the current locale is for the user to decide. It is not just the character set, but also the language, date and time formats, and so on. Your program has absolutely no \"right\" to mess with it.</p>\n\n<p>If you cannot localize your program, just tell the user the environmental requirements your program has, and let them worry about it.</p>\n\n<p>Really, you should not really rely on UTF-8 being the current encoding, but use wide character support, including functions like <a href=\"http://man7.org/linux/man-pages/man3/wctype.3.html\" rel=\"nofollow\"><code>wctype()</code></a>, <a href=\"http://man7.org/linux/man-pages/man3/mbstowcs.3.html\" rel=\"nofollow\"><code>mbstowcs()</code></a>, and so on. POSIXy systems also provide <a href=\"http://man7.org/linux/man-pages/man3/iconv_open.3.html\" rel=\"nofollow\"><code>iconv_open()</code></a> and <a href=\"http://man7.org/linux/man-pages/man3/iconv.3.html\" rel=\"nofollow\"><code>iconv()</code></a> function family in their C libraries to convert between encodings (which should always include conversion to and from <code>wchar_t</code>); on Windows, you need a separate version <code>libiconv</code> library. This is how for example the GCC compiler handles different character sets. (Internally, it uses Unicode/UTF-8, but if you ask it to, it can do the necessary conversions to work with other character sets.)</p>\n\n<p>I am personally a strong proponent of <a href=\"http://utf8everywhere.org/\" rel=\"nofollow\">using UTF-8 everywhere</a>, but overriding the user locale in a program is horrific. Abominable. Distasteful; like a desktop applet changing the display resolution because the programmer is particularly fond of certain one.</p>\n\n<p>I would be happy to write some example code to show how to correctly solve any character-set-sensible situation, but there are so many, I don't know where to start.</p>\n\n<p>If the OP amends their question to state exactly <strong>what problem overriding the character set is supposed to solve</strong>, I'm willing to show how to use the aforementioned utilities and POSIX facilities (or equivalent freely available libraries on Windows) to solve it correctly.</p>\n\n<p>If this seems harsh to someone, it is, but only because taking the easy and simple route here (overriding the user's locale setting) is so ... <em>wrong</em>, purely on technical grounds. Even <em>no action</em> is better, and actually quite acceptable, as long as you just document your application only handles UTF-8 input/output.</p>\n\n<hr>\n\n<p>Example 1. Localized Happy New Year!</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;locale.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;wchar.h&gt;\n\nint main(void)\n{\n    /* We wish to use the user's current locale. */\n    setlocale(LC_ALL, \"\");\n\n    /* We intend to use wide functions on standard output. */\n    fwide(stdout, 1);\n\n    /* For Windows compatibility, print out a Byte Order Mark.\n     * If you save the output to a file, this helps tell Windows\n     * applications that the file is Unicode.\n     * Other systems don't need it nor use it.\n    */\n    fputwc(L'\\uFEFF', stdout);\n\n    wprintf(L\"Happy New Year!\\n\");\n    wprintf(L\"\u0421 \u043d\u043e\u0432\u044b\u043c \u0433\u043e\u0434\u043e\u043c!\\n\");\n    wprintf(L\"\u65b0\u5e74\u597d\uff01\\n\");\n    wprintf(L\"\u8cc0\u6b63\uff01\\n\");\n    wprintf(L\"\u00a1Feliz a\u00f1o nuevo!\\n\");\n    wprintf(L\"Hyv\u00e4\u00e4 uutta vuotta!\\n\");\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>Note that wprintf() takes a wide string (wide string constants are of form <code>L\"\"</code>, wide character constants <code>L''</code>, as opposed to normal/narrow counterparts <code>\"\"</code> and <code>''</code>). Formats are still the same; <code>%s</code> prints a normal/narrow string, and <code>%ls</code> a wide string.</p>\n\n<hr>\n\n<p>Example 2. Reading input lines from standard input, and optionally saving them to a file. The file name is supplied on the command line.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;locale.h&gt;\n#include &lt;wctype.h&gt;\n#include &lt;wchar.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;stdio.h&gt;\n\ntypedef enum {\n    TRIM_LEFT     = 1,      /* Remove leading whitespace and control characters */\n    TRIM_RIGHT    = 2,      /* Remove trailing whitespace and control characters */\n    TRIM_NEWLINE  = 4,      /* Remove newline at end of line */\n    TRIM          = 7,      /* Remove leading and trailing whitespace and control characters */\n    OMIT_NUL      = 8,      /* Skip NUL characters (embedded binary zeros, L'\\0') */\n    OMIT_CONTROLS = 16,     /* Skip control characters */\n    CLEANUP       = 31,     /* All of the above. */\n    COMBINE_LWS   = 32,     /* Combine all whitespace into a single space */\n} trim_opts;\n\n\n/* Read an unlimited-length line from a wide input stream.\n *\n * This function takes a pointer to a wide string pointer,\n * pointer to the number of wide characters dynamically allocated for it,\n * the stream to read from, and a set of options on how to treat the line.\n *\n * If an error occurs, this will return 0 with errno set to nonzero error number.\n * Use strerror(errno) to obtain the error description (as a narrow string).\n *\n * If there is no more data to read from the stream,\n * this will return 0 with errno 0, and feof(stream) will return true.\n *\n * If an empty line is read,\n * this will return 0 with errno 0, but feof(stream) will return false.\n *\n * Typically, you initialize variables like\n *      wchar_t *line = NULL;\n *      size_t   size = 0;\n * before calling this function, so that subsequent calls the same, dynamically\n * allocated buffer for the line, and it is automatically grown if necessary.\n * There are no built-in limits to line lengths this way.\n*/\nsize_t getwline(wchar_t **const lineptr,\n                size_t   *const sizeptr,\n                FILE     *const in,\n                trim_opts const trimming)\n{\n    wchar_t *line;\n    size_t   size;\n    size_t   used = 0;\n    wint_t   wc;\n    fpos_t   startpos;\n    int      seekable;\n\n    if (lineptr == NULL || sizeptr == NULL || in == NULL) {\n        errno = EINVAL;\n        return 0;\n    }\n\n    if (*lineptr != NULL) {\n        line = *lineptr;\n        size = *sizeptr;\n    } else {\n        line = NULL;\n        size = 0;\n        *sizeptr = 0;\n    }\n\n    /* In error cases, we can try and get back to this position\n     * in the input stream, as we cannot really return the data\n     * read thus far. However, some streams like pipes are not seekable,\n     * so in those cases we should not even try.\n     * Use (seekable) as a flag to remember if we should try.\n    */\n    if (fgetpos(in, &amp;startpos) == 0)\n        seekable = 1;\n    else\n        seekable = 0;\n\n    while (1) {\n\n        /* When we read a wide character from a wide stream,\n         * fgetwc() will return WEOF with errno set if an error occurs.\n         * However, fgetwc() will return WEOF with errno *unchanged*\n         * if there is no more input in the stream.\n         * To detect which of the two happened, we need to clear errno\n         * first.\n        */\n        errno = 0;\n        wc = fgetwc(in);\n        if (wc == WEOF) {\n            if (errno) {\n                const int saved_errno = errno;\n                if (seekable)\n                    fsetpos(in, &amp;startpos);\n                errno = saved_errno;\n                return 0;\n            }\n            if (ferror(in)) {\n                if (seekable)\n                    fsetpos(in, &amp;startpos);\n                errno = EIO;\n                return 0;\n            }\n            break;\n        }\n\n        /* Dynamically grow line buffer if necessary.\n         * We need room for the current wide character,\n         * plus at least the end-of-string mark, L'\\0'.\n        */\n        if (used + 2 &gt; size) {\n            /* Size policy. This can be anything you see fit,\n             * as long as it yields size &gt;= used + 2.\n             *\n             * This one increments size to next multiple of\n             * 1024 (minus 16). It works well in practice,\n             * but do not think of it as the \"best\" way.\n             * It is just a robust choice.\n            */\n            size = (used | 1023) + 1009;\n            line = realloc(line, size * sizeof line[0]);\n            if (!line) {\n                /* Memory allocation failed. */\n                if (seekable)\n                    fsetpos(in, &amp;startpos);\n                errno = ENOMEM;\n                return 0;\n            }\n            *lineptr = line;\n            *sizeptr = size;\n        }\n\n        /* Append character to buffer. */\n        if (!trimming)\n            line[used++] = wc;\n        else {\n            /* Check if we have reasons to NOT add the character to buffer. */\n            do {\n                /* Omit NUL if asked to. */\n                if (trimming &amp; OMIT_NUL)\n                    if (wc == L'\\0')\n                        break;\n\n                /* Omit controls if asked to. */\n                if (trimming &amp; OMIT_CONTROLS)\n                    if (iswcntrl(wc))\n                        break;\n\n                /* If we are at start of line, and we are left-trimming,\n                 * only graphs (printable non-whitespace characters) are added. */\n                if (trimming &amp; TRIM_LEFT)\n                    if (wc == L'\\0' || !iswgraph(wc))\n                        break;\n\n                /* Combine whitespaces if asked to. */\n                if (trimming &amp; COMBINE_LWS)\n                    if (iswspace(wc)) {\n                        if (used &gt; 0 &amp;&amp; line[used-1] == L' ')\n                            break;\n                        else\n                            wc = L' ';\n                    }\n\n                /* Okay, add the character to buffer. */\n                line[used++] = wc;\n\n            } while (0);\n        }\n\n        /* End of the line? */\n        if (wc == L'\\n')\n            break;\n    }\n\n    /* The above loop will only end (break out)\n     * if end of line or end of input was found,\n     * and no error occurred.\n    */\n\n    /* Trim right if asked to. */\n    if (trimming &amp; TRIM_RIGHT)\n        while (used &gt; 0 &amp;&amp; iswspace(line[used-1]))\n            --used;\n    else\n    if (trimming &amp; TRIM_NEWLINE)\n        while (used &gt; 0 &amp;&amp; (line[used-1] == L'\\r' || line[used-1] == L'\\n'))\n            --used;\n\n    /* Ensure we have room for end-of-string L'\\0'. */\n    if (used &gt;= size) {\n        size = used + 1;\n        line = realloc(line, size * sizeof line[0]);\n        if (!line) {\n            if (seekable)\n                fsetpos(in, &amp;startpos);\n            errno = ENOMEM;\n            return 0;\n        }\n        *lineptr = line;\n        *sizeptr = size;\n    }\n\n    /* Add end of string mark. */\n    line[used] = L'\\0';\n\n    /* Successful return. */\n    errno = 0;\n    return used;\n}\n\n/* Counts the number of wide characters in 'alpha' class.\n*/\nsize_t count_letters(const wchar_t *ws)\n{\n    size_t count = 0;\n    if (ws)\n        while (*ws != L'\\0')\n            if (iswalpha(*(ws++)))\n                count++;\n    return count;\n}\n\nint main(int argc, char *argv[])\n{\n    FILE    *out;\n\n    wchar_t *line = NULL;\n    size_t   size = 0;\n    size_t   len;\n\n    setlocale(LC_ALL, \"\");\n\n    /* Standard input and output should use wide characters. */\n    fwide(stdin, 1);\n    fwide(stdout, 1);\n\n    /* Check if the user asked for help. */\n    if (argc &lt; 2 || argc &gt; 3 || strcmp(argv[1], \"-h\") == 0 || strcmp(argv[1], \"--help\") == 0 || strcmp(argv[1], \"/?\") == 0) {\n        fprintf(stderr, \"\\n\");\n        fprintf(stderr, \"Usage: %s [ -h | --help | /? ]\\n\", argv[0]);\n        fprintf(stderr, \"       %s FILENAME [ PROMPT ]\\n\", argv[0]);\n        fprintf(stderr, \"\\n\");\n        fprintf(stderr, \"The program will read input lines until an only '.' is supplied.\\n\");\n        fprintf(stderr, \"If you do not want to save the output to a file,\\n\");\n        fprintf(stderr, \"use '-' as the FILENAME.\\n\");\n        fprintf(stderr, \"\\n\");\n        return EXIT_SUCCESS;\n    }\n\n    /* Open file for output, unless it is \"-\". */\n    if (strcmp(argv[1], \"-\") == 0)\n        out = NULL; /* No output to file */\n    else {\n        out = fopen(argv[1], \"w\");\n        if (out == NULL) {\n            fprintf(stderr, \"%s: %s.\\n\", argv[1], strerror(errno));\n            return EXIT_FAILURE;\n        }\n\n        /* The output file is used with wide strings. */\n        fwide(out, 1);\n    }\n\n    while (1) {\n\n        /* Prompt? Note: our prompt string is narrow, but stdout is wide. */\n        if (argc &gt; 2) {\n            wprintf(L\"%s\\n\", argv[2]);\n            fflush(stdout);\n        }\n\n        len = getwline(&amp;line, &amp;size, stdin, CLEANUP);\n        if (len == 0) {\n            if (errno) {\n                fprintf(stderr, \"Error reading standard input: %s.\\n\", strerror(errno));\n                break;\n            }\n            if (feof(stdin))\n                break;\n        }\n\n        /* The user does not wish to supply more lines? */\n        if (wcscmp(line, L\".\") == 0)\n            break;\n\n        /* Print the line to the file. */\n        if (out != NULL) {\n            fputws(line, out);\n            fputwc(L'\\n', out);\n        }\n\n        /* Tell the user what we read. */\n        wprintf(L\"Received %lu wide characters, %lu of which were letterlike.\\n\",\n                (unsigned long)len, (unsigned long)count_letters(line));\n        fflush(stdout);\n    }\n\n    /* The line buffer is no longer needed, so we can discard it.\n     * Note that free(NULL) is safe, so we do not need to check.\n    */\n    free(line);\n\n    /* I personally also like to reset the variables.\n     * It helps with debugging, and to avoid reuse-after-free() errors. */\n    line = NULL;    \n    size = 0;\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>The <code>getwline()</code> function above is pretty much at the most complicated end of functions you might need when dealing with localized wide character support. It allows you to read localized input lines without length restrictions, and optionally trims and cleans up (removing control codes and embedded binary zeros) the returned string. It also works fine with both LF and CR-LF (<code>\\n</code> and <code>\\r\\n</code>) newline encodings. </p>\n"}, {"tags": [], "owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "is_accepted": false, "score": 1, "last_activity_date": 1458822718, "last_edit_date": 1495535308, "creation_date": 1458817012, "answer_id": 36198530, "question_id": 36184019, "link": "https://stackoverflow.com/questions/36184019/is-it-possible-force-utf-8-in-a-c-program/36198530#36198530", "title": "Is it possible &quot;force&quot; UTF-8 in a C program?", "body": "<p>This is not an answer, but a third, quite complex example, on how to use wide character I/O. This was too long to add to my <a href=\"https://stackoverflow.com/a/36188053/5977581\">actual answer to this question</a>.</p>\n\n<p>This example shows how to read and process CSV files (<a href=\"https://tools.ietf.org/html/rfc4180\" rel=\"nofollow noreferrer\">RFC-4180</a> format, optionally with limited backslash escape support) using wide strings. </p>\n\n<p>The following code is CC0/public domain, so you are free to use it any way you like, even include in your own proprietary projects, but if it breaks anything, you get to keep all the bits and not complain to me. (I'll be happy to include any bug fixes if you find and report them in a comment below, though.)</p>\n\n<p>The logic of the code is robust, however. In particular, it supports universal newlines, all four common newline types: Unix-like LF (<code>\\n</code>), old CR LF (<code>\\r\\n</code>), old Mac CR (<code>\\r</code>), and the occasionally encountered weird LF CR (<code>\\n\\r</code>). There are no built-in limitations wrt. the length of a field, the number of fields in a record, or the number of records in a file. It works very nicely if you need to convert CSV or process CSV input stream-like (field by field or record-by-record), without having to have more than one in memory at one point. If you want to construct structures to describe the records and fields in memory, you'll need to add some scaffolding code for that.</p>\n\n<p>Because of universal newline support, when reading input interactively, this program might require two consecutive end-of-inputs (<kbd>Ctrl</kbd>+<kbd>Z</kbd> in Windows and MS-DOS, <kbd>Ctrl</kbd>+<kbd>D</kbd> everywhere else), as the first one is usually \"consumed\" by the <code>csv_next_field()</code> or <code>csv_skip_field()</code> function, and the <code>csv_next_record()</code> function needs to re-read it again to actually detect it. However, you do not normally ask the user to input CSV data interactively, so this should be an acceptable quirk.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;locale.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;wchar.h&gt;\n#include &lt;wctype.h&gt;\n#include &lt;errno.h&gt;\n\n/* RFC-4180 -format CSV file processing using wide input streams.\n *\n * #define BACKSLASH_ESCAPES if you additionally wish to have\n * \\\\, \\a, \\b, \\t, \\n, \\v, \\f, \\r, \\\", and \\, de-escaped to their\n * C string equivalents when reading CSV fields.\n*/\n\ntypedef enum {\n    CSV_OK = 0,\n    CSV_END = 1,\n    CSV_INVALID_PARAMETERS = -1,\n    CSV_FORMAT_ERROR = -2,\n    CSV_CHARSET_ERROR = -3,\n    CSV_READ_ERROR = -4,\n    CSV_OUT_OF_MEMORY = -5,\n} csv_status;\n\nconst char *csv_error(const csv_status code)\n{\n    switch (code) {\n    case CSV_OK:                 return \"No error\";\n    case CSV_END:                return \"At end\";\n    case CSV_INVALID_PARAMETERS: return \"Invalid parameters\";\n    case CSV_FORMAT_ERROR:       return \"Bad CSV format\";\n    case CSV_CHARSET_ERROR:      return \"Illegal character in CSV file (incorrect locale?)\";\n    case CSV_READ_ERROR:         return \"Read error\";\n    case CSV_OUT_OF_MEMORY:      return \"Out of memory\";\n    default:                     return \"Unknown csv_status code\"; \n    }\n}\n\n/* Start the next record. Automatically skips any remaining fields in current record.\n * Returns CSV_OK if successful, CSV_END if no more records, or a negative CSV_ error code. */\ncsv_status csv_next_record (FILE *const in);\n\n/* Skip the next field. Returns CSV_OK if successful, CSV_END if no more fields in current record,\n * or a negative CSV_ error code. */\ncsv_status csv_skip_field  (FILE *const in);\n\n/* Read the next field. Returns CSV_OK if successful, CSV_END if no more fields in current record,\n * or a negative CSV_ error code.\n * If this returns CSV_OK, then *dataptr is a dynamically allocated wide string to the field\n * contents, space allocated for *sizeptr wide characters; and if lengthptr is not NULL, then\n * *lengthptr is the number of wide characters in said wide string. */\ncsv_status csv_next_field  (FILE *const in, wchar_t **const dataptr,\n                                            size_t   *const sizeptr,\n                                            size_t   *const lengthptr);\n\nstatic csv_status internal_skip_quoted(FILE *const in)\n{\n    while (1) {\n        wint_t  wc;\n\n        errno = 0;\n        wc = fgetwc(in);\n\n        if (wc == WEOF) {\n            if (errno == EILSEQ)\n                return CSV_CHARSET_ERROR;\n            if (errno)\n                return CSV_READ_ERROR;\n            if (ferror(in)) {\n                errno = EIO;\n                return CSV_READ_ERROR;\n            }\n            errno = 0;\n            return CSV_FORMAT_ERROR;\n        }\n\n        if (wc == L'\"') {\n            errno = 0;\n            wc = fgetwc(in);            \n\n            if (wc == L'\"')\n                continue;\n\n            while (wc != WEOF &amp;&amp; wc != L'\\n' &amp;&amp; wc != L'\\r' &amp;&amp; iswspace(wc)) {\n                errno = 0;\n                wc = fgetwc(in);\n            }\n\n            if (wc == WEOF) {\n                if (errno == EILSEQ)\n                    return CSV_CHARSET_ERROR;\n                if (errno)\n                    return CSV_READ_ERROR;\n                if (ferror(in)) {\n                    errno = EIO;\n                    return CSV_READ_ERROR;\n                }\n                errno = 0;\n                return CSV_END;\n            }\n\n            if (wc == L',') {\n                errno = 0;\n                return CSV_OK;\n            }\n\n            if (wc == L'\\n' || wc == L'\\r') {\n                ungetwc(wc, in);\n                errno = 0;\n                return CSV_END;\n            }\n\n            ungetwc(wc, in);\n            errno = 0;\n            return CSV_FORMAT_ERROR;\n        }\n\n#ifdef BACKSLASH_ESCAPES\n        if (wc == L'\\\\') {\n            errno = 0;\n            wc = fgetwc(in);\n\n            if (wc == L'\"')\n                continue;\n\n            if (wc == WEOF) {\n                if (errno == EILSEQ)\n                    return CSV_CHARSET_ERROR;\n                if (errno)\n                    return CSV_READ_ERROR;\n                if (ferror(in)) {\n                    errno = EIO;\n                    return CSV_READ_ERROR;\n                }\n                errno = 0;\n                return CSV_END;\n            }\n        }\n#endif\n    }\n}\n\nstatic csv_status internal_skip_unquoted(FILE *const in, wint_t wc)\n{\n    while (1) {\n\n        if (wc == WEOF) {\n            if (errno == EILSEQ)\n                return CSV_CHARSET_ERROR;\n            if (errno)\n                return CSV_READ_ERROR;\n            if (ferror(in)) {\n                errno = EIO;\n                return CSV_READ_ERROR;\n            }\n            errno = 0;\n            return CSV_END;\n        }\n\n        if (wc == L',') {\n            errno = 0;\n            return CSV_OK;\n        }\n\n        if (wc == L'\\n' || wc == L'\\r') {\n            ungetwc(wc, in);\n            errno = 0;\n            return CSV_END;\n        }\n\n#ifdef BACKSLASH_ESCAPES\n        if (wc == L'\\\\') {\n            errno = 0;\n            wc = fgetwc(in);\n            if (wc == WEOF) {\n                if (errno == EILSEQ)\n                    return CSV_CHARSET_ERROR;\n                if (errno)\n                    return CSV_READ_ERROR;\n                if (ferror(in)) {\n                    errno = EIO;\n                    return CSV_READ_ERROR;\n                }\n                errno = 0;\n                return CSV_END;\n            }\n        }\n#endif\n\n        errno = 0;\n        wc = fgetwc(in);\n    }\n}\n\ncsv_status csv_next_record(FILE *const in)\n{\n    while (1) {\n        wint_t      wc;\n        csv_status  status;\n\n        do {\n            errno = 0;\n            wc = fgetwc(in);\n        } while (wc != WEOF &amp;&amp; wc != L'\\n' &amp;&amp; wc != L'\\r' &amp;&amp; iswspace(wc));\n\n        if (wc == WEOF) {\n            if (errno == EILSEQ)\n                return CSV_CHARSET_ERROR;\n            if (errno)\n                return CSV_READ_ERROR;\n            if (ferror(in)) {\n                errno = EIO;\n                return CSV_READ_ERROR;\n            }\n            errno = 0;\n            return CSV_END;\n        }\n\n        if (wc == L'\\n' || wc == L'\\r') {\n            wint_t next_wc;\n\n            errno = 0;\n            next_wc = fgetwc(in);\n\n            if (next_wc == WEOF) {\n                if (errno == EILSEQ)\n                    return CSV_CHARSET_ERROR;\n                if (errno)\n                    return CSV_READ_ERROR;\n                if (ferror(in)) {\n                    errno = EIO;\n                    return CSV_READ_ERROR;\n                }\n                errno = 0;\n                return CSV_END;\n            }\n\n            if ((wc == L'\\n' &amp;&amp; next_wc == L'\\r') ||\n                (wc == L'\\r' &amp;&amp; next_wc == L'\\n')) {\n                errno = 0;\n                return CSV_OK;\n            }\n\n            ungetwc(next_wc, in);\n            errno = 0;\n            return CSV_OK;\n        }\n\n        if (wc == L'\"')\n            status = internal_skip_quoted(in);\n        else\n            status = internal_skip_unquoted(in, wc);\n\n        if (status &lt; 0)\n            return status;\n    }\n}\n\ncsv_status csv_skip_field(FILE *const in)\n{\n    wint_t  wc;\n\n    if (!in) {\n        errno = EINVAL;\n        return CSV_INVALID_PARAMETERS;\n    } else\n    if (ferror(in)) {\n        errno = EIO;\n        return CSV_READ_ERROR;\n    }\n\n    /* Skip leading whitespace. */\n    do {\n        errno = 0;\n        wc = fgetwc(in);\n    } while (wc != WEOF &amp;&amp; wc != L'\\n' &amp;&amp; wc != L'\\r' &amp;&amp; iswspace(wc));\n\n    if (wc == L'\"')\n        return internal_skip_quoted(in);\n    else\n        return internal_skip_unquoted(in, wc);\n\n}        \n\ncsv_status csv_next_field(FILE *const in, wchar_t **const dataptr,\n                                          size_t   *const sizeptr,\n                                          size_t   *const lengthptr)\n{\n    wchar_t *data;\n    size_t   size;\n    size_t   used = 0; /* length */\n    wint_t   wc;\n\n    if (lengthptr)\n        *lengthptr = 0;\n\n    if (!in || !dataptr || !sizeptr) {\n        errno = EINVAL;\n        return CSV_INVALID_PARAMETERS;\n    } else\n    if (ferror(in)) {\n        errno = EIO;\n        return CSV_READ_ERROR;\n    }\n\n    if (*dataptr) {\n        data = *dataptr;\n        size = *sizeptr;\n    } else {\n        data = NULL;\n        size = 0;\n        *sizeptr = 0;\n    }\n\n    /* Skip leading whitespace. */\n    do {\n        errno = 0;\n        wc = fgetwc(in);\n    } while (wc != WEOF &amp;&amp; wc != L'\\n' &amp;&amp; wc != L'\\r' &amp;&amp; iswspace(wc));\n\n    if (wc == WEOF) {\n        if (errno == EILSEQ)\n            return CSV_CHARSET_ERROR;\n        if (errno)\n            return CSV_READ_ERROR;\n        if (ferror(in)) {\n            errno = EIO;\n            return CSV_READ_ERROR;\n        }\n        errno = 0;\n        return CSV_END;\n    }\n\n    if (wc == L'\\n' || wc == L'\\r') {\n        ungetwc(wc, in);\n        errno = 0;\n        return CSV_END;\n    }\n\n    if (wc == L'\"')\n        while (1) {\n\n            errno = 0;\n            wc = getwc(in);\n\n            if (wc == WEOF) {\n                if (errno == EILSEQ)\n                    return CSV_CHARSET_ERROR;\n                if (errno)\n                    return CSV_READ_ERROR;\n                if (ferror(in)) {\n                    errno = EIO;\n                    return CSV_READ_ERROR;\n                }\n                errno = 0;\n                return CSV_FORMAT_ERROR;\n\n            } else\n            if (wc == L'\"') {\n                errno = 0;\n                wc = getwc(in);\n\n                if (wc != L'\"') {\n                    /* Not an escaped doublequote. */\n\n                    while (wc != WEOF &amp;&amp; wc != L'\\n' &amp;&amp; wc != L'\\r' &amp;&amp; iswspace(wc)) {\n                        errno = 0;\n                        wc = getwc(in);\n                    }\n\n                    if (wc == WEOF) {\n                        if (errno == EILSEQ)\n                            return CSV_CHARSET_ERROR;\n                        if (errno)\n                            return CSV_READ_ERROR;\n                        if (ferror(in)) {\n                            errno = EIO;\n                            return CSV_READ_ERROR;\n                        }\n                    } else\n                    if (wc == L'\\n' || wc == L'\\r') {\n                        ungetwc(wc, in);\n                    } else\n                    if (wc != L',') {\n                        errno = 0;\n                        return CSV_FORMAT_ERROR;\n                    }\n                    break;\n                }\n\n#ifdef BACKSLASH_ESCAPES\n            } else\n            if (wc == L'\\\\') {\n                errno = 0;\n                wc = getwc(in);\n\n                if (wc == L'\\0')\n                    continue;\n                else\n                if (wc == WEOF) {\n                    if (errno == EILSEQ)\n                        return CSV_CHARSET_ERROR;\n                    if (errno)\n                        return CSV_READ_ERROR;\n                    if (ferror(in)) {\n                        errno = EIO;\n                        return CSV_READ_ERROR;\n                    }\n                    break;\n                } else\n                    switch (wc) {\n                    case L'a':  wc = L'\\a'; break;\n                    case L'b':  wc = L'\\b'; break;\n                    case L't':  wc = L'\\t'; break;\n                    case L'n':  wc = L'\\n'; break;\n                    case L'v':  wc = L'\\v'; break;\n                    case L'f':  wc = L'\\f'; break;\n                    case L'r':  wc = L'\\r'; break;\n                    case L'\\\\': wc = L'\\\\'; break;\n                    case L'\"':  wc = L'\"';  break;\n                    case L',':  wc = L',';  break;\n                    default:\n                        ungetwc(wc, in);\n                        wc = L'\\\\';\n                    }\n#endif\n            }\n\n            if (used + 2 &gt; size) {\n                /* Allocation policy.\n                 * Anything that yields size &gt;= used + 2 is acceptable.\n                 * This one allocates in roughly 1024 byte chunks,\n                 * and is known to be robust (but not optimal) in practice. */\n                size = (used | 1023) + 1009;\n                data = realloc(data, size * sizeof data[0]);\n                if (!data) {\n                    errno = ENOMEM;\n                    return CSV_OUT_OF_MEMORY;\n                }\n                *dataptr = data;\n                *sizeptr = size;\n            }\n\n            data[used++] = wc;\n        }\n    else\n        while (1) {\n\n            if (wc == L',')\n                break;\n\n            if (wc == L'\\n' || wc == L'\\r') {\n                ungetwc(wc, in);\n                break;\n            }\n\n#ifdef BACKSLASH_ESCAPES\n            if (wc == L'\\\\') {\n                errno = 0;\n                wc = fgetwc(in);\n                if (wc == WEOF) {\n                    if (errno == EILSEQ)\n                        return CSV_CHARSET_ERROR;\n                    if (errno)\n                        return CSV_READ_ERROR;\n                    if (ferror(in)) {\n                        errno = EIO;\n                        return CSV_READ_ERROR;\n                    }\n                    wc = L'\\\\';\n                } else\n                    switch (wc) {\n                    case L'a':  wc = L'\\a'; break;\n                    case L'b':  wc = L'\\b'; break;\n                    case L't':  wc = L'\\t'; break;\n                    case L'n':  wc = L'\\n'; break;\n                    case L'v':  wc = L'\\v'; break;\n                    case L'f':  wc = L'\\f'; break;\n                    case L'r':  wc = L'\\r'; break;\n                    case L'\"':  wc = L'\"';  break;\n                    case L',':  wc = L',';  break;\n                    case L'\\\\': wc = L'\\\\'; break;\n                    default:\n                        ungetwc(wc, in);\n                        wc = L'\\\\';\n                    }\n            }\n#endif\n\n            if (used + 2 &gt; size) {\n                /* Allocation policy.\n                 * Anything that yields size &gt;= used + 2 is acceptable.\n                 * This one allocates in roughly 1024 byte chunks,\n                 * and is known to be robust (but not optimal) in practice. */\n                size = (used | 1023) + 1009;\n                data = realloc(data, size * sizeof data[0]);\n                if (!data) {\n                    errno = ENOMEM;\n                    return CSV_OUT_OF_MEMORY;\n                }\n                *dataptr = data;\n                *sizeptr = size;\n            }\n\n            data[used++] = wc;\n\n            errno = 0;\n            wc = getwc(in);\n\n            if (wc == WEOF) {\n                if (errno == EILSEQ)\n                    return CSV_CHARSET_ERROR;\n                if (errno)\n                    return CSV_READ_ERROR;\n                if (ferror(in)) {\n                    errno = EIO;\n                    return CSV_READ_ERROR;\n                }\n                break;\n            }\n        }\n\n    /* Ensure there is room for the end-of-string mark. */\n    if (used &gt;= size) {\n        size = used + 1;\n        data = realloc(data, size * sizeof data[0]);\n        if (!data) {\n            errno = ENOMEM;\n            return CSV_OUT_OF_MEMORY;\n        }\n        *dataptr = data;\n        *sizeptr = size;\n    }\n\n    data[used] = L'\\0';\n\n    if (lengthptr)\n        *lengthptr = used;\n\n    errno = 0;\n    return CSV_OK;\n}\n\n/* Helper function: print a wide string as if in quotes, but backslash-escape special characters.\n*/\nstatic void wquoted(FILE *const out, const wchar_t *ws, const size_t len)\n{\n    if (out) {\n        size_t i;\n\n        for (i = 0; i &lt; len; i++)\n            if (ws[i] == L'\\0')\n                fputws(L\"\\\\0\", out);\n            else\n            if (ws[i] == L'\\a')\n                fputws(L\"\\\\a\", out);\n            else\n            if (ws[i] == L'\\b')\n                fputws(L\"\\\\b\", out);\n            else\n            if (ws[i] == L'\\t')\n                fputws(L\"\\\\t\", out);\n            else\n            if (ws[i] == L'\\n')\n                fputws(L\"\\\\n\", out);\n            else\n            if (ws[i] == L'\\v')\n                fputws(L\"\\\\v\", out);\n            else\n            if (ws[i] == L'\\f')\n                fputws(L\"\\\\f\", out);\n            else\n            if (ws[i] == L'\\r')\n                fputws(L\"\\\\r\", out);\n            else\n            if (ws[i] == L'\"')\n                fputws(L\"\\\\\\\"\", out);\n            else\n            if (ws[i] == L'\\\\')\n                fputws(L\"\\\\\\\\\", out);\n            else\n            if (iswprint(ws[i])) \n                fputwc(ws[i], out);\n            else\n            if (ws[i] &lt; 65535)\n                fwprintf(out, L\"\\\\x%04x\", (unsigned int)ws[i]);\n            else\n                fwprintf(out, L\"\\\\x%08x\", (unsigned long)ws[i]);\n    }\n}\n\n\nstatic int show_csv(FILE *const in, const char *const filename)\n{\n    wchar_t        *field_contents = NULL;\n    size_t          field_allocated = 0;\n    size_t          field_length = 0;\n    unsigned long   record = 0UL;\n    unsigned long   field;\n    csv_status      status;\n\n    while (1) {\n\n        /* First field in this record. */\n        field = 0UL;\n        record++;\n\n        while (1) {\n\n            status = csv_next_field(in, &amp;field_contents, &amp;field_allocated, &amp;field_length);\n\n            if (status == CSV_END)\n                break;\n\n            if (status &lt; 0) {\n                fprintf(stderr, \"%s: %s.\\n\", filename, csv_error(status));\n                free(field_contents);\n                return -1;\n            }\n\n            field++;\n\n            wprintf(L\"Record %lu, field %lu is \\\"\", record, field);\n            wquoted(stdout, field_contents, field_length);\n            wprintf(L\"\\\", %lu characters.\\n\", (unsigned long)field_length);\n        }\n\n        status = csv_next_record(in);\n\n        if (status == CSV_END) {\n            free(field_contents);\n            return 0;\n        }\n\n        if (status &lt; 0) {\n            fprintf(stderr, \"%s: %s.\\n\", filename, csv_error(status));\n            free(field_contents);\n            return -1;\n        }\n    }\n}\n\nstatic int usage(const char *argv0)\n{\n    fprintf(stderr, \"\\n\");\n    fprintf(stderr, \"Usage: %s [ -h | --help | /? ]\\n\", argv0);\n    fprintf(stderr, \"       %s CSV-FILE [ ... ]\\n\", argv0);\n    fprintf(stderr, \"\\n\");\n    fprintf(stderr, \"Use special file name '-' to read from standard input.\\n\");\n    fprintf(stderr, \"\\n\");\n    return EXIT_SUCCESS;\n}\n\nint main(int argc, char *argv[])\n{\n    FILE *in;\n    int   arg;\n\n    setlocale(LC_ALL, \"\");\n\n    fwide(stdin, 1);\n    fwide(stdout, 1);\n\n    if (argc &lt; 1)\n        return usage(argv[0]);\n\n    for (arg = 1; arg &lt; argc; arg++) {\n\n        if (!strcmp(argv[arg], \"-h\") || !strcmp(argv[arg], \"--help\") || !strcmp(argv[arg], \"/?\"))\n            return usage(argv[0]);\n\n        if (!strcmp(argv[arg], \"-\")) {\n\n            if (show_csv(stdin, \"(standard input)\"))\n                return EXIT_FAILURE;\n\n        } else {\n\n            in = fopen(argv[arg], \"r\");\n            if (!in) {\n                fprintf(stderr, \"%s: %s.\\n\", argv[arg], strerror(errno));\n                return EXIT_FAILURE;\n            }\n\n            if (show_csv(in, argv[arg]))\n                return EXIT_FAILURE;\n            if (ferror(in)) {\n                fprintf(stderr, \"%s: %s.\\n\", argv[arg], strerror(EIO));\n                fclose(in);\n                return EXIT_FAILURE;\n            }\n            if (fclose(in)) {\n                fprintf(stderr, \"%s: %s.\\n\", argv[arg], strerror(EIO));\n                return EXIT_FAILURE;\n            }\n        }\n    }\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>The use of the above <code>csv_next_field()</code>, <code>csv_skip_field()</code>, and <code>csv_next_record()</code> is quite straightforward.</p>\n\n<ol>\n<li><p>Open the CSV file normally, then call <code>fwide(stream, 1)</code> on it to tell the C library you intend to use the wide string variants instead of the standard narrow string I/O functions.</p></li>\n<li><p>Create four variables, and initialize the first two:</p>\n\n<pre><code> wchar_t   *field = NULL;\n size_t     allocated = 0;\n size_t     length;\n csv_status status;\n</code></pre>\n\n<p><code>field</code> is a pointer to the dynamically allocated contents of each field you read. It is allocated automatically; essentially, you don't need to worry about it at all. <code>allocated</code> holds the currently allocated size (in wide characters, including terminating <code>L'\\0'</code>), and we'll use <code>length</code> and <code>status</code> later.</p></li>\n<li><p>At this point, you are ready to read or skip the first field in the first record.</p>\n\n<p>You do not wish to call <code>csv_next_record()</code> at this point, unless you wish to skip the very first record entirely in the file.</p></li>\n<li><p>Call <code>status = csv_skip_field(stream);</code> to skip the next field, or <code>status = csv_next_field(stream, &amp;field, &amp;allocated, &amp;length);</code> to read it.</p>\n\n<p>If <code>status == CSV_OK</code>, you have the field contents in wise string <code>field</code>. It has <code>length</code> wide characters in it.</p>\n\n<p>If <code>status == CSV_END</code>, there was no more fields in the current record. (The <code>field</code> is unchanged, and you should not examine it.)</p>\n\n<p>Otherwise, <code>status &lt; 0</code>, and it describes an error code. You can use <code>csv_error(status)</code> to obtain a (narrow) string describing it.</p></li>\n<li><p>At any point, you can move (skip) to the start of the next record by calling <code>status = csv_next_record(stream);</code>.</p>\n\n<p>If it returns <code>CSV_OK</code>, there might be a new record available. (We only know when you try to read or skip the first field. This is similar to how standard C library function <code>feof()</code> only tells you whether you have tried to read past the end of input, it does not tell whether there is more data available or not.)</p>\n\n<p>If it returns <code>CSV_END</code>, you already have processed the last record, and there are no more records.</p>\n\n<p>Otherwise, it returns a negative error code, <code>status &lt; 0</code>. You can use <code>csv_error(status)</code> to obtain a (narrow) string describing it.</p></li>\n<li><p>After you are done, discard the field buffer:</p>\n\n<pre><code> free(field);\n field = NULL;\n allocated = 0;\n</code></pre>\n\n<p>You do not actually need to reset the variables to <code>NULL</code> and zero, but I recommend it. In fact, you can do the above at any point (when you are no longer interested in the contents of the current field), as the <code>csv_next_field()</code> will then automatically allocate a new buffer as necessary.</p>\n\n<p>Note that <code>free(NULL);</code> is always safe and does nothing. You do not need to check if <code>field</code> is <code>NULL</code> or not before freeing it. This is also the reason why I recommend initializing the variables immediately when you declare them. It just makes everything so much easier to handle.</p></li>\n</ol>\n\n<p>The compiled example program takes one or more CSV file names as command-line parameters, then reads the files and reports the contents of each field in the file. If you have a particularly fiendishly complex CSV file, this is optimal for checking if this approach reads all the fields correctly.</p>\n"}], "owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4293, "favorite_count": 1, "accepted_answer_id": 36188053, "answer_count": 3, "score": 0, "last_activity_date": 1458822718, "creation_date": 1458751501, "question_id": 36184019, "link": "https://stackoverflow.com/questions/36184019/is-it-possible-force-utf-8-in-a-c-program", "title": "Is it possible &quot;force&quot; UTF-8 in a C program?", "body": "<p>Usually when I want my program to use UTF-8 encoding, I write <code>setlocale (LC_ALL, \"\");</code>. But today I found that it's just setting locate to environment's default locale, and I can't know whether the environment is using UTF-8 by default.</p>\n\n<p>I wonder is there any way to <strong>force</strong> the character encoding to be UTF-8? Also, is there any way to check whether my program is using UTF-8?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 3, "creation_date": 1458751489, "post_id": 36183880, "comment_id": 60003269, "body": "It&#39;s impossible to suggest how you can fix this, since there&#39;s no way of telling what you were trying to do in the first place."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 10, "creation_date": 1458752533, "post_id": 36183880, "comment_id": 60004021, "body": "Hmmm: OP, user user6007887, gone/deleted after only 20 minutes.  Looks like HW question was answered."}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 6, "creation_date": 1458829839, "post_id": 36183880, "comment_id": 60038614, "body": "Well, though OP is gone, <a href=\"http://meta.stackoverflow.com/questions/319596/where-is-the-op-of-this-question#comment326213_319597\">what&#39;s wrong</a> with this question that it is downvoted so badly?"}, {"owner": {"reputation": 25533, "user_id": 3318517, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fa52f0ed961993dce0a5c271dca0b4b7?s=128&d=identicon&r=PG", "display_name": "Daniel Darabos", "link": "https://stackoverflow.com/users/3318517/daniel-darabos"}, "edited": false, "score": 1, "creation_date": 1458899384, "post_id": 36183880, "comment_id": 60066941, "body": "By the edit history it looks like it was more ambiguous originally. Christian has added <i>&quot;should output exponentiations of 2&quot;</i> which improved it a lot."}], "answers": [{"tags": [], "owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "is_accepted": false, "score": 21, "last_activity_date": 1458987246, "last_edit_date": 1458987246, "creation_date": 1458751333, "answer_id": 36183959, "question_id": 36183880, "link": "https://stackoverflow.com/questions/36183880/multiplication-resulting-in-zero/36183959#36183959", "title": "Multiplication resulting in zero", "body": "<p>Plain <code>int</code> in C is <code>signed</code>. There is no conditional expression in <code>for</code> to break the loop. This makes it infinite which results in <a href=\"https://en.wikipedia.org/wiki/Integer_overflow\" rel=\"nofollow\">signed integer overflow</a> and which ultimately invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow\">undefined behavior</a>. In this case you can't expect any good.  </p>\n"}, {"comments": [{"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1458987088, "post_id": 36184293, "comment_id": 60098730, "body": "As far as I know <code>signed</code> overflow is undefined behavior. Could you please provide a confirmation from standard that says about it can reaches to <code>0</code>?"}, {"owner": {"reputation": 6882, "user_id": 611562, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3dbe1a93b0b5d353b419d62de19832c3?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/611562/matt"}, "reply_to_user": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1458993319, "post_id": 36184293, "comment_id": 60100470, "body": "@haccks hence having to add &quot;assuming the way overflows are handled is very basic&quot;. In the C standard the example given for <a href=\"http://port70.net/~nsz/c/c11/n1570.html#3.4.3p3\" rel=\"nofollow noreferrer\">underfined behaviour</a> is integer overflow. Unsigned overflow does not exist as unsigned integers are always truncated. So no, but for the common case that signed integers are stored as 2s complement, with ALU treating them as unsigned integers, the result will be as described."}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1459022320, "post_id": 36184293, "comment_id": 60110527, "body": "If that&#39;s the case then it must be &quot;implementation defined&quot; instead of &quot;undefined&quot;, but it&#39;s not."}], "tags": [], "owner": {"reputation": 6882, "user_id": 611562, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3dbe1a93b0b5d353b419d62de19832c3?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/611562/matt"}, "is_accepted": false, "score": 19, "last_activity_date": 1458752265, "creation_date": 1458752265, "answer_id": 36184293, "question_id": 36183880, "link": "https://stackoverflow.com/questions/36183880/multiplication-resulting-in-zero/36184293#36184293", "title": "Multiplication resulting in zero", "body": "<p>In this case it will very quickly reach zero if it overflows (assuming the way overflows are handled is very basic). Look at the operation in binary:</p>\n\n<pre><code>C  Bits\n0  00000010\n0  00000100\n0  00010000\n1  00000000\n</code></pre>\n\n<p>So you see that for an 8 bit integer, the overflow leaves you with zero (rather than some other number, or -128 as you'd get with signed integers).</p>\n\n<p>In 5 iterations exactly the same thing will happen to a 32 bit integer. </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6007887"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1389, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1459018632, "creation_date": 1458751162, "last_edit_date": 1459018632, "question_id": 36183880, "link": "https://stackoverflow.com/questions/36183880/multiplication-resulting-in-zero", "title": "Multiplication resulting in zero", "body": "<p>The following loop should recursively multiply a value by itself starting with 2. After some iterations the value seems to be 0 instead of ever growing numbers. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main() {\n    int i;\n    for (i = 2; ; i = i * i) {\n        printf(\"%d\\n\", i);\n    }\n}\n</code></pre>\n\n<p>Can somebody explain me why? Is there some way to fix it?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 7961, "user_id": 329801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a738a21eabcad64d71d7aeea53d84891?s=128&d=identicon&r=PG", "display_name": "thelaws", "link": "https://stackoverflow.com/users/329801/thelaws"}, "edited": false, "score": 2, "creation_date": 1458750936, "post_id": 36183696, "comment_id": 60002870, "body": "Add another <code>int</code> variable, initialize it to zero, and increment it whenever you find a factor"}, {"owner": {"reputation": 6882, "user_id": 611562, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3dbe1a93b0b5d353b419d62de19832c3?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/611562/matt"}, "edited": false, "score": 0, "creation_date": 1458750952, "post_id": 36183696, "comment_id": 60002879, "body": "So you currently loop from 2 to num, and in that loop check if <code>factors</code> is a factor. Create a new variable, set to 2 (or zero depending on how you count) then increment it whenever you find and print a factor."}, {"owner": {"reputation": 7, "user_id": 4494835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecc25e40d7d1c696d037ab9ffb7760f5?s=128&d=identicon&r=PG&f=1", "display_name": "MrSir231", "link": "https://stackoverflow.com/users/4494835/mrsir231"}, "edited": false, "score": 0, "creation_date": 1458751253, "post_id": 36183696, "comment_id": 60003098, "body": "Ok I got it now. Thanks for the help."}], "answers": [{"tags": [], "owner": {"reputation": 12945, "user_id": 2246488, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/7f300ea1293fd5e1b95783b6511d5a13?s=128&d=identicon&r=PG&f=1", "display_name": "James Wierzba", "link": "https://stackoverflow.com/users/2246488/james-wierzba"}, "is_accepted": false, "score": 0, "last_activity_date": 1458753008, "last_edit_date": 1458753008, "creation_date": 1458751737, "answer_id": 36184099, "question_id": 36183696, "link": "https://stackoverflow.com/questions/36183696/storing-the-amount-of-factors-as-a-variable-in-c/36184099#36184099", "title": "Storing the amount of factors as a variable in C", "body": "<p>I think what you're asking is how to store all factors? </p>\n\n<p>However, based on your sample output, you wouldn't even need to cache the values, you should only need to keep a count of them.</p>\n\n<p>Initialize a variable <code>cnt</code> to 0</p>\n\n<pre><code>int cnt = 0;\n</code></pre>\n\n<p>and increment it every time you see a factor:</p>\n\n<pre><code>  if(num % factors == 0){\n      printf(\"%d \",factors);\n      cnt++;\n  }\n</code></pre>\n\n<p>Then your line 2 output would be:</p>\n\n<pre><code>printf(\"%d has %d factors\", num, cnt);\n</code></pre>\n\n<p>And then you can check the cnt of factors to determine if it is prime:</p>\n\n<pre><code>bool isPrime = (cnt == 0);\nif(isPrime) printf(\"%d is a prime number\", num);\nelse printf(\"%d is not a prime number\", num);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1458753670, "last_edit_date": 1495542690, "creation_date": 1458753670, "answer_id": 36184732, "question_id": 36183696, "link": "https://stackoverflow.com/questions/36183696/storing-the-amount-of-factors-as-a-variable-in-c/36184732#36184732", "title": "Storing the amount of factors as a variable in C", "body": "<p>Algorithm error</p>\n\n<p>The <code>for()</code> has no early <code>break</code>, so after the loop is done, <code>factors == num</code> if <code>num</code> is at least 2.</p>\n\n<pre><code>for(factors = 2; factors &lt; num; factors++){\n....\n}\n// This is really doing `num % num` which is 0, which equals 0, so always true\nif(num % factors == 0){\n</code></pre>\n\n<p>Instead simply counts the factors.  2nd half similar to <a href=\"https://stackoverflow.com/a/36184099/2410359\">@James Wierzba</a></p>\n\n<pre><code>unsigned count = 0;\nfor(factors = 2; factors &lt; num; factors++) {\n  if(num % factors == 0){\n    count++;\n    printf(\"%d \",factors);\n  }\n}\n\nif (count &gt; 0) {\n  printf(\"%d is not a prime number\\n\", num);}\n}\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 4494835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecc25e40d7d1c696d037ab9ffb7760f5?s=128&d=identicon&r=PG&f=1", "display_name": "MrSir231", "link": "https://stackoverflow.com/users/4494835/mrsir231"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1458753670, "creation_date": 1458750686, "last_edit_date": 1458750743, "question_id": 36183696, "link": "https://stackoverflow.com/questions/36183696/storing-the-amount-of-factors-as-a-variable-in-c", "title": "Storing the amount of factors as a variable in C", "body": "<p>I'm taking a beginner's programming course and have a question. I'm suppose to be able to enter a number, and have it print out something like this</p>\n\n<pre><code>Factors of 36 between 2 and 35: 2 3 4 6 9 12 18 \n36 has 7 factors\n36 is not a prime number\n</code></pre>\n\n<p>My code so far allows the user to enter a number, and can print out the first line, but i'm having trouble getting the number of factors as a variable. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\nint main()\n{\n    int num, num2, factors;\n\n    printf(\"Enter a number: \");\n    scanf(\"%d\", &amp;num);\n    num2 = num - 1;\n    printf(\"Factors of %d between 2 and %d: \", num, num2);\n    for(factors = 2; factors &lt; num; factors++){\n        if(num % factors == 0){\n            printf(\"%d \",factors);\n            }\n        }\n    if(num % factors == 0){\n        printf(\"\\n\");\n        printf(\"%d has factors\\n\", num);\n        printf(\"%d is not a prime number\\n\", num);}\n}\n</code></pre>\n\n<p>If I can figure out how to get number of factors as a variable, then I can get the third line by myself, but I'm having trouble.</p>\n\n<p>Any help in the right direction would be appreciated.</p>\n"}, {"tags": ["c", "arduino", "embedded"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1458806186, "post_id": 36183623, "comment_id": 60024579, "body": "Mmm, spaghetti! Who wrote the library, some pasta chef?"}], "answers": [{"comments": [{"owner": {"reputation": 127, "user_id": 5922192, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d6dd8d26a8d2e4f424c6b5da0744dc24?s=128&d=identicon&r=PG", "display_name": "Doe Joe", "link": "https://stackoverflow.com/users/5922192/doe-joe"}, "edited": false, "score": 0, "creation_date": 1458752390, "post_id": 36183882, "comment_id": 60003929, "body": "would like to check again: would <code>sscanf(buf, &quot;%d&quot;,  &amp;num);</code> suffice for this case (to ignore \\r\\n) or would <code>sscanf(buf, &quot;%[^\\r\\n]&quot;, &amp;num);</code> do the same function as well?"}, {"owner": {"reputation": 22422, "user_id": 634919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4a87fe094961af20263d8e7ff445b2?s=128&d=identicon&r=PG", "display_name": "Nate Eldredge", "link": "https://stackoverflow.com/users/634919/nate-eldredge"}, "reply_to_user": {"reputation": 127, "user_id": 5922192, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d6dd8d26a8d2e4f424c6b5da0744dc24?s=128&d=identicon&r=PG", "display_name": "Doe Joe", "link": "https://stackoverflow.com/users/5922192/doe-joe"}, "edited": false, "score": 0, "creation_date": 1458752688, "post_id": 36183882, "comment_id": 60004120, "body": "<code>sscanf(buf, &quot;%d&quot;, &amp;num);</code> would work fine.  <code>sscanf(buf, &quot;%d\\r\\n&quot;, &amp;num);</code> would also work, since the <code>\\r\\n</code>, being a sequence of whitespace characters, matches any amount of whitespace in the string, including none (again, read the manual).  <code>sscanf(buf, &quot;%[^\\r\\n]&quot;, &amp;num);</code> would not work at all, since it is expecting to store a string, not an integer.  You&#39;d wind up with <code>num</code> containing something like 0x313131, or if the string was more than <code>sizeof(int)</code> bytes, you&#39;d overwrite other memory."}, {"owner": {"reputation": 127, "user_id": 5922192, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d6dd8d26a8d2e4f424c6b5da0744dc24?s=128&d=identicon&r=PG", "display_name": "Doe Joe", "link": "https://stackoverflow.com/users/5922192/doe-joe"}, "edited": false, "score": 0, "creation_date": 1458752851, "post_id": 36183882, "comment_id": 60004227, "body": "ok thank you so much for the insight! much appreciated. (ps still learning C)"}], "tags": [], "owner": {"reputation": 22422, "user_id": 634919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4a87fe094961af20263d8e7ff445b2?s=128&d=identicon&r=PG", "display_name": "Nate Eldredge", "link": "https://stackoverflow.com/users/634919/nate-eldredge"}, "is_accepted": true, "score": 0, "last_activity_date": 1458751561, "last_edit_date": 1458751561, "creation_date": 1458751163, "answer_id": 36183882, "question_id": 36183623, "link": "https://stackoverflow.com/questions/36183623/c-removing-new-line-null-terminate-input-string/36183882#36183882", "title": "C: removing new line/null terminate input string", "body": "<p>It looks to me like you should expect <code>111\\r\\n\\0</code>.  Note that the condition <code>b[0] != until</code> is checked after incrementing <code>i</code>, so when the newline character is received and the loop exits, <code>i</code> points to the next byte after <code>\\n</code>.  Then <code>b[i]=0</code> stores a null byte there.</p>\n\n<p>Note that this code appears to have a bug: if the <code>until</code> character is never received, the loop will run until <code>i == buf_max</code> and then store one byte more with the null terminator.  So a total of <code>buf_max+1</code> bytes are stored, meaning the following code would have a buffer overflow: </p>\n\n<pre><code>char mybuf[123];\nserialport_read_until(fd, buf, 'x', 123, 42);\n</code></pre>\n\n<p>Unless the documentation says that <code>buf_max</code> should be one less than the size of the buffer, which would be counterintuitive and error-prone, the loop termination condition should probably say <code>i+1 &lt; buf_max</code> or something similar.  </p>\n\n<p>Also, since <code>i</code> is checked at the end, even with this fix, the code will still store one byte if you pass in <code>buf_max == 0</code> (but without the fix it will store two bytes).  So that's another bug.</p>\n\n<p>The <code>char b[1];</code> declaration and accompanying comment is a little weird too.  It would be more idiomatic to simply declare <code>char b;</code> and then just pass <code>&amp;b</code> to <code>read()</code>.</p>\n\n<p>So if this is your code, there's more work to do on it.  If it's someone else's code, I'd be very careful using this library, if this function is any indication of the quality.</p>\n\n<p>Doing <code>buf[i-1]=0</code> at the end would avoid the overflow, but would also mean that if the <code>until</code> character is not received, the last byte received would be lost.  It would also break if you ever call the function with <code>buf_max == 0</code>.  So that's not what you want.  </p>\n\n<p>If you're using <code>sscanf</code>, the question of whether or not there is trailing whitespace is irrelevant; <code>sscanf(\"%d\")</code> will just ignore it.  You should have a careful read through your library's documentation of <code>sscanf</code>.  In particular, the way it handles whitespace is not always intuitive.</p>\n"}], "owner": {"reputation": 127, "user_id": 5922192, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d6dd8d26a8d2e4f424c6b5da0744dc24?s=128&d=identicon&r=PG", "display_name": "Doe Joe", "link": "https://stackoverflow.com/users/5922192/doe-joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1622, "favorite_count": 0, "accepted_answer_id": 36183882, "answer_count": 1, "score": 0, "last_activity_date": 1458751561, "creation_date": 1458750446, "last_edit_date": 1458751167, "question_id": 36183623, "link": "https://stackoverflow.com/questions/36183623/c-removing-new-line-null-terminate-input-string", "title": "C: removing new line/null terminate input string", "body": "<p>In C I'm using this method from a serial library:</p>\n\n<pre><code>int serialport_read_until(int fd, char* buf, char until, int buf_max, int timeout)\n{\n    char b[1];  // read expects an array, so we give it a 1-byte array\n    int i=0;\n    do { \n        int n = read(fd, b, 1);  // read a char at a time\n        if( n==-1) return -1;    // couldn't read\n        if( n==0 ) {\n            usleep( 1 * 1000 );  // wait 1 msec try again\n            timeout--;\n            if( timeout==0 ) return -2;\n            continue;\n        }\n#ifdef SERIALPORTDEBUG  \n        printf(\"serialport_read_until: i=%d, n=%d b='%c'\\n\",i,n,b[0]); // debug\n#endif\n        buf[i] = b[0]; \n        i++;\n    } while( b[0] != until &amp;&amp; i &lt; buf_max &amp;&amp; timeout&gt;0 );\n\n    buf[i] = 0;  // null terminate the string\n    return 0;\n}\n</code></pre>\n\n<p>The string that it is going to read is like this:\n\"111\\r\\n\" (with a carriage + new line behind)</p>\n\n<p>It is being printed out in Arduino using</p>\n\n<pre><code>serial.print(\"1\");\nserial.print(\"1\");\nserial.println(\"1\");\n</code></pre>\n\n<p>Using the serialport_read_until method (char until is '<strong>\\r\\n</strong>'), I want to ensure that I am reading the entire buffer correctly.</p>\n\n<p>Which of the following below does the char* buf look like in the end?</p>\n\n<blockquote>\n  <p>1) 111\\r\\n</p>\n  \n  <p>2) 111\\r\\n\\0</p>\n  \n  <p>3) 111\\0</p>\n  \n  <p>4) 111</p>\n</blockquote>\n\n<p>I need to figure out this part before I use sscanf method to convert the string into an integer correctly, but I'm not sure which to use:</p>\n\n<p><code>sscanf(buf, \"%d\\r\\n\", &amp;num);</code> OR <code>sscanf(buf, \"%d\", &amp;num);</code></p>\n\n<p>In addition, should I change the 2nd last line: <code>buf[i] = 0;</code> to <code>buf[i-1] = 0;</code> ?</p>\n"}, {"tags": ["c", "linux", "linker", "x86-64", "elf"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458750618, "post_id": 36183515, "comment_id": 60002661, "body": "And you compile for a 64 bit target?"}, {"owner": {"reputation": 1054, "user_id": 1521243, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/caec6b8ca7c22e89ceeb5a350b75f61c?s=128&d=identicon&r=PG", "display_name": "Ari", "link": "https://stackoverflow.com/users/1521243/ari"}, "edited": false, "score": 0, "creation_date": 1458751036, "post_id": 36183515, "comment_id": 60002932, "body": "Hazarding a guess: in the virtual memory layout for your process, the .data segment is near the beginning, after the .text segment. You don&#39;t have 4GB of code, so it&#39;s probably safe to assume .data it starts in the 32 bit space."}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1458751675, "post_id": 36183515, "comment_id": 60003399, "body": "BTW <code>1&lt;&lt;32</code> is sometimes UB."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1458810015, "post_id": 36183515, "comment_id": 60026356, "body": "I got the question reopened by inserting more details on what happens on Linux. You should add enough detail into the question itself so that it doesn&#39;t get closed."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1458811184, "post_id": 36183515, "comment_id": 60026993, "body": "The linker decides where the <code>.rodata</code> and <code>.data</code> sections will be in virtual memory.  The ELF loader in the kernel must map the executable to the addresses its metadata specifies.  Linux executables do <i>not</i> have to be position-independent.  Only shared libraries have to be PIC.  This is there can be a compiler option for code model without any mention of OS support.  Good question, though.  It&#39;s not obvious how to google this: You wouldn&#39;t know what to search on unless you already know the answer."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1458822108, "post_id": 36183515, "comment_id": 60033418, "body": "@AnttiHaapala: It&#39;s weird that this got closed.  The original question was well-written and pretty clear.  I knew right away what was being asked.  I have to assume that the close-voters didn&#39;t know the answer and didn&#39;t know that amd64 compilers do this for accessing static data.  To be fair, it&#39;s <i>usually</i> a safe assumption that a low-rep user asking a question has some silly misunderstanding or mistake like building in 32bit mode, and a question with an interesting answer is the exception.  Anyway, I cleaned up your edit to leave out the noisy full compiler output."}], "answers": [{"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1458818166, "post_id": 36183894, "comment_id": 60031017, "body": "You can actually use <code>-fpie</code> to make position independent executables.  This may enable slightly faster code than <code>-fpic</code>, depending on the target architecture, since the code doesn&#39;t have to be linkable into a shared library.  I&#39;m not sure if this makes a difference for i386 or amd64 targets."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1536599428, "post_id": 36183894, "comment_id": 91472718, "body": "Update, <code>-fpie</code> can still inline non-<code>static</code> functions, but <code>-fpic</code> can&#39;t because it has to assume symbol-interposition.  See <a href=\"https://www.macieira.org/blog/2012/01/sorry-state-of-dynamic-libraries-on-linux/\" rel=\"nofollow noreferrer\">macieira.org/blog/2012/01/&hellip;</a> for <code>-fPIC</code>, and my answer on <a href=\"https://stackoverflow.com/q/43367427\">32-bit absolute addresses no longer allowed in x86-64 Linux?</a> for more about <code>-fpie</code> vs. PIC.  <code>-fpie -pie</code> is the default for gcc on most recent Linux distros."}], "tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": false, "score": 1, "last_activity_date": 1458812200, "last_edit_date": 1495542687, "creation_date": 1458751186, "answer_id": 36183894, "question_id": 36183515, "link": "https://stackoverflow.com/questions/36183515/how-can-gcc-clang-assume-a-string-constants-address-is-32-bit/36183894#36183894", "title": "How can gcc/clang assume a string constant&#39;s address is 32-bit?", "body": "<p>I can confirm that this happens on 64-bit compilation:</p>\n\n<pre><code>gcc -O1 foo.c\n</code></pre>\n\n<p>Then <code>objdump -d a.out</code> (notice also that <code>printf(\"%s\\n\")</code> can be <a href=\"https://stackoverflow.com/questions/11589342/what-is-the-behavior-of-printing-null-with-printfs-s-specifier\">optimized into <code>puts</code>!</a>):</p>\n\n<pre><code>0000000000400536 &lt;main&gt;:\n  400536:       48 83 ec 08             sub    $0x8,%rsp\n  40053a:       bf d4 05 40 00          mov    $0x4005d4,%edi\n  40053f:       e8 cc fe ff ff          callq  400410 &lt;puts@plt&gt;\n  400544:       b8 00 00 00 00          mov    $0x0,%eax\n  400549:       48 83 c4 08             add    $0x8,%rsp\n  40054d:       c3                      retq   \n  40054e:       66 90                   xchg   %ax,%ax\n</code></pre>\n\n<p>The reason is that GCC defaults to <code>-mcmodel=small</code> where the static data is linked in the bottom 2G of address space.</p>\n\n<hr>\n\n<p>Notice that string constants do not go to the data segment, but they're within the code segment instead, unless <code>-fwritable-strings</code>. Also if you want to relocate the object code freely in memory, you'd probably want to compile with <code>-fpic</code> to make the code RIP relative instead of putting 64-bit addresses everywhere.</p>\n"}, {"tags": [], "owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "is_accepted": true, "score": 6, "last_activity_date": 1458752083, "creation_date": 1458752083, "answer_id": 36184230, "question_id": 36183515, "link": "https://stackoverflow.com/questions/36183515/how-can-gcc-clang-assume-a-string-constants-address-is-32-bit/36184230#36184230", "title": "How can gcc/clang assume a string constant&#39;s address is 32-bit?", "body": "<p>In GCC manual:</p>\n\n<p><a href=\"https://gcc.gnu.org/onlinedocs/gcc-4.5.3/gcc/i386-and-x86_002d64-Options.html\" rel=\"noreferrer\">https://gcc.gnu.org/onlinedocs/gcc-4.5.3/gcc/i386-and-x86_002d64-Options.html</a></p>\n\n<p><strong>3.17.15 Intel 386 and AMD x86-64 Options</strong></p>\n\n<blockquote>\n  <p><strong>-mcmodel=small</strong></p>\n  \n  <p>Generate code for the small code model: the program and its symbols\n  must be linked in the lower 2 GB of the address space. Pointers are 64\n  bits. Programs can be statically or dynamically linked. <strong>This is the</strong>\n  <strong>default code model.</strong></p>\n  \n  <p>-mcmodel=kernel Generate code for the kernel code model. The kernel runs in the negative 2 GB of the address space. This model has to be\n  used for Linux kernel code.</p>\n  \n  <p>-mcmodel=medium</p>\n  \n  <p>Generate code for the medium model: The program is linked in the lower\n  2 GB of the address space. Small symbols are also placed there.\n  Symbols with sizes larger than -mlarge-data-threshold are put into\n  large data or bss sections and can be located above 2GB. Programs can\n  be statically or dynamically linked.</p>\n  \n  <p>-mcmodel=large</p>\n  \n  <p>Generate code for the large model: This model makes no assumptions\n  about addresses and sizes of sections.</p>\n</blockquote>\n\n<hr>\n\n<p><a href=\"https://gcc.gnu.org/onlinedocs/gcc/AArch64-Options.html\" rel=\"noreferrer\">https://gcc.gnu.org/onlinedocs/gcc/AArch64-Options.html</a></p>\n\n<p><strong>3.18.1 AArch64 Options</strong></p>\n\n<blockquote>\n  <p>-mcmodel=tiny</p>\n  \n  <p>Generate code for the tiny code model. The program and its statically defined symbols must be within 1GB of each other. Pointers\n  are 64 bits. Programs can be statically or dynamically linked. This\n  model is not fully implemented and mostly treated as \u2018small\u2019.</p>\n  \n  <p><strong>-mcmodel=small</strong></p>\n  \n  <p>Generate code for the small code model. The program and its statically defined symbols must be within 4GB of each other. Pointers\n  are 64 bits. Programs can be statically or dynamically linked. <strong>This is</strong>\n  <strong>the default code model</strong>.</p>\n  \n  <p>-mcmodel=large</p>\n  \n  <p>Generate code for the large code model. This makes no assumptions about addresses and sizes of sections. Pointers are 64 bits. Programs\n  can be statically linked only.</p>\n</blockquote>\n"}], "owner": {"reputation": 113, "user_id": 477345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ed26a837f3997f704bde464fa7a7768?s=128&d=identicon&r=PG", "display_name": "Scott Carr", "link": "https://stackoverflow.com/users/477345/scott-carr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 499, "favorite_count": 1, "accepted_answer_id": 36184230, "answer_count": 2, "score": 5, "last_activity_date": 1458822204, "creation_date": 1458750174, "last_edit_date": 1458822204, "question_id": 36183515, "link": "https://stackoverflow.com/questions/36183515/how-can-gcc-clang-assume-a-string-constants-address-is-32-bit", "title": "How can gcc/clang assume a string constant&#39;s address is 32-bit?", "body": "<p>If I compile this program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(int argc, char** argv) {\n    printf(\"hello world!\\n\");\n    return 0;\n}\n</code></pre>\n\n<p>for x86-64, the asm output uses <code>movl  $.LC0, %edi</code> / <code>call puts</code>.  (<a href=\"http://gcc.godbolt.org/#%7B%22version%22%3A3%2C%22filterAsm%22%3A%7B%22labels%22%3Atrue%2C%22directives%22%3Atrue%2C%22commentOnly%22%3Atrue%7D%2C%22compilers%22%3A%5B%7B%22sourcez%22%3A%22MQSwdgxgNgrgJgUwAQB4DOAXOID2A6ACwD4AoE8DJAWwENwAKCpGgJwHMIAaJCA1gKn7N2ANwCUSAN4kkspAAcWFAGb0ARAQRQoOJAHccLKHACEAHTBqxAbhlyWCDDBZgkABlsBfIAA%3D%22%2C%22compiler%22%3A%22g530%22%2C%22options%22%3A%22-xc%20%20-O3%20%20-Wall%22%7D%5D%7D\" rel=\"nofollow\">See full asm output / compile options on godbolt</a>.)</p>\n\n<p>My question is: How can GCC know that the the string's address can fit in a 32bit immediate operand?  Why doesn't it need to use <code>movabs  $.LC0, %rdi</code> (i.e. a <code>mov r64, imm64</code>, not a zero or sign-extended <code>imm32</code>).</p>\n\n<p>AFAIK, there's nothing saying the loader has to decide to load the data section at any particular address.  If the string is stored at some address above <code>1ULL &lt;&lt; 32</code> then the higher bits will be ignored by the movl.  I get similar behavior with clang, so I don't think this is unique to GCC.</p>\n\n<hr>\n\n<p>The reason I care is I want to create my own data segment that lives in memory at any arbitrary address I choose (above 2^32 potentially). </p>\n"}, {"tags": ["c", "windows", "character-encoding", "console-application", "locale"], "answers": [{"tags": [], "owner": {"reputation": 26421, "user_id": 343721, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b8ad1d8e899bd63166450473531f65b6?s=128&d=identicon&r=PG", "display_name": "Jan Turo\u0148", "link": "https://stackoverflow.com/users/343721/jan-turo%c5%88"}, "is_accepted": false, "score": 0, "last_activity_date": 1458760464, "creation_date": 1458760464, "answer_id": 36186817, "question_id": 36183438, "link": "https://stackoverflow.com/questions/36183438/scanf-printf-call-messes-non-ascii-chars-after-locale-is-set/36186817#36186817", "title": "scanf-printf call messes non-ASCII chars after locale is set", "body": "<p>After 3 hours of testing, I finaly got the working solution. It might not work for everybody since there is still a little mystery behind it. So this helped:</p>\n\n<pre><code>setlocale(LC_CTYPE,\"Czech_Czech Republic.852\");\n</code></pre>\n\n<p>CP852 was the default console codepage for Central Europe since DOS times. There is also <code>chcp</code> DOS command and <code>SetConsoleCP</code> and <code>SetconsoleOutputCP</code> winAPI functions. For some reason, this still messes the output:</p>\n\n<pre><code>setlocale(LC_CTYPE,\"Czech_Czech Republic.1250\");\nSetConsoleCP(1250);\nSetConsoleOutputCP(1250);\n</code></pre>\n\n<p>...but this is OK</p>\n\n<pre><code>setlocale(LC_CTYPE,\"Czech_Czech Republic.852\");\nSetConsoleCP(852); // default in CE win console\nSetConsoleOutputCP(852); // default in CE win console\n</code></pre>\n\n<p>Note that UTF-8 can't be set in <code>setlocale</code>, see the original question.</p>\n"}], "owner": {"reputation": 26421, "user_id": 343721, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b8ad1d8e899bd63166450473531f65b6?s=128&d=identicon&r=PG", "display_name": "Jan Turo\u0148", "link": "https://stackoverflow.com/users/343721/jan-turo%c5%88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 298, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1458760464, "creation_date": 1458749951, "last_edit_date": 1458754023, "question_id": 36183438, "link": "https://stackoverflow.com/questions/36183438/scanf-printf-call-messes-non-ascii-chars-after-locale-is-set", "title": "scanf-printf call messes non-ASCII chars after locale is set", "body": "<p>I wonder why non-ASCII localed input-output fails:</p>\n\n<pre><code>setlocale(LC_ALL,\"\");\nscanf(\"%s\",buffer); // I type \"p\u0159\u00ed\u0161ern\u011b\"\nprintf(\"%s\",buffer); // I get \"p\u00fd\u02c7\u00e7ern\u0158\"\n</code></pre>\n\n<p>The locale is <em>Czech_Czech Republic.1250</em> and all the non-ASCII chars (\u0159\u00ed\u0161\u011b) are in CP1250. <strong>Why it fails?</strong> <a href=\"http://www.cplusplus.com/reference/clocale/\" rel=\"nofollow\">The reference</a> says</p>\n\n<blockquote>\n  <p>In &lt;cstdio> (&lt;stdio.h>), formatted input/output operations are\n  affected by character transformation rules.</p>\n</blockquote>\n\n<p>Using the default \"C\" locale gives correct output. <strong>How to fix it?</strong> On Windows I can't use UTF-8 in <a href=\"https://msdn.microsoft.com/cs-cz/library/x99tb11d.aspx\" rel=\"nofollow\">setlocale</a></p>\n\n<blockquote>\n  <p>If you provide a code page value of UTF-7 or UTF-8, setlocale will\n  fail, returning NULL.</p>\n</blockquote>\n\n<p>In my project I use setlocale to read UTF8 text file and to display it on console using WinAPI MultiByteToWideChar function, but that requires system default locale, so I need to set the locale.</p>\n\n<p><strong>edit</strong>: I just found the input is in <a href=\"http://www.acc.umu.se/~saasha/charsets/?charset=cp852&amp;charset=cp1250\" rel=\"nofollow\">CP852</a>, which is the default in \"C\". I suppose I could use <a href=\"https://sourceforge.net/projects/mingw/files/MinGW/Base/libiconv/libiconv-1.14-2/\" rel=\"nofollow\">iconv</a>, but I'd rather convince scanf not to stay with CP852.</p>\n"}, {"tags": ["java", "android", "c", "android-ndk", "java-native-interface"], "comments": [{"owner": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "edited": false, "score": 0, "creation_date": 1458749015, "post_id": 36182493, "comment_id": 60001504, "body": "And what do you get if you print <code>strlen(token)</code>?"}, {"owner": {"reputation": 2791, "user_id": 1439733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bb03e04f38790a0b3623e03a196542d?s=128&d=identicon&r=PG", "display_name": "Stefan Zobel", "link": "https://stackoverflow.com/users/1439733/stefan-zobel"}, "edited": false, "score": 1, "creation_date": 1458749100, "post_id": 36182493, "comment_id": 60001569, "body": "What is &quot;nothing&quot; - an empty byte array or null? Any chance that strlen(token) == 0 here?"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1458766074, "post_id": 36182493, "comment_id": 60012035, "body": "Also, post all your code.  Given your calls to <code>FindClass()</code> and <code>GetMethodID()</code>, you&#39;re likely leaving something out that&#39;s failing."}, {"owner": {"reputation": 11, "user_id": 3616378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4aa894b1469a59cc07767b22d0e89a8f?s=128&d=identicon&r=PG&f=1", "display_name": "asmine", "link": "https://stackoverflow.com/users/3616378/asmine"}, "edited": false, "score": 0, "creation_date": 1458793464, "post_id": 36182493, "comment_id": 60020760, "body": "comments:I got the value of strlen(token) is always 23,it was generated from get_token() method which is for AES decrypt. And i got a null from java. I had some error log infomation updated above."}], "owner": {"reputation": 11, "user_id": 3616378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4aa894b1469a59cc07767b22d0e89a8f?s=128&d=identicon&r=PG&f=1", "display_name": "asmine", "link": "https://stackoverflow.com/users/3616378/asmine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1026, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1458880117, "creation_date": 1458747438, "last_edit_date": 1458794276, "question_id": 36182493, "link": "https://stackoverflow.com/questions/36182493/jni-convert-unsigned-char-to-jbytearray-and-return-jbytearray-to-java", "title": "JNI convert unsigned char* to jbyteArray and return jbyteArray to java", "body": "<p>I got a unsigned char* data using c which is decrpt by AES,and i wanted to convert this data to jbyteArryay and return it to java:\nthis is the code:</p>\n\n<pre><code>{\n   unsigned char* token = get_token();//get token from AES decrypt method\n\n   LOGV(\"token is:%s\",token);//it shows me that string like:\"jghgillldjdmdejkgmmjdkf\"\n\n   /**\n    * when i try this line:unsigned char* token = \"jghgillldjdmdejkgmmjdkf\";i works.\n    */\n\n   jclass strClass = (*env)-&gt;FindClass(env,\"java/lang/String\");\n   jmethodID ctorID = (*env)-&gt;GetMethodID(env,strClass,\"&lt;init&gt;\", \"([BLjava/lang/String;)V\");\n   jbyteArray bytes = (*env)-&gt;NewByteArray(env,strlen(token));\n   (*env)-&gt;SetByteArrayRegion(env,bytes,0,strlen(token),(jbyte*)token);\n   return bytes;\n}\n</code></pre>\n\n<p>but when i try to get the value from java,i got nothing,is here anyone who can help me? I really got a trouble on it,Thank you very much!</p>\n\n<p><strong>UPDATE:</strong>\nI tried another way like :</p>\n\n<pre><code>{\nchar *token = get_token();\nreturn (*env)-&gt;NewStringUTF(env,token);\n}\n</code></pre>\n\n<p>but the android device crashed,and the error log is:</p>\n\n<pre><code>03-23 13:15:01.951: A/art(5211): art/runtime/check_jni.cc:65] JNI DETECTED   ERROR IN APPLICATION: input is not valid Modified UTF-8: illegal continuation byte 0x2c\n03-23 13:15:01.951: A/art(5211): art/runtime/check_jni.cc:65]     string: 'igkjiekefkdiijikjljmdlf?,x??'\n03-23 13:15:01.951: A/art(5211): art/runtime/check_jni.cc:65]     in call to NewStringUTF\n03-23 13:15:01.951: A/art(5211): art/runtime/check_jni.cc:65]     from java.lang.String com.asmine.ssonative.SSONative.getToken(java.lang.String, java.lang.String)\n03-23 13:15:01.951: A/art(5211): art/runtime/check_jni.cc:65] \"Thread-313\" prio=5 tid=15 Runnable\n03-23 13:15:01.951: A/art(5211): art/runtime/check_jni.cc:65]   | group=\"main\" sCount=0 dsCount=0 obj=0x12ce50a0 self=0xed22a800\n03-23 13:15:01.951: A/art(5211): art/runtime/check_jni.cc:65]   | sysTid=5232 nice=0 cgrp=apps sched=0/0 handle=0xf435ab80\n03-23 13:15:01.951: A/art(5211): art/runtime/check_jni.cc:65]   | state=R schedstat=( 859393537 12390828 74 ) utm=83 stm=2 core=3 HZ=100\n03-23 13:15:01.951: A/art(5211): art/runtime/check_jni.cc:65]   | stack=0xe25fe000-0xe2600000 stackSize=1036KB\n03-23 13:15:01.951: A/art(5211): art/runtime/check_jni.cc:65]   | held mutexes= \"mutator lock\"(shared held)\n03-23 13:15:01.951: A/art(5211): art/runtime/check_jni.cc:65]   native: #00 pc 00005ac3  /system/lib/libbacktrace_libc++.so (UnwindCurrent::Unwind(unsigned int, ucontext*)+83)\n03-23 13:15:01.951: A/art(5211): art/runtime/check_jni.cc:65]   native: #01 pc 00002e91  /system/lib/libbacktrace_libc++.so (Backtrace::Unwind(unsigned int, ucontext*)+33)\n03-23 13:15:01.951: A/art(5211): art/runtime/check_jni.cc:65]   native: #02 pc 003c3f0a  /system/lib/libart.so (art::DumpNativeStack(std::__1::basic_ostream&lt;char, std::__1::char_traits&lt;char&gt; &gt;&amp;, int, char const*, art::mirror::ArtMethod*)+138)\n03-23 13:15:01.951: A/art(5211): art/runtime/check_jni.cc:65]   native: #03 pc 0038e85c  /system/lib/libart.so (art::Thread::Dump(std::__1::basic_ostream&lt;char, std::__1::char_traits&lt;char&gt; &gt;&amp;) const+284)\n03-23 13:15:01.951: A/art(5211): art/runtime/check_jni.cc:65]   native: #04 pc 0010131b  /system/lib/libart.so (art::JniAbort(char const*, char const*)+1019)\n03-23 13:15:01.951: A/art(5211): art/runtime/check_jni.cc:65]   native: #05 pc 00101ecc  /system/lib/libart.so (art::JniAbortF(char const*, char const*, ...)+108)\n03-23 13:15:01.951: A/art(5211): art/runtime/check_jni.cc:65]   native: #06 pc 00106b36  /system/lib/libart.so (art::ScopedCheck::Check(bool, char const*, ...) (.constprop.130)+3046)\n03-23 13:15:01.951: A/art(5211): art/runtime/check_jni.cc:65]   native: #07 pc 0010cd4d  /system/lib/libart.so (art::CheckJNI::NewStringUTF(_JNIEnv*, char const*)+93)\n</code></pre>\n"}, {"tags": ["c", "arrays", "constants"], "comments": [{"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1458747733, "post_id": 36182463, "comment_id": 60000504, "body": "Can you please show the <i>actual</i> declarations?  These are not arrays.  Unless that&#39;s the issue..."}, {"owner": {"reputation": 197, "user_id": 5585075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9030bcefdc0b9355e4fca09647ecc4fb?s=128&d=identicon&r=PG&f=1", "display_name": "T. Tournesol", "link": "https://stackoverflow.com/users/5585075/t-tournesol"}, "reply_to_user": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1458748022, "post_id": 36182463, "comment_id": 60000735, "body": "Sorry, I mistyped my example. It&#39;s a simplified form of the actual code."}, {"owner": {"reputation": 16970, "user_id": 2079345, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/lq0tx.png?s=128&g=1", "display_name": "chiliNUT", "link": "https://stackoverflow.com/users/2079345/chilinut"}, "edited": false, "score": 0, "creation_date": 1458773129, "post_id": 36182463, "comment_id": 60015245, "body": "genesis vdp, very cool!"}], "answers": [{"comments": [{"owner": {"reputation": 197, "user_id": 5585075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9030bcefdc0b9355e4fca09647ecc4fb?s=128&d=identicon&r=PG&f=1", "display_name": "T. Tournesol", "link": "https://stackoverflow.com/users/5585075/t-tournesol"}, "edited": false, "score": 0, "creation_date": 1458748123, "post_id": 36182702, "comment_id": 60000811, "body": "Sorry, I mistyped my example. I checked the actual code and didn&#39;t forget the brackets, so it&#39;s not so simple :)"}, {"owner": {"reputation": 1075, "user_id": 2539954, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/1ef914985b0030db224fbb296d0c9d0a?s=128&d=identicon&r=PG", "display_name": "Erik Nyquist", "link": "https://stackoverflow.com/users/2539954/erik-nyquist"}, "reply_to_user": {"reputation": 197, "user_id": 5585075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9030bcefdc0b9355e4fca09647ecc4fb?s=128&d=identicon&r=PG&f=1", "display_name": "T. Tournesol", "link": "https://stackoverflow.com/users/5585075/t-tournesol"}, "edited": false, "score": 0, "creation_date": 1458748208, "post_id": 36182702, "comment_id": 60000884, "body": "well, then nobody will be able to help you. You need to post the <i>actual code</i> that you are working with."}, {"owner": {"reputation": 197, "user_id": 5585075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9030bcefdc0b9355e4fca09647ecc4fb?s=128&d=identicon&r=PG&f=1", "display_name": "T. Tournesol", "link": "https://stackoverflow.com/users/5585075/t-tournesol"}, "edited": false, "score": 0, "creation_date": 1458748361, "post_id": 36182702, "comment_id": 60000996, "body": "I thought it was more comfortable to paste a code showing exactly the proble, and this code does, but if you want the actual code, I&#39;ll paste it at the end of the message."}, {"owner": {"reputation": 1075, "user_id": 2539954, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/1ef914985b0030db224fbb296d0c9d0a?s=128&d=identicon&r=PG", "display_name": "Erik Nyquist", "link": "https://stackoverflow.com/users/2539954/erik-nyquist"}, "reply_to_user": {"reputation": 197, "user_id": 5585075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9030bcefdc0b9355e4fca09647ecc4fb?s=128&d=identicon&r=PG&f=1", "display_name": "T. Tournesol", "link": "https://stackoverflow.com/users/5585075/t-tournesol"}, "edited": false, "score": 0, "creation_date": 1458748553, "post_id": 36182702, "comment_id": 60001135, "body": "That approach suggests you know exactly where the problem is. If that were the case, would you even be here? :)"}], "tags": [], "owner": {"reputation": 1075, "user_id": 2539954, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/1ef914985b0030db224fbb296d0c9d0a?s=128&d=identicon&r=PG", "display_name": "Erik Nyquist", "link": "https://stackoverflow.com/users/2539954/erik-nyquist"}, "is_accepted": false, "score": 6, "last_activity_date": 1458748369, "last_edit_date": 1458748369, "creation_date": 1458747978, "answer_id": 36182702, "question_id": 36182463, "link": "https://stackoverflow.com/questions/36182463/declaration-of-an-array-of-constants/36182702#36182702", "title": "Declaration of an array of constants", "body": "<p>\"What am I doing wrong?\"</p>\n\n<p>The most immediate thing I see is....</p>\n\n<p>this is not an array:</p>\n\n<pre><code>const int my_array = { /* elements */ }\n</code></pre>\n\n<p>this is an array:</p>\n\n<pre><code>const int my_array[N] = { /* N elements */ };\n</code></pre>\n\n<p>Additionally, don't ignore that error message! it speaks truth!</p>\n\n<pre><code>error: initializer element is not constant\n</code></pre>\n\n<p>You are using something that is not a constant, namely \"my_array\", to initialise array elements. \"my_array\" will evaluate to a pointer to the first element of the array, and this value is not known at compile time.</p>\n"}, {"comments": [{"owner": {"reputation": 197, "user_id": 5585075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9030bcefdc0b9355e4fca09647ecc4fb?s=128&d=identicon&r=PG&f=1", "display_name": "T. Tournesol", "link": "https://stackoverflow.com/users/5585075/t-tournesol"}, "edited": false, "score": 0, "creation_date": 1458749080, "post_id": 36182920, "comment_id": 60001552, "body": "The first approach is not suitable because my_other_array must go in ROM. The second would be incredibely convoluted since I need the symbol table with the actual location of my_array to generate the data in my_other_array... It&#39;s a much more painful problem than I thought..."}, {"owner": {"reputation": 197, "user_id": 5585075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9030bcefdc0b9355e4fca09647ecc4fb?s=128&d=identicon&r=PG&f=1", "display_name": "T. Tournesol", "link": "https://stackoverflow.com/users/5585075/t-tournesol"}, "edited": false, "score": 0, "creation_date": 1458750066, "post_id": 36182920, "comment_id": 60002311, "body": "Thanks a lot for you answer ! I wish I could select two answers :)"}, {"owner": {"reputation": 197, "user_id": 5585075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9030bcefdc0b9355e4fca09647ecc4fb?s=128&d=identicon&r=PG&f=1", "display_name": "T. Tournesol", "link": "https://stackoverflow.com/users/5585075/t-tournesol"}, "edited": false, "score": 0, "creation_date": 1458752159, "post_id": 36182920, "comment_id": 60003760, "body": "The EDIT is clever. Unfortunatelt, the endianness don&#39;t match here (and to make things worse, it&#39;s in fact addr/2 that must be sent, interleaved by 0x95, 0x96 and 0x97)."}], "tags": [], "owner": {"reputation": 5867, "user_id": 2252087, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/020cbe41b02f03d59f3adae022c0ce7d?s=128&d=identicon&r=PG", "display_name": "ensc", "link": "https://stackoverflow.com/users/2252087/ensc"}, "is_accepted": false, "score": 3, "last_activity_date": 1458750721, "last_edit_date": 1458750721, "creation_date": 1458748593, "answer_id": 36182920, "question_id": 36182463, "link": "https://stackoverflow.com/questions/36182463/declaration-of-an-array-of-constants/36182920#36182920", "title": "Declaration of an array of constants", "body": "<p>Assuming that you want to evaluate <code>my_array[X]</code> but not <code>my_array</code>:</p>\n\n<p>That's not supported by C; a shorter example might be</p>\n\n<pre><code>int const   foo[] = { 0 };\nint         bar[] = { foo[0] };\n</code></pre>\n\n<p>Despite the <code>const</code> keyword, the C standard does not allow to evaluate this at compile time.</p>\n\n<p>You can try to place it into function context</p>\n\n<pre><code>int const   foo[] = { 0 };\nint         bar[1];\n\nvoid init(void)\n{\n    int     tmp[] = { foo[0] };\n\n    memcpy(bar, tmp, sizeof tmp);\n}\n</code></pre>\n\n<p>Alternatively, you can use an external tool to generate a header file with <code>bar[]</code> content.</p>\n\n<p>EDIT:</p>\n\n<p>When your platform's endianess matches (linker places address of the array in the way how it is expected by the DMA controller), you can try</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n\nstatic int const    foo[] = { 23 };\nstruct dma {\n    uint16_t    a;\n    uint16_t    b;\n    uint16_t    c;\n    void const  *p;\n} __attribute__((__packed__));\n\nstruct dma const    tmp = {\n    .a  = 1,\n    .b  = 0x9370,\n    .c  = 0x9400,\n    .p  = foo,\n};\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 197, "user_id": 5585075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9030bcefdc0b9355e4fca09647ecc4fb?s=128&d=identicon&r=PG&f=1", "display_name": "T. Tournesol", "link": "https://stackoverflow.com/users/5585075/t-tournesol"}, "edited": false, "score": 0, "creation_date": 1458749987, "post_id": 36183088, "comment_id": 60002262, "body": "Thanks for your detailed answer. I naively thought that any calulation involving only constants would be suitable. I don&#39;t master the toolchain (it uses an old version of GCC with a premade make file) so I think I&#39;ll declare a zeroed array of the desired size, and write a small python script that&#39;ll read the symbol table and fill the zeroed array directly in the compiled binary. How awful..."}, {"owner": {"reputation": 22422, "user_id": 634919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4a87fe094961af20263d8e7ff445b2?s=128&d=identicon&r=PG", "display_name": "Nate Eldredge", "link": "https://stackoverflow.com/users/634919/nate-eldredge"}, "reply_to_user": {"reputation": 197, "user_id": 5585075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9030bcefdc0b9355e4fca09647ecc4fb?s=128&d=identicon&r=PG&f=1", "display_name": "T. Tournesol", "link": "https://stackoverflow.com/users/5585075/t-tournesol"}, "edited": false, "score": 0, "creation_date": 1458750200, "post_id": 36183088, "comment_id": 60002391, "body": "@T.Tournesol: If you&#39;re using GCC, you might also be using GNU ld as your linker, which has a rather powerful scripting language.  I don&#39;t know for sure whether it has this specific functionality, but it is worth checking."}, {"owner": {"reputation": 22422, "user_id": 634919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4a87fe094961af20263d8e7ff445b2?s=128&d=identicon&r=PG", "display_name": "Nate Eldredge", "link": "https://stackoverflow.com/users/634919/nate-eldredge"}, "reply_to_user": {"reputation": 197, "user_id": 5585075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9030bcefdc0b9355e4fca09647ecc4fb?s=128&d=identicon&r=PG&f=1", "display_name": "T. Tournesol", "link": "https://stackoverflow.com/users/5585075/t-tournesol"}, "edited": false, "score": 0, "creation_date": 1458750447, "post_id": 36183088, "comment_id": 60002556, "body": "@T.Tournesol: It&#39;s all part of the fun of low-level programming!"}, {"owner": {"reputation": 197, "user_id": 5585075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9030bcefdc0b9355e4fca09647ecc4fb?s=128&d=identicon&r=PG&f=1", "display_name": "T. Tournesol", "link": "https://stackoverflow.com/users/5585075/t-tournesol"}, "edited": false, "score": 0, "creation_date": 1458752215, "post_id": 36183088, "comment_id": 60003793, "body": "But it&#39;s in fact high-level !!! I was given the choice between C and plain 68000 asm :)"}], "tags": [], "owner": {"reputation": 22422, "user_id": 634919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4a87fe094961af20263d8e7ff445b2?s=128&d=identicon&r=PG", "display_name": "Nate Eldredge", "link": "https://stackoverflow.com/users/634919/nate-eldredge"}, "is_accepted": true, "score": 7, "last_activity_date": 1458750107, "last_edit_date": 1458750107, "creation_date": 1458749053, "answer_id": 36183088, "question_id": 36182463, "link": "https://stackoverflow.com/questions/36182463/declaration-of-an-array-of-constants/36183088#36183088", "title": "Declaration of an array of constants", "body": "<p>The elements you use to initialize your arrays need to be <em>constant expressions</em>.  These are defined in Section 6.6 of <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1256.pdf\" rel=\"nofollow\">the C99 standard</a> or the same place in <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow\">C11</a>.  See paragraph 7:</p>\n\n<blockquote>\n  <p>More latitude is permitted for constant expressions in initializers.\n  Such a constant expression shall be, or evaluate to, one of the\n  following:</p>\n  \n  <ul>\n  <li>an arithmetic constant expression,</li>\n  <li>a null pointer constant,</li>\n  <li>an address constant, or</li>\n  <li>an address constant for an object type plus or minus an integer constant expression.</li>\n  </ul>\n</blockquote>\n\n<p>Now <code>my_array</code> is an address constant, but all you're allowed to do to it is add or subtract an integer constant.  By shifting or masking, you're creating something that is no longer a constant expression, thus not allowable in an initializer.</p>\n\n<p>I guess the rationale for this restriction is that C is intended to be usable for relocatable code, where the program's location in memory may not be known until it's loaded in preparation for execution.  On such a system, references to addresses within the program have to be filled in by the loader, based on a table within the binary that it reads at load time (e.g. \"At relative address 0x12345678 within the program, fill in the absolute address of the object <code>my_array</code> once it is known\").  This table usually has a fairly restrictive format, and probably has a way to express constant offsets (\"fill in the absolute address of the object <code>my_array</code>, plus 42\") but typically won't support arbitrary arithmetic.  </p>\n\n<p>Probably the simplest solution for you is to make <code>my_other_array</code> not be <code>const</code> and fill it in at runtime, by writing a function that extracts the necessary bits of the address of <code>my_array</code> and inserts them into <code>my_other_array</code>, and call this function before you need to use <code>my_other_array</code>.</p>\n\n<p>If it's important for some reason that <code>my_other_array</code> be already filled in when the program is loaded, and your target platform is such that you know where in memory the program will be located, then you might be able to use the facilities of your assembler or linker to achieve what you want.  But of course this would be system-specific.</p>\n\n<p>(Edit: You've mentioned in another comment that this array needs to go in ROM.  If so, then I think my last suggestion is your only hope.  You may want to post another question about how / whether you can do this with the particular toolchain you're using.)</p>\n"}, {"comments": [{"owner": {"reputation": 197, "user_id": 5585075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9030bcefdc0b9355e4fca09647ecc4fb?s=128&d=identicon&r=PG&f=1", "display_name": "T. Tournesol", "link": "https://stackoverflow.com/users/5585075/t-tournesol"}, "edited": false, "score": 0, "creation_date": 1458750169, "post_id": 36183403, "comment_id": 60002357, "body": "Why would the address of snake_patterns[] be determined at runtime, if I declared it as a const ? The symbol table shows it&#39;s calculated during compilation, and it&#39;s stored in the ROM segment..."}, {"owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "reply_to_user": {"reputation": 197, "user_id": 5585075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9030bcefdc0b9355e4fca09647ecc4fb?s=128&d=identicon&r=PG&f=1", "display_name": "T. Tournesol", "link": "https://stackoverflow.com/users/5585075/t-tournesol"}, "edited": false, "score": 0, "creation_date": 1458750509, "post_id": 36183403, "comment_id": 60002595, "body": "@T.Tournesol Suppose the address of snake_patterns[] is determined after compilation, what if you copy the executable file and launch them simultaneously, and what if that fixed address is occupied by another program? As a result, you have to re-compile your code every time you need them to be executed!"}, {"owner": {"reputation": 197, "user_id": 5585075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9030bcefdc0b9355e4fca09647ecc4fb?s=128&d=identicon&r=PG&f=1", "display_name": "T. Tournesol", "link": "https://stackoverflow.com/users/5585075/t-tournesol"}, "edited": false, "score": 0, "creation_date": 1458752015, "post_id": 36183403, "comment_id": 60003656, "body": "On the patform I develop for, it can&#39;t happen."}, {"owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "reply_to_user": {"reputation": 197, "user_id": 5585075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9030bcefdc0b9355e4fca09647ecc4fb?s=128&d=identicon&r=PG&f=1", "display_name": "T. Tournesol", "link": "https://stackoverflow.com/users/5585075/t-tournesol"}, "edited": false, "score": 0, "creation_date": 1458752164, "post_id": 36183403, "comment_id": 60003767, "body": "@T.Tournesol But C isn&#39;t designed for the platform you develop for only, so the C standard had to compromise."}, {"owner": {"reputation": 197, "user_id": 5585075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9030bcefdc0b9355e4fca09647ecc4fb?s=128&d=identicon&r=PG&f=1", "display_name": "T. Tournesol", "link": "https://stackoverflow.com/users/5585075/t-tournesol"}, "edited": false, "score": 0, "creation_date": 1458752299, "post_id": 36183403, "comment_id": 60003859, "body": "Of course ! But I thought const would prevent this kind of behaviour. For example, my symbol table shows that snake_patterns is located in ROM, so it won&#39;t likely be moved at runtime..."}], "tags": [], "owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "is_accepted": false, "score": 0, "last_activity_date": 1458750656, "last_edit_date": 1458750656, "creation_date": 1458749863, "answer_id": 36183403, "question_id": 36182463, "link": "https://stackoverflow.com/questions/36182463/declaration-of-an-array-of-constants/36183403#36183403", "title": "Declaration of an array of constants", "body": "<p>I'm afraid you there is no way you can do this.</p>\n\n<p>This is because the address of <code>snake_patterns[]</code> is determined at runtime, that is, <strong>after</strong> program startup. However, a variable with static storage duration must be initialised \"<strong>before</strong> program startup\" (quoted from N1570).</p>\n\n<p>Suppose the address of <code>snake_patterns[]</code> is determined after compilation, what if one copy the executable file and launch them simultaneously, and what if that fixed address is currently occupied by another program? The program won't run successfully in either case. As a result, you have to re-compile your code every time you need them to be executed if you want to know the address at compile time.</p>\n\n<p>Why not simply <code>malloc()</code> some memory to your <code>temp[]</code> at runtime?</p>\n"}, {"comments": [{"owner": {"reputation": 197, "user_id": 5585075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9030bcefdc0b9355e4fca09647ecc4fb?s=128&d=identicon&r=PG&f=1", "display_name": "T. Tournesol", "link": "https://stackoverflow.com/users/5585075/t-tournesol"}, "edited": false, "score": 0, "creation_date": 1458752362, "post_id": 36183888, "comment_id": 60003896, "body": "That&#39;s likely what I&#39;ll do. Thanks for the advice for the red flashing comment (how do you make a red flashing comment in C ? :) )"}], "tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 1, "last_activity_date": 1458751178, "creation_date": 1458751178, "answer_id": 36183888, "question_id": 36182463, "link": "https://stackoverflow.com/questions/36182463/declaration-of-an-array-of-constants/36183888#36183888", "title": "Declaration of an array of constants", "body": "<p>After reading the other answers and your comments, I would say that you cannot do it with a normal C build chain. Nate Eldredge's answer is clear about that.</p>\n\n<p>If you need to be able to store this in ROM, I would use the following trick:</p>\n\n<p>Declare your arrays that way:</p>\n\n<pre><code>const int my_array[] = {\n    // data...\n};\nconst char my_other_array[] = {\n    00, 2, 01, 1, 02, 0\n};\n</code></pre>\n\n<p>Fully build your executable, asking the compiler and linker to generate a full symbol map.</p>\n\n<p>Find the address of my_array in the map, and put it by hand into <code>my_other_array</code>.</p>\n\n<p>Build again the executable with a full map, and make sure that the address has not changed (it should not)</p>\n\n<p>And... note the trick in documentation <strong>and</strong> in code in red flashing font in case of future maintenance...</p>\n"}, {"comments": [{"owner": {"reputation": 197, "user_id": 5585075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9030bcefdc0b9355e4fca09647ecc4fb?s=128&d=identicon&r=PG&f=1", "display_name": "T. Tournesol", "link": "https://stackoverflow.com/users/5585075/t-tournesol"}, "edited": false, "score": 0, "creation_date": 1458861897, "post_id": 36191324, "comment_id": 60056451, "body": "It&#39;ll be definitely useful. Thanks !"}, {"owner": {"reputation": 973, "user_id": 1734032, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/69zJo.jpg?s=128&g=1", "display_name": "mckenzm", "link": "https://stackoverflow.com/users/1734032/mckenzm"}, "edited": false, "score": 0, "creation_date": 1507689243, "post_id": 36191324, "comment_id": 80305870, "body": "For AVR, it is certainly preferable for constants, and tables of contents.to be stored where hard coded values would be stored."}], "tags": [], "owner": {"reputation": 4696, "user_id": 238320, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/2f3aa1c23aa5ee5a5b031a15b1710eac?s=128&d=identicon&r=PG", "display_name": "David Cary", "link": "https://stackoverflow.com/users/238320/david-cary"}, "is_accepted": false, "score": 2, "last_activity_date": 1504101112, "last_edit_date": 1504101112, "creation_date": 1458780144, "answer_id": 36191324, "question_id": 36182463, "link": "https://stackoverflow.com/questions/36182463/declaration-of-an-array-of-constants/36191324#36191324", "title": "Declaration of an array of constants", "body": "<p>It sounds like you want one \"variable\" in ROM to store the address of some other variable.</p>\n\n<p>Many platforms have very little RAM, so putting as much data in (program memory) ROM rather than scarce RAM is a good idea.</p>\n\n<h2>portable approach using standard C</h2>\n\n<p>Perhaps using a \"function context\" as ensc suggested is close enough?</p>\n\n<pre><code>#include &lt;genesis.h&gt;\n#include \"snake.h\"\n#include &lt;string.h&gt;\n\nconst u32 snake_patterns[] = {\n    0x00024666,\n    // ... some 100ths of lines\n};\n\nint test_system( int a, unsigned char * dest[] ){\n    const u16 temp[] = {\n        1, 0x9370, 0x9400, // const, so stored in ROM\n        ((const u32) snake_patterns) &amp; 0xFF,\n        (((const u32) snake_patterns) &gt;&gt; 8) &amp; 0xFF,\n        (((const u32) snake_patterns) &gt;&gt; 16) &amp; 0xFF\n    };\n    // ... then do something with that array, perhaps\n    memcpy(dest, temp, 12);\n}\n\nint main(void){\n    unsigned char * buffer[80];\n    int mangled_address = (u32) snake_patterns;\n    test_system( mangled_address, buffer );\n    printf(\"result: %s\", buffer);\n}\n</code></pre>\n\n<h2>nonstandard extensions</h2>\n\n<p>Several C compilers have a few features that let you tell the compiler to put things in ROM rather than RAM.\nUnfortunately, those features have not yet been standardized in Standard C.\n(SDCC uses the word  \"<code>at</code>\". Some other compilers use the word \"<code>__at</code>\" or \"<code>_at_</code>\". Some other compilers use the symbol \"<code>@</code>\". GCC apparently(?) uses \"<code>__attribute__((section (\".theNameOfMyArraySection\")))</code>\" and also requires tweaking the linker script. You'll have to figure out which approach your particular compiler supports, and then change it if you ever switch compilers).</p>\n\n<pre><code>#include &lt;genesis.h&gt;\n#include \"snake.h\"\n\n#define snake_address 0x7F234\n\nconst u32 _at_ snake_address snake_patterns[] = {\n    0x00024666,\n    // ... some 100ths of lines\n};\n\nconst u16 temp[] = {\n    1, 0x9370, 0x9400,\n    ((const u32) snake_address) &amp; 0xFF,\n    (((const u32) snake_address) &gt;&gt; 8) &amp; 0xFF,\n    (((const u32) snake_address) &gt;&gt; 16) &amp; 0xFF\n};\n</code></pre>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/4067811/how-to-place-a-variable-at-a-given-absolute-address-in-memory-with-gcc\">How to place a variable at a given absolute address in memory (with GCC)</a></li>\n<li><a href=\"https://stackoverflow.com/questions/27494833/how-do-most-embedded-c-compilers-define-symbols-for-memory-mapped-io\">How do most embedded C compilers define symbols for memory mapped I/O?</a></li>\n<li><a href=\"http://mcuoneclipse.com/2012/11/01/defining-variables-at-absolute-addresses-with-gcc/\" rel=\"nofollow noreferrer\">\"Defining Variables at Absolute Addresses with gcc\"</a></li>\n<li><a href=\"http://books.google.com/books?id=se0HAAAAQBAJ\" rel=\"nofollow noreferrer\">\"Embedded System Design with C805\"</a> section 5.10.6 \"Absolute variable location\" compares 3 different compilers.</li>\n</ul>\n"}], "owner": {"reputation": 197, "user_id": 5585075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9030bcefdc0b9355e4fca09647ecc4fb?s=128&d=identicon&r=PG&f=1", "display_name": "T. Tournesol", "link": "https://stackoverflow.com/users/5585075/t-tournesol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6417, "favorite_count": 0, "accepted_answer_id": 36183088, "answer_count": 6, "score": 10, "last_activity_date": 1504101112, "creation_date": 1458747345, "last_edit_date": 1458748789, "question_id": 36182463, "link": "https://stackoverflow.com/questions/36182463/declaration-of-an-array-of-constants", "title": "Declaration of an array of constants", "body": "<p>I have that may be a problem of declaration :</p>\n\n<p>I declare an array of const int :</p>\n\n<pre><code>const int my_array[] = {\n    // data...\n}\n</code></pre>\n\n<p>Then I need to declare another array of bytes of the form :</p>\n\n<pre><code>00 aa 01 bb 02 cc\n</code></pre>\n\n<p>where aabbcc is the 24-bits address in memory of the const int (I precise I code for a very particular platform, this explains that), so I wrote :</p>\n\n<pre><code>const char my_other_array[] = {\n    00, (my_array &gt;&gt; 16) &amp; 0xFF, 01, (my_array &gt;&gt; 8) &amp; 0xFF, 02, my_array &amp; 0xFF\n}\n</code></pre>\n\n<p>but I get this error :</p>\n\n<pre><code>error: invalid operands to binary &gt;&gt;\nerror: initializer element is not constant\n</code></pre>\n\n<p>I thought about casting my_array :</p>\n\n<pre><code>const char my_other_array[] = {\n    00, (((const u32) my_array) &gt;&gt; 16) &amp; 0xFF, 01, (((const u32) my_array) &gt;&gt; 8) &amp; 0xFF, 02, ((const u32) my_array) &amp; 0xFF\n}\n</code></pre>\n\n<p>but then I get a warning + error :</p>\n\n<pre><code>warning: initializer element is not computable at load time\nerror: initializer element is not computable at load time\n</code></pre>\n\n<p>What am I doing wrong ?</p>\n\n<p>Here's the actual code, for those asking (I cut the irrelevant parts) :</p>\n\n<pre><code>#include &lt;genesis.h&gt;\n#include \"snake.h\"\n\nconst u32 snake_patterns[] = {\n    0x00024666,\n    // ... some 100ths of lines\n};\n\nconst u16 temp[] = {\n    1, 0x9370, 0x9400, ((const u32) snake_patterns) &amp; 0xFF, (((const u32) snake_patterns) &gt;&gt; 8) &amp; 0xFF, (((const u32) snake_patterns) &gt;&gt; 16) &amp; 0xFF\n};\n</code></pre>\n\n<p>You'll notice things are a little more complicated, but I think the previous basic example (fixed with the appropriate brackets) shows the problem in a clearer way. Some may recognize a list of DMA calls for the Genesis VDP.</p>\n"}, {"tags": ["c", "unix", "io"], "comments": [{"owner": {"reputation": 1480, "user_id": 3680119, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x7ea1.png?s=128&g=1", "display_name": "Cormac O&#39;Brien", "link": "https://stackoverflow.com/users/3680119/cormac-obrien"}, "edited": false, "score": 1, "creation_date": 1458746173, "post_id": 36181906, "comment_id": 59999266, "body": "SUSv4 does not specify that <code>read</code> and <code>write</code> must be unbuffered: <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/read.html\" rel=\"nofollow noreferrer\">read</a>, <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/write.html\" rel=\"nofollow noreferrer\">write</a>"}, {"owner": {"reputation": 7797, "user_id": 942746, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/34cf9eae5d595c0b480a7cb42f3722b1?s=128&d=identicon&r=PG", "display_name": "Brian McFarland", "link": "https://stackoverflow.com/users/942746/brian-mcfarland"}, "edited": false, "score": 1, "creation_date": 1458746182, "post_id": 36181906, "comment_id": 59999272, "body": "Where did you get the notion that <code>read()</code> and <code>write()</code> are unbuffered?"}, {"owner": {"reputation": 1480, "user_id": 3680119, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x7ea1.png?s=128&g=1", "display_name": "Cormac O&#39;Brien", "link": "https://stackoverflow.com/users/3680119/cormac-obrien"}, "edited": false, "score": 0, "creation_date": 1458746330, "post_id": 36181906, "comment_id": 59999411, "body": "Additionally, the <code>sync</code> call (<a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/sync.html\" rel=\"nofollow noreferrer\">sync</a>) exists for a reason."}, {"owner": {"reputation": 521, "user_id": 5737877, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/f08281b24fa35630459e7dd70c388b4c?s=128&d=identicon&r=PG&f=1", "display_name": "A.Cho", "link": "https://stackoverflow.com/users/5737877/a-cho"}, "edited": false, "score": 0, "creation_date": 1458746514, "post_id": 36181906, "comment_id": 59999587, "body": "The book <i>advanced programming in the unix environment</i> shows the title &#39;unbuffered i/o&#39;"}, {"owner": {"reputation": 1480, "user_id": 3680119, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x7ea1.png?s=128&g=1", "display_name": "Cormac O&#39;Brien", "link": "https://stackoverflow.com/users/3680119/cormac-obrien"}, "edited": false, "score": 0, "creation_date": 1458746929, "post_id": 36181906, "comment_id": 59999894, "body": "@A.Cho That only means that <code>read()</code> and <code>write()</code> are not <i>necessarily</i> buffered. At least in Linux they are buffered by default unless <code>O_DIRECT</code> is specified; I can&#39;t speak to BSD or other Unices."}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1458758768, "post_id": 36181906, "comment_id": 60007874, "body": "&quot;I heard unbuffered I/O means I/O happens on char-by-char to real device.&quot;, it depends on the device, you have two kinds of devices under Unix: char-oriented and -block-oriented. In general, disks are used through block-oriented drivers (even if there also exists a char-oriented access to)."}], "answers": [{"tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": true, "score": 3, "last_activity_date": 1458746176, "creation_date": 1458746176, "answer_id": 36181996, "question_id": 36181906, "link": "https://stackoverflow.com/questions/36181906/why-do-unbuffered-read-write-operations-use-buffer-cache/36181996#36181996", "title": "Why do unbuffered read()/write() operations use buffer cache?", "body": "<p>Basically the term \"buffering\" here means \"a place where data is stored when going to/from the kernel\", i.e. to avoid doing one system call for each I/O call, the buffered functions use a buffer between.</p>\n\n<p>What the kernel does with the data is not something the standard library can do much about.</p>\n\n<p>It would be possible to do a 1:1 mapping of read/write calls at the standard library's level (i.e. <code>fread()</code> and friends) to <code>read()</code>/<code>write()</code> calls on the underlying file descriptor; the term buffering is telling you that is <em>not</em> what you can expect.</p>\n"}, {"tags": [], "owner": {"reputation": 162, "user_id": 4062056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f1144287b85c426b30d94496a0cf6b2?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Ekzhanov", "link": "https://stackoverflow.com/users/4062056/alexander-ekzhanov"}, "is_accepted": false, "score": 1, "last_activity_date": 1458747010, "creation_date": 1458747010, "answer_id": 36182338, "question_id": 36181906, "link": "https://stackoverflow.com/questions/36181906/why-do-unbuffered-read-write-operations-use-buffer-cache/36182338#36182338", "title": "Why do unbuffered read()/write() operations use buffer cache?", "body": "<p>\"(Un)buffered\" in the manual refers to user-space buffering. Kernel space buffering depends on implementation, usually most devices are buffered (disk, sockets, USB etc.) except hardware ports (GPIO).</p>\n"}], "owner": {"reputation": 521, "user_id": 5737877, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/f08281b24fa35630459e7dd70c388b4c?s=128&d=identicon&r=PG&f=1", "display_name": "A.Cho", "link": "https://stackoverflow.com/users/5737877/a-cho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 632, "favorite_count": 1, "accepted_answer_id": 36181996, "answer_count": 2, "score": 3, "last_activity_date": 1458747010, "creation_date": 1458745934, "last_edit_date": 1458746282, "question_id": 36181906, "link": "https://stackoverflow.com/questions/36181906/why-do-unbuffered-read-write-operations-use-buffer-cache", "title": "Why do unbuffered read()/write() operations use buffer cache?", "body": "<p>Basically on UNIX, <code>read()</code> and <code>write()</code> functions are unbuffered I/O, </p>\n\n<p>and there are Standard I/O, which is buffered I/O.</p>\n\n<p>But, <code>read()</code> and <code>write()</code> functions use <em>buffer cache</em> which is in kernel before doing real I/O(I/O to real device), and real I/O happens using <em>buffer cache</em>. It's using buffer.</p>\n\n<p>I heard unbuffered I/O means I/O happens on char-by-char to real device.</p>\n\n<p>Then, why <code>read()</code> and <code>write()</code> functions are unbuffered I/O, even though it is using <em>buffer cache</em>?</p>\n"}, {"tags": ["c", "matrix", "sizeof"], "comments": [{"owner": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "edited": false, "score": 0, "creation_date": 1458744994, "post_id": 36181505, "comment_id": 59998338, "body": "<code>n * m</code> is your size."}, {"owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "edited": false, "score": 0, "creation_date": 1458746010, "post_id": 36181505, "comment_id": 59999128, "body": "Also, don&#39;t cast the value returned by <code>malloc()</code>. See: <a href=\"http://stackoverflow.com/q/605845/5399734\">stackoverflow.com/q/605845/5399734</a>"}, {"owner": {"reputation": 1588, "user_id": 6082851, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b14f3cd864bc266a401eca07b4153602?s=128&d=identicon&r=PG", "display_name": "12431234123412341234123", "link": "https://stackoverflow.com/users/6082851/12431234123412341234123"}, "edited": false, "score": 0, "creation_date": 1458746446, "post_id": 36181505, "comment_id": 59999519, "body": "dont use int for a size, use allways size_t or ptrdiff_t"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 4672916, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ce18da49207e1c46c9bf6a981801a8fe?s=128&d=identicon&r=PG&f=1", "display_name": "Xavier Tapia Gonzalez", "link": "https://stackoverflow.com/users/4672916/xavier-tapia-gonzalez"}, "edited": false, "score": 0, "creation_date": 1458745003, "post_id": 36181536, "comment_id": 59998352, "body": "Ok, that makes sense, so which function do I have to use?"}, {"owner": {"reputation": 27359, "user_id": 1141471, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/t1JZE.png?s=128&g=1", "display_name": "4pie0", "link": "https://stackoverflow.com/users/1141471/4pie0"}, "reply_to_user": {"reputation": 45, "user_id": 4672916, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ce18da49207e1c46c9bf6a981801a8fe?s=128&d=identicon&r=PG&f=1", "display_name": "Xavier Tapia Gonzalez", "link": "https://stackoverflow.com/users/4672916/xavier-tapia-gonzalez"}, "edited": false, "score": 0, "creation_date": 1458745069, "post_id": 36181536, "comment_id": 59998392, "body": "@XavierTapiaGonzalez Which function to use to do what exactly? If you need to allocate memory dynamically and you will need it&#39;s size later you must store size of array somewhere. Later you must use these stored values, here m and n."}, {"owner": {"reputation": 45, "user_id": 4672916, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ce18da49207e1c46c9bf6a981801a8fe?s=128&d=identicon&r=PG&f=1", "display_name": "Xavier Tapia Gonzalez", "link": "https://stackoverflow.com/users/4672916/xavier-tapia-gonzalez"}, "edited": false, "score": 0, "creation_date": 1458745277, "post_id": 36181536, "comment_id": 59998549, "body": "Ok, so is impossible to get the information of the size of a matrix only from the matrix?"}, {"owner": {"reputation": 27359, "user_id": 1141471, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/t1JZE.png?s=128&g=1", "display_name": "4pie0", "link": "https://stackoverflow.com/users/1141471/4pie0"}, "reply_to_user": {"reputation": 45, "user_id": 4672916, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ce18da49207e1c46c9bf6a981801a8fe?s=128&d=identicon&r=PG&f=1", "display_name": "Xavier Tapia Gonzalez", "link": "https://stackoverflow.com/users/4672916/xavier-tapia-gonzalez"}, "edited": false, "score": 1, "creation_date": 1458745906, "post_id": 36181536, "comment_id": 59999037, "body": "You are welcome. (A good place to store array dimensions may be introduced array wrapper struct M { double **data; size_t m, n; })"}, {"owner": {"reputation": 45, "user_id": 4672916, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ce18da49207e1c46c9bf6a981801a8fe?s=128&d=identicon&r=PG&f=1", "display_name": "Xavier Tapia Gonzalez", "link": "https://stackoverflow.com/users/4672916/xavier-tapia-gonzalez"}, "edited": false, "score": 0, "creation_date": 1458748630, "post_id": 36181536, "comment_id": 60001205, "body": "Ok, and you also could send a struct as a variable of a function? In my case for multiplicate matrices &quot;double ** matrix_mult(struct M, struct N)&quot; ?"}, {"owner": {"reputation": 27359, "user_id": 1141471, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/t1JZE.png?s=128&g=1", "display_name": "4pie0", "link": "https://stackoverflow.com/users/1141471/4pie0"}, "reply_to_user": {"reputation": 45, "user_id": 4672916, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ce18da49207e1c46c9bf6a981801a8fe?s=128&d=identicon&r=PG&f=1", "display_name": "Xavier Tapia Gonzalez", "link": "https://stackoverflow.com/users/4672916/xavier-tapia-gonzalez"}, "edited": false, "score": 0, "creation_date": 1458749354, "post_id": 36181536, "comment_id": 60001773, "body": "@XavierTapiaGonzalez Yes. In this function you would check that number of columns in M is the same as number of rows in N (only number of columns in first matrix must equal number of rows in second) M.n == N.m and perform multiplication on M.data and N.data."}], "tags": [], "owner": {"reputation": 27359, "user_id": 1141471, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/t1JZE.png?s=128&g=1", "display_name": "4pie0", "link": "https://stackoverflow.com/users/1141471/4pie0"}, "is_accepted": true, "score": 4, "last_activity_date": 1458744868, "creation_date": 1458744868, "answer_id": 36181536, "question_id": 36181505, "link": "https://stackoverflow.com/questions/36181505/size-of-a-matrix-declared-dynamically-on-c/36181536#36181536", "title": "Size of a Matrix declared dynamically on C", "body": "<p>You cannot use sizeof operator on dynamically created array to get array size. If array is created dynamically the only option to know it's size is to store it somewhere.</p>\n"}, {"tags": [], "owner": {"reputation": 3983, "user_id": 620029, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c3c977d6b546bc538aa47413431dba0c?s=128&d=identicon&r=PG", "display_name": "Vladp", "link": "https://stackoverflow.com/users/620029/vladp"}, "is_accepted": false, "score": 3, "last_activity_date": 1458745799, "creation_date": 1458745799, "answer_id": 36181863, "question_id": 36181505, "link": "https://stackoverflow.com/questions/36181505/size-of-a-matrix-declared-dynamically-on-c/36181863#36181863", "title": "Size of a Matrix declared dynamically on C", "body": "<p>Using <code>sizeof(M[0])</code> only gets you the <strong>type</strong> size of <code>M[0]</code> which is <code>double *</code> which in your case identical to size of <code>double</code></p>\n\n<p>So in your case you have to save the size of the allocated array (n, m).</p>\n\n<p>Another solution would be to use stack allocation where <code>sizeof</code> can actually get the size of types like <code>double[]</code></p>\n"}], "owner": {"reputation": 45, "user_id": 4672916, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ce18da49207e1c46c9bf6a981801a8fe?s=128&d=identicon&r=PG&f=1", "display_name": "Xavier Tapia Gonzalez", "link": "https://stackoverflow.com/users/4672916/xavier-tapia-gonzalez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 36181536, "answer_count": 2, "score": 0, "last_activity_date": 1458745799, "creation_date": 1458744776, "question_id": 36181505, "link": "https://stackoverflow.com/questions/36181505/size-of-a-matrix-declared-dynamically-on-c", "title": "Size of a Matrix declared dynamically on C", "body": "<p>I've declared a matrix dynamically as follows </p>\n\n<pre><code>double **y;\ny = (double **)malloc(n*sizeof(double *));\nfor(i=0;i&lt;n;i++)\n  y[i]=(double*)malloc(m*sizeof(double));\n</code></pre>\n\n<p>Where m and n are integers declared before.\nThen, I need to compute a function that multiplies two different matrix, and I need to check if the number of rows on the first matrix coincides with the number of columns on the second matrix. So I need to know the numbers of columns and rows.\nSo I computed what follows:</p>\n\n<pre><code>int k=sizeof(M[0])/sizeof(double);\n</code></pre>\n\n<p>But this integer k returns me 1. And no matther how long n and m are...</p>\n\n<p>What am I doing wrong?</p>\n\n<p>Thanks and sorry for my english.</p>\n"}, {"tags": ["c++", "c", "linux", "multithreading", "ace"], "comments": [{"owner": {"reputation": 14053, "user_id": 2189130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/trlri.png?s=128&g=1", "display_name": "kmdreko", "link": "https://stackoverflow.com/users/2189130/kmdreko"}, "edited": false, "score": 0, "creation_date": 1458745380, "post_id": 36181225, "comment_id": 59998619, "body": "You mention multi-threading and async, is it possible that the returned values are being processed out of order? I&#39;d like to see the context in which this function is called and the result calculated."}, {"owner": {"reputation": 6681, "user_id": 6024122, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-uiRWa4coXLs/AAAAAAAAAAI/AAAAAAAAJUs/5BxfhSS1bUY/photo.jpg?sz=128", "display_name": "Patrick Trentin", "link": "https://stackoverflow.com/users/6024122/patrick-trentin"}, "edited": false, "score": 0, "creation_date": 1458745465, "post_id": 36181225, "comment_id": 59998684, "body": "Your output is not very useful without a glimpse of the code in which you compute and print out those values."}, {"owner": {"reputation": 2432, "user_id": 793716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06452b91c9651f991d26d28ba873e760?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/793716/rob"}, "edited": false, "score": 1, "creation_date": 1458745725, "post_id": 36181225, "comment_id": 59998886, "body": "I notice you are not applying the same math to compute the user and system time (missing *100000) in the system time computation.."}, {"owner": {"reputation": 2212, "user_id": 4466962, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7f8abee5eacda9f2a4c06b17f10c9610?s=128&d=identicon&r=PG&f=1", "display_name": "Dinari", "link": "https://stackoverflow.com/users/4466962/dinari"}, "edited": false, "score": 1, "creation_date": 1458745893, "post_id": 36181225, "comment_id": 59999026, "body": "I will add the rest, wanted to keep it a bit shorter. about the *1000000 , r_utime is in seconds, and r_stime is in microseconds, as i am returning the value in micro, i only need to multiply the seconds"}, {"owner": {"reputation": 6681, "user_id": 6024122, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-uiRWa4coXLs/AAAAAAAAAAI/AAAAAAAAJUs/5BxfhSS1bUY/photo.jpg?sz=128", "display_name": "Patrick Trentin", "link": "https://stackoverflow.com/users/6024122/patrick-trentin"}, "edited": false, "score": 0, "creation_date": 1458746853, "post_id": 36181225, "comment_id": 59999829, "body": "it doesn&#39;t look like you are invoking <code>m_cpuTime.calculateCpuTime()</code> each time, some times you don&#39;t pass through the singleton that should guarantee mutual exclusion, why is it?"}, {"owner": {"reputation": 6681, "user_id": 6024122, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-uiRWa4coXLs/AAAAAAAAAAI/AAAAAAAAJUs/5BxfhSS1bUY/photo.jpg?sz=128", "display_name": "Patrick Trentin", "link": "https://stackoverflow.com/users/6024122/patrick-trentin"}, "edited": false, "score": 1, "creation_date": 1458747276, "post_id": 36181225, "comment_id": 60000152, "body": "Moreover, collecting 4 different values while at the same time acquiring/releasing a lock might be a source of issues, any thread could kick in and delay the execution of your current thread. This might or might not be a problem for you, I didn&#39;t really go very deep in what you&#39;re doing with the values, once you collected them :-P"}, {"owner": {"reputation": 2212, "user_id": 4466962, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7f8abee5eacda9f2a4c06b17f10c9610?s=128&d=identicon&r=PG&f=1", "display_name": "Dinari", "link": "https://stackoverflow.com/users/4466962/dinari"}, "edited": false, "score": 0, "creation_date": 1458747884, "post_id": 36181225, "comment_id": 60000632, "body": "i am calling it, it just removed some of the code to make it more readable, it passes thru 2 objects in the way there, i am invoking the singleton every time.  the values are just for debugging this exact problem, i was only working with thread delta, when i have noticed the error. Thank you tho :)"}, {"owner": {"reputation": 6681, "user_id": 6024122, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-uiRWa4coXLs/AAAAAAAAAAI/AAAAAAAAJUs/5BxfhSS1bUY/photo.jpg?sz=128", "display_name": "Patrick Trentin", "link": "https://stackoverflow.com/users/6024122/patrick-trentin"}, "edited": false, "score": 1, "creation_date": 1458748012, "post_id": 36181225, "comment_id": 60000726, "body": "It&#39;s a bit hard to help you if you&#39;re not showing us the real code, lol."}, {"owner": {"reputation": 2212, "user_id": 4466962, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7f8abee5eacda9f2a4c06b17f10c9610?s=128&d=identicon&r=PG&f=1", "display_name": "Dinari", "link": "https://stackoverflow.com/users/4466962/dinari"}, "edited": false, "score": 0, "creation_date": 1458748481, "post_id": 36181225, "comment_id": 60001089, "body": "You are right, i added some more of the calling bits, i cant put the whole thing, it would make the post unreadble and too long. The only thing i left out is the Lock, it is sychronized , the whole thing."}, {"owner": {"reputation": 2432, "user_id": 793716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06452b91c9651f991d26d28ba873e760?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/793716/rob"}, "edited": false, "score": 1, "creation_date": 1458751870, "post_id": 36181225, "comment_id": 60003546, "body": "What type is your map m_threadsCpuMap object. I see you get a reference to the value in it and assume it is the actual value in the map, so when it gets updated you do not need to re-set the value in the map.. is this a valid assumption? it could be returning a copy to you and you are referencing/updating the copy not the original? Or is it a simple array :)?"}, {"owner": {"reputation": 2212, "user_id": 4466962, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7f8abee5eacda9f2a4c06b17f10c9610?s=128&d=identicon&r=PG&f=1", "display_name": "Dinari", "link": "https://stackoverflow.com/users/4466962/dinari"}, "edited": false, "score": 0, "creation_date": 1458752466, "post_id": 36181225, "comment_id": 60003980, "body": "its is a std::map&lt;pid_t, u64&gt; I am doing it for the exact reason you mentioned, so after updating i dont need to re-set the value of the map."}, {"owner": {"reputation": 2432, "user_id": 793716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06452b91c9651f991d26d28ba873e760?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/793716/rob"}, "edited": false, "score": 1, "creation_date": 1458754234, "post_id": 36181225, "comment_id": 60005135, "body": "If the key is not good (does not exist in the map) then the operator [] will create that element (with garbage value) and return that to you, this may be what you are seeing.. is it possible the pid id key is no good or you are not initializing the map properly?"}, {"owner": {"reputation": 2212, "user_id": 4466962, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7f8abee5eacda9f2a4c06b17f10c9610?s=128&d=identicon&r=PG&f=1", "display_name": "Dinari", "link": "https://stackoverflow.com/users/4466962/dinari"}, "edited": false, "score": 0, "creation_date": 1458767844, "post_id": 36181225, "comment_id": 60012987, "body": "I belive it creates a value with deafult ctr, 0 for u64, however i did try anouther version, where i was checking if the key exists, if not init it with 0. That was not it :( i am lost here"}, {"owner": {"reputation": 22422, "user_id": 634919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4a87fe094961af20263d8e7ff445b2?s=128&d=identicon&r=PG", "display_name": "Nate Eldredge", "link": "https://stackoverflow.com/users/634919/nate-eldredge"}, "edited": false, "score": 0, "creation_date": 1459196086, "post_id": 36181225, "comment_id": 60167769, "body": "Are you able to reproduce the issue in a much simpler program, one that would be short enough to post in its entirety?"}, {"owner": {"reputation": 2212, "user_id": 4466962, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7f8abee5eacda9f2a4c06b17f10c9610?s=128&d=identicon&r=PG&f=1", "display_name": "Dinari", "link": "https://stackoverflow.com/users/4466962/dinari"}, "edited": false, "score": 0, "creation_date": 1459233630, "post_id": 36181225, "comment_id": 60180749, "body": "Yes, i have simplified it and reproduced it, adding this to the main post."}, {"owner": {"reputation": 16376, "user_id": 2009616, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/oiCJA.jpg?s=128&g=1", "display_name": "isedev", "link": "https://stackoverflow.com/users/2009616/isedev"}, "edited": false, "score": 0, "creation_date": 1459240786, "post_id": 36181225, "comment_id": 60184964, "body": "Are you running ACE on Windows or some Unix-ish OS? If under Windows, I&#39;ll take a guess that you are interpreting ru_utime and ru_stime incorrectly (on Windows, FILETIME is a 64-bit value of 100-nanosecond intervals)."}, {"owner": {"reputation": 2212, "user_id": 4466962, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7f8abee5eacda9f2a4c06b17f10c9610?s=128&d=identicon&r=PG&f=1", "display_name": "Dinari", "link": "https://stackoverflow.com/users/4466962/dinari"}, "edited": false, "score": 0, "creation_date": 1459240968, "post_id": 36181225, "comment_id": 60185076, "body": "Unix-ish, to be exact : Linux A02T444 3.0.56-k2 #1 SMP Tue Jan 1 16:05:59 IST 2013 x86_64 GNU/Linux"}, {"owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 0, "creation_date": 1459241734, "post_id": 36181225, "comment_id": 60185579, "body": "Please provide a minimal but complete example. Without that, the cause could be anywhere in the code you don&#39;t show. Also your question is off-topic without it."}, {"owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "edited": false, "score": 0, "creation_date": 1459241782, "post_id": 36181225, "comment_id": 60185606, "body": "Interestingly, 18446744073709430616d = 1999999999996A55h. You must have a conversion problem."}, {"owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 0, "creation_date": 1459241831, "post_id": 36181225, "comment_id": 60185631, "body": "Ah, I just saw your minimal example which (surprise?) didn&#39;t show these effects. That&#39;s exactly the reason why you&#39;re supposed to extract this before even asking..."}, {"owner": {"reputation": 265, "user_id": 2845280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e01e13f0c2bee16e73c7290e15d7abc?s=128&d=identicon&r=PG&f=1", "display_name": "Maksim", "link": "https://stackoverflow.com/users/2845280/maksim"}, "edited": false, "score": 0, "creation_date": 1459241882, "post_id": 36181225, "comment_id": 60185664, "body": "looks like uint 64 overflow"}, {"owner": {"reputation": 2212, "user_id": 4466962, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7f8abee5eacda9f2a4c06b17f10c9610?s=128&d=identicon&r=PG&f=1", "display_name": "Dinari", "link": "https://stackoverflow.com/users/4466962/dinari"}, "edited": false, "score": 0, "creation_date": 1459242016, "post_id": 36181225, "comment_id": 60185751, "body": "The over flow is the symptom, after the getrusage returns lower CPU usage values for the later call. which cause the newValue to be smaller then oldValue, and the overflow in the delta."}, {"owner": {"reputation": 2212, "user_id": 4466962, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7f8abee5eacda9f2a4c06b17f10c9610?s=128&d=identicon&r=PG&f=1", "display_name": "Dinari", "link": "https://stackoverflow.com/users/4466962/dinari"}, "edited": false, "score": 0, "creation_date": 1459250778, "post_id": 36181225, "comment_id": 60191704, "body": "I cant do that, sadly, aside from the fact it is gigantic, it is related to a feature i am developing for a product i do not own."}], "answers": [{"comments": [{"owner": {"reputation": 2212, "user_id": 4466962, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7f8abee5eacda9f2a4c06b17f10c9610?s=128&d=identicon&r=PG&f=1", "display_name": "Dinari", "link": "https://stackoverflow.com/users/4466962/dinari"}, "edited": false, "score": 0, "creation_date": 1459283381, "post_id": 36288821, "comment_id": 60214136, "body": "Thank you, cant believe i actually missed that, its always the simplest mistakes."}], "tags": [], "owner": {"reputation": 4505, "user_id": 1168733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5ewxJ.jpg?s=128&g=1", "display_name": "Sigi", "link": "https://stackoverflow.com/users/1168733/sigi"}, "is_accepted": true, "score": 4, "last_activity_date": 1459265821, "creation_date": 1459265821, "answer_id": 36288821, "question_id": 36181225, "link": "https://stackoverflow.com/questions/36181225/impossible-cpu-time-for-process-thread-with-rusage/36288821#36288821", "title": "Impossible Cpu time for process / thread with rusage", "body": "<p>Check carefully these lines: you are multiplying the system time seconds by 100 thousand instead of 1 million:</p>\n\n<pre><code>u64 userUSeconds = (static_cast&lt;u64&gt;(l_rusage.ru_utime.tv_sec)*1000000)+\n  (static_cast&lt;u64&gt;(l_rusage.ru_utime.tv_usec));\n\nu64 systemUSeconds = (static_cast&lt;u64&gt;(l_rusage.ru_stime.tv_sec)*100000)+\n  (static_cast&lt;u64&gt;(l_rusage.ru_stime.tv_usec));\n</code></pre>\n\n<p>They are there in two of three examples you have shown (not in the first one).</p>\n\n<p>However this would explain the odd sequence: </p>\n\n<blockquote>\n  <p>2016/03/29 08:07:05.201 - #2 - 24011/24011 -\n  CpuTime::getProcessDeltaCpuTime: oldValue = 14800749 m_processCpu =\n  14801749 m_process Cpu - oldValue = 1000</p>\n  \n  <p>2016/03/29 08:07:05.202 - #2 - 24011/24011 -\n  CpuTime::getProcessDeltaCpuTime: oldValue = 14801749 m_processCpu =\n  14802749 m_process Cpu - oldValue = 1000</p>\n  \n  <p>2016/03/29 08:07:05.203 - #2 - 24011/24011 -\n  CpuTime::getProcessDeltaCpuTime: oldValue = 14802749 m_processCpu =\n  13903748 m_process Cpu - oldValue = 18446744073708652615</p>\n  \n  <p>2016/03/29 08:07:05.204 - #2 - 24011/24011 -\n  CpuTime::getProcessDeltaCpuTime: oldValue = 13903748 m_processCpu =\n  13904748 m_process Cpu - oldValue = 1000</p>\n</blockquote>\n\n<p>at every iteration it adds 1000 us. But I guess that as soon as the system time surpass one second, only 1/10 of second is added, resulting in -0.9 seconds shift that is exactly 14.8 -> 13.9 seconds.</p>\n\n<p>in fact:</p>\n\n<pre><code> 18446744073708652615 - 2^64 + 1 = -899000\n</code></pre>\n\n<p>that is -900000 (0.9 seconds) + 1000 us</p>\n"}], "owner": {"reputation": 2212, "user_id": 4466962, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7f8abee5eacda9f2a4c06b17f10c9610?s=128&d=identicon&r=PG&f=1", "display_name": "Dinari", "link": "https://stackoverflow.com/users/4466962/dinari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 469, "favorite_count": 3, "accepted_answer_id": 36288821, "answer_count": 1, "score": 6, "last_activity_date": 1459265821, "creation_date": 1458744074, "last_edit_date": 1459261978, "question_id": 36181225, "link": "https://stackoverflow.com/questions/36181225/impossible-cpu-time-for-process-thread-with-rusage", "title": "Impossible Cpu time for process / thread with rusage", "body": "<p>I am calculating the delta between the cpu time a process / thread is using, between the calling of a certain function.</p>\n\n<p>I am getting impossible value for the process cpu time, some time's the next call is returning smaller cpu time, which is impossible.</p>\n\n<p>this is the code i am using to calculate the cpu time:</p>\n\n<pre><code>  u64 CpuTime::calculateCpuTime(bool a_thread)\n  {\n    struct rusage l_rusage;\n    int retVal;\n    if(a_thread)\n    {\n      retVal = getrusage(1, &amp;l_rusage); //1 = RUSAGE_THREAD\n    }\n    else\n    {\n      retVal = getrusage(0, &amp;l_rusage); //0 = RUSAGE_SELF\n    }\n    ASSERT(retVal==0);\n\n    u64 userUSeconds = (static_cast&lt;u64&gt;(l_rusage.ru_utime.tv_sec)*1000000)+\n      (static_cast&lt;u64&gt;(l_rusage.ru_utime.tv_usec));\n\n    u64 systemUSeconds = (static_cast&lt;u64&gt;(l_rusage.ru_stime.tv_sec)*1000000)+\n      (static_cast&lt;u64&gt;(l_rusage.ru_stime.tv_usec));\n\n    if(a_thread)\n    {\n      return userUSeconds + systemUSeconds;\n    }\n    return (userUSeconds + systemUSeconds) / ACE_OS::num_processors_online();\n  }\n</code></pre>\n\n<p>Also the function calculating retrieving this is async, no more then 1 thread can access it at a time.</p>\n\n<p>this is an example of the impossible output (process):</p>\n\n<blockquote>\n  <p>2016/03/23 13:39:05.187 - #2 - 15471/15055 -\n  ThreadDeltaCpuTime = 6000  ThreadCpuTime = 46756013 ProcessCpuTime = <strong>39820759</strong>  deltaProcessCpuTime= 250</p>\n  \n  <p>2016/03/23 13:39:05.386 - #2 - 15470/15055 -\n  ThreadDeltaCpuTime = 5000  ThreadCpuTime = 46663013 ProcessCpuTime = <strong>39699759</strong>  deltaProcessCpuTime = <strong>18446744073709430616</strong></p>\n</blockquote>\n\n<p>The delta calculation is a simple newValue - oldValue, with a unsigned int, it leads to those numbers.</p>\n\n<p>Example for a thread impossible output:</p>\n\n<blockquote>\n  <p>2016/03/23 13:38:59.183 - #2 - <strong>15472</strong>/15055 - ThreadDeltaCpuTime =\n  6000 ThreadCpuTime = <strong>47541012</strong> ProcessCpuTime = 39658134\n  deltaProcessCpuTime = 5250</p>\n  \n  <p>2016/03/23 13:38:59.382 - #2 - <strong>15472</strong>/15055 - ThreadDeltaCpuTime =\n  1844\n  <strong>6744073708557617</strong> ThreadCpuTime = <strong>46547013</strong> ProcessCpuTime = 39663009 deltaProcessCpuTime = 4625</p>\n</blockquote>\n\n<p>i have bolded the thread id, also you can see the function has been executed 200ms after the first 1.</p>\n\n<p>I am looking for a clue for why this is happening, i have tried using the ACE_OS rusage as well, with same results (make sense), i could solve this by ignoring \"bad\" values, but i am wondering why this is happening.</p>\n\n<p>EDIT:</p>\n\n<p>This is where i do the actual printing:</p>\n\n<pre><code>  u64 computeCpuTime()\n  {\n    u64 deltaCpuTime= CpuTime::getThreadDeltaCpuTime();\n    u64 CpuTime= getThreadCpuTime();\n    u64 ProcessCpuTime= getProcessCpuTime();\n    u64 deltaProcessCpuTime= CpuTime::getProcessDeltaCpuTime();\n    Log&lt;&lt;value(deltaCpuTime)&lt;&lt;value(CpuTime)&lt;&lt;value(ProcessCpuTime)&lt;&lt;value(deltaProcessCpuTime)&lt;&lt;endlog;\n    return deltaCpuTime;\n  }\n</code></pre>\n\n<p>And the rest of the functions used in this calculation:</p>\n\n<pre><code>  u64 CpuTime::getThreadDeltaCpuTime()\n  {\n    pid_t thisThread = (pid_t) syscall (SYS_gettid);\n    u64&amp; val = m_threadsCpuMap[thisThread];\n    u64 oldValue =val;\n    val = calculateCpuTime(true);\n    return val - oldValue;\n  }\n\n  u64 CpuTime::getProcessDeltaCpuTime()\n  {\n    u64 oldValue = m_processCpu;\n    m_processCpu = calculateCpuTime(false);\n\n    return m_processCpu - oldValue;\n  }\n\n  u64 getThreadCpuTime()\n  {\n    return CpuTime::calculateCpuTime(true);\n  }\n\n  u64 getProcessCpuTime()\n  {\n    return CpuTime::calculateCpuTime(false);\n  }\n</code></pre>\n\n<p>The object doing the system call (\"m_cpuTime\") is a singleton, protected with a mutex, only 1 thread can access it at a time.</p>\n\n<p>it holds the map of the threads cpu usage, m_threadsCpuMap (used for the delta), and also the last process cpu usage, m_processCpu.</p>\n\n<p>ANOTHER EDIT:</p>\n\n<p>I have simplified it with a simple test, working with a single thread, removed the division by active cpu's, and am only checking the Process Cpu time, still with impossible results.</p>\n\n<p>Here is the updated functions:</p>\n\n<p>Test:</p>\n\n<pre><code>for(int i = 0; i &lt; 100000 ; i++)\n{\n  for(int k = 0; k &lt; 1000000; k++)\n    m = k % i;\n    cpuTime = CpuTime::instance()-&gt;getProcessDeltaCpuTime();\n}\n</code></pre>\n\n<p>Functions used in test:</p>\n\n<pre><code>  u64 CpuTime::getProcessDeltaCpuTime()\n  {\n    u64 oldValue = m_processCpu;\n    m_processCpu = calculateCpuTime(eThisProcess);\n   Log&lt;&lt;value(oldValue)&lt;&lt;value(m_processCpu)&lt;value( m_processCpu - oldValue)&lt;&lt;endlog;\n    return m_processCpu - oldValue;\n  }\n\n  u64 CpuTime::calculateCpuTime(int a_type)\n  {\n    struct rusage l_rusage;\n    int retVal;\n    if(a_type == eThisThread)\n    {\n      retVal = /*ACE_OS::*/getrusage(1, &amp;l_rusage);\n    }\n    else\n    {\n      retVal = /*ACE_OS::*/getrusage(0, &amp;l_rusage);\n    }\n\n    u64 userUSeconds = (static_cast&lt;u64&gt;(l_rusage.ru_utime.tv_sec)*1000000)+\n      (static_cast&lt;u64&gt;(l_rusage.ru_utime.tv_usec));\n\n    u64 systemUSeconds = (static_cast&lt;u64&gt;(l_rusage.ru_stime.tv_sec)*100000)+\n      (static_cast&lt;u64&gt;(l_rusage.ru_stime.tv_usec));\n\n    if(a_type == eThisThread)\n    {\n      return userUSeconds + systemUSeconds;\n    }\n    return (userUSeconds + systemUSeconds)/* / ACE_OS::num_processors_online()*/;\n</code></pre>\n\n<p>This is an example of the logs, i have removed all the times the delta was ~0</p>\n\n<blockquote>\n  <p>2016/03/29 08:07:05.198 - #2 - 24011/24011 -\n  CpuTime::getProcessDeltaCpuTime:  oldValue = 14797750 m_processCpu =\n  14798749 m_process Cpu - oldValue = 999 </p>\n  \n  <p>2016/03/29 08:07:05.199 - #2 -\n  24011/24011 - CpuTime::getProcessDeltaCpuTime:  oldValue = 14798749\n  m_processCpu = 14799749 m_process Cpu - oldValue = 1000 </p>\n  \n  <p>2016/03/29\n  08:07:05.200 - #2 - 24011/24011 - CpuTime::getProcessDeltaCpuTime: \n  oldValue = 14799749 m_processCpu = 14800749 m_process Cpu - oldValue =\n  1000</p>\n  \n  <p>2016/03/29 08:07:05.201 - #2 - 24011/24011 -\n  CpuTime::getProcessDeltaCpuTime:  oldValue = 14800749 m_processCpu =\n  14801749 m_process Cpu - oldValue = 1000 </p>\n  \n  <p>2016/03/29 08:07:05.202 - #2\n  - 24011/24011 - CpuTime::getProcessDeltaCpuTime:  oldValue = 14801749 m_processCpu = 14802749 m_process Cpu - oldValue = 1000 </p>\n  \n  <p><strong>2016/03/29 08:07:05.203 - #2 - 24011/24011 - CpuTime::getProcessDeltaCpuTime: \n  oldValue = 14802749 m_processCpu = 13903748 m_process Cpu - oldValue =\n  18446744073708652615</strong> </p>\n  \n  <p>2016/03/29 08:07:05.204 - #2 - 24011/24011 -\n  CpuTime::getProcessDeltaCpuTime:  oldValue = 13903748 m_processCpu =\n  13904748 m_process Cpu - oldValue = 1000 </p>\n  \n  <p>2016/03/29 08:07:05.205 - #2\n  - 24011/24011 - CpuTime::getProcessDeltaCpuTime:  oldValue = 13904748 m_processCpu = 13905748 m_process Cpu - oldValue = 1000</p>\n</blockquote>\n\n<p>This time there was only <strong>1</strong> time of bad values, out of 100000 iterations.\nAnd after it all the following calculation were also smaller, e.g. it went like this:\n1 2 3 4 5 6 7 8 9 10 <strong>bad value, 6</strong> 7 8 9 10...\nAs if the process lost count, went back, and then continued normally.</p>\n\n<p>YET ANOUTHER EDIT:</p>\n\n<p>I have separated the code, completely, compiled it as simple as possible. and the problem did not occur, it could be a matter of probability (it was 1/100000 before).\nthis is the code:</p>\n\n<pre><code>int main()\n{\n  long int n = 0;\n  long int oldValue = 0;\n  long int newValue = 0;\n  unsigned long int deltaValue = 0;\n\n  for(int i = 0; i &lt; 1000000; i++)\n  {\n    for(long int m = 0; m &lt;10000; m++)\n      n = m + i;\n    struct rusage l_rusage;\n    int retVal;\n    retVal = getrusage(0, &amp;l_rusage);\n    if(retVal != 0) return 0;\n\n    long int userUSeconds = l_rusage.ru_utime.tv_sec*1000000 + l_rusage.ru_utime.tv_usec;\n\n    long int systemUSeconds = l_rusage.ru_stime.tv_sec*100000 + l_rusage.ru_stime.tv_usec;\n    oldValue = newValue;\n    newValue = userUSeconds + systemUSeconds;\n    deltaValue = newValue - oldValue;\n    if(deltaValue != 0)\n      std::cout&lt;&lt;\"Old value: \"&lt;&lt; oldValue &lt;&lt;\" New Value: \"&lt;&lt; newValue &lt;&lt;\" Delta value: \"&lt;&lt;deltaValue&lt;&lt;\"\\n\";\n\n\n  }\n  std::cout&lt;&lt;n;\n  return 0;\n}\n</code></pre>\n\n<p>And from further investigating the earlier test, (which use our unittest framework), the problem occurs always at around the same CPU time.\nWhich mean this is happening for a reason, i just cant figure out what happens at that exact time which could cause some thing like this.\nOr how some thing like this could be caused.</p>\n\n<p>I am not familiar enough with linux kernel to understand how this calculation is made.</p>\n\n<p>Another insight - when using clock() to get the process. it does not happen, even more - it seems like until that moment the values were around the same, after this point they are not:</p>\n\n<blockquote>\n  <p>2016/03/29 12:36:19.158 - #2 - 20544/20544 -\n  CpuTime::getProcessDeltaCpuTime:  oldValue = 14598780\n  m_processCpu = 14598780 m_processCpu - oldValue = 0 oldClockTime =\n  14580000 m_clockTime = 14580000 m_clockTime - oldClockTime = 0</p>\n  \n  <p>2016/03/29 12:36:19.158 - #2 - 20544/20544 -\n  CpuTime::getProcessDeltaCpuTime:  <strong>oldValue = 14598780</strong>\n  m_processCpu = 13699779 m_processCpu - oldValue = 18446744073708652615\n  <strong>oldClockTime = 14580000</strong> m_clockTime = 14590000 m_clockTime - oldClockTime = 10000</p>\n  \n  <p>2016/03/29 12:36:19.158 - #2 - 20544/20544 -\n  CpuTime::getProcessDeltaCpuTime:  oldValue = 13699779\n  <strong>m_processCpu = 13699779</strong> m_processCpu - oldValue = 0 oldClockTime = 14590000 <strong>m_clockTime = 14590000</strong> m_clockTime - oldClockTime = 0</p>\n</blockquote>\n\n<p>Which leads me to a different question, how is rusage calculated, and how is clock()? what could lead to the difference between them?</p>\n\n<p>I have worked around the problem, measuring it using clock_gettime, here is the code if any 1 is interested:</p>\n\n<pre><code>  u64 CpuMeasure::calculateCpuTime(int a_type)\n  {\n    struct timespec ts;\n\n    if(a_type == eThisThread)\n    {\n      if (ACE_OS::clock_gettime(CLOCK_THREAD_CPUTIME_ID, &amp;ts) == 0)\n      {\n         return (u64)ts.tv_sec * 1000000 + (u64)ts.tv_nsec / 1000; //From nano to mili seconds\n      }\n    }\n    else\n    {\n      if (ACE_OS::clock_gettime(CLOCK_PROCESS_CPUTIME_ID, &amp;ts) == 0)\n      {\n         return (u64)ts.tv_sec * 1000000 + (u64)ts.tv_nsec / 1000;\n      }\n    }\n    ASSERT(false); //we cant be here, unless some thing bad happened\n    return 0;\n}\n</code></pre>\n\n<p>I am using ACE_OS for portability, but it works with the default functions from sys/time.h</p>\n\n<p>Yet, i am still in question about <strong>rusage strange behavior</strong> , what could cause it to give those values.</p>\n"}, {"tags": ["android", "c++", "c", "sockets", "android-ndk"], "comments": [{"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1458743657, "post_id": 36180968, "comment_id": 59997198, "body": "You want to pass the received datagram packets to the C oprogram you got them from? Please clarify."}, {"owner": {"reputation": 611, "user_id": 6005085, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/c57ef9634d249d5016bea20649c3e2f8?s=128&d=identicon&r=PG&f=1", "display_name": "somia", "link": "https://stackoverflow.com/users/6005085/somia"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1458743967, "post_id": 36180968, "comment_id": 59997464, "body": "I want to pass the received datagram packets to the native method within Android. Not back to the C program which I received from."}], "answers": [{"comments": [{"owner": {"reputation": 611, "user_id": 6005085, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/c57ef9634d249d5016bea20649c3e2f8?s=128&d=identicon&r=PG&f=1", "display_name": "somia", "link": "https://stackoverflow.com/users/6005085/somia"}, "edited": false, "score": 0, "creation_date": 1458744256, "post_id": 36181118, "comment_id": 59997714, "body": "The C function is already defined to receive the packet. I am receiving a structure _PktHdrTypeDef as byte[] and the C function is void Parse_header(_PktHdrTypeDef * pPktHdr)"}, {"owner": {"reputation": 55767, "user_id": 219159, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cxM6H.jpg?s=128&g=1", "display_name": "Seva Alekseyev", "link": "https://stackoverflow.com/users/219159/seva-alekseyev"}, "reply_to_user": {"reputation": 611, "user_id": 6005085, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/c57ef9634d249d5016bea20649c3e2f8?s=128&d=identicon&r=PG&f=1", "display_name": "somia", "link": "https://stackoverflow.com/users/6005085/somia"}, "edited": false, "score": 0, "creation_date": 1458744408, "post_id": 36181118, "comment_id": 59997849, "body": "You know arbitrary C functions cannot be called from Java anyway, right? You would need a JNI compliant wrapper for that, in the form <code>Java_com_mypackage_MyClass_MyMethod()</code>."}, {"owner": {"reputation": 611, "user_id": 6005085, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/c57ef9634d249d5016bea20649c3e2f8?s=128&d=identicon&r=PG&f=1", "display_name": "somia", "link": "https://stackoverflow.com/users/6005085/somia"}, "edited": false, "score": 0, "creation_date": 1458744683, "post_id": 36181118, "comment_id": 59998085, "body": "In that case can I pass the packet as MyMethod(buf) and receive it as Java_com_mypackage_MyClass_MyMethod(JNIEnv * env, _PktHdrTypeDef * pPktHdr)"}, {"owner": {"reputation": 55767, "user_id": 219159, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cxM6H.jpg?s=128&g=1", "display_name": "Seva Alekseyev", "link": "https://stackoverflow.com/users/219159/seva-alekseyev"}, "reply_to_user": {"reputation": 611, "user_id": 6005085, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/c57ef9634d249d5016bea20649c3e2f8?s=128&d=identicon&r=PG&f=1", "display_name": "somia", "link": "https://stackoverflow.com/users/6005085/somia"}, "edited": false, "score": 0, "creation_date": 1458745020, "post_id": 36181118, "comment_id": 59998359, "body": "No. If you pass a <code>byte []</code> from the Java side, the JNI side will receive a <code>jbyteArray</code> and nothing else. It&#39;s up to you to retrieve the bytes from the array. Also, the size of the received packet might be less than the length of the buffer; you will want actual packet size."}, {"owner": {"reputation": 55767, "user_id": 219159, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cxM6H.jpg?s=128&g=1", "display_name": "Seva Alekseyev", "link": "https://stackoverflow.com/users/219159/seva-alekseyev"}, "reply_to_user": {"reputation": 611, "user_id": 6005085, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/c57ef9634d249d5016bea20649c3e2f8?s=128&d=identicon&r=PG&f=1", "display_name": "somia", "link": "https://stackoverflow.com/users/6005085/somia"}, "edited": false, "score": 0, "creation_date": 1458745417, "post_id": 36181118, "comment_id": 59998652, "body": "Also, I have no idea what does <code>_PktHdrTypeDef</code> stand for. Whatever that data structure is, it&#39;s up to you to populate it."}, {"owner": {"reputation": 611, "user_id": 6005085, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/c57ef9634d249d5016bea20649c3e2f8?s=128&d=identicon&r=PG&f=1", "display_name": "somia", "link": "https://stackoverflow.com/users/6005085/somia"}, "edited": false, "score": 0, "creation_date": 1458820773, "post_id": 36181118, "comment_id": 60032602, "body": "Thanks Seva Alekseyev... I am able to receive the byte array using GetByteArrayRegion(). I am accepting your answer!!"}], "tags": [], "owner": {"reputation": 55767, "user_id": 219159, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cxM6H.jpg?s=128&g=1", "display_name": "Seva Alekseyev", "link": "https://stackoverflow.com/users/219159/seva-alekseyev"}, "is_accepted": true, "score": 0, "last_activity_date": 1458743768, "creation_date": 1458743768, "answer_id": 36181118, "question_id": 36180968, "link": "https://stackoverflow.com/questions/36180968/android-ndk-how-to-pass-received-datagrampacket-as-arguments-to-the-c-function/36181118#36181118", "title": "Android NDK how to pass received DatagramPacket as arguments to the C function?", "body": "<p>Pass the <code>buf</code> (assuming it's a <code>byte[]</code>) and the value of <code>packet.getLength()</code> to the JNI function. Inside that, use byte array functions - e. g. <code>JNIEnv::GetByteArrayRegion()</code> to get the actual bytes.</p>\n"}], "owner": {"reputation": 611, "user_id": 6005085, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/c57ef9634d249d5016bea20649c3e2f8?s=128&d=identicon&r=PG&f=1", "display_name": "somia", "link": "https://stackoverflow.com/users/6005085/somia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 36181118, "answer_count": 1, "score": 1, "last_activity_date": 1458743996, "creation_date": 1458743373, "last_edit_date": 1458743996, "question_id": 36180968, "link": "https://stackoverflow.com/questions/36180968/android-ndk-how-to-pass-received-datagrampacket-as-arguments-to-the-c-function", "title": "Android NDK how to pass received DatagramPacket as arguments to the C function?", "body": "<p>I am receiving DatagramPacket in my android application from a C Program. I need to use NDK to parse the data. I want to pass the received packets to the native method to parse. Could someone tell me a way to pass the received packet to the C function?</p>\n\n<pre><code> DatagramPacket packet = new DatagramPacket(buf, buf.length);\n socket.receive(packet);\n System.out.println(packet.getLength());\n</code></pre>\n\n<p>Now I need to pass this received packets to the C function to parse.</p>\n"}, {"tags": ["c", "linux", "raspbian"], "owner": {"reputation": 253, "user_id": 2363018, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a8aa8a1356e2a1dddb4905c9d4a03ab6?s=128&d=identicon&r=PG", "display_name": "Gregorek", "link": "https://stackoverflow.com/users/2363018/gregorek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 195, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1458747770, "creation_date": 1458743215, "last_edit_date": 1458747770, "question_id": 36180907, "link": "https://stackoverflow.com/questions/36180907/console-application-auto-start-at-boot-with-output-to-screen", "title": "Console application auto start at boot with output to screen", "body": "<p>I have my \"c\" application for raspbian which uses a lot of <code>printf</code> and <code>sprintf</code> to display the necessary information. \nThe application should start automatically on boot and display the data on the screen without anyone beeing logged.\nI had this running on older raspbian be adding this command in the file <code>/etc/rc.local</code>:</p>\n\n<pre><code>exec /path/application \n</code></pre>\n\n<p>Everything was fine until i installed it on latest raspbian (8, Jessie). \nNow the application starts from the <code>rc.local</code> but the only thing I get on the screen is \"A start Job is running on rc.local\".</p>\n\n<p>So the application works fine but I don't see the necessary output on the screen which I had before.</p>\n\n<p>I tried to run the application as a process from </p>\n\n<pre><code>/etc/rc2.d/S03application\n</code></pre>\n\n<p>but even if it successfully run there is no output on the screen :(</p>\n\n<p>Is there any way to make the <code>rc.local</code> work as before? Or maybe redirecting the output from process to screen?</p>\n\n<p>Please help</p>\n"}, {"tags": ["c", "pointers", "linear-programming", "glpk"], "comments": [{"owner": {"reputation": 1880, "user_id": 4281182, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/teZv4.png?s=128&g=1", "display_name": "Sel&#231;uk Cihan", "link": "https://stackoverflow.com/users/4281182/sel%c3%a7uk-cihan"}, "edited": false, "score": 1, "creation_date": 1458744230, "post_id": 36180699, "comment_id": 59997689, "body": "The way your method is and the way you call it is perfectly fine. You should look elsewhere for the error. By the way, &quot;outside my function&quot; is the same scope having heler_glpk, right?"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1458744582, "post_id": 36180699, "comment_id": 59997992, "body": "Post <code>index_ouverture_serveur</code> function."}, {"owner": {"reputation": 172, "user_id": 3410991, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/bac95fc33ffe9f71e511c3cfc8d5ba69?s=128&d=identicon&r=PG&f=1", "display_name": "Hayanno", "link": "https://stackoverflow.com/users/3410991/hayanno"}, "edited": false, "score": 0, "creation_date": 1458748886, "post_id": 36180699, "comment_id": 60001396, "body": "I posted index_ouverture_serveur, very simple function..."}, {"owner": {"reputation": 172, "user_id": 3410991, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/bac95fc33ffe9f71e511c3cfc8d5ba69?s=128&d=identicon&r=PG&f=1", "display_name": "Hayanno", "link": "https://stackoverflow.com/users/3410991/hayanno"}, "edited": false, "score": 0, "creation_date": 1458748915, "post_id": 36180699, "comment_id": 60001415, "body": "outside my function mean just after calling my function"}, {"owner": {"reputation": 172, "user_id": 3410991, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/bac95fc33ffe9f71e511c3cfc8d5ba69?s=128&d=identicon&r=PG&f=1", "display_name": "Hayanno", "link": "https://stackoverflow.com/users/3410991/hayanno"}, "edited": false, "score": 0, "creation_date": 1458749420, "post_id": 36180699, "comment_id": 60001815, "body": "I just updated my answer with some printf for debug"}, {"owner": {"reputation": 423, "user_id": 1102939, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ec66abe104696b29841bee7b47bd84ae?s=128&d=identicon&r=PG", "display_name": "Elan", "link": "https://stackoverflow.com/users/1102939/elan"}, "edited": false, "score": 1, "creation_date": 1458750798, "post_id": 36180699, "comment_id": 60002775, "body": "It is possible that you are overwriting the values yourself. Is your <code>malloc</code> big enough? Depends on your exact numeric values of <code>baie.nbr_serveur</code> and <code>nbr_colums</code>, which you haven&#39;t supplied. Is it possible to run the code with some small value like 3 and 4, respectively for these variables. Also a small value for number of rows."}], "owner": {"reputation": 172, "user_id": 3410991, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/bac95fc33ffe9f71e511c3cfc8d5ba69?s=128&d=identicon&r=PG&f=1", "display_name": "Hayanno", "link": "https://stackoverflow.com/users/3410991/hayanno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 1, "closed_date": 1458766192, "answer_count": 0, "score": 4, "last_activity_date": 1458749382, "creation_date": 1458742620, "last_edit_date": 1458749382, "question_id": 36180699, "link": "https://stackoverflow.com/questions/36180699/c-element-of-struct-inside-strunct-not-retaining-assigned-value", "closed_reason": "Not suitable for this site", "title": "C element of struct inside strunct not retaining assigned value", "body": "<p>Here's my structs :</p>\n\n<pre><code>typedef struct Bounds Bounds;\nstruct Bounds\n{\n    int type;\n    double lb;\n    double ub;\n};\n\ntypedef struct HelperGlpk HelperGlpk;\nstruct HelperGlpk\n{\n    double *matrix_coefs;\n    double *obj_coefs;\n    Bounds *row_bounds;\n    Bounds *col_bounds;\n    int *column_of_coef;\n    int *row_of_coef;\n    int cpt_coef;\n    int cpt_contrainte;\n};\n</code></pre>\n\n<p>here's my function generate_contrainte_1 :</p>\n\n<pre><code>void genere_contrainte_1(int i, int j, HelperGlpk *helper_glpk, Baie baie){\n    helper_glpk-&gt;col_bounds[index_ouverture_serveur(i)].type = GLP_DB;\n    helper_glpk-&gt;col_bounds[index_ouverture_serveur(i)].lb = 0;\n    helper_glpk-&gt;col_bounds[index_ouverture_serveur(i)].ub = 1;\n\n    helper_glpk-&gt;col_bounds[index_connexion(i, j, baie.nbr_serveur)].type = GLP_LO;\n    helper_glpk-&gt;col_bounds[index_connexion(i, j, baie.nbr_serveur)].lb = 0;\n    helper_glpk-&gt;col_bounds[index_connexion(i, j, baie.nbr_serveur)].ub = 0;\n</code></pre>\n\n<p>}</p>\n\n<p>and here's how I call generate_contrainte_1 :</p>\n\n<pre><code>HelperGlpk helper_glpk;\nhelper_glpk.col_bounds = malloc((nbr_colums + 1) * sizeof(Bounds));\nhelper_glpk.row_bounds = malloc((nbr_rows + 1) * sizeof(Bounds));  \n\nfor(i = 1; i &lt;= baie.nbr_serveur; i++)\n    for(j = 1; j &lt;= baie.nbr_client; j++)\n        genere_contrainte_1(i, j, &amp;helper_glpk, baie);\n</code></pre>\n\n<p>The problem is that the value inside </p>\n\n<p><code>helper_glpk-&gt;col_bounds[index_ouverture_serveur(i)].type</code> </p>\n\n<p>is not saved outside my function and I get a wrong value when I try to access it.</p>\n\n<p>How can I solve this problem ?</p>\n\n<p>Edit :</p>\n\n<pre><code>int index_ouverture_serveur(int i){\n    return i;\n}\n\nint index_connexion(int i, int j, size_t nbr_serveur){\n    return j * nbr_serveur + i;\n}\n</code></pre>\n\n<p>Edit 2 :\nI added some printf to know where the error come from, it didn't help me but it might help you :</p>\n\n<pre><code>    helper_glpk-&gt;col_bounds[index_ouverture_serveur(i)].type = GLP_DB;\n    helper_glpk-&gt;col_bounds[index_ouverture_serveur(i)].lb = 0;\n    helper_glpk-&gt;col_bounds[index_ouverture_serveur(i)].ub = 1;\n    printf(\"col_bounds[%d].type = %d\\n\", index_ouverture_serveur(i), helper_glpk-&gt;col_bounds[index_ouverture_serveur(i)].type);\n\n    helper_glpk-&gt;col_bounds[index_connexion(i, j, baie.nbr_serveur)].type = GLP_LO;\n    helper_glpk-&gt;col_bounds[index_connexion(i, j, baie.nbr_serveur)].lb = 0;\n    helper_glpk-&gt;col_bounds[index_connexion(i, j, baie.nbr_serveur)].ub = 0;\n\n    printf(\"col_bounds[%d].type = %d\\n\", index_connexion(i, j, baie.nbr_serveur), helper_glpk-&gt;col_bounds[index_ouverture_serveur(i)].type);\n</code></pre>\n\n<p>here's what I get :</p>\n\n<pre><code>col_bounds[1].type = 4\ncol_bounds[51].type = 4\ncol_bounds[1].type = 4\ncol_bounds[101].type = 4\ncol_bounds[1].type = 4\ncol_bounds[151].type = 4\ncol_bounds[1].type = 4\n[...]\ncol_bounds[4900].type = 4\ncol_bounds[50].type = 4\ncol_bounds[4950].type = 4\ncol_bounds[50].type = 4\ncol_bounds[5000].type = 4\ncol_bounds[50].type = 4\ncol_bounds[5050].type = 4\n</code></pre>\n\n<p>now I do this printf outside my function :</p>\n\n<pre><code>for(i = 1; i &lt;= nbr_colums; i++)\n        printf(\"type[%d] : %d\\n\", i, helper_glpk.col_bounds[i].type);\n</code></pre>\n\n<p>and this is what I get :</p>\n\n<pre><code>type[1] : 2555\ntype[2] : 2558\ntype[3] : 2561\ntype[4] : 2564\ntype[5] : 2567\ntype[6] : 2570\ntype[7] : 2573\ntype[8] : 2576\ntype[9] : 2579\ntype[10] : 2582\ntype[11] : 2585\ntype[12] : 2588\ntype[13] : 2591\ntype[14] : 2594\ntype[15] : 2597\ntype[16] : 2600\ntype[17] : 2603\ntype[18] : 2606\ntype[19] : 2609\ntype[20] : 2612\ntype[21] : 2615\ntype[22] : 2618\ntype[23] : 2621\ntype[24] : 2624\ntype[25] : 2627\ntype[26] : 2630\ntype[27] : 4\ntype[28] : 4\ntype[29] : 4\ntype[30] : 4\n[...]\ntype[5042] : 2\ntype[5043] : 2\ntype[5044] : 2\ntype[5045] : 2\ntype[5046] : 2\ntype[5047] : 2\ntype[5048] : 2\ntype[5049] : 2\ntype[5050] : 2\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2134, "user_id": 2623659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1bd33f70a971bf89c7719005d477e2b?s=128&d=identicon&r=PG", "display_name": "ach", "link": "https://stackoverflow.com/users/2623659/ach"}, "edited": false, "score": 1, "creation_date": 1458742391, "post_id": 36180485, "comment_id": 59996173, "body": "Probably, your program executes too fast, thus causing <code>time</code> to return the same value each time? <code>time</code> returns the number of seconds elapsed since the start of the UNIX era, so if your script makes it all into less than a second, there&#39;s a large chance, it&#39;ll be the same value."}, {"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "edited": false, "score": 2, "creation_date": 1458742458, "post_id": 36180485, "comment_id": 59996228, "body": "Can you post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> - the minimum program code necessary to reproduce the issue?"}, {"owner": {"reputation": 1247, "user_id": 1137904, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hy2jE.png?s=128&g=1", "display_name": "Alanmars", "link": "https://stackoverflow.com/users/1137904/alanmars"}, "edited": false, "score": 0, "creation_date": 1458742548, "post_id": 36180485, "comment_id": 59996305, "body": "Why not output the value &#39;time(NULL)&#39;? Maybe the same value is output for all processes, you know, for the same seed, srand always generate same number sequence."}], "answers": [{"comments": [{"owner": {"reputation": 1247, "user_id": 4284745, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-PPay30ot1_k/AAAAAAAAAAI/AAAAAAAAAFM/j7wqJ8SG30g/photo.jpg?sz=128", "display_name": "Dimitri Danilov", "link": "https://stackoverflow.com/users/4284745/dimitri-danilov"}, "edited": false, "score": 0, "creation_date": 1458742625, "post_id": 36180671, "comment_id": 59996371, "body": "Thanks, effectively my usleep was not enough, I needed to sleep more than 1 second to have a good random."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 3, "creation_date": 1458742648, "post_id": 36180671, "comment_id": 59996396, "body": "Suggest <code>srand(time(NULL) ^ getpid())</code>"}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1458742658, "post_id": 36180671, "comment_id": 59996406, "body": "A common approach is to combine the time and process ID in some way."}], "tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": true, "score": 7, "last_activity_date": 1458743094, "last_edit_date": 1458743094, "creation_date": 1458742566, "answer_id": 36180671, "question_id": 36180485, "link": "https://stackoverflow.com/questions/36180485/why-rand-returns-the-same-values-when-i-run-my-program-in-a-script/36180671#36180671", "title": "Why rand() returns the same values when I run my program in a script ?", "body": "<p>The <code>time()</code> call has only whole-second precision. If your programs all run the same second, they will all use the same seed.</p>\n\n<p>You must add more entropy. Consider using the return value of <a href=\"http://linux.die.net/man/2/getpid\" rel=\"nofollow\"><code>getpid()</code></a> if you have it, or else investigate the platform's random sources.</p>\n"}, {"tags": [], "owner": {"reputation": 1875, "user_id": 5057191, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d3a861c87b46363f63080839bbc699f2?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. E", "link": "https://stackoverflow.com/users/5057191/mr-e"}, "is_accepted": false, "score": 2, "last_activity_date": 1458742661, "creation_date": 1458742661, "answer_id": 36180714, "question_id": 36180485, "link": "https://stackoverflow.com/questions/36180485/why-rand-returns-the-same-values-when-i-run-my-program-in-a-script/36180714#36180714", "title": "Why rand() returns the same values when I run my program in a script ?", "body": "<p>This is cause <code>usleep</code> is delaying the execution of the next script the amount of microseconds (10000 = 0.01 seconds). <code>time(NULL)</code> returns SECONDS, thus making each <code>time(NULL)</code> returning value the same. Increase the amount of time it's delayed</p>\n"}], "owner": {"reputation": 1247, "user_id": 4284745, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-PPay30ot1_k/AAAAAAAAAAI/AAAAAAAAAFM/j7wqJ8SG30g/photo.jpg?sz=128", "display_name": "Dimitri Danilov", "link": "https://stackoverflow.com/users/4284745/dimitri-danilov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "closed_date": 1458742652, "accepted_answer_id": 36180671, "answer_count": 2, "score": 2, "last_activity_date": 1458743094, "creation_date": 1458742052, "question_id": 36180485, "link": "https://stackoverflow.com/questions/36180485/why-rand-returns-the-same-values-when-i-run-my-program-in-a-script", "closed_reason": "Duplicate", "title": "Why rand() returns the same values when I run my program in a script ?", "body": "<p>I have a <code>srand(time(NULL))</code> at the beginning of the execution, then I am doing </p>\n\n<pre><code>*pos_x = (rand() % HEIGHT);\n*pos_y = (rand() % WIDTH);\n</code></pre>\n\n<p>to generate random numbers.</p>\n\n<p>This works fine when I run my program manually, but when I lunch my program with this script : </p>\n\n<pre><code>#!/bin/bash\n\ni=\"0\"\nteam_number=\"0\"\n\nwhile [ $i -lt 30 ]\ndo\n  ./lemipc `pwd` team_number\ni=$[$i+1]\n  if (( $i % 10 == 0 ))\n  then\n    team_number=$[$team_number+1]\nfi\necho \"create process $i\"\nusleep 10000\ndone\n</code></pre>\n\n<p>I always get the same numbers for all the processes.</p>\n\n<p>I even tried to add a usleep to fix this but it still doesn't work.\nI get this for exemple : </p>\n\n<pre><code>97 51 \ncreate process 1\n97 51 \ncreate process 2\n97 51 \ncreate process 3\n97 51 \n</code></pre>\n\n<p>where 97 is pos_x and 51 pos_y.</p>\n\n<p>Have an idea why ? </p>\n"}, {"tags": ["c++", "c", "c-preprocessor"], "comments": [{"owner": {"reputation": 6770, "user_id": 3658660, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b40f4e2bead9eca6951da110a3c84e7?s=128&d=identicon&r=PG&f=1", "display_name": "hlscalon", "link": "https://stackoverflow.com/users/3658660/hlscalon"}, "edited": false, "score": 1, "creation_date": 1458742499, "post_id": 36180427, "comment_id": 59996265, "body": "What is the <i>complementary thing</i> you don&#39;t want it to do ?"}, {"owner": {"reputation": 203, "user_id": 3585955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1ef6feee33033f17adf1c9bccb2436d?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Wahler", "link": "https://stackoverflow.com/users/3585955/michael-wahler"}, "reply_to_user": {"reputation": 6770, "user_id": 3658660, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b40f4e2bead9eca6951da110a3c84e7?s=128&d=identicon&r=PG&f=1", "display_name": "hlscalon", "link": "https://stackoverflow.com/users/3658660/hlscalon"}, "edited": false, "score": 2, "creation_date": 1458742573, "post_id": 36180427, "comment_id": 59996328, "body": "<code>gcc -E -dM</code> displays all symbols that the preprocessor would apply to the code. What I want, in contrast, is a list of all symbols actually used in the code."}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1458743371, "post_id": 36180427, "comment_id": 59996965, "body": "What about preprocessor symbols that are generated using the concatenation operator?"}, {"owner": {"reputation": 59891, "user_id": 1207195, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q3P4g.jpg?s=128&g=1", "display_name": "Adriano Repetti", "link": "https://stackoverflow.com/users/1207195/adriano-repetti"}, "edited": false, "score": 0, "creation_date": 1458743912, "post_id": 36180427, "comment_id": 59997405, "body": "Not a ready to use answer but <a href=\"https://github.com/gcc-mirror/gcc/blob/master/libcpp/identifiers.c\" rel=\"nofollow noreferrer\">libcpp is open source</a>, if there isn&#39;t not a ready-to-use utility you may wrap some code around libcpp to dump all identifiers which are a known macro (note that this will include what paddy highlighted in his comment and it may be not what you want). for sure a starting point. Check also track_macro_expansion option."}, {"owner": {"reputation": 7797, "user_id": 942746, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/34cf9eae5d595c0b480a7cb42f3722b1?s=128&d=identicon&r=PG", "display_name": "Brian McFarland", "link": "https://stackoverflow.com/users/942746/brian-mcfarland"}, "edited": false, "score": 0, "creation_date": 1458747289, "post_id": 36180427, "comment_id": 60000168, "body": "Maybe you could get there via debug info in an elf?  If your code is compiled with the right flags (e.g. <code>-gdwarf-2 -g3</code>), <a href=\"https://sourceware.org/gdb/onlinedocs/gdb/Macros.html\" rel=\"nofollow noreferrer\">gdb is able to understand macros</a>, including when the macros are #defined / #undefed.  Maybe the dwarf info also contains where the macros are used??"}, {"owner": {"reputation": 2643, "user_id": 925592, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/e3X1a.jpg?s=128&g=1", "display_name": "RufusVS", "link": "https://stackoverflow.com/users/925592/rufusvs"}, "edited": false, "score": 0, "creation_date": 1576259496, "post_id": 36180427, "comment_id": 104854426, "body": "I am doing something similar.  I wrote a python program to extract all #define symbols and their values.  Then I generate an include-able file that uses &quot;#pragma message...&quot; (in my compiler) to output &lt;SYMBOL&gt;:&lt;VALUE&gt; lines.  not exactly what the OP asked for, but it gets very close to what I need.  I hope the OP keeps us posted on results."}], "answers": [{"tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 2, "last_activity_date": 1458746331, "creation_date": 1458746331, "answer_id": 36182060, "question_id": 36180427, "link": "https://stackoverflow.com/questions/36180427/extracting-preprocessor-symbols-from-source/36182060#36182060", "title": "Extracting preprocessor symbols from source", "body": "<p>That's quite simple. You have just to parse the source code <strong>exactly</strong> the way a conformant pre-processor would, and with the correct C or C++ version support. Ok, I'm joking, if you support only the later version, your code is likely to produce correct results on older versions - but even this should be thoroughly controlled.</p>\n\n<p>More seriously now. As you can ask the pre-processor to give you the list of all defined symbols, you can simply <em>tokenize</em> the source, and identify all tokens from that list that are not immediately following an initial #define or #undef. This part should be reasonably feasable with lex+yacc.</p>\n\n<p>The only alternative I can imagine would be to use the code of a real compiler (Clang should be easier than gcc but unsure) discard all code generation and consistently store every macro usage.</p>\n\n<p>TL/DR: however you take it, it will be a hard work: if you can do without, keep away from that...</p>\n"}, {"tags": [], "owner": {"reputation": 1036, "user_id": 192737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48f738d8db73053bd199aef3ae0bc10e?s=128&d=identicon&r=PG", "display_name": "Jeff Trull", "link": "https://stackoverflow.com/users/192737/jeff-trull"}, "is_accepted": false, "score": 0, "last_activity_date": 1458881087, "creation_date": 1458881087, "answer_id": 36214153, "question_id": 36180427, "link": "https://stackoverflow.com/questions/36180427/extracting-preprocessor-symbols-from-source/36214153#36214153", "title": "Extracting preprocessor symbols from source", "body": "<p>You can get half way there by using a preprocessor library such as <a href=\"http://www.boost.org/doc/libs/1_60_0/libs/wave/\" rel=\"nofollow\">Boost.Wave</a>.  It can act as a lexer so you wouldn't have to write that part yourself.  You would have to supply a grammar for the bit you cared about (define, ifdef, ifndef, if, elif) though. </p>\n"}], "owner": {"reputation": 203, "user_id": 3585955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1ef6feee33033f17adf1c9bccb2436d?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Wahler", "link": "https://stackoverflow.com/users/3585955/michael-wahler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 233, "favorite_count": 3, "answer_count": 2, "score": 14, "last_activity_date": 1459026983, "creation_date": 1458741883, "last_edit_date": 1459026983, "question_id": 36180427, "link": "https://stackoverflow.com/questions/36180427/extracting-preprocessor-symbols-from-source", "title": "Extracting preprocessor symbols from source", "body": "<p>I'm looking for a way to extract all preprocessor symbols used in my code.<br>\nAs an example, if my code looks like this:</p>\n\n<pre><code>#ifdef FOO\n#endif\n\n#if ( BAR == 1 &amp;&amp; \\\n      defined (Z) )\n#endif\n</code></pre>\n\n<p>I'd like to get the list <code>[FOO,BAR,Z]</code> as the output.</p>\n\n<p>I found some posts suggesting <code>gcc -E -dM</code>, but this displays all symbols that the preprocessor would apply to the code.<br>\nWhat I want, in contrast, is a list of all symbols <strong>actually used in the code</strong>. </p>\n\n<p>Any suggestions?</p>\n"}, {"tags": ["c", "gcc", "compilation"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1458741168, "post_id": 36179970, "comment_id": 59995154, "body": "If your code compiles without certains headers, why do you include them in first place? But I doubt your code compiles if you don&#39;t include ocilib.h."}, {"owner": {"reputation": 147, "user_id": 1958295, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/dce738831c2712369e3ce16cab9a26b6?s=128&d=identicon&r=PG", "display_name": "Mojo", "link": "https://stackoverflow.com/users/1958295/mojo"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1458741284, "post_id": 36179970, "comment_id": 59995236, "body": "cause on some machine I dont have ocilib installed , and on some machines I dont have mysql installed.."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1458741354, "post_id": 36179970, "comment_id": 59995300, "body": "How do you expect to compile code that uses ocilib, when the ocilib headers are not available ? It&#39;s almost like expecting to be able to compile your C code when there is no C compiler available."}, {"owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "edited": false, "score": 0, "creation_date": 1458741639, "post_id": 36179970, "comment_id": 59995543, "body": "I think you&#39;ll have to create a kind of dummy implementation of oclib/mysql"}, {"owner": {"reputation": 147, "user_id": 1958295, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/dce738831c2712369e3ce16cab9a26b6?s=128&d=identicon&r=PG", "display_name": "Mojo", "link": "https://stackoverflow.com/users/1958295/mojo"}, "edited": false, "score": 0, "creation_date": 1458742125, "post_id": 36179970, "comment_id": 59995951, "body": "ok , got it. used <code>#define</code> and <code>#ifdef</code> and now everything works. Thanks guys !"}], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 1958295, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/dce738831c2712369e3ce16cab9a26b6?s=128&d=identicon&r=PG", "display_name": "Mojo", "link": "https://stackoverflow.com/users/1958295/mojo"}, "edited": false, "score": 0, "creation_date": 1458742087, "post_id": 36180329, "comment_id": 59995923, "body": "ok , got it. used <code>#define</code> and <code>#ifdef</code> and now everything works. Thanks guys !"}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 1, "last_activity_date": 1458741672, "creation_date": 1458741672, "answer_id": 36180329, "question_id": 36179970, "link": "https://stackoverflow.com/questions/36179970/can-i-compile-selected-headers-code-in-c/36180329#36180329", "title": "Can I compile selected headers code in C", "body": "<p>You can insert conditional compilation directives (<code>#ifdef</code> ... <code>#endif</code> being canonical) into the code to selectively enable or disable compilation of the relevant <code>#include</code> directives.  As @MichaelWalz observed in comments, however, suppressing just the headers probably breaks the rest of the code -- if it doesn't then you should just delete those <code>#include</code>s.</p>\n\n<p>Moreover, if you do not have the headers in a particular environment, then it seems likely that you also do not have the libraries containing the functions declared by those headers.  Supposing that you include the headers because your code relies on some of those functions, you won't then be able to link the program once you compile it, headers or no headers.</p>\n\n<p>A conditional compilation solution thus only works if you use it everywhere needed in your code to remove all reliance on the features of a given library, including the associated headers.  That approach is relatively common, but it is not easy to retrofit onto a system not initially designed for it.</p>\n"}], "owner": {"reputation": 147, "user_id": 1958295, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/dce738831c2712369e3ce16cab9a26b6?s=128&d=identicon&r=PG", "display_name": "Mojo", "link": "https://stackoverflow.com/users/1958295/mojo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 36180329, "answer_count": 1, "score": 0, "last_activity_date": 1458741672, "creation_date": 1458740757, "question_id": 36179970, "link": "https://stackoverflow.com/questions/36179970/can-i-compile-selected-headers-code-in-c", "title": "Can I compile selected headers code in C", "body": "<p>I have a code in C that uses ocilib and mysql headers .\non some of my machine I don't have ocilib or mysql , and I want to be able to select to compile my code with/without the headers , can I do that ?\nneed to say that the code has ocilib and mysql defined in it, so probably I'll want to put them out too when compiling.</p>\n\n<p>example : </p>\n\n<pre><code>#include &lt;regex.h&gt;\n#include &lt;time.h&gt;\n#include &lt;ocilib.h&gt;\n\n\nvoid main(){\nMYSQL *conn;\nOCI_Connection* cn;\nOCI_Statement* st;\nchar *db_type=NULL;\n.....\n....\nif (strcasestr(db_type,\"mysql\")){/* mysql */\nif (!mysql_real_connect(conn, db_host,db_user, db_password, db_schemata, 0, NULL, 0)) {\n        syslog (LOG_NOTICE,\"%s\\n\", mysql_error(conn));\n        return;\n    }\n....\n}else{/* oracle*/\nOCI_Initialize(NULL, NULL, OCI_ENV_DEFAULT);\n....\n}\n}\n</code></pre>\n\n<p>I hope I was clear enough..\nthanks !</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1458740719, "post_id": 36179812, "comment_id": 59994794, "body": "Yes, both are the same, <code>MY_INT</code> is replaced by <code>int</code> in the first case."}, {"owner": {"reputation": 1068, "user_id": 57140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da10f3d496288a3eb7cf6ac03c225ed?s=128&d=identicon&r=PG", "display_name": "kwarnke", "link": "https://stackoverflow.com/users/57140/kwarnke"}, "edited": false, "score": 0, "creation_date": 1458740810, "post_id": 36179812, "comment_id": 59994861, "body": "Yes, The first approach looks from my side more readable, because it does show that <code>MY_INT</code> is the original type in question."}, {"owner": {"reputation": 2971, "user_id": 4975646, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XzXhmdjjKB0/AAAAAAAAAAI/AAAAAAAAAeg/9rsygRfbVyk/photo.jpg?sz=128", "display_name": "callyalater", "link": "https://stackoverflow.com/users/4975646/callyalater"}, "edited": false, "score": 0, "creation_date": 1458740966, "post_id": 36179812, "comment_id": 59994987, "body": "This actually happens a lot in the C standard library headers. Many times the &quot;type&quot; in the <code>typedef</code> is implementation defined and will have been defined by a <code>#define</code> earlier to ensure the the <code>typedef</code> alias is of the proper type."}], "answers": [{"comments": [{"owner": {"reputation": 2181, "user_id": 5598574, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/aUJPQ.jpg?s=128&g=1", "display_name": "Hairi", "link": "https://stackoverflow.com/users/5598574/hairi"}, "edited": false, "score": 0, "creation_date": 1458742058, "post_id": 36179982, "comment_id": 59995898, "body": "I thought so as well, but I need to be sure."}], "tags": [], "owner": {"reputation": 2575, "user_id": 4711812, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/87100b6114369140256e64e7ebab7ec9?s=128&d=identicon&r=PG&f=1", "display_name": "muXXmit2X", "link": "https://stackoverflow.com/users/4711812/muxxmit2x"}, "is_accepted": true, "score": 2, "last_activity_date": 1458743214, "last_edit_date": 1458743214, "creation_date": 1458740779, "answer_id": 36179982, "question_id": 36179812, "link": "https://stackoverflow.com/questions/36179812/can-i-use-define-specifying-a-type/36179982#36179982", "title": "Can I use define specifying a type", "body": "<p><strong>Do both declare two variables: a pointer to an int and an integer variable?</strong></p>\n\n<p>Short: yes.</p>\n\n<p>Long:</p>\n\n<p>Macro substitution is nothing else then plain text substitution. So when you <code>#define MY_INT int</code>, everything the preprocessor does when he finds a <code>MY_INT</code> is replacing it with <code>int</code>. </p>\n\n<p>After the preprocessor processed <strong>file.c</strong> in your first approach it will look exactly the same as <strong>file.c</strong> in the second approach. </p>\n\n<p>You can have a look at the preprocessors output with most compilers. E.g. for GCC the command would look like this <code>gcc -E -o file.i file.c</code>. <strong>file.i</strong> will then contain the preprocessors output so the actual file wich will be passed to the compiler.</p>\n\n<hr>\n\n<p>This is what GCC produced for your first approach:</p>\n\n<pre><code># 1 \"file1.c\"\n# 1 \"&lt;built-in&gt;\"\n# 1 \"&lt;command-line&gt;\"\n# 1 \"/usr/include/stdc-predef.h\" 1 3 4\n# 1 \"&lt;command-line&gt;\" 2\n# 1 \"file1.c\"\n# 1 \"file.h\" 1\n# 2 \"file1.c\" 2\n\ntypedef int my_int;\n\nmy_int *a, b;\n</code></pre>\n\n<p>and here is the second one</p>\n\n<pre><code># 1 \"file2.c\"\n# 1 \"&lt;built-in&gt;\"\n# 1 \"&lt;command-line&gt;\"\n# 1 \"/usr/include/stdc-predef.h\" 1 3 4\n# 1 \"&lt;command-line&gt;\" 2\n# 1 \"file2.c\"\n# 1 \"file.h\" 1\n# 2 \"file2.c\" 2\n\ntypedef int my_int;\n\nmy_int *a, b;\n</code></pre>\n\n<p>The only thing that differes is the name of the files I used. The rest is exactly the same.</p>\n"}], "owner": {"reputation": 2181, "user_id": 5598574, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/aUJPQ.jpg?s=128&g=1", "display_name": "Hairi", "link": "https://stackoverflow.com/users/5598574/hairi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 36179982, "answer_count": 1, "score": 0, "last_activity_date": 1458743214, "creation_date": 1458740391, "question_id": 36179812, "link": "https://stackoverflow.com/questions/36179812/can-i-use-define-specifying-a-type", "title": "Can I use define specifying a type", "body": "<p>Let assume that I can not have a private <code>typedef</code> in my header file. So I need to do connection to type that is specified from the outside. In other words the type <code>MY_INT</code> should be determined by the interface.</p>\n\n<p>So are these two approaches equal?</p>\n\n<h2>First approach:</h2>\n\n<p>In <strong>file.h</strong></p>\n\n<pre><code>#define MY_INT int\n</code></pre>\n\n<p>In <strong>file.c</strong></p>\n\n<pre><code>typedef MY_INT my_int;\nmy_int *a,b;\n</code></pre>\n\n<h2>Second approach</h2>\n\n<p>In <strong>file.c</strong></p>\n\n<pre><code>typedef int my_int; \nmy_int *a,b;\n</code></pre>\n\n<p>Do both declare two variables: a pointer to an int and an integer variable?</p>\n"}, {"tags": ["c", "opencl"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1458740290, "post_id": 36179748, "comment_id": 59994505, "body": "Post deceleration of <code>err</code>.  It is special somehow?"}, {"owner": {"reputation": 9942, "user_id": 2876799, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/f4774e789da0e393d56db22b62b9d292?s=128&d=identicon&r=PG&f=1", "display_name": "chasep255", "link": "https://stackoverflow.com/users/2876799/chasep255"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1458740347, "post_id": 36179748, "comment_id": 59994540, "body": "Here is the link to the full code (scroll down) <a href=\"https://github.com/clMathLibraries/clFFT\" rel=\"nofollow noreferrer\">github.com/clMathLibraries/clFFT</a>  err is just of type cl_int"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1458749011, "post_id": 36179748, "comment_id": 60001502, "body": "Not full code.  The definition of <code>type cl_int</code> is not there (AFAICT), maybe in <code>CL&#47;cl.h</code>.  OTOH, I do not expect this line of inquiry to help anyway now."}, {"owner": {"reputation": 7967, "user_id": 741692, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1300d6b45404082362f2d0f05de23640?s=128&d=identicon&r=PG&f=1", "display_name": "DarkZeros", "link": "https://stackoverflow.com/users/741692/darkzeros"}, "edited": false, "score": 0, "creation_date": 1458749124, "post_id": 36179748, "comment_id": 60001588, "body": "It is badly written, you can tell by the totally wasted <code>clFinish()</code> followed by a blocking call. In addition to the not checked error return codes"}, {"owner": {"reputation": 568, "user_id": 4157408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a44b6a712c8ad167e7331cef927d46a2?s=128&d=identicon&r=PG&f=1", "display_name": "void_ptr", "link": "https://stackoverflow.com/users/4157408/void-ptr"}, "edited": false, "score": 1, "creation_date": 1458758384, "post_id": 36179748, "comment_id": 60007663, "body": "That could be helpful during debugging - as you step through the code, you can watch <code>err</code>. But in general, yes, just poorly written code."}], "answers": [{"comments": [{"owner": {"reputation": 9942, "user_id": 2876799, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/f4774e789da0e393d56db22b62b9d292?s=128&d=identicon&r=PG&f=1", "display_name": "chasep255", "link": "https://stackoverflow.com/users/2876799/chasep255"}, "edited": false, "score": 0, "creation_date": 1458740660, "post_id": 36179842, "comment_id": 59994759, "body": "You would just not expect them to do something like this on the main example on the home page of their site."}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "reply_to_user": {"reputation": 9942, "user_id": 2876799, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/f4774e789da0e393d56db22b62b9d292?s=128&d=identicon&r=PG&f=1", "display_name": "chasep255", "link": "https://stackoverflow.com/users/2876799/chasep255"}, "edited": false, "score": 0, "creation_date": 1458740892, "post_id": 36179842, "comment_id": 59994925, "body": "@chasep255 True, but often that kind of &quot;page one&quot; example code is simplified to make the point clearer. Usually that&#39;s pointed out though, which doesn&#39;t seem to happen here."}, {"owner": {"reputation": 739, "user_id": 2710409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2IZ3I.jpg?s=128&g=1", "display_name": "Joshpbarron", "link": "https://stackoverflow.com/users/2710409/joshpbarron"}, "edited": false, "score": 0, "creation_date": 1458741049, "post_id": 36179842, "comment_id": 59995048, "body": "I used to use |= for a series of errors, which seems to be a variation of this."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "reply_to_user": {"reputation": 739, "user_id": 2710409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2IZ3I.jpg?s=128&g=1", "display_name": "Joshpbarron", "link": "https://stackoverflow.com/users/2710409/joshpbarron"}, "edited": false, "score": 0, "creation_date": 1458741319, "post_id": 36179842, "comment_id": 59995268, "body": "@joshpbarron, you can only do that if he errors a) do not culminate (I mean, can&#39;t continue after an error) and then b) errors are bit fields. Otherwise it is just as bad."}, {"owner": {"reputation": 9942, "user_id": 2876799, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/f4774e789da0e393d56db22b62b9d292?s=128&d=identicon&r=PG&f=1", "display_name": "chasep255", "link": "https://stackoverflow.com/users/2876799/chasep255"}, "edited": false, "score": 0, "creation_date": 1458741520, "post_id": 36179842, "comment_id": 59995439, "body": "The only theory I have is that maybe subsequent function calls return the last error if there was one.  Probably just bad code."}], "tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": true, "score": 2, "last_activity_date": 1458740458, "creation_date": 1458740458, "answer_id": 36179842, "question_id": 36179748, "link": "https://stackoverflow.com/questions/36179748/what-is-the-point-of-error-checking-in-this-code/36179842#36179842", "title": "What is the point of error checking in this code?", "body": "<p>My guess would be: a lazy programmer (aka \"bad code\").</p>\n\n<p>You're right, it just throws each error value away, and doesn't check it.</p>\n\n<p>This isn't very uncommon, since probably it works \"most of the time\" and the error paths rarely get used.</p>\n"}, {"comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1458741634, "post_id": 36180247, "comment_id": 59995538, "body": "The debugging point is actually a very important one.  With optimization all off, the &#39;err&#39; var would probably exist and get loaded from EAX, (or whatever), even if unused.  On a release build with all opti. on, it would all likely get removed."}], "tags": [], "owner": {"reputation": 1068, "user_id": 57140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da10f3d496288a3eb7cf6ac03c225ed?s=128&d=identicon&r=PG", "display_name": "kwarnke", "link": "https://stackoverflow.com/users/57140/kwarnke"}, "is_accepted": false, "score": 5, "last_activity_date": 1458741464, "creation_date": 1458741464, "answer_id": 36180247, "question_id": 36179748, "link": "https://stackoverflow.com/questions/36179748/what-is-the-point-of-error-checking-in-this-code/36180247#36180247", "title": "What is the point of error checking in this code?", "body": "<p>For me it looks like improvable code. It is better than just ignoring the return value, the usual way, because you can see the actual return value while debugging. In your example, where no special error handling is needed, for a better readability a macro could be an option:</p>\n\n<pre><code>#define ON_ERROR_GOTO_CLEANUP(status) if(status != CLBPM_SUCCESS) goto cleanup\n\nON_ERROR_GOTO_CLEANUP(clfftSetPlanScale(bpm-&gt;fft_plan, CLFFT_BACKWARD, 1.0f));\n</code></pre>\n"}], "owner": {"reputation": 9942, "user_id": 2876799, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/f4774e789da0e393d56db22b62b9d292?s=128&d=identicon&r=PG&f=1", "display_name": "chasep255", "link": "https://stackoverflow.com/users/2876799/chasep255"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 36179842, "answer_count": 2, "score": 1, "last_activity_date": 1458741464, "creation_date": 1458740210, "question_id": 36179748, "link": "https://stackoverflow.com/questions/36179748/what-is-the-point-of-error-checking-in-this-code", "title": "What is the point of error checking in this code?", "body": "<p>I was looking at the example code for clfft.  I notice that they keep assigning a value to err after each function call.</p>\n\n<pre><code>err = clfftCreateDefaultPlan(&amp;planHandle, ctx, dim, clLengths);\n\n/* Set plan parameters. */\nerr = clfftSetPlanPrecision(planHandle, CLFFT_SINGLE);\nerr = clfftSetLayout(planHandle, CLFFT_COMPLEX_INTERLEAVED, CLFFT_COMPLEX_INTERLEAVED);\nerr = clfftSetResultLocation(planHandle, CLFFT_INPLACE);\n\n/* Bake the plan. */\nerr = clfftBakePlan(planHandle, 1, &amp;queue, NULL, NULL);\n\n/* Execute the plan. */\nerr = clfftEnqueueTransform(planHandle, CLFFT_FORWARD, 1, &amp;queue, 0, NULL, NULL, &amp;bufX, NULL, NULL);\n\n/* Wait for calculations to be finished. */\nerr = clFinish(queue);\n\n/* Fetch results of calculations. */\nerr = clEnqueueReadBuffer( queue, bufX, CL_TRUE, 0, N * 2 * sizeof( *X ), X, 0, NULL, NULL );\n</code></pre>\n\n<p>I understand the need for error checking but they never actually check the return value.  They just assign it to err and overwrite it.  In my code I have this...</p>\n\n<pre><code>status = clfftSetPlanPrecision(bpm-&gt;fft_plan, bpm-&gt;float_type);\n    if(status != CLBPM_SUCCESS)\n        goto cleanup;\n\n    status = clfftSetLayout(bpm-&gt;fft_plan, CLFFT_COMPLEX_INTERLEAVED, CLFFT_COMPLEX_INTERLEAVED);\n    if(status != CLBPM_SUCCESS)\n        goto cleanup;\n\n    status = clfftSetPlanScale(bpm-&gt;fft_plan, CLFFT_FORWARD, 1.0f / (bpm-&gt;grid_size * bpm-&gt;grid_size));\n    if(status != CLBPM_SUCCESS)\n        goto cleanup;\n\n    status = clfftSetPlanScale(bpm-&gt;fft_plan, CLFFT_BACKWARD, 1.0f);\n    if(status != CLBPM_SUCCESS)\n        goto cleanup;\n\n    status = clfftSetResultLocation(bpm-&gt;fft_plan, CLFFT_OUTOFPLACE);\n    if(status != CLBPM_SUCCESS)\n        goto cleanup;\n</code></pre>\n\n<p>Is the example code just bad code or is the error propagating through the function calls?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1458740515, "post_id": 36179728, "comment_id": 59994652, "body": "Well, for one thing, you want time_t, not uint32_t.."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1458740530, "post_id": 36179728, "comment_id": 59994663, "body": "What is the type <code>Tm</code>? Is it an alias for <code>struct tm</code>?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1458740579, "post_id": 36179728, "comment_id": 59994696, "body": "As for your problem, what is the value of the <code>tm_isdst</code> member? Maybe you should initialize it?"}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 4, "creation_date": 1458741091, "post_id": 36179728, "comment_id": 59995095, "body": "<code>tm_mon</code> should be zero-based so if you want March it&#39;s 2, not 3.  And <code>tm_year</code> is years since 1900, not 1970.  There is no <code>tm_day</code> in <code>struct tm</code>.  Very curious about what this <code>Tm</code> is."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1458743219, "post_id": 36180124, "comment_id": 59996839, "body": "Another note:  <code>mktime()</code> expects <i>all</i> fields, except <code>tm_wday</code> and <code>tm_yday</code> to be initialized.  <code>struct tm</code> has at <i>least</i> 9 fields - maybe more.  Best to zero fill all <code>tm Tm = {0};</code> and then fill individual fields as needed - before calling <code>mktime()</code>.  Then check its result against -1."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1458745021, "post_id": 36180124, "comment_id": 59998360, "body": "@chux Check its result against -1, and hope the date you were trying to convert wasn&#39;t 23:59:59 on December 31, 1969. :-) (But you&#39;re right, of course.)"}], "tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": false, "score": 4, "last_activity_date": 1458741880, "last_edit_date": 1458741880, "creation_date": 1458741120, "answer_id": 36180124, "question_id": 36179728, "link": "https://stackoverflow.com/questions/36179728/mktime-is-not-converting-to-the-right-date-why/36180124#36180124", "title": "mktime is not converting to the right date, why?", "body": "<p>I'm not sure what answer you were expecting.</p>\n\n<p>I assume your <code>Tm</code> type is actually a <code>struct tm</code>.</p>\n\n<p>When you set</p>\n\n<pre><code>Tm.tm_year = 46;\n</code></pre>\n\n<p>you are asking for the year 1946.</p>\n\n<p>When you set</p>\n\n<pre><code>Tm.tm_mon = 3;\n</code></pre>\n\n<p>you are asking for April.  (tm_mon is 0-based.)</p>\n\n<p>I assume you meant</p>\n\n<pre><code>Tm.tm_mday = 23;\n</code></pre>\n\n<p>(There is no <code>tm_day</code> member in <code>struct tm</code>.)</p>\n\n<p>As Joachim Pileborg mentioned, for best results when calling <code>mktime</code> you should also set</p>\n\n<pre><code>Tm.tm_isdst = -1;\n</code></pre>\n\n<p>Finally, most systems measure time since 1970.  So 1946 is a negative time.  So when you assign <code>mktime</code>'s return value to an unsigned <code>epoch</code> variable, you're not going to get the right answer.</p>\n\n<p>When I modify your code to assign <code>mktime</code>'s return value to a <code>time_t</code> variable, and print it, like this:</p>\n\n<pre><code>time_t epoch = mktime(&amp;Tm);\nprintf(\"%ld\\n\", (long)epoch);\n</code></pre>\n\n<p>I get -747654982, which is what I'd expect.  (I'm on U.S. Eastern time; if you're in a different time zone you'll get a slightly different value.)</p>\n\n<p>If you want to compute a time_t (\"epoch\") value for today's date, in 2016, use</p>\n\n<pre><code>Tm.tm_year = 2016 - 1900;\n</code></pre>\n\n<p>(which will give it the value 116).</p>\n\n<p>One more question: Are you <em>sure</em> when you ran this code it computed <code>epoch</code> as 1458651818?  1458651818 corresponds to yesterday!  It has nothing to do with the year 1946, and it's not the answer I'd expect based on your <code>uint32_t</code> mistake, either.</p>\n\n<p>(By the way, what system are you using?  Not all systems necessarily use a base year of 1970.)</p>\n"}, {"tags": [], "owner": {"reputation": 1683, "user_id": 1135541, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/fkFuj.jpg?s=128&g=1", "display_name": "user1135541", "link": "https://stackoverflow.com/users/1135541/user1135541"}, "is_accepted": true, "score": 0, "last_activity_date": 1461160318, "creation_date": 1461160318, "answer_id": 36746008, "question_id": 36179728, "link": "https://stackoverflow.com/questions/36179728/mktime-is-not-converting-to-the-right-date-why/36746008#36746008", "title": "mktime is not converting to the right date, why?", "body": "<p>The C language does not specify the epoch year and leaves it up to library implementation. I was assuming the EPOCH is 1970, but the particular library I was using sets their epoch to 1900. This resolved the issue.</p>\n"}], "owner": {"reputation": 1683, "user_id": 1135541, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/fkFuj.jpg?s=128&g=1", "display_name": "user1135541", "link": "https://stackoverflow.com/users/1135541/user1135541"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "accepted_answer_id": 36746008, "answer_count": 2, "score": -2, "last_activity_date": 1461160344, "creation_date": 1458740166, "last_edit_date": 1461160344, "question_id": 36179728, "link": "https://stackoverflow.com/questions/36179728/mktime-is-not-converting-to-the-right-date-why", "title": "mktime is not converting to the right date, why?", "body": "<p>Using standard mktime() function from time.h library</p>\n\n<pre><code>tm Tm;\nTm.tm_year = 46;\nTm.tm_mon = 3-1;  // since month start with zero\nTm.tm_mday = 23;\nTm.tm_hour = 9;\nTm.tm_min = 3;\nTm.tm_sec = 38;\n\nuint32_t epoch = mktime(&amp;Tm);\n</code></pre>\n\n<p><code>epoch</code> is 1458651818\ngoing to: <a href=\"http://www.epochconverter.com\" rel=\"nofollow\">http://www.epochconverter.com</a>  and entering 1458651818</p>\n\n<p>outputs:</p>\n\n<p>Tue 22 Mar 2016 09:03:38 AM EDT GMT-4:00 DST</p>\n\n<p>I am setting day <code>Tm.tm_day = 23;</code>, not 22, why is my epoch converting to 23rd? What is the recommended way to fix it?</p>\n"}, {"tags": ["java", "c++", "c", "arrays", "programming-languages"], "comments": [{"owner": {"reputation": 3213, "user_id": 6084430, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/B0TaE.jpg?s=128&g=1", "display_name": "DimChtz", "link": "https://stackoverflow.com/users/6084430/dimchtz"}, "edited": false, "score": 0, "creation_date": 1458739535, "post_id": 36179444, "comment_id": 59993956, "body": "Yes, it is guaranteed (as far as I know)"}, {"owner": {"reputation": 182833, "user_id": 2970947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HAq55.png?s=128&g=1", "display_name": "Elliott Frisch", "link": "https://stackoverflow.com/users/2970947/elliott-frisch"}, "edited": false, "score": 7, "creation_date": 1458739594, "post_id": 36179444, "comment_id": 59994000, "body": "It would be very difficult to program in a language where that wasn&#39;t guaranteed."}, {"owner": {"reputation": 10501, "user_id": 4070469, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/OKYPb.png?s=128&g=1", "display_name": "Mauker", "link": "https://stackoverflow.com/users/4070469/mauker"}, "edited": false, "score": 0, "creation_date": 1458739717, "post_id": 36179444, "comment_id": 59994090, "body": "Indeed it would. Good point."}, {"owner": {"reputation": 1050, "user_id": 4720292, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ab9634db96cbb4bc54c10cbe276ae411?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/4720292/pierre"}, "edited": false, "score": 0, "creation_date": 1458739745, "post_id": 36179444, "comment_id": 59994104, "body": "@everyone : is there any reason for which they may be inserted in another order ? (eventually langage depedant)"}, {"owner": {"reputation": 10501, "user_id": 4070469, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/OKYPb.png?s=128&g=1", "display_name": "Mauker", "link": "https://stackoverflow.com/users/4070469/mauker"}, "edited": false, "score": 0, "creation_date": 1458739791, "post_id": 36179444, "comment_id": 59994143, "body": "This was a discussion I had with some colleagues, and I wasn&#39;t 100% if this was true."}, {"owner": {"reputation": 3213, "user_id": 6084430, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/B0TaE.jpg?s=128&g=1", "display_name": "DimChtz", "link": "https://stackoverflow.com/users/6084430/dimchtz"}, "reply_to_user": {"reputation": 1050, "user_id": 4720292, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ab9634db96cbb4bc54c10cbe276ae411?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/4720292/pierre"}, "edited": false, "score": 0, "creation_date": 1458739793, "post_id": 36179444, "comment_id": 59994146, "body": "@Pierre Maybe c++ or java wants to troll us"}, {"owner": {"reputation": 34901, "user_id": 3973077, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e80187d131859fc0601a01231fec657e?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Boddington", "link": "https://stackoverflow.com/users/3973077/paul-boddington"}, "edited": false, "score": 3, "creation_date": 1458740058, "post_id": 36179444, "comment_id": 59994350, "body": "I think if the behaviour was anything else it wouldn&#39;t get called an array."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 2, "creation_date": 1458740095, "post_id": 36179444, "comment_id": 59994383, "body": "If you use correct containers, yes. With some <i>dictionary</i>, it would be a different story."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1458740164, "post_id": 36179444, "comment_id": 59994431, "body": "Please ask two separate questions, one for Java, one for C++."}, {"owner": {"reputation": 10501, "user_id": 4070469, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/OKYPb.png?s=128&g=1", "display_name": "Mauker", "link": "https://stackoverflow.com/users/4070469/mauker"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1458740177, "post_id": 36179444, "comment_id": 59994441, "body": "@Jarod42 Maybe that&#39;s why one of my friends said that it was not always true."}, {"owner": {"reputation": 148364, "user_id": 501696, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/shkBF.png?s=128&g=1", "display_name": "Blackbelt", "link": "https://stackoverflow.com/users/501696/blackbelt"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1458740709, "post_id": 36179444, "comment_id": 59994788, "body": "@Jarod42 what do you mean by container?"}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1458740803, "post_id": 36179444, "comment_id": 59994854, "body": "What do you mean by &quot;inserted&quot;? Array elements don&#39;t get inserted."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1458741010, "post_id": 36179444, "comment_id": 59995024, "body": "Do arrays maintain their order, on the bedpost overnight?"}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 1, "creation_date": 1458741774, "post_id": 36179444, "comment_id": 59995663, "body": "perhaps the Befunge language could be said to be a language in which arrays don&#39;t keep their order. <a href=\"https://en.wikipedia.org/wiki/Befunge\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Befunge</a>"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 148364, "user_id": 501696, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/shkBF.png?s=128&g=1", "display_name": "Blackbelt", "link": "https://stackoverflow.com/users/501696/blackbelt"}, "edited": false, "score": 0, "creation_date": 1458742184, "post_id": 36179444, "comment_id": 59996003, "body": "@Blackbelt: As OP talks about <i>&quot;for any (or most of) the programming languages&quot;</i>, I group built-in array with more dedicated class/struct/.. of the language to handle that."}], "answers": [{"comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 1, "creation_date": 1458740202, "post_id": 36179734, "comment_id": 59994455, "body": "If you are quoting, please indicate what exactly are you quoting."}, {"owner": {"reputation": 597, "user_id": 4304746, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100005754678803/picture?type=large", "display_name": "Baroudi Safwen", "link": "https://stackoverflow.com/users/4304746/baroudi-safwen"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1458740282, "post_id": 36179734, "comment_id": 59994503, "body": "thx, i was about to but forgot to."}], "tags": [], "owner": {"reputation": 597, "user_id": 4304746, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100005754678803/picture?type=large", "display_name": "Baroudi Safwen", "link": "https://stackoverflow.com/users/4304746/baroudi-safwen"}, "is_accepted": true, "score": 6, "last_activity_date": 1458741876, "last_edit_date": 1458741876, "creation_date": 1458740171, "answer_id": 36179734, "question_id": 36179444, "link": "https://stackoverflow.com/questions/36179444/does-an-initialized-array-retain-its-order-in-c-c-and-similar-languages/36179734#36179734", "title": "Does an Initialized Array retain its order in C/C++ and similar languages?", "body": "<p>let us hear what the creators of C have to say about this:<br></p>\n\n<blockquote>\n  <p>An array may be initialized by following its declaration with a list\n  of initializers enclosed in braces and separated by commas. For\n  example, to initialize an array days with the number of days in each\n  month: <br><code>int days[] = { 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31 }</code>\n  <br> When the size of the array is omitted, the compiler will compute the\n  length by counting the initializers, of which there are 12 in this\n  case. If there are fewer initializers for an array than the specified\n  size, the others will be zero for external, static and automatic\n  variables. It is an error to have too many initializers. <br>There is no\n  way to specify repetition of an initializer, nor to initialize an\n  element in the middle of an array without supplying all the preceding\n  values as well. <br>Character arrays are a special case of initialization;\n  a string may be used instead of the braces and commas notation: <br><code>char pattern = \"ould\";</code> is a shorthand for the longer but equivalent<br> <code>char pattern[] = { 'o', 'u', 'l', 'd', '\\0' };</code> In this case, the array size\n  is five (four characters plus the terminating '\\0').</p>\n</blockquote>\n\n<p>C BY BRIAN W KERNIGHAN &amp; DENNIS M RITCHIE, second edition, page 95.</p>\n"}, {"tags": [], "owner": {"reputation": 1388, "user_id": 5837095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I7CdJ.png?s=128&g=1", "display_name": "Embedded C", "link": "https://stackoverflow.com/users/5837095/embedded-c"}, "is_accepted": false, "score": 2, "last_activity_date": 1458740279, "creation_date": 1458740279, "answer_id": 36179774, "question_id": 36179444, "link": "https://stackoverflow.com/questions/36179444/does-an-initialized-array-retain-its-order-in-c-c-and-similar-languages/36179774#36179774", "title": "Does an Initialized Array retain its order in C/C++ and similar languages?", "body": "<blockquote>\n  <p>It will be same in both the case</p>\n</blockquote>\n\n<p><code>int[] myArray = { 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 };</code></p>\n\n<p>It will just do</p>\n\n<pre><code>int[0] = 1\nint[1] = 2\n.\n.\n.\nint[9] = 10\n</code></pre>\n\n<p>It will not vary to language to language <code>int[] array</code> is ideal in <code>java</code> just for program convenience <code>int array[]</code> is allowed.</p>\n"}], "owner": {"reputation": 10501, "user_id": 4070469, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/OKYPb.png?s=128&g=1", "display_name": "Mauker", "link": "https://stackoverflow.com/users/4070469/mauker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "closed_date": 1458740973, "accepted_answer_id": 36179734, "answer_count": 2, "score": 2, "last_activity_date": 1458741876, "creation_date": 1458739496, "last_edit_date": 1495540772, "question_id": 36179444, "link": "https://stackoverflow.com/questions/36179444/does-an-initialized-array-retain-its-order-in-c-c-and-similar-languages", "closed_reason": "Needs more focus", "title": "Does an Initialized Array retain its order in C/C++ and similar languages?", "body": "<p><strong>Say that I have an Array in C/C++:</strong></p>\n\n<pre><code>int myArray[10] = { 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 };\n</code></pre>\n\n<p><strong>Same in Java:</strong></p>\n\n<pre><code>int[] myArray = { 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 };\n</code></pre>\n\n<p>And the equivalent in other programming languages.</p>\n\n<p>Is it guaranteed that the elements will be always in the same order I've typed on the initialization? E.g.: <code>1, 2, 3, 4, 5, 6, 7, 8, 9, 10</code>.</p>\n\n<hr>\n\n<p><strong>Note:</strong> I've already asked <a href=\"https://stackoverflow.com/questions/34733278/does-an-initialized-array-retain-its-order\">this question</a> specific to the Java programming language and I know it's true. But I wonder if this behavior is a rule for any (or most of) the programming languages, and I wasn't sure if an edit was the best way to ask that.</p>\n"}, {"tags": ["c", "debugging", "segmentation-fault"], "comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1458744247, "post_id": 36179391, "comment_id": 59997706, "body": "The problem is in your latest edit, you created two variations of the string variable:  <code>char *string_</code>, then you use <code>string</code> everywhere else.  Make them both the same."}], "answers": [{"tags": [], "owner": {"reputation": 283736, "user_id": 298479, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc66db28aa7c3fa8e4ce4238b696dee9?s=128&d=identicon&r=PG", "display_name": "ThiefMaster", "link": "https://stackoverflow.com/users/298479/thiefmaster"}, "is_accepted": false, "score": 0, "last_activity_date": 1458739604, "creation_date": 1458739604, "answer_id": 36179490, "question_id": 36179391, "link": "https://stackoverflow.com/questions/36179391/decrypt-and-encrypt-text-with-command-line-arguments/36179490#36179490", "title": "decrypt and encrypt text with command line arguments", "body": "<pre><code>char *string;\nchar encrypted_string[strlen(string)];\nchar decrypted_string[strlen(string)];\n</code></pre>\n\n<p>This results in undefined behavior - you try to get the length of an uninitialized piece of memory (I'm amazed that your program doesn't crash). You may only call <code>strlen</code> after assigning something to <code>string</code>.</p>\n\n<p>The easiest fix (assuming you don't want to start using <code>malloc</code>, <code>strdup</code>, etc.) would be moving the last two lines after <code>string = argv[1];</code></p>\n\n<p>Also, you need to check <code>argc</code> to make sure enough arguments have been passed!</p>\n"}, {"comments": [{"owner": {"reputation": 16565, "user_id": 3235496, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d8ea8f12cc0983b9b878120f7d052e42?s=128&d=identicon&r=PG", "display_name": "manlio", "link": "https://stackoverflow.com/users/3235496/manlio"}, "edited": false, "score": 0, "creation_date": 1458743454, "post_id": 36179769, "comment_id": 59997030, "body": "Merging two answers isn&#39;t always the best option :-). +1"}], "tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": false, "score": 1, "last_activity_date": 1458744736, "last_edit_date": 1458744736, "creation_date": 1458740260, "answer_id": 36179769, "question_id": 36179391, "link": "https://stackoverflow.com/questions/36179391/decrypt-and-encrypt-text-with-command-line-arguments/36179769#36179769", "title": "decrypt and encrypt text with command line arguments", "body": "<blockquote>\n  <p>warning: 'string' is used uninitialized in this function\n  [-Wuninitialized]</p>\n</blockquote>\n\n<p><code>char *string;</code> creates a pointer to char.  At this point it is not yet a string, but you are using it as a string argument.  </p>\n\n<p>Before using <code>char *string;</code> it must have memory assigned, and should be initialized.  Among other methoods, this <em>can</em> be done by:</p>\n\n<pre><code>char *string = calloc(80, 1);//initializes with known values (NULL).  \n</code></pre>\n\n<p>Now <code>string</code> is usable, but has zero length.  Values can be assigned via string functions:</p>\n\n<pre><code>strcpy(string, argv[1]);\nsprintf(string, \"%s\", argv[1]);\nstrcat(string, argv[1]);\n</code></pre>\n\n<p>... <em><a href=\"http://www.cplusplus.com/reference/cstring/\" rel=\"nofollow\">more string functions</a></em>  </p>\n\n<p>When using input from command line, <code>argv, argc</code>, <code>malloc/calloc</code> and string cpy functions can be avoided by using <code>strdup</code>.  a value can be assigned like this:</p>\n\n<pre><code>if(argc == 2)\n{\n    char *string = strdup(argv[1]);\n    if(!string) return -1;\n    ...\n</code></pre>\n\n<p><em>EDIT</em>  (addressing your OP edit)<br>\nYou are now using two different variables:  <code>string_</code> and <code>string</code>  </p>\n\n<pre><code>char *string_ = calloc(80, 1);\n            ^\nstring = argv[1];\n</code></pre>\n\n<p>Make them the same throughout your code and it should build and run.</p>\n"}, {"tags": [], "owner": {"reputation": 16565, "user_id": 3235496, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d8ea8f12cc0983b9b878120f7d052e42?s=128&d=identicon&r=PG", "display_name": "manlio", "link": "https://stackoverflow.com/users/3235496/manlio"}, "is_accepted": true, "score": 0, "last_activity_date": 1458744365, "last_edit_date": 1495540770, "creation_date": 1458741542, "answer_id": 36180282, "question_id": 36179391, "link": "https://stackoverflow.com/questions/36179391/decrypt-and-encrypt-text-with-command-line-arguments/36180282#36180282", "title": "decrypt and encrypt text with command line arguments", "body": "<p>When a meaningful value for the variable can be determined, try to declare and initialize the variable in one step:</p>\n\n<pre><code>char *string = argv[1];\nchar encrypted_string[strlen(string)];\nchar decrypted_string[strlen(string)];\nchar *key_ch = argv[2];\nchar key_int = atoi(key_ch);\n</code></pre>\n\n<p>This will fix the warning: you were trying to get the length of an uninitialized string.</p>\n\n<p>(here assuming C99. <code>char encrypted_string[strlen(string)]</code> is a <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Variable-Length.html\" rel=\"nofollow noreferrer\">VLA</a>. If you're restricted to C89 only <a href=\"https://stackoverflow.com/a/36179769/3235496\">Rykker's answer</a> works).</p>\n\n<p>Also:</p>\n\n<ul>\n<li><p>use <code>const</code> to prevent unwanted modifications, e.g.</p>\n\n<pre><code>const char *string = argv[1];\n/* ... */\nconst char *key_ch = argv[2]\n</code></pre></li>\n<li><p><code>string</code> is a constant so you can get its length just one time (do not recalculate the length every time... take a look at <a href=\"http://www.joelonsoftware.com/articles/fog0000000319.html\" rel=\"nofollow noreferrer\">Shlemiel the painter's algorithm</a>). So</p>\n\n<pre><code>const char *string = argv[1];\nconst int length = strlen(string);\n\nchar encrypted_string[length];\nchar decrypted_string[length];\n\nconst char *key_ch = argv[2];\nchar key_int = atoi(key_ch);\n</code></pre></li>\n<li><p>check inputs: what happen if</p>\n\n<ul>\n<li><code>argc &lt; 4</code></li>\n<li><code>argv[3]</code> isn't in (\"encrypt\", \"decrypt\")</li>\n<li><code>key_ch</code> is not a number</li>\n<li><code>key_int</code> is too big</li>\n</ul></li>\n<li><p>you're printing <code>encrypted_string</code> / <code>decryped_string</code> one character at a time... and it works, but consider that if you want to manipulate them as 'strings' they aren't null terminated and their length isn't correct.</p></li>\n<li><p><em>don't repeat yourself</em>. The differences between the encryption and the decryption phases are minimal: you can use just one buffer and change <code>key_int</code> to a negative value to decrypt.</p></li>\n</ul>\n"}], "owner": {"reputation": 31, "user_id": 5995228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb17529a8f3010bd61adead545592bd8?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/5995228/rob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 864, "favorite_count": 0, "accepted_answer_id": 36180282, "answer_count": 3, "score": 1, "last_activity_date": 1458745387, "creation_date": 1458739354, "last_edit_date": 1458745387, "question_id": 36179391, "link": "https://stackoverflow.com/questions/36179391/decrypt-and-encrypt-text-with-command-line-arguments", "title": "decrypt and encrypt text with command line arguments", "body": "<p>I am trying to make a program that will encrypt and decrypt when user enters the string they want to encrypt/decrypt for <code>argv[2]</code> and enters either \"encrypt\" or \"decrypt\" for <code>argv[3]</code>. Here is the code I am trying to compile and run as of now</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\nint main(int argc, char **argv)\n{\n    int i;\n    // char *string;\n    char *key_ch;\n    char  key_int;\n    char *string_ = calloc(80, 1);\n    string = argv[1];\n    char encrypted_string[strlen(string)];\n    char decrypted_string[strlen(string)];\n    //char *key_ch;\n    //char key_int;\n    string = argv[1];\n    key_ch = argv[2];\n    key_int = atoi(key_ch);\n\n    if (argc &lt; 3)\n    {\n       printf(\"Not enough arguments!\\n\");\n       exit (1);\n    }\n\n    if (strcmp(argv[3], \"encrypt\") == 0)\n    {\n            i = 0;\n            while(i &lt;= strlen(string)-1)\n            {\n                    encrypted_string[i] = string[i] + key_int;\n                    i++;\n            }\n\n    //      printf(\"Encrypted string: \");\n            i = 0;\n            while (i &lt;= strlen(string) -1)\n            {\n                    printf(\"%c\", encrypted_string[i]);\n                    i++;\n            }\n            printf(\"\\n\");\n    }\n    if (strcmp(argv[3], \"decrypt\") == 0)\n    {\n            i = 0;\n            while(i &lt;= strlen(string) -1)\n            {\n                    decrypted_string[i] = string[i] - key_int;\n                    i++;\n            }\n\n    //      printf(\"Decrypted String: \");\n            i = 0;\n            while (i &lt;= strlen(string) -1)\n            {\n                    printf(\"%c\", decrypted_string[i]);\n                    i++;\n            }\n\n            printf(\"\\n\");\n\n    }\n    return 0;\n}\n</code></pre>\n\n<p>When I try to compile it without the <code>-Wall</code> command it compiles fine but when I run the program I am getting a segmentation fault, when I compile with <code>-Wall</code> I am getting</p>\n\n<blockquote>\n  <p>sam0.c:9:24: warning: 'string' is used uninitialized in this function [-Wuninitialized]</p>\n  \n  <p>char encrypted_string[strlen(string)];</p>\n</blockquote>\n\n<p><strong>Can anyone possible shine some light on this error?</strong> Thank you</p>\n\n<p><strong>Edit:</strong>\nChanged my code to your suggestions. I am not getting a compiling error at all even when using \"-Wall\" however somewhere in my program it is causing me to get a segmentation fault... any ideas? I put quotes around where I changed my code for reference in case I did it wrong.</p>\n"}, {"tags": ["java", "android", "c", "android-assets"], "comments": [{"owner": {"reputation": 905471, "user_id": 115145, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/wDnd8.png?s=128&g=1", "display_name": "CommonsWare", "link": "https://stackoverflow.com/users/115145/commonsware"}, "edited": false, "score": 4, "creation_date": 1458737073, "post_id": 36178522, "comment_id": 59992157, "body": "&quot;I know while installing apk android copy assets file to /data/data/com.packagename/something&quot; -- and your proof of this is, what, exactly? AFAIK, assets are not files on the device, but remain packaged in the APK."}], "answers": [{"tags": [], "owner": {"reputation": 28120, "user_id": 492773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4c30dea4ed3e1c2efc5e877f1f3c971?s=128&d=identicon&r=PG", "display_name": "kichik", "link": "https://stackoverflow.com/users/492773/kichik"}, "is_accepted": true, "score": 6, "last_activity_date": 1459141594, "creation_date": 1459141594, "answer_id": 36256296, "question_id": 36178522, "link": "https://stackoverflow.com/questions/36178522/fopen-in-jni-c-code-get-failed-for-file-placed-in-assets-folder-in-android-appli/36256296#36256296", "title": "fopen in JNI C code get failed for file placed in assets folder in android application", "body": "<p>You can use the asset manager to access assets in JNI code. It's part of NDK.</p>\n\n<p><a href=\"http://developer.android.com/ndk/reference/group___asset.html\">http://developer.android.com/ndk/reference/group___asset.html</a></p>\n\n<p>Something like:</p>\n\n<pre><code>EXPORT_API void LoadAsset(char* filename, jobject assetManager){\n    AAssetManager* mgr = AAssetManager_fromJava(env, assetManager);\n    AAsset* asset = AAssetManager_open(mgr, filename, AASSET_MODE_BUFFER);\n    AAsset_read(asset, ...);\n}\n</code></pre>\n\n<p>And then in Java something like:</p>\n\n<pre><code>LoadAsset(\"myfile\", getContext().getAssetManager());\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 147, "user_id": 4008701, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/39a6ac36d8f662bfb304a36b50482162?s=128&d=identicon&r=PG&f=1", "display_name": "Cody Richardson", "link": "https://stackoverflow.com/users/4008701/cody-richardson"}, "is_accepted": false, "score": 0, "last_activity_date": 1459455861, "creation_date": 1459455861, "answer_id": 36343062, "question_id": 36178522, "link": "https://stackoverflow.com/questions/36178522/fopen-in-jni-c-code-get-failed-for-file-placed-in-assets-folder-in-android-appli/36343062#36343062", "title": "fopen in JNI C code get failed for file placed in assets folder in android application", "body": "<p>One way I've found is to write a test line in the code, something like:</p>\n\n<pre><code>System.out.println(\"Working Directory = \" +\n              System.getProperty(\"user.dir\"));\n</code></pre>\n\n<p>Now, if you know where your assets are stored by Android, <code>/data/data/com.packagename/assets/file.png</code>, for example, then you will know the reletive or absolute path to the assets. I hope this works for you, it helped me!</p>\n"}], "owner": {"reputation": 23469, "user_id": 775964, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/glHLl.jpg?s=128&g=1", "display_name": "Jeegar Patel", "link": "https://stackoverflow.com/users/775964/jeegar-patel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1190, "favorite_count": 3, "accepted_answer_id": 36256296, "answer_count": 2, "score": 8, "last_activity_date": 1459455861, "creation_date": 1458736952, "last_edit_date": 1458738149, "question_id": 36178522, "link": "https://stackoverflow.com/questions/36178522/fopen-in-jni-c-code-get-failed-for-file-placed-in-assets-folder-in-android-appli", "title": "fopen in JNI C code get failed for file placed in assets folder in android application", "body": "<p>I have kept some files in assets folder of android application.</p>\n\n<p>Now i compile that application and get apk. [when i extract that apk my files are there in assets folder] </p>\n\n<p>Now i install that apk in mobile device </p>\n\n<p>and in That application has some code in c programing with JNI interface.</p>\n\n<p>Now my <code>fopen()</code> call in c programming for that file get failed.</p>\n\n<pre><code>fopen(\"myfile\",\"r\");\n</code></pre>\n\n<p>I know while installing apk android copy assets file to <code>/data/data/com.packagename/something</code> </p>\n\n<p>So does anyone knows that path so i can give it in <code>fopen()</code> </p>\n\n<p>or is there any other method to open that file in C programming.</p>\n\n<hr>\n\n<p>If i keep those files in sdcard folder and access like <code>fopen(\"/sdcard/myfile\",\"r\");</code> then it works file. But i want to keep those files in assets folder only</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 1, "creation_date": 1458736382, "post_id": 36178260, "comment_id": 59991665, "body": "Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. The given code doesn&#39;t have any problem."}, {"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "reply_to_user": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 0, "creation_date": 1458736485, "post_id": 36178260, "comment_id": 59991727, "body": "@CoolGuy ...except that it&#39;s not in a function."}, {"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "reply_to_user": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 0, "creation_date": 1458736671, "post_id": 36178260, "comment_id": 59991866, "body": "@JonathonReinhart Now that the OP has posted the full code, it seems that you are right. :-)"}, {"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "reply_to_user": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 0, "creation_date": 1458736737, "post_id": 36178260, "comment_id": 59991915, "body": "@CoolGuy I was thinking that, for once, that <i>was</i> the full code!"}, {"owner": {"reputation": 3, "user_id": 3943840, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001571802268/picture?type=large", "display_name": "ehfi98u34yf87", "link": "https://stackoverflow.com/users/3943840/ehfi98u34yf87"}, "edited": false, "score": 0, "creation_date": 1458736773, "post_id": 36178260, "comment_id": 59991944, "body": "Derp. Thanks heaps guys!"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 3943840, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001571802268/picture?type=large", "display_name": "ehfi98u34yf87", "link": "https://stackoverflow.com/users/3943840/ehfi98u34yf87"}, "edited": false, "score": 0, "creation_date": 1458736846, "post_id": 36178403, "comment_id": 59991986, "body": "Thanks heaps. That was a silly mistake..."}], "tags": [], "owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "is_accepted": true, "score": 2, "last_activity_date": 1458736604, "creation_date": 1458736604, "answer_id": 36178403, "question_id": 36178260, "link": "https://stackoverflow.com/questions/36178260/code-composer-studio-171-expected-a-declaration-error/36178403#36178403", "title": "Code Composer Studio &#39;#171 expected a declaration&#39; error", "body": "<p>Assuming you actually posted your complete code, you  can't throw statements in the global namespace - when would they run? They need to be in a function. Any introduction to C will tell you that execution starts in <code>main</code>.</p>\n\n<pre><code>int main (void)\n{\n\n    return 0;\n}\n</code></pre>\n\n<p>If you're just getting started with C, it would behoove you to learn to write basic console applications on a desktop environment first, before moving to an MCU.</p>\n"}], "owner": {"reputation": 3, "user_id": 3943840, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001571802268/picture?type=large", "display_name": "ehfi98u34yf87", "link": "https://stackoverflow.com/users/3943840/ehfi98u34yf87"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1510, "favorite_count": 0, "closed_date": 1458768397, "accepted_answer_id": 36178403, "answer_count": 1, "score": 0, "last_activity_date": 1458736624, "creation_date": 1458736232, "last_edit_date": 1458736624, "question_id": 36178260, "link": "https://stackoverflow.com/questions/36178260/code-composer-studio-171-expected-a-declaration-error", "closed_reason": "Not suitable for this site", "title": "Code Composer Studio &#39;#171 expected a declaration&#39; error", "body": "<p>I am receiving an error '#171 expected a declaration' when building my project. Below is the code that seems to be causing the problem. Any help or suggestions would be greatly appreciated. Thanks.</p>\n\n<pre><code>#include \"stdbool.h\"\n#include \"stdint.h\"\n#include \"inc/hw_i2c.h\"\n#include \"inc/hw_memmap.h\"\n#include \"inc/hw_types.h\"\n#include \"driverlib/gpio.h\"\n#include \"driverlib/i2c.h\"\n#include \"driverlib/pin_map.h\"\n#include \"driverlib/sysctl.h\"\n#include \"driverlib/uart.h\"\n#include \"utils/uartstdio.h\"\n\n#include \"stdlib.h\"\n#include \"math.h\"\n#include \"time.h\"\n\n#define SLAVE_ADDRESS 0x5A\n#define SQUARE_WAVE 0\n#define TRIANGULAR_WAVE 1\n#define SAWTOOTH_WAVE 2\n#define SINE_WAVE 3\n#define RANDOM_NOISE 4\n\nvoid InitConsole(void) {\n\n    SysCtlPeripheralEnable(SYSCTL_PERIPH_GPIOA);\n    GPIOPinConfigure(GPIO_PA0_U0RX);\n    GPIOPinConfigure(GPIO_PA1_U0TX);\n    SysCtlPeripheralEnable(SYSCTL_PERIPH_UART0);\n    UARTClockSourceSet(UART0_BASE, UART_CLOCK_PIOSC);\n    GPIOPinTypeUART(GPIO_PORTA_BASE, GPIO_PIN_0 | GPIO_PIN_1);\n    UARTStdioConfig(0, 115200, 16000000);\n}\n\nint i = 0;\nint sawTable[1023];\n\nfor (i = 0; i &lt; 1023; i++) &lt;--- The error is on this line\n    sawTable[i] = i;\n</code></pre>\n"}, {"tags": ["c", "sockets", "time", "udp", "measure"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1458737299, "post_id": 36178105, "comment_id": 59992326, "body": "I suggest using <code>double</code> and not <code>float</code>, seeing as the range of number is so great between seconds and nanoseconds. <code>timed = 1e-9 * (ts2.tv_nsec - ts1.tv_nsec) + ts2.tv_sec - ts1.tv_sec;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1632, "user_id": 875023, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0bf3d8b5bd7da63e35beb9006b7f8c7c?s=128&d=identicon&r=PG", "display_name": "G&#225;bor Buella", "link": "https://stackoverflow.com/users/875023/g%c3%a1bor-buella"}, "edited": false, "score": 0, "creation_date": 1458737573, "post_id": 36178684, "comment_id": 59992562, "body": "Yup, I tried the code, and the only time I get negative result, is if I erroneously print the float value as an int : <code>printf(&quot;%d&quot;, timef)</code> There is no need for floating point here, it just leads so such silly mistakes."}, {"owner": {"reputation": 21, "user_id": 6104051, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfa943dcde30fb11f752af4c2b9e54e6?s=128&d=identicon&r=PG&f=1", "display_name": "ampu", "link": "https://stackoverflow.com/users/6104051/ampu"}, "edited": false, "score": 0, "creation_date": 1458741924, "post_id": 36178684, "comment_id": 59995786, "body": "My complete code write measures into a files (dataserver.txt and data.txt) and then I process them with Matlab, but is easy to see in files without processing that there are measures in server file which are bigger than measures in client file, making negative the subtraction Tt= Tclient-Tserver.  Maybe the error is writing to file...  When I back to home I am going to paste the full code here.  Thank you guys!"}, {"owner": {"reputation": 21, "user_id": 6104051, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfa943dcde30fb11f752af4c2b9e54e6?s=128&d=identicon&r=PG&f=1", "display_name": "ampu", "link": "https://stackoverflow.com/users/6104051/ampu"}, "edited": false, "score": 0, "creation_date": 1458759227, "post_id": 36178684, "comment_id": 60008124, "body": "With this code I get bigger client measures so I never get negative values when subtract server measure, but I am not sure what does the format number in both printf, because I get warnings and I have never seen  %u.%09lld format before"}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1458766436, "post_id": 36178684, "comment_id": 60012259, "body": "The printf format string is displaying two values: <code>%u</code> is an <code>unsigned int</code>, <code>%09lld</code> is a <code>long long</code>, displayed with a width of 9 characters zero-filled to the left.  This is just a trick to show a number with a fixed-sized decimal part without using floating point values.  It doesn&#39;t use machine locale, however, and so is always showing a period to separate the whole part fractional part.  Don&#39;t get too caught up on that.  What warnings do you get?"}, {"owner": {"reputation": 21, "user_id": 6104051, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfa943dcde30fb11f752af4c2b9e54e6?s=128&d=identicon&r=PG&f=1", "display_name": "ampu", "link": "https://stackoverflow.com/users/6104051/ampu"}, "edited": false, "score": 0, "creation_date": 1459189794, "post_id": 36178684, "comment_id": 60164396, "body": "I have posted a message with time format warnings which I get"}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1459201600, "post_id": 36178684, "comment_id": 60170525, "body": "Then adjust the modifiers accordingly.  The warning clearly tells you that on your system both of these types are aliased to <code>long int</code>.  So use <code>%ld.%09ld</code>.  Like I said, don&#39;t get caught up on my <code>printf</code> statement, as that wasn&#39;t the important part of my answer."}, {"owner": {"reputation": 21, "user_id": 6104051, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfa943dcde30fb11f752af4c2b9e54e6?s=128&d=identicon&r=PG&f=1", "display_name": "ampu", "link": "https://stackoverflow.com/users/6104051/ampu"}, "edited": false, "score": 0, "creation_date": 1459278578, "post_id": 36178684, "comment_id": 60211265, "body": "I have changed printf statements according to my data type (%ld.%09ld) and I get the same measures than my original code so it gives me negative measures again.... what is happening? Please help!!"}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1459288387, "post_id": 36178684, "comment_id": 60216575, "body": "Maybe <a href=\"http://stackoverflow.com/q/3523442/1553090\">this is related</a>.  Otherwise print out the actual values of the two <code>timespec</code> stamps and work out yourself what is happening."}, {"owner": {"reputation": 21, "user_id": 6104051, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfa943dcde30fb11f752af4c2b9e54e6?s=128&d=identicon&r=PG&f=1", "display_name": "ampu", "link": "https://stackoverflow.com/users/6104051/ampu"}, "edited": false, "score": 0, "creation_date": 1459494661, "post_id": 36178684, "comment_id": 60320897, "body": "@paddy I have tested with CLOCK_MONOTONIC like the related post, but I get the same results. This line: diff.tv_nsec += 1000000000LL; within condition if(diff.tv_nsec &lt; 0) works with long int?"}], "tags": [], "owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "is_accepted": false, "score": 0, "last_activity_date": 1458738764, "last_edit_date": 1458738764, "creation_date": 1458737353, "answer_id": 36178684, "question_id": 36178105, "link": "https://stackoverflow.com/questions/36178105/time-measure-udp-socket-c/36178684#36178684", "title": "Time measure UDP socket C", "body": "<p>You might be getting problems with converting these numbers to floating point.  Try computing the difference into a suitably large <em>integer</em> datatype.  At least to begin with, and then work back from there.</p>\n\n<pre><code>const int64_t NANO = 1000000000LL;\nint64_t nsec = (int64_t)(ts2.tv_sec - ts1.tv_sec) * NANO;\nnsec += (int64_t)(ts2.tv_nsec - ts1.tv_nsec);\nprintf( \"Elapsed: %lld.%09lld secs\\n\", nsec / NANO, nsec % NANO );\n</code></pre>\n\n<p>If you wanted a float out of that, beware that single-precision is pretty limited.  You may be able to clamp it to microseconds, but for longer intervals you might not get microsecond resolution.</p>\n\n<pre><code>timef = (float)(nsec / 1000LL) * 1e-6f;\n</code></pre>\n\n<p>Better to use double:</p>\n\n<pre><code>double timef;\ntimef = (double)nsec * 1e-9;\n</code></pre>\n\n<p>Of course, you could just use a timespec itself:</p>\n\n<pre><code>struct timespec diff;\ndiff.tv_sec = ts2.tv_sec - ts1.tv_sec;\ndiff.tv_nsec = ts2.tv_nsec - ts1.tv_nsec;\nif( diff.tv_nsec &lt; 0 ) {\n    diff.tv_sec--;    \n    diff.tv_nsec += 1000000000LL;\n}\nprintf( \"Elapsed: %u.%09lld secs\\n\", diff.tv_sec, diff.tv_nsec );\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6104051, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfa943dcde30fb11f752af4c2b9e54e6?s=128&d=identicon&r=PG&f=1", "display_name": "ampu", "link": "https://stackoverflow.com/users/6104051/ampu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1110, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1459980014, "creation_date": 1458735809, "last_edit_date": 1459980014, "question_id": 36178105, "link": "https://stackoverflow.com/questions/36178105/time-measure-udp-socket-c", "title": "Time measure UDP socket C", "body": "<p>I\u00b4m trying to obtain the performance in a Client (PC i7 3.4 GHz Kubuntu 15.04) - Server (RaspberryPi 700 Mhz Raspbian Jessie) architecture with sockets,  measuring the spent time sending and receiving with at least microseconds precision.</p>\n\n<p>Concretely, I have a client (PC) that makes 100 times:</p>\n\n<ul>\n<li>Send UDP frame to server (Ta)</li>\n<li>Receive UDP frame from server (Tb)</li>\n<li>Spent time is: T=Tb-Ta</li>\n</ul>\n\n<p>and a server (RaspberryPi) that makes 100 times:</p>\n\n<ul>\n<li>Receive UDP frame from client(T1)</li>\n<li>Send UDP frame from client(T2)</li>\n<li>Spent time is: T'=T2-T1</li>\n</ul>\n\n<p>I\u00b4m measuring time before send and after receive in client and subtracting it the time taken in server to receive and send, so the total time would be: \nTt=T-T' \nbut sometimes I get negative measures... :S</p>\n\n<p>I\u00b4m measuring with this macro, where in 'X' I placed my code (C:sendto()-recvfrom() or S:recvfrom()-sendto()):</p>\n\n<pre><code>float timef=0.0;\n#define TIME_MEASURE(X)                                        \\\n{                                                              \\\n  struct timespec ts1, ts2;                                    \\\n  clock_gettime( CLOCK_REALTIME, &amp;ts1 );                       \\\n  X;                                                           \\\n  clock_gettime( CLOCK_REALTIME, &amp;ts2 );                       \\\n  timef=(float) ( 1.0*(1.0*ts2.tv_nsec - ts1.tv_nsec*1.0)*1e-9 \\\n    + 1.0*ts2.tv_sec - 1.0*ts1.tv_sec ) );                     \\\n}\n\n//Client pseudo-code example\n\nmain(){\n   TIME_MEASURE(\n       while(i&lt;100)\n       {\n           sendto(...);\n           recvfrom(..);\n       }\n   );\n}\n</code></pre>\n\n<p>I have to measure time in any case, so another solution to obtain performance is not valid for me.</p>\n\n<p>Can anyone suggest what can I do to solve this problem?</p>\n\n<p>Than you so much.</p>\n\n<p><strong>(V2. EDITED WITH 'int64_t' and 'double' VALUES)</strong></p>\n\n<p>Here is my full code.</p>\n\n<p>It can be downloaded from:<br>\nV1 - \n<a href=\"https://www.dropbox.com/sh/gb4mhn3amkyqhc1/AAC6FxKCfDxXQYgzRsjArvXQa?dl=0\" rel=\"nofollow\">https://www.dropbox.com/sh/gb4mhn3amkyqhc1/AAC6FxKCfDxXQYgzRsjArvXQa?dl=0</a></p>\n\n<p>V2 - \n<a href=\"https://www.dropbox.com/sh/byipa75qruc71gj/AAD2ExMlnQSaUk_Pbc5xR2lZa?dl=0\" rel=\"nofollow\">https://www.dropbox.com/sh/byipa75qruc71gj/AAD2ExMlnQSaUk_Pbc5xR2lZa?dl=0</a></p>\n\n<p>server.c:</p>\n\n<pre><code>    /****************************************\n * Servidor UDP. Recibe como argumento\n * en linea de comandos el numero de puerto. El servidor\n * se ejecuta en bucle\n ***************************************/\n#include &lt;sys/types.h&gt;\n#include &lt;netdb.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;arpa/inet.h&gt;\n#include &lt;pthread.h&gt;\n#define TAMANO 256\n\n#include &lt;sys/time.h&gt;\n#include &lt;math.h&gt;\n#include &lt;time.h&gt;\n\nvoid * ack();\nvoid error_fatal(char *); /* Imprime un mensaje de error y sale del programa */\n\n\n\n\nint sock, length, fromlen, n, i, j, port ;\nstruct sockaddr_in server;\nstruct sockaddr_in from;\nchar buffer[TAMANO];\n\nfloat timeArr;\nfloat timeVector[101];\ndouble timed;\n\n#define TIME_MEASURE(X)                                             \\\n{                                                                   \\\n    struct timespec ts1, ts2, diff;                                 \\\n    clock_gettime( CLOCK_REALTIME, &amp;ts1 );                          \\\n    X;                                                              \\\n    clock_gettime( CLOCK_REALTIME, &amp;ts2 );                          \\\n    timeArr= (float) ( 1.0*(1.0*ts2.tv_nsec - ts1.tv_nsec*1.0)*1e-9 \\\n     + 1.0*ts2.tv_sec - 1.0*ts1.tv_sec );                           \\\n     diff.tv_sec = ts2.tv_sec - ts1.tv_sec;                          \\\n     diff.tv_nsec = ts2.tv_nsec - ts1.tv_nsec;                       \\\n     if( diff.tv_nsec &lt; 0 ) {                                        \\\n         diff.tv_sec--;                                              \\\n         diff.tv_nsec += 1000000000LL;                               \\\n         }                                                               \\\n         printf( \"Elapsed: %u.%09lld secs\\n\", diff.tv_sec, diff.tv_nsec );\\\n         const int64_t NANO = 1000000000LL;                              \\\n         int64_t nsec = (int64_t)(ts2.tv_sec - ts1.tv_sec) * NANO;       \\\n         nsec += (int64_t)(ts2.tv_nsec - ts1.tv_nsec);                   \\\n         printf( \"Elapsed nsec: %lld.%09lld secs\\n\", nsec / NANO, nsec % NANO );\\\n         timed = (double)nsec * 1e-9;                                    \\\n         printf(\"nsec=%ld\\n\");                                           \\\n         }\\\n\nint main(int argc, char *argv[])\n{\n\n    timeArr=0.1;\n    i=0;\n    pthread_t recv;\n\n    FILE *f;\n\n\n\n\n    if (argc &lt; 2) \n    {\n        fprintf(stderr, \"ERROR, no se ha indicado el puerto \\n\");\n        exit(1);\n    }\n\n    /* obtain port number */\n    if (sscanf(argv[1], \"%d\", &amp;port) &lt;= 0)\n    {\n        fprintf(stderr, \"%s: error: wrong parameter: port\\n\", argv[0]);\n    return -2;\n    }\n\n    /* (1) creacion del socket del servidor*/\n    sock=socket(AF_INET, SOCK_DGRAM, 0);\n    if (sock &lt; 0) \n        error_fatal(\"Creando el socket\");\n\n    length = sizeof(server);\n    memset(&amp;server,0,length); /*limpio la direccion del socket del servidor*/\n\n    /* (2) vinculo la direccion IP y puerto local al socket creado anteriormente */\n    server.sin_family=AF_INET;\n    server.sin_addr.s_addr=INADDR_ANY;\n    server.sin_port=htons(port);\n\n    if (bind(sock,(struct sockaddr *)&amp;server,length)&lt;0)\n        error_fatal(\"binding\");\n\n    fromlen = sizeof(struct sockaddr_in);\n\n    /* (3) bucle principal. Pongo a recibir y responder mensajes a traves del socket*/\n    printf(\"Servidor listo y esperando tramas UDP en el puerto %d...\\n\", port);\n\n\n\n    while (1) \n    {\n        //el cliente manda una trama de prueba para no contar el tiempo de espera en el servidor\n        //client sends init frame and it is not counted\n        if(i==0)\n        {\n             //Recibo paquete de prueba para empezar a contar, desecho este tiempo\n            n = recvfrom(sock,buffer,TAMANO,0,(struct sockaddr *)&amp;from,&amp;fromlen);\n            pthread_create (&amp;recv, NULL,ack, &amp;fromlen);\n            i++;            \n\n        }\n        else\n        {\n\n            TIME_MEASURE(\n\n                n = recvfrom(sock,buffer,TAMANO,0,(struct sockaddr *)&amp;from,&amp;fromlen);\n\n                if (n &lt; 0) \n                    error_fatal(\"recvfrom\");\n                    /*datagrama recibido*/\n\n                pthread_create (&amp;recv, NULL,ack, &amp;fromlen);\n            );\n\n\n            timeVector[i]=(float)timeArr;\n\n            printf(\"timevector[%d] = %f\\n\", i, timeArr);\n\n            if(i==100)\n            {\n                f=fopen(\"dataserver.txt\", \"w+\");\n                printf(\"Se han recibido 100 tramas UDP\\n\\n\\n\");\n\n                for(j=0;j&lt;=100;j++)\n                {\n\n                    fprintf(f,\"%f\\n\",timeVector[j]);\n                    //printf(\"valores: %f\\n\",timeVector[j]);\n                }\n                i=0;\n                fclose(f);\n                memset(timeVector,0,100);\n            }\n            else\n            {\n                i++;   \n            }\n        }\n\n    }\n    return 0;\n}\n\nvoid *ack(void *ptr){\n\n    int *fl;\n\n    fl= (int *)ptr;\n    buffer[n]='\\0'; /* para poder imprimirlo con prinft*/\n    //printf(\"Recibido en el servidor: %s\\n\", buffer);\n\n    /*enviar respuesta*/\n    float t;\n\n    t=(float)timeArr;\n\n    //It is like an ACK, now I am not using this value\n    n = sendto(sock,&amp;t,sizeof(float),0,(struct sockaddr *)&amp;from,fromlen);\n\n    memset(buffer,0,TAMANO); \n    if (n &lt; 0) \n         error_fatal(\"sendto\"); \n\n    pthread_exit(NULL);\n}\n\nvoid error_fatal(char *msg)\n{\n perror(msg);\n exit(1);\n}\n</code></pre>\n\n<p>client.c</p>\n\n<pre><code>/*******************************************************************\n * Cliente de eco remoto sobre UDP:\n *\n * cliente dir_ip_maquina puerto\n ********************************************************************/\n#include &lt;sys/types.h&gt;\n#include &lt;netdb.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;arpa/inet.h&gt;\n#define TAMANO 256 /* tamano del buffer de recepcion */\n\n#include &lt;sys/time.h&gt;\n#include &lt;math.h&gt;\n#include &lt;time.h&gt;\n\nvoid error_fatal(char *); /* Imprime un mensaje de error y sale del programa */\n\nfloat timeArr;\nfloat timeVector[101];\nint i;\ndouble timed;\n\n\n\n#define TIME_MEASURE(X)                                             \\\n{                                                                   \\\n    struct timespec ts1, ts2, diff;                                 \\\n    clock_gettime( CLOCK_REALTIME, &amp;ts1 );                          \\\n    X;                                                              \\\n    clock_gettime( CLOCK_REALTIME, &amp;ts2 );                          \\\n    timeArr= (float) ( 1.0*(1.0*ts2.tv_nsec - ts1.tv_nsec*1.0)*1e-9 \\\n     + 1.0*ts2.tv_sec - 1.0*ts1.tv_sec );                           \\\n     diff.tv_sec = ts2.tv_sec - ts1.tv_sec;                          \\\n     diff.tv_nsec = ts2.tv_nsec - ts1.tv_nsec;                       \\\n     if( diff.tv_nsec &lt; 0 ) {                                        \\\n         diff.tv_sec--;                                              \\\n         diff.tv_nsec += 1000000000LL;                               \\\n         }                                                               \\\n         printf( \"Elapsed: %u.%09lld secs\\n\", diff.tv_sec, diff.tv_nsec );\\\n         const int64_t NANO = 1000000000LL;                              \\\n         int64_t nsec = (int64_t)(ts2.tv_sec - ts1.tv_sec) * NANO;       \\\n         nsec += (int64_t)(ts2.tv_nsec - ts1.tv_nsec);                   \\\n         printf( \"Elapsed nsec: %lld.%09lld secs\\n\", nsec / NANO, nsec % NANO );\\\n         timed = (double)nsec * 1e-9;                                    \\\n         printf(\"nsec=%ld\\n\");                                           \\\n         }\\\n\n\n\n/*\n * \n *    const int64_t NANO = 1000000000LL;                              \\\n    int64_t nsec = (int64_t)(ts2.tv_sec - ts1.tv_sec) * NANO;       \\\n    nsec += (int64_t)(ts2.tv_nsec - ts1.tv_nsec);                   \\\n    printf( \"Elapsed: %lld.%09lld secs\\n\", nsec / NANO, nsec % NANO );\\\n                                                                    \\\n\n                                                                    */\n\nint main(int argc, char *argv[])\n{\n    int sock; /* descriptor del socket del cliente */\n    int length, n, j, port;\n    struct sockaddr_in server, from; /* direcciones del socket del servidor y cliente */\n    struct hostent *hp; /* estructura para el nombre del servidor (ver gethostbyname) */\n    char buffer[TAMANO]; /* buffer de recepcion y envio del mensaje */\n    char buffercpy[TAMANO];\n    float bufferf[7];\n\n    FILE *f = fopen(\"data.txt\", \"w+\");\n    struct timespec spec;\n    clockid_t clk_id;\n\n    clk_id=CLOCK_REALTIME;\n    i=0;\n\n\n    if (argc != 3) \n    { \n        fprintf(stderr,\"Uso: ./client server port\\n\");\n        exit(1);\n    }\n\n    /* obtain port number */\n    if (sscanf(argv[2], \"%d\", &amp;port) &lt;= 0)\n    {\n    fprintf(stderr, \"%s: error: wrong parameter: port\\n\", argv[0]);\n    return -2;\n    }\n    printf(\"El cliente va a mandar por el puerto %d\\n\", port);\n\n    /* (1) creacion del socket UDP del cliente */\n    sock= socket(AF_INET, SOCK_DGRAM, 0); \n    if (sock &lt; 0)   \n        error_fatal(\"socket\");    \n    server.sin_family = AF_INET; /*dominio de Internet*/\n\n    /* (2) averigua la direccion IP a partir del nombre del servidor*/\n    hp = gethostbyname(argv[1]);\n    if (hp==0) \n        error_fatal(\"Host desconocido\");\n\n    /* (3) copia la IP resuelta anteriormente en la direccion del socket del servidor */\n    memcpy((char *)&amp;server.sin_addr,(char *)hp-&gt;h_addr,hp-&gt;h_length);\n\n   if ( clock_getres( clk_id, &amp;spec) == -1 )\n   {\n      perror( \"clock get resolution\" );\n      return EXIT_FAILURE;\n    }\n\n    //printf (\"CLOCK_REALTIME: %ld s, %ld ns\\n\", spec.tv_sec,spec.tv_nsec); \n\n    /* (4) copia el puerto destino en la direccion del socket del servidor */\n    server.sin_port = htons(port);\n    length=sizeof(struct sockaddr_in);\n\n    printf(\"Por favor, introduce el mensaje: \");\n        memset(buffer,0,TAMANO); /*limpio el buffer*/\n        fgets(buffer,TAMANO-1,stdin);\n        strcpy(buffercpy, buffer);//Copio el mensaje a un nuevo buffer para que se repita en el while\n\n\n    while(i&lt;=100)\n    {       \n        //client sends init frame and it is not counted\n        if(i==0)\n        {\n\n            /* (5) envia al socket del servidor el mensaje almacenado en el buffer*/\n            n=sendto(sock,buffer,strlen(buffer),0,(struct sockaddr *) &amp;server,length);\n            if (n &lt; 0) \n                error_fatal(\"Sendto\");\n\n            /* (6) lee del socket el mensaje de respuesta del servidor*/\n            n = recvfrom(sock,bufferf,sizeof(float),0,(struct sockaddr *) &amp;from, &amp;length);\n\n            if (n &lt; 0) \n                error_fatal(\"recvfrom\");\n            i++;\n\n        }\n        else\n        {\n\n\n\n\n            TIME_MEASURE(\n                memset(buffer, '\\0', sizeof(buffer));\n                strcpy(buffer, buffercpy);\n\n                /* (5) envia al socket del servidor el mensaje almacenado en el buffer*/\n                n=sendto(sock,buffer,strlen(buffer),0,(struct sockaddr *) &amp;server,length);\n                if (n &lt; 0) \n                    error_fatal(\"Sendto\");\n\n                /* (6) lee del socket el mensaje de respuesta del servidor*/\n                n = recvfrom(sock,bufferf,sizeof(float),0,(struct sockaddr *) &amp;from, &amp;length);\n\n                if (n &lt; 0) \n                    error_fatal(\"recvfrom\");\n\n            );\n\n            timeVector[i]=(float)timeArr;\n            printf(\"Tiempo de procesamiento cliente - timeVector [%d]: %f\\n\", i,timeArr);\n\n            //timeVector[i]+=(float)(0.0 - *bufferf);\n            //printf(\"timeVector negativo[%d]= %f\\n\", i, timeVector[i]);\n            buffer[n]='\\0'; /* para poder imprimirlo con printf*/\n            bufferf[n]='\\0'; /* para poder imprimirlo con printf*/\n            //printf(\"Recibido en el cliente: %f ACK(%d)%c\\n\",*bufferf,i,'\\0');\n\n\n            printf(\"timeVector TOTAL= %f\\n\\n\", timeVector[i]);\n            //printf(\"buffer=%s%c\\n\",buffer,'\\0');\n\n            if(i==100){\n                for(j=1;j&lt;=100;j++){\n                    fprintf(f,\"%f\\n\",timeVector[j]);\n                        //printf(\"valores: %f\\n\",timeVector[j]);\n                }\n                printf(\"Se han enviado 100 tramas UDP \\n\\n\\n\");\n\n            }\n            i++;\n        }\n    }\n\n    fclose(f);\n    /*cerramos el socket*/\n    if(close(sock) &lt; 0) \n        error_fatal(\"close\");\n}\n\nvoid error_fatal(char *msg)\n{\n    perror(msg);\n    exit(1);\n}\n</code></pre>\n\n<p>I get warnings in number formats, so I think that it is probably that printed values wouldn't be correct.</p>\n\n<p>These are warnings which I get:  </p>\n\n<pre><code>server.c: In function \u2018main\u2019:\nserver.c:50:18: warning: format \u2018%u\u2019 expects argument of type \u2018unsigned int\u2019, but argument 2 has type \u2018__time_t {aka long int}\u2019 [-Wformat=]\n          printf( \"Elapsed: %u.%09lld secs\\n\", diff.tv_sec, diff.tv_nsec );\\\n                  ^\nserver.c:122:13: note: in expansion of macro \u2018TIME_MEASURE\u2019\n             TIME_MEASURE(\n             ^\nserver.c:50:18: warning: format \u2018%lld\u2019 expects argument of type \u2018long long int\u2019, but argument 3 has type \u2018__syscall_slong_t {aka long int}\u2019 [-Wformat=]\n          printf( \"Elapsed: %u.%09lld secs\\n\", diff.tv_sec, diff.tv_nsec );\\\n                  ^\nserver.c:122:13: note: in expansion of macro \u2018TIME_MEASURE\u2019\n             TIME_MEASURE(\n             ^\nserver.c:54:18: warning: format \u2018%lld\u2019 expects argument of type \u2018long long int\u2019, but argument 2 has type \u2018long int\u2019 [-Wformat=]\n          printf( \"Elapsed nsec: %lld.%09lld secs\\n\", nsec / NANO, nsec % NANO )\n                  ^\nserver.c:122:13: note: in expansion of macro \u2018TIME_MEASURE\u2019\n             TIME_MEASURE(\n             ^\nserver.c:54:18: warning: format \u2018%lld\u2019 expects argument of type \u2018long long int\u2019, but argument 3 has type \u2018long int\u2019 [-Wformat=]\n          printf( \"Elapsed nsec: %lld.%09lld secs\\n\", nsec / NANO, nsec % NANO )\n                  ^\nserver.c:122:13: note: in expansion of macro \u2018TIME_MEASURE\u2019\n             TIME_MEASURE(\n             ^\nserver.c:56:17: warning: format \u2018%ld\u2019 expects a matching \u2018long int\u2019 argument [-Wformat=]\n          printf(\"nsec=%ld\\n\");                                           \\\n                 ^\nserver.c:122:13: note: in expansion of macro \u2018TIME_MEASURE\u2019\n             TIME_MEASURE(\n             ^\n</code></pre>\n"}, {"tags": ["c++", "c", "cscope"], "comments": [{"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 1, "creation_date": 1458735820, "post_id": 36178082, "comment_id": 59991267, "body": "What&#39;s wrong with <code>-L3</code>?"}, {"owner": {"reputation": 2359, "user_id": 3801449, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/04t78.jpg?s=128&g=1", "display_name": "Eenoku", "link": "https://stackoverflow.com/users/3801449/eenoku"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1458735970, "post_id": 36178082, "comment_id": 59991372, "body": "@FUZxxl I don&#39;t want to know, which functions were called by, let&#39;s say, myFunc(). I want files and line numbers were myFunc() was called itself."}, {"owner": {"reputation": 2359, "user_id": 3801449, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/04t78.jpg?s=128&g=1", "display_name": "Eenoku", "link": "https://stackoverflow.com/users/3801449/eenoku"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1458739122, "post_id": 36178082, "comment_id": 59993678, "body": "@FUZxxl I&#39;m sorry, I overlooked somehow :-) Please, add your response as the answer, so I can accept it."}], "answers": [{"tags": [], "owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "is_accepted": true, "score": 2, "last_activity_date": 1458739507, "creation_date": 1458739507, "answer_id": 36179449, "question_id": 36178082, "link": "https://stackoverflow.com/questions/36178082/use-cscope-to-find-function-calls-not-definitions-c-c/36179449#36179449", "title": "Use CScope to find function calls (NOT definitions) (C/C++)", "body": "<p>Use the option <code>-L3</code> to ask for functions that call a specific function.</p>\n"}], "owner": {"reputation": 2359, "user_id": 3801449, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/04t78.jpg?s=128&g=1", "display_name": "Eenoku", "link": "https://stackoverflow.com/users/3801449/eenoku"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 716, "favorite_count": 0, "accepted_answer_id": 36179449, "answer_count": 1, "score": 0, "last_activity_date": 1458739507, "creation_date": 1458735748, "question_id": 36178082, "link": "https://stackoverflow.com/questions/36178082/use-cscope-to-find-function-calls-not-definitions-c-c", "title": "Use CScope to find function calls (NOT definitions) (C/C++)", "body": "<p>I need to find function calls in my C and C++ codes. When I was looking for some suitable software, I found CScope. It looks pretty well, the only problem is, that I can't find a way how to find just function calls with it.</p>\n\n<pre><code> 0 Find this C symbol:\n 1 Find this function definition:\n 2 Find functions called by this function:\n 3 Find functions calling this function:\n 4 Find this text string:\n 5 Change this text string:\n 6 Find this egrep pattern:\n 7 Find this file:\n 8 Find files\n</code></pre>\n\n<p>I thought about finding all symbols (cscope -L0) and then removing definitions (cscope  -L1), but it means, that codes will be parsed 2x and I'm afraid it's going to be too slow.</p>\n\n<p>Is there any better, \"original\", way to do this with CScope?</p>\n"}, {"tags": ["c", "linux", "exec", "busybox", "vfork"], "comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1458739331, "post_id": 36177998, "comment_id": 59993809, "body": "Layers of the service.  Once the daemon is started (your pid 647), the system shows an instance, then depending on how system is configured, additional processes are started as needed.  Starting a similar instance in another part of your code may result in one more process, but does not require another instance of the daemon, for example.  Your <code>.&#47;MyApp</code> is already running, no need for another process ID, even though you used it to start another instance of <code>udhcpd</code> (pid 648)"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1458739333, "post_id": 36177998, "comment_id": 59993812, "body": "It appears unrelated to your problem, but one really ought to use <code>fork()</code> rather than <code>vfork()</code> on any Linux system.  Quoth the Linux manual page for <code>vfork()</code>: &quot;It is rather unfortunate that Linux revived this specter from the past.&quot;"}, {"owner": {"reputation": 21, "user_id": 6103938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b0ef0f3a130530950a918776c6758c0?s=128&d=identicon&r=PG&f=1", "display_name": "user6103938", "link": "https://stackoverflow.com/users/6103938/user6103938"}, "edited": false, "score": 0, "creation_date": 1458740674, "post_id": 36177998, "comment_id": 59994770, "body": "Ryker, when I wrote &quot;In another part of our code we start dhcpd...&quot; above I  meant &quot;dhcpcd&quot; (and not udhcpd). I am only starting udhcpd once as shown above."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 6103938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b0ef0f3a130530950a918776c6758c0?s=128&d=identicon&r=PG&f=1", "display_name": "user6103938", "link": "https://stackoverflow.com/users/6103938/user6103938"}, "is_accepted": false, "score": 0, "last_activity_date": 1458835634, "creation_date": 1458835634, "answer_id": 36204787, "question_id": 36177998, "link": "https://stackoverflow.com/questions/36177998/busybox-udhcpd-vfork-starts-two-processes/36204787#36204787", "title": "Busybox udhcpd vfork starts two processes", "body": "<p>I believe the answer is udhcpd does another fork leaving a zombie process. Reverted to just doing a system call and killing the process using the PID in the PID file.</p>\n"}], "owner": {"reputation": 21, "user_id": 6103938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b0ef0f3a130530950a918776c6758c0?s=128&d=identicon&r=PG&f=1", "display_name": "user6103938", "link": "https://stackoverflow.com/users/6103938/user6103938"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 248, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1458835634, "creation_date": 1458735540, "last_edit_date": 1458741418, "question_id": 36177998, "link": "https://stackoverflow.com/questions/36177998/busybox-udhcpd-vfork-starts-two-processes", "title": "Busybox udhcpd vfork starts two processes", "body": "<p>In my application I require to start Busybox udhcpd (dhcp server), the code is below. While udhcpd does start and run I get two versions in the process list. udhcpd is running correctly, i.e. assigned IP addresses to devices.</p>\n\n<pre><code>pid_t forked_pid = vfork();\n\nif ( forked_pid == 0 )\n{\n  // Child process, execute udhcpd.\n  execl( \"/usr/bin/udhcpd\",\n         \"udhcpd\",\n         \"/var/run/udhcpd.conf\",   // the location of the udhcpd config file\n         NULL );\n}\nelse if ( forked_pid &gt; 0 )\n{\n  // Parent process, record the childs pid\n  m_udhcpd_pid = forked_pid;\n  log( Log_Info, \"UDHCPD started with PID: %d (PID=%d)\", forked_pid, getpid());\n}\nelse\n{\n  log( Log_Warning, \"Failed to start UDHCPD\" );\n}\n</code></pre>\n\n<p>Log Output</p>\n\n<p>UDHCPD started with PID: 647 (PID=528)</p>\n\n<p>PS output</p>\n\n<pre><code>528 root       0:03 ./MyApp\n\n647 root       0:00 [udhcpd]\n\n648 root       0:00 udhcpd /var/run/udhcpd.conf\n</code></pre>\n\n<p>Now if I look at /var/run/udhcpd.pid it has the pid of 648. In another part of our code we start dhcpcd (dhcp client) using the same code as above and it only has one entry in the process list. Can anyone explain what the difference is and if I am doing things incorrectly what I should be doing?</p>\n\n<p>The reason for asking is I require to later stop udhcpd and it seems I will need to stop using both the childs pid (647) and also the pid read from /var/run/udhcpd.pid (648).</p>\n"}, {"tags": ["c", "pointers", "linear-programming", "segmentation-fault", "glpk"], "comments": [{"owner": {"reputation": 29294, "user_id": 2659313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9828b91aef4c2b3cf14f3501e0a20e33?s=128&d=identicon&r=PG", "display_name": "Mohit Jain", "link": "https://stackoverflow.com/users/2659313/mohit-jain"}, "edited": false, "score": 1, "creation_date": 1458735510, "post_id": 36177967, "comment_id": 59991030, "body": "Please paste the appropriate minimal code here"}, {"owner": {"reputation": 29294, "user_id": 2659313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9828b91aef4c2b3cf14f3501e0a20e33?s=128&d=identicon&r=PG", "display_name": "Mohit Jain", "link": "https://stackoverflow.com/users/2659313/mohit-jain"}, "edited": false, "score": 0, "creation_date": 1458735604, "post_id": 36177967, "comment_id": 59991098, "body": "Assumin it is <code>for</code> or <code>while</code> loop, don&#39;t you think <code>i</code> should start with <code>0</code>."}, {"owner": {"reputation": 2887, "user_id": 5845470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/606531753afd42de16d82a1199fc4d45?s=128&d=identicon&r=PG&f=1", "display_name": "jdarthenay", "link": "https://stackoverflow.com/users/5845470/jdarthenay"}, "edited": false, "score": 0, "creation_date": 1458735696, "post_id": 36177967, "comment_id": 59991159, "body": "What&#39;s the type/declaration of <code>helper_glpk.col_bounds</code>? - ok, just seen it in your pastebin link. But providing pastebin links is not the way to use SO."}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1458736017, "post_id": 36177967, "comment_id": 59991404, "body": "Either <code>helper_glpk.col_bounds</code> is too small or the pointer it contains at position 1 is uninitialised or dangling."}, {"owner": {"reputation": 51110, "user_id": 106435, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/11155673de94185c4ea775c87d2c8aeb?s=128&d=identicon&r=PG", "display_name": "vikingosegundo", "link": "https://stackoverflow.com/users/106435/vikingosegundo"}, "edited": false, "score": 1, "creation_date": 1458736035, "post_id": 36177967, "comment_id": 59991415, "body": "first: post relating code here. second: write code in english so that people not fluent in French can easily understand it."}, {"owner": {"reputation": 51110, "user_id": 106435, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/11155673de94185c4ea775c87d2c8aeb?s=128&d=identicon&r=PG", "display_name": "vikingosegundo", "link": "https://stackoverflow.com/users/106435/vikingosegundo"}, "edited": false, "score": 1, "creation_date": 1458736089, "post_id": 36177967, "comment_id": 59991456, "body": "BTW: nothing in your code is objective-c. it is plain C."}, {"owner": {"reputation": 172, "user_id": 3410991, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/bac95fc33ffe9f71e511c3cfc8d5ba69?s=128&d=identicon&r=PG&f=1", "display_name": "Hayanno", "link": "https://stackoverflow.com/users/3410991/hayanno"}, "edited": false, "score": 0, "creation_date": 1458736140, "post_id": 36177967, "comment_id": 59991502, "body": "Sorry guys I have updated my question"}, {"owner": {"reputation": 172, "user_id": 3410991, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/bac95fc33ffe9f71e511c3cfc8d5ba69?s=128&d=identicon&r=PG&f=1", "display_name": "Hayanno", "link": "https://stackoverflow.com/users/3410991/hayanno"}, "edited": false, "score": 0, "creation_date": 1458737360, "post_id": 36177967, "comment_id": 59992382, "body": "So I posted relative code here, sorry for that, but I didn&#39;t add the objective-c tag, someone else did."}], "answers": [{"comments": [{"owner": {"reputation": 172, "user_id": 3410991, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/bac95fc33ffe9f71e511c3cfc8d5ba69?s=128&d=identicon&r=PG&f=1", "display_name": "Hayanno", "link": "https://stackoverflow.com/users/3410991/hayanno"}, "edited": false, "score": 0, "creation_date": 1458737085, "post_id": 36178240, "comment_id": 59992165, "body": "It was Bounds * at first, but I want to modify col_bounds and row_bounds inside a function, so I think I have to make them pointers ?"}, {"owner": {"reputation": 172, "user_id": 3410991, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/bac95fc33ffe9f71e511c3cfc8d5ba69?s=128&d=identicon&r=PG&f=1", "display_name": "Hayanno", "link": "https://stackoverflow.com/users/3410991/hayanno"}, "edited": false, "score": 0, "creation_date": 1458737593, "post_id": 36178240, "comment_id": 59992573, "body": "I just updated my code as you said, I now have Bounds *, but it seems that my struct isn&#39;t saved, because inside my function I have helper_glpk-&gt;col_bounds[1].type = 1; and outside I get the error : type = 216; invalid column type"}, {"owner": {"reputation": 2887, "user_id": 5845470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/606531753afd42de16d82a1199fc4d45?s=128&d=identicon&r=PG&f=1", "display_name": "jdarthenay", "link": "https://stackoverflow.com/users/5845470/jdarthenay"}, "reply_to_user": {"reputation": 172, "user_id": 3410991, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/bac95fc33ffe9f71e511c3cfc8d5ba69?s=128&d=identicon&r=PG&f=1", "display_name": "Hayanno", "link": "https://stackoverflow.com/users/3410991/hayanno"}, "edited": false, "score": 0, "creation_date": 1458738028, "post_id": 36178240, "comment_id": 59992883, "body": "You need to call your function this way: <code>my_function(helper_glpk-&gt;col_bounds + i)</code> and the argument of <code>my_function</code> must be a <code>Bound *</code>."}, {"owner": {"reputation": 172, "user_id": 3410991, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/bac95fc33ffe9f71e511c3cfc8d5ba69?s=128&d=identicon&r=PG&f=1", "display_name": "Hayanno", "link": "https://stackoverflow.com/users/3410991/hayanno"}, "edited": false, "score": 0, "creation_date": 1458738168, "post_id": 36178240, "comment_id": 59992992, "body": "There&#39;s no other way to do that ? My function already have helper_glpk as argument, and need other element of helper_glpk so I think you solution is not really good. If I go for Bounds ** should it fix my problem ?"}, {"owner": {"reputation": 2887, "user_id": 5845470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/606531753afd42de16d82a1199fc4d45?s=128&d=identicon&r=PG&f=1", "display_name": "jdarthenay", "link": "https://stackoverflow.com/users/5845470/jdarthenay"}, "reply_to_user": {"reputation": 172, "user_id": 3410991, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/bac95fc33ffe9f71e511c3cfc8d5ba69?s=128&d=identicon&r=PG&f=1", "display_name": "Hayanno", "link": "https://stackoverflow.com/users/3410991/hayanno"}, "edited": false, "score": 0, "creation_date": 1458738481, "post_id": 36178240, "comment_id": 59993240, "body": "Sorry, my previous comment is completely wrong. To use <code>Bounds *</code> instead of <code>Bounds **</code> you need to use <code>helper_glpk-&gt;col_bounds[...].type</code> inside your <code>genere_contrainte_1</code> function."}, {"owner": {"reputation": 172, "user_id": 3410991, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/bac95fc33ffe9f71e511c3cfc8d5ba69?s=128&d=identicon&r=PG&f=1", "display_name": "Hayanno", "link": "https://stackoverflow.com/users/3410991/hayanno"}, "edited": false, "score": 0, "creation_date": 1458738819, "post_id": 36178240, "comment_id": 59993483, "body": "Ok, so that&#39;s what I did but I still can&#39;t have the same value inside and oustide the function, somewhat the value is always overwritten, should I malloc every Bounds ?"}, {"owner": {"reputation": 2887, "user_id": 5845470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/606531753afd42de16d82a1199fc4d45?s=128&d=identicon&r=PG&f=1", "display_name": "jdarthenay", "link": "https://stackoverflow.com/users/5845470/jdarthenay"}, "reply_to_user": {"reputation": 172, "user_id": 3410991, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/bac95fc33ffe9f71e511c3cfc8d5ba69?s=128&d=identicon&r=PG&f=1", "display_name": "Hayanno", "link": "https://stackoverflow.com/users/3410991/hayanno"}, "edited": false, "score": 0, "creation_date": 1458739061, "post_id": 36178240, "comment_id": 59993631, "body": "Do you use <code>printf</code> to check the values of <code>index_ouverture_serveur(i)</code> and <code>index_connexion(i, j, baie.nbr_serveur)</code>?"}, {"owner": {"reputation": 172, "user_id": 3410991, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/bac95fc33ffe9f71e511c3cfc8d5ba69?s=128&d=identicon&r=PG&f=1", "display_name": "Hayanno", "link": "https://stackoverflow.com/users/3410991/hayanno"}, "edited": false, "score": 0, "creation_date": 1458739496, "post_id": 36178240, "comment_id": 59993921, "body": "yeah I do, they are very simple function, for example index_ouverture_serveur(i) return i"}, {"owner": {"reputation": 2887, "user_id": 5845470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/606531753afd42de16d82a1199fc4d45?s=128&d=identicon&r=PG&f=1", "display_name": "jdarthenay", "link": "https://stackoverflow.com/users/5845470/jdarthenay"}, "reply_to_user": {"reputation": 172, "user_id": 3410991, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/bac95fc33ffe9f71e511c3cfc8d5ba69?s=128&d=identicon&r=PG&f=1", "display_name": "Hayanno", "link": "https://stackoverflow.com/users/3410991/hayanno"}, "edited": false, "score": 0, "creation_date": 1458756190, "post_id": 36178240, "comment_id": 60006339, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/107166/discussion-between-jdarthenay-and-hayanno\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 2887, "user_id": 5845470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/606531753afd42de16d82a1199fc4d45?s=128&d=identicon&r=PG&f=1", "display_name": "jdarthenay", "link": "https://stackoverflow.com/users/5845470/jdarthenay"}, "is_accepted": true, "score": 2, "last_activity_date": 1458736969, "last_edit_date": 1458736969, "creation_date": 1458736172, "answer_id": 36178240, "question_id": 36177967, "link": "https://stackoverflow.com/questions/36177967/c-array-being-overwritten/36178240#36178240", "title": "C Array being overwritten?", "body": "<p>This code is wrong:</p>\n\n<pre><code>helper_glpk.col_bounds = malloc((nbr_colums + 1) * sizeof(Bounds));\n</code></pre>\n\n<p>You need to fix it with (provided you need nbr_colums + 1 elements):</p>\n\n<pre><code>helper_glpk.col_bounds = malloc((nbr_colums + 1) * sizeof(Bounds *));\nfor (int index = 0; index &lt; nbr_colums + 1; index++)\n{\n    helper_glpk.col_bounds[index] = malloc(sizeof(Bounds));\n}\n</code></pre>\n\n<p>I have not checked the rest of the code, there could be other errors.</p>\n\n<p>Edit: maybe you don't need the for loop depending on what your <code>genere_contrainte_1</code> does, but you need to correct your <code>malloc</code> with the right <code>sizeof</code>.</p>\n\n<p>Edit2: I read your <code>genere_contrainte_1</code>, you definitely need all these <code>malloc</code>s. But I really doubt you need <code>row_bounds</code> and <code>col_bounds</code> to be <code>Bounds **</code>, it seems to me <code>Bounds *</code> would have been fine, and that way a single <code>malloc</code> for each field would be enough.</p>\n"}], "owner": {"reputation": 172, "user_id": 3410991, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/bac95fc33ffe9f71e511c3cfc8d5ba69?s=128&d=identicon&r=PG&f=1", "display_name": "Hayanno", "link": "https://stackoverflow.com/users/3410991/hayanno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 452, "favorite_count": 0, "closed_date": 1458736293, "accepted_answer_id": 36178240, "answer_count": 1, "score": -4, "last_activity_date": 1458736983, "creation_date": 1458735472, "last_edit_date": 1458736983, "question_id": 36177967, "link": "https://stackoverflow.com/questions/36177967/c-array-being-overwritten", "closed_reason": "Not suitable for this site", "title": "C Array being overwritten?", "body": "<p>When I run this program : <a href=\"http://hastebin.com/asorawoluw.m\" rel=\"nofollow\">http://hastebin.com/asorawoluw.m</a></p>\n\n<p>I get this error in GDB :</p>\n\n<pre><code>Program received signal SIGSEGV, Segmentation fault.\n0x0000000000401f91 in resoudre (baie=...) at lineaire.c:291\n291         printf(\"type[%d] : %d\\n\", i, helper_glpk.col_bounds[i]-&gt;type);\n</code></pre>\n\n<p>When i ask gdb to <code>print i</code>I get :</p>\n\n<pre><code>$1 = 1\n</code></pre>\n\n<p>So the first iteration is failing, but I'm sure I did write into the first case of <code>helper_glpk.col_bounds</code> at the line 200-204 and I did malloc so there's no way (I think ?) that my data is being overwritten or deleted.. so I don't understand why I get this error.</p>\n\n<p>Edit : here's the minimal code :\nMy structs :</p>\n\n<pre><code>typedef struct Bounds Bounds;\nstruct Bounds\n{\n    int type;\n    double lb;\n    double ub;\n};\n\ntypedef struct HelperGlpk HelperGlpk;\nstruct HelperGlpk\n{\n    double *matrix_coefs;\n    double *obj_coefs;\n    Bounds **row_bounds;\n    Bounds **col_bounds;\n    int *column_of_coef;\n    int *row_of_coef;\n    int cpt_coef;\n    int cpt_contrainte;\n};\n</code></pre>\n\n<p>My functions to generates constraint :</p>\n\n<pre><code>void genere_contrainte_1(int i, int j, HelperGlpk *helper_glpk, Baie baie){         \n    helper_glpk-&gt;col_bounds[index_ouverture_serveur(i)]-&gt;type = GLP_DB;\n    helper_glpk-&gt;col_bounds[index_ouverture_serveur(i)]-&gt;lb = 0;\n    helper_glpk-&gt;col_bounds[index_ouverture_serveur(i)]-&gt;ub = 1;\n\n    helper_glpk-&gt;cpt_coef++;\n\n    helper_glpk-&gt;col_bounds[index_connexion(i, j, baie.nbr_serveur)]-&gt;type = GLP_LO;\n    helper_glpk-&gt;col_bounds[index_connexion(i, j, baie.nbr_serveur)]-&gt;lb = 0;\n    helper_glpk-&gt;col_bounds[index_connexion(i, j, baie.nbr_serveur)]-&gt;ub = 0;\n\n    helper_glpk-&gt;cpt_coef++;\n}\n</code></pre>\n\n<p>and the main program is :</p>\n\n<pre><code>void resoudre(Baie baie){\n\n    glp_prob *lp;\n\n    const int nbr_rows = baie.nbr_client + baie.nbr_serveur * baie.nbr_client; // nombre de contrainte\n    const int nbr_colums = baie.nbr_serveur + baie.nbr_serveur * baie.nbr_client; // nombre de variable\n    const int nbr_coefs = 3 * baie.nbr_serveur * baie.nbr_client;\n\n    int i, j;\n\n    HelperGlpk helper_glpk;\n\n    helper_glpk.matrix_coefs = malloc((nbr_coefs + 1) * sizeof(double));\n    helper_glpk.matrix_coefs[0] = 0;\n\n    helper_glpk.obj_coefs = malloc((nbr_colums + 1) * sizeof(double));\n    helper_glpk.obj_coefs[0] = 0;\n\n    helper_glpk.column_of_coef = malloc((nbr_colums + 1) * sizeof(int));\n    helper_glpk.column_of_coef[0] = 0;\n\n    helper_glpk.row_of_coef = malloc((nbr_rows + 1) * sizeof(int)); \n    helper_glpk.row_of_coef[0] = 0;\n\n        helper_glpk.col_bounds = malloc((nbr_colums + 1) * sizeof(Bounds *));\n\nfor (int index = 0; index &lt;= nbr_colums; index++)\n{\n    helper_glpk.col_bounds[index] = malloc(sizeof(Bounds));\n}\n\nhelper_glpk.row_bounds = malloc((nbr_rows + 1) * sizeof(Bounds *));\n\nfor (int index = 0; index &lt;= nbr_rows; index++)\n{\n    helper_glpk.row_bounds[index] = malloc(sizeof(Bounds));\n}\n\n    helper_glpk.cpt_coef = 1;\n\n    for(i = 1; i &lt;= baie.nbr_serveur; i++)\n        for(j = 1; j &lt;= baie.nbr_client; j++)\n            genere_contrainte_1(i, j, &amp;helper_glpk, baie);\n\n    for(i = 1; i &lt;= nbr_colums; i++)\n        printf(\"type[%d] : %d\\n\", i, helper_glpk.col_bounds[i]-&gt;type);\n\n    for(j = 1; j &lt;= baie.nbr_client; j++)\n        genere_contrainte_2(j, &amp;helper_glpk, baie.nbr_serveur);\n</code></pre>\n\n<p>The error I get is while I try to printf after the call to generate_contrainte_1</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1458735719, "post_id": 36177957, "comment_id": 59991182, "body": "While writing functions in the style suggested by the linked answer helps with tail recursion, actual compiler support is also needed, that the compiler can detect tail recursion and then reuse the function context. If the compiler can&#39;t do that then all you have is normal recursion, only that the recursive call is made in a special place."}], "answers": [{"comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1458736442, "post_id": 36178122, "comment_id": 59991696, "body": "Interesting. I didn&#39;t realize that GCC did that optimization. Perhaps SICP was written before that, though it is still an important point that the optimization isn&#39;t guaranteed."}, {"owner": {"reputation": 102099, "user_id": 1600898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/01377f8b31f24b0265854666b29d0c03?s=128&d=identicon&r=PG", "display_name": "user4815162342", "link": "https://stackoverflow.com/users/1600898/user4815162342"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1458738481, "post_id": 36178122, "comment_id": 59993239, "body": "@JohnColeman Not only does GCC optimize that, it optimizes even some <i>non-tail</i> recursions, such as the traditional recursive factorial. It&#39;s <a href=\"https://gcc.godbolt.org/#%7B%22version%22%3A3%2C%22filterAsm%22%3A%7B%22labels%22%3Atrue%2C%22directives%22%3Atrue%2C%22commentOnly%22%3Atrue%7D%2C%22compilers%22%3A%5B%7B%22sourcez%22%3A%22PTAEBUE8AcFNUgewK4CdQGNEBN4AtZVYAaURdAG0QENtRqA7UWAD2oFtoLYA6AKACWDAC6gAZtQzCAFENENk7AJSgA3n1CgBY0NIXtQAXkOgADEo2bQRYWiYBGANyWbd0PtAAqcZJkeAtKD2Ss4AvnxAAAA%3D%22%2C%22compiler%22%3A%22g530%22%2C%22options%22%3A%22-O2%22%7D%5D%7D\" rel=\"nofollow noreferrer\">quite fascinating</a>, really."}], "tags": [], "owner": {"reputation": 102099, "user_id": 1600898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/01377f8b31f24b0265854666b29d0c03?s=128&d=identicon&r=PG", "display_name": "user4815162342", "link": "https://stackoverflow.com/users/1600898/user4815162342"}, "is_accepted": true, "score": 4, "last_activity_date": 1458763800, "last_edit_date": 1458763800, "creation_date": 1458735860, "answer_id": 36178122, "question_id": 36177957, "link": "https://stackoverflow.com/questions/36177957/tail-recursion-in-c-and-sicp/36178122#36178122", "title": "Tail recursion in C and SICP", "body": "<p>As mentioned in the comments, while you can <em>write</em> tail-recursive algorithms in C, there is no guarantee that the generated code will not allocate additional stack memory at each tail call. This is exactly what used to happen in virtually all historic C implementations, making tail recursion impractical.</p>\n\n<p>In modern C this is a quality of implementation issue. For example, GCC has been able to optimize many instances of tail recursion into equivalent iteration for many years now. Still, the key difference in comparison to Scheme is that Scheme <em>guarantees</em> tail call elimination, while C doesn't and is unlikely to ever do so.</p>\n"}], "owner": {"reputation": 125, "user_id": 3402904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/347bfecbd320487f5c785cc5edc3e096?s=128&d=identicon&r=PG&f=1", "display_name": "Mirko Hern&#225;ndez", "link": "https://stackoverflow.com/users/3402904/mirko-hern%c3%a1ndez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 288, "favorite_count": 0, "accepted_answer_id": 36178122, "answer_count": 1, "score": 0, "last_activity_date": 1458763800, "creation_date": 1458735428, "last_edit_date": 1495540231, "question_id": 36177957, "link": "https://stackoverflow.com/questions/36177957/tail-recursion-in-c-and-sicp", "title": "Tail recursion in C and SICP", "body": "<p>I'm confused by the following paragraph in  SICP:</p>\n\n<blockquote>\n  <p>One reason that the distinction between process and procedure may be confusing is that most implementations of common languages (including Ada, Pascal, and C) are designed in such a way that the interpretation of <strong>any recursive procedure</strong> consumes an amount of memory that grows with the number of procedure calls, even when the process described is, in principle, iterative. As a consequence, these languages can describe iterative processes only by resorting to special-purpose ``looping constructs'' such as do, repeat, until, for, and while. </p>\n</blockquote>\n\n<p>As I understand it, you can actually write tail recursive procedures(functions) in C:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/3935501/tail-recursion-in-c#3935573\">Tail recursion in C</a></p>\n\n<p>So, what is the correct interpretation of the mentioned paragraph?</p>\n"}, {"tags": ["c", "algorithm", "recursion"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1458732651, "post_id": 36176907, "comment_id": 59989144, "body": "Try stepping through the code, line by line, in a debugger. For such a small array it should not be to hard even with the recursion."}, {"owner": {"reputation": 45031, "user_id": 213136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b84a36c241e04175fcec402dac43018?s=128&d=identicon&r=PG", "display_name": "Bob Jarvis - Reinstate Monica", "link": "https://stackoverflow.com/users/213136/bob-jarvis-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1458732681, "post_id": 36176907, "comment_id": 59989169, "body": "So let&#39;s see - you&#39;ve got a bug, you don&#39;t know where it is, and you didn&#39;t include all the code. Hmmm...you should really include the <code>partition</code> and <code>swap</code> code."}, {"owner": {"reputation": 7873, "user_id": 2225104, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/195de66794c596e35bc145c80e9f5515?s=128&d=identicon&r=PG", "display_name": "BitTickler", "link": "https://stackoverflow.com/users/2225104/bittickler"}, "edited": false, "score": 0, "creation_date": 1458732811, "post_id": 36176907, "comment_id": 59989243, "body": "Also, you can try to implement a quicksort first, then think about when to stop the quicksort algorithm to obtain your quickselect solution. Because this is basically what happens. Quicksort as long as it takes to reach partition sizes of size k."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1458732917, "post_id": 36176907, "comment_id": 59989300, "body": "Are you sure you want <code>x &lt; right - 1</code> and not <code>x &lt; right</code> or even <code>x &lt;= right</code>?"}, {"owner": {"reputation": 1713, "user_id": 3989939, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/530734853101ecc62e278406ed5b9065?s=128&d=identicon&r=PG&f=1", "display_name": "JavascriptLoser", "link": "https://stackoverflow.com/users/3989939/javascriptloser"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1458733098, "post_id": 36176907, "comment_id": 59989415, "body": "@WeatherVane I changed that line, but now the program consistently returns the kth+1 smallest item"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1458733135, "post_id": 36176907, "comment_id": 59989443, "body": "I just changed the above comment. <code>right</code> was set from the array length as <code>right = n - 1</code>."}, {"owner": {"reputation": 1713, "user_id": 3989939, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/530734853101ecc62e278406ed5b9065?s=128&d=identicon&r=PG&f=1", "display_name": "JavascriptLoser", "link": "https://stackoverflow.com/users/3989939/javascriptloser"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1458733243, "post_id": 36176907, "comment_id": 59989508, "body": "@WeatherVane the equals sign crashes the program, as does <code>x &lt;= right + 1</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1713, "user_id": 3989939, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/530734853101ecc62e278406ed5b9065?s=128&d=identicon&r=PG&f=1", "display_name": "JavascriptLoser", "link": "https://stackoverflow.com/users/3989939/javascriptloser"}, "edited": false, "score": 0, "creation_date": 1458733437, "post_id": 36177226, "comment_id": 59989637, "body": "This crashes the program"}, {"owner": {"reputation": 4154, "user_id": 3844480, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ho59A.jpg?s=128&g=1", "display_name": "ilim", "link": "https://stackoverflow.com/users/3844480/ilim"}, "reply_to_user": {"reputation": 1713, "user_id": 3989939, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/530734853101ecc62e278406ed5b9065?s=128&d=identicon&r=PG&f=1", "display_name": "JavascriptLoser", "link": "https://stackoverflow.com/users/3989939/javascriptloser"}, "edited": false, "score": 0, "creation_date": 1458733623, "post_id": 36177226, "comment_id": 59989765, "body": "@PythonNewb added a link to ideone so you may experiment with it. It did seem to work on with k values 1 to 5 when I ran it."}, {"owner": {"reputation": 1713, "user_id": 3989939, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/530734853101ecc62e278406ed5b9065?s=128&d=identicon&r=PG&f=1", "display_name": "JavascriptLoser", "link": "https://stackoverflow.com/users/3989939/javascriptloser"}, "edited": false, "score": 0, "creation_date": 1458733779, "post_id": 36177226, "comment_id": 59989876, "body": "Indeed this works, however it&#39;s off by one, the 0th smallest item returns 1, when the 1st smallest item should return 1, correct?"}, {"owner": {"reputation": 4154, "user_id": 3844480, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ho59A.jpg?s=128&g=1", "display_name": "ilim", "link": "https://stackoverflow.com/users/3844480/ilim"}, "reply_to_user": {"reputation": 1713, "user_id": 3989939, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/530734853101ecc62e278406ed5b9065?s=128&d=identicon&r=PG&f=1", "display_name": "JavascriptLoser", "link": "https://stackoverflow.com/users/3989939/javascriptloser"}, "edited": false, "score": 0, "creation_date": 1458733911, "post_id": 36177226, "comment_id": 59989969, "body": "@PythonNewb I assumed k was a positive integer. (i.e. I figured there can&#39;t be a 0th smallest number, but the smallest number would actually be 1st smallest number) If that assumption holds, this works fine. If you are planning to assign the value of k in range [0, n-1], then you should simply replace both <b>k-1</b> in if statements with k and you&#39;d get what you want. The code is basically the same. You just have to make the distinction whether k is an index or a value indicating the order of the element. (i.e. 0-indexed or 1-indexed)"}, {"owner": {"reputation": 9285, "user_id": 1218408, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/YqwCY.png?s=128&g=1", "display_name": "ZachB", "link": "https://stackoverflow.com/users/1218408/zachb"}, "edited": false, "score": 0, "creation_date": 1536540128, "post_id": 36177226, "comment_id": 91447608, "body": "I don&#39;t think this matters much, but the original 1965 implementation uses <code>if (A[x] &lt; pivot)</code> (instead of <code>&lt;=</code>). There&#39;s no point in swapping values equal to the pivot."}, {"owner": {"reputation": 4123, "user_id": 195787, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4b9620cb172292493f9c02c8f37c6cc7?s=128&d=identicon&r=PG", "display_name": "Royi", "link": "https://stackoverflow.com/users/195787/royi"}, "edited": false, "score": 0, "creation_date": 1598817811, "post_id": 36177226, "comment_id": 112574240, "body": "Is there an implementation with no recursion? Will it be faster?"}], "tags": [], "owner": {"reputation": 4154, "user_id": 3844480, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ho59A.jpg?s=128&g=1", "display_name": "ilim", "link": "https://stackoverflow.com/users/3844480/ilim"}, "is_accepted": true, "score": 5, "last_activity_date": 1610695000, "last_edit_date": 1610695000, "creation_date": 1458733275, "answer_id": 36177226, "question_id": 36176907, "link": "https://stackoverflow.com/questions/36176907/implementation-of-the-quick-select-algorithm-to-find-kth-smallest-number/36177226#36177226", "title": "Implementation of the quick select algorithm to find kth smallest number", "body": "<p>In your partition function the loop condition should be <code>x &lt; right</code>, not <code>x &lt; right - 1</code>.</p>\n<p>Also, in the if statements in quickselect, you should switch both uses of <code>p-1</code> to <code>p</code>. <code>p</code> is already an index and by decreasing <code>k</code> by 1 you turn it into an index(rather than an order) as well. There is no need to decrease <code>p</code> by one again.</p>\n<pre><code>int partition(int *A, int left, int right){\n    int pivot = A[right], i = left, x;\n \n    for (x = left; x &lt; right; x++){\n        if (A[x] &lt; pivot){\n            swap(&amp;A[i], &amp;A[x]);\n            i++;\n        }\n    }\n \n    swap(&amp;A[i], &amp;A[right]);\n    return i;\n}\n \n \nint quickselect(int *A, int left, int right, int k){\n \n    //p is position of pivot in the partitioned array\n    int p = partition(A, left, right);\n \n    //k equals pivot got lucky\n    if (p == k-1){\n        return A[p];\n    }\n    //k less than pivot\n    else if (k - 1 &lt; p){\n        return quickselect(A, left, p - 1, k);\n    }\n    //k greater than pivot\n    else{\n        return quickselect(A, p + 1, right, k);\n    }\n}\n</code></pre>\n<p>Here's a working example. <a href=\"http://ideone.com/Bkaglb\" rel=\"nofollow noreferrer\">http://ideone.com/Bkaglb</a></p>\n"}], "owner": {"reputation": 1713, "user_id": 3989939, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/530734853101ecc62e278406ed5b9065?s=128&d=identicon&r=PG&f=1", "display_name": "JavascriptLoser", "link": "https://stackoverflow.com/users/3989939/javascriptloser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6409, "favorite_count": 0, "accepted_answer_id": 36177226, "answer_count": 1, "score": 3, "last_activity_date": 1610695000, "creation_date": 1458732429, "last_edit_date": 1458732801, "question_id": 36176907, "link": "https://stackoverflow.com/questions/36176907/implementation-of-the-quick-select-algorithm-to-find-kth-smallest-number", "title": "Implementation of the quick select algorithm to find kth smallest number", "body": "<p>I'm currently working on a program to find the kth smallest number of an array using the quick select algorithm. I've finished it and it works but does not give the correct result every time.</p>\n\n<p>Here's my code (I didn't include my <code>partition</code> or <code>swap</code> algorithm, I'm fairly sure they're correct):</p>\n\n<pre><code>/*\ninputs...\n*A: pointer to array\nn: size of array\nk: the item in question\n*/\nint ksmallest(int *A, int n, int k){\n\n    int left = 0; \n    int right = n - 1; \n    int next = 1;\n\n    return quickselect(A, left, right, k);\n}\n\nint quickselect(int *A, int left, int right, int k){\n\n    //p is position of pivot in the partitioned array\n    int p = partition(A, left, right);\n\n    //k equals pivot got lucky\n    if (p - 1 == k - 1){\n        return A[p];\n    }\n    //k less than pivot\n    else if (k - 1 &lt; p - 1){\n        return quickselect(A, left, p - 1, k);\n    }\n    //k greater than pivot\n    else{\n        return quickselect(A, p + 1, right, k);\n    }\n}\n</code></pre>\n\n<p>Everything compiles fine. I then tried to use the program on the following array: <code>[1,3,8,2,4,9,7]</code></p>\n\n<p>These were my results:</p>\n\n<pre><code>&gt; kthsm 2\n4\n&gt; kthsm 1\n1\n&gt; kthsm 3\n2\n</code></pre>\n\n<p>As you can see, it worked correctly on the 1th smallest item, but failed on the others. What could be the problem? I guessed than my indexing was off but I'm not exactly sure.</p>\n\n<p>EDIT: Added my partition and swap code below, as requested:</p>\n\n<pre><code>int partition(int *A, int left, int right){\n\n    int pivot = A[right], i = left, x;\n\n    for (x = left; x &lt; right - 1; x++){\n        if (A[x] &lt;= pivot){\n            swap(&amp;A[i], &amp;A[x]);\n            i++;\n        }\n    }\n\n    swap(&amp;A[i], &amp;A[right]);\n    return i;\n}\n\n//Swaps\nvoid swap(int *a, int *b){\n    int temp = *a;\n    *a = *b;\n    *b = temp;\n}\n</code></pre>\n"}, {"tags": ["c", "libjpeg-turbo", "turbojpeg"], "answers": [{"tags": [], "owner": {"reputation": 3, "user_id": 5190196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80a423a45487b0dfeb2fe24597c8e6e4?s=128&d=identicon&r=PG&f=1", "display_name": "AleA", "link": "https://stackoverflow.com/users/5190196/alea"}, "is_accepted": false, "score": 0, "last_activity_date": 1458808108, "creation_date": 1458808108, "answer_id": 36195890, "question_id": 36176222, "link": "https://stackoverflow.com/questions/36176222/libjpeg-turbo-tjcompressfromyuv/36195890#36195890", "title": "libjpeg turbo tjCompressFromYUV", "body": "<p>Ok it turned out the problem was in the program containing the code I posted, in a smaller test program the <code>tjBufSizeYUV2</code> call performs as expected.</p>\n\n<p>On a side note it seems that if <code>jpegBuf</code> is pre-allocated before calling <code>tjBufSizeYUV2</code>, the <code>flag</code> argument passed to <code>tjBufSizeYUV2</code> must contain <code>TJFLAG_NOREALLOC</code>, or else <code>jpegBuf</code> won't be freed even if <code>tjFree(jpegBuf);</code> is later called.</p>\n"}, {"tags": [], "owner": {"reputation": 36, "user_id": 8031422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf372ea6867eeb81027f6f73e9f3279f?s=128&d=identicon&r=PG&f=1", "display_name": "om77", "link": "https://stackoverflow.com/users/8031422/om77"}, "is_accepted": true, "score": 1, "last_activity_date": 1532365777, "creation_date": 1532365777, "answer_id": 51484053, "question_id": 36176222, "link": "https://stackoverflow.com/questions/36176222/libjpeg-turbo-tjcompressfromyuv/51484053#51484053", "title": "libjpeg turbo tjCompressFromYUV", "body": "<p>Turbojpeg API tjCompressFromYUV allows you such options for jpegBuf:</p>\n\n<p>@param jpegBuf address of a pointer to an image buffer that will receive the\nJPEG image.  TurboJPEG has the ability to reallocate the JPEG buffer to\naccommodate the size of the JPEG image.  Thus, you can choose to:</p>\n\n<ol>\n<li><p>pre-allocate the JPEG buffer with an arbitrary size using #tjAlloc() and\nlet TurboJPEG grow the buffer as needed,</p></li>\n<li><p>set *jpegBuf to NULL to tell TurboJPEG to allocate the buffer\nfor you, or</p></li>\n<li><p>pre-allocate the buffer to a \"worst case\" size determined by calling\ntjBufSize().  This should ensure that the buffer never has to be\nre-allocated (setting #TJFLAG_NOREALLOC guarantees this.)</p>\n\n<p>If you choose option 1, *jpegSize should be set to the size of your\npre-allocated buffer.  In any case, unless you have set #TJFLAG_NOREALLOC,\nyou should always check *jpegBuf upon return from this function, as\nit may have changed.</p></li>\n</ol>\n\n<p>So by using 2-nd option, there is no need to call tjBufSizeYUV2 and tjAlloc, simply have jpegBuf=NULL before calling tjCompressFromYUV and do tjFree after compressing.</p>\n"}, {"comments": [{"owner": {"reputation": 80989, "user_id": 466862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d873f397779db38cd510d9ee5416fd43?s=128&d=identicon&r=PG", "display_name": "Mark Rotteveel", "link": "https://stackoverflow.com/users/466862/mark-rotteveel"}, "edited": false, "score": 3, "creation_date": 1600511466, "post_id": 63967350, "comment_id": 113115166, "body": "Please don&#39;t post only code as answer, but also provide an explanation what your code does and how it solves the problem of the question. Answers with an explanation are usually more helpful and of better quality, and are more likely to attract upvotes."}, {"owner": {"reputation": 2646, "user_id": 10951752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c771de42f31de7fd407adc253c2dc994?s=128&d=identicon&r=PG&f=1", "display_name": "flaxel", "link": "https://stackoverflow.com/users/10951752/flaxel"}, "edited": false, "score": 2, "creation_date": 1600514464, "post_id": 63967350, "comment_id": 113115832, "body": "Please follow the <a href=\"https://stackoverflow.com/help/how-to-answer\">contribution guideline</a> how to answer a question."}], "tags": [], "owner": {"reputation": 1, "user_id": 14304955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3073ca42654e8b72015df61477c073a9?s=128&d=identicon&r=PG&f=1", "display_name": "haskell", "link": "https://stackoverflow.com/users/14304955/haskell"}, "is_accepted": false, "score": 0, "last_activity_date": 1600508805, "last_edit_date": 1600508805, "creation_date": 1600508473, "answer_id": 63967350, "question_id": 36176222, "link": "https://stackoverflow.com/questions/36176222/libjpeg-turbo-tjcompressfromyuv/63967350#63967350", "title": "libjpeg turbo tjCompressFromYUV", "body": "<p><code>#define PADDING 4</code><br />\n<code>jpegBuf = tjAlloc(width*height*3/2);</code></p>\n"}], "owner": {"reputation": 3, "user_id": 5190196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80a423a45487b0dfeb2fe24597c8e6e4?s=128&d=identicon&r=PG&f=1", "display_name": "AleA", "link": "https://stackoverflow.com/users/5190196/alea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1391, "favorite_count": 0, "accepted_answer_id": 51484053, "answer_count": 3, "score": 0, "last_activity_date": 1600508805, "creation_date": 1458730536, "question_id": 36176222, "link": "https://stackoverflow.com/questions/36176222/libjpeg-turbo-tjcompressfromyuv", "title": "libjpeg turbo tjCompressFromYUV", "body": "<p>I'd like to compress a planar 4:2:0 YUV buffer to a jpeg image using libturbojpeg in C, but I'm having trouble using the <code>tjCompressFromYUV()</code> function.</p>\n\n<p>This is my code:</p>\n\n<pre><code>#define PADDING     2\ntjhandle tjh;\nunsigned long buf_size;\nunsigned char *jpegBuf = NULL;\nunsigned long jpegSize;\nint width = 352;\nint height = 288;\nint quality = 70;\nunsigned char *ucp_frame;\nint j;\nFILE *fp = NULL;\n\nucp_frame = malloc(width * height * 3 / 2);\nif ( NULL == ucp_frame ) {\n    printf(\"malloc error ucp_frame\\n\");\n    return 0;\n}\n\nfp = fopen(\"planar_352x288.raw\", \"rb\");\nif( NULL == fp ) {\n    printf(\"fopen error\\n\");\n    return 0;\n}\n\nj = fread( ucp_frame, 1, width * height * 3 / 2, fp);\nif( j != width * height * 3 / 2 ) {\n    printf(\"fread error\\n\");\n    return 0;\n}\nfclose(fp);\n\ntjh = tjInitCompress();\nif( NULL == tjh ) {\n    printf(\"tjInitCompress error '%s'\\n\",  tjGetErrorStr() );\n    return 0;\n}\n\nbuf_size = tjBufSizeYUV2( width, PADDING, height, TJSAMP_420);\njpegBuf = tjAlloc(buf_size);\n\nif( tjCompressFromYUV( tjh, ucp_frame, width, PADDING, height,\n                       TJSAMP_420, &amp;jpegBuf, &amp;jpegSize, quality,\n                       TJFLAG_NOREALLOC ) ) {\n    printf(\"tjCompressFromYUV error '%s'\\n\",  tjGetErrorStr() );\n}\n</code></pre>\n\n<p>The error string returned by <code>tjGetErrorStr()</code> is \"Bogus input colorspace\".</p>\n\n<p>I tried linking libturbojpeg versions 1.4.2 and 1.4.90.</p>\n\n<p>Any help wolud be appreciated,</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c", "keyword", "restrict"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 2152805, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gEKie.jpg?s=128&g=1", "display_name": "Choes", "link": "https://stackoverflow.com/users/2152805/choes"}, "edited": false, "score": 0, "creation_date": 1458731815, "post_id": 36176278, "comment_id": 59988618, "body": "I just want to comprehend this keyword, so I break the promise. it gets 10 if utilize &quot;-O1&quot; for gcc(5.2.1)."}], "tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": true, "score": 5, "last_activity_date": 1458731092, "last_edit_date": 1458731092, "creation_date": 1458730680, "answer_id": 36176278, "question_id": 36176219, "link": "https://stackoverflow.com/questions/36176219/a-puzzling-example-about-the-c-keyword-restrict/36176278#36176278", "title": "A puzzling example about the C keyword &quot;restrict&quot;", "body": "<p>Your code causes undefined behaviour. <code>restrict</code> is a promise from you to the compiler that all of the pointer parameters point to different memory areas.   </p>\n\n<p>You break this promise by putting <code>&amp;i</code> for two of the arguments.</p>\n\n<p>(In fact, with <code>restrict</code> it is allowed to pass overlapping pointers, but only if no writes are done through any of the overlapping pointers within the function. But typically you would not bother with <code>restrict</code> if there is no writing happening).</p>\n\n<hr>\n\n<p>FWIW, on my system with gcc 4.9.2, output is <code>j = 20</code> at <code>-O0</code> and <code>j = 10</code> at <code>-O1</code> or higher, which suggests that the compiler is indeed taking note of the <code>restrict</code>.  Of course, since it is undefined behaviour, your results may vary.</p>\n"}], "owner": {"reputation": 31, "user_id": 2152805, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gEKie.jpg?s=128&g=1", "display_name": "Choes", "link": "https://stackoverflow.com/users/2152805/choes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 1, "accepted_answer_id": 36176278, "answer_count": 1, "score": 0, "last_activity_date": 1458731092, "creation_date": 1458730532, "last_edit_date": 1458730994, "question_id": 36176219, "link": "https://stackoverflow.com/questions/36176219/a-puzzling-example-about-the-c-keyword-restrict", "title": "A puzzling example about the C keyword &quot;restrict&quot;", "body": "<p><a href=\"https://en.wikipedia.org/wiki/Restrict\" rel=\"nofollow\">The example</a> is taken from Wikipedia:</p>\n\n<pre><code>void updatePtrs(size_t *restrict ptrA, size_t *restrict ptrB, size_t *restrict val)\n{\n    *ptrA += *val;\n    *ptrB += *val;\n}\n</code></pre>\n\n<p>I call this function in the <code>main()</code>:</p>\n\n<pre><code>int main(void)\n{\n    size_t i = 10; \n    size_t j = 0;\n\n    updatePtrs(&amp;i, &amp;j, &amp;i);\n\n    printf(\"i = %lu\\n\", i); \n    printf(\"j = %lu\\n\", j); \n\n    return 0;\n}\n</code></pre>\n\n<p>The <code>val</code> pointer is not be loaded twice according to the Wikipedia's description, so the value of <code>j</code> should be 10, but it's 20 in fact.</p>\n\n<p>Is my comprehension about this keyword not correct? Should I utilize some specific options of <code>gcc</code>?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["python", "c", "gdb"], "comments": [{"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1458741891, "post_id": 36176038, "comment_id": 59995756, "body": "What version of gdb are you using, and on what platform? <code>data = [];  for i in range(0, 27): data.append(int(v[i]))</code> works fine for me on gdb 7.10.1, Fedora 23. Could be a bug that&#39;s been fixed."}, {"owner": {"reputation": 1032, "user_id": 917516, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f34a0152883d2ee4d60f946c00b09e08?s=128&d=identicon&r=PG", "display_name": "Steve ", "link": "https://stackoverflow.com/users/917516/steve"}, "reply_to_user": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1458747837, "post_id": 36176038, "comment_id": 60000590, "body": "@MarkPlotnick : GNU gdb (Ubuntu 7.7.1-0ubuntu5~14.04.2) 7.7.1"}, {"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1458749844, "post_id": 36176038, "comment_id": 60002147, "body": "Hmm. The <code>data.append(int(v[i]))</code> loop works for me on that version/platform, too. (64-bit). Do you have any gdb python customizations that could be redefining the way <code>gdb.Value</code>s work?"}, {"owner": {"reputation": 1032, "user_id": 917516, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f34a0152883d2ee4d60f946c00b09e08?s=128&d=identicon&r=PG", "display_name": "Steve ", "link": "https://stackoverflow.com/users/917516/steve"}, "reply_to_user": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1458751358, "post_id": 36176038, "comment_id": 60003173, "body": "Is your gdb build with Python 2.7 or 3.x ? Ubuntu uses 3.x there are no other extensions install"}, {"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1458751544, "post_id": 36176038, "comment_id": 60003303, "body": "Python 3. I&#39;m using only the software that came with the Ubuntu distro."}, {"owner": {"reputation": 1032, "user_id": 917516, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f34a0152883d2ee4d60f946c00b09e08?s=128&d=identicon&r=PG", "display_name": "Steve ", "link": "https://stackoverflow.com/users/917516/steve"}, "reply_to_user": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1459325879, "post_id": 36176038, "comment_id": 60230434, "body": "After a clean setup I&#39;m able to read the bytes using the append mehtod but it int(v[i])  maps the values to 0 or -1  not to 337 or something.."}, {"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 1, "creation_date": 1459327077, "post_id": 36176038, "comment_id": 60231130, "body": "If you declare <code>img</code> as <code>unsigned char[]</code> instead of <code>char[]</code>, <code>int(v[i])</code> will be 0 or 255 rather than 0 or -1. If you want to see the data as 377 instead of 255, you can use <code>&quot;{0:o}&quot;.format(int(v[i]))</code>."}], "owner": {"reputation": 1032, "user_id": 917516, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f34a0152883d2ee4d60f946c00b09e08?s=128&d=identicon&r=PG", "display_name": "Steve ", "link": "https://stackoverflow.com/users/917516/steve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 597, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1458730027, "creation_date": 1458730027, "question_id": 36176038, "link": "https://stackoverflow.com/questions/36176038/python-parse-gdb-value-to-bytearray", "title": "Python: parse gdb.value to bytearray", "body": "<p>I try to parse an char[] / char* from gdb.value to bytearray or a list of ints etc. </p>\n\n<p>following test code in c:</p>\n\n<pre><code>int main(int argc, char *argv[])\n{\n\n    char img[] = {0xFF, 0x00, 0xFF, 0x00, 0xFF, 0x00, 0xFF, 0x00, 0xFF,\n                  0x00, 0xFF, 0x00, 0xFF, 0x00, 0xFF, 0x00, 0xFF, 0x00,\n                  0xFF, 0x00, 0xFF, 0x00, 0xFF, 0x00, 0xFF, 0x00, 0xFF};\n\n    char* imgp = img;\n    return 0;\n}\n</code></pre>\n\n<p>first try: </p>\n\n<pre><code>v = gdb.parse_and_eval(\"img\")\nprint(v)\nl = list(bytearray(v))\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>~\"\\\"\\\\377\\\\000\\\\377\\\\000\\\\377\\\\000\\\\377\\\\000\\\\377\\\\000\\\\377\\\\000\\\\377\\\\000\\\\377\\\\000\\\\377\\\\000\\\\377\\\\000\\\\377\\\\000\\\\377\\\\000\\\\377\\\\000\\\\377\\\"\\n\"\nTypeError: 'gdb.Value' object is not iterable\\n\"\n</code></pre>\n\n<p>yay a string!?  no gdb.value -> not iterable :( but index able ... ok </p>\n\n<pre><code>data = []\nfor i in range(0, 27):\n   data.append(int(v[i]))\n</code></pre>\n\n<p>result: </p>\n\n<pre><code>Python Exception &lt;class 'gdb.MemoryError'&gt; Cannot access memory at address 0x7ffc737be000:\n</code></pre>\n\n<p>ok lets do it the \"safe\" way: </p>\n\n<pre><code> v = gdb.parse_and_eval(\"img\") \n inferior = gdb.selected_inferior()\n mem = inferior.read_memory(v, 27)\n</code></pre>\n\n<p>result: </p>\n\n<pre><code>Python Exception &lt;class 'gdb.MemoryError'&gt; Cannot access memory at address 0x7ffc737be000:\n</code></pre>\n\n<p>Okay whats wrong? How do I get this data out of the gdb.value type?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1458730284, "post_id": 36175955, "comment_id": 59987602, "body": "What did you try ? What prevents you from inserting an <code>if</code> statement at the appropriate place ?"}], "answers": [{"comments": [{"owner": {"reputation": 528, "user_id": 5153946, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J4cXX.jpg?s=128&g=1", "display_name": "George Bou", "link": "https://stackoverflow.com/users/5153946/george-bou"}, "edited": false, "score": 0, "creation_date": 1458754573, "post_id": 36176363, "comment_id": 60005375, "body": "@megasxrl did you find this answer useful? any feedback?"}], "tags": [], "owner": {"reputation": 528, "user_id": 5153946, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J4cXX.jpg?s=128&g=1", "display_name": "George Bou", "link": "https://stackoverflow.com/users/5153946/george-bou"}, "is_accepted": false, "score": 2, "last_activity_date": 1458731775, "last_edit_date": 1458731775, "creation_date": 1458730957, "answer_id": 36176363, "question_id": 36175955, "link": "https://stackoverflow.com/questions/36175955/incorporating-an-if-statement-to-set-value-limits/36176363#36176363", "title": "incorporating an if statement to set value limits", "body": "<p>I think a <code>while</code> statement would be more useful than <code>if</code>.</p>\n\n<p>First ask the user to enter the value. Then while the user enters incorrect values you keep asking him again.</p>\n\n<p>It could look like this:</p>\n\n<pre><code>printf(\"Line: \");\nscanf(\"%d\",&amp;shot[0]);\nwhile(shot[0]&lt;lower_bound || shot[0]&gt;upper_bound){\n    printf(\"Incorrect entry\");\n    printf(\"Enter a correct Line: \");\n    scanf(\"%d\",&amp;shot[0]);\n}\nshot[0]--;\n</code></pre>\n\n<p>If you really need the <code>if</code> you could change the <code>while</code> with the <code>if</code>, but that would only check the value once whereas a while statement keeps checking until you get what you need.</p>\n"}], "owner": {"reputation": 25, "user_id": 5580464, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/609b2aaa4ccdced3f2d27083c72d86a1?s=128&d=identicon&r=PG&f=1", "display_name": "megasxrl", "link": "https://stackoverflow.com/users/5580464/megasxrl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1458731775, "creation_date": 1458729830, "question_id": 36175955, "link": "https://stackoverflow.com/questions/36175955/incorporating-an-if-statement-to-set-value-limits", "title": "incorporating an if statement to set value limits", "body": "<p>I am creating a battleship program for my program; the program works fine but im trying to make sure when the user puts a coordinate out of range the program will say the coordinate they've inputted is incorrect. this is the code:</p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n    #include &lt;stdlib.h&gt;\n\n    void startBoard(int board[][5])\n{\n  int line, column;\n    for(line=0 ; line &lt; 5 ; line++ )\n        for(column=0 ; column &lt; 5 ; column++ )\n            board[line][column]=-1;\n }\n\nvoid showBoard(int board[][5])\n{\n\nint line, column;\n\n    printf(\"\\t1 \\t2 \\t3 \\t4 \\t5\");\n    printf(\"\\n\");\n\n    for(line=0 ; line &lt; 5 ; line++ ){\n        printf(\"%d\",line+1);\n        for(column=0 ; column &lt; 5 ; column++ ){\n            if(board[line][column]==-1){\n                printf(\"\\t~\");\n            }else if(board[line][column]==0){\n                printf(\"\\t*\");\n            }else if(board[line][column]==1){\n                printf(\"\\tX\");\n            }\n\n        }\n        printf(\"\\n\");\n    }\n\n}\n\nvoid startShips(int ships[][2]){\n    srand(time(NULL));\n    int ship, last;\n\n    for(ship=0 ; ship &lt; 3 ; ship++){\n        ships[ship][0]= rand()%5;\n        ships[ship][1]= rand()%5;\nfor(last=0 ; last &lt; ship ; last++){\n            if( (ships[ship][0] == ships[last][0])&amp;&amp;(ships[ship][1] == ships[last][1]) )\n                do{\n                    ships[ship][0]= rand()%5;\n                    ships[ship][1]= rand()%5;\n                }while( (ships[ship][0] == ships[last][0])&amp;&amp;(ships[ship][1] == ships[last][1]) );\n        }\n\n    }\n}\n\nvoid giveShot(int shot[2])\n{\n\n    printf(\"Line: \");\n    scanf(\"%d\",&amp;shot[0]);\n    shot[0]--;\n\n    printf(\"Column: \");\n    scanf(\"%d\",&amp;shot[1]);\n    shot[1]--;\n\n}\n\nint hitship(int shot[2], int ships[][2])\n{\n    int ship;\n\n    for(ship=0 ; ship &lt; 3 ; ship++){\n        if( shot[0]==ships[ship][0] &amp;&amp; shot[1]==ships[ship][1]){\n            printf(\"You hit a ship with the shot (%d,%d)\\n\",shot[0]+1,shot[1]+1);\n            return 1;\n        }\n    }\n    return 0;\n}\n\nvoid tip(int shot[2], int ships[][2], int attempt)\n{\n    int line=0,\n        column=0,\n        row;\n\n    //count how many ships there is line/column\n    for(row=0 ; row &lt; 3 ; row++){\n        if(ships[row][0]==shot[0])\n            line++;\n        if(ships[row][1]==shot[1])\n            column++;\n    }\n\n    printf(\"\\nDica %d: \\nline %d -&gt; %d ships\\ncolumn %d -&gt; %d ships\\n\",attempt,shot[0]+1,line,shot[1]+1,column);\n }\n\n void changeBoard(int shot[2], int ships[][2], int board[][5]){\n    if(hitship(shot,ships))\n        board[shot[0]][shot[1]]=1;\n    else\n        board[shot[0]][shot[1]]=0;\n}\n\nint main() {\n    int board[5][5];\n    int ships[3][2];\n    int shot[2];\n    int attempts=0,\n        hits=0;\n\n    startBoard(board);\n    startShips(ships);\n\n    printf(\"\\n\");\n\n    do{\n        showBoard(board);\n        giveShot(shot);\n        attempts++;\n\n        if(hitship(shot,ships)){\n            tip(shot,ships,attempts);\n            hits++;\n        }\n        else\n            tip(shot,ships,attempts);\n\n        changeBoard(shot,ships,board);\n\n\n    }while(hits!=3);\n\n    printf(\"\\n\\n\\nFinished game. You hit the three ships in %d attempts\", attempts);\n    showBoard(board);\n}\n</code></pre>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1458730163, "post_id": 36175915, "comment_id": 59987517, "body": "Presumably, you only close the connection at process termination?  I mean, you don&#39;t open and close it at 100Hz?"}, {"owner": {"reputation": 3068, "user_id": 553735, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/1e348f8a50d94baf7d0a434e63967ca6?s=128&d=identicon&r=PG", "display_name": "Srv19", "link": "https://stackoverflow.com/users/553735/srv19"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1458731789, "post_id": 36175915, "comment_id": 59988599, "body": "Correct; i read from serial device with blocking read() calls in sycle with select(). I close connection when process is being terminated after recieving appropriate signal (i handle SIGINT, to be specific)."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1458735229, "post_id": 36175915, "comment_id": 59990814, "body": "Orite:)  OK, then, what happens when you comment out those closing operations, maybe binary-chop them?"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1458736467, "post_id": 36175915, "comment_id": 59991709, "body": "Also, I dread to think what &#39;valid reasons&#39; there might be for disabling the FIFO buffer.  You wil get up to 16 times more interrupts:("}, {"owner": {"reputation": 3068, "user_id": 553735, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/1e348f8a50d94baf7d0a434e63967ca6?s=128&d=identicon&r=PG", "display_name": "Srv19", "link": "https://stackoverflow.com/users/553735/srv19"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1458739526, "post_id": 36175915, "comment_id": 59993949, "body": "It is better then recieving an interrupt 1/100 of a second late, or so it goes"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1458779611, "post_id": 36175915, "comment_id": 60017246, "body": "this lines: `   if(poldconfig != NULL)         memcpy(poldconfig, &amp;config, sizeof(struct termios));` is probably wrong,  suggest: <code>struct termios oldconfig;  memcpy( &amp;oldconfig, &amp;config, sizeof( struct termios) );</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1458779744, "post_id": 36175915, "comment_id": 60017270, "body": "this line: <code>int fd = open(pconfig-&gt;device, async? flag | O_NONBLOCK: flag);</code>  <code>async</code> is not defined in the posted code"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1458779931, "post_id": 36175915, "comment_id": 60017312, "body": "the use of <code>!!</code> just clutters the code,  suggest dropping both of those operators in all instances of their use in the posted code."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1458780104, "post_id": 36175915, "comment_id": 60017354, "body": "when working with the hardware of a communications port, you cannot change its&#39; type.  I.E. if it is a <code>16550A</code> it will always be a <code>16550A</code>.  Do not try to change its&#39; type."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1458780929, "post_id": 36175915, "comment_id": 60017592, "body": "the posted question does not indicate the actual baud rate.  However, of prime importance is Given some baud rate, can the OS (and your program) keep up with it?   are you using interrupts or polling?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1458781134, "post_id": 36175915, "comment_id": 60017651, "body": "the posted question does not contain enough information on several important areas to enable us to debug your problem.   Some things of interest:  what OS, What else is running, hardware at the actual port, which port driver,  number of bytes in each input burst, baud rate, CPU clock rate, etc etc etc"}, {"owner": {"reputation": 3068, "user_id": 553735, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/1e348f8a50d94baf7d0a434e63967ca6?s=128&d=identicon&r=PG", "display_name": "Srv19", "link": "https://stackoverflow.com/users/553735/srv19"}, "edited": false, "score": 0, "creation_date": 1458800429, "post_id": 36175915, "comment_id": 60022591, "body": "user3629249: thank you for comments. I will add clarifications where it is possible"}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1458831787, "post_id": 36175915, "comment_id": 60039981, "body": "Assuming you cannot kill the offending process with <code>kill -KILL pid</code> either, and looking at the <a href=\"http://www.moxa.com/support/DownloadFile.aspx?type=support&amp;id=952\" rel=\"nofollow noreferrer\">x86-64 driver</a> (latest version from 2012), I&#39;d guess the driver is buggy. (Specifically, in the <code>close_wait</code> queue handling.) Not pushing the Linux driver upstream is just stupid, as out of tree drivers are quaranteed to stop working at some point unless actively maintained. (A &quot;stable driver API&quot; would kill the development rate and restrict all changes, so in-tree drivers are the only viable way.)"}, {"owner": {"reputation": 3068, "user_id": 553735, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/1e348f8a50d94baf7d0a434e63967ca6?s=128&d=identicon&r=PG", "display_name": "Srv19", "link": "https://stackoverflow.com/users/553735/srv19"}, "edited": false, "score": 0, "creation_date": 1458886784, "post_id": 36175915, "comment_id": 60062471, "body": "When the program hangs, only thing i can do is suspend it and run it to the background (nominally it runs at foreground to be stopped with Ctrl-C at my convenience). After that, i have tried <code>kill</code> and attaching with <code>gdb</code> - but no changes in the process state were brought about. As i am not proficient enough to fix the driver myself, i am leaning towards trying to make an <code>SIGALARM</code> handler which calls <code>exit</code>"}], "owner": {"reputation": 3068, "user_id": 553735, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/1e348f8a50d94baf7d0a434e63967ca6?s=128&d=identicon&r=PG", "display_name": "Srv19", "link": "https://stackoverflow.com/users/553735/srv19"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 150, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1458802256, "creation_date": 1458729736, "last_edit_date": 1458802256, "question_id": 36175915, "link": "https://stackoverflow.com/questions/36175915/program-hangs-when-setting-serial-port-parameters", "title": "Program hangs when setting serial port parameters", "body": "<p>In my program a connection is opened with serial port that recieves 10-byte packages with set frequency (usually 100 Hz). However i have run into the following problem: sometimes (but not always) when i am closing connection, the program hangs.</p>\n\n<p>In the following code i do not specify constants; at runtime connection parameters (baud rate, parity...) are determined from command line. In practice, connection is usually opened with baud rate 230400, no parity, 8-bit character size and 1 stop bit.</p>\n\n<p>This is how i am opening serial port:</p>\n\n<pre><code>struct termios config;\nLOGPRINT(\"Will operate on device \\'%s\\'\\n\", pconfig-&gt;device);\nLOGPRINT(\"Opening serial device\\n\");\nint flag = O_RDWR | O_NOCTTY | ASYNC_LOW_LATENCY;\n// pconfig contains some necessary information to set connection parameters\n// async == false for connectin that causes problems\nint fd = open(pconfig-&gt;device, async? flag | O_NONBLOCK: flag);\nif(fd == -1)\n{ /* skipped error handling */  }\n\nLOGPRINT(\"Retrieving terminal attributes\\n\");\nif(!!tcgetattr(fd, &amp;config))\n{ /* skipped error handling */  }\nelse\n{\n    // backup old configuration for restoring it on exit\n    if(poldconfig != NULL)\n        memcpy(poldconfig, &amp;config, sizeof(struct termios));\n\n    LOGPRINT(\"Setting terminal attributes\\n\");\n    set_attribs(fd, &amp;config, pconfig);\n}\n...\nint set_attribs(const int fd, struct termios* pterm, const struct serial_config* pconfig)\n{\n    // set baud rate\n    // baud_rates contains integers of actual rates\n    LOGPRINT(\"Setting baud rate to %d.\\n\", baud_rates[pconfig-&gt;baud_rate_index]);\n    // change to raw mode\n    LOGPRINT(\"Setting terminal to raw mode\\n\");\n    pterm-&gt;c_iflag &amp;= ~(IGNBRK | BRKINT | PARMRK | ISTRIP | INLCR\n                        | IGNCR | ICRNL | IXON);\n    pterm-&gt;c_oflag &amp;= OPOST;\n    pterm-&gt;c_lflag &amp;= ~(ECHO | ECHONL | ICANON | ISIG | IEXTEN);\n    // baud_bits contains actual pre-defined baud rate flags\n    cfsetispeed(pterm, baud_bits[pconfig-&gt;baud_rate_index]);\n    cfsetospeed(pterm, baud_bits[pconfig-&gt;baud_rate_index]);\n    LOGPRINT(\"Set character size, parity and stop bit flags.\\n\");\n    // set character size\n    pterm-&gt;c_cflag &amp;= ~CSIZE;\n    pterm-&gt;c_cflag |= pconfig-&gt;csize_flag;\n    // set parity\n    pterm-&gt;c_cflag &amp;= ~(PARENB | PARODD);\n    pterm-&gt;c_cflag |= pconfig-&gt;parity_flag;\n    // set stopbits\n    pterm-&gt;c_cflag &amp;= ~CSTOPB;\n    pterm-&gt;c_cflag |= pconfig-&gt;stopbits_flag;\n\n    // enable reading; ignore control lines\n    pterm-&gt;c_cflag |= CREAD | CLOCAL;\n    LOGPRINT(\"Flush terminal.\\n\");\n    // flush terminal\n    tcflush(fd, TCIOFLUSH);\n    LOGPRINT(\"Apply parameters.\\n\");\n    return tcsetattr(fd, TCSANOW, pterm);\n}\n</code></pre>\n\n<p>For valid reasons, i needed to force serial device driver to use 1-byte buffer for incoming/outgoing data, which i have set using this function:</p>\n\n<pre><code>int set_port_type(int fd, int ptype)\n{\n    struct serial_struct temp;\n    int res = ioctl(fd, TIOCGSERIAL, &amp;temp);\n    if(!!res)\n    { /* stipped error handling */ }\n    temp.type = ptype;\n    res = ioctl(fd, TIOCSSERIAL, &amp;temp);\n    if(!!res)\n    { /* stipped error handling */ }\n    return res;\n}\n</code></pre>\n\n<p>with ptype = PORT_UNKNOWN or ptype = PORT_16450.</p>\n\n<p>When finished with serial port, i perform the following operations:</p>\n\n<ol>\n<li>Flush it</li>\n<li>Set its type back to 16550A</li>\n<li>Restore its settigns to saved ones</li>\n<li>Close it</li>\n</ol>\n\n<p>From time to time it causes the program to hang and stop responding to any external stimulus. It forces me to suspend the program and then reboot system, as it never releases file descriptors it holds.</p>\n\n<p>What can i do to ensure that does not happen? Even if settings are not restored, the program needs to close on its own - maybe with error code.</p>\n\n<p>Operating system i am using is TinyCore Linux. No other user program is being run an the same time as my program.</p>\n\n<p>IMportant clarification. Serial device i am working with is actually NPort 5232 - asyncronous RS-422/485 - Ethernet communicator (<a href=\"http://www.moxa.com/product/NPort_5210.htm\" rel=\"nofollow\">description from vendor</a>. Consequently, serial devices i am working with are virtual, which enables me to try and change their type / size of internal buffer.</p>\n"}, {"tags": ["c", "unions"], "answers": [{"comments": [{"owner": {"reputation": 18883, "user_id": 2612235, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/dpsjq.jpg?s=128&g=1", "display_name": "nowox", "link": "https://stackoverflow.com/users/2612235/nowox"}, "edited": false, "score": 0, "creation_date": 1458735108, "post_id": 36176350, "comment_id": 59990730, "body": "I&#39;ve edited my question I think I was confused of what my real problem was."}], "tags": [], "owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "is_accepted": true, "score": 2, "last_activity_date": 1458730919, "creation_date": 1458730919, "answer_id": 36176350, "question_id": 36175877, "link": "https://stackoverflow.com/questions/36175877/default-type-for-unions/36176350#36176350", "title": "Default type for Unions", "body": "<p>No, it is not part of standard C.</p>\n\n<p>If any compilers support it (I'm not sure offhand, as I've never sought to use such a feature) it will be a vendor-specific extension.</p>\n\n<p>It is possible in C++ for a union to have an <code>operator[]()</code>, but there is no equivalent in C.   The only time I saw it used, I had to resist temptation to strangle the programmer.</p>\n"}], "owner": {"reputation": 18883, "user_id": 2612235, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/dpsjq.jpg?s=128&g=1", "display_name": "nowox", "link": "https://stackoverflow.com/users/2612235/nowox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 36176350, "answer_count": 1, "score": 0, "last_activity_date": 1462206337, "creation_date": 1458729633, "last_edit_date": 1462206337, "question_id": 36175877, "link": "https://stackoverflow.com/questions/36175877/default-type-for-unions", "title": "Default type for Unions", "body": "<p>I've heard that some compilers allows the following: </p>\n\n<pre><code>union {\n   int array[2]; // The default type for this union is `int[2]`\n   struct {\n      int low;\n      int high;\n   } word;\n} foo;\n\n\n// Normal usage\nfoo.a[0] = 0; \nfoo.low = 0\n\n// What I am looking for\nfoo[0] = 0;\n</code></pre>\n\n<p>Is it part of the C99/C11 standards? </p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I think I've found what was making me confused. We can actually declare an union without name in C. </p>\n\n<pre><code>struct {\n   union {\n      int all[2];\n      struct {\n         int low;\n         int high;\n      } word;\n   } bar;\n} foo;\n\nfoo.bar.all[0];\nfoo.bar.low;\nfoo.bar.high;\n</code></pre>\n\n<p>In that particular case It solves my XY problem.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 6508, "user_id": 5962841, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qD8gs.jpg?s=128&g=1", "display_name": "Mafii", "link": "https://stackoverflow.com/users/5962841/mafii"}, "edited": false, "score": 0, "creation_date": 1458729635, "post_id": 36175838, "comment_id": 59987168, "body": "Exactly <i>&quot;Only primitive types or enumeration types are supported in this context&quot;</i> You can&#39;t use custom classes, you must use primitive types or lists of primitive types"}, {"owner": {"reputation": 93252, "user_id": 861716, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb1a28030a6da0e72693e36c77eb3cd6?s=128&d=identicon&r=PG", "display_name": "Gert Arnold", "link": "https://stackoverflow.com/users/861716/gert-arnold"}, "edited": false, "score": 0, "creation_date": 1458773507, "post_id": 36175838, "comment_id": 60015369, "body": "I rolled back your revision in which you erased everything but the first sentence. The code is the relevant part, also after a question has been answered."}], "answers": [{"tags": [], "owner": {"reputation": 21585, "user_id": 2410379, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/X2Tci.jpg?s=128&g=1", "display_name": "David Pine", "link": "https://stackoverflow.com/users/2410379/david-pine"}, "is_accepted": false, "score": 0, "last_activity_date": 1458731712, "creation_date": 1458731712, "answer_id": 36176654, "question_id": 36175838, "link": "https://stackoverflow.com/questions/36175838/creating-constant-values/36176654#36176654", "title": "Creating constant values", "body": "<p>It appears as though the issue is that the <code>user.Roles</code> is a different type than the <code>db.Roles</code>. As such one cannot possibly contain the other.</p>\n\n<p>Try rewriting that as this:</p>\n\n<pre><code>return View(new UsersEdit\n{\n    Username = user.Username,\n    Email = user.Email,\n\n    Roles = db.Roles.Select(r =&gt; new RoleCheckbox\n    {\n        Id = r.Id,\n        //This should no longer cause an issue.\n        IsChecked = user.Roles.Any(role =&gt; role.Id == r.Id),\n        Name = r.Name\n    }).ToList()\n});\n</code></pre>\n\n<p>With <code>Linq</code> you can use <code>.Any</code> and pass a predicate that will evaluate in a similar fashion to the <code>.Contains</code> you were looking to achieve.</p>\n"}, {"tags": [], "owner": {"reputation": 157412, "user_id": 5202563, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2mKKQ.png?s=128&g=1", "display_name": "Ivan Stoev", "link": "https://stackoverflow.com/users/5202563/ivan-stoev"}, "is_accepted": false, "score": 0, "last_activity_date": 1458733309, "creation_date": 1458733309, "answer_id": 36177233, "question_id": 36175838, "link": "https://stackoverflow.com/questions/36175838/creating-constant-values/36177233#36177233", "title": "Creating constant values", "body": "<p>The error message is telling you that LINQ to Entities does not support <code>Contains</code> with class (<code>RoleEntity</code> in your case).</p>\n\n<p>What you need to do is to create a list of \"primitive types\", in your case list of <code>int</code> containing role <code>Id</code>s.</p>\n\n<pre><code>var userRoleIds = user.Roles.Select(r =&gt; r.Id).ToList();\n</code></pre>\n\n<p>and then use it as follows</p>\n\n<pre><code>IsChecked = userRoleIds.Contains(r.Id),\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 218, "user_id": 1358742, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/00DG7.jpg?s=128&g=1", "display_name": "Ivan Eftimov", "link": "https://stackoverflow.com/users/1358742/ivan-eftimov"}, "is_accepted": true, "score": 0, "last_activity_date": 1458733480, "creation_date": 1458733480, "answer_id": 36177295, "question_id": 36175838, "link": "https://stackoverflow.com/questions/36175838/creating-constant-values/36177295#36177295", "title": "Creating constant values", "body": "<p>You should execute the db.Roles query first, using <strong>ToList()</strong> and your code should work: </p>\n\n<pre><code>Roles = db.Roles.ToList().Select(r =&gt; new RoleCheckbox\n{\n    Id = r.Id,\n    //This should work now\n    IsChecked = user.Roles.Contains(r),\n    Name = r.Name\n}).ToList()\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 5447211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28c06697a65473e9521dee7fbbf7af71?s=128&d=identicon&r=PG&f=1", "display_name": "btag", "link": "https://stackoverflow.com/users/5447211/btag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "closed_date": 1458788991, "accepted_answer_id": 36177295, "answer_count": 3, "score": -1, "last_activity_date": 1458781541, "creation_date": 1458729530, "last_edit_date": 1458781541, "question_id": 36175838, "link": "https://stackoverflow.com/questions/36175838/creating-constant-values", "closed_reason": "Not suitable for this site", "title": "Creating constant values", "body": "<p>Im trying to get all the genres from my context and display them.</p>\n\n<p>This what I get when I run the program:</p>\n\n<p>Unable to create a constant value of type 'MyBooks.Models.BookEntity'. Only primitive types or enumeration types are supported in this context.</p>\n\n<p>Edit</p>\n\n<pre><code>return View(new BooksEdit\n{\n    BookName = book.BookName,\n\n    Genre = context.Genre.Select(b =&gt; new GenreList\n    {\n        Id = b.Id,\n        //This causes the error\n        yesGenre = book.Genres.Contains(b),\n        BookName = b.Name\n    }).ToList()\n});\n</code></pre>\n\n<p>Book</p>\n\n<pre><code>public class Book\n{\n    public virtual int Id { get; set; }\n    public virtual string BookName{ get; set; }\n\n    public virtual IList&lt;GEnre&gt; Genres{ get; set; }\n\n    public Book()\n    {\n        Genres = new List&lt;Genre&gt;();\n    }\n}\n</code></pre>\n\n<p>Genre</p>\n\n<pre><code>public class Genre\n{\n    public virtual int Id { get; set; }\n    public virtual string GEnreName{ get; set; }\n\n    public virtual IList&lt;Book&gt; Books{ get; set; }\n\n}\n</code></pre>\n\n<p>ViewModel</p>\n\n<pre><code>public class GenreList\n{\n    public int Id { get; set; }\n    public bool yesGenre{ get; set; }\n    public string GenreName{ get; set; }\n}\n\npublic class BookEdit\n{\n\n    public IList&lt;GenreList&gt; Genres{ get; set; } \n\n    public string BookName{ get; set; } \n}\n</code></pre>\n"}, {"tags": ["c", "sockets", "unix", "client-server"], "answers": [{"comments": [{"owner": {"reputation": 521, "user_id": 5737877, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/f08281b24fa35630459e7dd70c388b4c?s=128&d=identicon&r=PG&f=1", "display_name": "A.Cho", "link": "https://stackoverflow.com/users/5737877/a-cho"}, "edited": false, "score": 0, "creation_date": 1458728139, "post_id": 36175220, "comment_id": 59986121, "body": "It means that <code>close()</code> doesn&#39;t return in the kernel until finishing final handshaking, like file descriptor is not fully closed when one process is opening file although its reference count is zero?"}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "reply_to_user": {"reputation": 521, "user_id": 5737877, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/f08281b24fa35630459e7dd70c388b4c?s=128&d=identicon&r=PG&f=1", "display_name": "A.Cho", "link": "https://stackoverflow.com/users/5737877/a-cho"}, "edited": false, "score": 0, "creation_date": 1458728202, "post_id": 36175220, "comment_id": 59986164, "body": "No, it doesn&#39;t mean any of that. &#39;Asynchronous&#39; means it <i>does</i> return before processing is finished, and the FD is closed but the connection lingers on ..."}], "tags": [], "owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "is_accepted": true, "score": 1, "last_activity_date": 1458727899, "creation_date": 1458727899, "answer_id": 36175220, "question_id": 36175137, "link": "https://stackoverflow.com/questions/36175137/when-the-servers-child-close-socket/36175220#36175220", "title": "when the server&#39;s child close socket", "body": "<p>Yes it does. <code>close()</code> is normally asynchronous.</p>\n"}, {"tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": false, "score": 1, "last_activity_date": 1458738969, "creation_date": 1458738969, "answer_id": 36179236, "question_id": 36175137, "link": "https://stackoverflow.com/questions/36175137/when-the-servers-child-close-socket/36179236#36179236", "title": "when the server&#39;s child close socket", "body": "<p>Yes, <code>close()</code> on sockets is normally asynchronous, and sockets can linger after application is terminated. You can easily see them in <code>netstat</code> output in their approriate state (for example, <code>TIME_WAIT</code> or <code>FIN_WAIT2</code>).</p>\n"}], "owner": {"reputation": 521, "user_id": 5737877, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/f08281b24fa35630459e7dd70c388b4c?s=128&d=identicon&r=PG&f=1", "display_name": "A.Cho", "link": "https://stackoverflow.com/users/5737877/a-cho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 36175220, "answer_count": 2, "score": 0, "last_activity_date": 1458738969, "creation_date": 1458727705, "question_id": 36175137, "link": "https://stackoverflow.com/questions/36175137/when-the-servers-child-close-socket", "title": "when the server&#39;s child close socket", "body": "<p>On the concurrent server, server spawns many children(assume that I am using multiple process when clients connet). So, if client close sockets(<code>close()</code> function), it sends <code>FIN</code> to server and receive <code>ACK</code> from the server.</p>\n\n<p>Finally, server's <code>read()</code> function returns <code>0</code> and <code>exit()</code> function is called. It causes server child to terminate and close socket, and send <code>FIN</code> to its client.</p>\n\n<p>In this situation, how can server receive <code>ACK</code> even though server's child socket is closed? and how can server re-send <code>FIN</code> when client doesn't receive the <code>FIN</code> even though there is no connected socket because of child which is terminated?</p>\n\n<p>Does kernel keep that terminated process's socket until finishing final four-handshaking although it is closed?</p>\n"}, {"tags": ["c", "debugging", "lldb"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1458726384, "post_id": 36174473, "comment_id": 59984955, "body": "In <a href=\"http://lldb.llvm.org/tutorial.html\" rel=\"nofollow noreferrer\">this LLDB tutorial</a> there&#39;s a section named &quot;Examining Thread State&quot; which shows you commands to list threads and to select thread context. Not knowing if this is the problem, you might want to select the right thread context for it to work?"}], "answers": [{"tags": [], "owner": {"reputation": 20083, "user_id": 2465073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0f7ba796598ce99fe9d17b66c119b00?s=128&d=identicon&r=PG", "display_name": "Jim Ingham", "link": "https://stackoverflow.com/users/2465073/jim-ingham"}, "is_accepted": true, "score": 2, "last_activity_date": 1458771196, "creation_date": 1458771196, "answer_id": 36189704, "question_id": 36174473, "link": "https://stackoverflow.com/questions/36174473/lldb-cannot-print-tls-variable/36189704#36189704", "title": "lldb cannot print TLS variable", "body": "<p>lldb doesn't currently support thread local storage variables on OS X (not sure about Linux.)  You can work around this by making accessor functions for your TLS variables, and calling those after selecting the appropriate thread.</p>\n"}], "owner": {"reputation": 3214, "user_id": 4333809, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb246fedefccc8b02a3efb989143d3b9?s=128&d=identicon&r=PG&f=1", "display_name": "Zohar81", "link": "https://stackoverflow.com/users/4333809/zohar81"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 347, "favorite_count": 0, "accepted_answer_id": 36189704, "answer_count": 1, "score": 0, "last_activity_date": 1458771196, "creation_date": 1458725907, "question_id": 36174473, "link": "https://stackoverflow.com/questions/36174473/lldb-cannot-print-tls-variable", "title": "lldb cannot print TLS variable", "body": "<p>I've decided to use TLS variables on my C project to define some variables that should be valid throughout thread scope. </p>\n\n<p>Here's my declaration : \n<code>static __thread char log_username[100];</code> </p>\n\n<p>however, for some reason the lldb debugger fail to show them for the following reason :</p>\n\n<pre><code>(lldb) print log_username[2]\nerror: Couldn't materialize: couldn't get the value of variable log_username: \nNo TLS data currently exists for this thread.\nErrored out in Execute, couldn't PrepareToExecuteJITExpression\n</code></pre>\n\n<p>The debugger states that TLS data is currently not available, but if I use simple printf, it works. </p>\n\n<p>Any idea how to resolve this, or just treat it as debugger limitation that I can live with ... </p>\n"}, {"tags": ["c", "time", "multiplication", "gmp"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458726036, "post_id": 36174315, "comment_id": 59984711, "body": "Please use all-uppercase names for macros. And format&amp;indent your code properly."}, {"owner": {"reputation": 361, "user_id": 2764478, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/75c03e9ad9b4ef0091f7a9da911a6445?s=128&d=identicon&r=PG&f=1", "display_name": "Rick", "link": "https://stackoverflow.com/users/2764478/rick"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458726371, "post_id": 36174315, "comment_id": 59984945, "body": "Changed the macros. Can you please tell me about the problem in indentation and format. I will be happy to change."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458726465, "post_id": 36174315, "comment_id": 59985008, "body": "See your code! If still unsure seach for &quot;C indentation style&quot;. Pick one (if possible not too exotic) and use that consistently."}], "answers": [{"tags": [], "owner": {"reputation": 4569, "user_id": 1282773, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/GFxGD.jpg?s=128&g=1", "display_name": "ivaigult", "link": "https://stackoverflow.com/users/1282773/ivaigult"}, "is_accepted": false, "score": 1, "last_activity_date": 1458729729, "creation_date": 1458729729, "answer_id": 36175912, "question_id": 36174315, "link": "https://stackoverflow.com/questions/36174315/gmp-timing-difference-for-different-integer-size/36175912#36175912", "title": "GMP timing difference for different integer size;", "body": "<p>According to <a href=\"https://gmplib.org/gmp-man-6.1.0.pdf\" rel=\"nofollow\">GMP documentation</a> 15.1 section, the library uses different multiplication algorithms for different sizes of operands. Look at thresholds table:</p>\n\n<pre><code>| Algorithm | Threshold            |\n|-----------|----------------------|\n| Basecase  | (none)               |\n| Karatsuba | MUL_TOOM22_THRESHOLD |\n| Toom-3    | MUL_TOOM33_THRESHOLD |\n| Toom-4    | MUL_TOOM44_THRESHOLD |\n| Toom-6.5  | MUL_TOOM6H_THRESHOLD |\n| Toom-8.5  | MUL_TOOM8H_THRESHOLD |\n| FFT       | MUL_FFT_THRESHOLD    |    \n</code></pre>\n\n<p>So, since the algorithms are different timings might be different too.</p>\n"}, {"comments": [{"owner": {"reputation": 6533, "user_id": 1918193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b70a14318e0f417ecac47809f38fafc?s=128&d=identicon&r=PG", "display_name": "Marc Glisse", "link": "https://stackoverflow.com/users/1918193/marc-glisse"}, "edited": false, "score": 1, "creation_date": 1458730548, "post_id": 36176185, "comment_id": 59987772, "body": "every mpz_init should have a corresponding mpz_free. Or better yet to measure the multiplication time, the same variables should be reused."}], "tags": [], "owner": {"reputation": 6353, "user_id": 1486562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01e47645a7afc7e351b193d12de90a43?s=128&d=identicon&r=PG", "display_name": "flaviodesousa", "link": "https://stackoverflow.com/users/1486562/flaviodesousa"}, "is_accepted": false, "score": 0, "last_activity_date": 1458730426, "creation_date": 1458730426, "answer_id": 36176185, "question_id": 36174315, "link": "https://stackoverflow.com/questions/36174315/gmp-timing-difference-for-different-integer-size/36176185#36176185", "title": "GMP timing difference for different integer size;", "body": "<p>Try a longer sample. I've changed REPEAT to 10000000 and those</p>\n\n<pre><code>mpz_t a[REPEAT];\nmpz_t b[REPEAT];\nmpz_t a1[REPEAT];\nmpz_t b1[REPEAT];\nmpz_t r[REPEAT];\nmpz_t r1[REPEAT];\n</code></pre>\n\n<p>to</p>\n\n<pre><code>static mpz_t a[REPEAT];\nstatic mpz_t b[REPEAT];\nstatic mpz_t a1[REPEAT];\nstatic mpz_t b1[REPEAT];\nstatic mpz_t r[REPEAT];\nstatic mpz_t r1[REPEAT];\n</code></pre>\n\n<p>So after 3 runs I got:</p>\n\n<pre><code>$ gcc -O2 gmp_bench.c -lgmp\n$ time ./a.out             \nNumber of seconds: 12.689352\nNumber of seconds: 18.295134\n./a.out  34.54s user 1.27s system 99% cpu 35.820 total\n$ time ./a.out\nNumber of seconds: 12.647052\nNumber of seconds: 17.918326\n./a.out  34.08s user 1.35s system 99% cpu 35.426 total\n$ time ./a.out\nNumber of seconds: 12.647854\nNumber of seconds: 18.106714\n./a.out  34.29s user 1.28s system 99% cpu 35.581 total\n$\n</code></pre>\n\n<p>By monitoring the execution I've noticed the memory allocated is constantly increasing so allocation overhead may be a higher performance toll than the algorithm itself.</p>\n"}], "owner": {"reputation": 361, "user_id": 2764478, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/75c03e9ad9b4ef0091f7a9da911a6445?s=128&d=identicon&r=PG&f=1", "display_name": "Rick", "link": "https://stackoverflow.com/users/2764478/rick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1458730426, "creation_date": 1458725469, "last_edit_date": 1458727234, "question_id": 36174315, "link": "https://stackoverflow.com/questions/36174315/gmp-timing-difference-for-different-integer-size", "title": "GMP timing difference for different integer size;", "body": "<p>Can anyone tell me how the time taken by differs in GMP if I use operands of different size.\nFor example : the below code </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;gmp.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n#define REPEAT 10000\n\nvoid full_mult(mpz_t r,mpz_t a,mpz_t b)\n{\n    mpz_t temp;\n    mpz_init(temp);\n\n    mpz_mul(r,a,b);\n    mpz_add(temp,a,b);\n    mpz_sub(a,a,b);\n    mpz_mul(temp,temp,a);\n    /*the above code 10 more times*/\n}\n\nvoid half_mult(mpz_t r,mpz_t a,mpz_t b)\n{\n    mpz_t temp;\n    mpz_init(temp);\n\n    mpz_mul(r,a,b);\n    mpz_add(temp,a,b);\n    mpz_sub(a,a,b);\n    mpz_mul(temp,temp,a);\n    /*the above code then more times*/\n}\n\n\nvoid main()\n{\n\n    long int i;\n    clock_t start, end;\n    double cpu_time_used;\n\n    gmp_randstate_t state;\n    gmp_randinit_mt(state);\n\n    mpz_t a[REPEAT];\n    mpz_t b[REPEAT];\n    mpz_t a1[REPEAT];\n    mpz_t b1[REPEAT];\n    mpz_t r[REPEAT];\n    mpz_t r1[REPEAT];\n\n    for(i=0;i&lt;REPEAT;i++)\n    {\n        mpz_init(a[i]);mpz_init(b[i]);\n        mpz_init(a1[i]);mpz_init(b1[i]);\n        mpz_init(r[i]);mpz_init(r1[i]);\n    }\n\n    for(i=0;i&lt;REPEAT;i++)\n    {\n        mpz_urandomb(a[i],state,128);\n        mpz_urandomb(b[i],state,128);\n\n    }\n\n    start=clock();\n\n    for(i=0;i&lt;REPEAT;i++)\n        half_mult(r[i],a[i],b[i]);\n\n    end=clock();\n    printf( \"Number of seconds: %f\\n\", (end-start)/(double)CLOCKS_PER_SEC );\n\n\n    for(i=0;i&lt;REPEAT;i++)\n    {\n        mpz_urandomb(a1[i],state,256);\n        mpz_urandomb(b1[i],state,256);\n\n    }\n\n    start=clock();\n\n    for(i=0;i&lt;REPEAT;i++)\n        full_mult(r1[i],a1[i],b1[i]);\n\n    end=clock();\n\n    printf( \"Number of seconds: %f\\n\", (end-start)/(double)CLOCKS_PER_SEC );\n\n}\n</code></pre>\n\n<p>As you can see I am trying to measure the timing while operating with two types of integers. One with 256 bits and another with 128 bits. But I did not get any conclusive results from this code. Sometimes time for the operations for 128 bits are higher sometimes time for the operations for 256 bits are higher.</p>\n"}, {"tags": ["c", "algorithm", "filesystems", "posix"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1458723961, "post_id": 36173695, "comment_id": 59983414, "body": "Many fileSystems provide API calls for such purposes.  Anyway, why do you need this retrograde step?"}, {"owner": {"reputation": 632, "user_id": 4845615, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-k-_IbriMjQU/AAAAAAAAAAI/AAAAAAAABDM/7vimTa9cQ0A/photo.jpg?sz=128", "display_name": "C&#233;dric Fran&#231;oys", "link": "https://stackoverflow.com/users/4845615/c%c3%a9dric-fran%c3%a7oys"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1458724520, "post_id": 36173695, "comment_id": 59983758, "body": "This is for storing metadata into a sub-dir of the parent directory. Storing absolute path is not safe since it might change depending on the way current drive is mounted."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1458725928, "post_id": 36173695, "comment_id": 59984649, "body": "Check if your reference folder <code>&quot;D:\\main\\&quot;</code> matches the first part of your absolute filepath. If it does, keep the rest of the filepath. If it does not, replace the drive spec with the appropriate number of <code>&quot;..\\&quot;</code>"}, {"owner": {"reputation": 632, "user_id": 4845615, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-k-_IbriMjQU/AAAAAAAAAAI/AAAAAAAABDM/7vimTa9cQ0A/photo.jpg?sz=128", "display_name": "C&#233;dric Fran&#231;oys", "link": "https://stackoverflow.com/users/4845615/c%c3%a9dric-fran%c3%a7oys"}, "edited": false, "score": 0, "creation_date": 1458729383, "post_id": 36173695, "comment_id": 59986991, "body": "It seems a good start. I&#39;ll try to come up with something in that sense."}], "answers": [{"comments": [{"owner": {"reputation": 632, "user_id": 4845615, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-k-_IbriMjQU/AAAAAAAAAAI/AAAAAAAABDM/7vimTa9cQ0A/photo.jpg?sz=128", "display_name": "C&#233;dric Fran&#231;oys", "link": "https://stackoverflow.com/users/4845615/c%c3%a9dric-fran%c3%a7oys"}, "edited": false, "score": 0, "creation_date": 1458727526, "post_id": 36174776, "comment_id": 59985702, "body": "Thanks for the hint. But actually, I need it to be cross-platform (i.e. minimum win32 &amp; linux)"}], "tags": [], "owner": {"reputation": 2887, "user_id": 5845470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/606531753afd42de16d82a1199fc4d45?s=128&d=identicon&r=PG&f=1", "display_name": "jdarthenay", "link": "https://stackoverflow.com/users/5845470/jdarthenay"}, "is_accepted": false, "score": 2, "last_activity_date": 1458726719, "creation_date": 1458726719, "answer_id": 36174776, "question_id": 36173695, "link": "https://stackoverflow.com/questions/36173695/how-to-retrieve-filepath-relatively-to-a-given-directory-in-c/36174776#36174776", "title": "How to retrieve filepath relatively to a given directory in C", "body": "<p>You are giving windows paths in your example. So, if it is acceptable for you to use the WinAPI functions, you can use <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/bb773740%28v=vs.85%29.aspx\" rel=\"nofollow\">PathRelativePathTo</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1458730951, "post_id": 36176001, "comment_id": 59988055, "body": "Please note that MSVC  / Windows does not care whether you use the forward or the backward slash separator, to open a file. It would make life easier just to replace any backward slashes."}, {"owner": {"reputation": 2887, "user_id": 5845470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/606531753afd42de16d82a1199fc4d45?s=128&d=identicon&r=PG&f=1", "display_name": "jdarthenay", "link": "https://stackoverflow.com/users/5845470/jdarthenay"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1458731511, "post_id": 36176001, "comment_id": 59988404, "body": "@Weather Vane Maybe replacing all backslashes in path by slashes for Windows then. But UNIX files and directories may contain a backslash, so this substitution cannot be done for UNIX."}, {"owner": {"reputation": 632, "user_id": 4845615, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-k-_IbriMjQU/AAAAAAAAAAI/AAAAAAAABDM/7vimTa9cQ0A/photo.jpg?sz=128", "display_name": "C&#233;dric Fran&#231;oys", "link": "https://stackoverflow.com/users/4845615/c%c3%a9dric-fran%c3%a7oys"}, "edited": false, "score": 0, "creation_date": 1458750357, "post_id": 36176001, "comment_id": 60002507, "body": "Actually my concern about the code being cross-platform is more related to the functions involved rather than dealing with path separator."}], "tags": [], "owner": {"reputation": 2887, "user_id": 5845470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/606531753afd42de16d82a1199fc4d45?s=128&d=identicon&r=PG&f=1", "display_name": "jdarthenay", "link": "https://stackoverflow.com/users/5845470/jdarthenay"}, "is_accepted": false, "score": -1, "last_activity_date": 1458729904, "last_edit_date": 1495541683, "creation_date": 1458729904, "answer_id": 36176001, "question_id": 36173695, "link": "https://stackoverflow.com/questions/36173695/how-to-retrieve-filepath-relatively-to-a-given-directory-in-c/36176001#36176001", "title": "How to retrieve filepath relatively to a given directory in C", "body": "<p>First thing you need to identify the file path separator as stated <a href=\"https://stackoverflow.com/a/12971535/5845470\">here</a>.</p>\n\n<pre><code>const char kPathSeparator =\n#ifdef _WIN32\n                            '\\\\';\n#else\n                            '/';\n#endif\n</code></pre>\n\n<p>Then, you need to write a function to compute a canonical absolute file path. You will have to use <code>#ifdef _WIN32</code> again because there are specific windows treatment required (add current disk at the begining of path if none is present).\nAfter that, remove all <code>.</code> in the path, and remove all <code>..</code> with their previous directory.</p>\n\n<p>Once this function is written, you need to use it twice to get your origin and target canonical absolute paths, and then as explains @Weather Vane you need to identify the common part in the two paths and to add the number of <code>..</code> concatenated to the end of the target canonical path.</p>\n"}, {"tags": [], "owner": {"reputation": 632, "user_id": 4845615, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-k-_IbriMjQU/AAAAAAAAAAI/AAAAAAAABDM/7vimTa9cQ0A/photo.jpg?sz=128", "display_name": "C&#233;dric Fran&#231;oys", "link": "https://stackoverflow.com/users/4845615/c%c3%a9dric-fran%c3%a7oys"}, "is_accepted": true, "score": 0, "last_activity_date": 1458827516, "last_edit_date": 1458827516, "creation_date": 1458750284, "answer_id": 36183561, "question_id": 36173695, "link": "https://stackoverflow.com/questions/36173695/how-to-retrieve-filepath-relatively-to-a-given-directory-in-c/36183561#36183561", "title": "How to retrieve filepath relatively to a given directory in C", "body": "<p>Here is the shortest solution I could figure out.</p>\n\n<p>Algorithm is actually quite simple:  </p>\n\n<p>Given 1) a reference path (path to which result path will be relative to); and 2) an absolute path (full path of a file) :</p>\n\n<ul>\n<li>while path parts are equals : skip them</li>\n<li><p>when we come across a difference</p>\n\n<ol>\n<li>add a \"..\" for each remaining part of reference path</li>\n<li>add remaining parts from absolute path </li>\n</ol></li>\n</ul>\n\n<p>The only limitation under windows is in case of distinct volume (drive letters differ), in which situation we have no choice but to return the original absolute path.</p>\n\n<p>Cross-platform C source : </p>\n\n<pre><code>#if defined(WIN32) || defined(_WIN32) || defined(__WIN32) &amp;&amp; !defined(__CYGWIN__)\n    const char* path_separator = \"\\\\\";\n#else\n    const char* path_separator = \"/\";\n#endif  \n\n#define FILENAME_MAX 1024\n\n\nchar* get_relative_path(char* reference_path, char* absolute_path) {\n    static char relative_path[FILENAME_MAX];\n    // init result string\n    relative_path[0] = '\\0';    \n    // check first char (under windows, if differs, we return absolute path)\n    if(absolute_path[0] != reference_path[0]) {\n        return absolute_path;\n    }    \n    // make copies to prevent altering original strings\n    char* path_a = strdup(absolute_path);\n    char* path_r = strdup(reference_path);\n\n    int inc;\n    int size_a = strlen(path_a)+1;\n    int size_r = strlen(path_r)+1;\n\n    for(inc = 0; inc &lt; size_a &amp;&amp; inc &lt; size_r; inc += strlen(path_a+inc)+1) {\n        char* token_a = strchr(path_a+inc, path_separator[0]);\n        char* token_r = strchr(path_r+inc, path_separator[0]);        \n        if(token_a) token_a[0] = '\\0';\n        if(token_r) token_r[0] = '\\0';        \n        if(strcmp(path_a+inc, path_r+inc) != 0) break;\n    }\n\n    for(int inc_r = inc; inc_r &lt; size_r; inc_r += strlen(path_r+inc_r)+1) {\n        strcat(relative_path, \"..\");\n        strcat(relative_path, path_separator);        \n        if( !strchr(reference_path+inc_r, path_separator[0]) ) break;\n    }\n\n    if(inc &lt; size_a) strcat(relative_path, absolute_path+inc);\n\n    return relative_path;\n}\n</code></pre>\n"}], "owner": {"reputation": 632, "user_id": 4845615, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-k-_IbriMjQU/AAAAAAAAAAI/AAAAAAAABDM/7vimTa9cQ0A/photo.jpg?sz=128", "display_name": "C&#233;dric Fran&#231;oys", "link": "https://stackoverflow.com/users/4845615/c%c3%a9dric-fran%c3%a7oys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 391, "favorite_count": 0, "accepted_answer_id": 36183561, "answer_count": 3, "score": 1, "last_activity_date": 1468231687, "creation_date": 1458723634, "last_edit_date": 1495541683, "question_id": 36173695, "link": "https://stackoverflow.com/questions/36173695/how-to-retrieve-filepath-relatively-to-a-given-directory-in-c", "title": "How to retrieve filepath relatively to a given directory in C", "body": "<p>I'm looking for an efficient way to convert absolute filepath to a path relative to a specific directory.</p>\n\n<p>Let's say we have to following structure:  </p>\n\n<pre><code>D:\\main\\test1\\blah.txt  \nD:\\test2\\foo.txt\n</code></pre>\n\n<p>With <code>\"D:\\main\"</code> being the reference directory, then result would be:   </p>\n\n<ul>\n<li>blah.txt => \"\\test1\\blah.txt\"  </li>\n<li>foo.txt => \"..\\test2\\foo.txt\"  </li>\n</ul>\n\n<p>Any clue ?</p>\n\n<hr>\n\n<p>Notes for the record:</p>\n\n<p>It seems that:  </p>\n\n<ul>\n<li>there is no unified API function (cross-platform) for performing this</li>\n<li><p>this question has been asked various times for other languages (though most answers take advantage of function PathRelativePathTo):</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/275689/how-to-get-relative-path-from-absolute-path\">How to get relative path from absolute path</a>  </li>\n<li><a href=\"https://stackoverflow.com/questions/1672561/getting-a-file-path-relative-to-a-particular-directory\">Getting a file path relative to a particular directory</a></li>\n<li><a href=\"https://stackoverflow.com/questions/1766748/how-do-i-get-a-relative-path-from-one-path-to-another-in-c-sharp\">How do I get a relative path from one path to another in C#</a></li>\n</ul></li>\n</ul>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 800, "user_id": 1767423, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jMB08.jpg?s=128&g=1", "display_name": "Hassan", "link": "https://stackoverflow.com/users/1767423/hassan"}, "edited": false, "score": 0, "creation_date": 1458721720, "post_id": 36172970, "comment_id": 59982147, "body": "What&#39;s the second parameter of the function printAfterX?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1458721755, "post_id": 36172970, "comment_id": 59982163, "body": "Compile with all warnings enabled and treat warnings as errors."}, {"owner": {"reputation": 39, "user_id": 6062915, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/0629a4849f4859bde07d3070fb1dc157?s=128&d=identicon&r=PG&f=1", "display_name": "saymaname", "link": "https://stackoverflow.com/users/6062915/saymaname"}, "reply_to_user": {"reputation": 800, "user_id": 1767423, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jMB08.jpg?s=128&g=1", "display_name": "Hassan", "link": "https://stackoverflow.com/users/1767423/hassan"}, "edited": false, "score": 0, "creation_date": 1458721918, "post_id": 36172970, "comment_id": 59982238, "body": "@HassanNadeem the size of the array"}, {"owner": {"reputation": 800, "user_id": 1767423, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jMB08.jpg?s=128&g=1", "display_name": "Hassan", "link": "https://stackoverflow.com/users/1767423/hassan"}, "edited": false, "score": 0, "creation_date": 1458721939, "post_id": 36172970, "comment_id": 59982250, "body": "@saymaname <code>if (n &gt;= arr)</code> does not make any sense, you are comparing an integer with an array. I you need this <code>if (n+arr &gt;= x)</code>"}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1458725622, "post_id": 36172970, "comment_id": 59984454, "body": "<code>n</code> is <code>11</code> in your code.   The is no circumstance in <code>arr &lt; arr + n</code> can ever be false."}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 6062915, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/0629a4849f4859bde07d3070fb1dc157?s=128&d=identicon&r=PG&f=1", "display_name": "saymaname", "link": "https://stackoverflow.com/users/6062915/saymaname"}, "edited": false, "score": 0, "creation_date": 1458721873, "post_id": 36173098, "comment_id": 59982218, "body": "but I need to this without any others variables. just with x,n,arr"}], "tags": [], "owner": {"reputation": 4270, "user_id": 2707359, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8754698c78ca3a082e1593688a9df99c?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/2707359/ilya"}, "is_accepted": true, "score": 2, "last_activity_date": 1458722595, "last_edit_date": 1495540238, "creation_date": 1458721731, "answer_id": 36173098, "question_id": 36172970, "link": "https://stackoverflow.com/questions/36172970/print-elements-after-place-in-array-in-c/36173098#36173098", "title": "Print elements after place in array in c", "body": "<p>Why do you need to mix pointers and indices? You are right, in the line <code>for (arr=x+1; arr &lt; arr+n; arr++)</code> there is a problem, because <code>arr &lt; arr + n</code> is always true for positive <code>n</code>. So, this loop will never end.</p>\n\n<p>Also it is not clear what does <code>if (n &gt;= arr)</code> mean. Here you compare number of elements in the array and pointer on this array. It is useless. It seems that you need to compare <code>x</code> and <code>arr</code>.</p>\n\n<p>I'd recommend you to use index of element to simplify your code. Try this:</p>\n\n<pre><code>void printAfterX(int* arr, int n, int x)\n{    \n    if (x &lt; 0 || x+1 &gt;= n)\n    {\n        printf(\"not found\");\n    }\n    else\n    {\n        for (int i = x+1; i &lt; n; i++)\n        {\n            printf(\"%d  \", arr[i]);\n        }    \n    }\n}\n</code></pre>\n\n<p>And to call this function you need to change third parameter:</p>\n\n<pre><code>printAfterX(arr, 11, 6);\n</code></pre>\n\n<p>Also it is better to avoid using of <code>system(\"pause\")</code> - read here: <a href=\"https://stackoverflow.com/questions/1107705/systempause-why-is-it-wrong\">system(&quot;pause&quot;); - Why is it wrong?</a></p>\n\n<p><strong>Update:</strong></p>\n\n<p>Ok, if you need to use pointers, try this:</p>\n\n<pre><code>void printAfterX(int* arr, int n, int* x)\n{\n\n    if (x &lt; arr || x+1 &gt; arr+n)\n    {\n        printf(\"not found\");\n    }\n    else\n    {            \n        for (x = x+1; x &lt; arr + n; x++)\n        {\n            printf(\"%d  \", *x);\n        }\n\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3197, "user_id": 5853530, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3b9567983f2e1d6c2315fa26202accb6?s=128&d=identicon&r=PG&f=1", "display_name": "Rajeev Singh", "link": "https://stackoverflow.com/users/5853530/rajeev-singh"}, "is_accepted": false, "score": 0, "last_activity_date": 1458722754, "last_edit_date": 1458722754, "creation_date": 1458721992, "answer_id": 36173188, "question_id": 36172970, "link": "https://stackoverflow.com/questions/36172970/print-elements-after-place-in-array-in-c/36173188#36173188", "title": "Print elements after place in array in c", "body": "<p>The line <code>for (arr=x+1; arr &lt; arr+ n; arr++)</code> is an infinite loop as <code>arr &lt; arr+ n</code> is always true.</p>\n\n<p>Also in line <code>if (n &gt;= arr)</code> you are comparing a int with a pointer,which is not meaningful.</p>\n\n<p>Modify your function like this:</p>\n\n<pre><code>void printAfterX(int* arr, int n, int* x)\n{\n\n    if (n &lt;= x-arr) //checking it doesn't exceeds the size\n    {\n        printf(\"not found\");\n    }\n    else\n    {\n        for (x++; x &lt; arr+ n; x++)\n        {\n            printf(\"%d  \",*x);\n        }\n\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 30168, "user_id": 5612562, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/gzBQY.jpg?s=128&g=1", "display_name": "msc", "link": "https://stackoverflow.com/users/5612562/msc"}, "is_accepted": false, "score": 0, "last_activity_date": 1458746729, "last_edit_date": 1458746729, "creation_date": 1458722443, "answer_id": 36173323, "question_id": 36172970, "link": "https://stackoverflow.com/questions/36172970/print-elements-after-place-in-array-in-c/36173323#36173323", "title": "Print elements after place in array in c", "body": "<p>Try it:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid printAfterX(int[], int, int);\n\nint main(void)\n{    \n    int arr[] = { 4, 8, 6, 2, 1, 3, 5, 7, 8, 9, 5 };\n    printAfterX(arr, 11, 6);    \n    system(\"PAUSE\");       \n    return 0;   \n}\n\nvoid printAfterX(int arr[], int n, int x)    \n{    \n    if (n &lt;= arr[x])   \n    {   \n        printf(\"not found\");    \n    }    \n    else    \n    {    \n        for (i=x+1; i &lt; n; i++)    \n        {    \n            printf(\"%d  \",arr[i]);    \n        }      \n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "is_accepted": false, "score": 0, "last_activity_date": 1458722790, "creation_date": 1458722790, "answer_id": 36173437, "question_id": 36172970, "link": "https://stackoverflow.com/questions/36172970/print-elements-after-place-in-array-in-c/36173437#36173437", "title": "Print elements after place in array in c", "body": "<p>You have to pass the number of elements as a parameter to the function to know when you have reached the end of the array.</p>\n\n<p>You also can't compare a variable of type <code>int</code> to varibale of type <code>int *</code>.Try this version:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid printAfterX(int* arr, size_t size, size_t offset);\n\nint main(void)\n{\n    int arr[] = { 4, 8, 6, 2, 1, 3, 5, 7, 8, 9, 5 };\n    printAfterX(arr, 11, 7);\n\n    system(\"PAUSE\");\n    return 0;\n}\n\nvoid printAfterX(int* arr, size_t size, size_t offset)\n{\n    if (offset &gt;= size)\n    {\n        printf(\"not found\");\n        return;\n    }\n    else\n    {\n        while(offset &lt; size)\n        {\n            printf(\"%d  \", *(arr + offset));\n            offset++;\n        }\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "is_accepted": false, "score": 1, "last_activity_date": 1458748072, "creation_date": 1458748072, "answer_id": 36182729, "question_id": 36172970, "link": "https://stackoverflow.com/questions/36172970/print-elements-after-place-in-array-in-c/36182729#36182729", "title": "Print elements after place in array in c", "body": "<p>It is obvious that <code>arr &lt; arr + n</code> always holds true unless it has an overflow, so the loop won't stop before that happens.</p>\n\n<p>Furthermore, by writing <code>n &gt;= arr</code>, you compare an <code>int</code> to an <code>int *</code>, which definitely make no sense. To check the array bound, you should also check whether it's less than the lower bound. </p>\n\n<p>Finally, I think it's better to use a simple while loop.</p>\n\n<p>Here is the refined code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid printAfterX(int *arr, int n, int *x);\n\nint main(void)\n{\n    int arr[] = { 4, 8, 6, 2, 1, 3, 5, 7, 8, 9, 5 };\n    printAfterX(arr, 11, arr + 6);\n\n    getchar();\n    return 0;\n}\n\nvoid printAfterX(int *arr, int n, int *x)\n{\n    if (x &lt; arr || x &gt;= arr + n)\n    {\n        printf(\"No such element\");\n    }\n    while(x &lt; arr + n)\n    {\n        printf(\"%d  \", *x);\n        x++;\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 6062915, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/0629a4849f4859bde07d3070fb1dc157?s=128&d=identicon&r=PG&f=1", "display_name": "saymaname", "link": "https://stackoverflow.com/users/6062915/saymaname"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 36173098, "answer_count": 5, "score": 1, "last_activity_date": 1458748072, "creation_date": 1458721282, "last_edit_date": 1458726200, "question_id": 36172970, "link": "https://stackoverflow.com/questions/36172970/print-elements-after-place-in-array-in-c", "title": "Print elements after place in array in c", "body": "<p>So I tried to print elements of array after some point or place\nbut its print me another number of garbage. The code need to print 7,8,9,5.\nI'm sure that the problem is in the line :</p>\n\n<blockquote>\n  <p>for (arr=x+1; <strong>arr &lt; arr+ n</strong>; arr++)\n  but I don't understand what to write instead this line.</p>\n</blockquote>\n\n<p>Please help me and use * or &amp; instead [](use pointers). thanks!</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid printAfterX(int* arr, int n, int* x);\n\nint main(void)\n{\n    int arr[] = { 4, 8, 6, 2, 1, 3, 5, 7, 8, 9, 5 };\n    printAfterX(arr, 11, arr + 6);\n\n    system(\"PAUSE\");    \n    return 0;\n}\n\nvoid printAfterX(int* arr, int n, int* x)\n{\n    if (n &gt;= arr)\n    {\n        printf(\"not found\");\n    }\n    else\n    {\n        for (arr=x+1; arr &lt; arr+ n; arr++)\n        {\n            printf(\"%d  \",*arr);\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "recursion", "printf"], "comments": [{"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 4, "creation_date": 1458718686, "post_id": 36172235, "comment_id": 59980639, "body": "Under which conditions would you expect it to be executed?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1458718958, "post_id": 36172235, "comment_id": 59980766, "body": "Please format your code."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 1, "creation_date": 1458719941, "post_id": 36172235, "comment_id": 59981229, "body": "How could it possibly ever be executed?  There is no path to it.  It&#39;s what is known as &quot;unreachable code&quot;.  If <code>i%2</code> is non-zero, it returns <code>i++</code>.  Otherwise it returns the nested recursive call result.  It returns in either case."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6102799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f82e26bce1a6ac57890487e52f707d24?s=128&d=identicon&r=PG&f=1", "display_name": "Premanand", "link": "https://stackoverflow.com/users/6102799/premanand"}, "edited": false, "score": 1, "creation_date": 1458719914, "post_id": 36172262, "comment_id": 59981214, "body": "Yup.. Thanks for that."}], "tags": [], "owner": {"reputation": 29294, "user_id": 2659313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9828b91aef4c2b3cf14f3501e0a20e33?s=128&d=identicon&r=PG", "display_name": "Mohit Jain", "link": "https://stackoverflow.com/users/2659313/mohit-jain"}, "is_accepted": false, "score": 2, "last_activity_date": 1458718703, "creation_date": 1458718703, "answer_id": 36172262, "question_id": 36172235, "link": "https://stackoverflow.com/questions/36172235/why-the-printf-statement-inside-the-funint-i-is-not-executed/36172262#36172262", "title": "Why the printf statement inside the fun(int i) is not executed?", "body": "<p>From :</p>\n\n<pre><code>if ( i%2 ) return (i++);\nelse return fun(fun( i - 1 ));\n</code></pre>\n\n<p>Both parts are returning if the function converges. So <code>printf</code> is unreachable code.</p>\n"}, {"tags": [], "owner": {"reputation": 2887, "user_id": 5845470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/606531753afd42de16d82a1199fc4d45?s=128&d=identicon&r=PG&f=1", "display_name": "jdarthenay", "link": "https://stackoverflow.com/users/5845470/jdarthenay"}, "is_accepted": false, "score": 1, "last_activity_date": 1458718705, "creation_date": 1458718705, "answer_id": 36172263, "question_id": 36172235, "link": "https://stackoverflow.com/questions/36172235/why-the-printf-statement-inside-the-funint-i-is-not-executed/36172263#36172263", "title": "Why the printf statement inside the fun(int i) is not executed?", "body": "<p>Because <code>return</code> ends current function.</p>\n"}, {"tags": [], "owner": {"reputation": 1401, "user_id": 5079428, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c07cc177e5bb1e109157faafb49b2956?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/5079428/chris"}, "is_accepted": false, "score": 1, "last_activity_date": 1458718718, "creation_date": 1458718718, "answer_id": 36172269, "question_id": 36172235, "link": "https://stackoverflow.com/questions/36172235/why-the-printf-statement-inside-the-funint-i-is-not-executed/36172269#36172269", "title": "Why the printf statement inside the fun(int i) is not executed?", "body": "<p><code>return</code> returns control of the program to the calling function. So nothing after <code>return</code> is called inside a function is executed. If you want the <code>printf</code> to be called, put it before <code>return</code>.</p>\n"}], "owner": {"reputation": 21, "user_id": 6102799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f82e26bce1a6ac57890487e52f707d24?s=128&d=identicon&r=PG&f=1", "display_name": "Premanand", "link": "https://stackoverflow.com/users/6102799/premanand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1458720723, "creation_date": 1458718594, "last_edit_date": 1458720723, "question_id": 36172235, "link": "https://stackoverflow.com/questions/36172235/why-the-printf-statement-inside-the-funint-i-is-not-executed", "title": "Why the printf statement inside the fun(int i) is not executed?", "body": "<p>This is a code that has a recursive loop. I got the output as 199, but the printf statement marked as --A is not executed. Please tell me why??</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint fun(int); // function defined\n\nint main()\n{\n    printf(\" %d \", fun(200)); // function called\n    return 0;\n}\n\nint fun(int i) // entire body of the function\n{\n    static int d = 0;\n    d++;\n\n    if (i % 2)\n        return (i++);\n    else \n        return fun(fun(i - 1));\n\n    printf(\"%d \", d);// ------A\n\n} // function fun(int) ends here.\n</code></pre>\n"}, {"tags": ["c", "structure"], "comments": [{"owner": {"reputation": 4011, "user_id": 1477064, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cd12123a743db34ac0b055a6fa736788?s=128&d=identicon&r=PG", "display_name": "xvan", "link": "https://stackoverflow.com/users/1477064/xvan"}, "edited": false, "score": 0, "creation_date": 1458719126, "post_id": 36172013, "comment_id": 59980846, "body": "<a href=\"http://askubuntu.com/questions/588800/setup-virtual-serial-ports-linux-null-modem-emulator-using-tty0tty\">This might help you</a>"}, {"owner": {"reputation": 764, "user_id": 2899478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/juuUm.jpg?s=128&g=1", "display_name": "o_weisman", "link": "https://stackoverflow.com/users/2899478/o-weisman"}, "edited": false, "score": 0, "creation_date": 1458723044, "post_id": 36172013, "comment_id": 59982841, "body": "I really don&#39;t think that a newbie should start with serial communication without some reading. There are plenty of issues here: Serial communication is stream based, so you need a Sync (2 to 4 bytes fixed value that you don&#39;t expect to appear in your data) at the beginning of messages in order to recognize where a structure starts. Communication in general should not rely on memcpy as each platform can place the data differently (big / little endian, byte alignment) resulting  in mismatching data. In addition, your code copies 1 structure size but your loop runs 7 times etc. etc."}, {"owner": {"reputation": 39, "user_id": 6102719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dddc2b732a7d41a1300af036aa9ec6ee?s=128&d=identicon&r=PG&f=1", "display_name": "manstud", "link": "https://stackoverflow.com/users/6102719/manstud"}, "edited": false, "score": 0, "creation_date": 1458723674, "post_id": 36172013, "comment_id": 59983244, "body": "Thanks o_weisman for your valuable comments i really appreciate it. For syncing in serial comm, header, tail, crc all have been added already and the segregation of data from that is taken care of."}, {"owner": {"reputation": 39, "user_id": 6102719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dddc2b732a7d41a1300af036aa9ec6ee?s=128&d=identicon&r=PG&f=1", "display_name": "manstud", "link": "https://stackoverflow.com/users/6102719/manstud"}, "edited": false, "score": 0, "creation_date": 1458724064, "post_id": 36172013, "comment_id": 59983472, "body": "Data contains pure data of array of struct format. The platform remains same as the boards have 2 modules of same type. The problem i am having is in running 7 times(just example) the loop so that the size is offset to read the next struct ."}, {"owner": {"reputation": 764, "user_id": 2899478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/juuUm.jpg?s=128&g=1", "display_name": "o_weisman", "link": "https://stackoverflow.com/users/2899478/o-weisman"}, "edited": false, "score": 0, "creation_date": 1458726441, "post_id": 36172013, "comment_id": 59984988, "body": "If as you say SerialMessage-&gt;Data is just a buffer of bytes that is guaranteed to be correctly copied to your structure, what is the problem to have a variable that holds your offset in the buffer? Instead of SerialMessage-&gt;Data you always use  SerialMessage-&gt;Data + OffsetInBuf and take care to increase OffsetInBuf by size of each data you read. Also, don&#39;t use numeric values, use a constant = 12."}], "owner": {"reputation": 39, "user_id": 6102719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dddc2b732a7d41a1300af036aa9ec6ee?s=128&d=identicon&r=PG&f=1", "display_name": "manstud", "link": "https://stackoverflow.com/users/6102719/manstud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1458717799, "creation_date": 1458717799, "question_id": 36172013, "link": "https://stackoverflow.com/questions/36172013/segregating-array-of-structures-which-have-void-pointer", "title": "segregating array of structures which have void pointer", "body": "<p>First of all i am a new-bee to programming and i know only basics of c.</p>\n\n<p>What i am trying to achieve is to segregate array of structures with structure having below declaration</p>\n\n<pre><code> struct detail{\n   int x;\n   int y;\n   int data_size;\n   void *data;\n }\n</code></pre>\n\n<p>I am getting the array of structures of above type from serial communication. I need to segregate each struct and pass it to some other function.</p>\n\n<p>What i have done till now is,</p>\n\n<pre><code>....\n\nstruct detail *read_first_element = (detail *) malloc (sizeof(detail)); // instance of defined struct\n\nmemcpy(read_first_element, SerialMessage-&gt;Data ,sizeof(detail)); // copy serial message into instance\n\nfor (int i=7;i&gt;0;i--) // for example 7 struct data is coming in\n{\n   memcpy(current_element, SerialMessage-&gt;Data, 12); // fill first 3 elements (int int int)\n// create memory for void *\n  current_element-&gt;data = malloc (current_element-&gt;data_size);\n  memcpy(current_element + 12, SerialMessage-&gt;Data + 12 , read_first_element-&gt;data_size );// fill the data\n  size = read_first_element-&gt;data_size + 12; // create offset\n  current_element = current_element + size; // for next structure \n  element\n\n   some more code. . . . \n  }\n</code></pre>\n\n<p>Please let me know if i am doing it right? I do not have serial array structure coming in now but once connection is established i can test. Is there a way to test this with sample example?</p>\n"}, {"tags": ["c", "linux", "64-bit", "32-bit", "dlopen"], "comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1458716585, "post_id": 36171324, "comment_id": 59979660, "body": "Did you try calling <code>dlerror()</code> (<a href=\"http://man7.org/linux/man-pages/man3/dlerror.3.html\" rel=\"nofollow noreferrer\">man7.org/linux/man-pages/man3/dlerror.3.html</a>)?"}, {"owner": {"reputation": 41, "user_id": 4344056, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000716561097/picture?type=large", "display_name": "Prasad Jvv", "link": "https://stackoverflow.com/users/4344056/prasad-jvv"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1458725790, "post_id": 36171324, "comment_id": 59984560, "body": "Thank you Alk for your response, it is helpful. Looks like dlopen by default doesn&#39;t load any shared object if it is not compatible. However there is a misunderstanding from my side that resulted in this post, Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "is_accepted": false, "score": 0, "last_activity_date": 1459565653, "creation_date": 1459565653, "answer_id": 36368635, "question_id": 36171324, "link": "https://stackoverflow.com/questions/36171324/anyway-to-instruct-dlopen-not-to-load-incompatible-binary-in-c-linux/36368635#36368635", "title": "Anyway to instruct dlopen not to load incompatible binary in C (Linux)", "body": "<blockquote>\n  <p>Is there a way to instruct dlopen to not to load a shared-object if it is not compatible?</p>\n</blockquote>\n\n<p>There is <em>no need</em> for any such instruction: <code>dlopen</code> will already do <em>exactly</em> that.</p>\n"}], "owner": {"reputation": 41, "user_id": 4344056, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000716561097/picture?type=large", "display_name": "Prasad Jvv", "link": "https://stackoverflow.com/users/4344056/prasad-jvv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 103, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1459565653, "creation_date": 1458715073, "question_id": 36171324, "link": "https://stackoverflow.com/questions/36171324/anyway-to-instruct-dlopen-not-to-load-incompatible-binary-in-c-linux", "title": "Anyway to instruct dlopen not to load incompatible binary in C (Linux)", "body": "<p>Is there a way to instruct dlopen to not to load a shared-object if it is not compatible?\nFor example calling dlopen from 64-bit binary application ideally should not load a 32-bit shared-object even if the \"so\" name matches. This can help in preventing from loading non-compatible binary to avoid un-expected behavior.</p>\n"}, {"tags": ["c++", "c", "linux", "vim", "youcompleteme"], "comments": [{"owner": {"reputation": 156267, "user_id": 546861, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SIhsx.png?s=128&g=1", "display_name": "romainl", "link": "https://stackoverflow.com/users/546861/romainl"}, "edited": false, "score": 0, "creation_date": 1458716927, "post_id": 36171134, "comment_id": 59979806, "body": "Those are not &quot;functions&quot; and this is not YCM&#39;s issue tracker or support forum."}, {"owner": {"reputation": 1050, "user_id": 1535111, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/7655307537962189c96770c6d82a2667?s=128&d=identicon&r=PG", "display_name": "cqdjyy01234", "link": "https://stackoverflow.com/users/1535111/cqdjyy01234"}, "edited": false, "score": 0, "creation_date": 1464404858, "post_id": 36171134, "comment_id": 62485549, "body": "I meet the same problem and work around by the global namespace ::. The for, while, etc are keywords instead of built in functions."}], "answers": [{"tags": [], "owner": {"reputation": 358, "user_id": 5309028, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/zFcFB.jpg?s=128&g=1", "display_name": "fat_cheng", "link": "https://stackoverflow.com/users/5309028/fat-cheng"}, "is_accepted": false, "score": 0, "last_activity_date": 1458721709, "creation_date": 1458721709, "answer_id": 36173091, "question_id": 36171134, "link": "https://stackoverflow.com/questions/36171134/does-ycm-support-completion-of-built-in-functions/36173091#36173091", "title": "Does YCM support completion of built in functions?", "body": "<p>As you know,YCM need to be compiled before it worked.</p>\n\n<p>I don't know how you compile it,but if you need semantic support for C-family languages,you should go to the YCM directory and compile it like this:\n<code>\n    ./install.py --clang-completer\n</code>\nThe above command is for Ubuntu 64bit/Mac/Fedora 64bit,more details is <a href=\"https://github.com/Valloric/YouCompleteMe\" rel=\"nofollow\">here</a></p>\n"}], "owner": {"reputation": 981, "user_id": 3033594, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/qgRRk.jpg?s=128&g=1", "display_name": "testname123", "link": "https://stackoverflow.com/users/3033594/testname123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 299, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1458721709, "creation_date": 1458714199, "question_id": 36171134, "link": "https://stackoverflow.com/questions/36171134/does-ycm-support-completion-of-built-in-functions", "title": "Does YCM support completion of built in functions?", "body": "<p>This questions relates to using YCM for the C family of languages:</p>\n\n<p>I think I've got YCM configured so that it doesn't crash immediately (long story) and will do some completions such as items it's seen before (if I write <code>printf</code> once, it'll complete it for me the second time around) as well as things like <code>long</code>, 'int', etc.</p>\n\n<p>However, when I type some familiar builtin functions like <code>for</code>, <code>while</code> and <code>switch</code>, nothing happens.</p>\n\n<p>Why is this?  The same isn't true for Python, only C family languages that rely on the <code>ycm_extra_conf.py</code> file.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1458712746, "post_id": 36170799, "comment_id": 59978222, "body": "<code>struct sPRIME_THREAD</code> is undefined. By doing <code>typedef struct {...}  sPRIME_THREAD;</code> you just define the type <code>sPRIME_THREA</code>."}, {"owner": {"reputation": 157, "user_id": 2770897, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1031007667/picture?type=large", "display_name": "Lilith Deficiency", "link": "https://stackoverflow.com/users/2770897/lilith-deficiency"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1458713478, "post_id": 36170799, "comment_id": 59978476, "body": "I tried doing        typedef struct sPRIME_THREAD\t{ ... } sPRIME_THREAD; and I get a lot of multiple definition errors."}], "answers": [{"comments": [{"owner": {"reputation": 189, "user_id": 4374228, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-zfPXtRPNgfg/AAAAAAAAAAI/AAAAAAAAABk/mmK2w_fFfIE/photo.jpg?sz=128", "display_name": "GShaik", "link": "https://stackoverflow.com/users/4374228/gshaik"}, "reply_to_user": {"reputation": 157, "user_id": 2770897, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1031007667/picture?type=large", "display_name": "Lilith Deficiency", "link": "https://stackoverflow.com/users/2770897/lilith-deficiency"}, "edited": false, "score": 0, "creation_date": 1458713667, "post_id": 36170907, "comment_id": 59978547, "body": "remove <code>extern</code> and make sure that it is not defined in anywhere"}, {"owner": {"reputation": 189, "user_id": 4374228, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-zfPXtRPNgfg/AAAAAAAAAAI/AAAAAAAAABk/mmK2w_fFfIE/photo.jpg?sz=128", "display_name": "GShaik", "link": "https://stackoverflow.com/users/4374228/gshaik"}, "reply_to_user": {"reputation": 157, "user_id": 2770897, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1031007667/picture?type=large", "display_name": "Lilith Deficiency", "link": "https://stackoverflow.com/users/2770897/lilith-deficiency"}, "edited": false, "score": 0, "creation_date": 1458714342, "post_id": 36170907, "comment_id": 59978810, "body": "@LilithDeficiency by removing <code>struct</code> keyword in functions, the program compiled successfully"}, {"owner": {"reputation": 157, "user_id": 2770897, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1031007667/picture?type=large", "display_name": "Lilith Deficiency", "link": "https://stackoverflow.com/users/2770897/lilith-deficiency"}, "edited": false, "score": 0, "creation_date": 1458715328, "post_id": 36170907, "comment_id": 59979127, "body": "That is weird, it didn&#39;t work for me even when I double checked I didn&#39;t had any more extern declarations."}], "tags": [], "owner": {"reputation": 189, "user_id": 4374228, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-zfPXtRPNgfg/AAAAAAAAAAI/AAAAAAAAABk/mmK2w_fFfIE/photo.jpg?sz=128", "display_name": "GShaik", "link": "https://stackoverflow.com/users/4374228/gshaik"}, "is_accepted": false, "score": 0, "last_activity_date": 1458714507, "last_edit_date": 1458714507, "creation_date": 1458713115, "answer_id": 36170907, "question_id": 36170799, "link": "https://stackoverflow.com/questions/36170799/error-deferencing-pointer-to-incomplete-type/36170907#36170907", "title": "Error: deferencing pointer to incomplete type", "body": "<p>No need of using <code>struct</code> keyword, if you are using <code>typedef</code> . Refer <a href=\"http://en.cppreference.com/w/c/language/typedef\" rel=\"nofollow\">typedef</a></p>\n\n<p>check this</p>\n\n<pre><code>/* Data types */\ntypedef struct              // Prime search thread data\n{\nunsigned int num;       // Prime search thread number\nunsigned int current;   // Number currently evaluating for primality\nunsigned int low;       // Low end of range to test for primality\nunsigned int high;      // High end of range to test for primality\n} sPRIME_THREAD;\n\n/* Shared global variables */\nextern sPRIME_THREAD primeThreadData[MAX_THREADS];  // Prime search    thread data\nint numThreads;                                     // Number of prime    search threads\n\nsPRIME_THREAD *create_thread(unsigned int num, unsigned int current,\n                                unsigned int low, unsigned int high)\n{\n   sPRIME_THREAD *thread = (sPRIME_THREAD *)malloc(sizeof(sPRIME_THREAD));\n\n    thread-&gt;num = num;\n    thread-&gt;current = current;\n    thread-&gt;low = low;\n    thread-&gt;high = high;\n\n    return thread;\n}\n\nvoid destroy_thread(sPRIME_THREAD *thread)\n{\nfree(thread);\n}\n\n void print_info(sPRIME_THREAD *thread)\n {\n printf(\"Num: %d\\n\", thread-&gt;num);\n printf(\"Current: %d\\n\", thread-&gt;current);\n printf(\"Low: %d\\n\", thread-&gt;low);\n printf(\"High: %d\\n\", thread-&gt;high);\n }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 157, "user_id": 2770897, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1031007667/picture?type=large", "display_name": "Lilith Deficiency", "link": "https://stackoverflow.com/users/2770897/lilith-deficiency"}, "edited": false, "score": 0, "creation_date": 1458715076, "post_id": 36171048, "comment_id": 59979060, "body": "I tried doing that before and got even more errors, example of these are: <code>ilopez_prime.h:24:8: error: name of type \u2018sPRIME_THREAD\u2019 is unknown  extern sPRIME_THREAD primeThreadData[MAX_THREADS];  ilopez_prime.h: In function \u2018create_thread\u2019: ilopez_prime.h:30:35: error: \u2018sPRIME_THREAD\u2019 was not declared here    struct sPRIME_THREAD *thread = (sPRIME_THREAD *)malloc(sizeof(sPRIME_THREAD)); </code>"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 157, "user_id": 2770897, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1031007667/picture?type=large", "display_name": "Lilith Deficiency", "link": "https://stackoverflow.com/users/2770897/lilith-deficiency"}, "edited": false, "score": 0, "creation_date": 1458715818, "post_id": 36171048, "comment_id": 59979317, "body": "The <code>struct</code>-type is <code>struct sPRIME_THREAD</code> not just <code>sPRIME_THREAD</code>."}, {"owner": {"reputation": 157, "user_id": 2770897, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1031007667/picture?type=large", "display_name": "Lilith Deficiency", "link": "https://stackoverflow.com/users/2770897/lilith-deficiency"}, "edited": false, "score": 0, "creation_date": 1458716416, "post_id": 36171048, "comment_id": 59979585, "body": "Oh yes, I see now your comment. My apologies, that actually fixed it. Thank you very much :)"}], "tags": [], "owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "is_accepted": true, "score": 0, "last_activity_date": 1458715781, "last_edit_date": 1458715781, "creation_date": 1458713826, "answer_id": 36171048, "question_id": 36170799, "link": "https://stackoverflow.com/questions/36170799/error-deferencing-pointer-to-incomplete-type/36171048#36171048", "title": "Error: deferencing pointer to incomplete type", "body": "<p><code>struct sPRIME_THREAD</code> is undefined. By doing <code>typedef struct {...}  sPRIME_THREAD;</code> you just define an anonymous <code>struct</code> to be the type <code>sPRIME_THREAD</code>.</p>\n\n<p>To fix this drop the typedef </p>\n\n<pre><code>typedef struct              \n{\n  unsigned int num;       \n  unsigned int current;  \n  unsigned int low;       \n  unsigned int high;     \n} sPRIME_THREAD;\n</code></pre>\n\n<p>and define a <code>struct</code> type by</p>\n\n<pre><code>struct sPRIME_THREAD             \n{\n  unsigned int num;      \n  unsigned int current;  \n  unsigned int low;       \n  unsigned int high;     \n};\n</code></pre>\n\n<p>and always use <code>struct sPRIME_THREAD</code> when refering to the type.</p>\n"}], "owner": {"reputation": 157, "user_id": 2770897, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1031007667/picture?type=large", "display_name": "Lilith Deficiency", "link": "https://stackoverflow.com/users/2770897/lilith-deficiency"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 36171048, "answer_count": 2, "score": 1, "last_activity_date": 1458715781, "creation_date": 1458712619, "last_edit_date": 1458714347, "question_id": 36170799, "link": "https://stackoverflow.com/questions/36170799/error-deferencing-pointer-to-incomplete-type", "title": "Error: deferencing pointer to incomplete type", "body": "<p>I have seen this question/error a lot but I just can't figure out what is wrong. I created a structure that contains some information about a thread and just basically I want to assign some values (thread number, current thread... etc) everytime I create a thread. The threads are not relevant for this error. So far, I am just trying to make my struct work but I keep getting an error for deferencing pointer to incomplete type for the part of </p>\n\n<p><code>thread-&gt;num=num;</code></p>\n\n<p>Is it a memory allocation error? Or any clue?\nHere is my code:</p>\n\n<p>main.c // does not give me any error</p>\n\n<pre><code>struct sPRIME_THREAD *new_thread = create_thread(1,0,0,20);\nprintf(\"Thread Info:\\n\");\nprint_info(new_thread);\n</code></pre>\n\n<p>header.h</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;assert.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n/* Macro definitions */\n#define MAX_THREADS     5   // Maximum number of prime search threads\n\n/* Data types */\ntypedef struct              // Prime search thread data\n{\n    unsigned int num;       // Prime search thread number\n    unsigned int current;   // Number currently evaluating for primality\n    unsigned int low;       // Low end of range to test for primality\n    unsigned int high;      // High end of range to test for primality\n} sPRIME_THREAD;\n\n/* Shared global variables */\nextern sPRIME_THREAD primeThreadData[MAX_THREADS];  // Prime search thread data\nint numThreads;                                     // Number of prime search threads\n\nstruct sPRIME_THREAD *create_thread(unsigned int num, unsigned int current,\n                                    unsigned int low, unsigned int high) \n    {\n        struct sPRIME_THREAD *thread = (sPRIME_THREAD *)malloc(sizeof(sPRIME_THREAD));\n\n        thread-&gt;num = num;\n        thread-&gt;current = current;\n        thread-&gt;low = low;\n        thread-&gt;high = high;\n\n        return thread;\n    }\n\nvoid destroy_thread(struct sPRIME_THREAD *thread) \n{\n    free(thread);\n}\n\nvoid print_info(struct sPRIME_THREAD *thread) \n{\n    printf(\"Num: %d\\n\", thread-&gt;num);\n    printf(\"Current: %d\\n\", thread-&gt;current);\n    printf(\"Low: %d\\n\", thread-&gt;low);\n    printf(\"High: %d\\n\", thread-&gt;high); \n}\n</code></pre>\n"}, {"tags": ["c", "gcc", "command-prompt"], "comments": [{"owner": {"reputation": 29294, "user_id": 2659313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9828b91aef4c2b3cf14f3501e0a20e33?s=128&d=identicon&r=PG", "display_name": "Mohit Jain", "link": "https://stackoverflow.com/users/2659313/mohit-jain"}, "edited": false, "score": 2, "creation_date": 1458711932, "post_id": 36170646, "comment_id": 59977925, "body": "Does <code>anagrams dictionary1.txt output1.txt</code> or <code>anagrams.exe dictionary1.txt output1.txt</code> work for you?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1458711997, "post_id": 36170646, "comment_id": 59977951, "body": "are you trying on windows box? The given commands should work just fine on a linux box (shell)."}, {"owner": {"reputation": 1, "user_id": 6102393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67cb28d79726f3d5fff773677553b9ca?s=128&d=identicon&r=PG&f=1", "display_name": "AsricDog", "link": "https://stackoverflow.com/users/6102393/asricdog"}, "edited": false, "score": 0, "creation_date": 1458712091, "post_id": 36170646, "comment_id": 59977988, "body": "In both cases I get a &quot;anagrams.exe has stopped working&quot; crash pop-up."}, {"owner": {"reputation": 29294, "user_id": 2659313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9828b91aef4c2b3cf14f3501e0a20e33?s=128&d=identicon&r=PG", "display_name": "Mohit Jain", "link": "https://stackoverflow.com/users/2659313/mohit-jain"}, "edited": false, "score": 1, "creation_date": 1458712123, "post_id": 36170646, "comment_id": 59978000, "body": "Then drop <code>.&#47;</code> and debug your program. You are possibly using a lot of memory."}, {"owner": {"reputation": 1, "user_id": 6102393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67cb28d79726f3d5fff773677553b9ca?s=128&d=identicon&r=PG&f=1", "display_name": "AsricDog", "link": "https://stackoverflow.com/users/6102393/asricdog"}, "edited": false, "score": 0, "creation_date": 1458712125, "post_id": 36170646, "comment_id": 59978002, "body": "I am on windows and do not have access to linux right now."}, {"owner": {"reputation": 2145, "user_id": 4849573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/096fb4358973b1d406f85d2b0eeec9c2?s=128&d=identicon&r=PG&f=1", "display_name": "ckruczek", "link": "https://stackoverflow.com/users/4849573/ckruczek"}, "edited": false, "score": 1, "creation_date": 1458712157, "post_id": 36170646, "comment_id": 59978012, "body": "Well then you successfully ran the program but it crashed while executing the program. You now have to investigate and debug WHAT crashs your program."}, {"owner": {"reputation": 1, "user_id": 6102393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67cb28d79726f3d5fff773677553b9ca?s=128&d=identicon&r=PG&f=1", "display_name": "AsricDog", "link": "https://stackoverflow.com/users/6102393/asricdog"}, "edited": false, "score": 0, "creation_date": 1458712684, "post_id": 36170646, "comment_id": 59978201, "body": "Ok. Thank you for the quick help. I was worried that this error was going to be a much bigger deal than it actually is."}], "answers": [{"comments": [{"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 0, "creation_date": 1458715013, "post_id": 36170721, "comment_id": 59979041, "body": "&quot;<i>IX&#39;ish systems</i>&quot; - Never heard of that. What&#39;s &#39;IX&#39;?"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 0, "creation_date": 1458715898, "post_id": 36170721, "comment_id": 59979356, "body": "@CoolGuy This refers to <code>UNIX</code>-like systems."}, {"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "edited": false, "score": 0, "creation_date": 1458716851, "post_id": 36170721, "comment_id": 59979771, "body": "You might want to say POSIX then, as that is the standard nowadays that UNIX systems adhere to (and GNU-based systems try to imitate - poorly)."}], "tags": [], "owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "is_accepted": false, "score": 5, "last_activity_date": 1458714176, "last_edit_date": 1458714176, "creation_date": 1458712181, "answer_id": 36170721, "question_id": 36170646, "link": "https://stackoverflow.com/questions/36170646/gcc-command-prompt-error-is-not-recognized-as-an-internal-or-external-comma/36170721#36170721", "title": "GCC/Command Prompt error: &#39;.&#39; is not recognized as an internal or external command", "body": "<blockquote>\n  <p>'.' is not recognized as an internal or external command</p>\n</blockquote>\n\n<p>This is not a GCC error. The error is issued by the shell when trying to run a command.</p>\n\n<p>On Windows this </p>\n\n<pre><code>./anagrams  dictionary1.txt  output1.txt\n</code></pre>\n\n<p>should be </p>\n\n<pre><code>.\\anagrams  dictionary1.txt  output1.txt\n</code></pre>\n\n<p>as on Windows the path delimiter is <code>\\</code> as opposedto IX'ish systems where it is <code>/</code>.</p>\n\n<p>On both systems <code>.</code> denotes the current directory.</p>\n\n<hr>\n\n<p>The reason for the crash you mention in your comment is not obvious from the minimal sources you show. Also this is a different question.</p>\n"}], "owner": {"reputation": 1, "user_id": 6102393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67cb28d79726f3d5fff773677553b9ca?s=128&d=identicon&r=PG&f=1", "display_name": "AsricDog", "link": "https://stackoverflow.com/users/6102393/asricdog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 751, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1458714176, "creation_date": 1458711829, "question_id": 36170646, "link": "https://stackoverflow.com/questions/36170646/gcc-command-prompt-error-is-not-recognized-as-an-internal-or-external-comma", "title": "GCC/Command Prompt error: &#39;.&#39; is not recognized as an internal or external command", "body": "<p>I'm fairly new to C and am completely new to using the command prompt and GCC to compile and run my programs. I'm struggling to find the right words to ask this question properly so please bear with me, I am doing my best.</p>\n\n<p>I need to use GCC to compile and run this C program but I'm getting an error that I do not understand. In this example program, I was told to use these lines to compile and run the code:</p>\n\n<pre><code>$ gcc -Wall -std=c99 -o anagrams anagrams.c \n$ ./anagrams  dictionary1.txt  output1.txt\n</code></pre>\n\n<p>So that is what I did. GCC does compile the program file, so the first line does not give me any error. But GCC does not like the second line, as shown below: </p>\n\n<pre><code>C:\\Users\\...\\Example&gt;gcc -Wall -std=c99 -o anagrams anagrams.c\nC:\\Users\\...\\Example&gt;./anagrams dictionary1.txt output1.txt\n'.' is not recognized as an internal or external command,\noperable program or batch file.\n</code></pre>\n\n<p>Everywhere I look, it says to use \"./filename\" to run the program after compiling so I don't understand why it is not working for me. Any help or advice would be really appreciated.</p>\n\n<p>Also, here is the main() of the program to show why those two .txt files are needed:</p>\n\n<pre><code>int main(int argc, char *argv[])\n{\n    AryElement *ary;\n    int aryLen;\n\n    if (argc != 3) {\n        printf(\"Wrong number of arguments to program.\\n\");\n        printf(\"Usage: ./anagrams infile outfile\\n\");\n        exit(EXIT_FAILURE);\n    }\n\n    char *inFile = argv[1];\n    char *outFile = argv[2];\n\n    ary = buildAnagramArray(inFile,&amp;aryLen);\n\n    printAnagramArray(outFile,ary,aryLen);\n\n    freeAnagramArray(ary,aryLen);\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1458740921, "post_id": 36170447, "comment_id": 59994948, "body": "Curious: what did you expect to be the printout?"}, {"owner": {"reputation": 3681, "user_id": 4610740, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/zWErh.jpg?s=128&g=1", "display_name": "Sajeeb Ahamed", "link": "https://stackoverflow.com/users/4610740/sajeeb-ahamed"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1458916459, "post_id": 36170447, "comment_id": 60075247, "body": "I did not expect anything. I just run the code at codeblocks and find out such an output. So I was curious, why? @chux"}], "answers": [{"tags": [], "owner": {"reputation": 1388, "user_id": 5837095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I7CdJ.png?s=128&g=1", "display_name": "Embedded C", "link": "https://stackoverflow.com/users/5837095/embedded-c"}, "is_accepted": false, "score": 5, "last_activity_date": 1458711653, "last_edit_date": 1458711653, "creation_date": 1458711206, "answer_id": 36170524, "question_id": 36170447, "link": "https://stackoverflow.com/questions/36170447/why-printf-prints-such-a-thing/36170524#36170524", "title": "Why printf() prints such a thing?", "body": "<p>see <code>printf</code> is a function which returns <code>int</code>. Where <code>int</code> is a number of <code>characters</code> printed.<br><br> \n<strong>This is a <code>printf</code> prototype</strong></p>\n\n<pre><code>int printf(const char *restrict format, ...)\n</code></pre>\n\n<p><strong>As per your program:</strong> <br></p>\n\n<pre><code>printf(\"%d\", printf(\"%d\",a));\n</code></pre>\n\n<p><code>printf(\"%d\",a)</code> where <code>a</code> is <code>123</code>, so it prints <code>123</code> and returns <code>3</code><br>\nAnd <code>printf(\"%d\", printf(\"%d\",a));</code> becomes <code>printf(\"%d\",3);</code> So it prints prints <code>3</code> alone<br><br>\n<strong>So your output is:</strong><br>\n<code>1233</code></p>\n"}, {"tags": [], "owner": {"reputation": 21711, "user_id": 418729, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/Vm1jt.jpg?s=128&g=1", "display_name": "Sadique", "link": "https://stackoverflow.com/users/418729/sadique"}, "is_accepted": false, "score": 2, "last_activity_date": 1458711925, "last_edit_date": 1458711925, "creation_date": 1458711226, "answer_id": 36170527, "question_id": 36170447, "link": "https://stackoverflow.com/questions/36170447/why-printf-prints-such-a-thing/36170527#36170527", "title": "Why printf() prints such a thing?", "body": "<p>Break it up to understand it. The <a href=\"http://www.cplusplus.com/reference/cstdio/printf/\" rel=\"nofollow\">printf</a> function's Return Value\nOn success, is the total number of characters successfully written.</p>\n\n<p><code>printf(\"%d\",a)</code> successfully writes 3 characters and then returns the value as a second parameter to be passed to the original call</p>\n\n<pre><code>printf(\"%d\", 3 );  \n</code></pre>\n\n<p>Second <code>printf</code> is passed as a parameter is evaluated and then its result is passed in the outer <code>printf</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 4708, "user_id": 5901848, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qbaoZ.jpg?s=128&g=1", "display_name": "Sanchit Patiyal", "link": "https://stackoverflow.com/users/5901848/sanchit-patiyal"}, "is_accepted": false, "score": 1, "last_activity_date": 1458712220, "creation_date": 1458712220, "answer_id": 36170734, "question_id": 36170447, "link": "https://stackoverflow.com/questions/36170447/why-printf-prints-such-a-thing/36170734#36170734", "title": "Why printf() prints such a thing?", "body": "<p>Printf always return the number of characters. And since a=123 implies 3 characters so output is coming as 1233. you will understand from this example.</p>\n\n<pre><code>int main(){\n  int a = 123;\n  int b=printf(\"%d\",a);\n  printf(\"\\n%d\", b);\n  return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 3681, "user_id": 4610740, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/zWErh.jpg?s=128&g=1", "display_name": "Sajeeb Ahamed", "link": "https://stackoverflow.com/users/4610740/sajeeb-ahamed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "closed_date": 1586582673, "answer_count": 3, "score": -7, "last_activity_date": 1458712220, "creation_date": 1458710835, "question_id": 36170447, "link": "https://stackoverflow.com/questions/36170447/why-printf-prints-such-a-thing", "closed_reason": "Needs details or clarity", "title": "Why printf() prints such a thing?", "body": "<p>I found a problem at internet such that there is a <strong>C</strong> program which like- <br></p>\n\n<pre><code>int main(){\n   int a = 123;\n   printf(\"%d\", printf(\"%d\",a));\n   return 0;\n}\n</code></pre>\n\n<p>I run this program at <strong>Codeblocks</strong> and find result <strong>1233</strong>.<br>\nMy question is that why printf() acts like this?</p>\n"}, {"tags": ["c", "reverse", "lseek"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1458707731, "post_id": 36169834, "comment_id": 59976691, "body": "My suggestion would be to print the characters using <code>printf(&quot;%02x\\n&quot;, buffer);</code>. You can&#39;t use <code>&quot;%s&quot;</code> because the buffer is only one character, so it doesn&#39;t have a NUL terminator, and isn&#39;t a valid string. And add the output from that <code>printf</code> to the question, so we can see what&#39;s in the input file."}, {"owner": {"reputation": 250, "user_id": 5937424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5870a99ee03e4af8fd990722adfb0149?s=128&d=identicon&r=PG&f=1", "display_name": "Careful Now", "link": "https://stackoverflow.com/users/5937424/careful-now"}, "edited": false, "score": 0, "creation_date": 1458707997, "post_id": 36169834, "comment_id": 59976765, "body": "Also a little oddity about printf is it only flushes writes when it meets a &quot;\\n&quot; in the format string. If there is anything left to print it does the same again. This coupled with the \\n that is after the second string isn&#39;t removed by the looks of things"}, {"owner": {"reputation": 1574, "user_id": 3612634, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/z4pyN.png?s=128&g=1", "display_name": "tisaconundrum", "link": "https://stackoverflow.com/users/3612634/tisaconundrum"}, "edited": false, "score": 0, "creation_date": 1458712189, "post_id": 36169834, "comment_id": 59978027, "body": "FILE A is the input file, FILE B is the output file"}, {"owner": {"reputation": 1574, "user_id": 3612634, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/z4pyN.png?s=128&g=1", "display_name": "tisaconundrum", "link": "https://stackoverflow.com/users/3612634/tisaconundrum"}, "edited": false, "score": 0, "creation_date": 1458712253, "post_id": 36169834, "comment_id": 59978050, "body": "<code>printf(&quot;%02x\\n&quot;, buffer);</code> only gives me an output of todays date. 22feb3, over and over again."}, {"owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 0, "creation_date": 1458712260, "post_id": 36169834, "comment_id": 59978054, "body": "Side note, you definitely shouldn&#39;t be doing a syscall for every byte. Either do the buffering yourself, or just use <code>fopen&#47;fseek</code> rather than <code>open&#47;lseek</code>."}, {"owner": {"reputation": 1574, "user_id": 3612634, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/z4pyN.png?s=128&g=1", "display_name": "tisaconundrum", "link": "https://stackoverflow.com/users/3612634/tisaconundrum"}, "reply_to_user": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 0, "creation_date": 1458712333, "post_id": 36169834, "comment_id": 59978087, "body": "@o11c This is a homework assignment and i&#39;m constrained to using syscalls. Can you elaborate on what you mean by &quot;do the buffering yourself&quot;?"}, {"owner": {"reputation": 1574, "user_id": 3612634, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/z4pyN.png?s=128&g=1", "display_name": "tisaconundrum", "link": "https://stackoverflow.com/users/3612634/tisaconundrum"}, "edited": false, "score": 0, "creation_date": 1458712736, "post_id": 36169834, "comment_id": 59978216, "body": "instead of <code>printf(&quot;%02x\\n&quot;, buffer)</code> do <code>printf(&quot;%c&quot;, *buffer)</code> or <code>putchar(*buffer)</code> this will output single characters correctly."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1458712754, "post_id": 36169834, "comment_id": 59978226, "body": "Should be <code>printf(&quot;%02x\\n&quot;, *buffer);</code> or <code>printf(&quot;%02x\\n&quot;, buffer[0]);</code> The point of the <code>%02x</code> is to show the non-printing characters, since that seems to be where the problem is."}, {"owner": {"reputation": 1574, "user_id": 3612634, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/z4pyN.png?s=128&g=1", "display_name": "tisaconundrum", "link": "https://stackoverflow.com/users/3612634/tisaconundrum"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1458713709, "post_id": 36169834, "comment_id": 59978560, "body": "Thank you for clarifying @user3386109    Here is my output <code>The filesize is: 12</code>  <code>65 64 63 62 61 0a 0a 45 44 43 42 41 </code>"}], "answers": [{"comments": [{"owner": {"reputation": 1574, "user_id": 3612634, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/z4pyN.png?s=128&g=1", "display_name": "tisaconundrum", "link": "https://stackoverflow.com/users/3612634/tisaconundrum"}, "edited": false, "score": 0, "creation_date": 1458713534, "post_id": 36170771, "comment_id": 59978498, "body": "Thank you for your answer, this helped me understand what is happening intrinsically for print. however, in my case i can&#39;t use a buffer size of 2 because it creates spaces between each of my letters in my <code>dest_file.txt</code>."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 1574, "user_id": 3612634, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/z4pyN.png?s=128&g=1", "display_name": "tisaconundrum", "link": "https://stackoverflow.com/users/3612634/tisaconundrum"}, "edited": false, "score": 1, "creation_date": 1458713890, "post_id": 36170771, "comment_id": 59978635, "body": "Take a look at the full code I posted. Note the second update with the <code>nl</code> variable"}, {"owner": {"reputation": 1574, "user_id": 3612634, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/z4pyN.png?s=128&g=1", "display_name": "tisaconundrum", "link": "https://stackoverflow.com/users/3612634/tisaconundrum"}, "edited": false, "score": 0, "creation_date": 1458714303, "post_id": 36170771, "comment_id": 59978790, "body": "I&#39;m getting an output of this <code>dcba\\n\\nEDCBA</code> are those extra parameters <code>gcc -Wall -Wextra -finline-functions...</code> supposed to fix part of the problems i&#39;m getting with writing to files?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 1574, "user_id": 3612634, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/z4pyN.png?s=128&g=1", "display_name": "tisaconundrum", "link": "https://stackoverflow.com/users/3612634/tisaconundrum"}, "edited": false, "score": 0, "creation_date": 1458714670, "post_id": 36170771, "comment_id": 59978928, "body": "No. I removed the <code>-finline-functions</code> that and the <code>Ofast</code> are just compiler optimizations. The  <code>-Wall -Wextra</code> enables compiler <i>warnings</i> (which you should use <i>every</i> time). What operating system are you on? (please not Windows) Have you tried with <i>exactly</i> the code I posted? I have confirmed both in the output above."}, {"owner": {"reputation": 1574, "user_id": 3612634, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/z4pyN.png?s=128&g=1", "display_name": "tisaconundrum", "link": "https://stackoverflow.com/users/3612634/tisaconundrum"}, "edited": false, "score": 0, "creation_date": 1458715008, "post_id": 36170771, "comment_id": 59979040, "body": "MinGW Windows, (Unfortunately) I get the same problem in linux as well. I&#39;m using QTcreator, and it gives me all warnings"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 1574, "user_id": 3612634, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/z4pyN.png?s=128&g=1", "display_name": "tisaconundrum", "link": "https://stackoverflow.com/users/3612634/tisaconundrum"}, "edited": false, "score": 0, "creation_date": 1458715121, "post_id": 36170771, "comment_id": 59979074, "body": "What version of <code>gcc</code>? if earlier than <code>4.6</code> get rid of <code>-Ofast</code> and use <code>-O3</code> if you want full optimization. This code compiles <code>without a single warning</code>. So if you are getting warnings, it isn&#39;t with this code (you are probably missing a header or something). What warnings do you get?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 1574, "user_id": 3612634, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/z4pyN.png?s=128&g=1", "display_name": "tisaconundrum", "link": "https://stackoverflow.com/users/3612634/tisaconundrum"}, "edited": false, "score": 2, "creation_date": 1458715461, "post_id": 36170771, "comment_id": 59979172, "body": "You know, I think I figured out your <code>dcba\\n\\nEDCBA</code>. You are using a data file you created on windows with <code>ABCDE\\r\\nabcde\\r\\n</code>. When you create a file in say <code>Notepad</code> windows inserts <code>DOS</code> line-ends with are <i>carriage-return</i> then <i>newline</i> (<code>\\r\\n</code>), so I suspect that is where your character funniness is coming from. Create the datafile in your <code>mingw</code> setup with <code>printf &quot;ABCDE\\nabcde\\n&quot; &gt; testabcde.txt</code> and then run the code again. (there is nothing wrong with <code>mingw</code>, it is a fine environment with <code>gcc</code> as the compiler -- old, but fine)"}, {"owner": {"reputation": 1574, "user_id": 3612634, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/z4pyN.png?s=128&g=1", "display_name": "tisaconundrum", "link": "https://stackoverflow.com/users/3612634/tisaconundrum"}, "edited": false, "score": 0, "creation_date": 1458747049, "post_id": 36170771, "comment_id": 59999976, "body": "Thanks David, this makes sense coming back and rereading your comments."}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": true, "score": 1, "last_activity_date": 1458714695, "last_edit_date": 1458714695, "creation_date": 1458712455, "answer_id": 36170771, "question_id": 36169834, "link": "https://stackoverflow.com/questions/36169834/copy-bytes-from-one-file-to-another-in-reverse-order-in-c/36170771#36170771", "title": "copy bytes from one file to another in reverse order in C", "body": "<p>You have an number of problems. Your extra newline come from the fact that POSIX defines the line-end as a <code>newline</code> (though not all files comply). Therefore to get rid of your extra newline, you need:</p>\n\n<pre><code>int n = -2;\n</code></pre>\n\n<p>instead of </p>\n\n<pre><code>int n = -1;\n</code></pre>\n\n<p>(which is explicitly reading the POSIX line-end and writing that to your output file)</p>\n\n<p>Your additional problems are you will not know if your file open fails because you are checking the return incorrectly:</p>\n\n<pre><code>// if ((src_file = open (argv[1],O_RDONLY)) &lt; -1) return 1;\n// if ((dest_file = creat (argv[2], PERMS)) &lt; -1) return 1;\n</code></pre>\n\n<p>The return is <code>-1</code> on failure. Therefore you need:</p>\n\n<pre><code>if ((src_file = open (argv[1],O_RDONLY)) == -1) return 1;\nif ((dest_file = creat (argv[2], PERMS)) == -1) return 1;\n</code></pre>\n\n<p>Next, your buffer will NOT hold a string. At minimum you need a <code>2-char</code> array to hold <code>1-char</code> plus the <code>nul-terminating</code> character. The following will not work:</p>\n\n<pre><code>#define BUFF_SIZE 1\n...\nchar buffer[BUFF_SIZE];\n...\n    printf (\"%s\", buffer);\n</code></pre>\n\n<p>You have sent an non-terminated character to <code>printf</code>. Which if you are compiling with <em>warnings enabled</em> (e.g. <code>-Wall -Wextra</code>) you would know because the compiler would warn you (it probably does even without the proper warning flags depending on your compiler). At a minimum to make the above work you need:</p>\n\n<pre><code>#define BUFF_SIZE 2\n</code></pre>\n\n<p>and you must insure you <em>nul-terminate</em> <code>buffer</code> before calling <code>printf</code>. You can accomplish that with:</p>\n\n<pre><code>char buffer[BUFF_SIZE] = \"\";\n...\n    read (src_file, buffer, BUFF_SIZE - 1);\n    buffer[1] = 0;\n    printf (\"%s\", buffer);\n    write (dest_file, buffer, BUFF_SIZE - 1);\n</code></pre>\n\n<p>(you should be checking the return of <code>read</code> and <code>write</code> to validate you are reading/writing the number of bytes you think you are...)</p>\n\n<p>Putting the corrections together (and showing you can eliminate the buffer altogether and simply use an <code>int</code> as a buf char) you could do the following:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;unistd.h&gt;\n\n#define CHAR_SIZE 2048\n#define BUFF_SIZE 2\n#define PERMS 0666\n\nint main(int argc, char **argv) {\n\n    if (argc &lt; 3) {\n        return 1;\n        printf (\"ERROR: not enough arguments\\n\");\n    }\n\n    int src_file = 0;\n    int dest_file = 0;\n    int n = -2;\n    int nl = '\\n';  /* explicit newline when writing in reverse */\n\n    // if ((src_file = open (argv[1],O_RDONLY)) &lt; -1) return 1;\n    // if ((dest_file = creat (argv[2], PERMS)) &lt; -1) return 1;\n    if ((src_file = open (argv[1],O_RDONLY)) == -1) return 1;\n    if ((dest_file = creat (argv[2], PERMS)) == -1) return 1;\n\n    printf (\"The filesize is: %ld\\n\", lseek(src_file, (off_t) 0, SEEK_END));\n\n    lseek (src_file, n--, SEEK_END);\n#ifdef WBUFCHAR\n    int bufchar;\n    do {    /* validate both read and write */\n        if (read (src_file, &amp;bufchar, BUFF_SIZE - 1) == 0) {\n            fprintf (stderr, \"error: read failure.\\n\");\n            return 1;\n        }\n        putchar (bufchar);\n        if (write (dest_file, &amp;bufchar, BUFF_SIZE - 1) == 0) {\n            fprintf (stderr, \"error: write failure.\\n\");\n            return 1;\n        }\n    } while (lseek (src_file, n--, SEEK_END) &gt; -1);\n#else\n    char buffer[BUFF_SIZE];\n    do {    /* validate both read and write */\n        if (read (src_file, buffer, BUFF_SIZE - 1) == 0) {\n            fprintf (stderr, \"error: read failure.\\n\");\n            return 1;\n        }\n        buffer[1] = 0;          /* nul-terminate */\n        printf (\"%s\", buffer);\n        if (write (dest_file, buffer, BUFF_SIZE - 1) == 0) {\n            fprintf (stderr, \"error: write failure.\\n\");\n            return 1;\n        }\n    } while (lseek (src_file, n--, SEEK_END) &gt; -1);\n#endif\n    /* explicity write the newline you removed earlier */\n    if (write (dest_file, &amp;nl, BUFF_SIZE - 1) == 0) {\n        fprintf (stderr, \"error: write failure.\\n\");\n        return 1;\n    }\n    putchar ('\\n');\n    return 0;\n}\n</code></pre>\n\n<p><em>note:</em> compile as normal to use your <code>buffer</code>. Compile with <code>-DWBUFCHAR</code> to use the <code>bufchar</code> code.</p>\n\n<p><strong>Example Compilation and Output</strong></p>\n\n<pre><code>$ cat testabcde.txt\nABCDE\nabcde\n\n$ gcc -Wall -Wextra -Ofast -o bin/extranl extranl.c\n\n$ ./bin/extranl testabcde.txt testrev.txt\nThe filesize is: 12\nedcba\nEDCBA\n\n$ cat testrev.txt\nedcba\nEDCBA\n\n$ gcc -Wall -Wextra -Ofast -DWBUFCHAR -o bin/extranlwbc extranl.c\n\n$ ./bin/extranlwbc testabcde.txt testrevwbc.txt\nThe filesize is: 12\nedcba\nEDCBA\n\n$ cat testrevwbc.txt\nedcba\nEDCBA\n</code></pre>\n\n<p>Give that a try and let me know if you have further questions.</p>\n"}, {"tags": [], "owner": {"reputation": 1574, "user_id": 3612634, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/z4pyN.png?s=128&g=1", "display_name": "tisaconundrum", "link": "https://stackoverflow.com/users/3612634/tisaconundrum"}, "is_accepted": false, "score": 0, "last_activity_date": 1458717245, "creation_date": 1458717245, "answer_id": 36171874, "question_id": 36169834, "link": "https://stackoverflow.com/questions/36169834/copy-bytes-from-one-file-to-another-in-reverse-order-in-c/36171874#36171874", "title": "copy bytes from one file to another in reverse order in C", "body": "<pre><code>#include &lt;unistd.h&gt;                                                         \n#include &lt;fcntl.h&gt;                                                          \n#include &lt;sys/types.h&gt;                                                      \n\n#define CHAR_SIZE 2048                                                      \n#define BUFF_SIZE 1                                                         \n#define PERMS 0666                                                          \n\nint main(int argc, char* argv[]){                                           \n    if (argc &lt; 3) {                                                         \n        printf (\"ERROR: not enough arguments\\n\");                           \n        return 1;                                                           \n    }                                                                       \n    int src_file = 0; int dest_file = 0;                                    \n    int n = -1;                                                             \n    if((src_file=open(argv[1],O_RDONLY)) == -1) return 1;                   \n    if((dest_file = creat(argv[2], PERMS)) == -1) return 1;                 \n    printf (\"The filesize is: %d\\n\", lseek(src_file, (off_t) 0, SEEK_END)); \n    char buffer[BUFF_SIZE];                                                 \n    lseek (src_file,n--,SEEK_END);                                          \n    do {                                                                    \n        read(src_file,buffer,BUFF_SIZE);                                    \n        printf(\"%02x\\n\", *buffer);                                          \n        if (*buffer == '\\n')                                                \n            n--;                                                            \n        write(dest_file,buffer,BUFF_SIZE);                                  \n    }while (lseek (src_file,n--,SEEK_END) &gt; -1);                            \n    printf(\"\\n\");                                                           \n    return 0;                                                               \n\n}                                                                           \n</code></pre>\n\n<p>This solution was the best way to fix the extra newline white space (\\n\\n) in my output file.</p>\n\n<p>by adding this part to the do/while loop I can compensate for the extra \\n that is added.</p>\n\n<pre><code>if (*buffer == '\\n')                                                \n                n--;\n</code></pre>\n"}], "owner": {"reputation": 1574, "user_id": 3612634, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/z4pyN.png?s=128&g=1", "display_name": "tisaconundrum", "link": "https://stackoverflow.com/users/3612634/tisaconundrum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1352, "favorite_count": 0, "accepted_answer_id": 36170771, "answer_count": 2, "score": 0, "last_activity_date": 1458717245, "creation_date": 1458707047, "last_edit_date": 1495541778, "question_id": 36169834, "link": "https://stackoverflow.com/questions/36169834/copy-bytes-from-one-file-to-another-in-reverse-order-in-c", "title": "copy bytes from one file to another in reverse order in C", "body": "<p>After checking for an <a href=\"https://stackoverflow.com/questions/8716113/c-copy-files-in-reverse-order-using-lseek\">answer here</a>, and running it in my environment I found that the code still runs into the same issues as my code.\nThis issue is that whenever I have an input file similar to this...</p>\n\n<pre><code> FILE A                 \n|---------------------| \n| ABCDE               | \n| abcde               | \n|---------------------| \n</code></pre>\n\n<p>I get extra newline white space generated in my destination file. </p>\n\n<pre><code> FILE B                 \n|---------------------| \n| edcba               | \n|                     | \n| EDCBA               | \n|---------------------| \n</code></pre>\n\n<p>After debugging my code I could see that '\\n' was being copied into the destination file <strong>twice</strong>, I'd like to understand why lseek is doing this. </p>\n\n<p>Attached is my code. The critical section in question is in the do/while loop. I'm <em>pretty sure</em> my thought process is sound, as the code from this <a href=\"https://stackoverflow.com/questions/8716113/c-copy-files-in-reverse-order-using-lseek\">answer</a> that I looked up would output the exact same results.</p>\n\n<pre><code>#define CHAR_SIZE 2048 \n#define BUFF_SIZE 1    \n#define PERMS 0666   \n\n\nint main(int argc, char* argv[]){                                          \n    if (argc &lt; 3) {                                                        \n        return 1;                                                          \n        printf (\"ERROR: not enough arguments\\n\");                          \n    }                                                                      \n    int src_file = 0; int dest_file = 0;                                   \n    int n = -1;                                                            \n    if((src_file=open(argv[1],O_RDONLY)) &lt; -1) return 1;                   \n    if((dest_file = creat(argv[2], PERMS)) &lt; -1) return 1;                 \n    printf (\"The filesize is: %d\\n\", lseek(src_file, (off_t) 0, SEEK_END));\n    char buffer[BUFF_SIZE];                                                \n    lseek (src_file,n--,SEEK_END);                                         \n    do {                                                                   \n        read(src_file,buffer,BUFF_SIZE);                                   \n        printf (\"%s\", buffer);                                             \n        write(dest_file,buffer,BUFF_SIZE);                                 \n    }while (lseek (src_file,n--,SEEK_END) &gt; -1);                           \n    printf(\"\\n\");                                                          \n    return 0;                                                              \n\n}                       \n</code></pre>\n"}, {"tags": ["c", "fortran", "fortran-iso-c-binding"], "comments": [{"owner": {"reputation": 53754, "user_id": 198536, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9edaf4c1c1b89b5d39c40528d0017509?s=128&d=identicon&r=PG", "display_name": "wallyk", "link": "https://stackoverflow.com/users/198536/wallyk"}, "edited": false, "score": 0, "creation_date": 1458705465, "post_id": 36169555, "comment_id": 59976028, "body": "Why do you say that copying a multi-GB array is <i>not</i> sensible?  What type of hardware is targeted?"}, {"owner": {"reputation": 60850, "user_id": 221955, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0bc09e1bd45610fc85274cd7bb002c56?s=128&d=identicon&r=PG", "display_name": "Michael Anderson", "link": "https://stackoverflow.com/users/221955/michael-anderson"}, "reply_to_user": {"reputation": 53754, "user_id": 198536, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9edaf4c1c1b89b5d39c40528d0017509?s=128&d=identicon&r=PG", "display_name": "wallyk", "link": "https://stackoverflow.com/users/198536/wallyk"}, "edited": false, "score": 0, "creation_date": 1458705595, "post_id": 36169555, "comment_id": 59976063, "body": "@wallyk Primarily because I&#39;m going to already be running close to the memory limit on the machine. Adding another 4GB in used memory is going to bring the application down- or push me into swap - either of which is unacceptable."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1458706148, "post_id": 36169555, "comment_id": 59976238, "body": "I suggest looking at the Fortran compiler manual.  However, in the days of yore (aka Fortran 77), REAL was also <code>REAL*4</code> as opposed to <code>REAL*8</code> for double precision \u2014 was that DOUBLE PRECISION? \u2014 so the chances are very high that Fortran REAL is the same as C float.  And if it turned out, by some mischance or contrivance, that Fortran REAL was C <code>double</code>, you&#39;d be able to use the uncopied array, would you not?  AFAICR, if you modify the array in the C code, it gets changed in the calling function too \u2014 just like C."}, {"owner": {"reputation": 27595, "user_id": 187997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a67861c90e07dfaa852c4b95615c9183?s=128&d=identicon&r=PG", "display_name": "M. S. B.", "link": "https://stackoverflow.com/users/187997/m-s-b"}, "edited": false, "score": 0, "creation_date": 1458707557, "post_id": 36169555, "comment_id": 59976651, "body": "You could try writing <code>real (OriginalArray, c_float)</code>.  If <code>OriginalArray</code> is of the same type as <code>c_float</code>, one would hope that the intrinsic <code>real</code> is written to just past the array.  If it is of a different type, then it would make a temporary copy of type <code>c_float</code>.  Maybe there would be enough memory..."}, {"owner": {"reputation": 49888, "user_id": 721644, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KSRQT.jpg?s=128&g=1", "display_name": "Vladimir F", "link": "https://stackoverflow.com/users/721644/vladimir-f"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1458726980, "post_id": 36169555, "comment_id": 59985370, "body": "@JonathanLeffler in the days of yore the odds of working with a strange machine where these simple assumptions were not true were much larger than today (various 24 bit or 48 bit machines and others)."}], "answers": [{"comments": [{"owner": {"reputation": 60850, "user_id": 221955, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0bc09e1bd45610fc85274cd7bb002c56?s=128&d=identicon&r=PG", "display_name": "Michael Anderson", "link": "https://stackoverflow.com/users/221955/michael-anderson"}, "edited": false, "score": 0, "creation_date": 1458710012, "post_id": 36170181, "comment_id": 59977328, "body": "For the compile time check I get <code>error #6683: A kind type parameter must be a compile-time constant.   [MERGE]</code>"}, {"owner": {"reputation": 19806, "user_id": 1234550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca8762a0a1ea6a90af61e5d46e4bd675?s=128&d=identicon&r=PG", "display_name": "IanH", "link": "https://stackoverflow.com/users/1234550/ianh"}, "reply_to_user": {"reputation": 60850, "user_id": 221955, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0bc09e1bd45610fc85274cd7bb002c56?s=128&d=identicon&r=PG", "display_name": "Michael Anderson", "link": "https://stackoverflow.com/users/221955/michael-anderson"}, "edited": false, "score": 0, "creation_date": 1458710510, "post_id": 36170181, "comment_id": 59977472, "body": "@MichaelAnderson The expression that provides the kind for the <code>dummy</code> variable is one that requires F2003 support.  I suspect you are not using a recent ifort release.  It works for me with 16.0.2."}, {"owner": {"reputation": 60850, "user_id": 221955, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0bc09e1bd45610fc85274cd7bb002c56?s=128&d=identicon&r=PG", "display_name": "Michael Anderson", "link": "https://stackoverflow.com/users/221955/michael-anderson"}, "edited": false, "score": 0, "creation_date": 1458710909, "post_id": 36170181, "comment_id": 59977592, "body": "Yep, stuck with 15 for now. So guess I&#39;m stuck with the runtime version for now,"}, {"owner": {"reputation": 19806, "user_id": 1234550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca8762a0a1ea6a90af61e5d46e4bd675?s=128&d=identicon&r=PG", "display_name": "IanH", "link": "https://stackoverflow.com/users/1234550/ianh"}, "reply_to_user": {"reputation": 60850, "user_id": 221955, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0bc09e1bd45610fc85274cd7bb002c56?s=128&d=identicon&r=PG", "display_name": "Michael Anderson", "link": "https://stackoverflow.com/users/221955/michael-anderson"}, "edited": false, "score": 1, "creation_date": 1458717644, "post_id": 36170181, "comment_id": 59980135, "body": "ok - with some versions of 15.0 if you simplify the expression for the compiler with some intermediate named constants it will work.  See edit."}, {"owner": {"reputation": 530, "user_id": 2394541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f9b9b9399b329591f7be92da1c5e442?s=128&d=identicon&r=PG", "display_name": "tim18", "link": "https://stackoverflow.com/users/2394541/tim18"}, "edited": false, "score": 0, "creation_date": 1523619699, "post_id": 36170181, "comment_id": 86646549, "body": "I don&#39;t see that the KINDs of real*4, default real, C_FLOAT need be the same even when the floating point representation is the same.  I fail to understand exactly what is wanted here.  If you are paranoid, you might run old-fashioned tests to see whether the EPSILON values associated with the data types can be matched."}], "tags": [], "owner": {"reputation": 19806, "user_id": 1234550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca8762a0a1ea6a90af61e5d46e4bd675?s=128&d=identicon&r=PG", "display_name": "IanH", "link": "https://stackoverflow.com/users/1234550/ianh"}, "is_accepted": true, "score": 5, "last_activity_date": 1458717733, "last_edit_date": 1458717733, "creation_date": 1458709175, "answer_id": 36170181, "question_id": 36169555, "link": "https://stackoverflow.com/questions/36169555/how-to-check-that-fortran-real-is-compatible-with-c-float/36170181#36170181", "title": "How to check that fortran real is compatible with C float?", "body": "<p>The comparison between the kind of default REAL and the kind of REAL that is interoperable with a <code>float</code> in C is just a simple integer comparison.</p>\n\n<p>You can make this comparison trigger a compile error or runtime error.</p>\n\n<pre><code>USE, INTRINSIC :: ISO_C_BINDING, ONLY: C_FLOAT    \n\n! -99 is never a valid kind - so this will fail at compile time \n! if the test condition is false.\nREAL(MERGE(KIND(1.0), -99, C_FLOAT == KIND(1.0)) :: dummy\n</code></pre>\n\n<p>or </p>\n\n<pre><code>IF (C_FLOAT /= KIND(1.0))  &amp;\n    ERROR STOP 'Default REAL isn''t interoperable with FLOAT!!'\n</code></pre>\n\n<p>C_FLOAT itself may have a negative value if the Fortran processor has no kind of REAL that interoperates with it.</p>\n\n<p>(For some 15.0.x versions of ifort the following can be used for the compile time check variant:</p>\n\n<pre><code>USE, INTRINSIC :: ISO_C_BINDING, ONLY: C_FLOAT\nINTEGER, PARAMETER :: dummy_rk = MERGE(C_FLOAT, -99, KIND(1.0) == C_FLOAT)\n! -99 is never a valid kind - so this will fail at compile time \n! if the test condition is false.\nREAL(dummy_rk) :: dummy\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 53754, "user_id": 198536, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9edaf4c1c1b89b5d39c40528d0017509?s=128&d=identicon&r=PG", "display_name": "wallyk", "link": "https://stackoverflow.com/users/198536/wallyk"}, "is_accepted": false, "score": 0, "last_activity_date": 1523564630, "last_edit_date": 1523564630, "creation_date": 1458713996, "answer_id": 36171086, "question_id": 36169555, "link": "https://stackoverflow.com/questions/36169555/how-to-check-that-fortran-real-is-compatible-with-c-float/36171086#36171086", "title": "How to check that fortran real is compatible with C float?", "body": "<p>There are several problems.</p>\n\n<ul>\n<li><p>C's <code>float</code> is passed as a <code>double</code> for C function parameters and expression evaluation.  This is easily overcome by passing a pointer to a structure or array containing variables defined as <code>float</code> (which really uses a 32-bit float).</p></li>\n<li><p>Intel's Fortran has several flavors of real:  <code>real*4</code>, <code>real*8</code>, and <code>real*16</code>.  By default (compiler settings may change these), <code>real</code> is real*4 and <code>double precision</code> is <code>real*8</code>.  See the <a href=\"https://software.intel.com/en-us/node/579806\" rel=\"nofollow noreferrer\">documentation</a>.</p></li>\n<li><p>C's <code>long double</code> type has no equivalent in Intel Fortran, where&mdash;if  it were implemented, would be <code>real*10</code>&mdash;which it <em>does</em> use for intermediate values of expressions on an x86.</p></li>\n<li><p>Of course there is the major column versus minor column array layout problem (for more than one dimensional arrays) of C vs. Fortran.</p></li>\n</ul>\n\n<p>If it were me, I would blaze the way for development by creating a test which passes known data (1.0, 2.0, 3.0, 4.0, ...) from C to Fortran and vice versa and either print the values or compare them to what they should be.  If non-whole numbers are used, be sure to use an appropriate epsilon comparison:</p>\n\n<pre><code>           if (abs (c_val - fortran_val) &gt; 0.00001)  error();\n</code></pre>\n"}], "owner": {"reputation": 60850, "user_id": 221955, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0bc09e1bd45610fc85274cd7bb002c56?s=128&d=identicon&r=PG", "display_name": "Michael Anderson", "link": "https://stackoverflow.com/users/221955/michael-anderson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 739, "favorite_count": 1, "accepted_answer_id": 36170181, "answer_count": 2, "score": 2, "last_activity_date": 1523564630, "creation_date": 1458705312, "question_id": 36169555, "link": "https://stackoverflow.com/questions/36169555/how-to-check-that-fortran-real-is-compatible-with-c-float", "title": "How to check that fortran real is compatible with C float?", "body": "<p>I'm bridging some legacy code between fortran and C using the iso-c-binding and modules/interfaces etc. </p>\n\n<p>Normally, when passing a fortran array to C I'd just copy it into another array of the right iso-c-binding type. However some of the code requires me to pass a large (multi GB) array. In this case copying it is not sensible. Also, since it is coming from 3rd party code, changing the type of the fortran array no use <code>real(c_float)</code> is not possible either.</p>\n\n<p>However I'd be happy to throw an exception, or fail to compile if the underlying fortran array was incompatible with the C float based API. </p>\n\n<p>Is there a way to check whether a default <code>real</code> is compatible with a C <code>float</code> or <code>double</code> at compile time (or runtime)?</p>\n\n<p>I'm using the intel fortran and C compilers if that matters.</p>\n"}, {"tags": ["c", "gcc", "static-linking"], "comments": [{"owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "edited": false, "score": 0, "creation_date": 1458717044, "post_id": 36169528, "comment_id": 59979860, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/844819/how-to-static-link-on-os-x\" title=\"how to static link on os x\">stackoverflow.com/questions/844819/how-to-static-link-on-os-&zwnj;&#8203;x</a>"}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 0, "creation_date": 1458717238, "post_id": 36169528, "comment_id": 59979957, "body": "<code>-static</code> is not needed to link against static libraries, but to link statically against the C/C++ runtime libraries, which AFAICT is not what you are trying to achieve; you can do without it. By the way, why are you putting a <code>.c</code> file into a static library?"}, {"owner": {"reputation": 15, "user_id": 6097725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c2a2176a26146088af064e7c6bc0e2d?s=128&d=identicon&r=PG&f=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/6097725/richard"}, "reply_to_user": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 0, "creation_date": 1458718218, "post_id": 36169528, "comment_id": 59980410, "body": "@MatteoItalia  that&#39;s a write mistake, what I mean is &quot;t1.o&quot;."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1458766986, "post_id": 36169528, "comment_id": 60012544, "body": "the <code>gcc</code> linker retrieves/processes command line arguments left to right, So I am surprised that either method worked.  I.E. the <code>-L</code> and <code>-l</code> should be at the end of the line."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 6097725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c2a2176a26146088af064e7c6bc0e2d?s=128&d=identicon&r=PG&f=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/6097725/richard"}, "edited": false, "score": 0, "creation_date": 1458718505, "post_id": 36171771, "comment_id": 59980545, "body": "It&#39;s a write mistake, what I mean is &quot;t1.o&quot;, and I truly work on MacOS.The command you give is work as well, but I am just curious why the &#39;-static&#39; make an error."}], "tags": [], "owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "is_accepted": false, "score": 1, "last_activity_date": 1458716893, "creation_date": 1458716893, "answer_id": 36171771, "question_id": 36169528, "link": "https://stackoverflow.com/questions/36169528/how-to-use-gcc-command-with-static/36171771#36171771", "title": "How to use gcc command with &#39;-static&#39;", "body": "<blockquote>\n  <p>ar rcv libt1.a t1.c</p>\n</blockquote>\n\n<p>Typo? You don't normally want a C source file in a library.....</p>\n\n<p>Clang is known to be a bit picky, especially with static libraries (Is this on MacOS, by any chance?) and will try and link to a non-existing runtime library - You can work around this by handing over the static library as an <em>object file</em> instead of a <em>library</em> like</p>\n\n<pre><code>gcc t.o libt1.a -o t\n</code></pre>\n\n<p>This should work.</p>\n"}, {"tags": [], "owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "is_accepted": true, "score": 1, "last_activity_date": 1458722014, "last_edit_date": 1495535312, "creation_date": 1458722014, "answer_id": 36173195, "question_id": 36169528, "link": "https://stackoverflow.com/questions/36169528/how-to-use-gcc-command-with-static/36173195#36173195", "title": "How to use gcc command with &#39;-static&#39;", "body": "<p>As explained in the comment, <code>-static</code> is not required to link against a static library of yours, but is used to instruct the compiler to link statically against the C (and C++, in case of g++) runtime libraries. This <a href=\"https://developer.apple.com/library/mac/qa/qa1118/_index.html\" rel=\"nofollow noreferrer\">is not supported</a> on OS X (link taken from the <a href=\"https://stackoverflow.com/questions/844819/how-to-static-link-on-os-x\">linked answer</a> above), hence the error.</p>\n\n<p>To link against your static library, just do as you did in the second command line, without specifying <code>-static</code>.</p>\n\n<blockquote>\n  <p>But I search a lot, find out other guys use '-static', and they do not get an error. So, please help me figure that.</p>\n</blockquote>\n\n<p>They are probably working on Linux or Windows, where static linking against libc is supported (although even on Linux it brings its fair share of problems).</p>\n"}], "owner": {"reputation": 15, "user_id": 6097725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c2a2176a26146088af064e7c6bc0e2d?s=128&d=identicon&r=PG&f=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/6097725/richard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1278, "favorite_count": 0, "accepted_answer_id": 36173195, "answer_count": 2, "score": 1, "last_activity_date": 1458728186, "creation_date": 1458705152, "last_edit_date": 1458728186, "question_id": 36169528, "link": "https://stackoverflow.com/questions/36169528/how-to-use-gcc-command-with-static", "title": "How to use gcc command with &#39;-static&#39;", "body": "<p>When I tried to use gcc command to compile a test program with a static library 't1' which archive by myself.</p>\n\n<p>The command I use to archive static library like this:</p>\n\n<pre><code>ar rcv libt1.a t1.o\n</code></pre>\n\n<p>Use the following command got An error:</p>\n\n<pre><code>gcc -L. -static -lt1 t.c -o t\n\nld: library not found for -lcrt0.o\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\n</code></pre>\n\n<p>But, If I remove '-static' like this:</p>\n\n<pre><code>gcc -L. -lt1 t.c -o t\n</code></pre>\n\n<p>It compile successfully. And I got the right result.</p>\n\n<p>But I search a lot, find out other guys use '-static', and they do not get an error. So, please help me figure that.</p>\n"}, {"tags": ["c", "list", "pointers", "insert"], "comments": [{"owner": {"reputation": 1480, "user_id": 3680119, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x7ea1.png?s=128&g=1", "display_name": "Cormac O&#39;Brien", "link": "https://stackoverflow.com/users/3680119/cormac-obrien"}, "edited": false, "score": 0, "creation_date": 1458704368, "post_id": 36169248, "comment_id": 59975721, "body": "Assuming <code>tmp_aux</code> is non-null at the beginning of your loop, it will never terminate; <code>tmp_aux-&gt;next = tmp_aux</code> does not traverse the list, just continually reassigns a value. Maybe you wanted to do <code>tmp_aux = tmp_aux-&gt;next</code>?"}, {"owner": {"reputation": 55, "user_id": 6101363, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1043928549005275/picture?type=large", "display_name": "Francisco Ignacio Hoyos Armijo", "link": "https://stackoverflow.com/users/6101363/francisco-ignacio-hoyos-armijo"}, "reply_to_user": {"reputation": 1480, "user_id": 3680119, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x7ea1.png?s=128&g=1", "display_name": "Cormac O&#39;Brien", "link": "https://stackoverflow.com/users/3680119/cormac-obrien"}, "edited": false, "score": 0, "creation_date": 1458704618, "post_id": 36169248, "comment_id": 59975791, "body": "i tried that but still printing the first node at the bottom of the list; i think the last node i scan should be at the bottom... is that right?"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1458704916, "post_id": 36169248, "comment_id": 59975863, "body": "You example shows inserting at the end of the list not at the beginning. If it were at the beginning the new node would print first not last right? So which is it do you really want - beginning or end of list?"}, {"owner": {"reputation": 55, "user_id": 6101363, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1043928549005275/picture?type=large", "display_name": "Francisco Ignacio Hoyos Armijo", "link": "https://stackoverflow.com/users/6101363/francisco-ignacio-hoyos-armijo"}, "edited": false, "score": 0, "creation_date": 1458705146, "post_id": 36169248, "comment_id": 59975937, "body": "that is what im trying to do, insert it at the beginning, i think if is the first node will be at the bottom of the printed list right?"}], "answers": [{"tags": [], "owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "is_accepted": true, "score": 1, "last_activity_date": 1458709628, "creation_date": 1458709628, "answer_id": 36170257, "question_id": 36169248, "link": "https://stackoverflow.com/questions/36169248/insert-node-at-the-begining-of-a-list/36170257#36170257", "title": "Insert node at the begining of a list", "body": "<p>Personally I think the first node should be printed first (in reference to the comments), but that's just semantics I suppose.</p>\n\n<p>All the times I've used linked lists, I've used <code>head</code> and <code>tail</code> pointers.  The <code>head</code> pointer points to the first item in the list, the <code>tail</code> points to the last item in the list.  There is some extra bookkeeping required to keep these up-to-date every time you add and remove an item from the list, but I think that is well worth the effort.  Any operation that requires you to iterate over the list (searching for a specific node, printing all the items, etc) is done more simply because you start at the <code>head</code> and go to the <code>tail</code>.  Something like the following should get you started,, this is not meant to be an all-inclusive program:</p>\n\n<pre><code> static struct nodo *head = NULL, *tail = NULL;\n\n struct nodo* insert_at_head(struct nodo* new_aux)\n {\n   if (head == NULL &amp;&amp; tail == NULL)\n   {\n     // our list is empty; any item inserted is both the beginning and end\n     head = new_aux;\n     tail = new_aux;\n     new_aux-&gt;next = NULL;  // only 1 item in the list, there is no next element\n   }\n   else\n   {\n     // if maintained properly, this should be the only other possibility\n     new_aux-&gt;next = head;  // new_aux is the new head of the list, so the previous head is now the 2nd item\n     head = new_aux;  // make new_aux the new head of the list\n   }\n\n   // in fact, since head = new_aux happens in both branches, that should just go here\n\n   return head;  // this could be a void function, but returning head and checking that it equals new_aux shows that new_aux is now the head of the list\n }\n\n struct nodo* remove_head()\n {\n   if (head != NULL)  // our list is not empty, so it does in fact have a head\n   {\n     struct nodo* temp = head\n     head = head-&gt;next;  // even if there is one item in the list, head-&gt;next should be NULL, so now head is NULL\n     free(temp);\n   }\n   else\n   {\n     // this means our list is empty, optionally print an error message or warning \"Trying to delete head from empty list!\"\n     return NULL;\n   }\n\n   return head;\n }\n\n // now iterating over all the nodes is easy, you just have to go from head to tail.\n void print_list()\n {\n   struct nodo* cur_aux;\n   for (cur_aux=head; cur_aux!=NULL; cur_aux=cur_aux-&gt;next)\n   {\n     // print whatever you want here\n   }\n }\n\n // you can have several other functions, for manipulating the list.  Their prototypes *might* look like the following:\n // do not forget to maintain head and tail pointers for all of these!\n struct nodo* insert_at_tail(stuct nodo* new_aux); // similar to insert_at_head(), except now you want to make the current last node the 2nd to last node\n struct nodo* locate_aux(const struct nodo* aux); // iterate head to tail and return the node that matches all fields of struct nodo, return NULL if not found\n void delete_aux(struct nodo* aux); // iterate through the list and delete aux if found\n void clean_up_list(); // iterate from head to tail and delete all items\n struct nodo* insert_aux_after(struct nodo* insert_after, struct nodo* new_aux); // this will insert new_aux after insert_after\n\n int main(int argc, char* argv[])\n {\n   // something like this\n   struct nodo* new_aux = malloc(sizeof(struct nodo));\n   struct nodo* new_aux2 = malloc(sizeof(struct nodo));\n   struct nodo* new_aux3 = malloc(sizeof(struct nodo));\n\n   // fill in the fields for each new_aux\n   if (insert_at_head(new_aux) != new_aux)\n   {\n     // some error happened on insertion,, handle it\n   }\n   insert_at_head(new_aux2);\n   insert_at_head(new_aux3);\n\n   print_list();\n   // the output should print new_aux3, then new_aux2, and finally new_aux\n\n   clean_up_list();\n   return 0;\n }\n</code></pre>\n\n<p>You can adjust <code>head</code> and <code>tail</code> to be first or last in the list, but general convention labels <code>head</code> as the first item in the list.  I could possibly fill in some code for the other prototypes.  In fact you could implement everything above without a <code>tail</code> pointer, just start all your iterations over the list at <code>head</code> and go until <code>-&gt;next == NULL</code>.  You might also consider maintaining a <code>static size_t num_aux</code> that keeps a running count of the number of items in the list.  This would especially be helpful for determining success or failure when trying to delete items from the list.  I suspect if you google a tutorial on linked lists you will get far better code than what I provided, but what I showed should be at least one reasonable approach to dealing with linked lists.</p>\n"}], "owner": {"reputation": 55, "user_id": 6101363, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1043928549005275/picture?type=large", "display_name": "Francisco Ignacio Hoyos Armijo", "link": "https://stackoverflow.com/users/6101363/francisco-ignacio-hoyos-armijo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 36170257, "answer_count": 1, "score": 1, "last_activity_date": 1458709628, "creation_date": 1458703481, "question_id": 36169248, "link": "https://stackoverflow.com/questions/36169248/insert-node-at-the-begining-of-a-list", "title": "Insert node at the begining of a list", "body": "<p>I need to insert a node at the beginning on a list, how i do that? </p>\n\n<p>with this code:</p>\n\n<pre><code>while(tmp!=NULL){\n    printf(\"__________\");\n    printf(\"\\nCodigo: %d\\n\",tmp-&gt;code);\n    printf(\"Nombre: %s\\n\",tmp-&gt;name);\n    printf(\"Apellido: %s\\n\",tmp-&gt;last);\n    tmp = tmp-&gt;next;\n\n};\n</code></pre>\n\n<p>i print the list, and this is what i see:</p>\n\n<hr>\n\n<p>Codigo: 3<br>\nNombre: third<br>\n                                                                                                                                                                                                    Apellido: node                                                                                                                                                                        </p>\n\n<hr>\n\n<p>Codigo: 2<br>\nNombre: secc<br>\n                                                                                                                                                                                                                                                       Apellido: node                                                                                                                                                                                                                                         </p>\n\n<hr>\n\n<p>Codigo: 1<br>\nNombre: first<br>\n                                                                                                                                                                                                                              Apellido: node     </p>\n\n<p><em>so, if i insert something at the beginnig i should see</em></p>\n\n<hr>\n\n<p>Codigo: 3<br>\nNombre: third<br>\n                                                                                                                                                                                                    Apellido: node                                                                                                                                                                        </p>\n\n<hr>\n\n<p>Codigo: 2<br>\nNombre: secc<br>\n                                                                                                                                                                                                                                                       Apellido: node                                                                                                                                                                                                                                         </p>\n\n<hr>\n\n<p>Codigo: 1<br>\nNombre: first<br>\n                                                                                                                                                                                                                              Apellido: node</p>\n\n<hr>\n\n<p>Codigo: 4<br>\nNombre: fourth<br>\n                                                                                                                                                                                                                              Apellido: node    </p>\n\n<p>how i do that? i tried with this:</p>\n\n<pre><code>    tmp_aux = lista;// creating an aux list\n    while(tmp_aux-&gt;next!=NULL){\n        tmp_aux-&gt;next = tmp_aux;\n    }; // i used this becouse the last printed (up) is the first node\n    new_aux = (struct nodo* ) malloc(1*sizeof(struct nodo));\n    printf(\"ingrese el codigo: \");\n    scanf(\"%d\",&amp;(*new_aux).code);\n    printf(\"ingrese el nombre: \");\n    scanf(\"%s\",&amp;(*new_aux).name);\n    printf(\"ingrese el apellido: \");\n    scanf(\"%s\",&amp;(*new_aux).last);\n\n\n\n    new_aux-&gt;next = tmp_aux;// then i put the aux on the next of my new node\n    lista = new_aux;// and make my list the new one\n</code></pre>\n"}, {"tags": ["c", "pointers", "linked-list"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 2, "creation_date": 1458701590, "post_id": 36168945, "comment_id": 59974994, "body": "Please show a <a href=\"https://stackoverflow.com/help/mcve\">minimal complete and verifiable example</a>."}, {"owner": {"reputation": 17580, "user_id": 493106, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/48b0c7ab491edf2f69e63773181a22b5?s=128&d=identicon&r=PG", "display_name": "xaxxon", "link": "https://stackoverflow.com/users/493106/xaxxon"}, "edited": false, "score": 0, "creation_date": 1458701628, "post_id": 36168945, "comment_id": 59975002, "body": "You store the node you started at and stop when the current node&#39;s next is the starting node."}, {"owner": {"reputation": 339, "user_id": 4076958, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/fc1f23a7b481e629e92b57e0e066ec88?s=128&d=identicon&r=PG&f=1", "display_name": "Jude", "link": "https://stackoverflow.com/users/4076958/jude"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1458701632, "post_id": 36168945, "comment_id": 59975005, "body": "@kaylum do you mean my output, or just more of my program?"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1458701734, "post_id": 36168945, "comment_id": 59975033, "body": "@Jude The code. The link explains what and why."}, {"owner": {"reputation": 339, "user_id": 4076958, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/fc1f23a7b481e629e92b57e0e066ec88?s=128&d=identicon&r=PG&f=1", "display_name": "Jude", "link": "https://stackoverflow.com/users/4076958/jude"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1458702126, "post_id": 36168945, "comment_id": 59975150, "body": "@kaylum Alright I&#39;ve added more information"}], "answers": [{"tags": [], "owner": {"reputation": 250, "user_id": 5937424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5870a99ee03e4af8fd990722adfb0149?s=128&d=identicon&r=PG&f=1", "display_name": "Careful Now", "link": "https://stackoverflow.com/users/5937424/careful-now"}, "is_accepted": true, "score": 0, "last_activity_date": 1458709243, "creation_date": 1458709243, "answer_id": 36170195, "question_id": 36168945, "link": "https://stackoverflow.com/questions/36168945/free-a-circular-linked-list/36170195#36170195", "title": "Free a circular linked list", "body": "<p>When you do</p>\n\n<pre><code>while( *bestFriend != NULL)\n</code></pre>\n\n<p>You forget that this is circular. The next of the last node to be freed will be the first node you freed. This creates a problem since that memory was deallocated from your program. This will cause a segmentation fault. </p>\n\n<p>My suggestion is to not have the list in a circular manor it will make no difference just one next pointer is not filled.</p>\n"}, {"tags": [], "owner": {"reputation": 6779, "user_id": 1691223, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/c2AsP.jpg?s=128&g=1", "display_name": "Shravan40", "link": "https://stackoverflow.com/users/1691223/shravan40"}, "is_accepted": false, "score": 0, "last_activity_date": 1458709458, "creation_date": 1458709458, "answer_id": 36170230, "question_id": 36168945, "link": "https://stackoverflow.com/questions/36168945/free-a-circular-linked-list/36170230#36170230", "title": "Free a circular linked list", "body": "<p>Circular linked list will never point to <code>NULL</code>, given it has one or more node.</p>\n\n<p>But you are doing <code>while( *bestFriend != NULL)</code> which means that you are not treating the given list as circular.</p>\n"}], "owner": {"reputation": 339, "user_id": 4076958, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/fc1f23a7b481e629e92b57e0e066ec88?s=128&d=identicon&r=PG&f=1", "display_name": "Jude", "link": "https://stackoverflow.com/users/4076958/jude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 722, "favorite_count": 0, "accepted_answer_id": 36170195, "answer_count": 2, "score": -1, "last_activity_date": 1458709458, "creation_date": 1458701396, "last_edit_date": 1458701785, "question_id": 36168945, "link": "https://stackoverflow.com/questions/36168945/free-a-circular-linked-list", "title": "Free a circular linked list", "body": "<p>I kind of understand how to free them but I'm pretty sure I am doing it wrong in my code.</p>\n\n<pre><code>while( *bestFriend != NULL){\n                    temptr = *bestFriend;\n                    *bestFriend = (*bestFriend)-&gt;next;\n                    free(temptr);\n                    printf(\"Freed\\n\");\n                }\n</code></pre>\n\n<p>its crashing my program a bit unsure what is causing it though.</p>\n\n<p>Edit: rest of Code</p>\n\n<pre><code>int duckDuckBoot(jimmysFriend **bestFriend, int rounds, int howManyDucks, int numberOfFriends, int gameCounter){\n\n    int roundCounter;\n    int i;\n    jimmysFriend *temptr;\n    temptr = *bestFriend;\n    roundCounter = 0;\n    if(rounds != 0){\n     do{\n        for(i = 0; i &lt; howManyDucks;){\n            i++;\n            if(i == howManyDucks){\n                    temptr = temptr-&gt;next;\n                if((*bestFriend)-&gt;next == *bestFriend){\n                    temptr = *bestFriend;\n                    free(temptr);\n                    *bestFriend = NULL;\n                    printf(\"Game %d:\\n\", gameCounter);\n                    printf(\"Jimmy has friends no more\\n\");\n                    return 0;\n                }\n                else if(temptr-&gt;next == *bestFriend){\n                 jimmysFriend *temptr2;\n                 while(temptr-&gt;next-&gt;next != *bestFriend){\n                        temptr = temptr-&gt;next;\n                 }\n\n                 temptr2 = temptr-&gt;next;\n                 temptr-&gt;next = *bestFriend;\n                 free(temptr2);\n                 temptr = *bestFriend;\n                }\n                else if(temptr == *bestFriend){\n                    jimmysFriend *temptr2;\n                    temptr2 = *bestFriend;\n                    while(temptr-&gt;next != *bestFriend){\n                        temptr = temptr-&gt;next;\n                    }\n                    temptr-&gt;next = (*bestFriend)-&gt;next;\n                    (*bestFriend) = (*bestFriend)-&gt;next;\n                    free(temptr2);\n                }\n                else{\n                    jimmysFriend* temptr2;\n                    temptr2 = *bestFriend;\n\n                    while(temptr2-&gt;next-&gt;next != temptr-&gt;next){\n                        temptr2= temptr2-&gt;next;\n                    }\n                    jimmysFriend *temptr3;\n                    temptr3 = temptr;\n                    temptr2-&gt;next = temptr-&gt;next;\n                    temptr = temptr-&gt;next;\n                    temptr2 = NULL;\n                    free(temptr3);\n                    free(temptr2);\n\n\n                }\n                roundCounter++;\n                }\n            else{\n            temptr = temptr-&gt;next;\n            }\n\n\n        }\n\n        }while(roundCounter != rounds);\n        if(roundCounter == rounds){\n            char** nameList;\n            int listSize;\n            nameList = allocMemory(numberOfFriends);\n            listSize = dataTransfer(*bestFriend, nameList, numberOfFriends);\n            printf(\"Game %d:\\n\", gameCounter);\n            for(i = 0; i &lt; listSize; i++){\n                printf(\"%s\\n\",nameList[i]);\n\n                }\n\n          for(i = 0; i &lt; listSize; i++){\n                    free(nameList[i]);\n                    free(nameList);\n                }\n            while( *bestFriend != NULL){\n                    temptr = *bestFriend;\n                    *bestFriend = (*bestFriend)-&gt;next;\n                    free(temptr);\n                    printf(\"Freed\\n\");\n                }\n\n\n        }\n\n\n\n\n\n\n\n    }\n\n\n    return 1;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31, "user_id": 6091495, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b87f8b2c8282c93585bf7d3991f5fca6?s=128&d=identicon&r=PG&f=1", "display_name": "Cole", "link": "https://stackoverflow.com/users/6091495/cole"}, "edited": false, "score": 0, "creation_date": 1458701425, "post_id": 36168854, "comment_id": 59974958, "body": "My guess right now after thinking more about it, is that I need to dereference invalidBase in the else statement? By using a pointer? Such as have it in the else statement be *invalidBase = *p; then increment invalidBase instead of j++. Is this close? <b>I THINK THIS IS WAY OFF AFTER GETTING MIKECATS REPLY!</b>"}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1458701645, "post_id": 36168854, "comment_id": 59975008, "body": "No, you cannot increment <code>invalidBase</code> because it is an array and ih wil be automatic converted ti a pointer, which id not a lvalue, when it is used in expressions except for operands of <code>sizeof</code> or unary <code>&amp;</code> operator."}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1458701763, "post_id": 36168854, "comment_id": 59975041, "body": "You may want to use <code>switch</code> statement instead of these many <code>if-else</code> statements."}, {"owner": {"reputation": 31, "user_id": 6091495, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b87f8b2c8282c93585bf7d3991f5fca6?s=128&d=identicon&r=PG&f=1", "display_name": "Cole", "link": "https://stackoverflow.com/users/6091495/cole"}, "reply_to_user": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1458761809, "post_id": 36168854, "comment_id": 60009701, "body": "@MikeCAT I tried, but I seemed to have problems using switch statements for the pointer. I looked it up online and was unable to find out how to do it. Maybe I just did some silly mistake, but I don&#39;t know for sure."}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1458780399, "post_id": 36168854, "comment_id": 60017447, "body": "I added a code using <code>switch</code> statement to my answer."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 6091495, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b87f8b2c8282c93585bf7d3991f5fca6?s=128&d=identicon&r=PG&f=1", "display_name": "Cole", "link": "https://stackoverflow.com/users/6091495/cole"}, "edited": false, "score": 0, "creation_date": 1458701627, "post_id": 36168947, "comment_id": 59975001, "body": "god I love you &lt;3. Such a dumb error. Thank you....  I looked at this forever. Was doing so much research into nested if loops thinking I did something wrong. Thank you &lt;3"}], "tags": [], "owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "is_accepted": false, "score": 3, "last_activity_date": 1458780378, "last_edit_date": 1458780378, "creation_date": 1458701407, "answer_id": 36168947, "question_id": 36168854, "link": "https://stackoverflow.com/questions/36168854/nested-if-else-statements-are-giving-me-problems/36168947#36168947", "title": "Nested if-else statements are giving me problems", "body": "<p>Yoy invoked <em>undefined behavior</em> by using values of uninitialized variables having automatic storage duration, which is indeterminate.</p>\n\n<p>To improve:</p>\n\n<ul>\n<li>Increment the counter <code>j</code> only if a data is stored to <code>invalidBase</code>.</li>\n<li>Use <code>j</code> to determine the length to print.</li>\n</ul>\n\n<p>Improved code:</p>\n\n<pre><code>void countBase(char *p)\n{\n   int aCount = 0, cCount = 0, tCount = 0, gCount = 0;\n   char invalidBase[100];\n   int i, j=0;\n   while(*p != '\\0')\n   {\n      if(*p == 'A' || *p == 'a')\n      {\n         aCount++;\n      }\n      else if(*p == 'C' || *p == 'c')\n      {\n         cCount++;\n      }\n      else if(*p == 'T' || *p == 't')\n      {\n         tCount++;\n      }\n      else if(*p == 'G' || *p == 'g')\n      {\n         gCount++;\n      }\n      else\n      {\n         if(j &lt; (int)(sizeof(invalidBase) / sizeof(*invalidBase))) /* avoid buffer overrun */\n         {\n            invalidBase[j] = *p;\n            j++;\n         }\n      }\n      p++;\n   }\n\n   for(i = 0; i &lt; j; i++)\n   {\n      printf(\"Invalid Base: %c\\n\", invalidBase[i]);\n   }\n\n   printf(\" A: %i\\n C: %i\\n T: %i\\n G: %i\\n\", aCount, cCount, tCount, gCount);\n}\n</code></pre>\n\n<p>Note that you can use <code>switch</code> statement instead of these many <code>if-else</code> statements.</p>\n\n<pre><code>void countBase(char *p)\n{\n   int aCount = 0, cCount = 0, tCount = 0, gCount = 0;\n   char invalidBase[100];\n   int i, j=0;\n   while(*p != '\\0')\n   {\n      switch(*p)\n      {\n      case 'A':\n      case 'a':\n         aCount++;\n         break;\n      case 'C':\n      case 'c':\n         cCount++;\n         break;\n      case 'T':\n      case 't':\n         tCount++;\n         break;\n      case 'G':\n      case 'g':\n         gCount++;\n         break;\n      default:\n         if(j &lt; (int)(sizeof(invalidBase) / sizeof(*invalidBase))) /* avoid buffer overrun */\n         {\n            invalidBase[j] = *p;\n            j++;\n         }\n         break;\n      }\n      p++;\n   }\n\n   for(i = 0; i &lt; j; i++)\n   {\n      printf(\"Invalid Base: %c\\n\", invalidBase[i]);\n   }\n\n   printf(\" A: %i\\n C: %i\\n T: %i\\n G: %i\\n\", aCount, cCount, tCount, gCount);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 6091495, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b87f8b2c8282c93585bf7d3991f5fca6?s=128&d=identicon&r=PG&f=1", "display_name": "Cole", "link": "https://stackoverflow.com/users/6091495/cole"}, "edited": false, "score": 0, "creation_date": 1458761891, "post_id": 36169038, "comment_id": 60009743, "body": "Ah! I like this! Thank you very much! Much cleaner. Also, I thought it added the \\0 automatically? I never added it to the pointer!?"}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1458780114, "post_id": 36169038, "comment_id": 60017355, "body": "This usage of <code>tolower()</code> may invoke <i>undefined behavior</i> for passing out-of-range value. Casting <code>*p</code> to <code>unsigned char</code> before passing it is good to prevent it."}], "tags": [], "owner": {"reputation": 685, "user_id": 2868284, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/76f42be013abf833273224eb4eaef29c?s=128&d=identicon&r=PG", "display_name": "cenouro", "link": "https://stackoverflow.com/users/2868284/cenouro"}, "is_accepted": false, "score": 0, "last_activity_date": 1458702103, "creation_date": 1458702103, "answer_id": 36169038, "question_id": 36168854, "link": "https://stackoverflow.com/questions/36168854/nested-if-else-statements-are-giving-me-problems/36169038#36169038", "title": "Nested if-else statements are giving me problems", "body": "<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\nvoid countBase(char *p) {\n    int aCount = 0, cCount = 0, tCount = 0, gCount = 0;\n    char invalidBase[100];\n    int i, j=0;\n    while(*p != '\\0') {\n        if(tolower(*p) == 'a') {\n            aCount++;\n        }\n        else if(tolower(*p) == 'c') {\n            cCount++;\n        }\n        else if(tolower(*p) == 't') {\n            tCount++;\n        }\n        else if(tolower(*p) == 'g') {\n            gCount++;\n        }\n        else {\n            // This is the correct place to increment j.\n            invalidBase[j++] = *p;\n        }\n\n        // The following line is wrong. You can only increment j if an invalid\n        // base was found and inserted on the array.\n        // j++;\n        p++;\n    }\n\n    // Your code lacked the \"end of string\" delimitation.\n    invalidBase[j] = '\\0';\n\n    for(i = 0; invalidBase[i] != '\\0'; i++) {\n        printf(\"Invalid Base: %c\\n\", invalidBase[i]);\n    }\n\n    printf(\" A: %i\\n C: %i\\n T: %i\\n G: %i\\n\", aCount, cCount, tCount, gCount);\n}\n\nint main(){\n    printf(\"Testing '%s'\\n\", \"agtcpoop\");\n    countBase(\"agtcpoop\");\n    puts(\"***********************************\");\n    printf(\"Testing '%s'\\n\", \"a\");\n    countBase(\"a\");\n    puts(\"***********************************\");\n    printf(\"Testing '%s'\\n\", \"\");\n    countBase(\"\");\n    puts(\"***********************************\");\n    printf(\"Testing '%s'\\n\", \"p\");\n    countBase(\"p\");\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 6091495, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b87f8b2c8282c93585bf7d3991f5fca6?s=128&d=identicon&r=PG&f=1", "display_name": "Cole", "link": "https://stackoverflow.com/users/6091495/cole"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1458780378, "creation_date": 1458700824, "question_id": 36168854, "link": "https://stackoverflow.com/questions/36168854/nested-if-else-statements-are-giving-me-problems", "title": "Nested if-else statements are giving me problems", "body": "<p>The code I wrote is supposed to count the amount of a's, c's, t's, and g's in a char pointer list. Then if the entered char is not an a, c, t, or g, then it is supposed to add the invalid letter into the char list invalidBase. Instead when I enter the data agtcpoop it prints out Invalid Base: but the chars are not there, when it is supposed to print out poop. Please help! Here is the code:</p>\n\n<pre><code>void countBase(char *p)\n{\n   int aCount = 0, cCount = 0, tCount = 0, gCount = 0;\n   char invalidBase[100];\n   int i, j=0;\n   while(*p != '\\0')\n{\n  if(*p == 'A' || *p == 'a')\n  {\n     aCount++;\n  }\n  else if(*p == 'C' || *p == 'c')\n  {\n     cCount++;\n  }\n  else if(*p == 'T' || *p == 't')\n  {\n     tCount++;\n  }\n  else if(*p == 'G' || *p == 'g')\n  {\n     gCount++;\n  }\n  else\n  {\n     invalidBase[j] = *p;\n  }\n  j++;\n  p++;\n}\n\nfor(i = 0; invalidBase[i] != '\\0'; i++)\n{\n   printf(\"Invalid Base: %c\\n\", invalidBase[i]);\n}\n\nprintf(\" A: %i\\n C: %i\\n T: %i\\n G: %i\\n\", aCount, cCount, tCount, gCount);\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 1, "creation_date": 1458699934, "post_id": 36168702, "comment_id": 59974560, "body": "Installing a library is just putting the relevant files in the various locations whereby the compiler/linker can find them. This may also include any other files that the library requires - configuration files for example"}, {"owner": {"reputation": 3336, "user_id": 2649384, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/07fcf64005a81f4b34618c50a15f2b20?s=128&d=identicon&r=PG", "display_name": "Izzo", "link": "https://stackoverflow.com/users/2649384/izzo"}, "reply_to_user": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1458700115, "post_id": 36168702, "comment_id": 59974599, "body": "@EdHeal, can you provide further information? I would like to understand it at a lower level."}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 1, "creation_date": 1458700314, "post_id": 36168702, "comment_id": 59974652, "body": "What more information do you require? It possibility creates a few files specific to your set up. It then copies files to the relevant locations and sets the various file permissions. The installer can do other things but that is usually the sum total"}, {"owner": {"reputation": 3336, "user_id": 2649384, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/07fcf64005a81f4b34618c50a15f2b20?s=128&d=identicon&r=PG", "display_name": "Izzo", "link": "https://stackoverflow.com/users/2649384/izzo"}, "reply_to_user": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1458700428, "post_id": 36168702, "comment_id": 59974681, "body": "If you were to write a program with an installed library, would it be possible to distribute it to other users?"}], "answers": [{"tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": true, "score": 2, "last_activity_date": 1458700920, "last_edit_date": 1458700920, "creation_date": 1458700551, "answer_id": 36168813, "question_id": 36168702, "link": "https://stackoverflow.com/questions/36168702/c-installed-library-what-is-this/36168813#36168813", "title": "C Installed Library - What is this?", "body": "<p>In order to include the header files your project needs to know where those header files are.  You <em>could</em> tell your pre-processor where they are, usually with <code>-I</code>, but for convenience your system has a set of directories it will search by default. This is called an \"include path\". Places like <code>/usr/include</code>, <code>/usr/local/include</code> and the like are typical.</p>\n\n<p>Installing a library usually means putting it in an include path.  sndfile.h will probably go into <code>/usr/local/include/sndfile.h</code>.</p>\n\n<p>The code in the library is a little different. The install process will compile the code into a <a href=\"https://en.wikipedia.org/wiki/Library_%28computing%29#Shared_libraries\" rel=\"nofollow\">shared library</a> that all processes can use. By using the shared library, rather than compiling it into every program, this reduces code size and memory usage system wide. Like the header file, shared libraries are found in a library path.  <code>/usr/lib</code> and <code>/usr/local/lib</code> are common examples.</p>\n\n<p>Shared libraries also have the advantage that one it's upgraded, every program that's using it also gets upgraded.  This is very good for fixing bugs and plugging security holes.  The downside is if a shared library introduces a bug or security hole, or changes its interface, it effect every program using it.</p>\n\n<hr>\n\n<p>The install process should be documented in the <code>README</code> or <code>INSTALL</code> file of the project source.  Typically it's...</p>\n\n<pre><code>./configure\nmake\nmake check\nmake install\n</code></pre>\n\n<p>But usually you can do this safer and easier with your package manager.  For example, <a href=\"https://packages.debian.org/source/stable/libsndfile\" rel=\"nofollow\">Debian has a libsndfile package</a> as does <a href=\"https://launchpad.net/ubuntu/+source/libsndfile\" rel=\"nofollow\">Ubuntu</a>.  That way it will be kept up to date.</p>\n\n<hr>\n\n<p>If you want to distribute a program which relies on another library, you have three choices.</p>\n\n<p>First is to make the users manually install that library.  This is a pain for most users.</p>\n\n<p>Next is to use a packaging system, <a href=\"http://packaging.ubuntu.com/html/packaging-new-software.html\" rel=\"nofollow\">like that which comes with Ubuntu</a>, and turn your software into a package.  Then it can declare a dependency on the library's package.  This is good, but it requires making a package for every major distribution.</p>\n\n<p>You can distribute the library along with your source code.  When your source code is built, build the library as well.  If you distribute your program as a binary, you can distribute the compiled library as well.  This is what a lot of applications are these days: directories full of compiled code and all their necessary support libraries and frameworks.  An example is <a href=\"https://developer.apple.com/library/mac/documentation/CoreFoundation/Conceptual/CFBundles/BundleTypes/BundleTypes.html\" rel=\"nofollow\">the OS X .app bundle</a>.</p>\n"}], "owner": {"reputation": 3336, "user_id": 2649384, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/07fcf64005a81f4b34618c50a15f2b20?s=128&d=identicon&r=PG", "display_name": "Izzo", "link": "https://stackoverflow.com/users/2649384/izzo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "closed_date": 1458700712, "accepted_answer_id": 36168813, "answer_count": 1, "score": -3, "last_activity_date": 1458700920, "creation_date": 1458699778, "question_id": 36168702, "link": "https://stackoverflow.com/questions/36168702/c-installed-library-what-is-this", "closed_reason": "Needs more focus", "title": "C Installed Library - What is this?", "body": "<p>I'm currently trying to install a library in c (specifically libsndfile). It's telling me that I need to 'install' and library. I'm confused, what exactly am I doing by 'installing' the library? </p>\n\n<p>Why is it that I'm not just including header and source code files? </p>\n\n<p>I've tried googling this but have not gotten too much success. Does anyone care to explain or recommend an article that discusses this?</p>\n\n<p>Thank you,</p>\n"}, {"tags": ["c"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5889206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33a72d689a27b0e6d8758d895c1c0e71?s=128&d=identicon&r=PG&f=1", "display_name": "phunguz", "link": "https://stackoverflow.com/users/5889206/phunguz"}, "edited": false, "score": 0, "creation_date": 1458700432, "post_id": 36168717, "comment_id": 59974685, "body": "Wow major lapse there -.- thanks. Should I call it right after PrintCard on line 46? It would look like this right : PlayHands(H1,H2);"}, {"owner": {"reputation": 1, "user_id": 5889206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33a72d689a27b0e6d8758d895c1c0e71?s=128&d=identicon&r=PG&f=1", "display_name": "phunguz", "link": "https://stackoverflow.com/users/5889206/phunguz"}, "edited": false, "score": 0, "creation_date": 1458700553, "post_id": 36168717, "comment_id": 59974722, "body": "My instructor asked that we not use structs yet since we have not gotten to that part of the lesson plan yet"}, {"owner": {"reputation": 845, "user_id": 1744516, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d2103343c8f275f917ba916ee58bc55f?s=128&d=identicon&r=PG", "display_name": "Sterling Christensen", "link": "https://stackoverflow.com/users/1744516/sterling-christensen"}, "reply_to_user": {"reputation": 1, "user_id": 5889206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33a72d689a27b0e6d8758d895c1c0e71?s=128&d=identicon&r=PG&f=1", "display_name": "phunguz", "link": "https://stackoverflow.com/users/5889206/phunguz"}, "edited": false, "score": 0, "creation_date": 1458701245, "post_id": 36168717, "comment_id": 59974901, "body": "You should try it and see what happens. I&#39;m sure you&#39;ll get it working if you keep at it."}], "tags": [], "owner": {"reputation": 845, "user_id": 1744516, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d2103343c8f275f917ba916ee58bc55f?s=128&d=identicon&r=PG", "display_name": "Sterling Christensen", "link": "https://stackoverflow.com/users/1744516/sterling-christensen"}, "is_accepted": false, "score": 2, "last_activity_date": 1458700964, "last_edit_date": 1458700964, "creation_date": 1458699864, "answer_id": 36168717, "question_id": 36168670, "link": "https://stackoverflow.com/questions/36168670/a-function-that-will-play-two-hands-of-five-cards/36168717#36168717", "title": "A function that will play two hands of five cards?", "body": "<p>It's because you're not calling <code>PlayHands</code></p>\n\n<p>By the way, <code>PlayHands</code> appears to copy 5 properties for each card that it moves from the deck to a player's hand. But cards have only <s>three</s> two properties! (note that <code>NPROPS</code> is defined as 2) </p>\n\n<p>I would strongly recommend you use a struct instead.</p>\n\n<p>For example:</p>\n\n<pre><code>struct Card {\n    int suit;\n    int value;\n};\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5889206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33a72d689a27b0e6d8758d895c1c0e71?s=128&d=identicon&r=PG&f=1", "display_name": "phunguz", "link": "https://stackoverflow.com/users/5889206/phunguz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "closed_date": 1458700547, "answer_count": 1, "score": -1, "last_activity_date": 1458700964, "creation_date": 1458699535, "last_edit_date": 1458700288, "question_id": 36168670, "link": "https://stackoverflow.com/questions/36168670/a-function-that-will-play-two-hands-of-five-cards", "closed_reason": "Not suitable for this site", "title": "A function that will play two hands of five cards?", "body": "<p>In a program that shuffles a deck of cards, I am trying to write a function that plays two hands of said cards.</p>\n\n<p>Here is the gist:\n<a href=\"https://gist.github.com/anonymous/ab16041559c72657832f\" rel=\"nofollow\">https://gist.github.com/anonymous/ab16041559c72657832f</a></p>\n\n<p>The prototype is on line 23 and the function I have so far begins on 133. \nThe program compiles and runs, but when I try to write in a printf function to output the results it doesn't show up. </p>\n"}, {"tags": ["c", "rust", "ffi"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1458697048, "post_id": 36168281, "comment_id": 59973844, "body": "What&#39;s the question?"}, {"owner": {"reputation": 11441, "user_id": 24817, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/233c279c012ebac792aaa805f966cbc7?s=128&d=identicon&r=PG", "display_name": "Steve Klabnik", "link": "https://stackoverflow.com/users/24817/steve-klabnik"}, "edited": false, "score": 0, "creation_date": 1458698269, "post_id": 36168281, "comment_id": 59974142, "body": "I&#39;m also not clear on what the question is, but I have one additional comment: the testStruct should be #[repr(C)]`."}, {"owner": {"reputation": 81, "user_id": 1440612, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F3fAm.jpg?s=128&g=1", "display_name": "CallumStyan", "link": "https://stackoverflow.com/users/1440612/callumstyan"}, "edited": false, "score": 0, "creation_date": 1458698731, "post_id": 36168281, "comment_id": 59974280, "body": "Added a line to clarify what my actual question is, but any prod in the right direction regarding pointers and FFI in Rust is appreciated."}], "answers": [{"comments": [{"owner": {"reputation": 30697, "user_id": 31667, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/082b069c287878a1bd5731f44c8f10e7?s=128&d=identicon&r=PG", "display_name": "viraptor", "link": "https://stackoverflow.com/users/31667/viraptor"}, "edited": false, "score": 0, "creation_date": 1458705377, "post_id": 36169235, "comment_id": 59975995, "body": "I found the <code>Box&lt;T&gt;</code> comment interesting. What do you mean by accidental freeing when compared to local variable? Isn&#39;t it also possible in the same way if you use the <code>TestStruct&lt;&#39;a&gt;</code> from your second example, and do <code>fn foo() { let mut ts = TestStruct {...}; start_test(&amp;mut ts); }</code> ? If  <code>a_string</code> is generated in <code>foo</code> (for example ref&#39;d local string) and <code>start_test</code> saves the pointer for later, rust will also free it, right?"}, {"owner": {"reputation": 46065, "user_id": 234590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/463c0219a51a5d1fd08e1fa280811b57?s=128&d=identicon&r=PG", "display_name": "Francis Gagn&#233;", "link": "https://stackoverflow.com/users/234590/francis-gagn%c3%a9"}, "reply_to_user": {"reputation": 30697, "user_id": 31667, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/082b069c287878a1bd5731f44c8f10e7?s=128&d=identicon&r=PG", "display_name": "viraptor", "link": "https://stackoverflow.com/users/31667/viraptor"}, "edited": false, "score": 0, "creation_date": 1458706442, "post_id": 36169235, "comment_id": 59976336, "body": "You&#39;re right, the same issue could occur with a local variable and a borrowed pointer in the struct. This will catch lifetime errors in the Rust code, but not in the C code. There&#39;s a reason why calling <code>extern</code> functions is unsafe, after all. :)"}, {"owner": {"reputation": 30697, "user_id": 31667, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/082b069c287878a1bd5731f44c8f10e7?s=128&d=identicon&r=PG", "display_name": "viraptor", "link": "https://stackoverflow.com/users/31667/viraptor"}, "edited": false, "score": 0, "creation_date": 1458710701, "post_id": 36169235, "comment_id": 59977530, "body": "Thanks, I thought there&#39;s some specific issue on top of that in case of Boxes :)"}, {"owner": {"reputation": 81, "user_id": 1440612, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F3fAm.jpg?s=128&g=1", "display_name": "CallumStyan", "link": "https://stackoverflow.com/users/1440612/callumstyan"}, "edited": false, "score": 0, "creation_date": 1458754034, "post_id": 36169235, "comment_id": 60004988, "body": "@FrancisGagn&#233; Thank you for the detailed explanation in your answer, I&#39;ll play around with this today and mark it as accepted!"}], "tags": [], "owner": {"reputation": 46065, "user_id": 234590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/463c0219a51a5d1fd08e1fa280811b57?s=128&d=identicon&r=PG", "display_name": "Francis Gagn&#233;", "link": "https://stackoverflow.com/users/234590/francis-gagn%c3%a9"}, "is_accepted": true, "score": 6, "last_activity_date": 1458703423, "creation_date": 1458703423, "answer_id": 36169235, "question_id": 36168281, "link": "https://stackoverflow.com/questions/36168281/what-is-the-correct-way-to-declare-a-structure-or-just-a-variable-in-rust-that/36169235#36169235", "title": "What is the correct way to declare a structure, or just a variable, in Rust that can be passed to C code expecting a pointer?", "body": "\n\n<blockquote>\n  <p>What is the correct way to declare a structure, or just a variable, in Rust that can be passed to C code expecting a pointer?</p>\n</blockquote>\n\n<p>The memory layout of a struct is undefined (the compiler is allowed to reorder fields, for instance) unless you add the <code>#[repr(C)]</code> attribute to the struct. This attribute gives the struct a layout compatible with C.</p>\n\n<pre class=\"lang-rust prettyprint-override\"><code>#[repr(C)]\nstruct TestStruct {\n    an_int: libc::c_int,\n    a_string: *mut libc::c_char\n}\n</code></pre>\n\n<p>Using a raw pointer in the struct works fine, but we can do better. There are two other important types in Rust that are only composed of a pointer: borrowed pointers (<code>&amp;'a T</code> or <code>&amp;'a mut T</code>) and <code>Box&lt;T&gt;</code>. You can use these types instead <code>*const T</code> or <code>*mut T</code> to make it clear that the pointer borrows an existing value (and enables the compiler to validate that the pointer doesn't outlive its referent) or points to an object on the heap that should be dropped when the pointer (or the struct containing it) goes out of scope. However, be careful with <code>Box&lt;T&gt;</code>, since you could accidentally free a value while the C code still has a pointer to the value.</p>\n\n<pre class=\"lang-rust prettyprint-override\"><code>#[repr(C)]\nstruct TestStruct&lt;'a&gt; {\n    an_int: libc::c_int,\n    a_string: &amp;'a mut libc::c_char\n}\n</code></pre>\n\n<p>Another thing to watch out for is the use of fat pointers. In Rust, some pointer types are <em>fat</em>, i.e. they carry additional data along with the pointer. For example, slices (<code>*const [T]</code>, <code>*mut [T]</code>, <code>&amp;'a [T]</code>, <code>&amp;'a mut [T]</code>) can be thought of as a struct or tuple containing a pointer to the first item and the number of items in the slice (a <code>usize</code>); trait objects (<code>*const T</code>, <code>*mut T</code>, <code>&amp;'a T</code>, <code>&amp;'a mut T</code> where <code>T</code> is the name of a trait) are composed of a pointer to the object and a pointer to the virtual method table for the trait implementation. You should avoid using these types when defining a Rust struct matching a C struct.</p>\n\n<p>You can find more information on using Rust's FFI in <a href=\"http://doc.rust-lang.org/stable/book/ffi.html\">the FFI section of the Rust book</a>.</p>\n"}], "owner": {"reputation": 81, "user_id": 1440612, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F3fAm.jpg?s=128&g=1", "display_name": "CallumStyan", "link": "https://stackoverflow.com/users/1440612/callumstyan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 496, "favorite_count": 0, "accepted_answer_id": 36169235, "answer_count": 1, "score": 0, "last_activity_date": 1458737006, "creation_date": 1458696644, "last_edit_date": 1458737006, "question_id": 36168281, "link": "https://stackoverflow.com/questions/36168281/what-is-the-correct-way-to-declare-a-structure-or-just-a-variable-in-rust-that", "title": "What is the correct way to declare a structure, or just a variable, in Rust that can be passed to C code expecting a pointer?", "body": "<p>I'm having a hard time wrapping my head around declaring mutable (or pointer) variables and interacting with C code through FFI. I've been playing with this for most of the day and have found conflicting examples due to how quickly Rust is developing. :)</p>\n\n<p>The situation is like this: I have a C function which takes in a pointer to a <code>struct</code>, this struct has fields that are <code>int</code>s and <code>char *</code>s.  My understanding is that I need to declare a similar struct in Rust to pass to the <code>extern C</code> function.</p>\n\n<hr>\n\n<p>Here are my example files I've written while trying to figure this out:</p>\n\n<pre><code>main.rs\nextern crate libc;\n\nstruct testStruct {\n  an_int: libc::c_int,\n  a_string: *mut libc::c_char\n}\n\nextern {\n  fn start_test(test: *mut testStruct) -&gt; libc::c_int;\n}\n\nfn main() {\n  // println!(\"Hello, world!\");\n  let test_struct = testStruct { an_int: 1, a_string: \"hello\" };\n  start_test(&amp;mut test_struct);\n}\n</code></pre>\n\n<p>--</p>\n\n<pre><code>test_file.c\n#include &lt;stdio.h&gt;\n#include \"test_file.h\"\n\nstruct test_struct {\n    int an_int;\n    char *a_string;\n};\n\nint start_client(struct test_struct *test) {\n    printf(\"Test function!\\n\");\n    return 0;\n}\n</code></pre>\n\n<p>Obviously the actual code is more complex, I'm just trying to get a basic example working to understand how mutability/pointers work in Rust with FFI.</p>\n"}, {"tags": ["c++", "c", "input", "console", "serial-port"], "comments": [{"owner": {"reputation": 10563, "user_id": 1104328, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/df0790774838286ad0d93567ae1fcf56?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/1104328/harry"}, "edited": false, "score": 0, "creation_date": 1458694943, "post_id": 36167999, "comment_id": 59973270, "body": "Please add some code."}, {"owner": {"reputation": 1, "user_id": 5342036, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zxpYHmk3rE4/AAAAAAAAAAI/AAAAAAAAACE/fTEy5dIwT-g/photo.jpg?sz=128", "display_name": "Linus Walden", "link": "https://stackoverflow.com/users/5342036/linus-walden"}, "reply_to_user": {"reputation": 10563, "user_id": 1104328, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/df0790774838286ad0d93567ae1fcf56?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/1104328/harry"}, "edited": false, "score": 0, "creation_date": 1458695466, "post_id": 36167999, "comment_id": 59973402, "body": "@harry added my current state"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1458695505, "post_id": 36167999, "comment_id": 59973415, "body": "This looks more like C++, not C.  Are you programming in C# or <i>managed</i> C++?"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1458695580, "post_id": 36167999, "comment_id": 59973437, "body": "Since the serial port is not standard in C or C++, which library?  Which platform?  Embedded?  Direct access to the UART?"}, {"owner": {"reputation": 1, "user_id": 5342036, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zxpYHmk3rE4/AAAAAAAAAAI/AAAAAAAAACE/fTEy5dIwT-g/photo.jpg?sz=128", "display_name": "Linus Walden", "link": "https://stackoverflow.com/users/5342036/linus-walden"}, "reply_to_user": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1458695604, "post_id": 36167999, "comment_id": 59973444, "body": "@Thomas Working with Arduino, that should be a variaton of c++. Not sure on that point though."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1458695765, "post_id": 36167999, "comment_id": 59973490, "body": "Now that you&#39;ve established the platform, which operating system?  Arduino?  Android? WinCE? Micrium? Linux? None?  The operating system may provide API to access the serial port."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1458695906, "post_id": 36167999, "comment_id": 59973525, "body": "Did you set the serial port properties, baud rate, stop bit, parity, etc. the same as the terminal or vice-versa?"}, {"owner": {"reputation": 1, "user_id": 5342036, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zxpYHmk3rE4/AAAAAAAAAAI/AAAAAAAAACE/fTEy5dIwT-g/photo.jpg?sz=128", "display_name": "Linus Walden", "link": "https://stackoverflow.com/users/5342036/linus-walden"}, "reply_to_user": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1458695924, "post_id": 36167999, "comment_id": 59973531, "body": "@Thomas Sorry for the unclarity. Im using Windows, but run the program on the Arduino. I use the serial Monitor of my PC for the inputs. I print onto that console and a tft-screen, but thats not important."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1458696099, "post_id": 36167999, "comment_id": 59973575, "body": "There is no standard OS for embedded systems; usually Arduino is an embedded system.  Your PC should be connected to the Arduino via USB or RS232 connector.  You may want to search the internet for &quot;C++ arduino serial port&quot; for more examples of how to set up the serial port and how to use it.  My next question was about interrupts..."}, {"owner": {"reputation": 1, "user_id": 5342036, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zxpYHmk3rE4/AAAAAAAAAAI/AAAAAAAAACE/fTEy5dIwT-g/photo.jpg?sz=128", "display_name": "Linus Walden", "link": "https://stackoverflow.com/users/5342036/linus-walden"}, "edited": false, "score": 0, "creation_date": 1458696165, "post_id": 36167999, "comment_id": 59973596, "body": "I connect to the Arduino (Mega 2560) using a USB cable."}], "answers": [{"tags": [], "owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "is_accepted": true, "score": 0, "last_activity_date": 1458697598, "creation_date": 1458697598, "answer_id": 36168418, "question_id": 36167999, "link": "https://stackoverflow.com/questions/36167999/c-read-serial-input-to-string/36168418#36168418", "title": "C++ read Serial input to String", "body": "<pre><code>char bufferChar[] = {0};\n</code></pre>\n\n<p>This declares an array with one element.</p>\n\n<pre><code>bufferChar[1] = bufferChar2;\n</code></pre>\n\n<p>This attempts to set the value of the 2nd element in an one element array. Buffer overflow. Undefined behavior.</p>\n\n<pre><code>strcpy(input[1], input[1]);\n</code></pre>\n\n<p>This makes no sense. Besides the dubious reason behind wanting to <code>strcpy</code>() something on top of itself, <code>input</code> is a <code>char</code> array, so <code>input[1]</code> is a single <code>char</code> value, while <code>strcpy()</code> takes <code>char *</code> arguments.</p>\n\n<p>This line must've made your compiler spew a bunch of warnings and/or errors. Please don't ignore diagnostic messages from your compiler. That's the compiler telling you that you're doing it wrong.</p>\n\n<pre><code>strcat(input[1], bufferChar[1]);\n</code></pre>\n\n<p>So, we are attempting to <code>strcat</code>() another pair of <code>char</code>s instead of <code>char *</code>s. This is not going to work any better than attempting to <code>strcpy()</code> the same thing.</p>\n\n<p>Even if your compiler accepts this, the resulting code will crash, in at least three or four different ways, by my count.</p>\n\n<p>You need to:</p>\n\n<ol>\n<li><p>Declare <code>input</code> and <code>charBuffer</code> arrays that are of sufficient size, for what you intend to do with them.</p></li>\n<li><p>Pass pointers, not <code>char</code>s, to both <code>strcpy()</code> (if you need it), and <code>strcat()</code>.</p></li>\n<li><p><code>char *</code> parameters, to both <code>strcpy()</code> and <code>strcat()</code> arrays must be null-terminated strings. It is your responsibility to '\\0'-terminate each parameter. Although there are several ways to get this \"for free\", if you're in doubt, explicitly 0-terminate them.</p></li>\n</ol>\n"}], "owner": {"reputation": 1, "user_id": 5342036, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zxpYHmk3rE4/AAAAAAAAAAI/AAAAAAAAACE/fTEy5dIwT-g/photo.jpg?sz=128", "display_name": "Linus Walden", "link": "https://stackoverflow.com/users/5342036/linus-walden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 845, "favorite_count": 0, "closed_date": 1458699861, "accepted_answer_id": 36168418, "answer_count": 1, "score": -4, "last_activity_date": 1458697598, "creation_date": 1458694897, "last_edit_date": 1458695665, "question_id": 36167999, "link": "https://stackoverflow.com/questions/36167999/c-read-serial-input-to-string", "closed_reason": "Needs details or clarity", "title": "C++ read Serial input to String", "body": "<p>I need to get the Serial input from the console to a String.\nWhen the User types \"xyz\" into the console and presses enter, the String \"input\" should be defined as \"xyz\". From then I'll interpret the String.\nThis is what I currently have:</p>\n\n<p>Defintion:</p>\n\n<pre><code>char input[] = {0};\nchar bufferChar[] = {0};\n</code></pre>\n\n<p>Use:</p>\n\n<pre><code>bool canInput = true;\nwhile(canInput == true) {\n  if(Serial.available() &gt; 0) {\n    char bufferChar2 = Serial.read();\n    bufferChar[1] = bufferChar2;\n    strcpy(input[1], input[1]);\n    strcat(input[1], bufferChar[1]);\n    Serial.print(input);\n    tft.print(input);\n  }\n}\n</code></pre>\n\n<p>I am new to c, so sorry if this code is bad.\nThanks in advace,\nLinus</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 34083, "user_id": 1287251, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IQkBy.png?s=128&g=1", "display_name": "Cornstalks", "link": "https://stackoverflow.com/users/1287251/cornstalks"}, "edited": false, "score": 3, "creation_date": 1458694178, "post_id": 36167892, "comment_id": 59973055, "body": "<code>while(fp)</code> will always be true (assuming the call to <code>fopen</code> succeeds)."}, {"owner": {"reputation": 1945, "user_id": 218145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07b3a10bc1219f5ddcad476568014b44?s=128&d=identicon&r=PG", "display_name": "Nick White", "link": "https://stackoverflow.com/users/218145/nick-white"}, "edited": false, "score": 0, "creation_date": 1458694450, "post_id": 36167892, "comment_id": 59973134, "body": "in your while loop, add <code>if (feof(fp)) break;</code>"}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "reply_to_user": {"reputation": 1945, "user_id": 218145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07b3a10bc1219f5ddcad476568014b44?s=128&d=identicon&r=PG", "display_name": "Nick White", "link": "https://stackoverflow.com/users/218145/nick-white"}, "edited": false, "score": 0, "creation_date": 1458694616, "post_id": 36167892, "comment_id": 59973179, "body": "@NickWhite: <a href=\"http://stackoverflow.com/a/3181093/364696\">Don&#39;t use <code>feof</code></a>. File operations should generally use what Python calls the EAFP pattern (Easier to Ask Forgiveness than seek Permission); do what you want to do, and handle the error."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3427559"}, "edited": false, "score": 0, "creation_date": 1458694807, "post_id": 36167892, "comment_id": 59973232, "body": "What do you suggest I do instead of <code>feof()</code>?"}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1458695053, "post_id": 36167892, "comment_id": 59973298, "body": "@KshitijBantupalli: I added it to my answer; if you don&#39;t see it, refresh the page."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1458696411, "post_id": 36167892, "comment_id": 59973652, "body": "@KshitijBantupalli: instead of <code>while(fp)</code>, use <code>int c; while ((c = fgetc(fp)) != EOF)</code>"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user3427559"}, "edited": false, "score": 0, "creation_date": 1458694708, "post_id": 36167918, "comment_id": 59973201, "body": "I just added a <code>while(1)</code> loop and used <code>if(feof(fp))     break;</code>."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1458694866, "post_id": 36167918, "comment_id": 59973251, "body": "@KshitijBantupalli: As I noted in the comments on the question, <a href=\"http://stackoverflow.com/a/3181093/364696\">don&#39;t use <code>feof</code></a>; it only tells you you&#39;ve reached the end of the file after you&#39;ve read garbage. <code>fgetc</code> itself will both read a character and tell you if it has reached the end of the file, so <code>feof</code> is just wasting cycles checking flags when <code>fgetc</code> has already told you what&#39;s going on."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 1, "creation_date": 1458694996, "post_id": 36167918, "comment_id": 59973288, "body": "@KshitijBantupalli: To be clear, the <code>while</code> loop I provided as an example is basically <i>the</i> canonical approach to reading a file one character at a time; most docs (say, <a href=\"http://en.cppreference.com/w/c/io/fgetc\" rel=\"nofollow noreferrer\">cppreference.com&#39;s <code>fgetc</code> docs</a>) use the exact same pattern."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3427559"}, "edited": false, "score": 0, "creation_date": 1458695315, "post_id": 36167918, "comment_id": 59973371, "body": "Thanks @ShadowRanger"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1458696480, "post_id": 36167918, "comment_id": 59973676, "body": "@KshitijBantupalli: the best advice you got here is: <b>never ever use feof()</b>"}], "tags": [], "owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "is_accepted": true, "score": 1, "last_activity_date": 1458694658, "last_edit_date": 1458694658, "creation_date": 1458694286, "answer_id": 36167918, "question_id": 36167892, "link": "https://stackoverflow.com/questions/36167892/can-someone-explain-the-segmentation-fault-in-this/36167918#36167918", "title": "Can someone explain the segmentation fault in this?", "body": "<p>Your problem is:</p>\n\n<pre><code>while (fp)\n</code></pre>\n\n<p>A <code>FILE*</code> is, to a boolean test, just another pointer. So as long as it opened successfully, that test always passes. You keep reading character at a time, storing into successive elements of the array, until you overflow, and eventually end up writing into unallocated memory entirely (or coincidentally stomping something important and causing a crash some other way).</p>\n\n<p>You really want something like:</p>\n\n<pre><code>    // Must read into int; EOF itself is not a char value\n    int inchar;\n    // Read and test for EOF\n    while((inchar = fgetc(fp)) != EOF)\n    {\n        ch[i] = inchar;  // Store\n        i++;\n        printf(\"%d\", inchar); // Print raw value returned by fgetc\n    }\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user3427559"}, "edited": false, "score": 0, "creation_date": 1458695096, "post_id": 36168005, "comment_id": 59973314, "body": "Can you tell me why it will be increased to 400?"}, {"owner": {"reputation": 133, "user_id": 6010681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/311f7f9cba6ef6b8a2c2eaa4815d64df?s=128&d=identicon&r=PG&f=1", "display_name": "stan", "link": "https://stackoverflow.com/users/6010681/stan"}, "edited": false, "score": 1, "creation_date": 1458695392, "post_id": 36168005, "comment_id": 59973386, "body": "You has two loops in your code. &quot;while(count!=0)&quot; is 100 times. &quot;while(fp)&quot; is expected to 4 times. 100 x 4 = 400."}], "tags": [], "owner": {"reputation": 133, "user_id": 6010681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/311f7f9cba6ef6b8a2c2eaa4815d64df?s=128&d=identicon&r=PG&f=1", "display_name": "stan", "link": "https://stackoverflow.com/users/6010681/stan"}, "is_accepted": false, "score": 1, "last_activity_date": 1458694930, "creation_date": 1458694930, "answer_id": 36168005, "question_id": 36167892, "link": "https://stackoverflow.com/questions/36167892/can-someone-explain-the-segmentation-fault-in-this/36168005#36168005", "title": "Can someone explain the segmentation fault in this?", "body": "<p>After you fix \"while (fp)\" issue. You still has problem with ch[i]. With your code, \"i\" will be increased to 400. So segmentation fault occurs.</p>\n\n<pre><code>    while(fp)\n    {\n        ch[i] = fgetc(fp);\n        i++;\n        j = i;\n        printf(\"%d\", j);    \n    }\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user3427559"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 36167918, "answer_count": 2, "score": 0, "last_activity_date": 1458696337, "creation_date": 1458694088, "last_edit_date": 1458696337, "question_id": 36167892, "link": "https://stackoverflow.com/questions/36167892/can-someone-explain-the-segmentation-fault-in-this", "title": "Can someone explain the segmentation fault in this?", "body": "<p>I have written a piece of code which reads a text file foo.txt which is of format:</p>\n\n<pre><code>1\n2\n3\n4\n</code></pre>\n\n<p>It stores the last number and increments it and writes it back. This is the part where I'm storing the last number and the next part of the code will be writing the number to the file. The file is called by <code>./readfile 100 foo.txt</code>, where 100 is the number of times it has to increment the last number.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(int argc, char *argv[]) {\n    FILE *fp;\n    char ch[100];\n    int i = 0;\n    int j = 0;\n    int count = atoi(argv[1]);\n\n    while (count != 0) {\n        fp = fopen(argv[2], \"r\");\n        while (fp) {\n            ch[i] = fgetc(fp);\n            i++;\n            j = i;\n            printf(\"%d\", j);    \n        }\n        fclose(fp);\n        count--;\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "string", "segmentation-fault", "malloc", "strtok"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 2, "creation_date": 1458693877, "post_id": 36167851, "comment_id": 59972966, "body": "<code>sizeof(string)</code> does not do what you think it does."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1458693974, "post_id": 36167851, "comment_id": 59972998, "body": "<code>fgets(string, sizeof(string), fin)</code> --&gt; <code>fgets(string, STR, fin)</code>  : <code>sizeof(string)</code> is <code>sizeof(char*)</code>"}, {"owner": {"reputation": 123, "user_id": 5601732, "user_type": "registered", "accept_rate": 27, "profile_image": "https://lh6.googleusercontent.com/-TiNzHzxbVdQ/AAAAAAAAAAI/AAAAAAAAABE/9GwNCtv0iOU/photo.jpg?sz=128", "display_name": "stellarhawk 34", "link": "https://stackoverflow.com/users/5601732/stellarhawk-34"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1458694261, "post_id": 36167851, "comment_id": 59973074, "body": "@BLUEPIXY thank you so much. Is this because sizeof(string) is actually completely unknown at that point?"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1458694482, "post_id": 36167851, "comment_id": 59973144, "body": "no, pointer size 4 or 8 or etc. but already known."}, {"owner": {"reputation": 4121, "user_id": 2098932, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/BBJGp.jpg?s=128&g=1", "display_name": "Logicrat", "link": "https://stackoverflow.com/users/2098932/logicrat"}, "edited": false, "score": 1, "creation_date": 1458694507, "post_id": 36167851, "comment_id": 59973153, "body": "@stellarhawk34 <code>string</code> is a pointer, so its size is probably 4, unless you are on a 64-bit machine, and then it is likely to be 8. The <code>sizeof()</code> operator has nothing to do with the length of the character string that <code>string</code> point to. For that, you should use <code>strlen()</code>."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 4121, "user_id": 2098932, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/BBJGp.jpg?s=128&g=1", "display_name": "Logicrat", "link": "https://stackoverflow.com/users/2098932/logicrat"}, "edited": false, "score": 1, "creation_date": 1458694782, "post_id": 36167851, "comment_id": 59973222, "body": "@Logicrat: Unfortunately, calling <code>strlen()</code> on the pointer returned by <code>malloc()</code> reads indeterminate values, which means undefined behavior."}], "answers": [{"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 1, "last_activity_date": 1458696096, "creation_date": 1458696096, "answer_id": 36168192, "question_id": 36167851, "link": "https://stackoverflow.com/questions/36167851/why-segmentation-fault-strtok-and-malloc/36168192#36168192", "title": "why segmentation fault? strtok and malloc", "body": "<p>When you make <code>string</code> an allocated array of <code>char</code>, <code>sizeof(string)</code> no longer gives you the size of the array, it gives you the size of the pointer.  Therefore you must change the loop to tell <code>fgets</code> the size of your array:</p>\n\n<pre><code>while (fgets(string, STR, fin)) {\n    ...\n</code></pre>\n\n<p>Or better, if you reallocate the array to size <code>size</code>:</p>\n\n<pre><code>while (fgets(string, size, fin)) {\n    ...\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 5601732, "user_type": "registered", "accept_rate": 27, "profile_image": "https://lh6.googleusercontent.com/-TiNzHzxbVdQ/AAAAAAAAAAI/AAAAAAAAABE/9GwNCtv0iOU/photo.jpg?sz=128", "display_name": "stellarhawk 34", "link": "https://stackoverflow.com/users/5601732/stellarhawk-34"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 233, "favorite_count": 0, "accepted_answer_id": 36168192, "answer_count": 1, "score": 0, "last_activity_date": 1458696189, "creation_date": 1458693734, "last_edit_date": 1458696189, "question_id": 36167851, "link": "https://stackoverflow.com/questions/36167851/why-segmentation-fault-strtok-and-malloc", "title": "why segmentation fault? strtok and malloc", "body": "<p>I have the following code which works perfectly when not using <code>malloc</code>, but when I want to add in dynamic memory allocation it says segmentation fault although it compiles without warnings or errors. Why?</p>\n\n<p>Thanks in advance</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define MAXNUM 30\n#define STR 200 \n#define MAXLEN 40\n\nstruct human { //Va\n    char name[MAXLEN];\n    char surname[MAXLEN];   \n    int age;\n    float weight;\n};\n\nint main(int argc, char *argv[]) {  \n    char *dlim= \",\", *end = \"\\n\", *stop = NULL;\n    char *tok, *string;\n    string = (char *)malloc(sizeof(char) * STR);\n    int i = 0, j = 0;\n\n    struct human man[MAXNUM];\n\n    FILE *fin = fopen(\"data.txt\", \"r\"); \n\n    if (string == NULL) {\n        printf(\"Memory not allocated\");\n    }\n\n    if (fin == NULL) {\n        printf(\"Cannot open file\\n\");\n        exit(0);\n    }\n\n    while (fgets(string, sizeof(string), fin)) {\n        tok = strtok(string, dlim);\n        strcpy(man[i].name, tok);\n\n        tok = strtok(stop, dlim);\n        strcpy(man[i].surname,tok);         \n\n        tok = strtok(stop, dlim);\n        man[i].age = atoi(tok);\n\n        tok = strtok(stop, dlim);\n        man[i].weight = atof(tok);\n\n        i++;\n    }\n    fclose(fin);  \n    free(string);\n\n    j = i;\n    i = 0;\n    while (i &lt; j) {\n        printf(\"%s %s %d %f \\n\", man[i].name, man[i].surname, man[i].age, man[i].weight);   \n        i++;\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "function"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1458692099, "post_id": 36167536, "comment_id": 59972447, "body": "You probably meant the function parameter to be <code>int (*p)[N_ROWS][N_COLS]</code>"}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 1, "creation_date": 1458692310, "post_id": 36167536, "comment_id": 59972509, "body": "Your function is declared to take an array of pointers, and you&#39;re passing it a pointer to an array."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1458692556, "post_id": 36167536, "comment_id": 59972572, "body": "@M.M: I suspect OP just should remove the <code>*</code> from <code>p</code>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458692644, "post_id": 36167536, "comment_id": 59972600, "body": "Look at the declaration of <code>Array</code> and the function argument <code>p</code>. Then think what you pass to <code>p</code>. (But be aware that the <b>semantics</b> differ). An array is not a pointer (and vice versa)."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1458693043, "post_id": 36167536, "comment_id": 59972728, "body": "Remove the <code>*</code> from the function, and remove the <code>&amp;</code> from the call."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458693101, "post_id": 36167536, "comment_id": 59972743, "body": "@Olaf In that case the <code>&amp;</code> would also be removed from <code>&amp;Array</code>, and also it would be possible to call the function with an array with a different number of rows, silently causing undefined behaviour if not enough rows are given. OP may want the compiler to diagnose attempt to pass an array that is not the exact size of both row and column."}, {"owner": {"reputation": 65, "user_id": 5632120, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7d800113ac23f22d24781a11963292a2?s=128&d=identicon&r=PG&f=1", "display_name": "j.yang94", "link": "https://stackoverflow.com/users/5632120/j-yang94"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458693449, "post_id": 36167536, "comment_id": 59972846, "body": "So I removed the * and &amp; and that error went away, but now it&#39;s saying that expression must have a pointer to object type (in my printf statement)  as well as function returning array is not allowed? (No idea what this means) @Olaf Array is declared as a 3x3 array, if I changed the code to  void display(int p)[N_ROWS][N_COLS]  wouldn&#39;t I  be only referencing for an integer and not an array?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1458694141, "post_id": 36167536, "comment_id": 59973047, "body": "@vvid solely removing <code>*</code> and <code>&amp;</code> from the code you posted would not cause that error message. You must have also made some other change. Perhaps you messed with <code>p[i][j]</code>."}, {"owner": {"reputation": 65, "user_id": 5632120, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7d800113ac23f22d24781a11963292a2?s=128&d=identicon&r=PG&f=1", "display_name": "j.yang94", "link": "https://stackoverflow.com/users/5632120/j-yang94"}, "edited": false, "score": 0, "creation_date": 1458694409, "post_id": 36167536, "comment_id": 59973122, "body": "Yeah, I also had to change the () so the prototype read void display(int p[N_ROWS][N_COLS]) I did not have to change with the       p[i][j]"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1458695059, "post_id": 36167536, "comment_id": 59973299, "body": "What did you mean by &quot;I removed the <code>*</code>&quot; then?  The only <code>*</code> in your code was the one in that prototype."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458723569, "post_id": 36167536, "comment_id": 59983169, "body": "You pre-last comment is not clear. Something like <code>void display(int p)[N_ROWS][N_COLS]</code> is invalid syntax. C follows a strict syntax&amp;grammar. Please be exact what you mean - beginner or not."}], "answers": [{"comments": [{"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1458693124, "post_id": 36167742, "comment_id": 59972753, "body": "Your points are correct, but the OP is confused on how to pass a simple 2D array, your explanation just adds to this confusion."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 2, "creation_date": 1458693173, "post_id": 36167742, "comment_id": 59972766, "body": "@user3386109: That would defeat the type checking and allow the calling code to pass, say, an <code>int [1][3]</code> array as an argument. If the array size is always the same, i.e. fixed at compile time, it is a much better idea to enforce the sizing by doing the above, i.e. pass a pointer to the entire array."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1458693333, "post_id": 36167742, "comment_id": 59972815, "body": "@user3386109: C99-specific <code>static</code> keyword in array size does not enforce anything in this case. It works as a hint to the compiler, but it does not trigger compile-time size checking. If you consider this syntax &quot;complicated&quot;, you can always greatly simplify it by using an intermediate <code>typedef</code> for array type. Just do <code>typedef int A[N_ROWS][N_COLS]</code> and then declare <code>A *</code> parameter."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 1, "creation_date": 1458693735, "post_id": 36167742, "comment_id": 59972920, "body": "@jxr: as noted by AnT, your approach does improve type checking, but you must also correct the OP&#39;s code and use <code>printf(&quot;%i&quot;, (*p)[i][j]);</code>"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1458693869, "post_id": 36167742, "comment_id": 59972960, "body": "@jxr: for completeness, you might also add the generalized C99 syntax <code>void display(int n_rows, int n_cols, int p[nrows][n_cols])</code>"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1458693946, "post_id": 36167742, "comment_id": 59972984, "body": "@chqrlie: C.2011 makes VLA an optional feature. I think that means the array syntax support you are advising is also optional."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1458694033, "post_id": 36167742, "comment_id": 59973021, "body": "@user3386109 using the <code>static</code> keyword does not enforce the constraint.  It helps the compiler optimize , and the compiler <i>could</i> emit a warning; but the standard requires that the compiler still compile the code in either case , and in practice no compilers that I&#39;m aware of actually do emit a warning there."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 1, "creation_date": 1458694041, "post_id": 36167742, "comment_id": 59973023, "body": "@chqrlie: A good compiler would warn on the <code>printf</code> usage error."}, {"owner": {"reputation": 65, "user_id": 5632120, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7d800113ac23f22d24781a11963292a2?s=128&d=identicon&r=PG&f=1", "display_name": "j.yang94", "link": "https://stackoverflow.com/users/5632120/j-yang94"}, "edited": false, "score": 0, "creation_date": 1458694168, "post_id": 36167742, "comment_id": 59973052, "body": "I understood up to the part about &quot;An alternative means&quot; but the first part was very helpful and agree with the user, it&#39;s easier to just remove the * and &amp;"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1458694352, "post_id": 36167742, "comment_id": 59973105, "body": "@jxr: what a bummer! Complete VLA support as specified in C99 was indeed a headache, but making the whole thing optional is killing the feature."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1458694497, "post_id": 36167742, "comment_id": 59973147, "body": "@user3386109 what compiler? gcc provides no warning. See http goo.gl/XheF1S .  Also it is hard to see why you would advocate a solution where the compiler may optionally warn; vs. one where the compiler must give an error"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1458694505, "post_id": 36167742, "comment_id": 59973152, "body": "@user3386109: Firstly, there&#39;s no requirement to generate a diagnostic message in such cases and many compilers don&#39;t. I don&#39;t know what specific compilers you are talking about. Secondly, and more importantly, a parameter of type, say, <code>int [static 5]</code> is supposed to accept argument of type <code>int *</code>, i.e. something that is declared as a pointer (not as an array), in which case no compile-time size checking is possible at all."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1458694511, "post_id": 36167742, "comment_id": 59973154, "body": "@jxr: <i>A good compiler would warn on the printf usage error.</i> is a bit of a lame excuse."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1458694700, "post_id": 36167742, "comment_id": 59973197, "body": "@chqrlie: It&#39;s not an excuse, it&#39;s the truth. The question was more or less about array function parameters. The <code>printf</code> was already broken in the original code."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1458696567, "post_id": 36167742, "comment_id": 59973700, "body": "@user3386109: You claim I am advocating a particular approach, when that is inaccurate. I am explaining what the asker passed to <code>display</code>, and how to make <code>display</code> accept that type. Specifically, the last sentence is the actual question: <i>Aren&#39;t both my parameters type <code>int(*)[3][3]</code> or am I missing something?</i>. I explain what is missed."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1458696614, "post_id": 36167742, "comment_id": 59973719, "body": "That error can be detected trivially within the function by anyone looking at the code, whereas the bounds check error cannot be (and in fact it may not even be known at compile-time what size array is passed in).  A ridiculous comparison by you, really"}], "tags": [], "owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "is_accepted": false, "score": 3, "last_activity_date": 1458696151, "last_edit_date": 1458696151, "creation_date": 1458693030, "answer_id": 36167742, "question_id": 36167536, "link": "https://stackoverflow.com/questions/36167536/incompatible-parameter-types/36167742#36167742", "title": "Incompatible parameter types?", "body": "<blockquote>\n  <p><sub>Much of this has already been explained in comments to your question.</sub></p>\n</blockquote>\n\n<p>Your definition of <code>display</code>:</p>\n\n<pre><code>void display(int*p[N_ROWS][N_COLS])\n{\n</code></pre>\n\n<p>This says <code>p</code> will be an array <code>N_ROWS</code> of array <code>N_COLS</code> of pointers to <code>int</code>.</p>\n\n<p>When you call <code>display</code>:</p>\n\n<pre><code>int Array [N_ROWS][N_COLS] = { {1,2,3},{4,5,6},{7,8,9} };\ndisplay(&amp;Array);\n</code></pre>\n\n<p>You are passing in the address of <code>Array</code>, thus it is a pointer to an array <code>N_ROWS</code> of array <code>N_COLS</code> of <code>int</code>.</p>\n\n<p>To make the definition of <code>display</code> match the way you are calling it:</p>\n\n<pre><code>void display(int (*p)[N_ROWS][N_COLS])\n{\n</code></pre>\n\n<p>The parentheses make the <code>*</code> associate with <code>p</code> first. Since <code>p</code> is a pointer to an array of array of <code>int</code>, getting to the <code>int</code> requires an extra dereference:</p>\n\n<pre><code>printf(\"%i\\n\", (*p)[i][j]);\n</code></pre>\n\n<p>Defining <code>display</code> to take a pointer to an array means that the size of the array is bound to the type parameter, and thus <code>display</code> knows exactly the dimensions of the array.</p>\n\n<p>An alternative means would be to define <code>display</code> to take the dimension of the array as a second parameter.</p>\n\n<pre><code>void display(int p[][N_COLS], int n_rows)\n{\n</code></pre>\n\n<p>In this case the <code>p</code> parameter is a pointer to an array <code>N_COLS</code> of <code>int</code>. An <em>array of T</em> when used in most expressions will decay to a value of type <em>pointer to T</em> equal to the address of its first element. Thus, you could call this second version of <code>display</code> like this:</p>\n\n<pre><code>int Array [N_ROWS][N_COLS] = { {1,2,3},{4,5,6},{7,8,9} };\ndisplay(Array, N_ROWS);\n</code></pre>\n\n<p>The advantage of this second approach is that <code>display</code> can work with arrays that have fewer or more than <code>N_ROWS</code>. The disadvantage is that it is up to the caller to pass in the right number of rows.</p>\n\n<p>You might think that the following declaration would give you complete type safety:</p>\n\n<pre><code>void display(int p[N_ROWS][N_COLS])\n{\n</code></pre>\n\n<p>But, the array syntax in C for function parameters cause the size information for <code>p</code> to be ignored, and becomes equivalent to <code>int p[][N_COLS]</code>, which in turn is treated as <code>int (*p)[N_COLS]</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 65, "user_id": 5632120, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7d800113ac23f22d24781a11963292a2?s=128&d=identicon&r=PG&f=1", "display_name": "j.yang94", "link": "https://stackoverflow.com/users/5632120/j-yang94"}, "edited": false, "score": 0, "creation_date": 1458694296, "post_id": 36167792, "comment_id": 59973084, "body": "Is there a specific reason as to why N_ROWS is ignored in the prototype? That&#39;s the only thing I find confusing."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 65, "user_id": 5632120, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7d800113ac23f22d24781a11963292a2?s=128&d=identicon&r=PG&f=1", "display_name": "j.yang94", "link": "https://stackoverflow.com/users/5632120/j-yang94"}, "edited": false, "score": 2, "creation_date": 1458694865, "post_id": 36167792, "comment_id": 59973250, "body": "@vvid: the size information for an array specified as a function parameter is not used by the compiler at all, neither for type checking, nor for <code>sizeof()</code>, because the array is passed as a pointer to its first element and the size is not deemed to be part of the type. It is accepted for historical reasons: the C inventors did not think of how this would become misleading and error prone. They instead must have thought it was a good way for the programmer to tell the next reader of the code what size is <i>expected</i> for the array, which itself is passed as a pointer to its first element."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 65, "user_id": 5632120, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7d800113ac23f22d24781a11963292a2?s=128&d=identicon&r=PG&f=1", "display_name": "j.yang94", "link": "https://stackoverflow.com/users/5632120/j-yang94"}, "edited": false, "score": 1, "creation_date": 1458695165, "post_id": 36167792, "comment_id": 59973335, "body": "@vvid to explain why <code>N_ROWS</code> is ignored, <a href=\"http://stackoverflow.com/questions/22677415/why-do-c-and-c-compilers-allow-array-lengths-in-function-signatures-when-they/22677793#22677793\">see here</a>.  Note that the alternative solution suggested by jxh means that <code>N_ROWS</code> would <i>not</i> be ignored any more, so if you want it to be significant you could consider that approach."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1458695268, "post_id": 36167792, "comment_id": 59973356, "body": "If you pass an array to <code>sizeof()</code>, the size information is not ignored. But, C defines array semantics to mostly allow them to be treated &quot;by reference&quot; so that passing an array to a function doesn&#39;t cause tons of data to be pushed onto the stack. Their approach was to define array semantics so that it decays to a pointer type, and this decayed type is what the function uses. So the function parameter looks like an array but is actually a pointer."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1458695639, "post_id": 36167792, "comment_id": 59973453, "body": "@jxr: indeed <i>the argument looks like an array but is actually a pointer</i>, it is very misleading, especially for <code>sizeof()</code> and any similar macros to compute the number of elements of this false array."}, {"owner": {"reputation": 65, "user_id": 5632120, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7d800113ac23f22d24781a11963292a2?s=128&d=identicon&r=PG&f=1", "display_name": "j.yang94", "link": "https://stackoverflow.com/users/5632120/j-yang94"}, "edited": false, "score": 0, "creation_date": 1458696338, "post_id": 36167792, "comment_id": 59973638, "body": "@chqrlie how are you making those grey boxes? I try Ctrl+K and 5 spaces but it doesn&#39;t turn gray"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 65, "user_id": 5632120, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7d800113ac23f22d24781a11963292a2?s=128&d=identicon&r=PG&f=1", "display_name": "j.yang94", "link": "https://stackoverflow.com/users/5632120/j-yang94"}, "edited": false, "score": 0, "creation_date": 1458696597, "post_id": 36167792, "comment_id": 59973712, "body": "@vvid: use the backquotes glued to the text: `code` will appear as <code>code</code>"}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 4, "last_activity_date": 1458695153, "last_edit_date": 1458695153, "creation_date": 1458693310, "answer_id": 36167792, "question_id": 36167536, "link": "https://stackoverflow.com/questions/36167536/incompatible-parameter-types/36167792#36167792", "title": "Incompatible parameter types?", "body": "<p>Your prototype for <code>display</code> is incorrect, as well as your call syntax: you define <code>display</code> to take a 2D array of pointers to <code>int</code>, whereas you just want a 2D array if <code>int</code>, as you pass a pointer to the array in <code>main</code> where you just want to pass the array, decaying as a pointer to its first element.</p>\n\n<p>Here is a simpler version:</p>\n\n<pre><code>void display(int p[N_ROWS][N_COLS]) {\n    int i, j;\n    for (i = 0; i &lt; N_ROWS; i++) {\n        for (j = 0; j &lt; N_COLS; j++) {\n            printf(\"%i\", p[i][j]);\n        }\n    }\n}\n</code></pre>\n\n<p>Note however that <code>p</code> above can have any number of rows, <code>N_ROWS</code> is ignored in the prototype, equivalent to <code>void display(int (*p)[N_COLS])</code>.</p>\n\n<p>Note also that your <code>printf</code> will output the matrix values without any separation.  This might not be your intent.</p>\n\n<p>And from <code>main</code>:</p>\n\n<pre><code>{\n    int Array[N_ROWS][N_COLS] = { {1,2,3},{4,5,6},{7,8,9} };\n    display(Array);\n}\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 5632120, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7d800113ac23f22d24781a11963292a2?s=128&d=identicon&r=PG&f=1", "display_name": "j.yang94", "link": "https://stackoverflow.com/users/5632120/j-yang94"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 504, "favorite_count": 0, "accepted_answer_id": 36167792, "answer_count": 2, "score": 2, "last_activity_date": 1458696151, "creation_date": 1458691638, "last_edit_date": 1458695414, "question_id": 36167536, "link": "https://stackoverflow.com/questions/36167536/incompatible-parameter-types", "title": "Incompatible parameter types?", "body": "<p>I want to use another function to print the contents of an array.\nWhen I run the code I get \"IntelliSense: argument of type \"int (*)[3][3]\" is incompatible with parameter of type \"int *(*)[3]\"</p>\n\n<p>This is my function:</p>\n\n<pre><code>void display(int *p[N_ROWS][N_COLS]) {\n    int i, j;\n    for (i = 0; i &lt; N_ROWS; i++) {\n        for (j = 0; j &lt;N _COLS; j++) {\n            printf(\"%i\", p[i][j]);\n        }\n    }\n}\n</code></pre>\n\n<p>I defined <code>N_ROWS</code> and <code>N_COLS</code>\nand in my <code>main</code> function I declare my array and then call the function</p>\n\n<pre><code>{\n    int Array[N_ROWS][N_COLS] = { {1,2,3},{4,5,6},{7,8,9} };\n    display(&amp;Array);\n}\n</code></pre>\n\n<p>Aren't both my parameters type <code>int(*)[3][3]</code> or am I missing something?</p>\n"}]