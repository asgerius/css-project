[{"tags": ["c", "hash", "salt", "crypt"], "comments": [{"owner": {"reputation": 968, "user_id": 484560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1226dc0cb4aeb50e8b9922c0931bedd3?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/484560/mark"}, "edited": false, "score": 0, "creation_date": 1574294284, "post_id": 58965170, "comment_id": 104185438, "body": "Is this C or C++?"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1574294538, "post_id": 58965170, "comment_id": 104185491, "body": "Strings in C need to be NUL terminated. Make sure <code>pre_salt</code> is one larger than the number of characters and ensure last element is 0."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1574295167, "post_id": 58965170, "comment_id": 104185648, "body": "Missing zero-terminator, also C doesn&#39;t have a &quot;string&quot; type, so a function can&#39;t return one. If you&#39;re using &quot;string&quot; as a synonym for &quot;char*&quot;, then your function is returning a local that will go out of scope."}, {"owner": {"reputation": 97, "user_id": 9453818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82bc33dfa828cad0b1cdb9cb68d65f4a?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando Velasco Borea", "link": "https://stackoverflow.com/users/9453818/fernando-velasco-borea"}, "edited": false, "score": 0, "creation_date": 1574297232, "post_id": 58965170, "comment_id": 104186160, "body": "Just tried that adding a &#39;\\0&#39; to the last element of the sting and worked out! I&#39;m using a library that has the string data type into it so even though I&#39;m using C, I&#39;m able to pass string type variables to functions as inputs or outputs. I have a question, what&#39;s the difference of declaring a char* variable instead of a char variable?"}], "answers": [{"comments": [{"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1574295209, "post_id": 58965243, "comment_id": 104185657, "body": "Probably still returning a pointer to a local that will go out of scope."}, {"owner": {"reputation": 97, "user_id": 9453818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82bc33dfa828cad0b1cdb9cb68d65f4a?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando Velasco Borea", "link": "https://stackoverflow.com/users/9453818/fernando-velasco-borea"}, "edited": false, "score": 0, "creation_date": 1574297288, "post_id": 58965243, "comment_id": 104186174, "body": "I used a slight variation of this :) I initialized pre_salt to size 3, and after the for loop I added to the last element a &#39;\\0&#39;. Thanks!"}], "tags": [], "owner": {"reputation": 240, "user_id": 2832768, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uwee8.png?s=128&g=1", "display_name": "guilleamodeo", "link": "https://stackoverflow.com/users/2832768/guilleamodeo"}, "is_accepted": true, "score": 1, "last_activity_date": 1574294551, "creation_date": 1574294551, "answer_id": 58965243, "question_id": 58965170, "link": "https://stackoverflow.com/questions/58965170/how-to-extract-the-first-x-characters-of-a-string-and-use-them-into-another-in-c/58965243#58965243", "title": "How to extract the first X characters of a string and use them into another in C", "body": "<p>You are missing the string's NUL terminator '\\0' so it keeps printing until it finds one.\nDeclare it like:</p>\n\n<pre><code>char  pre_salt[3]={0,0,0};\n</code></pre>\n\n<p>And problem solved.</p>\n"}], "owner": {"reputation": 97, "user_id": 9453818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82bc33dfa828cad0b1cdb9cb68d65f4a?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando Velasco Borea", "link": "https://stackoverflow.com/users/9453818/fernando-velasco-borea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "closed_date": 1574331166, "accepted_answer_id": 58965243, "answer_count": 1, "score": 0, "last_activity_date": 1574294551, "creation_date": 1574293999, "question_id": 58965170, "link": "https://stackoverflow.com/questions/58965170/how-to-extract-the-first-x-characters-of-a-string-and-use-them-into-another-in-c", "closed_reason": "Duplicate", "title": "How to extract the first X characters of a string and use them into another in C", "body": "<p>I have made this function to extract the first 2 characters of a string:</p>\n\n<pre><code>string get_salt(string hash)\n{\n    char pre_salt[2];\n\n    for (int i = 0; i &lt; 2; i++)\n    {\n        pre_salt[i] = hash[i];\n    }\n    string salt = pre_salt;\n    printf(\"%s\\n\", salt);\n    return(salt);\n}\n</code></pre>\n\n<p>But when I run it with a string that has \"50\" (is the example I'm using) as the first 2 characters, I get this output:</p>\n\n<pre><code>50r\u00aeB\n</code></pre>\n\n<p>And to be honest I have no idea why is it adding the 3 extra characters to the resulting string.</p>\n"}, {"tags": ["c", "arrays", "loops", "binary", "cryptography"], "comments": [{"owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "edited": false, "score": 0, "creation_date": 1574303004, "post_id": 58965130, "comment_id": 104187503, "body": "I&#39;m not entirely sure what the integers are supposed to hold in your key array, I&#39;ve written an answer for a byte[] instead. Just implementing an <code>inc</code> function should work no matter what though."}, {"owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "edited": false, "score": 0, "creation_date": 1574304479, "post_id": 58965130, "comment_id": 104187851, "body": "Note that this goes thourgh all possible <i>values</i> of the key. I&#39;m not sure that you actually mean &quot;permutations&quot;, that&#39;s not what your example shows anyway."}], "answers": [{"comments": [{"owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "edited": false, "score": 0, "creation_date": 1574303805, "post_id": 58966285, "comment_id": 104187697, "body": "It&#39;s of course easy to do the same thing for an <code>unsigned char</code> array, no need for <code>unsigned int</code> type if you limit to 0..255."}], "tags": [], "owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "is_accepted": false, "score": 0, "last_activity_date": 1574304136, "last_edit_date": 1574304136, "creation_date": 1574302850, "answer_id": 58966285, "question_id": 58965130, "link": "https://stackoverflow.com/questions/58965130/define-all-permutations-for-key-in-array/58966285#58966285", "title": "Define all permutations for key in array", "body": "<p>If you want to loop through all 2^(6*8) = 2^48 values (a very large number, mind you) the you can simply see the key as a number and then loop through all possible values by increasing the number, e.g. in Java:</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>\n/**\n * Increases a number encoded as a byte array, where the byte array represents a big endian number.\n * \n * @param bin the binary array that needs to be increased\n * @return true on carry after the maximum value has been reached\n */\nprivate static boolean inc(byte[] bin) {\n    for (int i = bin.length - 1; i &gt;= 0; i--) {\n\n        if (++bin[i] != 0) {\n            return false;\n        }\n        // if the binary number reaches 0 again\n        // we have looped and need to continue\n    }\n    // all values have become 00 now, so we have looped (a carry to the 49'th bit)\n    return true;\n}\n\npublic static void main(String[] args) {\n    byte[] key = new byte[6];\n    do {\n        System.out.println(Hex.encode(key));\n    } while (!inc(key));\n}\n</code></pre>\n\n<p>This is easy to replicate in C. Let <code>i</code> to from <code>0</code> to <code>bin.length - 1</code> if you want little endian rather than big endian.</p>\n\n<p>This is also clearly shown when you show your possible values:</p>\n\n<pre><code> 000 100 010 110 001 101 011 111\n</code></pre>\n\n<p>this is just counting, although your least significant value is at the left rather than the right.</p>\n"}], "owner": {"reputation": 11, "user_id": 12391517, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-llQXHi53-gI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdoVtrxJVaknL4qYTXTxtTIs1CLzw/photo.jpg?sz=128", "display_name": "Liam Waters", "link": "https://stackoverflow.com/users/12391517/liam-waters"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574304136, "creation_date": 1574293730, "last_edit_date": 1574303333, "question_id": 58965130, "link": "https://stackoverflow.com/questions/58965130/define-all-permutations-for-key-in-array", "title": "Define all permutations for key in array", "body": "<p>I am trying to create all iterations for a cryptography key. I've the following code:</p>\n\n<pre><code>unsigned int key[6] = {0x0,0x0,0x0,0x0,0x0,0x0};\nint count = 0;\n\nfor (int i = 0; i &lt; 6; i++)  //iterate through key\n{\n    for (int j = 0; j &lt; 256; j++)\n    {\n        key[i] = j;\n\n        for (int i = 0; i &lt; 6; i++)\n        {\n            printf(\"%02x\", key[i]);\n        }\n        printf(\"\\n\");\n    }\n\n}\n</code></pre>\n\n<p>It only iterated through one item at a time from left to right and doesn't create all permutations i.e. if it was binary the above goes:</p>\n\n<p>000\n100\n110\n111</p>\n\n<p>instead of \n000\n100\n010\n110\n001\n101\n011\n111</p>\n\n<p>Is there an easy way to loop through all keys easily without tripping up over for loops?\nThanks, Liam.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1574293953, "post_id": 58965119, "comment_id": 104185376, "body": "<code>while(gets_s(write,99) != &#39;\\0&#39;)</code> is not comparing the return from <code>gets_s()</code> to <code>NULL</code>."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1574293991, "post_id": 58965119, "comment_id": 104185385, "body": "You probably mean <code>while (gets_s(...) != NULL)</code>."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 2, "creation_date": 1574294118, "post_id": 58965119, "comment_id": 104185405, "body": "Also, <code>gets_s()</code> is effectively non-portable and Microsoft-only. Also, Microsoft&#39;s implementation of the C Standard&#39;s optional Annex K functionality also <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1967.htm\" rel=\"nofollow noreferrer\">does not comply with the C Standard</a>.  And it&#39;s arguably not any safer than standard, portable C functions."}, {"owner": {"reputation": 1, "user_id": 12407077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b600fd64edc61c4cf489e1c091710c78?s=128&d=identicon&r=PG&f=1", "display_name": "Lifeisgood", "link": "https://stackoverflow.com/users/12407077/lifeisgood"}, "edited": false, "score": 0, "creation_date": 1574294148, "post_id": 58965119, "comment_id": 104185409, "body": "actually I tried NULL as well, but it still does the same work... I changed &#39;\\0&#39; to NULL from the post."}, {"owner": {"reputation": 25744, "user_id": 2089675, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sBz5q.jpg?s=128&g=1", "display_name": "smac89", "link": "https://stackoverflow.com/users/2089675/smac89"}, "edited": false, "score": 0, "creation_date": 1574294251, "post_id": 58965119, "comment_id": 104185435, "body": "<code>gets_s</code> only returns <code>NULL</code> when there is nothing to read."}, {"owner": {"reputation": 200780, "user_id": 116908, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54d38793d7a407446999b33b81d607fd?s=128&d=identicon&r=PG", "display_name": "Carl Norum", "link": "https://stackoverflow.com/users/116908/carl-norum"}, "edited": false, "score": 0, "creation_date": 1574294313, "post_id": 58965119, "comment_id": 104185443, "body": "How are you trying to get <code>NULL</code> back? That&#39;s only going to happen if you manage to close the input stream somehow. Maybe you meant to check for an empty string (or just a newline) instead?"}, {"owner": {"reputation": 1, "user_id": 12407077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b600fd64edc61c4cf489e1c091710c78?s=128&d=identicon&r=PG&f=1", "display_name": "Lifeisgood", "link": "https://stackoverflow.com/users/12407077/lifeisgood"}, "edited": false, "score": 0, "creation_date": 1574294370, "post_id": 58965119, "comment_id": 104185454, "body": "yes. that is what I meant"}], "answers": [{"comments": [{"owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "edited": false, "score": 1, "creation_date": 1574296555, "post_id": 58965217, "comment_id": 104185998, "body": "The documentation refers to a nonexistent sister function <code>fgets_s</code>. :)"}], "tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": false, "score": 1, "last_activity_date": 1574294354, "creation_date": 1574294354, "answer_id": 58965217, "question_id": 58965119, "link": "https://stackoverflow.com/questions/58965119/whilegets-s-null-is-not-terminating-by-enter-in-c-programming/58965217#58965217", "title": "while(gets_s != NULL) is not terminating by enter in C programming", "body": "<p>Per <a href=\"https://docs.microsoft.com/en-us/cpp/c-runtime-library/reference/gets-s-getws-s?view=vs-2019\" rel=\"nofollow noreferrer\">Microsoft's <code>gets_s()</code> documentation</a>, <code>gets_s()</code> returns <code>NULL</code> on end-of-file and error conditions:</p>\n\n<blockquote>\n  <p><strong>Return Value</strong></p>\n  \n  <p>Returns buffer if successful. A NULL pointer indicates an error or\n  end-of-file condition. Use <code>ferror</code> or <code>feof</code> to determine which one\n  has occurred.</p>\n</blockquote>\n\n<p>Hitting the <code>enter</code> key does not close the input stream and cause an end-of-file condition.  It just places a zero-length line terminated with a newline in the input stream.</p>\n\n<p>To do that on Windows from a terminal, one usually has to enter the <code>CTRL-Z</code> key combination.</p>\n"}, {"tags": [], "owner": {"reputation": 240, "user_id": 2832768, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uwee8.png?s=128&g=1", "display_name": "guilleamodeo", "link": "https://stackoverflow.com/users/2832768/guilleamodeo"}, "is_accepted": false, "score": 0, "last_activity_date": 1574295595, "creation_date": 1574295595, "answer_id": 58965386, "question_id": 58965119, "link": "https://stackoverflow.com/questions/58965119/whilegets-s-null-is-not-terminating-by-enter-in-c-programming/58965386#58965386", "title": "while(gets_s != NULL) is not terminating by enter in C programming", "body": "<p>You need to do some handling there as gets_s() will return and empty string when enter is hit. You can write an extra function to handle that:</p>\n\n<pre><code>size_t my_gets(char *buf,size_t len)\n{\n    size_t ret=0;\n\n    if(gets_s(buf,len))\n        ret = strlen(buf);\n    return ret;\n}  \n</code></pre>\n\n<p>Then change your loop to:</p>\n\n<pre><code>while(my_gets(write,99))\n{\n   ...\n</code></pre>\n\n<p>P.S.- You should avoid calling variables with the same name of system functions (i.e. write).</p>\n"}], "owner": {"reputation": 1, "user_id": 12407077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b600fd64edc61c4cf489e1c091710c78?s=128&d=identicon&r=PG&f=1", "display_name": "Lifeisgood", "link": "https://stackoverflow.com/users/12407077/lifeisgood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1574295595, "creation_date": 1574293642, "last_edit_date": 1574294302, "question_id": 58965119, "link": "https://stackoverflow.com/questions/58965119/whilegets-s-null-is-not-terminating-by-enter-in-c-programming", "title": "while(gets_s != NULL) is not terminating by enter in C programming", "body": "<p>I am trying to write user input to a txt file using a while loop.</p>\n\n<p>But for some reason that I don't know, the while loop doesn't stop by clicking 'enter'.\nwhen I click 'enter', I see \"while loop executed\" so I know the while loop iterated again even though I wanted to stop the while loop.</p>\n\n<p>How to do it in a right way?</p>\n\n<p>P.S: I use Microsoft Visual Studio recommended by my professor.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nvoid main()\n{\n    //writing to file\n    char write[100];\n    char fileName[100];\n\n    printf(\"give a name for file: \");\n    gets_s(fileName,99);\n    strcat(fileName,\".txt\");\n\n    FILE* pF = fopen(fileName, \"w\");\n\n    printf(\"what needs to be written?\\n: \");\n\n    while(gets_s(write,99) != NULL)\n    {\n        printf(\"whileloop executed\\n\");\n        fprintf(pF,\"%s\\n\", write);\n    }\n\n    fclose(pF);\n}\n</code></pre>\n"}, {"tags": ["c", "algorithm", "stack"], "comments": [{"owner": {"reputation": 362, "user_id": 11727940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdf7d156412549dc797ed8854f8cc1c1?s=128&d=identicon&r=PG&f=1", "display_name": "abdullahalali", "link": "https://stackoverflow.com/users/11727940/abdullahalali"}, "edited": false, "score": 0, "creation_date": 1574290988, "post_id": 58964735, "comment_id": 104184526, "body": "Could you share a bit of code to help provide an answer?"}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 1, "creation_date": 1574291001, "post_id": 58964735, "comment_id": 104184534, "body": "What problems have you encountered? What code have you written so far? If you haven&#39;t even written any code yet, how would you solve the problem by hand? What steps does it take to solve the problem? Write these down in words and then try to translate those words into code."}, {"owner": {"reputation": 70549, "user_id": 4785185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ChR5h.jpg?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/4785185/prune"}, "edited": false, "score": 0, "creation_date": 1574292040, "post_id": 58964735, "comment_id": 104184903, "body": "Welcome to StackOverflow. <a href=\"https://stackoverflow.com/help/on-topic\">On topic</a>, <a href=\"https://stackoverflow.com/help/how-to-ask\">how to ask</a>, and ... <a href=\"https://codeblog.jonskeet.uk/2010/08/29/writing-the-perfect-question/\" rel=\"nofollow noreferrer\">the perfect question</a> apply here.  StackOverflow is a knowledge base for <i>specific</i> programming problems -- not a design, coding, research, or tutorial resource. Post the code or logic you used for your existing implementation, and your efforts in extracting the same information in a stack environment."}, {"owner": {"reputation": 53, "user_id": 12407006, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDdN1_4sVdV_UwYwoiu4fvU1GqzhcBqZfM7ICrbPg=k-s128", "display_name": "Caio Pardal", "link": "https://stackoverflow.com/users/12407006/caio-pardal"}, "reply_to_user": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1574299475, "post_id": 58964735, "comment_id": 104186663, "body": "@Code-Apprentice I edited the question with some code that I did so far"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1574300552, "post_id": 58964735, "comment_id": 104186915, "body": "You&#39;ve still not explained the problem you&#39;re having with the code or asked a specific question related to that code. Your question as currently written reads like a <i>Here&#39;s what I&#39;ve done. Can you finish my homework for me?</i> question, and we don&#39;t do that here. :-)"}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1574367863, "post_id": 58964735, "comment_id": 104218871, "body": "@CaioPardal Thanks for the code example. Now what problem have you encountered with it? What is it doing? Is there an error? If so, what is it? If not what is the output and what do you want it to be instead? I suggest you read <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">this article</a> for tips on how to debug your code."}, {"owner": {"reputation": 53, "user_id": 12407006, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDdN1_4sVdV_UwYwoiu4fvU1GqzhcBqZfM7ICrbPg=k-s128", "display_name": "Caio Pardal", "link": "https://stackoverflow.com/users/12407006/caio-pardal"}, "reply_to_user": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1574370734, "post_id": 58964735, "comment_id": 104220157, "body": "@Code-Apprentice thanks for your support. I was able to identify my problem and fix my code."}], "owner": {"reputation": 53, "user_id": 12407006, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDdN1_4sVdV_UwYwoiu4fvU1GqzhcBqZfM7ICrbPg=k-s128", "display_name": "Caio Pardal", "link": "https://stackoverflow.com/users/12407006/caio-pardal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574334433, "creation_date": 1574290827, "last_edit_date": 1574299375, "question_id": 58964735, "link": "https://stackoverflow.com/questions/58964735/stack-algorithm-to-obtain-the-greatest-number-after-remove-n-digits", "title": "Stack algorithm to obtain the greatest number after remove n digits", "body": "<p>I'm having trouble to implement a stack based algorithm in C to obtain the greatest number after removing n digits from the number.</p>\n\n<p>Basically the problem is:</p>\n\n<ul>\n<li>given N and a number with k digits, I need to obtain the greatest number after removing n first digits from the given k digit number.\ne.g.: 38271 and 2 => Greatest number is 871.</li>\n</ul>\n\n<p>I achieved doing this with an array implementation, but I'm not achieving to do this using a stack.</p>\n\n<p>Anyone could help me?</p>\n\n<p><strong>Edit 1: This is my code so far (I'm trying to read a sequence of numbers and get the greatest element of each one of them</strong></p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdio.h&gt;\n\n#include \"pilha.h\"\n\nvoid printNGE(int arr[], int n) \n{ \n    int i = 0; \n    struct Stack* stack = createStack(100); \n    stack-&gt;top = -1; \n    int element, next; \n\n    /* push the first element to stack */\n    push(stack, arr[0]); \n\n    // iterate for rest of the elements \n    for (i=1; i&lt;n; i++) \n    { \n        next = arr[i]; \n\n        if (!isEmpty(stack)) \n        { \n            // if stack is not empty, then pop an element from stack \n            element = pop(stack); \n\n            /* If the popped element is smaller than next, then \n                a) print the pair \n                b) keep popping while elements are smaller and \n                stack is not empty */\n            while (element &lt; next) \n            { \n                printf(\"n %d --&gt; %d\\n\", element, next); \n                if(isEmpty(stack)) \n                   break; \n                element = pop(stack); \n            }\n\n            /* If element is greater than next, then push \n               the element back */\n            if (element &gt; next) \n                push(stack, element); \n        } \n\n        /* push next to stack so that we can find \n           next greater for it */\n        push(stack, next); \n    } \n\n    /* After iterating over the loop, the remaining \n       elements in stack do not have the next greater \n       element, so print -1 for them */\n    while (!isEmpty(stack)) \n    { \n        element = pop(stack); \n        next = -1; \n        printf(\"n %d --&gt; %d\\n\", element, next); \n    } \n} \n\nint main()\n{\n   int m;\n\n   scanf(\"%d\", &amp;m); // n\u00famero de sequ\u00eancias que ser\u00e3o inseridas\n   printf(\"\\nsequences: : %d\\n\", m);\n\n   while (m &gt; 0) {\n        char *str;\n        char c = '\\0';\n        int i = 0, j = 1;\n\n        str = (char*)malloc(sizeof(char));\n\n        while (c != '\\n') {\n            // read the input from keyboard standard input\n            c = getc(stdin);\n\n            // re-allocate (resize) memory for character read to be stored\n            str = (char*)realloc(str, j * sizeof(char));\n\n            // store read character by making pointer point to c\n            str[i] = c;\n\n            i++;\n            j++;\n        }\n\n        str[i] = '\\0';\n        printf(\"\\nThe entered string is : %s\", str);\n\n        char delim[] = \" \";\n        char *ptr = strtok(str, delim);\n        char *aux[2];\n\n        int x = 0;\n        while (ptr != NULL) {\n        aux[x] = ptr;\n        ptr = strtok(NULL, delim);\n        x++;\n        }\n\n        free(str);\n\n        int tam = strlen(aux[0]);\n        printf(\"\\nThe tam is : %d\\n\", tam);\n        char number[tam];\n\n        strcpy(number, aux[0]);\n        printf(\"\\nThe number string is : %s\\n\", number);\n\n        int n = atoi(aux[1]); // converting second parameter passed to integer  \n        printf(\"\\nThe splitted number is : %d\\n\", n);\n\n\n        int arrayOfNumberDigits[tam];\n        for (int l = 0 ; l &lt; tam ; l++) {\n            int data = number[l] - '0';\n            arrayOfNumberDigits[l] = data;\n        }\n\n        printNGE(arrayOfNumberDigits, tam);\n\n        m--;\n   }\n\n   return EXIT_SUCCESS;\n} \n\n**Stack implementation**\n\nstack.c code\n\n\n#include &lt;stdlib.h&gt;\n#include &lt;limits.h&gt; \n\n#include \"pilha.h\"\n\nstruct Stack* createStack(unsigned capacity) \n{ \n    struct Stack* stack = (struct Stack*)malloc(sizeof(struct Stack)); \n    stack-&gt;capacity = capacity; \n    stack-&gt;top = -1; \n    stack-&gt;array = (int*)malloc(stack-&gt;capacity * sizeof(int)); \n    return stack; \n}\n\nint isFull(struct Stack* stack) \n{ \n    return stack-&gt;top == stack-&gt;capacity - 1; // Se o topo for igual \u00e0 capacidade, est\u00e1 cheia.\n} \n\n// Stack is empty when top is equal to -1 \nint isEmpty(struct Stack* stack) \n{ \n    return stack-&gt;top == -1; // est\u00e1 vazia quando o topo \u00e9 igual a -1\n} \n\nvoid push(struct Stack* stack, int item) \n{ \n    if (isFull(stack)) // verifica se est\u00e1 cheia, se estiver n\u00e3o \u00e9 poss\u00edvel adicionar\n        return; \n    stack-&gt;array[++stack-&gt;top] = item; // caso n\u00e3o esteja cheia, adiciona um item no final da pilha e aumenta o topo\n} \n\nint pop(struct Stack* stack) \n{ \n    if (isEmpty(stack)) // checa se est\u00e1 vazia, retornando falso\n        return INT_MIN; \n    return stack-&gt;array[stack-&gt;top--]; // se n\u00e3o estiver vazia, remove o \u00faltimo item e diminui o topo\n} \n\nint peek(struct Stack* stack) \n{ \n    if (isEmpty(stack)) // checa se existe um topo\n        return INT_MIN; \n    return stack-&gt;array[stack-&gt;top]; // se existir, remove o topo\n} \n</code></pre>\n"}, {"tags": ["c", "segmentation-fault"], "comments": [{"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1574290879, "post_id": 58964649, "comment_id": 104184476, "body": "in the code you&#39;ve shared, the one mystery dereference is indeed <code>old-&gt;previous</code>. If that hasn&#39;t been initialized to point to valid memory, then <code>old-&gt;</code> invokes undefined behavior. What do you do with <code>old</code> before passing it to <code>list_prepend</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 128, "user_id": 9181468, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xL05UTpdjWw/AAAAAAAAAAI/AAAAAAAAABA/CdGzAPG6x_g/photo.jpg?sz=128", "display_name": "Apo", "link": "https://stackoverflow.com/users/9181468/apo"}, "edited": false, "score": 0, "creation_date": 1574292060, "post_id": 58964784, "comment_id": 104184910, "body": "I use the type of list found online at <a href=\"https://fr.wikibooks.org/wiki/Structures_de_donn%C3%A9es_en_C/Les_listes_simples\" rel=\"nofollow noreferrer\">fr.wikibooks.org/wiki/Structures_de_donn%C3%A9es_en_C/&hellip;</a> I&#39;ve just change it a little bit to add a pointer to the previous element in the list. I don&#39;t use the fact list_append it doesn&#39;t work don&#39;t look at it I going to delete it because I don&#39;t use it."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 128, "user_id": 9181468, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xL05UTpdjWw/AAAAAAAAAAI/AAAAAAAAABA/CdGzAPG6x_g/photo.jpg?sz=128", "display_name": "Apo", "link": "https://stackoverflow.com/users/9181468/apo"}, "edited": false, "score": 0, "creation_date": 1574292309, "post_id": 58964784, "comment_id": 104184982, "body": "@jeanalpha2401 No, you don&#39;t. That is a singly-linked list (no <code>prev</code> or <code>previous</code> pointer) and you are using a doubly-linked list (each node has a pointer to its previous node)."}, {"owner": {"reputation": 128, "user_id": 9181468, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xL05UTpdjWw/AAAAAAAAAAI/AAAAAAAAABA/CdGzAPG6x_g/photo.jpg?sz=128", "display_name": "Apo", "link": "https://stackoverflow.com/users/9181468/apo"}, "edited": false, "score": 0, "creation_date": 1574292662, "post_id": 58964784, "comment_id": 104185081, "body": "ok, I get rid of it. But now how can I do? I want it to be NULL by default but I want to change it in this function. How can I affect it to a new value without accessing it? Is there another way I don&#39;t see?"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 128, "user_id": 9181468, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xL05UTpdjWw/AAAAAAAAAAI/AAAAAAAAABA/CdGzAPG6x_g/photo.jpg?sz=128", "display_name": "Apo", "link": "https://stackoverflow.com/users/9181468/apo"}, "edited": false, "score": 0, "creation_date": 1574293341, "post_id": 58964784, "comment_id": 104185244, "body": "Just write the code that does what you want. In the case of <code>list_prepend</code> you probably want to eliminate the pre-condition by testing if <code>old</code> is <code>NULL</code> and handling that case correctly. <code>if (old) old-&gt;previous = list;</code>."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 128, "user_id": 9181468, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xL05UTpdjWw/AAAAAAAAAAI/AAAAAAAAABA/CdGzAPG6x_g/photo.jpg?sz=128", "display_name": "Apo", "link": "https://stackoverflow.com/users/9181468/apo"}, "edited": false, "score": 0, "creation_date": 1574293431, "post_id": 58964784, "comment_id": 104185264, "body": "Your attempt to &quot;change&quot; a singly-linked list to a doubly linked list is inadvisable. The two data structures are different enough that it&#39;s much easier to just code a properly doubly-linked list from scratch. It&#39;s too easy to get it wrong (as you did) and miss cases."}, {"owner": {"reputation": 128, "user_id": 9181468, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xL05UTpdjWw/AAAAAAAAAAI/AAAAAAAAABA/CdGzAPG6x_g/photo.jpg?sz=128", "display_name": "Apo", "link": "https://stackoverflow.com/users/9181468/apo"}, "edited": false, "score": 0, "creation_date": 1574294411, "post_id": 58964784, "comment_id": 104185466, "body": "I just started a month ago programming in C, before I used to code in python I didn&#39;t know about that doubly-linked list thing and where to find it. Thank you for your help."}], "tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": true, "score": 3, "last_activity_date": 1574291395, "last_edit_date": 1574291395, "creation_date": 1574291094, "answer_id": 58964784, "question_id": 58964649, "link": "https://stackoverflow.com/questions/58964649/a-implementation-in-c-segmentation-fault/58964784#58964784", "title": "A* Implementation in C, Segmentation fault", "body": "<pre><code>NodeList * list_prepend(NodeList *old, Node *pNode)\n{\n\n    NodeList *list = list_create(pNode);\n    if (list){\n       list-&gt;next = old;\n       (*old).previous = list; // Since this accesses *old, old cannot be NULL\n    }\n    return list;\n}\n</code></pre>\n\n<p>See the comment above. It is a pre-condition of calling <code>list_prepend</code> that <code>old</code> not be <code>NULL</code>.</p>\n\n<pre><code>NodeList * getNeighbours(Node grid[row][column], Node * pNode)\n{\n        int x, y;\n        NodeList * list = NULL;\n        for(x = -1; x &lt;= 1; x++){\n                for(y = -1; y &lt;= 1; y++){\n                        if(x == y || x == -y)\n                                continue;\n\n                        int checkX = pNode-&gt;pos.x + x;\n                        int checkY = pNode-&gt;pos.y + y;\n                        if (checkX &gt;= 0 &amp;&amp; checkX &lt; column &amp;&amp; checkY &gt;= 0 &amp;&amp; checkY &lt; row){\n                                list = list_prepend(list, &amp;(grid[checkY][checkX])); // Uh oh, list is NULL on first invocation\n                        }\n                }           \n        }\n        return list;\n}\n</code></pre>\n\n<p>See the comment. The first call to <code>list_prepend</code> violates the pre-condition. It is very important to clearly document (in comments) the pre-conditions of your functions. It is also extremely helpful to test that all pre-conditions are true and report any that aren't. It makes debugging much easier.</p>\n\n<p>I'm also puzzled by your thinking in a few places. For example:</p>\n\n<pre><code>NodeList * list_append(NodeList *list, Node *pNode)\n{/*Rajouter le previous*/\n    NodeList **plist = &amp;list;\n    while (*plist)\n       plist = &amp;(*plist)-&gt;next;\n    *plist = list_create(pNode);\n    if (*plist)\n       return list;\n    else\n       return NULL;\n}\n</code></pre>\n\n<p>Why the mess with double indirection in <code>plist</code>? And why don't you set the newly-created node's <code>prev</code>? Why not just:</p>\n\n<pre><code>NodeList * list_append(NodeList *list, Node *pNode)\n{\n    if (list == NULL)\n        return list_create(pNode);\n    NodeList *plist = list;\n    while (plist-&gt;next != NULL)\n       plist = plist-&gt;next;\n    plist-&gt;next = list_create(pNode);\n    if (plist-&gt;next == NULL)\n        return NULL;\n    plist-&gt;next-&gt;prev = plist;\n    return list;\n}\n</code></pre>\n"}], "owner": {"reputation": 128, "user_id": 9181468, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xL05UTpdjWw/AAAAAAAAAAI/AAAAAAAAABA/CdGzAPG6x_g/photo.jpg?sz=128", "display_name": "Apo", "link": "https://stackoverflow.com/users/9181468/apo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 58964784, "answer_count": 1, "score": 1, "last_activity_date": 1574291395, "creation_date": 1574290346, "question_id": 58964649, "link": "https://stackoverflow.com/questions/58964649/a-implementation-in-c-segmentation-fault", "title": "A* Implementation in C, Segmentation fault", "body": "<p>For a school project in C, I want to create a pathfinding algorithm, I decided to use A*.\nAfter long reflexion and rewrite of many time all the code I can't find what is wrong. It must be because of the memory management but I can't figure out where it goes wrong. Even after looking for hours on forums I didn't find anything interesting.</p>\n\n<p>The gdb help me a little bit more when he shows me in which function the segfault occurs.</p>\n\n<pre><code>(gdb) bt\n#0  0x0000000008000917 in list_prepend ()\n#1  0x0000000008000b38 in findPath ()\n#2  0x0000000008001473 in main ()\n</code></pre>\n\n<p>I use struct to represent my Nodes and for my lists of pointers to the Nodes.</p>\n\n<pre><code>typedef struct Coord Coord;\nstruct Coord{\n  int x;\n  int y;\n};\n\ntypedef struct Node{\n    bool walkable;\n    bool wayToGo;\n    Coord pos;\n    int gCost;\n    int hCost;\n    int fCost; // fCost = gCost + hCost\n    struct Node *parent;\n} Node;\n\ntypedef struct NodeList{\n    Node * pNode;\n    struct NodeList * next;\n    struct NodeList * previous;\n} NodeList;\n</code></pre>\n\n<p>And the function that raise the SIGSEGV :</p>\n\n<pre><code>NodeList * list_prepend(NodeList *old, Node *pNode)\n{\n\n    NodeList *list = list_create(pNode); \n    if (list){                     \n       list-&gt;next = old;             \n       old-&gt;previous = list;\n    }\n    return list;                    \n}\n</code></pre>\n\n<p>Where :</p>\n\n<pre><code>NodeList * list_create (Node *pNode)\n{\n    NodeList *list = malloc(sizeof(NodeList));\n    if (list)\n    {\n        list-&gt;pNode = pNode;\n        list-&gt;next = NULL;\n        list-&gt;previous = NULL;\n    }\n    return list;\n}\n</code></pre>\n\n<p>I think that the problem comes from <code>old-&gt;previous = list</code> because it looks like <code>old-&gt;previous</code> gives NULL and I try to affect something to NULL. I don't know and that's why I'm asking.</p>\n\n<p>If you have any idea or if you can share a good debugging technique that would be great.</p>\n\n<p>If needed here is the full code I wrote to test the pathfinder :\n<a href=\"https://github.com/ApocalHyps/Pacman/blob/master/pathFinding.c\" rel=\"nofollow noreferrer\">pathFinding.c</a></p>\n"}, {"tags": ["c", "arrays", "pointers", "malloc", "realloc"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1574304282, "post_id": 58964580, "comment_id": 104187813, "body": "regarding: <code>char *arr2=(char*)malloc(sizeof(char)*size);</code>  This has several problems.  Rather than going into details, suggest: <code>char *arr2 = NULL;  char *temp = realloc( arr2, size );</code> followed by: <code>if( ! arr2 ) { perror( &quot;calloc for arr2 failed&quot; );  exit( EXIT_FAILURE ); } else { arr2 = temp;}</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1574304527, "post_id": 58964580, "comment_id": 104187858, "body": "where is the variable <code>l</code> initialized?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1574304629, "post_id": 58964580, "comment_id": 104187880, "body": "what is the expectation of the contents of the line read in via: <code>getline()</code>?  and where is the validation of the contents of that line?"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 12195923, "user_type": "registered", "profile_image": "https://graph.facebook.com/2559791284069612/picture?type=large", "display_name": "Luk&#225;\u0161 Sch&#246;bel", "link": "https://stackoverflow.com/users/12195923/luk%c3%a1%c5%a1-sch%c3%b6bel"}, "edited": false, "score": 0, "creation_date": 1574359965, "post_id": 58966427, "comment_id": 104215255, "body": "Thank you so much for explanation why it wasn&#39;t working, it helped me understand the problem and thanks for given solution! This fixed my program running for big game fields! Thank you thank you very much!"}], "tags": [], "owner": {"reputation": 11893, "user_id": 12098405, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C7IUyuZ5qqE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rehqQyGdh463Xz2DY8S4TYPhnDvzA/photo.jpg?sz=128", "display_name": "dash-o", "link": "https://stackoverflow.com/users/12098405/dash-o"}, "is_accepted": true, "score": 1, "last_activity_date": 1574303811, "creation_date": 1574303811, "answer_id": 58966427, "question_id": 58964580, "link": "https://stackoverflow.com/questions/58964580/munmap-chunk-invalid-pointer-aborted-core-dumped-realloc-invalid-next/58966427#58966427", "title": "Munmap_chunk(): invalid pointer, Aborted (core dumped), realloc(): invalid next size", "body": "<p>Short Answer:</p>\n\n<p>The allocation for <code>arr2</code> is too small for large boards (>200 bytes total), consider resizing it on EVERY iteration to handle unknown size.</p>\n\n<pre><code>  // existing line\n  err=getline(&amp;arr,&amp;bufsize,stdin);\n  if ( err &gt; 0 ) {\n      size += err ;\n      arr2 = realloc(arr2, size) ;\n      // Append arr to arr2.\n  }\n</code></pre>\n\n<p>Or similar.</p>\n\n<p><strong>Long Answer:</strong></p>\n\n<p>There is a compile error - code reference variable 'l' (in arr2[] = arr[j]), without declaring it (or specifying it's value). Assuming this is declared in <code>main</code> (or as static) and initialized to zero.</p>\n\n<p>On every iteration, the code append the content of the input line <code>arr</code> to <code>arr2</code>. Given initial allocation of only 200 bytes to arr2. on large boards (216x10), this will overrun the size of arr2 in iteration 20.</p>\n\n<p>The allocation on iteration 198 (i==size-2) allows the code to work on small problem that where the board total size is &lt; 200 bytes (10x10, ...).</p>\n\n<p><strong>Valgrind:</strong></p>\n\n<p>On my machine (Mint 19), valgrid correctly identified the buffer overrun with 216x10 board:</p>\n\n<pre><code>==61030== Memcheck, a memory error detector\n==61030== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.\n==61030== Using Valgrind-3.13.0 and LibVEX; rerun with -h for copyright info\n==61030== Command: ./a.out\n==61030== \nEnter game field:\n==61030== Invalid write of size 1\n==61030==    at 0x10882A: main (gg.c:25)\n==61030==  Address 0x522d108 is 0 bytes after a block of size 200 alloc'd\n==61030==    at 0x4C2FB0F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==61030==    by 0x10878C: main (gg.c:9)\n==61030== \n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 12195923, "user_type": "registered", "profile_image": "https://graph.facebook.com/2559791284069612/picture?type=large", "display_name": "Luk&#225;\u0161 Sch&#246;bel", "link": "https://stackoverflow.com/users/12195923/luk%c3%a1%c5%a1-sch%c3%b6bel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 466, "favorite_count": 0, "accepted_answer_id": 58966427, "answer_count": 1, "score": 2, "last_activity_date": 1574303811, "creation_date": 1574289964, "last_edit_date": 1574290417, "question_id": 58964580, "link": "https://stackoverflow.com/questions/58964580/munmap-chunk-invalid-pointer-aborted-core-dumped-realloc-invalid-next", "title": "Munmap_chunk(): invalid pointer, Aborted (core dumped), realloc(): invalid next size", "body": "<p>I'm writing code where user enter fields for <strong>Minesweeper</strong>, where <code>'.'</code> is empty field and <code>'*'</code> is bomb. Program will read the size of the field from the input, and <strong><em>print whole game field</em></strong>, where field that is <code>'.'</code> is replaced by the number of bombs around that field, if the field doesn't have any it prints <code>'.'</code>, and if the field is <code>'*'</code>, it prints simply <code>'*'</code> . </p>\n\n<p><strong>We don't know how big the input (game field) will be</strong>. <strong>Input is ended with EOF</strong>. My program is working fine for \"normal\" (small) inputs, for example 10x10 game field, 50x50 game field, 20x4 game field, etc. I get input into arr and then copy each index into arr2, so I can get another input into arr and I don't lose the previous input. <strong>Both arrays are 1D</strong>. In arr2, I change values of indexes from <code>'.'</code> to numbers (i.e. <code>2</code>) if the bomb (<code>' * '</code>) is around it.</p>\n\n<p>Example of input:</p>\n\n<pre><code>.*.\n*.*\n</code></pre>\n\n<p>Example of output:</p>\n\n<pre><code>2*2\n*3*\n</code></pre>\n\n<p>However, when I try to input game field that has i.e. 216 rows and 10 columns (216x10), this is what happens:</p>\n\n<ul>\n<li>If the code is same as you see, the program says: <code>realloc(): invalid next size.\nAborted (core dumped)</code></li>\n<li>If I use &amp;arr2 in realloc, it says the same.</li>\n<li>If I <strong>remove the realloc</strong> line it says: <code>munmap_chunk(): invalid pointer. Aborted (core dumped)</code></li>\n<li>The printed game field with the numbers have \"correctly printed field\" and parts where newline occurs or where whole row is filled with numbers.</li>\n</ul>\n\n<p><strong>Valgrind says no memory leaks or errors with low inputs.</strong></p>\n\n<p>As I'm new to the memory management and pointers, I can't find out where is the problem.\nI'd appreciate if you ask questions and try to help me.</p>\n\n<p>The code I show here should be the problematic part (and is the beginning of the program). The rest of the code should be fine and work based on this part.</p>\n\n<pre><code>\n    int main()\n    {\n      int err, size=200;\n      char *arr=NULL;\n      char *arr2=(char*)malloc(sizeof(char)*size);\n      size_t bufsize=0;\n      printf(\"Enter game field:\\n\");\n      while(true)\n      {\n         for (int i=0;i&lt;size;i++)\n            {\n                err=getline(&amp;arr,&amp;bufsize,stdin);\n                if (i==(size-2))\n                {\n                    size *= 3;\n                    arr2=(char*)realloc(arr2,sizeof(char)*size);\n                }\n                for (int j=0;j&lt;(err-1);j++)\n                {\n                    arr2[l]=arr[j];\n                    l++;\n                }\n                /*rest of the code*/\n            }\n      }\n\n.\n.\n.\n\n</code></pre>\n"}, {"tags": ["c", "function"], "comments": [{"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 3, "creation_date": 1574290223, "post_id": 58964577, "comment_id": 104184225, "body": "getBinary() is returning the address of <i>static</i> first8bits, which is constant over the lifetime of your program. If you want it to return a unique address each time, you should malloc() space each time and return that."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1574290293, "post_id": 58964577, "comment_id": 104184247, "body": "... or declare two arrays in <code>main</code>, and pass an array for <code>getBinary</code> to fill."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1574290382, "post_id": 58964577, "comment_id": 104184275, "body": "Its been a long time since I have seen <code>o</code> as a variable name."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1574292611, "post_id": 58964577, "comment_id": 104185069, "body": "<a href=\"https://stackoverflow.com/questions/11656532/returning-an-array-using-c\" title=\"returning an array using c\">stackoverflow.com/questions/11656532/returning-an-array-usin&zwnj;&#8203;g-c</a>"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1574298911, "post_id": 58964577, "comment_id": 104186543, "body": "What does <code>getBinary();</code> return a pointer to? How many of them are there?"}], "answers": [{"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1574299110, "post_id": 58965773, "comment_id": 104186583, "body": "Nit... Instead of telling the person <code>&quot;Try:&quot;</code>, tell them &quot;You can accomplish what your are trying to do by:&quot;. Why? When telling someone to just &quot;try&quot; something, it sounds if you are unsure if it will work and they should just &quot;try&quot; and find out. You answer is fine, convey you are confident in its correctness."}], "tags": [], "owner": {"reputation": 135, "user_id": 11730888, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wMFXV2mCR1U/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rciOHG5HVcJ2T9eyQHSyUSq37MMmQ/photo.jpg?sz=128", "display_name": "amengelbrecht", "link": "https://stackoverflow.com/users/11730888/amengelbrecht"}, "is_accepted": true, "score": 2, "last_activity_date": 1574298653, "creation_date": 1574298653, "answer_id": 58965773, "question_id": 58964577, "link": "https://stackoverflow.com/questions/58964577/everytime-i-declare-i-function-my-variable-made-by-the-function-changes-c-lang/58965773#58965773", "title": "Everytime I declare I function, my variable made by the function changes. C Language", "body": "<p>Because of the static keyword.</p>\n\n<p>Don't use static. Try:</p>\n\n<pre><code>int* first8bits = malloc(8 * sizeof(int));\n</code></pre>\n\n<p>This way you will allocate new memory each time you call it. You can still access it with the same [ i ] subscript. Remember to free the memory again at the end of main!</p>\n\n<pre><code>free(firstBin);\nfree(secBin);\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10520505, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kzFifBHSzGA/AAAAAAAAAAI/AAAAAAAAB2w/9Shqz24FpVI/photo.jpg?sz=128", "display_name": "Kako Kong", "link": "https://stackoverflow.com/users/10520505/kako-kong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 58965773, "answer_count": 1, "score": 1, "last_activity_date": 1574298653, "creation_date": 1574289959, "question_id": 58964577, "link": "https://stackoverflow.com/questions/58964577/everytime-i-declare-i-function-my-variable-made-by-the-function-changes-c-lang", "title": "Everytime I declare I function, my variable made by the function changes. C Language", "body": "<p>so I am working on my Binary adding program, but now I am stuck. I want to declare 2 variables for the first binary and second one, so I use the getBinary function I created to declare these 2. However, after I entered value for firstBin, I got the value I want, but after I entered the value for secBin, the value of firstBin somehow changes and become the same as secondBin. I was hoping for the variable to be unchangable. Thanks for the help</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint * getBinary(){\n        int i;\n        int j;\n        static int first8bits[8];\n        for (i = 0; i != 8; i++){\n            printf(\"Input 8-bits Binary:\");\n            scanf(\"%d\",&amp;first8bits[i]);\n        }\n        for (j = 0; j != 8; j++)\n            printf(\"%d\",first8bits[j]);\n        printf(\"\\n\");\n        return first8bits;\n        }\n\nint main(){\n    int o;\n    printf(\"Input the first Set of Binary...\");\n    const int * firstBin = getBinary();\n\n    printf(\"Input the second Set of Binary...\");\n    int * secBin = getBinary();\n\n    for (o = 0; o != 8; o++)\n            printf(\"%d\",firstBin[o]);\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 240, "user_id": 2832768, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uwee8.png?s=128&g=1", "display_name": "guilleamodeo", "link": "https://stackoverflow.com/users/2832768/guilleamodeo"}, "edited": false, "score": 0, "creation_date": 1574297131, "post_id": 58964514, "comment_id": 104186136, "body": "I have not had the time to analyse the whole thing but a quick look raised a couple of oddities. I think you are having a inverse priority problem adn the producer finishes before all the consumers start. So you should start the consumers before you start the producer and have a small delay so the consumers start. Also, the retval parameter of pthread_join() is the parameter given to pthread_exit(), which is the right way to exit a thread instead relying on the return terminate it."}, {"owner": {"reputation": 11893, "user_id": 12098405, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C7IUyuZ5qqE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rehqQyGdh463Xz2DY8S4TYPhnDvzA/photo.jpg?sz=128", "display_name": "dash-o", "link": "https://stackoverflow.com/users/12098405/dash-o"}, "edited": false, "score": 0, "creation_date": 1574304269, "post_id": 58964514, "comment_id": 104187809, "body": "Consider adding some delay to the consumer to make them do some &#39;work&#39;. It will allow you to test the code with &#39;stress&#39;"}], "owner": {"reputation": 1, "user_id": 12406932, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDpAKX--OEdngKFovjE6xAfMFG_bgaOEwwDJIn7=k-s128", "display_name": "Jose Chung Sze Yu", "link": "https://stackoverflow.com/users/12406932/jose-chung-sze-yu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 16, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574289608, "creation_date": 1574289608, "question_id": 58964514, "link": "https://stackoverflow.com/questions/58964514/only-one-worker-working-in-multithread-producer-consumer-problem", "title": "Only one worker working in Multithread producer consumer problem", "body": "<p>I am working on a consumer producer problem using only condition variables.\nthere should be 1 producer, 3 consumers, buffer size of 2 and 5 tasks for consumers to be done.\nHowever, the result seems to have only 1 consumer working\nAlso, the other consumers cannot enter the pthread_join.....\nI have been stuck here for days and I need your help!!! thanks!</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;stdlib.h&gt;\n\n\npthread_mutex_t mutex = PTHREAD_MUTEX_INITIALIZER;\npthread_cond_t empty = PTHREAD_COND_INITIALIZER, fill= PTHREAD_COND_INITIALIZER;\n\nint buffer_size;\nint *buffer;\nint fill_ptr = 0;                                   //the place next producer should put place task\nint use_ptr = 0;\nint count = 0;                                      //number of task on the buffer\nint work_done=0;\nint consumers=0;\nint loops =0;\n\ntypedef struct {\n    int a;\n}con_id;\n\nvoid put(int value){\n    buffer[fill_ptr]=value;\n    fill_ptr = (fill_ptr+1)%buffer_size;                    //update fill pointer\n    count ++;\n}\n\nint get(){\n    int tmp = buffer[use_ptr];\n    use_ptr = (use_ptr + 1)%buffer_size;\n    count --;\n    work_done++;\n    return tmp;\n}\n\n\nvoid *producer(void *args){                 //producer\n\n    for(int i = 0; i&lt;loops ;i++){                       //loops???\n        pthread_mutex_lock(&amp;mutex);\n        while(count == buffer_size)                         //if the buffer is full\n            pthread_cond_wait(&amp;empty, &amp;mutex);      //wait until empty signal is broadcasted\n        printf(\"I am producer: I now put task\\n\");\n        put(i);\n        printf(\"buffer[]: [\");\n        for(int j=0;j&lt;buffer_size;j++){\n            printf(\" %d ,\", buffer[j]);\n        }\n        printf(\"]\\n\");                                      //else rest code: place task\n        pthread_cond_broadcast(&amp;fill);                  //broadcast fill signal??????????\n        pthread_mutex_unlock(&amp;mutex);\n    }\n    printf(\"I am producer: I quit now\\n\");\n}\n\nvoid *consumer(void *arg){\n    con_id *consumer_id = malloc(sizeof(con_id));\n    consumer_id-&gt;a = *((int *)arg);\n    for (int i=0; i&lt;loops;i++){\n        pthread_mutex_lock(&amp;mutex);\n        while(count ==0){                           //if the buffer is empty\n            pthread_cond_wait(&amp;fill, &amp;mutex);\n        }                       \n        //printf(\"I am consumer:%d, I now get task\\n\", i);//else rest code:get task \n        int tmp = get();                            //tmp?\n        pthread_cond_broadcast(&amp;empty);             //broadcast empty signal????????\n        printf(\"buffer[use_ptr]: %d\\n\", tmp);       \n        int tmp2= *((int *)arg);            //tmp?\n        printf(\"I am consumer:%d, I have done a task\\n\", tmp2);\n        pthread_mutex_unlock(&amp;mutex);               \n    }\n\n    return (void*) consumer_id;\n}\n\n\nint main(int argc, char * argv[]){\n\n    buffer_size = 2;\n    loops = 5;\n    consumers = 3;\n\n\n\n    buffer = malloc(sizeof(int)*buffer_size);           //allocate space for the buffer\n\n    pthread_t prods, cons[consumers];                   //declare producer and consumers threads\n\n    pthread_create(&amp;prods, NULL, producer, NULL);       //create producers thread\n\n    for (int i = 0; i &lt; consumers; i++){\n        int *arg = malloc(sizeof(*arg));\n        *arg = i;\n        pthread_create(&amp;cons[i], NULL,consumer, arg);   // create consumer threads\n\n    }\n\n    pthread_join(prods, NULL);                          //wait for all threads to finish\n    printf(\"producer ended\\n\");\n    for (int i = 0; i &lt; consumers+1; i++){\n        printf(\" waiting for consumers to end\\n\");\n        con_id *consumer_id;\n        pthread_join(cons[i], (void**) &amp;consumer_id);\n        printf(\"joined %d\\n\", consumer_id-&gt;a);\n    }\n\n\n\n    printf(\"everything fucking done!\");\n    return 0;\n}\n</code></pre>\n\n<p>RESULTS:</p>\n\n<pre><code>I am producer: I now put task\nbuffer[]: [ 0 , 0 ,]\nI am producer: I now put task\nbuffer[]: [ 0 , 1 ,]\nbuffer[use_ptr]: 0\nI am consumer:2, I have done a task\nbuffer[use_ptr]: 1\nI am consumer:2, I have done a task\nI am producer: I now put task\nbuffer[]: [ 2 , 1 ,]\nI am producer: I now put task\nbuffer[]: [ 2 , 3 ,]\nbuffer[use_ptr]: 2\nI am consumer:2, I have done a task\nbuffer[use_ptr]: 3\nI am consumer:2, I have done a task\nI am producer: I now put task\nbuffer[]: [ 4 , 3 ,]\nI am producer: I quit now\nproducer ended\n waiting for consumers to end\nbuffer[use_ptr]: 4\nI am consumer:2, I have done a task\n</code></pre>\n\n<p>the program cannot end, and I have to use Ctrl-C to kill it </p>\n"}, {"tags": ["c", "arm", "embedded", "malloc"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1574286829, "post_id": 58963916, "comment_id": 104183000, "body": "Can you clarify how you are allocating the array? It makes a difference whether the array is allocated with <code>malloc</code> (which seems not to be the case), allocated as static memory or allocated as stack memory. A simple code example may help."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 1, "creation_date": 1574287026, "post_id": 58963916, "comment_id": 104183079, "body": "It&#39;s generally bad form to use dynamic allocation in a small embedded system. Figure out how much memory you have in the device, allocate it all to a big static array, and take what you need out of that (perhaps with something like a simple mark-release allocator)."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1574287035, "post_id": 58963916, "comment_id": 104183083, "body": "&quot;embedded&quot; and &quot;malloc&quot; is always a bad combination. <i>&quot;The obvious solution [...]: allocate all of the memory for the data upfront.&quot;</i> Yes, obvious and sensible, especially when you&#39;ve got 20KB of memory."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1574287050, "post_id": 58963916, "comment_id": 104183090, "body": "If you define the array as global one, then the linker will scream at you that your BSS section is overlapping with something else. Assuming a proper linker script of course... If it is local (on stack) then... well it&#39;s a bad idea."}, {"owner": {"reputation": 185, "user_id": 4954339, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nr8LXhdXlZg/AAAAAAAAAAI/AAAAAAAAAJ8/Pof6YMrf6NM/photo.jpg?sz=128", "display_name": "Matt Walck", "link": "https://stackoverflow.com/users/4954339/matt-walck"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1574287407, "post_id": 58963916, "comment_id": 104183222, "body": "@kaylum Good point, I&#39;ve added some examples."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1574287563, "post_id": 58963916, "comment_id": 104183286, "body": "The examples you have added are categorized as &quot;bad idea&quot; in my previous comment."}, {"owner": {"reputation": 185, "user_id": 4954339, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nr8LXhdXlZg/AAAAAAAAAAI/AAAAAAAAAJ8/Pof6YMrf6NM/photo.jpg?sz=128", "display_name": "Matt Walck", "link": "https://stackoverflow.com/users/4954339/matt-walck"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1574287628, "post_id": 58963916, "comment_id": 104183313, "body": "@EugeneSh. Agreed. My question is less &quot;best practices&quot; and more &quot;can you tell&quot; and &quot;if you can&#39;t, what happens&quot;."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1574287678, "post_id": 58963916, "comment_id": 104183338, "body": "As I said, the most practical way is to define a static (global) array and let linker worry about the space. Your examples are overflowing the stack, which is mostly not detectable (until it is too late)."}, {"owner": {"reputation": 185, "user_id": 4954339, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nr8LXhdXlZg/AAAAAAAAAAI/AAAAAAAAAJ8/Pof6YMrf6NM/photo.jpg?sz=128", "display_name": "Matt Walck", "link": "https://stackoverflow.com/users/4954339/matt-walck"}, "edited": false, "score": 0, "creation_date": 1574287799, "post_id": 58963916, "comment_id": 104183386, "body": "Well. that&#39;s a pretty embarrassing oversight on my part, given the name of the site I&#39;m on. Of course, it would be a stack overflow."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 2, "creation_date": 1574287865, "post_id": 58963916, "comment_id": 104183417, "body": "This path is fraught with danger in my opinion. There are different ways to check the remaining stack size but they are either platform dependent or quite fragile. I personally wouldn&#39;t go there. But for example: <a href=\"https://stackoverflow.com/questions/427209/is-it-possible-to-predict-a-stack-overflow-in-c-on-linux\">Is it possible to predict a stack overflow in C on Linux?</a>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1574288838, "post_id": 58963916, "comment_id": 104183748, "body": "&quot;device with 20KB of RAM&quot; --&gt; I feel a <a href=\"https://www.4allmemory.com/faq/details.cfm?faq_id=236\" rel=\"nofollow noreferrer\">DOS &quot;Out of Memory&quot;</a>  memory coming back.  Ahhh, those were the days - when you could see the bytes and tastes the bits. Hmmmm.  Or why would any program ever need more than 64k of my <a href=\"https://en.wikipedia.org/wiki/Commodore_64\" rel=\"nofollow noreferrer\">C64</a> or <a href=\"https://en.wikipedia.org/wiki/Commodore_VIC-20\" rel=\"nofollow noreferrer\">Vic-20</a>?"}, {"owner": {"reputation": 185, "user_id": 4954339, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nr8LXhdXlZg/AAAAAAAAAAI/AAAAAAAAAJ8/Pof6YMrf6NM/photo.jpg?sz=128", "display_name": "Matt Walck", "link": "https://stackoverflow.com/users/4954339/matt-walck"}, "reply_to_user": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1574289823, "post_id": 58963916, "comment_id": 104184085, "body": "@ikegami, I updated the question: I&#39;m running on the bare metal: no RTOS."}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1574325775, "post_id": 58964646, "comment_id": 104194974, "body": "Function pointers and interrupts are pretty much standard in all embedded systems, so the mentioned toolchain features for calculating stack usage aren&#39;t very useful or reliable."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1574325942, "post_id": 58964646, "comment_id": 104195070, "body": "And using <code>union</code> for the sake of saving memory is plain bad advise - that very practice is banned by MISRA-C for example. There&#39;s lots of better ways to optimize for memory consumption, most notably micro-managing the size of integer variables."}, {"owner": {"reputation": 91978, "user_id": 387076, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/cFyP6.jpg?s=128&g=1", "display_name": "Gilles &#39;SO- stop being evil&#39;", "link": "https://stackoverflow.com/users/387076/gilles-so-stop-being-evil"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1574330797, "post_id": 58964646, "comment_id": 104198139, "body": "@Lundin Function pointers for anything other than interrupt handlers? I&#39;ve worked on systems that made effective use of build-time stack usage analysis, and forbade the use of recursion and function pointers (except if needed to register an exception handler at boot time) primarily so that this analysis would work. You just need to take all entry points into account."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1574331445, "post_id": 58964646, "comment_id": 104198558, "body": "In addition to interrupts/vector table, they are also used for callbacks, state machines, bootloaders and so on. Yeah they potentially do screw up static analysis of stack use, but so do interrupts."}, {"owner": {"reputation": 91978, "user_id": 387076, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/cFyP6.jpg?s=128&g=1", "display_name": "Gilles &#39;SO- stop being evil&#39;", "link": "https://stackoverflow.com/users/387076/gilles-so-stop-being-evil"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1574333442, "post_id": 58964646, "comment_id": 104199785, "body": "@Lundin Many embedded projects forbid these. Callbacks? You don&#39;t need those for a system with a single binary image where everything is plugged together at compile time. State machines? Dispatch in a switch, not with tables."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1574336274, "post_id": 58964646, "comment_id": 104201416, "body": "That&#39;s completely irrational though, read-only function pointer tables are <i>safer</i> than switch statements - far less chance for spaghetti-jump related bugs. For example MISRA-C has a <i>whole chapter</i> dedicated to the dangers of switch statements, 7 rules. But it only has 1 rule about function pointers - that they shouldn&#39;t be converted to object pointers. The only advantage with switch is that the internal function-pointer jump table generated by the compiler upon optimizing a switch can be inlined by the compiler - you typically can&#39;t do that with regular function pointers."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1574336287, "post_id": 58964646, "comment_id": 104201425, "body": "As for callbacks, it is extremely common to take a general-purpose timer or the RTC, then register a list of callbacks for it to execute upon periodic interrupts. Otherwise you&#39;d have to allocate multiple hardware timers even when for tasks that don&#39;t have tough real time requirements."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1574336571, "post_id": 58964646, "comment_id": 104201586, "body": "Further arguments here: <a href=\"https://stackoverflow.com/questions/34939379/state-machine-with-no-function-pointer/34950753#34950753\" title=\"state machine with no function pointer\">stackoverflow.com/questions/34939379/&hellip;</a>"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1574424904, "post_id": 58964646, "comment_id": 104238492, "body": "&quot;attempting to allocate a local or global variable that doesn&#39;t fit in memory has undefined behavior,&quot; - citation needed"}, {"owner": {"reputation": 91978, "user_id": 387076, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/cFyP6.jpg?s=128&g=1", "display_name": "Gilles &#39;SO- stop being evil&#39;", "link": "https://stackoverflow.com/users/387076/gilles-so-stop-being-evil"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1574428976, "post_id": 58964646, "comment_id": 104240674, "body": "@M.M Hmmm, I thought that this would hit an implementation limit, but after checking I can&#39;t find such a limit. That would be a pretty bad omission in the standard though. Is the program <code>#include &lt;stdint.h&gt; int main(void) { static char a[SIZE_MAX]; char b[SIZE_MAX]; return 0; }</code> really strictly conforming? (P.S. asking for a citation for a reasonable-looking informal statement comes off as rather passive-aggressive. If you&#39;ve concluded that the behavior is in fact defined, which would be weird since pretty much every implementation rejects it, please share your wisdom instead of hoarding it.)"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1574458765, "post_id": 58964646, "comment_id": 104254495, "body": "Technically any implementation that allows a stack overflow is non-conforming,  it&#39;s one of those cases where we pretend the standard says something that it doesn&#39;t for practical reasons"}], "tags": [], "owner": {"reputation": 91978, "user_id": 387076, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/cFyP6.jpg?s=128&g=1", "display_name": "Gilles &#39;SO- stop being evil&#39;", "link": "https://stackoverflow.com/users/387076/gilles-so-stop-being-evil"}, "is_accepted": false, "score": 3, "last_activity_date": 1574290336, "creation_date": 1574290336, "answer_id": 58964646, "question_id": 58963916, "link": "https://stackoverflow.com/questions/58963916/detect-declaration-of-array-larger-than-free-memory/58964646#58964646", "title": "Detect declaration of array larger than free memory", "body": "<p>As far as the C language is concerned, attempting to allocate a local or global variable that doesn't fit in memory has undefined behavior, which means that anything can happen.</p>\n\n<p>In practice, depending on your toolchain, your MMU/MPU setup if any, and on the exact memory layout, the consequence may either be that writing outside the memory area reserved for the stack overwrite whatever that location in memory contains, leading to \u201cfun\u201d results, or some kind of memory-related fault. You definitely do not want to overwrite other memory, and memory faults are hard to recover from, so you should make sure that this won't happen.</p>\n\n<p>Major embedded toolchains have a way to compute the maximum stack usage of a program. More precisely, they compute a worst-case approximation which tends to be good enough for the kind of programs you'd typically run on a small embedded system. This only works if the program doesn't use dynamic features such as function pointers, recursion, variable length arrays and <code>alloca</code>, so don't do that.</p>\n\n<p>For example, with GCC, the compiler can tell you the stack usage of each function, and combined with the control flow graph you can determine an upper bound for the stack usage of the program. See <a href=\"https://stackoverflow.com/questions/6387614/how-to-determine-maximum-stack-usage-in-embedded-system-with-gcc\">How to determine maximum stack usage in embedded system with gcc?</a></p>\n\n<p>See also <a href=\"https://stackoverflow.com/questions/1756285/stack-size-estimation\">Stack Size Estimation</a> which mentions some tools that work separately from the compiler.</p>\n\n<p>Remember to take interrupt routines into account in addition to <code>main</code>, if applicable.</p>\n\n<p>If you make the variable permanent (static storage duration), i.e. if it's a global variable or a local variable with the <code>static</code> qualifier, your linker should tell you if you run out of BSS. It's more straightforward, but you lose the ability to use that memory for a different purpose during part of the program (e.g. during boot). You can regain some of this ability by making the global variable a <code>union</code>, but it's dangerous because the compiler won't protect you against using the wrong member of the union at the wrong time.</p>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1574325607, "post_id": 58964927, "comment_id": 104194893, "body": "Compiler options and call graphs aren&#39;t very useful, because these kind of systems have lots of interrupts, making it impossible to determine stack usage statically. It must be examined in run-time."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1574383145, "post_id": 58964927, "comment_id": 104223991, "body": "@Lundin Interrupts should not use any significant amount of stack (to be portable they should do nothing besides setting an atomic flag)"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1574407472, "post_id": 58964927, "comment_id": 104230040, "body": "It&#39;s not the amount that matters, it is the increased stack peak usage on top of what you already thought was the maximum use. Stack overflow because the programmer failed to consider the worst-case interrupt scenario is a well-known problem in embedded systems."}], "tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": false, "score": 1, "last_activity_date": 1574292249, "creation_date": 1574292249, "answer_id": 58964927, "question_id": 58963916, "link": "https://stackoverflow.com/questions/58963916/detect-declaration-of-array-larger-than-free-memory/58964927#58964927", "title": "Detect declaration of array larger than free memory", "body": "<p>gcc offers the flag <code>-fstack-usage</code> and <code>-Wstack-usage</code> which will output stack usage for each function and warn about excessive , this can be a starting point in looking for functions which risk a stack overflow. But won't help you with function call depths that overflow the stack in many small chunks.</p>\n\n<p>One possible approach is to work out the address of the end of the stack on your hardware so you can have a debug macro that will tell you how much stack is remaining.  Of course you can't close the gate after the horse has bolted -- if you have a function that needs to use a lot of stack then you'll need to do the stack check before calling that function;  not at the start of the function (typically the stack is consumed on function entry, not on execution reaching the declaration of the large buffer).</p>\n\n<p>Ideally you'd design your code in such a way that all possible code paths are known and you can get your head around it. clang has the ability to generate a call graph showing all functions that call each other -- if your code is a mess then this looks like the cat got into the wool basket,  but if not then you can associate stack usage with each function and work out the theoretical maximum possible stack usage for any code path.</p>\n\n<p>There are probably commercial tools that do all this stuff automatically although IDK what they are.</p>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 1, "last_activity_date": 1574325698, "creation_date": 1574325698, "answer_id": 58970560, "question_id": 58963916, "link": "https://stackoverflow.com/questions/58963916/detect-declaration-of-array-larger-than-free-memory/58970560#58970560", "title": "Detect declaration of array larger than free memory", "body": "<p>The question is a bit confused because you should never allocate that large arrays on the stack, particularly not in an embedded system. In case you declare a local array with size 30kb on a 20kib system, you will simply kill the stack with a stack overflow in run-time. </p>\n\n<p>You can only protect yourself from stack overflow with programmer knowledge and code review, though a few tool chains provide means to measure stack usage and some MCUs will give meaningful errors such as software interrupt/exception upon stack overflow. There's also a manual way to test stack use from a debugger, by filling the whole stack with some nonsense value like 0xAA, then execute the program with maximum code coverage, then analyse the memory map to see how far down in the stack you can still find 0xAA.</p>\n\n<blockquote>\n  <p>But if declaring arrays dynamically, how could one tell if the system was out of memory</p>\n</blockquote>\n\n<p>By checking the result of <code>malloc</code>. But this is a non-issue in your case, since you should never use dynamic memory on a 20kib bare metal system. <a href=\"https://electronics.stackexchange.com/a/171581/6102\">Because it doesn't make any sense to do so</a>.</p>\n\n<p>What you <em>should</em> do is to declare that array with static storage duration, by making it <code>static</code> and/or by moving it to file scope. In that case, you will get linker errors if you use too much memory. The linker will whine \"out of memory in section <code>.bss</code>\" or similar.</p>\n"}], "owner": {"reputation": 185, "user_id": 4954339, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nr8LXhdXlZg/AAAAAAAAAAI/AAAAAAAAAJ8/Pof6YMrf6NM/photo.jpg?sz=128", "display_name": "Matt Walck", "link": "https://stackoverflow.com/users/4954339/matt-walck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1574325698, "creation_date": 1574286528, "last_edit_date": 1574289734, "question_id": 58963916, "link": "https://stackoverflow.com/questions/58963916/detect-declaration-of-array-larger-than-free-memory", "title": "Detect declaration of array larger than free memory", "body": "<p>Is there a way to detect when an array (or any variable) will be larger than the amount of free memory in the system? Secondarily, if such an variable was declared, what would happen? </p>\n\n<p>Some background: I'm on an embedded ARM device with 20KB of RAM; it is not running an RTOS. I'm trying to read sensor data out into arrays, but there's a significant amount of sensor data that can be read. If I was allocating the memory with malloc, I could check that the return != NULL to see if enough space on the heap was available (though <a href=\"https://stackoverflow.com/questions/22422733/malloc-behaviour-on-an-embedded-system\">this question</a> seems to indicate that might be optimistic). However, I'm not sure what happens when an array that is larger than the available memory is declared.</p>\n\n<p>The obvious solution is to do what the linked question's accepted answer states: allocate all of the memory for the data upfront. But if declaring arrays dynamically, how could one tell if the system was out of memory, and what would happen if one didn't?</p>\n\n<p>edit: Some examples, to illustrate what I'm referring to. \nWhat would happen if one defined an array like so:</p>\n\n<pre><code>void breaking_things(){\n    uin8_t contrived_example[30000] = {0};\n}\n</code></pre>\n\n<p>This isn't possible on my system where I only have 20KB of free space, but what will happen.</p>\n\n<p>As another example:</p>\n\n<pre><code>void breaking_things(){\n   uin8_t contrived_example0[7000] = {0};\n   uin8_t contrived_example1[7000] = {0};\n   uin8_t contrived_example2[7000] = {0};\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 4046, "user_id": 4971422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4abf51a937ddda51cc6813445605c50?s=128&d=identicon&r=PG&f=1", "display_name": "FredK", "link": "https://stackoverflow.com/users/4971422/fredk"}, "edited": false, "score": 1, "creation_date": 1574286514, "post_id": 58963838, "comment_id": 104182849, "body": "<code>rejected</code> is declared as an array of 2 elements, and you read 3 into it, causing UB."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user12387817"}, "edited": false, "score": 0, "creation_date": 1574287047, "post_id": 58963957, "comment_id": 104183086, "body": "Thank you very much, the error has stopped. However, I noticed you said that input should be %d rather than %c, which I do not understand. For input, I am entering in a character to be read (like &#39;c&#39; or &#39;p&#39;). Isn&#39;t %d just for digits?"}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 0, "last_activity_date": 1574287136, "last_edit_date": 1574287136, "creation_date": 1574286738, "answer_id": 58963957, "question_id": 58963838, "link": "https://stackoverflow.com/questions/58963838/getting-an-error-stating-run-time-check-failure-2-stack-around-the-variable/58963957#58963957", "title": "Getting an error stating &quot;Run-time check failure #2 - stack around the variable &#39;rejected&#39; was corrupted. (Visual Studio)", "body": "<p>You're using <code>scanf</code> in three places with the <code>%s</code> format specifier, which is used to read a string, and in each of those places it is the incorrect one.  Using the wrong format specifier invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a> which can cause a crash.</p>\n\n<p>First:</p>\n\n<pre><code>scanf(\"%s\", &amp;rejected[x]);\n</code></pre>\n\n<p>Here you're really want to read a single character, so you need the <code>%c</code> format specifier.  This one accepts <em>any</em> character, including spaces and newlines, so you'll want to precede it with a space to consume any leftover newlines from the prior read:</p>\n\n<pre><code>scanf(\" %c\", &amp;rejected[x]);\n</code></pre>\n\n<p>Second:</p>\n\n<pre><code>scanf(\"%s\", &amp;input);\n</code></pre>\n\n<p><code>input</code> is an <code>char</code>, so you again want <code>%c</code> here:</p>\n\n<pre><code>scanf(\" %c\", &amp;input);\n</code></pre>\n\n<p>Third:</p>\n\n<pre><code>scanf(\"%s\", &amp;exitProgram);\n</code></pre>\n\n<p>You're reading a character here, so use <code>%c</code> with a leading space as before:</p>\n\n<pre><code>scanf(\" %c\", &amp;exitProgram);\n</code></pre>\n\n<p>You also have a problem here:</p>\n\n<pre><code>char rejected[2] = { 0 };\n...\nfor (int x = 0; x &lt;= 2; x++) {\n     scanf(\"%s\", &amp;rejected[x]);\n}\n</code></pre>\n\n<p>The array <code>rejected</code> only contains 2 elements but you try to read in 3.  This also invokes undefined behavior by writing past the end of the array.  Change the size of the array to 3.</p>\n\n<pre><code>char rejected[3] = { 0 };\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user12387817"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 0, "accepted_answer_id": 58963957, "answer_count": 1, "score": 1, "last_activity_date": 1574287136, "creation_date": 1574286217, "question_id": 58963838, "link": "https://stackoverflow.com/questions/58963838/getting-an-error-stating-run-time-check-failure-2-stack-around-the-variable", "title": "Getting an error stating &quot;Run-time check failure #2 - stack around the variable &#39;rejected&#39; was corrupted. (Visual Studio)", "body": "<p>All of my code works great until I press the key to exit my program, which happens when I press'-'. I then get that error and I am not sure how to resolve it. Here is my code:</p>\n\n<pre><code>#define _CRT_SECURE_NO_WARNINGS\n#include &lt;stdio.h&gt;\n#include &lt;ctype.h&gt;\n\nint main() {\n\nchar rejected[2] = { 0 };\nchar input = 0;\nchar exitProgram = 0;\n\nprintf(\"Please enter three letters you want filtered\\n\");\nfor (int x = 0; x &lt;= 2; x++) {\n     scanf(\"%s\", &amp;rejected[x]);\n}\nprintf(\"Please enter a letter and I will tell you if it is filtered or not\\n\");\nfor (int y = 0; y &lt;= 99; y++) {\n    scanf(\"%s\", &amp;input);\n    if (input == rejected[0] || input == rejected[1] || input == rejected[2]) {\n        printf(\"Filtered letter!\\n\");\n    }\n    else {\n        printf(\"Okay letter!\\n\");\n    }\n    if (y %5 == 0) {\n        printf(\"If you would like to exit this program, please enter '-'. If not, please enter '+'\\n\");\n        scanf(\"%s\", &amp;exitProgram);\n        if (exitProgram == '+') {\n            printf(\"Okay, continue having fun with my program!\\n\");\n        }\n        else if (exitProgram == '-') {\n            printf(\"Thank you for playing with my program!\\n\");\n            break;\n        }\n    }\n}\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c", "ncurses"], "comments": [{"owner": {"reputation": 1706, "user_id": 2906189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f346585e5c2b436ad98d6317256bc38?s=128&d=identicon&r=PG", "display_name": "William McBrine", "link": "https://stackoverflow.com/users/2906189/william-mcbrine"}, "edited": false, "score": 1, "creation_date": 1574408317, "post_id": 58963808, "comment_id": 104230385, "body": "In addition to the answer below, you&#39;re resetting the output to the same position for every word (thus overwriting the last word each time), except that every 15th word, you increment both the row and the column by a single position. This can&#39;t be what you intended."}], "answers": [{"tags": [], "owner": {"reputation": 85, "user_id": 12299863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IJqQA.jpg?s=128&g=1", "display_name": "Sinking", "link": "https://stackoverflow.com/users/12299863/sinking"}, "is_accepted": false, "score": 0, "last_activity_date": 1574288086, "last_edit_date": 1574288086, "creation_date": 1574287777, "answer_id": 58964145, "question_id": 58963808, "link": "https://stackoverflow.com/questions/58963808/how-to-use-mvprintw-with-array-of-pointers-to-strings/58964145#58964145", "title": "How to use mvprintw with array of pointers to strings", "body": "<p>I think you just forgot to include needed library</p>\n\n<pre><code>#include &lt;curses.h&gt;\n</code></pre>\n\n<p>usually, when you have an \"implicit declaration of function\" warning it means that you probably forgot to include some libraries.</p>\n\n<p>read some documentation about <a href=\"https://pubs.opengroup.org/onlinepubs/007908799/xcurses/mvprintw.html\" rel=\"nofollow noreferrer\">mvprintw()</a>, <a href=\"https://pubs.opengroup.org/onlinepubs/7908799/xcurses/endwin.html\" rel=\"nofollow noreferrer\">endwin()</a></p>\n\n<p>excuse me if I'm wrong, it's my first try to help here :)</p>\n"}], "owner": {"reputation": 74, "user_id": 12353853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bm6Z7.png?s=128&g=1", "display_name": "Derrick Wright", "link": "https://stackoverflow.com/users/12353853/derrick-wright"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574288086, "creation_date": 1574286033, "question_id": 58963808, "link": "https://stackoverflow.com/questions/58963808/how-to-use-mvprintw-with-array-of-pointers-to-strings", "title": "How to use mvprintw with array of pointers to strings", "body": "<p>Im trying to use mvprintw to print out words from an array. However no matter what I try mvprintw seems to be non functional. </p>\n\n<pre><code>\n\n#include &lt;ctype.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n\n#define MAX_WORD_LENGTH 12 /* The maximum length a word can be. */\n#define MAX_WORDS 75 /* The maximum words that can be in the DS4Talker. */\n\n\nvoid trim_whitespace(char *string);\n\nint read_words(char *word_list[MAX_WORDS], char *file_name);\n\n\n// Compile with gcc lab09.c -o lab09 -lncurses\n// Run with ./ds4rd.exe -d 054c:05c4 -D DS4_BT -t -b -bt -bd | ./lab09 word_list.txt\n\n\n/*----------------------------------------------------------------------------\n-                               Implementation                               -\n-----------------------------------------------------------------------------*/\nint main(int argc, char *argv[])\n{\n    char *word_list[MAX_WORDS];\n    int word_count = read_words(word_list, argv[1]);\n    int i = 0; int row = 1; int col = 1;\n    initscr();\n\n\n    for(int c = 0; c &lt; word_count; c++){\n        mvprintw(col, row, \"%15s\\n\", word_list[c]);\n        if(c % 15 == 0) {\n            row++;\n            col++;\n        }\n        printf(\"This is doing nothing :D\\n\");\n    }\n\n    //fclose(fptr); \n    refresh();\n    endwin();\n\n\n    return 0;\n}\n\n\n * @param string - The string to ensure has no whitespace.\n */\nvoid trim_whitespace(char *string)\n{\n    int length = strlen(string);\n    if (length == 0) return;\n\n    int i = length - 1;\n    while (isspace(string[i]) &amp;&amp; i &gt;= 0)\n    {\n        string[i] = '\\0';\n        i--;\n    }\n}\n\n\n * @param word_list - The list of words where the words taken from the given\n *                    file will be placed.\n * @param file_name - The name of the file to read from.\n * @return - The number of words read from the file.\n */\nint read_words(char *word_list[MAX_WORDS], char *file_name)\n{\n    int number_of_words_read = 0;\n    char line[MAX_WORD_LENGTH];\n    char *pointer;\n    FILE *file = fopen(file_name, \"r\");\n\n    while (!feof(file))\n    {\n        pointer = fgets(line, MAX_WORD_LENGTH, file);\n        if (pointer != NULL)\n        {\n            trim_whitespace(line);\n            word_list[number_of_words_read] = (char *) malloc(strlen(line) + 1);\n            strcpy(word_list[number_of_words_read], line);\n            number_of_words_read++;\n        }\n    }\n\n    fclose(file);\n    return number_of_words_read;\n}\n\n</code></pre>\n\n<p>Im going to include a screenshot of my cygwin terminal telling me that mvprintw has been implicitly declared. Not sure how to fix this, but perhaps its part of the issue. \nIf this screenshot is in bad taste, tell me, please do not downvote. </p>\n\n<p><a href=\"https://i.stack.imgur.com/ybcEk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ybcEk.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "arrays", "algorithm", "memory", "memory-management"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 3, "creation_date": 1574284453, "post_id": 58963435, "comment_id": 104182021, "body": "Everything is stored in binary. It&#39;s how you are interpreting the values. You are using <code>%d</code> which is signed. Try <code>%p</code> instead."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1574284734, "post_id": 58963435, "comment_id": 104182147, "body": "The addresses on the Mac are very high, and when they&#39;re interpreted as signed numbers they wrap around to negative numbers."}, {"owner": {"reputation": 41, "user_id": 8244729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eaa5c9b83f59830e271d85ef16cdba97?s=128&d=identicon&r=PG&f=1", "display_name": "Olcay E.", "link": "https://stackoverflow.com/users/8244729/olcay-e"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1574285217, "post_id": 58963435, "comment_id": 104182331, "body": "@Barmar Thanks. This is the answer which im looking for."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 8244729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eaa5c9b83f59830e271d85ef16cdba97?s=128&d=identicon&r=PG&f=1", "display_name": "Olcay E.", "link": "https://stackoverflow.com/users/8244729/olcay-e"}, "edited": false, "score": 0, "creation_date": 1574285021, "post_id": 58963514, "comment_id": 104182257, "body": "In fact, i have executed these codes on the same ide. (clion). yep i know, i should be using %p but in the book, it was using %d format specifier. I was just wondering the reason of difference on the results."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 2, "last_activity_date": 1574285860, "last_edit_date": 1574285860, "creation_date": 1574284617, "answer_id": 58963514, "question_id": 58963435, "link": "https://stackoverflow.com/questions/58963435/internal-array-element-location-algorithm/58963514#58963514", "title": "Internal Array Element Location Algorithm", "body": "<p>The internal memory layout of a program is specific to each implementation.  Addresses of variables are rarely the same in programs generated by two different compilers.  In fact, they can even differ on multiple runs of the same program.</p>\n\n<p>Also, when printing pointers, you should be using the <code>%p</code> format specifier.  You should also cast any pointer you print using <code>%p</code> to <code>void *</code> which is the expected type for this format specifier.  That's part of the reason why you see negative values for the addresses.  When you switch to <code>%p</code>, you'll most likely see non-negative values.</p>\n"}], "owner": {"reputation": 41, "user_id": 8244729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eaa5c9b83f59830e271d85ef16cdba97?s=128&d=identicon&r=PG&f=1", "display_name": "Olcay E.", "link": "https://stackoverflow.com/users/8244729/olcay-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1574285860, "creation_date": 1574284251, "last_edit_date": 1574285103, "question_id": 58963435, "link": "https://stackoverflow.com/questions/58963435/internal-array-element-location-algorithm", "title": "Internal Array Element Location Algorithm", "body": "<p>I'm trying to understand several concepts in C and one of these is the arrays. Well, in the book, there is an explanation about the internal array element location algorithm.</p>\n\n<blockquote>\n  <p>Each element in an array is reached by adding an offset to the starting address of the array</p>\n  \n  <p>\u2013 Address element i = starting array address + offset</p>\n  \n  <p>For single-dimensional arrays:</p>\n  \n  <p>\u2013 Offset = i * the size of an individual element</p>\n</blockquote>\n\n<p>However,</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#define  NUMELS 20\nint main() {\nint numbers[NUMELS];\n\nprintf(\"The starting address of the numbers array is: %d\\n\", &amp;(numbers[0]));\nprintf(\"The storage size of each array element is: %d\\n\", sizeof(int));\nprintf(\"The starting address of the numbers[5] array is: %d\\n\", &amp;(numbers[5]));\nreturn 0;\n}\n</code></pre>\n\n<p>when this code executed on <strong>macos</strong>, the result is;</p>\n\n<pre><code>The starting address of the numbers array is: -346695536\nThe storage size of each array element is: 4\nThe starting address of the numbers[5] array is: -346695516\n</code></pre>\n\n<p>on the another hand, when this code executed on <strong>windows</strong>, the result is;</p>\n\n<pre><code>The starting address of the numbers array is: 16514000\nThe storage size of each array element is: 4\nThe starting address of the numbers[5] array is: 16514020\n</code></pre>\n\n<p>My question is about the locating the arrays on the memory. Why does windows use unsigned numbers, whereas mac uses signed numbers?  </p>\n\n<p>Edit: Btw, i have executed these codes on the same ide. (clion). I know i should be using %p format specifier, but in the book, it was using %d format specifier. So I was just wondering the reason of difference on the results. Thanks for replies!</p>\n"}, {"tags": ["c", "animation", "sprite", "bmp", "sprite-sheet"], "answers": [{"comments": [{"owner": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "edited": false, "score": 0, "creation_date": 1574320334, "post_id": 58964872, "comment_id": 104192368, "body": "Thank you. I think my program should output A. The sprite B. Each frame cropped of unneeded pixels detected as transparent, C. A binary file with the already-determined actual width and height and a GIF (to make gif I should probably convert frames to png and cut the transparent pixels with ImageMagick or something). Do you think it worths sharing and open sourcing it?"}, {"owner": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "edited": false, "score": 0, "creation_date": 1574320580, "post_id": 58964872, "comment_id": 104192479, "body": "In the app, each frame is associated with its leftmost, rightmost (which essentially is leftmost (x) + width), topmost and bottommost (topmost (y) + height) and the transparent color detected. The center of the bounding box <code>wBox &#47; 2</code> is constant but I found out that you are right and the calculations from the question (minus the frame offset) actually produce different results for every frame. The motivation behind this was to shift position so that bounding box center and frame center matches, thought this would align them properly"}, {"owner": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "edited": false, "score": 0, "creation_date": 1574321151, "post_id": 58964872, "comment_id": 104192756, "body": "Do you mean that I should not allocate a fixed (sufficient minimum) width for every frame? If I pack them tight I don&#39;t think it will work everywhere, including in my game engine."}, {"owner": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "edited": false, "score": 0, "creation_date": 1574351815, "post_id": 58964872, "comment_id": 104210902, "body": "I mean I have each frame&#39;s x,y,w,h but I don&#39;t get you what should I do with them"}, {"owner": {"reputation": 240, "user_id": 2832768, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uwee8.png?s=128&g=1", "display_name": "guilleamodeo", "link": "https://stackoverflow.com/users/2832768/guilleamodeo"}, "reply_to_user": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "edited": false, "score": 0, "creation_date": 1574444912, "post_id": 58964872, "comment_id": 104248978, "body": "I would not recommend you the use of GIF because -as you said- it lacks transparency and supports a maximum of 256 colours.  I think that APNG is better for your purpose. The format is just a normal PNG with the firs frame at full size, and then other chunks with the frames to change, each giving location and dimension of the frame, as well as other stuff like timing. The only limitation is that each frame has to fit inside of the initial  PNG image. Its a great format because a PNG reader will play the sprite (eg a browser) and is compressed."}, {"owner": {"reputation": 240, "user_id": 2832768, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uwee8.png?s=128&g=1", "display_name": "guilleamodeo", "link": "https://stackoverflow.com/users/2832768/guilleamodeo"}, "reply_to_user": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "edited": false, "score": 0, "creation_date": 1574445137, "post_id": 58964872, "comment_id": 104249093, "body": "Read the info in the link I wrote in my answer and you will know what to do with your x,y,w,h. There is an open source library called libpng-apng which provides support to read/write these APNG files. <a href=\"https://github.com/rickytan/libpng-apng\" rel=\"nofollow noreferrer\">github.com/rickytan/libpng-apng</a>."}, {"owner": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "edited": false, "score": 0, "creation_date": 1574447314, "post_id": 58964872, "comment_id": 104250013, "body": "I can&#39;t use APNG, because it is not supported everywhere, including in the engine I use for my project, which /required/ me to create this tool. In any other situation, I&#39;d gladly use APNG."}, {"owner": {"reputation": 240, "user_id": 2832768, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uwee8.png?s=128&g=1", "display_name": "guilleamodeo", "link": "https://stackoverflow.com/users/2832768/guilleamodeo"}, "reply_to_user": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "edited": false, "score": 0, "creation_date": 1574599261, "post_id": 58964872, "comment_id": 104281706, "body": "My suggestion to use APNG is because is always good to use an standard format rather than your own format, which is what I think you are doing. Contrary to what you think, APNG is widely supported. Click in here <a href=\"https://en.wikipedia.org/wiki/APNG\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/APNG</a> with any browser and you will see a bouncing ball in the right hand side. That is an APNG."}, {"owner": {"reputation": 240, "user_id": 2832768, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uwee8.png?s=128&g=1", "display_name": "guilleamodeo", "link": "https://stackoverflow.com/users/2832768/guilleamodeo"}, "reply_to_user": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "edited": false, "score": 0, "creation_date": 1574599988, "post_id": 58964872, "comment_id": 104281890, "body": "Even Apple uses APNG for the animated stickers in iMessage. Go <a href=\"https://developer.apple.com/design/human-interface-guidelines/ios/extensions/messaging/#stickers\" rel=\"nofollow noreferrer\">developer.apple.com/design/human-interface-guidelines/ios/&hellip;</a> and scroll to &#39;Sticker Formats&#39;."}, {"owner": {"reputation": 240, "user_id": 2832768, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uwee8.png?s=128&g=1", "display_name": "guilleamodeo", "link": "https://stackoverflow.com/users/2832768/guilleamodeo"}, "reply_to_user": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "edited": false, "score": 0, "creation_date": 1574600050, "post_id": 58964872, "comment_id": 104281905, "body": "But again, it was just a suggestion. I am just trying to show that someone else walked your steps before. At least you know now how to fix your problem. :-)"}, {"owner": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "edited": false, "score": 0, "creation_date": 1574644321, "post_id": 58964872, "comment_id": 104293012, "body": "It is generally a piece of good advice towards the majority, but the platform I use hasn&#39;t been updated enough to support APNG. It is old too."}, {"owner": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "edited": false, "score": 0, "creation_date": 1574644520, "post_id": 58964872, "comment_id": 104293043, "body": "What I did is to give an option to use &quot;natural alignment&quot;, which is to not deteriorate the animation with alignment algorithms, but crop a fixed area (of the largest frame) of each frame and therefore preserve the natural alignment. In my case, I have a number of frames captured with AnimGet and it works out well because each frame is big enough. I still can&#39;t figure out why centering did not work though, but the program I am writing may give me a clue as I program it and use it."}, {"owner": {"reputation": 240, "user_id": 2832768, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uwee8.png?s=128&g=1", "display_name": "guilleamodeo", "link": "https://stackoverflow.com/users/2832768/guilleamodeo"}, "reply_to_user": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "edited": false, "score": 0, "creation_date": 1574792576, "post_id": 58964872, "comment_id": 104353858, "body": "Well, the main goal has been achieved and whoever reach here will know about APNG. ;-) all the best with your work!"}], "tags": [], "owner": {"reputation": 240, "user_id": 2832768, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uwee8.png?s=128&g=1", "display_name": "guilleamodeo", "link": "https://stackoverflow.com/users/2832768/guilleamodeo"}, "is_accepted": false, "score": 1, "last_activity_date": 1574291785, "creation_date": 1574291785, "answer_id": 58964872, "question_id": 58963373, "link": "https://stackoverflow.com/questions/58963373/sprite-alignment-in-a-sprite-packing-c-application/58964872#58964872", "title": "Sprite alignment in a Sprite Packing C application", "body": "<p>Your problem is that you first calculate the center then calculate the size of the required bounding box. That is why your image 'shakes' because in each image that center is different to the original center.</p>\n\n<p>You should use the center of the original bounding box as your origin, then find out the size of each sprite, keeping track of the leftmost, rightmost, topmost and bottommost non transparent pixels. That would give you the bounding box you need to use to avoid the shaking.</p>\n\n<p>The problem is that you will find that most sprites are already done that way, so the original bounding box is actually defined as to the minimum space to paint the whole sprite's sequence covering these non transparent pixels.</p>\n\n<p>The only way to remove unused sprite space is to store the first sprite complete, and then the origin and dimensions of each other sprite, like is done in animated GIF and APNG ( Animated PNG -> <a href=\"https://en.wikipedia.org/wiki/APNG\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/APNG</a> )     </p>\n"}], "owner": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574291785, "creation_date": 1574283981, "last_edit_date": 1574284449, "question_id": 58963373, "link": "https://stackoverflow.com/questions/58963373/sprite-alignment-in-a-sprite-packing-c-application", "title": "Sprite alignment in a Sprite Packing C application", "body": "<p>I am creating the \"perfect\" sprite packer. This is a sprite packer that makes sure the output sprite is compatible with most if not all game engines and animation software. It is a program that merges images into a horizontal sprite sheet.</p>\n\n<ol>\n<li><p>It converts (if needed) the source frames to BMP in memory</p></li>\n<li><p>It considers the top-left pixel fully transparent for the entire image (can be configured)</p></li>\n<li><p>It parses the frames each individually to find the real coordinates rect (where the actual frame starts, ends, its width and height (sometimes images may have a lot of extra transparent pixels).</p></li>\n<li><p>It determines the frame box, which have the width and height of the frame with the largest width/height so that it is long enough to contain every frame. (For extra compatibility, every frame must have the same dimensions).</p></li>\n<li><p>Creates output sprite with width of nFrames * wFrameBox</p></li>\n</ol>\n\n<p>The problem is - anchor alignment. Currently, it tries to align each frame so that its center is on the frame box center.</p>\n\n<pre><code>if((wBox / 2) &gt; (frame-&gt;realCoordinates.w / 2))\n{\n    xpos = xBoxOffset + ((wBox / 2) - (frame-&gt;realCoordinates.w / 2));\n}\nelse\n{\n    xpos = xBoxOffset + ((frame-&gt;realCoordinates.w / 2) - (wBox / 2));\n}\n</code></pre>\n\n<p>When animated, it looks better with it, but there is still this inconsistent horizontal frame position so that a walking animation looks like walking and shaking.\nI also tried the following:\nstore the real x pixel position of the widest frame and use it as a reference point:\n<code>xpos = xBoxOffset + (frame-&gt;realCoordinates.x - xRef);</code>\nIt also gives a little better results, showing that this is still not the correct algorithm.\nHonestly, I don't know what am I doing.</p>\n\n<p>What will be the correct way to align sprite frames (obtain the appropriate x position for drawing the next frame) given that the output sprite sheet have width of the number of frames multiplied by the width of the widest frame?</p>\n"}, {"tags": ["python", "c", "python-3.x", "python-c-api"], "answers": [{"tags": [], "owner": {"reputation": 116, "user_id": 3075647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/733cc0bf450873f18a06fbef839a32ec?s=128&d=identicon&r=PG&f=1", "display_name": "dalmago", "link": "https://stackoverflow.com/users/3075647/dalmago"}, "is_accepted": false, "score": 1, "last_activity_date": 1574785566, "creation_date": 1574785566, "answer_id": 59055340, "question_id": 58963274, "link": "https://stackoverflow.com/questions/58963274/c-api-pysys-setobject-reference-count/59055340#59055340", "title": "C-API: PySys_SetObject Reference Count", "body": "<blockquote>\n  <p>Should I just assume that whenever the docs don't specify that the function steals the reference I should always decrement its reference counter?</p>\n</blockquote>\n\n<p>Apparently yes. When calling <code>PySys_SetObject(\"name\", v)</code> it does increment <code>v</code> reference counter. It also decrements the reference counter of whichever object there is in the sys module named <code>\"name\"</code>, if it exists.</p>\n"}], "owner": {"reputation": 116, "user_id": 3075647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/733cc0bf450873f18a06fbef839a32ec?s=128&d=identicon&r=PG&f=1", "display_name": "dalmago", "link": "https://stackoverflow.com/users/3075647/dalmago"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1574887610, "creation_date": 1574283544, "last_edit_date": 1574887610, "question_id": 58963274, "link": "https://stackoverflow.com/questions/58963274/c-api-pysys-setobject-reference-count", "title": "C-API: PySys_SetObject Reference Count", "body": "<p>Does <a href=\"https://docs.python.org/3.6/c-api/sys.html#c.PySys_SetObject\" rel=\"nofollow noreferrer\">PySys_SetObject</a> steal the reference to the object <code>v</code> or should I decrement its reference counter?</p>\n\n<pre><code>PyObject *my_obj = PyUnicode_FromString(\"my_string_path\");\nint ret = PySys_SetObject(\"path\", my_obj);\nPy_XDECREF(my_obj);  // Should I decref it?\n</code></pre>\n\n<p>Should I just assume that whenever the docs don't specify that the function steals the reference I should always decrement its reference counter?</p>\n\n<p>The same question for <a href=\"https://docs.python.org/3.6/c-api/list.html#c.PyList_Append\" rel=\"nofollow noreferrer\">PyList_Append</a> (<a href=\"https://docs.python.org/3.6/c-api/list.html#c.PyList_SetItem\" rel=\"nofollow noreferrer\">PyList_SetItem</a> specifies the stealing behavior).</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1574280940, "post_id": 58962573, "comment_id": 104180464, "body": "Why are you changing your code on the fly? Please post the exact code which is generating the exact error, and not some &quot;tweaked&quot; one."}, {"owner": {"reputation": 277, "user_id": 5560389, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gutQT.png?s=128&g=1", "display_name": "F.Guerinoni", "link": "https://stackoverflow.com/users/5560389/f-guerinoni"}, "edited": false, "score": 0, "creation_date": 1574280970, "post_id": 58962573, "comment_id": 104180478, "body": "I don&#39;t have any problems to run this, write your input numbers and your host envirnoment"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 2, "creation_date": 1574280979, "post_id": 58962573, "comment_id": 104180483, "body": "<code>if (a &gt;= 0 &amp;&amp; b &gt;= 0)</code> that&#39;s not a good test. You don&#39;t want either a or b to be 0"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1574281026, "post_id": 58962573, "comment_id": 104180502, "body": "index is wrong: <code>a*i + n</code> =&gt; <code>b*i + n</code>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1574281057, "post_id": 58962573, "comment_id": 104180511, "body": "@Jean-Fran&#231;oisFabre The whole <code>valid</code> thing seem to be inverted"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1574281581, "post_id": 58962573, "comment_id": 104180748, "body": "no, <code>valid==1</code> is set at start. Loop exits when <code>valid==0</code> (which probably means: no need to validate anymore). I agree this is misleading"}, {"owner": {"reputation": 1082, "user_id": 9091276, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/05cFn.png?s=128&g=1", "display_name": "Frontear", "link": "https://stackoverflow.com/users/9091276/frontear"}, "edited": false, "score": 0, "creation_date": 1574282172, "post_id": 58962573, "comment_id": 104181007, "body": "By allowing <code>a</code> and <code>b</code> to be zero, you run the risk of running <code>malloc(0)</code>. What do you think happens when you try to dereference or use a pointer created by that?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1574284487, "post_id": 58962573, "comment_id": 104182044, "body": "regarding: <code>main()</code>  This results in a warning from the compiler.  In days gone by, a missing return type would default to <code>int</code> but not today.  Suggest: <code>int main( void )</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1574284608, "post_id": 58962573, "comment_id": 104182090, "body": "when compiling, always enable the warnings, then fix those warnings.  Regarding: <code>srand(time(0));</code>  This results in some &#39;conversion&#39; warnings from the compiler.  Suggest: <code>srand( (unsigned int)time( NULL ) );</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1574284876, "post_id": 58962573, "comment_id": 104182200, "body": "OT:  regarding this kind of statement: <code>Matrix_01 = (int *)malloc(a * b * sizeof(int));</code>  1) in C, the returned type is <code>void*</code> which can be assigned to any pointer.  Casting just clutters the code, making it more difficult to understand, debug, etc.  Suggest removing the cast.  2) when calling any of the heap allocation functions: <code>malloc()</code>, <code>calloc()</code>, and/or <code>realloc()</code> always check (!=NULL) the returned value.  If not successful, then call <code>perror( &quot;malloc failed&quot; );</code> to output both your error message and the text reason the system thinks the error occurred to <code>stderr</code>."}], "answers": [{"tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": true, "score": 1, "last_activity_date": 1574281697, "last_edit_date": 1574281697, "creation_date": 1574281191, "answer_id": 58962723, "question_id": 58962573, "link": "https://stackoverflow.com/questions/58962573/0xc0000374-a-heap-has-been-corrupted-parameters-0x77aab960/58962723#58962723", "title": "0xC0000374: A heap has been corrupted (parameters: 0x77AAB960)", "body": "<p>Heap is corrupt in that case means that you wrote out of the valid allocated zones.</p>\n\n<p>Check the min &amp; max values of your index:</p>\n\n<ul>\n<li><code>i</code> ranges from <code>0</code> to <code>a-1</code></li>\n<li><code>n</code> ranges from <code>0</code> to <code>b-1</code></li>\n</ul>\n\n<p>So <code>a*i + n</code> ranges from <code>0</code> to <code>a*(a+1) + b</code>. So it doesn't match the matrix dimensions. If <code>a</code> is bigger than <code>b</code> the memory will get corrupted.</p>\n\n<p>You need to replace this by <code>b*i + n</code> (which ranges from <code>0</code> to <code>b*(a-1) + b</code> => <code>a*b</code></p>\n\n<p>You also want to avoid to allow that <code>a</code> or <code>b</code> is zero when reading the input. Actually, it's better to check if <code>scanf</code> succeeded in scanning one value by checking the return code <em>then</em> check if values are greater than zero (but not equal) \nOr use 2D matrixes (or compute pointers on rows once to avoid those computations)</p>\n"}], "owner": {"reputation": 7, "user_id": 10872491, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-g-lkZs_GSto/AAAAAAAAAAI/AAAAAAAAAVk/lZdKDJJtelg/photo.jpg?sz=128", "display_name": "Slavko", "link": "https://stackoverflow.com/users/10872491/slavko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 859, "favorite_count": 0, "accepted_answer_id": 58962723, "answer_count": 1, "score": -2, "last_activity_date": 1574323381, "creation_date": 1574280645, "last_edit_date": 1574323381, "question_id": 58962573, "link": "https://stackoverflow.com/questions/58962573/0xc0000374-a-heap-has-been-corrupted-parameters-0x77aab960", "title": "0xC0000374: A heap has been corrupted (parameters: 0x77AAB960)", "body": "<p>The code bellow sometimes throws exceptions similar to:</p>\n\n<p>Exception thrown at 0x779CC19E (ntdll.dll) in Matriks.exe: 0xC0000005: Access violation reading location 0x0000001D.</p>\n\n<p>I'm new to C and just learned to use pointers. Any tips ? Are there other problems in my code that are worth criticizing ?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n\nmain()\n{\n    int *Matrix_01, *Matrix_02;\n    int a, b, i, n,valid=1;\n    srand(time(0));\n    do \n    {\n        printf(\"Insert number of rows: \");\n        scanf(\"%d\", &amp;a);\n        printf(\"Insert number of columns: \");\n        scanf(\"%d\", &amp;b);\n        if (a &gt;= 0 &amp;&amp; b &gt;= 0)\n            valid = 0;\n        else\n        {\n            printf(\"Invalid input!\");\n            system(\"pause&gt;null &amp; cls\");\n        }\n    } while (valid == 1);\n\n    Matrix_01 = (int *)malloc(a * b * sizeof(int));\n    Matrix_02 = (int *)malloc(a * b * sizeof(int));\n    for (i = 0; i &lt; a; i++)\n        for (n = 0; n &lt; b; n++)\n        {\n            Matrix_01[a*i + n] = rand() % 50;\n            Matrix_02[a*i + n] = rand() % 50;\n        }\n    printf(\"\\nFirst Matrix:\\n\");\n    for (i = 0; i &lt; a; i++)\n    {\n        printf(\"\\n\");\n        for (n = 0; n &lt; b; n++)\n        {\n            printf(\"%4d\", Matrix_01[a*i + n]);\n        }\n    }\n    printf(\"\\n\\nSecond Matrix:\\n\");\n    for (i = 0; i &lt; a; i++)\n    {\n        printf(\"\\n\");\n        for (n = 0; n &lt; b; n++)\n        {\n            printf(\"%4d\", Matrix_02[a*i + n]);\n        }\n    }\n    printf(\"\\n\\nAddition:\\n\");\n    for (i = 0; i &lt; a; i++)\n    {\n        printf(\"\\n\");\n        for (n = 0; n &lt; b; n++)\n        {\n            printf(\"%4d\", Matrix_01[a*i + n]+Matrix_02[a*i + n]);\n        }\n    }\n    printf(\"\\n\\nSubtraction:\\n\");\n    for (i = 0; i &lt; a; i++)\n    {\n        printf(\"\\n\");\n        for (n = 0; n &lt; b; n++)\n        {\n            printf(\"%4d\", Matrix_01[a*i + n] - Matrix_02[a*i + n]);\n        }\n    }\n    printf(\"\\n\");\n    system(\"pause&gt;null\");\n} \n</code></pre>\n"}, {"tags": ["c", "visual-studio-code", "embedded", "platformio"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1574277458, "post_id": 58961770, "comment_id": 104178732, "body": "<code>ln2</code> is pointing to a <i>string literal</i>, which should not be modified. Attempting to do so has an <i>undefined behavior</i>."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1574277651, "post_id": 58961770, "comment_id": 104178821, "body": "There should be hundreds of duplicates. Any canonical ones, anyone?"}, {"owner": {"reputation": 8627, "user_id": 59314, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/24424c3c34f1dd023613c34b627d08f4?s=128&d=identicon&r=PG", "display_name": "OrElse", "link": "https://stackoverflow.com/users/59314/orelse"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1574277751, "post_id": 58961770, "comment_id": 104178878, "body": "Actually it is not this case. Let me post an update"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1574277938, "post_id": 58961770, "comment_id": 104178969, "body": "Did you link with _printf_float? Most probably your &quot;platformio&quot; has some option to link with full version of C library, that does include float printf support, and such support is not included by default. <code>sprintf(ln1,</code> is undefined behavior no matter what it outputs. The code may output anything, also a valid output, and still the code is very invalid."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1574278053, "post_id": 58961770, "comment_id": 104179036, "body": "Your update has the same flaw. Before you fix the UB no definitive answer can be provided."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 7, "creation_date": 1574278124, "post_id": 58961770, "comment_id": 104179096, "body": "C libraries for embedded systems may attempt to reduce code size by not supporting floating point numbers. So the question mark simply means that you haven&#39;t enabled the floating point features of <code>sprintf</code>."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1574278220, "post_id": 58961770, "comment_id": 104179145, "body": "BTW, the code should be <code>char ln2[] = &quot;...............&quot;;</code> That creates an a array of characters that you can legally write to.  (Wow, they&#39;re removing spaces even in code snippets. The dots represent space characters.)"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1574278717, "post_id": 58961770, "comment_id": 104179376, "body": "@user3386109 has a very possible explanation. Which compiler/C library are you using?"}, {"owner": {"reputation": 8627, "user_id": 59314, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/24424c3c34f1dd023613c34b627d08f4?s=128&d=identicon&r=PG", "display_name": "OrElse", "link": "https://stackoverflow.com/users/59314/orelse"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1574278785, "post_id": 58961770, "comment_id": 104179404, "body": "@user3386109 I guess this one must be the case"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1574279079, "post_id": 58961770, "comment_id": 104179559, "body": "@OrElse Could be, but to know for sure (and to get help fixing it), the question needs more information about the tools and libraries that you&#39;re using."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 2, "creation_date": 1574279970, "post_id": 58961770, "comment_id": 104180012, "body": "@user3386109 There&#39;s no need to initialize it with a string literal. Just make sure it&#39;s defined as an array. The question was edited 4 minutes ago, and now shows <code>char ln2[16];</code>, which should be fine (and works correctly on my system). We still need a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. I&#39;m guessing it&#39;s an issue with <code>*printf</code> not supporting floating-point by default."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 2, "creation_date": 1574280129, "post_id": 58961770, "comment_id": 104180083, "body": "If my guess is correct (that you have to do something special to enable floating-point in <code>sprintf</code>), then  you should be able to reproduce the problem with a simple program that just does <code>printf(&quot;%f\\n&quot;, 0.0);</code>. Please try that, and if that prints a question mark, update your question to show a <i>complete</i> sample program (should be about 4 lines total). BTW, Visual Studio Code is an editor and should have no effect on the program&#39;s behavior. You&#39;ve probably configured it to invoke the compiler with certain options; you should get the same behavior invoking the compiler directly."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1574280305, "post_id": 58961770, "comment_id": 104180165, "body": "Also, &quot;embedded&quot; isn&#39;t enough information. Since embedded systems vary <i>a lot</i>, we likely need to know what embedded system you&#39;re targeting and what compiler you&#39;re using."}, {"owner": {"reputation": 8627, "user_id": 59314, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/24424c3c34f1dd023613c34b627d08f4?s=128&d=identicon&r=PG", "display_name": "OrElse", "link": "https://stackoverflow.com/users/59314/orelse"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1574281158, "post_id": 58961770, "comment_id": 104180552, "body": "@KeithThompson Into the spot. The printf(&quot;%f\\n&quot;, 0.0) returns -1"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1574281730, "post_id": 58961770, "comment_id": 104180825, "body": "<code>printf(&quot;%f\\n&quot;, 0.0)</code> returning -1 is a different problem. That simply means that <code>printf</code> is not supported because there is no <code>stdout</code> for <code>printf</code> to use. Try <code>printf(&quot;hello&quot;)</code> and I expect the return value will be -1."}, {"owner": {"reputation": 8627, "user_id": 59314, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/24424c3c34f1dd023613c34b627d08f4?s=128&d=identicon&r=PG", "display_name": "OrElse", "link": "https://stackoverflow.com/users/59314/orelse"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1574282646, "post_id": 58961770, "comment_id": 104181209, "body": "@user3386109 Here we go again. You are right. I should better check for alternatives <a href=\"https://github.com/mpaland/printf\" rel=\"nofollow noreferrer\">github.com/mpaland/printf</a>"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1574285128, "post_id": 58961770, "comment_id": 104182296, "body": "@OrElse It returned <code>-1</code> but did it print anything? You got a question mark from <code>sprintf</code>, so I&#39;d expect the same from <code>printf</code>. (Since it&#39;s an embedded target, maybe you don&#39;t have access to <code>stdout</code>?)"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1574285277, "post_id": 58961770, "comment_id": 104182348, "body": "Depending on your requirements, you might try something like <code>printf(&quot;%ld.%03d\\n&quot;, (long)Voltage1, (int)(Voltage1 * 1000.0))</code>. (I have not tested this. Watch out for rounding and off-by-one errors.)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1574290159, "post_id": 58961770, "comment_id": 104184204, "body": "Avoid buffer overflow: <code>sprintf(ln2, &quot;%f Volt&quot;, Data[Position].Voltage1);</code> --&gt; <code>snprintf(ln2, sizeof ln2, &quot;%f Volt&quot;, Data[Position].Voltage1);</code>"}], "answers": [{"comments": [{"owner": {"reputation": 8627, "user_id": 59314, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/24424c3c34f1dd023613c34b627d08f4?s=128&d=identicon&r=PG", "display_name": "OrElse", "link": "https://stackoverflow.com/users/59314/orelse"}, "edited": false, "score": 0, "creation_date": 1574277773, "post_id": 58961818, "comment_id": 104178889, "body": "Actually it is not this case. Let me post an update"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 8627, "user_id": 59314, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/24424c3c34f1dd023613c34b627d08f4?s=128&d=identicon&r=PG", "display_name": "OrElse", "link": "https://stackoverflow.com/users/59314/orelse"}, "edited": false, "score": 0, "creation_date": 1574278029, "post_id": 58961818, "comment_id": 104179020, "body": "@OrElse The answer still stands after your change.  You can&#39;t write to a string literal.  You got &quot;lucky&quot; that it worked in the case with an <code>int</code>."}, {"owner": {"reputation": 8627, "user_id": 59314, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/24424c3c34f1dd023613c34b627d08f4?s=128&d=identicon&r=PG", "display_name": "OrElse", "link": "https://stackoverflow.com/users/59314/orelse"}, "edited": false, "score": 0, "creation_date": 1574278088, "post_id": 58961818, "comment_id": 104179063, "body": "Thank you for your efforts sir, but I actually have the same results with char ln2[16];"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 8627, "user_id": 59314, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/24424c3c34f1dd023613c34b627d08f4?s=128&d=identicon&r=PG", "display_name": "OrElse", "link": "https://stackoverflow.com/users/59314/orelse"}, "edited": false, "score": 0, "creation_date": 1574278155, "post_id": 58961818, "comment_id": 104179107, "body": "@OrElse Then there&#39;s something else wrong with your code that you&#39;re not showing us.  Please update your question with a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> so others may reproduce your problem."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 1, "creation_date": 1574279384, "post_id": 58961818, "comment_id": 104179713, "body": "Not the cause of the problem, but still an issue anyway. +1"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 2, "creation_date": 1574280229, "post_id": 58961818, "comment_id": 104180128, "body": "This answer was made obsolete by a recent edit. The OP apparently has the problem after applying your fix."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 2, "creation_date": 1574283006, "post_id": 58961818, "comment_id": 104181396, "body": "@dbush I would rather say - it is normal in the embedded world. You need to let linker know that you want to print/scan floats and you are ready to sacrifice 10/15kb of FLASH"}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 2, "last_activity_date": 1574277466, "creation_date": 1574277466, "answer_id": 58961818, "question_id": 58961770, "link": "https://stackoverflow.com/questions/58961770/why-sprintf-generates-the-question-mark-character-as-output/58961818#58961818", "title": "Why sprintf() generates the question mark character, as output?", "body": "<p><code>ln2</code> points to a string literal.  String literals are read-only, so when you attempt to write to it you invoke <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.</p>\n\n<p>You should instead define <code>ln2</code> as a character array which is writable.</p>\n\n<pre><code>char ln2[16];\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": true, "score": 5, "last_activity_date": 1574282866, "creation_date": 1574282866, "answer_id": 58963131, "question_id": 58961770, "link": "https://stackoverflow.com/questions/58961770/why-sprintf-generates-the-question-mark-character-as-output/58963131#58963131", "title": "Why sprintf() generates the question mark character, as output?", "body": "<p>Embedded versions of the printf usually do not implement float number handling. You need to let the linker to link the correct version of the function. For example for ARM gcc it will be <code>-u _printf_float</code> or/and <code>-u _scanf_float</code></p>\n"}], "owner": {"reputation": 8627, "user_id": 59314, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/24424c3c34f1dd023613c34b627d08f4?s=128&d=identicon&r=PG", "display_name": "OrElse", "link": "https://stackoverflow.com/users/59314/orelse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 493, "favorite_count": 0, "accepted_answer_id": 58963131, "answer_count": 2, "score": 3, "last_activity_date": 1574283490, "creation_date": 1574277320, "last_edit_date": 1574283490, "question_id": 58961770, "link": "https://stackoverflow.com/questions/58961770/why-sprintf-generates-the-question-mark-character-as-output", "title": "Why sprintf() generates the question mark character, as output?", "body": "<p>While working on an embedded project, I noticed that <code>sprintf()</code> method for the following code:</p>\n\n<pre><code>  char ln2[16];\n  sprintf(ln2, \"%f Volt\", Data[Position].Voltage1);\n</code></pre>\n\n<p>generates the question mark character as output.</p>\n\n<p>The output generated from the code above is:</p>\n\n<pre><code>? Volt\n</code></pre>\n\n<p>while the input is declared as <code>double Voltage1 = 0.0;</code></p>\n\n<p>The same issue does not seem to apply while trying to format an integer.<br>\nThe following works as expected:</p>\n\n<pre><code>  char ln1[16];\n  sprintf(ln1, \"POSITION %d\", (Position + 1));\n</code></pre>\n\n<p>and outputs <code>POSITION 3</code> where the <code>Position</code> is a global variable and declared as <code>int</code>.</p>\n\n<p>The structure that actually holds the data is:</p>\n\n<pre><code>struct data\n{\n  int Position;\n  double Voltage1;\n  double Voltage2;\n};\n</code></pre>\n\n<p>All above while using the <a href=\"https://github.com/microsoft/vscode-cpptools\" rel=\"nofollow noreferrer\">C/C++</a> \nand the <a href=\"https://platformio.org/\" rel=\"nofollow noreferrer\">Platform.io</a> extensions both for VS Code.</p>\n\n<p>What is going on wrong here?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 2, "creation_date": 1574288385, "post_id": 58961739, "comment_id": 104183594, "body": "the posted code contains a logic error:  Regarding: <code>if (n = primzahlen[anzahl]){</code>  This is an assignment, but you actually want a comparison.  Suggest: <code>if (n == primzahlen[anzahl]){</code>.   Also, the index <code>anzahl</code> contains the index to the highest entry in the array: <code>primzahlen[]</code> which (probably) is not the entry of interest for the user supplied value."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1574288668, "post_id": 58961739, "comment_id": 104183692, "body": "OT: the posted code contains some &#39;magic&#39; numbers.  &#39;magic&#39; numbers are numbers with no basis.  I.E. 1000.  Suggest using an <code>enum</code> statement or a <code>#define</code> statement to give that &#39;magic&#39; number a meaningful name, then using that meaningful name throughout the code"}], "answers": [{"comments": [{"owner": {"reputation": 12226, "user_id": 980549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a68706fa5d2665f4dd0c6452b4e844c7?s=128&d=identicon&r=PG", "display_name": "Mark J. Bobak", "link": "https://stackoverflow.com/users/980549/mark-j-bobak"}, "edited": false, "score": 0, "creation_date": 1574286067, "post_id": 58961869, "comment_id": 104182671, "body": "Good catch, easy to overlook!"}], "tags": [], "owner": {"reputation": 1669, "user_id": 12396017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nk8xz.png?s=128&g=1", "display_name": "Maxim Sagaydachny", "link": "https://stackoverflow.com/users/12396017/maxim-sagaydachny"}, "is_accepted": false, "score": 2, "last_activity_date": 1574277711, "creation_date": 1574277711, "answer_id": 58961869, "question_id": 58961739, "link": "https://stackoverflow.com/questions/58961739/eratosthenes-in-c-how-do-use-the-printf-in-this-case/58961869#58961869", "title": "Eratosthenes in C - How do use the printf in this case", "body": "<p>you are discarding value of n variable here:</p>\n\n<pre><code>if (n = primzahlen[anzahl]){\n</code></pre>\n\n<p>you probably intended to compare numbers instead of assignment</p>\n\n<pre><code>if (n == primzahlen[anzahl]){\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1320, "user_id": 5495906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5b319c1b73d80f4155fbdd4fcb81525?s=128&d=identicon&r=PG&f=1", "display_name": "LegendofPedro", "link": "https://stackoverflow.com/users/5495906/legendofpedro"}, "edited": false, "score": 1, "creation_date": 1574303916, "post_id": 58963560, "comment_id": 104187726, "body": "What if the user wants to check an n&lt;=1?"}, {"owner": {"reputation": 378, "user_id": 2620017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/517078d0e5e19b98b4b8c7228da5aadf?s=128&d=identicon&r=PG", "display_name": "hko", "link": "https://stackoverflow.com/users/2620017/hko"}, "edited": false, "score": 1, "creation_date": 1574304696, "post_id": 58963560, "comment_id": 104187897, "body": "True. I added this check to my answer. All numbers &lt; 2 are not primes."}], "tags": [], "owner": {"reputation": 378, "user_id": 2620017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/517078d0e5e19b98b4b8c7228da5aadf?s=128&d=identicon&r=PG", "display_name": "hko", "link": "https://stackoverflow.com/users/2620017/hko"}, "is_accepted": false, "score": 2, "last_activity_date": 1574304604, "last_edit_date": 1574304604, "creation_date": 1574284830, "answer_id": 58963560, "question_id": 58961739, "link": "https://stackoverflow.com/questions/58961739/eratosthenes-in-c-how-do-use-the-printf-in-this-case/58963560#58963560", "title": "Eratosthenes in C - How do use the printf in this case", "body": "<p>The whole second part of your program isn't necessary. You can just simplify it to:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdbool.h&gt;\n\nint main () {\n    int i;\n    int durch [1000] = {0};\n    int n;\n\n    for (i = 2; i &lt;= 1000; i++)\n    {\n        if (!durch[i-2])\n        {\n            for (int j = 2*i; j &lt;= 1000; j+= i)\n            {\n                durch[j-2] = 1;\n            }\n        }\n    }\n\n    scanf (\"%i\", &amp;n);\n\n    if ((n &gt; 1) &amp;&amp; !durch [n-2]) {\n        printf (\"Yes it is a prime!\\n\");\n    }\n    else {\n        printf (\"No it isnt a prime!\\n\");\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>And note <code>scanf (\"%i\\n\", &amp;n);</code> will ask for 2 numbers. You need to use <code>scanf (\"%i\", &amp;n);</code></p>\n\n<p>See: <a href=\"https://stackoverflow.com/questions/6349837/scanf-curious-behaviour\">scanf() curious behaviour!</a></p>\n"}], "owner": {"reputation": 25, "user_id": 12382562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9087475cc2a7af83adc22e9db153d360?s=128&d=identicon&r=PG&f=1", "display_name": "Kise948", "link": "https://stackoverflow.com/users/12382562/kise948"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1574304604, "creation_date": 1574277209, "question_id": 58961739, "link": "https://stackoverflow.com/questions/58961739/eratosthenes-in-c-how-do-use-the-printf-in-this-case", "title": "Eratosthenes in C - How do use the printf in this case", "body": "<p>I'm pretty much done with my code which calculates all primes between 2 and 1000. However, I need make a code which scans my prime array and prints whether its a prime or not.</p>\n\n<p>For those who dont understand what I want: After calculating all primes between 2 and 1000, I want the user to give a random number which then tells the user whether its a prime or not. With this code below, it doesnt work for some reason... can someone tell me what I did wrong?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdbool.h&gt;\n\n\n\n\nint main () {\n\n\nint durch [1000] = {0};\n\nfor (int i = 2; i &lt;= 1000; i++)\n{\n    if (!durch[i-2])\n    {\n        for (int j = 2*i; j &lt;= 1000; j+= i)\n        {\n            durch[j-2] = 1;\n\n\n        }\n\n    }\n}\n\nint primzahlen [1000];\nint anzahl = 0;\nint n;\n\nfor (int i = 2; i &lt;= 1000; i++)\n{\n    if (!durch [i-2])\n    {\n        primzahlen[anzahl] = i;\n        anzahl++;\n\n// printf (\"%i : %i\\n\", anzahl, i);\nscanf (\"%i\\n\", &amp;n);\n\nif (n = primzahlen[anzahl]){\n    printf (\"Yes it is a prime!\\n\");\n    break;\n}\nelse {\n    printf (\"No it isnt a prime!\\n\");\n    break;\n}\n\n    }\n}\n\n\n    return 0;\n}\n</code></pre>\n\n<p>I really cant figure that part out.. I feel like I miss something? Can somebody help me out please?</p>\n"}, {"tags": ["c++", "c", "visual-studio-2015", "visual-studio-2017", "precompiled-headers"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1574275044, "post_id": 58961109, "comment_id": 104177625, "body": "If you want to use the Visual C++ precompiled header feature, why not let the project wizard create it for you and leave it as it is? And note that many large project disable it because it&#39;s often more trouble than it&#39;s worth."}, {"owner": {"reputation": 123, "user_id": 6217440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57ea60d9ff4628b674a27ce3213a3646?s=128&d=identicon&r=PG&f=1", "display_name": "Yea okay", "link": "https://stackoverflow.com/users/6217440/yea-okay"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1574287032, "post_id": 58961109, "comment_id": 104183082, "body": "@Someprogrammerdude I didn&#39;t use the wizard because I didn&#39;t need it in the beginning and didn&#39;t know how to use a wizard to re set it up. Also this has brought my compile time down from 20 seconds to 0.8 seconds so I believe this is something everyone should implement. Things like Windows.h, iostream, string, vector etc getting recompiled every single time is drastic in my opinion."}], "answers": [{"comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1574275206, "post_id": 58961218, "comment_id": 104177703, "body": "Use back ticks to highlight code. See my edit of the question. The problem is that brackets <code>&lt;&gt;</code> outside of code snippets are interpreted as an attempt to use HTML markup, and are ignored."}], "tags": [], "owner": {"reputation": 123, "user_id": 6217440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57ea60d9ff4628b674a27ce3213a3646?s=128&d=identicon&r=PG&f=1", "display_name": "Yea okay", "link": "https://stackoverflow.com/users/6217440/yea-okay"}, "is_accepted": true, "score": 0, "last_activity_date": 1574286926, "last_edit_date": 1574286926, "creation_date": 1574275039, "answer_id": 58961218, "question_id": 58961109, "link": "https://stackoverflow.com/questions/58961109/custom-precompiled-headers-causing-compile-errors/58961218#58961218", "title": "Custom precompiled headers causing compile errors", "body": "<p>The issue was with every CPP file that wasnt in the same folder as the precompiled header.\nSo if you use a file structure that contains different classes in different folders, using \n<code>#include \"../../vpch.h\"</code> will actually fail. You must add the root folder to your additional include directories and then use <code>#include &lt;vpch.h&gt;</code> for all files. I can NOT tell you why using <code>#include \"../../vpch.h\"</code> wasn't working. It seems counter intuitive for it to fail in my opinion. </p>\n\n<p>It may be because it searches for the precompiled header in the same folder as the file you are referencing it in. This answer, however, will work as a solution.</p>\n"}], "owner": {"reputation": 123, "user_id": 6217440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57ea60d9ff4628b674a27ce3213a3646?s=128&d=identicon&r=PG&f=1", "display_name": "Yea okay", "link": "https://stackoverflow.com/users/6217440/yea-okay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 58961218, "answer_count": 1, "score": 0, "last_activity_date": 1574286926, "creation_date": 1574274546, "last_edit_date": 1574275047, "question_id": 58961109, "link": "https://stackoverflow.com/questions/58961109/custom-precompiled-headers-causing-compile-errors", "title": "Custom precompiled headers causing compile errors", "body": "<p>I am trying to introduce precompiled headers into my project because of long compile times in my project right now. I have a main project that includes a main function and all the real code is in the DLL project(they are linked together.) I named my precompiled header \"vpch.h\" and i created a vpch.cpp that includes vpch.h. I am using visual studio 2017 so I went into the properties of vpch.cpp and selected Create. Then I added vpch.h as the first thing in all my cpp files. All files are set to use precompiled headers and reference vpch.h Every CPP files throws the error:</p>\n\n<pre><code>Error C1010 unexpected end of file while looking for precompiled header. \n            Did you forget to add '#include \"vpch.h\"' to your source?\n</code></pre>\n\n<p>I am at a loss as to what to do because I have followed many tutorials and can't find a reason for this. As well as most issues that pop up on google are people just accidentally including precompiled headers.</p>\n\n<p>My only thought is that maybe in the section in properties where it asks for the name of the precompiled header, I need to do more than put \"vpch.h\" and maybe an exact file location? Any help with this is super appreciated. </p>\n\n<p>EDIT</p>\n\n<p>From further debugging it would appear that all but ONE cpp file is throwing an error. The one that doesn't throw an error is the one that exists in the same exact folder as the vpch.h. So files that can't just write <code>#include \"vpch.h\"</code> and have to write something like <code>\"../vpch.h\"</code> I can write <code>#include &lt;vpch.h&gt;</code> and I am going to try that now but I am unsure that will help.</p>\n"}, {"tags": ["c", "buffer-overflow"], "comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 3, "creation_date": 1574274697, "post_id": 58961105, "comment_id": 104177454, "body": "Neither programs are safe, because <code>gets</code> is an unsafe function."}, {"owner": {"reputation": 616, "user_id": 1930495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Pirg4.jpg?s=128&g=1", "display_name": "Michele Dorigatti", "link": "https://stackoverflow.com/users/1930495/michele-dorigatti"}, "edited": false, "score": 2, "creation_date": 1574274730, "post_id": 58961105, "comment_id": 104177468, "body": "Please, make an effort to fix your spelling mistakes. You wrote &quot;save&quot; instead of &quot;safe&quot; several times. It makes it very hard to read."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 616, "user_id": 1930495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Pirg4.jpg?s=128&g=1", "display_name": "Michele Dorigatti", "link": "https://stackoverflow.com/users/1930495/michele-dorigatti"}, "edited": false, "score": 0, "creation_date": 1574274775, "post_id": 58961105, "comment_id": 104177501, "body": "@MicheleDorigatti They&#39;re not a native English speaker, give them a break."}, {"owner": {"reputation": 391, "user_id": 12081291, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhHvy.png?s=128&g=1", "display_name": "BitFriends", "link": "https://stackoverflow.com/users/12081291/bitfriends"}, "edited": false, "score": 0, "creation_date": 1574274781, "post_id": 58961105, "comment_id": 104177502, "body": "Yeah i know, but i cant explain whats the difference..."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1574274814, "post_id": 58961105, "comment_id": 104177519, "body": "Why do you think there&#39;s a difference in terms of the safety?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1574274850, "post_id": 58961105, "comment_id": 104177537, "body": "<code>gets</code> is a <a href=\"https://stackoverflow.com/questions/1694036/why-is-the-gets-function-so-dangerous-that-it-should-not-be-used\">dangerous</a> function that have been removed from the C specification."}, {"owner": {"reputation": 391, "user_id": 12081291, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhHvy.png?s=128&g=1", "display_name": "BitFriends", "link": "https://stackoverflow.com/users/12081291/bitfriends"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1574274908, "post_id": 58961105, "comment_id": 104177561, "body": "@Barmar because overflowing the buffer doesnt work in the first case. And sorry for my writing mistakes."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1574274924, "post_id": 58961105, "comment_id": 104177571, "body": "@Someprogrammerdude I posted that comment earlier, but I believe he&#39;s using it deliberately to cause a buffer overflow."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1574274988, "post_id": 58961105, "comment_id": 104177602, "body": "@BitFriends What do you mean &quot;doesn&#39;t work&quot;? It causes undefined behavior, so anything can happen. It might appear to work, it might cause a segmentation error, something else could happen."}, {"owner": {"reputation": 391, "user_id": 12081291, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhHvy.png?s=128&g=1", "display_name": "BitFriends", "link": "https://stackoverflow.com/users/12081291/bitfriends"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1574275085, "post_id": 58961105, "comment_id": 104177640, "body": "@Barmar the first one exited completely clean even with overflowing the check char. I ran it with <code>strace</code> and <code>gdb</code>. Nothing."}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1574275125, "post_id": 58961105, "comment_id": 104177666, "body": "Did you try <code>valgrind</code>?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1574275136, "post_id": 58961105, "comment_id": 104177670, "body": "@BitFriends Undefined behavior doesn&#39;t always cause an error."}, {"owner": {"reputation": 391, "user_id": 12081291, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhHvy.png?s=128&g=1", "display_name": "BitFriends", "link": "https://stackoverflow.com/users/12081291/bitfriends"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1574275233, "post_id": 58961105, "comment_id": 104177714, "body": "@Barmar that could be possible. Bunt im just wondering, why those 2 programs acting so &quot;much&quot; different"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1574275259, "post_id": 58961105, "comment_id": 104177727, "body": "Because smashing the stack is different from smashing the data segment."}, {"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1574275286, "post_id": 58961105, "comment_id": 104177738, "body": "It&#39;s really unclear what you&#39;re asking. The arrays in the two versions are susceptible to overflow by gets() so both are unsafe. Voting to close."}], "answers": [{"comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1574274746, "post_id": 58961144, "comment_id": 104177476, "body": "You&#39;re answering the question in the title, not the question in the text."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1574274807, "post_id": 58961144, "comment_id": 104177515, "body": "@Barmar This question is like an onion with layers, apparently."}, {"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1574275819, "post_id": 58961144, "comment_id": 104177988, "body": "@Barmar: &quot;Question body&quot; or simply &quot;body&quot; is more descriptive than &quot;text&quot; in this case."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 1, "last_activity_date": 1574274858, "last_edit_date": 1574274858, "creation_date": 1574274713, "answer_id": 58961144, "question_id": 58961105, "link": "https://stackoverflow.com/questions/58961105/what-is-the-difference-between-char-in-a-function-and-outside-a-function/58961144#58961144", "title": "What is the difference between char in a function and outside a function?", "body": "<p>In the first case you're declaring a global variable. This is generally a bad habit to get into for a multitude of reasons, many of which you'll discover over time, so it's best to never do that unless you have no other option.</p>\n\n<p>The second case makes it local to <code>main()</code>.</p>\n\n<p>Even better is to make a function that performs the get-assign operation and returns <code>char*</code>.</p>\n\n<p>It's worth noting that in both cases <strong>nothing about this program is safe</strong> as you're using a comically tiny buffer (16 bytes!) and never use a function that's buffer-length limited. <code>gets</code> is one of the worst to use. Consider something else, anything else, even <code>scanf('%15s', &amp;check)</code>.</p>\n\n<p>Moving the buffer from one location to another doesn't make it any safer. The problem is with the buffer and how it's used.</p>\n"}], "owner": {"reputation": 391, "user_id": 12081291, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhHvy.png?s=128&g=1", "display_name": "BitFriends", "link": "https://stackoverflow.com/users/12081291/bitfriends"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "closed_date": 1574275284, "accepted_answer_id": 58961144, "answer_count": 1, "score": 0, "last_activity_date": 1574274886, "creation_date": 1574274532, "last_edit_date": 1574274886, "question_id": 58961105, "link": "https://stackoverflow.com/questions/58961105/what-is-the-difference-between-char-in-a-function-and-outside-a-function", "closed_reason": "Duplicate", "title": "What is the difference between char in a function and outside a function?", "body": "<p>Ive got 2 example codes, one is safe against buffer overflows even compiled with\n<code>gcc -fno-stack-protector -fno-pie -m32 save.c -o save</code></p>\n\n<p>Code of safe program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nchar check[16];\n\nint main(int argc, char **argv) {\n    printf(\"Enter a string: \");\n    gets(check);\n    printf(\"%s\\n\", check);\n    printf(\"Accepted.\\n\");\n\n}\n</code></pre>\n\n<p>Code of unsafe (vulnerable) program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(int argc, char **argv) {\n    char check[16];\n    printf(\"Enter a string: \");\n    gets(check);\n    printf(\"%s\\n\", check);\n    printf(\"Accepted.\\n\");\n\n}\n\n</code></pre>\n\n<p>Why is the char outside the program \"safe\"? (in my case)</p>\n"}, {"tags": ["c", "gtk", "gtk3", "glade"], "answers": [{"tags": [], "owner": {"reputation": 746, "user_id": 12126234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b10a7b87642cedea860405eebe2625b2?s=128&d=identicon&r=PG&f=1", "display_name": "lb90", "link": "https://stackoverflow.com/users/12126234/lb90"}, "is_accepted": true, "score": 1, "last_activity_date": 1574284737, "creation_date": 1574284737, "answer_id": 58963544, "question_id": 58961074, "link": "https://stackoverflow.com/questions/58961074/gtk-list-store-clear-function-raises-segmentation-fault-in-c/58963544#58963544", "title": "gtk_list_store_clear() function raises Segmentation Fault in C", "body": "<p>If you destroy the builder object (using <code>g_object_unref(builder)</code>) before the signal handler runs, liststore2 may point to freed memory.</p>\n\n<p>That happens if liststore2 is free-standing (i.e., not ref'ed by something else, for example a GtkTreeView)</p>\n\n<p><a href=\"https://developer.gnome.org/gtk3/unstable/GtkBuilder.html#gtk-builder-get-object\" rel=\"nofollow noreferrer\">gtk_builder_get_object</a> does <em>not</em> increment the reference count on object</p>\n"}], "owner": {"reputation": 142, "user_id": 9074013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/871d942d9a9381ac63801631c6a10ada?s=128&d=identicon&r=PG&f=1", "display_name": "NodeJS", "link": "https://stackoverflow.com/users/9074013/nodejs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 335, "favorite_count": 0, "accepted_answer_id": 58963544, "answer_count": 1, "score": 1, "last_activity_date": 1574284737, "creation_date": 1574274395, "question_id": 58961074, "link": "https://stackoverflow.com/questions/58961074/gtk-list-store-clear-function-raises-segmentation-fault-in-c", "title": "gtk_list_store_clear() function raises Segmentation Fault in C", "body": "<p>I am writing a program using GTK in C. \nI am using GtkListStore to display some data coming from a database.\nAfter a particular signal I want to remove all the rows in the GtkListStore.\nI used gtk_list_store_clear() function, but it raises Segmentation Fault.</p>\n\n<p>What is wrong with my code?</p>\n\n<pre><code>//Globally declared\nGtkListStore *liststore2;\n\n//Inside main() function\nliststore2 = GTK_LIST_STORE(gtk_builder_get_object(builder, \"liststore2\"));\n\n//Inside signal handler function\ngtk_list_store_clear(liststore2); //Error comes from here\n</code></pre>\n"}, {"tags": ["c", "arrays", "integer", "scanf"], "comments": [{"owner": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1574274224, "post_id": 58961026, "comment_id": 104177244, "body": "why are you not using any c++ when this is supposed to be c++?"}, {"owner": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1574274344, "post_id": 58961026, "comment_id": 104177297, "body": "coincidentally your code is valid C but not valid C++. <code>int a[N];</code> is a variable lenght array, C has them, C++ not"}, {"owner": {"reputation": 996, "user_id": 5824979, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/5i5yH.jpg?s=128&g=1", "display_name": "Sailanarmo", "link": "https://stackoverflow.com/users/5824979/sailanarmo"}, "edited": false, "score": 0, "creation_date": 1574274444, "post_id": 58961026, "comment_id": 104177334, "body": "As these two have pointed out. There is no C++ here. This is C. Consider changing your tag to reflect the correct language."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1574274515, "post_id": 58961026, "comment_id": 104177363, "body": "You are using C++, so use <code>getline()</code> to read an entire line of values, then create a <code>stringstream ss (line)</code> and use <code>&gt;&gt;</code> to read <code>int</code> values from the stringstream. (if it is just an unknown number of <code>int</code> in a single line, skip the stringstream). <i>Validate</i> each read."}, {"owner": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 996, "user_id": 5824979, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/5i5yH.jpg?s=128&g=1", "display_name": "Sailanarmo", "link": "https://stackoverflow.com/users/5824979/sailanarmo"}, "edited": false, "score": 0, "creation_date": 1574274537, "post_id": 58961026, "comment_id": 104177373, "body": "@Sailanarmo if it is compiled with a c++ compiler then it is c++ by definition, only OP can know what language they are targeting"}, {"owner": {"reputation": 996, "user_id": 5824979, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/5i5yH.jpg?s=128&g=1", "display_name": "Sailanarmo", "link": "https://stackoverflow.com/users/5824979/sailanarmo"}, "reply_to_user": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1574274747, "post_id": 58961026, "comment_id": 104177477, "body": "@formerlyknownas_463035818 I am not sure I agree with that. C and C++ are two different languages. C++ can compile C but to say C code suddenly becomes C++ code just because you compile it with a C++ compiler doesn&#39;t make it C++ code."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1574274794, "post_id": 58961026, "comment_id": 104177508, "body": "30 years ago C++ was a superset of C. (now they are completely different animals)"}, {"owner": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 996, "user_id": 5824979, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/5i5yH.jpg?s=128&g=1", "display_name": "Sailanarmo", "link": "https://stackoverflow.com/users/5824979/sailanarmo"}, "edited": false, "score": 1, "creation_date": 1574274877, "post_id": 58961026, "comment_id": 104177549, "body": "@Sailanarmo no. C++ cannot compile C. There is a small subset that is correct code in both and apart from the VLA (which exists in gcc as non-standard extension also in C++) this code belongs to that subset afaik, hence only OP can know what they use to compile it"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1574282746, "post_id": 58961026, "comment_id": 104181260, "body": "There is a subset that is correct in both and <b>only a subset of that subset has the same <i>behaviour</i> in both</b>."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1574282823, "post_id": 58961026, "comment_id": 104181296, "body": "This is neither nor, it is not proper standard C++."}], "answers": [{"tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": true, "score": 0, "last_activity_date": 1574276651, "creation_date": 1574276651, "answer_id": 58961616, "question_id": 58961026, "link": "https://stackoverflow.com/questions/58961026/how-to-fscaf-unknown-number-of-integers-into-an-array/58961616#58961616", "title": "How to fscaf unknown number of integers into an array", "body": "<p>Unless you cannot use containers from STL, like <a href=\"https://en.cppreference.com/w/cpp/container/vector\" rel=\"nofollow noreferrer\"><code>std::vector</code></a>, you will make like much easier and less error prone by using them. Here, while you can read the first value <code>N</code>, it isn't needed when you use a <code>std::vector</code> for storage. The STL containers handle required storage automatically, so all you really care about is reading the actual data values from the file and then using the <code>.push_back()</code> member function to add the values to your vector.</p>\n\n<p>Do not <em>Hardcode Filenames</em> in your code. That is what the arguments to <code>int main (int argc, char **argv)</code> are for (or you can take the filename as input). For example you could do:</p>\n\n<pre><code>int main (int argc, char **argv) {\n\n    int N, tmp;             /* int N and temporary int to use filling vector */\n    std::vector&lt;int&gt; v;     /* vector of int */\n\n    if (argc &lt; 2) { /* valdate 1 argument given for filename */\n        std::cerr &lt;&lt; \"usage: \" &lt;&lt; argv[0] &lt;&lt; \" filename\\n\";\n        return 1;\n    }\n    std::ifstream f (argv[1]);  /* open file */\n\n    if (!f.good()) {    /* validate file open */\n        std::cerr &lt;&lt; \"error: file open failed.\\n\";\n        return 1;\n    }\n</code></pre>\n\n<p>No need to hardcode your filename, just pass it as an argument to <code>main()</code>.</p>\n\n<p>With your file open, in its simplest form, you can simply use the overloaded <code>&gt;&gt;</code> stream operator to read values from your file. You must <strong><em>validate</em></strong> every read to ensure a stray non-digit character does cause a matching failure and set a failed stream state on your input stream. For example to check if the read of <code>N</code> is good (not bad here), you could do:</p>\n\n<pre><code>    if (!(f &gt;&gt; N)) {    /* read/validate N */\n        std::cerr &lt;&lt; \"error: invalid integer input - N.\\n\";\n        return 1;\n    }\n</code></pre>\n\n<p>Since the intent was to exit unless the read was good, the <code>!(f &gt;&gt; N)</code> form was used. (this also reduces the levels of indention you build into your code). You could have done:</p>\n\n<pre><code>    if (f &gt;&gt; N) {    /* read/validate N */\n        /* rest of your code goes here on good read */\n    }\n</code></pre>\n\n<p>The validation is the same, but in the first case we exit on a failure to read <code>N</code>, in the second, we just do not enter the block enclosing the rest of our code (which is now shifted with one more layer of indention to the right...)</p>\n\n<p>Reading the rest of the values and filling your vector is just a matter of reading into your temporary values <code>tmp</code> in the same manner and then after confirming a good read, you simply add the value to your vector using the <code>.push_back()</code> member function, e.g.</p>\n\n<pre><code>    while (f &gt;&gt; tmp)    /* read remaining int values into vector v */\n        v.push_back(tmp);\n</code></pre>\n\n<p>(<strong>note:</strong> reading numeric values all <em>whitespace</em> is ignored. That means whether you have 1-line or 1000-lines of integer values remaining in the file -- all will be read into your vector. All <code>'\\n'</code> are simply ignored since a <code>'\\n'</code> is <em>whitespace</em>. This is where you use <code>getline()</code> and a <code>std::stringstream</code> if you need to read only values in a single line)</p>\n\n<p>Reading the first <code>N</code> is only good for comparing with the <code>.size()</code> of the vector which you can now use to confirm you have read <code>N</code> values into your vector, e.g.</p>\n\n<pre><code>    if (v.size() != (size_t)N) {    /* valdate .size() == N */\n        std::cerr &lt;&lt; \"error: number read does not equal N.\\n\";\n        return 1;\n    }\n</code></pre>\n\n<p>You can do whatever you like with the values in your vector <code>v</code>. Here they are simply output using a <em>range-based</em> for loop and repurposing <code>tmp</code> as a counter to output the index as well:</p>\n\n<pre><code>    tmp = 0;\n    for (auto&amp; n : v)   /* loop over all values in v outputting */\n        std::cout &lt;&lt; \"v[\" &lt;&lt; tmp++ &lt;&lt; \"] : \" &lt;&lt; n &lt;&lt; '\\n';\n</code></pre>\n\n<p>Putting it altogether, you could do:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;vector&gt;\n\nint main (int argc, char **argv) {\n\n    int N, tmp;             /* int N and temporary int to use filling vector */\n    std::vector&lt;int&gt; v;     /* vector of int */\n\n    if (argc &lt; 2) { /* valdate 1 argument given for filename */\n        std::cerr &lt;&lt; \"usage: \" &lt;&lt; argv[0] &lt;&lt; \" filename\\n\";\n        return 1;\n    }\n    std::ifstream f (argv[1]);  /* open file */\n\n    if (!f.good()) {    /* validate file open */\n        std::cerr &lt;&lt; \"error: file open failed.\\n\";\n        return 1;\n    }\n\n    if (!(f &gt;&gt; N)) {    /* read/validate N */\n        std::cerr &lt;&lt; \"error: invalid integer input - N.\\n\";\n        return 1;\n    }\n\n    while (f &gt;&gt; tmp)    /* read remaining int values into vector v */\n        v.push_back(tmp);\n\n    if (v.size() != (size_t)N) {    /* valdate .size() == N */\n        std::cerr &lt;&lt; \"error: number read does not equal N.\\n\";\n        return 1;\n    }\n\n    tmp = 0;\n    for (auto&amp; n : v)   /* loop over all values in v outputting */\n        std::cout &lt;&lt; \"v[\" &lt;&lt; tmp++ &lt;&lt; \"] : \" &lt;&lt; n &lt;&lt; '\\n';\n}\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<p>With your data in the file <code>dat/nint.txt</code>, you would use the program as follows generating the following output:</p>\n\n<pre><code>$ ./bin/readnint dat/nint.txt\nv[0] : 4\nv[1] : 7\nv[2] : 9\nv[3] : 2\nv[4] : 1\n</code></pre>\n\n<p>Moral of the story -- <em>Do Not Use</em> <code>scanf</code>. It is so full of pitfalls for the new C/C++ programmer, and its improper use generates so many questions on this site it would be tantamount to <em>programming-malpractice</em> to suggest a <code>scanf</code> solution. Look things over and let me know if you have further questions.</p>\n"}], "owner": {"reputation": 3, "user_id": 12405674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b1d608cefdcf04d709a10431e4055c6?s=128&d=identicon&r=PG&f=1", "display_name": "ariad", "link": "https://stackoverflow.com/users/12405674/ariad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 58961616, "answer_count": 1, "score": 0, "last_activity_date": 1574277187, "creation_date": 1574274174, "last_edit_date": 1574277187, "question_id": 58961026, "link": "https://stackoverflow.com/questions/58961026/how-to-fscaf-unknown-number-of-integers-into-an-array", "title": "How to fscaf unknown number of integers into an array", "body": "<p>I am reading a text file from standard input that have the following form:</p>\n\n<p><strong>5</strong></p>\n\n<p><strong>4</strong> <strong>7</strong> <strong>9</strong> <strong>2</strong> <strong>1</strong></p>\n\n<p>where the first row is the size of the array I want to create each time and in the second row are the elements</p>\n\n<p>So far I have this</p>\n\n<pre><code>int main()\n{\n  int N;\n  int i;\n  FILE *fp;\n  const char *mode=\"r\";\n  fp=fopen(\"input.txt\", \"r\");\n\n  if((fp=fopen(\"input.txt\", \"r\"))==NULL) {\n    printf(\"Error opening file %s\\n\");\n    return -1;\n  }\n\n  fscanf(fp, \"%d\", &amp;N);\n\n  int a[N];\n  int n;\n\n  while (fscanf(fp, \"%d %n\", &amp;a[i], &amp;n) == 1){\n    i++;\n    fp += n;\n  }\n\n  fclose(fp);\n  return 0;\n}\n\n</code></pre>\n\n<p>It reads the file but it doesnt store the correct values</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 4, "creation_date": 1574273970, "post_id": 58960920, "comment_id": 104177116, "body": "<code>char *s</code> is pointing to nowhere in <code>anybase</code>, <code>strcpy(s,&quot;&quot;);</code> is going to fail. You need to allocate memory for it."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1574274116, "post_id": 58960920, "comment_id": 104177190, "body": "You <i>must</i> return a value from the function: the recursing function and <code>main</code> both need it."}, {"owner": {"reputation": 107, "user_id": 12405796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf818a9dd7a3ba9b67abd3ab11127158?s=128&d=identicon&r=PG&f=1", "display_name": "user526427", "link": "https://stackoverflow.com/users/12405796/user526427"}, "edited": false, "score": 0, "creation_date": 1574274691, "post_id": 58960920, "comment_id": 104177449, "body": "strcpy is not the problem"}, {"owner": {"reputation": 107, "user_id": 12405796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf818a9dd7a3ba9b67abd3ab11127158?s=128&d=identicon&r=PG&f=1", "display_name": "user526427", "link": "https://stackoverflow.com/users/12405796/user526427"}, "edited": false, "score": 0, "creation_date": 1574274724, "post_id": 58960920, "comment_id": 104177467, "body": "adding return to both anybase() and main() don&#39;t seem to avoid the seg fault"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 2, "creation_date": 1574275144, "post_id": 58960920, "comment_id": 104177676, "body": "@user526427 Perhaps it fails at some other point, the main problem remains, that <code>char *s</code> does not point to a valid memory location. So your program is working under undefined behaviour: that means, sometimes crashes, sometimes it doesn&#39;t."}], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 12405796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf818a9dd7a3ba9b67abd3ab11127158?s=128&d=identicon&r=PG&f=1", "display_name": "user526427", "link": "https://stackoverflow.com/users/12405796/user526427"}, "edited": false, "score": 0, "creation_date": 1574287528, "post_id": 58961347, "comment_id": 104183266, "body": "not sure if one has to malloc - would defining char *s outside of the function anybase() work? making it a global variable and assign a value would sure give it some allocated memory location, right?"}, {"owner": {"reputation": 378, "user_id": 2620017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/517078d0e5e19b98b4b8c7228da5aadf?s=128&d=identicon&r=PG", "display_name": "hko", "link": "https://stackoverflow.com/users/2620017/hko"}, "reply_to_user": {"reputation": 107, "user_id": 12405796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf818a9dd7a3ba9b67abd3ab11127158?s=128&d=identicon&r=PG&f=1", "display_name": "user526427", "link": "https://stackoverflow.com/users/12405796/user526427"}, "edited": false, "score": 0, "creation_date": 1574302905, "post_id": 58961347, "comment_id": 104187478, "body": "@user526427 check out my answer. It doesn&#39;t use malloc inside of your anybase function."}], "tags": [], "owner": {"reputation": 45031, "user_id": 213136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b84a36c241e04175fcec402dac43018?s=128&d=identicon&r=PG", "display_name": "Bob Jarvis - Reinstate Monica", "link": "https://stackoverflow.com/users/213136/bob-jarvis-reinstate-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1574275557, "creation_date": 1574275557, "answer_id": 58961347, "question_id": 58960920, "link": "https://stackoverflow.com/questions/58960920/c-programming-recursion-question-generating-segfault/58961347#58961347", "title": "C programming recursion question generating segfault", "body": "<p>You were pretty much there, except you never allocated any memory for the string you're trying to produce. Here's a version which (apparently) runs correctly:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nchar* anybase(int n, int b)\n  {\n  char *s;\n  int len;\n\n  if(n == 0)\n    {\n    s = malloc(200);\n    s[0] = '\\0';\n    }\n  else\n    {\n    s = anybase(n/b, b);\n\n    len=strlen(s);\n    s[len] = \"0123456789ABCEDFGHIGKLMNOPQRSTUVWXYZ\"[n%b];\n    s[len+1]='\\0';\n    }\n\n  return s;\n  }\n\nint main()\n  {\n  char *result;\n\n  result = anybase(900000, 18);\n  printf(\"%s\\n\", result);\n\n  free(result);\n  }\n</code></pre>\n\n<p>Note that since the buffer returned by <code>anybase</code> is allocated dynamically (using the <code>malloc</code> library function) it must be free'd after use.</p>\n"}, {"comments": [{"owner": {"reputation": 107, "user_id": 12405796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf818a9dd7a3ba9b67abd3ab11127158?s=128&d=identicon&r=PG&f=1", "display_name": "user526427", "link": "https://stackoverflow.com/users/12405796/user526427"}, "edited": false, "score": 0, "creation_date": 1574279097, "post_id": 58961707, "comment_id": 104179570, "body": "Thanks. What if I want to avoid using malloc/calloc at all?"}, {"owner": {"reputation": 326, "user_id": 8157105, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/A1A9a.jpg?s=128&g=1", "display_name": "Alex Hoffmann", "link": "https://stackoverflow.com/users/8157105/alex-hoffmann"}, "reply_to_user": {"reputation": 107, "user_id": 12405796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf818a9dd7a3ba9b67abd3ab11127158?s=128&d=identicon&r=PG&f=1", "display_name": "user526427", "link": "https://stackoverflow.com/users/12405796/user526427"}, "edited": false, "score": 0, "creation_date": 1574340722, "post_id": 58961707, "comment_id": 104203943, "body": "Then I would reccomend modifying your function <code>anybase</code> to accept a <code>char *</code> to a statically allocated char array in your main. You will no longer need to return the string as it will be passed through to each function call. I will edit my answer to do so."}], "tags": [], "owner": {"reputation": 326, "user_id": 8157105, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/A1A9a.jpg?s=128&g=1", "display_name": "Alex Hoffmann", "link": "https://stackoverflow.com/users/8157105/alex-hoffmann"}, "is_accepted": false, "score": 1, "last_activity_date": 1574340753, "last_edit_date": 1574340753, "creation_date": 1574277076, "answer_id": 58961707, "question_id": 58960920, "link": "https://stackoverflow.com/questions/58960920/c-programming-recursion-question-generating-segfault/58961707#58961707", "title": "C programming recursion question generating segfault", "body": "<p>The string buffer can be created statically in the main function but must then be passed to each recursive function call such that it can be written in to.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define BUFFER_SIZE 200\nconst char *selection = \"0123456789ABCEDFGHIGKLMNOPQRSTUVWXYZ\";\n\nvoid anybase(int n, int b, char *s)\n{\n    if (n) {\n        anybase(n / b, b, s);\n\n        strncat(&amp;s[strlen(s)], &amp;selection[n % b], sizeof(char));\n        printf(\"%s, %d, %d\\n\", s, n, b);\n    }\n}\n\nint main()\n{\n    char buf[BUFFER_SIZE];\n    memset(buf, 0, sizeof(char) * BUFFER_SIZE);\n\n    anybase(900000, 18, buf);\n    printf(\"Ouput: %s, N: %d, B: %d\\n\", buf, 90000, 18);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 107, "user_id": 12405796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf818a9dd7a3ba9b67abd3ab11127158?s=128&d=identicon&r=PG&f=1", "display_name": "user526427", "link": "https://stackoverflow.com/users/12405796/user526427"}, "edited": false, "score": 0, "creation_date": 1574279475, "post_id": 58962186, "comment_id": 104179745, "body": "i saw this version of the code and not sure why it can&#39;t be using some return values. That&#39;s why i posted the first question"}, {"owner": {"reputation": 378, "user_id": 2620017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/517078d0e5e19b98b4b8c7228da5aadf?s=128&d=identicon&r=PG", "display_name": "hko", "link": "https://stackoverflow.com/users/2620017/hko"}, "reply_to_user": {"reputation": 107, "user_id": 12405796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf818a9dd7a3ba9b67abd3ab11127158?s=128&d=identicon&r=PG&f=1", "display_name": "user526427", "link": "https://stackoverflow.com/users/12405796/user526427"}, "edited": false, "score": 1, "creation_date": 1574280577, "post_id": 58962186, "comment_id": 104180292, "body": "The reason why s is not a return value but an argument is because you want to pass in the array from outside. If you define the array inside your function it will be lost because of its scope.  You could of course add a return value, but not sure what you would use it for."}], "tags": [], "owner": {"reputation": 378, "user_id": 2620017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/517078d0e5e19b98b4b8c7228da5aadf?s=128&d=identicon&r=PG", "display_name": "hko", "link": "https://stackoverflow.com/users/2620017/hko"}, "is_accepted": false, "score": 1, "last_activity_date": 1574302791, "last_edit_date": 1574302791, "creation_date": 1574279036, "answer_id": 58962186, "question_id": 58960920, "link": "https://stackoverflow.com/questions/58960920/c-programming-recursion-question-generating-segfault/58962186#58962186", "title": "C programming recursion question generating segfault", "body": "<p>As others mentioned the issue is <code>s</code> is just a pointer that points to no where.\nBut instead of allocating memory for <code>s</code> inside of your anybase function a better approach is to allocate the memory in the main function. This avoids possible memory leaks when calling the function multiple times.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nvoid anybase(int n, int b, char* s)\n{\n    int len;\n    if(n==0) {strcpy(s,\"\"); return;}\n\n    anybase(n/b, b, s);\n\n    len=strlen(s);\n    s[len] = \"0123456789ABCEDFGHIGKLMNOPQRSTUVWXYZ\"[n%b];\n    s[len+1]='\\0';\n    printf (\"%s, %d, %d\\n\", s, n, b);\n    printf(\"%d\\n\", len +1);\n    return;\n}\nint main(){\n    char s[33]; /* enough for all ints with base 2 */\n    anybase(90000, 18, s);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 12405796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf818a9dd7a3ba9b67abd3ab11127158?s=128&d=identicon&r=PG&f=1", "display_name": "user526427", "link": "https://stackoverflow.com/users/12405796/user526427"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1574340753, "creation_date": 1574273797, "last_edit_date": 1574273904, "question_id": 58960920, "link": "https://stackoverflow.com/questions/58960920/c-programming-recursion-question-generating-segfault", "title": "C programming recursion question generating segfault", "body": "<p>trying to convert any number to any base in a recursion with C:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nchar* anybase(int n, int b)\n{\n\n   char * s;\n   int len;\n\n   if(n==0) {strcpy(s,\"\"); return s;}\n\n   s = anybase(n/b, b);\n\n   len=strlen(s);\n   s[len] = \"0123456789ABCEDFGHIGKLMNOPQRSTUVWXYZ\"[n%b];\n   s[len+1]='\\0';\nprintf (\"%s, %d, %d\\n\", s, n, b);\n\n/*   return s; */\n\n\n}\nint main(){\n\nchar *s;\n\ns = anybase(900000, 18);\n/*printf (\"%s, %d, %d\\n\", anybase(90000, 18), 90000, 18);*/\n\n}\n</code></pre>\n\n<p>is it the recursion having a problem? not sure why one can't return a value in the function call. what would be needed to call this recursion function and return a value instead of void.</p>\n\n<p>Why is it generating seg fault each time running it? Thanks!</p>\n"}, {"tags": ["c", "recursion"], "comments": [{"owner": {"reputation": 7239, "user_id": 12361700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/287854d44d93bab6658abf2d547578cc?s=128&d=identicon&r=PG&f=1", "display_name": "Berto99", "link": "https://stackoverflow.com/users/12361700/berto99"}, "edited": false, "score": 0, "creation_date": 1574273903, "post_id": 58960864, "comment_id": 104177082, "body": "when does it increment? it just never change its value"}], "answers": [{"tags": [], "owner": {"reputation": 200780, "user_id": 116908, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54d38793d7a407446999b33b81d607fd?s=128&d=identicon&r=PG", "display_name": "Carl Norum", "link": "https://stackoverflow.com/users/116908/carl-norum"}, "is_accepted": false, "score": 1, "last_activity_date": 1574273906, "creation_date": 1574273906, "answer_id": 58960948, "question_id": 58960864, "link": "https://stackoverflow.com/questions/58960864/im-studying-recursion-functions-in-c-for-the-very-first-time-i-tried-to-debug/58960948#58960948", "title": "I&#39;m studying recursion functions in C for the very first time. I tried to debug the function below and it&#39;s all clear except the index grow of n", "body": "<p>Each recursive function call has <em>its own</em> <code>n</code>. The calling level's <code>n</code> isn't affected by the changes made at the lower recursive calls. So when the lower call returns, the caller's <code>n</code> is unmodified.</p>\n"}, {"tags": [], "owner": {"reputation": 10901, "user_id": 578749, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/40231a11da5f1c627fd21d6700edddff?s=128&d=identicon&r=PG", "display_name": "lvella", "link": "https://stackoverflow.com/users/578749/lvella"}, "is_accepted": false, "score": 0, "last_activity_date": 1574274988, "last_edit_date": 1574274988, "creation_date": 1574274164, "answer_id": 58961022, "question_id": 58960864, "link": "https://stackoverflow.com/questions/58960864/im-studying-recursion-functions-in-c-for-the-very-first-time-i-tried-to-debug/58961022#58961022", "title": "I&#39;m studying recursion functions in C for the very first time. I tried to debug the function below and it&#39;s all clear except the index grow of n", "body": "<p>You are mixing up multiple different <code>n</code> variables. Variable <code>n == 5</code> still exists when variable <code>n == 4</code> is created, and ceases to exist after <code>n == 4</code> is destroyed.</p>\n\n<p>As with every function call, the variables for the called function are created on entry and deleted on return. So, each time the recursive function is invoked, all its local variables are created again for that invocation. They are not shared between different invocations just because the function happens to be the same.</p>\n\n<p>For a variable to be shared between all the invocations of a function call, it must be <code>static</code>, but function arguments like <code>n</code> can not be <code>static</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 12405716, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBbVGrbPOwF-AJUicYxXkZmjLIpZCePRxvFTtENcg=k-s128", "display_name": "Giuseppe Fiorella", "link": "https://stackoverflow.com/users/12405716/giuseppe-fiorella"}, "edited": false, "score": 0, "creation_date": 1574284917, "post_id": 58961044, "comment_id": 104182221, "body": "Ok so basically it&#39;s not 1 function at work but 5 (ideally tho) and everytime the cycle returns something it&#39;s like one of the function can stop working and focus on the new function with the new value (returning the value in base of the code) . So basically when n is equal 1 the function returns  *(p+0). Once the cycle of the function with n=1 ends with the return , the cycle-function with n=2 starts working with the new value and so on . Is that right?"}, {"owner": {"reputation": 7239, "user_id": 12361700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/287854d44d93bab6658abf2d547578cc?s=128&d=identicon&r=PG&f=1", "display_name": "Berto99", "link": "https://stackoverflow.com/users/12361700/berto99"}, "reply_to_user": {"reputation": 23, "user_id": 12405716, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBbVGrbPOwF-AJUicYxXkZmjLIpZCePRxvFTtENcg=k-s128", "display_name": "Giuseppe Fiorella", "link": "https://stackoverflow.com/users/12405716/giuseppe-fiorella"}, "edited": false, "score": 0, "creation_date": 1574285492, "post_id": 58961044, "comment_id": 104182431, "body": "yes, start the first one (with n=2) , does what it has to do, arrives to the recursive call,  which will be managed as a normal function call, so it stops, starts the function called by the recursive call (with n=1 ), which it&#39;s stopped immediatly because the first if condition is true, so it returns the int, and then the other function call  (with n=2) that has called this one that as just return, &#39;restarts&#39;. if you have more than 2 calls, the the reasoning is the same, but the first part is repeated many time and then the last also is repated many times"}], "tags": [], "owner": {"reputation": 7239, "user_id": 12361700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/287854d44d93bab6658abf2d547578cc?s=128&d=identicon&r=PG&f=1", "display_name": "Berto99", "link": "https://stackoverflow.com/users/12361700/berto99"}, "is_accepted": true, "score": 0, "last_activity_date": 1574274272, "creation_date": 1574274272, "answer_id": 58961044, "question_id": 58960864, "link": "https://stackoverflow.com/questions/58960864/im-studying-recursion-functions-in-c-for-the-very-first-time-i-tried-to-debug/58961044#58961044", "title": "I&#39;m studying recursion functions in C for the very first time. I tried to debug the function below and it&#39;s all clear except the index grow of n", "body": "<p>The <code>n</code> variable never change because each function call has its ows <code>n</code>... you are seeing a 'increasing of <code>n</code>' because you have to remember that a function call also do a rollback from the last, where n==1, to the first, where n==5, so if you print n after the recursive call, you will see 1->2->3->4->5 just because the function are doing a rollback of the recursive calls</p>\n"}, {"tags": [], "owner": {"reputation": 1203, "user_id": 5872193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9839edfacb5837e124d10164cdc0c558?s=128&d=identicon&r=PG&f=1", "display_name": "Honza Reme\u0161", "link": "https://stackoverflow.com/users/5872193/honza-reme%c5%a1"}, "is_accepted": false, "score": 0, "last_activity_date": 1574274542, "creation_date": 1574274542, "answer_id": 58961107, "question_id": 58960864, "link": "https://stackoverflow.com/questions/58960864/im-studying-recursion-functions-in-c-for-the-very-first-time-i-tried-to-debug/58961107#58961107", "title": "I&#39;m studying recursion functions in C for the very first time. I tried to debug the function below and it&#39;s all clear except the index grow of n", "body": "<p>Every time a function is called, a part of the computer's memory (RAM) is reserved for <em>the instance</em> of the called function. The part of the memory is called a <em>stack</em> and the portion reserved for the function instance is called a <em>stack frame</em>.</p>\n\n<p>Instance-specific data (like function parameters and variables) are stored in the stack frame.</p>\n\n<p>When another function is called (or even the same function again), a new stack frame is created and the new function instance stores its data there. When it returns, the original function instance resumes execution <em>(note that there is more code after the <code>int m = minimum(p,n-1);</code> line, which needs to get executed at some point)</em> in its own stack frame, retaining the values of the parameters and variables.</p>\n"}], "owner": {"reputation": 23, "user_id": 12405716, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBbVGrbPOwF-AJUicYxXkZmjLIpZCePRxvFTtENcg=k-s128", "display_name": "Giuseppe Fiorella", "link": "https://stackoverflow.com/users/12405716/giuseppe-fiorella"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 58961044, "answer_count": 4, "score": 0, "last_activity_date": 1574284624, "creation_date": 1574273551, "last_edit_date": 1574284624, "question_id": 58960864, "link": "https://stackoverflow.com/questions/58960864/im-studying-recursion-functions-in-c-for-the-very-first-time-i-tried-to-debug", "title": "I&#39;m studying recursion functions in C for the very first time. I tried to debug the function below and it&#39;s all clear except the index grow of n", "body": "<pre class=\"lang-c prettyprint-override\"><code>int minimum(int *p,int n){\n\n    if (n==1)\n        return *(p+0);\n    int m = minimum(p,n-1);\n    if (m&lt;*(p+(n-1)))\n            return m;\n    return *(p+(n-1));\n\n}\n</code></pre>\n\n<p>The function checks all the values of an array and it returns the lowest value. \nfor example A[n]={1,2,3,4,5} it returns 1 </p>\n\n<p>considering n = 5 for example during the execution n goes from 5 to 1 until it goes into the first if ( if (n==1) ) and it returns the value of the first cell of the array p . After the first recall of the function the function itself keeps going ofc and it goes to the next if -->   if (m&lt;*(p+(n-1)))</p>\n\n<p>Alright if i now check the  n value it is 2 and then 3 and 4 and 5 so it reaches the end of the array controllying if there's a value lower than the previous one. </p>\n\n<p>I do understand why n goes from 5 to 1 , but how does it goes from 1 to 5?? How the value of n grows if there's no increase ? i tested the function with a random array and it works completely fine . </p>\n\n<p><em>Updated</em> What i understood by your answers is this : </p>\n\n<p>Ok so basically it's not 1 function at work but 5 (ideally tho) and everytime the cycle returns something it's like one of the function can stop working and focus on the new function with the new value (returning the value in base of the code) . So basically when n is equal 1 the function returns  *(p+0). Once the cycle of the function with n=1 ends with the return , the cycle-function with n=2 starts working with the new value and so on . Is that right?</p>\n"}, {"tags": ["c", "asynchronous", "node.js-addon", "n-api"], "answers": [{"comments": [{"owner": {"reputation": 104, "user_id": 1854983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c9c8f27d98e516acecfa23b07b1eb1d?s=128&d=identicon&r=PG", "display_name": "user1854983", "link": "https://stackoverflow.com/users/1854983/user1854983"}, "edited": false, "score": 2, "creation_date": 1608238820, "post_id": 58960856, "comment_id": 115530164, "body": "Updated Link: <a href=\"https://github.com/nodejs/node-addon-examples/blob/master/async_work_thread_safe_function/napi/binding.c\" rel=\"nofollow noreferrer\">github.com/nodejs/node-addon-examples/blob/master/&hellip;</a>"}], "tags": [], "owner": {"reputation": 695, "user_id": 4925067, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/47A2p.jpg?s=128&g=1", "display_name": "Frederik Petersen", "link": "https://stackoverflow.com/users/4925067/frederik-petersen"}, "is_accepted": false, "score": 2, "last_activity_date": 1608323789, "last_edit_date": 1608323789, "creation_date": 1574273495, "answer_id": 58960856, "question_id": 58960713, "link": "https://stackoverflow.com/questions/58960713/how-to-use-napi-threadsafe-function-for-nodejs-native-addon/58960856#58960856", "title": "How to use napi_threadsafe_function for NodeJS Native Addon", "body": "<p>If anyone else gets stuck with this issue. I finally managed to hunt down an example <a href=\"https://github.com/nodejs/node-addon-examples/blob/master/async_work_thread_safe_function/napi/binding.c\" rel=\"nofollow noreferrer\">here</a>.</p>\n<p>Once I understand it better and have gotten a working sample, I will update here. Hopefully someone needing this in the future will have an easier time than me.</p>\n<p>See Satyan's answer</p>\n"}, {"comments": [{"owner": {"reputation": 695, "user_id": 4925067, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/47A2p.jpg?s=128&g=1", "display_name": "Frederik Petersen", "link": "https://stackoverflow.com/users/4925067/frederik-petersen"}, "edited": false, "score": 0, "creation_date": 1575355840, "post_id": 59130984, "comment_id": 104528106, "body": "I really appreciate the detailed answer. Thank you for taking the time to help out @satyan!"}], "tags": [], "owner": {"reputation": 1014, "user_id": 2157864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rjwPF.jpg?s=128&g=1", "display_name": "Satyan", "link": "https://stackoverflow.com/users/2157864/satyan"}, "is_accepted": true, "score": 5, "last_activity_date": 1575262561, "last_edit_date": 1575262561, "creation_date": 1575243240, "answer_id": 59130984, "question_id": 58960713, "link": "https://stackoverflow.com/questions/58960713/how-to-use-napi-threadsafe-function-for-nodejs-native-addon/59130984#59130984", "title": "How to use napi_threadsafe_function for NodeJS Native Addon", "body": "<p>As a summery tag we may say, the <strong>N-API ThreadSafeFunctions acts as a safe tunnel between the asynchronous C/C++ code executing on a worker thread and the JavaScript layer for information exchange</strong>.</p>\n\n<p>Before going technical let us consider a scenario that we have a very long running process heavy task to be completed. We all know putting this task on node.js main thread is not a good choice, it will chock the event loop and block all other task in the queue. So a good choice could be to consider this task in a separate thread (let us call this thread as a worker thread). JavaScript asynchronous callback and Promise are doing exactly this approach. </p>\n\n<p>Let us say we have deployed the <strong>task on a worker thread</strong> and we are ready with a portion of result and we would like it to be send to JavaScript layer. Then the process involve are, <strong>converting the result into napi_value and then call the Callback JavaScript</strong> function from C/C++. Unfortunately <strong>neither of the operation can be performed from a worker thread; these operations should be exclusively done from the main thread</strong>. The JavaScript Promise and Callback, wait till the task completion and then switch over to main thread along with the task result in a normal C/C++ storage facility such as structure etc. Then do the napi_value conversion and call the JavaScript callback function from the main thread.</p>\n\n<p>Since our task is extremely long running probably we don't want to wait till the end of the task before exchanging the result with JavaScript layer.\nLet us consider a scenario where we are searching objects in a very large video where we prefer to get the detected objects send to JavaScript layer as on when it is found.\nIn such a scenario <strong>we will have to start sending task result while the task is still in progress</strong>. <strong>This is the scenario where Asynchronous Thread-safe Function Calls come for our help</strong>. It acts as a safe tunnel between the worker thread and the JavaScript layer for information exchange. Let us consider the following function snippet</p>\n\n<pre><code>napi_value CAsyncStreamSearch(napi_env env, napi_callback_info info)\n{\n    // The native addon function exposed to JavaScript\n    // This will be the funciton a node.js application calling.\n}\n\nvoid ExecuteWork(napi_env env, void* data)\n{\n    // We will use this function to get the task done.\n    // This code will be executed on a worker thread.\n}\n\nvoid OnWorkComplete(napi_env env, napi_status status, void* data)\n{\n    // after the `ExecuteWork` function exits, this\n    // callback function will be called on the main thread\n}\n\nvoid ThreadSafeCFunction4CallingJS(napi_env env, napi_value js_cb,\n                 void* context, void* data)\n{\n   // This funcion acts as a safe tunnel between the asynchronous C/C++ code \n   // executing the worker thread and the JavaScript layer for information exchange.\n}\n</code></pre>\n\n<p>In this first three functions are nearly same as JavaScript Promise and Callback that we are familiar with. The fourth one is specifically for the Asynchronous Thread-safe Function Calls. In this, our long running <strong>task is being executed by ExecuteWork() function on a worker thread</strong>. Let us say <strong>it has instructed us not to call JavaScript</strong> (and also any napi_value conversion of result) from ExecuteWork() <strong>but permitted to do so from ThreadSafeCFunction4CallingJS</strong> as long as we are calling ThreadSafeCFunction4CallingJS with an napi equivalent of C/C++ function pointer. Then we could pack the JavaScript calls inside this ThreadSafeCFunction4CallingJS() function. Then when ExecuteWork() function could pass the result to ThreadSafeCFunction4CallingJS() while it is being invoked in a plain C/C++ storage units such as structure etc. The ThreadSafeCFunction4CallingJS() convert this result to napi_value and call JavaScript function. \n<strong>Under the cover the ThreadSafeCFunction4CallingJS() function is being queue to the event loop, and eventually it get executed by main thread.</strong></p>\n\n<p>The following code snippet packed inside CAsyncStreamSearch() is responsible for creating a C/C++ function pointer equivalent of N-API by usng <strong>napi_create_threadsafe_function()</strong> and it is being done from the native addon's main thread itself. Similarly the request for creation of worker thread by using <strong>napi_create_async_work()</strong> function then placing the work int the event queue by  <strong>using napi_queue_async_work()</strong> so that a worker thread will pickup this item in the future.</p>\n\n<pre><code>napi_value CAsyncStreamSearch(napi_env env, napi_callback_info info)\n{\n-- -- -- --\n-- -- -- --\n  // Create a thread-safe N-API callback function correspond to the C/C++ callback function\n  napi_create_threadsafe_function(env,\n      js_cb, NULL, work_name, 0, 1, NULL, NULL, NULL,\n      ThreadSafeCFunction4CallingJS, // the C/C++ callback function\n      // out: the asynchronous thread-safe JavaScript function\n      &amp;(async_stream_data_ex-&gt;tsfn_StreamSearch));\n\n  // Create an async work item, that can be deployed in the node.js event queue\n  napi_create_async_work( env, NULL,\n       work_name,\n       ExecuteWork,\n       OnWorkComplete,\n       async_stream_data_ex,\n       // OUT: THE handle to the async work item\n       &amp;(async_stream_data_ex-&gt;work_StreamSearch);)\n\n  // Queue the work item for execution.\n  napi_queue_async_work(env, async_stream_data_ex-&gt;work_StreamSearch);\n\n  return NULL;\n}\n</code></pre>\n\n<p>Then during the asynchronous execution of task (ExecuteWork() function) invokes ThreadSafeCFunction4CallingJS() by calling napi_call_threadsafe_function() function as shown bellow.</p>\n\n<pre><code>static void ExecuteWork(napi_env env, void *data)\n{\n  // tsfn is napi equivalent of point to ThreadSafeCFunction4CallingJS\n  // function that we created at CAsyncStreamSearch function\n  napi_acquire_threadsafe_function( tsfn )\n  Loop\n  {\n    // this will eventually invoke ThreadSafeCFunction4CallingJS()\n   // we may call any number of time (in fact it can be called from any thread)\n    napi_call_threadsafe_function( tsfn, WorkResult, );\n  }\n  napi_release_threadsafe_function( tsfn,);\n}\n</code></pre>\n\n<p>The example you pointed out is one of the best source of information and it is directly form node.js team itself. When I was learning this concept I too was referring the same example, during my study the example has been recreated by extracting original idea from it, hope you may find this much simplified. and it is available at </p>\n\n<p><a href=\"https://github.com/msatyan/MyNodeC/blob/master/src/mync1/ThreadSafeAsyncStream.cpp\" rel=\"noreferrer\">https://github.com/msatyan/MyNodeC/blob/master/src/mync1/ThreadSafeAsyncStream.cpp</a>\n<a href=\"https://github.com/msatyan/MyNodeC/blob/master/test/ThreadSafeAsyncStream.js\" rel=\"noreferrer\">https://github.com/msatyan/MyNodeC/blob/master/test/ThreadSafeAsyncStream.js</a></p>\n"}, {"tags": [], "owner": {"reputation": 183, "user_id": 646768, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/fd1b4b1affb27cbaafb1b58d4a3c8bdf?s=128&d=identicon&r=PG", "display_name": "glitchyme", "link": "https://stackoverflow.com/users/646768/glitchyme"}, "is_accepted": false, "score": 0, "last_activity_date": 1590102243, "creation_date": 1590102243, "answer_id": 61945201, "question_id": 58960713, "link": "https://stackoverflow.com/questions/58960713/how-to-use-napi-threadsafe-function-for-nodejs-native-addon/61945201#61945201", "title": "How to use napi_threadsafe_function for NodeJS Native Addon", "body": "<p>The solution from this site worked for me <a href=\"https://napi.inspiredware.com/special-topics/thread-safe-functions.html\" rel=\"nofollow noreferrer\">here</a></p>\n\n<pre><code>struct ThreadCtx {\n  ThreadCtx(Napi::Env env) {};\n\n  std::thread nativeThread;\n  Napi::ThreadSafeFunction tsfn;\n};\n\n\nvoid Target::Connect(const Napi::CallbackInfo&amp; info) {\n  Napi::Env env = info.Env();\n\n\n  threadCtx = new ThreadCtx(env);\n\n  // Create a ThreadSafeFunction\n  threadCtx-&gt;tsfn = Napi::ThreadSafeFunction::New(env, info[0].As&lt;Napi::Function&gt;(), \"Resource Name\", 0 /* Unlimited queue */, 1 /* Only 1 thread */, threadCtx,\n        [&amp;]( Napi::Env, void *finalizeData, ThreadCtx *context ) {\n            printf(\"Thread cleanup\\n\");\n            threadCtx-&gt;nativeThread.join();\n        },\n        (void*)nullptr\n        );\n\n  // Create a native thread\n  threadCtx-&gt;nativeThread = std::thread([&amp;] {\n    auto callback = [](Napi::Env env, Napi::Function cb, char* buffer) {\n        cb.Call({Napi::String::New(env, buffer)});\n    };\n\n\n\n    char reply[1024];\n    memset(reply, 0, sizeof(reply));\n    while(true)\n    {\n        size_t reply_length = boost::asio::read(s, boost::asio::buffer(reply, sizeof(reply)));\n\n        if(reply_length &lt;= 0) {\n            printf(\"Bad read from boost asio\\n\");\n            break;\n        }\n\n\n        // Callback (blocking) to JS\n        napi_status status = threadCtx-&gt;tsfn.BlockingCall(reply, callback);\n        if (status != napi_ok)\n        {\n            // Handle error\n            break;\n        }\n    }\n\n    // Release the thread-safe function\n    threadCtx-&gt;tsfn.Release();\n  });\n}\n</code></pre>\n"}], "owner": {"reputation": 695, "user_id": 4925067, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/47A2p.jpg?s=128&g=1", "display_name": "Frederik Petersen", "link": "https://stackoverflow.com/users/4925067/frederik-petersen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1568, "favorite_count": 2, "accepted_answer_id": 59130984, "answer_count": 3, "score": 3, "last_activity_date": 1608323789, "creation_date": 1574272963, "question_id": 58960713, "link": "https://stackoverflow.com/questions/58960713/how-to-use-napi-threadsafe-function-for-nodejs-native-addon", "title": "How to use napi_threadsafe_function for NodeJS Native Addon", "body": "<p>I've been looking through the <a href=\"https://nodejs.org/api/n-api.html#napi_call_threadsafe_function\" rel=\"nofollow noreferrer\">NAPI documentation</a> to try and understand how it deals with <code>multithreading</code>. According to the documentation <code>napi_create_threadsafe_function()</code> and <code>napi_call_threadsafe_function()</code> are used to create and call <code>js functions</code> from multiple threads. The issue is that the documentation is not that straight forward, and there are no examples and I can't find any anywhere else.</p>\n\n<p>If anyone has any experience using <code>napi_create_threadsafe_function()</code> and <code>napi_call_threadsafe_function()</code> or know where to find examples of them being used. Please if you could help out with a a basic example so I can just understand how to use them correctly. </p>\n\n<p>I'm writting a <code>C</code> addon not <code>C++</code> and need to use these functions. I am not using the wrapper <code>node-addon-api</code>, but <code>napi</code> directly</p>\n"}, {"tags": ["python", "c", "testing", "cygwin", "popen"], "comments": [{"owner": {"reputation": 378, "user_id": 2620017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/517078d0e5e19b98b4b8c7228da5aadf?s=128&d=identicon&r=PG", "display_name": "hko", "link": "https://stackoverflow.com/users/2620017/hko"}, "edited": false, "score": 0, "creation_date": 1574281405, "post_id": 58960681, "comment_id": 104180679, "body": "Most likely there is an issue in your C program. I would suggest to try a very simple C program, like Hello World to test your workflow first."}, {"owner": {"reputation": 1, "user_id": 12405561, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZQo6_a8uFtY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfYHlG_EO102dWDDCBfy-lHNqnOQQ/photo.jpg?sz=128", "display_name": "Assaf Halsadi", "link": "https://stackoverflow.com/users/12405561/assaf-halsadi"}, "reply_to_user": {"reputation": 378, "user_id": 2620017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/517078d0e5e19b98b4b8c7228da5aadf?s=128&d=identicon&r=PG", "display_name": "hko", "link": "https://stackoverflow.com/users/2620017/hko"}, "edited": false, "score": 0, "creation_date": 1574286051, "post_id": 58960681, "comment_id": 104182666, "body": "That&#39;s a good idea, I&#39;ll try that and post an update"}, {"owner": {"reputation": 606, "user_id": 4257143, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-q195EKev0qQ/AAAAAAAAAAI/AAAAAAAAAxM/R2bEEt98Yrc/photo.jpg?sz=128", "display_name": "Doug Henderson", "link": "https://stackoverflow.com/users/4257143/doug-henderson"}, "edited": false, "score": 0, "creation_date": 1574300339, "post_id": 58960681, "comment_id": 104186869, "body": "Are you using cygwin&#39;s python3? Supply the version from <code>python -V</code> or <code>python3 -V</code> and the cygwin version info from <code>uname -a</code>. Also, I suggest you use the Cygwin mintty console instead of windows cmd, Also strongly suggest you use python3 (version 3) as python (version 2) is EOL this Dec 31."}, {"owner": {"reputation": 15415, "user_id": 982257, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pRf2i.jpg?s=128&g=1", "display_name": "Iguananaut", "link": "https://stackoverflow.com/users/982257/iguananaut"}, "edited": false, "score": 0, "creation_date": 1574344320, "post_id": 58960681, "comment_id": 104206134, "body": "If you&#39;re using Python 3 you can just use <a href=\"https://docs.python.org/3/library/subprocess.html#subprocess.run\" rel=\"nofollow noreferrer\"><code>subprocess.run</code></a> which is effectively the same as this.  I agree with others that this likely has little to do with Python; rather your C program is crashing for some reason.  Please try to provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">Minimal, Complete, Verifiable, Example</a> or else it&#39;s hard to say much."}, {"owner": {"reputation": 1, "user_id": 12405561, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZQo6_a8uFtY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfYHlG_EO102dWDDCBfy-lHNqnOQQ/photo.jpg?sz=128", "display_name": "Assaf Halsadi", "link": "https://stackoverflow.com/users/12405561/assaf-halsadi"}, "edited": false, "score": 0, "creation_date": 1574449363, "post_id": 58960681, "comment_id": 104250810, "body": "Thanks for the tip in the right direction guys, it was a C problem.  Once I tested it with valgrind with all possible flags it found some error that apperarently Clion AND the command line did not.  So I could get better, any idea why Clion or the command file wouldn&#39;t tell me of errors in my code that got it stuck ? I tried freeing a non existing item and did not close a file properly.   Also - as I&#39;m new here, how do I give you credit for helping me out?  Thanks in advance !"}, {"owner": {"reputation": 6281, "user_id": 5105383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2YCB5.jpg?s=128&g=1", "display_name": "matzeri", "link": "https://stackoverflow.com/users/5105383/matzeri"}, "edited": false, "score": 0, "creation_date": 1577385741, "post_id": 58960681, "comment_id": 105158744, "body": "When compiling with gcc it is good practice to use option <code>-Wall</code> so than all warnings are enabled"}], "owner": {"reputation": 1, "user_id": 12405561, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZQo6_a8uFtY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfYHlG_EO102dWDDCBfy-lHNqnOQQ/photo.jpg?sz=128", "display_name": "Assaf Halsadi", "link": "https://stackoverflow.com/users/12405561/assaf-halsadi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 296, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574272851, "creation_date": 1574272851, "question_id": 58960681, "link": "https://stackoverflow.com/questions/58960681/testing-a-c-program-through-subprocess-popen-in-python-raises-cygwin-error", "title": "Testing a C program through subprocess.Popen in PYTHON, raises cygwin error", "body": "<p>I am a student studying C right now and i have been trying to write test programs for my peers.\nI decided to write my test program in python due to knowing that all of the students have the same IDE and interpreter version. </p>\n\n<p>I decided to work with subprocess.Popen.\nI unpack a tar file in that my C program is stored in using a tar command, then i compile the needed files using a gcc command. and then i run tests using input that is stored in text files, comparing the users output to expected outputs in corresponding text files.</p>\n\n<p>when i run my C executable through the cmd, it works flawlessly and no errors appear.\nbut when i try to run them through subprocess.Popen, i get a cygwin error <strong>in addition</strong> to the expected output, causing my testing program to report a test failure. </p>\n\n<p>I use this function, supplying it with an array of strings as arguments for the command.</p>\n\n<pre><code>def run_cmd_command(arguments_list):\n        \"\"\"\n        runs the given command through the command line and returns information\n        about the command.\n        :param arguments_list: a list representing the command to run\n        :return: A tuple containing the returncode, the output of the command and\n        all the errors.\n        \"\"\"\n        process = subprocess.Popen(arguments_list, stdin=subprocess.PIPE,\n                           stdout=subprocess.PIPE, stderr=subprocess.PIPE,\n                           universal_newlines=True)\n        output, errors = process.communicate()\n        return process.returncode, output, errors\n</code></pre>\n\n<p>The test python program works properly when supplied with proper inputs.</p>\n\n<p>On the other hand, when the inputs are not proper, the C program is supposed to print into stderr the string : <code>\"Invalid Input\\n\"</code> but prints <code>Invalid input\n      0 [main] TreeAnalyzer 1780 cygwin_exception::open_stackdumpfile: Dumping stack trace to TreeAnalyzer.exe.stackdump\n</code></p>\n\n<p>I would like to supply you with more information but im not sure which information to supply due to not understand where the problem's may root from.</p>\n"}, {"tags": ["c", "dynamic-memory-allocation", "calloc"], "comments": [{"owner": {"reputation": 1427, "user_id": 3424746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e09ba41aee19d01cf5070f7f5e47a3ba?s=128&d=identicon&r=PG&f=1", "display_name": "PiRocks", "link": "https://stackoverflow.com/users/3424746/pirocks"}, "edited": false, "score": 0, "creation_date": 1574272711, "post_id": 58960580, "comment_id": 104176469, "body": "<code>free(&amp;ms1-&gt;name); </code> Why are you taking the address of <code>ms1-&gt;name</code>?"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1574272765, "post_id": 58960580, "comment_id": 104176501, "body": "it should be <code>free(ms1-&gt;name);</code> because you want to free the memory that <code>ms1-&gt;name</code> is pointing to."}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 1, "creation_date": 1574273197, "post_id": 58960580, "comment_id": 104176714, "body": "Tip: <code>calloc(1, (strlen(char_p) + 1) * sizeof(char))</code> doesn&#39;t make much sense. That should be  <code>calloc(strlen(char_p)+1, sizeof(char))</code> or <code>malloc((strlen(char_p) + 1) * sizeof(char))</code>. Except <code>sizeof(char)</code> is guaranteed to be 1, so that should be  <code>calloc(strlen(char_p)+1, 1)</code> or <code>malloc(strlen(char_p)+1)</code>. Also, the cast the return value isn&#39;t needed and therefore dangerous. It should be omitted."}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1574273245, "post_id": 58960580, "comment_id": 104176747, "body": "Tip: You might find <code>strdup</code> useful"}], "answers": [{"comments": [{"owner": {"reputation": 730, "user_id": 8211088, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/NUYTG.png?s=128&g=1", "display_name": "PerduGames", "link": "https://stackoverflow.com/users/8211088/perdugames"}, "edited": false, "score": 0, "creation_date": 1574277777, "post_id": 58960657, "comment_id": 104178894, "body": "That&#39;s right, I had put the &quot;&amp;&quot; because I got the &quot;expected &#39;void *&#39; but argument is of type &#39;const char *&#39;&quot; warning, and I read it quickly, and didn&#39;t even realize it was a convertion error. Do I need convert by using &quot;const&quot; or also &quot;char&quot;?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 730, "user_id": 8211088, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/NUYTG.png?s=128&g=1", "display_name": "PerduGames", "link": "https://stackoverflow.com/users/8211088/perdugames"}, "edited": false, "score": 0, "creation_date": 1574277928, "post_id": 58960657, "comment_id": 104178961, "body": "@PerduGames The error you got was because you were trying to pass a <code>const</code> pointer where a non-<code>const</code> pointer was expected, so a cast is needed.  The best way to fix this would be to change <code>name</code> to <code>char *</code> since the memory returned is writable."}, {"owner": {"reputation": 730, "user_id": 8211088, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/NUYTG.png?s=128&g=1", "display_name": "PerduGames", "link": "https://stackoverflow.com/users/8211088/perdugames"}, "edited": false, "score": 0, "creation_date": 1574278182, "post_id": 58960657, "comment_id": 104179121, "body": "So would it be writable even if I use <code>const</code> on the <code>name</code> member?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 730, "user_id": 8211088, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/NUYTG.png?s=128&g=1", "display_name": "PerduGames", "link": "https://stackoverflow.com/users/8211088/perdugames"}, "edited": false, "score": 0, "creation_date": 1574278261, "post_id": 58960657, "comment_id": 104179166, "body": "@PerduGames The <code>const</code> means you can&#39;t write to it via the <code>name</code> member but you can through some other <code>char *</code> pointer.  Regardless, you should remove the <code>const</code> qualifier."}, {"owner": {"reputation": 730, "user_id": 8211088, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/NUYTG.png?s=128&g=1", "display_name": "PerduGames", "link": "https://stackoverflow.com/users/8211088/perdugames"}, "edited": false, "score": 0, "creation_date": 1574278610, "post_id": 58960657, "comment_id": 104179325, "body": "True, I tested here, I can record through another pointer anyway, I will remove <code>const</code>, it would be nice to show this solution in your answer since it is the most correct."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 2, "last_activity_date": 1574278730, "last_edit_date": 1574278730, "creation_date": 1574272749, "answer_id": 58960657, "question_id": 58960580, "link": "https://stackoverflow.com/questions/58960580/how-should-i-release-a-char-pointer-by-passing-a-const-char-pointer-for-free/58960657#58960657", "title": "How should I release a char pointer by passing a const char pointer for free?", "body": "<p>This is incorrect:</p>\n\n<pre><code>free(&amp;ms1-&gt;name);\n</code></pre>\n\n<p>The address of <code>ms1-&gt;name</code> is part of the allocated memory assigned to <code>ms1</code>.  it is <em>not</em> the allocation for the <code>name</code> member.</p>\n\n<p>You assigned allocated memory to <code>ms1-&gt;name</code>, so that is what you should pass to <code>free</code>:</p>\n\n<pre><code>free((char *)ms1-&gt;name);\n</code></pre>\n\n<p>Note that the cast is needed because otherwise you would be passing a <code>const</code> pointer to a function expecting a non-<code>const</code> pointer.  The cast can be removed  by changing the <code>name</code> member from <code>const char *</code> to <code>char *</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1574273007, "post_id": 58960711, "comment_id": 104176619, "body": "<code>free((char*)ms1-&gt;name)</code> is needed to avoid a warning since it&#39;s a pointer to a const char for some reason."}, {"owner": {"reputation": 730, "user_id": 8211088, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/NUYTG.png?s=128&g=1", "display_name": "PerduGames", "link": "https://stackoverflow.com/users/8211088/perdugames"}, "edited": false, "score": 0, "creation_date": 1574277942, "post_id": 58960711, "comment_id": 104178973, "body": "True, but note that <code>strdup</code> is not part of the ANSI standard. It is an extension of POSIX."}], "tags": [], "owner": {"reputation": 1669, "user_id": 12396017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nk8xz.png?s=128&g=1", "display_name": "Maxim Sagaydachny", "link": "https://stackoverflow.com/users/12396017/maxim-sagaydachny"}, "is_accepted": false, "score": 1, "last_activity_date": 1574272958, "creation_date": 1574272958, "answer_id": 58960711, "question_id": 58960580, "link": "https://stackoverflow.com/questions/58960580/how-should-i-release-a-char-pointer-by-passing-a-const-char-pointer-for-free/58960711#58960711", "title": "How should I release a char pointer by passing a const char pointer for free?", "body": "<p>&amp;ms1->name points to the address of first field in your struct, i.e. it points to ms1 itself.\nso ms1, and &amp;ms1->name point to the same address</p>\n\n<p>the code should be</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nstruct mystruct {const char *name; int x;};\n\nint main(void) {\n  struct mystruct *ms1;\n  ms1 = (struct mystruct *) calloc(1, sizeof(struct mystruct));\n  ms1-&gt;name = strdup(\"dlldffdl\");\n  ms1-&gt;x = 3;\n  free(ms1-&gt;name);\n  free(ms1);\n  return 0;\n}\n</code></pre>\n\n<p>also your function test_calloc_char_p duplicates functionality of strdup </p>\n"}], "owner": {"reputation": 730, "user_id": 8211088, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/NUYTG.png?s=128&g=1", "display_name": "PerduGames", "link": "https://stackoverflow.com/users/8211088/perdugames"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "closed_date": 1574291847, "accepted_answer_id": 58960657, "answer_count": 2, "score": -3, "last_activity_date": 1574332259, "creation_date": 1574272519, "last_edit_date": 1574332259, "question_id": 58960580, "link": "https://stackoverflow.com/questions/58960580/how-should-i-release-a-char-pointer-by-passing-a-const-char-pointer-for-free", "closed_reason": "Not suitable for this site", "title": "How should I release a char pointer by passing a const char pointer for free?", "body": "<p>I have the code below in a main.c file:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nstruct mystruct {const char *name; int x;};\n\nchar *test_calloc_char_p(const char *char_p) {\n  return (char *) calloc(1, (strlen(char_p) + 1) * sizeof(char));\n}\n\nint main(void) {\n  struct mystruct *ms1;\n  ms1 = (struct mystruct *) calloc(1, sizeof(struct mystruct));\n  ms1-&gt;name = test_calloc_char_p(\"dlldffdl\");\n  ms1-&gt;x = 3;\n  free(&amp;ms1-&gt;name);\n  free(ms1);\n  return 0;\n}\n</code></pre>\n\n<p>Which I compile with <code>gcc main.c -o test</code> and run with <code>./test</code>, and I get:</p>\n\n<pre><code>free(): double free detected in tcache 2\nAbortado\n</code></pre>\n\n<p>I don't understant, why? I should not release <code>ms1-&gt;name</code>? because when I comment this line I don't get the error, but why shouldn't I release something that I allocated?</p>\n"}, {"tags": ["c", "arrays", "function", "pointers"], "comments": [{"owner": {"reputation": 804, "user_id": 5893772, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/EATNh.png?s=128&g=1", "display_name": "Reticulated Spline", "link": "https://stackoverflow.com/users/5893772/reticulated-spline"}, "edited": false, "score": 0, "creation_date": 1574271170, "post_id": 58960194, "comment_id": 104175646, "body": "It would be worth running this code through a formatter to clean it up a little bit, or just indent it carefully."}, {"owner": {"reputation": 804, "user_id": 5893772, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/EATNh.png?s=128&g=1", "display_name": "Reticulated Spline", "link": "https://stackoverflow.com/users/5893772/reticulated-spline"}, "edited": false, "score": 0, "creation_date": 1574271371, "post_id": 58960194, "comment_id": 104175761, "body": "I&#39;ll take a look at the code, but I&#39;ll also make a general recommendation that you choose more descriptive variable names in the future."}, {"owner": {"reputation": 804, "user_id": 5893772, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/EATNh.png?s=128&g=1", "display_name": "Reticulated Spline", "link": "https://stackoverflow.com/users/5893772/reticulated-spline"}, "edited": false, "score": 0, "creation_date": 1574271537, "post_id": 58960194, "comment_id": 104175850, "body": "What are <code>P</code>, <code>N</code>, and <code>Null_nbr</code> supposed to hold at the end of the program?"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1574272013, "post_id": 58960194, "comment_id": 104176106, "body": "When I compile the code, I get 4 warnings. If you fix those warnings, the code works. If you compile with gcc or clang, be sure to use the <code>-Wall</code> option. With microsoft, use <code>&#47;W3</code>."}], "answers": [{"tags": [], "owner": {"reputation": 163, "user_id": 12313191, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDelPS5VpuVOfMYXPwWBTLBvilRRWDWFzYm4WiPJA=k-s128", "display_name": "Yoni Melki", "link": "https://stackoverflow.com/users/12313191/yoni-melki"}, "is_accepted": false, "score": 2, "last_activity_date": 1574271663, "creation_date": 1574271663, "answer_id": 58960356, "question_id": 58960194, "link": "https://stackoverflow.com/questions/58960194/function-who-counts-the-number-of-positive-negative-null-numbers-of-an-array-u/58960356#58960356", "title": "Function who counts the number of positive, negative,null numbers of an Array &quot;using pointers&quot;", "body": "<p>Some programs/compiler don\u2019t allow to define a size of an array like you did (t[M]) because M isn\u2019t a constant value.\nTry to write like this.\n<code>int *array, size\narray = (int*)malloc(size * sizeof(int))</code>.</p>\n\n<p>It should work like this.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1574276473, "creation_date": 1574276473, "answer_id": 58961567, "question_id": 58960194, "link": "https://stackoverflow.com/questions/58960194/function-who-counts-the-number-of-positive-negative-null-numbers-of-an-array-u/58961567#58961567", "title": "Function who counts the number of positive, negative,null numbers of an Array &quot;using pointers&quot;", "body": "<p>If using C99 ...<br>\nWhen <code>int t[M]</code> is declared, <code>M</code> lacks a specified value.  Leads to <em>undefined behavior</em>.</p>\n\n<p>Move declaration after <code>scanf(\"%d\", &amp;M);</code></p>\n\n<pre><code>int M, i, P, N, Null_nbr;    \nprintf(\"enter the size of your array\");\nscanf(\"%d\", &amp;M);\nassert(M &gt; 0);\nint t[M];\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 12405441, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kJa37.jpg?s=128&g=1", "display_name": "issam el mariami", "link": "https://stackoverflow.com/users/12405441/issam-el-mariami"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1574276473, "creation_date": 1574271028, "last_edit_date": 1574273450, "question_id": 58960194, "link": "https://stackoverflow.com/questions/58960194/function-who-counts-the-number-of-positive-negative-null-numbers-of-an-array-u", "title": "Function who counts the number of positive, negative,null numbers of an Array &quot;using pointers&quot;", "body": "<p>My main problem is to write a C program who uses a <code>void</code> function with five arguments: an Array of integer type <code>T[]</code>, its size <code>M</code>, an integer <code>P</code>, another integer <code>N</code> and another one <code>Null_nbr</code>.<br>\nI am NOT TO USE GLOBAL VARIABLES, and to USE POINTERS (because I did it already without Pointers).<br>\nThe program that I write does not return any Errors or Warnings But it doesn't work !\nI'll appreciate it if someone tells me where the issue is in my program.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nvoid function(int [], int , int *, int *, int *);\nint main() {\n    int M, t[M] , i, P, N, Null_nbr;    \n    printf(\"enter the size of your array\");\n    scanf(\"%d\", &amp;M);\n    printf(\"\\n enter the array's elements\");\n    for(i = 0; i &lt; M; i++) {\n        scanf(\"%d\", &amp;t[i]);\n    }\n    function(t, M, &amp;P, &amp;N, &amp;Null_nbr);\n}\nvoid function(int t[], int M, int *P, int *N, int *Null_nbr) {\n    int i;\n    *P=0;\n    *N=0;\n    *Null_nbr=0;\n    for(i = 0; i &lt; M; i++){\n        if(t[i] == 0)\n            (*Null_nbr)++;\n        else if (t[i] &lt; 0)\n            (*N)++;\n        else\n            (*P)++;\n    }\n    printf(\"\\n P = %d N = %d and  Null=%d\", P, N, Null_nbr);        \n}\n</code></pre>\n"}, {"tags": ["c", "static-libraries"], "comments": [{"owner": {"reputation": 109324, "user_id": 21926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6e61d47f9a6ec0a7a286835e51f3332?s=128&d=identicon&r=PG", "display_name": "Sean Bright", "link": "https://stackoverflow.com/users/21926/sean-bright"}, "edited": false, "score": 5, "creation_date": 1574270804, "post_id": 58960088, "comment_id": 104175463, "body": "No, as you point out <code>SCOPE_SIZE</code> is specified at compile time and it is then fixed in the resulting binary."}, {"owner": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "edited": false, "score": 2, "creation_date": 1574270833, "post_id": 58960088, "comment_id": 104175485, "body": "Can you change a compile-time constant without recompilng the library code that uses that constant?  Uh ... no ;)"}, {"owner": {"reputation": 7053, "user_id": 1162141, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7db6bfbfbb420620e6df76c0e406098d?s=128&d=identicon&r=PG", "display_name": "technosaurus", "link": "https://stackoverflow.com/users/1162141/technosaurus"}, "edited": false, "score": 0, "creation_date": 1574278082, "post_id": 58960088, "comment_id": 104179057, "body": "Change it to a pointer and allocate it at startup/initialization time using malloc/mmap."}], "answers": [{"tags": [], "owner": {"reputation": 119, "user_id": 7458049, "user_type": "registered", "profile_image": "https://graph.facebook.com/1588840764489336/picture?type=large", "display_name": "0x6261627564", "link": "https://stackoverflow.com/users/7458049/0x6261627564"}, "is_accepted": false, "score": 0, "last_activity_date": 1574277396, "creation_date": 1574277396, "answer_id": 58961790, "question_id": 58960088, "link": "https://stackoverflow.com/questions/58960088/is-it-possible-to-change-the-buffer-size-used-in-a-c-library-at-compile-time/58961790#58961790", "title": "Is it possible to change the buffer size used in a C library at compile time?", "body": "<p>The answer is no.</p>\n\n<p>During preprocessing (before compilation, when the object file or library created) every macros are processed and it is not possible to modify them anymore.</p>\n\n<p>There is a great thread under this question about the compilation and linking process: <a href=\"https://stackoverflow.com/questions/6264249/how-does-the-compilation-linking-process-work\">How does the compilation/linking process work?</a></p>\n"}, {"tags": [], "owner": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "is_accepted": false, "score": 1, "last_activity_date": 1574277722, "creation_date": 1574277722, "answer_id": 58961872, "question_id": 58960088, "link": "https://stackoverflow.com/questions/58960088/is-it-possible-to-change-the-buffer-size-used-in-a-c-library-at-compile-time/58961872#58961872", "title": "Is it possible to change the buffer size used in a C library at compile time?", "body": "<p>A compiled file is data, with a certain, fixed format. If you know the format of the compiled files, you can change them, but this can be difficult and error-prone, and doesn't really have much to do with C. It is not something that you can do by editing the C source code.</p>\n"}], "owner": {"reputation": 655, "user_id": 7628040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad56e01e183980e30f82fe09908e002?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando Garibaldi", "link": "https://stackoverflow.com/users/7628040/fernando-garibaldi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1574285841, "creation_date": 1574270681, "question_id": 58960088, "link": "https://stackoverflow.com/questions/58960088/is-it-possible-to-change-the-buffer-size-used-in-a-c-library-at-compile-time", "title": "Is it possible to change the buffer size used in a C library at compile time?", "body": "<p>So, I am using a library for reading serial data. I have the source code of the library and it shows that the size of the serial data is something like this:</p>\n\n<pre><code>SOMETYPE ScopeArray[SCOPE_SIZE];\n</code></pre>\n\n<p>Where <code>SCOPE_SIZE</code> is defined by a user-defined compiler flag at compile time. Now my question is: If I'm using the library and not the source code, can I change the value of <code>SCOPE_SIZE</code> by recompiling my application not the library?</p>\n\n<p>If this question doesn't make sense please let me know and I'll try my best to re-explain. \nThanks!</p>\n"}, {"tags": ["c", "union", "type-punning", "c-standard-library"], "comments": [{"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 1, "creation_date": 1574270300, "post_id": 58959794, "comment_id": 104175190, "body": "There&#39;s <code>a_union</code> and <code>q_union</code> in your code. Is this actually your code, or have you made a mistake copy-pasting it?"}, {"owner": {"reputation": 3, "user_id": 12405353, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k1Kxk.jpg?s=128&g=1", "display_name": "Forenceur", "link": "https://stackoverflow.com/users/12405353/forenceur"}, "reply_to_user": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 0, "creation_date": 1574701827, "post_id": 58959794, "comment_id": 104316660, "body": "Oh, that&#39;s just because I use two computers one with an azerty keyboard, and the other one with a qwerty, so sometimes I make mistake"}], "answers": [{"tags": [], "owner": {"reputation": 48092, "user_id": 136208, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a30f566f1b7c9ae44cf245138850ba4?s=128&d=identicon&r=PG", "display_name": "AProgrammer", "link": "https://stackoverflow.com/users/136208/aprogrammer"}, "is_accepted": false, "score": 0, "last_activity_date": 1574270096, "creation_date": 1574270096, "answer_id": 58959935, "question_id": 58959794, "link": "https://stackoverflow.com/questions/58959794/issue-using-type-punning-with-union/58959935#58959935", "title": "Issue using Type Punning with union", "body": "<p>A <code>double</code> with value <code>3.0</code> has a lot of 0 bytes.  I assume the endianess of your machine is such that they overlap with the int.  If instead of <code>3.0</code> you are using <code>3.1</code>, you should see another value.</p>\n\n<p>Instead of an <code>int</code>, you may also try with an <code>unsigned long long</code>, it commonly has the same size as a double and you'll be able to print its whole representation.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 12405507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d64e3193e14dda79f7b2bc4c54a8cd4a?s=128&d=identicon&r=PG", "display_name": "Daniel Mull", "link": "https://stackoverflow.com/users/12405507/daniel-mull"}, "is_accepted": false, "score": 2, "last_activity_date": 1574270161, "creation_date": 1574270161, "answer_id": 58959959, "question_id": 58959794, "link": "https://stackoverflow.com/questions/58959794/issue-using-type-punning-with-union/58959959#58959959", "title": "Issue using Type Punning with union", "body": "<p>It would depend on the type of storage used by your particular processor. </p>\n\n<p>3.0000000000000000 (double precision 3) is represented by 4008 0000 0000 0000 (hex)</p>\n\n<p>Your processor could store floating point numbers in a variety of orders, some store the least significant bytes/words first. In that case the int would only return 0000 0000.</p>\n\n<p>Try using Pi, or sqrt(2)</p>\n"}, {"tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": true, "score": 1, "last_activity_date": 1574270826, "creation_date": 1574270826, "answer_id": 58960133, "question_id": 58959794, "link": "https://stackoverflow.com/questions/58959794/issue-using-type-punning-with-union/58960133#58960133", "title": "Issue using Type Punning with union", "body": "<p>The sizes of the members do not match in any common systems. <code>int</code> is usually nowadays 32 bits and <code>double</code> 64 bits. Because of little-endian storage, the zero bits at the end of the <code>3.0000000000</code> correspond to those of the <code>int</code> member.</p>\n\n<p>Try this one instead:</p>\n\n<pre><code>#include &lt;inttypes.h&gt;\n#include &lt;stdio.h&gt;\n\nunion q_union{\n    uint64_t i;\n    double d;\n};\n\n_Static_assert(sizeof (union q_union){}.i == sizeof (union q_union){}.d,\n     \"The sizes of double and uint64_t must match\");\n\nuint64_t f(void) {\n    union q_union t;\n    t.d = 3.0;\n    return t.i;\n}\n\nint main(int argc, char *argv[])\n{\n    printf(\"%\" PRIu64 \"\\n\", f());\n    printf(\"%#\" PRIx64 \"\\n\", f());\n    return 0;\n}\n</code></pre>\n\n<p>outputs:</p>\n\n<pre><code>4613937818241073152\n0x4008000000000000\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12405353, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k1Kxk.jpg?s=128&g=1", "display_name": "Forenceur", "link": "https://stackoverflow.com/users/12405353/forenceur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 58960133, "answer_count": 3, "score": 0, "last_activity_date": 1574701851, "creation_date": 1574269668, "last_edit_date": 1574701851, "question_id": 58959794, "link": "https://stackoverflow.com/questions/58959794/issue-using-type-punning-with-union", "title": "Issue using Type Punning with union", "body": "<p>I wanted to learn more about type punning and aliasing. So I use the code provide by the <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Optimize-Options.html#Optimize-Options\" rel=\"nofollow noreferrer\">GCC documentation</a> at option <code>-fstric-aliasing</code> like below :</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>union a_union{\n    int i;\n    double d;\n};\n\nint f(){\n    union a_union t;\n    t.d=3.0;\n\n    return t.i\n}\n\n/*what I add*/\nint main(int argc, char *argv[])\n{\n    printf(\"%d\\n\",f());\n    return 0;\n}\n</code></pre>\n\n<p>I expected nothing special but I get only 0. So I test with different value for <code>t.d</code> but no change.\nI test this code on Debian 9, with gcc 6.3, without option.\nI also try with option <code>-fno-strict-aliasing</code> same result</p>\n\n<p>If someone can I explain, why I get only 0 that would be great</p>\n"}, {"tags": ["c", "gcc", "mingw", "c-preprocessor", "linker-flags"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1574270414, "post_id": 58959532, "comment_id": 104175265, "body": "The short answer is <i>no</i>. Because the linker options are for the <i>linker</i>, and anything except the most trivial of programs will have separate compilation and linking."}], "answers": [{"comments": [{"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1574276248, "post_id": 58959999, "comment_id": 104178176, "body": "POSIX documents <code>-lpthread</code>. The <code>-pthread</code> is a historical GCC curiousity and is not needed; special macros have not bee required for threads to work for decades."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 1, "creation_date": 1574276534, "post_id": 58959999, "comment_id": 104178286, "body": "@R.. Linux doesn&#39;t claim to be POSIX compliant, neither does MinGW on Windows, neither does gcc. I am not sure what relevance that POSIX documentation has. The gcc documentation is pretty clear with regards to threading."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1574276717, "post_id": 58959999, "comment_id": 104178373, "body": "GNU documentation has a lot of GNU folks&#39; opinions in it. There is no technical reason to need <code>-pthread</code> since around 2000-ish."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1574276923, "post_id": 58959999, "comment_id": 104178463, "body": "@R.. <code>-pthread</code> compiler option defines <code>_REENTRANT</code> macro on Linux, on Solaris it defined <code>_MT</code>, if I remember correctly. If code depends on those macros you have no other option but to use <code>-pthread</code>. IMO, there is no good reason to ever use <code>-lpthread</code>. I am not sure why you advocate it."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 1, "creation_date": 1574277109, "post_id": 58959999, "comment_id": 104178571, "body": "<code>_REENTRANT</code> is a LinuxThreads thing from the late 90s. <i>Your code</i> was never supposed to depend on it (as it&#39;s in the reserved namespace). It was used by the glibc/LinuxThreads headers from that era, and it&#39;s a long-gone thing of the past from when threads were treated as a weird optional add-on. I &quot;advocate&quot; <code>-lpthread</code> because it&#39;s the <a href=\"https://pubs.opengroup.org/onlinepubs/9699919799/utilities/c99.html\" rel=\"nofollow noreferrer\">documented standard way</a> to ensure that the pthread interfaces are available, whereas <code>-pthread</code> was a crufty hack to make broken pthread implementations work in the 90s."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1574277448, "post_id": 58959999, "comment_id": 104178728, "body": "@R.. boost library depends on these macros, for example. In a single-threaded application there may be no point in using reference counter atomic increments for smart pointers because they are considerably more expensive.  Your claim that the code is not supposed to depend on those is not practical."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 1, "creation_date": 1574277564, "post_id": 58959999, "comment_id": 104178785, "body": "I am sorry, POSIX documentation doesn&#39;t override particular product documentation. <code>gcc</code> is pretty clear on what compiler options are needed to compile multi-threaded applications. And it is up-to-date documentation."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1574277580, "post_id": 58959999, "comment_id": 104178793, "body": "Boost is wrong to do that, for many reasons, independent of it being in the reserved namespace and not a macro for application code to use/inspect. Library code that <i>does not know whether it&#39;s going to be used in a multithreaded environment</i> will be compiled without it defined, and then the code will be broken when it gets used. Compile-time omission of locks is a broken practice from the 90s. You need a runtime predicate to do it correctly."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1574277672, "post_id": 58959999, "comment_id": 104178835, "body": "<i>Boost is wrong to do that</i>. That is too strong of a statement. IMO, your claims are too purist and are not practical."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1574277741, "post_id": 58959999, "comment_id": 104178868, "body": "Insisting on not generating broken code by default is hardly &quot;purist&quot;."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1574277855, "post_id": 58959999, "comment_id": 104178925, "body": "@R.. Your claim that if code uses <code>_REENTRANT</code> it is broken is again too purist. You are just dismissing any evidence that contradicts your beliefs."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1574278239, "post_id": 58959999, "comment_id": 104179155, "body": "No, I have consistent reasons for it all. You&#39;re not introducing new &quot;evidence&quot;."}, {"owner": {"reputation": 1154, "user_id": 9319588, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nucMmzLW4a0/AAAAAAAAAAI/AAAAAAAABO8/8cOyCmUB_OU/photo.jpg?sz=128", "display_name": "Cerlancism", "link": "https://stackoverflow.com/users/9319588/cerlancism"}, "edited": false, "score": 0, "creation_date": 1574321775, "post_id": 58959999, "comment_id": 104193039, "body": "-lrt does not seem to work with MinGW, I can&#39;t find much information about -lrt when using MinGW on Windows."}], "tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": true, "score": 2, "last_activity_date": 1574270670, "last_edit_date": 1574270670, "creation_date": 1574270294, "answer_id": 58959999, "question_id": 58959532, "link": "https://stackoverflow.com/questions/58959532/is-it-possible-for-preprocessor-to-check-if-a-linker-option-is-used/58959999#58959999", "title": "Is it possible for preprocessor to check if a linker option is used?", "body": "<blockquote>\n  <p>I have a timer program which uses <code>clock_gettime</code>. This requires <code>-lpthread</code> option to compile successfully or else it gets undefined reference to <code>clock_gettime</code> error.</p>\n</blockquote>\n\n<p><code>clock_gettime</code> requires <code>-lrt</code>, see <a href=\"http://man7.org/linux/man-pages/man2/clock_gettime.2.html\" rel=\"nofollow noreferrer\"><code>man clock_gettime</code></a>. <code>-lpthread</code> just happens to depend on that library.</p>\n\n<p><code>-lpthread</code> linker option should never be used because it is not sufficient. The correct way to compile and link multi-threaded applications is to use <code>-pthread</code> compiler and linker option. The compiler option defines the required macros, the linker option links the correct library.</p>\n\n<blockquote>\n  <p>Just curious if I can make a custom message to warn people at compile time or preprocessing time who compiled without it to include <code>-lpthread</code> option.</p>\n</blockquote>\n\n<p><code>-lrt</code> is a linker option. When object files are compiled separately from linking, the linker options are not a part of the compiler command line and hence aren't available at that stage. There is link-time code generation, however, the compilers don't normally export linker options as macros for the code being compiled to inspect.</p>\n"}], "owner": {"reputation": 1154, "user_id": 9319588, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nucMmzLW4a0/AAAAAAAAAAI/AAAAAAAABO8/8cOyCmUB_OU/photo.jpg?sz=128", "display_name": "Cerlancism", "link": "https://stackoverflow.com/users/9319588/cerlancism"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 58959999, "answer_count": 1, "score": 0, "last_activity_date": 1574270670, "creation_date": 1574268726, "last_edit_date": 1574268984, "question_id": 58959532, "link": "https://stackoverflow.com/questions/58959532/is-it-possible-for-preprocessor-to-check-if-a-linker-option-is-used", "title": "Is it possible for preprocessor to check if a linker option is used?", "body": "<p>I have a timer program which uses <code>clock_gettime</code>. This requires <code>-lpthread</code> option to compile successfully or else it gets <code>undefined reference to 'clock_gettime'</code> error.  </p>\n\n<p>As so far I explored that we can generate preprocessor warning messages with <code>#warning</code> and check if the include is present by <code>#if __has_include(\"&lt;pthread.h&gt;\")</code>. But checking those does not really check if <code>clock_gettime</code> function is defined.</p>\n\n<p>Just curious if I can make a custom message to warn people at compile time or preprocessing time who compiled without it to include <code>-lpthread</code> option.  </p>\n\n<p>I am using MinGW on Windows.</p>\n"}, {"tags": ["c", "string", "char"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 2, "creation_date": 1574268044, "post_id": 58959228, "comment_id": 104173939, "body": "<a href=\"https://stackoverflow.com/a/8940392/918959\">stackoverflow.com/a/8940392/918959</a> has the answer. It is legacy. C was supposed to replace the language called B and many of its features are so today because they aided in porting B programs to C. Some things like the precedence of <a href=\"https://stackoverflow.com/questions/4685072/operator-precedence-bitwise-lower-than#comment66723659_4685140\"><code>&amp;</code> and <code>|</code> do make zero sense this day as they are</a>, but they cannot be fixed <i>now</i>, because they could break so many existing programs."}], "owner": {"reputation": 35, "user_id": 4401872, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RD5Sd.jpg?s=128&g=1", "display_name": "zangsy", "link": "https://stackoverflow.com/users/4401872/zangsy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "closed_date": 1574267870, "answer_count": 0, "score": 2, "last_activity_date": 1574267914, "creation_date": 1574267712, "question_id": 58959228, "link": "https://stackoverflow.com/questions/58959228/why-cannot-assign-a-string-to-a-char-array-in-c", "closed_reason": "Duplicate", "title": "Why cannot assign a string to a char array in C?", "body": "<p>I searched many similar questions, but none of them actually answer my question. I know the difference between char* and char[]. char* is a pointer, which can point to a string, and can be reassigned to another string, like this:</p>\n\n<pre><code>char* p;\np = \"hello\";\np = \"world\";\n</code></pre>\n\n<p>but the string <strong>p</strong> points to cannot be modified. char[] is an array, the element of the string in this array can be modified, like this:</p>\n\n<pre><code>char[] arr = \"hello\";\narr[0] = 'w'; // arr = \"wello\";\n</code></pre>\n\n<p>my question is that why <strong>arr</strong> cannnot be reassigned? like this:</p>\n\n<pre><code>arr = \"world\";\n</code></pre>\n\n<p>what is the relation between the name <strong>arr</strong> and the actual char[]? Based on my understanding, <strong>arr</strong> points to the starting position of char[], which means it is similar to a pointer, like <strong>p</strong> in the first example, but it also seems that <strong>arr</strong> itself does not have a memory address, unlike <strong>p</strong>. So, basically, I am quite confused about why <strong>arr</strong> cannot be assigned like a pointer but works like a pointer. I am looking forward to very detailed explanantions, thanks for help.</p>\n"}, {"tags": ["c", "visual-studio", "heap-memory"], "answers": [{"tags": [], "owner": {"reputation": 2981, "user_id": 1854345, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/FeQ4p.jpg?s=128&g=1", "display_name": "TrevorBrooks", "link": "https://stackoverflow.com/users/1854345/trevorbrooks"}, "is_accepted": true, "score": 1, "last_activity_date": 1574279555, "creation_date": 1574279555, "answer_id": 58962324, "question_id": 58959150, "link": "https://stackoverflow.com/questions/58959150/heap-memory-visualization/58962324#58962324", "title": "Heap Memory Visualization", "body": "<p>Use the Memory Usage Diagnostic Tool in Visual Studio: <a href=\"https://docs.microsoft.com/en-us/visualstudio/profiling/memory-usage?view=vs-2019\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/visualstudio/profiling/memory-usage?view=vs-2019</a></p>\n\n<blockquote>\n  <p>The Memory Usage tool lets you take one or more snapshots of the\n  managed and native memory heap to help understand the memory usage\n  impact of object types. You can collect snapshots of .NET, native, or\n  mixed mode (.NET and native) apps.</p>\n</blockquote>\n\n<p>Here's a great blog article on its usage as well: <a href=\"https://devblogs.microsoft.com/visualstudio/analyze-cpu-memory-while-debugging/\" rel=\"nofollow noreferrer\">https://devblogs.microsoft.com/visualstudio/analyze-cpu-memory-while-debugging/</a></p>\n"}], "owner": {"reputation": 35, "user_id": 12403330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ad6178189d9a73a5143444b482796f7?s=128&d=identicon&r=PG&f=1", "display_name": "InterMilan", "link": "https://stackoverflow.com/users/12403330/intermilan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 489, "favorite_count": 1, "accepted_answer_id": 58962324, "answer_count": 1, "score": 0, "last_activity_date": 1574279555, "creation_date": 1574267509, "last_edit_date": 1574270039, "question_id": 58959150, "link": "https://stackoverflow.com/questions/58959150/heap-memory-visualization", "title": "Heap Memory Visualization", "body": "<p>I was wondering if there is a way to visualize (inside Visual Studio) how much of the heap memory I'm using during the execution of my program.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 4826, "user_id": 193789, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/a17cc57e47435930a48f7c80bcd53863?s=128&d=identicon&r=PG", "display_name": "kebs", "link": "https://stackoverflow.com/users/193789/kebs"}, "edited": false, "score": 1, "creation_date": 1574268008, "post_id": 58959131, "comment_id": 104173915, "body": "<code>time.h</code> is not a C++ header. You tagged C++ so use <code>ctime</code>"}, {"owner": {"reputation": 4826, "user_id": 193789, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/a17cc57e47435930a48f7c80bcd53863?s=128&d=identicon&r=PG", "display_name": "kebs", "link": "https://stackoverflow.com/users/193789/kebs"}, "edited": false, "score": 2, "creation_date": 1574268144, "post_id": 58959131, "comment_id": 104173996, "body": "<code>Sleep()</code> is not C++ but some (obscure?) Windows thing. You should stick to standard C++ , see <a href=\"https://en.cppreference.com/w/cpp/chrono\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/chrono</a>"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7524944, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-e_KiuP2cZcU/AAAAAAAAAAI/AAAAAAAAABY/gaRsyZ3Acpk/photo.jpg?sz=128", "display_name": "Dmitry Semenov", "link": "https://stackoverflow.com/users/7524944/dmitry-semenov"}, "edited": false, "score": 0, "creation_date": 1574270766, "post_id": 58959956, "comment_id": 104175444, "body": "didnt know it, tnx!"}], "tags": [], "owner": {"reputation": 46684, "user_id": 1527, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2180b1a962bf46e58fa9746cb4ebfb91?s=128&d=identicon&r=PG", "display_name": "Pete Kirkham", "link": "https://stackoverflow.com/users/1527/pete-kirkham"}, "is_accepted": true, "score": 1, "last_activity_date": 1574270153, "last_edit_date": 1592644375, "creation_date": 1574270153, "answer_id": 58959956, "question_id": 58959131, "link": "https://stackoverflow.com/questions/58959131/broken-timer-or-something-else/58959956#58959956", "title": "Broken timer or something else", "body": "<p>The documentation for the Sleep function at <a href=\"https://docs.microsoft.com/en-gb/windows/win32/api/synchapi/nf-synchapi-sleep\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-gb/windows/win32/api/synchapi/nf-synchapi-sleep</a> says</p>\n<blockquote>\n<p>Suspends the execution of the current thread until the time-out interval elapses.</p>\n<p>The system clock &quot;ticks&quot; at a constant rate. If dwMilliseconds is less than the resolution of the system clock, the thread may sleep for less than the specified length of time. If dwMilliseconds is greater than one tick but less than two, the wait can be anywhere between one and two ticks, and so on.</p>\n</blockquote>\n<p>Ticks are typically 15.6 ms on Windows systems (64 ticks per second), so 26 becomes 31.2.\nThis is the time after which it is possible for the suspended thread to become active again, there is no guarantee that it will start executing immediately. So your five sleeps become 156ms plus a little overhead.</p>\n<p>The documentation continues with mitigations for this behaviour, and warnings that the mitigations will affect system power usage and so on.</p>\n<blockquote>\n<p>To increase the accuracy of the sleep interval, call the timeGetDevCaps function to determine the supported minimum timer resolution and the timeBeginPeriod function to set the timer resolution to its minimum.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 74, "user_id": 1700925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c9a1956a530fcdc2bff9fde9949388b?s=128&d=identicon&r=PG&f=1", "display_name": "melissanais", "link": "https://stackoverflow.com/users/1700925/melissanais"}, "is_accepted": false, "score": 1, "last_activity_date": 1574270836, "last_edit_date": 1592644375, "creation_date": 1574270836, "answer_id": 58960137, "question_id": 58959131, "link": "https://stackoverflow.com/questions/58959131/broken-timer-or-something-else/58960137#58960137", "title": "Broken timer or something else", "body": "<p>In std::this_thread::sleep_for documentation (found <a href=\"https://en.cppreference.com/w/cpp/thread/sleep_for\" rel=\"nofollow noreferrer\">here</a>)</p>\n<blockquote>\n<p>It is stated that the function blocks the execution of the current\nthread for at least the specified sleep_duration.</p>\n<p>It may block for\nlonger than sleep_duration due to scheduling or resource contention\ndelays.</p>\n</blockquote>\n<p>So your code will take at least 135ms to execute.</p>\n"}], "owner": {"reputation": 13, "user_id": 7524944, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-e_KiuP2cZcU/AAAAAAAAAAI/AAAAAAAAABY/gaRsyZ3Acpk/photo.jpg?sz=128", "display_name": "Dmitry Semenov", "link": "https://stackoverflow.com/users/7524944/dmitry-semenov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 58959956, "answer_count": 2, "score": 0, "last_activity_date": 1574270836, "creation_date": 1574267458, "last_edit_date": 1574269985, "question_id": 58959131, "link": "https://stackoverflow.com/questions/58959131/broken-timer-or-something-else", "title": "Broken timer or something else", "body": "<p>I have some program what must help me, but i cant handle timing. <br>\nHire is a code:</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n#include &lt;time.h&gt;\n#include &lt;Windows.h&gt;\n\ndouble diffclock(clock_t clock1) {\n    clock_t clock2 = clock();\n    double diffticks = clock1 - clock2;\n    double diffms = diffticks / (CLOCKS_PER_SEC / 1000);\n\n    return diffms;\n}\n\n\nint main()\n{\n    int wait = 134;\n    clock_t fullbetween = clock();\n\n    for (int i = 0; i &lt; 5; i++) {\n        Sleep(wait / 5);\n        cout &lt;&lt; wait / 5 &lt;&lt; \"  \";\n    }\n    cout &lt;&lt; endl &lt;&lt; \"finish in \" &lt;&lt; diffclock(fullbetween) &lt;&lt; \" ms\" &lt;&lt; endl;\n    return 0;\n}\n</code></pre>\n\n<p>C++ version. same result:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;chrono&gt;\n#include &lt;ctime&gt;\n#include &lt;thread&gt;\n#include &lt;Windows.h&gt;\n\n\nint main()\n{\n    int wait = 134;\n    auto start = std::chrono::system_clock::now();\n\n    for (int i = 0; i &lt; 5; i++) {\n        std::this_thread::sleep_for(std::chrono::milliseconds(wait/5));\n    }\n    auto end = std::chrono::system_clock::now();\n\n    auto int_ms = std::chrono::duration_cast&lt;std::chrono::milliseconds&gt; (end - start);\n\n    std::cout &lt;&lt; std::endl &lt;&lt; \"finish in \" &lt;&lt; int_ms.count() &lt;&lt; \" ms\" &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre>\n\n<p>134 / 5 = 26 is ok. But in last \"cout\" it shows that all that iteration taked about ~170ms, not 130 as expected. Why this is happening ?</p>\n\n<p>Sry about my engl.</p>\n"}, {"tags": ["c", "formatting", "printf"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 4, "creation_date": 1574266747, "post_id": 58958859, "comment_id": 104173147, "body": "What you have is probably the easiest to read. I&#39;d stop here unless given a very good reason to complicate things."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 2, "creation_date": 1574267269, "post_id": 58958859, "comment_id": 104173467, "body": "If your program&#39;s output is ever read by a machine, or by an uninitiated human, the changing representation could be very confusing.  If you really want to do this, I strongly recommend marking the output format somehow, perhaps by prefixing the hexadecimal numbers with <code>0x</code>, which you can do either with <code>&quot;0x%x&quot;</code> or <code>&quot;%#x&quot;</code>."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1574267770, "post_id": 58958859, "comment_id": 104173773, "body": "Besides the other problems mentioned, calling <code>printf</code> with a format which is not a single, constant string is arguably poor style.  It is disrecommended by some style guides.  I believe it is diagnosed by some compilers.  It means that the compiler can&#39;t, in general, do any checking for mismatches between the format string and the arguments."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1574269724, "post_id": 58958859, "comment_id": 104174872, "body": "See also <a href=\"https://stackoverflow.com/questions/31290850\">Why is printf with a single argument (without conversion specifiers) deprecated?</a> (though it&#39;s a somewhat different question)."}], "answers": [{"comments": [{"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1574267480, "post_id": 58959017, "comment_id": 104173573, "body": "The second approach is not good in case you wanted to add a new-line or something else."}, {"owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "reply_to_user": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1574267580, "post_id": 58959017, "comment_id": 104173638, "body": "@machine_1 - Well, assuming you make <code>fmt</code> a big enough buffer, you can put whatever you want (including newlines) into it. But I&#39;m not saying it&#39;s the <i>best</i> way - just <i>one</i> way."}, {"owner": {"reputation": 1519, "user_id": 5447136, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/bpy5K.jpg?s=128&g=1", "display_name": "bool3max", "link": "https://stackoverflow.com/users/5447136/bool3max"}, "edited": false, "score": 0, "creation_date": 1574267678, "post_id": 58959017, "comment_id": 104173704, "body": "Wouldn&#39;t a buffer of size <code>3</code> be sufficient in the second example?"}, {"owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1574267714, "post_id": 58959017, "comment_id": 104173726, "body": "@AnttiHaapala Of course, one could equally well use <code>char* fmt</code> and initialise to a string-literal."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1574267738, "post_id": 58959017, "comment_id": 104173746, "body": "Some compilers will issue a warning if the printf format string is not a string literal."}, {"owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "reply_to_user": {"reputation": 1519, "user_id": 5447136, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/bpy5K.jpg?s=128&g=1", "display_name": "bool3max", "link": "https://stackoverflow.com/users/5447136/bool3max"}, "edited": false, "score": 0, "creation_date": 1574267747, "post_id": 58959017, "comment_id": 104173753, "body": "@bool - Just my habit - always prefer to allocate a &#39;bit too much&#39; rather than &#39;not enough&#39;."}, {"owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1574267856, "post_id": 58959017, "comment_id": 104173830, "body": "@Ian Well they shouldn&#39;t! From <a href=\"http://www.cplusplus.com/reference/cstdio/printf/\" rel=\"nofollow noreferrer\">cppreference</a>: <code>int printf ( const char * format, ... );</code> (implicit casting of non-const to const here is OK)."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1574268328, "post_id": 58959017, "comment_id": 104174090, "body": "@Adrian See the comment I added in the question.  It&#39;s a debatable warning, but not indefensible."}, {"owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1574268542, "post_id": 58959017, "comment_id": 104174202, "body": "@Steve I can understand (and even agree with) your comment/concern. However, it should be a warning from (maybe) a <i>code analyser</i> rather than a compiler. But, it depends also on whether one is using <code>C++</code> (IMHO, justified) or <code>C</code> (IMHO, unjustified) - question is tagged with both."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1574268910, "post_id": 58959017, "comment_id": 104174427, "body": "@Adrian Being pedantic, the variable <code>x</code> will have the wrong type for at least one of the format strings <code>%d</code> (expects an <code>int</code>) or <code>%x</code> (expects an <code>unsigned int</code>)."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1574269583, "post_id": 58959017, "comment_id": 104174800, "body": "@Adrian Two points (though I&#39;m not arguing with you; I like the freedom of using variable formats myself).  (1) Mismatch of <code>printf</code> arguments is bad.  Having the compiler check them is good.  But if the format is variable the compiler can&#39;t check.  Therefore variable formats are bad. (2) Some (including, I&#39;ve heard, the maintainers of gcc) believe that having separate code analyzers is lame.  They&#39;re too much extra work to maintain, they&#39;re too likely to diverge from the compiler(s) in terms of the language accepted, and people might not run them.  Ergo, <i>all</i> the warnings go in the compiler."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1574269665, "post_id": 58959017, "comment_id": 104174844, "body": "See also <a href=\"https://stackoverflow.com/questions/31290850\">Why is printf with a single argument (without conversion specifiers) deprecated?</a> (though it&#39;s a somewhat different question)."}, {"owner": {"reputation": 753, "user_id": 4388311, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/00f3d1843a0458b2b87e2e0214a6615b?s=128&d=identicon&r=PG&f=1", "display_name": "Mahouk", "link": "https://stackoverflow.com/users/4388311/mahouk"}, "edited": false, "score": 0, "creation_date": 1574271734, "post_id": 58959017, "comment_id": 104175952, "body": "Ok, I am sure now C does not provide native conditional formatting."}, {"owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1574283547, "post_id": 58959017, "comment_id": 104181621, "body": "@SteveSummit Yeah! But my point about C++ vs C is that C is &#39;supposed to be&#39; dangerous (it&#39;s human-readable assembler code - do what you want, <i>caveat emptor</i>, &amp;c) whereas C++ is (or has become) strongly typed. But this is philosophy, and not relevant to the OP&#39;s question."}, {"owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "reply_to_user": {"reputation": 753, "user_id": 4388311, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/00f3d1843a0458b2b87e2e0214a6615b?s=128&d=identicon&r=PG&f=1", "display_name": "Mahouk", "link": "https://stackoverflow.com/users/4388311/mahouk"}, "edited": false, "score": 0, "creation_date": 1574283774, "post_id": 58959017, "comment_id": 104181733, "body": "@Mahouk If you got something out of this, then we at SO have done our job! But maybe consider taking out the <code>C++</code> tag? (There are ways in <i>that</i> language to do conditional formatting, but not in C.)"}, {"owner": {"reputation": 753, "user_id": 4388311, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/00f3d1843a0458b2b87e2e0214a6615b?s=128&d=identicon&r=PG&f=1", "display_name": "Mahouk", "link": "https://stackoverflow.com/users/4388311/mahouk"}, "edited": false, "score": 0, "creation_date": 1574338798, "post_id": 58959017, "comment_id": 104202860, "body": "@Adrian, Really? In this case, Can you tell more about it? it would be my pleasure to know it"}, {"owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "reply_to_user": {"reputation": 753, "user_id": 4388311, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/00f3d1843a0458b2b87e2e0214a6615b?s=128&d=identicon&r=PG&f=1", "display_name": "Mahouk", "link": "https://stackoverflow.com/users/4388311/mahouk"}, "edited": false, "score": 1, "creation_date": 1574338926, "post_id": 58959017, "comment_id": 104202930, "body": "@Mahouk You should post a separate question! And be <b>very specific</b> and <b>explicit</b> in your title. There are many folks here on SO far more &#39;clued-up&#39; than I am on such methods."}, {"owner": {"reputation": 753, "user_id": 4388311, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/00f3d1843a0458b2b87e2e0214a6615b?s=128&d=identicon&r=PG&f=1", "display_name": "Mahouk", "link": "https://stackoverflow.com/users/4388311/mahouk"}, "edited": false, "score": 0, "creation_date": 1574342311, "post_id": 58959017, "comment_id": 104204856, "body": "@Adrian, Done! <a href=\"https://stackoverflow.com/questions/58975980/c-printing-with-conditional-format-depending-on-the-base-of-an-int-value\" title=\"c printing with conditional format depending on the base of an int value\">stackoverflow.com/questions/58975980/&hellip;</a>"}], "tags": [], "owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "is_accepted": true, "score": 1, "last_activity_date": 1574340978, "last_edit_date": 1574340978, "creation_date": 1574267105, "answer_id": 58959017, "question_id": 58958859, "link": "https://stackoverflow.com/questions/58958859/c-printf-conditional-format-depending-on-the-base-of-an-int-value/58959017#58959017", "title": "C printf : conditional format depending on the base of an int value", "body": "<p>Your 'conditional format' could be specified using the <em>ternary '?' operator</em>, as suggested in the comments:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>printf((x &gt; 0xF000) ? \"%#x\" : \"%u\", x);\n</code></pre>\n\n<p>However, as also suggested in the comments, this doesn't really help in terms of readability.</p>\n\n<p>You can also use a <em>string variable</em> as the format argument, for example (in this trivial case):</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>char fmt[4];\nif (x &gt; 0xF000) strcpy(fmt, \"%x\");\nelse            strcpy(fmt, \"%u\"); // You haven't specified what type \"x\" is, so let's assume \"unsigned\".\nprintf(fmt, x);\n</code></pre>\n"}], "owner": {"reputation": 753, "user_id": 4388311, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/00f3d1843a0458b2b87e2e0214a6615b?s=128&d=identicon&r=PG&f=1", "display_name": "Mahouk", "link": "https://stackoverflow.com/users/4388311/mahouk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 58959017, "answer_count": 1, "score": 1, "last_activity_date": 1574340978, "creation_date": 1574266551, "last_edit_date": 1574338829, "question_id": 58958859, "link": "https://stackoverflow.com/questions/58958859/c-printf-conditional-format-depending-on-the-base-of-an-int-value", "title": "C printf : conditional format depending on the base of an int value", "body": "<p>I have an unsigned int variable x which value is comprised between from 0 and 0xFFFFF and I would like to print it in a way more readable for the user. <br>\nIf x is greater than 0xF000, print it in hexadecimal, else print it in decimal.\nSo something like this would do it</p>\n\n<pre><code>if (x &gt; 0xF000) \n   printf(\"%#x\", x);\nelse \n   printf(\"%u\", x)\n</code></pre>\n\n<p>But I would like to know if there is an handier and smarter way to handle this, like conditional formatting for output depending of their value.</p>\n"}, {"tags": ["c", "bit-fields"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1574266618, "post_id": 58958814, "comment_id": 104173073, "body": "tl;dr: can&#39;t..."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1574266657, "post_id": 58958814, "comment_id": 104173091, "body": "use bitwise operators to extract the field yourself"}, {"owner": {"reputation": 896, "user_id": 6659361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/200d3e89398030d70445b9a3f071c385?s=128&d=identicon&r=PG&f=1", "display_name": "Maxime B.", "link": "https://stackoverflow.com/users/6659361/maxime-b"}, "reply_to_user": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1574266857, "post_id": 58958814, "comment_id": 104173213, "body": "@phuclv The problem is not to extract the field which is straightforward but to create the right size &quot;blob&quot; for my struct"}, {"owner": {"reputation": 896, "user_id": 6659361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/200d3e89398030d70445b9a3f071c385?s=128&d=identicon&r=PG&f=1", "display_name": "Maxime B.", "link": "https://stackoverflow.com/users/6659361/maxime-b"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1574267162, "post_id": 58958814, "comment_id": 104173400, "body": "@chux-ReinstateMonica I guess you are right, it must not be possible to do it in a clean way. I still think that it is possible to do it using a variable length array  <code>uint8_t bitfield[sz&#47;8]</code>, and wrapping read like that <code>#define read_field(f,n) (f[n&#47;8] &amp; (1&lt;&lt;(n%8)))</code>, no?"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1574268235, "post_id": 58958814, "comment_id": 104174055, "body": "@MaximeB. yes, basically."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1574268334, "post_id": 58958814, "comment_id": 104174093, "body": "Perhaps a <a href=\"https://en.wikipedia.org/wiki/Flexible_array_member\" rel=\"nofollow noreferrer\">flexible array member</a>?"}, {"owner": {"reputation": 896, "user_id": 6659361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/200d3e89398030d70445b9a3f071c385?s=128&d=identicon&r=PG&f=1", "display_name": "Maxime B.", "link": "https://stackoverflow.com/users/6659361/maxime-b"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1574268658, "post_id": 58958814, "comment_id": 104174289, "body": "@chux-ReinstateMonica It remains dirt but I think this is the best way to solve this issue. Thanks."}, {"owner": {"reputation": 132, "user_id": 6066745, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NvjLx.jpg?s=128&g=1", "display_name": "hazirovich", "link": "https://stackoverflow.com/users/6066745/hazirovich"}, "edited": false, "score": 0, "creation_date": 1574303863, "post_id": 58958814, "comment_id": 104187708, "body": "not sure what is the context of your problem, but in my experience sometimes the best solution with big header files filled with complex structs that have size and format dependencies is to auto-generate them using some script."}], "owner": {"reputation": 896, "user_id": 6659361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/200d3e89398030d70445b9a3f071c385?s=128&d=identicon&r=PG&f=1", "display_name": "Maxime B.", "link": "https://stackoverflow.com/users/6659361/maxime-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 138, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1574266397, "creation_date": 1574266397, "question_id": 58958814, "link": "https://stackoverflow.com/questions/58958814/variable-length-bitfield", "title": "Variable length bitfield", "body": "<p>tl;dr: How can I properly generate a variable length bitfield in C?</p>\n\n<p>I have a structure containing a variable number of elements for instance:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>struct s{\n    int v1;\n    int v2;\n    /* ... */\n    int vn;\n}\n</code></pre>\n\n<p>I'd like to create an anonymous bitfield of the size of the struct. Since i want low coupling between my two structs I do like this:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>struct x{\n        unsigned long a:sz(struct s);\n};\n</code></pre>\n\n<p>This code works but leads to issues:</p>\n\n<ol>\n<li>What can I do if the struct has a size above 64 bits?\n\n<ul>\n<li>I can use several ints to store my bitfield but that gets messy and overkill.</li>\n<li>I could also use a pointer to a void* but I suspect performance loss</li>\n</ul></li>\n<li>By design my bitfield will generate AND for each operation over it deteriorate performances as seen in the following code</li>\n</ol>\n\n<pre><code>int main() {\n 560:   41 54                   push   %r12\n}\n\n__fortify_function int\nprintf (const char *__restrict __fmt, ...)\n{\n  return __printf_chk (__USE_FORTIFY_LEVEL - 1, __fmt, __va_arg_pack ());\n 562:   4c 8d 25 cb 01 00 00    lea    0x1cb(%rip),%r12        # 734 &lt;_IO_stdin_used+0x4&gt;\n 569:   55                      push   %rbp\n 56a:   bd 64 00 00 00          mov    $0x64,%ebp\n 56f:   53                      push   %rbx\n 570:   bb 04 00 00 00          mov    $0x4,%ebx\n 575:   0f 1f 00                nopl   (%rax)\n                struct x x = { .a = 3, };\n                for(int i=0;i &lt;100; ++i){\n                        ++x.a;\n                        printf(\"%u\\n\", x.a);\n 578:   0f b6 d3                movzbl %bl,%edx\n 57b:   31 c0                   xor    %eax,%eax\n 57d:   83 c3 01                add    $0x1,%ebx\n 580:   4c 89 e6                mov    %r12,%rsi\n 583:   bf 01 00 00 00          mov    $0x1,%edi\n 588:   83 e3 0f                and    $0xf,%ebx\n 58b:   e8 b0 ff ff ff          callq  540 &lt;__printf_chk@plt&gt;\n                for(int i=0;i &lt;100; ++i){\n 590:   83 ed 01                sub    $0x1,%ebp\n 593:   75 e3                   jne    578 &lt;main+0x18&gt;\n                }\n                return 0;\n}\n 595:   5b                      pop    %rbx\n 596:   31 c0                   xor    %eax,%eax\n 598:   5d                      pop    %rbp\n 599:   41 5c                   pop    %r12\n 59b:   c3                      retq   \n 59c:   0f 1f 40 00             nopl   0x0(%rax)\n</code></pre>\n\n<p>Ideally I'd like to do something similar to the following pseudo-code (but this is obviously invalid in C).</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#define varint(sz) (sz &gt; 32) ? \\\n                        ((sz&gt;64) ? \"#error size too huge\" : int64_t) : \\\n                        ((sz&gt;16) ?  int32_t: int16_t)\nvarint(sizeof(s)/sizeof(int)) mybitfield = 0;\n</code></pre>\n\n<p>How can I properly generate a variable length bitfield in C?</p>\n"}, {"tags": ["c", "perl", "swig", "undefined-symbol"], "comments": [{"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1574280453, "post_id": 58958415, "comment_id": 104180241, "body": "Can you provide a link to the <code>BioMol</code> module? (I could not find it on metacpan.org)"}, {"owner": {"reputation": 81653, "user_id": 168175, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qxeUf.jpg?s=128&g=1", "display_name": "Flexo", "link": "https://stackoverflow.com/users/168175/flexo"}, "edited": false, "score": 0, "creation_date": 1574289536, "post_id": 58958415, "comment_id": 104183987, "body": "Rename definitely shouldn&#39;t do that. Seems more like a linker error, but I can&#39;t quite understand how."}, {"owner": {"reputation": 21, "user_id": 11739950, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-keuCN0YsXhg/AAAAAAAAAAI/AAAAAAAAR0A/5iO5JBG_Ydk/photo.jpg?sz=128", "display_name": "Hikmatyar Hasan", "link": "https://stackoverflow.com/users/11739950/hikmatyar-hasan"}, "reply_to_user": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1574327641, "post_id": 58958415, "comment_id": 104196055, "body": "@H&#229;konH&#230;gland - The BioMol module was built in house a while back so it would not be available online."}], "owner": {"reputation": 21, "user_id": 11739950, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-keuCN0YsXhg/AAAAAAAAAAI/AAAAAAAAR0A/5iO5JBG_Ydk/photo.jpg?sz=128", "display_name": "Hikmatyar Hasan", "link": "https://stackoverflow.com/users/11739950/hikmatyar-hasan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1574265119, "creation_date": 1574265119, "question_id": 58958415, "link": "https://stackoverflow.com/questions/58958415/swig-causing-symbol-lookup-issue-in-perl-package", "title": "SWIG causing `symbol lookup issue` in perl package", "body": "<p>I am trying to install an old perl module, called BioMol, where SWIG has been used to interface C with perl. It is currently installed on an 'old' machine and we want to install it on a newer machine. </p>\n\n<p>I am able to build the package and install it on the newer machine - producing a single library:  BioMol.so.</p>\n\n<p>When I try to run a sample script that uses a simple function from the perl module, I come across the following error:</p>\n\n<p><code>perl: symbol lookup error: /path-to-binary/BioMol.so: undefined symbol: new_fragmentlist</code></p>\n\n<p>By looking in the binary file (using nm), I found this:</p>\n\n<pre><code> 253                  U new_dihedrallist\n 254 0000000000019f60 T new_DihedralList\n 255                  U new_fragment\n 256 0000000000017ca0 T new_Fragment\n 257                  U new_fragmentlist\n 258 0000000000019000 T new_FragmentList\n</code></pre>\n\n<p>So it is true that new_fragmentlist is undefined (L#257), however new_FragmentList (L#258) seems like the one I should be using anyway. The binary file that is on the 'old' machine looks like this:</p>\n\n<pre><code>896 0000000000018d00 T new_Dihedral\n897 0000000000018c20 T new_DihedralList\n898 00000000000170b0 T new_Fragment\n899 0000000000016fd0 T new_FragmentList\n</code></pre>\n\n<p>I think this may be due to some rename directive in SWIG (see 5.4.7.2 in <a href=\"http://swig.org/Doc3.0/SWIGDocumentation.html#SWIG_rename_ignore\" rel=\"nofollow noreferrer\">http://swig.org/Doc3.0/SWIGDocumentation.html#SWIG_rename_ignore</a>). Maybe the reason I get the case issue in the new binary file, could be because of some new default option in the new SWIG (new version is 3.0.12 and the 'old machine' version is 1.3.40). Any help is much appreciated! </p>\n"}, {"tags": ["c", "ncurses"], "answers": [{"comments": [{"owner": {"reputation": 42737, "user_id": 4518274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UPurS.png?s=128&g=1", "display_name": "Thomas Dickey", "link": "https://stackoverflow.com/users/4518274/thomas-dickey"}, "edited": false, "score": 0, "creation_date": 1584392974, "post_id": 60710099, "comment_id": 107418773, "body": "That may work sometimes, but the result from <code>field_buffer</code> is not guaranteed to be null-terminated (so <code>strlen</code> may not give a good length)."}], "tags": [], "owner": {"reputation": 1, "user_id": 13071381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b76a5ab074988ec5e5627ef7abe5175?s=128&d=identicon&r=PG&f=1", "display_name": "JiPaul B.", "link": "https://stackoverflow.com/users/13071381/jipaul-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1584377814, "creation_date": 1584377814, "answer_id": 60710099, "question_id": 58958410, "link": "https://stackoverflow.com/questions/58958410/restrict-req-next-char-to-content-length-in-ncurses-form-field/60710099#60710099", "title": "Restrict REQ_NEXT_CHAR to content length in ncurses form field", "body": "<p>Personnally I compute effective length of a field by :</p>\n\n<pre><code>leneff=strlen(suppr_espaces(field_buffer(field[iet2],0),0));\n</code></pre>\n\n<p>where suppr_espaces is the following function :</p>\n\n<pre><code>// ==== suppr_espaces ====== suppress spaces in the end of a string =====\nchar *  suppr_espaces(char * chan,char cara) // the last space is replaced by\n{  char *ptc=chan; size_t len,len0;          //.. the char cara \n     len0=len=strlen(ptc); \n     while(len&gt;0 &amp;&amp; ptc[--len]==' ')\n        ptc[len]='\\0';\n     if (len &amp;&amp; ++len&lt;len0) ptc[len]=cara;\nreturn chan; \n}   // fin de la fonction suppr_espaces\n</code></pre>\n\n<p>Then you could compare the position of the cursor with the variable leneff for not move the cursor of the right of your actual content of the field </p>\n"}], "owner": {"reputation": 1311, "user_id": 3314907, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/dff57c24a500108f2ba77b814e06e230?s=128&d=identicon&r=PG&f=1", "display_name": "Celelibi", "link": "https://stackoverflow.com/users/3314907/celelibi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1584377814, "creation_date": 1574265106, "last_edit_date": 1574267458, "question_id": 58958410, "link": "https://stackoverflow.com/questions/58958410/restrict-req-next-char-to-content-length-in-ncurses-form-field", "title": "Restrict REQ_NEXT_CHAR to content length in ncurses form field", "body": "<p>When allowing to edit a form field in ncurses, I would like to also allow cursor motion with the arrow keys. Which work great.</p>\n\n<p>However, when <code>KEY_RIGHT</code> is pressed, I call <code>form_driver(form, REQ_NEXT_CHAR);</code>, which allow the cursor to be moved past the end of the field content. Here's my (almost) minimal working example.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;curses.h&gt;\n#include &lt;form.h&gt;\n\n\n\nint main(void) {\n    FIELD *fields[2] = {NULL};\n    FORM *form;\n    int ch, cont, err;\n\n\n    initscr();\n    cbreak();\n    noecho();\n    curs_set(1);\n    keypad(stdscr, TRUE);\n\n    fields[0] = new_field(1, 10, 0, 0, 0, 0);\n    set_field_back(fields[0], A_UNDERLINE);\n    field_opts_off(fields[0], O_AUTOSKIP);\n    field_opts_off(fields[0], O_NULLOK);\n    field_opts_off(fields[0], O_PASSOK);\n    set_field_type(fields[0], TYPE_ALNUM, 1);\n    form = new_form(fields);\n    post_form(form);\n\n    cont = 1;\n    while (cont) {\n        ch = getch();\n\n        switch (ch) {\n        case KEY_LEFT:\n            form_driver(form, REQ_PREV_CHAR);\n            break;\n        case KEY_RIGHT:\n            form_driver(form, REQ_NEXT_CHAR);\n            break;\n        case KEY_HOME:\n            form_driver(form, REQ_BEG_LINE);\n            break;\n        case KEY_END:\n            form_driver(form, REQ_END_LINE);\n            break;\n        case KEY_BACKSPACE:\n            form_driver(form, REQ_DEL_PREV);\n            break;\n        case KEY_DC:\n            form_driver(form, REQ_DEL_CHAR);\n            break;\n        case KEY_ENTER:\n        case '\\n':\n            err = form_driver(form, REQ_VALIDATION);\n            if (err == E_OK)\n                cont = 0;\n            break;\n        default:\n            form_driver(form, ch);\n            break;\n        }\n    }\n\n    unpost_form(form);\n    endwin();\n    printf(\"entered: %s\\n\", field_buffer(fields[0], 0));\n\n    free_form(form);\n    free_field(fields[0]);\n    return 0;\n}\n</code></pre>\n\n<p>How do I restrict the cursor motion of <code>REQ_NEXT_CHAR</code> to the actual content of the field?</p>\n"}, {"tags": ["c", "language-lawyer", "operator-precedence", "sequence-points", "order-of-execution"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1574263057, "post_id": 58957637, "comment_id": 104170804, "body": "<code>Is x+=x*=x undefined behavior?</code> Yes, no sequence point between multiple assigment (i.e., value change)."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 6, "creation_date": 1574263066, "post_id": 58957637, "comment_id": 104170807, "body": "Please do not provide C++ references for a C question.  They&#39;re not the same language."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1574263349, "post_id": 58957637, "comment_id": 104171017, "body": "@SouravGhosh <a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.5.16.2p3\" rel=\"nofollow noreferrer\">I&#39;m not so sure</a>: &quot;A compound assignment of the form E1 op = E2 is equivalent to the simple assignment expression E1 = E1 op (E2)&quot;  So I read that as saying it should be evaluated as <code>x = x + ( x = ( x * x ) )</code>. I don&#39;t see any UB."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1574263350, "post_id": 58957637, "comment_id": 104171022, "body": "So what do we need to explain? C? or C++? What is <code>x</code>, what is the programming language?!"}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1574263358, "post_id": 58957637, "comment_id": 104171032, "body": "Yes, <code>x += x *= x</code> is equivalent to <code>x += (x *= x)</code>  - since <code>+=</code> and <code>*=</code> have equal precedence and right-to-left associativity.    However, that does not guarantee that <code>x * = x</code> is evaluated before the leftmost <code>x</code>.     In any event, the behaviour is undefined in C, since <code>x</code> is modified twice in one statement."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1574263387, "post_id": 58957637, "comment_id": 104171060, "body": "@AndrewHenle it is UB because there is multiple assignment anyway. It does not matter how you consider the grouping to be."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1574263410, "post_id": 58957637, "comment_id": 104171073, "body": "@AndrewHenle What should be the final value of X per yourself? Well, not what I would expect: <a href=\"https://ideone.com/ncXE45\" rel=\"nofollow noreferrer\">ideone.com/ncXE45</a> :) So UB it is..."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1574263478, "post_id": 58957637, "comment_id": 104171123, "body": "@AnttiHaapala I&#39;m looking for the reference now..."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 2, "creation_date": 1574263492, "post_id": 58957637, "comment_id": 104171135, "body": "@AndrewHenle the same as ever: <i>&quot;Between the previous and next sequence point an object shall have its stored value modified at most once by the evaluation of an expression. Furthermore, the prior value shall be read only to determine the value to be stored&quot;</i>"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1574264314, "post_id": 58957637, "comment_id": 104171641, "body": "Clearly it&#39;s undefined.  <code>x</code> is modified twice between sequence points.  Why is there any doubt or debate about this?"}, {"owner": {"reputation": 17343, "user_id": 445976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c82b2b9bdcf1baaf4677238d59cf745f?s=128&d=identicon&r=PG", "display_name": "Blastfurnace", "link": "https://stackoverflow.com/users/445976/blastfurnace"}, "edited": false, "score": 0, "creation_date": 1574265469, "post_id": 58957637, "comment_id": 104172390, "body": "@Patrick The bottom of the page you linked has a link to its own <a href=\"https://en.cppreference.com/w/c/language/eval_order\" rel=\"nofollow noreferrer\">C version of the page</a>. That might be a better choice for your question."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1574265477, "post_id": 58957637, "comment_id": 104172395, "body": "Well, it isn&#39;t UB in C++17... C and C++ are the same up to C11/C++11. In C++14 the C++ committee only managed to confuse themselves. C++17 contains the fix that C++14 was supposed to contain. As for C, the committee would hate to improve the language by removing well-known language flaws."}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 1, "creation_date": 1574265857, "post_id": 58957637, "comment_id": 104172624, "body": "This really needs a language-lawyer tag.  It doesn&#39;t matter if it is undefined behavior; it is an atrocity that should never be written except for the purpose of language lawyering!"}, {"owner": {"reputation": 111, "user_id": 7860448, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5f89aab836f3e697a8ab22fb6d8b5644?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick", "link": "https://stackoverflow.com/users/7860448/patrick"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1574288499, "post_id": 58957637, "comment_id": 104183631, "body": "@AnttiHaapala I&#39;m sorry for making mistake when copying the link. It is c not c++ and thanks for correcting the link."}], "answers": [{"comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1574268771, "post_id": 58958285, "comment_id": 104174352, "body": "I guess what it says is that <code>z = foo() + (x += y)</code> <code>foo</code> will either see <code>x</code> changed already, at which point <code>foo()</code> by changing global <code>x</code> cannot affect the value of the evaluation <code>x += y</code>, or <code>foo()</code> executes completely before and <code>x += y</code> is evaluated."}, {"owner": {"reputation": 111, "user_id": 7860448, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5f89aab836f3e697a8ab22fb6d8b5644?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick", "link": "https://stackoverflow.com/users/7860448/patrick"}, "edited": false, "score": 0, "creation_date": 1574289921, "post_id": 58958285, "comment_id": 104184112, "body": "I think the compound assignment is atomic in this context and it can&#39;t be interleaved with other functions."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 1, "last_activity_date": 1574265057, "last_edit_date": 1574265057, "creation_date": 1574264737, "answer_id": 58958285, "question_id": 58957637, "link": "https://stackoverflow.com/questions/58957637/evaluation-order-of-c-language/58958285#58958285", "title": "Evaluation Order of C Language", "body": "<p>1) Yes. </p>\n\n<p>C17 6.5.16 Assignment operators, \u00a73</p>\n\n<blockquote>\n  <p>The evaluations of the operands are unsequenced.</p>\n</blockquote>\n\n<p>Which makes it UB because of C17 6.5 \u00a72</p>\n\n<blockquote>\n  <p>If a side effect on a scalar object is unsequenced relative to either a different side effect on the same scalar object or a value computation using the value of the same scalar object, the behavior is undefined.</p>\n</blockquote>\n\n<p>Every assignment is a side effect.  C99 had the same rule but it was much easier to understand:</p>\n\n<p>C99 6.5 \u00a72</p>\n\n<blockquote>\n  <p>Between the previous and next sequence point an object shall have its stored value\n  modified at most once by the evaluation of an expression. Furthermore, the prior value\n  shall be read only to determine the value to be stored.</p>\n</blockquote>\n\n<hr>\n\n<p>2) All the text with C11 sequencing changes is rather confusing to read. They use terms that aren't formally defined anywhere, such as \"single evaluation\".</p>\n\n<p>The normative text is C17 6.5.15.2 \u00a73</p>\n\n<blockquote>\n  <p>A compound assignment of the form E1 op= E2 is equivalent to the simple assignment\n  expression E1 = E1 op (E2), except that the lvalue E1 is evaluated only once, and with\n  respect to an indeterminately-sequenced function call, the operation of a compound assignment is a single evaluation.</p>\n</blockquote>\n\n<p>I suppose that this simply means that an operation like <code>int x;</code> ... <code>x += 1</code> should result in machine code like:</p>\n\n<ul>\n<li>Store 1 in register</li>\n<li>Add x to register</li>\n<li>Write register to x</li>\n</ul>\n\n<p>Otherwise, suppose something gets sequences in between those operations that updates <code>x</code>. But compound assignment isn't atomic no matter, so I don't quite understand what the standard is after here.</p>\n"}, {"comments": [{"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1574445187, "post_id": 58959717, "comment_id": 104249117, "body": "Given something like <code>*p += f();</code>, would the Standard make clear whether the call could occur between evaluation of <code>p</code> and the accesses to that lvalue?  I think the C and C++ Standards would both benefit by recognizing that an lvalue used as the left operand of an assignment operator, or which has its address taken, must be &quot;resolved&quot; prior to the assignment or the first use of the resulting address, and by explicitly specifying how such resolution is sequenced with other parts of expression evaluation."}], "tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": true, "score": 1, "last_activity_date": 1574318773, "last_edit_date": 1574318773, "creation_date": 1574269346, "answer_id": 58959717, "question_id": 58957637, "link": "https://stackoverflow.com/questions/58957637/evaluation-order-of-c-language/58959717#58959717", "title": "Evaluation Order of C Language", "body": "<p><code>x+=x*=x</code> has undefined behaviour because <code>x</code> is assigned to twice between sequence points.</p>\n\n<hr>\n\n<p>The text corresponding to 14) in C11, C17 says</p>\n\n<blockquote>\n  <p>A compound assignment of the form E1 op= E2 is equivalent to the simple assignment expression E1 = E1 op (E2), except that the lvalue E1 is evaluated only once, and with respect to an indeterminately-sequenced function call, the operation of a compound assignment is a single evaluation.</p>\n</blockquote>\n\n<p>What I believe it means is that</p>\n\n<pre><code>int x = 0;\n\nint foo(void) {\n    x = 5;\n    return x;\n}\n\nint main(void) {\n    int y = foo() + (x += 2); \n}\n</code></pre>\n\n<p>will have <em>either</em> the behaviour of</p>\n\n<pre><code>int main(void) {\n    int _tmp = x += 2;\n    int y = foo() + _tmp; \n}\n</code></pre>\n\n<p>or</p>\n\n<pre><code>int main(void) {\n    int _tmp = foo();\n    int y = _tmp + (x += 2); \n}\n</code></pre>\n\n<p>and cannot be split to for example</p>\n\n<pre><code>int main(void) {\n    int _tmp = x;\n    int _tmp2 = foo();\n    x = _tmp + 2;\n    int y = _tmp2 + x; \n}\n</code></pre>\n\n<p>Note that this guarantee is new in C11, and it does not exist in C89, C99.</p>\n"}], "owner": {"reputation": 111, "user_id": 7860448, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5f89aab836f3e697a8ab22fb6d8b5644?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick", "link": "https://stackoverflow.com/users/7860448/patrick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 1, "accepted_answer_id": 58959717, "answer_count": 2, "score": 1, "last_activity_date": 1574374337, "creation_date": 1574262794, "last_edit_date": 1574374337, "question_id": 58957637, "link": "https://stackoverflow.com/questions/58957637/evaluation-order-of-c-language", "title": "Evaluation Order of C Language", "body": "<ol>\n<li>Is <code>x+=x*=x</code> undefined behavior?</li>\n<li>Can anyone explain this rule in <a href=\"https://en.cppreference.com/w/c/language/eval_order\" rel=\"nofollow noreferrer\">Order of evaluation</a>? What is \"single evaluation\"? What is the opposite of \"single evaluation\"?\n\n<blockquote>\n  <p>14) With respect to an indeterminately-sequenced function call, the operation of compound assignment operators, and both prefix and postfix forms of increment and decrement operators are single evaluations.</p>\n</blockquote></li>\n</ol>\n"}, {"tags": ["c", "menu"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1574262063, "post_id": 58957287, "comment_id": 104170144, "body": "The simplified code you posted works fine. The problem must be in original non simplified code you didn&#39;t post."}, {"owner": {"reputation": 828, "user_id": 9073437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C3ywo.jpg?s=128&g=1", "display_name": "Grandtour", "link": "https://stackoverflow.com/users/9073437/grandtour"}, "reply_to_user": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1574262263, "post_id": 58957287, "comment_id": 104170265, "body": "@DavidRanieri it&#39;s <code>do{ switch{...} }while(...)</code>."}, {"owner": {"reputation": 828, "user_id": 9073437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C3ywo.jpg?s=128&g=1", "display_name": "Grandtour", "link": "https://stackoverflow.com/users/9073437/grandtour"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1574262511, "post_id": 58957287, "comment_id": 104170437, "body": "@Jabberwocky I tested my program now, and I discovered that it only doesn&#39;t works when I type a file that has spaces in its name (like <code>Hello World.mp3</code>). <code>Hello-World.mp3</code> works fine."}, {"owner": {"reputation": 828, "user_id": 9073437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C3ywo.jpg?s=128&g=1", "display_name": "Grandtour", "link": "https://stackoverflow.com/users/9073437/grandtour"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1574262631, "post_id": 58957287, "comment_id": 104170510, "body": "@Jabberwocky but the fact is: before I created that menu, it was working fine with all type of files, including the one that has spaces in its name."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1574262636, "post_id": 58957287, "comment_id": 104170512, "body": "You&#39;re asking about the usage of <code>scanf</code>. <code>scanf</code> is not good for interactive user input. Use <code>fgets</code> and scan the string yourself (possibly using <code>sscanf</code> depending on what you want to do)."}, {"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1574262713, "post_id": 58957287, "comment_id": 104170575, "body": "@grandtour: That&#39;s the behaviour of scanf() for the specifier that you gave it."}, {"owner": {"reputation": 938, "user_id": 5502325, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pXFxy.jpg?s=128&g=1", "display_name": "Silveris", "link": "https://stackoverflow.com/users/5502325/silveris"}, "edited": false, "score": 0, "creation_date": 1574265542, "post_id": 58957287, "comment_id": 104172426, "body": "@Grandtour you should put a \\ before the space when inputting your file name: <code>Hello\\ World.mp3</code>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 938, "user_id": 5502325, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pXFxy.jpg?s=128&g=1", "display_name": "Silveris", "link": "https://stackoverflow.com/users/5502325/silveris"}, "edited": false, "score": 3, "creation_date": 1574270376, "post_id": 58957287, "comment_id": 104175241, "body": "@Silveris that&#39;s not really a good advice. And it&#39;s actually plain wrong anyway. It&#39;s not a shell issue but a scanf issue"}], "answers": [{"tags": [], "owner": {"reputation": 828, "user_id": 9073437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C3ywo.jpg?s=128&g=1", "display_name": "Grandtour", "link": "https://stackoverflow.com/users/9073437/grandtour"}, "is_accepted": true, "score": 4, "last_activity_date": 1574529536, "last_edit_date": 1574529536, "creation_date": 1574516108, "answer_id": 59008212, "question_id": 58957287, "link": "https://stackoverflow.com/questions/58957287/how-to-make-a-menu-that-repeats-in-c/59008212#59008212", "title": "How to make a menu that repeats in C", "body": "<p>Changing <code>scanf(\" %s\")</code> to this, did the trick:</p>\n\n<pre><code>getchar();\ngets(directory);\n\n//AFTER READING THAT DIRECTORY, WE NEED TO CHECK IF IT HAS QUOTES ON IT:\nif(directory[0] == '\\\"')  //IF IT HAS, ENTER HERE\n{\n    /* REMOVE ALL QUOTES IN THE DIRECTORY */\n}\n</code></pre>\n"}], "owner": {"reputation": 828, "user_id": 9073437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C3ywo.jpg?s=128&g=1", "display_name": "Grandtour", "link": "https://stackoverflow.com/users/9073437/grandtour"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 1, "accepted_answer_id": 59008212, "answer_count": 1, "score": 3, "last_activity_date": 1595899320, "creation_date": 1574261851, "last_edit_date": 1595899320, "question_id": 58957287, "link": "https://stackoverflow.com/questions/58957287/how-to-make-a-menu-that-repeats-in-c", "title": "How to make a menu that repeats in C", "body": "<p>I'm making a file compressor program in C, and I'm creating a friendly menu that appears in the beginning of the program.</p>\n<p>That's the simplified code:</p>\n<p><strong>Compress.c</strong></p>\n<pre><code>int main()\n{\n\n    char directory[100];\n    char option;\n    bool exit = false;\n\n    do\n    {\n\n        printf(&quot;|------------------------------------|\\n&quot;);\n        printf(&quot;|             Welcome!               |\\n&quot;);\n        printf(&quot;|                                    |\\n&quot;);\n        printf(&quot;|Select one of the following options:|\\n&quot;);\n        printf(&quot;|    1 - Compress a file             |\\n&quot;);\n        printf(&quot;|    2 - Decompress a file           |\\n&quot;);\n        printf(&quot;|    3 - Exit                        |\\n&quot;);\n        printf(&quot;|------------------------------------|\\n&quot;);\n\n        scanf(&quot; %c&quot;, &amp;option);\n\n        switch(option)\n        {\n            case '1':\n                printf(&quot;Enter the FULL directory or drag HERE the file you want to COMPRESS: \\n&quot;);\n                scanf(&quot; %s&quot;, directory);\n\n                /* COMPRESS FILE */\n\n                break;\n\n            case '2':\n                printf(&quot;Enter the FULL directory or drag HERE the file you want to UNCOMPRESS: \\n&quot;);\n                scanf(&quot; %s&quot;, directory);\n\n                /* DECOMPRESS FILE */\n\n                break;\n\n            case '3':\n                exit = true;\n                break;\n\n            default:\n                printf(&quot;Invalid option!\\n\\n&quot;);\n                break;\n        }\n    }while(exit == false);\n\n    return 0;\n}\n</code></pre>\n<p>After typing '1', for example, and typing a CORRECT directory, the program prints 10 times the menu and returns 0. But when I type an INVALID or NONEXISTENT directory, it works, because it prints only 1 time the menu and waits for user types the option again!</p>\n<p>Why is it doing that?</p>\n"}, {"tags": ["c", "linux", "sockets", "tcp"], "comments": [{"owner": {"reputation": 108, "user_id": 7362958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/590adbee41464bc855623cde5b6adfc9?s=128&d=identicon&r=PG&f=1", "display_name": "ieio", "link": "https://stackoverflow.com/users/7362958/ieio"}, "edited": false, "score": 0, "creation_date": 1574267340, "post_id": 58957234, "comment_id": 104173504, "body": "I think you have to tell, in same way, to the client from the server that the file is finished, or close the socket in the server and reconnect."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 12111413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b63a58c8a8fb102f41d1eff83ca06caa?s=128&d=identicon&r=PG&f=1", "display_name": "ShelleyYS", "link": "https://stackoverflow.com/users/12111413/shelleyys"}, "edited": false, "score": 0, "creation_date": 1574697977, "post_id": 59008661, "comment_id": 104314534, "body": "Thanks for your answer! I fixed it and it works fine. But the read loop still cannot terminate after reaches the end of texts, because it cannot print out &quot;Save status: success&quot; and ask to input a new file name. Do you have any other suggestions? Thanks!"}, {"owner": {"reputation": 1669, "user_id": 12396017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nk8xz.png?s=128&g=1", "display_name": "Maxim Sagaydachny", "link": "https://stackoverflow.com/users/12396017/maxim-sagaydachny"}, "reply_to_user": {"reputation": 11, "user_id": 12111413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b63a58c8a8fb102f41d1eff83ca06caa?s=128&d=identicon&r=PG&f=1", "display_name": "ShelleyYS", "link": "https://stackoverflow.com/users/12111413/shelleyys"}, "edited": false, "score": 0, "creation_date": 1574703568, "post_id": 59008661, "comment_id": 104317484, "body": "I would send the size of the file before sending the file itself. This way you would know when file transfer is complete and it is time to break the loop. It is up to you to decide what protocol to implement."}], "tags": [], "owner": {"reputation": 1669, "user_id": 12396017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nk8xz.png?s=128&g=1", "display_name": "Maxim Sagaydachny", "link": "https://stackoverflow.com/users/12396017/maxim-sagaydachny"}, "is_accepted": false, "score": 0, "last_activity_date": 1574519348, "creation_date": 1574519348, "answer_id": 59008661, "question_id": 58957234, "link": "https://stackoverflow.com/questions/58957234/download-a-file-from-server-using-tcp/59008661#59008661", "title": "Download a file from server using TCP", "body": "<p>you have several issues.</p>\n\n<p><strong>first:</strong> - comparison operator has precedence over assignment so length gets FALSE(0) value instead of the real number of received data</p>\n\n<pre><code>if (length=read(sockfd, recvBuff, sizeof(recvBuff))&lt;0)\n</code></pre>\n\n<p>it should be:</p>\n\n<pre><code>if ((length=read(sockfd, recvBuff, sizeof(recvBuff)))&lt;0)\n</code></pre>\n\n<p><strong>second:</strong> you are operating with zero terminated strings but you do not send zero ('\\0') from server and client does not set it at the end of the data block.\nSo you need to set it explicitly at client side here </p>\n\n<pre><code>if ((length=read(sockfd, recvBuff, sizeof(recvBuff)))&lt;0)\n{\n    printf(\"fail\\n\");\n    continue;\n}\nelse if (strcmp(recvBuff,\"File not found\\n\")==0)\n{\n    printf(\"fail\\n\");\n    continue;\n}\nelse\n{    \n   recvBuff[length]='\\0';\n</code></pre>\n\n<p>and here:</p>\n\n<pre><code>while ((length=read(sockfd, recvBuff, sizeof(recvBuff)))&gt;0){\n  recvBuff[length]='\\0';\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 12111413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b63a58c8a8fb102f41d1eff83ca06caa?s=128&d=identicon&r=PG&f=1", "display_name": "ShelleyYS", "link": "https://stackoverflow.com/users/12111413/shelleyys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 145, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1574519348, "creation_date": 1574261706, "question_id": 58957234, "link": "https://stackoverflow.com/questions/58957234/download-a-file-from-server-using-tcp", "title": "Download a file from server using TCP", "body": "<p>I'm trying to write a C program for a client which can download a file from the server using TCP. The client will print and save the file content after it receives the file from the server. To compile the client program it needs IP address and port number of the server. I implemented it in Linux but it displayed 0s after the received texts. The saved text file was the same. I have no idea how to output the text only. Maybe there are wrongs in the receive buffer?</p>\n\n<p>Code for server:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;netdb.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;arpa/inet.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;pthread.h&gt;\n\n#define portnum 12345\n#define FILE_SIZE 500 \n#define BUFFER_SIZE 1024\n\n\nvoid *client_fun(void * fd);\n\nint main()\n{\n    int new_fd;\n    pthread_t thread_id;\n    int server_fd=socket(AF_INET,SOCK_STREAM,0);\n    if(-1==server_fd)\n    {\n        perror(\"socket\");\n        exit(1);\n    }\n\n    struct sockaddr_in server_addr;   \n    server_addr.sin_family=AF_INET;   \n    server_addr.sin_port=htons(portnum);  \n    (server_addr.sin_addr).s_addr=htonl(INADDR_ANY);\n    if(-1==bind(server_fd,(struct sockaddr *)&amp;server_addr,sizeof(server_addr)))  \n    {\n        perror(\"bind\");\n        close(server_fd);\n        exit(6);\n    }\n\n    if(-1==listen(server_fd,5)) \n    {\n        perror(\"listen\");\n        close(server_fd);\n        exit(7);\n    }\n\n    while(1)\n    {\n        struct sockaddr_in client_addr;\n        int size=sizeof(client_addr);\n        new_fd=accept(server_fd,(struct sockaddr *)&amp;client_addr,&amp;size);  \n\n        if(new_fd &lt; 0)\n        {\n            perror(\"accept\");\n            continue;      \n        }\n        printf(\"accept client ip\u951b?s:%d\\n\",inet_ntoa(client_addr.sin_addr),client_addr.sin_port);\n\n        //printf(\"new_fd=%d\\n\",new_fd);\n        if (new_fd &gt; 0)\n        {\n            pthread_create(&amp;thread_id, NULL, client_fun, (void *)&amp;new_fd);  \n            pthread_detach(thread_id);\n        }\n\n    }\n    close(server_fd);\n\n    return 0;\n}\n\nvoid *client_fun(void *arg)\n{\n    int new_fd = *((int *)arg);\n    int file2_fp;\n    int len;\n\n\n    char buffer[BUFFER_SIZE];\n    memset( buffer,0, sizeof(buffer) ); \n\n    while(1)\n    {\n\n        if((len=recv(new_fd, buffer, sizeof(buffer), 0)) &lt;= 0)\n        {\n            continue;\n        }\n\n        char file_name[FILE_SIZE]; \n        memset( file_name,0, sizeof(file_name) );   \n        strncpy(file_name, buffer, strlen(buffer)&gt;FILE_SIZE?FILE_SIZE:strlen(buffer)); \n        memset( buffer,0, sizeof(buffer) );\n        printf(\"Client requests file %s\\n\", file_name); \n\n        if( strcmp(file_name,\"exit\")==0 )\n        {\n           break;\n        }\n\n\n         file2_fp = open(file_name,O_RDONLY,0777); \n         if(file2_fp&lt;0) \n         { \n            printf(\"File %s Not Found\\n\", file_name);\n            char* err_info = \"File not found\\n\";\n            if (write(new_fd, err_info, sizeof(err_info)) &lt; 0)\n            {\n                printf(\"Send error information failed\\n\");\n                break;\n            }\n            continue;\n         } \n         else \n         { \n            int length = 0; \n            memset( buffer,0, sizeof(buffer) );\n\n            while( (length = read(file2_fp, buffer, sizeof(buffer))) &gt; 0  )    \n            {   \n                if( write(new_fd, buffer, length) &lt; 0) \n                { \n                    printf(\"Send File %s Failed.\\n\", file_name); \n                    break; \n                } \n                memset( buffer,0, sizeof(buffer) );\n            } \n\n             close(file2_fp); \n             printf(\"Transfer file %s successfully!\\n\", file_name);\n         }   \n    }\n    close(new_fd);\n\n}\n</code></pre>\n\n<p>Code for client:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;netdb.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;arpa/inet.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;pthread.h&gt;\n\nint main(int argc, char *argv[])\n{\n    int sockfd = 0;\n    char recvBuff[1024];\n    char file_name[500];\n    char *serverIP=argv[1];\n    int portno=atoi(argv[2]);\n    printf(\"IP Addresses: %s   Port Number: %s\\n\", argv[1], argv[2]);\n    memset(recvBuff,'0',sizeof(recvBuff));\n    struct sockaddr_in server_addr;\n    /* Creat a socket*/\n    sockfd = socket(AF_INET, SOCK_STREAM, 0);\n    /*Initialize sockaddr_in structure*/\n    server_addr.sin_family=AF_INET;\n    server_addr.sin_port=htons(portno);\n    (server_addr.sin_addr).s_addr=inet_addr(serverIP);\n    /*Attempt a connection*/\n    printf(\"Connect status: \");\n    if (connect(sockfd,(struct sockaddr *)&amp;server_addr,sizeof(server_addr))&lt;0)\n    {\n        printf(\"fail\\n\");\n        return 0;\n    } \n    printf(\"success\\n\");\n    /*Request file from server*/\n  while(1)\n  {\n    printf(\"Input the file name to be requested from the server: \");\n    fgets(file_name,500, stdin);\n    char *p=strchr(file_name,'\\n');\n    if (p) *p=0;\n    if (send(sockfd, file_name, strlen(file_name), 0)&lt;0) \n    {\n        printf(\"Send failed.\\n\");\n        break;\n    }\n    printf(\"Send success.\\n\");\n    if (strcmp(file_name,\"exit\")==0)\n        break;\n\n    int length=0;\n    printf(\"Send status: \");\n\n    if (length=read(sockfd, recvBuff, sizeof(recvBuff))&lt;0)\n    {\n        printf(\"fail\\n\");\n        continue;\n    }\n    else if (strcmp(recvBuff,\"File not found\\n\")==0)\n    {\n        printf(\"fail\\n\");\n        continue;\n    }\n    else\n    {    \n        printf(\"success\\n\");   \n        /*Create file where text will be stored*/\n        FILE *fp;\n        fp=fopen(\"received_file.txt\",\"w\"); \n        printf(\"Open file status: \");\n        if (fp==NULL)\n        {\n            printf(\"fail\\n\");\n            continue;\n        }\n\n\n        printf(\"success\\n\");\n        printf(\"Received text: \");\n\n        if (fprintf(fp, \"%s\", recvBuff)&lt;0)\n        {\n            printf(\"Save status: fail\\n\");\n            continue;\n        }\n\n        fflush(fp);\n        printf(\"%s\",recvBuff);\n\n        memset(recvBuff,0,1024);\n\n        while ((length=read(sockfd, recvBuff, sizeof(recvBuff)))&gt;0)\n        {\n           if (fprintf(fp, \"%s\", recvBuff)&lt;0)\n           { \n               printf(\"Save status: fail\\n\");  \n               break;         \n           }\n           fflush(fp);\n           printf(\"%s\",recvBuff);\n           memset(recvBuff,0,1024); \n        }\n\n        printf(\"Save status: success\");      \n    }\n  }      \n}\n</code></pre>\n\n<p>Another question is that the client is supposed to keep asking for files until it sends an 'exit'. But it stopped asking the client to input the file name after the first file was received. What's wrong with the loop?</p>\n"}, {"tags": ["c", "assembly", "raspberry-pi", "arm", "armv7"], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 9342019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c61e4eb01c059eae41db34c2a7b52d9a?s=128&d=identicon&r=PG", "display_name": "Michael Bonnet", "link": "https://stackoverflow.com/users/9342019/michael-bonnet"}, "edited": false, "score": 0, "creation_date": 1574694760, "post_id": 58957461, "comment_id": 104312762, "body": "Thank you for your help, that fixed the issue. Any ideas on that VMOV R3, R1, S1 line giving the error &quot;expected comma&quot;?"}, {"owner": {"reputation": 2653, "user_id": 3515931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4c0edddc6a265a0a22058bb2343328d?s=128&d=identicon&r=PG&f=1", "display_name": "JohnH", "link": "https://stackoverflow.com/users/3515931/johnh"}, "reply_to_user": {"reputation": 47, "user_id": 9342019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c61e4eb01c059eae41db34c2a7b52d9a?s=128&d=identicon&r=PG", "display_name": "Michael Bonnet", "link": "https://stackoverflow.com/users/9342019/michael-bonnet"}, "edited": false, "score": 0, "creation_date": 1574716397, "post_id": 58957461, "comment_id": 104322923, "body": "Sorry, I don&#39;t know why it is doing that.  Good luck!"}], "tags": [], "owner": {"reputation": 2653, "user_id": 3515931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4c0edddc6a265a0a22058bb2343328d?s=128&d=identicon&r=PG&f=1", "display_name": "JohnH", "link": "https://stackoverflow.com/users/3515931/johnh"}, "is_accepted": false, "score": 1, "last_activity_date": 1574263960, "last_edit_date": 1574263960, "creation_date": 1574262318, "answer_id": 58957461, "question_id": 58957166, "link": "https://stackoverflow.com/questions/58957166/bus-error-in-armv7-assembly-function-to-find-maximum-element-of-array/58957461#58957461", "title": "Bus error in ARMv7 assembly function to find maximum element of array", "body": "<p>On a count of \"3\" you compare s0 to s1 3 times.... meaning you look for four elements in the array. (With <code>n</code> elements you really should only have <code>n-1</code> comparisons) </p>\n\n<p>The logic...</p>\n\n<pre><code>decrement count\ncmp element0 element1 ... loop\ndecrement count\ncompare element1 element2 ... loop\ndecrement count \ncompare element2 with 'bus error' -- nothing there. \n</code></pre>\n\n<p>Moving <code>SUB R1, R1, #1</code> to the first line after <code>maxF32_loop:</code> probably fixes it as it puts the decrement before the check for count being 0. </p>\n"}], "owner": {"reputation": 47, "user_id": 9342019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c61e4eb01c059eae41db34c2a7b52d9a?s=128&d=identicon&r=PG", "display_name": "Michael Bonnet", "link": "https://stackoverflow.com/users/9342019/michael-bonnet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574264645, "creation_date": 1574261499, "last_edit_date": 1574264645, "question_id": 58957166, "link": "https://stackoverflow.com/questions/58957166/bus-error-in-armv7-assembly-function-to-find-maximum-element-of-array", "title": "Bus error in ARMv7 assembly function to find maximum element of array", "body": "<p>I'm having trouble with an ARMv7 assembly function I'm trying to write. The function is below.</p>\n\n<pre><code>.global maxF32    \n\n// float maxF32(const float x[], uint32_t count)\n// returns the maximum value in the array (x) containing count entries\n/* R0 = float x[], R1 = uint32_t count */\nmaxF32:\n    CMP R1, #0         @ SET FLAGS OF COUNT\n    BEQ maxF32_end     @ IF COUNT == 0, GO TO END\n    MOV R2, R0         @ COPY R0 INTO R2\n    MOV R0, #0         @ ZERO OUT R0\n    MOV R3, #0         @ ZERO OUT R3\n    MOV S0, R0         @ ZERO OUT S0\n    MOV S1, R0         @ ZERO OUT S1\n    MOV S2, R0         @ ZERO OUT S2\n    B maxF32_loop      @ BRANCH TO LOOP\nmaxF32_loop:\n    CMP R1, #0         @ CHECK IF COUNT == 0\n    BEQ maxF32_end     @ IF SO, GO TO END\n    VLDR.F32 S0, [R2]  @ LOAD CURRENT ELEMENT INTO S0\n    ADD R2, R2, #4     @ INCREMENT VECTOR POINTER\n    VLDR.F32 S1, [R2]  @ LOAD NEXT ELEMENT INTO S1\n    SUB R1, R1, #1     @ DECREMENT COUNT\n    CMP S0, S1         @ SET FLAGS; CHECK S0 - S1\n    BMI maxF32_update  @ IF RESULT IS NEGATIVE (S1 &gt; S0), GO TO UPDATE GREATEST\n    B maxF32_loop      @ REPEAT LOOP\nmaxF32_update:\n    VMOV R3, R1, S1  @ MOVE GREATER INTO GREATEST REGISTER\n    B maxF32_loop    @ GO BACK TO LOOP\nmaxF32_end:\n    MOV R0, R3  @ COPY GREATEST INTO R0\n    BX LR       @ RETURN\n</code></pre>\n\n<p>I test with the following C code:</p>\n\n<pre><code>extern float maxF32(const float x[], uint32_t count);\n\n#define COUNT 3\n\nfloat x[] = {1.2, 1.3, 1.4};\nfloat result;\n\nresult = maxF32(x, COUNT);\n\nprintf(\"result is %lf\\n\", result);\n</code></pre>\n\n<p>Using gdb, right around the second to last or last loop through the array, I get a \"bus error\" right around the <code>CMP S0, S1</code> line. I sometimes also get an \"expected comma\" at <code>MOV R3, R1, S1</code>, which confuses me as I don't know where I would need an extra comma.</p>\n\n<p>Last note, I am coding on a Raspberry Pi Model 3 B+.</p>\n\n<p>Thanks for any and all help.</p>\n"}, {"tags": ["c", "pointers", "struct", "malloc"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 5, "creation_date": 1574259874, "post_id": 58956560, "comment_id": 104168765, "body": "No, <code>malloc</code> only the new nodes. The pointer members point to other nodes (which are already allocated), or you set them to <code>NULL</code> when they don&#39;t point anywhere, for example the last link in a chain."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 3, "creation_date": 1574260244, "post_id": 58956560, "comment_id": 104168965, "body": "Aside: <code>void *</code> can be used as a &quot;universal&quot; object pointer type, but for type-safety it would be better to use a specific pointer type. However, to do that, you need to define your <code>struct</code> with a tag name. For example <code>typedef struct segment segment_t;</code> <code>struct segment {</code> <code>struct {</code> <code>double x, y;</code> <code>} point;</code> <code>segment_t *next;</code> <code>segment_t *prev;</code> <code>}</code>;"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 12403330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ad6178189d9a73a5143444b482796f7?s=128&d=identicon&r=PG&f=1", "display_name": "InterMilan", "link": "https://stackoverflow.com/users/12403330/intermilan"}, "edited": false, "score": 0, "creation_date": 1574261087, "post_id": 58956702, "comment_id": 104169500, "body": "Ok, so if I&#39;m building the function to set up a new segment, is it better to do like this: <code>segment_t *segment_new(double x, double y) {   segment_t *s = malloc(sizeof(segment_t));   s-&gt;next = malloc(sizeof(segment_t));     s-&gt;prev = malloc(sizeof(segment_t));     s-&gt;point.x = x;   s-&gt;point.y = y;    return s;</code>  or like this:  <code>segment_t *segment_new(double x, double y) {   segment_t *s = malloc(sizeof(segment_t));   s-&gt;point.x = x;   s-&gt;point.y = y;    return s;</code> ? Thanks"}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 35, "user_id": 12403330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ad6178189d9a73a5143444b482796f7?s=128&d=identicon&r=PG&f=1", "display_name": "InterMilan", "link": "https://stackoverflow.com/users/12403330/intermilan"}, "edited": false, "score": 0, "creation_date": 1574261558, "post_id": 58956702, "comment_id": 104169794, "body": "<code>s-&gt;next-&gt;x</code>, <code>s-&gt;next-&gt;y</code>, <code>s-&gt;next-&gt;next</code>, <code>s-&gt;next-&gt;prev</code>, <code>s-&gt;prev-&gt;x</code>, <code>s-&gt;prev-&gt;y</code>, <code>s-&gt;prev-&gt;next</code> and <code>s-&gt;next-&gt;prev</code> are all uninitialized after that. It makes no sense to create three segments and leaving two of them uninitialized. You probably want <code>s-&gt;next = NULL; s-&gt;prev = NULL;</code>"}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 35, "user_id": 12403330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ad6178189d9a73a5143444b482796f7?s=128&d=identicon&r=PG&f=1", "display_name": "InterMilan", "link": "https://stackoverflow.com/users/12403330/intermilan"}, "edited": false, "score": 0, "creation_date": 1574264354, "post_id": 58956702, "comment_id": 104171664, "body": "If I was building a linked list, I wouldn&#39;t have a <code>segment_new</code> function at all. I would pass the data (not a node/segment) to the insert/append/whatever function. That function would allocate the node/segment and assign the parameter to the newly-created structure, setting <code>prev</code> and <code>next</code> as appropriate to add it to the list."}], "tags": [], "owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": true, "score": 4, "last_activity_date": 1574264662, "last_edit_date": 1574264662, "creation_date": 1574260183, "answer_id": 58956702, "question_id": 58956560, "link": "https://stackoverflow.com/questions/58956560/malloc-inside-a-structure/58956702#58956702", "title": "Malloc inside a structure", "body": "<p><code>malloc(sizeof(segment_t))</code> allocates enough memory for the entire structure, including <code>x</code>, <code>y</code>, <code>next</code> and <code>prev</code>.</p>\n\n<p>It doesn't initialize any of those members, however. If you want <code>next</code> and <code>prev</code> to point to something, you will need to assign a pointer to them. Whether it's a freshly allocated pointer (<code>malloc(...)</code>) or an existing one (incl <code>NULL</code>) is up to you.</p>\n\n<p>In this particular case, an instance of <code>segment_t</code> is a node of a doubly-linked list. As such, <code>s-&gt;next</code> and <code>s-&gt;prev</code> should be initialized to <code>NULL</code> until the node (segment) is added to the list.</p>\n\n<hr>\n\n<p>As mentioned by @Vlad from Moscow, you shouldn't be using <code>void*</code> for the pointers, but the following:</p>\n\n<pre><code>typedef struct segment {\n  struct {\n    double x, y;\n  } point;\n  struct segment *next;\n  struct segment *prev;\n} segment_t;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 1, "creation_date": 1574261651, "post_id": 58956726, "comment_id": 104169852, "body": "A comment indicates the pointers are to segments. so it&#39;s the latter. 100% agree that <code>void*</code> shouldn&#39;t be used here."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1574262019, "post_id": 58956726, "comment_id": 104170108, "body": "@ikegami It is just a bad idea to use void * as the type of the pointers. This only confuses readers of the code."}, {"owner": {"reputation": 35, "user_id": 12403330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ad6178189d9a73a5143444b482796f7?s=128&d=identicon&r=PG&f=1", "display_name": "InterMilan", "link": "https://stackoverflow.com/users/12403330/intermilan"}, "edited": false, "score": 0, "creation_date": 1574262943, "post_id": 58956726, "comment_id": 104170724, "body": "I agree it&#39;s a bad idea, but this is the first part of an homework set up by the professor."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 1, "last_activity_date": 1574260272, "creation_date": 1574260272, "answer_id": 58956726, "question_id": 58956560, "link": "https://stackoverflow.com/questions/58956560/malloc-inside-a-structure/58956726#58956726", "title": "Malloc inside a structure", "body": "<p>For starters it is unclear why within the structure the pointers have the type void *. This only confuses readers of the structure definition</p>\n\n<pre><code>typedef struct{\n  struct {\n    double x, y;\n  } point;\n  void *next;\n  void *prev;\n} segment_t;\n</code></pre>\n\n<p>Whether you mean</p>\n\n<pre><code>typedef struct{\n  struct point{\n    double x, y;\n  } point;\n  struct point *next;\n  struct point *prev;\n} segment_t;\n</code></pre>\n\n<p>or you mean</p>\n\n<pre><code>typedef struct segment {\n  struct {\n    double x, y;\n  } point;\n  struct segment *next;\n  struct segment *prev;\n} segment_t;\n</code></pre>\n\n<p>So change the structure definition accordingly to its usage.</p>\n\n<p>If you want to allocate memory for an object of the type <code>segment_t</code> or <code>poly_t</code> then the object should be initialized ultimately. For example the pointers next, prev, first, and last initially can be initialized by NULL.</p>\n"}], "owner": {"reputation": 35, "user_id": 12403330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ad6178189d9a73a5143444b482796f7?s=128&d=identicon&r=PG&f=1", "display_name": "InterMilan", "link": "https://stackoverflow.com/users/12403330/intermilan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 58956702, "answer_count": 2, "score": 3, "last_activity_date": 1574264662, "creation_date": 1574259749, "question_id": 58956560, "link": "https://stackoverflow.com/questions/58956560/malloc-inside-a-structure", "title": "Malloc inside a structure", "body": "<p>I've just started a course about C programming and I'm stuck with the malloc() function.\nI've a code to implement a linked list of segments.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\ntypedef struct{\n  struct {\n    double x, y;\n  } point;\n  void *next;\n  void *prev;\n} segment_t;\n\ntypedef struct {\n  segment_t *first;\n  segment_t *last;\n} poly_t;\n</code></pre>\n\n<p>Now, if I want to allocate the memory for the struct <code>segment_t</code>, should I allocate also the memory for the two void pointers <code>*next</code> and <code>*prev</code>?\nAnd the same for <code>*first</code> and <code>*last</code> inside the poly_t structure?</p>\n\n<p>Thanks for the help!</p>\n"}, {"tags": ["c", "linux", "serial-port"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1574262762, "post_id": 58956423, "comment_id": 104170610, "body": "What errors are you getting? As for (2) I would make the read blocking instead. You are blocking it yourself anyway until the full buffer is read, then why not let <code>read</code> to take care of that in a proper way?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1574263479, "post_id": 58956423, "comment_id": 104171124, "body": "Error detection code not posted so unnecessarily difficult to see why errors occur more or less.  Post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 85, "user_id": 966446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84ce96bdf9b590a97974cd6d809a3438?s=128&d=identicon&r=PG", "display_name": "Lhh92", "link": "https://stackoverflow.com/users/966446/lhh92"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1574264319, "post_id": 58956423, "comment_id": 104171646, "body": "@Eugene - Are those settings not already blocking?"}, {"owner": {"reputation": 85, "user_id": 966446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84ce96bdf9b590a97974cd6d809a3438?s=128&d=identicon&r=PG", "display_name": "Lhh92", "link": "https://stackoverflow.com/users/966446/lhh92"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1574264451, "post_id": 58956423, "comment_id": 104171729, "body": "@chux - It is not important for this. Every packet is 7 bytes long. First byte is a header character, 4 bytes of a count, followed by a CRC 16 check.  The issue is not related."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1574265073, "post_id": 58956423, "comment_id": 104172134, "body": "@Lhh92 Right, it is blocking. Still, you are talking about errors, but the only error handling we see here is for <code>rc == -1</code> and appears that you are not talking about these - which is misleading. Please provide more information about the errors. Everything is related."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1574265573, "post_id": 58956423, "comment_id": 104172445, "body": "Serial ports do not have packets - it is a byte at a time.  Header character is indistinguishable from CRC bytes.  Receiving system can easily get out of phase.  Seeing how code syncs on incoming data (or lack of good syncing) is important and can easily explain the issue."}, {"owner": {"reputation": 185, "user_id": 2842468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sx6Oc.gif?s=128&g=1", "display_name": "ulix", "link": "https://stackoverflow.com/users/2842468/ulix"}, "edited": false, "score": 0, "creation_date": 1574270201, "post_id": 58956423, "comment_id": 104175126, "body": "Try setting VTIME &gt; 0 as explained here <a href=\"http://www.unixwiz.net/techtips/termios-vmin-vtime.html\" rel=\"nofollow noreferrer\">unixwiz.net/techtips/termios-vmin-vtime.html</a>. This makes read() not teturn immediately if nothing was received."}, {"owner": {"reputation": 13673, "user_id": 1599004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df9d2a02744f666e97375e05fdc54255?s=128&d=identicon&r=PG", "display_name": "sawdust", "link": "https://stackoverflow.com/users/1599004/sawdust"}, "edited": false, "score": 0, "creation_date": 1574276999, "post_id": 58956423, "comment_id": 104178503, "body": "What is <code>fd</code>? Sometimes you use it dereferenced, <code>*fd = open(..)</code> and <code>tcsetattr(*fd,...)</code>, but you also use the pointer value, <code>read(fd, ...)</code>.  Your termios initialization is problematic.  See <a href=\"http://www.chemie.fu-berlin.de/chemnet/use/info/libc/libc_12.html#SEC237\" rel=\"nofollow noreferrer\">Setting Terminal Modes Properly</a>"}, {"owner": {"reputation": 13673, "user_id": 1599004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df9d2a02744f666e97375e05fdc54255?s=128&d=identicon&r=PG", "display_name": "sawdust", "link": "https://stackoverflow.com/users/1599004/sawdust"}, "reply_to_user": {"reputation": 185, "user_id": 2842468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sx6Oc.gif?s=128&g=1", "display_name": "ulix", "link": "https://stackoverflow.com/users/2842468/ulix"}, "edited": false, "score": 0, "creation_date": 1574279053, "post_id": 58956423, "comment_id": 104179544, "body": "Your <b>read()</b> request can cause undefined behavior. (1) A pointer (?) to the file descriptor is the argument instead of the file descriptor.  (2) A minimum of 200 bytes is specified by VMIN, but as <code>buf</code> is filled by each read request, eventually <code>num_buf_byte_remaining</code> could be less than VMIN.  That&#39;s an illogical request.  Also set VTIME &gt; 0 as @ulix suggested (but for the wrong reason)."}, {"owner": {"reputation": 185, "user_id": 2842468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sx6Oc.gif?s=128&g=1", "display_name": "ulix", "link": "https://stackoverflow.com/users/2842468/ulix"}, "reply_to_user": {"reputation": 13673, "user_id": 1599004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df9d2a02744f666e97375e05fdc54255?s=128&d=identicon&r=PG", "display_name": "sawdust", "link": "https://stackoverflow.com/users/1599004/sawdust"}, "edited": false, "score": 0, "creation_date": 1574283799, "post_id": 58956423, "comment_id": 104181741, "body": "@sawdust, based on doc link i posted, paragraph &quot;VMIN &gt; 0 and VTIME &gt; 0 &quot; please ecplain what&#39;s the &quot;wrong reason&quot;  ?"}, {"owner": {"reputation": 13673, "user_id": 1599004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df9d2a02744f666e97375e05fdc54255?s=128&d=identicon&r=PG", "display_name": "sawdust", "link": "https://stackoverflow.com/users/1599004/sawdust"}, "reply_to_user": {"reputation": 185, "user_id": 2842468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sx6Oc.gif?s=128&g=1", "display_name": "ulix", "link": "https://stackoverflow.com/users/2842468/ulix"}, "edited": false, "score": 0, "creation_date": 1574287529, "post_id": 58956423, "comment_id": 104183268, "body": "@ulix -- The existing VTIME=0 and VMIN=200  already <i>&quot;makes read() not teturn immediately&quot;</i>."}, {"owner": {"reputation": 85, "user_id": 966446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84ce96bdf9b590a97974cd6d809a3438?s=128&d=identicon&r=PG", "display_name": "Lhh92", "link": "https://stackoverflow.com/users/966446/lhh92"}, "reply_to_user": {"reputation": 13673, "user_id": 1599004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df9d2a02744f666e97375e05fdc54255?s=128&d=identicon&r=PG", "display_name": "sawdust", "link": "https://stackoverflow.com/users/1599004/sawdust"}, "edited": false, "score": 0, "creation_date": 1574321154, "post_id": 58956423, "comment_id": 104192757, "body": "@sawdust - apologies I had incorrectly copied the code over. The terminos struct is set up in a function called open_port. I have made the above changes."}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1574329169, "post_id": 58956423, "comment_id": 104197070, "body": "High load may change the timing. Maybe in one case the consumer has already processed all data before new data arrive from the producer and in the other case the consumer has to append new data to partially processed data. You should also show the code that consumes the data from the ring buffer. How do you handle communication frames that are split between the end of one buffer and the start of the next buffer. How can you distinguish a header byte from other bytes? A CRC byte can have the same value as your header byte. How do you find the next header byte when you detect a CRC error?"}, {"owner": {"reputation": 85, "user_id": 966446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84ce96bdf9b590a97974cd6d809a3438?s=128&d=identicon&r=PG", "display_name": "Lhh92", "link": "https://stackoverflow.com/users/966446/lhh92"}, "edited": false, "score": 0, "creation_date": 1574331145, "post_id": 58956423, "comment_id": 104198372, "body": "I have added the code. You can see it just logs to file - you are correct about the timing, I think there is something in there."}], "answers": [{"tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": true, "score": 1, "last_activity_date": 1574337715, "creation_date": 1574337715, "answer_id": 58974587, "question_id": 58956423, "link": "https://stackoverflow.com/questions/58956423/why-does-linux-c-serial-read-only-work-with-high-cpu/58974587#58974587", "title": "Why does Linux C serial read only work with high CPU?", "body": "<p>As your code doesn't work in a common condition that you can't prevent from happening, the why of \"Why [it] only work[s] with high CPU?\" doesn't really matter.  It's probably interesting to spend a lot of time and effort finding out the \"Why?\", but I'd think you're going to have to change your code because anything that stops working when CPU load goes down is, IMO, waaaaay too fragile to trust to work for any time.</p>\n\n<p>First, is threading even useful on your system?  If there's only one CPU that can run only one thread at a time, creating multiple threads will be counterproductive.  Have you tried a simple single-threaded solution and actually found that it doesn't work?</p>\n\n<p>If you have tried a single-threaded solution and it doesn't work, the first thing I note is that your currently posted code is doing a tremendous amount of extra work it doesn't need to do, and it's likely contending over a single lock when that doesn't help much at all.</p>\n\n<p>So eliminate your extraneous copying of data along with all the unnecessary bookkeeping you're doing.</p>\n\n<p>You also probably have a lot of contention with just a single mutex and condition variable. There's no need to not read because the logging thread is doing something, or the logging thread not processing because the read thread is doing some bookkeeping. You'd almost certainly benefit from finer lock granularity.</p>\n\n<p>I'd do something like this:</p>\n\n<pre><code>#define CHUNK_SIZE ( 4 * 1024 )\n#define NUM_BUFFERS 16\n\nstruct dataStruct\n{\n    sem_t full;\n    sem_t empty;\n    ssize_t count;\n    char data[ CHUNK_SIZE ]\n};\n\nstruct dataStruct dataArray[ NUM_BUFFERS ];\n\nvoid initDataArray( void )\n{\n    for ( int ii = 0; ii &lt; NUM_BUFFERS; ii++ )\n    {\n        // buffers all start empty\n        sem_init( &amp;( dataArray[ ii ].full ), 0, 0 );\n        sem_init( &amp;( dataArray[ ii ].empty ), 0, 1 );\n    }\n}\n\nvoid *readPortThread( void *arg )\n{\n    unsigned currBuffer = 0;\n\n    // get portFD from arg\n    int portFD = ???\n    for ( ;; )\n    {\n        sem_wait( &amp;( dataArray[ currBuffer  ].empty ) );\n\n        // probably should loop and read more, and don't\n        // infinite loop on any error (hint...)\n        dataArray[ currBuffer  ].count = read( portFD, \n            dataArray[ currBuffer  ].data,\n            sizeof( dataArray[ currBuffer  ].data ) );\n        sem_post( &amp;( dataArray[ currBuffer  ].full ) );\n        currBuffer++;\n        currBuffer  %= NUM_BUFFERS;\n    }\n    return( NULL );\n}\n\nvoid *processData( char *data, ssize_t count )\n{\n    ...\n}\n\nvoid *logDataThread( void *arg )\n{\n    for ( ;; )\n    {\n        sem_wait( &amp;( dataArray[ currBuffer  ].full ) );\n\n        processData( dataArray[ currBuffer  ].data,\n            dataArray[ currBuffer  ].count );\n\n        sem_post( &amp;( dataArray[ currBuffer  ].empty ) );\n        currBuffer++;\n        currBuffer  %= NUM_BUFFERS;\n    }\n    return( NULL );\n}\n</code></pre>\n\n<p>Note the much finer locking granularity, and the complete lack of extraneous copying of data.  Proper headers, all error checking, and full implementation are left as an exercise...</p>\n\n<p>You'll have to test to find optimum values for <code>CHUNK_SIZE</code> and <code>NUM_BUFFERS</code>.  Setting the number of buffers dynamically would be a good improvement also.</p>\n\n<p>OT: There's no need for any indirection in your <code>int open_port(int flags, int *fd)</code> function.  Simply return the <code>fd</code> value - it's good enough for <code>open()</code> itself:</p>\n\n<pre><code>int open_port(int flags )\n{\n    struct termios options;\n    int fd = open(\"/dev/ttyUSB0\", flags | O_NOCTTY);\n\n    if(fd &lt; 0){\n        printf(\"Error opening port\\n\");\n        return fd;\n    }\n\n    // no need for else - the above if statement returns\n    printf(\"Port handle is %d\\n\", fd);\n\n    // did you set **ALL** the fields???\n    memset( options, 0, sizeof( options ) );\n\n    options.c_cflag = BAUDRATE | CS8 | CLOCAL | CREAD;\n    options.c_iflag = 0;\n    options.c_oflag = 0;\n    options.c_lflag = 0;\n    options.c_cc[VTIME] = 0;\n    options.c_cc[VMIN] = 200;\n    tcflush(fd, TCIFLUSH);\n    tcsetattr(fd, TCSANOW, &amp;options);\n\n    return fd;\n}\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 966446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84ce96bdf9b590a97974cd6d809a3438?s=128&d=identicon&r=PG", "display_name": "Lhh92", "link": "https://stackoverflow.com/users/966446/lhh92"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 270, "favorite_count": 0, "accepted_answer_id": 58974587, "answer_count": 1, "score": 0, "last_activity_date": 1574337715, "creation_date": 1574259294, "last_edit_date": 1574331109, "question_id": 58956423, "link": "https://stackoverflow.com/questions/58956423/why-does-linux-c-serial-read-only-work-with-high-cpu", "title": "Why does Linux C serial read only work with high CPU?", "body": "<p>I am reading from a serial port (in blocking mode) using the following code</p>\n\n<pre><code>\n\n    int fd;\n\n    int res;\n    res = open_port(O_RDONLY | O_NOCTTY, &amp;fd);\n\n\n    while (num_bytes_read &lt; C_BUFFER_ENTRY_SIZE)\n    {\n        num_buf_byte_remaining = C_BUFFER_ENTRY_SIZE - num_bytes_read;      \n        rc = read(fd, &amp;buf[num_bytes_read], num_buf_byte_remaining);\n\n        if (rc &gt; 0)\n        {\n            num_bytes_read += rc;\n        }\n\n        if (rc == -1)\n        {\n            printf(\"Read error %s\\n\",strerror(errno));\n        }\n    }\n</code></pre>\n\n<p>The port I am reding from is /dev/ttyUSB0 (a serial port) that is configured using the following configuration.</p>\n\n<pre><code>    // BAUDRATE B3000000\nint open_port(int flags, int *fd)\n{\n    struct termios options;\n    *fd = open(\"/dev/ttyUSB0\", flags | O_NOCTTY);\n\n    if(*fd &lt; 0){\n        printf(\"Error opening port\\n\");\n        return 1;\n    } else{\n        printf(\"Port handle is %d\\n\", *fd);\n    }\n\n    options.c_cflag = BAUDRATE | CS8 | CLOCAL | CREAD;\n    options.c_iflag = 0;\n    options.c_oflag = 0;\n    options.c_lflag = 0;\n    options.c_cc[VTIME] = 0;\n    options.c_cc[VMIN] = 200;\n    tcflush(*fd, TCIFLUSH);\n    tcsetattr(*fd, TCSANOW, &amp;options);\n\n    return 0;\n}\n</code></pre>\n\n<p>The amount of data being transferred over this serial link is very high (approximately 1-2Mbps) and so the reads need to be quick. </p>\n\n<p>The behaviour I am seeing is that the read loop misses data quite frequently when the system is running normally. However, when I increase the loading using <code>nice -n 20 cat /dev/zero &gt; /dev/null</code> all of the errors suddenly stop (I have a header + count + CRCpacket structure so can check corruption and continuity).</p>\n\n<ol>\n<li>Why would increasing the CPU loading actually make the performance of this loop better?</li>\n<li>Do I need to change the terminal settings to improve the performance? (I have tried setting VMIN to 0)</li>\n</ol>\n\n<p>EDIT</p>\n\n<p>Based on the comments below I will expand upon the above. The <code>buf</code> variable that data is where the data read from the serial port is put. This while loop continues until buf has C_BUFFER_ENTRY_SIZE (4096) of bytes in it. </p>\n\n<p>After the while loop breaks (because the num of bytes are equal to 4906) <code>buf</code> is added to a queue to be read from a second thread. The queue is protected by mutexes and conditional variables see below.</p>\n\n<pre><code>/// function is after above while 1 loop\nadd_to_queue(buf,num_bytes_read);\n\n// ring buff struct\ntypedef struct\n{\n    pthread_mutex_t mutex;\n    pthread_cond_t fill;\n    pthread_cond_t empty;\n    int s_icm_idx; // InComing Message index\n    int s_ogm_idx; // OutGoing Message index\n    int s_entry_count;\n    int s_entry_count_hi;\n    int used_bytes[10000];\n    ring_buffer_data_t buffer[10000];\n}ring_buffer_t;\n\ntypedef struct\n{\n    char data[4096];\n}ring_buffer_data_t;\n\n\n///\nint add_to_queue(void* a_data, int a_bytes)\n{\n    int ret_val = 0;\n\n    if (a_bytes &gt; C_BUFFER_ENTRY_SIZE)\n    {\n        return 2;\n    }\n\n    pthread_mutex_lock(&amp;(circ_buf.mutex));\n\n    while (circ_buf.s_entry_count == 10000) \n    {\n        ret_val = 1;\n        pthread_cond_wait(&amp;(circ_buf.empty), &amp;(circ_buf.mutex));\n    }\n\n    /* Put the data on the queue, set how many bytes of the queue */\n    /* are used and then incoming message index and the queue     */\n    /* entry counter.                                             */\n    memcpy(&amp;(circ_buf.buffer[circ_buf.s_icm_idx]), a_data, a_bytes);\n    circ_buf.used_bytes[circ_buf.s_icm_idx] = a_bytes;\n\n    circ_buf.s_icm_idx = (circ_buf.s_icm_idx + 1) % 10000;\n    crc_buf.s_entry_count++;\n\n    pthread_cond_signal(&amp;(circ_buf.fill));\n    pthread_mutex_unlock(&amp;(circ_buf.mutex));\n\n    return ret_val;\n}\n</code></pre>\n\n<p>The second thread reads data from this queue then parses each 4906 byte segement using a simple state machine. I.e. loops through the bytes until a header bytes is found, then checks <code>idx +  5</code> to get CRC, performs CRC over the whole 6 bytes if the crc is valid then reads the message. </p>\n\n<p>The corrupted data I am seeing read from the serial is indicated by the CRC failing. When I load the CPU the CRC check does not fail. And because the 4 bytes between header and CRC are a count I can see that no messages are dropped (continuous count).</p>\n\n<p>I am confident it is not the CRC check that is wrong when the loading is low.</p>\n\n<p><strong>EDIT 2:</strong> </p>\n\n<p>Full compilable code</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;termio.h&gt;\n#include &lt;linux/serial.h&gt;\n#include &lt;assert.h&gt;\n#include &lt;string.h&gt;\n#include &lt;string.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;sys/types.h&gt;\n\n#include &lt;time.h&gt;\n\n//The width and depth of the queue, ie the max size message that can be placed on it.\n#define C_BUFFER_ENTRY_SIZE 4096\n#define C_FIFO_ENTRIES_MAX 10000\n\ntypedef struct\n{\n    char data[C_BUFFER_ENTRY_SIZE];\n}ring_buffer_data_t;\n\n\ntypedef struct\n{\n    pthread_mutex_t mutex;\n    pthread_cond_t fill;\n    pthread_cond_t empty;\n\n    int s_icm_idx; // InComing Message index\n    int s_ogm_idx; // OutGoing Message index\n    int s_entry_count;\n    int s_entry_count_hi;\n    int used_bytes[C_FIFO_ENTRIES_MAX];\n    ring_buffer_data_t buffer[C_FIFO_ENTRIES_MAX];\n} ring_buffer_t;\n\n\nstatic ring_buffer_t s_rb = {PTHREAD_MUTEX_INITIALIZER, PTHREAD_COND_INITIALIZER, PTHREAD_COND_INITIALIZER, 0, 0, 0, 0, {0}, {{{0}}}};\nconst uint8_t CRC_LUT[256] = {0, 94, 188, 226, 97, 63, 221, 131, 194, 156, 126, 32, 163, 253, 31, 65, 157, 195, 33, 127, 252, 162, 64, 30, 95, 1, 227, 189, 62, 96, 130, 220, 35, 125, 159, 193, 66, 28, 254, 160, 225, 191, 93, 3, 128, 222, 60, 98, 190, 224, 2, 92, 223, 129, 99, 61, 124, 34, 192, 158, 29, 67, 161, 255, 70, 24, 250, 164, 39, 121, 155, 197, 132, 218, 56, 102, 229, 187, 89, 7, 219, 133, 103, 57, 186, 228, 6, 88, 25, 71, 165, 251, 120, 38, 196, 154, 101, 59, 217, 135, 4, 90, 184, 230, 167, 249, 27, 69, 198, 152, 122, 36, 248, 166, 68, 26, 153, 199, 37, 123, 58, 100, 134, 216, 91, 5, 231, 185, 140, 210, 48, 110, 237, 179, 81, 15, 78, 16, 242, 172, 47, 113, 147, 205, 17, 79, 173, 243, 112, 46, 204, 146, 211, 141, 111, 49, 178, 236, 14, 80, 175, 241, 19, 77, 206, 144, 114, 44, 109, 51, 209, 143, 12, 82, 176, 238, 50, 108, 142, 208, 83, 13, 239, 177, 240, 174, 76, 18, 145, 207, 45, 115, 202, 148, 118, 40, 171, 245, 23, 73, 8, 86, 180, 234, 105, 55, 213, 139, 87, 9, 235, 181, 54, 104, 138, 212, 149, 203, 41, 119, 244, 170, 72, 22, 233, 183, 85, 11, 136, 214, 52, 106, 43, 117, 151, 201, 74, 20, 246, 168, 116, 42, 200, 150, 21, 75, 169, 247, 182, 232, 10, 84, 215, 137, 107, 53};\nint id;\n\nFILE *log_fh;\n\nvoid *dequeue_and_log(void* fd)\n{\n    #define HDR_START 'X'\n\n    // FILE *fd;\n\n    //fd = fopen(\"log.log\", \"wb\");\n    uint8_t parse_buffer[2 * C_BUFFER_ENTRY_SIZE] = {0};\n    int bytes_to_write = 0;\n    while (1)\n    {\n        pthread_mutex_lock(&amp;(s_rb.mutex));\n\n        while (s_rb.s_entry_count == 0)\n        {\n            pthread_cond_wait(&amp;(s_rb.fill), &amp;(s_rb.mutex));\n        }\n        // Get the incoming data from the buffer\n        bytes_to_write = s_rb.used_bytes[s_rb.s_ogm_idx];\n        memcpy(parse_buffer, &amp;(s_rb.buffer[s_rb.s_ogm_idx]),bytes_to_write);\n\n        s_rb.s_ogm_idx = (s_rb.s_ogm_idx + 1) % C_FIFO_ENTRIES_MAX;\n        s_rb.s_entry_count--;\n\n        pthread_cond_signal(&amp;(s_rb.empty));\n        pthread_mutex_unlock(&amp;(s_rb.mutex));\n        // binary write\n        fwrite(parse_buffer,bytes_to_write,1,(FILE*)fd);\n    }\n}\n\nint add_to_queue(void* a_data, int a_bytes)\n{\n    int ret_val = 0;\n\n    if (a_bytes &gt; C_BUFFER_ENTRY_SIZE)\n    {\n        printf(\"add_to_queue oversized send %i\\n\", a_bytes);\n        return 2;\n    }\n\n    pthread_mutex_lock(&amp;(s_rb.mutex));  \n\n    while (s_rb.s_entry_count == C_FIFO_ENTRIES_MAX) \n    {\n        ret_val = 1;\n        printf(\"Queue is FULL\\n\");\n        pthread_cond_wait(&amp;(s_rb.empty), &amp;(s_rb.mutex));\n    }\n\n    /* Put the data on the queue, set how many bytes of the queue */\n    /* are used and then incoming message index and the queue     */\n    /* entry counter.                                             */\n    memcpy(&amp;(s_rb.buffer[s_rb.s_icm_idx]), a_data, a_bytes);\n    s_rb.used_bytes[s_rb.s_icm_idx] = a_bytes;\n\n    s_rb.s_icm_idx = (s_rb.s_icm_idx + 1) % C_FIFO_ENTRIES_MAX;\n    s_rb.s_entry_count++;\n\n    pthread_cond_signal(&amp;(s_rb.fill));\n    pthread_mutex_unlock(&amp;(s_rb.mutex));\n\n    return ret_val;\n}\n\nint open_port(char *port_name, int flags, int *fd)\n{\n    struct termios options;\n\n    //*fd = open(port_name, O_RDWR | O_NOCTTY);\n    *fd = open(port_name, flags | O_NOCTTY);\n\n    if(*fd &lt; 0){\n        printf(\"Error opening port\\n\");\n        return 1;\n    } else{\n        printf(\"Port handle is %d\\n\", *fd);\n    }\n\n    //Assume port has already been setup by receiver\n    #if(1)\n    options.c_cflag = B3000000 | CS8 | CLOCAL | CREAD;\n    options.c_iflag = 0;\n    options.c_oflag = 0;\n    options.c_lflag = 0;\n    options.c_cc[VTIME] = 0;\n    options.c_cc[VMIN] = 200;\n    tcflush(*fd, TCIFLUSH);\n    tcsetattr(*fd, TCSANOW, &amp;options);\n    #endif\n\n    return 0;\n}\n\n\nint main(int argc, char **argv)\n{\n    int fd;\n    int res;\n    uint8_t buf[C_BUFFER_ENTRY_SIZE];\n    int rc = 0;\n\n    pthread_t p_parse;\n    setbuf(stdout, NULL);\n\n    int num_bytes_read = 0;\n    int num_buf_byte_remaining = 0;\n\n    #define HB_PRINT_INTERVAL 200\n\n    unsigned long int heartbeat_seq_count = 0;\n    unsigned long int heartbeat_seq_count_last_print = 0;\n\n    pthread_mutex_init(&amp;(s_rb.mutex), NULL);\n\n    log_fh = fopen(argv[2], \"wb\");\n\n    res = open_port(argv[1], O_RDONLY, &amp;fd);\n    pthread_create(&amp;p_parse, NULL, dequeue_and_log, (void *)log_fh);\n\n    while(1){\n        heartbeat_seq_count++;\n\n        if (heartbeat_seq_count - heartbeat_seq_count_last_print &gt;= HB_PRINT_INTERVAL)\n        {\n            printf(\"Sequence ID %10ld\\n\", heartbeat_seq_count);             \n            heartbeat_seq_count_last_print = heartbeat_seq_count;\n        }\n\n        num_bytes_read = 0;\n        while (num_bytes_read &lt; C_BUFFER_ENTRY_SIZE)\n        {\n            num_buf_byte_remaining = C_BUFFER_ENTRY_SIZE - num_bytes_read;      \n            rc = read(fd, &amp;buf[num_bytes_read], num_buf_byte_remaining);\n\n\n            if (rc &gt; 0)\n            {\n                num_bytes_read += rc;\n            }\n            else if (rc == -1)\n            {\n                printf(\"Read error %s\\n\",strerror(errno));\n            }\n            else \n            {}\n        }\n\n        //add data to logging queue\n        add_to_queue(buf, num_bytes_read);\n    }\n\n    fclose(log_fh);\n    return 0;\n}\n\n</code></pre>\n\n<ol>\n<li>Reads from serial adds to queue</li>\n<li>Second thread reads from queue and writes to disk</li>\n</ol>\n\n<p>A python script post processes the output file to check to see if the data it corrupted. This is run on a separate PC after the test has finished so has no bearing on load. I know this script is fine at parsing data.</p>\n\n<p>There are three things that I have tested and cannot explain</p>\n\n<ol>\n<li>VMIN = 200 and no background load = Corrupted data  in the binary file </li>\n<li>VMIN = 0 and no background load = <strong>NO</strong> Corrupted data in the binary file </li>\n<li>VMIN = 200 and background load = <strong>NO</strong> Corrupted data in the binary file</li>\n</ol>\n\n<p>Setting VMIN to zero increases the CPU load (as the read loop is running much faster, as the read function is returning 0 quite frequently). Therefore I am unsure if it is actually VMIN causing the issue or more that increasing the CPU load makes the read behave normally. </p>\n\n<p>To retiterate, it is not the decode function. That function works perfectly from the file in the no corrupted data cases above.</p>\n"}, {"tags": ["c", "memory", "terminal"], "comments": [{"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1574258611, "post_id": 58956121, "comment_id": 104167942, "body": "<a href=\"https://en.wikipedia.org/wiki/Segmentation_fault\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Segmentation_fault</a>"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1574258638, "post_id": 58956121, "comment_id": 104167964, "body": "and <a href=\"https://en.wikipedia.org/wiki/Core_dump\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Core_dump</a> ...."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1574258776, "post_id": 58956121, "comment_id": 104168050, "body": "Your process was terminated by a fatal signal and wrote a process memory image for use with a (post-mortem)-debugger"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1574258924, "post_id": 58956121, "comment_id": 104168139, "body": "When you ask a question on Stack Overflow, SO will suggest duplicates based on your question title. You should at least casually look into these if they would answer your question."}], "answers": [{"comments": [{"owner": {"reputation": 67968, "user_id": 584192, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YBSIc.png?s=128&g=1", "display_name": "Samuel Liew", "link": "https://stackoverflow.com/users/584192/samuel-liew"}, "edited": false, "score": 0, "creation_date": 1574283521, "post_id": 58956247, "comment_id": 104181610, "body": "Comments are not for extended discussion; this conversation has been <a href=\"https://chat.stackoverflow.com/rooms/202757/discussion-on-answer-by-ikegami-what-does-the-term-segmentation-fault-core-dum\">moved to chat</a>."}], "tags": [], "owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": false, "score": 2, "last_activity_date": 1574263830, "last_edit_date": 1574263830, "creation_date": 1574258770, "answer_id": 58956247, "question_id": 58956121, "link": "https://stackoverflow.com/questions/58956121/what-does-the-term-segmentation-fault-core-dumped-mean/58956247#58956247", "title": "What does the term &#39;Segmentation fault (core dumped)&#39; mean?", "body": "<p><a href=\"https://en.wikipedia.org/wiki/Segmentation_fault\" rel=\"nofollow noreferrer\">Quoting</a> Wikipedia,</p>\n\n<blockquote>\n  <p>In computing, a segmentation fault (often shortened to segfault) or access violation is a fault, or failure condition, raised by hardware with memory protection, notifying an operating system (OS) the software has attempted to access a restricted area of memory (a memory access violation).</p>\n</blockquote>\n\n<p>For example, the following will result in a segmentation fault on machines with memory protection (such as the one you are using right now):</p>\n\n<pre><code>char* s = NULL;\nsize_t len = 0;\nfor (size_t i=0; s[i]; ++i) { // SEGFAULT: s[i] tries to dereference a NULL\n   ++len;\n}\n</code></pre>\n\n<hr>\n\n<p><a href=\"https://en.wikipedia.org/wiki/Core_dump\" rel=\"nofollow noreferrer\">Quoting</a> Wikipedia,</p>\n\n<blockquote>\n  <p>In computing, a core dump, crash dump, memory dump, or system dump consists of the recorded state of the working memory of a computer program at a specific time, generally when the program has crashed or otherwise terminated abnormally. In practice, other key pieces of program state are usually dumped at the same time, including the processor registers, which may include the program counter and stack pointer, memory management information, and other processor and operating system flags and information.</p>\n</blockquote>\n\n<p>Having a core dump allows one to debug a program that crashed earlier. Note that the actual creation of the code dump is often skipped (for privacy, security and space reasons) unless a setting is enabled.</p>\n\n<hr>\n\n<p>There was a discussion in the comments as to whether it's fair to say that a program crashes or not.</p>\n\n<p>The process is what is receiving the SIGSEGV signal, and it's what is being dumped, so it's fair to say \"<em>the process crashed</em>\".</p>\n\n<p>As the driving force of the process, the instructions being executed by the process can be said to cause the crash. The collection of these instructions are known as \"the program\", so it's fair to say \"<em>the program crashed</em>\".</p>\n\n<p>Both expressions are valid and refer to the same event.</p>\n"}, {"comments": [{"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1574259120, "post_id": 58956329, "comment_id": 104168258, "body": "Hm, how could this answer be posted after the question was closed?"}, {"owner": {"reputation": 94, "user_id": 6625422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd174255eb17c254506526bc4c8720f3?s=128&d=identicon&r=PG&f=1", "display_name": "Henry Fung", "link": "https://stackoverflow.com/users/6625422/henry-fung"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1574263423, "post_id": 58956329, "comment_id": 104171084, "body": "No idea. It wasn&#39;t closed when I was writing it."}], "tags": [], "owner": {"reputation": 94, "user_id": 6625422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd174255eb17c254506526bc4c8720f3?s=128&d=identicon&r=PG&f=1", "display_name": "Henry Fung", "link": "https://stackoverflow.com/users/6625422/henry-fung"}, "is_accepted": false, "score": 2, "last_activity_date": 1574259049, "creation_date": 1574259049, "answer_id": 58956329, "question_id": 58956121, "link": "https://stackoverflow.com/questions/58956121/what-does-the-term-segmentation-fault-core-dumped-mean/58956329#58956329", "title": "What does the term &#39;Segmentation fault (core dumped)&#39; mean?", "body": "<p>It happens when you are <em>trying to access an invalid address</em>. It may look like this:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>int* a;\n*a = 4;\n</code></pre>\n\n<p>Or this:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>struct s {\n  int a;\n}\n\nint main() {\n  struct s* foo;\n  foo-&gt;a = 4;\n}\n</code></pre>\n\n<p>The variable <code>a</code> in the first example and <code>foo</code> in the second example are not initialised. They don\u2019t point to any memory. If you try to assign a value to it, a Segmentation Fault will occur and your program crashes.</p>\n\n<p>The correct way is to first initialise it.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>int* a = malloc(sizeof(int));\n*a = 4;\n// ...\nfree(a);\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10914878, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-l_U4IS3vozY/AAAAAAAAAAI/AAAAAAAAAAo/06dr0Tv00Y4/photo.jpg?sz=128", "display_name": "koustav das", "link": "https://stackoverflow.com/users/10914878/koustav-das"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2164, "favorite_count": 0, "closed_date": 1574258857, "answer_count": 2, "score": -3, "last_activity_date": 1574263830, "creation_date": 1574258453, "question_id": 58956121, "link": "https://stackoverflow.com/questions/58956121/what-does-the-term-segmentation-fault-core-dumped-mean", "closed_reason": "Duplicate", "title": "What does the term &#39;Segmentation fault (core dumped)&#39; mean?", "body": "<p>I have seen it sometimes. But I did not understand the meaning of this term.</p>\n"}, {"tags": ["c", "data-structures", "header", "structure"], "answers": [{"comments": [{"owner": {"reputation": 134, "user_id": 6876860, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-m8QHM2bgZFs/AAAAAAAAAAI/AAAAAAAABD4/H04KOxcMRFg/photo.jpg?sz=128", "display_name": "Deepak Pawade", "link": "https://stackoverflow.com/users/6876860/deepak-pawade"}, "edited": false, "score": 0, "creation_date": 1574258818, "post_id": 58956189, "comment_id": 104168072, "body": "so passing MAX as a parameter to initStack would do the trick?"}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 1, "last_activity_date": 1574258612, "creation_date": 1574258612, "answer_id": 58956189, "question_id": 58956084, "link": "https://stackoverflow.com/questions/58956084/howw-to-dynamically-set-size-of-an-array-in-an-header-file-from-outside-the-head/58956189#58956189", "title": "Howw to dynamically set size of an array in an header file from outside the header file in c?", "body": "<p>You structure contains what is called a <strong>flexible array member</strong>.  Such a structure can be created by dynamically allocating space for the struct plus the desired size of the flexible array member.</p>\n\n<pre><code>struct stack{\n    int top;\n    char data[];\n} *s;\n\nvoid initStack()\n{\n    s = malloc(sizeof(struct stack) + MAX * sizeof(char));\n}\n</code></pre>\n"}], "owner": {"reputation": 134, "user_id": 6876860, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-m8QHM2bgZFs/AAAAAAAAAAI/AAAAAAAABD4/H04KOxcMRFg/photo.jpg?sz=128", "display_name": "Deepak Pawade", "link": "https://stackoverflow.com/users/6876860/deepak-pawade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 1, "accepted_answer_id": 58956189, "answer_count": 1, "score": 0, "last_activity_date": 1574258612, "creation_date": 1574258330, "question_id": 58956084, "link": "https://stackoverflow.com/questions/58956084/howw-to-dynamically-set-size-of-an-array-in-an-header-file-from-outside-the-head", "title": "Howw to dynamically set size of an array in an header file from outside the header file in c?", "body": "<pre><code>//stack.h \nstruct stack{\n    int top;\n    char data[];   //set the size of this array\n}s;\n\nvoid init(){    \n    s.top = -1;\n}\n\nint isFull(){\n    return (s.top==MAX-1) ? 1 : 0;\n}\n\n int isEmpty(){\n    return (s.top==-1) ? 1 : 0;\n}   \n\nvoid push(char ch){\n    if(!isFull()){\n        s.data[++s.top] = ch;\n    }else{\n        printf(\"\\n The stack is full\\n\");\n    }\n}\n\n char pop(){\n    return (!isEmpty()) ? s.data[s.top--] : '\\0';\n}\n</code></pre>\n\n<p>I want to implement this stack in an header file and want to set the size of the data array from outside.I Know this is an header file and its of no use if we change the header variables, but still am curious.</p>\n"}, {"tags": ["c++", "c", "gcc"], "answers": [{"tags": [], "owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "is_accepted": false, "score": 1, "last_activity_date": 1574258469, "creation_date": 1574258469, "answer_id": 58956133, "question_id": 58956003, "link": "https://stackoverflow.com/questions/58956003/how-to-enable-werror-using-gcc-pragma/58956133#58956133", "title": "How to enable -Werror using GCC pragma?", "body": "<p>For this case, you can use</p>\n\n<pre><code>#pragma GCC diagnostic error \"-Wincompatible-pointer-types\"\n</code></pre>\n\n<p>as for example in</p>\n\n<pre><code>#pragma GCC diagnostic error \"-Wincompatible-pointer-types\"\nvoid foo(int * a)\n{\n}\n\nvoid bar() {\n        foo(\"foo\");\n}\n</code></pre>\n\n<p>Using <code>-Wall</code> with this pragma is not supported. Only diagnostic options are supported, that are shown with <code>-fdiagnostics-show-option</code> (which is the default today anyway), as in your example warning above.</p>\n"}, {"tags": [], "owner": {"reputation": 238, "user_id": 4095104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b0868543591a528f3c39136447fc94d?s=128&d=identicon&r=PG", "display_name": "L29Ah", "link": "https://stackoverflow.com/users/4095104/l29ah"}, "is_accepted": false, "score": 0, "last_activity_date": 1575514641, "creation_date": 1575514641, "answer_id": 59187537, "question_id": 58956003, "link": "https://stackoverflow.com/questions/58956003/how-to-enable-werror-using-gcc-pragma/59187537#59187537", "title": "How to enable -Werror using GCC pragma?", "body": "<p>As a workaround, it turns out the current semantic of <code>-Wall</code> option is described in the man page, in my case of gcc-8.3.0 it says that it enables the following options that could be used with the pragma afterwards:</p>\n\n<blockquote>\n  <p>-Waddress -Warray-bounds=1 (only with -O2) -Wbool-compare -Wbool-operation -Wc++11-compat  -Wc++14-compat -Wcatch-value (C++ and Objective-C++ only) -Wchar-subscripts -Wcomment -Wduplicate-decl-specifier (C and Objective-C\n       only) -Wenum-compare (in C/ObjC; this is on by default in C++) -Wformat -Wint-in-bool-context -Wimplicit (C and Objective-C only) -Wimplicit-int (C and Objective-C only) -Wimplicit-function-declaration (C and Objective-C\n       only) -Winit-self (only for C++) -Wlogical-not-parentheses -Wmain (only for C/ObjC and unless -ffreestanding) -Wmaybe-uninitialized -Wmemset-elt-size -Wmemset-transposed-args -Wmisleading-indentation (only for C/C++)\n       -Wmissing-attributes -Wmissing-braces (only for C/ObjC) -Wmultistatement-macros -Wnarrowing (only for C++) -Wnonnull -Wnonnull-compare -Wopenmp-simd -Wparentheses -Wpointer-sign -Wreorder -Wrestrict -Wreturn-type\n       -Wsequence-point -Wsign-compare (only in C++) -Wsizeof-pointer-div -Wsizeof-pointer-memaccess -Wstrict-aliasing -Wstrict-overflow=1 -Wstringop-truncation -Wswitch -Wtautological-compare -Wtrigraphs -Wuninitialized\n    -Wunknown-pragmas -Wunused-function -Wunused-label -Wunused-value -Wunused-variable -Wvolatile-register-var</p>\n</blockquote>\n\n<p>It's likely that the list may change with time. On the other hand, <code>diagnostic error</code>ing over a version-dependent list may be a bad idea as it may break compilation for users that are likely to use some other versions of the toolchain than developers do (that <code>-Werror</code> is infamous for), so explicitly listing the desired warnings is good for public relations.</p>\n"}], "owner": {"reputation": 238, "user_id": 4095104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b0868543591a528f3c39136447fc94d?s=128&d=identicon&r=PG", "display_name": "L29Ah", "link": "https://stackoverflow.com/users/4095104/l29ah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 305, "favorite_count": 0, "answer_count": 2, "score": 5, "last_activity_date": 1575514641, "creation_date": 1574258037, "question_id": 58956003, "link": "https://stackoverflow.com/questions/58956003/how-to-enable-werror-using-gcc-pragma", "title": "How to enable -Werror using GCC pragma?", "body": "<p>I have a few files where i'd like to be strict about warnings, and i use GCC to build my project.</p>\n\n<p>I've tried <code>#pragma GCC diagnostic error \"-Wall\"</code> as per <a href=\"https://gcc.gnu.org/onlinedocs/gcc-4.7.2/gcc/Diagnostic-Pragmas.html\" rel=\"noreferrer\">https://gcc.gnu.org/onlinedocs/gcc-4.7.2/gcc/Diagnostic-Pragmas.html</a>, but it fails to account for some other enabled warning types:</p>\n\n<pre><code>foo.c:666:6: warning: passing argument 2 of 'bar' from incompatible pointer type [-Wincompatible-pointer-types]\n</code></pre>\n\n<p>Is there a way to enable -Werror for the file like it was supplied from the command line (or, at least, for the implicitly enabled set of warnings), so any warning would trigger an error?</p>\n"}, {"tags": ["c", "sockets", "udp", "winsock", "ioctl"], "comments": [{"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1574257661, "post_id": 58955812, "comment_id": 104167346, "body": "You have a UDP connection. When the client closes the connection, exactly nothing happens on the network. So, a <code>recvfrom()</code>  would block waiting for data, not return <code>-1</code>. What is the error message you observe?"}, {"owner": {"reputation": 37, "user_id": 12256357, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hbJeG8z2DiM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc6zR4iQsqdXOGH_EJUIUzboDiOcg/photo.jpg?sz=128", "display_name": "barbaros", "link": "https://stackoverflow.com/users/12256357/barbaros"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1574259487, "post_id": 58955812, "comment_id": 104168500, "body": "@Ctx In Ioctl function sizebufferdata is returned 1 when connection broken. I think it must be 0 or -1."}, {"owner": {"reputation": 11893, "user_id": 12098405, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C7IUyuZ5qqE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rehqQyGdh463Xz2DY8S4TYPhnDvzA/photo.jpg?sz=128", "display_name": "dash-o", "link": "https://stackoverflow.com/users/12098405/dash-o"}, "edited": false, "score": 0, "creation_date": 1574272199, "post_id": 58955812, "comment_id": 104176195, "body": "Did you close the UDP client program, or the UDP connection in the server ?"}, {"owner": {"reputation": 37, "user_id": 12256357, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hbJeG8z2DiM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc6zR4iQsqdXOGH_EJUIUzboDiOcg/photo.jpg?sz=128", "display_name": "barbaros", "link": "https://stackoverflow.com/users/12256357/barbaros"}, "edited": false, "score": 0, "creation_date": 1574313150, "post_id": 58955812, "comment_id": 104189910, "body": "I closed UDP client program. I hoped return -1 or 0 in ioctlsocket(ServerSocket, FIONREAD, &amp;sizebufferdata). But it was 1."}], "owner": {"reputation": 37, "user_id": 12256357, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hbJeG8z2DiM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc6zR4iQsqdXOGH_EJUIUzboDiOcg/photo.jpg?sz=128", "display_name": "barbaros", "link": "https://stackoverflow.com/users/12256357/barbaros"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574257587, "creation_date": 1574257458, "last_edit_date": 1574257587, "question_id": 58955812, "link": "https://stackoverflow.com/questions/58955812/why-does-ioctl-function-with-fionread-set-argp-parameter-to-1-without-any-messag", "title": "Why does ioctl function with FIONREAD set argp parameter to 1 without any message?", "body": "<pre><code>int8_t RecvData(){\n\nif (ioctlsocket(ServerSocket, FIONREAD, &amp;sizebufferdata) != NO_ERROR)\n{\n    printf(\"Server: ioctlsocket reading failed with error: %u\\n\", WSAGetLastError());\n    closesocket(ServerSocket);\n    WSACleanup();\n\n    return(-1);\n}\n\nif (sizebufferdata != 0)\n{\n    printf(\"%d\\n\", sizebufferdata);\n    char *ReceiveBuffer = (char *)malloc(sizebufferdata * sizeof(char));\n    ReceivedDataLen = recvfrom(ServerSocket, ReceiveBuffer, sizebufferdata, 0, (struct sockaddr \n*)&amp;ClientAddr, &amp;ClientLen);\n\nif (ReceivedDataLen == SOCKET_ERROR)\n{\n    printf(\"Server: recvfrom failed with error %u\\n\", WSAGetLastError());\n    free(ReceiveBuffer);\n    closesocket(ServerSocket);\n    WSACleanup();\n\n    return(-1);\n    }\n}\n</code></pre>\n\n<p>I'm constantly calling the RecvData() function and using non-blocking. When I send data from the UDP client, sizebufferdata returns the correct value. However, when I close the UDP client program, sizebufferdata incorrectly returns a value of 1. At the same time, the Recvfrom function works correctly by giving -1 on its return. \nWhy does ioctl return  1 when UDP client closed?</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1574257114, "post_id": 58955668, "comment_id": 104167010, "body": "Read about array decay."}, {"owner": {"reputation": 1490, "user_id": 4562521, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/efoWu.png?s=128&g=1", "display_name": "christian mini", "link": "https://stackoverflow.com/users/4562521/christian-mini"}, "edited": false, "score": 0, "creation_date": 1574257395, "post_id": 58955668, "comment_id": 104167198, "body": "sizeof(array) return the size of int pointer, in your case 8 because array is declared as int*."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1574258263, "post_id": 58955668, "comment_id": 104167718, "body": "An array is not a pointer and a pointer is not an array."}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 3, "last_activity_date": 1574257153, "creation_date": 1574257153, "answer_id": 58955731, "question_id": 58955668, "link": "https://stackoverflow.com/questions/58955668/array-size-is-initializing-as-8-no-matter-what-data-size-is-used-for-allocation/58955731#58955731", "title": "Array size is initializing as 8 no matter what Data Size is used for allocation", "body": "<p>The type of <code>array</code> is <code>int *</code>, so <code>sizeof(array)</code> evaluates to the size of an <code>int *</code>, <em>not</em> what it points to.</p>\n\n<p>The size of the memory block that was allocated it exactly what you passed to <code>malloc</code>, namely <code>arraySizes[j] * sizeof(int)</code>.  That's something you need to keep track of yourself.</p>\n\n<p>For the same reason, <code>sizeof(array)/sizeof(array[0]);</code>  won't do what you expect.  This will only work if <code>array</code> has array type, not pointer type.</p>\n"}, {"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": -1, "last_activity_date": 1574257242, "creation_date": 1574257242, "answer_id": 58955766, "question_id": 58955668, "link": "https://stackoverflow.com/questions/58955668/array-size-is-initializing-as-8-no-matter-what-data-size-is-used-for-allocation/58955766#58955766", "title": "Array size is initializing as 8 no matter what Data Size is used for allocation", "body": "<ol>\n<li><code>void fillArray_int(int arr[], int dataSize)</code>\nIt is not possible to do it this way. Arrays are passed as reference - ie pointers. And the pointer size in your system is 8 bytes.</li>\n</ol>\n\n<p>2.\n<code>array</code> is just the pointer - and sizeof of pointer is in your case 8 (64 bits system)</p>\n"}], "owner": {"reputation": 1, "user_id": 12226874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7769f5ed71d19d578db5ba934cf38a5?s=128&d=identicon&r=PG&f=1", "display_name": "sannic19", "link": "https://stackoverflow.com/users/12226874/sannic19"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "closed_date": 1574261252, "accepted_answer_id": 58955731, "answer_count": 2, "score": -2, "last_activity_date": 1574261271, "creation_date": 1574256957, "last_edit_date": 1574257122, "question_id": 58955668, "link": "https://stackoverflow.com/questions/58955668/array-size-is-initializing-as-8-no-matter-what-data-size-is-used-for-allocation", "closed_reason": "Duplicate", "title": "Array size is initializing as 8 no matter what Data Size is used for allocation", "body": "<p>I am working on a school project which fills integers arrays with random numbers then sorts them and records the times. I've gotten the sorting functions to work but I'm running into an issue when making the arrays. The project instructions tell us to declare the array with:  </p>\n\n<pre><code>int * array = (int *) malloc (arraySizes[i] * sizeof(int));\n</code></pre>\n\n<p><strong>arraySizes</strong> is an array with the lengths of the arrays we are making in them i.e. [1000, 2000, 3000] </p>\n\n<p>When I run the program it does make a random number with the fill function but no matter the data size, the array is initialized with a length of 8. Is there anything I am doing wrong with my array initialization? </p>\n\n<p>Attached below is the function that initializes the array and the function that fills the array with random numbers. The main function is just used for picking between int arrays and string arrays, which I have a group partner working on string arrays. </p>\n\n<pre><code>    void Int_Arrays(){\n\n    //printf(\"Size          Trial[0]        Trial[1]        Trial[2]        Trial[3]        Trial[4]     Average\\n\");\n       Node *head = NULL;    // for storing times\n        int i;\n        int j;\n        int m;\n        for(j = 0; j &lt; numTrials; j++){\n            int dataSize;\n            dataSize = arraySizes[j];\n            printf(\"DataSize: %d\\n\", dataSize);// for debugging \n            int * array = (int *) malloc (arraySizes[j] * sizeof(int));\n            printf(\"Inital array size: %d\\n\", sizeof(array));// for debugging\n            printf(\"%d  \", arraySizes[j]);\n        fillArray_int(array, arraySizes[j]);  \n        int n = sizeof(array)/sizeof(array[0]);\n        //printf(\"array size: %d\\n\", sizeof(array));\n        for (i = 0; i &lt; sizeof(array); i++){     \n                  printf(\"%d \", array[i]);\n        }\n        printf(\"\\n\");\n        for (m = 1; m &lt;= 5; m++){     \n        //runSort_Int(array, n); // runs sorting functions\n        }\n       double avg = avgTime(head); // calculates time averages\n      // printf(\"     %lf\", &amp;avg);\n       // printf(\"\\n\");\n        free(array);\n\n   }\n\n}\n\n    void fillArray_int(int arr[], int dataSize)\n    {\n        printf(\"Data Size: %d\\n\", dataSize); // for debugging\n        printf(\"array size: %d\\n\", sizeof(arr)); // for debugging\n        int i = 0;\n        srand(time(0));\n        while (i &lt; dataSize)\n        {\n            arr[i] = 0;\n\n             int r = (randNum()% 9) + 1;\n\n            arr[i] = r;\n            i++;\n        } \n\n    }\n</code></pre>\n"}, {"tags": ["c", "pointers", "segmentation-fault"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 5, "creation_date": 1574256940, "post_id": 58955628, "comment_id": 104166902, "body": "<code>sizeof(int) != sizeof(int*)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 758, "user_id": 7943285, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10212581786924324/picture?type=large", "display_name": "Kaan Taha K&#246;ken", "link": "https://stackoverflow.com/users/7943285/kaan-taha-k%c3%b6ken"}, "edited": false, "score": 0, "creation_date": 1574257376, "post_id": 58955659, "comment_id": 104167189, "body": "If I do not use casting in front of the variable, It does not let me compile. Since I started university, I used this convention, I wrote above. they showed like this. That&#39;s, why I confused"}, {"owner": {"reputation": 758, "user_id": 7943285, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10212581786924324/picture?type=large", "display_name": "Kaan Taha K&#246;ken", "link": "https://stackoverflow.com/users/7943285/kaan-taha-k%c3%b6ken"}, "edited": false, "score": 0, "creation_date": 1574257388, "post_id": 58955659, "comment_id": 104167195, "body": "Thank you for your help"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 758, "user_id": 7943285, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10212581786924324/picture?type=large", "display_name": "Kaan Taha K&#246;ken", "link": "https://stackoverflow.com/users/7943285/kaan-taha-k%c3%b6ken"}, "edited": false, "score": 1, "creation_date": 1574257687, "post_id": 58955659, "comment_id": 104167375, "body": "@KaanTahaK&#246;ken: &quot;<i>If I do not use casting in front of the variable, It does not let me compile.</i>&quot; you then do not use a standard compliant C compiler, perhaps a C++ compiler?"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 3, "last_activity_date": 1574257272, "last_edit_date": 1574257272, "creation_date": 1574256926, "answer_id": 58955659, "question_id": 58955628, "link": "https://stackoverflow.com/questions/58955628/the-address-of-double-pointer-is-deleted-after-assign-some-variable/58955659#58955659", "title": "The address of double pointer is deleted after assign some variable", "body": "<p>The problem as I see it is</p>\n\n<pre><code>bucket = (int **)malloc(sizeof(int) * 10);\n</code></pre>\n\n<p>it should rather be</p>\n\n<pre><code>bucket = malloc (sizeof(*bucket) * 10);  // take the size from the target variable itself\n</code></pre>\n\n<p>In case, in your platform, <code>sizeof (int*)</code> is less than <code>sizeof(int)</code>, you'll end up having memory overrun while accessing <code>bucket</code>, thereby invoking undefined behaviour.</p>\n\n<p>Notes:</p>\n\n<ol>\n<li><a href=\"https://stackoverflow.com/q/605845/2173917\">No need to cast the return value of <code>malloc()</code> and family.</a></li>\n<li>Better not to use a hard-coded type for size calculation.</li>\n</ol>\n"}], "owner": {"reputation": 758, "user_id": 7943285, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10212581786924324/picture?type=large", "display_name": "Kaan Taha K&#246;ken", "link": "https://stackoverflow.com/users/7943285/kaan-taha-k%c3%b6ken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "closed_date": 1574261407, "accepted_answer_id": 58955659, "answer_count": 1, "score": -3, "last_activity_date": 1574261456, "creation_date": 1574256824, "question_id": 58955628, "link": "https://stackoverflow.com/questions/58955628/the-address-of-double-pointer-is-deleted-after-assign-some-variable", "closed_reason": "Duplicate", "title": "The address of double pointer is deleted after assign some variable", "body": "<p>I have an interesting problem after allocating a double-pointer.</p>\n\n<pre><code>int **bucket;\nbucket = (int **)malloc(sizeof(int) * 10);\n</code></pre>\n\n<p>I have created a double-pointer without any problem and I have also created a single pointer.</p>\n\n<pre><code>int *size;\nsize = (int *)malloc(sizeof(int) * 10);\n</code></pre>\n\n<p>In the first loop, I allocated each element of <code>bucket</code>, and, second loop, I am assigning zero to every element of <code>size</code>.</p>\n\n<pre><code>for (i = 0; i &lt; 10; i++)\n    *(bucket + i) = (int *)malloc(sizeof(int) * 1);\nfor (i = 0; i &lt; 10; i++)\n    size[i] = 0;\n</code></pre>\n\n<p>When I am doing assign operation to size, It deletes the address of certain elements of the bucket. Here, the screenshots while I am debugging.</p>\n\n<p>In this stage I have not entered the 2nd loop:</p>\n\n<p><a href=\"https://i.stack.imgur.com/g9oGS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/g9oGS.png\" alt=\"enter image description here\"></a></p>\n\n<p>This is after I entered the second loop:\n<a href=\"https://i.stack.imgur.com/3Vkyo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3Vkyo.png\" alt=\"enter image description here\"></a></p>\n\n<p>What can cause this problem? Any thought?</p>\n"}, {"tags": ["c", "visual-studio-code"], "comments": [{"owner": {"reputation": 13228, "user_id": 8398549, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8tzrl.jpg?s=128&g=1", "display_name": "Cid", "link": "https://stackoverflow.com/users/8398549/cid"}, "edited": false, "score": 0, "creation_date": 1574257046, "post_id": 58955597, "comment_id": 104166975, "body": "Maybe use rather VS Community instead ?"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1574265838, "post_id": 58955597, "comment_id": 104172608, "body": "Compile? Does it show up there then?"}], "owner": {"reputation": 51, "user_id": 11643080, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kR07i8duaG0/AAAAAAAAAAI/AAAAAAAAAhQ/A2ZWBtzSGbM/photo.jpg?sz=128", "display_name": "iBRabbit", "link": "https://stackoverflow.com/users/11643080/ibrabbit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574256712, "creation_date": 1574256712, "question_id": 58955597, "link": "https://stackoverflow.com/questions/58955597/how-to-show-error-code-in-c-on-vscode-in-problems-section", "title": "How to show error code in C on Vscode in &quot;Problems&quot; section", "body": "<p>I want to ask how to show an C / C++ error message in problems section. What extension I should install?</p>\n\n<p><a href=\"https://i.stack.imgur.com/AQ3uw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AQ3uw.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "arrays", "split", "strtok"], "comments": [{"owner": {"reputation": 6187, "user_id": 1837823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f80792d86cb08d7a729869f1ed3698c?s=128&d=identicon&r=PG", "display_name": "mikea", "link": "https://stackoverflow.com/users/1837823/mikea"}, "edited": false, "score": 2, "creation_date": 1574256576, "post_id": 58955497, "comment_id": 104166664, "body": "The errors might be ugly but they&#39;d be extremely useful in seeing where this might be failing, so please add them to your question."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1574256593, "post_id": 58955497, "comment_id": 104166675, "body": "<i>&quot;which look too ugly to paste into this&quot;</i> - No, they don&#39;t."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 1, "creation_date": 1574256628, "post_id": 58955497, "comment_id": 104166696, "body": "And how can you expect the word to be printed without trying to print them?"}, {"owner": {"reputation": 33821, "user_id": 45685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/y4RJr.jpg?s=128&g=1", "display_name": "AndersK", "link": "https://stackoverflow.com/users/45685/andersk"}, "edited": false, "score": 0, "creation_date": 1574257684, "post_id": 58955497, "comment_id": 104167369, "body": "since strtok keeps a static copy of your string and modifies it every time you call with strtok(NULL, buf) it is not so surprising. You need to add storage and not just have an array of pointers <code>char* split[MAX]</code> instead of strcpy(split[i],temp)  do <code>split[i] = strdup(temp);</code>"}, {"owner": {"reputation": 195, "user_id": 8902744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea2b2c747d0bebd8b2b714961e356a60?s=128&d=identicon&r=PG&f=1", "display_name": "Jake Jackson", "link": "https://stackoverflow.com/users/8902744/jake-jackson"}, "edited": false, "score": 0, "creation_date": 1574258439, "post_id": 58955497, "comment_id": 104167840, "body": "Sorry, I actually pasted the wrong code. It isn&#39;t much different, but it is my latest attempt. And for the errors, I was hoping someone would just copy my code and compile it themselves -cheeky, I know."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1574259216, "post_id": 58955497, "comment_id": 104168312, "body": "The second argument to <code>split</code> is a pointer to pointers to char (<code>char**</code> or <code>char *[]</code>). But when you call it you provide a pointer to char (<code>char*</code>)"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1574261636, "post_id": 58955497, "comment_id": 104169843, "body": "The first error is in the title. Please check the wording. And terminology. <code>a</code> is a character and is a <i>word</i> too... but it certainly cannot be split into <b>several</b>."}], "answers": [{"comments": [{"owner": {"reputation": 195, "user_id": 8902744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea2b2c747d0bebd8b2b714961e356a60?s=128&d=identicon&r=PG&f=1", "display_name": "Jake Jackson", "link": "https://stackoverflow.com/users/8902744/jake-jackson"}, "edited": false, "score": 0, "creation_date": 1574261720, "post_id": 58956717, "comment_id": 104169899, "body": "Thanks a lot, man. I have asked so many question about this bit of code and only this one has made sense."}], "tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": true, "score": 1, "last_activity_date": 1574260561, "last_edit_date": 1574260561, "creation_date": 1574260236, "answer_id": 58956717, "question_id": 58955497, "link": "https://stackoverflow.com/questions/58955497/how-do-i-split-a-sentence-into-individual-words-using-my-custom-function-split/58956717#58956717", "title": "How do I split a sentence into individual words using my custom function split()?", "body": "<p>There are many issues:</p>\n\n<p>This is what you want. The comments explain what was wrong:</p>\n\n<pre><code>void split(char* buf, char* words[], size_t max) {\n  char* temp = strtok(buf, \" \");\n\n  int i = 0;\n  while (temp != NULL)            // wrong usage of strtok\n  {\n    words[i++] = strdup(temp);    // words[i] points nowhere, you need to allocate memory\n    temp = strtok(NULL, \" \");     // wrong usage of strtok\n  }\n  words[i] = NULL;                // you didn't terminate the words array\n}\n\nint main(int argc, char** argv) {\n  char* buf = malloc(SIZE);        // this could be \"char buf[SIZE];\". It's not wrong\n                                   // but there's no need for dynamically allocating memory here\n\n  char** words = malloc(MAX * sizeof(char*));   // you need to allocate pointers to char, not char\n\n  while (1) {\n    char* input = read_line(buf, SIZE);\n    split(input, words, MAX);\n\n    for (int i = 0; words[i] != NULL; i++) {    // you need to check for the NULL pointer\n      printf(\"%s\\n\", words[i]);                 // not the NUL char\n    }\n  }\n}\n</code></pre>\n\n<p>There is still room for improvement, </p>\n\n<ul>\n<li>the <code>split</code> function doesn't check for <code>max</code>, </li>\n<li>at the end of the program the allocated memory is not properly freed</li>\n<li>there is no error checking whatsoever for brevity</li>\n</ul>\n\n<p><a href=\"https://en.cppreference.com/w/c/experimental/dynamic/strdup\" rel=\"nofollow noreferrer\"><code>strdup</code></a> might not be available on your platform, so you might need to implement it yourself (basically 3 lines of code)</p>\n"}], "owner": {"reputation": 195, "user_id": 8902744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea2b2c747d0bebd8b2b714961e356a60?s=128&d=identicon&r=PG&f=1", "display_name": "Jake Jackson", "link": "https://stackoverflow.com/users/8902744/jake-jackson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 58956717, "answer_count": 1, "score": -2, "last_activity_date": 1597745099, "creation_date": 1574256443, "last_edit_date": 1597745099, "question_id": 58955497, "link": "https://stackoverflow.com/questions/58955497/how-do-i-split-a-sentence-into-individual-words-using-my-custom-function-split", "title": "How do I split a sentence into individual words using my custom function split()?", "body": "<p>I am trying to split the user's input into separate words and then print each word on a newline.</p>\n<p>I have a function <code>split()</code> that tries to take care of split each word using the <code>strtok()</code> method. When I try to loop through the words in the <code>Main()</code> to print them, it simply doesn't.</p>\n<p>After compiling, I get two errors.</p>\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define MAX 10\n#define SIZE 256\n\nchar *read_line(char *buf, size_t sz) {\n  printf(&quot;&gt; &quot;);\n  fgets(buf, sz, stdin);\n  buf[strcspn(buf, &quot;\\n&quot;)] = 0;\n  return buf;\n}\n\nvoid split(char *buf, char *words[], size_t max) {\n  char *temp = strtok(buf, &quot; &quot;);\n\n  for (int i = 0; words[0] != '\\0'; i++) {\n    strcpy(words[i], temp);\n    temp = strtok(NULL, buf);\n  }\n}\n\nint main(int argc, char **argv) {\n  char *buf = malloc(SIZE);\n  char *words = malloc(MAX * sizeof(char));\n\n  while(1) {\n    char *input = read_line(buf, SIZE);\n    split(input, words, MAX);\n\n    for (int i = 0; words[i] != '\\0'; i++) {\n      printf(&quot;%s\\n&quot;, words[i]);\n    }\n  }\n}\n</code></pre>\n<p>Is there something I am doing or not understanding properly?</p>\n"}, {"tags": ["c", "gcc"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1574255895, "post_id": 58955110, "comment_id": 104166278, "body": "<code>library into libLib.a and set SYMBOL=2</code> - how do you do that? How do you &quot;set&quot; &quot;SYMBOL=2&quot;? Show the code."}], "answers": [{"comments": [{"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1574255923, "post_id": 58955233, "comment_id": 104166300, "body": "Well, with <code>#error</code> compilation will fail, so <code>#warning</code> is the better option. If it isn&#39;t supported, the compiler will complain about it too, so it has almost the same effect as <code>#error</code> if it is unsupported ;)"}, {"owner": {"reputation": 1590, "user_id": 3796272, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zqSzP.jpg?s=128&g=1", "display_name": "Kampi", "link": "https://stackoverflow.com/users/3796272/kampi"}, "edited": false, "score": 0, "creation_date": 1574256689, "post_id": 58955233, "comment_id": 104166738, "body": "<code>#warning</code> does work in my case, so I have verified my assumption."}, {"owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "edited": false, "score": 0, "creation_date": 1574256742, "post_id": 58955233, "comment_id": 104166769, "body": "The syntax with the parentheses is not wrong, they are just not needed."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "edited": false, "score": 0, "creation_date": 1574256797, "post_id": 58955233, "comment_id": 104166810, "body": "@thebusybee I did not claim that, but other parts were wrong (else if, endif missing)"}, {"owner": {"reputation": 1590, "user_id": 3796272, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zqSzP.jpg?s=128&g=1", "display_name": "Kampi", "link": "https://stackoverflow.com/users/3796272/kampi"}, "edited": false, "score": 0, "creation_date": 1574256884, "post_id": 58955233, "comment_id": 104166870, "body": "Yeah, you are right. I rewrite this example from my mind and not copy the code new and so I missed it :). I will update my question"}, {"owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "edited": false, "score": 1, "creation_date": 1574256937, "post_id": 58955233, "comment_id": 104166900, "body": "Right, but that hit my eye. Sorry for the noise. Anyway, you might like to expand your answer. ;-)"}], "tags": [], "owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "is_accepted": true, "score": 3, "last_activity_date": 1574256996, "last_edit_date": 1574256996, "creation_date": 1574255670, "answer_id": 58955233, "question_id": 58955110, "link": "https://stackoverflow.com/questions/58955110/preprocessor-symbol-in-library-and-change-the-symbols-value-while-using-the-libr/58955233#58955233", "title": "Preprocessor symbol in library and change the symbols value while using the library", "body": "<p>First of all, the correct syntax for the preprocessor directives is:</p>\n\n<pre><code>static inline void DoStuff(void) __attribute__ ((always_inline));\nstatic inline void DoStuff(void)\n{\n#if SYMBOL == 1\n    // Stuff\n\n#elif SYMBOL == 2\n    // Other stuff   \n\n#endif\n}\n</code></pre>\n\n<p>You can also leave the parentheses around the comparison if you prefer, but it isn't strictly necessary as with the regular <code>if</code> condition.</p>\n\n<p>If you are not sure, which code parts are active, you can use <code>#warning</code> to make it obvious:</p>\n\n<pre><code>#if SYMBOL == 1\n #warning Symbol == 1\n    // Stuff\n\n#elif SYMBOL == 2\n #warning Symbol == 2\n    // Other stuff  \n\n#endif\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 699, "user_id": 7562074, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mYiplUjiang/AAAAAAAAAAI/AAAAAAAAASg/IuJhDArg780/photo.jpg?sz=128", "display_name": "Roy Avidan", "link": "https://stackoverflow.com/users/7562074/roy-avidan"}, "is_accepted": false, "score": 0, "last_activity_date": 1574256245, "creation_date": 1574256245, "answer_id": 58955437, "question_id": 58955110, "link": "https://stackoverflow.com/questions/58955110/preprocessor-symbol-in-library-and-change-the-symbols-value-while-using-the-libr/58955437#58955437", "title": "Preprocessor symbol in library and change the symbols value while using the library", "body": "<p>In C, lines which starts with # are <strong>pre-processed</strong> by the preprocessor, which means that when you compile this, the compiler will read it like this (for example, if <strong>in the library</strong> SYMBOL=1:</p>\n\n<pre><code>static inline void DoStuff(void) __attribute__ ((always_inline));\nstatic inline void DoStuff(void)\n{\n    //only the stuff that were in the block of SYMBOL=1\n}\n</code></pre>\n\n<p>When you compile the code into a library, it no longer knows SYMBOL.\nWhen you change SYMBOL in your code, it will only change it for this project.\nTo resolve this issue, use the macros in a header:</p>\n\n<p>In DoStuff.h:</p>\n\n<pre><code>void __do_stuff1();\nvoid __do_stuff2();\nstatic inline void DoStuff()\n{\n    #if SYMBOL==1\n        __do_stuff1();\n    #elif SYMBOL==2\n        __do_stuff2();\n    #endif\n}\n</code></pre>\n\n<p>In DoStuff.c:</p>\n\n<pre><code>void__do_stuff1(){...}\nvoid __do_stuff2(){...}\n</code></pre>\n"}], "owner": {"reputation": 1590, "user_id": 3796272, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zqSzP.jpg?s=128&g=1", "display_name": "Kampi", "link": "https://stackoverflow.com/users/3796272/kampi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 58955233, "answer_count": 2, "score": 2, "last_activity_date": 1574256996, "creation_date": 1574255281, "last_edit_date": 1574256931, "question_id": 58955110, "link": "https://stackoverflow.com/questions/58955110/preprocessor-symbol-in-library-and-change-the-symbols-value-while-using-the-libr", "title": "Preprocessor symbol in library and change the symbols value while using the library", "body": "<p>I have a library project with a inline function in my <code>Lib.h</code>:</p>\n\n<pre><code> static inline void DoStuff(void) __attribute__ ((always_inline));\n static inline void DoStuff(void)\n {\n #if(SYMBOL == 1)\n     // Stuff\n #elif(SYMBOL == 2)\n     // Other stuff   \n #endif\n}\n</code></pre>\n\n<p>I compile my library into <code>libLib.a</code> and set <code>SYMBOL=2</code>. Now I use this library and the header <code>Lib.h</code> in some other project. This project set <code>SYMBOL=1</code> and calls <code>DoStuff()</code> in this project. Which part of the <code>#if</code> directive gets executed? I assume that the compiler will run the part with <code>#if(SYMBOL == 1)</code> but I\u00b4m not sure. How does the compiler handle it?</p>\n"}, {"tags": ["c", "memmove"], "comments": [{"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 4, "creation_date": 1574253831, "post_id": 58954575, "comment_id": 104165000, "body": "You don&#39;t have an array of arrays, you have an array of pointers. Think about the difference copying the elements of an array and copying a pointer."}, {"owner": {"reputation": 1817, "user_id": 7556604, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hgWR8.jpg?s=128&g=1", "display_name": "Clonk", "link": "https://stackoverflow.com/users/7556604/clonk"}, "edited": false, "score": 2, "creation_date": 1574253927, "post_id": 58954575, "comment_id": 104165056, "body": "memmove is basically memcpy but it&#39;s allows overlap between <code>src</code> and <code>dest</code> pointers (meaning it will also be slower)."}, {"owner": {"reputation": 1220, "user_id": 5878272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14e96159153b67fab5222b7c5fa18c71?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/5878272/fredrik"}, "reply_to_user": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 2, "creation_date": 1574254148, "post_id": 58954575, "comment_id": 104165179, "body": "@molbdnilo he doesn&#39;t have an array of pointers, he has a pointer to pointers."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 3, "creation_date": 1574254183, "post_id": 58954575, "comment_id": 104165199, "body": "Consider using <code>double (*arr)[M] = malloc( sizeof(double[N][M]) );</code> and then <code>memcpy(arr[i], arr[i+1], sizeof(double[M]));</code>. It will be far more cache-friendly and easier to read too."}, {"owner": {"reputation": 19, "user_id": 12403991, "user_type": "registered", "profile_image": "https://graph.facebook.com/2513503585371442/picture?type=large", "display_name": "Florian Aubin", "link": "https://stackoverflow.com/users/12403991/florian-aubin"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1574254727, "post_id": 58954575, "comment_id": 104165554, "body": "Thanks for your quick anwsers.  Indeed, I have a pointer to pointers ! @Lundin I cannot defined my array like <code>double (*arr)[M]</code> because M is a variable.  If I understand well your answers, I can only remove one for loop using: <code>for(int j=i; j&lt;N-1; j++) memcpy(&amp;(Arr[k][0]), &amp;(Arr[k+1][0]), M*sizeof(double));</code>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1574254796, "post_id": 58954575, "comment_id": 104165585, "body": "@FlorianAubin Update your C compiler to a standard one made this millennium and you can."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1574256135, "post_id": 58954575, "comment_id": 104166404, "body": "<code>Theses arrays are full of values</code> Not so full, <code>Arr[N-1]</code> is uninitialized."}], "answers": [{"tags": [], "owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "is_accepted": false, "score": 0, "last_activity_date": 1574255224, "creation_date": 1574255224, "answer_id": 58955090, "question_id": 58954575, "link": "https://stackoverflow.com/questions/58954575/how-does-memmove-on-array-of-pointers-in-c-c-work/58955090#58955090", "title": "How does memmove on array of pointers in C/C++ work?", "body": "<p>The first copies <code>M</code> numbers <code>N-1-i</code> times, and the second copies <code>N-1-i</code> pointers once.<br>\nThat is, if <code>double</code> and <code>double*</code> are the same size, the first copies <code>M</code> times as much memory as the second.<br>\n(And is less cache-friendly.)  </p>\n\n<p>Simplifying to just two pointers:</p>\n\n<pre><code> double *arr = malloc(M * sizeof(double));\n double *arr2 = malloc(M * sizeof(double));\n</code></pre>\n\n<p>the difference is the same as between</p>\n\n<pre><code> for (int k = 0; k &lt; M; k++) arr2[k] = arr[k];\n</code></pre>\n\n<p>and</p>\n\n<pre><code>arr2 = arr;\n</code></pre>\n\n<p>Which one you should use depends on what you're after; copying the pointers or copying the elements.  </p>\n"}, {"tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": false, "score": 0, "last_activity_date": 1574257581, "creation_date": 1574257581, "answer_id": 58955854, "question_id": 58954575, "link": "https://stackoverflow.com/questions/58954575/how-does-memmove-on-array-of-pointers-in-c-c-work/58955854#58955854", "title": "How does memmove on array of pointers in C/C++ work?", "body": "<blockquote>\n  <p>Are there any differences between these 2 lines ?</p>\n</blockquote>\n\n<p>Let's take:</p>\n\n<pre><code>memmove(&amp;(Arr[i]), &amp;(Arr[i+1]), (N-1-i)*sizeof(double*));\n</code></pre>\n\n<p>Basically what it does can be represented by copying byte-by-byte the specified amount of bytes from one pointer to another. So it can be written in this I hope correct code:</p>\n\n<pre><code>for (size_t j = 0; j &lt; (N-1-i)*sizeof(double*); ++j) {\n    *( ((char*)&amp;Arr[i]) + j ) = *( ((char *)(&amp;Arr[i + 1]) + j );\n</code></pre>\n\n<p>Puff, it makes a big technical difference, but let's remove <code>sizeof(double*)</code> and the casts:</p>\n\n<pre><code>for (size_t j = 0; j &lt; N - 1 - i; ++j)\n    *(&amp;Arr[i] + j) = *(&amp;Arr[i + 1] + j);\n</code></pre>\n\n<p>The <code>&amp;Arr[i]</code> is equal to <code>&amp;*(Arr + i)</code> which is equal to <code>Arr + i</code>, so:</p>\n\n<pre><code>for (size_t j = 0; j &lt; N - 1 - i; ++j) {\n    *(Arr + i + j) = *(Arr + i + j + 1);\n</code></pre>\n\n<p>The <code>*(a + i)</code> is equal to <code>a[i]</code>, so we can:</p>\n\n<pre><code>for (size_t j = 0; j &lt; N - 1 - i; ++j) {\n    Arr[i + j] = Arr[i + j + 1];\n</code></pre>\n\n<p>As <code>i + j</code> is on both sides and <code>j</code> starts from <code>0</code>, we could just start from <code>i</code>:</p>\n\n<pre><code>for (size_t j = i; j &lt; N - 1; ++j) {\n    Arr[j] = Arr[j + 1];\n</code></pre>\n\n<p>Now this copies the pointers values(!) from <code>Arr[j + 1]</code> into <code>Arr[j]</code>. This does something very different then copying the values that are pointed to by the pointers:</p>\n\n<pre><code>for(int j = i; j &lt; N - 1; j++)\n    for(int k = 0; k &lt; M; k++)\n         Arr[j][k] = Arr[j + 1][k];\n</code></pre>\n\n<p>On the other hand, the above code could be translated to:</p>\n\n<pre><code>for(int j = i; j &lt; N - 1; j++)\n    memcpy(Arr[j], Arr[j + 1], M * sizeof(double));\n  //^^^^^^ or memove, but I guess not\n</code></pre>\n\n<blockquote>\n  <p>Theses arrays are full of values</p>\n</blockquote>\n\n<p>Your initialization routine that you have showed has this loop:</p>\n\n<pre><code>for(int j = 0; j &lt; N-1; j++)\n   Arr[j] = malloc(M*sizeof(double))\n</code></pre>\n\n<p>Being sane and assuming <code>N &gt; 1</code>, then <code>Arr[N - 1]</code> is left uninitialized. So, accessing in the above loops <code>Arr[j + 1]</code> for the last loop when <code>j = N - 2</code> is accessing uninitialized value. And the loop <code>for(int k = 0; k &lt; M; k++)</code> <code>Arr[j][k] = Arr[j + 1][k];</code> dereferences uninitialized pointer in <code>Arr[j + 1][k]</code> and is undefined behavior.</p>\n"}, {"tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 1, "last_activity_date": 1574258788, "last_edit_date": 1574258788, "creation_date": 1574258417, "answer_id": 58956106, "question_id": 58954575, "link": "https://stackoverflow.com/questions/58954575/how-does-memmove-on-array-of-pointers-in-c-c-work/58956106#58956106", "title": "How does memmove on array of pointers in C/C++ work?", "body": "<blockquote>\n  <p>Are there any differences between these 2 lines ?</p>\n</blockquote>\n\n<p>Yes, they are very different. And the second is leaking memory.</p>\n\n<p>Explanation:</p>\n\n<p>After initialization like:</p>\n\n<pre><code>double **Arr = malloc(N*sizeof(double*));\nfor(int j = 0; j &lt; N; j++)\n  Arr[j] = malloc(M*sizeof(double))\n</code></pre>\n\n<p>(note: I changed the N-1 to N as I assumed it to be a mistake)</p>\n\n<p>The allocated memory now looks like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/cZwmv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cZwmv.png\" alt=\"enter image description here\"></a></p>\n\n<p>When you then do:</p>\n\n<pre><code>for(int j = i; j &lt; N; j++)\n  for(int k = 0; k &lt; M; k++)\n    Arr[j][k] = Arr[j+1][k];\n</code></pre>\n\n<p>You copy the doubles from a horizontal array to the horizontal array above. Like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/sU6If.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sU6If.png\" alt=\"enter image description here\"></a></p>\n\n<p>When you do:</p>\n\n<pre><code>memmove(&amp;(Arr[i]), &amp;(Arr[i+1]), (N-1-i)*sizeof(double*));\n</code></pre>\n\n<p>You copy the double-pointers in the vertical array one position up. Like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ShrAQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ShrAQ.png\" alt=\"enter image description here\"></a></p>\n\n<p>So it's very different operations that the 2 code blocks do.</p>\n\n<p>And the <code>memmove</code> is bad as it leaks memory.</p>\n"}], "owner": {"reputation": 19, "user_id": 12403991, "user_type": "registered", "profile_image": "https://graph.facebook.com/2513503585371442/picture?type=large", "display_name": "Florian Aubin", "link": "https://stackoverflow.com/users/12403991/florian-aubin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 1, "answer_count": 3, "score": 1, "last_activity_date": 1574258788, "creation_date": 1574253566, "last_edit_date": 1574254591, "question_id": 58954575, "link": "https://stackoverflow.com/questions/58954575/how-does-memmove-on-array-of-pointers-in-c-c-work", "title": "How does memmove on array of pointers in C/C++ work?", "body": "<p>I have an array of array like this :</p>\n\n<pre><code>double **Arr = malloc(N*sizeof(double*));\nfor(int j = 0; j &lt; N-1; j++)\n  Arr[j] = malloc(M*sizeof(double))\n</code></pre>\n\n<p>Theses arrays are full of values. And I want to shift some arrays (the N-i last ones). Are there any differences between these 2 lines ?</p>\n\n<pre><code>for(int j = i; j &lt; N-1; j++)\n  for(int k = 0; k &lt; M; k++)\n    Arr[j][k] = Arr[j+1][k];\n</code></pre>\n\n<p>or</p>\n\n<pre><code>memmove(&amp;(Arr[i]), &amp;(Arr[i+1]), (N-1-i)*sizeof(double*));\n</code></pre>\n"}, {"tags": ["c", "linux", "system-calls", "glibc", "libc"], "comments": [{"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1574254534, "post_id": 58954540, "comment_id": 104165427, "body": "Why don&#39;t you use <code>stat()</code> to get the file size?"}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1574255344, "post_id": 58954540, "comment_id": 104165940, "body": "Maybe related, the return types are not correct. Also see the <a href=\"http://man7.org/linux/man-pages/man2/pread.2.html\" rel=\"nofollow noreferrer\"><code>pread (2)</code> man page</a>."}, {"owner": {"reputation": 403, "user_id": 6524000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yqRJp.jpg?s=128&g=1", "display_name": "MajorasKid", "link": "https://stackoverflow.com/users/6524000/majoraskid"}, "edited": false, "score": 0, "creation_date": 1574258458, "post_id": 58954540, "comment_id": 104167850, "body": "Thanks for the comment. I have to adapt it so that I still return a size_t value. I also have another implementation for the get_size (which works fine) but still, this might be a valid case where my code should have the same output as the reference read implementation, which means I should check if the error is my code. But anyway thanks for the suggestion"}, {"owner": {"reputation": 11893, "user_id": 12098405, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C7IUyuZ5qqE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rehqQyGdh463Xz2DY8S4TYPhnDvzA/photo.jpg?sz=128", "display_name": "dash-o", "link": "https://stackoverflow.com/users/12098405/dash-o"}, "edited": false, "score": 0, "creation_date": 1574272298, "post_id": 58954540, "comment_id": 104176239, "body": "How do you intercept the &#39;read&#39; ?"}, {"owner": {"reputation": 403, "user_id": 6524000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yqRJp.jpg?s=128&g=1", "display_name": "MajorasKid", "link": "https://stackoverflow.com/users/6524000/majoraskid"}, "edited": false, "score": 0, "creation_date": 1574322761, "post_id": 58954540, "comment_id": 104193479, "body": "Its a mechanism we developed for an internal project (thus, I cannot disclose it yet, sorry). But the arguments are extraced correctly, as i can just use printf to compare all their values with the parameters I use in my testfile"}, {"owner": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "edited": false, "score": 0, "creation_date": 1574392538, "post_id": 58954540, "comment_id": 104225953, "body": "I&#39;m voting to close this question as off-topic because without an MCVE it&#39;s impossible to know what&#39;s wrong."}, {"owner": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "edited": false, "score": 0, "creation_date": 1574392615, "post_id": 58954540, "comment_id": 104225966, "body": "Running the test under <code>strace</code> may explain what&#39;s going on. But if the interception mechanism itself uses <code>ptrace</code>, then debugging this would be hard."}], "owner": {"reputation": 403, "user_id": 6524000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yqRJp.jpg?s=128&g=1", "display_name": "MajorasKid", "link": "https://stackoverflow.com/users/6524000/majoraskid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 145, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574253449, "creation_date": 1574253449, "question_id": 58954540, "link": "https://stackoverflow.com/questions/58954540/implement-own-read-system-call-using-pread", "title": "Implement own read() system call using pread()", "body": "<p>this question is somewhat related to another <a href=\"https://stackoverflow.com/questions/58952893/why-does-fseek-use-read-system-call#58952893\">question</a> I posted before (I'm posting this here as a new question, as I didnt wanted to interrupt the ongoing discussion in the other thread). I'm trying to implement an own read() implementation using (among others) the pread system call. Note that this is not intended to provide better performance whatsover, but just to check how pread() could be used to achieve the same as read().</p>\n\n<p>I'm intercepting the read() execution, and forward it to my own read_handler(). There I will extract the parameters from their respective registers and execute my mapping.</p>\n\n<pre><code>static volatile int read_handler(void){\n\n    register void *rdi asm (\"rdi\");\n    register void *rsi asm (\"rsi\");\n    register void *rdx asm (\"rdx\");\n\n    int fd = rdi;\n    char *buf = rsi;\n    int count = rdx;\n    printf(\"[OWN_READ] Got read(%d, %p, %d)\\n\", fd,buf, count);\n\n    int current_offset = lseek(fd, 0, SEEK_CUR);\n\n    int pread_return = pread(fd,buf,count,current_offset);\n\n    //set fd offset, as pread will NOT change it automatically\n    lseek(fd, current_offset+pread_return, SEEK_CUR);  \n\n    return pread_return;\n}\n</code></pre>\n\n<p>So, first I extract the parameter from the register, which works fine. Next i get the current file offset (as pread will not change the offset according to the man page). I call pread using the same parameters, in addition to the current offset defined by the file itself. Next, I update the file offset using lseek and return the number of bytes.</p>\n\n<p>As stated in my previous question, a read() call within fseek will somehow break my read implementation. I had a function to get the current file size, which was as follows:</p>\n\n<pre><code>long get_file_size(const char *name)\n{\n    FILE *temp_file = fopen(name, \"rb\");\n    if (temp_file == NULL)\n    {\n        return -1;\n    }\n\n    fseek(temp_file, 0L, SEEK_END);\n    long sz =  ftell(temp_file);\n    fclose(temp_file);\n    return sz;\n}\n</code></pre>\n\n<p>When I execute this function using the reference read() implementation, it returns the correct file size. My implementation on the other hand forces the get_file_size function to always return double the actually size. </p>\n\n<p>My understanding of read() and pread() is that the main difference (regarding the functionality to read from a file) is that pread will not update the file offset, which I added in my implementation using lseek. Thus, (for now not including corner cased) my implementation should work just as the reference implementation.</p>\n\n<p>Additonally (if it is helpfull), this \"get_file_size\" function works just fine:</p>\n\n<pre><code>unsigned long get_file_size()\n{\n    const char *text_file = \"/tmp/syscalltest/tests/truncate_test.txt\";\n    int fd = open(text_file, O_RDONLY);\n    unsigned int size = lseek(fd, 0 , SEEK_END);\n    printf(\"[FILE SIZE] Current file size: %d\\n\",size );\n    close(fd);\n    return size;\n}\n</code></pre>\n\n<p>My goal with this test is to check if pread() can produce the same output as a read() call. I tried to verify this by executing various test files, including on that will use the above get_file_size. In my previous question it was hinted that maybe my read() implementation has an error, which will force the get_file_size() to produce wrong results. I'm trying to understand if I have to check my read() implementation, or if the error is caused by the undefined behaviour of the use of fseek in the function. Thanks for any hints on which part might cause an error here.</p>\n"}, {"tags": ["c", "fork"], "comments": [{"owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "edited": false, "score": 0, "creation_date": 1574252835, "post_id": 58953988, "comment_id": 104164410, "body": "<i>The child process is skiped, idk why ?</i> Child process runs, you may not see the <code>printf()</code> output on your console due to the fact that its buffered IO. You need to use <code>&#39;\\n</code> to flush the buffer or use <code>fflush()</code>. Try <code>printf(&quot;CHILD PROCESS\\n&quot;);</code>"}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 12343347, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-95HwbuAueHc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reRen-dkEeEgaeusgHaEzgWV0Cn1w/photo.jpg?sz=128", "display_name": "MrSano43", "link": "https://stackoverflow.com/users/12343347/mrsano43"}, "edited": false, "score": 0, "creation_date": 1574253882, "post_id": 58954353, "comment_id": 104165032, "body": "It works, any idea why the execl isnt executing, i mean the &quot;verificador&quot; should be working now right?"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 29, "user_id": 12343347, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-95HwbuAueHc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reRen-dkEeEgaeusgHaEzgWV0Cn1w/photo.jpg?sz=128", "display_name": "MrSano43", "link": "https://stackoverflow.com/users/12343347/mrsano43"}, "edited": false, "score": 0, "creation_date": 1574254211, "post_id": 58954353, "comment_id": 104165216, "body": "@MrSano43 How do you know it is not executing? You&#39;re not checking the return value at all."}, {"owner": {"reputation": 29, "user_id": 12343347, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-95HwbuAueHc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reRen-dkEeEgaeusgHaEzgWV0Cn1w/photo.jpg?sz=128", "display_name": "MrSano43", "link": "https://stackoverflow.com/users/12343347/mrsano43"}, "edited": false, "score": 0, "creation_date": 1574262448, "post_id": 58954353, "comment_id": 104170387, "body": "The verificador program receive the word from stdin and then it should be running after the exec no?"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 29, "user_id": 12343347, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-95HwbuAueHc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reRen-dkEeEgaeusgHaEzgWV0Cn1w/photo.jpg?sz=128", "display_name": "MrSano43", "link": "https://stackoverflow.com/users/12343347/mrsano43"}, "edited": false, "score": 0, "creation_date": 1574264698, "post_id": 58954353, "comment_id": 104171878, "body": "@MrSano43 I have absolutely no way of continuing the debugging since I don&#39;t have that file on my computer."}, {"owner": {"reputation": 29, "user_id": 12343347, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-95HwbuAueHc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reRen-dkEeEgaeusgHaEzgWV0Cn1w/photo.jpg?sz=128", "display_name": "MrSano43", "link": "https://stackoverflow.com/users/12343347/mrsano43"}, "edited": false, "score": 0, "creation_date": 1574268681, "post_id": 58954353, "comment_id": 104174302, "body": "Added the &quot;verificador&quot; code , check it if you can, thanks in advance."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 29, "user_id": 12343347, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-95HwbuAueHc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reRen-dkEeEgaeusgHaEzgWV0Cn1w/photo.jpg?sz=128", "display_name": "MrSano43", "link": "https://stackoverflow.com/users/12343347/mrsano43"}, "edited": false, "score": 0, "creation_date": 1574282848, "post_id": 58954353, "comment_id": 104181314, "body": "@MrSano43 It does not work that way. Now we have figured out that the child process indeed runs. SO is not for iterative solutions. It&#39;s made for good QA-pairs. After you got this solved you should spend at least half a day trying to debug it with your new knowledge and then - if you fail - create a NEW question with a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Don&#39;t change questions. It invalidates answers. I have rolled back your edit."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 29, "user_id": 12343347, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-95HwbuAueHc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reRen-dkEeEgaeusgHaEzgWV0Cn1w/photo.jpg?sz=128", "display_name": "MrSano43", "link": "https://stackoverflow.com/users/12343347/mrsano43"}, "edited": false, "score": 0, "creation_date": 1574283007, "post_id": 58954353, "comment_id": 104181398, "body": "What you are supposed to do now is follow <a href=\"https://stackoverflow.com/help/someone-answers\">these instructions</a> and upvote and accept answers."}, {"owner": {"reputation": 29, "user_id": 12343347, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-95HwbuAueHc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reRen-dkEeEgaeusgHaEzgWV0Cn1w/photo.jpg?sz=128", "display_name": "MrSano43", "link": "https://stackoverflow.com/users/12343347/mrsano43"}, "edited": false, "score": 0, "creation_date": 1574425321, "post_id": 58954353, "comment_id": 104238737, "body": "Sorry was just because it was intended that the child processo would execute the program, and it wasnt that much new information as you&#39;re saying,  but I got it running, thanks."}], "tags": [], "owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "is_accepted": false, "score": -1, "last_activity_date": 1574252790, "creation_date": 1574252790, "answer_id": 58954353, "question_id": 58953988, "link": "https://stackoverflow.com/questions/58953988/why-the-child-process-wont-execute-in-this-code/58954353#58954353", "title": "Why the child process won&#39;t execute in this code?", "body": "<p>It does run. This is a problem with buffered streams. They may have the need to be flushed.</p>\n\n<p>One solution is to add a newline character:</p>\n\n<pre><code>printf(\"CHILD PROCESS\\n\");\n</code></pre>\n\n<p>Adding a newline character will work in most situations, since many terminals do an automatic flush when encountering a newline. But you can also be more specific:</p>\n\n<pre><code>printf(\"CHILD PROCESS\");\nfflush(stdout);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 29, "user_id": 12343347, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-95HwbuAueHc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reRen-dkEeEgaeusgHaEzgWV0Cn1w/photo.jpg?sz=128", "display_name": "MrSano43", "link": "https://stackoverflow.com/users/12343347/mrsano43"}, "edited": false, "score": 0, "creation_date": 1574268731, "post_id": 58954657, "comment_id": 104174328, "body": "First of all, thanks, 2nd can you see the edit ? For some reason I can&#39;t still run the program I want in fork..."}], "tags": [], "owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "is_accepted": true, "score": 1, "last_activity_date": 1574253835, "creation_date": 1574253835, "answer_id": 58954657, "question_id": 58953988, "link": "https://stackoverflow.com/questions/58953988/why-the-child-process-wont-execute-in-this-code/58954657#58954657", "title": "Why the child process won&#39;t execute in this code?", "body": "<p>The problem is as follows:</p>\n\n<p>Here, you write a string to the stdout stream:</p>\n\n<pre><code>printf(\"CHILD PROCESS\");\n</code></pre>\n\n<p>This output is buffered, due to line buffering when stdout is a terminal.\nUsually, this buffer is implicitly flushed when the program ends, showing the output. But here:</p>\n\n<pre><code>if(close(STDOUT_FILENO)==-1) myabort (\"CHILD: Error while closing the standard output.\",-4);\nif(dup(fd[1])==-1) myabort(\"CHILD: Error while duplicating the pipe write end\",-5);\n</code></pre>\n\n<p>you <em>close</em> the stdout filedescriptor (1), which was connected to your terminal, and connect it to your pipe. So, when the stdout-stream is (implicitly or explicitly) flushed after this, the output goes to the pipe!</p>\n\n<p>You have to make sure, that the output is flushed before closing the filedescriptor, to not only make sure, that it is printed to the terminal, but also to not corrupt the communication through the pipe with your verificator-process. Because, as it stands, your verificator process will receive the string</p>\n\n<pre><code>\"filipe\\0CHILD PROCESS\"\n</code></pre>\n\n<p>when the stdout stream is implicitly flushed when your child process ends (i.e. returns from <code>main()</code>)</p>\n\n<p>The easiest and safest way to fix this situation is to call</p>\n\n<pre><code>fflush(stdout);\n</code></pre>\n\n<p>directly before you close filedescriptor 1.</p>\n"}], "owner": {"reputation": 29, "user_id": 12343347, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-95HwbuAueHc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reRen-dkEeEgaeusgHaEzgWV0Cn1w/photo.jpg?sz=128", "display_name": "MrSano43", "link": "https://stackoverflow.com/users/12343347/mrsano43"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 58954657, "answer_count": 2, "score": -1, "last_activity_date": 1574282866, "creation_date": 1574251611, "last_edit_date": 1574282866, "question_id": 58953988, "link": "https://stackoverflow.com/questions/58953988/why-the-child-process-wont-execute-in-this-code", "title": "Why the child process won&#39;t execute in this code?", "body": "<p>The child process is skiped, idk why... I used debugger and it doesn't give any clues why...only runs trhough the code ending with the printf of the parent process... Thanks in advance. Don't know what to say more my first time asking a question, it's asking me for details ... But I don't know what else to say, the purpose of the code is to run the \"verificador\" program which is a program that verifies in a given string how many forbidden words exist, so I've tried this, where my \"server\" would communicate through a pipe with \"verificador\" and than save the number of forbidden words to give to the \"client\".</p>\n\n<pre><code>#include &lt;sys/errno.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/wait.h&gt;\n\nvoid myabort(const char * msg, int exit_status){\n    perror(msg);\n    exit(exit_status);\n}\n\nint main(int argc,char *argv[])\n{\n    pid_t pid;\n    int fd[2],newfd,nbytes;\n    int status;\n    char word[]=\"filipe\";\n    FILE* f;\n\n    if(pipe(fd)&lt;0) myabort(\"unable to create unamed pipe\",-1);\n\n    switch(pid=fork()){\n        case -1: // Error\n                myabort(\"Unable to fork()\",-3);\n                break;\n\n        case  0:\n            printf(\"CHILD PROCESS\");\n            if(close(fd[0])==-1) myabort (\"CHILD: Error while closing the read end of the pipe.\",-4);\n            if(close(STDOUT_FILENO)==-1) myabort (\"CHILD: Error while closing the standard output.\",-4);\n            if(dup(fd[1])==-1) myabort(\"CHILD: Error while duplicating the pipe write end\",-5);\n            if(close(fd[1])==-1) myabort (\"CHILD: Error while closing the original write end descriptor of the pipe.\",-4);\n            //fprintf(stdout, \"%s\", word);\n            write(1,word,sizeof(word));\n            break;\n\n        default:\n            printf(\"PARENT PROCESS\");\n            wait(&amp;status);\n            close(STDIN_FILENO);\n            newfd = dup(fd[0]);\n            close(fd[0]);\n            close(fd[1]);\n\n            f = fdopen(newfd, \"r\");\n            if(f == NULL) myabort(\"Error opening new file descriptor.\", -1);\n\n            execl(\"verificador\", \"verificador\", \"palavras_proibidas\", NULL);\n\n            break;\n    }\n}\n\n</code></pre>\n"}, {"tags": ["c", "algorithm", "struct", "linked-list", "singly-linked-list"], "comments": [{"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 1, "creation_date": 1574252024, "post_id": 58953971, "comment_id": 104163922, "body": "It is unclear whether you mean adjacent duplicated elements or all duplicated elements."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 12343944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6279d7b78a3d7457edc0264094fe6125?s=128&d=identicon&r=PG&f=1", "display_name": "FAFSHOCK", "link": "https://stackoverflow.com/users/12343944/fafshock"}, "edited": false, "score": 1, "creation_date": 1574346680, "post_id": 58954075, "comment_id": 104207701, "body": "Thank you. I shall try this one out ASAP. if i run into anything i&#39;ll just drop a comment back to you. Thank you!"}], "tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": true, "score": 3, "last_activity_date": 1574253432, "last_edit_date": 1574253432, "creation_date": 1574251910, "answer_id": 58954075, "question_id": 58953971, "link": "https://stackoverflow.com/questions/58953971/i-have-a-linked-list-i-would-like-to-remove-duplicate-values/58954075#58954075", "title": "I have a linked list, I would like to remove duplicate values", "body": "<p>There are two approaches that come to mind right away, and which one to use depends on your specific case, and whether you'd like to preserve the original order of elements or not.</p>\n\n<hr>\n\n<p>1st approach:</p>\n\n<p>Use a double loop and pick up a node at a time. Then iterate the list after that node, and if you find a duplicate, remove. Repeat picking nodes, until you have iterated over the whole list. </p>\n\n<pre><code>For every node of the list\n  For every next_node after node\n    If next_node.value == node.value\n      Remove that next_node\n</code></pre>\n\n<p>This approach preserves the original order of the elements.</p>\n\n<p>This approach is I think what you'd have already in mind. I suggest you start with that.</p>\n\n<p>Example:</p>\n\n<blockquote>\n  <p>1 -> 2 -> 3 -> 4 -> 1</p>\n</blockquote>\n\n<p>I will start from the first node (1), check the second node, the third, the fourth, nothing so far, no duplicates found. I now check the fifth node, which also has the value 1 (duplicate found!), so I remove it.</p>\n\n<p>Now the list looks like this:</p>\n\n<blockquote>\n  <p>1 -> 2 -> 3 -> 4</p>\n</blockquote>\n\n<p>Now I am looking of duplicates of the second node (I checked for the first node in the previous traversal). I check 3, I check 4, no duplicates found. The list remains the same.</p>\n\n<p>Now I am looking of duplicates of the third node. I check 4, no duplicates found. The list remains the same.</p>\n\n<p>Now I am looking of duplicates of the fourth node. The next node is NULL, which means that the fourth node is the last node (because we removed the fifth node in the first traversal, as a duplicate of 1). There is nothing to check then, the list remains the same:</p>\n\n<blockquote>\n  <p>1 -> 2 -> 3 -> 4</p>\n</blockquote>\n\n<p>Observe how, for every node that I want to check if duplicates exist, I traverse the list until its end. So, for every node, I am doing an O(N) traversal, where N is the size of the list.</p>\n\n<p>How many nodes do I have? N</p>\n\n<p>So the Time Complexity of this approach is N * O(N) = O(N<sup>2</sup>)</p>\n\n<p>I strongly recommend trying that out yourself, and practice. When you are done, you could read the <a href=\"https://www.geeksforgeeks.org/remove-duplicates-from-an-unsorted-linked-list/\" rel=\"nofollow noreferrer\">Remove duplicates from an unsorted list</a> to check your solution.</p>\n\n<hr>\n\n<p>2nd approach:</p>\n\n<p>Sort the list, and now the list will have the duplicate values grouped together. So, if there is a duplicate of the current node, it will be its next node. If it's a duplicate, remove next node.</p>\n\n<p>Now, again, if there is a duplicate of the current node, it will be its next node. So do the same above, until the next node is <em>not</em> a duplicate of the current node.</p>\n\n<p>Then, make next node the current node, and do the same process. </p>\n\n<pre><code>Sort list\ncurrent_node = head_node\nWhile current_node != NULL\n  If current_node.value == current_node.next.value\n    Remove current_node.next\n  Else\n    current_node = current_node.next\n</code></pre>\n\n<p>This approach does <em>not preserve</em> the original order of the elements.</p>\n\n<p>Same Example:</p>\n\n<blockquote>\n  <p>1 -> 2 -> 3 -> 4 -> 1</p>\n</blockquote>\n\n<p>Sort the list:</p>\n\n<blockquote>\n  <p>1 -> 1 -> 2 -> 3 -> 4</p>\n</blockquote>\n\n<p>I start from 1. I check its next node, it's also 1, a duplicate found! Remove the next node. Now the list is:</p>\n\n<blockquote>\n  <p>1 -> 2 -> 3 -> 4</p>\n</blockquote>\n\n<p>Current node is still 1. I check its next node, it's 2. Not a duplicate. List remains the same. Set next node as the current node.</p>\n\n<p>Current node is 2. Check its next node, it's 3, not a duplicate. List remains the same. Set next node as the current node.</p>\n\n<p>Current node is 3. Check its next node, it's 4, not a duplicate. List remains the same. Set next node as the current node.</p>\n\n<p>Current node is 4. It doesn't have a next node, nothing to check, I am done. List remains the same:</p>\n\n<blockquote>\n  <p>1 -> 2 -> 3 -> 4</p>\n</blockquote>\n\n<p>Observe that for every node, I check only its immediate next node(s). And then, I continue for the last next node checked. That is O(N).</p>\n\n<p>However, I had to sort the list, in order to ensure that the duplicates are grouped. Sorting a list can be done in O(NlogN).</p>\n\n<p>The Time Complexity is O(NlogN) + O(N) = O(NlogN).</p>\n\n<p>I had used Merge Sort to <a href=\"https://gsamaras.wordpress.com/code/list-mergesort-c/\" rel=\"nofollow noreferrer\">sort the list in C</a>. There is also the <a href=\"https://www.geeksforgeeks.org/remove-duplicates-from-a-sorted-linked-list/\" rel=\"nofollow noreferrer\">Remove duplicates from sorted list</a> for another explanation. </p>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 12343944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6279d7b78a3d7457edc0264094fe6125?s=128&d=identicon&r=PG&f=1", "display_name": "FAFSHOCK", "link": "https://stackoverflow.com/users/12343944/fafshock"}, "edited": false, "score": 0, "creation_date": 1574346623, "post_id": 58954404, "comment_id": 104207667, "body": "At first using an array was my idea. as i run through a loop taking a single node comparing it with the rest. if it has no duplicates, it gets added to an array. but will it be a lengthy process is my fear."}, {"owner": {"reputation": 301, "user_id": 4287117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec64f958fb4cc3f79c4b7677670d0811?s=128&d=identicon&r=PG&f=1", "display_name": "Siddharth", "link": "https://stackoverflow.com/users/4287117/siddharth"}, "reply_to_user": {"reputation": 41, "user_id": 12343944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6279d7b78a3d7457edc0264094fe6125?s=128&d=identicon&r=PG&f=1", "display_name": "FAFSHOCK", "link": "https://stackoverflow.com/users/12343944/fafshock"}, "edited": false, "score": 0, "creation_date": 1574404818, "post_id": 58954404, "comment_id": 104229085, "body": "umm.. not that way.. what I meant is - if your first node contains 1 as data, then the arr[1] = 1 should be done. Moving to the next node of the linked list, if it again has a 1, we have found a duplicate as the arr[1] is already 1.  In this, you will traverse the linked list only once and find all the duplicates based on making the data in the node an index to the array; and marking the value at that index as 1, meaning &#39;already encountered&#39;..."}], "tags": [], "owner": {"reputation": 301, "user_id": 4287117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec64f958fb4cc3f79c4b7677670d0811?s=128&d=identicon&r=PG&f=1", "display_name": "Siddharth", "link": "https://stackoverflow.com/users/4287117/siddharth"}, "is_accepted": false, "score": 0, "last_activity_date": 1574252966, "creation_date": 1574252966, "answer_id": 58954404, "question_id": 58953971, "link": "https://stackoverflow.com/questions/58953971/i-have-a-linked-list-i-would-like-to-remove-duplicate-values/58954404#58954404", "title": "I have a linked list, I would like to remove duplicate values", "body": "<p>The below solution is only for sufficiently small integer values, not extremely large ones.\nWhat we can do here is take another array that can act as associative container.</p>\n\n<ul>\n<li>Take an array. Initialize that array to 0.</li>\n<li>Start to traverse the linked list.</li>\n<li>if (arr[node->data] == 0); then increment arr[node->data]. This will make it 1, marking one occurrence.</li>\n<li>else if (arr[node->data] == 1); then delete this node, as this means that the current node already contains an integer that has been encountered before.</li>\n</ul>\n\n<p>You can implement a DS based on hashing or BST's, similar to cpp maps, to act as associative container, if you want to scale this up.</p>\n\n<p>If you want a generic algorithm, I would encourage that you first write a brute-force logic along following lines --</p>\n\n<ul>\n<li>Traverse the linked list </li>\n<li>if the 'data' is found for the first time, then ignore and continue.</li>\n<li>if the 'data' is found next time, invoke the logic of deletion.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 12343944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6279d7b78a3d7457edc0264094fe6125?s=128&d=identicon&r=PG&f=1", "display_name": "FAFSHOCK", "link": "https://stackoverflow.com/users/12343944/fafshock"}, "edited": false, "score": 0, "creation_date": 1574346499, "post_id": 58954560, "comment_id": 104207578, "body": "Thank you, apparently for the creation of nodes I am not supposed to use functions nor loops, which is why i had to hard code the numbers (i didn&#39;t use a <code>scanf</code> as the numbers i enter are unique to myself) and it cannot be sorted as well because those numbers are supposed to be in a specific order as it is unique. I&#39;ll give yours a shot though."}], "tags": [], "owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "is_accepted": false, "score": 1, "last_activity_date": 1574253520, "creation_date": 1574253520, "answer_id": 58954560, "question_id": 58953971, "link": "https://stackoverflow.com/questions/58953971/i-have-a-linked-list-i-would-like-to-remove-duplicate-values/58954560#58954560", "title": "I have a linked list, I would like to remove duplicate values", "body": "<p>In the posted code you are \"manually\" adding every node if front of the list, so the first step would be to create a function that does that.</p>\n\n<p>Then, you can create another function that will add a node in a list keeping it sorted. It will traverse the list finding the right location and will add a node only if it is not already there another node with the same value.</p>\n\n<p>Now you can traverse the original list (the one which is not sorted) and for every node, try to add a copy of it to the sorted list. If it's already there, remove the node from the original list, otherwise add the copy to the sorted list.</p>\n\n<p>At the end you will have two lists of unique elements, one of which sorted.</p>\n\n<p>Don't forget to create a function that releases the allocated memory.</p>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 12343944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6279d7b78a3d7457edc0264094fe6125?s=128&d=identicon&r=PG&f=1", "display_name": "FAFSHOCK", "link": "https://stackoverflow.com/users/12343944/fafshock"}, "edited": false, "score": 0, "creation_date": 1574346160, "post_id": 58954643, "comment_id": 104207354, "body": "apparently I have to use typedefs for this and also yes I am well aware that it is a bad practice to use global variables. but I used them first because I had an idea of using them in a process but didn&#39;t initiate it.  Also, the function can also be done using while loops instead of the for loops right?"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 41, "user_id": 12343944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6279d7b78a3d7457edc0264094fe6125?s=128&d=identicon&r=PG&f=1", "display_name": "FAFSHOCK", "link": "https://stackoverflow.com/users/12343944/fafshock"}, "edited": false, "score": 0, "creation_date": 1574346238, "post_id": 58954643, "comment_id": 104207405, "body": "@FAFSHOCK Pay attention to that it is only me who shows how the function can be written. Without my code you had big difficulties.L("}, {"owner": {"reputation": 41, "user_id": 12343944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6279d7b78a3d7457edc0264094fe6125?s=128&d=identicon&r=PG&f=1", "display_name": "FAFSHOCK", "link": "https://stackoverflow.com/users/12343944/fafshock"}, "edited": false, "score": 0, "creation_date": 1574347031, "post_id": 58954643, "comment_id": 104207921, "body": "yeah, Thank you for that!  still new and learning code and when it comes to pointers and functions and such, it really gets me in trouble because i come across many pointer errors which i don&#39;t really know to counter. I&#39;m just really not sure on using this method as I have not learned that you could use for-loops in that way (only method i have used is <code>for(int i = 0; i&lt;n; i++)</code>). which is why I&#39;m trying with a while loop"}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 1, "last_activity_date": 1574254297, "last_edit_date": 1574254297, "creation_date": 1574253786, "answer_id": 58954643, "question_id": 58953971, "link": "https://stackoverflow.com/questions/58953971/i-have-a-linked-list-i-would-like-to-remove-duplicate-values/58954643#58954643", "title": "I have a linked list, I would like to remove duplicate values", "body": "<p>It seems you mean to remove not only adjacent duplicate values in the list.</p>\n\n<p>What you need is to write a function that will accept the head node of the list by reference. The function can return the number of removed nodes.</p>\n\n<p>Pay attention to that it is a bad idea to declare the global variables</p>\n\n<pre><code>//Global variables\nSTUDENTIDPtr previousPtr;           //pointer to previous node in list\nSTUDENTIDPtr currentPtr;            //pointer to current node in list\n</code></pre>\n\n<p>that moreover are redundant.</p>\n\n<p>And this typedef can confuse readers of the code</p>\n\n<pre><code>typedef STUDENTID *STUDENTIDPtr; \n</code></pre>\n\n<p>Also you could write a separate function that adds a node to the list. You could initially to write the function such a way that the nodes in the list were ordered by the value.</p>\n\n<p>As for the function that removes duplicate values then it can look the following way as iy is shown in the demonstrative program below. Investigate it.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n/* self-referential structure*/\nstruct studentID{\n    int value;          //a data member which is an integer\n    struct studentID *next;         //a data member which is a pointer to next node\n};\n\n\ntypedef struct studentID STUDENTID;     //creating a nickname for struct studentID as STUDENTID\ntypedef STUDENTID *STUDENTIDPtr;  \n\nsize_t remove_duplicates( STUDENTIDPtr *head )\n{\n    size_t n = 0;\n\n    for ( ; *head != NULL; head = &amp;( *head )-&gt;next )\n    {\n        for ( STUDENTIDPtr *next = &amp;( *head )-&gt;next; *next != NULL; )\n        {\n            if ( ( *head )-&gt;value == ( *next )-&gt;value )\n            {\n                STUDENTIDPtr tmp = *next;\n                *next = ( *next )-&gt;next;\n                free( tmp );\n                ++n;\n            }\n            else\n            {\n                next = &amp;( *next )-&gt;next;\n            }\n        }\n    }\n\n    return n;\n}\n\nvoid printList(STUDENTIDPtr currentPtr){\n\n\n    for ( ; currentPtr != NULL; currentPtr = currentPtr -&gt;next )\n    {\n        printf(\"%d -&gt; \", currentPtr-&gt;value);\n    }\n\n    puts( \"NULL\" );\n}\n\nint main(void) \n{\n    STUDENTIDPtr newPtr1;           //creating a pointer to create a new node\n    STUDENTIDPtr newPtr2;           //creating a pointer to create a new node\n    STUDENTIDPtr newPtr3;           //creating a pointer to create a new node\n    STUDENTIDPtr newPtr4;           //creating a pointer to create a new node\n    STUDENTIDPtr newPtr5;           //creating a pointer to create a new node\n\n\n    //creation of the first node\n    newPtr1 = malloc(sizeof(STUDENTID));            //This is when a node is created\n    newPtr2 = malloc(sizeof(STUDENTID));            //This is when a node is created\n    newPtr3 = malloc(sizeof(STUDENTID));            //This is when a node is created\n    newPtr4 = malloc(sizeof(STUDENTID));            //This is when a node is created\n    newPtr5 = malloc(sizeof(STUDENTID));            //This is when a node is created\n\n\n    newPtr1 -&gt; value = 4; // assign data in first node \n    newPtr1 -&gt; next = newPtr2;\n\n\n    newPtr2 -&gt; value = 4; // assign data in first node \n    newPtr2 -&gt; next = newPtr3;\n\n\n    newPtr3 -&gt; value = 5; // assign data in first node \n    newPtr3 -&gt; next = newPtr4;\n\n\n    newPtr4 -&gt; value = 2; // assign data in first node \n    newPtr4 -&gt; next = newPtr5;\n\n\n    newPtr5 -&gt; value = 1; // assign data in first node \n    newPtr5 -&gt; next = NULL;\n\n\n    printList( newPtr1 );\n\n    size_t n = remove_duplicates( &amp;newPtr1 );\n\n    printf( \"There are removed %zu elements\\n\", n );\n\n    printList( newPtr1 );\n\n    return 0;\n}\n</code></pre>\n\n<p>The program output might look like</p>\n\n<pre><code>4 -&gt; 4 -&gt; 5 -&gt; 2 -&gt; 1 -&gt; NULL\nThere are removed 1 elements\n4 -&gt; 5 -&gt; 2 -&gt; 1 -&gt; NULL\n</code></pre>\n\n<p>Bear in mind that you need to write also a function that will free all allocated memory for the list.</p>\n"}], "owner": {"reputation": 41, "user_id": 12343944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6279d7b78a3d7457edc0264094fe6125?s=128&d=identicon&r=PG&f=1", "display_name": "FAFSHOCK", "link": "https://stackoverflow.com/users/12343944/fafshock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 647, "favorite_count": 0, "accepted_answer_id": 58954075, "answer_count": 4, "score": 2, "last_activity_date": 1587116674, "creation_date": 1574251556, "last_edit_date": 1574253915, "question_id": 58953971, "link": "https://stackoverflow.com/questions/58953971/i-have-a-linked-list-i-would-like-to-remove-duplicate-values", "title": "I have a linked list, I would like to remove duplicate values", "body": "<p>So, I've created a code where it creates a linked list with 5 values. I would like to know what would be the best method to remove duplicates of those values and print the linked list again without the duplicates.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n/* self-referential structure*/\nstruct studentID{\n    int value;          //a data member which is an integer\n    struct studentID *next;         //a data member which is a pointer to next node\n};\n\n\ntypedef struct studentID STUDENTID;     //creating a nickname for struct studentID as STUDENTID\ntypedef STUDENTID *STUDENTIDPtr;        //creating a nickname for STUDENTID as STUDENTIDPtr\n\n\n//Global variables\nSTUDENTIDPtr previousPtr;           //pointer to previous node in list\nSTUDENTIDPtr currentPtr;            //pointer to current node in list\n\n\nvoid printList(STUDENTIDPtr currentPtr){\n\n\n    while (currentPtr != NULL){         //while not the end of the list\n        printf(\"%d -&gt; \", currentPtr-&gt;value);\n        currentPtr = currentPtr -&gt;next;\n    }\n}\n\n\nint main(){\n    STUDENTIDPtr newPtr1;           //creating a pointer to create a new node\n    STUDENTIDPtr newPtr2;           //creating a pointer to create a new node\n    STUDENTIDPtr newPtr3;           //creating a pointer to create a new node\n    STUDENTIDPtr newPtr4;           //creating a pointer to create a new node\n    STUDENTIDPtr newPtr5;           //creating a pointer to create a new node\n\n\n    //creation of the first node\n    newPtr1 = malloc(sizeof(STUDENTID));            //This is when a node is created\n    newPtr2 = malloc(sizeof(STUDENTID));            //This is when a node is created\n    newPtr3 = malloc(sizeof(STUDENTID));            //This is when a node is created\n    newPtr4 = malloc(sizeof(STUDENTID));            //This is when a node is created\n    newPtr5 = malloc(sizeof(STUDENTID));            //This is when a node is created\n\n\n    newPtr1 -&gt; value = 4; // assign data in first node \n    newPtr1 -&gt; next = newPtr2;\n\n\n    newPtr2 -&gt; value = 4; // assign data in first node \n    newPtr2 -&gt; next = newPtr3;\n\n\n    newPtr3 -&gt; value = 5; // assign data in first node \n    newPtr3 -&gt; next = newPtr4;\n\n\n    newPtr4 -&gt; value = 2; // assign data in first node \n    newPtr4 -&gt; next = newPtr5;\n\n\n    newPtr5 -&gt; value = 1; // assign data in first node \n    newPtr5 -&gt; next = NULL;\n\n\n    currentPtr = newPtr1;\n\n    printList(newPtr1);\n\n\n    return 0;\n}\n\n</code></pre>\n\n<p>will using if else and run through every linked list be easy or is there a better method?</p>\n"}, {"tags": ["c", "image-processing", "deep-learning", "opencl"], "comments": [{"owner": {"reputation": 18176, "user_id": 48660, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/NJ1Lx.jpg?s=128&g=1", "display_name": "pmdj", "link": "https://stackoverflow.com/users/48660/pmdj"}, "edited": false, "score": 0, "creation_date": 1574265626, "post_id": 58953823, "comment_id": 104172480, "body": "What do you mean by &quot;the one that I have to adapt uses a batch that confuses me&quot;?"}], "answers": [{"tags": [], "owner": {"reputation": 317, "user_id": 3980364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68fb35635f24df3b1d27ab384838f5a6?s=128&d=identicon&r=PG&f=1", "display_name": "Hashman", "link": "https://stackoverflow.com/users/3980364/hashman"}, "is_accepted": false, "score": 0, "last_activity_date": 1575699090, "creation_date": 1575699090, "answer_id": 59223490, "question_id": 58953823, "link": "https://stackoverflow.com/questions/58953823/opencl-kernel-implementing-im2col-with-batch/59223490#59223490", "title": "OpenCL Kernel implementing im2col with batch", "body": "<p>Your C version folds the batch into the lowest dimension. The opencl version isn't even using batch. </p>\n\n<p>You need to pass in the batch size \"B\", and change this copy to a block copy (or just do a loop over) by the batch size:</p>\n\n<pre><code>for (int b=0; b&lt;B; b++) *(im_col*B+b) = (i &gt;= 0 &amp;&amp; j &gt;= 0 &amp;&amp; i &lt; height_inp &amp;&amp; j &lt; width_inp) ? im_src[(ki * width_inp + kj)*B + b] : 0;\n</code></pre>\n\n<p>to emulate the memcpy(..., B*sizeof(type)). </p>\n\n<p>And then just stride B times more:</p>\n\n<pre><code>im_col += height_out * width_out * B;\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7585451, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-JwwDHOejV7g/AAAAAAAAAAI/AAAAAAAAAMg/DH0HTvFnc2Y/photo.jpg?sz=128", "display_name": "Lanver", "link": "https://stackoverflow.com/users/7585451/lanver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 143, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1575699090, "creation_date": 1574250959, "question_id": 58953823, "link": "https://stackoverflow.com/questions/58953823/opencl-kernel-implementing-im2col-with-batch", "title": "OpenCL Kernel implementing im2col with batch", "body": "<p>I am trying to adapt a secuential function writen for CPU to an OpenCL kernel for GPU.\nThe function is the well known im2col used in many deep learning applications.</p>\n\n<p>I have found some code on the OpenCV repository implementing this im2col function written in OpenCL but the one that I have to adapt uses a batch that confuses me and seems to be a bit different. </p>\n\n<p>What should I change on the OpenCL kernel to make it work the same on GPU as it does on the CPU function? </p>\n\n<p>CPU code</p>\n\n<pre><code>int fn_im2col_cpu(int I, int WI, int HI, int B, int KW, int KH, int WO, int HO, int PW, int PH, int SW, int SH, type *in_ptr, type *out_ptr) {\n    PROFILING_HEADER_EXTERN(im2col);\n    PROFILING_DEVICE(im2col, DEV_CPU);\n\n    int i;                                             // scrolls input channels\n    int w;                                             // scrolls channel columns (width)\n    int h;                                             // scrolls channel rows (height)\n    int kw;                                            // scrolls filter columns (width)\n    int kh;                                            // scrolls filter rows (height)\n\n // we sweep all output pixels, and for each pixel we compute the associated input pixel\n #pragma omp parallel for private (kh, kw, h, w)\n    for (i = 0; i &lt; I; i++) {\n        size_t out_addr = ((size_t)B * (size_t)WO * (size_t)HO * (size_t)KW * (size_t)KH * (size_t)i);\n        size_t in_addr1 = (size_t)i * (size_t)B * (size_t)WI * (size_t)HI;\n        for (kh = 0; kh &lt; KH; kh++) {\n            for (kw = 0; kw &lt; KW; kw++) {\n                for (h = 0; h &lt; HO; h++) {\n                    int hi = h * SH - PH + kh;\n                    size_t in_addr2 = in_addr1 + ((size_t)hi * (size_t)B * (size_t)WI);\n                    for (w = 0; w &lt; WO; w++) {\n                        int wi = w * SW - PW + kw;\n                        int force_padding = (wi &lt; 0) || (wi &gt;= WI) || (hi &lt; 0) || (hi &gt;= HI);\n                        if (force_padding) {\n                            bzero(&amp;out_ptr[out_addr], B*sizeof(type));\n                        } else {\n                            int in_addr = in_addr2 + (wi * B);\n                            memcpy(&amp;out_ptr[out_addr], &amp;in_ptr[in_addr], B*sizeof(type));\n                        }\n                        out_addr+=B;\n                    }\n                }\n            }\n        }\n    }\n    return 1;\n}\n</code></pre>\n\n<p>OpenCL kernel from <a href=\"https://github.com/opencv/opencv/blob/master/modules/dnn/src/opencl/im2col.cl\" rel=\"nofollow noreferrer\">https://github.com/opencv/opencv/blob/master/modules/dnn/src/opencl/im2col.cl</a></p>\n\n<pre><code>__kernel void im2col(__global const float *im_src, int im_src_offset,\n                     int channels, int height_inp, int width_inp,\n                     int kernel_h, int kernel_w, int pad_h, int pad_w, \n                     int stride_h, int stride_w,\n                     int height_out, int width_out,\n                     __global float *im_col, int im_col_offset\n                    )\n{\n    int index = get_global_id(0);\n    if (index &gt;= height_out * width_out * channels)\n        return;\n\n    int j_out = index % width_out;\n    int i_out = (index / width_out) % height_out;\n    int c_inp = (index / width_out) / height_out;\n\n    int c_out = c_inp * kernel_h * kernel_w;\n    int i_inp = i_out * stride_h - pad_h;\n    int j_inp = j_out * stride_w - pad_w;\n\n    im_src += (c_inp * height_inp + i_inp) * width_inp + j_inp + im_src_offset;\n    im_col += (c_out * height_out + i_out) * width_out + j_out + im_col_offset;\n\n    for (int ki = 0; ki &lt; kernel_h; ++ki)\n        for (int kj = 0; kj &lt; kernel_w; ++kj) {\n            int i = i_inp + ki;\n            int j = j_inp + kj;\n            *im_col = (i &gt;= 0 &amp;&amp; j &gt;= 0 &amp;&amp; i &lt; height_inp &amp;&amp; j &lt; width_inp) ?\n                im_src[ki * width_inp + kj] : 0;\n            im_col += height_out * width_out;\n      }\n}\n</code></pre>\n"}, {"tags": ["c", "sockets", "networking"], "comments": [{"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 1, "creation_date": 1574249836, "post_id": 58953367, "comment_id": 104162703, "body": "Because <code>sin_addr</code> isn&#39;t at the same offset. There is something else there that null-terminates the display. Look at the definitions."}, {"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 0, "creation_date": 1574250396, "post_id": 58953367, "comment_id": 104163009, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/21099041/why-do-we-cast-sockaddr-in-to-sockaddr-when-calling-bind\">Why do we cast sockaddr_in to sockaddr when calling bind()?</a>"}, {"owner": {"reputation": 371, "user_id": 8947295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2c02768c96b2b7449738fb4b947a13b?s=128&d=identicon&r=PG&f=1", "display_name": "Karim", "link": "https://stackoverflow.com/users/8947295/karim"}, "edited": false, "score": 1, "creation_date": 1574254993, "post_id": 58953367, "comment_id": 104165700, "body": "The IP address is printed in the first case, because <code>inet_ntoa()</code> converts it to a printable string. In the sockaddr-struct, the IP is stored in &quot;binary&quot; form (4 bytes)"}, {"owner": {"reputation": 85, "user_id": 10633319, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Legolas", "link": "https://stackoverflow.com/users/10633319/legolas"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1574260340, "post_id": 58953367, "comment_id": 104169031, "body": "@user207421 what definitions are you referring to?"}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1574295459, "post_id": 58953367, "comment_id": 104185715, "body": "The definitions of those structs, of course."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "reply_to_user": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 0, "creation_date": 1574295508, "post_id": 58953367, "comment_id": 104185727, "body": "@RishikeshRaje No it doesn&#39;t. That&#39;s the opposite cast."}], "owner": {"reputation": 85, "user_id": 10633319, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Legolas", "link": "https://stackoverflow.com/users/10633319/legolas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1574272995, "creation_date": 1574249517, "last_edit_date": 1574272995, "question_id": 58953367, "link": "https://stackoverflow.com/questions/58953367/why-do-i-need-to-cast-sockaddr-to-sockaddr-in-in-this-case", "title": "Why do I need to cast sockaddr to sockaddr_in in this case?", "body": "<p>In the file below I only get output for the first of the two prints. The output that I get is:</p>\n\n<pre><code>0 2 127.0.0.1\n0 2 \n</code></pre>\n\n<p>Why does using sockaddr->sa_data (it is a char array) not print anything? While I know it is not a very convenient struct but it should still hold information right? How does the info magically show up after casting it?</p>\n\n<p>Code Used:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;netdb.h&gt;\n#include &lt;arpa/inet.h&gt;\n\nint main(int argc, char **argv) {\n\n    //DNS\n    struct addrinfo hints;\n    struct addrinfo *result, *temp;\n\n    memset(&amp;hints, 0, sizeof(struct addrinfo));\n    hints.ai_family = AF_UNSPEC;\n    hints.ai_socktype = SOCK_STREAM;\n    hints.ai_protocol = IPPROTO_TCP;\n    hints.ai_flags = AI_CANONNAME;\n\n    int s = getaddrinfo(\"localhost\", NULL, &amp;hints, &amp;result);\n    for (temp = result; temp != NULL; temp = temp-&gt;ai_next) {\n        printf(\"%d %d %s\\n\", s, temp-&gt;ai_addr-&gt;sa_family, inet_ntoa(((struct sockaddr_in*)(temp-&gt;ai_addr))-&gt;sin_addr));\n        printf(\"%d %d %s\\n\", s, temp-&gt;ai_addr-&gt;sa_family, temp-&gt;ai_addr-&gt;sa_data);\n\n    }\n\n}\n</code></pre>\n"}, {"tags": ["c", "linux-kernel", "smp"], "answers": [{"tags": [], "owner": {"reputation": 11196, "user_id": 1079907, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a7c69e39fbec2c781db5f27b40f63023?s=128&d=identicon&r=PG", "display_name": "Sunil Bojanapally", "link": "https://stackoverflow.com/users/1079907/sunil-bojanapally"}, "is_accepted": false, "score": 0, "last_activity_date": 1574257254, "creation_date": 1574257254, "answer_id": 58955769, "question_id": 58952912, "link": "https://stackoverflow.com/questions/58952912/cpu1-failed-to-come-online/58955769#58955769", "title": "CPU1 failed to come online", "body": "<p>It could be possible that CPU <code>1</code> is set offline in the system to not schedule, receive interrupts form the devices. Below we can see 4 cores are available, and when one of the core is disabled using sysfs option it became offline.</p>\n\n<pre><code>[root@ucc1 bin]# cat /sys/devices/system/cpu/online \n0-3\n\n[root@ucc1 bin]# echo 0 &gt; /sys/devices/system/cpu/cpu3/online\n[root@ucc1 bin]# cat /sys/devices/system/cpu/online\n0-2\n\n[root@ucc1 bin]# cat /sys/devices/system/cpu/offline\n3\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 6639402, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-yzCW4HkJxzI/AAAAAAAAAAI/AAAAAAAAAJw/PxvdtaqHIlc/photo.jpg?sz=128", "display_name": "Harsh Agarwal", "link": "https://stackoverflow.com/users/6639402/harsh-agarwal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 684, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574257254, "creation_date": 1574248074, "last_edit_date": 1574255504, "question_id": 58952912, "link": "https://stackoverflow.com/questions/58952912/cpu1-failed-to-come-online", "title": "CPU1 failed to come online", "body": "<p>Could someone explain why we get the message below in kernel in SMP environment?</p>\n\n<blockquote>\n  <p>CPU1 failed to come online</p>\n</blockquote>\n\n<p>Source kernel_msm-4.9/kernel/arch/arm/kernel/smp.c:</p>\n\n<pre><code>if (!cpu_online(cpu)) \n{\n    pr_crit(\"CPU%u: failed to come online\\n\", cpu);\n    ret = -EIO;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "system-calls", "libc"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1574248846, "post_id": 58952893, "comment_id": 104162122, "body": "&quot;This function will return the correct size&quot;, Hmmm, <code>ftell()</code> returns a <code>long</code>.  This code uses <code>unsigned long</code> and omits an error check.  Rather than change the type of return, returning a <code>long</code> makes more sense."}, {"owner": {"reputation": 3350, "user_id": 7332147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e4GFL.png?s=128&g=1", "display_name": "linuxfan says Reinstate Monica", "link": "https://stackoverflow.com/users/7332147/linuxfan-says-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1574248929, "post_id": 58952893, "comment_id": 104162170, "body": "May be a read is performed in order to reset the input buffer after a seek?"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1574249019, "post_id": 58952893, "comment_id": 104162213, "body": "<code>_IO_SEEKOFF</code> calls <code>__seekoff</code> from the jump table"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1574249026, "post_id": 58952893, "comment_id": 104162217, "body": "Also, strictly speaking your <code>get_file_size()</code> does not return the size of the file. Per <a href=\"https://port70.net/~nsz/c/c11/n1570.html#7.21.9.4p2\" rel=\"nofollow noreferrer\"><b>7.21.9.4 The ftell function</b>, paragraph 2 of the C standard</a>: &quot;For a text stream, its file position indicator contains <b>unspecified information</b>, usable by the fseek function for returning the file position indicator for the stream to its position at the time of the ftell call; <b>the difference between two such return values is not necessarily a meaningful measure of the number of characters written or read</b>.&quot;"}, {"owner": {"reputation": 403, "user_id": 6524000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yqRJp.jpg?s=128&g=1", "display_name": "MajorasKid", "link": "https://stackoverflow.com/users/6524000/majoraskid"}, "edited": false, "score": 0, "creation_date": 1574249093, "post_id": 58952893, "comment_id": 104162258, "body": "I changed my get_size function from &quot;unsigned long&quot; to long. It didnt change anything (as expected as the test size is 46byte, so nowhere close to the maximum values). Read might be used to reset the buffer, but for this lseek() would me more suitable i guess (not sure about this one), and as far as I can tell, _IO_SEEKOFF returns &quot;return _IO_SEEKOFF (fp, offset, dir, mode); &quot; ( copied directly from the source file)"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1574249109, "post_id": 58952893, "comment_id": 104162267, "body": "I would like to remove the part for the size function. That is not interesting, rather boring indeed. What is interesting is why there is a <code>read</code> in the <code>fseek</code> for text files."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1574249151, "post_id": 58952893, "comment_id": 104162289, "body": "For telling the size of the file you need to open it in binary mode. And you&#39;ll use <code>fstat</code> instead of seek and tell.."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1574249231, "post_id": 58952893, "comment_id": 104162338, "body": "Actually I am going to change <i>that too</i> because it does not seem to matter."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1574249290, "post_id": 58952893, "comment_id": 104162378, "body": "here it is: <a href=\"https://code.woboq.org/userspace/glibc/libio/wfileops.c.html#902\" rel=\"nofollow noreferrer\">code.woboq.org/userspace/glibc/libio/wfileops.c.html#902</a> the read call"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1574249343, "post_id": 58952893, "comment_id": 104162408, "body": "@KamilCuk answer please :D"}, {"owner": {"reputation": 403, "user_id": 6524000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yqRJp.jpg?s=128&g=1", "display_name": "MajorasKid", "link": "https://stackoverflow.com/users/6524000/majoraskid"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1574249352, "post_id": 58952893, "comment_id": 104162416, "body": "@AndrewHenle i implemented an alternative get_size function using lseek, which gives the correct size. But my problem still exists I guess? If the current fet_size function does not work with my read() implementation, yet it does with the reference implementation, I have an error somewhere right? Or is it undefined behaviour of the current get_size, and thus cannot be fixed?"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1574249380, "post_id": 58952893, "comment_id": 104162435, "body": "@AnttiHaapala <i>For telling the size of the file you need to open it in binary mode.</i> And that&#39;s pedantically <a href=\"https://port70.net/~nsz/c/c11/n1570.html#note268\" rel=\"nofollow noreferrer\">undefined behavior</a>: &quot;Setting the file position indicator to end-of-file, as with fseek(file, 0, SEEK_END), has undefined behavior for a binary stream ...&quot;  There&#39;s really no portable, strictly-conforming way to get the size of a file in C.  Using a binary stream relies on platform-specific guarantees, so you might as well use the platform&#39;s facilities that get the size directly, such as <code>stat()</code> or <code>GetFileSize()</code>."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1574249417, "post_id": 58952893, "comment_id": 104162458, "body": "@AndrewHenle ah good point, I guess it is POSIX-defined though."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1574249457, "post_id": 58952893, "comment_id": 104162479, "body": "@AnttiHaapala POSIX does define <code>ftell()</code> to return an actual, accurate byte offset."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 2, "creation_date": 1574249506, "post_id": 58952893, "comment_id": 104162513, "body": "Anyway, the <code>get_size</code> function question is boring and can&#39;t be fixed, except by &quot;use stat&quot;. The &quot;why there is read in seek&quot; is interesting. The read has nothing to do with your code failing, it is just b0rken."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1574249563, "post_id": 58952893, "comment_id": 104162543, "body": "@MajorasKid I don&#39;t see any actual errors, assuming a POSIX system - the interesting thing is why your code causes an underlying <code>read()</code> call.  Just don&#39;t return <code>0</code> on an error - otherwise you&#39;ll confuse empty files with non-existent files."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 2, "creation_date": 1574249618, "post_id": 58952893, "comment_id": 104162572, "body": "the cause for the read is this: <a href=\"https://code.woboq.org/userspace/glibc/libio/wfileops.c.html#887\" rel=\"nofollow noreferrer\">code.woboq.org/userspace/glibc/libio/wfileops.c.html#887</a>  - I&#39;d really wanna remove the get_file_size and just have that one."}, {"owner": {"reputation": 403, "user_id": 6524000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yqRJp.jpg?s=128&g=1", "display_name": "MajorasKid", "link": "https://stackoverflow.com/users/6524000/majoraskid"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1574249618, "post_id": 58952893, "comment_id": 104162573, "body": "oke thanks @AnttiHaapala. But yes, would still be interesting to see where the read() call comes from."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1574249826, "post_id": 58952893, "comment_id": 104162696, "body": "The function is correct on POSIX, but bad. There is just something totally wrong with your <i>read system call</i>, but that would be a separate question, for which you need to add the code for <i>that</i>. Hmm I will rephrase the question so that people do not get stuck..."}, {"owner": {"reputation": 403, "user_id": 6524000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yqRJp.jpg?s=128&g=1", "display_name": "MajorasKid", "link": "https://stackoverflow.com/users/6524000/majoraskid"}, "edited": false, "score": 0, "creation_date": 1574249851, "post_id": 58952893, "comment_id": 104162713, "body": "Hm I&#39;m sorry, but i cannot find how the execution of fseek() ends up in _IO_wfile_seekoff. Did i overlooked something in the function call order above?. I will write a new question for my read() implementation, as it would be too offtopic for this question i guess. Thanks for any help here anyways!"}], "answers": [{"comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1574250096, "post_id": 58953508, "comment_id": 104162830, "body": "And the why part ;)"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1574250116, "post_id": 58953508, "comment_id": 104162839, "body": "That&#39;s the hard part ; ) I actually am puzzled why doesn&#39;t it call <code>lseek</code> syscall."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1574250441, "post_id": 58953508, "comment_id": 104163031, "body": "@KamilCuk No kidding.  I suspect it has something to do with that &quot;Puff...&quot; comment you had in originally, and a GLIBC maintainer with waaaay too much free time.  The reasoning for such an &quot;optimization&quot; has to be, umm, interesting.  That&#39;s a LOT of O&amp;M technical debt there."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1574252087, "post_id": 58953508, "comment_id": 104163965, "body": "@AndrewHenle I guess the cause is reasoning that lead to this comment: <a href=\"https://code.woboq.org/userspace/glibc/libio/wfileops.c.html#887\" rel=\"nofollow noreferrer\"><code>&#47;* Try to seek to a block boundary, to improve kernel page management. *&#47;</code></a>"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1574253304, "post_id": 58953508, "comment_id": 104164702, "body": "Maybe buffering?"}], "tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": false, "score": 5, "last_activity_date": 1574250482, "last_edit_date": 1574250482, "creation_date": 1574250013, "answer_id": 58953508, "question_id": 58952893, "link": "https://stackoverflow.com/questions/58952893/why-does-fseek-use-read-system-call/58953508#58953508", "title": "Why does fseek use read() system call?", "body": "<p><a href=\"https://github.com/bminor/glibc/blob/2a764c6ee848dfe92cb2921ed3b14085f15d9e79/libio/ioseekoff.c#L59\" rel=\"nofollow noreferrer\"><code>_IO_seekoff_unlocked-&gt;_IO_SEEKOFF</code></a> actually expands to <a href=\"https://github.com/lattera/glibc/blob/895ef79e04a953cac1493863bcae29ad85657ee1/libio/libioP.h#L188\" rel=\"nofollow noreferrer\"><code>JUMP3 (__seekoff, FP, OFF, DIR, MODE)</code></a>. <a href=\"https://github.com/lattera/glibc/blob/895ef79e04a953cac1493863bcae29ad85657ee1/libio/libioP.h#L121\" rel=\"nofollow noreferrer\"><code>JUMP3</code></a> is a macro that calls <code>__seekoff</code> from the <code>FILE</code> <a href=\"https://github.com/lattera/glibc/blob/895ef79e04a953cac1493863bcae29ad85657ee1/libio/libioP.h#L300\" rel=\"nofollow noreferrer\">\"jump\" table/vtable</a>.</p>\n\n<p><a href=\"https://github.com/bminor/glibc/blob/a5406364ac949f91867352cb2ae867629f083c5b/libio/iofopen.c#L73\" rel=\"nofollow noreferrer\">fopen</a> by default assigns <a href=\"https://github.com/bminor/glibc/blob/a5406364ac949f91867352cb2ae867629f083c5b/libio/fileops.c#L1440\" rel=\"nofollow noreferrer\"><code>_IO_file_jumps</code></a> (or something like that, because the file can be mmap-ed etc. etc.) as the jump table for new <code>FILE</code>s. It is the implementation of the jump table/virtual table for a <code>FILE</code>.</p>\n\n<p>So <code>_IO_SEEKOFF</code> calls <a href=\"https://code.woboq.org/userspace/glibc/libio/fileops.c.html#1450\" rel=\"nofollow noreferrer\"><code>_IO_file_jumps-&gt;__seekoff</code></a>. It points to <a href=\"https://code.woboq.org/userspace/glibc/libio/fileops.c.html#_IO_new_file_seekoff\" rel=\"nofollow noreferrer\"><code>_IO_new_file_seekoff</code></a> and finally inside that function a call is made to <a href=\"https://code.woboq.org/userspace/glibc/libio/fileops.c.html#1023\" rel=\"nofollow noreferrer\"><code>_IO_SYSREAD</code></a>. <a href=\"https://code.woboq.org/userspace/glibc/libio/libioP.h.html#_M/_IO_SYSREAD\" rel=\"nofollow noreferrer\"><code>_IO_SYSREAD</code></a> calls <code>_read</code> from the jump table, which in turn calls <a href=\"https://code.woboq.org/userspace/glibc/libio/fileops.c.html#_IO_file_read\" rel=\"nofollow noreferrer\"><code>_IO_file_read</code></a>, which calls <a href=\"https://code.woboq.org/userspace/glibc/sysdeps/unix/sysv/linux/read.c.html#30\" rel=\"nofollow noreferrer\"><code>__read</code></a> which finally executes <a href=\"https://code.woboq.org/userspace/glibc/sysdeps/unix/sysv/linux/read.c.html#30\" rel=\"nofollow noreferrer\"><code>SYSCALL_CANCEL (read)</code></a>.</p>\n"}], "owner": {"reputation": 403, "user_id": 6524000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yqRJp.jpg?s=128&g=1", "display_name": "MajorasKid", "link": "https://stackoverflow.com/users/6524000/majoraskid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 362, "favorite_count": 1, "answer_count": 1, "score": 6, "last_activity_date": 1574253212, "creation_date": 1574248037, "last_edit_date": 1574253212, "question_id": 58952893, "link": "https://stackoverflow.com/questions/58952893/why-does-fseek-use-read-system-call", "title": "Why does fseek use read() system call?", "body": "<p>I'm trying to understand the glibc implementation of <code>fseek</code>. To do so, I downloaded the glibc source code and tried to understand its function execution order. </p>\n\n<p>I found the <code>fseek</code> implementation in <code>libio/fseek.c</code>. Basically, it calls the function (or rather the macro) <code>_IO_fseek()</code> using the same parameters. This macro is implemented in <code>libio/iolibio.h</code>.</p>\n\n<p>It is defined as <code>_IO_seekoff_unlocked (__fp, __offset, __whence, _IOS_INPUT|_IOS_OUTPUT)</code> (implemented in <code>libio/ioseekoff.c</code>). The next step in its execution is rather confusing for me:</p>\n\n<p><code>_IO_seekoff_unlocked</code> basically returns <code>_IO_SEEKOFF (fp, offset, dir, mode);</code>, which returns <code>_IO_seekoff_unlocked (fp, offset, dir, mode);</code>, which should create a call loop.</p>\n\n<p>Also, when using <code>strace</code> on an example program (<code>seek.c</code>): </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) {\n    printf(\"[Fseek] Executing fseek\\n\");\n    FILE *f = fopen(\"./seek.c\", \"rb\");\n\n    fseek(f, 0L, SEEK_END);\n}\n</code></pre>\n\n<p>it shows that <code>fseek</code> will call the <code>read</code> system call, even though I could not find it in the glibc implementation.</p>\n\n<pre><code>...\nwrite(1, \"[Fseek] Executing fseek\\n\", 24[Fseek] Executing fseek\n) = 24\nopenat(AT_FDCWD, \"./seek.c\", O_RDONLY)  = 3\nfstat(3, {st_mode=S_IFREG|0644, st_size=146, ...}) = 0\nfstat(3, {st_mode=S_IFREG|0644, st_size=146, ...}) = 0\nlseek(3, 0, SEEK_SET)                   = 0\nread(3, \"#include &lt;stdio.h&gt;\\n\\nint main(voi\"..., 146) = 146\nexit_group(0)                           = ?\n+++ exited with 0 +++\n</code></pre>\n\n<p>My goal is to understand how the read system call is used here. I have my own implementation of the <code>read</code> system call, which works well for other tests I wrote but will fail for some reason when it is called via <code>fseek</code>.</p>\n\n<p>As an example, I use <code>fseek</code> in a function to get the size of a file:</p>\n\n<pre><code>long get_file_size(const char *name)\n{\n    FILE *temp_file = fopen(name, \"rb\");\n    if (temp_file == NULL)\n    {\n        return -1;\n    }\n\n    fseek(temp_file, 0L, SEEK_END);\n    long sz =  ftell(temp_file);\n    fclose(temp_file);\n    return sz;\n}\n</code></pre>\n\n<p>This function will return the correct size with the \"normal\" <code>read</code> implementation but will fail with mine. So, if anybody can tell me how I can understand the use of <code>read</code> within <code>fseek</code> (which I could not find in the source), I would highly appreciate it.</p>\n"}, {"tags": ["c", "malloc", "free"], "comments": [{"owner": {"reputation": 2193, "user_id": 5512095, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/58e730dd5510436d080bb145d452a2e6?s=128&d=identicon&r=PG&f=1", "display_name": "Denis Sheremet", "link": "https://stackoverflow.com/users/5512095/denis-sheremet"}, "edited": false, "score": 0, "creation_date": 1574248025, "post_id": 58952812, "comment_id": 104161686, "body": "What are the maximum values for n, m and k? MLE means &quot;memory limit exceeded&quot;, so maybe your code actually tries to allocate too much memory?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1574249068, "post_id": 58952812, "comment_id": 104162241, "body": "Do you actually append NULL as sentinel value to the various arrays? You don&#39;t show how you initialize them."}, {"owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1574249130, "post_id": 58952812, "comment_id": 104162281, "body": "@Lundin - I like the &quot;sentinel&quot; term! Can I &#39;borrow&#39; it in my answer? \ud83d\ude0a"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "edited": false, "score": 0, "creation_date": 1574249199, "post_id": 58952812, "comment_id": 104162319, "body": "@Adrian-ReinstateMonica Yes you may use any commonly used term in computer science in your answers... <a href=\"https://en.wikipedia.org/wiki/Sentinel_value\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Sentinel_value</a>"}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1574249124, "post_id": 58953201, "comment_id": 104162275, "body": "&quot;you rely on the first &#39;out-of-bounds&#39; pointer elements of arr[i] and arr[i][j] being NULL - but this is not safe!&quot; We don&#39;t know that. If NULL is always appended as sentinel value, such code is safe. Since we don&#39;t know, we can&#39;t answer the question."}, {"owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1574249195, "post_id": 58953201, "comment_id": 104162316, "body": "@Lundin - In the code presented by the OP, no &#39;sentinel&#39; is added, so it is unsafe (UB)."}], "tags": [], "owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "is_accepted": false, "score": 1, "last_activity_date": 1574263239, "last_edit_date": 1574263239, "creation_date": 1574249036, "answer_id": 58953201, "question_id": 58952812, "link": "https://stackoverflow.com/questions/58952812/create-a-3-d-array-with-malloc-but-got-re-and-mle/58953201#58953201", "title": "Create a 3-D array with malloc but got RE and MLE", "body": "<p>In your <code>delete_3d_array</code> function, you rely on the first 'out-of-bounds' pointer elements of <code>arr[i]</code> and <code>arr[i][j]</code> being <code>NULL</code> - but this is not safe, unless you <strong><em>explicitly add</em></strong> these 'extra' values (<em>sentinels</em>) in your <code>new_3d_array</code> function and assign <code>NULL</code> to these:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>unsigned ***new_3d_array(unsigned n, unsigned m, unsigned k)\n{\n    unsigned ***arr3D = malloc((n+1) * sizeof(unsigned**)); /// Add space for a NULL marker.\n    unsigned i, j; /// As suggested by chux - Makes more sense to avoid mixing types.\n\n    arr3D[n] = NULL; /// Explicitly set the 'end marker' to NULL\n    for (i = 0; i &lt; n; i++)\n    {\n        arr3D[i] = malloc((m+1) * sizeof(unsigned*)); /// Again, add end-marker...\n        arr3D[i][m] = NULL; // ... and definitively set it to NULL!\n        for (j = 0; j &lt; m; j++)\n        {\n            arr3D[i][j] = malloc(k * sizeof(unsigned));\n        }\n    }\n\n    return arr3D;\n}\n</code></pre>\n\n<p>Also, <a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">see here</a> on casting the return value of <code>malloc</code>.</p>\n\n<p><strong>EDIT/APPENDIX:</strong><br>\nThe above code will fix your <code>RE</code> problem, assuming that <code>RE</code> is \"Run-Time Error\" (that is, de-referencing an invalid/uninitialized pointer). However, there is still a problem caused by multiple calls to <code>malloc</code> (or <code>calloc</code>), known as \"heap fragmentation.\" Each of your innermost loop's <code>malloc</code> calls will ask the operating system to 'look for' space to assign to the requested memory, and this can (especially if your <code>m</code> dimension is large) make the O/S 'think' it's run out of memory.</p>\n\n<p>You can help prevent this from happening by calling <code>malloc</code> <strong><em>much</em></strong> less often (and for larger blocks), and then <em>calculating</em> (rather than <em>allocating</em>) your 2nd-level pointers:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>unsigned*** new_3d_array(unsigned n, unsigned m, unsigned k)\n{\n    unsigned*** arr3D = malloc((n + 1) * sizeof(unsigned**)); // Add space for a NULL marker.\n    unsigned i, j;\n    arr3D[n] = NULL; /// Explicitly set the 'end marker' to NULL\n    for (i = 0; i &lt; n; i++) {\n        arr3D[i] = malloc(m * sizeof(unsigned*));\n        unsigned* block = malloc(sizeof(unsigned) * m * k); // Allocate one BIG block of m x k \n        for (j = 0; j &lt; m; j++)\n            arr3D[i][j] = block + j * m;// First element (j == 0) will be \"block\", others will be incremented by \"m\"\n    }\n    return arr3D;\n}\n</code></pre>\n\n<p>Of course, you would then need to modify your <code>delete_3d_array</code> function accordingly:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>void delete_3d_array(unsigned*** arr)\n{\n    int i = 0;\n    while (arr[i] != NULL) {\n        free(arr[i][0]); // This will free the WHOLE BLOCK (m x k) allocated above!\n        free(arr[i]);\n        i++;\n    }\n    free(arr);\n}\n</code></pre>\n\n<p>You could, <em>in theory</em>, even change the 'outer' loop in a similar way; but then, the syntax for calculating pointer addresses for the sub-arrays becomes quite arcane.</p>\n\n<p>Feel free to ask for any further clarification and/or explanation.</p>\n"}, {"tags": [], "owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "is_accepted": false, "score": 0, "last_activity_date": 1574250977, "creation_date": 1574250977, "answer_id": 58953830, "question_id": 58952812, "link": "https://stackoverflow.com/questions/58952812/create-a-3-d-array-with-malloc-but-got-re-and-mle/58953830#58953830", "title": "Create a 3-D array with malloc but got RE and MLE", "body": "<p>@adrian has given one possible solution.</p>\n\n<p>There is another way by passing the size of the array to the delete function. You only need to pass <code>n</code> and <code>m</code> to the function.</p>\n\n<pre><code>void delete_3d_array(unsigned ***arr, int n, int m)\n{\n    int i,j;\n    for (i=0; i&lt;n; i++)\n    {\n        for (j=0; j&lt;m; j++)\n        {\n            free(arr[i][j]);\n        }\n        free(arr[i]);\n    }\n    free(arr);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1574253557, "post_id": 58954029, "comment_id": 104164864, "body": "Good use of <code>sizeof</code> object vs type!  Unclear why retain the unneeded casts like <code>(unsigned***)</code> when promoting style and mixed types in <code>i &lt; n</code>."}, {"owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "edited": false, "score": 0, "creation_date": 1574254299, "post_id": 58954029, "comment_id": 104165279, "body": "A nice answer! However, although using <code>calloc</code> <i>will</i> set the &#39;extra&#39; <i>(sentinel)</i> pointers to zero, I still think that lines like <code>arr3D[n] = NULL;</code> make it much clearer to others reading the code what you are using this last element for (especially with a comment to that end). Also, <code>calloc</code> will set <i>all</i> elements to zero, when most are going to be replaced - so there may be a small performance penalty."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1574254457, "post_id": 58954029, "comment_id": 104165378, "body": "The major performance penalty here is the heap fragmentation, with allocation all over the place. calloc overhead is negligible compared to that major bottleneck."}, {"owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1574262033, "post_id": 58954029, "comment_id": 104170120, "body": "@Lundin On the &quot;heap fragmentation&quot; issue, see my added EDIT/APPENDIX."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "edited": false, "score": 0, "creation_date": 1574263379, "post_id": 58954029, "comment_id": 104171052, "body": "@Adrian-ReinstateMonica You are making things needlessly complicated. Calculating indices is obsolete C89 style. In modern C simply use an array pointer to VLA and let the compiler do the work. Also note that the heap fragmentation in itself isn&#39;t the real problem (in itself it will only lead to wasted memory), but rather the lack of coherence for data cache during access. I&#39;ve written a FAQ post about it here: <a href=\"https://stackoverflow.com/questions/42094465/correctly-allocating-multi-dimensional-arrays\">Correctly allocating multi-dimensional arrays</a>."}, {"owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1574263562, "post_id": 58954029, "comment_id": 104171177, "body": "@Lundin OK, I&#39;ll accept the &#39;lesson&#39;! As a (mostly) <code>C++</code> programmer (<code>C</code> in the old days), I have an inherent &#39;allergy&#39; to VLAs."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "edited": false, "score": 1, "creation_date": 1574265005, "post_id": 58954029, "comment_id": 104172089, "body": "@Adrian-ReinstateMonica That&#39;s ok, as a (mostly) C programmer (C++ in the old days), I&#39;m allergic to some 90% of the C++ language :)  VLAs are quite useless. Pointers to VLA are great. For example consider <code>void stuff (int x, int y, int matrix[x][y])</code>. Can&#39;t do that in C++."}], "tags": [], "owner": {"reputation": 11893, "user_id": 12098405, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C7IUyuZ5qqE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rehqQyGdh463Xz2DY8S4TYPhnDvzA/photo.jpg?sz=128", "display_name": "dash-o", "link": "https://stackoverflow.com/users/12098405/dash-o"}, "is_accepted": false, "score": 1, "last_activity_date": 1574266198, "last_edit_date": 1574266198, "creation_date": 1574251740, "answer_id": 58954029, "question_id": 58952812, "link": "https://stackoverflow.com/questions/58952812/create-a-3-d-array-with-malloc-but-got-re-and-mle/58954029#58954029", "title": "Create a 3-D array with malloc but got RE and MLE", "body": "<p>I believe better to use calloc, instead of malloc. Easier interface, and reduces the possibility of incorrect initialization.</p>\n\n<p>Style note: better to use for loops, instead of while loops to free the data.</p>\n\n<pre><code>unsigned ***new_3d_array(unsigned n, unsigned m, unsigned k)\n{\n    unsigned ***arr3D = calloc(n+1, sizeof(*arr3d));\n    for (int i = 0; i &lt; n; i++)\n    {\n        arr3D[i] =  calloc(m+1, sizeof(*arr3D[i]));\n        for (int j = 0; j &lt; m; j++)\n        {\n            arr3D[i][j] = calloc(k, sizeof(*arr3D[i][j]));\n        }\n    }\n\n    return arr3D;\n}\nvoid delete_3d_array(unsigned ***arr)\n{\n    for (int i=0 ; arr[i] != NULL ; i++ ) {\n        for (int j = 0; arr[i][j] != NULL ; j++) {\n            free(arr[i][j]);\n        }\n        free(arr[i]);\n        arr[i] = NULL ;\n    }\n    free(arr);\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11628833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b11587249fdde10e682373f4f22e09ab?s=128&d=identicon&r=PG&f=1", "display_name": "JstMonika", "link": "https://stackoverflow.com/users/11628833/jstmonika"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1574266198, "creation_date": 1574247784, "question_id": 58952812, "link": "https://stackoverflow.com/questions/58952812/create-a-3-d-array-with-malloc-but-got-re-and-mle", "title": "Create a 3-D array with malloc but got RE and MLE", "body": "<p>I wrote a function with three parameter as height, width, and depth. After create a 3-D array with malloc, I return a <code>unsigned***</code> as array\u2019s name.</p>\n\n<p>The other function is meant to delete this dynamic 3-D array. Using array\u2019s name as parameter, and free it in the function.</p>\n\n<p>But I got some RE and MLE in the submit, I wonder where shouldn\u2019t I do?</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>unsigned ***new_3d_array(unsigned n, unsigned m, unsigned k)\n{\n    unsigned ***arr3D = (unsigned***)malloc(n * sizeof(unsigned**));\n    int i, j;\n\n    for (i = 0; i &lt; n; i++)\n    {\n        arr3D[i] =  (unsigned**)malloc(m * sizeof(unsigned*));\n        for (j = 0; j &lt; m; j++)\n        {\n            arr3D[i][j] = (unsigned*)malloc(k * sizeof(unsigned));\n        }\n    }\n\n    return arr3D;\n}\nvoid delete_3d_array(unsigned ***arr)\n{\n    int i = 0, j = 0;\n    while (arr[i] != NULL)\n    {\n        j = 0;\n\n        while (arr[i][j] != NULL)\n        {\n            free(arr[i][j]);\n            j++;\n        }\n        free(arr[i]);\n        i++;\n    }\n    free(arr);\n}\n</code></pre>\n"}, {"tags": ["c", "printf", "scanf"], "comments": [{"owner": {"reputation": 488, "user_id": 12199970, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-o1lnLQaFIl4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd-DeKatHNuf7q7OLUjUujB8yO-xQ/photo.jpg?sz=128", "display_name": "Venkatesh Nandigama", "link": "https://stackoverflow.com/users/12199970/venkatesh-nandigama"}, "edited": false, "score": 2, "creation_date": 1574248551, "post_id": 58952806, "comment_id": 104161968, "body": "Yes, %10d if 4 digit number is given remaining six places in the left filled with sapces"}, {"owner": {"reputation": 33, "user_id": 12330964, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAaD8TOc8VGc4XH0uDNiH7Z5BhWb_lCx9tmQXgk=k-s128", "display_name": "milad naderi", "link": "https://stackoverflow.com/users/12330964/milad-naderi"}, "reply_to_user": {"reputation": 488, "user_id": 12199970, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-o1lnLQaFIl4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd-DeKatHNuf7q7OLUjUujB8yO-xQ/photo.jpg?sz=128", "display_name": "Venkatesh Nandigama", "link": "https://stackoverflow.com/users/12199970/venkatesh-nandigama"}, "edited": false, "score": 0, "creation_date": 1574248554, "post_id": 58952806, "comment_id": 104161973, "body": "I&#39;ve read the deitel book but it only explained it for floating integers"}, {"owner": {"reputation": 33, "user_id": 12330964, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAaD8TOc8VGc4XH0uDNiH7Z5BhWb_lCx9tmQXgk=k-s128", "display_name": "milad naderi", "link": "https://stackoverflow.com/users/12330964/milad-naderi"}, "reply_to_user": {"reputation": 488, "user_id": 12199970, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-o1lnLQaFIl4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd-DeKatHNuf7q7OLUjUujB8yO-xQ/photo.jpg?sz=128", "display_name": "Venkatesh Nandigama", "link": "https://stackoverflow.com/users/12199970/venkatesh-nandigama"}, "edited": false, "score": 0, "creation_date": 1574248602, "post_id": 58952806, "comment_id": 104161999, "body": "so 10 means output with 10 spaces?"}, {"owner": {"reputation": 488, "user_id": 12199970, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-o1lnLQaFIl4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd-DeKatHNuf7q7OLUjUujB8yO-xQ/photo.jpg?sz=128", "display_name": "Venkatesh Nandigama", "link": "https://stackoverflow.com/users/12199970/venkatesh-nandigama"}, "edited": false, "score": 1, "creation_date": 1574248787, "post_id": 58952806, "comment_id": 104162089, "body": "10 means total size where your number is printed, if number is less than 10 digits than remaining filled with spaces"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1574248912, "post_id": 58952806, "comment_id": 104162160, "body": "Basically <code>%d</code> just prints the significant digits of the number (&quot;1234&quot;), <code>%10d</code> prints the number with 10 decimals using space for non significant digits ( &quot;      1234&quot;) and <code>%010d</code> prints the number with 10 decimals, using <code>0</code> for non significant digits (&quot;0000001234&quot;)."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1574249148, "post_id": 58952806, "comment_id": 104162287, "body": "Have you read the documentation?"}], "answers": [{"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 2, "last_activity_date": 1574249144, "creation_date": 1574249144, "answer_id": 58953238, "question_id": 58952806, "link": "https://stackoverflow.com/questions/58952806/numbers-behind-in-printf-and-scanf/58953238#58953238", "title": "numbers behind % in printf and scanf", "body": "<p><code>\"%10d\"</code> means to pad with spaces on the left, as needed, so decimal output is at least 10 <em>characters</em>.</p>\n"}], "owner": {"reputation": 33, "user_id": 12330964, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAaD8TOc8VGc4XH0uDNiH7Z5BhWb_lCx9tmQXgk=k-s128", "display_name": "milad naderi", "link": "https://stackoverflow.com/users/12330964/milad-naderi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 58953238, "answer_count": 1, "score": 0, "last_activity_date": 1574249144, "creation_date": 1574247773, "last_edit_date": 1574248665, "question_id": 58952806, "link": "https://stackoverflow.com/questions/58952806/numbers-behind-in-printf-and-scanf", "title": "numbers behind % in printf and scanf", "body": "<p>I stumbled into this and I don't know what it does exactly</p>\n\n<pre><code>int i; \nfor ( i = 1; i &lt;= 20; i++ ) {\n  printf( \"%10d\", (1+rand()%6) );\n\n  if ( i % 5 == 0 ) {\n    printf( \"\\n\" );\n  } \n} \n</code></pre>\n\n<p>Above is part of a program that tosses a dice for 20 times.</p>\n\n<p>The thing i don't understand is this line:</p>\n\n<pre><code>printf( \"%10d\", (1+rand()%6) );\n</code></pre>\n\n<p>My problem is \"%10d\"</p>\n\n<p>Is this a visual thing because outputs order of appearance change with it.</p>\n\n<p>I know in float values it shows decimal point but what about in integers as int, also can anyone tell me the difference between this:</p>\n\n<pre><code>prinf(\"%.2f\",value);\n</code></pre>\n\n<p>and this:</p>\n\n<pre><code>prinf(\"%6.2f\",value);\n</code></pre>\n\n<p>They both print 1000.30, so what is 6 for?</p>\n"}, {"tags": ["c", "linux", "serial-port", "termios"], "comments": [{"owner": {"reputation": 2561, "user_id": 11476836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c679da3a7b9adc6f980fb698e3f46b0b?s=128&d=identicon&r=PG&f=1", "display_name": "Marcos G.", "link": "https://stackoverflow.com/users/11476836/marcos-g"}, "edited": false, "score": 1, "creation_date": 1574253105, "post_id": 58952752, "comment_id": 104164578, "body": "Looks like a hardware issue. Are you sure you are using the right port? Does <code>dmesg | grep &#47;dev&#47;ttyS0</code> report something unusual? What driver does your port use?"}, {"owner": {"reputation": 326, "user_id": 8157105, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/A1A9a.jpg?s=128&g=1", "display_name": "Alex Hoffmann", "link": "https://stackoverflow.com/users/8157105/alex-hoffmann"}, "reply_to_user": {"reputation": 2561, "user_id": 11476836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c679da3a7b9adc6f980fb698e3f46b0b?s=128&d=identicon&r=PG&f=1", "display_name": "Marcos G.", "link": "https://stackoverflow.com/users/11476836/marcos-g"}, "edited": false, "score": 0, "creation_date": 1574263178, "post_id": 58952752, "comment_id": 104170890, "body": "dmesg is empty, setserial is reporting <code>&#47;dev&#47;ttyS0, UART: unknown, Port: 0x03f8, IRQ: 4</code>. <code>&#47;sys&#47;class&#47;tty&#47;*&#47;device&#47;driver</code> is showing all of my 4 ttyS[0123] being run by the <code>serial8250</code> driver."}, {"owner": {"reputation": 2561, "user_id": 11476836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c679da3a7b9adc6f980fb698e3f46b0b?s=128&d=identicon&r=PG&f=1", "display_name": "Marcos G.", "link": "https://stackoverflow.com/users/11476836/marcos-g"}, "edited": false, "score": 1, "creation_date": 1574269761, "post_id": 58952752, "comment_id": 104174895, "body": "Do a <code>sudo modprobe serial-8250</code> and try <code>dmesg | grep &#47;dev&#47;tty</code> again. You are on a desktop with a multiport card, right?"}, {"owner": {"reputation": 326, "user_id": 8157105, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/A1A9a.jpg?s=128&g=1", "display_name": "Alex Hoffmann", "link": "https://stackoverflow.com/users/8157105/alex-hoffmann"}, "reply_to_user": {"reputation": 2561, "user_id": 11476836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c679da3a7b9adc6f980fb698e3f46b0b?s=128&d=identicon&r=PG&f=1", "display_name": "Marcos G.", "link": "https://stackoverflow.com/users/11476836/marcos-g"}, "edited": false, "score": 0, "creation_date": 1574275003, "post_id": 58952752, "comment_id": 104177611, "body": "lsmod is saying I don&#39;t have it in my kernel&#39;s <code>&#47;lib&#47;modules</code> even though CONFIG_SERIAL_8250 is enabled in my kernel build. Funnily enough I get the same result from my home PC, saying 8250 cannot be found. Both are thinkpads with docks. My work computer (with the error) is an x280 with a thunderbolt dock."}, {"owner": {"reputation": 2561, "user_id": 11476836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c679da3a7b9adc6f980fb698e3f46b0b?s=128&d=identicon&r=PG&f=1", "display_name": "Marcos G.", "link": "https://stackoverflow.com/users/11476836/marcos-g"}, "edited": false, "score": 0, "creation_date": 1574277536, "post_id": 58952752, "comment_id": 104178768, "body": "Can you switch docking stations to see if the hardware is faulty?"}, {"owner": {"reputation": 2561, "user_id": 11476836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c679da3a7b9adc6f980fb698e3f46b0b?s=128&d=identicon&r=PG&f=1", "display_name": "Marcos G.", "link": "https://stackoverflow.com/users/11476836/marcos-g"}, "edited": false, "score": 0, "creation_date": 1574277863, "post_id": 58952752, "comment_id": 104178928, "body": "I&#39;m asking because I&#39;ve seen that, if the docking connector is not firmly in place or damaged the driver will not load"}, {"owner": {"reputation": 13673, "user_id": 1599004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df9d2a02744f666e97375e05fdc54255?s=128&d=identicon&r=PG", "display_name": "sawdust", "link": "https://stackoverflow.com/users/1599004/sawdust"}, "edited": false, "score": 0, "creation_date": 1574280691, "post_id": 58952752, "comment_id": 104180340, "body": "Try using system utilities, e.g. stty, instead of your code. If those have same issues then problem is with the system. BTW using nonblocking mode is probably the wrong choice, especially with noncanonical mode (nonblocking mode nullifies the VMIN and VTIME settings).  Sleeping while waiting for a signal to perform the read is convoluted and a waste of time &amp; effort.  The kernel does a far more efficient job if you simply used blocking mode."}, {"owner": {"reputation": 326, "user_id": 8157105, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/A1A9a.jpg?s=128&g=1", "display_name": "Alex Hoffmann", "link": "https://stackoverflow.com/users/8157105/alex-hoffmann"}, "reply_to_user": {"reputation": 2561, "user_id": 11476836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c679da3a7b9adc6f980fb698e3f46b0b?s=128&d=identicon&r=PG&f=1", "display_name": "Marcos G.", "link": "https://stackoverflow.com/users/11476836/marcos-g"}, "edited": false, "score": 0, "creation_date": 1574281615, "post_id": 58952752, "comment_id": 104180761, "body": "@MarcosG. Removing my dock still results in the same error. I sadly don&#39;t have another dock to test with as I think no two of us have the same series thinkpad :P  @sawdust <code>stty -F &#47;dev&#47;ttyS0</code> gives the same error so it must be the hardware I guess. I also do not know too much about serial but my eventual application (FreeRTOS emulator) will have the serial traffic asynchronously transferred into freertos queues, ideally not blocking while waiting for new traffic. In this case does async make sense?"}, {"owner": {"reputation": 13673, "user_id": 1599004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df9d2a02744f666e97375e05fdc54255?s=128&d=identicon&r=PG", "display_name": "sawdust", "link": "https://stackoverflow.com/users/1599004/sawdust"}, "edited": false, "score": 0, "creation_date": 1574290869, "post_id": 58952752, "comment_id": 104184470, "body": "<i>&quot;Does <code>dmesg | grep &#47;dev&#47;ttyS0</code> report something unusual?&quot;</i> -- No, that&#39;s inappropriate and too restrictive; drivers don&#39;t care about the <b>/dev</b> directory while initializing.  Simplify and search for <code>dmesg | grep tty</code>.      <i>&quot;setserial is reporting <code>&#47;dev&#47;ttyS0, UART: unknown,...</code>&quot;</i> -- That might be a problem.  In  <b>drivers/tty/serial/serial_core.c</b> routine <b>uart_port_startup()</b> checks for <code>if (uport-&gt;type == PORT_UNKNOWN)</code>, which will eventually result in EIO to the user."}, {"owner": {"reputation": 13673, "user_id": 1599004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df9d2a02744f666e97375e05fdc54255?s=128&d=identicon&r=PG", "display_name": "sawdust", "link": "https://stackoverflow.com/users/1599004/sawdust"}, "edited": false, "score": 1, "creation_date": 1574290912, "post_id": 58952752, "comment_id": 104184492, "body": "<i>&quot;In this case does async make sense?&quot;</i> -- No, because the kernel handles the async I/O when you open the serial terminal.  Your program is &quot;reading&quot; from a terminal buffer (typically 4K bytes) rather than the hardware. See <a href=\"http://www.linux.it/~rubini/docs/serial/serial.html\" rel=\"nofollow noreferrer\">Linux serial drivers</a>   The device driver using interrupts is buffering the received data.  Your program can fetch data from the upper-layer buffer at any pace.  Preferably use syscalls of more than just one byte."}], "answers": [{"tags": [], "owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "is_accepted": true, "score": 2, "last_activity_date": 1574316224, "last_edit_date": 1574316224, "creation_date": 1574315912, "answer_id": 58968194, "question_id": 58952752, "link": "https://stackoverflow.com/questions/58952752/input-output-error-when-getting-termios-attributes-on-ttys0-serial-port/58968194#58968194", "title": "Input/Output error when getting termios attributes on ttyS0 serial port", "body": "<p>The <code>dmesg(1)</code> output you show in the comments to your question shows <code>UART: unknown</code>. It seems this can be the problem.  It is not recognizing any uart in port <code>0x3f8</code>, so you seem <strong>not to have an uart there</strong> (at least, not a standard or compatible one)  </p>\n\n<p>The message normally shows <code>UART: ns16550a</code> or similar, giving you info about the chipset installed there.  In your case, the other parameters, show as reserved by the kernel so no other device can use those.  I don't know the exact reason why the serial driver does not deallocate the resources and continues, but that's probably some legacy issue also.</p>\n\n<p>PC based uarts are normally recognized by hardwired configuration only at fixed locations in the system, and are exercised (some inocuous command is sent to see if it responds to it) to be recognized, as <em>they are legacy devices</em>, predating from PnP or PCI devices, so they must be probed by software at well known places.  This is what the software is doing.</p>\n\n<p>If you know there's a physical port device installed, try to use BIOS SETUP to check if the serial port has been enabled in BIOS (if it hasn't you'll not see it at all).  Enable it if it hasn't been, and try again.  </p>\n"}], "owner": {"reputation": 326, "user_id": 8157105, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/A1A9a.jpg?s=128&g=1", "display_name": "Alex Hoffmann", "link": "https://stackoverflow.com/users/8157105/alex-hoffmann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1690, "favorite_count": 0, "accepted_answer_id": 58968194, "answer_count": 1, "score": 0, "last_activity_date": 1574316224, "creation_date": 1574247638, "last_edit_date": 1574280916, "question_id": 58952752, "link": "https://stackoverflow.com/questions/58952752/input-output-error-when-getting-termios-attributes-on-ttys0-serial-port", "title": "Input/Output error when getting termios attributes on ttyS0 serial port", "body": "<p>I am writing a simple program to open the serial port <code>/dev/ttyS0</code> which is visible in <code>/dev</code>.</p>\n\n<p>The code opens the serial port no problems on my PC at home but on my work machine I run into an error that returns \"Input/Output Error\". The error appears as a result of <code>tcgetattr</code> failing but I am unsure why as the serial port is visible. I added a verbose error printout via <code>libexplain</code> and it reported to me. </p>\n\n<blockquote>\n  <p>tcgetattr(fildes = 3 \"/dev/ttyS0\", data = 0x7FFEEA8CEEB0) failed, Input/output error (5, EIO)</p>\n</blockquote>\n\n<p>I am not sure what other information is relevant that I can provide. It is an Arch Linux system with a 5.3.8 kernel.</p>\n\n<pre><code>const char *port_name = \"/dev/ttyS0\";\n\nint main(int argc, char *argv[])\n{\n   int serial_fd, file_status;\n    struct termios termSettings;\n    struct sigaction act = { 0 };\n\n    serial_fd = open(port_name, O_RDWR | O_NOCTTY | O_NONBLOCK);\n\n    if (serial_fd &lt; 0) {\n        perror(\"Opening serial port failed\");\n        return -1;\n    }\n\n    if (tcgetattr(serial_fd, &amp;termSettings) &lt; 0) {\n        perror(\"Getting terminal attributes failed\");\n        printf(\"Error reason: %s\\n\",  explain_tcgetattr(serial_fd, &amp;termSettings));\n        goto error;\n    }\n   ...\n}\n</code></pre>\n\n<p>The complete source is <a href=\"https://github.com/alxhoff/C-code-snippets/blob/3b913fc0efcb84ff9597e8874218a149cfcfb75f/tty_serial/src/main.c\" rel=\"nofollow noreferrer\">here</a></p>\n"}, {"tags": ["c", "arrays", "loops", "scanf", "element"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1574249088, "post_id": 58952727, "comment_id": 104162253, "body": "Have you already studied the <code>struct</code> C keyword? If yes, then your approach is wrong. If no, then you should definitely study <code>struct</code> first."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1574249182, "post_id": 58952727, "comment_id": 104162310, "body": "Also study the chapter dealing with strings in your beginner&#39;s C text book, especially the <code>strcpy</code> function. You cannot assign strings with <code>=</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11452330"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1574249514, "post_id": 58952727, "comment_id": 104162519, "body": "Thank you for a response, Jabberwocky. I haven&#39;t got as far as using struct yet and just have to make-do with the tools I have for now which are quite basic. I have actually managed to get a new element (name) added to the array. I&#39;m still having problems getting it to be displayed but I am trying to work it out by passing data from one function to another."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11452330"}, "edited": false, "score": 0, "creation_date": 1574254593, "post_id": 58954566, "comment_id": 104165469, "body": "Hi LoganMacMonkey, thanks for the response. I have set up the program quite similarly to your example and it does work just fine. I can see the names I have input in one function displayed in full in another. I am just having trouble with adding new names into the array."}, {"owner": {"reputation": 59, "user_id": 8108313, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ub1Pb8txiAI/AAAAAAAAAAI/AAAAAAAAAB4/q3oqcU57xOY/photo.jpg?sz=128", "display_name": "LoganMacMonkey", "link": "https://stackoverflow.com/users/8108313/loganmacmonkey"}, "edited": false, "score": 0, "creation_date": 1574257142, "post_id": 58954566, "comment_id": 104167031, "body": "I noticed that you never used i in your for loop.  you should replace STUDNO with i within your for loop."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11452330"}, "edited": false, "score": 0, "creation_date": 1574265377, "post_id": 58954566, "comment_id": 104172322, "body": "It seems to be working but it is storing the name in some random place in memory, the slot in the array has been allocated for it but it is just displaying random symbols instead of the name."}], "tags": [], "owner": {"reputation": 59, "user_id": 8108313, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ub1Pb8txiAI/AAAAAAAAAAI/AAAAAAAAAB4/q3oqcU57xOY/photo.jpg?sz=128", "display_name": "LoganMacMonkey", "link": "https://stackoverflow.com/users/8108313/loganmacmonkey"}, "is_accepted": false, "score": 0, "last_activity_date": 1574253545, "creation_date": 1574253545, "answer_id": 58954566, "question_id": 58952727, "link": "https://stackoverflow.com/questions/58952727/adding-elements-to-an-array-in-c/58954566#58954566", "title": "Adding elements to an array in C", "body": "<p>This problem is very common. When the last thing printed to the console counts as a valid input for your scanf function, it'll read that as the input or not read anything at all, not letting the user put an input into the code. I can't get anymore technical than that because I'm not 100% sure what's happening in the scanf funtion that would cause this but to fix it, all you have to do is include the last thing you printed to the console. Your code would look like this.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) {\n  char newName;\n  int newNo;\n\n  printf(\"\\nPlease enter a student number: \\n\");\n  scanf(\"%d\", &amp;newNo);\n  printf(\"Please enter the student name:\\n\");\n  scanf(\"\\n%[^\\n]\", &amp;newName);\n  printf(\"\\n%c\\n\",newName); //To check if it's working\n  return 0;\n}\n</code></pre>\n\n<p>When I ran this, I noticed that this only gets you the first letter of your input so if you want the entire string, you would write the code like this.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define NAMELENGTH 40\nint main(void) {\n  char newName[NAMELENGTH];\n  int newNo;\n\n  printf(\"\\nPlease enter a student number: \\n\");\n  scanf(\"%d\", &amp;newNo);\n  printf(\"Please enter the student name:\\n\");\n  scanf(\"\\n%[^\\n]\", newName);\n  printf(\"\\n%s\\n\",newName); //To check if it's working\n  return 0;\n}\n</code></pre>\n\n<p>The code above can give you the following output:</p>\n\n<p>Please enter a student number:</p>\n\n<p>40</p>\n\n<p>Please enter the student name:</p>\n\n<p>anhtz</p>\n\n<p>anhtz</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11452330"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1574253545, "creation_date": 1574247561, "question_id": 58952727, "link": "https://stackoverflow.com/questions/58952727/adding-elements-to-an-array-in-c", "title": "Adding elements to an array in C", "body": "<p>I have an assignment to create a grade book with student names and grades and I'm stuck where it asks me to add a new student. STUDNO is where the program only allows 75 students with a NAMELENGTH of 40.</p>\n\n<p>So I have written a for loop to search through the array and I have no errors or warnings yet the program skips over the scanf function where it asks for name input. </p>\n\n<p>Here is the code: </p>\n\n<pre><code>    #define STUDNO 75\n#define NAMELENGTH 40\n\nvoid super(int studNo, char name [STUDNO][NAMELENGTH],\n     int studMark1[STUDNO], int studMark2[STUDNO],\n     int studMark3[STUDNO], int pinNo[][3])\n{\n    int i;\n    char newName;\n    int newNo;\n\n    printf(\"\\n      Add New Student\\n\");\n    printf(\"\\nPlease enter a student number: \\n\");\n    scanf(\"%d\", &amp;newNo);\n    printf(\"Please enter the student name:\\n\");\n    scanf(\"%[^\\n]\", &amp;newName);\n    for(i = studNo-1; i &gt;= newNo; i--)\n    {\n        name[STUDNO+1][NAMELENGTH]=name[STUDNO][NAMELENGTH];\n    }\n    name[newNo][NAMELENGTH] = newName;\n</code></pre>\n"}, {"tags": ["c", "net-snmp"], "answers": [{"tags": [], "owner": {"reputation": 91, "user_id": 8144906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7818cc246817d3cef758ff8c5a73b072?s=128&d=identicon&r=PG", "display_name": "Martin", "link": "https://stackoverflow.com/users/8144906/martin"}, "is_accepted": false, "score": 0, "last_activity_date": 1576245814, "creation_date": 1576245814, "answer_id": 59324117, "question_id": 58952153, "link": "https://stackoverflow.com/questions/58952153/how-do-i-create-a-user-in-net-snmp-c-api/59324117#59324117", "title": "How do I create a user in net-snmp C API?", "body": "<p>The following function does what I want. I could not find the prototype for vacm_parse_rouser() in a header file so I added it to my code.</p>\n\n<pre><code>void vacm_parse_rouser( const char *token, char *confline );\n\nbool create_user_and_access()\n{\n    const char* username = \"myuser\";\n    const char* auth_type = \"SHA\";\n    char auth_pass[] = \"12345678\";\n    const char* priv_type = \"AES\";\n    char priv_pass[] = \"12345678\";\n    struct usmUser* user;\n    int type_nr;\n    const oid* auth;\n    netsnmp_priv_alg_info *pai;\n    char line[128];\n\n    user = usm_create_user();\n    user-&gt;engineID = snmpv3_generate_engineID( &amp;user-&gt;engineIDLen );\n    user-&gt;name = strdup( username );\n    user-&gt;secName = strdup( user-&gt;name );\n\n    type_nr = usm_lookup_auth_type( auth_type );\n    if( type_nr &lt; 0 )\n    {\n        printf( \"usm_lookup_auth_type %s failed.\\n\", auth_type );\n        return false;\n    }\n    auth = sc_get_auth_oid( type_nr, &amp;user-&gt;authProtocolLen );\n    if( !auth )\n    {\n        printf( \"sc_get_auth_oid %d (%s) failed.\\n\", type_nr, auth_type );\n        return false;\n    }\n    user-&gt;authProtocol = snmp_duplicate_objid( auth, user-&gt;authProtocolLen );\n    usm_set_user_password( user, \"userSetAuthPass\", auth_pass );\n\n    type_nr = usm_lookup_priv_type( priv_type );\n    if( type_nr &lt; 0 )\n    {\n        printf( \"usm_lookup_priv_type %s failed.\\n\", priv_type );\n        return false;\n    }\n    pai = sc_get_priv_alg_bytype( type_nr );\n    if( !pai )\n    {\n        printf( \"sc_get_priv_alg_bytype %d (%s) failed.\\n\",\n                type_nr, priv_type );\n        return false;\n    }\n    user-&gt;privProtocolLen = pai-&gt;oid_len;\n    user-&gt;privProtocol =\n            snmp_duplicate_objid( pai-&gt;alg_oid, user-&gt;privProtocolLen );\n    usm_set_user_password( user, \"userSetPrivPass\", priv_pass );\n\n    usm_add_user( user );\n\n    strcpy( line, username );\n    vacm_parse_rouser( \"rouser\", line );\n\n    return true;\n}\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 8144906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7818cc246817d3cef758ff8c5a73b072?s=128&d=identicon&r=PG", "display_name": "Martin", "link": "https://stackoverflow.com/users/8144906/martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576245814, "creation_date": 1574245806, "question_id": 58952153, "link": "https://stackoverflow.com/questions/58952153/how-do-i-create-a-user-in-net-snmp-c-api", "title": "How do I create a user in net-snmp C API?", "body": "<p>I am writing an SNMP daemon in C and I want to create a user and give it read-only access. I had the following lines in the config:</p>\n\n<pre><code>createUser myuser SHA \"12345678\" AES\nrouser myuser\n</code></pre>\n\n<p>How can I do the same in C from within the daemon?</p>\n"}, {"tags": ["c", "embedded", "nxp-microcontroller"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1574245024, "post_id": 58951792, "comment_id": 104159857, "body": "Which MCU? Which compiler?"}, {"owner": {"reputation": 1701, "user_id": 5836577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/931236857b09c3b0aea0f29fb5a23cbc?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Petitjean", "link": "https://stackoverflow.com/users/5836577/guillaume-petitjean"}, "edited": false, "score": 0, "creation_date": 1574245356, "post_id": 58951792, "comment_id": 104160065, "body": "There might be some king of erase/prog protection that you need to unlock. Don&#39;t know what MCU you&#39;re working on but it is common."}, {"owner": {"reputation": 2346, "user_id": 2549281, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/XpMre.jpg?s=128&g=1", "display_name": "Dabo", "link": "https://stackoverflow.com/users/2549281/dabo"}, "edited": false, "score": 0, "creation_date": 1574245402, "post_id": 58951792, "comment_id": 104160098, "body": "Probably you should check flash controller status register for precise hardware error code. And then look in documentation what does it mean. The error code you get looks like some software generalization"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1574272477, "post_id": 58951792, "comment_id": 104176345, "body": "This is an X-Y problem - you are asking about a problem with your solution rather then about the problem you are trying to solve.  Do you really want to use an entire flash erase block for that?  Better to embed the version number as a constant string at a known location in your code using whatever linker directives your toolchain supports for that.  The linker will then have knowledge of the fixed location string and can efficiently locate other code and data around it.  The version then  is specified in the build, not added manually after - which would be error prone."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1574272768, "post_id": 58951792, "comment_id": 104176504, "body": "Here&#39;s how you do it with gcc: <a href=\"https://mcuoneclipse.com/2012/11/01/defining-variables-at-absolute-addresses-with-gcc/\" rel=\"nofollow noreferrer\">mcuoneclipse.com/2012/11/01/&hellip;</a>.  Though in your case you&#39;ll want something like: <code>static const char __attribute__((section (&quot;.BootInfoSection&quot;))) versionstr[16] = &quot;01.01.01&quot; ;</code>"}, {"owner": {"reputation": 195, "user_id": 3788048, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fSvcW.jpg?s=128&g=1", "display_name": "Asan", "link": "https://stackoverflow.com/users/3788048/asan"}, "reply_to_user": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1574691369, "post_id": 58951792, "comment_id": 104310934, "body": "@Clifford I wrote what you propose and modified the linker file as stated on the link. I checked and the variable is indeed in the memory address I want it to be, but the variable shows up as 0. The whole buffer is 0. Would you know why this happens? I tried to set the type to int and the variable was set to 0 also."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1574703417, "post_id": 58951792, "comment_id": 104317420, "body": "@Asan : Different problem, different question.  Post a new one.  You&#39;ll do better with a broader audience that just asking me, and you will be able to show <i>exactly</i> what you have done."}], "answers": [{"tags": [], "owner": {"reputation": 9, "user_id": 4079728, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af401958b184b726aeeb94fec448fb6f?s=128&d=identicon&r=PG&f=1", "display_name": "Ummer K K", "link": "https://stackoverflow.com/users/4079728/ummer-k-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1576142463, "creation_date": 1576142463, "answer_id": 59301263, "question_id": 58951792, "link": "https://stackoverflow.com/questions/58951792/writing-a-value-on-the-flash-memory-in-c/59301263#59301263", "title": "Writing a value on the flash memory in C", "body": "<p>This could be because your erase/program function is running from flash. The controller doesn't allow the flash to be erased/programmed when executing from flash. As a solution, you can copy the flash routine to RAM and execute from there.</p>\n\n<p>To make sure if that is the case, please have a look at your map file and check the address of flash routines.</p>\n"}], "owner": {"reputation": 195, "user_id": 3788048, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fSvcW.jpg?s=128&g=1", "display_name": "Asan", "link": "https://stackoverflow.com/users/3788048/asan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1326, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1576142463, "creation_date": 1574244865, "last_edit_date": 1574756265, "question_id": 58951792, "link": "https://stackoverflow.com/questions/58951792/writing-a-value-on-the-flash-memory-in-c", "title": "Writing a value on the flash memory in C", "body": "<p>Currently I am trying to write a short string on the flash memory of the microcontroller I am using. The goal would be that the program writes the firmware version at a specific address so that the bootloader can read this and check if there is an update. The driver example provided by NXP seems to work (I can write and read the variable). However, when I place this code on my program I get error 103  <code>kStatus_FTFx_AccessError</code> when running <code>FLASH_Erase</code> and the next functions. Which to my understanding means that the address I set is not correct.</p>\n\n<p>This is my memory map (linker file): </p>\n\n<pre><code>MEMORY\n{\n  m_interrupts          (RX)  : ORIGIN = 0x00000000, LENGTH = 0x00000400\n  m_flash_config        (RX)  : ORIGIN = 0x00000400, LENGTH = 0x00002000\n  m_text                (RX)  : ORIGIN = 0x00005000, LENGTH = 0x001FFBF0\n  m_data                (RW)  : ORIGIN = 0x1FFF0000, LENGTH = 0x00030000\n  m_data_2              (RW)  : ORIGIN = 0x20000000, LENGTH = 0x00030000\n}\n</code></pre>\n\n<p>The function I am running: </p>\n\n<pre><code>#include \"FlashStorage.h\"\n#include \"fsl_device_registers.h\"\n#include \"fsl_debug_console.h\"\n#include \"board.h\"\n#include \"clock_config.h\"\n#include \"fsl_flash.h\"\n#if defined(FSL_FEATURE_HAS_L1CACHE) &amp;&amp; FSL_FEATURE_HAS_L1CACHE\n#include \"fsl_cache.h\"\n#endif /* FSL_FEATURE_HAS_L1CACHE */\n#include \"pin_mux.h\"\n\n\n#define BUFFER_LEN 4\n\n\n/*! @brief Flash driver Structure */\nstatic flash_config_t s_flashDriver;\n/*! @brief Flash cache driver Structure */\nstatic ftfx_cache_config_t s_cacheDriver;\n/*! @brief Buffer for program */\nstatic uint32_t s_buffer[BUFFER_LEN];\n/*! @brief Buffer for readback */\nstatic uint32_t s_buffer_rbc[BUFFER_LEN];\n\n\n/***********************************************************************/\n/* LOCAL FUNCTION PROTOTYPES                                           */\n/***********************************************************************/\n\n\n/***********************************************************************/\n/* GLOBAL FUNCTIONS                                                    */\n/***********************************************************************/\nvoid FLASH_WriteFlashMemory(void)\n{\n    ftfx_security_state_t securityStatus = kFTFx_SecurityStateNotSecure; /* Return protection status */\n    status_t result;    /* Return code from each flash driver function */\n    uint32_t destAdrss; /* Address of the target location */\n    uint32_t i, failAddr, failDat;\n\n    uint32_t pflashBlockBase = 0;\n    uint32_t pflashTotalSize = 0;\n    uint32_t pflashSectorSize = 0;\n\n    memset(&amp;s_flashDriver, 0, sizeof(flash_config_t));\n    memset(&amp;s_cacheDriver, 0, sizeof(ftfx_cache_config_t));\n    result = FLASH_Init(&amp;s_flashDriver);\n    if (kStatus_FTFx_Success != result)\n    {\n        PRINTF(\"error \" );         //error_trap();\n\n        //error_trap();\n    }\n    /* Setup flash cache driver structure for device and initialize variables. */\n    result = FTFx_CACHE_Init(&amp;s_cacheDriver);\n    if (kStatus_FTFx_Success != result)\n    {\n        PRINTF(\"error \" );         //error_trap();\n\n        //error_trap();\n    }\n    /* Get flash properties*/\n    FLASH_GetProperty(&amp;s_flashDriver, kFLASH_PropertyPflash0BlockBaseAddr, &amp;pflashBlockBase);\n    FLASH_GetProperty(&amp;s_flashDriver, kFLASH_PropertyPflash0TotalSize, &amp;pflashTotalSize);\n    FLASH_GetProperty(&amp;s_flashDriver, kFLASH_PropertyPflash0SectorSize, &amp;pflashSectorSize);\n\n    /* Check security status. */\n    result = FLASH_GetSecurityState(&amp;s_flashDriver, &amp;securityStatus);\n    if (kStatus_FTFx_Success != result)\n    {\n        PRINTF(\"error \" );         //error_trap();\n\n        //error_trap();\n    }\n    /* Test pflash basic opeation only if flash is unsecure. */\n    if (kFTFx_SecurityStateNotSecure == securityStatus)\n    {\n        /* Pre-preparation work about flash Cache/Prefetch/Speculation. */\n        FTFx_CACHE_ClearCachePrefetchSpeculation(&amp;s_cacheDriver, true);\n\n        /* Debug message for user. */\n        /* Erase several sectors on upper pflash block where there is no code */\n        PRINTF(\"\\r\\n Erase a sector of flash\");\n\n/* In case of the protected sectors at the end of the pFlash just select\nthe block from the end of pFlash to be used for operations\nSECTOR_INDEX_FROM_END = 1 means the last sector,\nSECTOR_INDEX_FROM_END = 2 means (the last sector - 1) ...\nin case of FSL_FEATURE_FLASH_HAS_PFLASH_BLOCK_SWAP it is\nSECTOR_INDEX_FROM_END = 1 means the last 2 sectors with width of 2 sectors,\nSECTOR_INDEX_FROM_END = 2 means the last 4 sectors back\nwith width of 2 sectors ...\n*/\n#ifndef SECTOR_INDEX_FROM_END\n  #define SECTOR_INDEX_FROM_END 1U\n#endif\n\n        destAdrss = 0x2400  ;\n        result = FLASH_Erase(&amp;s_flashDriver, destAdrss, pflashSectorSize, kFTFx_ApiEraseKey);\n        if (kStatus_FTFx_Success != result)\n        {\n            PRINTF(\"error \" );         //error_trap();\n\n            //error_trap();\n        }\n\n        /* Verify sector if it's been erased. */\n        result = FLASH_VerifyErase(&amp;s_flashDriver, destAdrss, pflashSectorSize, kFTFx_MarginValueUser);\n        if (kStatus_FTFx_Success != result)\n        {\n            PRINTF(\"error \" );         //error_trap();\n\n            //error_trap();\n        }\n\n        /* Print message for user. */\n        PRINTF(\"\\r\\n Successfully Erased Sector 0x%x -&gt; 0x%x\\r\\n\", destAdrss, (destAdrss + pflashSectorSize));\n\n        /* Print message for user. */\n        PRINTF(\"\\r\\n Program a buffer to a sector of flash \");\n        /* Prepare user buffer. */\n        for (i = 0; i &lt; BUFFER_LEN; i++)\n        {\n            s_buffer[i] = 3;\n        }\n\n        /* Program user buffer into flash*/\n        result = FLASH_Program(&amp;s_flashDriver, destAdrss, (uint8_t *)s_buffer, sizeof(s_buffer));\n        if (kStatus_FTFx_Success != result)\n        {\n            PRINTF(\"error \" );         //error_trap();\n\n            //error_trap();\n        }\n\n        /* Verify programming by Program Check command with user margin levels */\n        result = FLASH_VerifyProgram(&amp;s_flashDriver, destAdrss, sizeof(s_buffer), (const uint8_t *)s_buffer, kFTFx_MarginValueUser,\n                                     &amp;failAddr, &amp;failDat);\n        if (kStatus_FTFx_Success != result)\n        {\n            PRINTF(\"error \" );         //error_trap();\n        }\n\n        for (uint32_t i = 0; i &lt; BUFFER_LEN; i++)\n                {\n                    s_buffer_rbc[i] = *(volatile uint32_t *)(destAdrss + i * 4);\n                    if (s_buffer_rbc[i] != s_buffer[i])\n                    {\n//                        error_trap();\n                    }\n\n                    PRINTF(\"\\r\\n VALUES: %d, %d, %d, %d \",s_buffer_rbc[0], s_buffer_rbc[1], s_buffer_rbc[2], s_buffer_rbc[3] );\n                }\n\n        /* Post-preparation work about flash Cache/Prefetch/Speculation. */\n        FTFx_CACHE_ClearCachePrefetchSpeculation(&amp;s_cacheDriver, false);\n\n#if defined(FSL_FEATURE_HAS_L1CACHE) &amp;&amp; FSL_FEATURE_HAS_L1CACHE\n        L1CACHE_InvalidateCodeCache();\n#endif /* FSL_FEATURE_HAS_L1CACHE */\n\n#if defined(__DCACHE_PRESENT) &amp;&amp; __DCACHE_PRESENT\n        /* Clean the D-Cache before reading the flash data*/\n        SCB_CleanInvalidateDCache();\n#endif\n\n    }\n    else\n    {\n        PRINTF(\"\\r\\n Erase/Program operation will not be executed, as Flash is SECURE!\");\n    }\n\n}\n</code></pre>\n\n<p>How can I prepare the memory to be suitable to be written? Or what would be a suitable address on where to write? I don't seem to understand why the memory address I am using is incorrect since it is not used in the memory map. </p>\n\n<p>HW and compiler:</p>\n\n<ul>\n<li>Microcontroller: K66F Development board by NXP.</li>\n<li>Kinetis design studio IDE.</li>\n<li>GNU Tools for ARM Embedded Processors (arm-none-eabi-gcc)</li>\n</ul>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 10045, "user_id": 77542, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2bb52913c4cebae8835bb50c03996d5?s=128&d=identicon&r=PG", "display_name": "Tordek", "link": "https://stackoverflow.com/users/77542/tordek"}, "edited": false, "score": 2, "creation_date": 1574244751, "post_id": 58951732, "comment_id": 104159676, "body": "Do not cast the return value of malloc."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1574244903, "post_id": 58951732, "comment_id": 104159777, "body": "<code>a1-&gt;name</code> is an uninitialised value. You need to allocate dynamic memory or declare that as a fixed size char array."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1574244905, "post_id": 58951732, "comment_id": 104159780, "body": "You have not allocated any space for <code>a1-&gt;name</code>"}, {"owner": {"reputation": 273, "user_id": 12403204, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Fcjy5xM8CAY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdipV7nrrozrL_3Ye5rQIPfFUSTbQ/photo.jpg?sz=128", "display_name": "Leo S", "link": "https://stackoverflow.com/users/12403204/leo-s"}, "edited": false, "score": 0, "creation_date": 1574244956, "post_id": 58951732, "comment_id": 104159822, "body": "It did not work. I removed (struct Person*) but still getting an error. I am new in c so can you explain a little more.@Tordek"}, {"owner": {"reputation": 10045, "user_id": 77542, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2bb52913c4cebae8835bb50c03996d5?s=128&d=identicon&r=PG", "display_name": "Tordek", "link": "https://stackoverflow.com/users/77542/tordek"}, "edited": false, "score": 0, "creation_date": 1574245101, "post_id": 58951732, "comment_id": 104159906, "body": "My comment was not meant as a solution but as a good practice. By casting the return value of <code>malloc</code> you&#39;re hiding potential bugs, and obscuring code unnecessarily."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1574245593, "post_id": 58951732, "comment_id": 104160215, "body": "Please provide a [mvce], a complete compilable program. Casting the return value of malloc and <i>not</i> having includes can <b>exactly</b> cause crashes too. If you do not provide the code I am going to assume that&#39;s the reason."}], "answers": [{"comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1574245661, "post_id": 58951829, "comment_id": 104160254, "body": "<i>and</i> #includes..."}, {"owner": {"reputation": 273, "user_id": 12403204, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Fcjy5xM8CAY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdipV7nrrozrL_3Ye5rQIPfFUSTbQ/photo.jpg?sz=128", "display_name": "Leo S", "link": "https://stackoverflow.com/users/12403204/leo-s"}, "edited": false, "score": 0, "creation_date": 1574246057, "post_id": 58951829, "comment_id": 104160518, "body": "Thanks for your helpful comment. This is not related under the topic but i wonder that if i initialize header with malloc. The types of the node class are initialized NULL? And also i have created the head with struct Node* head=NULL so what if i do struct Node head=NULL these two are different? I am new on c and these type of questions are confusing.@Blaze"}, {"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "reply_to_user": {"reputation": 273, "user_id": 12403204, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Fcjy5xM8CAY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdipV7nrrozrL_3Ye5rQIPfFUSTbQ/photo.jpg?sz=128", "display_name": "Leo S", "link": "https://stackoverflow.com/users/12403204/leo-s"}, "edited": false, "score": 0, "creation_date": 1574246389, "post_id": 58951829, "comment_id": 104160732, "body": "@XY <code>head</code> is just a pointer. When you assign to it with <code>head=malloc(sizeof(struct Node));</code> it overwrites the value it previously had. With <code>struct Node head=NULL</code> you&#39;re making a pointer and setting its value to <code>NULL</code>, but it&#39;s not allocating any memory for it yet."}], "tags": [], "owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "is_accepted": false, "score": 0, "last_activity_date": 1574245868, "last_edit_date": 1574245868, "creation_date": 1574244952, "answer_id": 58951829, "question_id": 58951732, "link": "https://stackoverflow.com/questions/58951732/initialization-of-string-in-struct/58951829#58951829", "title": "initialization of string in struct", "body": "<p>That's because you're not allocating memory for <code>a1-&gt;name</code>. Sure, you're allocating memory for <code>a1</code>, which includes the pointer <code>a1-&gt;name</code>, but <code>name</code> is not pointing anywhere valid. You need to allocate memory for that, too:</p>\n\n<pre><code>a1-&gt;name = malloc(sizeof(\"nameee\"));\n</code></pre>\n\n<p>And don't forget to free all your memory when you're done:</p>\n\n<pre><code>free(a1-&gt;name);\nfree(a1);\nfree(head);\nfree(tail);\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p>These two are global variables and they are initialized with null\n  above.</p>\n</blockquote>\n\n<p>To have a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">Minimal, Reproducible Example</a> is i helpful if you include parts like that in your code, like this:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\nstruct Node {\n    struct Person *data;\n    struct Node *next;\n    struct Node *prev;\n} *head, *tail;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 564, "user_id": 5199255, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/seJ5j.jpg?s=128&g=1", "display_name": "Damiano", "link": "https://stackoverflow.com/users/5199255/damiano"}, "is_accepted": false, "score": 0, "last_activity_date": 1574244973, "creation_date": 1574244973, "answer_id": 58951844, "question_id": 58951732, "link": "https://stackoverflow.com/questions/58951732/initialization-of-string-in-struct/58951844#58951844", "title": "initialization of string in struct", "body": "<p>a1->name is not initialized, you should malloc it or change it to an array like</p>\n\n<pre><code>#define MAX_NAME_LENGTH 30\n\nstruct Person{\n  char name[MAX_NAME_LENGTH];\n  int numb;\n  char *var;\n};```\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 10045, "user_id": 77542, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2bb52913c4cebae8835bb50c03996d5?s=128&d=identicon&r=PG", "display_name": "Tordek", "link": "https://stackoverflow.com/users/77542/tordek"}, "is_accepted": true, "score": 0, "last_activity_date": 1574245120, "last_edit_date": 1574245120, "creation_date": 1574245002, "answer_id": 58951862, "question_id": 58951732, "link": "https://stackoverflow.com/questions/58951732/initialization-of-string-in-struct/58951862#58951862", "title": "initialization of string in struct", "body": "<pre><code>struct Person *a1 = malloc(sizeof(struct Person));\nchar is[] = \"nameee\";\nstrcpy(a1-&gt;name,is);\n</code></pre>\n\n<p><code>strcpy</code> copies a string into a memory location (in this case, <code>a1-&gt;name</code>); it needs to be allocated. <code>a1-&gt;name</code>'s value is uninitialized, thus you are writing in an undefined location in memory.</p>\n\n<p>You need to allocate space for it, for example like:</p>\n\n<pre><code>struct Person *a1 = malloc(sizeof(struct Person));\nchar is[] = \"nameee\";\na1-&gt;name = malloc(strlen(is) + 1);\nstrcpy(a1-&gt;name,is);\n</code></pre>\n\n<p>or, use <code>strdup</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 1701, "user_id": 5836577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/931236857b09c3b0aea0f29fb5a23cbc?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Petitjean", "link": "https://stackoverflow.com/users/5836577/guillaume-petitjean"}, "is_accepted": false, "score": 0, "last_activity_date": 1574245054, "creation_date": 1574245054, "answer_id": 58951880, "question_id": 58951732, "link": "https://stackoverflow.com/questions/58951732/initialization-of-string-in-struct/58951880#58951880", "title": "initialization of string in struct", "body": "<p>You are allocating a variable of type <code>struct Person</code>. The field <code>name</code>is just a pointer. But there is no space allocated for the string that <code>name</code> points to.</p>\n\n<p>You need to allocate the string itself, something like: <code>a1-&gt;name = malloc(xxx);</code></p>\n"}], "owner": {"reputation": 273, "user_id": 12403204, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Fcjy5xM8CAY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdipV7nrrozrL_3Ye5rQIPfFUSTbQ/photo.jpg?sz=128", "display_name": "Leo S", "link": "https://stackoverflow.com/users/12403204/leo-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "closed_date": 1574245632, "accepted_answer_id": 58951862, "answer_count": 4, "score": 0, "last_activity_date": 1574245868, "creation_date": 1574244679, "question_id": 58951732, "link": "https://stackoverflow.com/questions/58951732/initialization-of-string-in-struct", "closed_reason": "Duplicate", "title": "initialization of string in struct", "body": "<pre><code>struct Person{\n  char *name;\n  int numb;\n  char *var;\n};\n\nstruct Node{\n   struct Person *data;\n   struct Node *next;\n   struct Node *prev;\n};\n\n\nint main() {\n\nhead=(struct Node*)(malloc(sizeof(struct Node)));//\ntail=(struct Node*)(malloc(sizeof(struct Node)));//These two are global variables and they are initialized with null above.\n\n struct Person *a1=(struct Person*)(malloc(sizeof(struct Person)));\n char is[]=\"nameee\";\n strcpy(a1-&gt;name,is);\n\n printf(\"%s\\n\",a1-&gt;name);\n\n\n\n  return 0;\n}\n</code></pre>\n\n<p>why i am getting segmentation fault for that code? I created a doubly linked list stored Person but when i initialized the structure with a string this code is getting an error. </p>\n"}, {"tags": ["c", "preprocessor-directive"], "comments": [{"owner": {"reputation": 633, "user_id": 10819212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J8mjR.png?s=128&g=1", "display_name": "Felix G", "link": "https://stackoverflow.com/users/10819212/felix-g"}, "edited": false, "score": 2, "creation_date": 1574245088, "post_id": 58951714, "comment_id": 104159897, "body": "While you can&#39;t use an <code>#ifdef</code> for your second case, you absolutely <b>can</b> use an <code>#if</code> so there would be no additional runtime cost for TEST 0. This btw. also means you can have multiple different values for TEST, maybe corresponding to different log levels or things like that"}, {"owner": {"reputation": 889, "user_id": 8080758, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5ce11073e465a49f65a4a6430e090dae?s=128&d=identicon&r=PG&f=1", "display_name": "Cl&#233;ment", "link": "https://stackoverflow.com/users/8080758/cl%c3%a9ment"}, "reply_to_user": {"reputation": 633, "user_id": 10819212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J8mjR.png?s=128&g=1", "display_name": "Felix G", "link": "https://stackoverflow.com/users/10819212/felix-g"}, "edited": false, "score": 0, "creation_date": 1574245506, "post_id": 58951714, "comment_id": 104160162, "body": "This is exactly the case I can have. Thank you for the answer."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 633, "user_id": 10819212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J8mjR.png?s=128&g=1", "display_name": "Felix G", "link": "https://stackoverflow.com/users/10819212/felix-g"}, "edited": false, "score": 0, "creation_date": 1574245588, "post_id": 58951714, "comment_id": 104160213, "body": "@FelixG: Put in an answer so the OP can accept?"}], "answers": [{"comments": [{"owner": {"reputation": 10045, "user_id": 77542, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2bb52913c4cebae8835bb50c03996d5?s=128&d=identicon&r=PG", "display_name": "Tordek", "link": "https://stackoverflow.com/users/77542/tordek"}, "edited": false, "score": 0, "creation_date": 1574245365, "post_id": 58951765, "comment_id": 104160073, "body": "An additional benefit to the first way is that toolchains allow you to define constants externally; generally, using &quot;-DDEBUG&quot; to enable debug options without having to modify files."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1574245996, "post_id": 58951765, "comment_id": 104160480, "body": "That&#39;s some &gt;400 moons ago so I&#39;m not sure it is relevant. Also, early Solaris machines probably had a BFM instruction that newer computers lack (Branch on Full Moon)."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1574246000, "post_id": 58951765, "comment_id": 104160484, "body": "<i>Many moons ago some compilers (one for Solaris if I recall correctly)</i>  Probably pre-C89, so &quot;many moons&quot; is 30+ years ago.  I remember when the &quot;ANSI&quot; standard came out, the <code>-ansi</code> argument to the Sun compiler would break a lot of preexisting code."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1574246297, "post_id": 58951765, "comment_id": 104160667, "body": "@Lundin, Only 10 years ago in a large investment bank I had to support a compiler that required the second way so I believe it&#39;s still relevant enough to indicate the possibility here. I left before the compiler was changed."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 2, "last_activity_date": 1574245231, "last_edit_date": 1574245231, "creation_date": 1574244778, "answer_id": 58951765, "question_id": 58951714, "link": "https://stackoverflow.com/questions/58951714/ifdef-vs-define-boolean/58951765#58951765", "title": "(#ifdef) vs. (#define &lt;boolean&gt;)", "body": "<p>Many moons ago some compilers (one for Solaris if I recall correctly) would not correctly compile code that used the first snippet.</p>\n\n<p>But the C standard (now) requires them to and as such there is no benefit at all in using the second way which could now be regarded as idiosyncratic.</p>\n\n<p>Of course if you need <code>TEST</code> to be a numerical value such as in a condition check as opposed to merely using <code>#ifdef</code> then you'd need to use the second way.</p>\n"}, {"tags": [], "owner": {"reputation": 633, "user_id": 10819212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J8mjR.png?s=128&g=1", "display_name": "Felix G", "link": "https://stackoverflow.com/users/10819212/felix-g"}, "is_accepted": true, "score": 5, "last_activity_date": 1574245669, "creation_date": 1574245669, "answer_id": 58952099, "question_id": 58951714, "link": "https://stackoverflow.com/questions/58951714/ifdef-vs-define-boolean/58952099#58952099", "title": "(#ifdef) vs. (#define &lt;boolean&gt;)", "body": "<p>While you can't use an <code>#ifdef</code> for your second case, you absolutely can use an <code>#if</code> so there would be no additional runtime cost for TEST 0. This btw. also means you can have multiple different values for TEST, maybe corresponding to different log levels or things like that</p>\n\n<p>(Posted my comment as an answer, as suggested by Bathsheba)</p>\n"}], "owner": {"reputation": 889, "user_id": 8080758, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5ce11073e465a49f65a4a6430e090dae?s=128&d=identicon&r=PG&f=1", "display_name": "Cl&#233;ment", "link": "https://stackoverflow.com/users/8080758/cl%c3%a9ment"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "closed_date": 1574246913, "accepted_answer_id": 58952099, "answer_count": 2, "score": 2, "last_activity_date": 1574245669, "creation_date": 1574244629, "question_id": 58951714, "link": "https://stackoverflow.com/questions/58951714/ifdef-vs-define-boolean", "closed_reason": "Opinion-based", "title": "(#ifdef) vs. (#define &lt;boolean&gt;)", "body": "<p>I am trying to figure out which practice is the best between : </p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#define TEST \n//#define TEST commented if not used or simply deleted\n</code></pre>\n\n<pre class=\"lang-c prettyprint-override\"><code>#define TEST 1\n#define TEST 0 //if not used\n</code></pre>\n\n<p>For readability, I prefer to define a \"Boolean\" and check it in a <code>if</code> but I guess it is not efficient since it doesn't use <code>#ifdef</code> and it needs to be checked everytime in a if</p>\n"}, {"tags": ["c++", "c", "windows"], "comments": [{"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 4, "creation_date": 1574242884, "post_id": 58951095, "comment_id": 104158568, "body": "If you figure out the endianness, <code>std::memcpy</code> may work just fine."}, {"owner": {"reputation": 48092, "user_id": 136208, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a30f566f1b7c9ae44cf245138850ba4?s=128&d=identicon&r=PG", "display_name": "AProgrammer", "link": "https://stackoverflow.com/users/136208/aprogrammer"}, "edited": false, "score": 4, "creation_date": 1574242957, "post_id": 58951095, "comment_id": 104158603, "body": "Just continue the pattern until you handle the 8 bytes."}, {"owner": {"reputation": 1041, "user_id": 6583298, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/5xZmG.jpg?s=128&g=1", "display_name": "Norbert Boros", "link": "https://stackoverflow.com/users/6583298/norbert-boros"}, "edited": false, "score": 0, "creation_date": 1574243091, "post_id": 58951095, "comment_id": 104158683, "body": "Thanks for the prompt response guys, I added an &quot;update&quot; where I state that c or c++ is fine, and endian-ess can be ignored."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 1, "creation_date": 1574243249, "post_id": 58951095, "comment_id": 104158766, "body": "Your first step should be to understand how the 32-bit version works. Then you can easily generalise that to any bit width."}, {"owner": {"reputation": 4398, "user_id": 3697264, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5adc5afbd7a1145fdd762d872b4b43bb?s=128&d=identicon&r=PG", "display_name": "SPlatten", "link": "https://stackoverflow.com/users/3697264/splatten"}, "edited": false, "score": 0, "creation_date": 1574243281, "post_id": 58951095, "comment_id": 104158780, "body": "A very simple and powerful way to do this, create a union which contains the byte array and the DWORD64 you are after then when you copy your bytes to the array the 64bit DWORD will automatically be populated."}, {"owner": {"reputation": 1041, "user_id": 6583298, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/5xZmG.jpg?s=128&g=1", "display_name": "Norbert Boros", "link": "https://stackoverflow.com/users/6583298/norbert-boros"}, "reply_to_user": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1574243289, "post_id": 58951095, "comment_id": 104158789, "body": "@molbdnilo You are absolutely right, however I do not (yet) understand shifting properly :)"}, {"owner": {"reputation": 1041, "user_id": 6583298, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/5xZmG.jpg?s=128&g=1", "display_name": "Norbert Boros", "link": "https://stackoverflow.com/users/6583298/norbert-boros"}, "reply_to_user": {"reputation": 4398, "user_id": 3697264, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5adc5afbd7a1145fdd762d872b4b43bb?s=128&d=identicon&r=PG", "display_name": "SPlatten", "link": "https://stackoverflow.com/users/3697264/splatten"}, "edited": false, "score": 0, "creation_date": 1574243317, "post_id": 58951095, "comment_id": 104158804, "body": "@SPlatten Sounds very interesting, post your answer ?"}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 4, "creation_date": 1574243918, "post_id": 58951095, "comment_id": 104159170, "body": "<code>getDwordFromBytes</code> has a bug in it. It invokes undefined behavior if <code>b[3] &gt; 127</code>, because it will overflow the integer promoted expression <code>(b[3] &lt;&lt; 24)</code>."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1574243945, "post_id": 58951095, "comment_id": 104159185, "body": "@NorbertBoros Then learning about bit manipulation should be your very first step."}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "reply_to_user": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1574245140, "post_id": 58951095, "comment_id": 104159931, "body": "To fix the bug pointed out by @mch, add an explicit cast : <code>(((uint32_t) b[3]) &lt;&lt; 24)</code> (or if you must use non-standard types : <code>(((DWORD) b[3]) &lt;&lt; 24)</code>). You should probably do this for the others as well."}, {"owner": {"reputation": 1041, "user_id": 6583298, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/5xZmG.jpg?s=128&g=1", "display_name": "Norbert Boros", "link": "https://stackoverflow.com/users/6583298/norbert-boros"}, "edited": false, "score": 0, "creation_date": 1574245237, "post_id": 58951095, "comment_id": 104159990, "body": "Thank you for all for the attention and your willingness to help, but if you have a good solution could you not post an answer ?"}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1574252665, "post_id": 58952221, "comment_id": 104164302, "body": "Right, my bad, all those parenthesis made it unreadable. I&#39;d consider fixing by adding a temp pointer in the function: <code>const uint8_t* u8 = arr;</code>, then voila each line in the macro can get simplified into <code>((uint64_t)arr[7] &lt;&lt; 56)</code>. Or if being pedantic about macro safety, <code>((uint64_t)(arr)[7] &lt;&lt; 56)</code>"}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": true, "score": 3, "last_activity_date": 1574251874, "last_edit_date": 1574251874, "creation_date": 1574246010, "answer_id": 58952221, "question_id": 58951095, "link": "https://stackoverflow.com/questions/58951095/c-c-convert-an-array-of-8-bytes-into-a-64-bit-integer/58952221#58952221", "title": "C/C++ Convert an array of 8 bytes into a 64-bit integer", "body": "<p>if you care about the endianness and do not want to use any pointer or union punning</p>\n\n<pre><code>#define to64b(arr) (((uint64_t)(((uint8_t *)(arr))[7]) &lt;&lt;  0)+\\ \n                    ((uint64_t)(((uint8_t *)(arr))[6]) &lt;&lt;  8)+\\\n                    ((uint64_t)(((uint8_t *)(arr))[5]) &lt;&lt; 16)+\\\n                    ((uint64_t)(((uint8_t *)(arr))[4]) &lt;&lt; 24)+\\\n                    ((uint64_t)(((uint8_t *)(arr))[3]) &lt;&lt; 32)+\\\n                    ((uint64_t)(((uint8_t *)(arr))[2]) &lt;&lt; 40)+\\\n                    ((uint64_t)(((uint8_t *)(arr))[1]) &lt;&lt; 48)+\\\n                    ((uint64_t)(((uint8_t *)(arr))[0]) &lt;&lt; 56))\n\n#define to64l(arr) (((uint64_t)(((uint8_t *)(arr))[0]) &lt;&lt;  0)+\\ \n                    ((uint64_t)(((uint8_t *)(arr))[1]) &lt;&lt;  8)+\\\n                    ((uint64_t)(((uint8_t *)(arr))[2]) &lt;&lt; 16)+\\\n                    ((uint64_t)(((uint8_t *)(arr))[3]) &lt;&lt; 24)+\\\n                    ((uint64_t)(((uint8_t *)(arr))[4]) &lt;&lt; 32)+\\\n                    ((uint64_t)(((uint8_t *)(arr))[5]) &lt;&lt; 40)+\\\n                    ((uint64_t)(((uint8_t *)(arr))[6]) &lt;&lt; 48)+\\\n                    ((uint64_t)(((uint8_t *)(arr))[7]) &lt;&lt; 56))\n\nuint64_t toUnsigned64(const void *arr, int bigend)\n{\n    return bigend ? to64b(arr) : to64l(arr);   \n}\n</code></pre>\n"}], "owner": {"reputation": 1041, "user_id": 6583298, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/5xZmG.jpg?s=128&g=1", "display_name": "Norbert Boros", "link": "https://stackoverflow.com/users/6583298/norbert-boros"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1086, "favorite_count": 0, "accepted_answer_id": 58952221, "answer_count": 1, "score": 0, "last_activity_date": 1574251874, "creation_date": 1574242771, "last_edit_date": 1574243153, "question_id": 58951095, "link": "https://stackoverflow.com/questions/58951095/c-c-convert-an-array-of-8-bytes-into-a-64-bit-integer", "title": "C/C++ Convert an array of 8 bytes into a 64-bit integer", "body": "<p>In one of my tasks I need to store DWORD into BYTE(s) and then convert them back. Platform is windows only.</p>\n\n<p>I have found the following on this website:</p>\n\n<pre><code>//Convert an array of four bytes into a 32-bit integer.\nDWORD getDwordFromBytes(BYTE* b)\n{\n    return (b[0]) | (b[1] &lt;&lt; 8) | (b[2] &lt;&lt; 16) | (b[3] &lt;&lt; 24);\n};\n</code></pre>\n\n<p>This works for converting 4 bytes into 1 DWORD, however how would you do this for DWORD64 ?</p>\n\n<p>I have tried the following but it's not returning correctly as I am losing data:</p>\n\n<pre><code>DWORD64 getDwordFromBytes64(BYTE* b)\n{\n    return ((DWORD64)b[0]) | ((DWORD64)b[1] &lt;&lt; 8) | ((DWORD64)b[2] &lt;&lt; 16) | ((DWORD64)b[3] &lt;&lt; 24);\n};\n</code></pre>\n\n<p>Suppose I have a byte array:</p>\n\n<pre><code>BYTE[] = {0x38,0xf0,0x07,0x40,0x01,0x00,0x00,0x00}; //000000014007F038\n</code></pre>\n\n<p>I need to get 000000014007F038 (DWORD64) back from it correctly.</p>\n\n<p>If someone would give me a solution I would very much appreciate it.</p>\n\n<p>Update:</p>\n\n<ul>\n<li>I can accept any solution wheter C or C++.</li>\n<li>\"Endianness\" can be ignored.</li>\n</ul>\n"}, {"tags": ["c", "multithreading", "linux-kernel", "linux-device-driver"], "answers": [{"comments": [{"owner": {"reputation": 375, "user_id": 11958500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/808134f06cedf9957a27a924d1589f3a?s=128&d=identicon&r=PG&f=1", "display_name": "gaston", "link": "https://stackoverflow.com/users/11958500/gaston"}, "edited": false, "score": 0, "creation_date": 1574243558, "post_id": 58951176, "comment_id": 104158946, "body": "Using local variable So I need to define <code>static struct task_struct *thread1</code> inside the <code>read_pid</code> function ? And how can I wait the thread to complete ?"}, {"owner": {"reputation": 896, "user_id": 6659361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/200d3e89398030d70445b9a3f071c385?s=128&d=identicon&r=PG&f=1", "display_name": "Maxime B.", "link": "https://stackoverflow.com/users/6659361/maxime-b"}, "reply_to_user": {"reputation": 375, "user_id": 11958500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/808134f06cedf9957a27a924d1589f3a?s=128&d=identicon&r=PG&f=1", "display_name": "gaston", "link": "https://stackoverflow.com/users/11958500/gaston"}, "edited": false, "score": 0, "creation_date": 1574243953, "post_id": 58951176, "comment_id": 104159191, "body": "Yes. A way to do that is to use kthread_stop <a href=\"https://elixir.bootlin.com/linux/latest/source/kernel/kthread.c#L547\" rel=\"nofollow noreferrer\">defined there</a>."}, {"owner": {"reputation": 375, "user_id": 11958500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/808134f06cedf9957a27a924d1589f3a?s=128&d=identicon&r=PG&f=1", "display_name": "gaston", "link": "https://stackoverflow.com/users/11958500/gaston"}, "edited": false, "score": 0, "creation_date": 1574245018, "post_id": 58951176, "comment_id": 104159855, "body": "The first solution is not working, I am facing same trouble with it."}, {"owner": {"reputation": 896, "user_id": 6659361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/200d3e89398030d70445b9a3f071c385?s=128&d=identicon&r=PG&f=1", "display_name": "Maxime B.", "link": "https://stackoverflow.com/users/6659361/maxime-b"}, "reply_to_user": {"reputation": 375, "user_id": 11958500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/808134f06cedf9957a27a924d1589f3a?s=128&d=identicon&r=PG&f=1", "display_name": "gaston", "link": "https://stackoverflow.com/users/11958500/gaston"}, "edited": false, "score": 1, "creation_date": 1574245212, "post_id": 58951176, "comment_id": 104159975, "body": "It should work. Please edit your post with your current code so that we can understand your issue"}, {"owner": {"reputation": 896, "user_id": 6659361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/200d3e89398030d70445b9a3f071c385?s=128&d=identicon&r=PG&f=1", "display_name": "Maxime B.", "link": "https://stackoverflow.com/users/6659361/maxime-b"}, "reply_to_user": {"reputation": 375, "user_id": 11958500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/808134f06cedf9957a27a924d1589f3a?s=128&d=identicon&r=PG&f=1", "display_name": "gaston", "link": "https://stackoverflow.com/users/11958500/gaston"}, "edited": false, "score": 0, "creation_date": 1574248800, "post_id": 58951176, "comment_id": 104162098, "body": "Although static, thread1 is still global in the code you posted! Please, verify your code before saying it doesn&#39;t work, the modifications I asked for are straightforward"}, {"owner": {"reputation": 375, "user_id": 11958500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/808134f06cedf9957a27a924d1589f3a?s=128&d=identicon&r=PG&f=1", "display_name": "gaston", "link": "https://stackoverflow.com/users/11958500/gaston"}, "edited": false, "score": 0, "creation_date": 1574248911, "post_id": 58951176, "comment_id": 104162158, "body": "I published my first code in the edited version. It does not include the modifications that you have suggested"}, {"owner": {"reputation": 375, "user_id": 11958500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/808134f06cedf9957a27a924d1589f3a?s=128&d=identicon&r=PG&f=1", "display_name": "gaston", "link": "https://stackoverflow.com/users/11958500/gaston"}, "edited": false, "score": 0, "creation_date": 1574250141, "post_id": 58951176, "comment_id": 104162855, "body": "I have declared <code>struct task_struct *thread1</code> inside <code>read_pid</code> function as you have mentioned, the problem was that it had type <code>static</code> as you said. Now it does not print to me <code>THREAD1 IS NOT NULL!!! CAN NOT CREATE THREAD!!!</code> But it says <code>pid = 0</code> <code>No such pid</code> and this when I try to re-excute my user-space program. I edited my code and I included the first solution"}], "tags": [], "owner": {"reputation": 896, "user_id": 6659361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/200d3e89398030d70445b9a3f071c385?s=128&d=identicon&r=PG&f=1", "display_name": "Maxime B.", "link": "https://stackoverflow.com/users/6659361/maxime-b"}, "is_accepted": true, "score": 0, "last_activity_date": 1574243033, "creation_date": 1574243033, "answer_id": 58951176, "question_id": 58950918, "link": "https://stackoverflow.com/questions/58950918/probelm-with-using-threads-in-linux-kernel-module/58951176#58951176", "title": "Probelm with using Threads in Linux kernel Module", "body": "<p>As you mentionned, the thread is correctly marked as not null since it is <em>already</em> running. So the behaviour is intended.</p>\n\n<p>So in order to solve your issue you have to describe what is you actual intended behavior.</p>\n\n<p>If you want to make it run multiple times, you might want to use a local variable to run the thread (for instance storing it in an array for later communication).</p>\n\n<p>You could also wait the previous thread to complete before running the next one.</p>\n"}, {"comments": [{"owner": {"reputation": 375, "user_id": 11958500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/808134f06cedf9957a27a924d1589f3a?s=128&d=identicon&r=PG&f=1", "display_name": "gaston", "link": "https://stackoverflow.com/users/11958500/gaston"}, "edited": false, "score": 0, "creation_date": 1574249645, "post_id": 58953194, "comment_id": 104162588, "body": "you said &quot; But after the read_pid done, the kernel did not stop. So the thread is still there. &quot; I think that the best solution is to stop it after <code>read_pid</code> function is done. Isn&#39;t it ?"}, {"owner": {"reputation": 2346, "user_id": 2549281, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/XpMre.jpg?s=128&g=1", "display_name": "Dabo", "link": "https://stackoverflow.com/users/2549281/dabo"}, "reply_to_user": {"reputation": 375, "user_id": 11958500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/808134f06cedf9957a27a924d1589f3a?s=128&d=identicon&r=PG&f=1", "display_name": "gaston", "link": "https://stackoverflow.com/users/11958500/gaston"}, "edited": false, "score": 0, "creation_date": 1574250332, "post_id": 58953194, "comment_id": 104162957, "body": "This is not how kernel designed to work. You don&#39;t start and kill threads any time the user wants from your driver something. If it is something you can provide synchronously, don&#39;t create a thread, just send it from the <code>read</code> function. If it is something that takes a lot of time to process, then make a thread which processes the data and prepares it continuously, and return the result to user only when he ask from the <code>read</code> function"}], "tags": [], "owner": {"reputation": 2346, "user_id": 2549281, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/XpMre.jpg?s=128&g=1", "display_name": "Dabo", "link": "https://stackoverflow.com/users/2549281/dabo"}, "is_accepted": false, "score": 0, "last_activity_date": 1574249008, "creation_date": 1574249008, "answer_id": 58953194, "question_id": 58950918, "link": "https://stackoverflow.com/questions/58950918/probelm-with-using-threads-in-linux-kernel-module/58953194#58953194", "title": "Probelm with using Threads in Linux kernel Module", "body": "<p>Your kernel code lives before and after your user space code started and finished to run. So when you execute your command for the first time, the kernel thread is created, as it is the first time the <code>read_pid</code> called so the thread is created. But after the <code>read_pid</code> done, the kernel did not stop. So the thread is still there. It looks like you should create your thread in the driver's <code>probe</code> function, and write the threads logic in the way that it only prepares data for the <code>read_pid</code> call. The signal usage looks absolutely unnecessary in your case.</p>\n"}], "owner": {"reputation": 375, "user_id": 11958500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/808134f06cedf9957a27a924d1589f3a?s=128&d=identicon&r=PG&f=1", "display_name": "gaston", "link": "https://stackoverflow.com/users/11958500/gaston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 403, "favorite_count": 0, "accepted_answer_id": 58951176, "answer_count": 2, "score": -1, "last_activity_date": 1574259297, "creation_date": 1574242187, "last_edit_date": 1574259297, "question_id": 58950918, "link": "https://stackoverflow.com/questions/58950918/probelm-with-using-threads-in-linux-kernel-module", "title": "Probelm with using Threads in Linux kernel Module", "body": "<p>I am developing Linux kernel module which is communicating with my user-space C application. In this module, I am creating a thread. this is my module where I am facing the problem :</p>\n\n<pre><code>#include &lt;linux/module.h&gt;\n#include &lt;linux/kernel.h&gt;\n#include &lt;linux/init.h&gt;\n#include &lt;asm/siginfo.h&gt;    //siginfo\n#include &lt;linux/rcupdate.h&gt;    //rcu_read_lock\n#include &lt;linux/sched/signal.h&gt;    //find_task_by_pid_type\n#include &lt;linux/debugfs.h&gt;\n#include &lt;linux/uaccess.h&gt;\n#include&lt;linux/slab.h&gt;\n#include &lt;linux/input.h&gt;\n#include &lt;linux/device.h&gt;\n#include &lt;linux/fs.h&gt; \n#include &lt;linux/random.h&gt; \n#include &lt;linux/kthread.h&gt; \n\n#define SIG_TEST 44    // we choose 44 as our signal number (real-time signals are in the range of 33 to 64)\n#define BTN_FILE_PATH \"/dev/input/event0\"\n\n\nchar *str = BTN_FILE_PATH;\nint file;\n\nstruct file *f;   // keyboard driver\n\n// prototypage des fonctions read_in_thread &amp; read_pid\nint read_in_thread(void *data);\nstatic ssize_t read_pid(struct file *pfile, char __user *buffer, size_t length, loff_t *offset);\n\n\nstatic ssize_t write_pid(struct file *pfile, const char __user *buffer,\n                                size_t length, loff_t *offset)\n{\n   return 0;\n}\n\n\n\nstruct read_args {\n    struct file *pfile;\n    const char __user *buffer;\n    size_t length;\n    loff_t *offset;\n};\n\n\nstatic ssize_t read_pid(struct file *pfile, char __user *buffer, size_t length, loff_t *offset)\n{\n  // cr\u00e9ation de la structure des arguments\n    struct read_args args ;\n    args.pfile = pfile;\n    args.buffer = buffer;\n    args.length = length;\n    args.offset = offset;\n\nstruct task_struct *thread1;\nchar our_thread[20];\nunsigned int rand;\n\nget_random_bytes(&amp;rand, sizeof(rand));\nrand = rand % 250;\nsprintf(our_thread, \"thread%u\", rand);\n\nif(thread1==NULL)\n{\nthread1 = kthread_create(read_in_thread,&amp;args,our_thread);\n    if((thread1))\n        {\n            printk(KERN_INFO \"Thread is created\\n\");\n        printk(\"thread name %s\\n\", our_thread);\n// lancement du thread\n            wake_up_process(thread1);\n        printk(KERN_INFO \"Thread is awake\\n\");\n        }\n}\n\nelse \nprintk(\"\\nTHREAD1 IS NOT NULL!!! CAN NOT CREATE THREAD!!!\\n\"); \n\nreturn 0;                   \n}\n\n\n\nint read_in_thread(void *data) {\n\n/************************** r\u00e9cup\u00e9ration des arguments *******************/\n\n    struct read_args *const args = data;\n\n/***************************   corps de la fonction ***********************/\n\n\n// init des variables \n\n    char mybuf[10];\n    enum { MAX_BUF_SIZE = 4096 };\n    size_t buf_size = 0;\n    char *buf = NULL;\n    ssize_t total = 0;\n    ssize_t rc = 0;\n    struct task_struct *t;\n    struct input_event ev[64];\n    int yalv;\n\n    int ret;\n    struct siginfo info;\n    int pid =0; \n    size_t amount = sizeof(ev);    \n\n\n// r\u00e9cup\u00e9ration de l'ID du processus appelant\n\n/* read the value from user space */\n    if(args-&gt;length &gt; 10)\n        return -EINVAL;\n    copy_from_user(mybuf, args-&gt;buffer, args-&gt;length);\n    sscanf(mybuf, \"%d\", &amp;pid);\n    printk(\"pid = %d\\n\", pid);\n\n    // the signal \n    memset(&amp;info, 0, sizeof(struct siginfo));\n    info.si_signo = SIG_TEST;\n    info.si_code = SI_QUEUE;    // this is bit of a trickery: SI_QUEUE is normally used by sigqueue from user space,\n                    // and kernel space should use SI_KERNEL. But if SI_KERNEL is used the real_time data \n                    // is not delivered to the user space signal handler function. \n    info.si_int = 260;          //real time signals may have 32 bits of data.\n\n    rcu_read_lock();\n    t = pid_task(find_vpid(pid), PIDTYPE_PID);  //find the task_struct associated with this pid\n    if(t == NULL){\n        printk(\"no such pid\\n\");\n        rcu_read_unlock();\n        return -ENODEV;\n    }\n    rcu_read_unlock();\n\n\n// lecture blocquante\n\n    rc = kernel_read(f, ev, amount, &amp;f-&gt;f_pos);\n\n// r\u00e9cup\u00e9ration de l'\u00e9v\u00e9nement\n\n    if (rc &gt; 0) {\n            for (yalv = 0; yalv &lt; (int) (rc / sizeof(struct input_event)); yalv++) {\n            if (ev[yalv].type == EV_KEY) {\n                if (ev[yalv].value == 0)\n                     //eval_keycode(ev[yalv].code);\n                     info.si_int = ev[yalv].code;  \n\n// envoie du signal vers le processus appelant avec les \u00e9v\u00e9nements lu\n\n                                         ret = send_sig_info(SIG_TEST, &amp;info, t);    //send the signal\n                         printk(\"signal was send\\n\");\n                     if (ret &lt; 0) {\n                            printk(\"error sending signal\\n\");\n                        kfree(buf);\n                            return ret;\n                         }              \n            }\n        }\n\n                if (rc &lt; amount) {\n                    /* Didn't read the full amount, so terminate early. */\n                    rc = 0;\n                }\n\n    } \n\n    /* Free temporary buffer. */\n        kfree(buf);\n\nreturn 0;\n}\n\n\n\n\nstatic const struct file_operations my_fops = {\n    .owner = THIS_MODULE,\n    .write = write_pid,\n    .read = read_pid,\n    //.open = open_pid,\n};\n\n\n\nstatic int __init signalexample_module_init(void)\n{\n     printk(KERN_INFO \"Initializing LKM\");\n    /* we need to know the pid of the user space process\n      * -&gt; we use debugfs for this. As soon as a pid is written to \n      * this file, a signal is sent to that pid\n      */\n    /* only root can write to this file (no read) */\n    register_chrdev(240, \"mod\", &amp;my_fops);\n    file = debugfs_create_file(\"signalconfpid\", 0200, NULL, NULL, &amp;my_fops);\n    f = filp_open(str, O_RDONLY , 0);\n    //printk(\"%d\",f);\n\n    return 0;\n}\n\n\n\nstatic void __exit signalexample_module_exit(void)\n{\n    unregister_chrdev(240, \"mod\");\n    debugfs_remove(file);\n\n}\n\nmodule_init(signalexample_module_init);\nmodule_exit(signalexample_module_exit);\nMODULE_LICENSE(\"GPL\");\n</code></pre>\n\n<p>When I execute my user-space program for the first time, everything is working well and it prints for me on the console :</p>\n\n<pre><code>Thread is created \nthread name thread91\nThread is awake \n</code></pre>\n\n<p>But when I try to execute it again, it prints :</p>\n\n<pre><code>THREAD1 IS NOT NULL!!! CAN NOT CREATE THREAD!!!\n</code></pre>\n\n<p>I think that the probelm is in <strong>task_struct *thread1</strong> which still holding information about the first thread which was created in my first execution of the program.</p>\n\n<p>Could anyone help me how to solve the problem ? How can I edit my code in order to make it run much more times correctly ? </p>\n\n<p>Thank you.</p>\n"}, {"tags": ["c", "pointers", "malloc", "c-strings"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1574242171, "post_id": 58950896, "comment_id": 104158133, "body": "What is <code>words</code>? Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1574242208, "post_id": 58950896, "comment_id": 104158160, "body": "... and most likely <code>malloc(sum * sizeof(char))</code> -&gt; <code>malloc(sum * sizeof(char*))</code>"}, {"owner": {"reputation": 13228, "user_id": 8398549, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8tzrl.jpg?s=128&g=1", "display_name": "Cid", "link": "https://stackoverflow.com/users/8398549/cid"}, "edited": false, "score": 2, "creation_date": 1574242241, "post_id": 58950896, "comment_id": 104158180, "body": "<code>for(int i = 1;</code> &lt;-- first index of an array is <code>0</code>"}, {"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 0, "creation_date": 1574242268, "post_id": 58950896, "comment_id": 104158199, "body": "<code>char **arguments = malloc(sum * sizeof(*arguments));</code> please learn the language using a good book, not by guessing."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 13228, "user_id": 8398549, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8tzrl.jpg?s=128&g=1", "display_name": "Cid", "link": "https://stackoverflow.com/users/8398549/cid"}, "edited": false, "score": 0, "creation_date": 1574242323, "post_id": 58950896, "comment_id": 104158236, "body": "@Cid he uses <code>arguments[i-1]</code> later on, so the code is correct but it&#39;s poor style, see my other comment"}, {"owner": {"reputation": 896, "user_id": 6659361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/200d3e89398030d70445b9a3f071c385?s=128&d=identicon&r=PG&f=1", "display_name": "Maxime B.", "link": "https://stackoverflow.com/users/6659361/maxime-b"}, "edited": false, "score": 0, "creation_date": 1574242343, "post_id": 58950896, "comment_id": 104158254, "body": "Additionally, although you allocate arguments, you don&#39;t allocate <code>arguments[i]</code> thus you get a fault when you <code>strcpy</code> to this buffer."}, {"owner": {"reputation": 133, "user_id": 10336980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd91b41ff2f48e50aaee97bbe37f5e13?s=128&d=identicon&r=PG&f=1", "display_name": "terrabyte", "link": "https://stackoverflow.com/users/10336980/terrabyte"}, "reply_to_user": {"reputation": 896, "user_id": 6659361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/200d3e89398030d70445b9a3f071c385?s=128&d=identicon&r=PG&f=1", "display_name": "Maxime B.", "link": "https://stackoverflow.com/users/6659361/maxime-b"}, "edited": false, "score": 0, "creation_date": 1574245503, "post_id": 58950896, "comment_id": 104160159, "body": "@MaximeB. can you explain this concept? What&#39;s the difference between allocated memory for arguments as a whole and each arguments[i] separately?"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1574245543, "post_id": 58950896, "comment_id": 104160187, "body": "@Jabberwocky: There is no evidence that the choice to take data starting from <code>words[1]</code> is a choice of style rather than function. As stated in the question, it is a functional requirement. Specifically, they are <b>given</b> a pointer, and the required task is to copy from <code>words[1]</code> on. This arises naturally when the standard <code>argv</code> of <code>main</code> is passed to a routine and one desires to copy the arguments but not the program name."}, {"owner": {"reputation": 133, "user_id": 10336980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd91b41ff2f48e50aaee97bbe37f5e13?s=128&d=identicon&r=PG&f=1", "display_name": "terrabyte", "link": "https://stackoverflow.com/users/10336980/terrabyte"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1574245758, "post_id": 58950896, "comment_id": 104160317, "body": "@EricPostpischil That&#39;s more or less what&#39;s going on but I couldn&#39;t find a way to articulate it nicely. Thank you for finding the words for me"}, {"owner": {"reputation": 896, "user_id": 6659361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/200d3e89398030d70445b9a3f071c385?s=128&d=identicon&r=PG&f=1", "display_name": "Maxime B.", "link": "https://stackoverflow.com/users/6659361/maxime-b"}, "edited": false, "score": 0, "creation_date": 1574246180, "post_id": 58950896, "comment_id": 104160596, "body": "@terrabyte <a href=\"http://c-faq.com/aryptr/dynmuldimary.html\" rel=\"nofollow noreferrer\">See explanation there</a>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1574246335, "post_id": 58950896, "comment_id": 104160686, "body": "@EricPostpischil you&#39;re probably right, I removed my comment, thanks"}], "answers": [{"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1574244780, "post_id": 58951499, "comment_id": 104159697, "body": "Please do not just post code for an answer without explaining it. Say why allocating space for the total number of characters and assigning it to a pointer to pointer to <code>char</code> is wrong. Say why space has to be allocated for pointers instead. Say why space has to be allocated for each string. Say why one has to be added to each. Additionally, we should not model code that ignores the possibility that <code>malloc</code> returns null. Students should be taught good error handling and robust programming practices as soon as feasible."}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1574244867, "post_id": 58951499, "comment_id": 104159753, "body": "@EricPostpischil Why not open teaching class here? Please don&#39;t take me for wrong, I&#39;m making a fair point here."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1574245024, "post_id": 58951499, "comment_id": 104159858, "body": "Starting with <code>words[1]</code> appears deliberate, as it is both stated explicitly in the text and manifested in the code, including copying from <code>words[i]</code> to <code>arguments[i-1]</code>. The latter shows the OP is aware of zero-based indexing and supports the hypothesis that starting with <code>words[1]</code> is deliberate. Therefore, suggesting the OP was wrong in this is likely a mistake. Starting the answer with it instead of starting with the key problem in the code is a detraction."}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1574245463, "post_id": 58951499, "comment_id": 104160137, "body": "@EricPostpischil Please post your elaborative post with minor details starting from binary. Happy to upvote."}, {"owner": {"reputation": 527, "user_id": 5523794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e12d42737c25a792438b0250170b90?s=128&d=identicon&r=PG&f=1", "display_name": "JonP", "link": "https://stackoverflow.com/users/5523794/jonp"}, "edited": false, "score": 1, "creation_date": 1574247424, "post_id": 58951499, "comment_id": 104161349, "body": "The correct solution is given despite the unnecessary comment about the indexing, so upvoted."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 1, "last_activity_date": 1574244908, "last_edit_date": 1574244908, "creation_date": 1574243957, "answer_id": 58951499, "question_id": 58950896, "link": "https://stackoverflow.com/questions/58950896/using-malloc-for-an-array-of-strings/58951499#58951499", "title": "Using malloc for an array of strings", "body": "<blockquote>\n  <p>I want to create an array of strings called arguments that copies\n  entries from an array of strings called words</p>\n</blockquote>\n\n<p>If so then this loop does not make sense.</p>\n\n<pre><code>int sum = 0;\nfor(int i = 1; words[i] != NULL; i++) {\n    sum += strlen(words[i]);\n}\n</code></pre>\n\n<p>Moreover indices in C start from <code>0</code>. It is unclear why the index <code>i</code> in you loop starts from <code>1</code>.</p>\n\n<p>You need to allocate an array of pointers and then allocate memory for strings that will be pointed to by elements of the array of pointers.</p>\n\n<p>What you need is the following</p>\n\n<pre><code>size_t n = 0;\n\nwhile ( words[n] != NULL ) ++n;\n\nchar **arguments = malloc( n * sizeof( *arguments ) );\n\nfor ( size_t i = 0; i != n; i++ )\n{\n    size_t length = strlen( words[i] );\n    arguments[i] = malloc( length + 1 );\n    strcpy( arguments[i], words[i] );\n}\n</code></pre>\n\n<p>If you want to exclude the string words[0] from the set of copied strings then the code snippet can look like</p>\n\n<pre><code>size_t n = 0;\n\nwhile ( words[n+1] != NULL ) ++n;\n\nchar **arguments = malloc( n * sizeof( *arguments ) );\n\nfor ( size_t i = 0; i != n; i++ )\n{\n    size_t length = strlen( words[i+1] );\n    arguments[i] = malloc( length + 1 );\n    strcpy( arguments[i], words[i+1] );\n}\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 10336980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd91b41ff2f48e50aaee97bbe37f5e13?s=128&d=identicon&r=PG&f=1", "display_name": "terrabyte", "link": "https://stackoverflow.com/users/10336980/terrabyte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1574245352, "creation_date": 1574242117, "last_edit_date": 1574245352, "question_id": 58950896, "link": "https://stackoverflow.com/questions/58950896/using-malloc-for-an-array-of-strings", "title": "Using malloc for an array of strings", "body": "<p>I want to create an array of strings called arguments that copies entries from an array of strings called words (from words[1] until the end). I'm having trouble with malloc and don't really understand how much I should malloc.\nI first sum all the characters in total that I'm going to be storing. The last entry in words is always NULL.</p>\n\n<pre><code>words = [\"jargon\",\"hello\", \"world\", NULL];\nint sum = 0;\nfor(int i = 1; words[i] != NULL; i++) {\n    sum += strlen(words[i]);\n}\n</code></pre>\n\n<p>So i will have sum characters in my array called arguments. So now i malloc and copy the required entries.</p>\n\n<pre><code>char **arguments = malloc(sum * sizeof(char));\nfor(int i = 0; words[i] != NULL; i++) {\n    strcpy(arguments[i], words[i+1]);\n}\n</code></pre>\n\n<p>However, i get a memory buffer overflow. If i change it to</p>\n\n<pre><code>char **arguments = malloc(sum * sizeof(*arguments));\n</code></pre>\n\n<p>I get past the memory buffer overflow but instead am greeted with an uninitialized value in arguments[i] in the next line. Could anyone shed some light on what's going on?</p>\n\n<p>Edit: Sorry about the poor style and thanks for the advice. </p>\n"}, {"tags": ["c", "algorithm", "for-loop", "reverse", "c-strings"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1574237885, "post_id": 58949572, "comment_id": 104155794, "body": "Do you need to <i>print</i> it reversed or reverse it <i>in memory</i>?"}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 2, "creation_date": 1574237900, "post_id": 58949572, "comment_id": 104155803, "body": "Your first <code>for</code> loop has no effect since your second <code>for</code> loop starts by resetting the value of <code>i</code> to 1."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1574238101, "post_id": 58949572, "comment_id": 104155889, "body": "Hint: to print the string reversed, you need to print the last character of the string, then the second to last etc. until the first. Your second for loop does not do that at all., it prints the second character and then the first."}, {"owner": {"reputation": 305, "user_id": 12404524, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1NTMZ.jpg?s=128&g=1", "display_name": "Aniruddh Mukherjee", "link": "https://stackoverflow.com/users/12404524/aniruddh-mukherjee"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1574238425, "post_id": 58949572, "comment_id": 104156045, "body": "@Jabberwocky How do I get to that last character?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1574238725, "post_id": 58949572, "comment_id": 104156181, "body": "Hint 2: you need a separate variable for the length of the string, call it <code>length</code>. With the first for loop you determine the length of the string; after that for loop <code>i</code> contains the length of the string. Store that in the <code>length</code> variable. Then loop through the string from <code>length-1</code> to <code>0</code> instead of from <code>1</code> to <code>0</code>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1574239988, "post_id": 58949572, "comment_id": 104156824, "body": "Your source of learning C is outdated by some 30 years. Never use <code>gets</code>, that function doesn&#39;t even exist since 8 years back."}, {"owner": {"reputation": 305, "user_id": 12404524, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1NTMZ.jpg?s=128&g=1", "display_name": "Aniruddh Mukherjee", "link": "https://stackoverflow.com/users/12404524/aniruddh-mukherjee"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1574240312, "post_id": 58949572, "comment_id": 104157020, "body": "@Lundin What should I use instead of <code>gets()</code>?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1574240724, "post_id": 58949572, "comment_id": 104157266, "body": "@dev.aniruddha The question you should be asking yourself is rather, &quot;why was I taught to use <code>gets</code> and should I trust anything said from that source of learning from now on?&quot;. As for <code>gets</code> replacements, see <a href=\"https://stackoverflow.com/questions/1694036/why-is-the-gets-function-so-dangerous-that-it-should-not-be-used\">Why is the gets function so dangerous that it should not be used?</a>."}, {"owner": {"reputation": 305, "user_id": 12404524, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1NTMZ.jpg?s=128&g=1", "display_name": "Aniruddh Mukherjee", "link": "https://stackoverflow.com/users/12404524/aniruddh-mukherjee"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1574241734, "post_id": 58949572, "comment_id": 104157871, "body": "@Lundin I was actually just googling about it. Thanks for the recommendation."}], "answers": [{"comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1574239375, "post_id": 58950003, "comment_id": 104156498, "body": "Details you left out: <code>NULL</code> -&gt; <code>NUL</code>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1574239465, "post_id": 58950003, "comment_id": 104156545, "body": "Other detail: your solution actually prints the NUL which is not quite correct. Therefore no UV"}, {"owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1574239736, "post_id": 58950003, "comment_id": 104156674, "body": "@Jabberwocky what do you mean with <code>NULL -&gt; NUL</code>? But yeah you are right I forgot to decrement before the first print."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1574239924, "post_id": 58950003, "comment_id": 104156788, "body": "<code>NULL</code> is the NULL <i>pointer</i>, <code>NUL</code> is the NUL <i>char</i>, but actually there is no <code>NUL</code> symbol, therefore it should just be <code>0</code>. And BTW he want only for loops, no while."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1574240130, "post_id": 58950003, "comment_id": 104156924, "body": "Depending on the platform <code>NULL</code>is defined as <code>0</code>, and therefore <code>NULL</code> compiles fine."}, {"owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1574240418, "post_id": 58950003, "comment_id": 104157092, "body": "@Jabberwocky I know still it does not make sense to use in this context. I revised the answer now. Anymore issues with it? Trying to piece a good answer together while trying to be fast is nearly mutually exculsive... I should take more time to analyze."}, {"owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1574242263, "post_id": 58950003, "comment_id": 104158195, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/202704/discussion-between-kami-kaze-and-jabberwocky\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "is_accepted": false, "score": 1, "last_activity_date": 1574243226, "last_edit_date": 1574243226, "creation_date": 1574239314, "answer_id": 58950003, "question_id": 58949572, "link": "https://stackoverflow.com/questions/58949572/reversing-string-only-using-for-loop/58950003#58950003", "title": "Reversing String Only Using For Loop", "body": "<p><code>gets()</code> is a bad idea as you can easily get overflows and it is no longer part of the c standard.\nSo let's assume that the string entered fits the array and this is just for an excercise with no reallife usage.</p>\n\n<p>Your first loop finds the terminator. That's good.<br>\nYour second loop sets the variable that indicates the terminator to 1, destroying the result.\nIf you remove the assignment <code>i=1</code>, your program compiles with gcc and does what you want.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\nint main()\n{\n    char a[20];\n    int i;\n    printf(\"Enter any String\\n\");\n    gets(a);\n    for(i=0;a[i]!=NULL;i++)\n    {}\n    for(;i&gt;=0;i--) //removed i=1 here\n    {\n        printf(\"%c\",a[i]);\n    }\n}\n</code></pre>\n\n<p>But there are still some issues to be addressed.\nYou will also reverse the terminator, instead you should start from <code>i-1</code>\nI would advise to not use a for loop if you do not have a counter criterion The first loop should rather be a <code>while</code> loop, but as it was part of the assignment you had no choice still I will replace it in my recommendation. As they can easily be swapped.</p>\n\n<p>Then you could use another variable for the second loop for clarity.\nAlso <code>NULL</code> is the NULL-pointer not the value <code>0</code> (also namend NUL apperantly) . So you should replace this either with <code>0</code> or with <code>'\\0'</code></p>\n\n<p>Also <code>stdlib.h</code> is not required here</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include&lt;stdio.h&gt;\nint main()\n{\n    char a[20];\n    int i = 0;\n\n    printf(\"Enter any String\\n\");\n    gets(a);\n\n    while (a[i] != 0)\n    {\n        i++;\n    }\n\n    for(int j = i-1; j&gt;=0; j--) // -1 to get the value in front of the terminator\n    {\n        printf(\"%c\",a[j]);\n    }\n    printf(\"\\n\"); //to flush the output.\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 305, "user_id": 12404524, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1NTMZ.jpg?s=128&g=1", "display_name": "Aniruddh Mukherjee", "link": "https://stackoverflow.com/users/12404524/aniruddh-mukherjee"}, "is_accepted": false, "score": -1, "last_activity_date": 1574240089, "creation_date": 1574240089, "answer_id": 58950252, "question_id": 58949572, "link": "https://stackoverflow.com/questions/58949572/reversing-string-only-using-for-loop/58950252#58950252", "title": "Reversing String Only Using For Loop", "body": "<p>Here is the solution code. \nThe first for loop is to be used for determining the length of the string and the second for loop is for traversing the string from the last position to the first.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint main()\n{\n    char a[20];\n    int i,j,len;\n    printf(\"Enter a String\\n\");\n    gets(a);\n    for(i=0;a[i]!=NULL;i++)\n    {}\n    len=i;\n    for(j=len-1;j&gt;=0;j--)\n    {\n        printf(\"%c\",a[j]);\n    }\n\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1574240519, "post_id": 58950337, "comment_id": 104157156, "body": "You forgot to forward declare <code>findlength</code>."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1574240705, "post_id": 58950337, "comment_id": 104157255, "body": "<code>if(a[i] == NULL)</code> should be <code>if(a[i] == &#39;\\0&#39;)</code>."}, {"owner": {"reputation": 1, "user_id": 7850997, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-UQ01OTh_3Vg/AAAAAAAAAAI/AAAAAAAAABA/XcYDhmHTtiY/photo.jpg?sz=128", "display_name": "spil3141", "link": "https://stackoverflow.com/users/7850997/spil3141"}, "edited": false, "score": 0, "creation_date": 1575267238, "post_id": 58950337, "comment_id": 104494779, "body": "thanks guys :) . i appreciate it. i will edit asap."}], "tags": [], "owner": {"reputation": 1, "user_id": 7850997, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-UQ01OTh_3Vg/AAAAAAAAAAI/AAAAAAAAABA/XcYDhmHTtiY/photo.jpg?sz=128", "display_name": "spil3141", "link": "https://stackoverflow.com/users/7850997/spil3141"}, "is_accepted": false, "score": -1, "last_activity_date": 1575267330, "last_edit_date": 1575267330, "creation_date": 1574240347, "answer_id": 58950337, "question_id": 58949572, "link": "https://stackoverflow.com/questions/58949572/reversing-string-only-using-for-loop/58950337#58950337", "title": "Reversing String Only Using For Loop", "body": "<p>I think why only two chars are been return is because of the condition statement in your second \"for loop\". </p>\n\n<pre><code>for(i=1;i&gt;=0;i--) \n</code></pre>\n\n<p>Note: </p>\n\n<ol>\n<li>it repeats from 1~0 (1,0): meaning it will repeat only twice</li>\n<li>first iteration: when i == 1 </li>\n<li>second iteration: when i == 0 ; then it ends . </li>\n</ol>\n\n<p>Please note that you created two \"for loops\" with the first one having no content. </p>\n\n<p>Bonus: \nI tried to fixed your code but realized that my C language skills isnt the best lol . Anyways, i came up with something that you could reference but it only reverse strings of less than 8 elements.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\nint findlength(char a[]);\n\nint main()\n{\n    char a[20];\n    int i;\n    printf(\"Enter any String\\n\");\n    gets(a);\n    int len = findlength(a);\n    printf(\"Lenght of the String is: %d \\n\",len);\n    printf(\"Reversed String is: \");\n    for(i=len;i&gt;-1;i--){\n        printf(\"%c\",a[i]);\n    }\n\n}\n\nint findlength(char a[]){\n    int result = 0;\n    int i;\n    for(i=0;i&lt;sizeof(a) / sizeof(char);i++){ // sizeof(char) is 1 \n        if(a[i] == '\\0') //end of string\n            return result;\n        result += 1;\n    }\n    return result;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "edited": false, "score": 0, "creation_date": 1574241405, "post_id": 58950417, "comment_id": 104157664, "body": "This deviates a bit from the original code, because of the use of fgets() instead of gets (which is better for many reasons). This makes it at places a little bit harder to follow. Also this solution reverses the string in memory not just on output. But a high quality answer that gives a good amount of insight.+1"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "edited": false, "score": 0, "creation_date": 1574241715, "post_id": 58950417, "comment_id": 104157862, "body": "@KamiKaze hets is not a standard C function. So by the definition it can not be better. It is just very bad and unsafe."}, {"owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "edited": false, "score": 0, "creation_date": 1574241841, "post_id": 58950417, "comment_id": 104157923, "body": "I may have been unclear with my wording of the comment. I meant <code>fgets()</code> is far superior to <code>gets()</code>"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "edited": false, "score": 0, "creation_date": 1574241965, "post_id": 58950417, "comment_id": 104158004, "body": "@KamiKaze One more you shall not use the function gets. It is not a standard C function. It is unsafe. And many compilers can issue an error that the name is undeclared."}, {"owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "edited": false, "score": 0, "creation_date": 1574242114, "post_id": 58950417, "comment_id": 104158105, "body": "I totally agree, also that you added the version which just reverses the output improves the answer even more."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 4, "last_activity_date": 1574241904, "last_edit_date": 1574241904, "creation_date": 1574240628, "answer_id": 58950417, "question_id": 58949572, "link": "https://stackoverflow.com/questions/58949572/reversing-string-only-using-for-loop/58950417#58950417", "title": "Reversing String Only Using For Loop", "body": "<p>For starters the function <code>gets</code> is not a standard C function any more. it is unsafe. Instead use the standard C function <code>fgets</code>. The function can append the new line character <code>'\\n'</code> to the entered string that should be excluded from the string.</p>\n\n<p>It is unclear from your question whether you are allowed to use standard string functions.</p>\n\n<p>Nevertheless here is a demonstrative program that does the task without using standard C string functions and that uses only for loops (neither <code>while</code> loop nor <code>do-while</code> loop).</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) \n{\n    enum { N = 20 };\n    char s[N];\n\n    printf( \"Enter any String less than %d symbols: \", N ); \n\n    fgets( s, N, stdin );\n\n    //  remove the new line character and calculate the length of the string\n    size_t n = 0;\n    for ( ; s[n] != '\\0' &amp;&amp; s[n] != '\\n'; ) ++n;\n\n    s[n] = '\\0';\n\n    //  reverse the string\n    for ( size_t i = 0; i &lt; n / 2; i++ )\n    {\n        char c = s[i];\n        s[i] = s[n-i-1];\n        s[n-i-1] = c;\n    }\n\n    puts( s );\n\n    return 0;\n}\n</code></pre>\n\n<p>Its output might look the following way</p>\n\n<pre><code>Enter any String less than 20 symbols: Hello dev.aniruddha\nahddurina.ved olleH\n</code></pre>\n\n<p>If you want just to output the original string in the reverse order then the program can look like</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) \n{\n    enum { N = 20 };\n    char s[N];\n\n    printf( \"Enter any String less than %d symbols: \", N ); \n\n    fgets( s, N, stdin );\n\n    //  remove the new line character and calculate the length of the string\n    size_t n = 0;\n    for ( ; s[n] != '\\0' &amp;&amp; s[n] != '\\n'; ) ++n;\n\n    s[n] = '\\0';\n\n    //  reverse the string\n\n    for ( ; n-- != 0;  )\n    {\n        putchar( s[n] );\n    }\n\n    putchar( '\\n' );\n\n    return 0;\n}\n</code></pre>\n\n<p>Its output is the same as shown above</p>\n\n<pre><code>Enter any String less than 20 symbols: Hello dev.aniruddha\nahddurina.ved olleH\n</code></pre>\n"}], "owner": {"reputation": 305, "user_id": 12404524, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1NTMZ.jpg?s=128&g=1", "display_name": "Aniruddh Mukherjee", "link": "https://stackoverflow.com/users/12404524/aniruddh-mukherjee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 58950417, "answer_count": 4, "score": -1, "last_activity_date": 1575267330, "creation_date": 1574237670, "last_edit_date": 1574240734, "question_id": 58949572, "link": "https://stackoverflow.com/questions/58949572/reversing-string-only-using-for-loop", "title": "Reversing String Only Using For Loop", "body": "<p>I have been trying to reverse(and print it that way) a given string <em>only using for loops</em> and <em>nothing more</em>. I think I have built up the basic logic, but it has some defects. When run, it only reverses the first two characters and then stops. Please help me find the defect in my logic. </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\nint main()\n{\n    char a[20];\n    int i;\n    printf(\"Enter any String\\n\");\n    gets(a);\n    for(i=0;a[i]!=NULL;i++)\n    {}\n    for(i=1;i&gt;=0;i--)\n    {\n        printf(\"%c\",a[i]);\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "embedded", "stm32", "freertos"], "comments": [{"owner": {"reputation": 2449, "user_id": 4730685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8d2d8e67d9c0443c382d1dd80132063?s=128&d=identicon&r=PG&f=1", "display_name": "Erlkoenig", "link": "https://stackoverflow.com/users/4730685/erlkoenig"}, "edited": false, "score": 0, "creation_date": 1574237435, "post_id": 58949366, "comment_id": 104155607, "body": "Please also show the compilation flags passed to gcc/g++."}, {"owner": {"reputation": 9396, "user_id": 2261538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4e60dd44745bd1518ee933e081119de?s=128&d=identicon&r=PG", "display_name": "darune", "link": "https://stackoverflow.com/users/2261538/darune"}, "edited": false, "score": 0, "creation_date": 1574237738, "post_id": 58949366, "comment_id": 104155736, "body": "I vote close - I understand your issue - but for a sort of question like this you provide too little information. To start: where can documention of the relevant systems be found (so everyone does not have to look this up themselves) ? compile flags are missing, what else did you do ? which options did you already try (yes, Im expecting this) ?"}, {"owner": {"reputation": 895, "user_id": 3664589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qCKWz.jpg?s=128&g=1", "display_name": "bananenb&#228;r", "link": "https://stackoverflow.com/users/3664589/bananenb%c3%a4r"}, "reply_to_user": {"reputation": 9396, "user_id": 2261538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4e60dd44745bd1518ee933e081119de?s=128&d=identicon&r=PG", "display_name": "darune", "link": "https://stackoverflow.com/users/2261538/darune"}, "edited": false, "score": 0, "creation_date": 1574238198, "post_id": 58949366, "comment_id": 104155942, "body": "added gcc flags (skipped c++, as this seems not c++ related anymore). @darune I thought this is more of a general question, and I think it is a simple question, so I tried keeping it short. I tried many combinations of compile flags, none of which made a difference."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1574274023, "post_id": 58949366, "comment_id": 104177142, "body": "<i>&quot;in order to show the compiler that most translation units are not even needed, to find out which modules are most expensive.&quot;</i> - That is a flawed method.  The linker map file will provide that information directly."}], "answers": [{"comments": [{"owner": {"reputation": 895, "user_id": 3664589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qCKWz.jpg?s=128&g=1", "display_name": "bananenb&#228;r", "link": "https://stackoverflow.com/users/3664589/bananenb%c3%a4r"}, "edited": false, "score": 0, "creation_date": 1574239115, "post_id": 58949740, "comment_id": 104156375, "body": "Thank you! <code>-ffunction-sections -fdata-sections</code> actually did the trick. -flto creates some issues with assembly code from FreeRTOS/CMSIS, that&#39;s why I removed it from gcc initially. I&#39;ll have to figure that out separately."}, {"owner": {"reputation": 2449, "user_id": 4730685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8d2d8e67d9c0443c382d1dd80132063?s=128&d=identicon&r=PG&f=1", "display_name": "Erlkoenig", "link": "https://stackoverflow.com/users/4730685/erlkoenig"}, "reply_to_user": {"reputation": 895, "user_id": 3664589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qCKWz.jpg?s=128&g=1", "display_name": "bananenb&#228;r", "link": "https://stackoverflow.com/users/3664589/bananenb%c3%a4r"}, "edited": false, "score": 1, "creation_date": 1574239186, "post_id": 58949740, "comment_id": 104156404, "body": "Without <code>-flto</code> at the compiler, <code>-flto</code> at the linker does nothing. Seeing your German username: <a href=\"https://www.mikrocontroller.net/articles/ARM_GCC#Nutzung_mit_eigener_Umgebung.2FKommandozeile\" rel=\"nofollow noreferrer\">this article</a> might help."}], "tags": [], "owner": {"reputation": 2449, "user_id": 4730685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8d2d8e67d9c0443c382d1dd80132063?s=128&d=identicon&r=PG&f=1", "display_name": "Erlkoenig", "link": "https://stackoverflow.com/users/4730685/erlkoenig"}, "is_accepted": true, "score": 5, "last_activity_date": 1574238355, "creation_date": 1574238355, "answer_id": 58949740, "question_id": 58949366, "link": "https://stackoverflow.com/questions/58949366/c-embedded-code-size-does-not-shrink-when-commenting-freertos-roottask/58949740#58949740", "title": "C (Embedded): Code size does not shrink when commenting FreeRTOS&#39; RootTask", "body": "<p>You need to pass the flags <code>-ffunction-sections -fdata-sections</code> to the compiler (gcc/g++) such that <code>--gc-sections</code> in the linker works, and <code>-flto</code> to the compiler such that <code>-flto</code> in the linker can do its work.</p>\n"}], "owner": {"reputation": 895, "user_id": 3664589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qCKWz.jpg?s=128&g=1", "display_name": "bananenb&#228;r", "link": "https://stackoverflow.com/users/3664589/bananenb%c3%a4r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 58949740, "answer_count": 1, "score": 0, "last_activity_date": 1574238355, "creation_date": 1574236896, "last_edit_date": 1574238143, "question_id": 58949366, "link": "https://stackoverflow.com/questions/58949366/c-embedded-code-size-does-not-shrink-when-commenting-freertos-roottask", "title": "C (Embedded): Code size does not shrink when commenting FreeRTOS&#39; RootTask", "body": "<p>I have a tree-shaped process/task architecture in my FreeRTOS construct. The main() simply creates a RootTask (after initializing the HAL), which creates another two tasks, and so on.</p>\n\n<p>I'm currently fighting with flash size (code + constants, basically?), and therefore disabling tasks (=commenting them) in order to show the compiler that most translation units are not even needed, to find out which modules are most expensive.</p>\n\n<p>However, I've \"commented my way up\" to main() and took out EVERYTHING except the while(1) loop. It still doesn't fit in 128k Flash. \nTried removing all C++ translation units, using even gcc for linking; but still ~100k \".text\" section  (I would be fine with 10k at this point, considering the application doesn't do anything).</p>\n\n<p>I'm using arm-none-eabi-gcc/g++ 5.4.1. The linker script was generated by ST-CubeMX.</p>\n\n<p>gcc flags: \n<code>-mcpu=cortex-m0 -mthumb -Os -s -Wall -Wa -a -ad -alms=build/$(notdir $(&lt;:.c=.lst))</code></p>\n\n<p>Linker flags: \n<code>-mcpu=cortex-m0 -specs=nosys.specs -T$(LDSCRIPT) [some-libraries] -Wl,-Map=$(BUILD_DIR)/$(TARGET).map,--cref -Wl,--gc-sections,--undefined=uxTopUsedPriority,-flto</code>\n(also generated by CubeMX, except -flto)</p>\n\n<p>Can someone explain why the Compiler/Linker are not removing unused code from the final binary? Are there tools to investigate further?</p>\n\n<p>Please let me know if more information is needed.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["c", "raspberry-pi", "pwm"], "owner": {"reputation": 17, "user_id": 12395011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1678f34294337219006c97e016d6f95?s=128&d=identicon&r=PG&f=1", "display_name": "lee1591", "link": "https://stackoverflow.com/users/12395011/lee1591"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 106, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1574239204, "creation_date": 1574236378, "last_edit_date": 1574239204, "question_id": 58949250, "link": "https://stackoverflow.com/questions/58949250/raspberry-pi-3b-using-bcm2835-lib-to-generate-hareware-pwm-send-specific-numbe", "title": "raspberry pi 3B+ using BCM2835 lib to generate Hareware PWM (send specific numbers of pulses)", "body": "<p>I am working on using Raspberry Pi to generate hardware PWM to control my stepper motors. When I tried hardware pwm, I found that I can not control the pulse in numbers such as I just wanted motor to move 8000 steps and then stop.</p>\n\n<p>I don't want use time to turn off the PWM, I want specific steps.</p>\n\n<pre><code>#include &lt;bcm2835.h&gt;\n#include &lt;stdio.h&gt;\n\n// PWM output on RPi Plug P1 pin 12 (which is GPIO pin 18)\n// in alt fun 5.\n// Note that this is the _only_ PWM pin available on the RPi IO headers\n#define PIN RPI_GPIO_P1_12\n// and it is controlled by PWM channel 0\n#define PWM_CHANNEL 0\n// This controls the max range of the PWM signal\n#define RANGE 1024\n\nint main(int argc, char **argv)\n{\n    if (!bcm2835_init())\n    return 1;\n\n    // Set the output pin to Alt Fun 5, to allow PWM channel 0 to be output there\n    bcm2835_gpio_fsel(PIN, BCM2835_GPIO_FSEL_ALT5);\n\n    // Clock divider is set to 16.\n    // With a divider of 16 and a RANGE of 1024, in MARKSPACE mode,\n    // the pulse repetition frequency will be\n    // 1.2MHz/1024 = 1171.875Hz, suitable for driving a DC motor with PWM\n    bcm2835_pwm_set_clock(BCM2835_PWM_CLOCK_DIVIDER_16);\n    bcm2835_pwm_set_mode(PWM_CHANNEL, 1, 1);   //CTL reg\n    bcm2835_pwm_set_range(PWM_CHANNEL, RANGE); //RNG1/2 reg\n\n    // Vary the PWM m/s ratio between 1/RANGE and (RANGE-1)/RANGE\n    int direction = 1;\n    int data = 1;\n    while (1)\n      {\n    if (data == 1)\n      direction = 1;\n    else if (data == RANGE-1)\n      direction = -1;\n    data += direction;\n      bcm2835_pwm_set_data(PWM_CHANNEL, data);\n    bcm2835_delay(1);\n      }\n\n    bcm2835_close();\n    return 0;\n}\n</code></pre>\n\n<p>Can this code achieve my thought (modifying some registers of pwm)? Which reg of PWM control the autofill(autopadding), I just want to know how to stop sending pulses after stopping the motor.</p>\n"}, {"tags": ["c", "linux", "optimization", "memory", "memory-management"], "comments": [{"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 0, "creation_date": 1574233831, "post_id": 58948612, "comment_id": 104154073, "body": "What link-time optimisations are you using?"}, {"owner": {"reputation": 13, "user_id": 9171514, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yD2CSA9ga88/AAAAAAAAAAI/AAAAAAAAAXI/NcA6GMfsSnM/photo.jpg?sz=128", "display_name": "JAINIL PANDYA", "link": "https://stackoverflow.com/users/9171514/jainil-pandya"}, "reply_to_user": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 0, "creation_date": 1574234090, "post_id": 58948612, "comment_id": 104154197, "body": "gcc standard. LTO"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1574234213, "post_id": 58948612, "comment_id": 104154251, "body": "There&#39;s just no one simple or single answer to this. You might use compiler and linker flags to enable space-saving optimization (but those could result in &quot;slower&quot; code). Or you could reduce the actual source code, which could lead to unreadable and unmaintainable code. You could use less constant variables which could be put into the text segment. Or perhaps a myriad of other things, or a combination of many things. But the important point is to remember that no matter what you do it will be a trade-off. You win some in text segment size, but loose in others."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1574234392, "post_id": 58948612, "comment_id": 104154331, "body": "While this question in it current form is fuzzy and much to broad, I&#39;m curious about the requirement itself? What is the project? What is your target platform? And most importantly, why do you have this requirement and where does it come from? What&#39;s the underlying problem it&#39;s supposed to solve?"}, {"owner": {"reputation": 13, "user_id": 9171514, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yD2CSA9ga88/AAAAAAAAAAI/AAAAAAAAAXI/NcA6GMfsSnM/photo.jpg?sz=128", "display_name": "JAINIL PANDYA", "link": "https://stackoverflow.com/users/9171514/jainil-pandya"}, "edited": false, "score": 0, "creation_date": 1574234528, "post_id": 58948612, "comment_id": 104154383, "body": "I need to reduce Ram size from 2gb to 1gb basically firmware requirement and it is Linux platform."}, {"owner": {"reputation": 1220, "user_id": 5878272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14e96159153b67fab5222b7c5fa18c71?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/5878272/fredrik"}, "edited": false, "score": 1, "creation_date": 1574234816, "post_id": 58948612, "comment_id": 104154513, "body": "@JAINILPANDYA What are you coding that takes 2gb of ram? And why are you asking about lowering the text segment when it&#39;s obviously something that you are loading from disk or generating from code that takes up 2GB of ram."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1574234860, "post_id": 58948612, "comment_id": 104154531, "body": "Have you customized the linker file? Have you stripped the executable? Build for 32-bit target? And considering that it wasn&#39;t that many years ago that many Linux systems commonly ran with less than a single GiB or RAM, perhaps your code is just badly designed from the start? Does it do a lot of dynamic memory allocations? Contain large arrays? And this sounds more like a systems-integration problem than the problem of a single program (unless it&#39;s badly implemented or designed)."}, {"owner": {"reputation": 13, "user_id": 9171514, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yD2CSA9ga88/AAAAAAAAAAI/AAAAAAAAAXI/NcA6GMfsSnM/photo.jpg?sz=128", "display_name": "JAINIL PANDYA", "link": "https://stackoverflow.com/users/9171514/jainil-pandya"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1574318157, "post_id": 58948612, "comment_id": 104191510, "body": "@Someprogrammerdude Thanks dude ,no customized linker ,we have 64 bit os ,yup our code is old enough and it is not properly designed . Stores in large arrays and less number of dynamic memory allocations. Does increase in dynamic memory allocation decrease text segment size?"}, {"owner": {"reputation": 13, "user_id": 9171514, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yD2CSA9ga88/AAAAAAAAAAI/AAAAAAAAAXI/NcA6GMfsSnM/photo.jpg?sz=128", "display_name": "JAINIL PANDYA", "link": "https://stackoverflow.com/users/9171514/jainil-pandya"}, "reply_to_user": {"reputation": 1220, "user_id": 5878272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14e96159153b67fab5222b7c5fa18c71?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/5878272/fredrik"}, "edited": false, "score": 0, "creation_date": 1574318273, "post_id": 58948612, "comment_id": 104191556, "body": "@Fredrik bro, it is new requirement to reduce the overall memory segment so reducing text segment is a part of it. data /.bss memory are up to the mark."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1574331248, "post_id": 58948612, "comment_id": 104198440, "body": "Dynamic memory allocation from the heap will come out of the same virtual memory pool on the hardware in the end, so for a memory-constrained system it&#39;s not a real solution."}], "answers": [{"tags": [], "owner": {"reputation": 381, "user_id": 6160020, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YKm7XmRRzWk/AAAAAAAAAAI/AAAAAAAABMA/0SMhweWTkPY/photo.jpg?sz=128", "display_name": "aneesh jose", "link": "https://stackoverflow.com/users/6160020/aneesh-jose"}, "is_accepted": true, "score": -1, "last_activity_date": 1574234201, "creation_date": 1574234201, "answer_id": 58948727, "question_id": 58948612, "link": "https://stackoverflow.com/questions/58948612/i-need-to-reduce-text-segment-of-all-object-files-used-in-my-project/58948727#58948727", "title": "I need to reduce text segment of all object files used in my project", "body": "<p>Optimize for size. If you are using GCC, use the flag -Os, which instructs GCC to \"optimize for size.\" It enables all -O2 optimizations which do not increase the size of the executable, and then it also toggles some optimization flags to further reduce executable size.</p>\n"}], "owner": {"reputation": 13, "user_id": 9171514, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yD2CSA9ga88/AAAAAAAAAAI/AAAAAAAAAXI/NcA6GMfsSnM/photo.jpg?sz=128", "display_name": "JAINIL PANDYA", "link": "https://stackoverflow.com/users/9171514/jainil-pandya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 58948727, "answer_count": 1, "score": 0, "last_activity_date": 1574234201, "creation_date": 1574233727, "question_id": 58948612, "link": "https://stackoverflow.com/questions/58948612/i-need-to-reduce-text-segment-of-all-object-files-used-in-my-project", "title": "I need to reduce text segment of all object files used in my project", "body": "<p><strong>My project requirement is to  reduce text segment of object files used in my project. I tried reducing redundant logic but the change results is minimum amount of bytes .</strong></p>\n\n<p>My code uses switch cases ,nested if/else ,along with const arrays and for/while loops .It also contains semaphores,mutex etc.</p>\n\n<p>Can you please suggest best solution to reduce maximum instruction used in text segment?</p>\n"}, {"tags": ["c", "bison", "flex-lexer", "language-design", "nim-lang"], "comments": [{"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1574236773, "post_id": 58948337, "comment_id": 104155340, "body": "You don&#39;t identify them with either. You leave all that until a pseudo-link step, which is where you identify all functions and what they should do. Otherwise you bake them into the language, which leads to difficulties later on when you want to add more; and you bloat the language. At best you should consider them as Pascal does, as part of an imaginary enclosing scope whose content isn&#39;t specified by the language itself, or recognized by it."}, {"owner": {"reputation": 488, "user_id": 12199970, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-o1lnLQaFIl4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd-DeKatHNuf7q7OLUjUujB8yO-xQ/photo.jpg?sz=128", "display_name": "Venkatesh Nandigama", "link": "https://stackoverflow.com/users/12199970/venkatesh-nandigama"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1574257440, "post_id": 58948337, "comment_id": 104167228, "body": "@user207421 , Thank you. do you have any references to learn more about this, please post"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1574315135, "post_id": 58948337, "comment_id": 104190427, "body": "What do you consider &quot;quite huge&quot;? I have a simple lexer with more than 500 symbols, which is about 70k (compiled with -Os)."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "reply_to_user": {"reputation": 488, "user_id": 12199970, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-o1lnLQaFIl4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd-DeKatHNuf7q7OLUjUujB8yO-xQ/photo.jpg?sz=128", "display_name": "Venkatesh Nandigama", "link": "https://stackoverflow.com/users/12199970/venkatesh-nandigama"}, "edited": false, "score": 0, "creation_date": 1574643387, "post_id": 58948337, "comment_id": 104292856, "body": "@VenkateshNandigama The Pascal User Manual and Report."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 1, "creation_date": 1574643444, "post_id": 58948337, "comment_id": 104292871, "body": "@rici Yeah. I had a lexer for Cobol-85, which has &gt; 400 reserved words, all separately recognized as patters, and it wasn&#39;t huge, with maximum <i>flex</i> compression enabled."}], "owner": {"reputation": 21415, "user_id": 1270812, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/LmoZ6.jpg?s=128&g=1", "display_name": "Dr.Kameleon", "link": "https://stackoverflow.com/users/1270812/dr-kameleon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1574232656, "creation_date": 1574232656, "question_id": 58948337, "link": "https://stackoverflow.com/questions/58948337/best-way-to-identify-system-library-commands-in-lexer-bison", "title": "Best way to identify system library commands in Lexer/Bison", "body": "<p>I'm writing an intepreter for a new programming language. The language's syntax is very simple and the \"system library\" commands are treated as simple identifiers (even <code>if</code> is no special construct, but a function like everything else - only pre-defined internally). <em>And no, this is not yet-another-one of the 1 million Lisp's out there.</em></p>\n\n<p><strong>The question is:</strong></p>\n\n<p>Should I have the Lexer catch them, or should I do it in the AST-construction code?</p>\n\n<p><strong>What I've done so far:</strong></p>\n\n<p>I tried recognizing all of them in my Lexer script, and they are a lot already - over 200. I send the same token back to Bison (<code>SYSTEM_CMD</code>) only with a different value (basically a numeric index pointing to the array of system commands where they are all stored).</p>\n\n<p>As an approach, I think this makes it much faster than having to look up every single one of them in a hash and see if it's a system command.</p>\n\n<p>The thing is the Lexer is getting quite huge (in term of resulting binary filesize I mean) rather fast. And I obviously don't like it.</p>\n\n<hr>\n\n<p>Given that my focus is something both lightning-fast (I'm already quite good with that) and small enough to be embedded, what would be the most recommended approach?</p>\n"}, {"tags": ["c", "algorithm"], "comments": [{"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1574231858, "post_id": 58948140, "comment_id": 104153329, "body": "<code>scanf(&quot;%d&quot;,&amp;a);</code> --&gt;         <code>scanf(&quot;%d&quot;,&amp;a[i]);</code>"}, {"owner": {"reputation": 2026, "user_id": 3789665, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/38983281a7926f50843153d9e0788cdf?s=128&d=identicon&r=PG&f=1", "display_name": "greybeard", "link": "https://stackoverflow.com/users/3789665/greybeard"}, "edited": false, "score": 2, "creation_date": 1574238606, "post_id": 58948140, "comment_id": 104156124, "body": "<code>&amp;a[i]</code> \u2192 <code>a + i</code> ;)"}, {"owner": {"reputation": 3669, "user_id": 5078576, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/gwGt0.jpg?s=128&g=1", "display_name": "Leos313", "link": "https://stackoverflow.com/users/5078576/leos313"}, "reply_to_user": {"reputation": 2026, "user_id": 3789665, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/38983281a7926f50843153d9e0788cdf?s=128&d=identicon&r=PG&f=1", "display_name": "greybeard", "link": "https://stackoverflow.com/users/3789665/greybeard"}, "edited": false, "score": 1, "creation_date": 1574243239, "post_id": 58948140, "comment_id": 104158762, "body": "@greybeard, yes, the two expressions are equivalent. However, I prefer the  <code>&amp;a[i]</code> because it better describes what we want to do: increment the index of an array and point to the correspondent variable. That is the same of adding X Bytes to the pointer of the array where X is the <code>sizeof(data_type)</code>. I just think is less intuitive. A little bit harder to remember :)"}], "answers": [{"tags": [], "owner": {"reputation": 664, "user_id": 1344924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0870afb0998f9e34fdda5991f743649d?s=128&d=identicon&r=PG", "display_name": "Shrikant", "link": "https://stackoverflow.com/users/1344924/shrikant"}, "is_accepted": true, "score": 2, "last_activity_date": 1574232104, "creation_date": 1574232104, "answer_id": 58948221, "question_id": 58948140, "link": "https://stackoverflow.com/questions/58948140/c-invalid-conversion-from-int-to-int/58948221#58948221", "title": "C - &quot;Invalid Conversion from &quot;int*&quot; to &quot;int&quot;", "body": "<p><code>scanf(\"%d\",&amp;a)</code> should be <code>scanf(\"%d\",&amp;a[i])</code> </p>\n\n<p>and also correct your function forward declarations from </p>\n\n<pre><code>void LinearSearch(int,int);\nvoid BubbleSort(int,int);\n</code></pre>\n\n<p>to </p>\n\n<pre><code>void LinearSearch(int[],int);\nvoid BubbleSort(int[],int);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3669, "user_id": 5078576, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/gwGt0.jpg?s=128&g=1", "display_name": "Leos313", "link": "https://stackoverflow.com/users/5078576/leos313"}, "is_accepted": false, "score": 1, "last_activity_date": 1574232915, "creation_date": 1574232915, "answer_id": 58948393, "question_id": 58948140, "link": "https://stackoverflow.com/questions/58948140/c-invalid-conversion-from-int-to-int/58948393#58948393", "title": "C - &quot;Invalid Conversion from &quot;int*&quot; to &quot;int&quot;", "body": "<p>The declaration of your two function does not match with the definition. To be clear, you have declared:</p>\n\n<pre><code>void LinearSearch(int,int);  //&lt;---the two arguments are int\nvoid BubbleSort(int,int);    //&lt;---the two arguments are int\n</code></pre>\n\n<p>But, in the end, you define your function as:</p>\n\n<pre><code>void LinearSearch(int a[10],int sizA); //&lt;---the first argument is an int*\nvoid BubbleSort(int a[10],int sizB);   //&lt;---the first argument is an int*\n</code></pre>\n\n<p>If you want to solve the compilation error you are reporting, please just substitute your declarations with this two line!</p>\n\n<p><strong>P.S.</strong> Please also note that there are other little problems you may want to solve (when using <code>scanf(\"%d\",&amp;a);</code>). As point out in one of the comment, the correct instruction should be <code>scanf(\"%d\",&amp;a[i]);</code>.</p>\n"}], "owner": {"reputation": 305, "user_id": 12404524, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1NTMZ.jpg?s=128&g=1", "display_name": "Aniruddh Mukherjee", "link": "https://stackoverflow.com/users/12404524/aniruddh-mukherjee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 58948221, "answer_count": 2, "score": 1, "last_activity_date": 1574236318, "creation_date": 1574231752, "last_edit_date": 1574236318, "question_id": 58948140, "link": "https://stackoverflow.com/questions/58948140/c-invalid-conversion-from-int-to-int", "title": "C - &quot;Invalid Conversion from &quot;int*&quot; to &quot;int&quot;", "body": "<p>I am new to coding. I was trying to make a program with multiple functions with different functions for Linear Search and Bubble Sort. I am using DevC++ IDE with the TDM-GCC 4.9.2 64-bit compiler. I don't know where I made the mistake.\nAt line numbers 17 and 19, it shows the error \"Invalid Conversion from \"int*\" to \"int\".  </p>\n\n<pre><code>#include&lt;stdio.h&gt;\nvoid LinearSearch(int,int);\nvoid BubbleSort(int,int);\nint main()\n{\n    int i,a[10],n;\n    int size=10;\n    for(i=0;i&lt;10;i++)\n    {\n        printf(\"Enter a number\\n\");\n        scanf(\"%d\",&amp;a);\n    }\n    printf(\"Press the button og=f your choice!\\n\");\n    printf(\"1. Linear Seach    2. Bubble Sort\\n\");\n    scanf(\"%d\",&amp;n);\n    if(n==1)\n    LinearSearch(a,size); //Invalid Conversion from \"int*\" to \"int\n    else if(n==2)\n    BubbleSort(a,size);  //Invalid Conversion from \"int*\" to \"int\n    else\n    printf(\"You have pressed the wrong button!\\n\");\n}\nvoid LinearSearch(int a[10],int sizA)\n{\n    int i,s,f=0;\n    printf(\"Enter the search value\\n\");\n    scanf(\"%d\",&amp;s);\n    for(i=0;i&lt;10;i++)\n    {\n        if(s==a[i])\n        {\n            f=1;\n            printf(\"The Search Avlue is located at position no. %d in the array\",i);\n        }\n    }\n    if(f==0)\n    printf(\"Search Value Not Found\");\n}\nvoid BubbleSort(int a[10],int sizB)\n{\n    int i,j,k;\n    for(i=0;i&lt;10;i++)\n    {\n        for(j=0;j&lt;10-i-1;j++)\n        {\n            if(a[j]&gt;a[j+1])\n            k=a[j];\n            a[j]=a[j+1];\n            a[j+1]=k;\n        }\n    }\n    for(i=0;i&lt;10;i++)\n    {\n        printf(\"%d  \",a[i]);\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "bash", "readline", "tty"], "answers": [{"tags": [], "owner": {"reputation": 73, "user_id": 7896114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40c2c448e29bed154722abc3acb02efe?s=128&d=identicon&r=PG&f=1", "display_name": "phkb", "link": "https://stackoverflow.com/users/7896114/phkb"}, "is_accepted": false, "score": 0, "last_activity_date": 1574294563, "creation_date": 1574294563, "answer_id": 58965247, "question_id": 58947951, "link": "https://stackoverflow.com/questions/58947951/tty-key-codes-changed-in-bind-x-bash-callback/58965247#58965247", "title": "TTY key codes changed in &quot;bind -x&quot; bash callback", "body": "<p>It is because the terminal is set in appcursor mode.</p>\n\n<p>To unset it, write <code>\"\\x1B[?1l\"</code> to the tty.</p>\n"}], "owner": {"reputation": 73, "user_id": 7896114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40c2c448e29bed154722abc3acb02efe?s=128&d=identicon&r=PG&f=1", "display_name": "phkb", "link": "https://stackoverflow.com/users/7896114/phkb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574294563, "creation_date": 1574230914, "question_id": 58947951, "link": "https://stackoverflow.com/questions/58947951/tty-key-codes-changed-in-bind-x-bash-callback", "title": "TTY key codes changed in &quot;bind -x&quot; bash callback", "body": "<p>I'm trying to bind an interactive program to a key in bash using <code>bind -x</code>. This program sets the terminal in raw mode during its execution, and resets the previous settings at exit.</p>\n\n<p>Some keys have different codes when the program is run via the bash binding. For example, the down arrow code is <code>&lt;Esc&gt;OB</code> instead of <code>&lt;Esc&gt;[B</code>. I'm trying to understand why and find a solution to have the \"normal\" codes.</p>\n\n<p>I printed the flags obtained with <code>tcgetattr</code>, they are the same whether the program is run normally or via the binding.</p>\n"}, {"tags": ["c++", "c", "signals", "correlation"], "comments": [{"owner": {"reputation": 20722, "user_id": 1625187, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6vWOZ.jpg?s=128&g=1", "display_name": "Evg", "link": "https://stackoverflow.com/users/1625187/evg"}, "edited": false, "score": 0, "creation_date": 1574230336, "post_id": 58947785, "comment_id": 104152836, "body": "Please show your code and ask a concrete question. Asking to write code for you is not how this site works."}, {"owner": {"reputation": 2611, "user_id": 3109549, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/28171eb9da89605ed11018b44ae9be8b?s=128&d=identicon&r=PG", "display_name": "Tr\u1ea7n \u0110\u1ee9c T&#226;m", "link": "https://stackoverflow.com/users/3109549/tr%e1%ba%a7n-%c4%90%e1%bb%a9c-t%c3%a2m"}, "edited": false, "score": 0, "creation_date": 1574230731, "post_id": 58947785, "comment_id": 104152962, "body": "Please show your source and your library"}, {"owner": {"reputation": 1, "user_id": 12401925, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAsM0ZLpjhsKIcya7M8RWPdHYxu6JKDD3q4DHkV6Q=k-s128", "display_name": "Abhinav Parashar", "link": "https://stackoverflow.com/users/12401925/abhinav-parashar"}, "edited": false, "score": 0, "creation_date": 1574231156, "post_id": 58947785, "comment_id": 104153091, "body": "I have edit the question, with the code, please check"}, {"owner": {"reputation": 521, "user_id": 11102391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca1c0cdfd7726432576f1d4b7d27b2e2?s=128&d=identicon&r=PG&f=1", "display_name": "Gennady.F", "link": "https://stackoverflow.com/users/11102391/gennady-f"}, "edited": false, "score": 0, "creation_date": 1574234993, "post_id": 58947785, "comment_id": 104154583, "body": "regarding Cross-Correlation in MKL - my recommendation you to try a similar functionality from the Intel IPP library.  Please check the ippiCrossCorrNorm_<i>.</i> function. the reason why I don&#39;t recommend you to use MKL in this case --  this functionality is not well optimized. the examples of this code you may find out into IPP Forum -  <a href=\"https://software.intel.com/en-us/forums/intel-integrated-performance-primitives/\" rel=\"nofollow noreferrer\">software.intel.com/en-us/forums/&hellip;</a>"}], "owner": {"reputation": 1, "user_id": 12401925, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAsM0ZLpjhsKIcya7M8RWPdHYxu6JKDD3q4DHkV6Q=k-s128", "display_name": "Abhinav Parashar", "link": "https://stackoverflow.com/users/12401925/abhinav-parashar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 699, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1574231127, "creation_date": 1574230101, "last_edit_date": 1574231127, "question_id": 58947785, "link": "https://stackoverflow.com/questions/58947785/calculating-cross-correlation-for-1d-signals-in-c-c", "title": "Calculating Cross Correlation for 1D Signals in C/C++", "body": "<p>Can someone help me out in doing the cross correlation for 1D signals in C/C++, using libraries such as Intel MKL or FFTW3 or Armadillo or GNU-GSL etc. I am using Ubuntu 18 64 Bit.</p>\n\n<p>Tried a lot of combinations, either library is not getting integrated properly, or it is just calculating the correlation coefficient not the correlation value between the data provided (happening with GSL), my data is huge in numbers, in float, around 30k of listing.</p>\n\n<p>Please help me out with a code logic to work out with these libraries.</p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n    #include &lt;forkjoin.h&gt;\n    #include &lt;shared.h&gt;\n    #include &lt;barrier.h&gt;\n    int main()\n   {\n   int *a,*b,pid,nproc,i,*bar,sum1,sum2,size;\n   int shmid1,shmid2,shmid3,shmid4,shmid5,shmid6,shmid7,shmid8;\n   float *a1,*b1,*ab,*mean1,*mean2,total; \n\n   printf(\"Enter the size of the array : \");\n   scanf(\"%d\",&amp;size);\n   a = (int *) create_memory(2*size,&amp;shmid1);\n   b = (int *) create_memory(2*size,&amp;shmid2);\n   a1 = (float *) create_memory(4*size,&amp;shmid4);\n   b1 = (float *) create_memory(4*size,&amp;shmid5);\n   ab = (float *) create_memory(4*size,&amp;shmid6);\n   mean1 = (float *) create_memory(4,&amp;shmid7);\n   mean2 = (float *) create_memory(4,&amp;shmid8);\n   bar = (int *) create_memory(2*4,&amp;shmid3);\n\n   for(i=0;i&lt;size;i++)        \n   {\n         printf(\"Enter %d Element of x : \",i+1);\n         scanf(\"%d\",&amp;a[i]);\n         printf(\"Enter %d Element of y : \",i+1);\n         scanf(\"%d\",&amp;b[i]);  \n   }\n   printf(\"Enter the no of process : \");\n   scanf(\"%d\",&amp;nproc);\n   barrier_init(bar,nproc);\n   sum1=0;\n   sum2=0;\n   pid=create_process(&amp;nproc);\n   for(i=pid;i&lt;size;i+=nproc)\n   {\n         sum1 = sum1 + a[i];\n         sum2 = sum2 + b[i];\n   } \n   barrier(bar);\n\n   (*mean1) += (float)sum1/size;\n   (*mean2) += (float)sum2/size;\n\n   barrier(bar);\n   for(i=pid;i&lt;size;i+=nproc)\n   {    \n         a1[i] = (a[i])-(*mean1);\n         b1[i] = (b[i])-(*mean2);\n   }\n   for(i=pid;i&lt;size;i+=nproc)\n   {    \n         ab[i] = a1[i]*b1[i];\n   }\n   join_process(&amp;nproc,&amp;pid);\n   for(i=0;i&lt;size;i++)\n   {\n         total = total+ab[i];\n   } \n   printf(\"The Correlation is : %f \\n\",total);\n   if(total &gt;= 0)\n         printf(\"The Correlation  is Positive\\n\"); \n   else  \n         printf(\"The Correlation is Negative \\n\");\n   cleanup_memory(&amp;shmid1);\n   cleanup_memory(&amp;shmid2);\n   cleanup_memory(&amp;shmid3);\n   cleanup_memory(&amp;shmid4);\n   cleanup_memory(&amp;shmid5);\n   cleanup_memory(&amp;shmid6);\n   cleanup_memory(&amp;shmid7);\n   cleanup_memory(&amp;shmid8);\n   return 0;              \n\n   }  \n</code></pre>\n\n<p>here the header files such as Forkjoin and barrier are not able to be located.</p>\n\n<p>Thanks\nAbhinav</p>\n"}, {"tags": ["c", "function", "typedef", "c99"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1574226118, "post_id": 58946977, "comment_id": 104151598, "body": "I don&#39;t understand what <i>you</i> don&#39;t understand. You function claims it returns a <code>myfunc_t</code>, but doesn&#39;t, It is then used in a context that expects a function returning <code>void</code>, which yours doesn&#39;t by declaration (forget about practice, which we already discussed). Changing to <code>void</code> fulfills <i>both</i> problems."}, {"owner": {"reputation": 6975, "user_id": 274579, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/745415fffcdea46caf03c90534a4c7fa?s=128&d=identicon&r=PG", "display_name": "ysap", "link": "https://stackoverflow.com/users/274579/ysap"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1574226446, "post_id": 58946977, "comment_id": 104151676, "body": "<code>myfunc_t</code> is an alias for a prototype, isn&#39;t it? A type of a function, that is, that returns a <code>void</code>. I am using this prototype to define a function that returns a <code>void</code>. I am surely missing something here, but I still expect this to work."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1574226504, "post_id": 58946977, "comment_id": 104151691, "body": "It&#39;s a pointer-to-function <i>type</i> alias. Prototype has nothing to do with it."}, {"owner": {"reputation": 6975, "user_id": 274579, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/745415fffcdea46caf03c90534a4c7fa?s=128&d=identicon&r=PG", "display_name": "ysap", "link": "https://stackoverflow.com/users/274579/ysap"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1574226686, "post_id": 58946977, "comment_id": 104151738, "body": "Yes, see my comment to <a href=\"https://stackoverflow.com/a/58947063/274579\">stackoverflow.com/a/58947063/274579</a> Thanks."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1574231971, "post_id": 58946977, "comment_id": 104153375, "body": "You cannot use typedef to <i>define</i> a function, but you can use a typedef of a function type to <i>declare one</i>. If you&#39;ve got a function <i>pointer</i> type like in the question then that can be used to <i>neither</i> declare <i>nor</i> define a function..."}], "answers": [{"comments": [{"owner": {"reputation": 6975, "user_id": 274579, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/745415fffcdea46caf03c90534a4c7fa?s=128&d=identicon&r=PG", "display_name": "ysap", "link": "https://stackoverflow.com/users/274579/ysap"}, "edited": false, "score": 0, "creation_date": 1574226606, "post_id": 58947063, "comment_id": 104151713, "body": "I think I got my conceptual error. Contrary to what I wrote in the comment to the question, this is not rally a prototype. The definition of the function <code>myfunc</code> should have returned an object similar to <code>pfunc</code> in order to be correct."}], "tags": [], "owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "is_accepted": true, "score": 2, "last_activity_date": 1574226392, "creation_date": 1574226392, "answer_id": 58947063, "question_id": 58946977, "link": "https://stackoverflow.com/questions/58946977/why-is-this-usage-of-typedef-ed-function-an-error/58947063#58947063", "title": "Why is this usage of typedef-ed function an error?", "body": "<pre><code>myfunc_t myfunc(int x)\n</code></pre>\n\n<p>This statement creates a function <code>myfunc</code> which returns a function pointer <code>myfunc_t</code> </p>\n\n<p>But in the function definition you are not returning anything. Also what this does is make <code>myfunc</code> incompatible with the <code>myfunc_t</code> type (return values are different)</p>\n\n<p>What you need is to declare and define the function as </p>\n\n<pre><code>void myfunc(int x) \n{\n     ...\n}\n</code></pre>\n"}], "owner": {"reputation": 6975, "user_id": 274579, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/745415fffcdea46caf03c90534a4c7fa?s=128&d=identicon&r=PG", "display_name": "ysap", "link": "https://stackoverflow.com/users/274579/ysap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "closed_date": 1574231868, "accepted_answer_id": 58947063, "answer_count": 1, "score": 0, "last_activity_date": 1574226392, "creation_date": 1574225851, "question_id": 58946977, "link": "https://stackoverflow.com/questions/58946977/why-is-this-usage-of-typedef-ed-function-an-error", "closed_reason": "Duplicate", "title": "Why is this usage of typedef-ed function an error?", "body": "<p>I have the following code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\ntypedef void (*myfunc_t)(int x);\n\nmyfunc_t myfunc(int x)\n{\n    printf(\"x = %d\\n\", x);\n\n    return;\n}\n\nint main(void)\n{\n    myfunc_t pfunc = myfunc;\n\n    (pfunc)(1);\n\n    return 0;\n}\n</code></pre>\n\n<p>When compiling for C99, standard C, I get an error:</p>\n\n<pre><code>prog.c: In function \u2018myfunc\u2019:\nprog.c:9:6: error: \u2018return\u2019 with no value, in function returning non-void [-Werror]\n      return;\n      ^~~~~~\nprog.c:5:14: note: declared here\n     myfunc_t myfunc(int x)\n              ^~~~~~\nprog.c: In function \u2018main\u2019:\nprog.c:14:26: error: initialization of \u2018myfunc_t\u2019 {aka \u2018void (*)(int)\u2019} from incompatible pointer type \u2018void (* (*)(int))(int)\u2019 [-Werror=incompatible-pointer-types]\n         myfunc_t pfunc = myfunc;\n                          ^~~~~~\n</code></pre>\n\n<p>A few questions in SO already explain that the return type of <code>myfunc_t</code> is <code>void</code> (e.g., <a href=\"https://stackoverflow.com/a/30657500/274579\">here</a>). So, why do I get these errors?</p>\n\n<p>Note that if I change the type of <code>myfunc</code> from <code>myfunc_t</code> to <code>void</code>, then the program builds OK.</p>\n"}, {"tags": ["c", "for-loop"], "comments": [{"owner": {"reputation": 3364, "user_id": 7508700, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ms4Mr.png?s=128&g=1", "display_name": "David Buck", "link": "https://stackoverflow.com/users/7508700/david-buck"}, "edited": false, "score": 0, "creation_date": 1574230870, "post_id": 58946959, "comment_id": 104152997, "body": "So far you&#39;ve got a loop and in that loop you are only trying to print one star. You need to think about what to do inside that loop to print an increasing number of stars as i increases."}], "answers": [{"tags": [], "owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "is_accepted": true, "score": 2, "last_activity_date": 1574229399, "last_edit_date": 1574229399, "creation_date": 1574227079, "answer_id": 58947185, "question_id": 58946959, "link": "https://stackoverflow.com/questions/58946959/how-can-i-get-a-ladder/58947185#58947185", "title": "How can i get a &#39;*&#39; ladder?", "body": "<p>Nest a j loop printing from 1 to i stars. After said loop, but inside the outer, put a newline. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    int number;\n    if (scanf(\"%d\",&amp;number) == 1 &amp;&amp; number &gt; 0)\n    {\n        for(int i = 1 ; i &lt;= number ; i++)\n        {\n            for (int j=1; j&lt;=i; ++j)\n                fputc('*', stdout);\n\n            fputc('\\n', stdout);\n        }\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 12401656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7153dbb06b9a4c5bb83af0cda5a0af7a?s=128&d=identicon&r=PG&f=1", "display_name": "AngryGoat", "link": "https://stackoverflow.com/users/12401656/angrygoat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 58947185, "answer_count": 1, "score": 2, "last_activity_date": 1574229399, "creation_date": 1574225772, "last_edit_date": 1574226341, "question_id": 58946959, "link": "https://stackoverflow.com/questions/58946959/how-can-i-get-a-ladder", "title": "How can i get a &#39;*&#39; ladder?", "body": "<p>I want to add more * for each line but it appears only 1 * for each line.\nso confusing</p>\n\n<p>Here is my code </p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main()\n{\n  int number;\n  scanf(\"%d\",&amp;number);\n  for(int i = 1 ; i &lt;= number ; i++)\n  {\n    printf(\"*\\n\");\n  }\n  return 0;\n}\n</code></pre>\n\n<pre><code>This is my output\n5\n*\n*\n*\n*\n*\n</code></pre>\n\n<pre><code>This is output I want\n5\n*\n**\n***\n****\n*****\n</code></pre>\n"}, {"tags": ["c", "loops", "raspberry-pi", "binary", "led"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1574225461, "post_id": 58946880, "comment_id": 104151446, "body": "Welcome to Stackoverflow. We can help you fix and write your own code but not do all the work for you. Please try something, show what you have tried and ask a specific question about that code."}, {"owner": {"reputation": 585, "user_id": 3694234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfcdeb6b9b40f14bb4e515b06e485d16?s=128&d=identicon&r=PG&f=1", "display_name": "Yasir Khan", "link": "https://stackoverflow.com/users/3694234/yasir-khan"}, "edited": false, "score": 0, "creation_date": 1574228634, "post_id": 58946880, "comment_id": 104152318, "body": "Can you use C++?"}, {"owner": {"reputation": 1, "user_id": 12401615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7d1ca72c8798d745fdc798894cb4998?s=128&d=identicon&r=PG&f=1", "display_name": "jjjj4444", "link": "https://stackoverflow.com/users/12401615/jjjj4444"}, "edited": false, "score": 0, "creation_date": 1574228773, "post_id": 58946880, "comment_id": 104152354, "body": "I can only use C"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1574229153, "post_id": 58946880, "comment_id": 104152468, "body": "Thank you for posting your code. But you have not actually asked any question. What is it you would like help with specifically? Is there some incorrect behaviour in your code? Is it crashing? Is it too slow? ...?"}, {"owner": {"reputation": 1, "user_id": 12401615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7d1ca72c8798d745fdc798894cb4998?s=128&d=identicon&r=PG&f=1", "display_name": "jjjj4444", "link": "https://stackoverflow.com/users/12401615/jjjj4444"}, "edited": false, "score": 0, "creation_date": 1574229492, "post_id": 58946880, "comment_id": 104152567, "body": "the goal is to do everything stated at the top my code is doing it manually typing every situation. It needs to be able to do any positive or negative int and be able to still light the leds when 4 bit binary or less is converted and looped to keep asking."}], "answers": [{"tags": [], "owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "is_accepted": false, "score": 0, "last_activity_date": 1574229677, "creation_date": 1574229677, "answer_id": 58947694, "question_id": 58946880, "link": "https://stackoverflow.com/questions/58946880/binary-simulation-using-leds-in-c/58947694#58947694", "title": "Binary Simulation Using LEDS in C", "body": "<p>You can use a function as shown below to write to the pin. Note that I have used <code>unsigned int</code> for the parameters. This is to avoid undefined behaviour in bitwise operations.</p>\n\n<pre><code>#define NO_PINS 4\n#define MAXNO 16\nint pinnos[NO_PINS] = {0,2,3,5}\n\nvoid writetopin (unsigned int num)\n{ \n  if (num &gt;MAXNO) {\n     // handle this condition\n  }\n  else {\n     unsigned int mask = 0x01;\n     for (i=0; i&lt;NO_PINS; i++) {\n        unsigned int curr = num &amp; mask;\n        if (curr == 0) {\n          digitalWrite(pinnos[i], LOW);\n        }\n        else {\n          digitalWrite(pinnos[i], HIGH);\n        }\n        mask = mask &lt;&lt; 1; \n     }\n  }\n}\n</code></pre>\n\n<p>This function will handle only positive integers. To handle negative you need to define the sign bit and also the no of bits used for display.  </p>\n"}, {"tags": [], "owner": {"reputation": 585, "user_id": 3694234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfcdeb6b9b40f14bb4e515b06e485d16?s=128&d=identicon&r=PG&f=1", "display_name": "Yasir Khan", "link": "https://stackoverflow.com/users/3694234/yasir-khan"}, "is_accepted": false, "score": 0, "last_activity_date": 1574230823, "last_edit_date": 1574230823, "creation_date": 1574230418, "answer_id": 58947850, "question_id": 58946880, "link": "https://stackoverflow.com/questions/58946880/binary-simulation-using-leds-in-c/58947850#58947850", "title": "Binary Simulation Using LEDS in C", "body": "<p>This code should work for virtually any number of available GPIO pins. It works with both signed/unsigned numbers and calculates the mask required to get the desired bits off the number and display it. It also loops and asks for the input repeatedly untill EOF (ctrl+D) is pressed.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;wiringPi.h&gt;\n#include &lt;cstdint&gt;\n\n/* define led pins here */\nint pins[] = {2, 3 , 4, 5};\n\nvoid turn_led_on(int led)\n{\n    digitalWrite(pins[led], HIGH);        \n}\n\nvoid turn_led_off(int led)\n{\n    digitalWrite(pins[led], LOW);\n}\n\nvoid display_number(int number)\n{\n    int num_of_leds = sizeof(pins) / sizeof(int);\n\n    printf(\"The number is: %d\\n\", number);\n\n    uint8_t led_mask = (1 &lt;&lt; num_of_leds) - 1;\n\n    int masked_number = number &amp; led_mask;\n\n    for (int i = 0; i &lt; num_of_leds; i++) {\n        if (masked_number &amp; (1 &lt;&lt; i)) {\n            turn_led_on(i);\n        } else {\n            turn_led_off(i);\n        }\n    }\n}\n\nvoid initialize_leds()\n{\n    int num_of_leds = sizeof(pins) / sizeof(int);\n\n    for (int i = 0; i &lt; num_of_leds; i++) {\n        pinMode(pins[i], OUTPUT);\n        turn_led_off(pins[i]);\n    }\n}\n\nint main(int argc, char *argv[])\n{\n    int number;\n\n    wiringPiSetup();\n\n    initialize_leds(); \n\n    int ret;\n\n    while (true) {\n        printf(\"Please select a number to display!\\n\");\n        ret = scanf(\"%i\", &amp;number);\n\n        if (ret == EOF)\n            break;\n\n        display_number(number);\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 99, "user_id": 6422037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/936df06c5838a114e5c83378ea206648?s=128&d=identicon&r=PG&f=1", "display_name": "stilllearning", "link": "https://stackoverflow.com/users/6422037/stilllearning"}, "is_accepted": false, "score": 0, "last_activity_date": 1574314848, "last_edit_date": 1574314848, "creation_date": 1574232106, "answer_id": 58948222, "question_id": 58946880, "link": "https://stackoverflow.com/questions/58946880/binary-simulation-using-leds-in-c/58948222#58948222", "title": "Binary Simulation Using LEDS in C", "body": "<p>Other answers show how to map bits to GPIO pins. A little more explanation follows here, and I address the <code>printf</code> part: </p>\n\n<p>Keep in mind your integer is a binary representation in memory already:</p>\n\n<p><a href=\"https://en.wikipedia.org/wiki/Integer_(computer_science)\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Integer_(computer_science)</a></p>\n\n<p>It is probably 4 bytes. You can use bitwise operations to test each bit in your 32-bit chain, and build a string along the way:</p>\n\n<pre><code>char buffer[33];\nint value = -1; //for example\nunsigned int mask = 1;\nint i;\n\nbuffer[32] = 0; //null terminate\nfor (i = 0; i &lt; 32; i++) {\n  if (value &amp; mask) buffer[31-i] = '1'; //test each bit position\n  else buffer[31-i] = '0';\n  mask = mask &lt;&lt; 1; //shift high bit in mask one position left\n}\nprintf(\"$s\\n\",buffer);\n</code></pre>\n\n<p>Each time through the loop, <code>mask</code> shifts its single high bit one position to the left. The <code>&amp;</code> is the bitwise AND operator..each bit of <code>value</code> is AND-ed with the corresponding bit in <code>mask</code>, and the result is stored bit by bit. Since <code>mask</code> has only one bit high, the bitwise AND evaluates true only when <code>value</code> has a bit high in the same position. In this way you can test which bits of <code>value</code> are high, one at a time, from least significant bit to most significant bit. At the end, <code>buffer</code> will reflect just how those 32 bits are used to represent <code>value</code> in memory. Negative numbers will probably be in \"two's complement\" form.</p>\n"}], "owner": {"reputation": 1, "user_id": 12401615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7d1ca72c8798d745fdc798894cb4998?s=128&d=identicon&r=PG&f=1", "display_name": "jjjj4444", "link": "https://stackoverflow.com/users/12401615/jjjj4444"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 266, "favorite_count": 0, "answer_count": 3, "score": -2, "last_activity_date": 1574314848, "creation_date": 1574225328, "last_edit_date": 1574228254, "question_id": 58946880, "link": "https://stackoverflow.com/questions/58946880/binary-simulation-using-leds-in-c", "title": "Binary Simulation Using LEDS in C", "body": "<p>The goal is to take any int negative or positive and get the binary of it. then take that binary if it is 4 digits or less and display it on LEDS on raspberry Pi. No matter what display the binary with printf. It needs to be scalable so if you want to add more leds it should be easy only having to add pin numbers to the data structure without other effort to modify the program.  this needs to be a loop so after it prints the binary it asks to find it again the wiring pi numbers I am using for my LEDs are 0,2,3,5</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;wiringPi.h&gt;\n\n\nint main()\n{\n\nint displayNumber;\n\nwiringPiSetup();\n\npinMode(0, OUTPUT);\npinMode(2, OUTPUT);\npinMode(3, OUTPUT);\npinMode(5, OUTPUT);\n\n\ndigitalWrite(0, LOW);\ndigitalWrite(2, LOW);\ndigitalWrite(3, LOW);\ndigitalWrite(5, LOW);\n\nprintf(\"Please select a number to display!\\n\");\n\nscanf(\"%i\", &amp;displayNumber);\n\n\nswitch (displayNumber) {\n\ncase 0:\nprintf(\"0\");\ndigitalWrite(0, LOW);\ndigitalWrite(2, LOW);\ndigitalWrite(3, LOW);\ndigitalWrite(5, LOW);\nbreak;\n\ncase 1:\nprintf(\"1\");\ndigitalWrite(0, HIGH);\ndigitalWrite(2, LOW);\ndigitalWrite(3, LOW);\ndigitalWrite(5, LOW);\nbreak;\n\ncase 2:\nprintf(\"10\");\ndigitalWrite(0, HIGH);\ndigitalWrite(2, LOW);\ndigitalWrite(3, LOW);\ndigitalWrite(5, LOW);\nbreak;\n\ncase 3:\nprintf(\"11\");\ndigitalWrite(0, HIGH);\ndigitalWrite(2, HIGH);\ndigitalWrite(3, LOW);\ndigitalWrite(5, LOW);\nbreak;\n\ncase 4:\nprintf(\"100\");\ndigitalWrite(0, HIGH);\ndigitalWrite(2, LOW);\ndigitalWrite(3, LOW);\ndigitalWrite(5, LOW);\n\nbreak;\n\ncase 5:\nprintf(\"101\");\ndigitalWrite(0, HIGH);\ndigitalWrite(2, LOW);\ndigitalWrite(3, HIGH);\ndigitalWrite(5, LOW);\n\nbreak;\n\ncase 6:\nprintf(\"110\");\ndigitalWrite(0, HIGH);\ndigitalWrite(2, HIGH);\ndigitalWrite(3, LOW);\ndigitalWrite(5, LOW);\n\nbreak;\ncase 7:\nprintf(\"111\");\ndigitalWrite(0, HIGH);\ndigitalWrite(2, HIGH);\ndigitalWrite(3, HIGH);\ndigitalWrite(5, LOW);\n\nbreak;\ncase 8:\nprintf(\"1000\");\ndigitalWrite(0, HIGH);\ndigitalWrite(2, LOW);\ndigitalWrite(3, LOW);\ndigitalWrite(5, LOW);\n\nbreak;\ncase 9:\nprintf(\"1001\");\ndigitalWrite(0, HIGH);\ndigitalWrite(2, LOW);\ndigitalWrite(3, LOW);\ndigitalWrite(5, HIGH);\n\nbreak;\ncase 10:\nprintf(\"1010\");\ndigitalWrite(0, HIGH);\ndigitalWrite(2, LOW);\ndigitalWrite(3, HIGH);\ndigitalWrite(5, LOW);\n\nbreak;\ncase 11:\nprintf(\"1011\");\ndigitalWrite(0, HIGH);\ndigitalWrite(2, LOW);\ndigitalWrite(3, HIGH);\ndigitalWrite(5, HIGH);\n\nbreak;\ncase 12:\nprintf(\"1100\");\ndigitalWrite(0, HIGH);\ndigitalWrite(2, HIGH);\ndigitalWrite(3, LOW);\ndigitalWrite(5, LOW);\n\nbreak;\ncase 13:\nprintf(\"1101\");\ndigitalWrite(0, HIGH);\ndigitalWrite(2, HIGH);\ndigitalWrite(3, LOW);\ndigitalWrite(5, HIGH);\n\nbreak;\ncase 14:\nprintf(\"1110\");\ndigitalWrite(0, HIGH);\ndigitalWrite(2, HIGH);\ndigitalWrite(3, HIGH);\ndigitalWrite(5, LOW);\n\nbreak;\ncase 15:\nprintf(\"1111\");\ndigitalWrite(0, HIGH);\ndigitalWrite(2, HIGH);\ndigitalWrite(3, HIGH);\ndigitalWrite(5, HIGH);\nbreak;\n\n\n}\n\n\n\nreturn 0;\n\n}\n</code></pre>\n"}, {"tags": ["c", "multithreading", "rtos"], "comments": [{"owner": {"reputation": 1701, "user_id": 5836577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/931236857b09c3b0aea0f29fb5a23cbc?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Petitjean", "link": "https://stackoverflow.com/users/5836577/guillaume-petitjean"}, "edited": false, "score": 1, "creation_date": 1574234702, "post_id": 58946712, "comment_id": 104154457, "body": "Your solution basically does not use the benefits of a RTOS. a RTOS provides mechanisms like RTOS, IPC, exactly for this kind of question."}, {"owner": {"reputation": 1701, "user_id": 5836577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/931236857b09c3b0aea0f29fb5a23cbc?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Petitjean", "link": "https://stackoverflow.com/users/5836577/guillaume-petitjean"}, "edited": false, "score": 1, "creation_date": 1574234935, "post_id": 58946712, "comment_id": 104154557, "body": "Also, in an interview, you could mention that a RTOS scheduler is not necessraily preemptive but can be cooperative: in that case (to simplify) a task executes forever until it yields."}, {"owner": {"reputation": 4427, "user_id": 193887, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/54a2fc2a8cb81440a442aa45fc0f41a9?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/193887/jeremy"}, "edited": false, "score": 0, "creation_date": 1575456018, "post_id": 58946712, "comment_id": 104570111, "body": "Be aware that for many combinations of compiler, platform, and RTOS (and assuming the variable is declared <code>volatile</code>), your solution will work fine (albeit with a lot of busy-waiting).  Obviously the interviewers are interested in your understanding of RTOS concepts, but that doesn&#39;t mean your solution is invalid."}, {"owner": {"reputation": 1084, "user_id": 3052687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2bc9457ad57919f5ab4abc0007323f1?s=128&d=identicon&r=PG&f=1", "display_name": "HelpingHand", "link": "https://stackoverflow.com/users/3052687/helpinghand"}, "edited": false, "score": 0, "creation_date": 1588356149, "post_id": 58946712, "comment_id": 108872689, "body": "Similar problem to <a href=\"https://stackoverflow.com/questions/61156686/how-to-sync-thread-using-mutex-in-freertos/61237586#61237586\">this thread</a> - apart from that the present code does not use synchronisation at all."}], "answers": [{"tags": [], "owner": {"reputation": 56, "user_id": 12387785, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDyqGAY7oaqj0oyvAtZiO37fCuNPuS0CxzsD5qJxwY=k-s128", "display_name": "owl", "link": "https://stackoverflow.com/users/12387785/owl"}, "is_accepted": false, "score": 0, "last_activity_date": 1574228378, "creation_date": 1574228378, "answer_id": 58947427, "question_id": 58946712, "link": "https://stackoverflow.com/questions/58946712/how-to-make-sure-in-rtos-that-task1-finish-then-task2-start-we-dont-know-sched/58947427#58947427", "title": "How to make sure in RTOS that Task1 finish then Task2 start (we don&#39;t know scheduling algorithm )?", "body": "<p>For FreeRTOS you can use mutexes <a href=\"https://www.freertos.org/Real-time-embedded-RTOS-mutexes.html\" rel=\"nofollow noreferrer\">Mutexes</a>\nor \n<a href=\"https://www.freertos.org/FreeRTOS-Event-Groups.html\" rel=\"nofollow noreferrer\">Event groups</a></p>\n"}, {"tags": [], "owner": {"reputation": 42504, "user_id": 1161878, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0157ddd785dc01e95342e3661d34b42a?s=128&d=identicon&r=PG", "display_name": "Gene", "link": "https://stackoverflow.com/users/1161878/gene"}, "is_accepted": true, "score": 4, "last_activity_date": 1574407859, "creation_date": 1574407859, "answer_id": 58989481, "question_id": 58946712, "link": "https://stackoverflow.com/questions/58946712/how-to-make-sure-in-rtos-that-task1-finish-then-task2-start-we-dont-know-sched/58989481#58989481", "title": "How to make sure in RTOS that Task1 finish then Task2 start (we don&#39;t know scheduling algorithm )?", "body": "<p>A natural way to do this in an RTOS environment is with two binary semaphores, one for each task.  In pseudocode:</p>\n\n<pre><code>BinarySempahore up, dn;\n\nvoid task_up(void) {\n  while (1) {\n    wait(up);\n    printf(\"UP \");\n    signal(dn);\n  }\n}\n\nvoid task_dn(void) {\n  while (1) {\n    wait(dn);\n    printf(\"DOWN \");\n    signal(up);\n  }\n}\n\nvoid main(void) {\n  dn = create_binary_sempahore(0);\n  up = create_binary_semaphore(1);\n  start_task(task_dn);\n  start_task(task_up);\n}\n</code></pre>\n\n<p>Initially task <code>dn</code> blocks in <code>wait</code> because its semaphore has value zero, but <code>up</code> runs, prints its message, wakes up <code>dn</code>, then blocks on its own semaphore, which is now zero. Task <code>dn</code> is now unblocked from <code>wait</code> so prints its message, wakes <code>up</code>, then blocks on <em>its</em> sempahore, etc., etc.</p>\n"}], "owner": {"reputation": 163, "user_id": 2520119, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c7dcd3be1e714c56b9449258abf34664?s=128&d=identicon&r=PG", "display_name": "user2520119", "link": "https://stackoverflow.com/users/2520119/user2520119"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 58989481, "answer_count": 2, "score": 0, "last_activity_date": 1574544391, "creation_date": 1574224187, "question_id": 58946712, "link": "https://stackoverflow.com/questions/58946712/how-to-make-sure-in-rtos-that-task1-finish-then-task2-start-we-dont-know-sched", "title": "How to make sure in RTOS that Task1 finish then Task2 start (we don&#39;t know scheduling algorithm )?", "body": "<p>Below questions many times asked me in multiple interview and every time i confused to give answer properly.</p>\n\n<p><strong>Suppose RTOS running in single processor system. There are two tasks in that. Task1 print the data like \"Up\" and Task2 print data like \"Down\". How do you make sure that Task1 print first then Task2? So output is like below</strong></p>\n\n<p>Up\nDown\nUp \nDown\n.....</p>\n\n<p>I have suggested the mechanism using global variable like initially global variable have value 1. Ex. <code>int globaleVar = 1;</code> Now two task written like below</p>\n\n<p><strong>Task1</strong></p>\n\n<pre><code>while(1)\n{\n    if(globaleVar == 1)\n    {\n        printf(\"Up\");\n        globaleVar = 2;\n    }\n\n}\n</code></pre>\n\n<p><strong>Task2</strong></p>\n\n<pre><code>while(1)\n{\n    if(globaleVar == 2)\n    {\n        printf(\"Down\");\n        globaleVar = 1;\n    }\n\n}\n</code></pre>\n\n<p>But they said like what if Task2 get chance before the variable updated from Task1? Why not try using semaphor? </p>\n\n<p>So i am not aware about how it possible using semaphor? Anyone have idea? </p>\n"}, {"tags": ["c", "arrays", "linux", "compare", "string-comparison"], "comments": [{"owner": {"reputation": 585, "user_id": 3694234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfcdeb6b9b40f14bb4e515b06e485d16?s=128&d=identicon&r=PG&f=1", "display_name": "Yasir Khan", "link": "https://stackoverflow.com/users/3694234/yasir-khan"}, "edited": false, "score": 2, "creation_date": 1574224752, "post_id": 58946607, "comment_id": 104151279, "body": "This has code has so many errors, first what&#39;s the size of the array you need? size = sizeof(arr) will return the size of array pointer which could be 4 or 8 depending on the machine. And where is the input part? Then while reversing the array, you are overwriting the original array. And finally, if (temp = arr[j]) will always return true as it is assignment, not comparison. You probably need if (temp == arr[j]) but that too does&#39;t make sense logically."}], "answers": [{"tags": [], "owner": {"reputation": 135, "user_id": 11730888, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wMFXV2mCR1U/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rciOHG5HVcJ2T9eyQHSyUSq37MMmQ/photo.jpg?sz=128", "display_name": "amengelbrecht", "link": "https://stackoverflow.com/users/11730888/amengelbrecht"}, "is_accepted": false, "score": 4, "last_activity_date": 1574224681, "creation_date": 1574224681, "answer_id": 58946792, "question_id": 58946607, "link": "https://stackoverflow.com/questions/58946607/how-to-compare-if-an-array-is-the-same-in-reverse-in-c/58946792#58946792", "title": "How to compare if an array is the same in reverse in C?", "body": "<p>You can't get the size of the array with sizeof. You should print out size and see what that value is giving you, it won't be the size of the array.</p>\n\n<p>The reason you are always getting the \"same\" is that you aren't actually comparing values. You are assigning arr[j] to temp. if(temp = arr[j]) should be if(temp == arr[j]). I think you will find that it won't go to same anymore.</p>\n\n<p>An easier way to solve this problem would be:</p>\n\n<pre><code>void checkReverse(int* arr, int arrSize)\n{\n   // Loop through the array until you have hit the middle\n   for (int i = 0; i &lt; (arrSize - i); i++)\n   {\n      // Check the element to the element in the same place counting from the back\n      if (arr[i] != arr[arrSize - i - 1])\n      {\n         // If we find any that don't match, we know it's not the same and can return\n         printf(\"Array is NOT the same in reverse.\\n\");\n         return;\n      }\n   }\n\n   // If we made it this far, they are the same\n   printf(\"Array is the same in reverse.\\n\");\n   return;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 797, "user_id": 3721086, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/o5VBi.jpg?s=128&g=1", "display_name": "Sandeep Kokate", "link": "https://stackoverflow.com/users/3721086/sandeep-kokate"}, "is_accepted": false, "score": 1, "last_activity_date": 1574225233, "last_edit_date": 1574225233, "creation_date": 1574224905, "answer_id": 58946823, "question_id": 58946607, "link": "https://stackoverflow.com/questions/58946607/how-to-compare-if-an-array-is-the-same-in-reverse-in-c/58946823#58946823", "title": "How to compare if an array is the same in reverse in C?", "body": "<p>You need to modify your code with the following two points:</p>\n\n<ol>\n<li>In your code, size means the number of elements in the array correct? so to calculate it correctly replace</li>\n</ol>\n\n<p><code>size = sizeof(arr)/sizeof(int);</code></p>\n\n<p><code>sizeof</code> gives you the memory size occupied by the array, so for the array of three integers, it gives 3*int size. To count the elements of an array you need to use sizeof(array) and divide it with the size of the data type.</p>\n\n<ol start=\"2\">\n<li>You need to traverse in the loop and compare each element of the original array and reversed array to confirm is it the same not.</li>\n</ol>\n\n<p>So you need to replace your comparison logic with :</p>\n\n<pre><code>/* Compare original array with reversed array */\n  for(i=0;i &lt; size;i++)\n  {\n      if(new[i] != old[i]){\n          printf(\"Array is not the same in reverse\\n\");\n          return;\n      }\n  }\n  printf(\"Array is the same in reverse\\n\");\n  return;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 585, "user_id": 3694234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfcdeb6b9b40f14bb4e515b06e485d16?s=128&d=identicon&r=PG&f=1", "display_name": "Yasir Khan", "link": "https://stackoverflow.com/users/3694234/yasir-khan"}, "is_accepted": false, "score": 0, "last_activity_date": 1574227411, "creation_date": 1574227411, "answer_id": 58947247, "question_id": 58946607, "link": "https://stackoverflow.com/questions/58946607/how-to-compare-if-an-array-is-the-same-in-reverse-in-c/58947247#58947247", "title": "How to compare if an array is the same in reverse in C?", "body": "<p>If you want to use recursion to solve this problem.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint compare(int *arr, int p, int q)\n{\n    /* base case, if we are at or pass the middle point */\n    if (p &gt;= q)\n        return 1;\n\n    if (arr[p] != arr[q]) {\n        return 0;\n    } else {\n        return compare(arr, p + 1, q - 1);\n    }\n}\n\nint main(int argc, char *argv[])\n{\n    int arr1[] = {5, 5, 8, 8, 5, 5};\n\n    size_t array_size = sizeof(arr1) / sizeof(int);\n\n    int first = 0;\n    int last = array_size - 1;\n\n    if (compare(arr1, first, last)) {\n        printf(\"Array is same in reverse\\n\");\n    } else {\n        printf(\"Array is not same in reverse\\n\");\n    }\n\n    return 0;  \n}\n\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 66, "user_id": 8143226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba820f134f5524bf278b4810dda19155?s=128&d=identicon&r=PG&f=1", "display_name": "gabson", "link": "https://stackoverflow.com/users/8143226/gabson"}, "is_accepted": false, "score": 0, "last_activity_date": 1574323176, "creation_date": 1574323176, "answer_id": 58969935, "question_id": 58946607, "link": "https://stackoverflow.com/questions/58946607/how-to-compare-if-an-array-is-the-same-in-reverse-in-c/58969935#58969935", "title": "How to compare if an array is the same in reverse in C?", "body": "<p>Best solution to this question during an interview IMO: <a href=\"https://en.wikipedia.org/wiki/Stack_(abstract_data_type)\" rel=\"nofollow noreferrer\">Use a stack:</a></p>\n\n<p>step 1)\n<strong>racecar</strong> -> push into stack -> STACK</p>\n\n<p>step 2)\nSTACK-> pop from stack -> <strong>racecar</strong> </p>\n\n<p>The input and output strings are the same, therefore the word is a palindrome.</p>\n\n<p>As opposed to:</p>\n\n<p>step 1)  <strong>something</strong> -> push into stack -> STACK</p>\n\n<p>step 2) STACK-> pop from stack -> <strong>gnihtemos</strong> </p>\n\n<p>The input and output strings are NOT the same, therefore the word is NOT a palindrome.</p>\n"}], "owner": {"reputation": 23, "user_id": 11206484, "user_type": "registered", "profile_image": "https://graph.facebook.com/2827132050638239/picture?type=large", "display_name": "Anna Nguyen", "link": "https://stackoverflow.com/users/11206484/anna-nguyen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 812, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1574323176, "creation_date": 1574223443, "question_id": 58946607, "link": "https://stackoverflow.com/questions/58946607/how-to-compare-if-an-array-is-the-same-in-reverse-in-c", "title": "How to compare if an array is the same in reverse in C?", "body": "<p>C language<br>\nI want to compare an array with it's reversed form and check to see if it's the same.</p>\n\n<p>For example, arr1 = 5 5 8 8 5 5 <br>\nReversed arr1 = 5 5 8 8 5 5</p>\n\n<p>Then output would be: Array is the same in reverse. </p>\n\n<p><strong>For some reason when I try to compare my two arrays, it ALWAYS says it is the same even if it is not.</strong></p>\n\n<p>For example : 7 8 9 is entered. The reverse is 9 8 7, which is not the same as what was entered. However, my code says it is.</p>\n\n<p>How can I fix my comparison so that the results are accurate? Please advise, thank you!</p>\n\n<p>I tried using goto to display results. This is my code (function):</p>\n\n<pre><code>void function(int *arr)\n{\n  int j, c, temp, size;\n  size = sizeof(arr);\n  int old[size];\n  int new[size];\n\n  /*Prints original array from user input*/\n  printf(\"Input Array: \");\n  for(j=0; j&lt;size; j++)\n  {\n     printf(\"%d \", arr[j]);\n     old[j] = arr[j];\n  }\n  printf(\"\\n\");\n\n  /* Reversing the array */\n  c = j - 1;\n  j = 0;\n  while (j &lt; c)\n  {\n     temp = arr[j];\n     arr[j] = arr[c];\n     arr[c] = temp;\n     j++;\n     c--;\n  }\n\n  /* Print Reversed Array */\n  int i;\n  for(i=0; i&lt;size; i++)\n  {\n     printf(\"%d \", arr[i]);\n     /*saved to new for possible comparison*/\n     new[i] = arr[i];\n  }\n  printf(\"\\n\");\n\n  /* Compare original array with reversed array */\n  if(temp = arr[j])\n  {\n     goto same;\n  } else {\n     goto notsame; \n  }\n\n  same:\n     printf(\"Array is the same in reverse\\n\");\n     return 0;\n  notsame:\n     printf(\"Array is not the same in reverse\\n\");\n     return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "multithreading"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 3, "creation_date": 1574222010, "post_id": 58946392, "comment_id": 104150663, "body": "Can you please expand on &quot;having issues&quot;? What issues exactly? For example, what is the expected behaviour vs actual behaviour?"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1574222083, "post_id": 58946392, "comment_id": 104150680, "body": "Also, for your info <code>C</code> and <code>C++</code> are different languages and you should only select the one you are actually using."}, {"owner": {"reputation": 1, "user_id": 11111067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4b6f4610394a8e0b818b1883ef02f0f?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Cornila", "link": "https://stackoverflow.com/users/11111067/alex-cornila"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1574222150, "post_id": 58946392, "comment_id": 104150696, "body": "ahh ok sorry. so program runs, compiles but the image is not reconstructed  correctly. I assume I need to probably make sure my buffers store data sequentially but again not sure that causes the issue here."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1574222250, "post_id": 58946392, "comment_id": 104150720, "body": "Please put such info into the question itself and not as comments. And the more specific you are  the better people can help you. What does it mean by &quot;not reconstructed properly&quot;? All blank? Inverted? Cut off? Random? Suggest you provide sample input, expected output and actual output."}, {"owner": {"reputation": 729, "user_id": 5942006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fe054f41dc543395631acc84ac04f60?s=128&d=identicon&r=PG&f=1", "display_name": "systemcpro", "link": "https://stackoverflow.com/users/5942006/systemcpro"}, "edited": false, "score": 0, "creation_date": 1574222406, "post_id": 58946392, "comment_id": 104150753, "body": "As per previous comment. Are you actually compiling C code and have just used wrong tag or are you using a C++ compiler and just writing old style C? This is important since if using C++ one can (and should) avoid using raw threads altogether and use the stdlib threadnig facilities. Raw thread handles are notoriously error prone and hide subtle bugs even in the apparently &quot;simple&quot; code."}, {"owner": {"reputation": 2769, "user_id": 11343720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kHKkF.png?s=128&g=1", "display_name": "MERN", "link": "https://stackoverflow.com/users/11343720/mern"}, "reply_to_user": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "edited": false, "score": 0, "creation_date": 1574222652, "post_id": 58946392, "comment_id": 104150822, "body": "@uneven_mark, you are true"}, {"owner": {"reputation": 1, "user_id": 11111067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4b6f4610394a8e0b818b1883ef02f0f?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Cornila", "link": "https://stackoverflow.com/users/11111067/alex-cornila"}, "reply_to_user": {"reputation": 729, "user_id": 5942006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fe054f41dc543395631acc84ac04f60?s=128&d=identicon&r=PG&f=1", "display_name": "systemcpro", "link": "https://stackoverflow.com/users/5942006/systemcpro"}, "edited": false, "score": 0, "creation_date": 1574223258, "post_id": 58946392, "comment_id": 104150966, "body": "@systemcpro thats a good point, I initially started out using g++. So when I compile with gcc and using the while counter I get a seg fault"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1574223975, "post_id": 58946392, "comment_id": 104151121, "body": "@AlexCornila This is a classic producer-consumer problem. You need to synchronise the threads so that the consumer does not underrun and the producer does not overrun. That&#39;s a broad topic that is difficult to cover adequately in the context of this question. Suggest you do research on producer consumer pattern and implementations. One common solution is to use semaphores."}, {"owner": {"reputation": 1, "user_id": 11111067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4b6f4610394a8e0b818b1883ef02f0f?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Cornila", "link": "https://stackoverflow.com/users/11111067/alex-cornila"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1574224236, "post_id": 58946392, "comment_id": 104151174, "body": "@kaylum I see. I have used mutex locks for the buffer shouldn&#39;t that fix the problem you mentioned? thanks"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1574224641, "post_id": 58946392, "comment_id": 104151257, "body": "Mutex is not the right synchronisation technique here. A mutex protects the critical section which prevents the two threads from operating on the buffer at the same time. Very crudely that may work if the <code>grab</code> thread is guaranteed to execute first but there is nothing in your code that enforces that. But think about what happens even if that works - the <code>grab</code> thread would need to complete before the <code>analyze</code> thread runs. Which means the operations are serialised in which case there is no point in using threads. Semaphores will allow more fine grained synchronisation."}, {"owner": {"reputation": 1, "user_id": 11111067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4b6f4610394a8e0b818b1883ef02f0f?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Cornila", "link": "https://stackoverflow.com/users/11111067/alex-cornila"}, "edited": false, "score": 0, "creation_date": 1574225551, "post_id": 58946392, "comment_id": 104151468, "body": "@thank you so much I&#39;ll give that a  try."}], "owner": {"reputation": 1, "user_id": 11111067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4b6f4610394a8e0b818b1883ef02f0f?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Cornila", "link": "https://stackoverflow.com/users/11111067/alex-cornila"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 2, "answer_count": 0, "score": 0, "last_activity_date": 1574222588, "creation_date": 1574221865, "last_edit_date": 1574222588, "question_id": 58946392, "link": "https://stackoverflow.com/questions/58946392/multithreading-implementation-read-rotate-and-save-an-image-using-2-threads", "title": "multithreading implementation read, rotate, and save an image using 2 threads", "body": "<p>I have written this program that should use two threads one that reads in an image into a buffer and the second turns the image 90 degrees and saves it to a file. I need to run this for couple of minutes and collect some data. My problem is that the code runs ok without the while loop counter but I am having issue running multiple times. I assume the problem is with my threaded implementation. When the while loop is include the output image is just a set of vertical lines without the while counter image is reconstructed correctly. thank you   </p>\n\n<p>I have written this program that should use two threads one that reads in an image into a buffer and the second turns the image 90 degrees and saves it to a file. I need to run this for couple of minutes and collect some data. My problem is that the problem runs ok without the while loop counter but I am having issue running multiple times. I assume the problem is with my threaded implementation. thank you</p>\n\n<pre><code>#include &lt;stddef.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;pthread.h&gt;\n#define WIDTH 512\n#define HEIGHT 512\n#define DEPTH 255\n\npthread_mutex_t mtx;\nstatic const unsigned MAX = 8;\nchar *buffer = (char *)malloc((MAX) * sizeof(char));\n\nvoid *grab(void *buffer)\n{\nFILE *infile;\nsize_t i;\n\npthread_mutex_lock(&amp;mtx);\nchar *localbuffer = (char *)buffer;\ninfile = fopen(\"lena512.pgm\", \"r\");\n\nfor (i = 0; i &lt; 4; ++i)\n    fscanf(infile, \"%*[^\\n]\\n\");\n//buffer = (char *)malloc((WIDTH/64) * sizeof(char));\n//buffer = (char *)malloc((512) * sizeof(char)); /\n\nfor (i = 0; i &lt; HEIGHT; ++i)\n{\n    fread(&amp;localbuffer[i * WIDTH], sizeof(char),\n          WIDTH, infile);\n}\npthread_mutex_unlock(&amp;mtx);\n//fclose(infile);\n//return localbuffer;\npthread_exit(NULL);\n}\n\nvoid *analyze(void *buffer)\n{\npthread_mutex_lock(&amp;mtx);\nchar *localbuffer = (char *)buffer;\nFILE *outfile;\nsize_t i;\nchar *analyzed =\n    (char *)malloc(WIDTH * HEIGHT * sizeof(char));\n\nfor (int x = 0; x &lt; WIDTH; x++)\n{\n    for (int y = 0; y &lt; HEIGHT; y++)\n    {\n        int offset = HEIGHT * x + y;\n        analyzed[offset] = localbuffer[y * HEIGHT - 1 + x];\n    }\n}\noutfile = fopen(\"analyzed.pgm\", \"w\");\nfputs(\"P5\\n\", outfile);\nfprintf(outfile, \"%d %d\\n%d\\n\", WIDTH, HEIGHT, DEPTH);\n\nfor (i = 0; i &lt; HEIGHT; ++i)\n{\n    fwrite(&amp;analyzed[i * WIDTH], sizeof(char),\n           WIDTH, outfile);\n}\npthread_mutex_unlock(&amp;mtx);\n//fclose(outfile);\nfree(analyzed);\n//return localbuffer;\npthread_exit(NULL);\n}\n\nint main(void)\n{\nchar *localbuffer;\npthread_t thread1, thread2;\nint counter = 10000;\n\nwhile (counter != 0)\n{\n\n    pthread_create(&amp;thread1, NULL, grab, buffer);\n    pthread_create(&amp;thread2, NULL, analyze, buffer);\n\n    pthread_join(thread1, NULL);\n    pthread_join(thread2, NULL);\n}\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1574221493, "post_id": 58946306, "comment_id": 104150548, "body": "Can you please expand on &quot;not working&quot;. Which part specifically is not working - what is the expected behaviour and what is the actual behaviour?"}, {"owner": {"reputation": 719, "user_id": 10977224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4fb8cee5b76e0cc7a091d833faccf28?s=128&d=identicon&r=PG&f=1", "display_name": "RRGT19", "link": "https://stackoverflow.com/users/10977224/rrgt19"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1574222064, "post_id": 58946306, "comment_id": 104150678, "body": "@kaylum Thanks for replying. I have added more explanation to the question."}], "answers": [{"comments": [{"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1574227125, "post_id": 58946857, "comment_id": 104151861, "body": "@DavidSchwartz - You are correct. I have modified it."}, {"owner": {"reputation": 719, "user_id": 10977224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4fb8cee5b76e0cc7a091d833faccf28?s=128&d=identicon&r=PG&f=1", "display_name": "RRGT19", "link": "https://stackoverflow.com/users/10977224/rrgt19"}, "edited": false, "score": 0, "creation_date": 1574248797, "post_id": 58946857, "comment_id": 104162095, "body": "@RishikeshRaje The <code>if (k == numToWin)</code> condition is outside of the last <code>for</code> in both functions. I have tried to move it inside but, both functions doesn&#39;t work, always return <code>false</code>. I have tried to place peaces together diagonally on any direction and both functions always return <code>false</code>."}, {"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "reply_to_user": {"reputation": 719, "user_id": 10977224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4fb8cee5b76e0cc7a091d833faccf28?s=128&d=identicon&r=PG&f=1", "display_name": "RRGT19", "link": "https://stackoverflow.com/users/10977224/rrgt19"}, "edited": false, "score": 0, "creation_date": 1574250134, "post_id": 58946857, "comment_id": 104162851, "body": "@RRGT19 - The condition <code>if (k == numToWin)</code> checks whether the match is received for a particular value of <code>BASE[i][j]</code>. This represents the starting point for the pattern. If the match is received for any starting point, then the function exits with <code>true</code>"}, {"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 0, "creation_date": 1574250295, "post_id": 58946857, "comment_id": 104162935, "body": "The condition should not be moved from it&#39;s current location. If you still are not getting the diagonal with the value, you should tell us an example value of the entire <code>BASE</code> array for which the function is failing. you can make an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> by initailizing the array with example value."}, {"owner": {"reputation": 719, "user_id": 10977224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4fb8cee5b76e0cc7a091d833faccf28?s=128&d=identicon&r=PG&f=1", "display_name": "RRGT19", "link": "https://stackoverflow.com/users/10977224/rrgt19"}, "edited": false, "score": 0, "creation_date": 1574253244, "post_id": 58946857, "comment_id": 104164651, "body": "@RishikeshRaje I will do a reproducible example. In the meanwhile, what I&#39;ve tried to mean is this, look at this screenshot: <a href=\"https://ibb.co/4YGFb9X\" rel=\"nofollow noreferrer\">ibb.co/4YGFb9X</a>. The <code>if (k == numToWin)</code> is not evaluated because it&#39;s outside the for. I don&#39;t know if this is intentional or we need to use <code>j</code> instead of <code>k</code>."}, {"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "reply_to_user": {"reputation": 719, "user_id": 10977224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4fb8cee5b76e0cc7a091d833faccf28?s=128&d=identicon&r=PG&f=1", "display_name": "RRGT19", "link": "https://stackoverflow.com/users/10977224/rrgt19"}, "edited": false, "score": 0, "creation_date": 1574253575, "post_id": 58946857, "comment_id": 104164868, "body": "@RRGT19 - Please see the updated code. I have updated the scope of the <code>k</code> variable."}, {"owner": {"reputation": 719, "user_id": 10977224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4fb8cee5b76e0cc7a091d833faccf28?s=128&d=identicon&r=PG&f=1", "display_name": "RRGT19", "link": "https://stackoverflow.com/users/10977224/rrgt19"}, "edited": false, "score": 0, "creation_date": 1574255520, "post_id": 58946857, "comment_id": 104166053, "body": "@RishikeshRaje I have tried different angles and the functions only works sometimes but, don&#39;t work for the most basic scenario, having the same letter diagonally from bottom left towards the top right. I didn&#39;t know how to insert a snippet using C here, so I have created a working example with the non-functional case for you to see and test: <a href=\"https://codeshare.io/5wWJ9P\" rel=\"nofollow noreferrer\">codeshare.io/5wWJ9P</a>. You can copy it and paste it in your IDE to run it."}], "tags": [], "owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "is_accepted": false, "score": 1, "last_activity_date": 1574253413, "last_edit_date": 1574253413, "creation_date": 1574225159, "answer_id": 58946857, "question_id": 58946306, "link": "https://stackoverflow.com/questions/58946306/check-diagonally-winner-in-connect-n-using-c/58946857#58946857", "title": "Check diagonally winner in Connect N using C", "body": "<p>The main problem is that you are not exiting the function when you find a match of 4 elements. Also the function looping needs to be modified as shown.</p>\n\n<p>You need two functions to check left diagonal and right diagonal  </p>\n\n<pre><code>   /  &lt;-- left diagonal     right diagonal --&gt; \\\n  /                                             \\\n /                                               \\\n/                                                 \\\n</code></pre>\n\n<p>I have modified the check functions and also added the functionality to check for variable number of elements in a diagonal.</p>\n\n<pre><code>// this function checks diagnonal sloping left \"/\"\n//\nbool diagLeftWin(int ROWS, int COLS, char **BASE, int numToWin, char letter) {\n    for (int i=0; i&lt;ROWS-numToWin; i++){\n        for (int j=0; j&lt;COLS-numToWin; j++){\n            char curr = BASE[i][j];  \n            if (curr == letter) {\n              int k;\n              for (k=1; k&lt;numToWin; k++) {\n                  if (curr != BASE[i+k][j+k]) {\n                     break;\n                  }\n              }\n              if (k == numToWin) {\n                  // match found\n                  return true;\n              }\n            }                   \n        }\n    }\n    return false;\n}\n\n// this function checks diagnonal sloping right \"\\\"\n//\nbool diagLeftWin(int ROWS, int COLS, char **BASE, int numToWin, char letter) {\n    for (int i=ROWS-numToWin; i&gt;=0; i--){\n        for (int j=0; j&lt;COLS-numToWin; j++){\n            char curr = BASE[i][j]; \n            if (curr == letter) {\n              int k;                \n              for (k=1; k&lt;numToWin; k++) {\n                  if (curr != BASE[i-k][j+k]) {\n                     break;\n                  }\n              }\n              if (k == numToWin) {\n                  // match found\n                  return true;\n              } \n            }                   \n        }\n    }\n    return false;\n}\n</code></pre>\n\n<p>These functions check the entire board every time. You can optimise it to only check around newly added pieces to the board.</p>\n"}], "owner": {"reputation": 719, "user_id": 10977224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4fb8cee5b76e0cc7a091d833faccf28?s=128&d=identicon&r=PG&f=1", "display_name": "RRGT19", "link": "https://stackoverflow.com/users/10977224/rrgt19"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1574253413, "creation_date": 1574221269, "last_edit_date": 1574222716, "question_id": 58946306, "link": "https://stackoverflow.com/questions/58946306/check-diagonally-winner-in-connect-n-using-c", "title": "Check diagonally winner in Connect N using C", "body": "<p>I'm doing the game Connect N using C and I'm having a hard time trying to code an algorithm to check if there is a winner diagonally.</p>\n\n<pre><code>char **BASE;\nint piecesToWin, ROWS, COLS;\nprintf(\"Enter how many connected pieces to win?: \");\nscanf(\"%d\", &amp;piecesToWin);\n\nROWS = 2 + piecesToWin;\nCOLS = 3 + piecesToWin;\nBASE = (char **) malloc(ROWS * sizeof(char *)); // Allocate the row pointers\nfor (int i = 0; i &lt; ROWS; i++) //  Allocate each row separately\n    BASE[i] = (char *) malloc(COLS * sizeof(char));\n\n// Fill all with space to start\nfor (int i = 0; i &lt; ROWS; i++)\n    for (int j = 0; j &lt; COLS; j++)\n        BASE[i][j] = ' ';\n</code></pre>\n\n<p>After this, I insert a piece to the board and then, I check if there is a winner diagonally.</p>\n\n<pre><code>if (diagAscWin(ROWS, COLS, BASE, piecesToWin, 'X')) {\n     printf(\"X has won!.\");\n}\n\nif (diagDescWin(ROWS, COLS, BASE, piecesToWin, 'X')) {\n     printf(\"X has won!.\");\n}\n</code></pre>\n\n<p>What I have tried to check diagonally:</p>\n\n<pre><code>bool diagAscWin(int ROWS, int COLS, char **BASE, int numToWin, char letter) {\n    bool isWinner = false;\n    for (int i=3; i&lt;ROWS; i++){\n        for (int j=0; j&lt;COLS-3; j++){\n            if (BASE[i][j] == letter &amp;&amp; BASE[i-1][j+1] == letter &amp;&amp; BASE[i-2][j+2] == letter &amp;&amp; BASE[i-3][j+3] == letter)\n                isWinner = true;\n        }\n    }\n\n    return isWinner;\n}\n\nbool diagDescWin(int ROWS, int COLS, char **BASE, int numToWin, char letter) {\n    bool isWinner = false;\n    for (int i=3; i&lt;ROWS; i++){\n        for (int j=3; j&lt;COLS; j++){\n            if (BASE[i][j] == letter &amp;&amp; BASE[i-1][j-1] == letter &amp;&amp; BASE[i-2][j-2] == letter &amp;&amp; BASE[i-3][j-3] == letter)\n                isWinner = true;\n        }\n    }\n\n    return isWinner;\n}\n</code></pre>\n\n<p>These functions are not working. When I have N pieces diagonally, <code>diagAscWin</code> and <code>diagDescWin</code> don't see them and always return <code>false</code>. Also, I'm not sure if I need to initialize <code>i</code> or <code>j</code> with <code>3</code> or <code>j&lt;COLS-3</code>. I was trying to replicate a solution from another thread.</p>\n\n<p>Also, I have tried this:</p>\n\n<pre><code>bool diagRightWin(int ROWS, int COLS, char **BASE, int numToWin, char letter) {\n    bool isWinner = false;\n    int count;\n    for (int rowStart = 0; rowStart &lt; ROWS - 4; rowStart++) {\n        count = 0;\n        int row, col;\n        for (row = rowStart, col = 0; row &lt; ROWS &amp;&amp; col &lt; COLS; row++, col++) {\n            if (BASE[row][col] == letter) {\n                count++;\n                if (count &gt;= numToWin) isWinner = true;\n            } else {\n                count = 0;\n            }\n        }\n    }\n\n    return isWinner;\n}\n\nbool diagLeftWin(int ROWS, int COLS, char **BASE, int numToWin, char letter) {\n    bool isWinner = false;\n    int count;\n    for (int rowStart = 0; rowStart &lt; ROWS - 4; rowStart++) {\n        count = 0;\n        int row, col;\n        for (row = rowStart, col = 0; row &lt; ROWS &amp;&amp; col &lt; COLS; row++, col++) {\n            if (BASE[row][col] == letter) {\n                count++;\n                if (count &gt;= numToWin) isWinner = true;\n            } else {\n                count = 0;\n            }\n        }\n    }\n\n    return isWinner;\n}\n</code></pre>\n\n<p>These two functions also always return <code>false</code>.</p>\n\n<p>I have tried different logics with no luck. The correct thing is to check how many <code>numToWin</code> pieces are diagonally to say if there is a winner.</p>\n\n<p>I have tried to replicate:</p>\n\n<ol>\n<li><a href=\"https://stackoverflow.com/questions/32770321/connect-4-check-for-a-win-algorithm\">Connect 4 check for a win algorithm</a></li>\n<li><a href=\"https://stackoverflow.com/questions/39062111/java-how-to-check-diagonal-connect-four-win-in-2d-array\">Java: How to check diagonal Connect Four win in 2D array</a></li>\n<li><a href=\"https://stackoverflow.com/questions/34247472/javascript-connect-four-game-validation\">Javascript - Connect Four game validation</a></li>\n<li><a href=\"https://stackoverflow.com/questions/48506672/checking-for-a-line-of-four-connect-four-in-java\">Checking for a line of four (Connect Four in Java)</a></li>\n</ol>\n\n<p>My goal is to check if there is a winner diagonally (on any direction), having in mind that the board can be big or small, we don't know the size. What we know for sure is the <code>piecesToWin</code> which is the number of pieces that needs to be together to say there is a winner.</p>\n"}, {"tags": ["c", "delphi"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 12401373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dba838d31a9f6781390c577a182a5364?s=128&d=identicon&r=PG&f=1", "display_name": "chchub", "link": "https://stackoverflow.com/users/12401373/chchub"}, "edited": false, "score": 0, "creation_date": 1574652083, "post_id": 58947793, "comment_id": 104294369, "body": "Thank you very much. I spent a little time trying to test.The problem has been solved"}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 0, "last_activity_date": 1574230153, "creation_date": 1574230153, "answer_id": 58947793, "question_id": 58946288, "link": "https://stackoverflow.com/questions/58946288/how-convert-this-c-function-pointer-to-a-delphi-function/58947793#58947793", "title": "how convert this C function pointer to a delphi function", "body": "<p>Try something like this:</p>\n\n<pre class=\"lang-pascal prettyprint-override\"><code>type\n  ConfigNode = record\n    ...\n  end;\n  PConfigNode = ^ConfigNode;\n\n  SetValueFunc = function(const path, value: PAnsiChar): Integer; cdecl;\n  GetValueFunc = function(const path: PAnsiChar): PAnsiChar; cdecl;\n  GetPropertysFunc = function: PConfigNode; cdecl;\n\n  tagIProperty = record\n    SetValue: SetValueFunc;\n    GetValue: GetValueFunc;\n    GetPropertys: GetPropertysFunc;\n  end;\n  IProperty = tagIProperty;\n</code></pre>\n\n<pre class=\"lang-pascal prettyprint-override\"><code>var\n  property: ^IProperty;\n...\nproperty := ...;\n...\nproperty.SetValue('0/baud_rate', '1000000');\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 12401373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dba838d31a9f6781390c577a182a5364?s=128&d=identicon&r=PG&f=1", "display_name": "chchub", "link": "https://stackoverflow.com/users/12401373/chchub"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1574230153, "creation_date": 1574221078, "last_edit_date": 1574221320, "question_id": 58946288, "link": "https://stackoverflow.com/questions/58946288/how-convert-this-c-function-pointer-to-a-delphi-function", "title": "how convert this C function pointer to a delphi function", "body": "<p>There is a third-party C DLL, with Delphi 2007 development program (novice level), in the DLL header file, the function structure is more complex, there is a big god can give some ideas? C header file definition:</p>\n\n<pre><code>typedef int (*SetValueFunc)(const char* path, const char* value);\ntypedef const char* (*GetValueFunc)(const char* path);\ntypedef const ConfigNode* (*GetPropertysFunc)();\n\ntypedef struct  tagIProperty\n{\n    SetValueFunc     SetValue;\n    GetValueFunc     GetValue;\n    GetPropertysFunc GetPropertys;\n}IProperty;\n</code></pre>\n\n<p>Call in C:</p>\n\n<pre><code>property-&gt;SetValue(\"0/baud_rate\", \"1000000\")\n</code></pre>\n\n<p>I would be grateful if someone gave some advice.</p>\n"}, {"tags": ["c", "arrays", "function", "linear-search"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1574221659, "post_id": 58946266, "comment_id": 104150582, "body": "No. Bury your array in a structure and return that. You need one anyway so the caller can know how many (if any) results you found (i.e. <code>index</code> can also be a member of said structure)."}], "answers": [{"tags": [], "owner": {"reputation": 98, "user_id": 9984904, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WO4WDWnWAEU/AAAAAAAAAAI/AAAAAAAAAAc/JaD0Bw0uaOE/photo.jpg?sz=128", "display_name": "Thach Pham", "link": "https://stackoverflow.com/users/9984904/thach-pham"}, "is_accepted": false, "score": 1, "last_activity_date": 1574222092, "creation_date": 1574222092, "answer_id": 58946422, "question_id": 58946266, "link": "https://stackoverflow.com/questions/58946266/is-there-int-data-type-array-function/58946422#58946422", "title": "Is there int data type array function?", "body": "<p>We can wrap the array in a struct.</p>\n\n<pre><code>#define MAX_N 32\n\ntypedef struct{\n    int n;\n    int result[MAX_N];\n} Array;\n\nArray linearSearch(){\n    Array arr;\n    //do something\n    return arr;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 157, "user_id": 10454066, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-FwCqezw-Upk/AAAAAAAAAAI/AAAAAAAAATQ/U7qh5dxMsyk/photo.jpg?sz=128", "display_name": "Karthik Chennupati", "link": "https://stackoverflow.com/users/10454066/karthik-chennupati"}, "is_accepted": false, "score": 1, "last_activity_date": 1574229675, "creation_date": 1574229675, "answer_id": 58947693, "question_id": 58946266, "link": "https://stackoverflow.com/questions/58946266/is-there-int-data-type-array-function/58947693#58947693", "title": "Is there int data type array function?", "body": "<p>You declared <code>result</code> inside a function as a stack memory and you're returning its address. That address will not be valid after the function returns (The memory allocated for that function gets deallocated). Either declare it dynamically and return it's addresses or declare it in your calling function and pass it's address as argument to <code>linearSearch()</code> or you can even make it global just like you can for <code>search</code></p>\n"}, {"tags": [], "owner": {"reputation": 139, "user_id": 8512152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1691004664245639/picture?type=large", "display_name": "Cheang Wai Bin", "link": "https://stackoverflow.com/users/8512152/cheang-wai-bin"}, "is_accepted": false, "score": 0, "last_activity_date": 1574262002, "creation_date": 1574262002, "answer_id": 58957348, "question_id": 58946266, "link": "https://stackoverflow.com/questions/58946266/is-there-int-data-type-array-function/58957348#58957348", "title": "Is there int data type array function?", "body": "<p>Now I realised this is a very stupid question but short answer, no. What I did is i declared a global array variable and then I pass the value into the array. With that I can call back the value in the array.</p>\n\n<pre><code>int marks[5] = {90, 70, 90 ,50, 40};\nint search = 90;\n\n//global variable\nint result[5];\nint count = 0;\n\nvoid linearSearch(){\n   for(int i = 0; i &lt; 5; i++){\n      if(marks[i] == search){\n         result[count] = i;\n         index++;\n      }\n   }\n}\n</code></pre>\n\n<p>Now this should return <code>0</code> and <code>2</code> to the <code>result[0]</code> and <code>result[1]</code>. Just make sure to reset <code>count</code> to <code>0</code> later.</p>\n"}], "owner": {"reputation": 139, "user_id": 8512152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1691004664245639/picture?type=large", "display_name": "Cheang Wai Bin", "link": "https://stackoverflow.com/users/8512152/cheang-wai-bin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1574262002, "creation_date": 1574220913, "question_id": 58946266, "link": "https://stackoverflow.com/questions/58946266/is-there-int-data-type-array-function", "title": "Is there int data type array function?", "body": "<p>Is there actually array function in C? I actually wanted to return several integer value at one time. The code below is not valid obviously but it's just what I'm thinking about. Is there any other method to achieve this?</p>\n\n<pre><code>int marks[5] = {90, 90, 70 ,50, 40};\nint search = 90;\n\nint linearSearch(){\n  int result[5];\n  int index = 0;\n\n  for(int i = 0; i &lt; 5; i++){\n     if(marks[i] == search){\n        result[index] = i;\n        index++;\n     }\n\n  }\n  return result;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "multidimensional-array", "runtime", "benchmarking"], "comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1574260705, "post_id": 58946168, "comment_id": 104169255, "body": "Probably no; a 2D array is already contiguous in memory.  Although if the compiler doesn&#39;t &quot;see through&quot; that and is making nested loops, manually doing 2D indexing might help a bit if you&#39;re not memory-bound."}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 8244253, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7NLe6.jpg?s=128&g=1", "display_name": "Hussien Mostafa", "link": "https://stackoverflow.com/users/8244253/hussien-mostafa"}, "edited": false, "score": 0, "creation_date": 1574259945, "post_id": 58956600, "comment_id": 104168802, "body": "I think i wrote some thing wrong so i wrote it again"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1574260647, "post_id": 58956600, "comment_id": 104169215, "body": "Next time <a href=\"https://stackoverflow.com/posts/58956600/edit\">edit</a> your answer instead of deleting and reposting to correct mistakes."}, {"owner": {"reputation": 63, "user_id": 8244253, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7NLe6.jpg?s=128&g=1", "display_name": "Hussien Mostafa", "link": "https://stackoverflow.com/users/8244253/hussien-mostafa"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1576267352, "post_id": 58956600, "comment_id": 104857554, "body": "does my answer has problems or wrong information ? if anyone from the 32 person saw the question can tell me I&#39;ll be thankful  ..as there is no upvotes and not certified as answer I fear I wrote some thing  wrong ....please  correct  if some thing wrong"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1576267695, "post_id": 58956600, "comment_id": 104857695, "body": "Your code doesn&#39;t prove anything about performance, and since you&#39;re using <code>i</code> explicitly in the outer loop a compiler <i>can&#39;t</i> just optimize it away and flatten the loop for you.  Unless that happens, the addressing calculation for <code>Arr[i][j]</code> is more complicated if the compiler didn&#39;t just optimize it down to a pointer increment.  Number of C steps is a pretty poor approximation for real performance cost in asm running on a modern out-of-order CPU, especially one that supports SIMD so the compiler can auto-vectorize. It&#39;s not bad, but the question is asking about that difference specifically."}, {"owner": {"reputation": 63, "user_id": 8244253, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7NLe6.jpg?s=128&g=1", "display_name": "Hussien Mostafa", "link": "https://stackoverflow.com/users/8244253/hussien-mostafa"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1576268411, "post_id": 58956600, "comment_id": 104857956, "body": "that what he wrote  .... i think he just thought every nested loop is bad thing but he is wrong     &quot;&quot;&quot;&quot;. So, there are nested loops involved to calculate such attributes. Would converting the 2D array into 1D array give me a boost in performance in this case?....&quot;&quot;&quot;&quot;"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1576268626, "post_id": 58956600, "comment_id": 104858042, "body": "O(n) complexity isn&#39;t the question, it&#39;s the issue of constant factors in performance with a real compiler making code for a real CPU.  If a 2D loop defeats auto-vectorization, you could see a 4x slowdown.  That&#39;s unlikely but plausible, depending on the code and compiler.  Most of the time yes, there probably won&#39;t be a measurable perf difference, but your question doesn&#39;t prove that beyond both being O(n) theoretical time complexity."}], "tags": [], "owner": {"reputation": 63, "user_id": 8244253, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7NLe6.jpg?s=128&g=1", "display_name": "Hussien Mostafa", "link": "https://stackoverflow.com/users/8244253/hussien-mostafa"}, "is_accepted": false, "score": 0, "last_activity_date": 1576268335, "last_edit_date": 1576268335, "creation_date": 1574259872, "answer_id": 58956600, "question_id": 58946168, "link": "https://stackoverflow.com/questions/58946168/working-with-a-2d-array-vs-flatting-it-to-reduce-runtime-in-c/58956600#58956600", "title": "working with a 2D array vs flatting it to reduce runtime in C", "body": "<p>If you put your code that can make the answers more correct .....</p>\n\n<p><strong>as you asking about using nested  loops or not</strong> </p>\n\n<p>What I think that there is no difference  it takes same number of steps to print all elements in the array even if it is 1D or 2D (the same for computing mean)</p>\n\n<p>2D maybe better for some cases if your data is organized in way each group of elements in <strong>Ith</strong>  row and you want to  do certain operation on elements in this row only </p>\n\n<p>the nested loop has the same amount of steps as the normal loop (the only extra thing that you using extra variable <strong>j</strong> instead of i only ....this may make the program take extra memory for <strong>j</strong>  I think it's not big deal as these days the processors are faster and RAMs are bigger and won't affect performance that way you think if you need the array to have rows and colmuns   )</p>\n\n<pre><code>#define ROWS 3\n#define COLS  3\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void) {\n    int Arr[ROWS][COLS] = { { 10, 20, 30 }, { 40, 50, 60 }, { 70, 80, 90 } };\n    int Arr2[] = { 10, 20, 30, 60, 50, 40, 90, 80, 70 };\n    int counter1D, counter2D;\n    counter1D = counter2D = 0; //for storing number of iterations\n    puts(\"2D Way\");\n    for (int i = 0; i &lt; ROWS; i++) {\n        printf(\"print :the %d ROW\\n\", i);\n        for (int j = 0; j &lt; COLS; j++) {\n            printf(\"%d\\n\", Arr[i][j]);\n            counter2D++;\n        }\n    }\n    //print all elements in array\n    //1D way :\n    puts(\"1D way\");\n\n    for (int i = 0; i &lt; ROWS * COLS; i++) {\n        printf(\"print the %d element  %d\\n\", i, Arr2[i]);\n        counter1D++;\n    }\n    printf(\"2D counter  %d   1D counter   %d \", counter2D, counter1D);\n    return 0;\n}\n</code></pre>\n\n<p>this was a sample to prove that they take same steps ... the both counters for computing loop steps has the same values </p>\n\n<p><strong>if you  put your code we may reach to better thoughts ....</strong></p>\n"}], "owner": {"reputation": 21, "user_id": 5895675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66c79028824c70973c6ecb2d6092a64f?s=128&d=identicon&r=PG&f=1", "display_name": "dewren99", "link": "https://stackoverflow.com/users/5895675/dewren99"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1576268335, "creation_date": 1574220357, "question_id": 58946168, "link": "https://stackoverflow.com/questions/58946168/working-with-a-2d-array-vs-flatting-it-to-reduce-runtime-in-c", "title": "working with a 2D array vs flatting it to reduce runtime in C", "body": "<p>I am dealing with a single 2D array and my goal is to reduce the runtime of my function(written in C) as much as possible. I'm doing statistical calculations on the 2D array such as finding the average and minimum value. So, there are nested loops involved to calculate such attributes. Would converting the 2D array into 1D array give me a boost in performance in this case?</p>\n"}, {"tags": ["c", "cs50", "greedy"], "comments": [{"owner": {"reputation": 1082, "user_id": 9091276, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/05cFn.png?s=128&g=1", "display_name": "Frontear", "link": "https://stackoverflow.com/users/9091276/frontear"}, "edited": false, "score": 0, "creation_date": 1574220084, "post_id": 58946058, "comment_id": 104150242, "body": "Look at where you&#39;ve written your <code>return n;</code>. How do you expect anything past that to even run?"}, {"owner": {"reputation": 3, "user_id": 7697626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa8996284feec5fe54af0f1c9c57de47?s=128&d=identicon&r=PG&f=1", "display_name": "Zaed", "link": "https://stackoverflow.com/users/7697626/zaed"}, "edited": false, "score": 1, "creation_date": 1574220456, "post_id": 58946058, "comment_id": 104150317, "body": "Corrected the tag. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 200780, "user_id": 116908, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54d38793d7a407446999b33b81d607fd?s=128&d=identicon&r=PG", "display_name": "Carl Norum", "link": "https://stackoverflow.com/users/116908/carl-norum"}, "is_accepted": true, "score": 1, "last_activity_date": 1574219745, "creation_date": 1574219745, "answer_id": 58946085, "question_id": 58946058, "link": "https://stackoverflow.com/questions/58946058/do-while-loop-is-working-but-not-getting-final-output/58946085#58946085", "title": "Do-While loop is working but not getting final output", "body": "<p>Your <code>return</code> statement is above the output <code>printf</code> statement in your program. That means the last half of <code>get_defined_float</code> is dead code - it is never run.</p>\n\n<p>It seems like you probably want to take that dead code and move it into your <code>main</code> routine, subsituting <code>f</code> for <code>n</code> in the <code>int input = round(n * 100);</code> statement.</p>\n\n<p>You may also need to add a newline (<code>\\n</code>) to that output statement in order to flush the output buffer (normally line buffered for TTYs).</p>\n\n<p>Turn on some compiler warnings!</p>\n"}], "owner": {"reputation": 3, "user_id": 7697626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa8996284feec5fe54af0f1c9c57de47?s=128&d=identicon&r=PG&f=1", "display_name": "Zaed", "link": "https://stackoverflow.com/users/7697626/zaed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 1, "accepted_answer_id": 58946085, "answer_count": 1, "score": 0, "last_activity_date": 1574220414, "creation_date": 1574219533, "last_edit_date": 1574220414, "question_id": 58946058, "link": "https://stackoverflow.com/questions/58946058/do-while-loop-is-working-but-not-getting-final-output", "title": "Do-While loop is working but not getting final output", "body": "<p>The purpose of this code is to ask for the change required and then output the smallest number of coins that can be used to provide that change.</p>\n\n<p>Not sure why my code is not outputting anything?</p>\n\n<pre><code>#include &lt;cs50.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\nfloat get_defined_float(string prompt);\n\nint main(void)\n\n{\n    float f = get_defined_float(\"Required Change: \");\n}\n\nfloat get_defined_float(string prompt)\n{\n    float n;\n        do\n        {\n            n = get_float(\"Required Change: \");\n        }\n    while (n&lt;=0);\n    return n;\n\n\n\n\n    int input = round(n * 100);\n    int quarters = input / 25;\n    int dimes = (input % 25) / 10;\n    int nickles = (input % 25 % 10) / 5;\n    int pennies = (input % 5) / 1;\n\n\n    int total = quarters + dimes + nickles + pennies;\n    printf(\"%d\", total);\n}\n</code></pre>\n"}, {"tags": ["c", "gtk3", "glade"], "comments": [{"owner": {"reputation": 1896, "user_id": 4226702, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-siukF5ObSUs/AAAAAAAAAAI/AAAAAAAAAEc/Qww5nEqBNDw/photo.jpg?sz=128", "display_name": "Alexander Dmitriev", "link": "https://stackoverflow.com/users/4226702/alexander-dmitriev"}, "edited": false, "score": 1, "creation_date": 1574403773, "post_id": 58945760, "comment_id": 104228741, "body": "<a href=\"https://developer.gnome.org/gdk3/stable/gdk3-Event-Structures.html#GdkEventKey\" rel=\"nofollow noreferrer\">GdkEventKey</a> <code>keyval</code> field"}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1576191270, "post_id": 58945760, "comment_id": 104829491, "body": "<a href=\"https://m.youtube.com/playlist?list=PLN_MPJUQgPVpkVVSJ8qrzk65FHnUtO6BF\" rel=\"nofollow noreferrer\">Here you find almost everything you need to know about signals and events</a>"}], "answers": [{"comments": [{"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1574447238, "post_id": 58996431, "comment_id": 104249982, "body": "I would not do the check using the string description of the key when you could just compare the integer values instead."}], "tags": [], "owner": {"reputation": 694, "user_id": 8627962, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4f-Yq3BvCaA/AAAAAAAAAAI/AAAAAAAAARM/NeJoNAwQHT0/photo.jpg?sz=128", "display_name": "Siva Guru", "link": "https://stackoverflow.com/users/8627962/siva-guru"}, "is_accepted": false, "score": 1, "last_activity_date": 1574433344, "creation_date": 1574433344, "answer_id": 58996431, "question_id": 58945760, "link": "https://stackoverflow.com/questions/58945760/how-do-i-check-for-the-key-pressed-in-gtk3-c/58996431#58996431", "title": "How do I Check for the Key Pressed in GTK3 (C)?", "body": "<p>the callback function for keypress is </p>\n\n<p>on_key_press(GtkWidget *widget, GdkEventKey *key, gpointer user_data)</p>\n\n<p>GdkEventKey structure is defined here (<a href=\"https://developer.gnome.org/gdk3/stable/gdk3-Event-Structures.html#GdkEventKey\" rel=\"nofollow noreferrer\">https://developer.gnome.org/gdk3/stable/gdk3-Event-Structures.html#GdkEventKey</a>) \nand keyval returns the value of the key pressed you can compare it like this.</p>\n\n<p>strcmp(gdk_keyval_name(key->keyval), \"Return\") == 0</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user12211554"}, "is_accepted": false, "score": 0, "last_activity_date": 1574445224, "creation_date": 1574445224, "answer_id": 58999414, "question_id": 58945760, "link": "https://stackoverflow.com/questions/58945760/how-do-i-check-for-the-key-pressed-in-gtk3-c/58999414#58999414", "title": "How do I Check for the Key Pressed in GTK3 (C)?", "body": "<p>I think this should help you</p>\n\n<pre><code>void on_window_main_key_press_event(GtkWidget *widget, GdkEventKey *key, gpointer user_data) {\n    int TheKeyThatWasPressed = key-&gt;keyval; //Incase you need to find out what key got pressed\n}\n</code></pre>\n\n<p>Then use this in your main function:</p>\n\n<pre><code>g_signal_connect(Window, \"key-press-event\", G_CALLBACK(KeyPressHandler), NULL); \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6874, "user_id": 2279422, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eRTZC.jpg?s=128&g=1", "display_name": "Waqar", "link": "https://stackoverflow.com/users/2279422/waqar"}, "is_accepted": false, "score": 1, "last_activity_date": 1574447975, "last_edit_date": 1574447975, "creation_date": 1574447205, "answer_id": 58999833, "question_id": 58945760, "link": "https://stackoverflow.com/questions/58945760/how-do-i-check-for-the-key-pressed-in-gtk3-c/58999833#58999833", "title": "How do I Check for the Key Pressed in GTK3 (C)?", "body": "<p>You have to use <code>GdkEventKey</code> to handle key press events.</p>\n\n<p>The struct looks like this:</p>\n\n<pre><code>struct GdkEventKey {\n  GdkEventType type;  // is it a key-press or key release event\n  GdkWindow *window; // the window receiving the event\n  gint8 send_event;  // whether the event was sent explicitly. It's TRUE in that case\n  guint32 time;    //time of event in ms\n  guint state;     //a bit mask representing state of (Ctrl/Alt/Shift)\n  guint keyval;   // the key that was pressed\n  gint length;    // length of string\n  gchar *string;   //the string that may result from this kepress\n  guint16 hardware_keycode; //hardware key code\n  guint8 group; // keyboard group\n  guint is_modifier : 1;  //whether the key is mapped as modifier\n};\n</code></pre>\n\n<p>You can find the values of all key presses in this file: <a href=\"https://gitlab.gnome.org/GNOME/gtk/raw/master/gdk/gdkkeysyms.h\" rel=\"nofollow noreferrer\">gdkkeysyms.h</a></p>\n\n<h3>Here's a simple example:</h3>\n\n<pre><code>#include &lt;gtk/gtk.h&gt;\n#include &lt;gdk/gdkkeysyms.h&gt;\n\ngboolean\non_window_main_key_press_event (GtkWidget *widget, GdkEventKey *event, gpointer user_data);\n\nint main (int argc, char *argv[])\n{\n  GtkWidget *window;\n\n  gtk_init (&amp;argc, &amp;argv);\n\n  window = gtk_window_new (GTK_WINDOW_TOPLEVEL);\n\n  g_signal_connect (G_OBJECT (window), \"key_press_event\", G_CALLBACK (on_window_main_key_press_event), NULL);\n\n  gtk_widget_show_all (window);\n\n  gtk_main ();\n\n  return 0;\n}\n\ngboolean\non_key_press (GtkWidget *widget, GdkEventKey *event, gpointer user_data)\n{\n  switch (event-&gt;keyval)\n  {\n    case GDK_Z:\n    case GDK_z:\n      printf(\"key pressed: %s\\n\", \"Z\");\n      break;\n    case GDK_S\n    case GDK_s:\n      if (event-&gt;state &amp; GDK_SHIFT_MASK)\n      {\n        printf(\"key pressed: %s\\n\", \"shift + s\");\n      }\n      else if (event-&gt;state &amp; GDK_CONTROL_MASK)\n      {\n        printf(\"key pressed: %s\\n\", \"ctrl + s\");\n      }\n      else\n      {\n        printf(\"key pressed: %s\\n\", \"s\");\n      }\n      break;\n    default:\n      return FALSE; \n  }\n  return FALSE; \n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12401208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce68cd3fa54e2abc70a8d01dcf20faaf?s=128&d=identicon&r=PG&f=1", "display_name": "Nico Angelo Dela Cruz", "link": "https://stackoverflow.com/users/12401208/nico-angelo-dela-cruz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 580, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1574447975, "creation_date": 1574217192, "question_id": 58945760, "link": "https://stackoverflow.com/questions/58945760/how-do-i-check-for-the-key-pressed-in-gtk3-c", "title": "How do I Check for the Key Pressed in GTK3 (C)?", "body": "<p>We're trying to filter keys in the key press event in C using glade. But we can't figure out how to filter those keys. Here is the code:</p>\n\n<pre><code> // called when key pressed\nvoid on_window_main_key_press_event()\n{\n\n}\n</code></pre>\n"}, {"tags": ["c", "formatting", "coding-style", "astyle"], "owner": {"reputation": 21, "user_id": 12401097, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AsMiqXfPa4s/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdsipmqpLOZGmXHjZGsNyLYkYTQkw/photo.jpg?sz=128", "display_name": "Alex Alex", "link": "https://stackoverflow.com/users/12401097/alex-alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1574264550, "creation_date": 1574215394, "last_edit_date": 1574264550, "question_id": 58945556, "link": "https://stackoverflow.com/questions/58945556/how-to-tell-astyle-to-do-nothing", "title": "How to tell astyle to do nothing?", "body": "<p>I want to apply only one formatting rule from pletora of astyle capabilities - and nothing else.</p>\n\n<p>However, I find it impossible to turn off all astyle options - no matter what, I end up with aweful lot of undesired formatting changes.</p>\n\n<p>How to tell astyle to apply just a single formatting rule? Or, to apply no formatting rule, after which I would just enable my single desired rule?</p>\n"}, {"tags": ["c", "while-loop", "char", "scanf"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1574215637, "post_id": 58945493, "comment_id": 104149396, "body": "<code>scanf(&quot;%c\\n&quot;,&amp;q);</code> ---&gt; <code>scanf(&quot; %c&quot;,&amp;q);</code>"}, {"owner": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "edited": false, "score": 0, "creation_date": 1574215669, "post_id": 58945493, "comment_id": 104149399, "body": "i suggest you put the <code>printf</code> statement after your scanf to see what you read. Also, add <code>fflush(stdout)</code> after every printf, to flush buffers"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1574215827, "post_id": 58945493, "comment_id": 104149429, "body": "Hmmm certainly a dupe - but so many to choose form, hard to find a good enough one.."}], "answers": [{"tags": [], "owner": {"reputation": 56, "user_id": 12387785, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDyqGAY7oaqj0oyvAtZiO37fCuNPuS0CxzsD5qJxwY=k-s128", "display_name": "owl", "link": "https://stackoverflow.com/users/12387785/owl"}, "is_accepted": true, "score": 0, "last_activity_date": 1574229855, "creation_date": 1574229855, "answer_id": 58947736, "question_id": 58945493, "link": "https://stackoverflow.com/questions/58945493/program-doesnt-read-the-last-character-in-a-loop/58947736#58947736", "title": "Program doesn&#39;t read the last character in a loop", "body": "<p>As mentioned by chux, replace your </p>\n\n<pre><code>scanf(\"%c\\n\",&amp;q); \n</code></pre>\n\n<p>to</p>\n\n<pre><code> scanf(\" %c\",&amp;q);\n</code></pre>\n\n<p><strong>Why?</strong></p>\n\n<p>When user gives the number of letters is something like \"<strong>4\\n</strong>\" , this <strong>'\\n'</strong> is taken as your first letter by your second Scanf     <em>scanf(\"%c\\n\",&amp;q);</em> </p>\n\n<pre><code>printf(\"Enter the number of letters: \");\nscanf(\"%d\",&amp;n); //user input is e.g \"4\\n\"\n</code></pre>\n\n<p>Second scanf</p>\n\n<pre><code> printf(\"Type letter no %d: \",i);\n    scanf(\"%c\\n\",&amp;q); //Here q takes the value q = '\\n' \n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/questions/38039634/does-scanf-function-ignore-the-enter-key-when-looking-for-d-match\">some useful info here</a></p>\n"}], "owner": {"reputation": 3, "user_id": 12401017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3348dde84908dee6e5c7088a57bb4ae?s=128&d=identicon&r=PG&f=1", "display_name": "zoblek", "link": "https://stackoverflow.com/users/12401017/zoblek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 58947736, "answer_count": 1, "score": 0, "last_activity_date": 1574229855, "creation_date": 1574214782, "question_id": 58945493, "link": "https://stackoverflow.com/questions/58945493/program-doesnt-read-the-last-character-in-a-loop", "title": "Program doesn&#39;t read the last character in a loop", "body": "<p>So I have a program where you input number 'n', and then you input n number of characters. The program tests if you can form a word 'Nice' with those characters.\nThe problem was that whenever I type a character and press enter, the program reads that enter as a character too, so I guess i kinda solved it (?) like this:</p>\n\n<pre><code>    scanf(\"%c\\n\")\n</code></pre>\n\n<p>First of all this seems like a not so good solution even to me (I am pretty much new in this).\nAnother thing is, when i input a number 4, and input letters 'N' 'i' 'c' and 'e', it won't read that last letter 'e' so the program basically doesn't work so well.\nI hope someone has an explanation for this, and I hope someone could help me. I am sorry if this is a stupid question.</p>\n\n<p>Here is the whole code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\nint main(){\n\nint n,i,a,b,c,d;\nchar q;\n\nprintf(\"Enter the number of letters: \");\nscanf(\"%d\",&amp;n);\n\ni=1;\na=0;\nb=0;\nc=0;\nd=0;\n\nwhile(i&lt;=n){\n\n    printf(\"Type letter no %d: \",i);\n    scanf(\"%c\\n\",&amp;q);\n\n    if(q=='N')\n        a++;\n\n    if(q=='i')\n        b++;\n\n    if(q=='c')\n        c++;\n\n    if(q=='e')\n        d++;\n\ni++;\n}\n\nif(a&gt;0 &amp;&amp; b&gt;0 &amp;&amp; c&gt;0 &amp;&amp; d&gt;0)\n    printf(\"Nice.\");\n\n    else\n        printf(\"Not nice.\");\n\n}\n</code></pre>\n"}, {"tags": ["c", "validation"], "comments": [{"owner": {"reputation": 139, "user_id": 8512152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1691004664245639/picture?type=large", "display_name": "Cheang Wai Bin", "link": "https://stackoverflow.com/users/8512152/cheang-wai-bin"}, "edited": false, "score": 0, "creation_date": 1574214864, "post_id": 58945427, "comment_id": 104149234, "body": "I realized that the problem is with the new line after the scanf. If i just write in 3 <code>getchar()</code> after the <code>scanf</code> it works fine, but I believe there should be a proper or better way to do it?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1574214990, "post_id": 58945427, "comment_id": 104149259, "body": "<code>getchar()</code> only consumes one character, you should use a loop to continue consuming characters until you have consumed the newline (or EOF). <a href=\"http://c-faq.com/stdio/stdinflush2.html\" rel=\"nofollow noreferrer\">c-faq.com/stdio/stdinflush2.html</a>"}], "answers": [{"tags": [], "owner": {"reputation": 224, "user_id": 6428439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DQjKp.jpg?s=128&g=1", "display_name": "Lyon", "link": "https://stackoverflow.com/users/6428439/lyon"}, "is_accepted": false, "score": 0, "last_activity_date": 1574216048, "creation_date": 1574216048, "answer_id": 58945636, "question_id": 58945427, "link": "https://stackoverflow.com/questions/58945427/how-to-validate-the-input-type-to-receive-integer-only/58945636#58945636", "title": "How to validate the input type to receive integer only?", "body": "<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) {\nint num;\nchar c;\nprintf(\"What is the ID?\\n&gt;&gt; \");\n    while(!scanf(\"%d\", &amp;num)){\n        // consume new line\n        gets(&amp;c);\n        printf(\"\\nInvalid ID please try again...\\n\\n\");\n        printf(\"What is the ID?\\n&gt;&gt; \");\n    }\nreturn 0;\n}\n</code></pre>\n\n<p>By adding a gets() you can take in the new line and remove the issue. </p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 1, "last_activity_date": 1574216155, "creation_date": 1574216155, "answer_id": 58945651, "question_id": 58945427, "link": "https://stackoverflow.com/questions/58945427/how-to-validate-the-input-type-to-receive-integer-only/58945651#58945651", "title": "How to validate the input type to receive integer only?", "body": "<p>Code needs to consume the non-numeric line of input.</p>\n\n<p>Various ways to read the <em>rest of the line</em></p>\n\n<pre><code>int ch;\nwhile ((ch = getchar()) != '\\n' &amp;&amp; ch != EOF) {\n  ;\n}\n</code></pre>\n\n<p>Or </p>\n\n<pre><code>scanf(\"%*[^\\n]\");  // read all non- \\n\nscanf(\"%*1[\\n]\");  // read 1 \\n\n</code></pre>\n\n<hr>\n\n<p>Avoid below.  Fails to read anything when the next character is a <code>'\\n'</code>.</p>\n\n<pre><code>scanf(\"%*[^\\n]%*c\");\n</code></pre>\n"}], "owner": {"reputation": 139, "user_id": 8512152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1691004664245639/picture?type=large", "display_name": "Cheang Wai Bin", "link": "https://stackoverflow.com/users/8512152/cheang-wai-bin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 58945651, "answer_count": 2, "score": 0, "last_activity_date": 1574216155, "creation_date": 1574214328, "question_id": 58945427, "link": "https://stackoverflow.com/questions/58945427/how-to-validate-the-input-type-to-receive-integer-only", "title": "How to validate the input type to receive integer only?", "body": "<p>I only want to receive integer from the user and I tried doing as the code below but it doesn't seems to be quite right.</p>\n\n<pre><code>int num;\n\nprintf(\"What is the ID?\\n&gt;&gt; \");\n        while(!scanf(\"%d\", &amp;num)){\n            // consume new line\n            getchar();\n            printf(\"\\nInvalid ID please try again...\\n\\n\");\n            printf(\"What is the ID?\\n&gt;&gt; \");\n        }\n</code></pre>\n\n<p>If I only input <code>a</code> into the <code>scanf</code>, it works fine, but when I input <code>ab</code> into the <code>scanf</code>, it loops 2 times and if i input 3 alphabet it will loops 3 times. Why is it?</p>\n\n<pre><code>What is the ID?\n&gt;&gt; a\n\nInvalid ID please try again...\n\nWhat is the ID?\n&gt;&gt; abc\n\nInvalid ID please try again...\n\nWhat is the ID?\n&gt;&gt;\nInvalid ID please try again...\n\nWhat is the ID?\n&gt;&gt;\nInvalid ID please try again...\n\nWhat is the ID?\n&gt;&gt;\n</code></pre>\n"}, {"tags": ["c", "arrays", "string"], "comments": [{"owner": {"reputation": 363, "user_id": 12107182, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Rf3FT.jpg?s=128&g=1", "display_name": "ValeriF21", "link": "https://stackoverflow.com/users/12107182/valerif21"}, "edited": false, "score": 1, "creation_date": 1574214817, "post_id": 58945383, "comment_id": 104149225, "body": "First the function is isdigit() and second you need to write only the character you want to check in the braces, isdigit(phoneNum[i]) == 0.."}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1574214951, "post_id": 58945383, "comment_id": 104149249, "body": "<code>if (isdigits(phoneNum[i] == 0)) {</code> is comparing <code>phoneNum[i]</code> to zero, then checking whether the result of the comparison, which will be 1 or 0, is a digit character... which it never will be.  You probably want <code>if (isdigit(phoneNum[i]) == 0) {</code> instead."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12400994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71c3fd18623a4505ef2272c6b04545b6?s=128&d=identicon&r=PG&f=1", "display_name": "AKidNamedCoder", "link": "https://stackoverflow.com/users/12400994/akidnamedcoder"}, "edited": false, "score": 0, "creation_date": 1574214744, "post_id": 58945457, "comment_id": 104149214, "body": "That was a typo, still doesnt work if I fix it. I&#39;m wondering now if there is a way to validate that an array only has numbers without using that function."}], "tags": [], "owner": {"reputation": 2804, "user_id": 11652943, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qw3Ef.png?s=128&g=1", "display_name": "AbdelAziz AbdelLatef", "link": "https://stackoverflow.com/users/11652943/abdelaziz-abdellatef"}, "is_accepted": false, "score": 0, "last_activity_date": 1574214501, "creation_date": 1574214501, "answer_id": 58945457, "question_id": 58945383, "link": "https://stackoverflow.com/questions/58945383/how-to-allow-only-digits-to-be-entered-in-an-array/58945457#58945457", "title": "How to allow only digits to be entered in an array?", "body": "<p>I think the function you need is <a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_isdigit.htm\" rel=\"nofollow noreferrer\"><code>isdigit()</code></a>, not <code>isdigits()</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 45, "user_id": 11099804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ea35baf0b558ab7e820fbda5b2e356e?s=128&d=identicon&r=PG&f=1", "display_name": "cmhacker", "link": "https://stackoverflow.com/users/11099804/cmhacker"}, "is_accepted": false, "score": 0, "last_activity_date": 1574214781, "creation_date": 1574214781, "answer_id": 58945492, "question_id": 58945383, "link": "https://stackoverflow.com/questions/58945383/how-to-allow-only-digits-to-be-entered-in-an-array/58945492#58945492", "title": "How to allow only digits to be entered in an array?", "body": "<p>You should use <code>scanf(\"%10s\", phoneNum);</code> and also include <code>#include &lt;stdlib.h&gt;</code> which contains <code>isdigit()</code> method.</p>\n"}, {"tags": [], "owner": {"reputation": 56, "user_id": 6844146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a79cebd7c697458fce7ebe7ba44f1eb?s=128&d=identicon&r=PG&f=1", "display_name": "hess", "link": "https://stackoverflow.com/users/6844146/hess"}, "is_accepted": false, "score": 0, "last_activity_date": 1574214849, "creation_date": 1574214849, "answer_id": 58945499, "question_id": 58945383, "link": "https://stackoverflow.com/questions/58945383/how-to-allow-only-digits-to-be-entered-in-an-array/58945499#58945499", "title": "How to allow only digits to be entered in an array?", "body": "<p>As AbdelAziz stated, you should use is <a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_isdigit.htm\" rel=\"nofollow noreferrer\">isdigit()</a>, not <code>isdigits()</code>.\nAlso, your if statement is wrong:</p>\n\n<pre><code>if (isdigits(phoneNum[i] == 0))\n</code></pre>\n\n<p>should be:</p>\n\n<pre><code>if (isdigit(phoneNum[i]) == 0)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1574217644, "last_edit_date": 1574217644, "creation_date": 1574217284, "answer_id": 58945776, "question_id": 58945383, "link": "https://stackoverflow.com/questions/58945383/how-to-allow-only-digits-to-be-entered-in-an-array/58945776#58945776", "title": "How to allow only digits to be entered in an array?", "body": "<p><code>scanf_s(\"%10s\", phoneNum);</code> fails as it is missing an argument. Review your <code>scanf_s()</code> documentation.</p>\n\n<hr>\n\n<p>I do not recommend <code>scanf_s()</code>.  Instead avoid mixing user I/O with input validation.  Get the input, then validate it.</p>\n\n<pre><code>   char buf[80]; // Be generous.\n   if (fgets(buf, sizeof buf, stdin)) {\n     buf[strcspn(buf, \"\\n\")] = '\\0'; // Lop off potential \\n\n     // OK we have the input, now validate.\n\n     char phoneNum[11];\n     int n = 0;\n     // Use sscanf, isdigit, or ...\n     if (sscanf(buf, \"%10[0-9]\", phoneNum, &amp;n) == 1 &amp;&amp; n == 10 &amp;&amp; buf[n]==0) {\n       puts(\"Success\");\n     } else {\n       printf(\"Bad input &lt;%s&gt;\\n\", buf);\n     }\n</code></pre>\n\n<hr>\n\n<p><code>\"%10[0-9]%n\", phoneNum, &amp;n</code> --> Scan 1 to 10 digits into <code>phoneNum[]</code> and append a <code>'\\0'</code>.  Save scanning offset into <code>n</code></p>\n"}], "owner": {"reputation": 3, "user_id": 12400994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71c3fd18623a4505ef2272c6b04545b6?s=128&d=identicon&r=PG&f=1", "display_name": "AKidNamedCoder", "link": "https://stackoverflow.com/users/12400994/akidnamedcoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1574217644, "creation_date": 1574213884, "last_edit_date": 1574214357, "question_id": 58945383, "link": "https://stackoverflow.com/questions/58945383/how-to-allow-only-digits-to-be-entered-in-an-array", "title": "How to allow only digits to be entered in an array?", "body": "<p>So I am trying to write a program that receives a 10 digit phone number from the user.\nIt must only be 10 characters long.\nIt can only consist of digits. Entering a alphabet character or special character will give an error message. \nI have tried using the <code>isdigits()</code> function but that doesn't seem to work. \nHere is my code so far. </p>\n\n<p>Is there any other way to do this without using <code>isdigits()</code>?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\nvoid clearKeyboard(void);\n\nint main (void)\n{\n    char phoneNum[11];\n    int needInput = 1;\n    int i;\n    int flagBad = 0;\n    while (needInput == 1) {\n        scanf_s(\"%10s\", phoneNum);\n        clearKeyboard();\n        // (String Length Function: validate entry of 10 characters)\n        if (strlen(phoneNum) == 10) {\n            needInput = 0;\n            for (i = 0; i &lt; 10; i++) {\n                if (isdigits(phoneNum[i] == 0)) {\n                    flagBad = 1;\n                }\n            }\n            if (flagBad == 1) {\n                needInput = 1;\n                printf(\"Enter a 10-digit phone number: \");\n            }\n        }\n        else needInput == 0;    \n    }\n    printf(\"Successful\");\n    return 0;\n}\n\nvoid clearKeyboard(void)\n{\n    while (getchar() != '\\n'); // empty execution code block on purpose\n}\n\n</code></pre>\n"}, {"tags": ["c++", "c", "arrays"], "comments": [{"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 1, "creation_date": 1574213924, "post_id": 58945378, "comment_id": 104149042, "body": "The left hand side of an assignment must be a variable.  Try using array notation to access the character you want, instead of attempting pointer arithmetic."}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1574214164, "post_id": 58945378, "comment_id": 104149089, "body": "&quot;s1+i&quot; will evaluate to true until this expression evaluates to 0. Once you fix this compilation error, unless you fix this too, on a modern, 64 bit platform, this <code>for</code> loop will execute on average 9223372036854775808 times (by my calculations) which will take, ...a little while. Fortunately, it is going to crash much sooner than that. You need to explain precisely what you expect this function do, in order for anyone to help you with this problem, too."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1574214223, "post_id": 58945378, "comment_id": 104149104, "body": "maybe you forgot to fix the loop condition"}, {"owner": {"reputation": 1, "user_id": 12400989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jofhn.png?s=128&g=1", "display_name": "miltongoldman", "link": "https://stackoverflow.com/users/12400989/miltongoldman"}, "edited": false, "score": 0, "creation_date": 1574227581, "post_id": 58945378, "comment_id": 104152001, "body": "Robert- thank you for your comment. I already did do this exercise using array notation. I just wanted to challenge myself using pointers."}, {"owner": {"reputation": 1, "user_id": 12400989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jofhn.png?s=128&g=1", "display_name": "miltongoldman", "link": "https://stackoverflow.com/users/12400989/miltongoldman"}, "edited": false, "score": 0, "creation_date": 1574227625, "post_id": 58945378, "comment_id": 104152010, "body": "Sam- thank you for your comment. Wow, what a big number. You are correct on this loop. I thought by looping it through s1, which is only 20 elements, the loop exits when it gets to the newline character at the end of the array, but I realized that is not zero. Thank you. Also, I explained what I want the code to do in the comments I left on the right of the code, most notably:                                                     puts(s1);   //I want this to print Bye after function has run"}, {"owner": {"reputation": 1, "user_id": 12400989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jofhn.png?s=128&g=1", "display_name": "miltongoldman", "link": "https://stackoverflow.com/users/12400989/miltongoldman"}, "edited": false, "score": 0, "creation_date": 1574227720, "post_id": 58945378, "comment_id": 104152056, "body": "M.M- thank you for your comment. It wasn&#39;t the loop problem that was causing this."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12400989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jofhn.png?s=128&g=1", "display_name": "miltongoldman", "link": "https://stackoverflow.com/users/12400989/miltongoldman"}, "edited": false, "score": 0, "creation_date": 1574228442, "post_id": 58946292, "comment_id": 104152259, "body": "You are god. Thank you so much. This definitely worked."}], "tags": [], "owner": {"reputation": 729, "user_id": 5942006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fe054f41dc543395631acc84ac04f60?s=128&d=identicon&r=PG&f=1", "display_name": "systemcpro", "link": "https://stackoverflow.com/users/5942006/systemcpro"}, "is_accepted": false, "score": 0, "last_activity_date": 1574221121, "creation_date": 1574221121, "answer_id": 58946292, "question_id": 58945378, "link": "https://stackoverflow.com/questions/58945378/c-attempting-to-copy-pointer-values-into-another-pointer-getting-modifiable-lv/58946292#58946292", "title": "C: Attempting to copy pointer values into another pointer, getting modifiable lvalue error", "body": "<p>Something like this will get you started. Notice we have to dereference the char* in the copy. This assumes fixed length strings and so doesn't need to use malloc nor strlen functions from std library. Not ideal but something you can play with to get going.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n\n    char *mystrcopy(char* p, char* q);   //function prototype\n\n    #define LENGTH 20\n\n    int main(void){\n\n    char s1[LENGTH] = \"Hello\\n\";   \n    char s2[LENGTH] = \"Bye\\n\";\n\n    puts(s1);    //print Hello\n\n    mystrcopy(s1, s2);\n\n    puts(s1);   //I want this to print Bye after function has run\n\n   // system(\"pause\");   //\"press any key to continue....\"\n\n    return 0;\n}\n\nchar *mystrcopy(char* s1, char* s2)\n{\n    int i;\n    for (i = 0; i &lt; LENGTH; i++, ++s1, ++s2)    //for loop continues as long as s1+1 not 0\n    *s1 = *s2;   //error says s1 is not a modifiable lvalue\n\n    return s1;   //I know this could be a void function but I choose not to\n</code></pre>\n\n<p>}</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 12400989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jofhn.png?s=128&g=1", "display_name": "miltongoldman", "link": "https://stackoverflow.com/users/12400989/miltongoldman"}, "edited": false, "score": 0, "creation_date": 1574228025, "post_id": 58946321, "comment_id": 104152140, "body": "Wow, thank you for your thoughtful and patient comment. You are so nice! The biggest takeaway I got is:   <i>A major factor to note there is that it&#39;s not changing anything in the data being pointed to. It&#39;s only assigning the value of one pointer to another.</i>  This helped clarify this issue for me a lot. So even though I was changing the value of the pointer, if I went back and printed the s1 array itself, it wouldn&#39;t have done anything different if I didn&#39;t have the function at all. But what do you mean by <i>temporary</i> pointer? How was it temporary? Thank you very much."}, {"owner": {"reputation": 7700, "user_id": 126027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d083341daacfb4942b835e3f6f2fd804?s=128&d=identicon&r=PG", "display_name": "TheUndeadFish", "link": "https://stackoverflow.com/users/126027/theundeadfish"}, "reply_to_user": {"reputation": 1, "user_id": 12400989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jofhn.png?s=128&g=1", "display_name": "miltongoldman", "link": "https://stackoverflow.com/users/12400989/miltongoldman"}, "edited": false, "score": 0, "creation_date": 1574298087, "post_id": 58946321, "comment_id": 104186349, "body": "@miltongoldman Say we had a line of code <code>a = b + c;</code> The compiler first calculates <code>b + c</code> and then hangs onto the result in a temporary manner. Next it assigns that temporary value to <code>a</code>. So consequently if we had <code>x + y = z;</code> The compilers first figures out what <code>x + y</code> is, hangs onto that as a temporary, and then... well, the problem is that the line of code isn&#39;t assigning <code>z</code> to either <code>x</code> or <code>y</code> but instead to the temporary combination of them - which isn&#39;t something a developer should have intended to do in the first place."}], "tags": [], "owner": {"reputation": 7700, "user_id": 126027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d083341daacfb4942b835e3f6f2fd804?s=128&d=identicon&r=PG", "display_name": "TheUndeadFish", "link": "https://stackoverflow.com/users/126027/theundeadfish"}, "is_accepted": false, "score": 0, "last_activity_date": 1574221372, "creation_date": 1574221372, "answer_id": 58946321, "question_id": 58945378, "link": "https://stackoverflow.com/questions/58945378/c-attempting-to-copy-pointer-values-into-another-pointer-getting-modifiable-lv/58946321#58946321", "title": "C: Attempting to copy pointer values into another pointer, getting modifiable lvalue error", "body": "<p>Since <code>s1</code> is a pointer, then <code>s1 + 1</code> is also yields a pointer too (just a temporary one whose address has been moved.</p>\n\n<p>If we put some intermediary variables in place, then your loop is effectively going to be equivalent to:</p>\n\n<pre><code>for (i = 0; s1 + i; i++)\n{\n    char* t1 = s1 + i;\n    char* t2 = s2 + i;\n    t1 = t2;\n}\n</code></pre>\n\n<p>A major factor to note there is that it's not changing anything in the data being pointed to. It's only assigning the value of one pointer to another.</p>\n\n<p>Now when taking a look back at <code>s1 + 1 = anything</code>, that's trying to assign something to a temporary pointer (not to what the temporary pointer points to). So the compiler complains as a safeguard because trying to assign to a temporary is always a mistake.</p>\n\n<p>So knowing what you really wanted to do (and also noting that the loop condition of <code>s1 + 1</code> is not reading the value being pointed to, the code needs to be adjusted. For this type of situation, the array-like syntax allowed with pointers is much more convenient that trying to work in terms of incrementing the pointers themselves. Thus you would end up with something like:</p>\n\n<pre><code>for (i = 0; s1[i]; i++)\n{\n    s1[i] = s2[i];\n}\n</code></pre>\n\n<hr>\n\n<p>As a bonus consideration, your logic copies from <code>s2</code> to <code>s1</code> but the loop is conditional on <code>s1</code>. So what is going to happen if initial data in <code>s1</code> is shorter than what is in <code>s2</code>? Perhaps your loop condition should be in terms of <code>s2</code>.</p>\n\n<p>And a future consideration is what if the arrays pointed to be <code>s1</code> and <code>s2</code> aren't the same size. What kinds of problems can occur? Perhaps your function could take an additional parameter that specifies the maximum size of <code>s1</code>.</p>\n\n<p>A final consideration is these kinds of things are where <code>std::string</code> makes it easier and safer than doing it yourself with <code>char</code> arrays.</p>\n"}], "owner": {"reputation": 1, "user_id": 12400989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jofhn.png?s=128&g=1", "display_name": "miltongoldman", "link": "https://stackoverflow.com/users/12400989/miltongoldman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1574228621, "creation_date": 1574213810, "last_edit_date": 1574228621, "question_id": 58945378, "link": "https://stackoverflow.com/questions/58945378/c-attempting-to-copy-pointer-values-into-another-pointer-getting-modifiable-lv", "title": "C: Attempting to copy pointer values into another pointer, getting modifiable lvalue error", "body": "<p>I am learning C and am getting stuck. Basically I have 2 arrays declared and I want to copy all of the char values of one array into the other by using pointers. I am taking advantage of the fact that the array name is a pointer to its first element. Could someone please take a look and help? Thank you.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\nchar *mystrcopy(char*p, char*q);   //function prototype\n\nint main(void)\n{\n    char s1[20] = \"Hello\\n\";   \n    char s2[20] = \"Bye\\n\";\n\n    puts(s1);    //print Hello\n\n    mystrcopy(s1, s2);  //call function using pointers s1 and s2\n\n    puts(s1);   //I want this to print Bye after function has run\n\n    system(\"pause\");   //\"press any key to continue....\"\n\n    return 0;\n}\n\nchar *mystrcopy(char*s1, char*s2)\n{\n    int i;\n    for (i = 0; s1 + i; i++)    //for loop continues as long as s1+1 not 0\n        s1 + i = s2 + i;   //error says s1 is not a modifiable lvalue\n\n    return s1;   //I know this could be a void function but I choose not to\n}\n</code></pre>\n\n<p>I thought this would be fine since (s1 + i) is a pointer pointing at the ith element in the array s1, and replacing it with the ith element in s2. </p>\n\n<p>I tried using </p>\n\n<p>*(s1+i) = *(s2+i) </p>\n\n<p>instead, so copying the address of s2 into s1, but I get the same error.</p>\n\n<p>EDIT:</p>\n\n<p>The above code in the for loop actually worked</p>\n\n<p><code>*(s1+i) = *(s2+i)</code></p>\n\n<p>I think this didn't work because the loop that kept going. However, thanks everyone for answering my question on modifiable l value.</p>\n"}, {"tags": ["c", "sorting"], "answers": [{"tags": [], "owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "is_accepted": false, "score": 0, "last_activity_date": 1574212173, "creation_date": 1574212173, "answer_id": 58945182, "question_id": 58945119, "link": "https://stackoverflow.com/questions/58945119/c-using-insertion-sort-to-sort-array-of-pointers-to-structs/58945182#58945182", "title": "C Using insertion sort to sort array of pointers to structs", "body": "<p>You seem to assume that <code>pre-value</code> changes as you change <code>j</code>, but it needs to be re-calculated with each change to <code>j</code>.</p>\n"}], "owner": {"reputation": 2602, "user_id": 1204749, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8c7b2072c6586880fcb1e38a12de55ae?s=128&d=identicon&r=PG", "display_name": "cyber101", "link": "https://stackoverflow.com/users/1204749/cyber101"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 188, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1574212173, "creation_date": 1574211709, "question_id": 58945119, "link": "https://stackoverflow.com/questions/58945119/c-using-insertion-sort-to-sort-array-of-pointers-to-structs", "title": "C Using insertion sort to sort array of pointers to structs", "body": "<p>Im trying to sort, using Insertion Sort, variable-length array of  pointers to struct objects. </p>\n\n<p><strong>The sorting criteria is based on the structs distance_to_neighbor attribute.</strong></p>\n\n<p>The problem is it seems that sorted output is semi-sorted. </p>\n\n<p><strong>Here is my data structure  for a tree node:</strong></p>\n\n<pre><code>typedef struct tree_\n    {\n        struct tree *left; \n        struct tree *right; \n        float * info;  \n        float distance_to_neighbor;\n    } tree;\n</code></pre>\n\n<p><strong>Here is my Insertion Sort implementation, relevant code snippet  (based on <a href=\"https://www.techiedelight.com/insertion-sort-iterative-recursive/\" rel=\"nofollow noreferrer\">https://www.techiedelight.com/insertion-sort-iterative-recursive/</a>):</strong></p>\n\n<pre><code>// perform insertion sort on array of references to structs\nvoid insertion_sort(tree ** arr, int n)\n{\n    // Start from second element (element at index 0 \n    // is already sorted)\n    tree * pre_value = NULL;\n    for (int i = 1; i &lt; n; i++) \n    {\n        tree * value = *(arr + i);\n        int j = i;\n\n        // Find the index j within the sorted subset arr[0..i-1]\n        // where element arr[i] belongs\n        pre_value = *(arr + j - 1);\n        while (j &gt; 0 &amp;&amp; pre_value-&gt;distance_to_neighbor &gt; value.distance_to_neighbor) \n        {\n            **(arr + j) = **(arr + j - 1);\n            j--;\n        }\n\n        // Note that subarray arr[j..i-1] is shifted to\n        // the right by one position i.e. arr[j+1..i]\n        **(arr + j) = value;\n    }\n}\n</code></pre>\n\n<p><strong>Code snippet used  for debugging  before &amp; after sort:</strong></p>\n\n<p>printf (\"debug {\");\n                float * info;\n                float distance = 0;\n                for (int c = 0; c &lt; k_dimensions; c++)\n                {\n                    info = (float *) current->info;</p>\n\n<pre><code>                if (NULL != info)\n                {\n\n                    printf (\"%f,\", info[c]);\n                }\n                else\n                {\n                    break;\n                }\n\n            }//end for \n            printf (\"} \");\n            distance = (float) current-&gt;distance_to_neighbor;\n            printf (\"distance_to_neighbor=%f\\n\", distance);\n</code></pre>\n\n<p><strong>Here are the values before sorting (should be sorted based  on distance_to_neighbor) :</strong></p>\n\n<pre><code>debug {-50.000000,-50.000000,-50.000000,} distance_to_neighbor=53.000000\ndebug {-3.000000,-3.000000,-3.000000,} distance_to_neighbor=6.000000\ndebug {-2.000000,-2.000000,-2.000000,} distance_to_neighbor=5.000000\ndebug {-1.000000,-1.000000,-1.000000,} distance_to_neighbor=4.000000\ndebug {0.000000,0.000000,0.000000,} distance_to_neighbor=3.000000\ndebug {1.000000,1.000000,1.000000,} distance_to_neighbor=2.000000\ndebug {2.000000,2.000000,2.000000,} distance_to_neighbor=1.000000\ndebug {3.000000,3.000000,3.000000,} distance_to_neighbor=0.000000\ndebug {4.000000,4.000000,4.000000,} distance_to_neighbor=1.000000\ndebug {5.000000,5.000000,5.000000,} distance_to_neighbor=2.000000\ndebug {6.000000,6.000000,6.000000,} distance_to_neighbor=3.000000\ndebug {7.000000,7.000000,7.000000,} distance_to_neighbor=4.000000\ndebug {8.000000,8.000000,8.000000,} distance_to_neighbor=5.000000\ndebug {100.000000,100.000000,100.000000,} distance_to_neighbor=97.000000\n</code></pre>\n\n<p><strong>After sorting (looks sorted descending  order  then suddenly ascending order!. It should only be ascending order):</strong> </p>\n\n<pre><code>{8.000000,8.000000,8.000000,} distance_to_neighbor=5.000000\n{7.000000,7.000000,7.000000,} distance_to_neighbor=4.000000\n{6.000000,6.000000,6.000000,} distance_to_neighbor=3.000000\n{5.000000,5.000000,5.000000,} distance_to_neighbor=2.000000\n{4.000000,4.000000,4.000000,} distance_to_neighbor=1.000000\n{3.000000,3.000000,3.000000,} distance_to_neighbor=0.000000\n{2.000000,2.000000,2.000000,} distance_to_neighbor=1.000000\n{1.000000,1.000000,1.000000,} distance_to_neighbor=2.000000\n{0.000000,0.000000,0.000000,} distance_to_neighbor=3.000000\n{-1.000000,-1.000000,-1.000000,} distance_to_neighbor=4.000000\n{-2.000000,-2.000000,-2.000000,} distance_to_neighbor=5.000000\n{-3.000000,-3.000000,-3.000000,} distance_to_neighbor=6.000000\n{-50.000000,-50.000000,-50.000000,} distance_to_neighbor=53.000000\n{100.000000,100.000000,100.000000,} distance_to_neighbor=97.000000\n</code></pre>\n\n<p>I must keep my function signature the same as     <code>void insertion_sort(tree ** arr, int n)</code>.  How can I fix this sorting bug?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1574211987, "post_id": 58945116, "comment_id": 104148596, "body": "&quot;Hello,I&#39;m&quot; lacks a blank. If that is not the mistake which fails your output to match the required one, then please explain what difference you need to get rid of."}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1574212237, "post_id": 58945116, "comment_id": 104148653, "body": "What have you done so far to debug your program? (@yunnosch whoops, using my phone 2am, got the answer box mixed up with the comment box!)"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1574212496, "post_id": 58945116, "comment_id": 104148716, "body": "b calls c, c calls b. Your are not yet at recursion, are you? Return to second function means reurning without calling b. Declare the return type correctly, float instead of void. Same again elsewhere. You seem to need to reread the textbook chapters on calling functions, returning values from functions and using the returned values in the calling function. Explaining all that here would amount to a tutorial. Your question is hence too broad."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1574243628, "post_id": 58945116, "comment_id": 104158985, "body": "Welcome to SO. Please use a title for your question that specifies your problem. A plain jomework assignment is not sufficiently specific."}], "answers": [{"comments": [{"owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "edited": false, "score": 1, "creation_date": 1574237458, "post_id": 58945616, "comment_id": 104155618, "body": "Hello and welcome, this is a helpful answer. I just wanted to let you know that <code>stdio.h</code> is technically not always required but in this case necessary for <code>printf</code>. Maybe you could mention that in your answer to improve it a bit. Also your point 3 is strangly indented."}, {"owner": {"reputation": 31, "user_id": 12399946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e229a8d121e46ba3de3c5498c5fb3fa5?s=128&d=identicon&r=PG&f=1", "display_name": "sgtShaftoe", "link": "https://stackoverflow.com/users/12399946/sgtshaftoe"}, "reply_to_user": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "edited": false, "score": 0, "creation_date": 1574238241, "post_id": 58945616, "comment_id": 104155961, "body": "Thanks Kami, good point. I noticed that indentation as well but for the life of me I could not fix it. \ud83d\ude29"}, {"owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "edited": false, "score": 1, "creation_date": 1574238646, "post_id": 58945616, "comment_id": 104156147, "body": "Have a look at the suggested edit. Maybe this can help you and if it okay you can just approve it and afterwards you might want to edit the clarification for stdio.h in the question (see the edit link below your answer)"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1574239762, "post_id": 58945616, "comment_id": 104156691, "body": "<code>void a();</code> is obsolete style, don&#39;t teach that to newbies. The correct form is <code>void a(void);</code>"}, {"owner": {"reputation": 31, "user_id": 12399946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e229a8d121e46ba3de3c5498c5fb3fa5?s=128&d=identicon&r=PG&f=1", "display_name": "sgtShaftoe", "link": "https://stackoverflow.com/users/12399946/sgtshaftoe"}, "edited": false, "score": 0, "creation_date": 1574239920, "post_id": 58945616, "comment_id": 104156785, "body": "Done and done KK. Lundin, I was unaware as I am not exactly a veteran myself. Feel free to make the edit and I will approve."}, {"owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "edited": false, "score": 1, "creation_date": 1574242574, "post_id": 58945616, "comment_id": 104158381, "body": "If Lundin would edit your answer, you can not approve it as he has over 2k reputation. Also you should take care of your answer yourself. So please edit it yourself."}, {"owner": {"reputation": 31, "user_id": 12399946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e229a8d121e46ba3de3c5498c5fb3fa5?s=128&d=identicon&r=PG&f=1", "display_name": "sgtShaftoe", "link": "https://stackoverflow.com/users/12399946/sgtshaftoe"}, "edited": false, "score": 0, "creation_date": 1574243208, "post_id": 58945616, "comment_id": 104158748, "body": "I have edited it to show that style, would one of you be so kind as to explain why this is the proper form?"}], "tags": [], "owner": {"reputation": 31, "user_id": 12399946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e229a8d121e46ba3de3c5498c5fb3fa5?s=128&d=identicon&r=PG&f=1", "display_name": "sgtShaftoe", "link": "https://stackoverflow.com/users/12399946/sgtshaftoe"}, "is_accepted": false, "score": 2, "last_activity_date": 1574242881, "last_edit_date": 1574242881, "creation_date": 1574215888, "answer_id": 58945616, "question_id": 58945116, "link": "https://stackoverflow.com/questions/58945116/write-a-program-with-three-functions-call-the-first-function-from-main/58945616#58945616", "title": "Write a program with three functions, call the first function from main", "body": "<ol>\n<li><strong>What libraries have you included?</strong> stdio.h is required for printf function and math.h is also required to implement the sqrt() function.</li>\n</ol>\n\n<pre class=\"lang-c prettyprint-override\"><code>    #include &lt;stdio.h&gt;\n    #include &lt;math.h&gt;\n</code></pre>\n\n<ol start=\"2\">\n<li><p><strong>Your functions are incorrectly defined:</strong></p>\n\n<ul>\n<li>a requires no input and returns no data so it should be void </li>\n<li>b returns float variable so it should be labelled as such.    </li>\n<li>c has type float for input as well as output</li>\n</ul></li>\n</ol>\n\n<pre class=\"lang-c prettyprint-override\"><code>    void a(void);\n    float b(void);\n    float c(float); \n</code></pre>\n\n<ol start=\"3\">\n<li><strong>printf is not the way to call your functions.</strong> \nYou simply type the name of the function and arguments if you have any into your main function in the order you wish to call them.</li>\n</ol>\n\n<p><strong>example:</strong></p>\n\n<pre><code>void main()\n{\n    //declare your variable\n    float num;\n\n    //calls a function\n    a();\n\n    //calls b function and initializes num as value returned from b\n    num = b();\n\n    //calls c function and passes variable num to parameter in c function\n    c(num);\n}\n</code></pre>\n\n<p>This should get you headed in the right direction. </p>\n"}], "owner": {"reputation": 1, "user_id": 12323198, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAqpgfARLZuEuu5gn3sSfitiYABpV6PlOdHfEO1=k-s128", "display_name": "Mark Kevin Galvez", "link": "https://stackoverflow.com/users/12323198/mark-kevin-galvez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 518, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1574243389, "creation_date": 1574211697, "last_edit_date": 1574243389, "question_id": 58945116, "link": "https://stackoverflow.com/questions/58945116/write-a-program-with-three-functions-call-the-first-function-from-main", "title": "Write a program with three functions, call the first function from main", "body": "<p>a.    In the first function print \u201cHello, I\u2019m in function 1\u201d.  Call the second function.</p>\n\n<p>b.    In the second function ask the user to enter a float value.  Call a third function and pass the value to it.</p>\n\n<p>c.    In the third function calculate the square root of the number.  Return the square root to the second function, then the first function and then to main.</p>\n\n<p>d.    Print the square root in main in TWO decimal places.</p>\n\n<p>Please correct my coding for since I'm not getting the desired output.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>float a(float);\nvoid b(float);\nvoid c(float);\nvoid main(float d)\n{\n  printf(\"In main\\n\");\n  printf(\"back in main \\n\");\n  printf(\"The square root is %f\", d);\n}\n\nfloat a(float c)\n{\n  printf(\"Hello,I'm in function 1\");\n  return (c);\n}\n\nvoid b(float b)\n{\n  float number;\n  printf(\"in function 2\");\n  printf(\"enter a float value\");\n  scanf(\"%f\", &amp;number);\n  c(number);\n  return a(number);\n}\n\nvoid c(float a)\n{\n  float power;\n  printf(\"in function 3\");\n  power = sqrt(a);\n  return b(power);\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "linux", "function", "parameter-passing"], "answers": [{"tags": [], "owner": {"reputation": 378, "user_id": 2620017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/517078d0e5e19b98b4b8c7228da5aadf?s=128&d=identicon&r=PG", "display_name": "hko", "link": "https://stackoverflow.com/users/2620017/hko"}, "is_accepted": true, "score": 0, "last_activity_date": 1574213018, "creation_date": 1574213018, "answer_id": 58945280, "question_id": 58945024, "link": "https://stackoverflow.com/questions/58945024/error-passing-array-to-function-and-displaying-elements/58945280#58945280", "title": "Error passing array to function and displaying elements?", "body": "<p>There is a couple issues in your program. The most obvious is argv is a char **. But you are assigning a argv[i] (which is char *) to arr[i] (which is a int). Your compiler probably warns you about this. To convert a char* to an int you can use atoi() in this case.\nYou also want to use a different index for arr instead of i. And only increase it if you found a array element larger than the first one.</p>\n\n<pre><code>if (atoi(argv[i]) &gt; atoi(argv [1]))\n{\n    /* pass value of argument(s) to array named arr */\n    arr[j] = atoi(argv[i]);    \n    j++;\n} \n</code></pre>\n\n<p>Another issue is, sizeof(arr) in your function will just give you the size of an integer pointer. You  want the number of elements you found, which you should pass in as a second argument to the function.</p>\n"}], "owner": {"reputation": 23, "user_id": 11206484, "user_type": "registered", "profile_image": "https://graph.facebook.com/2827132050638239/picture?type=large", "display_name": "Anna Nguyen", "link": "https://stackoverflow.com/users/11206484/anna-nguyen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 58945280, "answer_count": 1, "score": 0, "last_activity_date": 1574214277, "creation_date": 1574210996, "last_edit_date": 1574214277, "question_id": 58945024, "link": "https://stackoverflow.com/questions/58945024/error-passing-array-to-function-and-displaying-elements", "title": "Error passing array to function and displaying elements?", "body": "<p>C language - Linux</p>\n\n<p>My program context: Read arguments input by user, passed arguments to an array after meeting requirements, and passed the array to a function. The function, then has to display the array elements. For some reason, the output is displaying random big numbers such as \"-914536439\" which is wrong.</p>\n\n<p>User input example: ./file 3 2 5 10 6 <br>\nCurrent output: Array elements are 0 0 0 -914536439 .. -914536430 (wrong!) <br>\nDesired output: Display array elements as it was given, \"Current array elements are: 3 5 10 6 \"</p>\n\n<p>I think I made an error with my void function somewhere. How can I fix this so that the function will display the array elements?</p>\n\n<p>My code:</p>\n\n<pre><code>/* function to display element of modified array */\nvoid function(int *arr)\n{\n   int j, size;\n   size = sizeof(arr)/sizeof(arr[0]);\n\n   printf(\"Current array elements are:\");\n   for (j=0; j &lt; size; j++)\n   {\n      /* display array elements */\n      printf(\"%d \", arr[j]);\n   }\n}\n\nint main (int argc, int *argv[])\n{ \n   /* max array size is 100 */\n   int arr[100];\n\n   for (int i=0; i&lt;argc; i++)\n   {\n       /*check if value of arguments is greater than value of argv[1] */\n       if (argv[i] &gt; argv [1])\n       {\n          /* pass value of argument(s) to array named arr */\n          arr[i] = argv[i];    \n       }    \n   }\n   /* pass array arr to function */\n   function(arr);\n\n   /*other code*/\n}\n</code></pre>\n"}, {"tags": ["c", "undefined-behavior", "cs50"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 12400830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6515020710329314eb326f82919de487?s=128&d=identicon&r=PG&f=1", "display_name": "Culask", "link": "https://stackoverflow.com/users/12400830/culask"}, "edited": false, "score": 0, "creation_date": 1574215050, "post_id": 58945259, "comment_id": 104149272, "body": "Thanks a lot! Now I can mutate the chars inside that char array."}], "tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": false, "score": 0, "last_activity_date": 1574212863, "creation_date": 1574212863, "answer_id": 58945259, "question_id": 58944961, "link": "https://stackoverflow.com/questions/58944961/why-would-i-receive-undefinedbehaviorsanitizerdeadlysignal-cs50-pset2-crack/58945259#58945259", "title": "Why would I receive UndefinedBehaviorSanitizer:DEADLYSIGNAL ? CS50 Pset2 Crack", "body": "<pre><code>string key = \"A\";\ncrypt(key, ...);\n</code></pre>\n\n<p>Is invalid. The <code>string key</code> points to a string literal <code>\"A\"</code>. A string literal <code>\"A\"</code> is immutable and can't be modified, while <code>crypt</code> expects a valid pointer to a 7 byte buffer (at least).</p>\n\n<p>Do:</p>\n\n<pre><code>char key[7];\ncrypt(key, ....);\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 12400830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6515020710329314eb326f82919de487?s=128&d=identicon&r=PG&f=1", "display_name": "Culask", "link": "https://stackoverflow.com/users/12400830/culask"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1574212863, "creation_date": 1574210366, "question_id": 58944961, "link": "https://stackoverflow.com/questions/58944961/why-would-i-receive-undefinedbehaviorsanitizerdeadlysignal-cs50-pset2-crack", "title": "Why would I receive UndefinedBehaviorSanitizer:DEADLYSIGNAL ? CS50 Pset2 Crack", "body": "<p>I get this error during runtime not on compilation. I Isolated the line that causes the error which is 44 (Removing it avoids the error). Code snippet and error message is given below.</p>\n\n<p>Based on my research, Error message suggests that I am trying to write into part of the memory that I should not be accessing. For another problem I have done something similar: pass a string from main to a function, edit some chars inside string within the function and return that string to a different variable. I tried assigning returned string to a new variable but error still comes up. What can I do to understand and avoid this error in the future ? </p>\n\n<pre><code>#include &lt;cs50.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;crypt.h&gt;\n\nstring get_nextkey(string currentkey);\nint get_nextchar(char current);\n\nstring starters[5] = {\"A\", \"AA\", \"AAA\", \"AAAA\", \"AAAAA\"};\n\nint main(int argc, string argv[])\n{\n    if (argc == 2)\n    {\n        string hash = argv[1];\n        char salt[3];\n        salt[0] = hash[0];\n        salt[1] = hash[1];\n        salt[2] = '\\0';\n        printf(\"%lu %s\\n\",strlen(salt),salt);\n        string key = \"A\";\n        for (int i = 0; i &lt; 100; i++)\n        {\n            printf(\"testing key: %s\\n\",key);\n            string keyhash = crypt(key, salt);\n            if (strcmp(hash,keyhash) == 0)\n            {\n                printf(\"%s\\n\",key);\n                return 0;\n            }\n            key = get_nextkey(key);\n        }     \n    }\n    printf(\"Usage: ./crack hash\\n\");\n    return 1;\n}\n\nstring get_nextkey(string currentkey)\n{\n    int length = strlen(currentkey);\n    int nextchar = get_nextchar(currentkey[length-1]);\n    if (nextchar != 0)\n    {\n        currentkey[length-1] = nextchar;\n    }\n    return currentkey;\n}\n\nint get_nextchar(char current)\n{\n    int nextchar = current + 1;\n    if (nextchar &lt; 123)\n    {\n        if (nextchar &gt; 90 &amp;&amp; nextchar &lt; 97)\n        {\n            nextchar = 97;\n        }\n    }\n    else\n    {\n        return 0;\n    }\n    return nextchar;\n}\n</code></pre>\n\n<pre><code>$ ./crack 50cI2vYkF0YU2\n2 50\ntesting key: A\nUndefinedBehaviorSanitizer:DEADLYSIGNAL\n==1361==ERROR: UndefinedBehaviorSanitizer: SEGV on unknown address 0x00000042b316 (pc 0x000000422b46 bp 0x7fff6b45cc20 sp 0x7fff6b45cb60 T1361)\n==1361==The signal is caused by a WRITE memory access.\n    #0 0x422b45  (/root/sandbox/crack+0x422b45)\n    #1 0x422836  (/root/sandbox/crack+0x422836)\n    #2 0x7f00a0281b96  (/lib/x86_64-linux-gnu/libc.so.6+0x21b96)\n    #3 0x402b79  (/root/sandbox/crack+0x402b79)\n\nUndefinedBehaviorSanitizer can not provide additional info.\n==1361==ABORTING\n</code></pre>\n"}]