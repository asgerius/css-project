[{"tags": ["python", "c", "caching"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1505952172, "post_id": 46333332, "comment_id": 79627585, "body": "The C compiler may have noticed that the two arrays have mutually exclusive lifetimes, so it reuses the same memory for both of them."}, {"owner": {"reputation": 79, "user_id": 5400814, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/542283609252362/picture?type=large", "display_name": "Jason  Long", "link": "https://stackoverflow.com/users/5400814/jason-long"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1505952380, "post_id": 46333332, "comment_id": 79627636, "body": "@Barmar what confused me most is why the python code in contrast.. the column cache Line ?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1505952441, "post_id": 46333332, "comment_id": 79627648, "body": "Python is interpreted, C is compiled, so there&#39;s lots of room for differences in behavior."}, {"owner": {"reputation": 63648, "user_id": 5014455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JTknr.png?s=128&g=1", "display_name": "juanpa.arrivillaga", "link": "https://stackoverflow.com/users/5014455/juanpa-arrivillaga"}, "edited": false, "score": 0, "creation_date": 1505954249, "post_id": 46333332, "comment_id": 79628032, "body": "Furthermore, a Python list is <i>*not a primitive array</i> and the performance characteristics are different. A CPython list is essentially an array of Py_object pointers. And <i>everything in Python is an object</i> including <code>int</code> objects."}], "owner": {"reputation": 79, "user_id": 5400814, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/542283609252362/picture?type=large", "display_name": "Jason  Long", "link": "https://stackoverflow.com/users/5400814/jason-long"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1505952416, "creation_date": 1505951432, "last_edit_date": 1505952416, "question_id": 46333332, "link": "https://stackoverflow.com/questions/46333332/python-different-for-loop-implement-get-different-speed-and-even-in-contrast-wit", "title": "python different for-loop implement get different speed and even in contrast with cache mechanism in C", "body": "<p>I learn about caching recently and knowing that it can optimize the program by improve the probability to hit the cache. And there is a piece of code that can get different time in C.</p>\n\n<pre><code>a[100][5000]=...//initialize\nfor(i=0; i&lt;100; i=i+1) {\n  for(j=0; j&lt;5000; j=j+1) {\n    a[i][j] = 2 * a[i][j];\n  }\n}\n\n\na[100][5000]=...//initialize\nfor(i=0; i&lt;100; i=i+1) {\n  for(j=0; j&lt;5000; j=j+1) {\n    a[i][j] = 2 * a[i][j];\n  }\n}\n</code></pre>\n\n<p>The below one is faster than above one. But in python get different result in below code.The principle is below one can hit the cache in cache Line but above one should visit the mem more frequently.</p>\n\n<pre><code>arr1 = [[i for i in range(5000)] for j in range(100)]\narr2 = [[i for i in range(5000)] for j in range(100)]\ndef test1():\n    start = time.time()\n    for i in range(5000):\n        for j in range(100):\n            arr1[i][j] = 2 * arr1[i][j]\n\ndef test2():\n    start = time.time()\n    sum = 0\n    for j in range(100):\n        for i in range(5000):\n            arr2[i][j] = 2 * arr2[i][j]\n%timeit -n100 test1() \n%timeit -n100 test2()\n# 1.16 s \u00b1 67.2 ms per loop (mean \u00b1 std. dev. of 7 runs, 100 loops each)\n# 1.5 s \u00b1 101 ms per loop (mean \u00b1 std. dev. of 7 runs, 100 loops each)\n</code></pre>\n\n<p>I wonder if the cache mechanism is diff in this two program language and the basic python is implemented by C?</p>\n"}, {"tags": ["c", "binary", "range"], "comments": [{"owner": {"reputation": 491, "user_id": 8509272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/487ff5fe4697aeb326fa5092ef38f116?s=128&d=identicon&r=PG&f=1", "display_name": "savram", "link": "https://stackoverflow.com/users/8509272/savram"}, "edited": false, "score": 0, "creation_date": 1505951700, "post_id": 46333297, "comment_id": 79627492, "body": "Huh I don&#39;t know this either. Thing is, even if you overflow the unsigned int it will just go back to 0 and start going up again, so it will always store a valid int even if you input a number bigger than 2^32-1"}, {"owner": {"reputation": 11458, "user_id": 3435400, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/61726fe80facc93d76754f0226b49eb9?s=128&d=identicon&r=PG&f=1", "display_name": "alain", "link": "https://stackoverflow.com/users/3435400/alain"}, "edited": false, "score": 0, "creation_date": 1505952120, "post_id": 46333297, "comment_id": 79627574, "body": "Have you tried something like <code>if(num &lt; 0)</code> for example? Is your question really &#39;how to check for negative numbers?&#39;"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1505952282, "post_id": 46333297, "comment_id": 79627608, "body": "Since <code>num</code> is unsigned, it can&#39;t be negative."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1505952338, "post_id": 46333297, "comment_id": 79627623, "body": "Instead of using <code>scanf</code>, use <code>fgets</code> to read a line. Then use a function to parse it as a number, and check if it&#39;s in the range you want."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7939273"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1505952408, "post_id": 46333297, "comment_id": 79627641, "body": "@Barmar: Yes, that was my response to my professor. He then said this: &quot;You can read in an input number as signed number and check whether it is a negative number. The valid number should be 0&lt;= input &lt;= 2^32 - 1.&quot;  My question is: if we read in a regular signed int value, doesn&#39;t that greatly decrease the range? 0 ~ 2,147,483,647 is a lot less than 2^32 - 1. How would I check the range (or how would the user be able to enter a number outside of the int range) when our range for the project is of an unsigned int, but the user enters a signed int?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7939273"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1505952439, "post_id": 46333297, "comment_id": 79627646, "body": "@Barmar: I believe we are meant to use scanf, as part of the instructions."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1505952529, "post_id": 46333297, "comment_id": 79627663, "body": "You&#39;ll need to use <code>long long int</code> to be able to hold numbers bigger than 2^32, then test if it&#39;s less than 2^32."}, {"owner": {"reputation": 115587, "user_id": 56541, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/Wm7Xg.png?s=128&g=1", "display_name": "David Z", "link": "https://stackoverflow.com/users/56541/david-z"}, "edited": false, "score": 0, "creation_date": 1505952601, "post_id": 46333297, "comment_id": 79627681, "body": "For future reference, if you have a new, separate problem, you should make a new post, but if you&#39;re asking essentially the same thing you were already asking, just edit the existing post (though not in a way that totally invalidates existing answers). In this case, from a quick glance it seems like you made the right choice to make a new post."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7939273"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1505952661, "post_id": 46333297, "comment_id": 79627699, "body": "@Barmar: I see! So the range for a long long int is bigger than an unsigned int? I didn&#39;t know that (haven&#39;t been coding for very long). I&#39;ll try to modify the code and see if it works."}, {"owner": {"reputation": 11458, "user_id": 3435400, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/61726fe80facc93d76754f0226b49eb9?s=128&d=identicon&r=PG&f=1", "display_name": "alain", "link": "https://stackoverflow.com/users/3435400/alain"}, "edited": false, "score": 0, "creation_date": 1505952685, "post_id": 46333297, "comment_id": 79627708, "body": "For the range 0 ~ 2,147,483,647 you can use an <code>int</code> and a simple <code>if(num &gt;= 0 &amp;&amp; num &lt; 2147483647)</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7939273"}, "reply_to_user": {"reputation": 11458, "user_id": 3435400, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/61726fe80facc93d76754f0226b49eb9?s=128&d=identicon&r=PG&f=1", "display_name": "alain", "link": "https://stackoverflow.com/users/3435400/alain"}, "edited": false, "score": 0, "creation_date": 1505952728, "post_id": 46333297, "comment_id": 79627720, "body": "@alain: I believe our range is meant to be 0 ~ 4294967295."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 11458, "user_id": 3435400, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/61726fe80facc93d76754f0226b49eb9?s=128&d=identicon&r=PG&f=1", "display_name": "alain", "link": "https://stackoverflow.com/users/3435400/alain"}, "edited": false, "score": 0, "creation_date": 1505952730, "post_id": 46333297, "comment_id": 79627722, "body": "@alain That&#39;s 2^31-1, not 2^32-1."}, {"owner": {"reputation": 11458, "user_id": 3435400, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/61726fe80facc93d76754f0226b49eb9?s=128&d=identicon&r=PG&f=1", "display_name": "alain", "link": "https://stackoverflow.com/users/3435400/alain"}, "edited": false, "score": 0, "creation_date": 1505952768, "post_id": 46333297, "comment_id": 79627731, "body": "He mentioned this range in a comment above. (But yes it seems the requirement is 2^32)"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1505952769, "post_id": 46333297, "comment_id": 79627732, "body": "@GarrettMcClure There are different sizes of int: <code>char</code>, <code>short</code>, <code>int</code>, <code>long int</code>, <code>long long int</code>."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 11458, "user_id": 3435400, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/61726fe80facc93d76754f0226b49eb9?s=128&d=identicon&r=PG&f=1", "display_name": "alain", "link": "https://stackoverflow.com/users/3435400/alain"}, "edited": false, "score": 0, "creation_date": 1505952859, "post_id": 46333297, "comment_id": 79627745, "body": "@alain He wrote &quot;the valid number should be 0&lt;= input &lt;= 2^32 - 1&quot;. Then he mentioned <code>2,147,483,647</code> as being too small to check for that range."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7939273"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1505952875, "post_id": 46333297, "comment_id": 79627751, "body": "@Barmar: Does long long int use %l? Or %d?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1505952894, "post_id": 46333297, "comment_id": 79627760, "body": "@GarrettMcClure Read the <code>scanf</code> documentation to learn."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7939273"}, "edited": false, "score": 0, "creation_date": 1505953302, "post_id": 46333297, "comment_id": 79627847, "body": "Update: it looks like something is still incorrect. When I tested the program, 2 returned a value of zero, which is incorrect. What could have caused this? I&#39;ve edited the top post with my updated/corrected code."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7939273"}, "edited": false, "score": 0, "creation_date": 1505953555, "post_id": 46333297, "comment_id": 79627902, "body": "New update: I think I figured it out! Thanks guys. I&#39;ll post the code that seems to have worked above, just in case someone else wants to reference it. Hope there&#39;s no more errors that I&#39;m not seeing."}], "answers": [{"tags": [], "owner": {"reputation": 313, "user_id": 2105501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45c64e49a69a60a94328fe105e936a3d?s=128&d=identicon&r=PG", "display_name": "Idan", "link": "https://stackoverflow.com/users/2105501/idan"}, "is_accepted": false, "score": 0, "last_activity_date": 1505952593, "creation_date": 1505952593, "answer_id": 46333469, "question_id": 46333297, "link": "https://stackoverflow.com/questions/46333297/c-help-checking-for-range-and-negative-numbers-when-user-inputs-unsigned-integ/46333469#46333469", "title": "C help - checking for range and negative numbers when user inputs unsigned integer", "body": "<p>Using <a href=\"https://stackoverflow.com/questions/2430303/disadvantages-of-scanf\">scanf might be problematic and dangerous</a>. A better way would be to use fgets to get input from the user, and then use <a href=\"https://stackoverflow.com/questions/11279767/how-do-i-make-sure-that-strtol-have-returned-successfully\">strtoul</a>/strtoul to convert the string to an integer.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7939273"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1505953623, "creation_date": 1505951143, "last_edit_date": 1505953623, "question_id": 46333297, "link": "https://stackoverflow.com/questions/46333297/c-help-checking-for-range-and-negative-numbers-when-user-inputs-unsigned-integ", "title": "C help - checking for range and negative numbers when user inputs unsigned integer", "body": "<p>I posted <a href=\"https://stackoverflow.com/questions/46285869/still-need-help-checking-scanfs-return-value-does-not-fulfill-the-correct-inp\">this</a> two days ago, but since my question has since changed to something else and I now need help regarding a new problem in my code, I thought it would be alright to make a new post. If I'm wrong, please close this question; I'm new to the community and don't want any trouble. I just want some help with my problem.</p>\n\n<p>I've received some feedback: I know my two problems with this code: I need to be checking that the input by the user is within range (0~2^32 - 1; if it isn't in range, it gets the \"warning\" message), and I need to check for negative numbers (these should get the \"invalid\" warning). But I'm completely stumped. Could I please perhaps get some more help on working my code to do the above two things?</p>\n\n<p><strong>Update</strong>: I think this code finally did the trick. Please let me know if I'm overlooking an error that isn't showing up after being compiled. Thanks!</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\nlong long int num;\nint count = 0;\n\nprintf(\"Please enter an integer: \");\nscanf(\"%lld\", &amp;num);\n\nif (num &gt;= 0 &amp;&amp; num &lt;= 4294967295) {\n    while(num){\n        count += num &amp; 1;\n        num &gt;&gt;= 1;\n    }\n    printf(\"%d\\n\", count);\n} else {\n    printf(\"Warning: this is not a valid integer\\n\");\n}\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "answers": [{"comments": [{"owner": {"reputation": 3504, "user_id": 1986221, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3a3976577cdcb38084a2a41f7c1fb761?s=128&d=identicon&r=PG", "display_name": "Alejandro Iv&#225;n", "link": "https://stackoverflow.com/users/1986221/alejandro-iv%c3%a1n"}, "edited": false, "score": 0, "creation_date": 1505953562, "post_id": 46333537, "comment_id": 79627904, "body": "May I ask... what&#39;s <code>sizeof array_tracker[0]</code>? I thought <code>array_tracker</code> was actually <code>NULL</code> until it&#39;s initialized?"}, {"owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "reply_to_user": {"reputation": 3504, "user_id": 1986221, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3a3976577cdcb38084a2a41f7c1fb761?s=128&d=identicon&r=PG", "display_name": "Alejandro Iv&#225;n", "link": "https://stackoverflow.com/users/1986221/alejandro-iv%c3%a1n"}, "edited": false, "score": 0, "creation_date": 1505954413, "post_id": 46333537, "comment_id": 79628059, "body": "@AlejandroIv&#225;n First of all, it can be NULL, yet it is its element that is measured. Next, <code>sizeof</code> is unevaluated context."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 3504, "user_id": 1986221, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3a3976577cdcb38084a2a41f7c1fb761?s=128&d=identicon&r=PG", "display_name": "Alejandro Iv&#225;n", "link": "https://stackoverflow.com/users/1986221/alejandro-iv%c3%a1n"}, "edited": false, "score": 0, "creation_date": 1505980295, "post_id": 46333537, "comment_id": 79636328, "body": "@AlejandroIv&#225;n <code>sizeof</code> just looks at the type, not the value."}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 1, "last_activity_date": 1505953153, "creation_date": 1505953153, "answer_id": 46333537, "question_id": 46333276, "link": "https://stackoverflow.com/questions/46333276/memory-error-in-program-that-fills-array-with-random-numbers/46333537#46333537", "title": "Memory error in program that fills array with random numbers", "body": "<p>You never initialized the contents of <code>array_tracker</code>. So when you do:</p>\n\n<pre><code>array_tracker[my_array[i]]++;\n</code></pre>\n\n<p>you're incrementing an uninitialized value. That's why you get lots of complaints about using uninitialized values.</p>\n\n<p>You could use <code>calloc()</code> instead of <code>malloc()</code> to allocate space and initialize all the elements to <code>0</code>.</p>\n\n<pre><code>array_tracker = calloc(array_size, sizeof array_tracker[0]);\n</code></pre>\n"}], "owner": {"reputation": 715, "user_id": 5076168, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/27640d7c6cef1ca016add7258a061933?s=128&d=identicon&r=PG&f=1", "display_name": "eZ_Harry", "link": "https://stackoverflow.com/users/5076168/ez-harry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1505953153, "creation_date": 1505950944, "question_id": 46333276, "link": "https://stackoverflow.com/questions/46333276/memory-error-in-program-that-fills-array-with-random-numbers", "title": "Memory error in program that fills array with random numbers", "body": "<p>I have a program with creates an array and fills its with random numbers. It then checks for any duplicates and prints out how many times each duplicate has occurred. All works fine except Memcheck is telling me there are 39 errors and I cannot figure out what is causing them (I think the issue is coming from the repeated() method)?</p>\n\n<p>Cheers,\nHarry</p>\n\n<p>Code -</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include \"random.h\"\n\nint main(void) {\n    int array_size = 0;\n    int *my_array;\n    int i = 0;\n\n    printf(\"Enter the size of the array:\\n\");\n    scanf(\"%d\", &amp;array_size);\n\n    my_array = malloc(array_size * sizeof my_array[0]);\n    if (NULL == my_array) {\n        fprintf(stderr, \"memory allocation failed!\\n\");\n        return EXIT_FAILURE;\n    }\n\n    for (i = 0; i &lt; array_size; i++) {\n        my_array[i] = rand() % array_size;\n    }\n    printf(\"What's in the array:\\n\");\n    for (i = 0; i &lt; array_size; i++) {\n        printf(\"%d \", my_array[i]);\n    }\n    printf(\"\\n\");\n\n    repeated(my_array, array_size);\n\n    free(my_array);\n\n    return EXIT_SUCCESS;\n}\n\nvoid repeated(int *my_array, int array_size) {\n    int *array_tracker;\n    int i;\n\n    array_tracker = malloc(array_size * sizeof array_tracker[0]);\n\n    for (i = 0; i &lt; array_size; i++) {\n        array_tracker[my_array[i]]++;\n    }\n\n    for (i = 0; i &lt; array_size; i++) {\n        if (array_tracker[i] &gt; 1) {\n            printf(\"%d occurs %d times\\n\", i, array_tracker[i]);\n        }\n    }\n\n    free(array_tracker);\n}\n</code></pre>\n\n<p>Memcheck output -</p>\n\n<pre><code>==23999== Memcheck, a memory error detector\n==23999== Copyright (C) 2002-2015, and GNU GPL'd, by Julian Seward et al.\n==23999== Using Valgrind-3.12.0 and LibVEX; rerun with -h for copyright info\n==23999== Command: ./lab20c-prog\n==23999== \n==23999== Conditional jump or move depends on uninitialised value(s)\n==23999==    at 0x40091F: repeated (random.c:15)\n==23999==    by 0x400799: main (random.c:42)\n==23999== \n==23999== Conditional jump or move depends on uninitialised value(s)\n==23999==    at 0x519148A: vfprintf (in /usr/lib64/libc-2.24.so)\n==23999==    by 0x5199718: printf (in /usr/lib64/libc-2.24.so)\n==23999==    by 0x40092E: repeated (random.c:16)\n==23999==    by 0x400799: main (random.c:42)\n==23999== \n==23999== Use of uninitialised value of size 8\n==23999==    at 0x518DD8B: _itoa_word (in /usr/lib64/libc-2.24.so)\n==23999==    by 0x5192552: vfprintf (in /usr/lib64/libc-2.24.so)\n==23999==    by 0x5199718: printf (in /usr/lib64/libc-2.24.so)\n==23999==    by 0x40092E: repeated (random.c:16)\n==23999==    by 0x400799: main (random.c:42)\n==23999== \n==23999== Conditional jump or move depends on uninitialised value(s)\n==23999==    at 0x518DD95: _itoa_word (in /usr/lib64/libc-2.24.so)\n==23999==    by 0x5192552: vfprintf (in /usr/lib64/libc-2.24.so)\n==23999==    by 0x5199718: printf (in /usr/lib64/libc-2.24.so)\n==23999==    by 0x40092E: repeated (random.c:16)\n==23999==    by 0x400799: main (random.c:42)\n==23999== \n==23999== Conditional jump or move depends on uninitialised value(s)\n==23999==    at 0x5192669: vfprintf (in /usr/lib64/libc-2.24.so)\n==23999==    by 0x5199718: printf (in /usr/lib64/libc-2.24.so)\n==23999==    by 0x40092E: repeated (random.c:16)\n==23999==    by 0x400799: main (random.c:42)\n==23999== \n==23999== Conditional jump or move depends on uninitialised value(s)\n==23999==    at 0x5191536: vfprintf (in /usr/lib64/libc-2.24.so)\n==23999==    by 0x5199718: printf (in /usr/lib64/libc-2.24.so)\n==23999==    by 0x40092E: repeated (random.c:16)\n==23999==    by 0x400799: main (random.c:42)\n==23999== \n==23999== Conditional jump or move depends on uninitialised value(s)\n==23999==    at 0x51915B9: vfprintf (in /usr/lib64/libc-2.24.so)\n==23999==    by 0x5199718: printf (in /usr/lib64/libc-2.24.so)\n==23999==    by 0x40092E: repeated (random.c:16)\n==23999==    by 0x400799: main (random.c:42)\n==23999== \n==23999== \n==23999== HEAP SUMMARY:\n==23999==     in use at exit: 0 bytes in 0 blocks\n==23999==   total heap usage: 4 allocs, 4 frees, 1,052,792 bytes allocated\n==23999== \n==23999== All heap blocks were freed -- no leaks are possible\n==23999== \n==23999== For counts of detected and suppressed errors, rerun with: -v\n==23999== Use --track-origins=yes to see where uninitialised values come from\n==23999== ERROR SUMMARY: 39 errors from 7 contexts (suppressed: 0 from 0)\n</code></pre>\n"}, {"tags": ["c", "if-statement", "integer-overflow", "c89"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 8, "creation_date": 1505947416, "post_id": 46332765, "comment_id": 79626407, "body": "It would be fair to note that signed integer overflow leads to undefined behaviour."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1505947545, "post_id": 46332765, "comment_id": 79626460, "body": "Btw <a href=\"https://ideone.com/1uxeDp\" rel=\"nofollow noreferrer\">ideone.com/1uxeDp</a>. Did you compile with optimisations?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1505947761, "post_id": 46332765, "comment_id": 79626530, "body": "Please clarify whether you are using C99 or C11 mode  (as opposed to C89 mode or a proprietary mode, with a non-standard definition of <code>int32_t</code>)"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 2, "creation_date": 1505947854, "post_id": 46332765, "comment_id": 79626548, "body": "As well as the overflow UB, you also cause UB by using the wrong format specifier in printf (assuming <code>UARTprintf</code> is a macro for a standard printf function, or ultimately does <code>va_arg(ap, unsigned int)</code>)"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1505948890, "post_id": 46332765, "comment_id": 79626809, "body": "The compiler might be converting the first code to something like <code>if (y &gt;= x+1)</code>, which has different overflow behavior than doing the subtraction."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1505950171, "post_id": 46332765, "comment_id": 79627171, "body": "@M.M: Tag wiki: without specific version, it is standard C, i.e. C11 (although in most aspects C99 does not make a difference)."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1505950272, "post_id": 46332765, "comment_id": 79627200, "body": "@Olaf I doubt OP read and followed the tag wiki policies in selecting a tag"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1505950274, "post_id": 46332765, "comment_id": 79627201, "body": "&quot;I would think that subtracting two int32_t variables would yield a result of type int32_t&quot; - 1) There is no <code>int32_t</code> type. It is just an alias for a standard type. 2) It depends on whether <code>int</code> on your platform has a lower/same rank as the original type or not. 3) What is The word <b>undefined</b> in &quot;undefined behaviour&quot; is pretty clear."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1505950394, "post_id": 46332765, "comment_id": 79627221, "body": "@M.M: Ignorantia legis non excusat."}, {"owner": {"reputation": 41, "user_id": 4024412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/056a0dfe17f83118b195bd3e78bfbe42?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Strobel", "link": "https://stackoverflow.com/users/4024412/steve-strobel"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1506007836, "post_id": 46332765, "comment_id": 79655949, "body": "@zerkms: Thanks for the example on ideone - I didn&#39;t know that existed.  The compiler in my case is TI&#39;s ARM compiler v16.6.0.STS.  Optimization is turned off;  the options (with include paths and symbol definitions removed since they aren&#39;t relevant) are: &quot;-mv7M4 --code_state=16 --float_support=FPv4SPD16 -me -g --gcc --diag_warning=225 --diag_wrap=off --display_error_number --abi=eabi&quot;"}, {"owner": {"reputation": 41, "user_id": 4024412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/056a0dfe17f83118b195bd3e78bfbe42?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Strobel", "link": "https://stackoverflow.com/users/4024412/steve-strobel"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1506007858, "post_id": 46332765, "comment_id": 79655966, "body": "@M.M: The compiler is set for &quot;ANSI C89&quot;.  I added the corresponding tag.  Should I remove the &quot;c&quot; tag, or leave them both?  stdint.h includes this:  &quot;typedef int int32_t;&quot;"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1506031132, "post_id": 46332765, "comment_id": 79667647, "body": "@SteveStrobel Leaving both would be the best option.  <code>stdint.h</code> is a C99 header although I would expect some compilers to offer it even in C89 mode"}], "answers": [{"tags": [], "owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "is_accepted": false, "score": 2, "last_activity_date": 1505947674, "creation_date": 1505947674, "answer_id": 46332837, "question_id": 46332765, "link": "https://stackoverflow.com/questions/46332765/why-does-integer-overflow-work-differently-inside-of-if-statement-conditional/46332837#46332837", "title": "Why does integer overflow work differently inside of if statement conditional?", "body": "<p>Given that signed integer overflow leads to undefined behaviour - you better not try to explain it.</p>\n\n<p>Because your assumptions are based on \"common sense\", not the standard.</p>\n\n<p>Otherwise - check assembly and try to debug it, but again, the outcome would not be scalable: you won't be able to apply the new knowledge to some other case (but with no doubt it would be fun to do).</p>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 4024412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/056a0dfe17f83118b195bd3e78bfbe42?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Strobel", "link": "https://stackoverflow.com/users/4024412/steve-strobel"}, "edited": false, "score": 0, "creation_date": 1506458812, "post_id": 46348670, "comment_id": 79828255, "body": "If using C++, it looks like a practical solution would be to use a library like SafeInt &lt;<a href=\"https://safeint.codeplex.com/\" rel=\"nofollow noreferrer\">safeint.codeplex.com</a>&gt;.  In some cases it does &quot;intermediate calculations...with unsigned numbers, and unsigned overflow is defined by the standard...&quot;  For example, &quot;the compiler may remove -x, but it won&#39;t remove ~(unsigned)x + 1, which emits the same bit pattern (and the same assembly code).&quot;"}], "tags": [], "owner": {"reputation": 41, "user_id": 4024412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/056a0dfe17f83118b195bd3e78bfbe42?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Strobel", "link": "https://stackoverflow.com/users/4024412/steve-strobel"}, "is_accepted": false, "score": 0, "last_activity_date": 1506010423, "creation_date": 1506010423, "answer_id": 46348670, "question_id": 46332765, "link": "https://stackoverflow.com/questions/46332765/why-does-integer-overflow-work-differently-inside-of-if-statement-conditional/46348670#46348670", "title": "Why does integer overflow work differently inside of if statement conditional?", "body": "<p>The question I didn't know enough to ask originally is, \"How can I avoid undefined behavior when doing subtraction on integers that might have overflowed?\"  Please correct me if I am wrong, but it appears that the answer to that question would be \"use unsigned rather than signed integers\" because the results are well defined (per C11 6.2.5/9) \"a result that cannot be represented by the resulting unsigned integer type is reduced modulo the number that is one greater than the largest value that can be represented by the resulting type.\"</p>\n\n<p>In this case, that is enough to come up with a working solution because the elapsed time will always be zero or a small positive number therefore the result of the subtraction will always be positive.  So the result of the subtraction could be kept as an unsigned number and compared ( \">=1\" ) or converted back to a signed int for comparison (C11 6.3.1.3 \"When a value with integer type is converted to another integer type ... if the value can be represented by the new type, it is unchanged.\"  This code works, and I believe does not rely on any undefined behavior:  \"if( ( (int32_t)(uint32_t)y - (uint32_t)x ) >= 1 )\"</p>\n\n<p>In the more general case, however, converting to unsigned to do the subtraction, then converting back to a signed result (which might be negative) is not well defined.  C11 6.3.1.3 says regarding converting to another integer type that if \"the new type is signed and the value cannot be represented in it; either the result is implementation-defined or an implementation-defined signal is raised.\"  So I can still imagine a scenario in which assembly code would be needed to achieve well-defined results;  this just isn't one of them.</p>\n"}], "owner": {"reputation": 41, "user_id": 4024412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/056a0dfe17f83118b195bd3e78bfbe42?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Strobel", "link": "https://stackoverflow.com/users/4024412/steve-strobel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1506010423, "creation_date": 1505947189, "last_edit_date": 1506007630, "question_id": 46332765, "link": "https://stackoverflow.com/questions/46332765/why-does-integer-overflow-work-differently-inside-of-if-statement-conditional", "title": "Why does integer overflow work differently inside of if statement conditional?", "body": "<p>In the following code, x and y are int32_t variables.  In this simplified example, they always differ by 1.  When they span the int32_t overflow boundary (0x7FFFFFFF, the max 2's compliment 32-bit positive number, to 0x80000000, the largest magnitude negative number), subtracting them seems to give different results when it is done inside the conditional of the if statement (Method 1) than it does if the result is stored in a temporary variable (Method 2).  Why don't they give the same result?</p>\n\n<p>I would think that subtracting two int32_t variables would yield a result of type int32_t, so using a temporary of that type shouldn't change anything.  I tried explicitly typecasting inside the if statement conditional;  that didn't change anything.  FWIW, Method 2 gives the result I would expect.</p>\n\n<p>The code:</p>\n\n<pre><code>int32_t x = (0x80000000 - 3);\n\nint i;\nfor( i = 0; i &lt; 5; ++i )\n{\n    int32_t y = x + 1;      // this may cause rollover from 0x7fffffff (positive) to 0x80000000 (negative)\n\n    UARTprintf(\"\\n\" \"x = 0x%08X, y = 0x%08X\", x, y );\n\n    if( ( y - x ) &gt;= 1 )            // Method 1\n        UARTprintf(\" - true \");\n    else\n        UARTprintf(\" - FALSE\");\n\n    int32_t z = ( y - x );          // Method 2\n    if( ( z ) &gt;= 1 )\n        UARTprintf(\" - true \");\n    else\n        UARTprintf(\" - false\");\n\n    ++x;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>x = 0x7ffffffd, y = 0x7ffffffe - true  - true\nx = 0x7ffffffe, y = 0x7fffffff - true  - true\nx = 0x7fffffff, y = 0x80000000 - FALSE - true\nx = 0x80000000, y = 0x80000001 - true  - true\nx = 0x80000001, y = 0x80000002 - true  - true\n</code></pre>\n\n<p>In my actual application (not this simplified example), y is incremented by a hardware timer and x is a record of when some code was last executed.  The test is intended to make some code run at intervals.  Considering that y represents time and the application may run for a very long time before it is restarted, just not letting it overflow isn't an option.</p>\n\n<p>Noting, as several of you did, that the standard does not define the behavior when signed integer overflow occurs tells me that I don't have a right to complain that I can't count on it working the way I want it to, but it doesn't give me a solution I can count on.  Even using a temporary variable, which seems to work with my current compiler version and settings, might quit working when one of those things changes.  Do I have any trustworthy options short of resorting to assembly code?</p>\n"}, {"tags": ["c", "r", "valgrind"], "comments": [{"owner": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "edited": false, "score": 0, "creation_date": 1505946685, "post_id": 46332631, "comment_id": 79626221, "body": "there is probably a continuation of the message which tells when the block was deleted/freed."}, {"owner": {"reputation": 48116, "user_id": 2725969, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/t13vb.jpg?s=128&g=1", "display_name": "BrodieG", "link": "https://stackoverflow.com/users/2725969/brodieg"}, "reply_to_user": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "edited": false, "score": 0, "creation_date": 1505946995, "post_id": 46332631, "comment_id": 79626305, "body": "Wouldn&#39;t it then say &quot;... of size 7,960 free&#39;d&quot;?  The word &quot;free&quot; does not appear in the full output I link."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1505948253, "post_id": 46332631, "comment_id": 79626649, "body": "Maybe a (uncaught) previous error has overwritten a memory-control-block?"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1505949245, "post_id": 46332631, "comment_id": 79626913, "body": "<code>... &amp;&amp; *(string_copy + 1))</code> why do you suppress the final &#39;\\n&#39; in the count of newlines? (besides the strange syntax: <code>... &amp;&amp; string_copy[1])</code> is more common, IMHO )"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1505950322, "post_id": 46332631, "comment_id": 79627212, "body": "<code>size_t i = 0; i &lt; newlines; ++i) size_all = CSR_add_szt(size_all, ctd_size);</code> You are performing multiplication by repetitive addition here. Are you afraid that a size_t overflows?"}, {"owner": {"reputation": 48116, "user_id": 2725969, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/t13vb.jpg?s=128&g=1", "display_name": "BrodieG", "link": "https://stackoverflow.com/users/2725969/brodieg"}, "edited": false, "score": 0, "creation_date": 1505955405, "post_id": 46332631, "comment_id": 79628282, "body": "re: size_t that&#39;s the idea, however unlikely.  This isn&#39;t a performance critical part of the code so I was just trying to get in the habit.  Not the best way to do it either, but just learning right now."}, {"owner": {"reputation": 48116, "user_id": 2725969, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/t13vb.jpg?s=128&g=1", "display_name": "BrodieG", "link": "https://stackoverflow.com/users/2725969/brodieg"}, "edited": false, "score": 0, "creation_date": 1505955491, "post_id": 46332631, "comment_id": 79628301, "body": "re: last newline, because the newline count is to count how many padding characters I need to add before each line, and a terminating newline doesn&#39;t have a subsequent line that needs to be pre-padded."}, {"owner": {"reputation": 48116, "user_id": 2725969, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/t13vb.jpg?s=128&g=1", "display_name": "BrodieG", "link": "https://stackoverflow.com/users/2725969/brodieg"}, "edited": false, "score": 0, "creation_date": 1505955514, "post_id": 46332631, "comment_id": 79628308, "body": "And thanks for actually taking the time to look at the source."}, {"owner": {"reputation": 29251, "user_id": 72178, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/M3OuM.png?s=128&g=1", "display_name": "ks1322", "link": "https://stackoverflow.com/users/72178/ks1322"}, "edited": false, "score": 0, "creation_date": 1505995981, "post_id": 46332631, "comment_id": 79646997, "body": "Stack traces from full error are truncated by 12 entries (this is default). It would be helpful to see full untruncated stack traces with, say <code>--num-callers=100</code>."}, {"owner": {"reputation": 48116, "user_id": 2725969, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/t13vb.jpg?s=128&g=1", "display_name": "BrodieG", "link": "https://stackoverflow.com/users/2725969/brodieg"}, "edited": false, "score": 0, "creation_date": 1506000078, "post_id": 46332631, "comment_id": 79650141, "body": "That&#39;s useful to know; unfortunately since I don&#39;t have direct access to the machine where this happened, and I can&#39;t reproduce this on my mac or on a linux VM, I can&#39;t do this."}], "answers": [{"comments": [{"owner": {"reputation": 48116, "user_id": 2725969, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/t13vb.jpg?s=128&g=1", "display_name": "BrodieG", "link": "https://stackoverflow.com/users/2725969/brodieg"}, "edited": false, "score": 0, "creation_date": 1522200967, "post_id": 46374025, "comment_id": 86055340, "body": "This is indeed what is happening.  I was not able to reproduce this error myself because I was not running an instrumented build of R, but once I got my hands on one I was able to narrow in on the error.  I was indeed writing past the end of a small allocation from a shared page."}], "tags": [], "owner": {"reputation": 3079, "user_id": 3035584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d3f84eebae0cfccb50e3be86dad24f1?s=128&d=identicon&r=PG&f=1", "display_name": "phd", "link": "https://stackoverflow.com/users/3035584/phd"}, "is_accepted": true, "score": 1, "last_activity_date": 1506119158, "creation_date": 1506119158, "answer_id": 46374025, "question_id": 46332631, "link": "https://stackoverflow.com/questions/46332631/invalid-write-of-size-1-x-bytes-inside-a-block-of-size-x-allocd/46374025#46374025", "title": "Invalid write of size 1 X bytes **inside** a block of size &gt;X **alloc&#39;d**", "body": "<p>Such error can happen when using memory pools.</p>\n\n<p>Typically, a lib or an application (such as R) can build its own allocator\nby getting big blocks e.g. from malloc, and then allocating small blocks\nfrom these big blocks.\nValgrind has some client requests allowing to describe these blocks (big or inner smaller blocks), and their allocations.</p>\n\n<p>With such client requests, you might have a part of a malloc allocated block\nthat is in fact marked as not addressable.</p>\n\n<p>Seeing the stack trace entry :</p>\n\n<blockquote>\n  <p>==1920==    by 0x4F3D3E: GetNewPage (svn/R-devel/src/main/memory.c:879)</p>\n</blockquote>\n\n<p>the above explanation looks plausible.</p>\n\n<p>This then might be an indication that there is a real bug somewhere in R\nand/or in the way the R allocator describes its memory pool to valgrind</p>\n"}], "owner": {"reputation": 48116, "user_id": 2725969, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/t13vb.jpg?s=128&g=1", "display_name": "BrodieG", "link": "https://stackoverflow.com/users/2725969/brodieg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1123, "favorite_count": 0, "accepted_answer_id": 46374025, "answer_count": 1, "score": 0, "last_activity_date": 1506119158, "creation_date": 1505946235, "last_edit_date": 1505947542, "question_id": 46332631, "link": "https://stackoverflow.com/questions/46332631/invalid-write-of-size-1-x-bytes-inside-a-block-of-size-x-allocd", "title": "Invalid write of size 1 X bytes **inside** a block of size &gt;X **alloc&#39;d**", "body": "<p>I'm relatively new at debugging valgrind errors, and this one has me stumped:</p>\n\n<pre><code>==1920== Invalid write of size 1\n==1920==    at 0x4C2ECC7: strcpy (/builddir/build/BUILD/valgrind-3.11.0/memcheck/../shared/vg_replace_strmem.c:506)\n==1920==    by 0x1D533B57: CSR_bullet (packages/tests-vg/vetr/src/cstringr.c:448)\n            ... redacted (see end for full error)\n==1920==  Address 0x1bd1be1f is 5,599 bytes inside a block of size 7,960 alloc'd\n==1920==    at 0x4C2BBAD: malloc (/builddir/build/BUILD/valgrind-3.11.0/coregrind/m_replacemalloc/vg_replace_malloc.c:299)\n==1920==    by 0x4F3D3E: GetNewPage (svn/R-devel/src/main/memory.c:879)\n            ... redacted (see end for full error)\n</code></pre>\n\n<p>Notice this is <strong>1</strong> byte <strong>well inside</strong> an <strong>alloc'd</strong> block.  I've seen similar errors that involve writing after, or before, or into a free'd block, or even writes where the write size is greater than end of block - address (therefore overflowing), but I can't find one like this one.</p>\n\n<p>This is happening on the <a href=\"https://www.stats.ox.ac.uk/pub/bdr/memtests/valgrind/vetr/tests/run.Rout.fail\" rel=\"nofollow noreferrer\">R CRAN check farm</a> at <a href=\"https://github.com/brodieG/vetr/blob/7a57be26d4a7141931426010c2d4b813c13ec054/src/cstringr.c#L448\" rel=\"nofollow noreferrer\">this line of code</a>.</p>\n\n<p>I cannot reproduce the error locally with valgrind on OSX or on a linux VM.</p>\n\n<p>Beyond that, the error doesn't make sense to me.  Why can't I write 1 byte in the middle of the allocated block?  This is all running inside R, so it's possible I guess that the allocation in question was made by a different part of the program and it is somehow reserved (one possible hint that that's happening is that the allocations I requested from R were less than 60 bytes when the error shows up), but I don't know if that is something that valgrind would be able to detect anyway.</p>\n\n<p>Full error:</p>\n\n<pre><code>==1920== Invalid write of size 1\n==1920==    at 0x4C2ECC7: strcpy (/builddir/build/BUILD/valgrind-3.11.0/memcheck/../shared/vg_replace_strmem.c:506)\n==1920==    by 0x1D533B57: CSR_bullet (packages/tests-vg/vetr/src/cstringr.c:448)\n==1920==    by 0x1D53317D: CSR_bullet_ext (packages/tests-vg/vetr/src/cstringr-ext.c:107)\n==1920==    by 0x4852BD: do_dotcall (svn/R-devel/src/main/dotcode.c:1252)\n==1920==    by 0x4C274D: Rf_eval (svn/R-devel/src/main/eval.c:728)\n==1920==    by 0x4C3AB5: R_execClosure (svn/R-devel/src/main/eval.c:1617)\n==1920==    by 0x4C2391: Rf_eval (svn/R-devel/src/main/eval.c:747)\n==1920==    by 0x4C29E0: forcePromise (svn/R-devel/src/main/eval.c:520)\n==1920==    by 0x4C27A1: Rf_eval (svn/R-devel/src/main/eval.c:647)\n==1920==    by 0x4C7746: do_withVisible (svn/R-devel/src/main/eval.c:2998)\n==1920==    by 0x4F7104: do_internal (svn/R-devel/src/main/names.c:1363)\n==1920==    by 0x4B553B: bcEval (svn/R-devel/src/main/eval.c:6503)\n==1920==  Address 0x1bd1be1f is 5,599 bytes inside a block of size 7,960 alloc'd\n==1920==    at 0x4C2BBAD: malloc (/builddir/build/BUILD/valgrind-3.11.0/coregrind/m_replacemalloc/vg_replace_malloc.c:299)\n==1920==    by 0x4F3D3E: GetNewPage (svn/R-devel/src/main/memory.c:879)\n==1920==    by 0x4F5814: Rf_allocVector3 (svn/R-devel/src/main/memory.c:2659)\n==1920==    by 0x4CAEAF: Rf_allocVector (svn/R-devel/src/include/Rinlinedfuns.h:247)\n==1920==    by 0x4CAEAF: do_growconst (svn/R-devel/src/main/eval.c:7490)\n==1920==    by 0x4B64BD: bcEval (svn/R-devel/src/main/eval.c:6483)\n==1920==    by 0x4C2207: Rf_eval (svn/R-devel/src/main/eval.c:624)\n==1920==    by 0x4C3AB5: R_execClosure (svn/R-devel/src/main/eval.c:1617)\n==1920==    by 0x4BAE13: bcEval (svn/R-devel/src/main/eval.c:6454)\n==1920==    by 0x4C2207: Rf_eval (svn/R-devel/src/main/eval.c:624)\n==1920==    by 0x4C3AB5: R_execClosure (svn/R-devel/src/main/eval.c:1617)\n==1920==    by 0x4BAE13: bcEval (svn/R-devel/src/main/eval.c:6454)\n==1920==    by 0x4C2207: Rf_eval (svn/R-devel/src/main/eval.c:624)\n</code></pre>\n"}, {"tags": ["c", "embedded", "stm32"], "comments": [{"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 3, "creation_date": 1505946132, "post_id": 46332561, "comment_id": 79626015, "body": "It means &quot;don&#39;t tell me I&#39;m writing bad code, I <i>intended</i> not to use the argument&quot;.  C compilers are a bit anal about it and tend to generate a warning.  Often appropriately, but just not here.  He did not want to do anything special at the end of the transmission, not unusual.  The function pointer was not his choice."}, {"owner": {"reputation": 17175, "user_id": 1756636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/92f14a1f21e57ba761c7163b2d00a78a?s=128&d=identicon&r=PG&f=1", "display_name": "SomeWittyUsername", "link": "https://stackoverflow.com/users/1756636/somewittyusername"}, "reply_to_user": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1505946439, "post_id": 46332561, "comment_id": 79626140, "body": "@HansPassant This may well be due to enforced API from external party and/or for uniformity sake - for example, there can be an alternative implementation that uses the pointer."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1505946578, "post_id": 46332561, "comment_id": 79626190, "body": "Yup, that&#39;s what &quot;the function pointer was not his choice&quot; means."}], "answers": [{"comments": [{"owner": {"reputation": 491, "user_id": 8509272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/487ff5fe4697aeb326fa5092ef38f116?s=128&d=identicon&r=PG&f=1", "display_name": "savram", "link": "https://stackoverflow.com/users/8509272/savram"}, "edited": false, "score": 0, "creation_date": 1505947112, "post_id": 46332582, "comment_id": 79626336, "body": "Hm...er..why not tell the compiler not to warn instead of coding nonsense?"}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 2, "creation_date": 1505947299, "post_id": 46332582, "comment_id": 79626377, "body": "because you want warnings for places you werent aware of this is how you prevent it for the places you are.  Some compilers have a pragma or directive, but gcc and others will let you just do x=x; or perhaps as in this case x;"}, {"owner": {"reputation": 634, "user_id": 8016390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cb8a7992f3527dc9d50d8ff87de9dc9b?s=128&d=identicon&r=PG&f=1", "display_name": "Gam", "link": "https://stackoverflow.com/users/8016390/gam"}, "reply_to_user": {"reputation": 491, "user_id": 8509272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/487ff5fe4697aeb326fa5092ef38f116?s=128&d=identicon&r=PG&f=1", "display_name": "savram", "link": "https://stackoverflow.com/users/8509272/savram"}, "edited": false, "score": 2, "creation_date": 1505947318, "post_id": 46332582, "comment_id": 79626384, "body": "@savram You may want to be warn about other unused variables."}, {"owner": {"reputation": 491, "user_id": 8509272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/487ff5fe4697aeb326fa5092ef38f116?s=128&d=identicon&r=PG&f=1", "display_name": "savram", "link": "https://stackoverflow.com/users/8509272/savram"}, "edited": false, "score": 0, "creation_date": 1505947727, "post_id": 46332582, "comment_id": 79626516, "body": "Still dirty to me. It&#39;s code that relies on specific compiler behavior. What if the compiler was smart enough to actually tell that the line is nonsense and the variable is still not being used? Portable, right...until it&#39;s not anymore."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1505957130, "post_id": 46332582, "comment_id": 79628615, "body": "@Jean-Fran&#231;ois Fabre i was sure that you do not answer 10k times answered question. Some answers are many years old"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1505971066, "post_id": 46332582, "comment_id": 79631767, "body": "@PeterJ_01 first I&#39;m honoured that you thought that about me, unfortunately, I didn&#39;t know this duplicate (I&#39;m not as good at it as with python), neither did the OP (difficult to find proper keywords) so that was a &quot;weakness&quot; moment. Note that this question is rare enough (compared to the <code>scanf</code> / <code>sizeof(ptr)</code> questions we see all the time). Let&#39;s hope the duplicate will be useful for future searches."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 491, "user_id": 8509272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/487ff5fe4697aeb326fa5092ef38f116?s=128&d=identicon&r=PG&f=1", "display_name": "savram", "link": "https://stackoverflow.com/users/8509272/savram"}, "edited": false, "score": 0, "creation_date": 1505971184, "post_id": 46332582, "comment_id": 79631810, "body": "@savram I may be wrong, but the derefencing to <code>(void)</code> makes sure of that. <code>ptr,</code> alone <i>could</i> be eliminated, but not that construct. And compilers are aware of this way to eliminate the warnings, they probably aren&#39;t going to break that. And if they do, you&#39;ll just get a warning, so no big risk."}], "tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": true, "score": 12, "last_activity_date": 1506029256, "last_edit_date": 1506029256, "creation_date": 1505945904, "answer_id": 46332582, "question_id": 46332561, "link": "https://stackoverflow.com/questions/46332561/what-does-this-statement-mean-in-c-voidptr/46332582#46332582", "title": "What does this statement mean in C: &quot;(void)ptr;&quot;", "body": "<p>this is just a <a href=\"https://stackoverflow.com/questions/3599160/unused-parameter-warnings-in-c/3599170\">portable way to suppress the warning</a> on this unused <code>uart</code> parameter.</p>\n\n<p>It has no effect, but compilers see that as used, and don't issue any warning.</p>\n\n<p>Very useful when the prototype of the function is imposed / cannot be changed (callback function) but your implementation doesn't need this parameter.</p>\n\n<p>(note that <code>gcc</code> favors the <code>__attribute__((unused))</code> construct, easier to understand, but not compatible with all compilers)</p>\n"}], "owner": {"reputation": 210, "user_id": 6365535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abea4413bb3445211c7c3606a38dcd4e?s=128&d=identicon&r=PG&f=1", "display_name": "TowerFan", "link": "https://stackoverflow.com/users/6365535/towerfan"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 392, "favorite_count": 1, "closed_date": 1505968501, "accepted_answer_id": 46332582, "answer_count": 1, "score": 6, "last_activity_date": 1506029256, "creation_date": 1505945798, "question_id": 46332561, "link": "https://stackoverflow.com/questions/46332561/what-does-this-statement-mean-in-c-voidptr", "closed_reason": "Duplicate", "title": "What does this statement mean in C: &quot;(void)ptr;&quot;", "body": "<p>It may not be clear from the title. I came across the following code in an embedded STM32 project. I don't understand the line inside the function.</p>\n\n<pre><code>    static void txend1(UARTDriver *uartp) {\n        (void)uartp; // what does this do? Is it a statement?\n    }\n</code></pre>\n\n<p>I've tried searching elsewhere online, but most results are casting pointers to void pointers, which I don't think this is. Thanks for the help!</p>\n"}, {"tags": ["c", "data-structures"], "comments": [{"owner": {"reputation": 1747, "user_id": 3726902, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/kV59z.png?s=128&g=1", "display_name": "Miket25", "link": "https://stackoverflow.com/users/3726902/miket25"}, "edited": false, "score": 0, "creation_date": 1505945203, "post_id": 46332456, "comment_id": 79625678, "body": "Mmm what&#39;s your question?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1505945226, "post_id": 46332456, "comment_id": 79625687, "body": "If you have issues, do explain those issues. It&#39;s much harder to guess what&#39;s wrong."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1505946304, "post_id": 46332456, "comment_id": 79626084, "body": "Names starting with underscore at file-scope are reserved for the implementation. You must not use them."}, {"owner": {"reputation": 103, "user_id": 8586428, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/6c4d4d0a5c15989d018097e024f1e931?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/8586428/kyle"}, "edited": false, "score": 0, "creation_date": 1505946617, "post_id": 46332456, "comment_id": 79626200, "body": "I see. Will bear that in mind. Surely that doesn&#39;t affect the functionality, does it?"}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1505949674, "post_id": 46332456, "comment_id": 79627027, "body": "Probably not, but no way to know. That&#39;s the whole point of them being reserved: They could do things."}], "answers": [{"comments": [{"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1505953302, "post_id": 46333448, "comment_id": 79627846, "body": "Added to my answer."}], "tags": [], "owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": true, "score": 1, "last_activity_date": 1505954177, "last_edit_date": 1505954177, "creation_date": 1505952404, "answer_id": 46333448, "question_id": 46332456, "link": "https://stackoverflow.com/questions/46332456/insert-function-for-ternary-search-tree-c/46333448#46333448", "title": "Insert function for Ternary Search Tree - C", "body": "<p><em>Note: You confusingly use <code>tree</code> for both <code>TSTnode*</code> and <code>TSTnode**</code>. I'm going to use <code>tree_ptr</code> for the latter, and pretend that you did the same.</em></p>\n\n<hr>\n\n<p>Your claim is false. The body of <code>if((*tree_ptr) == NULL)</code> is executed. You do have a number of problems, though.</p>\n\n<ol>\n<li><p>You don't handle the case where <code>*tree_ptr == NULL &amp;&amp; *(str+position+1) != '\\0'</code>.</p></li>\n<li><p>You don't correctly handle the case where <code>*tree_ptr != NULL &amp;&amp; *(str+position+1) == '\\0'</code>.</p></li>\n<li><p>You always return <code>0</code> when <code>*tree_ptr != NULL || str[1] != '\\0'</code>.</p></li>\n<li><p>You never allocate <code>word</code>, but you deference it. The thing is, you shouldn't be storing the string again anyway!</p></li>\n<li><p>You don't handle the case where <code>str[0] == '\\0'</code> (empty string).</p></li>\n</ol>\n\n<p>Fixed:</p>\n\n<pre><code>int insert_tst(struct TSTnode** tree_ptr, const char* str) {\n    if (!*str)\n        return 0;  /* Zero-length strings are not supported. */\n\n    return insert_tst_helper(tree_ptr, str, 0);\n}\n\nint insert_tst_helper(struct TSTnode** tree_ptr, const char* str, int position) {\n    if (*tree_ptr == NULL) {\n        *tree_ptr = new_tst_node(*(str+position));\n        if (*tree_ptr == NULL)\n            return 0;  /* Memory allocation error. */\n    }\n\n    if (*(str+position+1) == '\\0') { /* If the next char is a NUL */\n        (*tree_ptr)-&gt;is_word = 1;\n        return 1;\n    }\n\n    else if ((*tree_ptr)-&gt;self &gt; *(str+position)) {\n        position = position + 1;\n        return insert_tst_helper( &amp;((*tree_ptr)-&gt;left), str, position);\n    }\n\n    else if ((*tree_ptr)-&gt;self &lt; *(str+position)) {\n        position = position + 1;\n        return insert_tst_helper( &amp;((*tree_ptr)-&gt;right), str, position);\n    }\n    else {\n        position = position + 1;\n        return insert_tst_helper( &amp;((*tree_ptr)-&gt;sub), str, position);\n    } \n}\n</code></pre>\n\n<p>Untested.</p>\n\n<hr>\n\n<p>Let's clean this up, though.</p>\n\n<ul>\n<li><code>*(str+position)</code><br>simplifies to<br><code>str[position]</code></li>\n<li><code>ch == '\\0'</code><br>simplifies to<br><code>ch == 0</code><br>then to<br><code>!ch</code></li>\n<li><code>position = position + 1; return insert_tst_helper(..., str, position);</code><br>simplifies to<br><code>++position; return insert_tst_helper(..., str, position);</code><br>then to<br><code>return insert_tst_helper(..., str, position+1);</code><br>then to<br><code>return insert_tst_helper(..., str+1, 0);</code><br>then to<br><code>return insert_tst(..., str+1);</code></li>\n<li>Why is recursion being used at all???</li>\n</ul>\n\n<p>Fixed:</p>\n\n<pre><code>int insert_tst(struct TSTnode** tree_ptr, const char* str) {\n    if (!*str)\n        return 0;  /* Zero-length strings are not supported. */\n\n    while (1) {\n        if (*tree_ptr == NULL) {\n            *tree_ptr = new_tst_node(*str);\n            if (*tree_ptr == NULL)\n                return 0;  /* Memory allocation error. */\n        }\n\n        if (!*(str+1)) { /* If the next char is a NUL */\n            (*tree_ptr)-&gt;is_word = 1;\n            return 1;\n        }\n\n        int cmp = *str - (*tree_ptr)-&gt;self;\n        if      (cmp &lt; 0) { tree_ptr = &amp;( (*tree_ptr)-&gt;left  ); }\n        else if (cmp &gt; 0) { tree_ptr = &amp;( (*tree_ptr)-&gt;right ); }\n        else              { tree_ptr = &amp;( (*tree_ptr)-&gt;sub   ); }\n\n        ++str;\n    }\n}\n</code></pre>\n\n<p>Untested.</p>\n"}], "owner": {"reputation": 103, "user_id": 8586428, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/6c4d4d0a5c15989d018097e024f1e931?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/8586428/kyle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 285, "favorite_count": 0, "accepted_answer_id": 46333448, "answer_count": 1, "score": 0, "last_activity_date": 1505954177, "creation_date": 1505945155, "last_edit_date": 1505945287, "question_id": 46332456, "link": "https://stackoverflow.com/questions/46332456/insert-function-for-ternary-search-tree-c", "title": "Insert function for Ternary Search Tree - C", "body": "<p>I am new to C and am trying to code up a data structure, primarily, a ternary search tree. I am working under the assumption (for now) that valid char inputs are being passed in. I am having some issues with my insert function. Note that I am also inserting the original string in the last TSTnode where the last character of str will also be held.</p>\n\n<p>Here is what I have so far</p>\n\n<pre><code>struct TSTnode {\n    char* word; // NULL if no word ends here\n    char self;\n    struct TSTnode *left, *sub, *right;\n};\n\n\nint insert_tst(struct TSTnode** tree, const char* str) {\n    return _insert(tree, str, 0);\n}\n\n\nint _insert(struct TSTnode** tree, const char* str, int position) {\n\n    if((*tree) == NULL) {\n        *tree = new_tst_node(*(str+position));\n        position = position + 1;\n        if(*(str+position) == '\\0') {\n            (*tree)-&gt;word = strcpy((*tree)-&gt;word,str);\n            return 1;\n        }\n    }\n\n    else if ((*tree)-&gt;self &gt; *(str+position)) {\n        position = position + 1;\n        _insert( &amp;((*tree)-&gt;left), str, position);\n    }\n\n    else if ((*tree)-&gt;self &lt; *(str+position)) {\n        position = position + 1;\n        _insert( &amp;((*tree)-&gt;right), str, position);\n    }\n    else {\n        position = position + 1;\n        _insert( &amp;((*tree)-&gt;sub), str, position);\n    } \n    return 0;\n\n}\n\n\n\n\nstruct TSTnode* new_tst_node(char self) {\n    struct TSTnode* newNode = (struct TSTnode*) malloc(sizeof(struct \nTSTnode));\n\n    if (newNode == NULL) {\n        return NULL;\n    }\n    newNode-&gt;word = NULL;\n    newNode-&gt;self = self;\n    newNode-&gt;left = NULL;\n    newNode-&gt;right = NULL;\n    newNode-&gt;sub = NULL;\n\n    return newNode;\n}    \n</code></pre>\n\n<p>Here is how I am testing:</p>\n\n<pre><code>struct TSTnode* tree = NULL;\nchar* words[1] = {\"hello\"};\n\nfor (int i = 0; i &lt; 1; i++) {\n        if (insert_tst(&amp;tree, words[i]) == 0) {\n            //print some error\n    } \n       else { //success }\n</code></pre>\n\n<p>EDIT - My issue is that none of my conditional branches are being taken and the insert function simply goes straight to return 0.</p>\n"}, {"tags": ["c", "visual-studio"], "comments": [{"owner": {"reputation": 313, "user_id": 2105501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45c64e49a69a60a94328fe105e936a3d?s=128&d=identicon&r=PG", "display_name": "Idan", "link": "https://stackoverflow.com/users/2105501/idan"}, "edited": false, "score": 0, "creation_date": 1505944799, "post_id": 46332333, "comment_id": 79625529, "body": "How many successful iterations are they?  On which line exactly do you get the error?"}, {"owner": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "edited": false, "score": 1, "creation_date": 1505944990, "post_id": 46332333, "comment_id": 79625596, "body": "<code>tempDel = pA-&gt;frames;</code> at the end of the loop is superfluous, beyond that there&#39;s nothing overly suspect about the code so we cannot help. I suggest taking a look at Eric Lippert&#39;s <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a>, and if you&#39;re still stuck, then please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. :)"}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1505945723, "post_id": 46332333, "comment_id": 79625882, "body": "#75 is nice and early.  <a href=\"https://msdn.microsoft.com/en-us/library/w2fhc9a3(VS.80).aspx\" rel=\"nofollow noreferrer\">To set a memory-allocation breakpoint in your program</a>"}, {"owner": {"reputation": 1, "user_id": 8644686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e14600fe262199ef169c9a03c46d9efe?s=128&d=identicon&r=PG&f=1", "display_name": "Viet Nguyen", "link": "https://stackoverflow.com/users/8644686/viet-nguyen"}, "edited": false, "score": 0, "creation_date": 1505995879, "post_id": 46332333, "comment_id": 79646931, "body": "Thanks for points and tips, turns out how I was memory allocating for the frameName, I dropped sizeof out of:  temp-&gt;fileName=malloc(strlen(frameName)+1); and it worked just fine"}], "owner": {"reputation": 1, "user_id": 8644686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e14600fe262199ef169c9a03c46d9efe?s=128&d=identicon&r=PG&f=1", "display_name": "Viet Nguyen", "link": "https://stackoverflow.com/users/8644686/viet-nguyen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 177, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1505995777, "creation_date": 1505944492, "last_edit_date": 1505995777, "question_id": 46332333, "link": "https://stackoverflow.com/questions/46332333/heap-corruption-detected-after-normal-block-75-at-0x00ac7c10", "title": "HEAP CORRUPTION DETECTED: after Normal block (#75) at 0x00AC7C10", "body": "<p>Working on a program that handles linked list, at the delete portion of the list, I am supposed to free up the memory allocated, I keep getting this error when debugging: <code>HEAP CORRUPTION DETECTED: after Normal block (#75) at 0x00AC7C10</code>, but I am unsure where to look, can someone point me in the right direction?</p>\n\n<pre><code>void deleteFrames(struct Animation* pA)\n{\n    //using temp struct to cycle through and free each node that is not NULL\n    struct Frame *tempDel;\n    while (pA-&gt;frames!=NULL) {\n        tempDel = pA-&gt;frames;\n        pA-&gt;frames = pA-&gt;frames-&gt;pNext;\n        free(tempDel-&gt;fileName);\n        free(tempDel);\n        tempDel = pA-&gt;frames;\n    }\n}\n</code></pre>\n\n<p>The breakpoint gets triggered on free(tempDel->fileName); I spoke to a friend and he told me it might be how I am memory allocating the string that I use to set the name of the frameName \ntemp->fileName = malloc(sizeof(strlen(frameName))+ 1);</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1505943928, "post_id": 46332188, "comment_id": 79625186, "body": "Do you need to generate an array of N containing a random permutation of numbers 1 to N? This is how your requirement sounds, and not the whole mess you have described."}, {"owner": {"reputation": 99, "user_id": 5465746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cf11f01402078db9dc8926505804c47?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph V", "link": "https://stackoverflow.com/users/5465746/joseph-v"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1505944050, "post_id": 46332188, "comment_id": 79625237, "body": "@EugeneSh. yes that would be correct I believe my code segment accomplishes that."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1505944065, "post_id": 46332188, "comment_id": 79625244, "body": "..or {0,1,2,3,4,5,6,..n}, pick a random number index from [0..n-1], take out the value there, if index not [n-1], move number at [n-1] down to that position, then go back and pick from [n-2].. rinse, repeat."}, {"owner": {"reputation": 99, "user_id": 5465746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cf11f01402078db9dc8926505804c47?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph V", "link": "https://stackoverflow.com/users/5465746/joseph-v"}, "reply_to_user": {"reputation": 1924, "user_id": 2669042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c66a47707c3d1748c9977727ddfa4d50?s=128&d=identicon&r=PG", "display_name": "xing", "link": "https://stackoverflow.com/users/2669042/xing"}, "edited": false, "score": 0, "creation_date": 1505944241, "post_id": 46332188, "comment_id": 79625304, "body": "@xing I am not sure if I could approach it that way mainly because my initial post doesn&#39;t mention it but after I fill all the positions with unused values I need to sort them (without a library function). Not sure if that makes sense or not."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1505944305, "post_id": 46332188, "comment_id": 79625328, "body": "Why without a library function? Is this homework?"}, {"owner": {"reputation": 99, "user_id": 5465746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cf11f01402078db9dc8926505804c47?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph V", "link": "https://stackoverflow.com/users/5465746/joseph-v"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1505944368, "post_id": 46332188, "comment_id": 79625357, "body": "@MartinJames not sure if I understand what you mean, would you mind elaborating a little more please?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1505944385, "post_id": 46332188, "comment_id": 79625370, "body": "Why do you add 1 to <code>UserInput</code>?"}, {"owner": {"reputation": 99, "user_id": 5465746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cf11f01402078db9dc8926505804c47?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph V", "link": "https://stackoverflow.com/users/5465746/joseph-v"}, "reply_to_user": {"reputation": 1924, "user_id": 2669042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c66a47707c3d1748c9977727ddfa4d50?s=128&d=identicon&r=PG", "display_name": "xing", "link": "https://stackoverflow.com/users/2669042/xing"}, "edited": false, "score": 0, "creation_date": 1505944500, "post_id": 46332188, "comment_id": 79625406, "body": "@xing  yes one of the 3&#39;s would be replaced with a 4."}, {"owner": {"reputation": 99, "user_id": 5465746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cf11f01402078db9dc8926505804c47?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph V", "link": "https://stackoverflow.com/users/5465746/joseph-v"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1505944631, "post_id": 46332188, "comment_id": 79625462, "body": "@Barmar I thought when doing modulus in c program gives all the values of whatever is being modded minus 1 so that is why I added it. Like if i did rand() % 6 it would only give me random numbers between 0-5 and adding the 1 would give me the six. Is this not correct?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1505944788, "post_id": 46332188, "comment_id": 79625524, "body": "<a href=\"https://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle\" rel=\"nofollow noreferrer\">Fisher-Yates</a> is &quot;more random&quot; than the one proposed. Or more uniform, strictly speaking."}, {"owner": {"reputation": 99, "user_id": 5465746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cf11f01402078db9dc8926505804c47?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph V", "link": "https://stackoverflow.com/users/5465746/joseph-v"}, "reply_to_user": {"reputation": 1924, "user_id": 2669042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c66a47707c3d1748c9977727ddfa4d50?s=128&d=identicon&r=PG", "display_name": "xing", "link": "https://stackoverflow.com/users/2669042/xing"}, "edited": false, "score": 0, "creation_date": 1505944821, "post_id": 46332188, "comment_id": 79625535, "body": "@xing so essentially what you are saying is if the user defines the array at 9 enter numbers in a sequential order from 0-8, shuffle them, then when the user asks me to sort them again just do the opposite?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1505944966, "post_id": 46332188, "comment_id": 79625585, "body": "@JosephV I meant why are you adding 1 when you do the <code>malloc()</code>."}, {"owner": {"reputation": 99, "user_id": 5465746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cf11f01402078db9dc8926505804c47?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph V", "link": "https://stackoverflow.com/users/5465746/joseph-v"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1505945339, "post_id": 46332188, "comment_id": 79625737, "body": "@Barmar All the examples for the rand function that I have seen have used the plus 1 I just assumed that is what I do. Can you do it without it when using malloc()?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1505945546, "post_id": 46332188, "comment_id": 79625817, "body": "My question had nothing to do with the rand function. I wondered why you add 1 here: <code>malloc(sizeof(int) * (UserInput +1));</code> That&#39;s making the array larger than you need."}, {"owner": {"reputation": 99, "user_id": 5465746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cf11f01402078db9dc8926505804c47?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph V", "link": "https://stackoverflow.com/users/5465746/joseph-v"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1505946092, "post_id": 46332188, "comment_id": 79626002, "body": "Sorry @Barmar I misread you comment. I was using some examples from my previous programs that used malloc() and the plus 1 was for the null terminating character, except I didn&#39;t need that, sorry about that. I completely missed that."}], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 5465746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cf11f01402078db9dc8926505804c47?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph V", "link": "https://stackoverflow.com/users/5465746/joseph-v"}, "edited": false, "score": 0, "creation_date": 1505945813, "post_id": 46332421, "comment_id": 79625915, "body": "Thank you @Barmar going to assume it is not efficient because it takes more time to accomplish it this way? What is a way you think is more efficient?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 99, "user_id": 5465746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cf11f01402078db9dc8926505804c47?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph V", "link": "https://stackoverflow.com/users/5465746/joseph-v"}, "edited": false, "score": 0, "creation_date": 1505945909, "post_id": 46332421, "comment_id": 79625949, "body": "The most efficient way is to fill in the array from 1 to n, then randomly shuffle the array."}, {"owner": {"reputation": 99, "user_id": 5465746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cf11f01402078db9dc8926505804c47?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph V", "link": "https://stackoverflow.com/users/5465746/joseph-v"}, "edited": false, "score": 0, "creation_date": 1505946316, "post_id": 46332421, "comment_id": 79626087, "body": "Ah ok, thank you why did you use calloc instead of malloc? Sorry I am still new to this."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 99, "user_id": 5465746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cf11f01402078db9dc8926505804c47?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph V", "link": "https://stackoverflow.com/users/5465746/joseph-v"}, "edited": false, "score": 0, "creation_date": 1505946366, "post_id": 46332421, "comment_id": 79626112, "body": "<code>calloc()</code> automatically zeros the memory."}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 0, "last_activity_date": 1505945884, "last_edit_date": 1505945884, "creation_date": 1505944908, "answer_id": 46332421, "question_id": 46332188, "link": "https://stackoverflow.com/questions/46332188/deleting-duplicates-in-array-and-replacing-them-with-unused-values/46332421#46332421", "title": "Deleting Duplicates in array and replacing them with unused values", "body": "<p>It's not the most efficient way, but you can do it as you're generating the random numbers. When you pick a random number, go through all the previous elements of the array and see if it's already been used. Keep looping until you pick an unused number.</p>\n\n<pre><code>for (i = 0; i &lt; UserInput; i++) {\n    do {\n        result = ( rand() % UserInput) + 1;\n    } while (in_array(result, UserData, i-1));\n    UserData[i] = result;\n}\n\n\nint in_array(int val, int* array, int array_size) {\n    for (int i = 0; i &lt; array_size; i++) {\n        if (array[i] == val) {\n            return 1;\n        }\n    }\n    return 0;\n}\n</code></pre>\n\n<p>A slightly more efficient way to do it is to initialize the array to <code>0</code>. Then instead of picking random numbers, pick a random index to fill in, and repeat this until you pick an index that contains <code>0</code>.</p>\n\n<pre><code>UserData = calloc(UserInput, sizeof(int));\nfor (i = 1; i &lt;= UserInput; i++) {\n    int index;\n    do {\n        index = rand() % UserInput;\n    } while (UserData[index] != 0)\n    UserData[index] = i;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 617, "user_id": 5435919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/309be11aae9fe4f6260eb76bac96f916?s=128&d=identicon&r=PG&f=1", "display_name": "hassan arafat", "link": "https://stackoverflow.com/users/5435919/hassan-arafat"}, "is_accepted": false, "score": 0, "last_activity_date": 1505962433, "last_edit_date": 1505962433, "creation_date": 1505961573, "answer_id": 46334583, "question_id": 46332188, "link": "https://stackoverflow.com/questions/46332188/deleting-duplicates-in-array-and-replacing-them-with-unused-values/46334583#46334583", "title": "Deleting Duplicates in array and replacing them with unused values", "body": "<p>What you can do is shuffle the array instead. Just fill the array with all the numbers in order using a simple for loop, then shuffle it with something like this:</p>\n\n<pre><code>//read user input\n//create array and fill with all the numbers in order\n//[0,1,2,3,4,5 .. ... ]\nint index, temp;\n\n// size is the size of the array\nfor(int i = 0; i &lt; size; i++)\n{\n    index = rand()%size;//random place to pick from\n    temp = array[i];\n    array[i] = array[index];\n    array[index] = temp;\n}\n</code></pre>\n\n<p>This is a lot more effecient -and less error prone- than your current approach.</p>\n"}], "owner": {"reputation": 99, "user_id": 5465746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cf11f01402078db9dc8926505804c47?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph V", "link": "https://stackoverflow.com/users/5465746/joseph-v"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 118, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1506114968, "creation_date": 1505943761, "last_edit_date": 1506114968, "question_id": 46332188, "link": "https://stackoverflow.com/questions/46332188/deleting-duplicates-in-array-and-replacing-them-with-unused-values", "title": "Deleting Duplicates in array and replacing them with unused values", "body": "<p>My objective for this program is to let the user determine the size of the array and dynamically allocate memory for whatever size they choose. Once the user defines the size of the array, random numbers that do no exceed the size of the array are placed into all of the allotted positions. Where I am having issues is removing duplicates from the array and replacing them with a value that is not being used,<br>\nExample:</p>\n\n<pre><code>Please enter the size of the array:\n\nUser Input: 5 \n\nOutput of code: 5, 3, 3, 1, 2\n</code></pre>\n\n<p><strong>I would need it to be something like this:</strong></p>\n\n<pre><code>Please enter the size of the array:\n\nUser Input: 3\n\nOutput of program: 3, 1, 2\n</code></pre>\n\n<p>Currently reading \"C Programming - A Modern Approach\" by K.N. King (Second Edition).</p>\n\n<p>if someone could point me in the right direction on how to approach this, it would be much appreciated.Here is my code thus far.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#define true 1\n#define false 0\n\ntypedef int bool;\n\n\nint main() {\n\nint *UserData;\nint TempPost;\nint replace;\nint UserInput;\nint i;\nint result;\nbool digit_seen[UserInput];\nint digit;\nsrand ((unsigned) time(NULL));\n\nprintf(\"Please enter the size of the array using a whole number: \\n\");\nscanf(\"%d\", &amp;UserInput);\n\n\nUserData = malloc(sizeof(int) * (UserInput ) +1);\n\n\n for(i=0; i &lt; UserInput; i ++) {\n\n    result = (( rand() % UserInput) + 1);\n\n }\n\n    // check for duplicate values while putting values in array\n\n    while(UserInput&gt;0){\n\n        digit = UserInput % UserInput;\n          if(digit_seen[digit])\n              break;\n\n          digit_seen[digit] = true;\n          UserInput /= UserInput;\n\n          if(UserInput &gt; 0)\n              printf(\"Repeated digit \\n\");\n          else\n              printf(\"No repeated digit \\n\");\n\n\n    }\n\n  // Sorting the array using a Bubble sort\n\n        while(1){\n\n            replace = 0;\n\n\n            for (i=0; i&lt;(UserInput - 1); i++){\n\n\n                if(UserData[i]&gt;UserData[i+1]){\n\n                    TempPost = UserData[i];\n                    UserData[i] = UserData[i+1];\n                    UserData[i+1] = TempPost;\n\n                    replace = 1;\n\n\n                }\n\n\n            }\n\n\n          if(replace==0){\n\n              break;\n          } \n\n\n\n        }\n\n    printf(\"%d \\n\", result);\n\n\n\n return 0;\n}\n</code></pre>\n"}, {"tags": ["java", "android", "c", "android-ndk", "java-native-interface"], "answers": [{"comments": [{"owner": {"reputation": 2537, "user_id": 1720829, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e2DBe.png?s=128&g=1", "display_name": "Nathan F.", "link": "https://stackoverflow.com/users/1720829/nathan-f"}, "edited": false, "score": 0, "creation_date": 1505945812, "post_id": 46332558, "comment_id": 79625914, "body": "I posted my answer right before yours as I had figured it out on my own, but I appreciate the response and I&#39;ll mark your answer as the correct one instead of mine."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 1, "creation_date": 1506058015, "post_id": 46332558, "comment_id": 79674509, "body": "There&#39;s nothing special about <code>FindClass()</code> here. <i>Everything</i> that returns references returns local references, except for <code>NewGlobalRef()</code> and <code>NewWeakGlobalRef()</code>."}], "tags": [], "owner": {"reputation": 3071, "user_id": 3166697, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGEWy.jpg?s=128&g=1", "display_name": "Dima Kozhevin", "link": "https://stackoverflow.com/users/3166697/dima-kozhevin"}, "is_accepted": true, "score": 1, "last_activity_date": 1505946144, "last_edit_date": 1505946144, "creation_date": 1505945772, "answer_id": 46332558, "question_id": 46332147, "link": "https://stackoverflow.com/questions/46332147/call-static-java-method-from-separate-thread-using-jni/46332558#46332558", "title": "Call static Java method from separate thread using JNI", "body": "<p>It turns out that the <code>FindClass</code> method only returns local references, not global. In order to make this work you need to make it a global reference. You can do this as demonstrated below. </p>\n\n<pre><code>// Replace\n\n    sc_class = (*env)-&gt;FindClass(env, \"com/my/package/StateController\");\n\n// With\n\n    sc_class = (*env)-&gt;NewGlobalRef(\n        env, \n        (*env)-&gt;FindClass(\n            env, \n            \"com/my/package/StateController\"\n        )\n    );\n\n// Later when you are done with the class reference, run this to free it.\n\n    (*env)-&gt;DeleteGlobalRef(env, sc_class);\n</code></pre>\n\n<p>From Android Docs:</p>\n\n<blockquote>\n  <p>Bug: Mistakenly assuming FindClass() returns global references</p>\n  \n  <p>FindClass() returns local references. Many people assume otherwise. In a system without class unloading (like Android), you can treat jfieldID and jmethodID as if they were global. (They\u2019re not actually references, but in a system with class unloading there are similar lifetime issues.) But jclass is a reference, and FindClass() returns local references. A common bug pattern is \u201cstatic jclass\u201d. Unless you\u2019re manually turning your local references into global references, your code is broken.</p>\n  \n  <p><a href=\"https://android-developers.googleblog.com/2011/11/jni-local-reference-changes-in-ics.html\" rel=\"nofollow noreferrer\">https://android-developers.googleblog.com/2011/11/jni-local-reference-changes-in-ics.html</a></p>\n</blockquote>\n"}], "owner": {"reputation": 2537, "user_id": 1720829, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e2DBe.png?s=128&g=1", "display_name": "Nathan F.", "link": "https://stackoverflow.com/users/1720829/nathan-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 766, "favorite_count": 0, "accepted_answer_id": 46332558, "answer_count": 1, "score": 2, "last_activity_date": 1505946144, "creation_date": 1505943554, "last_edit_date": 1505946133, "question_id": 46332147, "link": "https://stackoverflow.com/questions/46332147/call-static-java-method-from-separate-thread-using-jni", "title": "Call static Java method from separate thread using JNI", "body": "<p>I'm trying to use JNI in android to make a function pointer that a native library I'm using uses forward it's call to java. </p>\n\n<p>When <code>initializeStateController</code> is called, a new thread is made using <code>pthread_create</code> that calls the function pointer whenever the state of the State Controller changes. </p>\n\n<p>However, when I try to call <code>GetStaticMethodID</code> from <code>state_exec</code> in C, I'm getting the following error: </p>\n\n<pre><code>JNI DETECTED ERROR IN APPLICATION: jclass is an invalid local reference: 0xec500019 (0xdead4321) in call to GetStaticMethodID\n</code></pre>\n\n<p>This is my current code: </p>\n\n<p><strong>C Code</strong></p>\n\n<pre><code>state_controller *controller;\nJavaVM* gJvm = NULL;\nstatic jclass sc_class;\n\nJNIEnv* getEnv() {\n    JNIEnv *env;\n    int status = (*gJvm)-&gt;GetEnv(gJvm, (void**)&amp;env, JNI_VERSION_1_6);\n    if(status &lt; 0) {\n         status = (*gJvm)-&gt;AttachCurrentThread(gJvm, &amp;env, NULL);\n        if(status &lt; 0) {\n            return NULL;\n        }\n    }\n    return env;\n}\n\nJNIEXPORT jint JNICALL JNI_OnLoad(JavaVM* pjvm, void* reserved) {\n    gJvm = pjvm;\n    JNIEnv *env = getEnv();\n\n    sc_class = (*env)-&gt;FindClass(env, \"com/my/package/StateController\");\n\n    return JNI_VERSION_1_6;\n}\n\nint state_exec(int state, int from) {\n    JNIEnv *env = getEnv();\n    jmethodID mid = (*env)-&gt;GetStaticMethodID(env, sc_class, \"stateExec\",\"(II)I\");\n    jint result = (*env)-&gt;CallStaticIntMethod(env, sc_class, mid, state, from);\n\n    return (int) result;\n}\n\n// This part is unimportant.\n// This is just where I hand the function pointer\n// to the library to use.\n\nJNIEXPORT void JNICALL \nJava_com_my_package_StateController_initializeStateController\n(\n        JNIEnv *env,\n        jobject jobj\n) {\n    controller = new_state_controller(\n        state_exec\n    );\n    sc_start_controller(controller);\n}\n</code></pre>\n\n<p><strong>Java</strong></p>\n\n<pre><code>package com.my.package;\n\nclass StateController {\n\n    public native void initializeStateController();\n\n    public static int stateExec(int state, int from) {\n        Log.d(\"StateTest\", \"State \" + state + \" -&gt; \" + from);\n        return 0;\n    }\n}\n\n. . . \n\n(new StateController()).initializeStateController();\n</code></pre>\n"}, {"tags": ["c", "printf", "cortex-m"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1505944534, "post_id": 46332109, "comment_id": 79625425, "body": "We seem to have very different ideas about what a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> is."}, {"owner": {"reputation": 1484, "user_id": 3780573, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/81f2ae844e72da9de5163cd2593f000a?s=128&d=identicon&r=PG&f=1", "display_name": "thndrwrks", "link": "https://stackoverflow.com/users/3780573/thndrwrks"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1505945916, "post_id": 46332109, "comment_id": 79625952, "body": "Sorry for the verbosity. I don&#39;t know what else to remove from the example files above. My inspiration was <a href=\"https://electronics.stackexchange.com/questions/224618/minimal-code-required-to-startup-a-stm32f4\" title=\"minimal code required to startup a stm32f4\">electronics.stackexchange.com/questions/224618/&hellip;</a> but with semihosting enabled. I tried to include just the information required to compile and debug my target microcontroller."}, {"owner": {"reputation": 1484, "user_id": 3780573, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/81f2ae844e72da9de5163cd2593f000a?s=128&d=identicon&r=PG&f=1", "display_name": "thndrwrks", "link": "https://stackoverflow.com/users/3780573/thndrwrks"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1505945984, "post_id": 46332109, "comment_id": 79625973, "body": "Perhaps I should have posted in electronics.stackexchange?"}], "owner": {"reputation": 1484, "user_id": 3780573, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/81f2ae844e72da9de5163cd2593f000a?s=128&d=identicon&r=PG&f=1", "display_name": "thndrwrks", "link": "https://stackoverflow.com/users/3780573/thndrwrks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 416, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1505943351, "creation_date": 1505943351, "question_id": 46332109, "link": "https://stackoverflow.com/questions/46332109/semihosting-printf-fails-in-malloc-r", "title": "Semihosting printf fails in _malloc_r", "body": "<p>I'm trying to get a minimal project with printf semihosting (printf over JTAG) working on a <a href=\"http://www.st.com/en/evaluation-tools/32f746gdiscovery.html\" rel=\"nofollow noreferrer\">STM32F746NG Discovery</a> development board and I'm running into trouble when printf is called. I'm at a loss for how to proceed in debugging this issue.</p>\n\n<p>Here's the symptoms. The HardFault_Handler is called from _malloc_r which gets called by printf. Here is the stack when the HardFault_Handler is entered:</p>\n\n<pre><code>#0  0x08000424 in HardFault_Handler () at startup.c:155\n#1  &lt;signal handler called&gt;\n#2  0x08000d28 in _malloc_r ()\n#3  0x0800215c in __smakebuf_r ()\n#4  0x08002066 in __swsetup_r ()\n#5  0x08001972 in __sfvwrite_r ()\n#6  0x080018b2 in _puts_r ()\n#7  0x0800036a in main () at main.c:41\n</code></pre>\n\n<p>The instruction at _malloc_r+96 causes the hard fault. If I set a breakpoint at _malloc_r+96 and continue 3 times, the processor hard faults after stepping over _malloc_r+96 the third time. Here is the output from GDB with the register information.</p>\n\n<pre><code>GNU gdb (GNU Tools for ARM Embedded Processors 6-2017-q1-update) 7.12.1.20170215\n-git\nCopyright (C) 2017 Free Software Foundation, Inc.\nLicense GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;\nThis is free software: you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.  Type \"show copying\"\nand \"show warranty\" for details.\nThis GDB was configured as \"--host=i686-w64-mingw32 --target=arm-none-eabi\".\nType \"show configuration\" for configuration details.\nFor bug reporting instructions, please see:\n&lt;http://www.gnu.org/software/gdb/bugs/&gt;.\nFind the GDB manual and other documentation resources online at:\n&lt;http://www.gnu.org/software/gdb/documentation/&gt;.\nFor help, type \"help\".\nType \"apropos word\" to search for commands related to \"word\".\nResetting target\nSelect auto target interface speed (2000 kHz)\nSelecting device: STM32F746NG\nSemi-hosting enabled (Handle on BKPT)\nSemihosting I/O set to TELNET and GDB Client\nLoading section .vectors, size 0x1c8 lma 0x8000000\nLoading section .text, size 0x1fe4 lma 0x8000200\nLoading section .rodata, size 0x1c lma 0x80021e4\nLoading section .init_array, size 0x8 lma 0x8002200\nLoading section .fini_array, size 0x4 lma 0x8002208\nLoading section .data, size 0x848 lma 0x800220c\nStart address 0x8000384, load size 10780\nTransfer rate: 1315 KB/sec, 1796 bytes/write.\nResetting target\n(gdb) b *_malloc_r+96\nBreakpoint 1 at 0x8000ce8\n(gdb) display/i $pc\n1: x/i $pc\n=&gt; 0x8000384 &lt;Reset_Handler&gt;:   push    {r7, lr}\n(gdb) c\nContinuing.\n\nBreakpoint 1, 0x08000ce8 in _malloc_r ()\n1: x/i $pc\n=&gt; 0x8000ce8 &lt;_malloc_r+96&gt;:    ldr     r3, [r4, #4]\n(gdb) i r\nr0             0x49     73\nr1             0x20000678       536872568\nr2             0x1      1\nr3             0x20000680       536872576\nr4             0x84882528       2223514920\nr5             0x20000008       536870920\nr6             0x408    1032\nr7             0x20000438       536871992\nr8             0x0      0\nr9             0x0      0\nr10            0x0      0\nr11            0x0      0\nr12            0xffffffff       4294967295\nsp             0x2004fb28       0x2004fb28\nlr             0x48     72\npc             0x8000ce8        0x8000ce8 &lt;_malloc_r+96&gt;\nxpsr           0x91090000       2433286144\nmsp            0x2004fb28       537197352\npsp            0x0      0\nprimask        0x0      0\nbasepri        0x0      0\nfaultmask      0x0      0\ncontrol        0x0      0\n(gdb) c\nContinuing.\n\nBreakpoint 1, 0x08000ce8 in _malloc_r ()\n1: x/i $pc\n=&gt; 0x8000ce8 &lt;_malloc_r+96&gt;:    ldr     r3, [r4, #4]\n(gdb) i r\nr0             0x49     73\nr1             0x20000678       536872568\nr2             0xfffffbf8       4294966264\nr3             0x0      0\nr4             0x0      0\nr5             0x20000008       536870920\nr6             0x408    1032\nr7             0x20000438       536871992\nr8             0x0      0\nr9             0x0      0\nr10            0x0      0\nr11            0x0      0\nr12            0xffffffff       4294967295\nsp             0x2004fb28       0x2004fb28\nlr             0x48     72\npc             0x8000ce8        0x8000ce8 &lt;_malloc_r+96&gt;\nxpsr           0x21090000       554237952\nmsp            0x2004fb28       537197352\npsp            0x0      0\nprimask        0x0      0\nbasepri        0x0      0\nfaultmask      0x0      0\ncontrol        0x0      0\n(gdb) c\nContinuing.\n\nBreakpoint 1, 0x08000ce8 in _malloc_r ()\n1: x/i $pc\n=&gt; 0x8000ce8 &lt;_malloc_r+96&gt;:    ldr     r3, [r4, #4]\n(gdb) i r\nr0             0x49     73\nr1             0x20000678       536872568\nr2             0xbbc234f0       3150066928\nr3             0xbbc238f8       3150067960\nr4             0x77f2eed6       2012409558\nr5             0x20000008       536870920\nr6             0x408    1032\nr7             0x20000438       536871992\nr8             0x0      0\nr9             0x0      0\nr10            0x0      0\nr11            0x0      0\nr12            0xffffffff       4294967295\nsp             0x2004fb28       0x2004fb28\nlr             0x48     72\npc             0x8000ce8        0x8000ce8 &lt;_malloc_r+96&gt;\nxpsr           0x81090000       2164850688\nmsp            0x2004fb28       537197352\npsp            0x0      0\nprimask        0x0      0\nbasepri        0x0      0\nfaultmask      0x0      0\ncontrol        0x0      0\n(gdb) si\n0x080003ec in HardFault_Handler () at startup.c:149\n149     void HardFault_Handler(void) { while(1) { } }\n1: x/i $pc\n=&gt; 0x80003ec &lt;HardFault_Handler+4&gt;:\n    b.n 0x80003ec &lt;HardFault_Handler+4&gt;\n(gdb) i r\nr0             0x49     73\nr1             0x20000678       536872568\nr2             0xbbc234f0       3150066928\nr3             0xbbc238f8       3150067960\nr4             0x77f2eed6       2012409558\nr5             0x20000008       536870920\nr6             0x408    1032\nr7             0x2004fb04       537197316\nr8             0x0      0\nr9             0x0      0\nr10            0x0      0\nr11            0x0      0\nr12            0xffffffff       4294967295\nsp             0x2004fb04       0x2004fb04\nlr             0xfffffff9       4294967289\npc             0x80003ec        0x80003ec &lt;HardFault_Handler+4&gt;\nxpsr           0x81090003       2164850691\nmsp            0x2004fb04       537197316\npsp            0x0      0\nprimask        0x0      0\nbasepri        0x0      0\nfaultmask      0x0      0\ncontrol        0x0      0\n(gdb)\n</code></pre>\n\n<p>It looks like $r4 is getting clobbered. I'm at a complete loss as to how to debug and fix this issue. Am I not initializing the C environment correctly in startup.c? Am I not defining something correctly in the linker? Let me know if I need to add more information, clarify something, or try some test.</p>\n\n<p>Some other details:</p>\n\n<ul>\n<li>STM32F746NG Discovery board. The onboard STLink debugger was reprogrammed using Segger's <a href=\"https://www.segger.com/products/debug-probes/j-link/models/other-j-links/st-link-on-board/\" rel=\"nofollow noreferrer\">STLinkReflash</a> utility.</li>\n<li>GNU Tools ARM Embedded - 6 2017-q1-update</li>\n<li>Windows 7 x64</li>\n</ul>\n\n<hr>\n\n<h2>startup.c</h2>\n\n<pre><code>#include &lt;stdint.h&gt;\n#include &lt;string.h&gt;    \n\nvoid Reset_Handler(void);\n// __attribute__((weak, alias(\"Default_Handler\"))) void NMI_Handler(void);\n// __attribute__((weak, alias(\"Default_Handler\"))) void HardFault_Handler(void);\n// __attribute__((weak, alias(\"Default_Handler\"))) void MemManage_Handler(void);\n// __attribute__((weak, alias(\"Default_Handler\"))) void BusFault_Handler(void);\n// __attribute__((weak, alias(\"Default_Handler\"))) void UsageFault_Handler(void);\n// __attribute__((weak, alias(\"Default_Handler\"))) void SVC_Handler(void);\n// __attribute__((weak, alias(\"Default_Handler\"))) void DebugMon_Handler(void);\n// __attribute__((weak, alias(\"Default_Handler\"))) void PendSV_Handler(void);\n// __attribute__((weak, alias(\"Default_Handler\"))) void SysTick_Handler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void WWDG_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void PVD_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void TAMP_STAMP_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void RTC_WKUP_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void FLASH_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void RCC_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void EXTI0_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void EXTI1_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void EXTI2_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void EXTI3_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void EXTI4_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void DMA1_Stream0_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void DMA1_Stream1_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void DMA1_Stream2_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void DMA1_Stream3_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void DMA1_Stream4_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void DMA1_Stream5_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void DMA1_Stream6_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void ADC_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void CAN1_TX_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void CAN1_RX0_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void CAN1_RX1_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void CAN1_SCE_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void EXTI9_5_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void TIM1_BRK_TIM9_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void TIM1_UP_TIM10_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void TIM1_TRG_COM_TIM11_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void TIM1_CC_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void TIM2_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void TIM3_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void TIM4_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void I2C1_EV_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void I2C1_ER_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void I2C2_EV_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void I2C2_ER_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void SPI1_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void SPI2_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void USART1_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void USART2_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void USART3_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void EXTI15_10_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void RTC_Alarm_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void OTG_FS_WKUP_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void TIM8_BRK_TIM12_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void TIM8_UP_TIM13_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void TIM8_TRG_COM_TIM14_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void TIM8_CC_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void DMA1_Stream7_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void FMC_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void SDMMC1_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void TIM5_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void SPI3_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void UART4_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void UART5_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void TIM6_DAC_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void TIM7_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void DMA2_Stream0_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void DMA2_Stream1_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void DMA2_Stream2_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void DMA2_Stream3_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void DMA2_Stream4_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void ETH_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void ETH_WKUP_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void CAN2_TX_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void CAN2_RX0_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void CAN2_RX1_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void CAN2_SCE_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void OTG_FS_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void DMA2_Stream5_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void DMA2_Stream6_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void DMA2_Stream7_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void USART6_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void I2C3_EV_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void I2C3_ER_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void OTG_HS_EP1_OUT_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void OTG_HS_EP1_IN_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void OTG_HS_WKUP_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void OTG_HS_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void DCMI_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void RNG_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void FPU_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void UART7_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void UART8_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void SPI4_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void SPI5_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void SPI6_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void SAI1_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void LTDC_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void LTDC_ER_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void DMA2D_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void SAI2_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void QUADSPI_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void LPTIM1_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void CEC_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void I2C4_EV_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void I2C4_ER_IRQHandler(void);\n__attribute__((weak, alias(\"Default_Handler\"))) void SPDIF_RX_IRQHandler(void);\n\n\nextern int main(void);\nextern void SystemInit(void);\nextern void __stack(void);\n\nextern unsigned _sidata;\nextern unsigned _sdata;\nextern unsigned _edata;\nextern unsigned _sbss;\nextern unsigned _ebss;\n\n\nvoid Reset_Handler(void)\n{   \n    SystemInit();\n\n    memcpy(&amp;_sdata, &amp;_sidata, &amp;_edata - &amp;_sdata);\n    memset(&amp;_sbss, 0, &amp;_ebss - &amp;_sbss);\n\n    main();\n}\n\n\nvoid Default_Handler(void)\n{\n    /* Spin forever */\n    while(1) { }\n}\n\n\nvoid NMI_Handler(void) { while(1) { } }\nvoid HardFault_Handler(void) { while(1) { } }\nvoid MemManage_Handler(void) { while(1) { } }\nvoid BusFault_Handler(void) { while(1) { } }\nvoid UsageFault_Handler(void) { while(1) { } }\nvoid SVC_Handler(void) { while(1) { } }\nvoid DebugMon_Handler(void) { while(1) { } }\nvoid PendSV_Handler(void) { while(1) { } }\nvoid SysTick_Handler(void) { while(1) { } }\n\n\nvoid __attribute__ ((section(\".vectors\"))) (*const vector_table[])(void) = \n{\n    &amp;__stack,\n    Reset_Handler,\n\n    NMI_Handler,\n    HardFault_Handler,\n    MemManage_Handler,\n    BusFault_Handler,\n    UsageFault_Handler,\n    0,\n    0,\n    0,\n    0,\n    SVC_Handler,\n    DebugMon_Handler,\n    0,\n    PendSV_Handler,\n    SysTick_Handler,\n\n    /* External Interrupts */\n    WWDG_IRQHandler,\n    PVD_IRQHandler,\n    TAMP_STAMP_IRQHandler,\n    RTC_WKUP_IRQHandler,\n    FLASH_IRQHandler,\n    RCC_IRQHandler,\n    EXTI0_IRQHandler,\n    EXTI1_IRQHandler,\n    EXTI2_IRQHandler,\n    EXTI3_IRQHandler,\n    EXTI4_IRQHandler,\n    DMA1_Stream0_IRQHandler,\n    DMA1_Stream1_IRQHandler,\n    DMA1_Stream2_IRQHandler,\n    DMA1_Stream3_IRQHandler,\n    DMA1_Stream4_IRQHandler,\n    DMA1_Stream5_IRQHandler,\n    DMA1_Stream6_IRQHandler,\n    ADC_IRQHandler,\n    CAN1_TX_IRQHandler,\n    CAN1_RX0_IRQHandler,\n    CAN1_RX1_IRQHandler,\n    CAN1_SCE_IRQHandler,\n    EXTI9_5_IRQHandler,\n    TIM1_BRK_TIM9_IRQHandler,\n    TIM1_UP_TIM10_IRQHandler,\n    TIM1_TRG_COM_TIM11_IRQHandler,\n    TIM1_CC_IRQHandler,\n    TIM2_IRQHandler,\n    TIM3_IRQHandler,\n    TIM4_IRQHandler,\n    I2C1_EV_IRQHandler,\n    I2C1_ER_IRQHandler,\n    I2C2_EV_IRQHandler,\n    I2C2_ER_IRQHandler,\n    SPI1_IRQHandler,\n    SPI2_IRQHandler,\n    USART1_IRQHandler,\n    USART2_IRQHandler,\n    USART3_IRQHandler,\n    EXTI15_10_IRQHandler,\n    RTC_Alarm_IRQHandler,\n    OTG_FS_WKUP_IRQHandler,\n    TIM8_BRK_TIM12_IRQHandler,\n    TIM8_UP_TIM13_IRQHandler,\n    TIM8_TRG_COM_TIM14_IRQHandler,\n    TIM8_CC_IRQHandler,\n    DMA1_Stream7_IRQHandler,\n    FMC_IRQHandler,\n    SDMMC1_IRQHandler,\n    TIM5_IRQHandler,\n    SPI3_IRQHandler,\n    UART4_IRQHandler,\n    UART5_IRQHandler,\n    TIM6_DAC_IRQHandler,\n    TIM7_IRQHandler,\n    DMA2_Stream0_IRQHandler,\n    DMA2_Stream1_IRQHandler,\n    DMA2_Stream2_IRQHandler,\n    DMA2_Stream3_IRQHandler,\n    DMA2_Stream4_IRQHandler,\n    ETH_IRQHandler,\n    ETH_WKUP_IRQHandler,\n    CAN2_TX_IRQHandler,\n    CAN2_RX0_IRQHandler,\n    CAN2_RX1_IRQHandler,\n    CAN2_SCE_IRQHandler,\n    OTG_FS_IRQHandler,\n    DMA2_Stream5_IRQHandler,\n    DMA2_Stream6_IRQHandler,\n    DMA2_Stream7_IRQHandler,\n    USART6_IRQHandler,\n    I2C3_EV_IRQHandler,\n    I2C3_ER_IRQHandler,\n    OTG_HS_EP1_OUT_IRQHandler,\n    OTG_HS_EP1_IN_IRQHandler,\n    OTG_HS_WKUP_IRQHandler,\n    OTG_HS_IRQHandler,\n    DCMI_IRQHandler,\n    0,\n    RNG_IRQHandler,\n    FPU_IRQHandler,\n    UART7_IRQHandler,\n    UART8_IRQHandler,\n    SPI4_IRQHandler,\n    SPI5_IRQHandler,\n    SPI6_IRQHandler,\n    SAI1_IRQHandler,\n    LTDC_IRQHandler,\n    LTDC_ER_IRQHandler,\n    DMA2D_IRQHandler,\n    SAI2_IRQHandler,\n    QUADSPI_IRQHandler,\n    LPTIM1_IRQHandler,\n    CEC_IRQHandler,\n    I2C4_EV_IRQHandler,\n    I2C4_ER_IRQHandler,\n    SPDIF_RX_IRQHandler,\n};\n</code></pre>\n\n<h2>main.c</h2>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nextern void initialise_monitor_handles(void);\n\nint main(void)\n{   \n    initialise_monitor_handles();\n\n    printf(\"Hello world!\\n\");\n\n    return 0;\n}\n\nvoid SystemInit(void)\n{\n\n}\n</code></pre>\n\n<h2>memory.ld</h2>\n\n<pre><code>ENTRY(Reset_Handler)\n\n__heap_size = 0x200;\n__stack_size = 0x400;\n\nMEMORY\n{\n    FLASH (rx) : ORIGIN = 0x08000000, LENGTH = 1024K\n    RAM (xrw)  : ORIGIN = 0x20000000, LENGTH = 320K\n}\n\nGROUP(\n    libgcc.a\n    libg.a\n    libc.a\n    libm.a\n    libnosys.a\n    librdimon.a\n)\n\nSECTIONS\n{\n    /***********************************************************************************************/\n    /* VECTOR TABLE                                                                                */\n    /***********************************************************************************************/\n    .vectors :\n    {\n        . = ALIGN(4);\n        KEEP(*(.vectors))\n        . = ALIGN(4);\n    } &gt; FLASH\n\n\n    /***********************************************************************************************/\n    /* PROGRAM CODE                                                                                */\n    /***********************************************************************************************/\n    .text :\n    {\n        . = ALIGN(4);\n        *(.text)           /* .text sections (code) */\n        *(.text*)          /* .text* sections (code) */\n        *(.glue_7)         /* glue arm to thumb code */\n        *(.glue_7t)        /* glue thumb to arm code */\n        *(.eh_frame)\n\n        KEEP (*(.init))\n        KEEP (*(.fini))\n\n        . = ALIGN(4);\n        _etext = .;        /* define a global symbols at end of code */\n    } &gt; FLASH\n\n\n    /***********************************************************************************************/\n    /* CONSTANT DATA                                                                               */\n    /***********************************************************************************************/\n    .rodata :\n    {\n        . = ALIGN(4);\n        __rodata_start__ = .;\n        *(.rodata)         /* .rodata sections (constants, strings, etc.) */\n        *(.rodata*)        /* .rodata* sections (constants, strings, etc.) */\n        . = ALIGN(4);\n        __rodata_end__ = .;\n    } &gt; FLASH\n\n    .ARM.extab : \n    {\n        *(.ARM.extab* .gnu.linkonce.armextab.*)\n    } &gt; FLASH\n\n    .ARM.exidx :\n    {\n        __exidx_start = .;\n        *(.ARM.exidx* .gnu.linkonce.armexidx.*)\n        __exidx_end = .;\n    } &gt; FLASH\n\n    .preinit_array :\n    {\n        PROVIDE_HIDDEN (__preinit_array_start = .);\n        KEEP (*(.preinit_array*))\n        PROVIDE_HIDDEN (__preinit_array_end = .);\n    } &gt; FLASH\n\n    .init_array :\n    {\n        PROVIDE_HIDDEN (__init_array_start = .);\n        KEEP (*(SORT(.init_array.*)))\n        KEEP (*(.init_array*))\n        PROVIDE_HIDDEN (__init_array_end = .);\n    } &gt; FLASH\n\n    .fini_array :\n    {\n        PROVIDE_HIDDEN (__fini_array_start = .);\n        KEEP (*(SORT(.fini_array.*)))\n        KEEP (*(.fini_array*))\n        PROVIDE_HIDDEN (__fini_array_end = .);\n    } &gt; FLASH\n\n    _etext = .;\n\n\n    /***********************************************************************************************/\n    /* INITIALIZED DATA                                                                            */\n    /***********************************************************************************************/\n    .data : ALIGN(4)\n    {\n        . = ALIGN(4);\n        _sidata = LOADADDR(.data);\n        _sdata = .;\n        __data_start__ = .;\n        *(.data)\n        *(.data*)\n\n        . = ALIGN(4);\n        _edata = .;\n        __data_end__ = .;\n    } &gt; RAM AT &gt; FLASH\n\n\n    /***********************************************************************************************/\n    /* UNINITIALIZED DATA                                                                          */\n    /***********************************************************************************************/\n    .bss (NOLOAD) : ALIGN(4)\n    {\n        . = ALIGN(4);\n        PROVIDE(_sbss = .);\n        __bss_start__ = .;\n        *(.bss)\n        *(.bss*)\n        *(COMMON)\n\n        . = ALIGN(4);\n        PROVIDE(_ebss = .);         /* define a global symbol at bss end */\n        __bss_end__ = .;\n    } &gt; RAM\n\n\n    /***********************************************************************************************/\n    /* USER HEAP                                                                                   */\n    /***********************************************************************************************/\n    .heap (NOLOAD) : ALIGN(4)\n    {\n        . = ALIGN(4);\n        PROVIDE(end = .);\n        __heap_start = .;\n        __heap_base__ = .;\n        . = . + __heap_size;\n        __heap_end = .;\n        __HeapLimit = .;\n    } &gt; RAM\n\n\n    /***********************************************************************************************/\n    /* USER STACK                                                                                  */\n    /***********************************************************************************************/\n    .stack ORIGIN(RAM) + LENGTH(RAM) - __stack_size (NOLOAD) :\n    {\n        __stack_start = .;\n        __stack = .;\n        *(.stack)\n        . = . + __stack_size;\n        __stack_end = .;\n        __StackLimit = .;\n    } &gt; RAM\n\n\n    /* Remove information from the standard libraries */\n    /*/DISCARD/ :\n    {\n        libc.a ( * )\n        libm.a ( * )\n        libgcc.a ( * )\n    }*/\n\n    .ARM.attributes 0 : { *(.ARM.attributes) }\n}\n</code></pre>\n\n<h2>makefile</h2>\n\n<pre><code>CC   = arm-none-eabi-gcc\nLD   = arm-none-eabi-gcc\nSIZE = arm-none-eabi-size\n\nARCHFLAGS = -mcpu=cortex-m7 -mthumb -mfpu=fpv4-sp-d16 -mfloat-abi=hard\nCFLAGS    = -g -c -Wall -Werror -pedantic \nLDFLAGS   = --specs=rdimon.specs -lc -lrdimon -Wl,--gc-sections,-Map,main.map,-Tmemory.ld\n\nSOURCES = main.c startup.c\nOBJECTS = $(SOURCES:%.c=%.o)\n\nmain.elf: $(OBJECTS)\n    $(LD) $(ARCHFLAGS) $(LDFLAGS) -o $@ $(OBJECTS)\n    $(SIZE) --format=sysv -x $@\n\n%.o: %.c\n    $(CC) $(ARCHFLAGS) $(CFLAGS) $&lt; -o $@ \n\nclean:\n    rm -rf main.elf\n    rm -rf $(OBJECTS)\n    rm -rf main.map\n</code></pre>\n\n<h2>.gdbinit</h2>\n\n<pre><code>file main.elf\ntarget remote :2331\nmonitor reset\nmonitor halt\nmonitor speed auto\nmonitor flash device STM32F746NG\nmonitor semihosting enable\nmonitor semihosting IOclient 3\nload\nmonitor reset\n</code></pre>\n"}, {"tags": ["c++", "c", "gcc", "standards"], "comments": [{"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 2, "creation_date": 1505941234, "post_id": 46331625, "comment_id": 79624122, "body": "Since you have to ask this question, it&#39;s probably a good idea to just not rely on it whether or not the expression is guaranteed not to execute. Future readers of your code / your coworkers / future you (while debugging) are likely to not know whether this is valid."}, {"owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 0, "creation_date": 1505941237, "post_id": 46331625, "comment_id": 79624125, "body": "<i>everything</i> is defined in terms of the &quot;as-if&quot; rule, applied to the abstract machine defined in the standard"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1505941358, "post_id": 46331625, "comment_id": 79624183, "body": "Do note that accessing a member of a null pointer is undefined behavior.  That allows the compiler to do whatever it wants."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1505941361, "post_id": 46331625, "comment_id": 79624186, "body": "I think the whole question can be rephrased as &quot;Is <code>(struct S*)NULL)-&gt;value;</code> line UB?&quot; The answer is Yes, I believe..."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 4, "creation_date": 1505941410, "post_id": 46331625, "comment_id": 79624211, "body": "Why not use <code>sizeof((struct S *)0-&gt;X)</code>; you know <code>sizeof()</code> doesn&#39;t evaluate its operand, but it would fail if <code>X</code> is not a member of <code>struct S</code>."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1505941417, "post_id": 46331625, "comment_id": 79624217, "body": "And dereferencing nullptr <b>is</b> UB."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 2, "creation_date": 1505941609, "post_id": 46331625, "comment_id": 79624282, "body": "In C++, you might write traits to know if <code>A::value</code> exists, see <a href=\"http://en.cppreference.com/w/cpp/experimental/is_detected\" rel=\"nofollow noreferrer\"><code>std::experimental::is_detected</code></a>."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 32078, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1505941686, "post_id": 46331625, "comment_id": 79624336, "body": "@VTT: would fail with overload methods."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 32078, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 1, "creation_date": 1505941724, "post_id": 46331625, "comment_id": 79624352, "body": "@VTT this question is tagged for C as well as C++."}, {"owner": {"reputation": 8637, "user_id": 354803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8de274de1f9ac102d96ec846c006176?s=128&d=identicon&r=PG", "display_name": "ShinTakezou", "link": "https://stackoverflow.com/users/354803/shintakezou"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1505941897, "post_id": 46331625, "comment_id": 79624420, "body": "@Jarod42 and others, the trick is (was?) common and based on the fact that <i>there must not happen any dereferencing</i> at all. It seems like it is there, but it isn&#39;t. Even in this case of mine: if the expression isn&#39;t actually ever evaluated, the UB doesn&#39;t apply \u2014 but is the core of the question, if the evaluation happens or not."}, {"owner": {"reputation": 8637, "user_id": 354803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8de274de1f9ac102d96ec846c006176?s=128&d=identicon&r=PG", "display_name": "ShinTakezou", "link": "https://stackoverflow.com/users/354803/shintakezou"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1505942136, "post_id": 46331625, "comment_id": 79624535, "body": "@JonathanLeffler definitely the third fix\u2026 though the <code>offsetof</code> avoids the show <code>(struct S *)NULL</code> which puzzles many."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1505942158, "post_id": 46331625, "comment_id": 79624546, "body": "You even say in your question &quot;The comma operator should evaluate the left operand&quot; but then go on to ask a question &quot;is it guaranteed NOT to&quot;, you contradict what you already appeared to know"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1505942213, "post_id": 46331625, "comment_id": 79624564, "body": "It <i>can</i> happen, and you have proven it by using <code>volatile</code>. The point is that the compiler might &quot;think&quot; this is some special memory, reading from which is triggering some unknown action (like some hardware register read is sometimes having some side effects), and has to be performed."}, {"owner": {"reputation": 8637, "user_id": 354803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8de274de1f9ac102d96ec846c006176?s=128&d=identicon&r=PG", "display_name": "ShinTakezou", "link": "https://stackoverflow.com/users/354803/shintakezou"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1505942362, "post_id": 46331625, "comment_id": 79624627, "body": "@M.M apparently. If you reason about it better, you reach that the standard could state somewhere something like &quot;the evaluation must be skipped in the following cases where the compiler can assure there aren&#39;t side effect: \u2026 follow the list\u2026&quot;. I haven&#39;t digged into them too much, as you can imagine by the question, but even in those few lines read I&#39;ve found sometimes surprises."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 4, "creation_date": 1505943427, "post_id": 46331625, "comment_id": 79625028, "body": "The program has undefined behaviour. One of the legitimate manifestations of undefined behaviour is not crashing. There is nothing to discuss, really."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1505945821, "post_id": 46331625, "comment_id": 79625921, "body": "I&#39;m sorry, the other part of the question, namely, how to make rhe compilatiin fail if requested struct member doesn&#39;t exist, is actually well defined and does have an answer. You can use <code>sizeof</code> as others suggested, or a not-taken branch of a conditional operator, e.g. <code>(0?(void)((type*)0)-&gt;member:(void)0)</code>. The expression in the left branch <i>is</i> guaranteed not to evaluate."}, {"owner": {"reputation": 8637, "user_id": 354803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8de274de1f9ac102d96ec846c006176?s=128&d=identicon&r=PG", "display_name": "ShinTakezou", "link": "https://stackoverflow.com/users/354803/shintakezou"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1505946619, "post_id": 46331625, "comment_id": 79626202, "body": "@n.m. The question is also about my ignorance about what standards have to say. There was a chance that the left operand of the comma operator could have been unevaluated (hopely using the right word\u2026) under specific conditions as per standard, so that UB couldn&#39;t be triggered. It happened to be not so."}, {"owner": {"reputation": 335869, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1505989747, "post_id": 46331625, "comment_id": 79642839, "body": "&quot;In the comma operator, is the left operand guaranteed not to be actually executed if it hasn&#39;t side effects?&quot; \u2013 You don&#39;t even have to know anything about C++ (except for the fact that it is Turing-complete) to answer this: figuring out whether the left operand has side-effects is equivalent to solving the Halting Problem. Obviously, the standard cannot force compiler writers to solve the Halting Problem, therefore, such a clause cannot possibly exist in the standard."}, {"owner": {"reputation": 618, "user_id": 497123, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/79496390df1f49a4d253b2d1bab3a0d4?s=128&d=identicon&r=PG", "display_name": "Federico Poloni", "link": "https://stackoverflow.com/users/497123/federico-poloni"}, "edited": false, "score": 0, "creation_date": 1505994005, "post_id": 46331625, "comment_id": 79645757, "body": "Philosoraptor questions: how can you tell if a line of code is executed or not, if it has no side effects? And: in your example, the left-hand operand may throw a segfault; isn&#39;t that a side effect?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1505994128, "post_id": 46331625, "comment_id": 79645841, "body": "In C you&#39;d rather write <code>#define STR_MEMBER(S, X) ((struct S){.X = 0}, #X)</code> which is 100% safe. The proper solution is of course, not to invent such horrible macros in the first place, but rather take action based on type. C has <code>_Generic</code> and C++ has templates. I don&#39;t think this macro fills any purpose in either language, smells like an &quot;XY problem&quot;."}, {"owner": {"reputation": 11533, "user_id": 1366431, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/YBopF.png?s=128&g=1", "display_name": "Leushenko", "link": "https://stackoverflow.com/users/1366431/leushenko"}, "edited": false, "score": 1, "creation_date": 1505998148, "post_id": 46331625, "comment_id": 79648647, "body": "Instead of using pointers, you can use in-place values in both languages as long as you abstract the in-place part to a helper macro: <code>#define STR_MEMBER(S,X) (sizeof(VALUE(S).X), #X)</code> with <code>VALUE(S)</code> defined as either <code>std::declval&lt;S&gt;()</code> or <code>(struct S){0}</code> depending on the state of <code>__cplusplus</code>."}, {"owner": {"reputation": 8637, "user_id": 354803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8de274de1f9ac102d96ec846c006176?s=128&d=identicon&r=PG", "display_name": "ShinTakezou", "link": "https://stackoverflow.com/users/354803/shintakezou"}, "reply_to_user": {"reputation": 335869, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1506018579, "post_id": 46331625, "comment_id": 79661977, "body": "@J&#246;rgWMittag interesting: it means gcc solved it! \u2014 or, that there is at least one case for which compilers can \u201csee\u201d that the only effect of an expression is to read a value\u2026 that then is discarded (because it&#39;s the left operand of the comma op), hence it can be optimized simply removing it. In this and other cases a standard could mandate a no-op, it is a matter of deciding to write so."}, {"owner": {"reputation": 8637, "user_id": 354803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8de274de1f9ac102d96ec846c006176?s=128&d=identicon&r=PG", "display_name": "ShinTakezou", "link": "https://stackoverflow.com/users/354803/shintakezou"}, "reply_to_user": {"reputation": 618, "user_id": 497123, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/79496390df1f49a4d253b2d1bab3a0d4?s=128&d=identicon&r=PG", "display_name": "Federico Poloni", "link": "https://stackoverflow.com/users/497123/federico-poloni"}, "edited": false, "score": 0, "creation_date": 1506018779, "post_id": 46331625, "comment_id": 79662088, "body": "@FedericoPoloni nonsense. The compiler produces code and before that, an intermediate representation which can be \u201canalyzed\u201d to determine many things, among these if a certain \u201cpiece\u201d would have no effects if the code would have been generated. Of course, all the physical changes into the cpu, that occurs to execute any piece of code, could be seen as a side effects of that code. But it&#39;s not what I mean usually, and hopefully I am not alone."}, {"owner": {"reputation": 8637, "user_id": 354803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8de274de1f9ac102d96ec846c006176?s=128&d=identicon&r=PG", "display_name": "ShinTakezou", "link": "https://stackoverflow.com/users/354803/shintakezou"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1506019061, "post_id": 46331625, "comment_id": 79662251, "body": "@Lundin I wrote a sentence to avoid comments like &quot;invent such horrible macros&quot;. Can you solve the problem with <code>_Generic</code> and templates? I&#39;ll see later your answer where, after the ritual &quot;it is UB&quot;, there&#39;s an explanation of how you&#39;d use <code>_Generic</code>(C11 anyway) and templates to achieve what I wanted. The macro fills the purpose explained in the question. I don&#39;t know how &quot;XY problems&quot; smell like."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1506062615, "post_id": 46331625, "comment_id": 79676439, "body": "@ShinTakezou My point is, there should be no situation where you need to find out what members a struct have in run-time, since members are determined at compile time. The need for such suggests a muddy design to begin with, hence &quot;XY problem&quot; - what you think you need is not necessarily the best solution."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1506062703, "post_id": 46331625, "comment_id": 79676482, "body": "With _Generic you wouldn&#39;t write a macro to see if a type exists, but perhaps to access it in a type safe manner. Given a proper typedef&#39;d struct <code>typedef struct { int value; } a_t;</code> you could for example write something like <code>#define get_value(name) _Generic((name), a_t: (name).value)</code> and call it like <code>a_t a; int something = get_value(a)</code>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1506062778, "post_id": 46331625, "comment_id": 79676537, "body": "Compound literals inside the macro is otherwise the best way to solve the problem in the question. Some answers to <a href=\"https://stackoverflow.com/questions/43043246/how-to-create-type-safe-enums\">How to create type safe enums?</a> use very similar techniques."}, {"owner": {"reputation": 8637, "user_id": 354803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8de274de1f9ac102d96ec846c006176?s=128&d=identicon&r=PG", "display_name": "ShinTakezou", "link": "https://stackoverflow.com/users/354803/shintakezou"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1506153117, "post_id": 46331625, "comment_id": 79713323, "body": "@Lundin &quot;find out what members struct have in run-time&quot;. Nope. My intention was some sort-of metaprogramming where everything must be done <b>at compile time</b>. Moreover, even the wrong macro works because at compile time gcc &quot;optimizes&quot; it and there exists no code which actually can execute the access at runtime. (By &quot;execute the access&quot; I mean a piece of assembly code which reads from a memory address 0 plus the offset of the member. If I had seen such a code, using <code>-S</code>, this question likely wouldn&#39;t exist.)"}, {"owner": {"reputation": 8637, "user_id": 354803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8de274de1f9ac102d96ec846c006176?s=128&d=identicon&r=PG", "display_name": "ShinTakezou", "link": "https://stackoverflow.com/users/354803/shintakezou"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1506153728, "post_id": 46331625, "comment_id": 79713472, "body": "@Lundin <code>_Generic</code>\u2026 I don&#39;t need type safety, but a string (known at compile time) which contains letters which are the symbol of a struct member. My initial thought indeed was to write a minimal parser for <code>struct</code> able to generate another <code>struct</code> combining other infos, then all put in <code>.h</code>\u2014all that to be sure the strings contain no typo\u2026 But then I wondered if it could be done by the preprocessor/compiler at compile time. The real usage wasn&#39;t like the given example but more like <code>struct info xxx_info[] = {{STR_MEMBER{xxx,yyy}, &#47;*\u2026*&#47;},&#47;*\u2026*&#47;};</code> All data are known at compile time."}], "answers": [{"tags": [], "owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "is_accepted": true, "score": 12, "last_activity_date": 1505942241, "last_edit_date": 1505942241, "creation_date": 1505941449, "answer_id": 46331733, "question_id": 46331625, "link": "https://stackoverflow.com/questions/46331625/in-the-comma-operator-is-the-left-operand-guaranteed-not-to-be-actually-execute/46331733#46331733", "title": "In the comma operator, is the left operand guaranteed not to be actually executed if it hasn&#39;t side effects?", "body": "<p>The <a href=\"http://en.cppreference.com/w/cpp/language/operator_other#Built-in_comma_operator\" rel=\"noreferrer\">comma operator</a> (<a href=\"http://en.cppreference.com/w/c/language/operator_other#Comma_operator\" rel=\"noreferrer\">C documentation</a>, says something very similar) has no such guarantees.</p>\n\n<blockquote>\n  <p>In a comma expression <code>E1, E2</code>, the expression E1 is evaluated, its result is discarded ..., and its side effects are completed before evaluation of the expression E2 begins</p>\n</blockquote>\n\n<p><sup>irrelevant information omitted</sup></p>\n\n<p>To put it simply, <code>E1</code> will be evaluated, although the compiler might optimize it away by the as-if rule if it is able to determine that there are no side-effects.</p>\n"}, {"comments": [{"owner": {"reputation": 8637, "user_id": 354803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8de274de1f9ac102d96ec846c006176?s=128&d=identicon&r=PG", "display_name": "ShinTakezou", "link": "https://stackoverflow.com/users/354803/shintakezou"}, "edited": false, "score": 0, "creation_date": 1505942639, "post_id": 46331742, "comment_id": 79624748, "body": "If there isn&#39;t anything later stating that nothing is actually evaluated under listed conditions\u2026 You are implying that there isn&#39;t text stating this, I suppose you&#39;ve checked, but maybe it would be clearer to specify that there aren&#39;t such exceptions."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 8637, "user_id": 354803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8de274de1f9ac102d96ec846c006176?s=128&d=identicon&r=PG", "display_name": "ShinTakezou", "link": "https://stackoverflow.com/users/354803/shintakezou"}, "edited": false, "score": 0, "creation_date": 1505942911, "post_id": 46331742, "comment_id": 79624854, "body": "@ShinTakezou No there is nothing like that. You can read the definition of the comma operator and see that it does not say &quot;the left operand is sometimes not evaluated&quot; or whatever"}, {"owner": {"reputation": 8637, "user_id": 354803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8de274de1f9ac102d96ec846c006176?s=128&d=identicon&r=PG", "display_name": "ShinTakezou", "link": "https://stackoverflow.com/users/354803/shintakezou"}, "edited": false, "score": 0, "creation_date": 1505943694, "post_id": 46331742, "comment_id": 79625115, "body": "A &quot;definition&quot; could be longer than few lines, it can be split in several paragraphs covering several cases. I suppose you are stating that it&#39;s not the case for the comma operator."}, {"owner": {"reputation": 8637, "user_id": 354803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8de274de1f9ac102d96ec846c006176?s=128&d=identicon&r=PG", "display_name": "ShinTakezou", "link": "https://stackoverflow.com/users/354803/shintakezou"}, "edited": false, "score": 0, "creation_date": 1505943822, "post_id": 46331742, "comment_id": 79625149, "body": "Maybe, and it would have taken you less time to add to your answer that there aren&#39;t exceptions stated anywhere in the standards. (As per suggestion given in my first comment)"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 8637, "user_id": 354803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8de274de1f9ac102d96ec846c006176?s=128&d=identicon&r=PG", "display_name": "ShinTakezou", "link": "https://stackoverflow.com/users/354803/shintakezou"}, "edited": false, "score": 1, "creation_date": 1505943995, "post_id": 46331742, "comment_id": 79625218, "body": "@ShinTakezou I think &quot;The standard guarantees that the left operand IS evaluated&quot; already clearly implies there are no exceptions."}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 1, "creation_date": 1505944375, "post_id": 46331742, "comment_id": 79625365, "body": "Note that OP is conflating &quot;evaluated&quot; and &quot;access the value&quot;. In C++ in particular, the lvalue-to-rvalue conversion is not applied to a discarded glvalue expression that does not have volatile-qualified type. That said, the UB in this case comes from the <code>-&gt;</code>, so whether an subsequent attempt to access the stored value is made is irrelevant."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1505944595, "post_id": 46331742, "comment_id": 79625446, "body": "@T.C. Yeah , funnily enough I considered adding that to my answer originally but decided not to  complicate things (probably the wrong decision). Thanks for clearly stating the matter"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1505946130, "post_id": 46331742, "comment_id": 79626014, "body": "@T.C. maybe the C++ case will be slightly more complicated if the &quot;empty lvalue&quot; proposal goes through ; In C++14 I believe we&#39;re &quot;saved&quot; by the provision that an lvalue must actually designate storage  (since using <code>*</code> on a null pointer is not explicitly UB)"}, {"owner": {"reputation": 8637, "user_id": 354803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8de274de1f9ac102d96ec846c006176?s=128&d=identicon&r=PG", "display_name": "ShinTakezou", "link": "https://stackoverflow.com/users/354803/shintakezou"}, "reply_to_user": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1505946166, "post_id": 46331742, "comment_id": 79626025, "body": "@T.C. my fault, I used terms without a specific jargon in mind, maybe mixing merely syntax parsing / compile time checks with evaluating = generating the code which will run and cause problems."}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1505946324, "post_id": 46331742, "comment_id": 79626088, "body": "@M.M Class member access on something that isn&#39;t an object of the right type is currently UB by omission; &quot;empty lvalues&quot; won&#39;t change that except perhaps make it explicitly UB."}], "tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": false, "score": 17, "last_activity_date": 1505946570, "last_edit_date": 1505946570, "creation_date": 1505941471, "answer_id": 46331742, "question_id": 46331625, "link": "https://stackoverflow.com/questions/46331625/in-the-comma-operator-is-the-left-operand-guaranteed-not-to-be-actually-execute/46331742#46331742", "title": "In the comma operator, is the left operand guaranteed not to be actually executed if it hasn&#39;t side effects?", "body": "<blockquote>\n  <p>Is there anything in the C and C++ languages standard which guarantees that compilers will always avoid actual evaluation of the left operand of the comma operator ?</p>\n</blockquote>\n\n<p>It's the opposite. The standard guarantees that the left operand IS evaluated (really it does, there aren't any exceptions). The result is discarded.</p>\n\n<hr>\n\n<p><em>Note:</em> for lvalue expressions, \"evaluate\" does not mean \"access the stored value\".  Instead, it means to work out where the designated memory location is.  The other code encompassing the lvalue expression may or may not then go on to access the memory location.   The process of reading from the memory location is known as \"lvalue conversion\" in C, or \"lvalue to rvalue conversion\" in C++.</p>\n\n<p>In C++ a discarded-value expression (such as the left operand of the comma operator) only has lvalue to rvalue conversion performed on it if it is <code>volatile</code> and also meets some other criteria (see C++14 [expr]/11 for detail). In C lvalue conversion <em>does</em> occur for expressions whose result is not used (C11 6.3.2.1/2).</p>\n\n<p>In your example, it is moot whether or not lvalue conversion happens. In both languages <code>X-&gt;Y</code>, where <code>X</code> is a pointer, is defined as <code>(*X).Y</code>; in C the act of applying <code>*</code> to a null pointer already causes undefined behaviour (C11 6.5.3/3), and in C++ the <code>.</code> operator is only defined for the case when the left operand actually designates an object (C++14 [expr.ref]/4.2).  </p>\n"}, {"comments": [{"owner": {"reputation": 8637, "user_id": 354803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8de274de1f9ac102d96ec846c006176?s=128&d=identicon&r=PG", "display_name": "ShinTakezou", "link": "https://stackoverflow.com/users/354803/shintakezou"}, "edited": false, "score": 0, "creation_date": 1505943412, "post_id": 46331805, "comment_id": 79625019, "body": "I think I will go for <code>sizeof</code>. Unfortuntely when I did my empirical checks I hadn&#39;t clang at hand. <code>-fsanitize=undefined</code> is accepted by gcc 6.3 too, but it seems everything is fine\u2026 clang 3.0-6.2 accepts it too, but the same result, except for warnings <code>expression result unused</code>. Indeed I&#39;m testing a different code where the macro is used only to populate a struct."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user743382"}, "is_accepted": false, "score": 3, "last_activity_date": 1505941714, "creation_date": 1505941714, "answer_id": 46331805, "question_id": 46331625, "link": "https://stackoverflow.com/questions/46331625/in-the-comma-operator-is-the-left-operand-guaranteed-not-to-be-actually-execute/46331805#46331805", "title": "In the comma operator, is the left operand guaranteed not to be actually executed if it hasn&#39;t side effects?", "body": "<blockquote>\n  <p>Gcc/g++ 6.3 and 4.9.2 never produced that dangerous code, even with -O0, as if they were always able to \u201csee\u201d that the evaluation hasn't side effects and so it can be skipped.</p>\n</blockquote>\n\n<p>clang will produce code which raises an error if you pass it the <code>-fsanitize=undefined</code> option. Which should answer your question: at least one major implementation's developers clearly consider the code as having undefined behaviour. And they are correct.</p>\n\n<blockquote>\n  <p>Suggestions about other possible \u201cfixes\u201d are welcome, too.</p>\n</blockquote>\n\n<p>I would look for something which is guaranteed not to evaluate the expression. Your suggestion of <code>offsetof</code> does the job, but may occasionally cause code to be rejected that would otherwise be accepted, such as when <code>X</code> is <code>a.b</code>. If you want that to be accepted, my thought would be to use <code>sizeof</code> to force an expression to remain unevaluated.</p>\n"}, {"comments": [{"owner": {"reputation": 8637, "user_id": 354803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8de274de1f9ac102d96ec846c006176?s=128&d=identicon&r=PG", "display_name": "ShinTakezou", "link": "https://stackoverflow.com/users/354803/shintakezou"}, "edited": false, "score": 0, "creation_date": 1505942511, "post_id": 46331907, "comment_id": 79624690, "body": "<code>offsetof</code> should appear somewhere at least in the C standard, if I remember well. Is it discarded or unevaluated like <code>sizeof</code>?"}, {"owner": {"reputation": 11458, "user_id": 3435400, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/61726fe80facc93d76754f0226b49eb9?s=128&d=identicon&r=PG&f=1", "display_name": "alain", "link": "https://stackoverflow.com/users/3435400/alain"}, "reply_to_user": {"reputation": 8637, "user_id": 354803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8de274de1f9ac102d96ec846c006176?s=128&d=identicon&r=PG", "display_name": "ShinTakezou", "link": "https://stackoverflow.com/users/354803/shintakezou"}, "edited": false, "score": 1, "creation_date": 1505942678, "post_id": 46331907, "comment_id": 79624767, "body": "I looked at the C++ draft N4296, <code>offsetof</code> is a macro. I didn&#39;t find much more about it at first glance. But <code>sizeof</code> is described as having an unevaluated operand."}, {"owner": {"reputation": 8637, "user_id": 354803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8de274de1f9ac102d96ec846c006176?s=128&d=identicon&r=PG", "display_name": "ShinTakezou", "link": "https://stackoverflow.com/users/354803/shintakezou"}, "edited": false, "score": 0, "creation_date": 1505942813, "post_id": 46331907, "comment_id": 79624818, "body": "gcc defines it as a built-in, I&#39;ve tried using it with <code>volatile</code>, it seems fine (no segfault), but I can&#39;t find an assurance about this behaviour."}, {"owner": {"reputation": 11458, "user_id": 3435400, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/61726fe80facc93d76754f0226b49eb9?s=128&d=identicon&r=PG&f=1", "display_name": "alain", "link": "https://stackoverflow.com/users/3435400/alain"}, "reply_to_user": {"reputation": 8637, "user_id": 354803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8de274de1f9ac102d96ec846c006176?s=128&d=identicon&r=PG", "display_name": "ShinTakezou", "link": "https://stackoverflow.com/users/354803/shintakezou"}, "edited": false, "score": 1, "creation_date": 1505942827, "post_id": 46331907, "comment_id": 79624823, "body": "@ShinTakezou Also, the first operand of <code>offsetof</code> must be a standard-layout class, else the behavior is undefined. <code>sizeof</code> doesn&#39;t have this limitation. (In C++)"}, {"owner": {"reputation": 8637, "user_id": 354803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8de274de1f9ac102d96ec846c006176?s=128&d=identicon&r=PG", "display_name": "ShinTakezou", "link": "https://stackoverflow.com/users/354803/shintakezou"}, "edited": false, "score": 0, "creation_date": 1505942919, "post_id": 46331907, "comment_id": 79624857, "body": "good point for <code>sizeof</code> against <code>offsetof</code>. The struct was a POD but you never know, maybe it will change!"}], "tags": [], "owner": {"reputation": 11458, "user_id": 3435400, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/61726fe80facc93d76754f0226b49eb9?s=128&d=identicon&r=PG&f=1", "display_name": "alain", "link": "https://stackoverflow.com/users/3435400/alain"}, "is_accepted": false, "score": 2, "last_activity_date": 1505944692, "last_edit_date": 1505944692, "creation_date": 1505942196, "answer_id": 46331907, "question_id": 46331625, "link": "https://stackoverflow.com/questions/46331625/in-the-comma-operator-is-the-left-operand-guaranteed-not-to-be-actually-execute/46331907#46331907", "title": "In the comma operator, is the left operand guaranteed not to be actually executed if it hasn&#39;t side effects?", "body": "<p>The left operand of the comma operator is a <em>discarded-value expression</em></p>\n\n<blockquote>\n  <p><strong>5 Expressions</strong><br>\n  11 In some contexts, an expression only appears for its side effects. Such an expression is called a discarded-value\n  expression. The expression is evaluated and its value is discarded.\n  [...]</p>\n</blockquote>\n\n<p>There are also <em>unevaluated operands</em> which, as the name implies, are not evaluated.</p>\n\n<blockquote>\n  <p>8  In some contexts, unevaluated operands appear (5.2.8, 5.3.3, 5.3.7,\n  7.1.6.2). An unevaluated operand is not evaluated. An unevaluated operand is considered a full-expression. [...]</p>\n</blockquote>\n\n<p>Using a discarded-value expression in your use case is undefined behavior, but using an unevaluated operand is not.</p>\n\n<p>Using <code>sizeof</code> for example would not cause UB because it takes an unevaluated operand.</p>\n\n<pre><code>#define STR_MEMBER(S,X) (sizeof(S::X), #X)\n</code></pre>\n\n<p><code>sizeof</code> is preferable to <code>offsetof</code>, because <code>offsetof</code> can't be used for static members and classes that are not standard-layout:</p>\n\n<blockquote>\n  <p><strong>18 Language support library</strong><br>\n  4  The macro offsetof(type, member-designator) accepts a restricted\n  set of type arguments in this International Standard. If type is not a\n  standard-layout class (Clause 9), the results are undefined. [...] The result of applying the offsetof macro to a field that\n  is a static data member or a function member is undefined. [...]</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 3, "last_activity_date": 1505946304, "creation_date": 1505946304, "answer_id": 46332639, "question_id": 46331625, "link": "https://stackoverflow.com/questions/46331625/in-the-comma-operator-is-the-left-operand-guaranteed-not-to-be-actually-execute/46332639#46332639", "title": "In the comma operator, is the left operand guaranteed not to be actually executed if it hasn&#39;t side effects?", "body": "<p>You ask,</p>\n\n<blockquote>\n  <p>is there anything in the C and C++ languages standard which guarantees\n  that compilers will always avoid actual evaluation of the left operand\n  of the comma operator when the compiler can be sure that the\n  evaluation hasn't side effects?</p>\n</blockquote>\n\n<p>As others have remarked, the answer is \"no\".  On the contrary, the standards both unconditionally state that the left-hand operand of the comma operator <strong>is</strong> evaluated, and that the result is discarded.</p>\n\n<p>This is of course a description of the execution model of an abstract machine; implementations are permitted to work differently, so long as the observable behavior is the same as the abstract machine behavior would produce.  If indeed evaluation of the left-hand expression produces no side effects, then that would <em>permit</em> skipping it altogether, but there is nothing in either standard that provides for <em>requiring</em> that it be skipped.</p>\n\n<p>As for fixing it, you have various options, some of which apply only to one or the other of the two languages you have named.  I tend to like your <code>offsetof()</code> alternative, but others have noted that in C++, there are types to which <code>offsetof</code> cannot be applied.  In C, on the other hand, the standard specifically describes its application to <em>structure</em> types, but says nothing about union types.  Its behavior on union types, though very likely to be consistent and natural, as technically undefined.</p>\n\n<p>In C only, you could use a compound literal to avoid the undefined behavior in your approach:</p>\n\n<pre><code>#define HAS_MEMBER(T,X) (((T){0}).X, #X)\n</code></pre>\n\n<p>That works equally well on structure and union types (though you need to provide a full type name for this version, not just a tag).  Its behavior is well defined when the given type does have such a member.  The expansion violates a language constraint -- thus requiring a diagnostic to be emitted -- when the type does not have such a member, including when it is neither a structure type nor a union type.</p>\n\n<p>You might also use <code>sizeof</code>, as @alain suggested, because although the <code>sizeof</code> expression will be evaluated, <em>its</em> operand will not be evaluated (except, in C, when its operand has variably-modified type, which will not apply to your use).  I think this variation will work in both C and C++ without introducing any undefined behavior:</p>\n\n<pre><code>#define HAS_MEMBER(T,X) (sizeof(((T *)NULL)-&gt;X), #X)\n</code></pre>\n\n<p>I have again written it so that it works for both structs and unions.</p>\n"}, {"comments": [{"owner": {"reputation": 8637, "user_id": 354803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8de274de1f9ac102d96ec846c006176?s=128&d=identicon&r=PG", "display_name": "ShinTakezou", "link": "https://stackoverflow.com/users/354803/shintakezou"}, "edited": false, "score": 0, "creation_date": 1506019948, "post_id": 46333895, "comment_id": 79662675, "body": "I would rather say that the first paragraph would be a reason to suggest adding a mandatory \u201celimination\u201d of the no side effects - discarded value case. / About the 2nd par, it isn&#39;t clear how they are on the same side\u2026 Anyway, few days ago I was joking with a friend about the fact that containers and similar technologies change the \u201cit works on my machine\u201d to \u201cI can guarantee it works on all these machines (like mine)\u201d. It could push an interesting paradigm shift and remove that annoying cliche on \u201cnasal demons\u201d and the already mentioned nice one \u201cit works on my machine\u201d!"}, {"owner": {"reputation": 23130, "user_id": 8586227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRnwg.png?s=128&g=1", "display_name": "Davis Herring", "link": "https://stackoverflow.com/users/8586227/davis-herring"}, "reply_to_user": {"reputation": 8637, "user_id": 354803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8de274de1f9ac102d96ec846c006176?s=128&d=identicon&r=PG", "display_name": "ShinTakezou", "link": "https://stackoverflow.com/users/354803/shintakezou"}, "edited": false, "score": 0, "creation_date": 1506022176, "post_id": 46333895, "comment_id": 79663815, "body": "You can&#39;t make eliminating <i>all</i> side-effect-free evaluations mandatory, since that&#39;s undecidable.  Exactly how hard, then, should the implementation be required to try to prove something eliminable? /  Those considerations are on the same side because they both allow the implementation to do things that are not the result of a simpleminded reading of the source.  (And &quot;it works on my machine&quot; really just means &quot;I haven&#39;t found the case that fails yet&quot;.  Containers or no, it&#39;s no substitute for correctness.)"}, {"owner": {"reputation": 8637, "user_id": 354803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8de274de1f9ac102d96ec846c006176?s=128&d=identicon&r=PG", "display_name": "ShinTakezou", "link": "https://stackoverflow.com/users/354803/shintakezou"}, "edited": false, "score": 0, "creation_date": 1506023434, "post_id": 46333895, "comment_id": 79664453, "body": "The compiler has something like <code>(discard (read 0 16))</code>, in an on-the-fly invented representation of a piece of the result of parsing (plus whatever) <code>(((p*)0)-&gt;x, &quot;x&quot;)</code>. The special rule for the comma op could consider a finite number of well defined cases, e.g. literals, const expressions and \u201cread only\u201d operations (w/o <code>volatile</code>). These few cases can be handled. Anyway, no point in discussing it further here./ E.g. consider this very case: gcc vN.N\u2026doesn&#39;t emit code to access <code>0-&gt;X</code>. Hence it works on my machine with that compiler, thus\u2026The case that fails doesn&#39;t exist at all here."}], "tags": [], "owner": {"reputation": 23130, "user_id": 8586227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRnwg.png?s=128&g=1", "display_name": "Davis Herring", "link": "https://stackoverflow.com/users/8586227/davis-herring"}, "is_accepted": false, "score": 2, "last_activity_date": 1505956516, "creation_date": 1505956516, "answer_id": 46333895, "question_id": 46331625, "link": "https://stackoverflow.com/questions/46331625/in-the-comma-operator-is-the-left-operand-guaranteed-not-to-be-actually-execute/46333895#46333895", "title": "In the comma operator, is the left operand guaranteed not to be actually executed if it hasn&#39;t side effects?", "body": "<p>The language doesn't need to say anything about \"actual execution\" because of the <a href=\"http://en.cppreference.com/w/cpp/language/as_if\" rel=\"nofollow noreferrer\">as-if rule</a>.  After all, with no side effects how could you tell whether the expression is evaluated?  (Looking at the assembly or setting breakpoints doesn't count; that's not part of execution of the program, which is all the language describes.)</p>\n\n<p>On the other hand, dereferencing a null pointer is undefined behavior, so the language says nothing at all about what happens.  You can't expect as-if to save you: as-if is a <em>relaxation</em> of otherwise-plausible restrictions on the implementation, and undefined behavior is a relaxation of <em>all</em> restrictions on the implementation.  There is therefore no \"conflict\" between \"this doesn't have side effects, so we can ignore it\" and \"this is undefined behavior, so nasal demons\"; they're on the same side!</p>\n"}], "owner": {"reputation": 8637, "user_id": 354803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8de274de1f9ac102d96ec846c006176?s=128&d=identicon&r=PG", "display_name": "ShinTakezou", "link": "https://stackoverflow.com/users/354803/shintakezou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1862, "favorite_count": 4, "accepted_answer_id": 46331733, "answer_count": 6, "score": 30, "last_activity_date": 1505956516, "creation_date": 1505940981, "last_edit_date": 1505945669, "question_id": 46331625, "link": "https://stackoverflow.com/questions/46331625/in-the-comma-operator-is-the-left-operand-guaranteed-not-to-be-actually-execute", "title": "In the comma operator, is the left operand guaranteed not to be actually executed if it hasn&#39;t side effects?", "body": "<p>To show the topic I'm going to use C, but the same macro can be used also in C++ (with or without <code>struct</code>), raising the same question.</p>\n\n<p>I came up with this macro</p>\n\n<pre><code>#define STR_MEMBER(S,X) (((struct S*)NULL)-&gt;X, #X)\n</code></pre>\n\n<p>Its purpose is to have strings (<code>const char*</code>) of an existing member of a <code>struct</code>, so that if the member doesn't exist, the compilation fails. A minimal usage example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nstruct a\n{\n    int value;\n};\n\nint main(void)\n{\n    printf(\"a.%s member really exists\\n\", STR_MEMBER(a, value));\n    return 0;\n}\n</code></pre>\n\n<p>If <code>value</code> weren't a member of <code>struct a</code>, the code wouldn't compile, and this is what I wanted.</p>\n\n<p>The comma operator should evaluate the left operand and then discard the result of the expression (if there is one), so that my understanding is that usually this operator is used when the evaluation of the left operand has side effects.</p>\n\n<p>In this case, however, there aren't (intended) side effects, but of course it works <em>iff</em> the compiler doesn't actually produce the code which evaluates the expression, for otherwise it would access to a <code>struct</code> located at <code>NULL</code> and a <em>segmentation fault</em> would occur.</p>\n\n<p>Gcc/g++ 6.3 and 4.9.2 never produced that dangerous code, even with <code>-O0</code>, as if they were always able to \u201csee\u201d that the evaluation hasn't side effects and so it can be skipped.</p>\n\n<p>Adding <code>volatile</code> in the macro (e.g. because accessing that memory address <em>is</em> the desired side effect) was so far the only way to trigger the segmentation fault.</p>\n\n<p>So the question: <strong>is there anything in the C and C++ languages standard which guarantees that compilers will always avoid actual evaluation of the left operand of the comma operator when the compiler can be sure that the evaluation hasn't side effects?</strong></p>\n\n<h2>Notes and fixing</h2>\n\n<p>I am not asking for a judgment about the macro <em>as it is</em> and the opportunity to use it or make it better. For the purpose of this question, the macro is bad <em>if and only if</em> it evokes undefined behaviour \u2014 i.e., <em>if and only if</em> it is risky because compilers are allowed to generate the \u201cevaluation code\u201d even when this hasn't side effects.</p>\n\n<p>I have already two obvious fixes in mind: \u201creifying\u201d the <code>struct</code> and using <code>offsetof</code>. The former needs an accessible memory area as big as the biggest <code>struct</code> we use as first argument of <code>STR_MEMBER</code> (e.g. maybe a static union could do\u2026). The latter should work flawlessly: it gives an offset we aren't interested in and avoids the access problem \u2014 indeed I'm assuming <em>gcc</em>, because it's the compiler I use (hence the tag), and that its <code>offsetof</code> built-in behaves.</p>\n\n<p>With the <code>offsetof</code> fix the macro becomes</p>\n\n<pre><code>#define STR_MEMBER(S,X) (offsetof(struct S,X), #X)\n</code></pre>\n\n<p>Writing <code>volatile struct S</code> instead of <code>struct S</code> doesn't cause the segfault.</p>\n\n<p>Suggestions about other possible \u201cfixes\u201d are welcome, too.</p>\n\n<h2>Added note</h2>\n\n<p>Actually, the real usage case was in C++ in a static storage <code>struct</code>. This seems to be fine in C++, but as soon as I tried C with a code closer to the original instead of the one boiled for this question, I realized that C isn't happy at all with that:</p>\n\n<pre><code>error: initializer element is not constant\n</code></pre>\n\n<p>C wants the struct to be initializable at compile time, instead C++ it's fine with that.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 26583, "user_id": 1441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb7f1cd450084fdb4bfc9376c7dba2a7?s=128&d=identicon&r=PG", "display_name": "crashmstr", "link": "https://stackoverflow.com/users/1441/crashmstr"}, "edited": false, "score": 0, "creation_date": 1505937272, "post_id": 46330716, "comment_id": 79622232, "body": "Use proper formatting, tag correctly (C or C++ but not both in most cases), and how about asking a question?"}, {"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1505937290, "post_id": 46330716, "comment_id": 79622245, "body": "What <i>&quot;garbage value&quot;</i> are you talking about?"}, {"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 0, "creation_date": 1505937299, "post_id": 46330716, "comment_id": 79622248, "body": "How are you running this program?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1505937388, "post_id": 46330716, "comment_id": 79622314, "body": "<code>argc&gt;=1</code> is not matching what you should actually expect."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 2, "creation_date": 1505937435, "post_id": 46330716, "comment_id": 79622347, "body": "<code>argc</code> is always at least 1."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1505937439, "post_id": 46330716, "comment_id": 79622353, "body": "And <code>atof()</code> always return a valid <code>float</code>."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1505937867, "post_id": 46330716, "comment_id": 79622573, "body": "This question is going to be closed as non-reproducible, if no further information is added."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1505938153, "post_id": 46330716, "comment_id": 79622717, "body": "<code>if(argc&gt;=1)</code> ==&gt; <code>if(argc &gt;= 3)</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 1, "creation_date": 1505938526, "post_id": 46330716, "comment_id": 79622903, "body": "@molbdnilo Disagree with <a href=\"https://stackoverflow.com/questions/46330716/area-of-triangle-using-command-line-in-c-language#comment79622347_46330716\">argc is always at least 1.</a>  That is not support by the C spec which has &quot;The value of argc shall be nonnegative.&quot; and &quot;If the value of argc is greater than zero, ...&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1505938239, "post_id": 46330912, "comment_id": 79622754, "body": "Forgot <code>#include &lt;stdio.h&gt;</code> too."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1505938718, "post_id": 46330912, "comment_id": 79623002, "body": "<code>argc&gt;=1</code> --&gt; <code>argc&gt;=3</code>  <a href=\"https://stackoverflow.com/questions/46330716/area-of-triangle-using-command-line-in-c-language#comment79622717_46330716\">@Weather Vane</a>"}, {"owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1505938931, "post_id": 46330912, "comment_id": 79623122, "body": "@chux now it prints usage too :-)"}], "tags": [], "owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "is_accepted": false, "score": 2, "last_activity_date": 1505938900, "last_edit_date": 1505938900, "creation_date": 1505937889, "answer_id": 46330912, "question_id": 46330716, "link": "https://stackoverflow.com/questions/46330716/area-of-triangle-using-command-line-in-c-language/46330912#46330912", "title": "area of triangle using command line in c language", "body": "<p>Most likely you forgot to include stdlib.h and you're not getting the right return type of atof as a double.  Always look at all of the warnings your compiler gives you.</p>\n\n\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nint main(int argc,char *argv[]){\n    double height,base,area;\n    if(argc==3){\n        printf(\"%s %s\\n\",argv[1],argv[2]);\n        height=atof(argv[1]);\n        base=atof(argv[2]);\n        area=(height*base)/2;\n        printf(\"%f, %f, %.2f\",height,base,area);\n    }\n    else{\n        fprintf(stderr,\"Usage:\\n\\t%s height base\\n\",argv[0]);\n    }\n    return 0;\n}\n</code></pre>\n\n<p><a href=\"https://tio.run/##ZZDBboQgEIbvPgVxs4luWGvd7KXWvkXTQ/UwIiAJxQ1gL82@eimg2a4tCTCZ@edjfsiRE@LcTigi54GiZ2MHKfpifEk2OTGFVCKURR8gVBYC0JxgMoJGBx9@vnf5V4L8Gqa5lxSNVPDR4h4MxaAp1LEoWBb6mua0qsO6aM9jWbo3aG9aleLIe@yWu@ry@iZdqA3YKYKC6q4aHrurbTrDDE229B@CMH@o6v8jMIziLiqW4r8eVtw1nlQa@uuBrQT/WVRrnL4a4PSpVa31rhZOHO9mr@w2NE3trBUq6@TqnIOBgTsVpTsX5TdhErhxxzeQ8gc\" rel=\"nofollow noreferrer\" title=\"C (gcc) \u2013 Try It Online\">Try it online!</a></p>\n"}], "owner": {"reputation": 1, "user_id": 8644156, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-85a2W7mraeY/AAAAAAAAAAI/AAAAAAAAAA4/lObSsomBf_I/photo.jpg?sz=128", "display_name": "Gaurang Makwana", "link": "https://stackoverflow.com/users/8644156/gaurang-makwana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1670, "favorite_count": 0, "closed_date": 1505939336, "answer_count": 1, "score": -3, "last_activity_date": 1505938900, "creation_date": 1505937146, "last_edit_date": 1505937606, "question_id": 46330716, "link": "https://stackoverflow.com/questions/46330716/area-of-triangle-using-command-line-in-c-language", "closed_reason": "Not suitable for this site", "title": "area of triangle using command line in c language", "body": "<pre><code>int main(int argc,char *argv[]){\n    float height,base,area;\n    if(argc&gt;=1){\n        printf(\"%s %s\",argv[1],argv[2]);\n        height=atof(argv[1]);\n        base=atof(argv[2]);\n        area=(height*base)/2;\n        printf(\"%f, %f, %.2f\",height,base,area);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>This c code take the average value of the height and base when I convert the code in float using <code>atof()</code> function of c on my computer, but some how on my friend's computer the code work properly. Why is this?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1909, "user_id": 2375574, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9ed9192b2e8d4dad7864bb45f589a449?s=128&d=identicon&r=PG", "display_name": "Saleem Ahmed", "link": "https://stackoverflow.com/users/2375574/saleem-ahmed"}, "edited": false, "score": 0, "creation_date": 1505938059, "post_id": 46330633, "comment_id": 79622669, "body": "Hi, Welcome to StackOverflow, please read community guidelines to posting questions with correct tags."}, {"owner": {"reputation": 1909, "user_id": 2375574, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9ed9192b2e8d4dad7864bb45f589a449?s=128&d=identicon&r=PG", "display_name": "Saleem Ahmed", "link": "https://stackoverflow.com/users/2375574/saleem-ahmed"}, "edited": false, "score": 1, "creation_date": 1505938095, "post_id": 46330633, "comment_id": 79622690, "body": "Also your program snippet has no function definition for fork() or getpid() hence the undefined error."}, {"owner": {"reputation": 3184, "user_id": 6710751, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qmR1W.jpg?s=128&g=1", "display_name": "Striezel", "link": "https://stackoverflow.com/users/6710751/striezel"}, "reply_to_user": {"reputation": 1909, "user_id": 2375574, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9ed9192b2e8d4dad7864bb45f589a449?s=128&d=identicon&r=PG", "display_name": "Saleem Ahmed", "link": "https://stackoverflow.com/users/2375574/saleem-ahmed"}, "edited": false, "score": 2, "creation_date": 1505940664, "post_id": 46330633, "comment_id": 79623871, "body": "@Saleem Ahmed Both <code>fork()</code> and <code>getpid()</code> as well as <code>getppid()</code> are defined in the header unistd.h, which is included in the code example above."}, {"owner": {"reputation": 3184, "user_id": 6710751, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qmR1W.jpg?s=128&g=1", "display_name": "Striezel", "link": "https://stackoverflow.com/users/6710751/striezel"}, "edited": false, "score": 0, "creation_date": 1505941005, "post_id": 46330633, "comment_id": 79624019, "body": "@Shagun Ramola What compiler are you using? Your example compiles without errors for me on GCC 4.9 on Debian Linux."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1505942108, "post_id": 46330633, "comment_id": 79624523, "body": "It is compiler configuration problem. Check the linked libraries."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8549610"}, "edited": false, "score": 0, "creation_date": 1505945776, "post_id": 46330633, "comment_id": 79625904, "body": "This might be relevant: <a href=\"https://stackoverflow.com/a/9612414/8549610\">stackoverflow.com/a/9612414/8549610</a> ."}], "owner": {"reputation": 1, "user_id": 8644092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0482ecc46ecd88a1c4a5754f4a7a74ef?s=128&d=identicon&r=PG&f=1", "display_name": "Shagun Ramola", "link": "https://stackoverflow.com/users/8644092/shagun-ramola"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1418, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1505941353, "creation_date": 1505936841, "last_edit_date": 1505941353, "question_id": 46330633, "link": "https://stackoverflow.com/questions/46330633/undefined-reference-to-function-fork-and-getppid", "title": "undefined reference to function fork and getppid", "body": "<p>The error I am getting on compiling the following code is\nundefined reference to 'fork'\nundefined reference to 'getppid'\nerror: ld returned 1 exit status </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;unistd.h&gt;\n#include&lt;sys/types.h&gt;\n\nint main()\n{\n    int pid;\n    pid=fork();    //creates child process and stores the return value \n    if(pid&gt;0)\n        printf(\"parent process id:%d\",getpid());    //prints the process id\n    else if(pid==0)\n        printf(\"Child process id:%d parent id:%d Parent process id:%d\",getpid(),getppid());    //prints the process and parent id\n    else\n        printf(\"Error\");\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "namespaces", "name-lookup"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1505936565, "post_id": 46330526, "comment_id": 79621906, "body": "<i>&quot;The compiler looks for the variable to print in the tag namespace first&quot;</i> - No it doesn&#39;t. You didn&#39;t specify a tag keyword."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1505936583, "post_id": 46330526, "comment_id": 79621912, "body": "Not clear. A name is only searched in the name space you specify. Btw: There is no &quot;tag name space&quot;."}, {"owner": {"reputation": 3639, "user_id": 1513753, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/S45L5.jpg?s=128&g=1", "display_name": "0decimal0", "link": "https://stackoverflow.com/users/1513753/0decimal0"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1505936939, "post_id": 46330526, "comment_id": 79622067, "body": "@StoryTeller  tag keyword? didn&#39;t get you . <code>struct </code> is the tag name ."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1505937039, "post_id": 46330526, "comment_id": 79622117, "body": "No. <code>struct</code> is a kewyrod. <code>struct id</code> tells the compiler you want a tagged type  and that it should look for <code>id</code> in the tag namespace."}, {"owner": {"reputation": 3639, "user_id": 1513753, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/S45L5.jpg?s=128&g=1", "display_name": "0decimal0", "link": "https://stackoverflow.com/users/1513753/0decimal0"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1505937137, "post_id": 46330526, "comment_id": 79622163, "body": "@StoryTeller ofcourse <code>struct</code> is a keyword and it comes in tag namespace if not defined using <code>typedef</code>."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1505937257, "post_id": 46330526, "comment_id": 79622226, "body": "<code>struct</code> doesn&#39;t come in the tag namespace... it&#39;s a keyword, not an identifier. Only identifiers go into namespaces."}, {"owner": {"reputation": 3639, "user_id": 1513753, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/S45L5.jpg?s=128&g=1", "display_name": "0decimal0", "link": "https://stackoverflow.com/users/1513753/0decimal0"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1505937312, "post_id": 46330526, "comment_id": 79622256, "body": "@StoryTeller yeah I meant the identifier defined using <code>struct</code>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1505937437, "post_id": 46330526, "comment_id": 79622350, "body": "You favourite C book could tell better, but for <code>stuct tag</code> <code>tag</code> is the tag. <code>struct</code> introduces the structure-specifier."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1505937897, "post_id": 46330526, "comment_id": 79622588, "body": "&quot;<i>Strangely enough for me, it did print 6 the first time I compiled it</i>&quot; -- it did not.  I can imagine small variations on the code that would print 6, but the exact code you presented will always print 7, as shown."}, {"owner": {"reputation": 3639, "user_id": 1513753, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/S45L5.jpg?s=128&g=1", "display_name": "0decimal0", "link": "https://stackoverflow.com/users/1513753/0decimal0"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1505938006, "post_id": 46330526, "comment_id": 79622641, "body": "@JohnBollinger Yes , you are right I tweaked with the code and I didn&#39;t even notice it. Will edit the question."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1505938268, "post_id": 46330526, "comment_id": 79622770, "body": "@Olaf, you&#39;re right that there is no <i>single</i> &quot;tag name space&quot;, but there are indeed three different ones, as C2011 6.2.3 pretty clearly states: &quot;there are separate name spaces for various categories of identifiers, as follows [...] the tags of structures, unions, and enumerations (disambiguated by [...] the keywords struct, union, or enum)&quot;.  But of course these are not namespaces in the C++ sense; the namespace to which a C identifier belongs is completely  determined by the kind of thing it identifies."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1505938536, "post_id": 46330526, "comment_id": 79622909, "body": "@JohnBollinger: As the question is tagged C, not C++, I think the context is clear. The standard expliciutly uses the term &quot;name space&quot;, so it is fine. I&#39;d say it is very well comparable to C++ namespaces, they are just bound to the type and there are no custom name spaces. However, nothing a good C book will not explain at the level asked."}], "answers": [{"comments": [{"owner": {"reputation": 3639, "user_id": 1513753, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/S45L5.jpg?s=128&g=1", "display_name": "0decimal0", "link": "https://stackoverflow.com/users/1513753/0decimal0"}, "edited": false, "score": 0, "creation_date": 1505938257, "post_id": 46330750, "comment_id": 79622764, "body": "Well actually defining same name will result in a conflict. Still confused about the order of lookup."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 3639, "user_id": 1513753, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/S45L5.jpg?s=128&g=1", "display_name": "0decimal0", "link": "https://stackoverflow.com/users/1513753/0decimal0"}, "edited": false, "score": 2, "creation_date": 1505938541, "post_id": 46330750, "comment_id": 79622912, "body": "@0decimal0, there is no lookup order.  Only one namespace is ever considered for any particular identifier; it is determined by what kind of identifier is being looked up.  Structure tags are one kind, with their own namespace; variable names are in the broader category of &quot;ordinary identifiers&quot;, which have a separate namespace.  There are other name spaces, too, but the compiler can always tell from context which one is relevant to any given identifier."}, {"owner": {"reputation": 3639, "user_id": 1513753, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/S45L5.jpg?s=128&g=1", "display_name": "0decimal0", "link": "https://stackoverflow.com/users/1513753/0decimal0"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1505978429, "post_id": 46330750, "comment_id": 79635173, "body": "Thanks @JohnBollinger , I get it now."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1506004220, "post_id": 46330750, "comment_id": 79653430, "body": "@JohnBollinger May I copy your comment into the text of my answer?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1506006368, "post_id": 46330750, "comment_id": 79654959, "body": "Sure, @zwol, I have no objection."}], "tags": [], "owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "is_accepted": true, "score": 7, "last_activity_date": 1506013302, "last_edit_date": 1506013302, "creation_date": 1505937256, "answer_id": 46330750, "question_id": 46330526, "link": "https://stackoverflow.com/questions/46330526/namespace-lookup-order-in-c/46330750#46330750", "title": "Namespace lookup order in C", "body": "<p>There is no namespace lookup order in C. Only one namespace is ever considered for any particular identifier; it is determined by what kind of identifier is being looked up. Structure tags are one kind, with their own namespace; variable names are in the broader category of \"ordinary identifiers\", which have a separate namespace. There are other name spaces, too, but the compiler can always tell from context which one is relevant to any given identifier.</p>\n\n<p>Thus, in your program, both uses of <code>myst.min</code> refer to the variable declared as <code>st myst;</code> and there isn't any second variable in the \"tag\" namespace (as you seem to have thought there would be).</p>\n\n<p>You can see this for yourself by commenting out everything within <code>main</code> above <code>myst.min = 7</code>:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main (void){\n#if 0\n  typedef struct{ //This belongs to ordinary name space\n    int min;\n  } st;\n  st myst;\n  myst.min=6;\n#endif\n  struct myst{ // This belongs to tag name space\n    int min;\n  };\n  myst.min=7;\n  printf(\"%d\\n%d\\n\",myst.min,myst.min);\n  return 0;\n}\n</code></pre>\n\n<p>Attempting to compile this will produce a hard error:</p>\n\n<pre><code>test.c: In function \u2018main\u2019:\ntest.c:14:3: error: \u2018myst\u2019 undeclared (first use in this function)\n</code></pre>\n\n<p>What the <code>struct myst</code> declaration does is declare another <strong>type</strong>, which you can then use to declare variables.  But it's not used for anything unless you actually do that.  For instance</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\ntypedef struct { int min; } st;\nstruct myst { int min };\nint main(void)\n{\n    // uses the typedef name 'st', in the ordinary namespace,\n    // to declare the variable 'myst', also in the ordinary namespace\n    st myst = { 6 };\n\n    // uses the struct name 'myst', in the tag namespace,\n    // to declare the variable 'myst2', in the ordinary namespace\n    struct myst myst2 = { 7 };\n\n    printf(\"%d %d\\n\", myst.min, myst2.min);\n    return 0;\n}\n</code></pre>\n\n<p>will print <code>6 7</code>.  This program also illustrates how <code>myst</code>, the variable, and <code>myst</code>, the struct tag, are indeed in two different namespaces and can be referred to independently.</p>\n\n<hr>\n\n<p>(Thanks to John Bollinger for the new first paragraph. \u2014ed)</p>\n"}, {"comments": [{"owner": {"reputation": 3639, "user_id": 1513753, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/S45L5.jpg?s=128&g=1", "display_name": "0decimal0", "link": "https://stackoverflow.com/users/1513753/0decimal0"}, "edited": false, "score": 0, "creation_date": 1505978499, "post_id": 46331881, "comment_id": 79635223, "body": "You answer is to the point and succinct , thanks . upvoted :)"}], "tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": false, "score": 3, "last_activity_date": 1505942090, "creation_date": 1505942090, "answer_id": 46331881, "question_id": 46330526, "link": "https://stackoverflow.com/questions/46330526/namespace-lookup-order-in-c/46331881#46331881", "title": "Namespace lookup order in C", "body": "<p>C namespaces are completely disjoint. Each identifier is searches ony in one namespace. For example:</p>\n\n<ul>\n<li>Identifiers that follow <code>struct</code>and <code>union</code> keywords are searched in the tag namespace</li>\n<li>Identifiers that follow the <code>goto</code> keyword are searched in the label namespace</li>\n<li>Identifiers that follow <code>.</code> or <code>-&gt;</code> symbols are searched in their structure or union member namespace (each structure and union has its own member namespace; type of the preceding expression determines which one to search)</li>\n<li>Other identifiers are searched in the ordinary namespace.</li>\n</ul>\n\n<p>There is no lookup order. The (unique) namespace to search is completely determined by the context.</p>\n"}], "owner": {"reputation": 3639, "user_id": 1513753, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/S45L5.jpg?s=128&g=1", "display_name": "0decimal0", "link": "https://stackoverflow.com/users/1513753/0decimal0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 46330750, "answer_count": 2, "score": 2, "last_activity_date": 1506013302, "creation_date": 1505936414, "last_edit_date": 1592644375, "question_id": 46330526, "link": "https://stackoverflow.com/questions/46330526/namespace-lookup-order-in-c", "title": "Namespace lookup order in C", "body": "<p>Is there an order of lookup in the namespaces namely, <em>tag namespace</em> and <em>ordinary name space</em> ? Consider the following code :</p>\n<pre><code>#include &lt;stdio.h&gt;\n\nint main (void){\n\n  typedef struct{ //This belongs to ordinary name space\n    int min;\n  } st;\n  st myst;\n  myst.min=6;\n  struct myst{ // This belongs to tag name space\n    int min;\n  };\n  myst.min=7;\n  printf(&quot;%d\\n%d\\n&quot;,myst.min,myst.min);\n  return 0;\n}\n</code></pre>\n<p><strong>Output</strong></p>\n<blockquote>\n<p>7</p>\n<p>7</p>\n</blockquote>\n<p>The compiler looks for the variable to print in the tag namespace first , I guess. I don't know if the lookup is even done for the same identifier in the ordinary namespace and if it is done I am clueless why it doesn't print it.</p>\n"}, {"tags": ["c", "terminal", "binary", "reverse-engineering", "tty"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1505932687, "post_id": 46329447, "comment_id": 79619873, "body": "Your question is confusing. Are you asking how to type control characters on the terminal, or how the C program writes what it read into memory?"}, {"owner": {"reputation": 112977, "user_id": 390278, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/84715fec547362389d02f5be0ed12814?s=128&d=identicon&r=PG", "display_name": "Jeff Mercado", "link": "https://stackoverflow.com/users/390278/jeff-mercado"}, "edited": false, "score": 0, "creation_date": 1505932907, "post_id": 46329447, "comment_id": 79619990, "body": "If you&#39;re operating on binary data, you shouldn&#39;t be using <code>fgets()</code> and friends. That&#39;s for reading text data."}, {"owner": {"reputation": 81, "user_id": 6805294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a341c8970e08c92210efd6fd01fe46b5?s=128&d=identicon&r=PG&f=1", "display_name": "GhostSparkles", "link": "https://stackoverflow.com/users/6805294/ghostsparkles"}, "edited": false, "score": 0, "creation_date": 1505933058, "post_id": 46329447, "comment_id": 79620060, "body": "Sorry, I&#39;m on my phone right now. Possibly the former. If I write AAAA I get x41x41x41x41 etc in memory. If I write \\x84 it writes x78x38x34 etc. I&#39;m having trouble writing the hex value I want as fgets interprets everything as ascii and doesn&#39;t seem to allow escape sequences."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1505933200, "post_id": 46329447, "comment_id": 79620125, "body": "That&#39;s not really a programming question, then, it&#39;s more about how to use Unix."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1505976633, "post_id": 46329447, "comment_id": 79634127, "body": "Are you sure you used <code>expect</code> correctly?  Of course <code>fgets</code> doesn&#39;t process escape sequences inside the program using it.  Neither does <code>strcpy</code>, or <code>scanf(&quot;%s&quot;)</code>.  I didn&#39;t fully read your last comment until after making an edit, so I think I actually answered half of your question by editing it."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1506044531, "post_id": 46329447, "comment_id": 79671040, "body": "the function: <code>fgets()</code> cannot overflow the input buffer unless the server programmer typed an invalid length for the buffer.  I suspect you are thinking of <code>gets()</code>.  In fact that is why <code>gets()</code> is nolonger part of the C language."}, {"owner": {"reputation": 81, "user_id": 6805294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a341c8970e08c92210efd6fd01fe46b5?s=128&d=identicon&r=PG&f=1", "display_name": "GhostSparkles", "link": "https://stackoverflow.com/users/6805294/ghostsparkles"}, "edited": false, "score": 0, "creation_date": 1506103293, "post_id": 46329447, "comment_id": 79700820, "body": "I&#39;m not directly overflowing fgets, the overflow is possible because the fgets buffer is larger than the one it will be copied into.  I&#39;ll update my question for clarity."}], "answers": [{"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1505978818, "post_id": 46329623, "comment_id": 79635426, "body": "You might also be able to copy/paste data with the high bit set, if you can overcome any UTF-8 assumptions in your terminal."}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 4, "last_activity_date": 1505933489, "last_edit_date": 1505933489, "creation_date": 1505933179, "answer_id": 46329623, "question_id": 46329447, "link": "https://stackoverflow.com/questions/46329447/write-non-ascii-characters-to-stdin-of-a-progam-on-a-tty-over-ssh/46329623#46329623", "title": "Write non-ASCII characters to stdin of a progam on a tty (over ssh)", "body": "<p>You can write characters in the range <code>0x00</code> to <code>0x1f</code> by typing control characters on the keyboard. Hold down the <Kbd>Control</kbd> key while typing a character in the third column of this <a href=\"http://www.asciitable.com/\" rel=\"nofollow noreferrer\">ASCII Chart</a> to get the corresponding code in the first column.</p>\n\n<p>Some control characters have special meaning to the terminal driver (e.g. <kbd>Ctl-c</kbd> to kill the process), you can type them literally by preceding with <kbd>Ctl-v</kbd>.</p>\n\n<p>And you can get <code>0x7f</code> by typing <kbd>Ctl-v</kbd><kbd>Delete</kbd> (this is the backward delete character, which might be labeld <kbd>Backspace</kbd>, not the forward delete that may be in a separate keypad). </p>\n\n<p>I'm not sure if there's any easy way to type characters above this. Depending on the settings in your terminal emulator, you might be able to get the high bit set by holding the <kbd>Alt</kbd> key while typing the corresponding ASCII character. E.g. <kbd>Alt-A</kbd> would send <code>0xc1</code> (<code>0x80 | 0x41</code>).</p>\n"}, {"comments": [{"owner": {"reputation": 81, "user_id": 6805294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a341c8970e08c92210efd6fd01fe46b5?s=128&d=identicon&r=PG&f=1", "display_name": "GhostSparkles", "link": "https://stackoverflow.com/users/6805294/ghostsparkles"}, "edited": false, "score": 1, "creation_date": 1506028930, "post_id": 46337879, "comment_id": 79666818, "body": "&#39; Precede every byte with a control-v (hex 0x16)&#39; worked perfectly for me. I used a pexpect script to send the hex.  Nice extension on Barmar&#39;s answer.  Upvoted both.   &#39;it&#39;s stripped by the TTY layer in the receiver even before ordinary characters&#39; very interesting morsel of information, thank you!"}], "tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": true, "score": 3, "last_activity_date": 1505978785, "creation_date": 1505978785, "answer_id": 46337879, "question_id": 46329447, "link": "https://stackoverflow.com/questions/46329447/write-non-ascii-characters-to-stdin-of-a-progam-on-a-tty-over-ssh/46337879#46337879", "title": "Write non-ASCII characters to stdin of a progam on a tty (over ssh)", "body": "<p>For high characters, you can probably copy/paste.</p>\n\n<p>e.g. <code>echo -ne \"\\x84\" | xclip -i</code> then middle-click in your terminal emulator, if your desktop is also running Linux.  (<strong>or maybe not, see below</strong>).  Or <code>echo ... | ssh user@host</code> could work.</p>\n\n<p><code>ssh -T</code> or the equivalent in any other terminal emulator might also be an option, to \"Disable pseudo-terminal allocation\", so the program on the remote side would have its <code>stdin</code> be a pipe from sshd, rather than a pseudo-terminal, I think.  This would disable stuff like <code>^s</code> and <code>^v</code> being special, I think.</p>\n\n<p>Conversely, <code>echo foo | ssh -tt</code> will force it to request a tty on the remote side, even though you're piping stuff into ssh.</p>\n\n<hr>\n\n<p>A less-intrusive way to make sure binary data over SSH gets through the TTY layer and to the <code>stdin</code> of the receiving program is to precede every byte with a control-<code>v</code> (hex 0x16).</p>\n\n<p>As Barmar points out, that's the literal-next character (<code>lnext</code> in <code>stty -a</code> output).  You can use it before <em>every</em> byte of your payload; it's stripped by the TTY layer in the receiver even before ordinary characters.</p>\n\n<pre><code># LANG=C sed to replace every byte with ^V byte\n# using bash $'' to put a literal control-V on sed's command line\necho \"hello\" | LANG=C sed $'s/./\\x16&amp;/g' | hd\n        16 68 16 65 16 6c 16 6c  16 6f 0a                 |.h.e.l.l.o.|\n</code></pre>\n\n<p>You can test all this locally by typing into <code>hexdump -C</code> (aka <code>hd</code>).  Just run it in a terminal, and type or paste some stuff, then control-D until it exits.</p>\n\n<pre><code>$ echo -ne \"\\x01\\xff\\x99\" | LANG=C sed $'s/./\\x16&amp;/g' | hd\n00000000  16 01 16 ff 16 99                                 |......|\n00000006\n      # yup, correct bytes from sed\n$ echo -ne \"\\x01\\xff\\x99\" | LANG=C sed $'s/./\\x16&amp;/g' | xclip -i\n$ LANG=C hd\n^A\ufffd\ufffd     (middle click, return, control-d)\n00000000  01 ef bf bd ef bf bd 0a                           |........|\n     # nope, that munged my data :/\n\n$ xclip -o | hd\n00000000  16 01 16 ff 16 99                                 |......|\n</code></pre>\n\n<p>So the X selection itself is correct, but it's getting munged either by Konsole as I paste, or by the TTY layer on the way from Konsole to <code>hexdump</code>?  The latter seems unlikely; probably it's a paste problem.  Konsole's \"encoding\" setting is UTF-8.  It doesn't seem to have a plain ASCII setting.</p>\n\n<p>Maybe try with <code>LANG=C xterm</code> or something, or just script <code>expect</code> correctly to send actual binary data to <code>ssh</code>, rather than escape codes.</p>\n\n<hr>\n\n<p><code>fgets</code> of course does not process escape sequences, any more than <code>strcpy</code> would.  In general C functions don't; but in C the <em>compiler</em> processes escape sequences inside <em>string literals</em> at compile time.</p>\n"}], "owner": {"reputation": 81, "user_id": 6805294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a341c8970e08c92210efd6fd01fe46b5?s=128&d=identicon&r=PG&f=1", "display_name": "GhostSparkles", "link": "https://stackoverflow.com/users/6805294/ghostsparkles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2382, "favorite_count": 1, "accepted_answer_id": 46337879, "answer_count": 2, "score": 2, "last_activity_date": 1507055875, "creation_date": 1505932582, "last_edit_date": 1507055875, "question_id": 46329447, "link": "https://stackoverflow.com/questions/46329447/write-non-ascii-characters-to-stdin-of-a-progam-on-a-tty-over-ssh", "title": "Write non-ASCII characters to stdin of a progam on a tty (over ssh)", "body": "<p>I'm SSHd into a remote server with some binary challenges. </p>\n\n<p>At one point it asks for me to input text. I know it's using <code>fgets()</code> to read <code>stdin</code>, and that I can overflow where it is being copied to and overwrite a nearby variable. </p>\n\n<p>The problem is I don't know how to type the address values I need, <code>\\x84</code> and <code>\\x04</code> etc. If I were able to use bash I would <code>echo -ne \"\\x84\"</code> or use a C hex array but I can't do that kind of thing here. </p>\n\n<p>I've tried using a hex to ASCII converter and copying the binary character and also using expect script to send the binary values but both have the same issue. x84 adds an extra char and x04 won't write at all. </p>\n\n<p>Any idea the best way to reliably write values to memory that can't be represented by ASCII characters over ssh on a Unix tty?</p>\n"}, {"tags": ["c", "bit-shift"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1505932315, "post_id": 46329341, "comment_id": 79619670, "body": "Looks like a Brainfck program..."}, {"owner": {"reputation": 91305, "user_id": 19410, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/175f1d55c73ce5cb1d071dc4d0f1a333?s=128&d=identicon&r=PG", "display_name": "Alex Reynolds", "link": "https://stackoverflow.com/users/19410/alex-reynolds"}, "edited": false, "score": 0, "creation_date": 1505932329, "post_id": 46329341, "comment_id": 79619677, "body": "<a href=\"https://stackoverflow.com/questions/10493411/what-is-bit-masking\">stackoverflow.com/questions/10493411/what-is-bit-masking</a>"}, {"owner": {"reputation": 253, "user_id": 3473653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0b3fec1a002544e3802f0fa0185b388?s=128&d=identicon&r=PG&f=1", "display_name": "PeskyToaster", "link": "https://stackoverflow.com/users/3473653/peskytoaster"}, "edited": false, "score": 0, "creation_date": 1505932420, "post_id": 46329341, "comment_id": 79619733, "body": "I would lay out the code in a more readable manner. In its current state it might as well be a PPCG answer."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1505933217, "post_id": 46329341, "comment_id": 79620133, "body": "<code>c</code> is an <i>uninitialised variable</i> so the operation will be undefined behaviour. Please post the typical <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> that shows the code."}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1505933686, "post_id": 46329341, "comment_id": 79620358, "body": "<code>((c&amp;(1&lt;&lt;0))!=0)&lt;&lt;6</code> simplifies to <code>(c&amp;(1&lt;&lt;0))&lt;&lt;6</code>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1505933923, "post_id": 46329341, "comment_id": 79620498, "body": "@ikegami and <code>1&lt;&lt;0</code> simplifies to.. ?"}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1505933963, "post_id": 46329341, "comment_id": 79620524, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/22338208/reverse-bits-in-byte-ansi-c\">reverse bits in byte ansi C</a>. Check the <a href=\"http://graphics.stanford.edu/~seander/bithacks.html#BitReverseObvious\" rel=\"nofollow noreferrer\">Bit Twiddling Hacks</a> page."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 1, "creation_date": 1505934023, "post_id": 46329341, "comment_id": 79620552, "body": "@Groo I deleted my answer which does that, because that is not the problem spec."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1505934179, "post_id": 46329341, "comment_id": 79620637, "body": "@Groo Not reversing bits, &quot;(c&amp;(1&lt;&lt;1))!=0)&lt;&lt;1)|              (((c&amp;(1&lt;&lt;2))!=0)&lt;&lt;0)&quot; end up on the same bit, don&#39;t they?"}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1505934204, "post_id": 46329341, "comment_id": 79620654, "body": "Yes, just noticed it after the question was reformatted, thanks, removed the vote."}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1505934243, "post_id": 46329341, "comment_id": 79620681, "body": "@Eugene Sh., Nothing. That&#39;s a clear constant."}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1505934336, "post_id": 46329341, "comment_id": 79620736, "body": "@Yunnosch, No, If both bits are set, you end up with  <code>(1&lt;&lt;1) | (1&lt;&lt;0)</code>"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1505934408, "post_id": 46329341, "comment_id": 79620777, "body": "@ikegami True, just spotted my misthinking, missed the <code>!=0</code> everywhere."}], "answers": [{"tags": [], "owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": true, "score": 5, "last_activity_date": 1505936070, "last_edit_date": 1505936070, "creation_date": 1505934187, "answer_id": 46329906, "question_id": 46329341, "link": "https://stackoverflow.com/questions/46329341/how-to-rearrange-bits/46329906#46329906", "title": "How to rearrange bits?", "body": "<pre><code>(((c&amp;(1&lt;&lt;x))!=0)&lt;&lt;y)\n</code></pre>\n\n<p>can also be written as</p>\n\n<pre><code>((c&amp;(1&lt;&lt;x)))&lt;&lt;(y-x))\n</code></pre>\n\n<p>Right off the bat, that eliminates one operation per bit. (Keep in mind that <code>y-x</code> is constant.)</p>\n\n<p>But that's not it. If you apply this transformation throughout, you'll notice that some bits are shifted by the same amount.</p>\n\n<pre><code>(( c &amp; 0x01 ) &lt;&lt; 6 ) |\n(( c &amp; 0x02 )      ) |\n(( c &amp; 0x04 ) &gt;&gt; 2 ) |\n(( c &amp; 0x08 ) &gt;&gt; 1 ) |\n(( c &amp; 0x10 ) &gt;&gt; 1 ) |\n(( c &amp; 0x20 ) &gt;&gt; 1 ) |\n(( c &amp; 0x40 ) &gt;&gt; 1 ) |\n(( c &amp; 0x80 )      )\n</code></pre>\n\n<p>We can group those.</p>\n\n<pre><code>(( c &amp; 0x01 ) &lt;&lt; 6 ) |\n(( c &amp; 0x82 )      ) |\n(( c &amp; 0x78 ) &gt;&gt; 1 ) |\n(( c &amp; 0x04 ) &gt;&gt; 2 )\n</code></pre>\n\n<p>We reduced 30 operations down to 10.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9473344, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/f88b6654464f6df53b10b517e97edf29?s=128&d=identicon&r=PG", "display_name": "ekim", "link": "https://stackoverflow.com/users/9473344/ekim"}, "is_accepted": false, "score": 0, "last_activity_date": 1520717682, "creation_date": 1520717682, "answer_id": 49214267, "question_id": 46329341, "link": "https://stackoverflow.com/questions/46329341/how-to-rearrange-bits/49214267#49214267", "title": "How to rearrange bits?", "body": "<p>\"Better\"  as in: \"Beauty is in the eye of the beholder.\"?</p>\n\n<p>Simply? another way: (uses \"no\"!? operations other than assignment?)</p>\n\n<p>The 1988 2nd edition of \"The C Programming Language\" by Kernighan and Ritchie in the last two sections of Chapter 6 explains the subtleties and idiosyncrasies of this code:</p>\n\n<pre><code>uint8_t c;\nuint8_t string[3];\n\nunion { uint8_t  bits;\n  struct { uint8_t t7    :1;\n           uint8_t t3456 :4;\n           uint8_t t2    :1;\n           uint8_t t1    :1;\n           uint8_t t0    :1;\n         } bi;\n  struct { uint8_t b7    :1;\n           uint8_t b6    :1;\n           uint8_t b2345 :4;\n           uint8_t b1    :1;\n           uint8_t b0    :1;\n         } ti;\n      } b,d;\n\n  b.bits = d.bits = c;      // does b.ti.b1 = d.bi.t1; b.ti.b7 = d.bi.t7;\n\n  b.ti.b0    = d.bi.t2;\n  b.ti.b2345 = d.bi.t3456;\n  b.ti.b6    = d.bi.t0;\n\n  string[2] = b.bits;\n</code></pre>\n\n<p>Problems? Read the book and consider:</p>\n\n<pre><code>  struct { uint8_t t0    :1;\n           uint8_t t1    :1;\n           uint8_t t2    :1;\n           uint8_t t3456 :4;\n           uint8_t t7    :1;\n          } bi;\n  struct { uint8_t b0    :1;\n           uint8_t b1    :1;\n           uint8_t b2345 :4;\n           uint8_t b6    :1;\n           uint8_t b7    :1;\n          } ti;\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 6444850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1feac89b746d01c5d8691437c6eb8234?s=128&d=identicon&r=PG&f=1", "display_name": "Dominic", "link": "https://stackoverflow.com/users/6444850/dominic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 544, "favorite_count": 0, "accepted_answer_id": 46329906, "answer_count": 2, "score": 0, "last_activity_date": 1520717682, "creation_date": 1505932203, "last_edit_date": 1505934057, "question_id": 46329341, "link": "https://stackoverflow.com/questions/46329341/how-to-rearrange-bits", "title": "How to rearrange bits?", "body": "<p>I have to rearagne bits in a byte. I solved the problme like this:</p>\n\n<pre><code>uint8_t c;\nuint8_t string[3];\n\nstring1[2] = (((c&amp;(1&lt;&lt;0))!=0)&lt;&lt;6)|\n             (((c&amp;(1&lt;&lt;1))!=0)&lt;&lt;1)|\n             (((c&amp;(1&lt;&lt;2))!=0)&lt;&lt;0)|\n             (((c&amp;(1&lt;&lt;3))!=0)&lt;&lt;2)|\n             (((c&amp;(1&lt;&lt;4))!=0)&lt;&lt;3)|\n             (((c&amp;(1&lt;&lt;5))!=0)&lt;&lt;4)|\n             (((c&amp;(1&lt;&lt;6))!=0)&lt;&lt;5)|\n             (((c&amp;(1&lt;&lt;7))!=0)&lt;&lt;7);\n</code></pre>\n\n<p>basicly:</p>\n\n<p>if bit0 is a 1, shift a 1 6times to the left.</p>\n\n<p>if bit1 is a 1, shift a 1 0times to the left.\n....</p>\n\n<p>Is there a better solution?</p>\n"}, {"tags": ["c", "hashtable"], "comments": [{"owner": {"reputation": 47412, "user_id": 3141234, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/78b45a835031f4ce03a6653b3262b5d3?s=128&d=identicon&r=PG", "display_name": "Alexander", "link": "https://stackoverflow.com/users/3141234/alexander"}, "edited": false, "score": 0, "creation_date": 1505931139, "post_id": 46329041, "comment_id": 79619006, "body": "is just using C++ an option? :|"}, {"owner": {"reputation": 4073, "user_id": 152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXFHS.jpg?s=128&g=1", "display_name": "Jonesinator", "link": "https://stackoverflow.com/users/152/jonesinator"}, "edited": false, "score": 7, "creation_date": 1505931168, "post_id": 46329041, "comment_id": 79619020, "body": "I&#39;m confused why you can&#39;t just change the key type to integer, and hash on the integer key."}, {"owner": {"reputation": 570, "user_id": 6327671, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/edaa078c07f64b105935a2dda9256486?s=128&d=identicon&r=PG&f=1", "display_name": "dav", "link": "https://stackoverflow.com/users/6327671/dav"}, "edited": false, "score": 0, "creation_date": 1505931271, "post_id": 46329041, "comment_id": 79619071, "body": "Sorry I wasn&#39;t clear. I want to hash with a string (using char pointer as the key) and store an integer (integer is the value). My hash table implementation uses string for both though."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1505931328, "post_id": 46329041, "comment_id": 79619105, "body": "&quot;My hash table implementation uses string&quot; --&gt; post that code else this is too broad."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1505932601, "post_id": 46329041, "comment_id": 79619828, "body": "I&#39;m still not sure I follow.  Are you asking how to use your existing hash table implementation, unmodified, to store integer values, or are you asking how your implementation can be modified to handle integer values?  Or are you open to both?"}, {"owner": {"reputation": 570, "user_id": 6327671, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/edaa078c07f64b105935a2dda9256486?s=128&d=identicon&r=PG&f=1", "display_name": "dav", "link": "https://stackoverflow.com/users/6327671/dav"}, "edited": false, "score": 0, "creation_date": 1505932711, "post_id": 46329041, "comment_id": 79619889, "body": "I want to know how I can use the existing hash table implementation, unmodified, to store integer values."}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 2, "creation_date": 1505933840, "post_id": 46329041, "comment_id": 79620452, "body": "If it has to be &quot;unmodified&quot;, then you can do what you&#39;re doing now, convert numbers to strings. It will be inefficient, and consume more memory."}], "answers": [{"comments": [{"owner": {"reputation": 570, "user_id": 6327671, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/edaa078c07f64b105935a2dda9256486?s=128&d=identicon&r=PG&f=1", "display_name": "dav", "link": "https://stackoverflow.com/users/6327671/dav"}, "edited": false, "score": 0, "creation_date": 1505942829, "post_id": 46330575, "comment_id": 79624824, "body": "Ok, maybe it would be worth it to modify the implementation file. What is the most effective way of doing that?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 570, "user_id": 6327671, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/edaa078c07f64b105935a2dda9256486?s=128&d=identicon&r=PG&f=1", "display_name": "dav", "link": "https://stackoverflow.com/users/6327671/dav"}, "edited": false, "score": 0, "creation_date": 1505943812, "post_id": 46330575, "comment_id": 79625147, "body": "It depends, @DavidTran, on what modifications you&#39;re willing to make, and on what features you want to support.  If you want to support data values of varying type, with type-specific handling, through a generic API, then your entries need to bear an additional member by which the value&#39;s type is recorded.  In that case, I might also specify the value type as a union, maybe something like <code>union { char *as_string; int as_int; &#47;* ... *&#47; } val;</code>.  One would then choose which member of the union to access based on the type metadata carried by the entry."}, {"owner": {"reputation": 570, "user_id": 6327671, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/edaa078c07f64b105935a2dda9256486?s=128&d=identicon&r=PG&f=1", "display_name": "dav", "link": "https://stackoverflow.com/users/6327671/dav"}, "edited": false, "score": 0, "creation_date": 1505943989, "post_id": 46330575, "comment_id": 79625212, "body": "I was wondering whether to use that (unions) or to store the value in the struct as a <code>void *</code>, adding a struct member to <code>hashtable_t</code> to keep track of it&#39;s type, and acting accordingly with the other functions. Would this work as well?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 570, "user_id": 6327671, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/edaa078c07f64b105935a2dda9256486?s=128&d=identicon&r=PG&f=1", "display_name": "dav", "link": "https://stackoverflow.com/users/6327671/dav"}, "edited": false, "score": 0, "creation_date": 1505946752, "post_id": 46330575, "comment_id": 79626234, "body": "That&#39;s two different questions.  First, yes, if each hash table is to carry values of consistent type, then you can put the metadata conveying that data type into the overall hash table type, once, instead of into each entry.  Second, yes, you can use a <code>void *</code>, +/- actual dynamic allocation in various cases, to store the values.  Do note that approaches that require dynamic memory allocation are much more costly than those that don&#39;t."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 1, "last_activity_date": 1505936939, "last_edit_date": 1505936939, "creation_date": 1505936603, "answer_id": 46330575, "question_id": 46329041, "link": "https://stackoverflow.com/questions/46329041/storing-integers-in-c-implemented-hash-tables/46330575#46330575", "title": "Storing integers in c-implemented hash tables?", "body": "<p>The access and manipulation functions associated with your hash table implementation assume that values have the form of null-terminated strings, and that their significance is carried entirely by their contents (not, for example, by the values of the pointers themselves).  Among other things, this is evident from the fact that the <code>new()</code> and <code>ht_insert()</code> functions make copies of the provided values via <code>strdup()</code>.  Therefore, if you intend to use those functions (not just the underlying data structures) then your only alternative for storing integers is to encode the integers into strings in some way, and store the strings.  This is what you already came up with.</p>\n\n<p>Note, by the way, that this presents a bit of an issue if you want to be able to store both strings and integers in the same hash table.  The table entries do not provide any way to record data type metadata, so to avoid collisions between string and number representations, you would need to encode data types into the values you store -- not only for the integers, but for the strings, too.  For example, you might encode values into strings whose first character communicates the data type.  Thus, perhaps <code>\"S12345\"</code> represents the <em>string</em> <code>\"12345\"</code>, whereas <code>\"I12345\"</code> represents the <em>integer</em> <code>12345</code>.  But you don't need such tricks if you assume all the values are of uniform type, on a table-by-table basis.</p>\n\n<p>You would have more options if you were open to writing at least a partial set of alternative hash table functions for storing integers in the existing data structures.  For example, you might use the fact that pointers and integers can be converted back and forth (with implementation-defined results). But I interpret you to have rejected such approaches, as using alternative functions is effectively the same thing as modifying the implementation.</p>\n"}], "owner": {"reputation": 570, "user_id": 6327671, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/edaa078c07f64b105935a2dda9256486?s=128&d=identicon&r=PG&f=1", "display_name": "dav", "link": "https://stackoverflow.com/users/6327671/dav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 750, "favorite_count": 0, "accepted_answer_id": 46330575, "answer_count": 1, "score": 0, "last_activity_date": 1505936939, "creation_date": 1505931070, "last_edit_date": 1505931399, "question_id": 46329041, "link": "https://stackoverflow.com/questions/46329041/storing-integers-in-c-implemented-hash-tables", "title": "Storing integers in c-implemented hash tables?", "body": "<p>Currently I have a hash table implementation in C that uses strings as the keys and values. If I wanted to store integers instead of strings as the values, what would be the best way to do this? I'm thinking of storing the integer in a string and converting it to an integer when I need it but it seems inefficient for arithmetic. Something like</p>\n\n<pre><code>insert(\"money\", \"13\");\nint i = atoi(get(\"key1\"));\nint sum = i + 10;\ninsert(\"money\", itoa(sum));\n</code></pre>\n\n<p>Is there a better way to do this?</p>\n\n<p>EDIT: hash table implementation</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\ntypedef struct tableentry /* hashtab entry */\n{\n    struct tableentry *next;\n    char *key;\n    char *val;\n} tableentry_t;\n\ntypedef struct hashtable\n{\n    size_t size;\n    struct tableentry **tab;\n} hashtable_t;\n\n/* creates hashtable */\n/* NOTE: dynamically allocated, remember to ht_free() */\nhashtable_t *ht_create(size_t size)\n{\n    hashtable_t *ht = NULL;\n    if ((ht = malloc(sizeof(hashtable_t))) == NULL)\n        return NULL;\n    /* allocate ht's table */\n    if ((ht-&gt;tab = malloc(sizeof(tableentry_t) * size)) == NULL)\n        return NULL;\n    /* null-initialize table */\n    int i;\n    for (i = 0; i &lt; size; i++)\n        ht-&gt;tab[i] = NULL;\n    ht-&gt;size = size;\n    return ht;\n}\n\n/* creates hash for a hashtab */\nstatic unsigned hash(hashtable_t *ht, char *s)\n{\n    unsigned hashval;\n    for (hashval = 0; *s != '\\0'; s++)\n        hashval = *s + 31 * hashval;\n    return hashval;\n}\n\n/* loops through linked list freeing */\nstatic void te_free(tableentry_t *te)\n{\n    tableentry_t *next;\n    while (te != NULL)\n    {\n        next = te-&gt;next;\n        free(te-&gt;key);\n        free(te-&gt;val);\n        free(te);\n        te = next;\n    }\n}\n\n/* creates a key-val pair */\nstatic tableentry_t *new(char *k, char *v)\n{\n    tableentry_t *te = NULL;\n\n    if ((te = calloc(1, sizeof(*te))) == NULL\n        || (te-&gt;key = strdup(k)) == NULL\n        || (te-&gt;val = strdup(v)) == NULL)\n    {\n        te_free(te);\n        return NULL;\n    }\n    te-&gt;next = NULL;\n    return te;\n}\n\nstatic tableentry_t *lookup(hashtable_t *ht, char *k)\n{\n    tableentry_t *te;\n    /* step through linked list */\n    for (te = ht-&gt;tab[hash(ht, k) % ht-&gt;size]; te != NULL; te = te-&gt;next)\n        if (strcmp(te-&gt;key, k) == 0)\n            return te; /* found */\n    return NULL; /* not found */\n}\n\n/* inserts the key-val pair */\nhashtable_t *ht_insert(hashtable_t *ht, char *k, char *v)\n{\n    tableentry_t *te;\n    /* unique entry */\n    if ((te = lookup(ht, k)) == NULL)\n    {\n        te = new(k, v);\n        unsigned hashval = hash(ht, k) % ht-&gt;size;\n        /* insert at beginning of linked list */\n        te-&gt;next = ht-&gt;tab[hashval]; \n        ht-&gt;tab[hashval] = te;\n    }\n    /* replace val of previous entry */\n    else\n    {\n        free(te-&gt;val);\n        if ((te-&gt;val = strdup(v)) == NULL)\n            return NULL;\n    }\n    return ht;\n}\n\n/* retrieve value from key */\nchar *ht_get(hashtable_t *ht, char *k)\n{\n    tableentry_t *te;\n    if ((te = lookup(ht, k)) == NULL)\n        return NULL;\n    return te-&gt;val;\n}\n\n/* frees hashtable created from ht_create() */\nvoid ht_free(hashtable_t *ht)\n{\n    int i;\n    for (i = 0; i &lt; ht-&gt;size; i++)\n        if (ht-&gt;tab[i] != NULL)\n            te_free(ht-&gt;tab[i]);\n    free(ht);\n}\n\n/* resizes hashtable, returns new hashtable and frees old*/\nhashtable_t *ht_resize(hashtable_t *oht, size_t size)\n{\n    hashtable_t *nht; /* new hashtable */\n    nht = ht_create(size);\n    /* rehash */\n    int i;\n    tableentry_t *te;\n    /* loop through hashtable */\n    for (i = 0; i &lt; oht-&gt;size; i++)\n        /* loop through linked list */\n        for (te = oht-&gt;tab[i]; te != NULL; te = te-&gt;next)\n            if (ht_insert(nht, te-&gt;key, te-&gt;val) == NULL)\n                return NULL;\n    ht_free(oht);\n    return nht;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "malloc", "free"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1505929076, "post_id": 46328472, "comment_id": 79617916, "body": "Are you on a platform where <a href=\"http://valgrind.org/\" rel=\"nofollow noreferrer\">Valgrind</a> works?  If so, use it.  The core dump likely means you&#39;ve trampled outside the bounds of your allocated array."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1505929157, "post_id": 46328472, "comment_id": 79617973, "body": "Why do people (particularly novices, I notice), like <code>*(r + (i * w) + j)</code> instead of <code>r[i * w + j]</code>?  Why is that nested loop counting?  You never use the count.  Are you meant to be creating strings?  You have no null terminators anywhere, so that you&#39;re <i>not</i> creating strings, just character arrays,"}, {"owner": {"reputation": 43, "user_id": 8469002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/773deefb768a403ff118e465288592c5?s=128&d=identicon&r=PG&f=1", "display_name": "dleft", "link": "https://stackoverflow.com/users/8469002/dleft"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1505929492, "post_id": 46328472, "comment_id": 79618162, "body": "@JonathanLeffler - I&#39;ll check out valgrind now, I&#39;ve not done much debugging but it&#39;s an essential tool to learn so now is as good a time as any! - Not sure really, I just used that because that&#39;s how I learned to do it. - Lastly, the count was there because I originally had the array contain ints, i wanted to check I had created the array properly so each element had a seperate value. When I changed it to chars I just forgot to remove the count."}, {"owner": {"reputation": 888, "user_id": 1096140, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5rFfC.jpg?s=128&g=1", "display_name": "hesham_EE", "link": "https://stackoverflow.com/users/1096140/hesham-ee"}, "edited": false, "score": 1, "creation_date": 1505929552, "post_id": 46328472, "comment_id": 79618183, "body": "This <code>*(r + (i * w) + j) = &#39;X&#39;</code> should have been <code>*(r + (i * h) + j) = &#39;X&#39;</code>"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1505929669, "post_id": 46328472, "comment_id": 79618239, "body": "And there is a similar error in <code>main</code>: the expression <code>*(p + (i * width) + j)</code> should be <code>*(p + (i * height) + j)</code>."}, {"owner": {"reputation": 43, "user_id": 8469002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/773deefb768a403ff118e465288592c5?s=128&d=identicon&r=PG&f=1", "display_name": "dleft", "link": "https://stackoverflow.com/users/8469002/dleft"}, "reply_to_user": {"reputation": 888, "user_id": 1096140, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5rFfC.jpg?s=128&g=1", "display_name": "hesham_EE", "link": "https://stackoverflow.com/users/1096140/hesham-ee"}, "edited": false, "score": 0, "creation_date": 1505929751, "post_id": 46328472, "comment_id": 79618281, "body": "@hesham_EE Just tried your response, and it&#39;s now not populating the array correctly.  Output: [X] [X] [X] [X] [X]  [X] [X] [X] [X] [X]  [X] [X] [X] [X] [X]  [X] [X] [X] [X] [X]  [X] [X] [X] [X] [X]  [] [] [] [] []  [] [] [] [] []"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1505929987, "post_id": 46328472, "comment_id": 79618416, "body": "&quot;but my skills probably aren&#39;t what the need to be.&quot; - That should tell you to start with something more basic to get the skills. A good textbook might help, too."}, {"owner": {"reputation": 43, "user_id": 8469002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/773deefb768a403ff118e465288592c5?s=128&d=identicon&r=PG&f=1", "display_name": "dleft", "link": "https://stackoverflow.com/users/8469002/dleft"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1505930179, "post_id": 46328472, "comment_id": 79618530, "body": "@Olaf for sure. I&#39;ve been doing 1D arrays and had no trouble, so I thought I would take a crack at 2D arrays. Probably running before I can walk!"}, {"owner": {"reputation": 888, "user_id": 1096140, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5rFfC.jpg?s=128&g=1", "display_name": "hesham_EE", "link": "https://stackoverflow.com/users/1096140/hesham-ee"}, "edited": false, "score": 0, "creation_date": 1505930222, "post_id": 46328472, "comment_id": 79618545, "body": "@dleft this is because you check the populated elements with the wrong indices. You may need to fix this loop the same way I commented before about the other loop."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1505930394, "post_id": 46328472, "comment_id": 79618624, "body": "@dleft: I don&#39;t see any 2D array in your code. After all, it should be clear the cannot have the same declarator like 1D arrays or pointers. One on the road: A pointer is not an array and an array is not a pointer. That&#39;s vital to remember in C. Whoever tells different should not write production code in C."}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1505929681, "post_id": 46328638, "comment_id": 79618247, "body": "Yup, and Valgrind confirms this diagnosis.  And there&#39;s the corresponding problem in <code>main()</code> too in the printing loop."}, {"owner": {"reputation": 43, "user_id": 8469002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/773deefb768a403ff118e465288592c5?s=128&d=identicon&r=PG&f=1", "display_name": "dleft", "link": "https://stackoverflow.com/users/8469002/dleft"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1505929914, "post_id": 46328638, "comment_id": 79618367, "body": "thanks for the response! I&#39;ll take @JonathanLeffler&#39;s advice now and try to learn valgrind. Thanks!"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 43, "user_id": 8469002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/773deefb768a403ff118e465288592c5?s=128&d=identicon&r=PG&f=1", "display_name": "dleft", "link": "https://stackoverflow.com/users/8469002/dleft"}, "edited": false, "score": 0, "creation_date": 1505929988, "post_id": 46328638, "comment_id": 79618417, "body": "@dleft: the main thing to remember with Valgrind is to compile <i>and</i> link with the <code>-g</code> option, so you get told the line numbers where the problems are occurring."}, {"owner": {"reputation": 43, "user_id": 8469002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/773deefb768a403ff118e465288592c5?s=128&d=identicon&r=PG&f=1", "display_name": "dleft", "link": "https://stackoverflow.com/users/8469002/dleft"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1505930248, "post_id": 46328638, "comment_id": 79618555, "body": "@JonathanLeffler thanks for the advice! Looking through the docs for Valgrind now. When I&#39;ve worked how I can fix the code I will post the solution at the bottom of my question."}], "tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": false, "score": 2, "last_activity_date": 1505929499, "creation_date": 1505929499, "answer_id": 46328638, "question_id": 46328472, "link": "https://stackoverflow.com/questions/46328472/free-array-returned-from-function/46328638#46328638", "title": "Free array returned from function", "body": "<p>With this</p>\n\n<pre><code>char *r = malloc(w * h * sizeof(char));\n</code></pre>\n\n<p>You allocate <code>w * h</code> (7 * 5 = 35 bytes) of memory. But</p>\n\n<pre><code>        *(r + (i * w) + j) = 'X';\n</code></pre>\n\n<p>can access well beyond the 35 bytes you have allocated (you'll see if you test the possible values for <code>i * w + j</code> in the loop), resulting in undefined behaviour.</p>\n\n<p>This possibly overwrites the malloc's internal data structures and thus you happen to get core dump when you free().</p>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 8469002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/773deefb768a403ff118e465288592c5?s=128&d=identicon&r=PG&f=1", "display_name": "dleft", "link": "https://stackoverflow.com/users/8469002/dleft"}, "edited": false, "score": 0, "creation_date": 1505986238, "post_id": 46334669, "comment_id": 79640186, "body": "Thanks for the tip! I&#39;ve got it up and running now, but I really should do a little more work on traversing 2D arrays before continuing with this!"}], "tags": [], "owner": {"reputation": 617, "user_id": 5435919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/309be11aae9fe4f6260eb76bac96f916?s=128&d=identicon&r=PG&f=1", "display_name": "hassan arafat", "link": "https://stackoverflow.com/users/5435919/hassan-arafat"}, "is_accepted": true, "score": 1, "last_activity_date": 1505962267, "creation_date": 1505962267, "answer_id": 46334669, "question_id": 46328472, "link": "https://stackoverflow.com/questions/46328472/free-array-returned-from-function/46334669#46334669", "title": "Free array returned from function", "body": "<p>You made a mistake on these lines</p>\n\n<blockquote>\n  <p><code>*(r + (i * w) + j) = 'X';</code></p>\n</blockquote>\n\n<p>and</p>\n\n<blockquote>\n  <p><code>printf(\"[%c] \", *(p + (i * width) + j));</code></p>\n</blockquote>\n\n<p>To keep inside the boundaries of your \"2D\" array -it's one dimensional but you are working around it like a compiler would-it should be <code>i * length</code> in there:</p>\n\n<pre><code>*(r + (i * h) + j) = 'X';`\n</code></pre>\n\n<p>and  </p>\n\n<pre><code>printf(\"[%c] \", *(p + (i * height) + j)); `\n</code></pre>\n\n<p>If you use this, you should be able to stay within the boundaries without making a mess.</p>\n"}], "owner": {"reputation": 43, "user_id": 8469002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/773deefb768a403ff118e465288592c5?s=128&d=identicon&r=PG&f=1", "display_name": "dleft", "link": "https://stackoverflow.com/users/8469002/dleft"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 0, "accepted_answer_id": 46334669, "answer_count": 2, "score": -1, "last_activity_date": 1505962267, "creation_date": 1505928966, "question_id": 46328472, "link": "https://stackoverflow.com/questions/46328472/free-array-returned-from-function", "title": "Free array returned from function", "body": "<p>apologies if this has appeared elsewhere, I've not been able to find a clear answer.\nI've been using Ed S's answer, Option 1 (linked below) to allocate memory, populate the array, then return it back to the caller.\nHe recommends freeing the memory after you've finished with it, however when I added the free() line, I get a core dump.\nI've had a poke around with GDB, but my skills probably aren't what the need to be.</p>\n\n<p>Thanks in advance for any help you can give.</p>\n\n<p>Link to answer: <a href=\"https://stackoverflow.com/questions/11656532/returning-an-array-using-c\">Returning an array using C</a></p>\n\n<p>Code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nchar * createArray();\n\nint main(int argc, char *argv[]){\n    printf(\"Creating Array...\\n\");\n    // pointer to an int\n    char *p;\n    // size of the array\n    int i,j;\n    // width of array\n    int width = 7;\n    // height of array\n    int height = 5;\n    // get an array from the function\n    p = createArray(width, height);\n    // check if p was created properly\n    if (p){\n        // print out the array\n        for (i = 0; i &lt; width; ++i){\n            for (j = 0; j &lt; height; ++j){\n                printf(\"[%c] \", *(p + (i * width) + j)); \n            }\n        printf(\"\\n\");\n        }\n\n        // here's where it hits the fan\n        free(p);\n    }\n    return 0;\n}\n\nchar * createArray(int w, int h){\n    // allocate some memory for the array\n    char *r = malloc(w * h * sizeof(char));\n    // check if the memory allocation was successful\n    if(!r){\n        return NULL;\n    }\n    int i, j;\n    int count = 0;\n    for (i = 0; i &lt; w; ++i){\n        for (j = 0; j &lt; h; ++j){\n            *(r + (i * w) + j) = 'X';\n            ++count;\n        }\n    }\n    return r;\n}\n</code></pre>\n"}, {"tags": ["c", "cplex"], "comments": [{"owner": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "edited": false, "score": 0, "creation_date": 1505928253, "post_id": 46328043, "comment_id": 79617400, "body": "I don&#39;t know if it can be done as a C callable library but are you just trying to generate the models?"}, {"owner": {"reputation": 128, "user_id": 3560035, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Rvtzn.jpg?s=128&g=1", "display_name": "acco93", "link": "https://stackoverflow.com/users/3560035/acco93"}, "reply_to_user": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "edited": false, "score": 0, "creation_date": 1505928574, "post_id": 46328043, "comment_id": 79617611, "body": "I&#39;m filling up a model a little at a time due to memory limitations. Most of the rows could be aggregated since they are linear combination of other rows."}, {"owner": {"reputation": 4187, "user_id": 1718477, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iisrz.jpg?s=128&g=1", "display_name": "rkersh", "link": "https://stackoverflow.com/users/1718477/rkersh"}, "edited": false, "score": 0, "creation_date": 1505952889, "post_id": 46328043, "comment_id": 79627758, "body": "Is your problem really so big that you need to worry about this incremental aggregating? What makes you think you need to do this?"}], "answers": [{"tags": [], "owner": {"reputation": 4187, "user_id": 1718477, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iisrz.jpg?s=128&g=1", "display_name": "rkersh", "link": "https://stackoverflow.com/users/1718477/rkersh"}, "is_accepted": true, "score": 1, "last_activity_date": 1505952825, "creation_date": 1505952825, "answer_id": 46333495, "question_id": 46328043, "link": "https://stackoverflow.com/questions/46328043/cplex-presolver-without-invoking-the-cplex-mip-solver/46333495#46333495", "title": "cplex presolver without invoking the cplex mip solver", "body": "<p>Yes, it's possible to call presolve independently. The function you're looking for is <a href=\"https://www.ibm.com/support/knowledgecenter/SSSA5P_12.7.1/ilog.odms.cplex.help/refcallablelibrary/cpxapi/presolve.html\" rel=\"nofollow noreferrer\">CPXpresolve</a>. The example given in the documentation is:</p>\n\n<blockquote>\n  <p>status = CPXpresolve (env, lp, CPX_ALG_DUAL);</p>\n</blockquote>\n\n<p>You may also be interested in <a href=\"https://www.ibm.com/support/knowledgecenter/SSSA5P_12.7.1/ilog.odms.cplex.help/refcallablelibrary/cpxapi/preslvwrite.html\" rel=\"nofollow noreferrer\">CPXpreslvwrite</a>. Here's the example for that (also from the documentation):</p>\n\n<blockquote>\n  <p>status = CPXpreslvwrite (env, lp, \"myfile.pre\", &amp;objoff);</p>\n</blockquote>\n\n<p>If you write out the presolved problem, as above, you can read it back in with CPXreadcopyprob. This will allow you to work with the presolved problem directly.</p>\n"}], "owner": {"reputation": 128, "user_id": 3560035, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Rvtzn.jpg?s=128&g=1", "display_name": "acco93", "link": "https://stackoverflow.com/users/3560035/acco93"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 46333495, "answer_count": 1, "score": 2, "last_activity_date": 1505952825, "creation_date": 1505927481, "question_id": 46328043, "link": "https://stackoverflow.com/questions/46328043/cplex-presolver-without-invoking-the-cplex-mip-solver", "title": "cplex presolver without invoking the cplex mip solver", "body": "<p>Is it possible to run the cplex presolver to aggregate a problem without invoking the the mip solver? If it is, could you provide an example using the c callable library?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 4, "creation_date": 1505927142, "post_id": 46327920, "comment_id": 79616724, "body": "Your compiler didn&#39;t warn about the zero-length array?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1505927143, "post_id": 46327920, "comment_id": 79616725, "body": "Segmentation fault is your code&#39;s way of saying <b>open the debugger</b>."}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 1, "creation_date": 1505927327, "post_id": 46327920, "comment_id": 79616833, "body": "Move <code>int a[n], i;</code> and <code>int multi_array[n][3];</code> lines past the line with the first <code>fscanf</code>, and try again. Do you see why this should work?"}, {"owner": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "edited": false, "score": 0, "creation_date": 1505927332, "post_id": 46327920, "comment_id": 79616839, "body": "it&#39;s because when you are declaring the arrays using <code>n</code> the value of <code>n</code> is <code>0</code> so your array length is <code>0</code> but you&#39;re trying to inject <code>3</code> elements and there&#39;s no space for them thus <i>segmentation fault</i>"}, {"owner": {"reputation": 2988, "user_id": 452414, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rDMfs.png?s=128&g=1", "display_name": "babon", "link": "https://stackoverflow.com/users/452414/babon"}, "edited": false, "score": 0, "creation_date": 1505927431, "post_id": 46327920, "comment_id": 79616906, "body": "BTW, it seems to me that you will now know how many numbers to work with. It may be <code>3</code> or <code>30</code>. Consider using dynamic allocation after reading the first line."}, {"owner": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "reply_to_user": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 0, "creation_date": 1505927490, "post_id": 46327920, "comment_id": 79616947, "body": "@dasblinkenlight depends if he has a <code>C99</code> compiler (hopefully yes)"}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "reply_to_user": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "edited": false, "score": 1, "creation_date": 1505927762, "post_id": 46327920, "comment_id": 79617107, "body": "@AhmedMasud Oh, I also hope that in 2017 most programmers did switch over to C99."}, {"owner": {"reputation": 51, "user_id": 8366727, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f9b9cd283e244c5209d1a0dbc5d9a2b0?s=128&d=identicon&r=PG&f=1", "display_name": "Raveel", "link": "https://stackoverflow.com/users/8366727/raveel"}, "edited": false, "score": 0, "creation_date": 1505927791, "post_id": 46327920, "comment_id": 79617135, "body": "Thanks EOF, dasblinkenlight, Ahmed Masud."}, {"owner": {"reputation": 51, "user_id": 8366727, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f9b9cd283e244c5209d1a0dbc5d9a2b0?s=128&d=identicon&r=PG&f=1", "display_name": "Raveel", "link": "https://stackoverflow.com/users/8366727/raveel"}, "edited": false, "score": 0, "creation_date": 1505928013, "post_id": 46327920, "comment_id": 79617253, "body": "Just one more question, when i print n it gives me two values 3 and 0. i just need 3 why does it give 0 aswell?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1505928815, "post_id": 46327920, "comment_id": 79617767, "body": "for ease of readability and understanding by us humans, 1) please consistently indent the code.  Indent after every opening brace &#39;{&#39;.  Unindent before every closing brace &#39;}&#39;,  Suggest 4 spaces for each indent level.  2) follow the axiom: <i>only one statement per line and (at most) one variable declaration per statement.</i>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1505929077, "post_id": 46327920, "comment_id": 79617919, "body": "when call any of the <code>scanf()</code> family of functions (for instance <code>fscanf()</code>), always check the returned value to assure the operation was successful."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1505929235, "post_id": 46327920, "comment_id": 79618012, "body": "arrays are indexed starting with 0 through (number of elements in array -1)  so this statement: <code>fscanf( point , &quot;%d,&quot; , &amp;multi_array[n][3]);</code> is indexing past the end of the array.  The result is undefined behavior and can lead to a seg fault event."}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1505942270, "post_id": 46329137, "comment_id": 79624592, "body": "They aren&#39;t going to work in the code shown because <code>n</code> is <code>0</code> at the time they&#39;re declared.  If the declarations were placed after <code>n</code> is read and validated (oops\u2026it isn&#39;t validated; oh well, after it is read and the newly added validation code blesses it).  C allows variable length arrays (VLAs) in C99 and usually in C11; it just requires the length to be non-zero (and non-negative).  GCC may be less fussy about the zero length arrays; add <code>-pedantic</code> to the compilation options to get it to complain about them and other abuses of the standard."}], "tags": [], "owner": {"reputation": 1037, "user_id": 6342463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/STRPB.jpg?s=128&g=1", "display_name": "Jabberwock", "link": "https://stackoverflow.com/users/6342463/jabberwock"}, "is_accepted": false, "score": 0, "last_activity_date": 1505931450, "creation_date": 1505931450, "answer_id": 46329137, "question_id": 46327920, "link": "https://stackoverflow.com/questions/46327920/cant-get-multi-array-working-in-c/46329137#46329137", "title": "Cant get Multi array working in c", "body": "<p>Since you don't know ahead of time how many rows your array is going to need, you cannot declare it on the stack (ie., <code>int a[n]</code> and <code>int multi_array[n][3]</code> are not going to work).  C does not resize the arrays for you when you change the value of n; you have declared them as size 0 and they remain that way, which is why you get SEGVs when you try to dereference them.</p>\n\n<p>If you switch to calloc() and declare as <code>int *multi_array[3]</code>, things should work better for you.</p>\n\n<p>You also have a bug in your printf() and fscanf() in that you are only ever dereferencing the last element in the array, not all three of them.  You have a further bug in that you are actually dereferencing the element one beyond the end, as an array of 3 elements has elements [0], [1], and [2].</p>\n"}, {"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1505932382, "creation_date": 1505932382, "answer_id": 46329396, "question_id": 46327920, "link": "https://stackoverflow.com/questions/46327920/cant-get-multi-array-working-in-c/46329396#46329396", "title": "Cant get Multi array working in c", "body": "<p>this line:</p>\n\n<pre><code>fscanf( point , \"%d,\" , &amp;multi_array[n][3]);\n</code></pre>\n\n<p>should be:</p>\n\n<pre><code>if( 3 != fscanf( point, :\"%d,%d,%d\", \n                 &amp;multi_array[i][0],\n                 &amp;multi_array[i][1],\n                 &amp;multi_array[i][2] ) )\n{ // then fscanf failed\n    fprintf( stderr, \"failed to read all 3 integers on data line: %d\\n\". i);\n    exit( EXIT_FAILURE );\n}\n\n// implied else, fscanf successful\n</code></pre>\n\n<p>also, when calling <code>fopen()</code>, always check (!=NULL) the returned value to assure the operation was successful.  Similar to:</p>\n\n<pre><code>FILE *point = fopen(\"example.txt\", \"r\");\nif( !point )\n{\n    perror( \"fopen to read 'example.txt' failed\" );\n    exit( EXIT_FAILURE );\n}\n\n// implied else, fopen successful\n</code></pre>\n\n<p>When the size of an array is determined by a value read in rather than a hard coded value, place all statements that use that size to declare an array AFTER the point where the size is read in.  That way the compiler can produce code to allocate the desired size.  Note: such arrays are called <code>VLAs</code>  (Variable Length Arrays)</p>\n\n<p>To avoid compiler warnings about unused variables (and to save space on the stack) always remove unused arrays, I.E. remove this line:</p>\n\n<pre><code>int a[n],\n</code></pre>\n\n<p>It is best practice to keep data definitions local to where those data definitions are used.</p>\n\n<p>Code should cleanup after itself.  It is poor programming practice to expect the OS to cleanup after sloppy code.</p>\n\n<p>'magic' numbers make the code much more difficult to understand, debug, etc.  The posted code contains the magic number '3'.  It is best if 'magic' numbers are given meaningful names and those meaningful names used throughout the code.  This is normally done by <code>#define</code> statements or a <code>enum</code> statement.</p>\n\n<p>When a system function indicates an error occurred, then the global variable 'errno' is set with an appropriate value.  'errno' should be used to display the related text.  there are two ways to do this:</p>\n\n<pre><code>perror( \"your error message\" );\n</code></pre>\n\n<p>and</p>\n\n<pre><code>#include &lt;errno.h&gt;\n...\nfprintf( stderr, \"the call to xxx returned the following error: %s\\n\", strerror( errno ) );\n</code></pre>\n\n<p>The following code demonstrates all the above: </p>\n\n<pre><code>#include &lt;stdio.h&gt;  // fscanf(), perror(), printf(), fprintf(), stderr, fclose(), fopen()\n#include &lt;stdlib.h&gt; // exit(), EXIT_FAILURE\n\n#define NUM_DATA_PER_LINE 3\n\nint main( void )\n{\n    int n;\n\n    FILE *point = fopen(\"example.txt\", \"r\");\n    if( !point )\n    {\n        perror( \"fopen to read 'example.txt' failed\" );\n        exit( EXIT_FAILURE );\n    }\n\n    // implied else, fopen successful\n\n    if( 1 != fscanf(point,\"%d\" , &amp;n) )\n    {\n        fprintf( stderr, \"fscanf failed to read the count of data lines\" );\n        fclose( point );\n        exit( EXIT_FAILURE );\n    }\n\n    // implied else, fscanf successful\n\n    printf(\"This is n: %d \" , n);\n\n    int multi_array[n][ NUM_DATA_PER_LINE ];\n\n    for(int i = 0; i &lt; n; i++)\n    {\n        if( NUM_DATA_PER_LINE != fscanf( point , \"%d,%d,%d\",\n            &amp;multi_array[i][0],\n            &amp;multi_array[i][1],\n            &amp;multi_array[i][2]) )\n        {\n            fprintf( stderr, \"fscanf failed to read 3 items from data line: %d\\n\", i );\n            fclose( point );\n            exit( EXIT_FAILURE );\n        }\n\n        // implied else, fscanf successful\n    }\n\n    fclose( point );\n\n    for( int i = 0; i &lt; n; i++ )\n    {\n        for( int j=0; j &lt; NUM_DATA_PER_LINE; j++ )\n        {\n            printf( \"%d\\n\" , multi_array[i][j] );\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 8366727, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f9b9cd283e244c5209d1a0dbc5d9a2b0?s=128&d=identicon&r=PG&f=1", "display_name": "Raveel", "link": "https://stackoverflow.com/users/8366727/raveel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1505932382, "creation_date": 1505927063, "question_id": 46327920, "link": "https://stackoverflow.com/questions/46327920/cant-get-multi-array-working-in-c", "title": "Cant get Multi array working in c", "body": "<pre><code>#include &lt;stdio.h&gt;\nint main()\n{\nint n=0;\nint a[n], i;\nint multi_array[n][3];\nFILE *point = fopen(\"example.txt\", \"r\");\n\nfscanf(point,\"%d\" , &amp;n);\nprintf(\"This is n: %d \" , n);\n\n\nfor(i = 0; i &lt; n; i++)\n{\n    fscanf( point , \"%d,\" , &amp;multi_array[n][3]);\n}\n\nfor(i = 0; i &lt; n; i++)\n{\n    printf(\"%d\\n\" , multi_array[n][3]);\n}\n}\n</code></pre>\n\n<p>The \"example.txt\" file has as code as following:</p>\n\n<p>3</p>\n\n<p>1,10,0</p>\n\n<p>2,1,2</p>\n\n<p>3,2,6</p>\n\n<p>The first digit determines the number of array (n) and the bottom three rows of numbers are to be stored into those array, for example: 1,10,0 should be stored in first array and 2,1,2 stored in the second array and so on.</p>\n\n<p>my above code gives me a segmentation fault error.</p>\n"}, {"tags": ["python", "c", "dll", "cygwin"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1505927011, "post_id": 46327774, "comment_id": 79616658, "body": "personally I&#39;d drop cygwin for MinGW if you can do that..."}, {"owner": {"reputation": 1774, "user_id": 3861449, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fc5cffc01b789b8262766e32eddbcfd7?s=128&d=identicon&r=PG&f=1", "display_name": "zephyr", "link": "https://stackoverflow.com/users/3861449/zephyr"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1505927076, "post_id": 46327774, "comment_id": 79616686, "body": "@Jean-Fran&#231;oisFabre Why do you suggest that?"}, {"owner": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "edited": false, "score": 0, "creation_date": 1505927208, "post_id": 46327774, "comment_id": 79616763, "body": "try replacing your <code>printf</code> with <code>fprintf (stderr, &quot;\\n%s\\n\\n&quot;, buf);</code> and share what happens."}, {"owner": {"reputation": 1774, "user_id": 3861449, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fc5cffc01b789b8262766e32eddbcfd7?s=128&d=identicon&r=PG&f=1", "display_name": "zephyr", "link": "https://stackoverflow.com/users/3861449/zephyr"}, "reply_to_user": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "edited": false, "score": 0, "creation_date": 1505927521, "post_id": 46327774, "comment_id": 79616969, "body": "@AhmedMasud No dice, it still hangs. I suspect something is wrong with my environment or the way I compile. As I said, replacing the <code>printf</code> with something like <code>int x = 0;</code> causes the function to run without hanging, but then I get a random number printed out and I&#39;ve no idea where that number is coming from or why it&#39;s being printed."}, {"owner": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "edited": false, "score": 0, "creation_date": 1505927659, "post_id": 46327774, "comment_id": 79617047, "body": "One more thing, move your <code>unsigned char buf[] = &quot;Hello World&quot;</code> to the <code>main.c</code> file, and declare it <code>static unsigned char buf[]</code> to make it local. Let&#39;s see if that fixes things. I highly doubt that your environment is to blame."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1505927781, "post_id": 46327774, "comment_id": 79617127, "body": "Because cygwin works in strange ways"}, {"owner": {"reputation": 1774, "user_id": 3861449, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fc5cffc01b789b8262766e32eddbcfd7?s=128&d=identicon&r=PG&f=1", "display_name": "zephyr", "link": "https://stackoverflow.com/users/3861449/zephyr"}, "reply_to_user": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "edited": false, "score": 0, "creation_date": 1505927953, "post_id": 46327774, "comment_id": 79617219, "body": "@AhmedMasud Sorry, still doesn&#39;t work... I can&#39;t believe it has anything to do with the c program itself because, as I said, I got it working on a linux system no problem. I suspect, as Jean-Fracois seems to, that it is something to do with cygwin."}, {"owner": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "edited": false, "score": 0, "creation_date": 1505928286, "post_id": 46327774, "comment_id": 79617426, "body": "hmm hey he may be right :P"}, {"owner": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "edited": false, "score": 1, "creation_date": 1505928506, "post_id": 46327774, "comment_id": 79617568, "body": "Aaah found something .... <a href=\"https://cygwin.com/cygwin-ug-net/dll.html\" rel=\"nofollow noreferrer\">cygwin.com/cygwin-ug-net/dll.html</a> apparently cygwin has a weirdness w.r.t. dlls. MinGW DLLs work as standard windows DLLs whereas they need fiddling (read the bottom of the page) to work with cygwin."}, {"owner": {"reputation": 173, "user_id": 5615268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80cad0b7a4e3dae856f113b90ccaf180?s=128&d=identicon&r=PG&f=1", "display_name": "0x11", "link": "https://stackoverflow.com/users/5615268/0x11"}, "edited": false, "score": 0, "creation_date": 1505928634, "post_id": 46327774, "comment_id": 79617651, "body": "Could it be that your C program isn&#39;t returning anything?"}, {"owner": {"reputation": 1774, "user_id": 3861449, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fc5cffc01b789b8262766e32eddbcfd7?s=128&d=identicon&r=PG&f=1", "display_name": "zephyr", "link": "https://stackoverflow.com/users/3861449/zephyr"}, "reply_to_user": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "edited": false, "score": 0, "creation_date": 1505928698, "post_id": 46327774, "comment_id": 79617694, "body": "@AhmedMasud Nice find. That looks promising. I&#39;ll take a look and see if that solves my problem."}, {"owner": {"reputation": 6281, "user_id": 5105383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2YCB5.jpg?s=128&g=1", "display_name": "matzeri", "link": "https://stackoverflow.com/users/5105383/matzeri"}, "edited": false, "score": 1, "creation_date": 1505983203, "post_id": 46327774, "comment_id": 79638224, "body": "The problem is that you are calling a cywgin program from a NOT cygwin python and having the wrong expectation. cygwin programs have different paradigma than normal windows programs."}, {"owner": {"reputation": 1774, "user_id": 3861449, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fc5cffc01b789b8262766e32eddbcfd7?s=128&d=identicon&r=PG&f=1", "display_name": "zephyr", "link": "https://stackoverflow.com/users/3861449/zephyr"}, "reply_to_user": {"reputation": 6281, "user_id": 5105383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2YCB5.jpg?s=128&g=1", "display_name": "matzeri", "link": "https://stackoverflow.com/users/5105383/matzeri"}, "edited": false, "score": 0, "creation_date": 1505999621, "post_id": 46327774, "comment_id": 79649797, "body": "@matzeri That was the problem. Once I ran the python script from the cygwin terminal using the cygwin installed python, it worked. If you want to put this as an answer, I&#39;ll accept it."}], "answers": [{"comments": [{"owner": {"reputation": 1774, "user_id": 3861449, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fc5cffc01b789b8262766e32eddbcfd7?s=128&d=identicon&r=PG&f=1", "display_name": "zephyr", "link": "https://stackoverflow.com/users/3861449/zephyr"}, "edited": false, "score": 0, "creation_date": 1506020218, "post_id": 46351269, "comment_id": 79662832, "body": "For future users, I was indeed using a personal install of Python and not Cygwin&#39;s install of Python. Once I switched, it worked as expected."}], "tags": [], "owner": {"reputation": 6281, "user_id": 5105383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2YCB5.jpg?s=128&g=1", "display_name": "matzeri", "link": "https://stackoverflow.com/users/5105383/matzeri"}, "is_accepted": true, "score": 3, "last_activity_date": 1506020087, "creation_date": 1506020087, "answer_id": 46351269, "question_id": 46327774, "link": "https://stackoverflow.com/questions/46327774/c-program-compiled-with-cygwin-and-called-from-python-hangs/46351269#46351269", "title": "C Program Compiled with Cygwin and Called from Python Hangs", "body": "<p>The problem is that you are calling a cywgin program from a NOT cygwin python and having the wrong expectation. </p>\n\n<p>cygwin programs have different paradigma (Posix-like) than normal windows programs.</p>\n\n<p>It is recommended to test with both cygwin python and compiler, or both windows one.   </p>\n"}], "owner": {"reputation": 1774, "user_id": 3861449, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fc5cffc01b789b8262766e32eddbcfd7?s=128&d=identicon&r=PG&f=1", "display_name": "zephyr", "link": "https://stackoverflow.com/users/3861449/zephyr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 348, "favorite_count": 0, "accepted_answer_id": 46351269, "answer_count": 1, "score": 3, "last_activity_date": 1507714243, "creation_date": 1505926494, "last_edit_date": 1505938683, "question_id": 46327774, "link": "https://stackoverflow.com/questions/46327774/c-program-compiled-with-cygwin-and-called-from-python-hangs", "title": "C Program Compiled with Cygwin and Called from Python Hangs", "body": "<p>I'm trying to call a c program from Python using <code>ctypes</code>. I've got a minimum (non-)working example below.</p>\n\n<h3>C Program</h3>\n\n<p>Here is the C program I'm trying to call into. Just your standard hello world program. I compile this, on windows, using eclipse and the cygwin gcc compiler to produce a <code>.dll</code> file.</p>\n\n<p><strong>main.h</strong></p>\n\n<pre><code>#ifndef INC_MAIN_H_\n#define INC_MAIN_H_\n\nvoid helloWorld();\n\nunsigned char buf[] = \"Hello World!\";\n\n#endif /* INC_MAIN_H_ */\n</code></pre>\n\n<p><strong>main.c</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"main.h\"\n\nvoid helloWorld(){\n    printf(\"\\n%s\\n\\n\", buf);\n}\n</code></pre>\n\n<h3>Python Program</h3>\n\n<p>Then I write a python script to load my <code>.dll</code> and call the <code>helloWorld</code> function. Importantly, I do pull over both the <code>.dll</code> I created and the <code>cygwin1.dll</code>.</p>\n\n<p><strong>helloWorld.py</strong></p>\n\n<pre><code>from ctypes import CDLL\nimport os\n\ndef loadDLL(file):\n    file = file.replace('\\\\','/')\n    if not os.path.exists(file):\n        raise FileNotFoundError(file)\n\n    print('Opening DLL File:', file)\n    dll = CDLL(file)\n\n    return dll\n\nif __name__ == '__main__':\n    dll = loadDLL(FILE_TO_LOAD)\n    dll.helloWorld()\n</code></pre>\n\n<p>When I go to run this program, <code>loadDLL</code> works just fine and loads the DLL. However, calling the <code>helloWorld</code> function from the c program causes it to hang.</p>\n\n<p>Oddly enough, if I replace the <code>printf</code> line with something innocuous (e.g., <code>int x = 0</code>), it executes fine but prints out a seemingly random number.</p>\n\n<p>Can anyone point me to what I'm doing wrong? Or even a way to figure out what's going wrong?</p>\n\n<p>Btw, I was able to get a nearly identical setup to work just fine on a linux system, so I'm guessing it's due to the windows environment that I've setup, but I couldn't begin to guess what it really is.</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>I'm not writing this as an answer because it doesn't solve the letter of the problem, but only the spirit.</p>\n\n<p>At <a href=\"https://stackoverflow.com/questions/46327774/c-program-compiled-with-cygwin-and-called-from-python-hangs#comment79616658_46327774\">Jean-Francois Fabre's suggestion</a> I dropped cygwin for mingw and things now work as expected. Apparently cygwin works in strange ways. <a href=\"https://stackoverflow.com/questions/46327774/c-program-compiled-with-cygwin-and-called-from-python-hangs#comment79617568_46327774\">Ahmed Masud</a> was able to find <a href=\"https://cygwin.com/cygwin-ug-net/dll.html\" rel=\"nofollow noreferrer\">a useful link</a> about how cygwin programs should be compiled if they're to be used for external libraries, but that seemed like much more trouble that just using mingw (not to mention the other problems I'd already encountered trying to use cygwin for this).</p>\n\n<p>FWIW, this program must also be run in on the command line in order to see the output of the c program. Running in python's IDLE did not capture the <code>printf</code> output from the c program.</p>\n"}, {"tags": ["c", "sockets", "raw-sockets"], "comments": [{"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 2, "creation_date": 1505926357, "post_id": 46327622, "comment_id": 79616289, "body": "Check <code>errno </code> perhaps?"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1505927128, "post_id": 46327622, "comment_id": 79616716, "body": "send() is well-documented.  A &#39;-1&#39; return is an error.  It&#39;s clearly explained.  Google &#39;send()&#39; or &#39;man send&#39;.  It&#39;s just there."}], "answers": [{"tags": [], "owner": {"reputation": 1340, "user_id": 8372228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea211204c4d8ee5167b4e34ccb2328f3?s=128&d=identicon&r=PG", "display_name": "v1bri", "link": "https://stackoverflow.com/users/8372228/v1bri"}, "is_accepted": false, "score": 0, "last_activity_date": 1505926511, "creation_date": 1505926511, "answer_id": 46327779, "question_id": 46327622, "link": "https://stackoverflow.com/questions/46327622/sending-raw-internet-packets-using-c/46327779#46327779", "title": "Sending raw internet packets using C", "body": "<p>Check <code>errno</code> to see what error the OS is providing when your <code>send()</code> call fails. Generally speaking, raw socket access requires elevated privileges (which you can grant by running your program with <code>sudo</code>, for example). </p>\n"}, {"tags": [], "owner": {"reputation": 2223, "user_id": 325181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26de4aa17ab84757b1233714af5fec84?s=128&d=identicon&r=PG", "display_name": "Clarus", "link": "https://stackoverflow.com/users/325181/clarus"}, "is_accepted": false, "score": 0, "last_activity_date": 1505926587, "creation_date": 1505926587, "answer_id": 46327808, "question_id": 46327622, "link": "https://stackoverflow.com/questions/46327622/sending-raw-internet-packets-using-c/46327808#46327808", "title": "Sending raw internet packets using C", "body": "<p>You may also need to bind your socket with an interface. Something like this:</p>\n\n<pre><code>if ( bind( raw, (struct sockaddr*) &amp;info.ll, sizeof( struct sockaddr_ll ))  == -1 )\n  perror(\"binding to interface\");\n</code></pre>\n\n<p>To get interfaces, try something like this:</p>\n\n<pre><code>if ( getifaddrs( &amp;ifa ) == -1) {\n  perror(\"Couldn't get interface information\");\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 1, "last_activity_date": 1505958027, "creation_date": 1505958027, "answer_id": 46334086, "question_id": 46327622, "link": "https://stackoverflow.com/questions/46327622/sending-raw-internet-packets-using-c/46334086#46334086", "title": "Sending raw internet packets using C", "body": "<p>Your <code>sendBuffer()</code> has a bug in it.  When you are passing the <code>buffer</code> parameter to <code>send()</code>, you are passing the address of <code>buffer</code> itself on the call stack, not the address that it points to (the <code>buffer[]</code> variable in <code>main()</code>). You need to remove the <code>&amp;</code> operator:</p>\n\n<pre><code>ssize_t sendBuffer(int socket, char buffer[], ssize_t length)\n{\n    //return send(socket, &amp;buffer, length, 0);\n    return send(socket, buffer, length, 0);\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8271299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e85dbecc63d5aff284f458c233a31c8?s=128&d=identicon&r=PG&f=1", "display_name": "ShietStone", "link": "https://stackoverflow.com/users/8271299/shietstone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1505958027, "creation_date": 1505925987, "question_id": 46327622, "link": "https://stackoverflow.com/questions/46327622/sending-raw-internet-packets-using-c", "title": "Sending raw internet packets using C", "body": "<p>I want to send a raw packet using raw sockets in C language. I made a header file which i can use in my projects. It's named \"Inet.h\". The Code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;arpa/inet.h&gt;\n#include &lt;linux/if_ether.h&gt;\n\n\nint createSocket();\nssize_t sendBuffer(int socket, char buffer[], ssize_t length);\n\nssize_t sendBuffer(int socket, char buffer[], ssize_t length)\n{\n    return send(socket, &amp;buffer, length, 0);\n}\n\nint createSocket()\n{\n        int _socket_ = socket(AF_PACKET, SOCK_RAW, htons(ETH_P_ALL));\n        return _socket_;\n}\n</code></pre>\n\n<p>The method createSocket() works very well, but sendBuffer() always make problems. I made a test Code:</p>\n\n<pre><code>#include \"Inet.h\"\n\nint main()\n{\n    int socket = createSocket();\n    printf(\"%i\\n\", socket);\n\n        char buffer[16] = {'A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P'};\n    ssize_t t = sendBuffer(socket, buffer, 16);\n    printf(\"%zd\\n\",t);\n    return 0;\n}\n</code></pre>\n\n<p>The output is following:</p>\n\n<p>3</p>\n\n<p>-1</p>\n\n<p>So the Socket, as i said already, works but i don't know why the sendBuffer function will not work. Please help.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1505924588, "post_id": 46326976, "comment_id": 79615192, "body": "Is <code>call_pool_t</code> in the called context in fact the same type as <code>struct call_pool</code> in the original context?  If the types are not identical then your debugging output says nothing interesting."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 3, "creation_date": 1505924638, "post_id": 46326976, "comment_id": 79615223, "body": "We are in any case unlikely to be able to provide much insight without some code -- a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, mind, not your whole program."}, {"owner": {"reputation": 1, "user_id": 7571722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f54dbe78223a89ee01b7a27f39b848f4?s=128&d=identicon&r=PG&f=1", "display_name": "squarebracket", "link": "https://stackoverflow.com/users/7571722/squarebracket"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1505926230, "post_id": 46326976, "comment_id": 79616213, "body": "Yes, I should have mentioned that <code>call_pool_t</code> is just a typedef of <code>struct call_pool</code>."}, {"owner": {"reputation": 1, "user_id": 7571722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f54dbe78223a89ee01b7a27f39b848f4?s=128&d=identicon&r=PG&f=1", "display_name": "squarebracket", "link": "https://stackoverflow.com/users/7571722/squarebracket"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1505926329, "post_id": 46326976, "comment_id": 79616272, "body": "As for a minimal example, I can&#39;t even fathom how to create such a reproducible problem from scratch. From my understanding of C, this shouldn&#39;t happen. I&#39;ll try to pull out relevant snippets so you can at least get an understanding of the call flow."}, {"owner": {"reputation": 2223, "user_id": 325181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26de4aa17ab84757b1233714af5fec84?s=128&d=identicon&r=PG", "display_name": "Clarus", "link": "https://stackoverflow.com/users/325181/clarus"}, "edited": false, "score": 1, "creation_date": 1505927130, "post_id": 46326976, "comment_id": 79616718, "body": "Why is this unexpected behaviour? What is the scope of your variable? What does valgrind (or some memory checker) say about the situation?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1505927614, "post_id": 46326976, "comment_id": 79617011, "body": "@squarebracket, it is a good first guess that the problem is in your code, not the gluster code.  Thus, presenting sufficient of your own code to exhibit the context of the call has a decent chance of being of help.  That is the bare minimum you can provide if you hope to get any useful analysis."}], "owner": {"reputation": 1, "user_id": 7571722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f54dbe78223a89ee01b7a27f39b848f4?s=128&d=identicon&r=PG&f=1", "display_name": "squarebracket", "link": "https://stackoverflow.com/users/7571722/squarebracket"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1505943247, "creation_date": 1505923835, "last_edit_date": 1505943247, "question_id": 46326976, "link": "https://stackoverflow.com/questions/46326976/memory-location-has-different-value-inside-and-outside-of-functions", "title": "Memory location has different value inside and outside of functions", "body": "<p>I'm trying to write a glusterfs plugin for collectd in C that uses the glusterfs libraries to make the actual RPC calls. I've managed to get a standalone C program working that's basically just cobbled together parts of the gluster CLI.</p>\n\n<p>However, when I port that code to a collectd library, I'm getting some weird behavior when making function calls that use symbols in the gluster libraries. Outside the function calls, memory location X refers to a struct with non-null members. Inside the function calls, memory location X refers to a struct with null members. This is causing the function to fail and return NULL instead of a pointer to a struct, which of course causes the RPC to fail.</p>\n\n<p>Here is some output from GDB from stepping through the program. You can see that the members of the struct living in <code>0x7fffec0231b0</code> change when entering the function. Note that I've removed some of the members from the print just to make it a bit more legible:</p>\n\n<pre><code>(gdb) next\n718                 frame = create_frame (THIS, state.ctx-&gt;pool);\n(gdb) print state.ctx.pool\n$22 = (struct call_pool *) 0x7fffdc022740\n(gdb) print *state.ctx.pool\n$23 = {..., frame_mem_pool = 0x7fffdc0227e0, stack_mem_pool = 0x7fffdc0586d0}\n(gdb) print *{struct call_pool *}0x7fffdc022740\n$24 = {..., frame_mem_pool = 0x7fffdc0227e0, stack_mem_pool = 0x7fffdc0586d0}\n(gdb) step\ncreate_frame (xl=0x7ffff4fc96e0 &lt;global_xlator&gt;, pool=pool@entry=0x7fffdc022740) at stack.c:17\n17      {\n(gdb) print pool\n$26 = (call_pool_t *) 0x7fffdc022740\n(gdb) print *pool\n$27 = {..., frame_mem_pool = 0x0, stack_mem_pool = 0x0}\n(gdb) print *{struct call_pool*}0x7fffdc022740\n$28 = {..., frame_mem_pool = 0x0, stack_mem_pool = 0x0}\n(gdb) finish\nRun till exit from #0  create_frame (xl=0x7ffff4fc96e0 &lt;global_xlator&gt;, pool=pool@entry=0x7fffdc022740) at stack.c:17\n0x00007ffff5400492 in profiler_callback (d=&lt;optimized out&gt;) at src/glusterfs.c:718\n718                 frame = create_frame (THIS, state.ctx-&gt;pool);\nValue returned is $29 = (call_frame_t *) 0x0\n(gdb) print state.ctx.pool\n$30 = (struct call_pool *) 0x7fffdc022740\n(gdb) print *{struct call_pool*}0x7fffdc022740\n$31 = {..., frame_mem_pool = 0x7fffdc0227e0, stack_mem_pool = 0x7fffdc0586d0}\n</code></pre>\n\n<p>As you can see, the memory location inside the function seems to refer to a struct that has different values, as its members are null inside the function, but not outside of it.</p>\n\n<p>Perhaps worth noting, <code>create_frame</code> is from a gluster library, which is separate from my collectd library. The behavior I described is also happening with another function from a gluster library.</p>\n\n<p>EDIT:</p>\n\n<p>Full source can be seen <a href=\"https://github.com/squarebracket/collectd/blob/master/src/glusterfs.c\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>Here's a bit of a reduced snippet:</p>\n\n<pre><code>// globals\nstruct cli_state state = {0, };\nstruct rpc_clnt *global_rpc;\nrpc_clnt_prog_t *cli_rpc_prog;\n\nint\nglusterfs_ctx_defaults_init ()\n{\n        call_pool_t   *pool = NULL;\n        glusterfs_ctx_t *ctx = state.ctx;\n\n        pool = GF_CALLOC (1, sizeof (call_pool_t),\n                          mt_call_pool_t);\n\n        /* stack_mem_pool size 256 * 128 */\n        pool-&gt;stack_mem_pool = mem_pool_new (call_stack_t, 16);\n        if (!pool-&gt;stack_mem_pool)\n                return 1;\n\n        ctx-&gt;pool = pool;\n\n        return 0;\n\n}\n\nvoid * profiler_callback (void* d) {\n    int ret = 0;\n        call_frame_t            *frame = NULL;\n        // function from gluster library returns\n        // pthread_getspecific (this_xlator_key);\n        // so essentially a thread-specific variable\n        xlator_t                *xlator = (*__glusterfs_this_location());\n\n        // here, state.ctx-&gt;pool-&gt;stack_mem_pool is not null\n        frame = create_frame (xlator, xlator-&gt;ctx-&gt;pool);\n        // it is also not null here. however, frame is null\n        // since state.ctx-&gt;pool-&gt;stack_mem_pool *is* null\n        // inside create_frame\n        if (!frame)\n                goto out;\n\nout:\n        INFO(\"Exiting with: %d\", ret);\n        kill_self();\n\n        return NULL;\n\n}\n\nint\nread_stats (void)\n{\n    int ret = -1;\n    glusterfs_ctx_t   *ctx = NULL;\n    xlator_t * xlator = NULL;\n\n        ctx = glusterfs_ctx_new ();\n        if (!ctx)\n                return ENOMEM;\n\n        ret = glusterfs_globals_init (ctx);\n        if (ret)\n                return ret;\n\n        // function from gluster library returns\n        // pthread_getspecific (this_xlator_key);\n        // so essentially a thread-specific variable\n        xlator = (*__glusterfs_this_location());\n\n        // Sets ctx.pool.stack_mem_pool\n        ret = glusterfs_ctx_defaults_init (xlator);\n        if (ret) {\n                return ret;\n        }\n\n        state.ctx = ctx;\n\n        pthread_mutex_init (&amp;cond_mutex, NULL);\n        pthread_cond_init (&amp;cond, NULL);\n        pthread_mutex_init (&amp;conn_mutex, NULL);\n        pthread_cond_init (&amp;conn, NULL);\n\n        ret = pthread_create ((&amp;(state.input)), NULL, profiler_callback, &amp;state);\n        if (ret) {\n            ERROR(\"problem! %d\", ret);\n        }\n\n        ret = event_dispatch (state.ctx-&gt;event_pool);\nout:\n\n        return ret;\n}\n\nvoid module_register(void) {\n  plugin_register_read(\"glusterfs\", read_stats);\n}\n</code></pre>\n\n<p><code>module_register</code> registers the <code>read_stats</code> function with collectd, which it then calls every interval period. </p>\n"}, {"tags": ["c++", "c", "c++11", "casting", "static-cast"], "comments": [{"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1505924014, "post_id": 46326947, "comment_id": 79614857, "body": "1) Just because something compiles doesn&#39;t mean that it&#39;ll work, or will produce the correct results. 2) Doing things the right way is usually more work than taking illegal shortcuts 3) The drawback is that it&#39;s undefined behavior."}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 1, "creation_date": 1505924792, "post_id": 46326947, "comment_id": 79615332, "body": "A C-style cast tells the compiler &quot;Just shut up and do it!&quot;. That &quot;takes care of&quot; the error or warning message, but then it is up to you whether it actually works. The compiler will not tell you, as you just asked it not to."}, {"owner": {"reputation": 9958, "user_id": 225186, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/dbc60362bf2df08202ff198e00085a5c?s=128&d=identicon&r=PG", "display_name": "alfC", "link": "https://stackoverflow.com/users/225186/alfc"}, "edited": false, "score": 1, "creation_date": 1505926443, "post_id": 46326947, "comment_id": 79616341, "body": "Runtime polymorphism and the STL do not mix well. This is an alternative, <a href=\"http://www.boost.org/doc/libs/1_65_1/libs/ptr_container/doc/ptr_container.html\" rel=\"nofollow noreferrer\">boost.org/doc/libs/1_65_1/libs/ptr_container/doc/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": true, "score": 3, "last_activity_date": 1505924218, "creation_date": 1505924218, "answer_id": 46327070, "question_id": 46326947, "link": "https://stackoverflow.com/questions/46326947/c-style-cast-of-stdvector/46327070#46327070", "title": "C-style cast of std::vector", "body": "<blockquote>\n  <p>Why does the first snippet even compile but using a static_cast causes a compilation error?</p>\n</blockquote>\n\n<p>Because a C-style cast is a sledgehammer that will throw all caution to the wind. Its motto is \"you want it? you got it\", regardless of what \"it\" is. A static cast will only do a cast that is correct in terms of static type checking.</p>\n\n<blockquote>\n  <p>What is the computational cost of the two methods? I expect the second one to incur into extra costs due to creating the temporary vector object new_vec, but I am not sure.</p>\n</blockquote>\n\n<p>Your expectation is correct. But the cost of code with well defined semantics can be in added work for the program.</p>\n\n<blockquote>\n  <p>What are the drawbacks of using the C-style cast in these cases?</p>\n</blockquote>\n\n<p>That it will always compile, and you won't find out there's a problem until you try to run it, on some platform in the future. Because it <em>may</em> work today.</p>\n"}, {"tags": [], "owner": {"reputation": 1435, "user_id": 180656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24c91c0ae420dcaf04e5e9061be6a93c?s=128&d=identicon&r=PG", "display_name": "Josef Grahn", "link": "https://stackoverflow.com/users/180656/josef-grahn"}, "is_accepted": false, "score": 1, "last_activity_date": 1505925102, "last_edit_date": 1505925102, "creation_date": 1505924753, "answer_id": 46327229, "question_id": 46326947, "link": "https://stackoverflow.com/questions/46326947/c-style-cast-of-stdvector/46327229#46327229", "title": "C-style cast of std::vector", "body": "<ol>\n<li>There are many cases in C++ where the specification allows the compiler to not give an error, but where the behaviour of the resulting program is undefined. C-style casts are largely a legacy compatibility leftover from the C heritage, and invokes undefined (often broken) behaviour in a lot of cases.</li>\n<li>Theoretically the compiler can optimise it away, but most likely yes, it will incur some computational cost. It's likely smaller than e.g. the overhead of calling all of those objects, which you would presumably do after having cast them.</li>\n<li>C-style cast have the drawback that it doesn't prevent you from invoking undefined behaviour, and doesn't make it clear what your intent is (e.g. with <code>auto x = (Foo) someConstType</code>, did you mean to remove a <code>const</code> qualifier or was that by accident?).</li>\n</ol>\n\n<p>In your specific case, the C-style version will yield an incorrect program if you have multiple inheritance, and up-casting a pointer means its address needs to change to point to the appropriate base class object.</p>\n"}, {"tags": [], "owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "is_accepted": false, "score": 2, "last_activity_date": 1505933194, "last_edit_date": 1505933194, "creation_date": 1505924898, "answer_id": 46327287, "question_id": 46326947, "link": "https://stackoverflow.com/questions/46326947/c-style-cast-of-stdvector/46327287#46327287", "title": "C-style cast of std::vector", "body": "<p>That code is nonsense. There is no requirement that the <strong>value</strong> of a <code>Derived*</code> is the same as the <strong>value</strong> of a <code>Base*</code>, so telling the compiler to pretend that a <code>std::vector&lt;B*&gt;</code> is a <code>std::vector&lt;A*&gt;</code> is not required to to anything sensible. In fact, that pointer type pun is impossible if you have multiple bases of the same type. Try it:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nstruct Base {\n    int i;\n};\n\nstruct I1 : Base {\n    int j;\n};\n\nstruct I2 : Base {\n    int k;\n};\n\nstruct Derived : I1, I2 {\n    int l;\n};\n\nint main() {\n    Derived d;\n    Base* b1 = &amp;(I1&amp;)d;\n    Base* b2 = &amp;(I2&amp;)d;\n    std::cout &lt;&lt; (void*)&amp;d &lt;&lt; ' ' &lt;&lt; (void*)b1 &lt;&lt; ' ' &lt;&lt; (void*)b2 &lt;&lt; '\\n';\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": false, "score": 1, "last_activity_date": 1505935475, "creation_date": 1505935475, "answer_id": 46330272, "question_id": 46326947, "link": "https://stackoverflow.com/questions/46326947/c-style-cast-of-stdvector/46330272#46330272", "title": "C-style cast of std::vector", "body": "<p>A <code>std::vector&lt;Derived*&gt;</code> is a type unrelated to a <code>std::vector&lt;Base*&gt;</code>.  There is no legal way to interpret the memory of one as the other, short of something insanely stupid like placement new.</p>\n\n<p>Your attempts generate errors if you are lucky.  If you are not, they generate undefined behavior, which means it may seem to work today but tomorrow they can silently format your hard drive due to anything from a compiler upgrade, to code far away being changed, or the phase of the moon.</p>\n\n<p>Now, it is the case that many of the operations on a <code>vector&lt;Base*&gt;</code> work on a <code>vector&lt;Derived*&gt;</code>.  We can handle this with <em>type erasure</em>.</p>\n\n<p>Here is a low-efficiency type erasure class:</p>\n\n<pre><code>template&lt;class R, class...Args&gt;\nusing vcfunc = std::function&lt;R(void const*, Args...)&gt;;\n\ntemplate&lt;class T, class R, class...Args, class F&gt;\nvcfunc&lt;R,Args...&gt; vcimpl( F&amp;&amp; f ) {\n  return [f=std::forward&lt;F&gt;(f)](void const* pt, Args&amp;&amp;...args)-&gt;R{\n    return f( *static_cast&lt;T const*&gt;(pt), std::forward&lt;Args&gt;(args)... );\n  };\n}\ntemplate&lt;class T&gt;\nstruct random_access_container_view {\n  using self=random_access_container_view;\n  struct vtable_t {\n    vcfunc&lt;std::size_t&gt; size;\n    vcfunc&lt;bool&gt; empty;\n    vcfunc&lt;T, std::size_t&gt; get;\n  };  \n  vtable_t vtable;\n  void const* ptr = 0;\n  template&lt;class C,\n    class dC=std::decay_t&lt;C&gt;,\n    std::enable_if_t&lt;!std::is_same&lt;dC, self&gt;{}, int&gt; =0\n  &gt;\n  random_access_container_view( C&amp;&amp; c ):\n    vtable{\n      vcimpl&lt;dC, std::size_t&gt;( [](auto&amp; c){ return c.size(); } ),\n      vcimpl&lt;dC, bool&gt;( [](auto&amp; c){ return c.empty(); } ),\n      vcimpl&lt;dC, T, std::size_t&gt;( [](auto&amp; c, std::size_t i){ return c[i]; } )\n    },\n    ptr( std::addressof(c) )\n  {}\n\n  std::size_t size() const { return vtable.size( ptr ); }\n  bool empty() const { return vtable.empty( ptr ); }\n  T operator[](std::size_t i) const { return vtable.get( ptr, i ); }\n};\n</code></pre>\n\n<p>Now this is a bit toy as it doesn't support iteration.  (Iterators are about as complex as the container I wrote above).</p>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/26799224cce7624f\" rel=\"nofollow noreferrer\">Live example</a>.</p>\n\n<pre><code>struct A {\n    char name='A';\n};\n\nstruct B:A {\n    B(){ name='B'; }\n};\n\nvoid print_them( random_access_container_view&lt;A&gt; container ) {\n    for (std::size_t i = 0; i &lt; container.size(); ++i ) {\n        std::cout &lt;&lt; container[i].name &lt;&lt; \"\\n\";\n    }\n}\nint main() {\n    std::vector&lt;B&gt; bs(10);\n    print_them( bs );\n}\n</code></pre>\n\n<p>Languages that permit containers-of-child to be treated as lists-of-base basically do the above kind of thing automatically.  Either the containers themselves have the equivalent of a virtual function table, or when you treat a container as a view to base a virtual function table is synthesized and used by the client code.</p>\n\n<p>The above isn't maximally efficient; note that every <code>std::function</code> was stateless.  I could replace them with function pointers pretty easily, and store a static vtable based on the type <code>C</code> instead to save memory (but add an other indirection).</p>\n\n<p>We can also do this a bit simpler with a non-view type, in that we could use the type erasure model-concept pattern instead of this manual vtable pattern.</p>\n"}], "owner": {"reputation": 112, "user_id": 7168080, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-MgXTO6inLpI/AAAAAAAAAAI/AAAAAAAAAHg/Z58RjQVuGdo/photo.jpg?sz=128", "display_name": "antogilbert", "link": "https://stackoverflow.com/users/7168080/antogilbert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 217, "favorite_count": 0, "accepted_answer_id": 46327070, "answer_count": 4, "score": 0, "last_activity_date": 1505935475, "creation_date": 1505923754, "question_id": 46326947, "link": "https://stackoverflow.com/questions/46326947/c-style-cast-of-stdvector", "title": "C-style cast of std::vector", "body": "<p>I stumbled upon this implementation in an existing code base when trying to find a solution to casting an <code>std::vector&lt;Derived *&gt;</code> to a <code>std::vector&lt;Base *&gt;</code>. I am using C++11.</p>\n\n<p>Consider the following code snippet:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n\nclass A\n{\n    // some implementation details\n};\n\nclass B : public A\n{\n    // some implementation details\n};\n\nvoid count(std::vector&lt;A *&gt; const &amp; a_vec)\n{\n  std::cout &lt;&lt; \"IT HAS THESE MANY PTRS: \" &lt;&lt; a_vec.size() &lt;&lt; std::endl;\n}\n\nint main()\n{\n  B * b;\n\n  std::vector&lt;B *&gt; b_vec {b};\n  count((std::vector&lt;A *&gt; &amp;) b_vec);\n\n  return 0;\n}\n</code></pre>\n\n<p>It felt extremely dodgy and so I tried to find an alternative. <a href=\"https://stackoverflow.com/a/902703/7168080\">This post</a> suggested an approach using <code>std::vector::assign</code>. So now, \n my main function would look like this:</p>\n\n<pre><code>int main()\n{\n  B * b;\n\n  std::vector&lt;B *&gt; b_vec {b};\n  std::vector&lt;A *&gt; new_vec;\n  new_vec.assign(b_vec.begin(), b_vec.end());\n  count(new_vec);\n\n  return 0;\n}\n</code></pre>\n\n<p>It compiles and works as expected. Now I have the following questions:</p>\n\n<p>1) Why does the first snippet even compile but using a <code>static_cast</code> causes a compilation error?</p>\n\n<p>2) What is the computational cost of the two methods? I expect the second one to incur into extra costs due to creating the temporary vector object <code>new_vec</code>, but I am not sure.</p>\n\n<p>3) What are the drawbacks of using the C-style cast in these cases?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["c++", "c", "linux", "linux-kernel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 1, "creation_date": 1505923598, "post_id": 46326867, "comment_id": 79614603, "body": "A file is stored in the filesytem. dd does the same."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 3, "creation_date": 1505923598, "post_id": 46326867, "comment_id": 79614604, "body": "You can bypass the block cache on <code>open()</code> by setting the <code>O_DIRECT</code> flag (if it is supported by the file-system driver)."}, {"owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "edited": false, "score": 1, "creation_date": 1505924343, "post_id": 46326867, "comment_id": 79615041, "body": "What makes you think that the file system is not &quot;efficient&quot; here?"}, {"owner": {"reputation": 3732, "user_id": 1719372, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/Xwn9U.jpg?s=128&g=1", "display_name": "bytefire", "link": "https://stackoverflow.com/users/1719372/bytefire"}, "edited": false, "score": 1, "creation_date": 1505924731, "post_id": 46326867, "comment_id": 79615290, "body": "Source code of <code>dd</code> which you mentioned, might have some hints. <code>dd_copy</code> function can be a good starting point: <a href=\"http://lingrok.org/xref/coreutils/src/dd.c#2039\" rel=\"nofollow noreferrer\">lingrok.org/xref/coreutils/src/dd.c#2039</a>"}, {"owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 0, "creation_date": 1505924999, "post_id": 46326867, "comment_id": 79615472, "body": "Filesystems generally prefer contiguous blocks, except if you append multiple times (which is fully in your control), or if they do transparent compression (and why do you care about that?)"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1505925408, "post_id": 46326867, "comment_id": 79615730, "body": "How big are your files: terabytes or gigabytes or petabytes??"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 1, "creation_date": 1505926100, "post_id": 46326867, "comment_id": 79616154, "body": "@mldssr: could you please <b>edit your question</b> to improve it: explain how large are your files and what kind of application are you coding!"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1505980753, "post_id": 46326867, "comment_id": 79636643, "body": "Even with the edit, you don&#39;t explain enough your context (e.g. total volume of data, number of files) and application (is it video, web server, ...).... But 16 disks to keep a few hundred files of a few giogabytes each is overkill."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1505985475, "post_id": 46326867, "comment_id": 79639667, "body": "If your question is related to <a href=\"https://stackoverflow.com/questions/46199135/how-to-design-a-driver-for-this-storage-system\">this one</a> you should have mentioned it. But all your questions still lack context and motivation (what kind of application are you developing, what industry, what data volume)...."}], "answers": [{"tags": [], "owner": {"reputation": 10781, "user_id": 375147, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/514f1ad54850fe2533132fb56fe87536?s=128&d=identicon&r=PG", "display_name": "Norman Gray", "link": "https://stackoverflow.com/users/375147/norman-gray"}, "is_accepted": false, "score": 1, "last_activity_date": 1506002682, "last_edit_date": 1506002682, "creation_date": 1505924245, "answer_id": 46327081, "question_id": 46326867, "link": "https://stackoverflow.com/questions/46326867/how-to-store-a-file-directly-in-certain-continuous-disk-blocks-in-linux-with-c-c/46327081#46327081", "title": "How to store a file directly in certain continuous disk blocks in Linux with C/C++?", "body": "<p>No, there's no way to do this.</p>\n\n<p>The point of the various system and library calls, and of the whole idea of a filesystem, is to present to a program an <em>abstraction</em> of the various messy details involved in storing bytes on disk. There is no unix-standard way of getting below this, and opening up the abstraction.</p>\n\n<p>It's conceivable that there is some back-door API to the inner workings of some filesystems, but I doubt it.  There be (very bad-tempered) dragons.</p>\n\n<p>If you're concerned with high-bandwidth access to storage, then you should look instead at whatever tuning opportunities your filesystem offers, and consider changing the filesystem, or other storage solution, that you're using.  That's a big project, which I wouldn't want to offer advice on.</p>\n"}, {"comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1505982252, "post_id": 46327381, "comment_id": 79637636, "body": "Probably bypassing the page cache would slow down the system (in  the OP&#39;s context)"}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1505986776, "post_id": 46327381, "comment_id": 79640541, "body": "@BasileStarynkevitch I would benchmark to find that out."}], "tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1505925184, "creation_date": 1505925184, "answer_id": 46327381, "question_id": 46326867, "link": "https://stackoverflow.com/questions/46326867/how-to-store-a-file-directly-in-certain-continuous-disk-blocks-in-linux-with-c-c/46327381#46327381", "title": "How to store a file directly in certain continuous disk blocks in Linux with C/C++?", "body": "<p>Using <code>O_DIRECT</code> when <code>open</code>ing file bypasses the page cache in the kernel.</p>\n\n<p>It must be supported by the filesystem. And you must satisfy the constraints specified in <code>man open(2)</code> when using <code>O_DIRECT</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1505987244, "post_id": 46327383, "comment_id": 79640949, "body": "I was under impression that <code>O_DIRECT</code> is often used by databases. For example, MySQL InnoDB opens data files with <code>O_DIRECT</code>."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "reply_to_user": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1505987640, "post_id": 46327383, "comment_id": 79641295, "body": "Probably useful for very large files. But OP have small (gigabyte sized) ones"}], "tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 3, "last_activity_date": 1506014237, "last_edit_date": 1506014237, "creation_date": 1505925198, "answer_id": 46327383, "question_id": 46326867, "link": "https://stackoverflow.com/questions/46326867/how-to-store-a-file-directly-in-certain-continuous-disk-blocks-in-linux-with-c-c/46327383#46327383", "title": "How to store a file directly in certain continuous disk blocks in Linux with C/C++?", "body": "<p>The <a href=\"https://en.wikipedia.org/wiki/Page_cache\" rel=\"nofollow noreferrer\">page cache</a> is <em>improving</em> performance, so you don't want to bypass it (or file system and other layers in the kernel). BTW, you are wrong in believing that <code>dd</code> would bypass them (and you could <a href=\"http://man7.org/linux/man-pages/man1/strace.1.html\" rel=\"nofollow noreferrer\">strace(1)</a> some <code>dd</code> command to check), since <code>dd</code> is using (like your applications) <a href=\"https://en.wikipedia.org/wiki/System_call\" rel=\"nofollow noreferrer\">system calls</a> (listed in <a href=\"http://man7.org/linux/man-pages/man2/syscalls.2.html\" rel=\"nofollow noreferrer\">syscalls(2)</a>)</p>\n\n<p>You could read <a href=\"http://advancedlinuxprogramming.com/\" rel=\"nofollow noreferrer\"><em>Advanced Linux Programming</em></a> and <a href=\"http://pages.cs.wisc.edu/~remzi/OSTEP/\" rel=\"nofollow noreferrer\"><em>Operating Systems : Three Easy Pieces</em></a> (both are freely downloadable) to understand that more.</p>\n\n<p>BTW, when creating a file system (e.g. <code>mkefs</code>) you can tune parameters like block size (e.g. <code>-b</code> option to <a href=\"http://man7.org/linux/man-pages/man8/mke2fs.8.html\" rel=\"nofollow noreferrer\">mke2fs(8)</a>...); perhaps you might recreate your file system with a larger block size (but that won't matter a lot).</p>\n\n<p>You could dedicate a disk partition to your application (but you probably <em>should not</em>). See <a href=\"http://man7.org/linux/man-pages/man8/raw.8.html\" rel=\"nofollow noreferrer\">raw(8)</a> -probably deprecated- and <a href=\"http://man7.org/linux/man-pages/man4/sd.4.html\" rel=\"nofollow noreferrer\">sd(4)</a>. Then format your disk and access e.g. <code>/dev/sdb3</code> as a block device from your code. But again, this is often unwise.</p>\n\n<p>Notice that these days applications rarely use raw disk partition. As an example, consider RDBMS such as PostGreSQL or MySQL. In the 1980s they generally used raw disk partitions, today they are using large disk <em>files</em> (so the file overhead does not matter) and routinely manage datasets of many terabytes.</p>\n\n<p>If you care about performance, I recommend instead to use a large buffer (e.g. a megabyte or some of them, not a kilobyte) for <a href=\"http://man7.org/linux/man-pages/man2/read.2.html\" rel=\"nofollow noreferrer\">read(2)</a> and <a href=\"http://man7.org/linux/man-pages/man2/write.2.html\" rel=\"nofollow noreferrer\">write(2)</a> operations, perhaps with the <a href=\"http://man7.org/linux/man-pages/man2/posix_fadvise.2.html\" rel=\"nofollow noreferrer\">posix_fadvise(2)</a> (and even the <a href=\"http://man7.org/linux/man-pages/man2/readahead.2.html\" rel=\"nofollow noreferrer\">readahead(2)</a>) system call. Using <code>O_DIRECT</code> to <a href=\"http://man7.org/linux/man-pages/man2/open.2.html\" rel=\"nofollow noreferrer\">open(2)</a> (mentioned in <a href=\"https://stackoverflow.com/a/46327381/841108\">Maxim's answer</a>) would bypass the page cache so could slow down things (even if in some cases it could slightly speed up). Look also <a href=\"http://man7.org/linux/man-pages/man2/fdatasync.2.html\" rel=\"nofollow noreferrer\">fsync(2)</a>. In some (but not all) cases accessing a file thru memory mapping with <a href=\"http://man7.org/linux/man-pages/man2/mmap.2.html\" rel=\"nofollow noreferrer\">mmap(2)</a> could be useful. Benchmark to find out the good buffer size for your particular application and computer (including hardware).</p>\n\n<p>But you won't get miracles: the bottleneck is probably the disk hardware itself (not the file system or any other software layer). If possible, buy more RAM (to have a better <a href=\"https://en.wikipedia.org/wiki/Page_cache\" rel=\"nofollow noreferrer\">page cache</a>) and get a fast SSD.</p>\n\n<p>Maybe (or probably) you should consider using RDBMS (PosGresSQL, MySQL), or non-SQL DBMS (MongoDb, ....), or libraries like <a href=\"http://sqlite.org/\" rel=\"nofollow noreferrer\">Sqlite</a> or <a href=\"http://www.gnu.org.ua/software/gdbm/\" rel=\"nofollow noreferrer\">GDBM</a>. They are well tuned and support many terabytes.</p>\n\n<p>For huge datasets (petabytes), you are likely to redesign your application, buy/use/develop specialized hardware and software and hire experts (but then you won't ask here). For large content (terabytes), using files is sensible, and big files of several terabytes are well managed today. If you have lots -e.g. millions- of files (each of small size) you may want to organize them in directory trees (e.g. rather long paths like <code>dir01/subdir234/file4566</code>); if possible avoid huge directories (e.g. of many thousand files). I see no reason to want contiguous disk blocks, since file systems manage that very well today.</p>\n\n<p>BTW, on current disk hardware (both spinning &amp; SSD), \"contiguous\" blocks  don't mean much....</p>\n\n<p>Look also for inspiration into existing code of <a href=\"https://en.wikipedia.org/wiki/Free_software\" rel=\"nofollow noreferrer\">free software</a> applications similar to yours.</p>\n\n<p><sup>Note. I am guessing that by \"large files\" you mean something which can be kept on a single disk (so a few terabytes at most).</sup></p>\n\n<blockquote>\n  <p>All the files I need to store are 100MB ~ 1GB. </p>\n</blockquote>\n\n<p>These are actually quite small (or at least medium sized) files, and they would likely sit entirely in RAM (in the page cache, see also <a href=\"http://linuxatemyram.com/\" rel=\"nofollow noreferrer\">http://linuxatemyram.com/</a> ...). So you really should not bother, and of course you'll better keep them as plain files in some ordinary file system (no need to tune anything in practice).</p>\n\n<blockquote>\n  <p>All I need is to store them into <code>/dev/sd[bcd...]</code> and remember where they are stored in case to read.</p>\n</blockquote>\n\n<p>It seems you think of bypassing the file system, use some raw disk partition, and painfully mimic the role of a file system in your user-land code. In short, <strong>don't do that</strong> (remember that file systems are extremely well designed and tuned system code in the kernel; you won't do as well in only a few months of work).  It could even be worse (because you won't use the page cache as efficiently as your system does). Keep your data as ordinary file in ordinary file systems.\n(Life is short, don't reinvent the wheel!).</p>\n\n<blockquote>\n  <p>I am making a small simply storage system consisting of 16+ HDDs. </p>\n</blockquote>\n\n<p>Perhaps you want an <a href=\"https://en.wikipedia.org/wiki/Logical_Volume_Manager_%28Linux%29\" rel=\"nofollow noreferrer\">LVM</a> and/or some <a href=\"https://en.wikipedia.org/wiki/RAID\" rel=\"nofollow noreferrer\">RAID</a>. I'm surprised you mention a small thing with more than 16 disks (perhaps buying fewer, but larger, disks might be better). BTW, 16 disks to keep a few dozen files of a  few gigabytes each is really overkill (since that fits in <em>one</em> terabyte disk). Don't forget to have <em>enough RAM!</em> And <em>don't forget backups!</em></p>\n\n<p>Remember that CPUs are many thousands times <a href=\"http://norvig.com/21-days.html#answers\" rel=\"nofollow noreferrer\">faster</a> than disks (even SSDs). So almost always file system software layer overhead don't matter at all. Probably your code is I/O bound, not CPU bound, so optimizing your code for CPU is useless (however, tuning buffer sizes etc... is worthwhile, but you should benchmark).</p>\n\n<p><sup>P.S. it is a pity that you are asking <a href=\"https://stackoverflow.com/questions/46199135/how-to-design-a-driver-for-this-storage-system\">several</a> questions related to the same task, but don't give enough context, motivation, and details (what volume &amp; bandwidth of data, what computer, what kind of application and code, what domain and industry, etc ...). I'm sure that with better and more detailed questions -as long as this answer- you'll get better and more useful answers.</sup></p>\n"}], "owner": {"reputation": 21, "user_id": 8374081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/348ee545747fde8172c6aa5942c8728c?s=128&d=identicon&r=PG&f=1", "display_name": "mldssr", "link": "https://stackoverflow.com/users/8374081/mldssr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 472, "favorite_count": 0, "closed_date": 1505943423, "answer_count": 3, "score": -3, "last_activity_date": 1506014237, "creation_date": 1505923449, "last_edit_date": 1505975496, "question_id": 46326867, "link": "https://stackoverflow.com/questions/46326867/how-to-store-a-file-directly-in-certain-continuous-disk-blocks-in-linux-with-c-c", "closed_reason": "Needs more focus", "title": "How to store a file directly in certain continuous disk blocks in Linux with C/C++?", "body": "<p>I am making a small simply storage system consisting of 16+ HDDs. All the files I need to store are 100MB ~ 1GB. It makes a big fuss over a minor issue to employ a complete file system. All I need is to store them into \n<code>/dev/sd[bcd...]</code> and remember where they are stored in case to read.</p>\n\n<p>Write()/fwrite() would have system buffer and file system involved, I think? How can I skip the file system and store a file directly in certainly continuous disk blocks with C/C++ efficiently, just like <code>dd</code>?</p>\n"}, {"tags": ["c", "binary", "int"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1505923272, "post_id": 46326771, "comment_id": 79614399, "body": "<code>int</code> is signed. Have you forgotten about it?"}, {"owner": {"reputation": 852, "user_id": 3227496, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/874115077/picture?type=large", "display_name": "Hans Petter Taugb&#248;l Kragset", "link": "https://stackoverflow.com/users/3227496/hans-petter-taugb%c3%b8l-kragset"}, "edited": false, "score": 0, "creation_date": 1505923539, "post_id": 46326771, "comment_id": 79614558, "body": "I always use <a href=\"https://www.valgrind.org\" rel=\"nofollow noreferrer\">Valgrind</a> to understand segfaults"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1505924169, "post_id": 46326771, "comment_id": 79614943, "body": "Building on what Eugene said, I think you would be surprised at your output if you print the value of <code>tmp</code> to your console with each iteration, especially in consideration of your loop-exit clause."}, {"owner": {"reputation": 1284, "user_id": 6262757, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/1134014206619252/picture?type=large", "display_name": "Nam Vu", "link": "https://stackoverflow.com/users/6262757/nam-vu"}, "reply_to_user": {"reputation": 852, "user_id": 3227496, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/874115077/picture?type=large", "display_name": "Hans Petter Taugb&#248;l Kragset", "link": "https://stackoverflow.com/users/3227496/hans-petter-taugb%c3%b8l-kragset"}, "edited": false, "score": 0, "creation_date": 1505933936, "post_id": 46326771, "comment_id": 79620503, "body": "@HansPetterTaugb&#248;lKragset I got the program to work, I&#39;m actually new to c and never heard of valgrind; thankyou for your suggestion, I&#39;ll keep it in mind!"}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1505930254, "post_id": 46327062, "comment_id": 79618558, "body": "<code>int tmp = 1 &lt;&lt; 31;</code> --&gt; <code>unsigned tmp = 1u &lt;&lt; 31;</code>  (be sure to change to <code>1u</code>)"}, {"owner": {"reputation": 1284, "user_id": 6262757, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/1134014206619252/picture?type=large", "display_name": "Nam Vu", "link": "https://stackoverflow.com/users/6262757/nam-vu"}, "edited": false, "score": 0, "creation_date": 1505933753, "post_id": 46327062, "comment_id": 79620401, "body": "Thank you! The program works fine now, I can&#39;t believe I forget about this"}], "tags": [], "owner": {"reputation": 6703, "user_id": 249810, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/41073fa4fa33840f81aceaefff9ec31c?s=128&d=identicon&r=PG", "display_name": "ezod", "link": "https://stackoverflow.com/users/249810/ezod"}, "is_accepted": false, "score": 1, "last_activity_date": 1505924159, "creation_date": 1505924159, "answer_id": 46327062, "question_id": 46326771, "link": "https://stackoverflow.com/questions/46326771/converting-an-integer-to-binary-strings-in-c/46327062#46327062", "title": "Converting an integer to binary strings in c", "body": "<p>Try making <code>tmp</code> an <code>unsigned int</code>. The behaviour of right-shifting a negative (signed) integer is implementation-defined, and in your case is likely shifting in 1s (the original MSB) thus causing the loop to exceed the length of <code>str</code>.</p>\n"}], "owner": {"reputation": 1284, "user_id": 6262757, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/1134014206619252/picture?type=large", "display_name": "Nam Vu", "link": "https://stackoverflow.com/users/6262757/nam-vu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 826, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1505924159, "creation_date": 1505923138, "last_edit_date": 1505923825, "question_id": 46326771, "link": "https://stackoverflow.com/questions/46326771/converting-an-integer-to-binary-strings-in-c", "title": "Converting an integer to binary strings in c", "body": "<p>This is what I've tried, my logic is that my <code>tmp</code> shifting left 31 times will get compared to the user input integer <code>I</code> and a value of 1 or 0 will be inserted to index <code>str[0]</code> -> <code>str[31]</code> and the I null terminate <code>str[32]</code> with the <code>\\0</code>. </p>\n\n<p>However, I'm getting a segmentation fault.</p>\n\n<p>P.S. I'm not allowed to change the parameters of this function and my professor set the size of <code>str</code> to be 33 in the main, which, I'm not allow to change either.  </p>\n\n<pre class=\"lang-c prettyprint-override\"><code>void int2bitstr(int I, char *str) {\n        int tmp = 1 &lt;&lt; 31;\n        do{\n                *str++ = !!(tmp &amp; I) + '0';\n        } while(tmp &gt;&gt;= 1);\n        *str = '\\0';\n}\n</code></pre>\n\n\n"}, {"tags": ["c", "file", "scanf", "fopen", "file-handling"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1505922063, "post_id": 46326377, "comment_id": 79613528, "body": "The while loop won&#39;t terminate for a non-empty file. Looks like an opposite problem from what you are describing."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1505922149, "post_id": 46326377, "comment_id": 79613593, "body": "@EugeneSh. it won&#39;t terminate for <i>any</i> file, even empty."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 3, "creation_date": 1505922169, "post_id": 46326377, "comment_id": 79613602, "body": "How do you know that the file &quot;opens fine&quot;, since you do not test the return value of <code>fopen()</code> before using it?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1505922202, "post_id": 46326377, "comment_id": 79613625, "body": "if pfile is NULL, feof returns <code>-1</code> so the loop is skipped."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 5, "creation_date": 1505922270, "post_id": 46326377, "comment_id": 79613670, "body": "Also see <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">Why is \u201cwhile ( !feof (file) )\u201d always wrong?</a>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1505922270, "post_id": 46326377, "comment_id": 79613671, "body": "@Jean-Fran&#231;oisFabre Is the EOF indicator updating on IO only?"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1505922515, "post_id": 46326377, "comment_id": 79613854, "body": "How do you know that added-by-a-recent-edit call to <code>fscanf()</code> works?  You&#39;re are not checking <i>anything</i> for errors."}, {"owner": {"reputation": 31, "user_id": 3002912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a457b2544207ee2164d0ac4e5e41219?s=128&d=identicon&r=PG&f=1", "display_name": "ankushkool", "link": "https://stackoverflow.com/users/3002912/ankushkool"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1505922858, "post_id": 46326377, "comment_id": 79614096, "body": "@JohnBollinger Good question, I assumed its reading the file as it was working when I ran the code independently."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1505923223, "post_id": 46326377, "comment_id": 79614360, "body": "Do not make assumptions about program behavior, @ankushkool.  Always check functions&#39; return values for error indicators, if indeed they provide any, except in the rare cases where you don&#39;t actually care whether they succeeded."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1505923302, "post_id": 46326377, "comment_id": 79614418, "body": "Do learn to use a debugger.  These are very handy for figuring out details of how what your program is actually doing differs from what you think it ought to be doing."}], "answers": [{"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1505922348, "post_id": 46326419, "comment_id": 79613729, "body": "And <code>while (!feof ...)</code> <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">is always wrong anyway</a> because it returns true only <i>after</i> an attempt to read <i>past</i> the end of the file occurs."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1505922616, "post_id": 46326419, "comment_id": 79613927, "body": "Although this answer makes statements about the pre-edit question that appear to be true, it does not <i>answer</i> the question, which asks why the program exits silently and unexpectedly (exactly what this answer asserts it will not do).  As the question original stood, this would have been better as a comment; now it is just wrong, and should be deleted."}], "tags": [], "owner": {"reputation": 989, "user_id": 5016244, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/bdZPE.jpg?s=128&g=1", "display_name": "Theophile Dano", "link": "https://stackoverflow.com/users/5016244/theophile-dano"}, "is_accepted": false, "score": 2, "last_activity_date": 1505922152, "creation_date": 1505922152, "answer_id": 46326419, "question_id": 46326377, "link": "https://stackoverflow.com/questions/46326377/fscanf-fclose-or-reading-file-exit-and-ends-program/46326419#46326419", "title": "fscanf() fclose() or reading file exit and ends program", "body": "<p>When you do <code>while (!feof ...)</code> you check each time if you have reach the end of the file. However, at no point your advance in the file (<code>fread</code> ?). That means this will never terminate.</p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 3002912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a457b2544207ee2164d0ac4e5e41219?s=128&d=identicon&r=PG&f=1", "display_name": "ankushkool", "link": "https://stackoverflow.com/users/3002912/ankushkool"}, "edited": false, "score": 0, "creation_date": 1505923465, "post_id": 46326838, "comment_id": 79614517, "body": "Thats a great advice, the file was not opening correctly. Thanks"}], "tags": [], "owner": {"reputation": 3954, "user_id": 3137388, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/98f780bca09821cbd63d84b8d6e028df?s=128&d=identicon&r=PG&f=1", "display_name": "kadina", "link": "https://stackoverflow.com/users/3137388/kadina"}, "is_accepted": true, "score": 0, "last_activity_date": 1505923374, "creation_date": 1505923374, "answer_id": 46326838, "question_id": 46326377, "link": "https://stackoverflow.com/questions/46326377/fscanf-fclose-or-reading-file-exit-and-ends-program/46326838#46326838", "title": "fscanf() fclose() or reading file exit and ends program", "body": "<p>Check whether the file exists or not. You should always check whether File pointer is NULL or not after opening the file. I think your program is unable to open the file and you are trying to use the file pointer without checking which is causing undefined behavior.</p>\n"}], "owner": {"reputation": 31, "user_id": 3002912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a457b2544207ee2164d0ac4e5e41219?s=128&d=identicon&r=PG&f=1", "display_name": "ankushkool", "link": "https://stackoverflow.com/users/3002912/ankushkool"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 282, "favorite_count": 1, "accepted_answer_id": 46326838, "answer_count": 2, "score": -1, "last_activity_date": 1505923374, "creation_date": 1505922009, "last_edit_date": 1505923188, "question_id": 46326377, "link": "https://stackoverflow.com/questions/46326377/fscanf-fclose-or-reading-file-exit-and-ends-program", "title": "fscanf() fclose() or reading file exit and ends program", "body": "<p>Below is a part of my code which is having issues with file handling. The file opens fine with fopen but when I try to read or just close the file my program exits without an error. I tried to run this code independently and it works fine. Would really appreciate if someone could help me out which pointing out what I am doing wrong. </p>\n\n<pre><code>    int ctrlSend(char *etherPort, uint8_t *inPayload, int payloadLen, int vlanID) \n    {\n    char intName [10]; // Interface name from file\n    int intVlan; // Interface VLAN from file\n    printf(\"In ctrlSend\\n\");\n\n    FILE * pFile; // File pointer\n    pFile = fopen (\"vlan.conf\",\"r\");\n\n    while(!feof(pFile))\n    {\n      fscanf(pFile,\"%s %d\",intName,&amp;intVlan)\n      printf(\"In ctrlSend while loop\");\n    }\n\n\n    fclose (pFile);\n    return 0;\n    }\n</code></pre>\n\n<p>UPDATE1: Updated above code</p>\n\n<p>UPDATE2: Alternate code below which has same issue.</p>\n\n<pre><code>    int ctrlSend(char *etherPort, uint8_t *inPayload, int payloadLen, int vlanID) \n    {\n\n    printf(\"In ctrlSend\\n\");\n\n    char intName [10]; // Interface name from file\n    int intVlan; // Interface VLAN from file\n    FILE * pFile; // File pointer\n    pFile = fopen (\"vlan.conf\",\"r\");\n\n    while (fscanf (pFile,\"%s %d\",intName,&amp;intVlan) == 2)\n    {\n        printf(\"In ctrlSend while loop\");\n    }\n\n\n    fclose (pFile);\n    return 0;\n    }\n</code></pre>\n\n<p>UPDATE3: Seems like the file is not opening, looking into it.</p>\n"}, {"tags": ["c", "unix"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1505921611, "post_id": 46326176, "comment_id": 79613189, "body": "<code>char buf[3];</code> read then null terminate <code>buf[2] = &#39;\\0&#39;;</code> that&#39;ll do it."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1505921694, "post_id": 46326176, "comment_id": 79613247, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/174531/easiest-way-to-get-files-contents-in-c\">Easiest way to get file&#39;s contents in C</a>"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1505922860, "post_id": 46326176, "comment_id": 79614100, "body": "<code>printf(&quot;%.*s\\n&quot;, (int)n, buf);</code>, where <code>n</code> is the number you got back from <code>read</code>."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 8642426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/036a3aeedde541f6313c91649531955a?s=128&d=identicon&r=PG&f=1", "display_name": "Tmirror", "link": "https://stackoverflow.com/users/8642426/tmirror"}, "edited": false, "score": 0, "creation_date": 1505922663, "post_id": 46326248, "comment_id": 79613966, "body": "Let&#39;s assume i hard code a char array char anotherBuf[2] and assign H at [0] and i at [1]. Then i can use printf(&quot;%s&quot;, anotherBuf) and it still prints the char Array correctly even without the terminating 0. It does not search for the &quot;next&quot; &#39;\\0&#39; it can find. Why is it not the same with my char Array? In fact: it only should contain &#39;H&#39; and &#39;i&#39; after read()."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 23, "user_id": 8642426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/036a3aeedde541f6313c91649531955a?s=128&d=identicon&r=PG&f=1", "display_name": "Tmirror", "link": "https://stackoverflow.com/users/8642426/tmirror"}, "edited": false, "score": 0, "creation_date": 1505922970, "post_id": 46326248, "comment_id": 79614172, "body": "@Tmirror That test was not guaranteed to work either; it was just by chance that there happened to be a null byte soon after <code>anotherBuf</code> for <code>printf</code> to find and stop on."}, {"owner": {"reputation": 989, "user_id": 5016244, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/bdZPE.jpg?s=128&g=1", "display_name": "Theophile Dano", "link": "https://stackoverflow.com/users/5016244/theophile-dano"}, "edited": false, "score": 0, "creation_date": 1505923073, "post_id": 46326248, "comment_id": 79614246, "body": "Printing a non-null-terminated string in C is <b>guaranteed</b> to give you extra rubbish as long as no null byte is found"}], "tags": [], "owner": {"reputation": 989, "user_id": 5016244, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/bdZPE.jpg?s=128&g=1", "display_name": "Theophile Dano", "link": "https://stackoverflow.com/users/5016244/theophile-dano"}, "is_accepted": true, "score": 1, "last_activity_date": 1505921631, "creation_date": 1505921631, "answer_id": 46326248, "question_id": 46326176, "link": "https://stackoverflow.com/questions/46326176/c-unix-read-reads-none-existing-letters/46326248#46326248", "title": "C UNIX - read() reads none existing letters", "body": "<p>Clearly you need to make <code>buf</code> 3 bytes long and use the last byte as the null byte (0 or <code>'\\0'</code>). That way, when you print the string, your computer doesn't carry on until he finds another 0 !</p>\n\n<p>The way strings (char arrays really) are handled in C is quite straightforward. Indeed, when dealing with strings (most) if not all functions take under the assumption that string parameters are <strong>null terminated</strong> (<code>puts</code>) or return null terminated strings (<code>strdup</code>).</p>\n\n<p>The point is that, by default the computer can't tell where a string ends unless it is given the strings size each time he processes it. The easiest implementation around this approach was to append after each string a 0 (namely the null byte). That way, the computer just need to iterate over the string's characters and stop when he finds the termination character (other name for null byte).</p>\n"}], "owner": {"reputation": 23, "user_id": 8642426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/036a3aeedde541f6313c91649531955a?s=128&d=identicon&r=PG&f=1", "display_name": "Tmirror", "link": "https://stackoverflow.com/users/8642426/tmirror"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 46326248, "answer_count": 1, "score": -1, "last_activity_date": 1505921631, "creation_date": 1505921421, "question_id": 46326176, "link": "https://stackoverflow.com/questions/46326176/c-unix-read-reads-none-existing-letters", "title": "C UNIX - read() reads none existing letters", "body": "<p>I've got a little problem while experimenting with some C code. I've tried to use read()-Command to read a text out of a file and store the results in a charArray. But when I print the results they're always different from the file.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;unistd.h&gt;\n\nvoid main() {\n\nint fd = open(\"file\", 2);\nchar buf[2];\nprintf(\"Read elements: %ld\\n\", read(fd, buf, 2));\nprintf(\"%s\\n\", buf);\nclose(fd);\n\n}\n</code></pre>\n\n<p>The file \"file\" was created in the same directory using the following UNIX commands:</p>\n\n<pre><code>cat &gt; file\nHi\n</code></pre>\n\n<p>So it contains just the word \"Hi\". When I run it, I expect it to read 2 bytes from the file (which are 'H' and 'i') and store them at buf[0] and buf[1]. But when I want to print the result, it appears, that there was an issue, because besides the word \"Hi\" there are several wierd characters printed (indicating a memory reading/writing problem i guess, due to bad buffer size). I've tried to increase the size of the buf-Array and it appears that when i change the size, the wierd characters printed change. The problem is removed when size reaches 32 bytes.</p>\n\n<p>Can someone explain to me in detail why this is happening?\nI've understood so far that read() does not read \\'0' when it reads something, and that the third parameter of read() indicates the maximum number of bytes to read.</p>\n\n<p>Antoher thing I've noticed while experimenting with the above code is the following: Let's assume one changes the third parameter (maximum bytes to read) of read() to 3, and the size of buf-Array to 512 (overkill i know, but I really wanted to see what will happen). Now read will acutally read a third character (in my case 'e') and store it into the buffer, even tho this third character does not exist.</p>\n\n<p>I've searched for a while now @stackoverflow and I found many similiar cases, but none of them made me understand my problem. If there is any other thread i missed, it would be a pleasure if u could link me to it.</p>\n\n<p>At last: sry for my bad english, it's not my native language.</p>\n"}, {"tags": ["c", "error-handling", "string-parsing"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1505920682, "post_id": 46325780, "comment_id": 79612416, "body": "Please show us what output you get and what output you expect."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1505920720, "post_id": 46325780, "comment_id": 79612456, "body": "<code>sl &lt; 0</code> not possible"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1505920776, "post_id": 46325780, "comment_id": 79612494, "body": "...and <code>si</code> may end up uninitialized."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1505920861, "post_id": 46325780, "comment_id": 79612582, "body": "... and this program doesn&#39;t <i>cast</i> anything but it <i>converts</i>."}, {"owner": {"reputation": 313, "user_id": 2105501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45c64e49a69a60a94328fe105e936a3d?s=128&d=identicon&r=PG", "display_name": "Idan", "link": "https://stackoverflow.com/users/2105501/idan"}, "edited": false, "score": 1, "creation_date": 1505920882, "post_id": 46325780, "comment_id": 79612604, "body": "Read: <a href=\"https://linux.die.net/man/3/strtoull\" rel=\"nofollow noreferrer\">linux.die.net/man/3/strtoull</a> in order to see the correct way to use the function strtoull"}], "answers": [{"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1505931829, "last_edit_date": 1505931829, "creation_date": 1505921919, "answer_id": 46326348, "question_id": 46325780, "link": "https://stackoverflow.com/questions/46325780/c-string-to-uint64-t-casting-with-error-handling/46326348#46326348", "title": "C - string to uint64_t casting with error handling", "body": "<p><code>strtoull();</code> allows input that begin with <code>'-'</code>.  The function converts the numeric portion of the text and then negates it, the result is still an <em>unsigned</em> integer.  So code cannot use the result of <code>strtoull()</code> to determine if the text represented a negative number as with <code>uint64_t sl;</code>, <code>sl &lt; 0</code> is always false.</p>\n\n<p>Code needs to detect the <code>'-'</code> in other ways.</p>\n\n<p>I'd expect the function to return an <code>uint64_t</code></p>\n\n<pre><code>#include &lt;ctype.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;stdio.h&gt;\n\n// int func(const char *buff) {\nuint64_t func(const char *buff) {\n  const char *s = buff;\n  // consume leading whitespace\n  while (isspace((unsigned char ) *s)) {\n    s++;\n  }\n  int sign = *s;\n  if (sign == '-' || sign == '+') {\n    s++;\n  }\n  // Now code knows it the text is \"negative\"\n\n  // rest of OP's code needs a some work\n  char *end;\n  errno = 0;\n  unsigned long long sl = strtoull(s, &amp;end, 10);\n\n  if (end == s) {\n    fprintf(stderr, \"%s: not a decimal number\\n\", buff);\n  } else if ('\\0' != *end) {\n    fprintf(stderr, \"%s: extra characters at end of input: %s\\n\", buff, end);\n    // } else if ((sl &lt; 0 || ULONG_MAX == sl) &amp;&amp; ERANGE == errno) {\n  } else if (sign == '-') {\n    fprintf(stderr, \"%s negative\\n\", buff);\n    sl = 0;\n    errno = ERANGE;\n  } else if (ERANGE == errno) {\n    fprintf(stderr, \"%s out of range of type uint64_t\\n\", buff);\n\n    // Only needed on rare machines\n#if ULLONG_MAX &gt; UINT64_MAX\n    else if (sl &gt; UINT64_MAX) {\n      fprintf(stderr, \"%s out of range of type uint64_t\\n\", buff);\n      sl = UINT64_MAX;\n      errno = ERANGE;\n    }\n#endif\n\n  }\n  return (uint64_t) sl;\n}\n</code></pre>\n\n<p>OP's returning of an <code>int</code> is strange.  Leave updating <code>main()</code> to OP.</p>\n"}], "owner": {"reputation": 305, "user_id": 7801444, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/95ffc26f9e2c72941144dfc1d9abc50c?s=128&d=identicon&r=PG&f=1", "display_name": "PyCV", "link": "https://stackoverflow.com/users/7801444/pycv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 411, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1505931829, "creation_date": 1505920350, "last_edit_date": 1505923642, "question_id": 46325780, "link": "https://stackoverflow.com/questions/46325780/c-string-to-uint64-t-casting-with-error-handling", "title": "C - string to uint64_t casting with error handling", "body": "<p>This program is to cast strings to <code>uint64_t</code> types and get the errors if any.</p>\n\n<p>It should output, in this case, 2 errors (overflow and negative number), none of which appear. Also, it doesn't properly cast one of the strings.</p>\n\n<p>Any help would be appreciated.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;inttypes.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;limits.h&gt;\n\nint func(const char *buff) {\n    char *end;\n    int si;\n\n    errno = 0;\n\n    const uint64_t sl = strtoull(buff, &amp;end, 10);\n\n    if (end == buff) {\n    fprintf(stderr, \"%s: not a decimal number\\n\", buff);\n    } else if ('\\0' != *end) {\n    fprintf(stderr, \"%s: extra characters at end of input: %s\\n\", buff, end);\n    } else if ((sl &lt; 0 || ULONG_MAX == sl) &amp;&amp; ERANGE == errno) {\n    fprintf(stderr, \"%s out of range of type uint64_t\\n\", buff);\n    } else if (sl &gt; ULONG_MAX) {\n    fprintf(stderr, \"%ld greater than ULONG_MAX\\n\", sl);\n    } else if (sl &lt; 0) {\n     fprintf(stderr, \"%ld negative\\n\", sl);\n    } else {\n    si = (int)sl;\n    }\n\n    return si;\n}\n\nint main()\n{\n\n    printf(\"%d\\n\", func(\"123456789123465789\"));\n    printf(\"%d\\n\", func(\"123456789123465789123465789\"));\n    printf(\"%d\\n\", func(\"-1\"));\n\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "cs50", "caesar-cipher"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1505918866, "post_id": 46325018, "comment_id": 79611058, "body": "You are checking whether the character is an alphabetical one, and it&#39;s case. Why to test it&#39;s numerical value too?"}, {"owner": {"reputation": 3, "user_id": 8462657, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155230429004681/picture?type=large", "display_name": "Shaun", "link": "https://stackoverflow.com/users/8462657/shaun"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1505919433, "post_id": 46325018, "comment_id": 79611477, "body": "Because if the uppercase letter is over position 90 in ASCII,i.e past the uppercase Z, it will return a non-uppercase letter which is incorrect. I need to check it&#39;s position and minus 26 so that A-Z wraps around."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1505919511, "post_id": 46325018, "comment_id": 79611525, "body": "but then it won&#39;t be alphabetical, right?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1505920231, "post_id": 46325018, "comment_id": 79612076, "body": "Questions seeking debugging help (&quot;why isn&#39;t this code working?&quot;) must include the desired behavior, a specific problem or error and the shortest code necessary to reproduce it in the question itself. Questions without a clear problem statement are not useful to other readers. See: How to create a Minimal, Complete, and Verifiable example."}, {"owner": {"reputation": 3, "user_id": 8462657, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155230429004681/picture?type=large", "display_name": "Shaun", "link": "https://stackoverflow.com/users/8462657/shaun"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1505920964, "post_id": 46325018, "comment_id": 79612680, "body": "@EugeneSh. I&#39;m not following sorry. If we take example &#39;foo&#39; which I am trying to encipher. If I use a key of 17, it should return &#39;wff&#39;, but my code is returning &#39;w&#39; only. With my code it is saying to go to position 128 which isn&#39;t a letter, but my code is saying if this is over 122, deduct 26. This equals and returns &#39;102&#39;, - which is &#39;f&#39;. Is it something to do with delete being assigned to 127?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1505921022, "post_id": 46325018, "comment_id": 79612723, "body": "There are a lot of other questions tagged <a href=\"https://stackoverflow.com/questions/tagged/cs50\">cs50</a> and <a href=\"https://stackoverflow.com/questions/tagged/caesar-cipher\">caesar-cipher</a>.  You can probably find the inspiration you need by looking at those.  Using hard-coded numbers like 90 is an indication of bugs; don&#39;t.  Use <code>&#39;a&#39;</code>, <code>&#39;z&#39;</code>, <code>&#39;A&#39;</code>, <code>&#39;Z&#39;</code>.  Convert the letter to a number 0..25; add the encryption key (also mapped to 0..25) modulo 26; convert the result back to the correct case of letter."}], "answers": [{"tags": [], "owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "is_accepted": true, "score": 0, "last_activity_date": 1505921194, "creation_date": 1505921194, "answer_id": 46326096, "question_id": 46325018, "link": "https://stackoverflow.com/questions/46325018/cs50-pset-2-caesar-erroneous-results/46326096#46326096", "title": "CS50 PSET 2 Caesar Erroneous Results", "body": "<p>With lower-case letters, you may face overflow:</p>\n\n<pre><code>char e = (s[i] + b);\n</code></pre>\n\n<p>On your system, <code>char</code> is signed, which means it can take values from &minus;128 to 127. Take lower-case z, which is ASCII 122. Shift it by 6 places or more, and you overflow your <code>char</code>. Overflow of signed integers is undefined behaviour. You can fix this by making your intermediate values <code>int</code>s:</p>\n\n<pre><code>int e = (s[i] + b);\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8462657, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155230429004681/picture?type=large", "display_name": "Shaun", "link": "https://stackoverflow.com/users/8462657/shaun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 341, "favorite_count": 0, "accepted_answer_id": 46326096, "answer_count": 1, "score": -2, "last_activity_date": 1505921194, "creation_date": 1505918273, "last_edit_date": 1505921088, "question_id": 46325018, "link": "https://stackoverflow.com/questions/46325018/cs50-pset-2-caesar-erroneous-results", "title": "CS50 PSET 2 Caesar Erroneous Results", "body": "<p>Thought I had completed Caesar, but when running CHeck50, my code fails for this reason: <em>encrypts \"barfoo\" as \"yxocll\" using 23 as key\noutput not valid ASCII text\nLog\nrunning ./caesar 23...\nsending input barfoo...\nchecking for output \"ciphertext: yxocll \"...</em> </p>\n\n<p>Can anyone see anything wrong with my code? It seems to work fine for uppercase letters, but with lowercase letters and certain 'keys', I'm getting erroneous results, and can't spot why. Any help would be greatly appreciated.</p>\n\n<p><strong>Example:</strong> If I try to encipher 'foo' with a key of 17, it should return 'wff', but my code is returning 'w' only. With the code I have written it is saying to go to position 128 which isn't a letter, but my code is then saying if this is over 122, deduct 26. This equals and returns '102', - which is 'f'. Is it something to do with delete being assigned to 127</p>\n\n<pre><code>#include &lt;cs50.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(int argc, string argv[])\n{\n  if (argc == 2) {\n    int a = atoi (argv[1]);\n    int b = a%26;\n    printf(\"plaintext: \");\n    //get string\n    string s = get_string();\n    printf (\"ciphertext: \");\n        //iterate through string\n        for (int i=0, n =strlen(s); i&lt;n; i++) {\n            //check if character is a letter\n            if ( isalpha (s[i])) {\n                //check if letter is uppercase\n                if (isupper (s[i])) {\n                    //calculate position of character in ASCI by adding 'Key'. If character is over 90, decrease character location by 26\n                    char c = (s[i] + b);\n                    if (c &gt; 90) {\n                            char d = c - 26;\n                            printf (\"%c\", d);\n                    } else\n                    printf(\"%c\", c);\n                } else\n               //For lowercase letters. If character location is over position 122, decrease location by 26\n                {\n                    char e = (s[i] + b);\n                    if (e&gt;122) {\n                            char f = e - 26;\n                            printf(\"%c\", f);\n                    } else\n                        printf(\"%c\", e);\n                }\n            } else    //print non letters with no change made\n            {\n                printf (\"%c\", s[i]);\n            }\n        }\n    }\nprintf (\"\\n\");\nreturn 0;\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["c", "igraph"], "comments": [{"owner": {"reputation": 11, "user_id": 8616550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638f1c824a4799f724e3eb734afdfd28?s=128&d=identicon&r=PG&f=1", "display_name": "InspectElement", "link": "https://stackoverflow.com/users/8616550/inspectelement"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1505920893, "post_id": 46324951, "comment_id": 79612612, "body": "I am trying to use a random network generator and delete edges randomly after the network generation. How can I randomly delete edges in Igraph C?"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1505923615, "post_id": 46324951, "comment_id": 79614614, "body": "Did you read the <a href=\"http://igraph.org/c/doc/\" rel=\"nofollow noreferrer\">documentation of <code>igraph</code></a> ? You really should!"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1505923845, "post_id": 46324951, "comment_id": 79614754, "body": "And you might ask on some dedicated list, or, after having done some experiments, by a mail to  <code>igraph@igraph.org</code>; it is probably  a too specialized software to get an answer on SO"}], "owner": {"reputation": 11, "user_id": 8616550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638f1c824a4799f724e3eb734afdfd28?s=128&d=identicon&r=PG&f=1", "display_name": "InspectElement", "link": "https://stackoverflow.com/users/8616550/inspectelement"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 213, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1505923411, "creation_date": 1505918101, "last_edit_date": 1505923411, "question_id": 46324951, "link": "https://stackoverflow.com/questions/46324951/deleting-edges-randomly-in-igraph-c", "title": "Deleting edges randomly in igraph C", "body": "<blockquote>\n  <p>How can I randomly delete edges in Igraph C?</p>\n</blockquote>\n\n<p>I am using a library called <a href=\"http://igraph.org/c/\" rel=\"nofollow noreferrer\">igraph</a>. I am using <a href=\"https://www.cygwin.com/\" rel=\"nofollow noreferrer\">Cygwin</a> on Windows.</p>\n\n<p>I am trying to delete edges randomly from a randomly generated network(network generated using Erdos Renyi Random network generator). </p>\n\n<p>I would appreciate some help in this regard.</p>\n\n<p>The <a href=\"https://stackoverflow.com/questions/36366716/deleting-an-edge-in-graph-for-c\">code is referenced from a different post</a>. Unfortunately there is no answer to the question on that post either.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;igraph/igraph.h&gt;\n\nint main() {\n\nint edgeCount=0;\nigraph_t g;\nigraph_vector_t v;\n\nigraph_vector_t edges;\nigraph_vector_init(&amp;edges,0);\n\nigraph_vector_t indices;\nigraph_vector_init(&amp;indices, 0);\n\nigraph_erdos_renyi_game(&amp;g, IGRAPH_ERDOS_RENYI_GNP, 500, .10,IGRAPH_UNDIRECTED, IGRAPH_NO_LOOPS); // Create a random graph\n\nigraph_get_edgelist(&amp;g, &amp;edges, 0); // Put the graph's list of indices in \"edges\"\n int r = rand() % ((int)igraph_ecount(&amp;g)); // Get a random edge index\n\n\nigraph_vector_push_back(&amp;indices, r); // create a vector of size 1 in which to put the random index found above\n\n igraph_delete_edges(&amp;g, igraph_es_vector(&amp;indices)); // Delete that edge\n\n return igraph_ecount(&amp;g);\n}\n</code></pre>\n"}, {"tags": ["c", "string", "pointers", "recursion"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1505917605, "post_id": 46324695, "comment_id": 79610116, "body": "A function has to be declared before it is used."}, {"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 1, "creation_date": 1505917630, "post_id": 46324695, "comment_id": 79610130, "body": "Indent your code, it&#39;s quite hard to read right now."}, {"owner": {"reputation": 313, "user_id": 2105501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45c64e49a69a60a94328fe105e936a3d?s=128&d=identicon&r=PG", "display_name": "Idan", "link": "https://stackoverflow.com/users/2105501/idan"}, "edited": false, "score": 0, "creation_date": 1505917645, "post_id": 46324695, "comment_id": 79610144, "body": "Try adding a deceleration for the &quot;strv&quot; at the top of the file."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 313, "user_id": 2105501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45c64e49a69a60a94328fe105e936a3d?s=128&d=identicon&r=PG", "display_name": "Idan", "link": "https://stackoverflow.com/users/2105501/idan"}, "edited": false, "score": 1, "creation_date": 1505917686, "post_id": 46324695, "comment_id": 79610173, "body": "@IdanMeyer I would add an acceleration.."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1505917818, "post_id": 46324695, "comment_id": 79610261, "body": "This must be a dup.... maybe this one <a href=\"https://stackoverflow.com/questions/12869720/conflicting-types-in-c\" title=\"conflicting types in c\">stackoverflow.com/questions/12869720/conflicting-types-in-c</a>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1505917880, "post_id": 46324695, "comment_id": 79610301, "body": "BTW, <code>str+1!=NULL</code> is definitely not the right stop condition."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3458"}, "edited": false, "score": 3, "creation_date": 1505918432, "post_id": 46324695, "comment_id": 79610731, "body": "OT: using static variables in recursive function is a cheat, likely not what your teacher wanted"}], "answers": [{"comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1505918370, "post_id": 46324938, "comment_id": 79610677, "body": "Deceleration again? It&#39;s the opposite of &quot;Acceleration&quot;. You want to use a <i>declaration</i>. Also your code is no different from OPs."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1505918848, "post_id": 46324938, "comment_id": 79611040, "body": "BTW <code>&lt;conio.h&gt;</code> is non standard (and absent on  Linux and POSIX systems)"}], "tags": [], "owner": {"reputation": 313, "user_id": 2105501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45c64e49a69a60a94328fe105e936a3d?s=128&d=identicon&r=PG", "display_name": "Idan", "link": "https://stackoverflow.com/users/2105501/idan"}, "is_accepted": false, "score": -2, "last_activity_date": 1505918589, "last_edit_date": 1505918589, "creation_date": 1505918076, "answer_id": 46324938, "question_id": 46324695, "link": "https://stackoverflow.com/questions/46324695/reverse-a-string-in-c-using-recursion-and-without-using-any-other-array-or-point/46324938#46324938", "title": "reverse a string in c using recursion and without using any other array or pointer", "body": "<p>You need to add a deceleration for you function \"strv\".</p>\n\n<p>Because the function strv is implemented after the function main, inside the scope of the function main, \"strv\" in not known.</p>\n\n<p>You should add a deceleration for the function strv above the function main:</p>\n\n<pre><code>char* strv(char *str);\n</code></pre>\n\n<p><strong>General rule of thumb: ALWAYS add a deceleration of functions in order to avoid these cases.</strong> </p>\n\n<p>Complete example:</p>\n\n<pre><code>#include&lt;conio.h&gt;\n#include&lt;stdio.h&gt;\n\nchar* strv(char *str);\n\nvoid main() \n{\n    char strr[10]=\"hello\";\n    char *st;\n    printf(\"%s\",strr);\n    st=strv(strr);\n    printf(\"%s\",st);\n}\n\nchar* strv(char *str)\n{\n    static int i,j;\n    char a;\n    if(str+1!=NULL) \n    {\n        a=*str;\n        i++;\n\n        strv(++str);\n        *(str-i+j)=a;\n        j++;\n        return str;\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1505920552, "post_id": 46325770, "comment_id": 79612321, "body": "Looks like O(n) to me if you precalculate the length and just pass it around."}, {"owner": {"reputation": 15724, "user_id": 1716339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/835fc3719b0118c68c4d202b3e5cbf18?s=128&d=identicon&r=PG", "display_name": "Aki Suihkonen", "link": "https://stackoverflow.com/users/1716339/aki-suihkonen"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1505920993, "post_id": 46325770, "comment_id": 79612701, "body": "Already removed the comment -- but giving the length as parameter is pretty much the same as having another pointer around; In a way, it violates the spirit of the rules..."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1505921421, "post_id": 46325770, "comment_id": 79613016, "body": "Well, I see it as a very idiomatic recursion technique and an optimization in zero cost. Well, that&#39;s my opinion."}], "tags": [], "owner": {"reputation": 15724, "user_id": 1716339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/835fc3719b0118c68c4d202b3e5cbf18?s=128&d=identicon&r=PG", "display_name": "Aki Suihkonen", "link": "https://stackoverflow.com/users/1716339/aki-suihkonen"}, "is_accepted": false, "score": 0, "last_activity_date": 1505920321, "creation_date": 1505920321, "answer_id": 46325770, "question_id": 46324695, "link": "https://stackoverflow.com/questions/46324695/reverse-a-string-in-c-using-recursion-and-without-using-any-other-array-or-point/46325770#46325770", "title": "reverse a string in c using recursion and without using any other array or pointer", "body": "<p>Given the constraints, at least an O(n^ 2) algorithm is possible.\nThe function locates the end, memorizes the last character, replaces it by zero for the next level and swaps array beginning and the original last character after the inner calls have finished.</p>\n\n<pre><code>void rev(char *a) {\n   int l=strlen(a);\n   if (l&lt;2) return;  // nothing to swap if l==0 or l==1\n   char b=a[l-1];    // have to remember the ending character\n   a[l-1]=0;         // and have to set it to zero for next level\n   rev(a+1);\n   a[l-1]=a[0];\n   a[0]=b;\n}\n</code></pre>\n\n<p>To solve the compile error, the easiest method is to place the subroutine before main().</p>\n"}, {"tags": [], "owner": {"reputation": 407, "user_id": 6566252, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7772f443cf60b1154e74ff398fbbe41d?s=128&d=identicon&r=PG&f=1", "display_name": "Bizzu", "link": "https://stackoverflow.com/users/6566252/bizzu"}, "is_accepted": false, "score": 0, "last_activity_date": 1505921376, "creation_date": 1505921376, "answer_id": 46326164, "question_id": 46324695, "link": "https://stackoverflow.com/questions/46324695/reverse-a-string-in-c-using-recursion-and-without-using-any-other-array-or-point/46326164#46326164", "title": "reverse a string in c using recursion and without using any other array or pointer", "body": "<p>The solution is to make a <code>swap function</code> and go from the begin, end of the array to the middle.\nWhile the <code>first \"iterator\" or \"pointer\"</code> is less than the <code>end \"pointer\"</code> continue the swaping.</p>\n\n<p>My advice, when you use the code change the <code>0</code> in my code and the <code>4</code> in my code to variable, for example : <code>begin</code> <code>end</code> and it will make your code readable and  Flexible for changes</p>\n\n<p>This is my code: </p>\n\n<pre><code>void swap(char* first, char* last){\n    if(first &gt; last){\n        return;\n    }\n    char tmp = *first;\n    *first=*last;\n    *last=tmp;\n    swap(first+1 , last -1);\n}\n\nint main() \n{    char strr[10]=\"hello\";\n    char *st;\n    swap(&amp;strr[0],&amp;strr[4]);\n    printf(\"%s\",strr);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 126, "user_id": 6660041, "user_type": "registered", "profile_image": "https://graph.facebook.com/1199203193475596/picture?type=large", "display_name": "Aviral Ahuja", "link": "https://stackoverflow.com/users/6660041/aviral-ahuja"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 717, "favorite_count": 0, "closed_date": 1505928555, "answer_count": 3, "score": -5, "last_activity_date": 1505921376, "creation_date": 1505917472, "last_edit_date": 1505919544, "question_id": 46324695, "link": "https://stackoverflow.com/questions/46324695/reverse-a-string-in-c-using-recursion-and-without-using-any-other-array-or-point", "closed_reason": "Duplicate", "title": "reverse a string in c using recursion and without using any other array or pointer", "body": "<pre><code>#include&lt;conio.h&gt;\n#include&lt;stdio.h&gt;\nvoid main() \n{\n    char strr[10]=\"hello\";\n    char *st;\n    printf(\"%s\",strr);\n    st=strv(strr);\n    printf(\"%s\",st);\n}\nchar* strv(char *str)\n{\n   static int i,j;\n   char a;\n   if(str+1!=NULL) \n   {\n      a=*str;\n      i++;\n      strv(++str);\n     *(str-i+j)=a;\n     j++;\n     return str;\n   }\n}\n</code></pre>\n\n<p>there's a error in code \"conflicting types for strv\" and i can;t figure out why.please respond with solution to reverse an array by recursion and without using any other array or pointer</p>\n"}, {"tags": ["c", "embedded", "embedded-linux", "sensors", "raspberry-pi3"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 5, "creation_date": 1505915913, "post_id": 46324018, "comment_id": 79608886, "body": "The question may be more suitable for <a href=\"https://raspberrypi.stackexchange.com/\">raspberrypi.stackexchange.com</a>, especially if it is regarding the difference between various Raspberry boards."}, {"owner": {"reputation": 70, "user_id": 8103113, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/9c2b4dc708a17e38d50406f3f1f8aa91?s=128&d=identicon&r=PG&f=1", "display_name": "Lomezno", "link": "https://stackoverflow.com/users/8103113/lomezno"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1505917533, "post_id": 46324018, "comment_id": 79610066, "body": "It is not a raspberry board the one im using. I used Rasp only to confirm that the sensor was not broken."}, {"owner": {"reputation": 808, "user_id": 2918853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oc6b4.png?s=128&g=1", "display_name": "Florian Castellane", "link": "https://stackoverflow.com/users/2918853/florian-castellane"}, "edited": false, "score": 0, "creation_date": 1505918588, "post_id": 46324018, "comment_id": 79610859, "body": "how long does this signal stay to low? is it long enough that your hardware will be able to see it?"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1505926641, "post_id": 46324018, "comment_id": 79616462, "body": "I think you need to ask the author of the library"}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1505935580, "post_id": 46327752, "comment_id": 79621374, "body": "That&#39;s an overly long comment. Don&#39;t use an answer fort that. We are not a tutoring/debugging/consulting site and such questions shall not be answered (see meta) at all."}, {"owner": {"reputation": 70, "user_id": 8103113, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/9c2b4dc708a17e38d50406f3f1f8aa91?s=128&d=identicon&r=PG&f=1", "display_name": "Lomezno", "link": "https://stackoverflow.com/users/8103113/lomezno"}, "edited": false, "score": 0, "creation_date": 1505981337, "post_id": 46327752, "comment_id": 79637031, "body": "I was checking the testing code and something is wrong, the board sends some signals that are detected by the test, so I cannot rely on the test to say that the lib is working. I also saw on documentation that the data port of the sensor is SDA, so im not sure anymore if I should plug it on gpio or i2c pin."}], "tags": [], "owner": {"reputation": 61, "user_id": 8151513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XRNTm.jpg?s=128&g=1", "display_name": "tony_felloni", "link": "https://stackoverflow.com/users/8151513/tony-felloni"}, "is_accepted": true, "score": 1, "last_activity_date": 1505926855, "last_edit_date": 1505926855, "creation_date": 1505926432, "answer_id": 46327752, "question_id": 46324018, "link": "https://stackoverflow.com/questions/46324018/temperature-sensor-not-working/46327752#46327752", "title": "Temperature sensor not working", "body": "<p>Some things to try that might get you going....</p>\n\n<ol>\n<li><p>First increase the counter \"counter++>10000\" to something much larger, It could be that the new processor you are running increments the counter at a much faster rate and you just timeout before the pin drops.</p></li>\n<li><p>If that doesn't work remove the timeout counter and loop forever in your source, also remove the sensor, then physically pull the data line to ground with a piece of wire and see if your code/new processor catches the signal change, at least then you know your source/hardware is configured correctly so you can focus your efforts elsewhere. </p></li>\n<li><p>Double check the voltage compatibility between your new processor 'high' level and what the sensors 'high' threshold is to ensure it is catching a 'one' on the data line.</p></li>\n<li><p>Lettus know how you go!</p></li>\n</ol>\n\n<p>Tony</p>\n"}], "owner": {"reputation": 70, "user_id": 8103113, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/9c2b4dc708a17e38d50406f3f1f8aa91?s=128&d=identicon&r=PG&f=1", "display_name": "Lomezno", "link": "https://stackoverflow.com/users/8103113/lomezno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "closed_date": 1505988721, "accepted_answer_id": 46327752, "answer_count": 1, "score": -1, "last_activity_date": 1505926855, "creation_date": 1505915672, "last_edit_date": 1505915845, "question_id": 46324018, "link": "https://stackoverflow.com/questions/46324018/temperature-sensor-not-working", "closed_reason": "Not suitable for this site", "title": "Temperature sensor not working", "body": "<p>Greetins,</p>\n\n<p>I recently bought a temperature &amp; humidity sensor (aosong am2302). I hooked it to a rasp pi 3 and it works like charm with the adafruit library. The problem comes when i try to make it work on another board (described <a href=\"https://itronriva.com/article/itron-riva-edge-design-guide/\" rel=\"nofollow noreferrer\">here</a>). I used <a href=\"https://github.com/jackmitch/libsoc\" rel=\"nofollow noreferrer\">this library</a> for gpio reading. I modified the file of beaglebone for gpio mapping and that's it. I run the tests and they work, so basically the lib looks like it works. So after that, I code the sensor reader and it doesnt work and I dont know why. \nAfter I run the sensor reader, If I check the file system, the gpio is exported.</p>\n\n<p>The sensor is installed like this: \n-Power to 5V (also tried with 3.3v)\n-VCC to gpio\n-Ground to GND.</p>\n\n<p>and here the code</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;sys/time.h&gt;\n\n#include \"libsoc_gpio.h\" //library for gpio reading\n\n#define MAXTIMINGS 10\n#define SILENT 0 \n\nint bits[MAXTIMINGS+1],data[5];\nint readDHT(int pin,int allowRetry);\n\nint\nmain(int argc, char **argv)\n{   int dhtpin;\n    if (argc&gt;1)dhtpin=atoi(argv[1]);\n    else printf(\"Introduce pin\");\n\n    if( SILENT &lt; 1 ) {\n        printf(\"Using pin #%d\\n\", dhtpin);\n    }\n    readDHT(dhtpin,5);\n    return 0;\n}\n\n\nint\nreadDHT(int pin, int allowRetry)\n{\n    int bitidx=0;\n    int counter = 0;\n    int i=0,j=0;\n    data[0] = data[1] = data[2] = data[3] = data[4] = 0;\n\n    gpio *gpio_output = libsoc_gpio_request(pin, LS_SHARED); //export GPIO\n\n    if (gpio_output == NULL)\n    {\n        fprintf(stderr, \"Failed to open GPIO %d\\n\", pin);\n        return -1;\n    }\n\n    libsoc_gpio_set_direction(gpio_output, OUTPUT); \n    if (libsoc_gpio_get_direction(gpio_output) != OUTPUT)\n    {\n        fprintf(stderr, \"Failed to set direction to OUTPUT\\n\");\n        if (gpio_output)\n        {\n            libsoc_gpio_free(gpio_output);\n        }\n        return -1;\n    }\n\n    libsoc_gpio_set_level(gpio_output, LOW);\n    libsoc_gpio_set_level(gpio_output, HIGH);\n\n    libsoc_gpio_set_direction(gpio_output, INPUT);\n\n    /* Wait for pin to drop */\n    while (libsoc_gpio_get_level(gpio_output) == HIGH)\n    {\n        if(counter++&gt;10000){\n            printf(\"ERROR: Pin never dropped\\n\");\n            return 1;\n        }\n    }\n    if (i&lt;= MAXTIMINGS)\n    {\n        counter =0;\n        while (libsoc_gpio_get_level(gpio_output) == LOW){\n            if(counter++ == 1000)\n                break;\n        }\n        counter =0;\n        while(libsoc_gpio_get_level(gpio_output) == HIGH){\n            if (counter++==1000)\n                break;\n        }\n        bits[bitidx++] = counter;\n        i++;\n    }\n\n\n    /* read data */\n    for (i = 1; i &lt; bitidx; i++) {\n        data[j / 8] &lt;&lt;= 1;\n        if(bits[i]&gt;200){\n            data[j/8] |= 1;\n        }\n        j++;\n    }\n    if( SILENT &lt; 1 ) {\n        printf(\"Data (%d): 0x%x 0x%x 0x%x 0x%x 0x%x\\n\", j, data[0], data[1], data[2], data[3], data[4]);\n    }\n    if ((j &gt;= 39) &amp;&amp; (data[4] == ((data[0] + data[1] + data[2] + data[3]) &amp; 0xFF)) ) {\n\n\n            float f, h;\n            h = data[0] * 256 + data[1];\n            h /= 10;\n\n            f = (data[2] &amp; 0x7F)* 256 + data[3];\n                f /= 10.0;\n                if (data[2] &amp; 0x80)  f *= -1;\n            printf(\"CTemp: %.1f\\nFTemp: %.1f\\nHum: %.1f%\\n\", f, ((f*9)/5)+32, h);\n        } else if( allowRetry &gt; 0 ) {\n            sleep(1);\n            if( SILENT &lt; 1 ) {\n            printf( \"Error getting information. Retrying\\n\" );\n            }\n            return readDHT(pin, --allowRetry );\n        } else {\n            if( SILENT &lt; 1 ) {\n            printf( \"Error getting information. Retries exhausted.\\n\" );\n            }\n            return 1;\n        }\n\n        return 0;\n\n    if (gpio_output)\n    {\n        libsoc_gpio_free(gpio_output);\n    }\n\n    /* Check we got all the data and checksum matches */\n}\n</code></pre>\n\n<p>With this code I get \"Pin never dropped\", so pin never goes to 0 so it doesnt report data. So i decided to try with bash and see if pin drops to 0. I coded the same as on the previous code but in bash and see the value of the pin (always 1, not dropping). Comming to this point, I run out of options, the sensor works (it's not broken), the library works but the sensor on this machine no. Any clue or idea on how to approach to find a solution?</p>\n\n<p>Thanks :)</p>\n"}, {"tags": ["c", "input", "segmentation-fault", "stdin"], "comments": [{"owner": {"reputation": 3483, "user_id": 3932569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bca364f93a9dfab17419b31a8a1a504?s=128&d=identicon&r=PG&f=1", "display_name": "Garf365", "link": "https://stackoverflow.com/users/3932569/garf365"}, "edited": false, "score": 4, "creation_date": 1505914222, "post_id": 46323403, "comment_id": 79607563, "body": "<code>first</code> is only a pointer, it doesn&#39;t have any memory =&gt; use of malloc or raw array"}, {"owner": {"reputation": 391, "user_id": 7157651, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/864161088d214f8a54c58acd9a07f68f?s=128&d=identicon&r=PG&f=1", "display_name": "zuzu", "link": "https://stackoverflow.com/users/7157651/zuzu"}, "reply_to_user": {"reputation": 3483, "user_id": 3932569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bca364f93a9dfab17419b31a8a1a504?s=128&d=identicon&r=PG&f=1", "display_name": "Garf365", "link": "https://stackoverflow.com/users/3932569/garf365"}, "edited": false, "score": 0, "creation_date": 1505914399, "post_id": 46323403, "comment_id": 79607709, "body": "I changed it to an array of size 100 and it works. Thank you!"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1505914442, "post_id": 46323403, "comment_id": 79607746, "body": "Also, the newline that is written to stdin when you hit the enter key may cause problems with subsequent calls to <code>sscanf</code>.  Include a space in the first part of your format string to consume the <code>\\n</code>: <code>sscanf(first,&quot; %d&quot;, &amp;firstNum);</code>"}, {"owner": {"reputation": 3483, "user_id": 3932569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bca364f93a9dfab17419b31a8a1a504?s=128&d=identicon&r=PG&f=1", "display_name": "Garf365", "link": "https://stackoverflow.com/users/3932569/garf365"}, "edited": false, "score": 0, "creation_date": 1505916541, "post_id": 46323403, "comment_id": 79609343, "body": "Also, because I can guess you&#39;re a beginner, best tool than log (ie printf) to see if a software works well and if not finding where is the bug, is the debugger. Debugger is design to find bug. BUT, it is also a really good tools to learn, specially c: you can run step by step your soft and see what&#39;s happen"}], "answers": [{"tags": [], "owner": {"reputation": 313, "user_id": 2105501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45c64e49a69a60a94328fe105e936a3d?s=128&d=identicon&r=PG", "display_name": "Idan", "link": "https://stackoverflow.com/users/2105501/idan"}, "is_accepted": true, "score": 4, "last_activity_date": 1505914668, "creation_date": 1505914668, "answer_id": 46323622, "question_id": 46323403, "link": "https://stackoverflow.com/questions/46323403/taking-input-from-stdin-segmentation-fault/46323622#46323622", "title": "Taking input from stdin segmentation fault", "body": "<p>first and second should be arrays and not pointers.\nBoth of your pointers point to some place in the memory, and when accessing them \"as arrays\" you override different memory.</p>\n\n<p>change:</p>\n\n<pre><code>char *first;\nchar *second;\n</code></pre>\n\n<p>To be:</p>\n\n<pre><code>char first[128] ={0};\nchar second[128] ={0};\n</code></pre>\n\n<p>As well, read the following:\n<a href=\"http://www.geeksforgeeks.org/difference-pointer-array-c/\" rel=\"nofollow noreferrer\">http://www.geeksforgeeks.org/difference-pointer-array-c/</a>\nIt explains about the difference between array and pointer in a very clear way.</p>\n"}], "owner": {"reputation": 391, "user_id": 7157651, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/864161088d214f8a54c58acd9a07f68f?s=128&d=identicon&r=PG&f=1", "display_name": "zuzu", "link": "https://stackoverflow.com/users/7157651/zuzu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 287, "favorite_count": 0, "accepted_answer_id": 46323622, "answer_count": 1, "score": 0, "last_activity_date": 1505914668, "creation_date": 1505914071, "last_edit_date": 1505914226, "question_id": 46323403, "link": "https://stackoverflow.com/questions/46323403/taking-input-from-stdin-segmentation-fault", "title": "Taking input from stdin segmentation fault", "body": "<p>An expected input for the code I'm trying to run looks something like this:</p>\n\n<p>(i,j) where i and j are integers. (Ex. (1,2), (10,21), etc).</p>\n\n<p>I need to store the both integers in int variables.</p>\n\n<p>This is what I did:</p>\n\n<pre><code>    getchar(); // gets open parenthesis\n\n    // gets first num\n    char *first;\n    int z = 0;\n    int a;\n\n    while((a = getchar()) != ',') {\n        first[z] = a;\n        z++;\n    }\n    int firstNum;\n    sscanf(first, \"%d\", &amp;firstNum);\n    printf(\"%d\\n\", firstNum); //checking if got correct num\n\n    // gets second num\n    char *second;\n    int y = 0;\n    int b;\n    while((b = getchar()) != ')') {\n        second[y] = b;\n        y++;\n    }\n    int secondNum;\n    sscanf(second, \"%d\", &amp;secondNum);\n    printf(\"%d\\n\", secondNum); //checking if got correct num\n</code></pre>\n\n<p>It works to get the first number. But, when I did it for the second number, I got a segmentation fault and I can't figure out why? I basically just redid the process of getting the first number?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1505913964, "post_id": 46323266, "comment_id": 79607324, "body": "The first element cannot be padded, therefore <code>&amp;vec.x == vec.vals</code> even without the packing. As for accessing the member, reading any non-active member is UB in C++ but does what you think on most (all) compilers"}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 4, "creation_date": 1505913997, "post_id": 46323266, "comment_id": 79607352, "body": "Are you asking about C or C++? They have different wording for unions. And is this limited to compilers supporting <code>#pragma pack</code>?"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1505914191, "post_id": 46323266, "comment_id": 79607526, "body": "<code>write</code> <i>from</i> <code>v.x and...</code> or <code>write</code> <i>to</i> <code>v.x and...</code>"}, {"owner": {"reputation": 133051, "user_id": 501250, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c39ae7fe43cf30bc0f4d4051defcbd87?s=128&d=identicon&r=PG", "display_name": "cdhowie", "link": "https://stackoverflow.com/users/501250/cdhowie"}, "edited": false, "score": 3, "creation_date": 1505914511, "post_id": 46323266, "comment_id": 79607794, "body": "Remember that undefined behavior has implications for the optimizer, too.  Even though <code>&amp;vec.x == &amp;vec.vals[0]</code>, the optimizer might assume you aren&#39;t going to use both at once. If a bit of code writes through one and reads through the other, the compiler may assume that the read can be optimized away since the behavior for that operation isn&#39;t defined."}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 0, "creation_date": 1505914547, "post_id": 46323266, "comment_id": 79607821, "body": "In C++ you could use a small accessor function <code>float&amp; x() { return vals[0]; }</code>. It <i>would</i> force you to write <code>v.x()</code> instead of <code>v.x</code> but would work correctly without any unions or non-portable hacks."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1505914613, "post_id": 46323266, "comment_id": 79607869, "body": "I really don&#39;t see any point worrying about the standard if you use compiler specific support. Just rely on the compiler documentation."}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 0, "creation_date": 1505914835, "post_id": 46323266, "comment_id": 79608038, "body": "The rules are different in c++ and c. choose one."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 0, "creation_date": 1505915381, "post_id": 46323266, "comment_id": 79608507, "body": "@RichardHodges And suppose the OP is interested in the difference between C and C++, since they are indeed different in this case. Then it is perfectly fine to use both language tags."}, {"owner": {"reputation": 837, "user_id": 2556973, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8367c78e6734853cb3157761f2eea3b5?s=128&d=identicon&r=PG", "display_name": "zac", "link": "https://stackoverflow.com/users/2556973/zac"}, "edited": false, "score": 0, "creation_date": 1505918178, "post_id": 46323266, "comment_id": 79610522, "body": "@All above. Yes, I&#39;m interested in the difference between C and C++. I was hoping to understand in which places all the &quot;variables&quot; (i.e. compilers, language, standard) agreed (which, I was hoping, was most places :P ) - and in which places they disagreed."}], "answers": [{"comments": [{"owner": {"reputation": 837, "user_id": 2556973, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8367c78e6734853cb3157761f2eea3b5?s=128&d=identicon&r=PG", "display_name": "zac", "link": "https://stackoverflow.com/users/2556973/zac"}, "edited": false, "score": 0, "creation_date": 1505918789, "post_id": 46323681, "comment_id": 79610994, "body": "Great answer. Clearly indicates the differences. Now, if only msvc supported C11, the world would be a happy place."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 837, "user_id": 2556973, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8367c78e6734853cb3157761f2eea3b5?s=128&d=identicon&r=PG", "display_name": "zac", "link": "https://stackoverflow.com/users/2556973/zac"}, "edited": false, "score": 0, "creation_date": 1505920200, "post_id": 46323681, "comment_id": 79612043, "body": "@zac I quoted C11 because it is the current standard. C99 is identical when it comes to this. C89 was also the same although the wording was bad and could be misunderstood. Though I&#39;m guessing the world would be a happier place if msvc supported <i>any</i> form of C standard. The C89 support is sometimes questionable, the C99 support incomplete at best, and C11 support non-existent."}, {"owner": {"reputation": 837, "user_id": 2556973, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8367c78e6734853cb3157761f2eea3b5?s=128&d=identicon&r=PG", "display_name": "zac", "link": "https://stackoverflow.com/users/2556973/zac"}, "edited": false, "score": 0, "creation_date": 1505922169, "post_id": 46323681, "comment_id": 79613603, "body": "There we go, learn something new. I thought the footnote 95 you mentioned was only added in C11 for clarity."}, {"owner": {"reputation": 837, "user_id": 2556973, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8367c78e6734853cb3157761f2eea3b5?s=128&d=identicon&r=PG", "display_name": "zac", "link": "https://stackoverflow.com/users/2556973/zac"}, "edited": false, "score": 0, "creation_date": 1505922359, "post_id": 46323681, "comment_id": 79613738, "body": "(In fact, I&#39;m looking at it now, and it doesn&#39;t have it :S)"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 837, "user_id": 2556973, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8367c78e6734853cb3157761f2eea3b5?s=128&d=identicon&r=PG", "display_name": "zac", "link": "https://stackoverflow.com/users/2556973/zac"}, "edited": false, "score": 0, "creation_date": 1505976773, "post_id": 46323681, "comment_id": 79634201, "body": "@zac Alright, but the footnote is just a clarification, it isn&#39;t normative."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 6, "last_activity_date": 1505915231, "last_edit_date": 1505915231, "creation_date": 1505914825, "answer_id": 46323681, "question_id": 46323266, "link": "https://stackoverflow.com/questions/46323266/packing-and-pointer-aliasing-c-and-c/46323681#46323681", "title": "Packing and pointer aliasing, C and C++", "body": "<blockquote>\n  <ol>\n  <li>I believe I am guaranteed (via #pragma compiler documentation, not language guarantee) that sizeof(vec) == 3*sizeof(float)</li>\n  </ol>\n</blockquote>\n\n<p>Yes that's correct, assuming the <code>#pragma</code> disabled padding entirely.</p>\n\n<hr>\n\n<blockquote>\n  <ol start=\"2\">\n  <li>As such, I believe I am guaranteed that &amp;vec.x == &amp;vec.vals[0], ect.</li>\n  </ol>\n</blockquote>\n\n<p>This is guaranteed regardless of padding, because there can never be padding at the beginning of the struct/union. See for example C11 6.7.2.1 \u00a715: </p>\n\n<blockquote>\n  <p>There may be unnamed padding within a structure object, but not at its beginning.</p>\n</blockquote>\n\n<p>This holds true for all versions of the C standard, and as far as I know, also for all versions of the C++ standard.</p>\n\n<hr>\n\n<blockquote>\n  <ol start=\"3\">\n  <li>However, I am unsure if it is legal (that is, not allowed via strict aliasing), to write from v.x and then read from v.vals[0]</li>\n  </ol>\n</blockquote>\n\n<p>This is fine in C but undefined behavior in C++. </p>\n\n<p>In C, the <code>.</code>/<code>-&gt;</code> operator guarantees this, C11 6.5.2.3:</p>\n\n<blockquote>\n  <p>A postfix expression followed by the . operator and an identifier designates a member of\n  a structure or union object. The value is that of the named member,95) and is an lvalue if the first expression is an lvalue. </p>\n</blockquote>\n\n<p>Where footnote 95 (informative, not normative) says:</p>\n\n<blockquote>\n  <p>95) If the member used to read the contents of a union object is not the same as the member last used to\n  store a value in the object, the appropriate part of the object representation of the value is reinterpreted\n  as an object representation in the new type as described in 6.2.6 (a process sometimes called \u2018\u2018type\n  punning\u2019\u2019). This might be a trap representation.</p>\n</blockquote>\n\n<p>C++ have no guarantees like this, so \"type punning\" through unions is undefined behavior in C++. This is a major difference between the two languages.</p>\n\n<p>Furthermore, C has the concept of <em>common initial sequence</em> for unions, also specified in C11 6.5.2.3:</p>\n\n<blockquote>\n  <p>One special guarantee is made in order to simplify the use of unions: if a union contains\n  several structures that share a common initial sequence (see below), and if the union\n  object currently contains one of these structures, it is permitted to inspect the common\n  initial part of any of them anywhere that a declaration of the completed type of the union\n  is visible. Two structures share a <em>common initial sequence</em> if corresponding members have compatible types (and, for bit-fields, the same widths) for a sequence of one or more\n  initial members.</p>\n</blockquote>\n\n<hr>\n\n<p>It is true that the array and the struct in your example may alias, because of the part you cited \"an aggregate or union type that includes one of the aforementioned types among its members\". So writing to the struct and then reading that data through the array does not violate strict aliasing, neither in C nor C++.</p>\n\n<p><em>However</em>, C++ has the concept of \"active member\" when dealing with unions, so in C++ this would give poorly-specified behavior for other reasons than aliasing - namely that C++ only guaranteed that the last written member of the union can be safely read.</p>\n"}], "owner": {"reputation": 837, "user_id": 2556973, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8367c78e6734853cb3157761f2eea3b5?s=128&d=identicon&r=PG", "display_name": "zac", "link": "https://stackoverflow.com/users/2556973/zac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 362, "favorite_count": 0, "accepted_answer_id": 46323681, "answer_count": 1, "score": 5, "last_activity_date": 1505915231, "creation_date": 1505913781, "question_id": 46323266, "link": "https://stackoverflow.com/questions/46323266/packing-and-pointer-aliasing-c-and-c", "title": "Packing and pointer aliasing, C and C++", "body": "<pre><code>union vec\n{\n#pragma pack(push,1)\n   struct\n   {\n      float x, y, z;\n   }\n#pragma pack(pop)\n   float vals[3];\n};\n</code></pre>\n\n<p>Consider the above definition. (Anonymous unions in C99 aside)</p>\n\n<p>I suppose this answer possibly permits different answers depending on choice of compiler, choice of language, and choice of standard.</p>\n\n<ol>\n<li>I believe I am guaranteed (via #pragma compiler documentation, not language guarantee) that <code>sizeof(vec) == 3*sizeof(float)</code></li>\n<li>As such, I believe I am guaranteed that <code>&amp;vec.x == &amp;vec.vals[0]</code>, ect.</li>\n<li>However, I am unsure if it is legal (that is, not allowed via strict aliasing), to write from <code>v.x</code> and then read from <code>v.vals[0]</code></li>\n</ol>\n\n<p>Packing aside, I believe the relevant verbiage (from the C99 standard, at least) is:</p>\n\n<blockquote>\n  <ul>\n  <li><p>a type compatible with the effective type of the object,</p></li>\n  <li><p>an aggregate or union type that includes one of the aforementioned\n  types among its members (including, recursively, a member of a\n  subaggregate or contained union), or</p></li>\n  </ul>\n</blockquote>\n"}, {"tags": ["c", "linux", "cd"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1505916236, "post_id": 46323265, "comment_id": 79609130, "body": "Eventually, you&#39;ll realize that the system call doesn&#39;t support the various <code>~</code> notations or the plain <code>cd</code> to change to the <code>$HOME</code> directory. The shell has to manage those too. Also look up the <code>cd</code> command on POSIX to see the difference between logical (<code>-L</code>) and physical (<code>-P</code>) variants.  That&#39;s for (much) later, though."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1506117158, "post_id": 46323265, "comment_id": 79706932, "body": "Why are you stripping a trailing <code>&#39;\\n&#39;</code>? I&#39;d say that should be the caller&#39;s responsibility. Believe it or not, it&#39;s perfectly legal to have a directory name ending in <code>&#39;\\n&#39;</code>. Also, your function prints an error message to <code>stderr</code> if it fails, but it doesn&#39;t inform the caller of any error."}], "answers": [{"tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": true, "score": 1, "last_activity_date": 1505914298, "creation_date": 1505914298, "answer_id": 46323494, "question_id": 46323265, "link": "https://stackoverflow.com/questions/46323265/c-function-cd-representation-not-working/46323494#46323494", "title": "C function - cd representation not working", "body": "<p><code>-</code> is not supported by the C library <code>chdir</code>, but only by the shell <code>cd</code> command.</p>\n\n<p>To be able to use this feature in a C program, you have to emulate it. For instance by storing the current path before performing a <code>chdir</code>:</p>\n\n<pre><code>void cd(char *path) {\n    int ret;\n    // used to store the previous path\n    static char old_path[MAX_PATH_LEN] = \"\";\n\n    if (strlen (path) &gt; 0) {\n        if (path[strlen (path) - 1] == '\\n') {\n            path[strlen (path) - 1] = '\\0';\n        }\n    }\n    if (!strcmp(path,\"-\"))\n    {\n        // - special argument: use previous path\n        if (old_path[0]=='\\0')\n        {\n           // no previous path: error\n           return -1;\n        }\n        path = old_path;  // use previous path\n    }\n    else\n    {   \n        // memorize current path prior to changing\n        strcpy(old_path,getcwd());\n    }\n    ret = chdir(path);\n    if(ret == -1) {\n        perror(\"changing directory failed:\");\n    }\n}\n</code></pre>\n\n<p>It may be need tuning in case the user uses <code>-</code> twice, maybe a stack of paths could be used, but the principle is there.</p>\n"}], "owner": {"reputation": 69, "user_id": 8553237, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6034900546d56a8f14ae45ef124ab6a3?s=128&d=identicon&r=PG&f=1", "display_name": "Frans", "link": "https://stackoverflow.com/users/8553237/frans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 46323494, "answer_count": 1, "score": 1, "last_activity_date": 1506115896, "creation_date": 1505913779, "question_id": 46323265, "link": "https://stackoverflow.com/questions/46323265/c-function-cd-representation-not-working", "title": "C function - cd representation not working", "body": "<pre><code>void cd(char *path) {\n    int ret;\n    if (strlen (path) &gt; 0) {\n        if (path[strlen (path) - 1] == '\\n') {\n            path[strlen (path) - 1] = '\\0';\n        }\n    }\n    ret = chdir(path);\n    if(ret == -1) {\n        perror(\"changing directory failed:\");\n    }\n}\n</code></pre>\n\n<p>This is my cd function that is supposed to represent a simple version of the cd function in linux, it works if I want to go into a directory but if I want to go back it does not work to use \"cd -\", anyone that knows how to fix this?</p>\n"}, {"tags": ["c", "fork"], "comments": [{"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1505914055, "post_id": 46323235, "comment_id": 79607411, "body": "are you sure you want separate processes rather than threads?"}, {"owner": {"reputation": 41, "user_id": 5404596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b41ab84a04332b2606c449aff9d0dc8f?s=128&d=identicon&r=PG&f=1", "display_name": "Space", "link": "https://stackoverflow.com/users/5404596/space"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1505916029, "post_id": 46323235, "comment_id": 79608972, "body": "@ChrisTurner, yes, trying to avoid pthread"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1505916922, "post_id": 46323235, "comment_id": 79609626, "body": "Your parent process should not execute the function;  only the children should.  Don&#39;t forget to wait for the children to die before exiting."}, {"owner": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "edited": false, "score": 0, "creation_date": 1505920604, "post_id": 46323235, "comment_id": 79612353, "body": "@Space why avoiding pthreads?"}], "answers": [{"tags": [], "owner": {"reputation": 613, "user_id": 5777453, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh3.googleusercontent.com/-4uw5MGjv0bc/AAAAAAAAAAI/AAAAAAAAErE/1e-03RNGDho/photo.jpg?sz=128", "display_name": "Shameel Mohamed", "link": "https://stackoverflow.com/users/5777453/shameel-mohamed"}, "is_accepted": false, "score": 0, "last_activity_date": 1505916953, "creation_date": 1505916953, "answer_id": 46324503, "question_id": 46323235, "link": "https://stackoverflow.com/questions/46323235/using-fork-to-run-mutltiple-tasks/46324503#46324503", "title": "Using fork() to run mutltiple tasks", "body": "<p>According to your logic, you would be able to cover only till 5000 words (according to your wordsize of 1000) even though you will have 8 duplicate processes running.</p>\n\n<p>I suppose you want help with the logic. A bit tweak of your for loop would do the trick :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include  &lt;sys/types.h&gt; //pid_t\nvoid doSomething(const int start, const int end){\n    printf(\"%d. Doing %d to %d \\n\", getpid(), start, end);\n}\n\nint main(){\n\n    int word_size = 10000;\n\n    for(int i=0; i&lt;=6; i=i+2){        //the tweaks\n        pid_t pid;\n        pid = fork();\n        if(pid == 0){\n            doSomething((i)*(word_size/8), (i+1)*(word_size/8));\n        }\n        else {\n            doSomething((i+1)*(word_size/8), (i+2)*(word_size/8));\n        }\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Hope this helps</p>\n"}, {"comments": [{"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1505923278, "post_id": 46326306, "comment_id": 79614402, "body": "possibly need to do something if <code>fork</code> returns -1, like break out of the loop? Or at least, not call <code>waitpid</code> for any failed children."}, {"owner": {"reputation": 41, "user_id": 5404596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b41ab84a04332b2606c449aff9d0dc8f?s=128&d=identicon&r=PG&f=1", "display_name": "Space", "link": "https://stackoverflow.com/users/5404596/space"}, "edited": false, "score": 0, "creation_date": 1505931641, "post_id": 46326306, "comment_id": 79619284, "body": "@Serge, thanks for the comment. However, it appears this doesn&#39;t work either. Basically, I get a lot of processes, repeating the same work.   Result: <a href=\"https://pastebin.com/9g5Qy3CL\" rel=\"nofollow noreferrer\">pastebin.com/9g5Qy3CL</a>"}, {"owner": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "edited": false, "score": 0, "creation_date": 1505932266, "post_id": 46326306, "comment_id": 79619647, "body": "You would need to make sure that your <code>doSomething</code> does not return, but exits. Or you can do it directly in the loop. I will edit the answer."}, {"owner": {"reputation": 41, "user_id": 5404596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b41ab84a04332b2606c449aff9d0dc8f?s=128&d=identicon&r=PG&f=1", "display_name": "Space", "link": "https://stackoverflow.com/users/5404596/space"}, "edited": false, "score": 0, "creation_date": 1505932437, "post_id": 46326306, "comment_id": 79619742, "body": "Like adding exit(0) after the call to doSomething? Going to try that!"}], "tags": [], "owner": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "is_accepted": true, "score": 2, "last_activity_date": 1505932444, "last_edit_date": 1505932444, "creation_date": 1505921800, "answer_id": 46326306, "question_id": 46323235, "link": "https://stackoverflow.com/questions/46323235/using-fork-to-run-mutltiple-tasks/46326306#46326306", "title": "Using fork() to run mutltiple tasks", "body": "<p>You are not really splitting it in 8 even parts. You are just starting 4 parallel processes and execute other 4 parts sequentially in the main thread. Also, you exit your main thread as soon as you done and let your parallel processes to finish at their leisure. So, in reality you would need something like the following:</p>\n\n<pre><code>    pid_t pid[8];\n    for (int i = 0; i &lt; 8; i++) {\n        pid[i] = fork();\n        if(pid[i] == 0){\n            doSomething((i)*(word_size/8), (i+1)*(word_size/8));\n            return 0;  // or exit(0);\n        }\n   }\n</code></pre>\n\n<p>Note that after forking, the child process should not return to the loop. I added teh <code>return 0;</code> statement to return from the <code>main</code> at this point. Or yuo can use <code>exit(0);</code> if this is not a main routing. I think that the most logical would be using <code>exit(0);</code> in the <code>doSomething</code> function.  </p>\n\n<p>now you have all pids of all process you started. you need to wait in the main thread till all of them finish (unless you really want to let them run on their own. Something like the following:</p>\n\n<pre><code>for (int i = 0; i &lt; 8; i++) {\n     int status;\n     waitpid(pid[i], &amp;status, WNOHANG);\n}\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 5404596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b41ab84a04332b2606c449aff9d0dc8f?s=128&d=identicon&r=PG&f=1", "display_name": "Space", "link": "https://stackoverflow.com/users/5404596/space"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 46326306, "answer_count": 2, "score": -1, "last_activity_date": 1505932444, "creation_date": 1505913707, "question_id": 46323235, "link": "https://stackoverflow.com/questions/46323235/using-fork-to-run-mutltiple-tasks", "title": "Using fork() to run mutltiple tasks", "body": "<p>Trying to run 'tasks' in parallel but (obviously) I am failing miserably.</p>\n\n<p>What I want it to do: split the size into 8 different (equal size) tasks and \"doSomething\" on them simultaneously.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include  &lt;sys/types.h&gt; //pid_t\nvoid doSomething(const int start, const int end){\n    printf(\"%d. Doing %d to %d \\n\", getpid(), start, end);\n}\n\nint main(){\n\n    int word_size = 10000;\n\n    for(int i=0; i&lt;3; i++){\n        pid_t pid;\n        pid = fork();\n        if(pid == 0){\n            doSomething((i)*(word_size/8), (i+1)*(word_size/8));\n        }\n        else {\n            doSomething((i+1)*(word_size/8), (i+2)*(word_size/8));\n        }\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Any help would be appreciated.</p>\n"}, {"tags": ["c", "dependencies", "relationships", "topological-sort"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1505916387, "post_id": 46323227, "comment_id": 79609235, "body": "This requires a topological sort.  The equivalent question was asked yesterday. There&#39;s a tag <a href=\"https://stackoverflow.com/questions/tagged/topological-sort\">topological-sort</a> you can search for inspiration."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1505916619, "post_id": 46323227, "comment_id": 79609413, "body": "Note that your sample data is conflated with your expected output, and the sample data doesn&#39;t match your specification.  Since there are 3 nodes, you can&#39;t have a 3 in the dependency lines."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1505934235, "post_id": 46323227, "comment_id": 79620675, "body": "it is a poor programming practice to <code>#include</code> header files those contents are not used.  In this case the header file: <code>string.h</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1505934343, "post_id": 46323227, "comment_id": 79620744, "body": "for ease of readability and understanding: 1) separate code blocks (for, if, else, while, do...while, switch, case, default) via a single blank line. 2) follow the axiom: <i>only one statement per line and (at most) one variable declaration per statement.</i> 3) place appropriate horizontal spacing inside parens, after commas and semicolons, inside square brackets"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1505934380, "post_id": 46323227, "comment_id": 79620766, "body": "when calling any of the <code>scanf()</code> family of functions, always check the returned value (not the parameter values) to assure the operation was successful."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1505934469, "post_id": 46323227, "comment_id": 79620791, "body": "variable names should indicate <code>content</code> or <code>usage</code> (or better, both).  names like <code>n</code>, <code>k</code>, even in the current context are meaningless"}], "owner": {"reputation": 79, "user_id": 8641595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/527b3ac4de37b51fd160dcdc36aeb482?s=128&d=identicon&r=PG&f=1", "display_name": "Reddy90", "link": "https://stackoverflow.com/users/8641595/reddy90"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1505916449, "creation_date": 1505913683, "last_edit_date": 1505916449, "question_id": 46323227, "link": "https://stackoverflow.com/questions/46323227/finding-the-correct-order-from-a-set-of-dependencies", "title": "Finding the correct order from a set of dependencies", "body": "<p>so here's my problem:\nInput:\nN, the total number of steps in the first line. Each step is implicitly numbered from 0 to N-1. A number K in the second line. Then the next K lines contain 2 integers each. Each such line represents a dependency: If \"X Y\" is in a line, then step X must necessarily be performed before step Y.</p>\n\n<p>Output:\nOne line containing the steps in the correct order. If multiple such correct orders are possible, then print the one in which the smaller numbers come as early as possible.</p>\n\n<p>Example:</p>\n\n<pre><code>3\n\n2\n\n1 0\n\n0 3\n\n1 0 3\n</code></pre>\n\n<p>Here's my code so far. I dont know how to compare the elements after sorting them so as to obtain the required format. Any leads would be appreciated .. thanks.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n#include&lt;stdlib.h&gt;\n\nint main(){\n\n    int n,k,i,j,temp,a=2;\n    scanf(\"%d\",&amp;n);\n    scanf(\"%d\",&amp;k);\n    int arr[k][2];\n    int ans[n];\n    for(i=0;i&lt;k;i++)\n        scanf(\"%d %d\",&amp;arr[i][0],&amp;arr[i][1]);\n\n    for(i=0;i&lt;k;i++){\n        for(j=i+1;j&lt;k;j++){\n\n            if(arr[i][0]&gt;arr[j][0]){\n                temp = arr[i][0];\n                arr[i][0] = arr[j][0];\n                arr[j][0] = temp;\n\n                temp = arr[i][1];\n                arr[i][1] = arr[j][1];\n                arr[j][1] = temp;\n            }\n        }\n    }\n    /*\n    for(i=0;i&lt;k;i++)\n        printf(\"%d   %d\\n\",arr[i][0],arr[i][1]);\n    */\n    ans[0] = arr[0][0];\n    ans[1] = arr[0][1];\n\n    /*done[n];\n    for(i=0;i&lt;n;i++)\n        done[i] = 0;\n    done[arr[0][0]] = 1;\n    done[arr[0][1]] = 1;\n    for(i=1;i&lt;k;i++){\n\n        if(done[arr[i][0]] == 0 || done[arr[i]])\n    }\n    */\n\n    for(i=0;i&lt;n;i++)\n        printf(\"%d  \",ans[i]);\n    printf(\"\\n\\n\");\n    return 0;\n}\n</code></pre>\n\n\n"}, {"tags": ["c", "openssl", "undefined-reference", "powerpc"], "comments": [{"owner": {"reputation": 59, "user_id": 8499897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JyNNk.png?s=128&g=1", "display_name": "TreesaL", "link": "https://stackoverflow.com/users/8499897/treesal"}, "reply_to_user": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1505978391, "post_id": 46322246, "comment_id": 79635146, "body": "@jww : what is an <code>xlat</code> file?  (Little clarification) : I don&#39;t need all the files from the opensource code. I need algorithms only from the crypto folder. And as per the customer requirement I will be adding the required .c files to the makefile. Hence, I need to know if there is any way I can make the function definition present in perl files visible to the compiler."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1531016140, "post_id": 46322246, "comment_id": 89436550, "body": "I added a proper answer. Sorry it took so long to loop back to this."}, {"owner": {"reputation": 2037, "user_id": 9812548, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VS24T.jpg?s=128&g=1", "display_name": "Dan Anderson", "link": "https://stackoverflow.com/users/9812548/dan-anderson"}, "edited": false, "score": 0, "creation_date": 1559085059, "post_id": 46322246, "comment_id": 99307176, "body": "The xlat file is not needed unless you use Microsoft Assemblers (for Windows). Xlat translates from Linux/UNIX/GNU assembly language format to Microsoft assembly language format. Basically, the operands are reversed. &quot;mov src,dest&quot; (UNIX) becomes &quot;mov dest,src&quot; (MSFT)"}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 8499897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JyNNk.png?s=128&g=1", "display_name": "TreesaL", "link": "https://stackoverflow.com/users/8499897/treesal"}, "edited": false, "score": 0, "creation_date": 1537004389, "post_id": 51223176, "comment_id": 91633031, "body": "Thank you for taking time to answer this. But unfortunately I am not working on that anymore. But this has given a good insight."}], "tags": [], "owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "is_accepted": true, "score": 3, "last_activity_date": 1559982384, "last_edit_date": 1559982384, "creation_date": 1530966057, "answer_id": 51223176, "question_id": 46322246, "link": "https://stackoverflow.com/questions/46322246/how-the-assembly-file-is-generated-from-the-perl-script-in-openssl/51223176#51223176", "title": "How the assembly file is generated from the perl script in OpenSSL", "body": "<blockquote>\n  <p>How the assembly file is generated from the Perl script in OpenSSL...</p>\n</blockquote>\n\n<p>You are using the <a href=\"https://www.openssl.org/~appro/cryptogams/\" rel=\"nofollow noreferrer\">Cryptogams implementation</a> of AES on Power8. Cryptogams is Andy Polyakov's project to provide high speed cryptography to other developers.</p>\n\n<p>The assembly language file is generated with a xlat program. For the Power8 gear the file is <a href=\"https://github.com/openssl/openssl/tree/master/crypto/perlasm\" rel=\"nofollow noreferrer\"><code>ppc-xlate.pl</code></a> in the <code>perlasm</code> directory. It is used by <a href=\"https://github.com/openssl/openssl/tree/master/crypto/aes/asm\" rel=\"nofollow noreferrer\"><code>aesp8-ppc.pl</code></a> in the <code>crypto/aes/asm</code> directory.</p>\n\n<p>Here is how you translate it. I'm working from <a href=\"https://gcc.gnu.org/wiki/CompileFarm\" rel=\"nofollow noreferrer\">GCC112 on the compile farm</a>, which is ppc64le.</p>\n\n<pre><code>git clone https://github.com/openssl/openssl.git\nmkdir cryptogams\n\ncp ./openssl/crypto/perlasm/ppc-xlate.pl cryptogams/\ncp ./openssl/crypto/aes/asm/aesp8-ppc.pl cryptogams/\n\ncd cryptogams/\nchmod +x *.pl\n\n./aesp8-ppc.pl ppc64le aesp8-ppc.s\n</code></pre>\n\n<p><code>aesp8-ppc.pl</code> generates a pure assembly language source file so name the output file with the little <code>*.s</code>. Sometimes the translation includes C preprocessor statements and it needs a big <code>*.S</code> (but not in this case).</p>\n\n<p>The second argument to <code>aesp8-ppc.pl</code> is called <code>flavor</code>. It is <code>ppc64le</code> in the commands above. Flavor does two things. First, it selects either 32-bit or 64-bit. Second, it selects either little-endian or big-endian. Be sure to get the flavor right.</p>\n\n<p>According to Andy at <a href=\"https://github.com/dot-asm/cryptogams/issues/5\" rel=\"nofollow noreferrer\">ppc8 does not build on powerpc64 big-endian</a>, big-endian PowerPC should use <code>linux64</code>, not <code>linux64be</code>. Little-endian needs <code>linux64le</code>, however.</p>\n\n<p>Once you have <code>aesp8-ppc.s</code> you can compile and assemble the source file with GCC.</p>\n\n<pre><code>gcc -mcpu=power8 -c aesp8-ppc.s\n</code></pre>\n\n<p>And then:</p>\n\n<pre><code>$ objdump --disassemble aesp8-ppc.o\naesp8-ppc.o:     file format elf64-powerpcle\n...\n\n0000000000000420 &lt;aes_p8_set_decrypt_key&gt;:\n     420:       c1 ff 21 f8     stdu    r1,-64(r1)\n     424:       a6 02 48 7d     mflr    r10\n     428:       50 00 41 f9     std     r10,80(r1)\n     42c:       75 fc ff 4b     bl      a0 &lt;aes_p8_set_encrypt_key&gt;\n     430:       a6 03 48 7d     mtlr    r10\n     434:       00 00 03 2c     cmpwi   r3,0\n     438:       68 00 c2 40     bne-    4a0 &lt;Ldec_key_abort&gt;\n     43c:       36 20 07 55     rlwinm  r7,r8,4,0,27\n     440:       10 ff 65 38     addi    r3,r5,-240\n     444:       7e f8 08 55     rlwinm  r8,r8,31,1,31\n     448:       14 3a a3 7c     add     r5,r3,r7\n     44c:       a6 03 09 7d     mtctr   r8\n...\n</code></pre>\n\n<p>At this point you have an object file, but you don't know the API signatures or how to use it. To find out what to do next you have to <code>objdump</code> and then grep the OpenSSL sources to see how they use it.</p>\n\n<pre><code>$ nm aesp8-ppc.o | grep ' T '\n00000000000006c0 T aes_p8_cbc_encrypt\n0000000000001140 T aes_p8_ctr32_encrypt_blocks\n00000000000005c0 T aes_p8_decrypt\n00000000000004c0 T aes_p8_encrypt\n0000000000000420 T aes_p8_set_decrypt_key\n00000000000000a0 T aes_p8_set_encrypt_key\n0000000000001d00 T aes_p8_xts_decrypt\n0000000000001a60 T aes_p8_xts_encrypt\n</code></pre>\n\n<p>You are interested in the four functions <code>aes_p8_set_encrypt_key</code>, <code>aes_p8_set_decrypt_key</code>, <code>aes_p8_encrypt</code> and <code>aes_p8_decrypt</code>. You will use the signatures you find to create a header file for your program.</p>\n\n<p>I'll help you with the first one: <code>aes_p8_set_encrypt_key</code>.</p>\n\n<pre><code>$ cd openssl\n\n# Find aes_p8_set_encrypt_key\n$ grep -nIR aes_p8_set_encrypt_key\ncrypto/evp/e_aes.c:153:# define HWAES_set_encrypt_key aes_p8_set_encrypt_key\n\n# Now look for HWAES_set_encrypt_key\n$ grep -nIR HWAES_set_encrypt_key\n...\ncrypto/evp/e_aes.c:2515:int HWAES_set_encrypt_key(const unsigned char *userKey, const int bits,\n...\n\n# Now find the complete HWAES_set_encrypt_key\n$ cat -n crypto/evp/e_aes.c\n...\n  2515  int HWAES_set_encrypt_key(const unsigned char *userKey, const int bits,\n  2516                            AES_KEY *key);\n</code></pre>\n\n<p>Lather, rinse, repeat for <code>AES_KEY</code>, <code>aes_p8_set_decrypt_key</code>, <code>aes_p8_encrypt</code> and <code>aes_p8_decrypt</code>.</p>\n\n<p>Eventually you will end up with a header like shown in <a href=\"https://wiki.openssl.org/index.php/Cryptogams_AES\" rel=\"nofollow noreferrer\">Cryptogams | AES</a> or <a href=\"https://wiki.openssl.org/index.php/Cryptogams_SHA\" rel=\"nofollow noreferrer\">Cryptogams | SHA</a> on the OpenSSL wiki. <a href=\"https://wiki.openssl.org/index.php/Cryptogams_AES\" rel=\"nofollow noreferrer\">Cryptogams | AES</a> and <a href=\"https://wiki.openssl.org/index.php/Cryptogams_SHA\" rel=\"nofollow noreferrer\">Cryptogams | SHA</a> are written for ARMv4 but the same applies to Power8 as well.</p>\n\n<hr>\n\n<p>Andy dual licenses his work. One license is the OpenSSL license because Andy works for OpenSSL. The second license is a BSD style license that does not have the encumbrances of OpenSSL.</p>\n\n<p>Andy's public source is at <a href=\"https://github.com/dot-asm/cryptogams\" rel=\"nofollow noreferrer\">GitHub | dot-asm</a>. Unfortunately, a lot of Andy's work has not been uploaded so you have to pull it from OpenSSL. And a lot it is not documented so you have to do a fair amount of poking and prodding in the OpenSSL sources.</p>\n\n<p>As far as I know there are two places you can look for documentation on using Cryptogams and Power8 cryptography. First is the OpenSSL wiki pages <a href=\"https://wiki.openssl.org/index.php/Cryptogams_AES\" rel=\"nofollow noreferrer\">Cryptogams | AES</a> and <a href=\"https://wiki.openssl.org/index.php/Cryptogams_SHA\" rel=\"nofollow noreferrer\">Cryptogams | SHA</a>. The tutorials are ARMv4 but it applies to Power 8, too. I wrote the wiki articles so errors and omissions are my mistakes.</p>\n\n<p>The second place to look is GitHub and <a href=\"https://github.com/noloader/POWER8-crypto\" rel=\"nofollow noreferrer\">Noloader | POWER8 crypto</a>. I help maintain Crypto++ and the POWER8 crypto book is my knowledge dump. The POWER8 book includes Cryptogams SHA for PowerPC in Chapter 7.</p>\n\n<p>The POWER8 crypto book was written by Bill Schmidt and I because we could not find documentation when working with AES and SHA on Power8. Bill Schmidt works for IBM and even he could not get the docs. All we could find was a blog post from an IBM engineer that was grossly missing details.</p>\n"}], "owner": {"reputation": 59, "user_id": 8499897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JyNNk.png?s=128&g=1", "display_name": "TreesaL", "link": "https://stackoverflow.com/users/8499897/treesal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1157, "favorite_count": 1, "accepted_answer_id": 51223176, "answer_count": 1, "score": 3, "last_activity_date": 1559982384, "creation_date": 1505910805, "last_edit_date": 1556580397, "question_id": 46322246, "link": "https://stackoverflow.com/questions/46322246/how-the-assembly-file-is-generated-from-the-perl-script-in-openssl", "title": "How the assembly file is generated from the perl script in OpenSSL", "body": "<p>In the opensource code of OpenSSL(version 1.1.0e) I saw that some of the function definition is generated by the perl files present inside the folders.\nIn the build.info file present in each folders inside the crypto, they have written some lines to generate the .s from the corresponding .pl.</p>\n\n<p>For example, for generating <code>aes_p8_set_encrypt_key</code> in <code>crypto/aes/build.info</code>:</p>\n\n<pre><code>GENERATE[aesp8-ppc.s]=asm/aesp8-ppc.pl $(PERLASM_SCHEME)\n</code></pre>\n\n<p>for generating <code>OPENSSL_madd300_probe</code> in <code>crypto/build.info</code> :</p>\n\n<pre><code>GENERATE[ppccpuid.s]=ppccpuid.pl $(PERLASM_SCHEME)\n</code></pre>\n\n<p>And also in the main Makefile(generated makefile), there are some lines as below:</p>\n\n<pre><code>crypto/aes/aes-x86_64.o: crypto/aes/aes-x86_64.s\n$(CC)  -I. -Icrypto/include -Iinclude $(CFLAGS) $(LIB_CFLAGS) -MMD -MF crypto/aes/aes-x86_64.d.tmp -MT $@ -c -o $@ crypto/aes/aes-x86_64.s\n@touch crypto/aes/aes-x86_64.d.tmp\n@if cmp crypto/aes/aes-x86_64.d.tmp crypto/aes/aes-x86_64.d &gt; /dev/null 2&gt; /dev/null; then \\\n    rm -f crypto/aes/aes-x86_64.d.tmp; \\\nelse \\\n    mv crypto/aes/aes-x86_64.d.tmp crypto/aes/aes-x86_64.d; \\\nfi\n</code></pre>\n\n<p>Followed with :</p>\n\n<pre><code>crypto/aes/aes-x86_64.s: crypto/aes/asm/aes-x86_64.pl\nCC=\"$(CC)\" $(PERL) crypto/aes/asm/aes-x86_64.pl $(PERLASM_SCHEME) $@\n</code></pre>\n\n<p>Can anyone explain how the .s is generated from the .pl files?\nI need to add them in my Makefile inside my project, to solve the <code>undefined reference</code> error coming for the functions whose definition is generated by the .pl file.</p>\n"}, {"tags": ["c", "command-line-arguments"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1505910581, "post_id": 46321605, "comment_id": 79604910, "body": "Please format your code correctly, exactly as the samples in your C textbook."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1505910664, "post_id": 46321605, "comment_id": 79604967, "body": "Please <a href=\"https://stackoverflow.com/posts/46321605/edit\">edit</a> your question on tell us what output you expect for what input. Show us some examples."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1505915081, "post_id": 46321605, "comment_id": 79608271, "body": "Welcome to Stack Overflow! Please <a href=\"https://stackoverflow.com/posts/46321605/edit\">edit</a> your question to show us what kind of debugging you&#39;ve done.  I expect you have run your <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> within Valgrind or a similar checker, and to have investigated with a debugger such as GDB, for example.  Ensure you&#39;ve enabled a full set of compiler warnings, too.  What did the tools tell you, and what information are they missing?  And read Eric Lippert&#39;s <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a>."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8641123, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dWcAC.jpg?s=128&g=1", "display_name": "Pranav Karakavalasa", "link": "https://stackoverflow.com/users/8641123/pranav-karakavalasa"}, "edited": false, "score": 0, "creation_date": 1505909417, "post_id": 46321640, "comment_id": 79604020, "body": "I am sorry i am new to command-line arguments, can you please tell me how to give an input through command lines? I use atoi() function when it is an integer, but i am unable to give user defined string or char input from command line. Thank you"}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1505910060, "post_id": 46321640, "comment_id": 79604507, "body": "Do not use <code>atoi</code>, since its behavior on invalid input is not reliable.  Use <code>strtol</code>."}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "reply_to_user": {"reputation": 11, "user_id": 8641123, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dWcAC.jpg?s=128&g=1", "display_name": "Pranav Karakavalasa", "link": "https://stackoverflow.com/users/8641123/pranav-karakavalasa"}, "edited": false, "score": 1, "creation_date": 1505910477, "post_id": 46321640, "comment_id": 79604827, "body": "@PranavKarakavalasa Please post a new actual question, using comments to follow up with something completely different is not how this site works."}], "tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": false, "score": 3, "last_activity_date": 1505909198, "creation_date": 1505909198, "answer_id": 46321640, "question_id": 46321605, "link": "https://stackoverflow.com/questions/46321605/string-or-character-input-from-command-line-in-c/46321640#46321640", "title": "String or character input from command line in C", "body": "<p>You are copying in the wrong direction, the prototype is</p>\n\n<pre><code>char * strcpy(char *destination, const char *source);\n</code></pre>\n\n<p>This is very likely undefined behavior.</p>\n\n<p>Also there's no need to copy the strings, you can process the arguments like any other string.</p>\n"}, {"tags": [], "owner": {"reputation": 57, "user_id": 6003089, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aFNOsZbCOYM/AAAAAAAAAAI/AAAAAAAAAB4/myNB6g0I2eo/photo.jpg?sz=128", "display_name": "Ravinder Singh", "link": "https://stackoverflow.com/users/6003089/ravinder-singh"}, "is_accepted": false, "score": 0, "last_activity_date": 1505912272, "creation_date": 1505912272, "answer_id": 46322741, "question_id": 46321605, "link": "https://stackoverflow.com/questions/46321605/string-or-character-input-from-command-line-in-c/46322741#46322741", "title": "String or character input from command line in C", "body": "<p><code>strcpy</code> function copies the values of second argument to first argument. If you want to use or access the value(<strong>single character</strong>) from the command line argument, then its just like two dimensional array.</p>\n\n<pre><code>argv[1][0]\n</code></pre>\n\n<p>I am thinking you didn't understand the command line argument well. In command line it doesn't mean you type number,character or string. It will always be read as a string. therefore if u have some command to run such as </p>\n\n<pre><code>./file-name 123 a myfile 3.14\n</code></pre>\n\n<p>All above will accessed as follows:</p>\n\n<p><strong>agrv[ 1 ]</strong> is string having <strong>\"123\"</strong>. To access first character(<strong>'1'</strong>) only I will write <strong>argv<a href=\"https://www.tutorialspoint.com/cprogramming/c_command_line_arguments.htm\" rel=\"nofollow noreferrer\">1</a>[0]</strong>.</p>\n\n<p><strong>agrv[2]</strong> is string having <strong>\"a\"</strong>. To access first character(<strong>'a'</strong>) only I will write <strong>argv<a href=\"https://www.tutorialspoint.com/cprogramming/c_command_line_arguments.htm\" rel=\"nofollow noreferrer\">1</a>[0]</strong>.</p>\n\n<p><strong>agrv[3]</strong> is string having <strong>\"myfile\"</strong>. To access first character(<strong>'m'</strong>) only I will write <strong>argv[3][0]</strong>.</p>\n\n<p><strong>agrv[4]</strong> is string having <strong>\"3.14\"</strong>. To access first character(<strong>'3'</strong>) only I will write <strong>argv[4][0]</strong>.</p>\n\n<p>you can also see <a href=\"https://www.tutorialspoint.com/cprogramming/c_command_line_arguments.htm\" rel=\"nofollow noreferrer\">here</a> for more information about command line argument.</p>\n"}, {"tags": [], "owner": {"reputation": 2355, "user_id": 7745946, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/guDLD.png?s=128&g=1", "display_name": "Aashish", "link": "https://stackoverflow.com/users/7745946/aashish"}, "is_accepted": true, "score": 0, "last_activity_date": 1505912814, "creation_date": 1505912814, "answer_id": 46322916, "question_id": 46321605, "link": "https://stackoverflow.com/questions/46321605/string-or-character-input-from-command-line-in-c/46322916#46322916", "title": "String or character input from command line in C", "body": "<p>You don't require to copy the entire string into another one for any manipulations.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main (int argc,char *argv[])\n{\n    if(argc==3)\n    {\n        int i, frequency = 0;\n        for(i = 0; argv[1][i]!= '\\0'; ++i)\n        {\n            if(argv[1][i] == argv[2][0])\n                ++frequency;\n        }\n        printf(\"Frequency of %c = %d\", argv[2][0], frequency);\n\n    }\n    else\n        printf(\"Invalid no of inputs\\n\");\n    return 0;\n}\n</code></pre>\n\n<p><strong>Input:</strong></p>\n\n<pre><code>hello h\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<pre><code>Frequency of h = 1\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1505918331, "post_id": 46323016, "comment_id": 79610653, "body": "&quot;strncpy() can be used to avoid overflows&quot; and also does not insure the destination is a null character terminated string.  Not good advise unless details of proper use are shown."}, {"owner": {"reputation": 4703, "user_id": 5375464, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3292ca87ff6c766b75dbe4b2ea0831da?s=128&d=identicon&r=PG&f=1", "display_name": "J...S", "link": "https://stackoverflow.com/users/5375464/j-s"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1505920440, "post_id": 46323016, "comment_id": 79612232, "body": "@chux I didn&#39;t know that. But thanks to you now I do. Edited."}], "tags": [], "owner": {"reputation": 4703, "user_id": 5375464, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3292ca87ff6c766b75dbe4b2ea0831da?s=128&d=identicon&r=PG&f=1", "display_name": "J...S", "link": "https://stackoverflow.com/users/5375464/j-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1505920793, "last_edit_date": 1505920793, "creation_date": 1505913107, "answer_id": 46323016, "question_id": 46321605, "link": "https://stackoverflow.com/questions/46321605/string-or-character-input-from-command-line-in-c/46323016#46323016", "title": "String or character input from command line in C", "body": "<p>As <a href=\"https://stackoverflow.com/users/28169/unwind\">unwind</a> pointed out, you are copying with <a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_strcpy.htm\" rel=\"nofollow noreferrer\"><code>strcpy()</code></a> in the wrong direction.</p>\n\n<pre><code>strcpy(argv[1],str);\nstrcpy(argv[2], ch);\n</code></pre>\n\n<p>should be changed to</p>\n\n<pre><code>strcpy(str, argv[1]);\nstrcpy(ch, argv[2]);\n</code></pre>\n\n<p>This is how I my teacher taught me: Right to left. Like the way Usain Bolt points when posing his famous <a href=\"http://content.newsinc.com/jpg/3163/31444970/44209623.jpg?t=1474999440\" rel=\"nofollow noreferrer\">victory pose</a>. His right hand points to the left.</p>\n\n<p><a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_strncpy.htm\" rel=\"nofollow noreferrer\"><code>strncpy()</code></a> can be used to avoid overflows instead of <code>strcpy()</code> but if the source is longer than the specified size, no <code>\\0</code> is appended to the destination string by <code>strncpy()</code>.</p>\n\n<p>You appear to be trying to give a string and a character as input via the command line and find the number of occurrences of that character in the string.</p>\n\n<p>If that's the case, supposing <code>argv[1]</code> has the string and <code>argv[2]</code> has the character,\nif <code>argv[2]</code> is not a single character, an error message may be displayed.</p>\n\n<pre><code>if(strlen(argv[2])!=1)\n{\n    printf(\"\\nError\");\n    exit(1);\n}\n</code></pre>\n\n<p>You should also check if the number of arguments provided (other than the program name) is at least 2. For example, if only one argument was given and you try to use <code>argv[2]</code>, it would lead to error.</p>\n\n<pre><code>if(argc&lt;3)\n{\n    printf(\"\\nNo enough arguments\");\n}\n</code></pre>\n\n<p>The name of the program counts as a value in <code>argv[0]</code>. See <a href=\"https://www.tutorialspoint.com/cprogramming/c_command_line_arguments.htm\" rel=\"nofollow noreferrer\">here</a></p>\n\n<pre><code>char c=ch[0];\nfor(i = 0; str[i]!= '\\0'; ++i) \n{ \n    if(c == str[i]) \n        ++frequency; \n} \nprintf(\"Frequency of %c = %d\", c, frequency); \n</code></pre>\n\n<p>Using <code>ch[0]</code> instead of <code>c</code> should work as well.</p>\n"}], "owner": {"reputation": 11, "user_id": 8641123, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dWcAC.jpg?s=128&g=1", "display_name": "Pranav Karakavalasa", "link": "https://stackoverflow.com/users/8641123/pranav-karakavalasa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4878, "favorite_count": 0, "closed_date": 1505944997, "accepted_answer_id": 46322916, "answer_count": 4, "score": -3, "last_activity_date": 1505920793, "creation_date": 1505909120, "last_edit_date": 1505911785, "question_id": 46321605, "link": "https://stackoverflow.com/questions/46321605/string-or-character-input-from-command-line-in-c", "closed_reason": "Needs details or clarity", "title": "String or character input from command line in C", "body": "<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;string.h&gt;\n\nint main(int argc, char *argv[]) \n{ \n    char str[1000], ch[100]; \n    int i, frequency = 0;\n    strcpy(argv[1],str);\n    strcpy(argv[2], ch);\n    for(i = 0; str[i]!= '\\0'; ++i) \n    { \n        if(ch[i] == str[i]) \n            ++frequency; \n    } \n    printf(\"Frequency of %c = %d\", *ch, frequency); \n    return (0); \n}\n</code></pre>\n\n<p>Compiles succesfully. </p>\n\n<p>Input: Hello h\nThe output is: Frequency of Somegarbage = 2</p>\n"}, {"tags": ["c", "linux", "buffer", "libpcap", "lzma"], "comments": [{"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1505908401, "post_id": 46320975, "comment_id": 79603360, "body": "You might be able to use a named pipe."}, {"owner": {"reputation": 2779, "user_id": 2037422, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/fbe43538cf41cb5974a7bf75b7f9d843?s=128&d=identicon&r=PG", "display_name": "Pavel Davydov", "link": "https://stackoverflow.com/users/2037422/pavel-davydov"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1505908620, "post_id": 46320975, "comment_id": 79603495, "body": "@SteveSummit I thought about it, however I&#39;m afraid it will slow the app down: data from pcap will be copied to kernel first, then copied out to userspace again, more syscalls, etc."}, {"owner": {"reputation": 2779, "user_id": 2037422, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/fbe43538cf41cb5974a7bf75b7f9d843?s=128&d=identicon&r=PG", "display_name": "Pavel Davydov", "link": "https://stackoverflow.com/users/2037422/pavel-davydov"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1505908792, "post_id": 46320975, "comment_id": 79603614, "body": "@SteveSummit By the way, do you know any tool that can parse pcap from pipe? Maybe, I can look for an answer in it&#39;s source code."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 1, "creation_date": 1505908978, "post_id": 46320975, "comment_id": 79603727, "body": "What do you want to parse exactly? The pcap file format itself is very simple and clear maybe you do not even need the libpcap for what you are trying to achieve."}, {"owner": {"reputation": 2779, "user_id": 2037422, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/fbe43538cf41cb5974a7bf75b7f9d843?s=128&d=identicon&r=PG", "display_name": "Pavel Davydov", "link": "https://stackoverflow.com/users/2037422/pavel-davydov"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1505909426, "post_id": 46320975, "comment_id": 79604024, "body": "@Ctx I want to parse UDP packets from pcap. It would be perfect if some lib could parse UDP headers and just give me it&#39;s payload, however I can handle it in my app as well. At least, I want to parse the packets. I&#39;ve read that pcap format is simple and consists of a file header and packet header, however after checking libpcap source I thought that it has a lot of corner cases that are somehow handled in the library. Do you think parsing it without pcap is a good idea?"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1505910656, "post_id": 46320975, "comment_id": 79604960, "body": "There are a whole lot of cornercases when doing live capturing from network interfaces or when many different layer-2-protocols are involved. But I do not see any difficulties when parsing a pcap-file &quot;manually&quot; which usually has always the same layer-2 protocol (ethernet for example)."}, {"owner": {"reputation": 2779, "user_id": 2037422, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/fbe43538cf41cb5974a7bf75b7f9d843?s=128&d=identicon&r=PG", "display_name": "Pavel Davydov", "link": "https://stackoverflow.com/users/2037422/pavel-davydov"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1505910856, "post_id": 46320975, "comment_id": 79605118, "body": "@Ctx Well, I mean smth like <a href=\"https://github.com/the-tcpdump-group/libpcap/blob/5c1f44efa6c5033b9eb49a34ad4b1e49251b91f5/sf-pcap.c#L556\" rel=\"nofollow noreferrer\">this</a>. I have no idea where my pcap files come from. I&#39;m not the one who recorded them."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1505916257, "post_id": 46320975, "comment_id": 79609142, "body": "It is almost always better to use the official library to read and parse formatted data from a file or stream.  Declaring that the official library is inadequate for some reason -- and that you&#39;re going to have to roll your own -- almost always leads to grief down the road.  (And I say this as someone who is <i>always</i> rolling my own file readers, because the official ones are always inadequate in some way.)"}, {"owner": {"reputation": 2779, "user_id": 2037422, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/fbe43538cf41cb5974a7bf75b7f9d843?s=128&d=identicon&r=PG", "display_name": "Pavel Davydov", "link": "https://stackoverflow.com/users/2037422/pavel-davydov"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1505929719, "post_id": 46320975, "comment_id": 79618269, "body": "@SteveSummit Hah, thanks for a good advice :)"}], "answers": [{"comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1505915404, "post_id": 46323757, "comment_id": 79608522, "body": "This is not very different from the named pipe suggestion.(which is easier to implement, because the main program only needs to read  to read from a (named) file.) In both cases the input will be not seekable."}, {"owner": {"reputation": 2779, "user_id": 2037422, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/fbe43538cf41cb5974a7bf75b7f9d843?s=128&d=identicon&r=PG", "display_name": "Pavel Davydov", "link": "https://stackoverflow.com/users/2037422/pavel-davydov"}, "edited": false, "score": 0, "creation_date": 1505916243, "post_id": 46323757, "comment_id": 79609136, "body": "Thanks for the suggestion. I&#39;ll give it a try, however I&#39;m not sure how much will performance degrade, compared to in memory buffer parsing."}, {"owner": {"reputation": 2779, "user_id": 2037422, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/fbe43538cf41cb5974a7bf75b7f9d843?s=128&d=identicon&r=PG", "display_name": "Pavel Davydov", "link": "https://stackoverflow.com/users/2037422/pavel-davydov"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1505916277, "post_id": 46323757, "comment_id": 79609158, "body": "@wildplasser Does libpcap require file to be seekable?"}, {"owner": {"reputation": 197, "user_id": 1676503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbd418b5e182b46179d0f4702f28a2f0?s=128&d=identicon&r=PG", "display_name": "lunix", "link": "https://stackoverflow.com/users/1676503/lunix"}, "edited": false, "score": 0, "creation_date": 1505916485, "post_id": 46323757, "comment_id": 79609312, "body": "If you have more than 1 CPU, it&#39;s probably faster, since you offload the decompress to another core"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1505916488, "post_id": 46323757, "comment_id": 79609314, "body": "I don&#39;t know. You could check the source. (theoretically, it wouldn&#39;t need it) The source you linked to <i>at least</i> had a SEEK_END in it"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1505916560, "post_id": 46323757, "comment_id": 79609365, "body": "@Martin: you mean faster than <i>what</i> ?"}, {"owner": {"reputation": 2779, "user_id": 2037422, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/fbe43538cf41cb5974a7bf75b7f9d843?s=128&d=identicon&r=PG", "display_name": "Pavel Davydov", "link": "https://stackoverflow.com/users/2037422/pavel-davydov"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1505916816, "post_id": 46323757, "comment_id": 79609553, "body": "@wildplasser Well, it has some fseeks in dump function (I&#39;m not going to dump to a pipe anyway), on the other hand <a href=\"https://github.com/the-tcpdump-group/libpcap/blob/5c1f44efa6c5033b9eb49a34ad4b1e49251b91f5/sf-pcap.c#L348\" rel=\"nofollow noreferrer\">this comment</a> states that pipes are supported."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1505917016, "post_id": 46323757, "comment_id": 79609697, "body": "Well,than start by @SteveSummit&#39;s suggestion. Here is a similar usage of a named pipe/fifo: <a href=\"https://stackoverflow.com/a/41741644/905902\">stackoverflow.com/a/41741644/905902</a>"}, {"owner": {"reputation": 197, "user_id": 1676503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbd418b5e182b46179d0f4702f28a2f0?s=128&d=identicon&r=PG", "display_name": "lunix", "link": "https://stackoverflow.com/users/1676503/lunix"}, "edited": false, "score": 0, "creation_date": 1505917396, "post_id": 46323757, "comment_id": 79609975, "body": "faster than using a decompress lib inside the same task and then parsing the buffer.  Also, in general I find pipes preferable to named pipes where possible as it saves (a) picking a unique name and (b) cleaning them up in all error cases."}, {"owner": {"reputation": 2779, "user_id": 2037422, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/fbe43538cf41cb5974a7bf75b7f9d843?s=128&d=identicon&r=PG", "display_name": "Pavel Davydov", "link": "https://stackoverflow.com/users/2037422/pavel-davydov"}, "edited": false, "score": 0, "creation_date": 1505918571, "post_id": 46323757, "comment_id": 79610849, "body": "Well, if I go with pipes, I&#39;ll use @Martin&#39;s solution. Named pipes would be easier in general, however my app has a state inside, so it should handle pipes from itself, and this way popen is easier to use."}, {"owner": {"reputation": 2779, "user_id": 2037422, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/fbe43538cf41cb5974a7bf75b7f9d843?s=128&d=identicon&r=PG", "display_name": "Pavel Davydov", "link": "https://stackoverflow.com/users/2037422/pavel-davydov"}, "edited": false, "score": 0, "creation_date": 1506001899, "post_id": 46323757, "comment_id": 79651637, "body": "I marked this as answer, case the trick with pipe works in my case. Added an example of code that uses pipe with pcap to the question. Thanks @Martin."}], "tags": [], "owner": {"reputation": 197, "user_id": 1676503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbd418b5e182b46179d0f4702f28a2f0?s=128&d=identicon&r=PG", "display_name": "lunix", "link": "https://stackoverflow.com/users/1676503/lunix"}, "is_accepted": true, "score": 2, "last_activity_date": 1505917595, "last_edit_date": 1505917595, "creation_date": 1505915023, "answer_id": 46323757, "question_id": 46320975, "link": "https://stackoverflow.com/questions/46320975/is-it-possible-to-parse-pcap-packets-from-buffer/46323757#46323757", "title": "Is it possible to parse pcap packets from buffer", "body": "<p>Particularly for large pcap files, it's preferable not to read the whole thing into memory first anyway. To handle the buffer management correctly, you'd need to understand the pcap format to get lengths correct, etc. </p>\n\n<p>You can stream it with popen, something like:</p>\n\n<pre><code>char* cmd = asprintf(\"/usr/bin/xz -d -c %s\", filename);\nFILE* fp = popen(cmd , \"r\");\nfree(cmd);\n</code></pre>\n\n<p>Then read from fp just as if it was uncompressed. You can also make a wrapper function for open returning a FILE* that works out whether to pipe it through a variety of decompressors by extension or just do a plain fopen.</p>\n\n<p>In general I find regular pipes preferable to named pipes where possible as it saves (a) picking a unique name and (b) cleaning them up in all error cases</p>\n\n<p>Or just parse the pcap by hand, the format is fairly trivial, IIRC it's just one header struct, then one per packet.</p>\n"}], "owner": {"reputation": 2779, "user_id": 2037422, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/fbe43538cf41cb5974a7bf75b7f9d843?s=128&d=identicon&r=PG", "display_name": "Pavel Davydov", "link": "https://stackoverflow.com/users/2037422/pavel-davydov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 948, "favorite_count": 0, "accepted_answer_id": 46323757, "answer_count": 1, "score": 3, "last_activity_date": 1506001943, "creation_date": 1505907312, "last_edit_date": 1506001943, "question_id": 46320975, "link": "https://stackoverflow.com/questions/46320975/is-it-possible-to-parse-pcap-packets-from-buffer", "title": "Is it possible to parse pcap packets from buffer", "body": "<p>I have a bunch of huge pcap files (> 10GB) that are compressed with lzma. I need to parse them on my machine, and I do not have enough space to uncompress them first. There are many libs that can stream lzma from file. The problem is on libpcap side, I've read it's API several times, and couldn't find any way to parse a buffer. What I see in the libs' source code is that it first <a href=\"https://github.com/the-tcpdump-group/libpcap/blob/5c1f44efa6c5033b9eb49a34ad4b1e49251b91f5/savefile.c#L373\" rel=\"nofollow noreferrer\">reads the magic byte</a> and <a href=\"https://github.com/the-tcpdump-group/libpcap/blob/5c1f44efa6c5033b9eb49a34ad4b1e49251b91f5/sf-pcap.c#L138\" rel=\"nofollow noreferrer\">file header</a> with <code>fread</code>:</p>\n\n<pre><code>    amt_read = fread((char *)&amp;magic, 1, sizeof(magic), fp);\n    ...\n    amt_read = fread(((char *)&amp;hdr) + sizeof hdr.magic, 1, sizeof(hdr) - sizeof(hdr.magic), fp);\n</code></pre>\n\n<p>And then <code>pcap_next_packet</code> also uses <code>fread</code> <a href=\"https://github.com/the-tcpdump-group/libpcap/blob/5c1f44efa6c5033b9eb49a34ad4b1e49251b91f5/sf-pcap.c#L430\" rel=\"nofollow noreferrer\">to read next packet from file</a>. So it looks like it's hard to pass a buffer from lzma stream to it. On the other hand, these functions are <a href=\"https://github.com/the-tcpdump-group/libpcap/blob/5c1f44efa6c5033b9eb49a34ad4b1e49251b91f5/sf-pcap.c#L251\" rel=\"nofollow noreferrer\">stored in pcap_t structure as pointers</a>. So I can implement my own procedures for it, however, this way I will have to duplicate a lot of code from libpcap. Does anybody know how to do it without hacking into libpcap? </p>\n\n<p>Am I missing something in libpcap API?</p>\n\n<p><strong>Update:</strong> With @Martin and others help, I managed to make it work. I'll post the implementation, so people who look for a way to do it can use it.</p>\n\n<pre><code>if (check_file_exists(\"/path/to/file.pcap.xz\")) {\n    return;\n}\n// first open a pipe\nFILE *pipe = popen(\"xz -d -c /path/to/file.pcap.xz\", \"r\");\nif (!pipe) {\n    // handle error somehow\n    return;\n}\nchar errbuff[256];\n// note pcap_fopen_offline function that takes FILE* instead of name\npcap_t *pcap = pcap_fopen_offline(pipe, errbuff);\nstruct pcap_pkthdr *header;\nuint8_t *data;\nwhile (pcap_next_ex(pcap, &amp;header, &amp;data)) {\n    // handle packets\n}\n</code></pre>\n"}, {"tags": ["c", "printf"], "comments": [{"owner": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "edited": false, "score": 1, "creation_date": 1505906543, "post_id": 46320672, "comment_id": 79602057, "body": "Are you sure that the data types match? Otherwise you have undefined behaviour."}, {"owner": {"reputation": 2365, "user_id": 611117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d70f88638c52101b1f0c5d9a87a803e?s=128&d=identicon&r=PG", "display_name": "vasek", "link": "https://stackoverflow.com/users/611117/vasek"}, "edited": false, "score": 7, "creation_date": 1505906581, "post_id": 46320672, "comment_id": 79602101, "body": "Please post <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a>"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1505906856, "post_id": 46320672, "comment_id": 79602314, "body": "<i>Questions seeking debugging help (why isn&#39;t this code working?) must include the desired behavior, a specific problem or error and the shortest code necessary to reproduce it in the question itself. Questions without a clear problem statement are not useful to other readers. See: How to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>.</i>"}, {"owner": {"reputation": 2104, "user_id": 949044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c84ec01bed6dea2f97aad7cc5d4e495c?s=128&d=identicon&r=PG", "display_name": "Lyth", "link": "https://stackoverflow.com/users/949044/lyth"}, "edited": false, "score": 0, "creation_date": 1505906867, "post_id": 46320672, "comment_id": 79602325, "body": "In your example &quot;ip&quot; variable points to some other place, where the string &quot;200 151...&quot; is  stored, which is surprisingly similar to not-fully-parsed-yet status code and length. Double-check where it is pointing and its null-termination."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1505909974, "post_id": 46320672, "comment_id": 79604440, "body": "<a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/utilities/od.html\" rel=\"nofollow noreferrer\">The <code>od</code> utility</a> (originally &quot;octal dump&quot;, IIRC) is a useful tool here, if you&#39;re running on a POSIX or POSIX-like system.  Instead of <code>myprogram</code>, run something like <code>myprogram | od -c</code> to see every character printed, including control characters like a <code>\\r</code> carriage return."}], "answers": [{"comments": [{"owner": {"reputation": 259, "user_id": 5631039, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/03a7c72afaaea1bc33f12d411265d8b0?s=128&d=identicon&r=PG&f=1", "display_name": "gel", "link": "https://stackoverflow.com/users/5631039/gel"}, "edited": false, "score": 0, "creation_date": 1505907439, "post_id": 46320904, "comment_id": 79602730, "body": "When I use that the program doesn&#39;t print anything. Do I need to do anything else?"}, {"owner": {"reputation": 132, "user_id": 3649130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4009fedaa2f083040c81957e72da141e?s=128&d=identicon&r=PG&f=1", "display_name": "Girauder", "link": "https://stackoverflow.com/users/3649130/girauder"}, "edited": false, "score": 0, "creation_date": 1505907742, "post_id": 46320904, "comment_id": 79602930, "body": "I think you are indeed correct, however I would change &#39;\\r&#39; for &#39;\\n&#39; I think that was the intended use?"}], "tags": [], "owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "is_accepted": true, "score": 7, "last_activity_date": 1505907570, "last_edit_date": 1505907570, "creation_date": 1505907119, "answer_id": 46320904, "question_id": 46320672, "link": "https://stackoverflow.com/questions/46320672/printf-prints-wrong-order-works-when-printed-separately/46320904#46320904", "title": "printf() - prints wrong order. Works when printed separately", "body": "<p>I think that the problem comes from <code>row</code> which contains a <code>\\r</code> character.</p>\n\n<p>Just modify it with <code>strchr(...)</code></p>\n\n<pre><code>/* replace all '\\r' by 'R' in row */\nchar *p = strchr(row, '\\r');\nwhile(p)\n{ \n    *p = 'R';\n    p = strchr(row, '\\r');\n}\n</code></pre>\n"}], "owner": {"reputation": 259, "user_id": 5631039, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/03a7c72afaaea1bc33f12d411265d8b0?s=128&d=identicon&r=PG&f=1", "display_name": "gel", "link": "https://stackoverflow.com/users/5631039/gel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 915, "favorite_count": 0, "accepted_answer_id": 46320904, "answer_count": 1, "score": 4, "last_activity_date": 1505907570, "creation_date": 1505906416, "last_edit_date": 1505907158, "question_id": 46320672, "link": "https://stackoverflow.com/questions/46320672/printf-prints-wrong-order-works-when-printed-separately", "title": "printf() - prints wrong order. Works when printed separately", "body": "<p>I'm trying to print some text in common log format. </p>\n\n<pre><code>printf(\"%s - - [%s] %s %d %zu\\n\", ip, _time, row, statuscode, size);\n</code></pre>\n\n<p>The problem is that the order gets all mixed up. The output is:</p>\n\n<pre><code>200 1511 - - [20/Sep/2017:13:07:32 +0200] GET / HTTP/1.1\n</code></pre>\n\n<p>I <strong>think</strong> (<code>1511</code>) is the <code>ip</code> getting printed. Don't know why.</p>\n\n<p>When I print them like this:</p>\n\n<pre><code>printf(\"1. %s\\n\", ip);\nprintf(\"2. %s\\n\", _time);\nprintf(\"3. %s\\n\", row);\nprintf(\"4. %d\\n\", statuscode);\nprintf(\"5. %zu\\n\", size);\n</code></pre>\n\n<p>It works like expected:</p>\n\n<pre><code>1. 127.0.0.1\n2. 20/Sep/2017:13:11:24 +0200\n3. GET / HTTP/1.1\n4. 200\n5. 151\n</code></pre>\n\n<p>It seems the problem starts when i add <code>statuscode</code> for some reason. I have no clue why. Any help is appreciated. </p>\n\n<p>Here is the function where I use prinft(): </p>\n\n<pre><code>static void handlelogging(char* method, struct sockaddr_storage client_addr, size_t size, char* row, int statuscode) {\n\nchar* ip;\nchar _time[80];\nstruct tm *info;\ntime_t rawtime;\n\ntime(&amp;rawtime);\ninfo = localtime(&amp;rawtime);\nstrftime(_time, 80,\"%d/%b/%Y:%H:%M:%S %z\", info)\nip = getip(client_addr);\n\n//Print goes here, see above.\n}\n</code></pre>\n\n<p>As someone said it could be a problem with the ip variable:</p>\n\n<pre><code>static char* getip(struct sockaddr_storage client_addr) {\n    char ipstr[20];\n    struct sockaddr_in *s;\n\n\n    s = (struct sockaddr_in *) &amp;client_addr;\n\n    /**\n     * Converts network address (s) in the IPV_4 family into a string.\n     */\n    return strdup(inet_ntop(AF_INET, &amp;s-&gt;sin_addr, ipstr, sizeof ipstr));\n }\n</code></pre>\n"}, {"tags": ["c", "arrays", "linked-list", "singly-linked-list"], "comments": [{"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1505909883, "post_id": 46320526, "comment_id": 79604369, "body": "The insertion is invalid. There is again a memory leak. See my answer."}, {"owner": {"reputation": 391, "user_id": 7157651, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/864161088d214f8a54c58acd9a07f68f?s=128&d=identicon&r=PG&f=1", "display_name": "zuzu", "link": "https://stackoverflow.com/users/7157651/zuzu"}, "reply_to_user": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1505909933, "post_id": 46320526, "comment_id": 79604405, "body": "Thanks! Will edit ASAP :)"}, {"owner": {"reputation": 391, "user_id": 7157651, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/864161088d214f8a54c58acd9a07f68f?s=128&d=identicon&r=PG&f=1", "display_name": "zuzu", "link": "https://stackoverflow.com/users/7157651/zuzu"}, "reply_to_user": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1505910961, "post_id": 46320526, "comment_id": 79605202, "body": "May I ask why a memory leak occurs?"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1505911463, "post_id": 46320526, "comment_id": 79605535, "body": "After calling malloc instead of newNode = link[3]; as it was written you have to write newNode-&gt;next = link[3];"}], "answers": [{"comments": [{"owner": {"reputation": 391, "user_id": 7157651, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/864161088d214f8a54c58acd9a07f68f?s=128&d=identicon&r=PG&f=1", "display_name": "zuzu", "link": "https://stackoverflow.com/users/7157651/zuzu"}, "edited": false, "score": 0, "creation_date": 1505906422, "post_id": 46320647, "comment_id": 79601967, "body": "Good point! Thanks for the insight. That means my code to insert should be more like... Node *newNode = malloc(sizeof(struct Node)) ?"}], "tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": false, "score": 2, "last_activity_date": 1505906308, "creation_date": 1505906308, "answer_id": 46320647, "question_id": 46320526, "link": "https://stackoverflow.com/questions/46320526/array-of-linked-lists-in-c-initializing-and-inserting/46320647#46320647", "title": "Array of Linked Lists in C: initializing and inserting?", "body": "<p>You already have an array of 5 pointers to nodes, that's <code>link</code>. You can set those to point to nothing by just doing:</p>\n\n<pre><code>for (size_t i = 0; i &lt; sizeof link / sizeof *link; ++i)\n link[i] = NULL;\n</code></pre>\n\n<p>here you should not allocate any new storage since you don't want actual nodes, you just want pointers to nodes and you already have them.</p>\n\n<p>Your code first allocates, then immediately overwrites the pointer returned by <code>malloc()</code> with <code>NULL</code>, effectively losing that memory forever. Not good.</p>\n\n<p>When you want to actually <em>create</em> a node, that's when you need to allocate it and link it into the proper list.</p>\n"}, {"comments": [{"owner": {"reputation": 391, "user_id": 7157651, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/864161088d214f8a54c58acd9a07f68f?s=128&d=identicon&r=PG&f=1", "display_name": "zuzu", "link": "https://stackoverflow.com/users/7157651/zuzu"}, "edited": false, "score": 0, "creation_date": 1505907220, "post_id": 46320811, "comment_id": 79602595, "body": "Thank you! I drew out your insert code and I think after allocating space for newNode, you have to point it to what link[3] was pointing to with newNode = link[3]"}, {"owner": {"reputation": 81, "user_id": 2354936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b11c14a0e1287a1fedbfd7c20e84f82f?s=128&d=identicon&r=PG", "display_name": "previ", "link": "https://stackoverflow.com/users/2354936/previ"}, "reply_to_user": {"reputation": 391, "user_id": 7157651, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/864161088d214f8a54c58acd9a07f68f?s=128&d=identicon&r=PG&f=1", "display_name": "zuzu", "link": "https://stackoverflow.com/users/7157651/zuzu"}, "edited": false, "score": 0, "creation_date": 1505913189, "post_id": 46320811, "comment_id": 79606760, "body": "well, if you save the pointer of the allocated memory in newNode, than you need to assign the pointer to link[3] too, but not vice versa. So it should be link[3] = newNode."}, {"owner": {"reputation": 391, "user_id": 7157651, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/864161088d214f8a54c58acd9a07f68f?s=128&d=identicon&r=PG&f=1", "display_name": "zuzu", "link": "https://stackoverflow.com/users/7157651/zuzu"}, "edited": false, "score": 0, "creation_date": 1505915387, "post_id": 46320811, "comment_id": 79608511, "body": "My mistake. I was actually referring to newNode-&gt;next = link[3], which I thought was newNode = link[3], at first. Thank you anyway :)"}], "tags": [], "owner": {"reputation": 81, "user_id": 2354936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b11c14a0e1287a1fedbfd7c20e84f82f?s=128&d=identicon&r=PG", "display_name": "previ", "link": "https://stackoverflow.com/users/2354936/previ"}, "is_accepted": false, "score": 3, "last_activity_date": 1505913031, "last_edit_date": 1505913031, "creation_date": 1505906818, "answer_id": 46320811, "question_id": 46320526, "link": "https://stackoverflow.com/questions/46320526/array-of-linked-lists-in-c-initializing-and-inserting/46320811#46320811", "title": "Array of Linked Lists in C: initializing and inserting?", "body": "<p>As far as I understood your program, the following statement is not necessary:</p>\n\n<p>link[q] = malloc(sizeof(struct Node));</p>\n\n<p>since you need to start from NULL pointers, link[q] = NULL; is just fine.</p>\n\n<p>To insert items in the list you should allocate memory for each item, so it should become something like that:</p>\n\n<pre><code>Node* newNode = malloc(sizeof(struct Node));\nnewNode-&gt;data = 1;\nnewNode-&gt;next = link[3];\nlink[3] = newNode;\n</code></pre>\n\n<p>It should work, although I did not test it.</p>\n"}, {"tags": [], "owner": {"reputation": 407, "user_id": 6566252, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7772f443cf60b1154e74ff398fbbe41d?s=128&d=identicon&r=PG&f=1", "display_name": "Bizzu", "link": "https://stackoverflow.com/users/6566252/bizzu"}, "is_accepted": false, "score": 1, "last_activity_date": 1505906832, "creation_date": 1505906832, "answer_id": 46320817, "question_id": 46320526, "link": "https://stackoverflow.com/questions/46320526/array-of-linked-lists-in-c-initializing-and-inserting/46320817#46320817", "title": "Array of Linked Lists in C: initializing and inserting?", "body": "<p>First of all the best thing to do for check something if you didn't sure is to see it - print it.</p>\n\n<p>Second, there is mistake in your code - </p>\n\n<pre><code>    link[q] = malloc(sizeof(struct Node));\n    link[q] = NULL;\n</code></pre>\n\n<p>here you make a new pointer void* in size of <code>struct Node</code> and then you lose him when you save NULL in the variable <code>Link[i]</code> you have 2 options:</p>\n\n<ol>\n<li>To allocate link and then initialize it with <code>defualt fields</code> for example - <code>data =-1</code></li>\n<li>dont allocate and put <code>NULL</code> in everty Node before you initialize</li>\n</ol>\n\n<p>my  advise, go with 2, and only when you need to add new node allocate.</p>\n"}, {"comments": [{"owner": {"reputation": 391, "user_id": 7157651, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/864161088d214f8a54c58acd9a07f68f?s=128&d=identicon&r=PG&f=1", "display_name": "zuzu", "link": "https://stackoverflow.com/users/7157651/zuzu"}, "edited": false, "score": 0, "creation_date": 1505915787, "post_id": 46321033, "comment_id": 79608789, "body": "In your function push_front, why do you do this? [int success = new_node != NULL; ] Would there be an occasion that the new_node would point to NULL (after just allocating space for it? Especially with the purpose of the function being collecting data for it anyway?). And why do we return the value of success? Is a return value required? Wouldn&#39;t it be the same to just declare the function as &quot;void&quot;?"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 391, "user_id": 7157651, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/864161088d214f8a54c58acd9a07f68f?s=128&d=identicon&r=PG&f=1", "display_name": "zuzu", "link": "https://stackoverflow.com/users/7157651/zuzu"}, "edited": false, "score": 0, "creation_date": 1505915928, "post_id": 46321033, "comment_id": 79608894, "body": "@Katrina The function malloc can fail. You need a way to determine whether a node was successfully added to the list."}, {"owner": {"reputation": 391, "user_id": 7157651, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/864161088d214f8a54c58acd9a07f68f?s=128&d=identicon&r=PG&f=1", "display_name": "zuzu", "link": "https://stackoverflow.com/users/7157651/zuzu"}, "edited": false, "score": 0, "creation_date": 1505916549, "post_id": 46321033, "comment_id": 79609354, "body": "Thank you again! :)"}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 3, "last_activity_date": 1505907457, "creation_date": 1505907457, "answer_id": 46321033, "question_id": 46320526, "link": "https://stackoverflow.com/questions/46320526/array-of-linked-lists-in-c-initializing-and-inserting/46321033#46321033", "title": "Array of Linked Lists in C: initializing and inserting?", "body": "<p>This loop</p>\n\n<pre><code>Node* link[5];\nfor(int q = 0; q &lt; 5; q++) {\n    link[q] = malloc(sizeof(struct Node));\n    link[q] = NULL;\n}\n</code></pre>\n\n<p>results in memory leaks because at first memory is allocated and then the pointers are overwritten with NULL. So the addresses of the allocated memory are lost.</p>\n\n<p>You could just write</p>\n\n<pre><code>Node* link[5] = { 0 };\n</code></pre>\n\n<p>Here is a demonstrative program that shows how nodes can be added to elements of the array of lists. Insetad of the data member <code>data</code> of the type <code>int</code> I am using the data member <code>data</code> of the type <code>char</code> for visibility.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct Node \n{\n    char data;\n    struct Node *next;\n} Node;\n\n\nint push_front( Node **head, char data )\n{\n    Node *new_node = malloc( sizeof( Node ) );\n    int success = new_node != NULL;\n\n    if ( success )\n    {\n        new_node-&gt;data = data;\n        new_node-&gt;next = *head;\n        *head = new_node;\n    }\n\n    return success;\n}\n\nvoid output( Node **head )\n{\n    for( Node *current =*head; current != NULL; current = current-&gt;next )\n    {\n        printf( \"%c \", current-&gt;data );\n    }\n    printf( \"%s\", \"NULL\" );\n}\n\nvoid display( Node **set, size_t n )\n{\n    for ( size_t i = 0; i &lt; n; i++ )\n    {\n        output( set++ );\n        putchar( '\\n' );\n    }\n}\n\n#define N   5\n\nint main(void) \n{\n    Node * link[N] = { 0 };\n\n    push_front( &amp;link[0], 'b' );\n    push_front( &amp;link[0], 'a' );\n    push_front( &amp;link[1], 'c' );\n    push_front( &amp;link[2], 'd' );\n\n    display( link, sizeof( link ) / sizeof( *link ) );\n\n    return 0;\n}\n</code></pre>\n\n<p>The program output is</p>\n\n<pre><code>a b NULL\nc NULL\nd NULL\nNULL\nNULL\n</code></pre>\n"}], "owner": {"reputation": 391, "user_id": 7157651, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/864161088d214f8a54c58acd9a07f68f?s=128&d=identicon&r=PG&f=1", "display_name": "zuzu", "link": "https://stackoverflow.com/users/7157651/zuzu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11177, "favorite_count": 0, "accepted_answer_id": 46321033, "answer_count": 4, "score": 6, "last_activity_date": 1505913031, "creation_date": 1505905930, "last_edit_date": 1505910976, "question_id": 46320526, "link": "https://stackoverflow.com/questions/46320526/array-of-linked-lists-in-c-initializing-and-inserting", "title": "Array of Linked Lists in C: initializing and inserting?", "body": "<p>I need to create an array of linked lists (as pictured) and this is what I've made so far:</p>\n\n<p><a href=\"https://i.stack.imgur.com/jIGTL.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/jIGTL.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>typedef struct Node {\n    int data;\n    struct Node *next;\n} Node;\n\nint main(void) {\n    Node* link[5];\n    for(int q = 0; q &lt; 5; q++) {\n        link[q] = malloc(sizeof(struct Node));\n        link[q] = NULL;\n    }\n}\n</code></pre>\n\n<p>It's been awhile since I've used linked lists in C, so I've forgotten a lot of the syntax and I'm having trouble visualizing what exactly happens when I code linked lists. If I'm not mistaken, when I call malloc in my code, I'm creating a Node with nothing in it yet?</p>\n\n<p>I want to initialize it to point to NULL. And I did this with</p>\n\n<pre><code>link[q] = NULL;\n</code></pre>\n\n<p>Am I right in saying this is what it looks like in memory?</p>\n\n<p>|1| -> NULL</p>\n\n<p>|2| -> NULL</p>\n\n<p>|3| -> NULL</p>\n\n<hr>\n\n<p>My next problem would be inserting data into the linked list.</p>\n\n<p>(Referring to the picture): If I want to insert another element into say the 3rd index of the array ([3]-> d -> NULL)</p>\n\n<p>Would this be correct?</p>\n\n<pre><code>Node* newNode = link[3];\nnewNode-&gt;data = 1;\nlink[3] = newNode;\n</code></pre>\n\n<p>Thank you for the help!</p>\n"}, {"tags": ["c", "variables", "printf"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1505905667, "post_id": 46320414, "comment_id": 79601447, "body": "if you want to print multiple times, why don&#39;t you use a loop?"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1505906385, "post_id": 46320414, "comment_id": 79601940, "body": "<code>printf(..., x, x, x);</code> Now it&#39;s used for all specifiers."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1505906741, "post_id": 46320414, "comment_id": 79602229, "body": "It&#39;s common to do things like <code>printf &quot;%d %o %x\\n&quot;, i, i, i)</code> to see a number&#39;s representation in different bases. But you have to repeat <code>i</code> multiple times in the call, as shown."}], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 3, "last_activity_date": 1505907105, "last_edit_date": 1505907105, "creation_date": 1505905884, "answer_id": 46320510, "question_id": 46320414, "link": "https://stackoverflow.com/questions/46320414/can-we-use-only-one-variable-for-many-format-descriptors-in-printf-in-c/46320510#46320510", "title": "Can we use only one variable for many format descriptors in printf in C", "body": "<p>No, this is not possible.</p>\n\n<p>Quoting <code>C11</code>, chapter  \u00a77.21.6.1, <em><code>fprintf()</code></em> (applicale for <code>*printf()</code> family, all emphasis mine)</p>\n\n<blockquote>\n  <p>The <code>fprintf</code> function writes output to the stream pointed to by stream, under control\n  of the string pointed to by <code>format</code> that specifies how subsequent arguments are\n  converted for output. <strong>If there are insufficient arguments for the <code>format</code>, the behavior is\n  undefined. If the <code>format</code> is exhausted while arguments remain, the excess arguments are\n  evaluated (as always) but are otherwise ignored.</strong> [...]</p>\n</blockquote>\n\n<p>and, for a <code>format</code> string containing conversion specifiers,  </p>\n\n<blockquote>\n  <p>The <code>format</code> shall be a multibyte character sequence, beginning and ending in its initial\n  shift state. The <code>format</code> is composed of zero or more directives: ordinary multibyte\n  characters (not <code>%</code>), which are copied unchanged to the output stream; and <strong>conversion\n  specifications, each of which results in fetching zero or more subsequent arguments,</strong>\n  converting them, if applicable, according to the corresponding conversion specifier, and\n  then writing the result to the output stream.**</p>\n</blockquote>\n\n<p>So, the bottom line, each conversion specification needs zero or more \"corresponding\" argument, and one argument, cannot correspond to multiple conversion specification in the <code>format</code> string. Each conversion specification needs their <em>own</em> argument.</p>\n\n<hr>\n\n<p>Solution:</p>\n\n<p>In case you want to print the same variable multiple times, like you're shown,</p>\n\n<pre><code> printf(\"\\n%c%c\\n%c\",only_one_variable_for_all);\n</code></pre>\n\n<p>you can simply use a loop!!</p>\n\n<pre><code> for (int i = 0; i &lt; SOME_SIZE; i++ ) \n { \n      printf (\"%c\", only_one_variable ); \n\n      /* some more logic for line break?*/\n\n }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": false, "score": 0, "last_activity_date": 1505905979, "creation_date": 1505905979, "answer_id": 46320537, "question_id": 46320414, "link": "https://stackoverflow.com/questions/46320414/can-we-use-only-one-variable-for-many-format-descriptors-in-printf-in-c/46320537#46320537", "title": "Can we use only one variable for many format descriptors in printf in C", "body": "<p>No. It's not possible. Each format specifier requires a respective argument.</p>\n\n<p>However, you can solve this in many ways depending on the thing you want to print multiple times.\nFor example, you can create C-string that contains the chars and print it.</p>\n\n<pre><code>char str[] = {ch, ch, ch, 0};\nprintf(\"%s\", str);\n</code></pre>\n\n<p>Or use a loop to print the value as many times as needed. But there's no generic way to solve this.</p>\n"}, {"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1505909648, "post_id": 46321595, "comment_id": 79604194, "body": "A <i>one</i>-based index?!?  In C?"}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1505909869, "post_id": 46321595, "comment_id": 79604362, "body": "@AndrewHenle It&#39;s POSIX, they didn&#39;t make it up, they just documented someones craziness. I suspect that in whatever implementation that made this up first it was just an offset into the arguments (since this probably came before va_list because it&#39;s a real pain to implement with a va_list) and the format string itself was at index 0."}], "tags": [], "owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "is_accepted": false, "score": 1, "last_activity_date": 1505909098, "creation_date": 1505909098, "answer_id": 46321595, "question_id": 46320414, "link": "https://stackoverflow.com/questions/46320414/can-we-use-only-one-variable-for-many-format-descriptors-in-printf-in-c/46321595#46321595", "title": "Can we use only one variable for many format descriptors in printf in C", "body": "<p>The C standard doesn't allow this, but on POSIX systems you can do something like this:</p>\n\n<pre><code>printf(\"%1$d %1$d %1$d\\n\", 17);\n</code></pre>\n\n<p>POSIX says:</p>\n\n<blockquote>\n  <p>Conversions can be applied to the nth argument after the format in the argument list, rather than to the next unused argument. In this case, the conversion specifier character % (see below) is replaced by the sequence \"%n$\", where n is a decimal integer in the range [1,{NL_ARGMAX}], giving the position of the argument in the argument list.</p>\n</blockquote>\n\n<p>It's a relatively unknown extension so be prepared for even very experienced C programmers to not know about it and yell at you if you use it. (it will fail code review). Also, it isn't even intended to be used for repeating one argument, but rather for translation format strings where certain languages might want to print things in different order. So I'd recommend against using it. Just write out the variable many times. Don't be lazy.</p>\n"}], "owner": {"reputation": 21, "user_id": 8640713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27814856b0d389f7613a7c25577b80b6?s=128&d=identicon&r=PG&f=1", "display_name": "Abi", "link": "https://stackoverflow.com/users/8640713/abi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 790, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1505909098, "creation_date": 1505905627, "last_edit_date": 1505906259, "question_id": 46320414, "link": "https://stackoverflow.com/questions/46320414/can-we-use-only-one-variable-for-many-format-descriptors-in-printf-in-c", "title": "Can we use only one variable for many format descriptors in printf in C", "body": "<p>Is is possible to write code like the one I've written in below ? </p>\n\n<pre><code>printf(\"\\n%c%c\\n%c\",only_one_variable_for_all);\nprintf(\"%c%c%c\\n\",only_one_variable_for_all);\n</code></pre>\n\n<p>I have to print in different patterns in each case\nCan you give any other ideas?</p>\n"}, {"tags": ["c", "function", "gcc"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1505902646, "post_id": 46319326, "comment_id": 79599578, "body": "Compiler throwing seg fault? Wow..."}, {"owner": {"reputation": 739, "user_id": 8281970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/abHXs.jpg?s=128&g=1", "display_name": "Ketan Mukadam", "link": "https://stackoverflow.com/users/8281970/ketan-mukadam"}, "edited": false, "score": 1, "creation_date": 1505902720, "post_id": 46319326, "comment_id": 79599628, "body": "Isnt it infinite call stack, with func1 calling func2 which in turn calls func1. How do you think it will end? BTW gcc will not throw the seg fault error, your program does."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1505902785, "post_id": 46319326, "comment_id": 79599673, "body": "<b>more importantly:</b> Why did you <b>choose</b> to ignore compiler warnings?"}, {"owner": {"reputation": 51, "user_id": 7618386, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3eac430ccc8bf1d56a762800ea00e9f1?s=128&d=identicon&r=PG&f=1", "display_name": "Samuel Thomson", "link": "https://stackoverflow.com/users/7618386/samuel-thomson"}, "edited": false, "score": 0, "creation_date": 1505902818, "post_id": 46319326, "comment_id": 79599701, "body": "thanks ketan mukadam for pointing that out. why is my program keeps on running"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1505902845, "post_id": 46319326, "comment_id": 79599721, "body": "@SamuelThomson see answers below"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1505903004, "post_id": 46319326, "comment_id": 79599820, "body": "Not directly related to your problem, but you should declare the function prototypes prior to using them: <code>void func1();&lt;newline&gt;void func2();</code> (put a newline between the two declarations for readability). Your compiler should have warned you, if not compile with <code>-Wall</code>. If you are using TurboC, change school."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1505903105, "post_id": 46319326, "comment_id": 79599884, "body": "@SouravGhosh is there something in the standard that specifies infinite recursion to be UB/implementation defined?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1505903249, "post_id": 46319326, "comment_id": 79599985, "body": "@SouravGhosh why is an infinite loop (such as <code>for(;;) {}</code>) UB?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1505903439, "post_id": 46319326, "comment_id": 79600093, "body": "@MichaelWalz It&#39;s not that simple, I agree. It has multiple conditions, like no volatile access. I&#39;ll check the details and for time being,I&#39;ll remove my previous comment."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1505903522, "post_id": 46319326, "comment_id": 79600136, "body": "@SouravGhosh OK let&#39;s delete our comments dealing with this."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 7618386, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3eac430ccc8bf1d56a762800ea00e9f1?s=128&d=identicon&r=PG&f=1", "display_name": "Samuel Thomson", "link": "https://stackoverflow.com/users/7618386/samuel-thomson"}, "edited": false, "score": 0, "creation_date": 1505903241, "post_id": 46319418, "comment_id": 79599980, "body": "@Adraian H thanks for your response. so you say that with recursion i can&#39;t get an output like that ."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 51, "user_id": 7618386, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3eac430ccc8bf1d56a762800ea00e9f1?s=128&d=identicon&r=PG&f=1", "display_name": "Samuel Thomson", "link": "https://stackoverflow.com/users/7618386/samuel-thomson"}, "edited": false, "score": 0, "creation_date": 1505903330, "post_id": 46319418, "comment_id": 79600033, "body": "@SamuelThomson you <i>do</i>  get an output like that. Simply the recursion nevers ends and when the stack is full your program blows up."}, {"owner": {"reputation": 76, "user_id": 1677977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebdf1c9aab3fc87bced0df609995a362?s=128&d=identicon&r=PG", "display_name": "AdrianH", "link": "https://stackoverflow.com/users/1677977/adrianh"}, "edited": false, "score": 0, "creation_date": 1505903409, "post_id": 46319418, "comment_id": 79600072, "body": "It&#39;s doable with recursion, just have to pass a termination condition of sorts - say each function receives number_of_calls_to_1 and number_of_calls_to_2 parameter, first at 1, decreases the corresponding counter and checks whether it is greater than or equal to zero - if so, call the function with the new counters, else stop recursing. Try to understand that Wikipedia example well and you should be able to do it."}], "tags": [], "owner": {"reputation": 76, "user_id": 1677977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebdf1c9aab3fc87bced0df609995a362?s=128&d=identicon&r=PG", "display_name": "AdrianH", "link": "https://stackoverflow.com/users/1677977/adrianh"}, "is_accepted": false, "score": 4, "last_activity_date": 1505902709, "creation_date": 1505902709, "answer_id": 46319418, "question_id": 46319326, "link": "https://stackoverflow.com/questions/46319326/segmentation-fault-core-dumped-after-running-for-sometime/46319418#46319418", "title": "Segmentation fault (core dumped) after running for sometime", "body": "<p>You're calling func1 which, in turn, is calling func2, which, in turn, is calling func1 and so on. This is infinite recursion - you probably have your program printing infinitely. At some point it will run out of stack space and return the error you encountered. You need a stop condition that tells func2 not to call func1 anymore if what you intended your program to do is already done. See an example of recursion termination for a different problem here: <a href=\"https://en.wikipedia.org/wiki/Recursion_termination\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Recursion_termination</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": true, "score": 4, "last_activity_date": 1505902804, "creation_date": 1505902804, "answer_id": 46319452, "question_id": 46319326, "link": "https://stackoverflow.com/questions/46319326/segmentation-fault-core-dumped-after-running-for-sometime/46319452#46319452", "title": "Segmentation fault (core dumped) after running for sometime", "body": "<p>The compiler does not throw a segmentation fault, your program does.</p>\n\n<p>Your program calls <code>func1()</code> and <code>func2()</code> infinite amount of times, causing it to blow up, since the stack size will be exceeded (thus the segmentation fault will happen).</p>\n"}], "owner": {"reputation": 51, "user_id": 7618386, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3eac430ccc8bf1d56a762800ea00e9f1?s=128&d=identicon&r=PG&f=1", "display_name": "Samuel Thomson", "link": "https://stackoverflow.com/users/7618386/samuel-thomson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 821, "favorite_count": 0, "accepted_answer_id": 46319452, "answer_count": 2, "score": 0, "last_activity_date": 1505970706, "creation_date": 1505902470, "last_edit_date": 1505970706, "question_id": 46319326, "link": "https://stackoverflow.com/questions/46319326/segmentation-fault-core-dumped-after-running-for-sometime", "title": "Segmentation fault (core dumped) after running for sometime", "body": "<p>I am trying to print the output as</p>\n\n<pre><code> func 1 ---------------1\nfunc 2  -------2\n func 1 ---------------1\nfunc 2  -------2\n</code></pre>\n\n<p>indefinetly.</p>\n\n<p>But I am getting <code>segmentation fault core(dumped)</code> after the program executes for some time. </p>\n\n<p>Why is my gcc compiler showing this error?</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint i=2;\nint main(int argc, char *argv[]){\n    func1();\n    func2();\n    return 0;\n}\n\nvoid func1(){\n    printf(\"\\n func 1 ---------------%d\",i);\n    i=2;\n    func2();\n}\n\nvoid func2(){\n    printf(\"\\nfunc 2  -------%d\",i);\n    i=1;\n    func1();\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "windows", "time", "struct"], "comments": [{"owner": {"reputation": 32078, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 4, "creation_date": 1505902120, "post_id": 46318868, "comment_id": 79599232, "body": "How did you get this <code>SYSTEMTIME</code>? I would assume that the content is garbage."}, {"owner": {"reputation": 42375, "user_id": 21567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23a053b78fc2567576235b77fa2e4c16?s=128&d=identicon&r=PG", "display_name": "Christian.K", "link": "https://stackoverflow.com/users/21567/christian-k"}, "reply_to_user": {"reputation": 32078, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1505903480, "post_id": 46318868, "comment_id": 79600112, "body": "In regard to @VTT&#39;s comment: are the other members making sense? If not the &quot;garbage&quot; idea becomes even more probable."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1505903573, "post_id": 46318868, "comment_id": 79600171, "body": "There is no magic offset, it starts at 0.  You&#39;ve got garbage data.  Stack buffer overflow, maybe."}, {"owner": {"reputation": 219, "user_id": 7125206, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-khRuSoovh3U/AAAAAAAAAAI/AAAAAAAAAEM/S8yyc-eW90A/photo.jpg?sz=128", "display_name": "Hatsune", "link": "https://stackoverflow.com/users/7125206/hatsune"}, "edited": false, "score": 0, "creation_date": 1506062957, "post_id": 46318868, "comment_id": 79676633, "body": "I am doing a reverse analysis of the virus, and I see the virus use this strutuce to SetWaitableTimer~\ud83d\ude1c"}, {"owner": {"reputation": 2149, "user_id": 2096401, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uVjii.jpg?s=128&g=1", "display_name": "TripeHound", "link": "https://stackoverflow.com/users/2096401/tripehound"}, "edited": false, "score": 0, "creation_date": 1506064013, "post_id": 46318868, "comment_id": 79677170, "body": "What makes you think a virus wouldn&#39;t generate &quot;<i>garbage data</i>&quot;? I&#39;ve no idea whether it <i>can</i> be used to exploit something, but deliberately using illegal values is the sort of thing you can almost expect a virus to do. But in any case, <code>834h</code> is <code>2100</code> (decimal) so the value is valid anyway."}, {"owner": {"reputation": 219, "user_id": 7125206, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-khRuSoovh3U/AAAAAAAAAAI/AAAAAAAAAEM/S8yyc-eW90A/photo.jpg?sz=128", "display_name": "Hatsune", "link": "https://stackoverflow.com/users/7125206/hatsune"}, "edited": false, "score": 0, "creation_date": 1506069757, "post_id": 46318868, "comment_id": 79680491, "body": "Ok, maybe I just found the answer right now~\ud83e\udd13THX guys"}], "answers": [{"tags": [], "owner": {"reputation": 219, "user_id": 7125206, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-khRuSoovh3U/AAAAAAAAAAI/AAAAAAAAAEM/S8yyc-eW90A/photo.jpg?sz=128", "display_name": "Hatsune", "link": "https://stackoverflow.com/users/7125206/hatsune"}, "is_accepted": false, "score": 0, "last_activity_date": 1506070127, "last_edit_date": 1592644375, "creation_date": 1506070127, "answer_id": 46360558, "question_id": 46318868, "link": "https://stackoverflow.com/questions/46318868/how-to-identify-the-meaning-of-the-myear-element-in-this-structure/46360558#46360558", "title": "How to identify the meaning of the mYear element in this structure\uff1f", "body": "<blockquote>\n<p>wYear=2001 represents the time in 2001</p>\n<p>wYear=1989 represents the time in 1989</p>\n</blockquote>\n<p>This is answer, I made a math error in calculating the hexadecimal to decimal, sorry guys~</p>\n<p>Happy autumn~\ud83d\ude18</p>\n"}], "owner": {"reputation": 219, "user_id": 7125206, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-khRuSoovh3U/AAAAAAAAAAI/AAAAAAAAAEM/S8yyc-eW90A/photo.jpg?sz=128", "display_name": "Hatsune", "link": "https://stackoverflow.com/users/7125206/hatsune"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1506070127, "creation_date": 1505901282, "last_edit_date": 1506069827, "question_id": 46318868, "link": "https://stackoverflow.com/questions/46318868/how-to-identify-the-meaning-of-the-myear-element-in-this-structure", "title": "How to identify the meaning of the mYear element in this structure\uff1f", "body": "<p>I had some question on Windows SYSTEMTIME struct description and explanation</p>\n\n<p>The Windwos SYSTEMTIME struct is like this</p>\n\n<pre><code>typedef struct _SYSTEMTIME {\n  WORD wYear;\n  WORD wMonth;\n  WORD wDayOfWeek;\n  WORD wDay;\n  WORD wHour;\n  WORD wMinute;\n  WORD wSecond;\n  WORD wMilliseconds;\n} SYSTEMTIME, *PSYSTEMTIME;\n</code></pre>\n\n<p>and the MSDN's explanation about the wYear is like this</p>\n\n<pre><code>The year. The valid values for this member are 1601 through 30827.\n</code></pre>\n\n<p>Now I got a SYSTEMTIME structure and the <code>wYear=834h</code></p>\n\n<p>How do I know how much the corresponding year is?</p>\n\n<hr>\n\n<h3>NOTE:</h3>\n\n<p>Q: <em>How did you get this SYSTEMTIME?</em></p>\n\n<p>A: <em>I am doing a reverse analysis of the virus with <code>IDA pro</code>, this structure is derived from the assembly code of the virus</em></p>\n\n<hr>\n\n<p>Q: <em>There is no magic offset, it starts at 0. You've got garbage data</em></p>\n\n<p>A: <em>I am sure about this is NOT garbage data, because this value is artificially given, the source assembly code is shown like this <code>mov [esp+40Ch+SystemTime.wYear], 834h</code></em></p>\n"}, {"tags": ["python", "c", "loops", "vector", "cython"], "comments": [{"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 1, "creation_date": 1505900424, "post_id": 46318475, "comment_id": 79598118, "body": "A good ol&#39; <code>for</code> loop over the indices, in which the first step is to get the pointer at index <code>i</code>?"}, {"owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "edited": false, "score": 0, "creation_date": 1505900435, "post_id": 46318475, "comment_id": 79598128, "body": "a for loop over indexes?"}, {"owner": {"reputation": 3737, "user_id": 2811074, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/XlxpL.jpg?s=128&g=1", "display_name": "Dalek", "link": "https://stackoverflow.com/users/2811074/dalek"}, "reply_to_user": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "edited": false, "score": 0, "creation_date": 1505900492, "post_id": 46318475, "comment_id": 79598166, "body": "@DanielSanchez I want to get both values and indexes of the pointer array in a loop."}, {"owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "edited": false, "score": 0, "creation_date": 1505900537, "post_id": 46318475, "comment_id": 79598204, "body": "@Dalek, use a normal for loop and then get the pointer with that index"}, {"owner": {"reputation": 3737, "user_id": 2811074, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/XlxpL.jpg?s=128&g=1", "display_name": "Dalek", "link": "https://stackoverflow.com/users/2811074/dalek"}, "reply_to_user": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "edited": false, "score": 0, "creation_date": 1505900792, "post_id": 46318475, "comment_id": 79598359, "body": "@DanielSanchez for instance if I give <code>index=1</code> to the pointer it returns the third element of the pointer in my code. I want to see what is going on.."}, {"owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "edited": false, "score": 0, "creation_date": 1505900825, "post_id": 46318475, "comment_id": 79598379, "body": "@Dalek, post your code then."}, {"owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "edited": false, "score": 0, "creation_date": 1505901655, "post_id": 46318475, "comment_id": 79598959, "body": "as a tip you shold visit and post on codereview, you will learn a lot. <a href=\"https://codereview.stackexchange.com\">codereview.stackexchange.com</a>"}, {"owner": {"reputation": 173469, "user_id": 901925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bbd70aaeb3a97d0087daf93c2be8804?s=128&d=identicon&r=PG", "display_name": "hpaulj", "link": "https://stackoverflow.com/users/901925/hpaulj"}, "edited": false, "score": 0, "creation_date": 1505925410, "post_id": 46318475, "comment_id": 79615731, "body": "This doesn&#39;t look like a codereview question.  It&#39;s not asking for improvements in code organization and style.  Plus there are more <code>cython</code> eyes here."}], "answers": [{"tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": false, "score": 3, "last_activity_date": 1505900588, "creation_date": 1505900588, "answer_id": 46318588, "question_id": 46318475, "link": "https://stackoverflow.com/questions/46318475/the-equivalence-of-enumerate-in-cython/46318588#46318588", "title": "The equivalence of &quot;enumerate&quot; in cython", "body": "<p>A simple for loop would suffice, like this:</p>\n\n<pre><code>for(int i = 0; i &lt; vecSize; ++i)\n    printf(\"Index = %d, Value = %d\\n\", i, vec[i]);\n</code></pre>\n\n<p>where <code>i</code> is the current index, <code>vec[i]</code> is the current element's value.</p>\n\n<p>PS: I assume that <code>vec</code> stores <code>int</code>s for this example and its size if <code>vecSize</code>.</p>\n"}], "owner": {"reputation": 3737, "user_id": 2811074, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/XlxpL.jpg?s=128&g=1", "display_name": "Dalek", "link": "https://stackoverflow.com/users/2811074/dalek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 921, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505902374, "creation_date": 1505900264, "last_edit_date": 1505902374, "question_id": 46318475, "link": "https://stackoverflow.com/questions/46318475/the-equivalence-of-enumerate-in-cython", "title": "The equivalence of &quot;enumerate&quot; in cython", "body": "<p>If one defines a pointer vector in <code>cython</code>, what is the similar function or procedure as <code>enumerate</code> in python to go through both indexes and values of elements in the pointer array in a loop inside a <strong>C</strong> declared type function?</p>\n\n<p><strong>test.pyx</strong></p>\n\n<pre><code>#cython: wraparound=False\n#cython: boundscheck=False\n#cython: cdivision=True\n#cython: nonecheck=False\nfrom cpython cimport array\nimport cython\nimport numpy as np\nimport ctypes\ncimport numpy as np\ncdef extern from \"math.h\":\n     cpdef double log(double x)\n     cpdef double exp(double x)\n\ndef void initial(int *ns, int *m, double *emax, double* x, double* hx, double*\n        hpx, int *lb, double *xlb, int *ub, double *xub, int* ifault, int* iwv,\n        double* rwv):\n      cdef int nn, ilow, ihigh, i\n      cdef int iipt, iz, ihuz, iscum, ix, ihx, ihpx\n      cdef bint horiz\n      cdef double hulb, huub, eps, cu, alcu, huzmax\n\n      eps = exp(-emax[0])\n      ifault[0] = 0\n      ilow = 0\n      ihigh = 0\n      nn = ns[0]+1\n\n      if (m[0] &lt; 1):\n         ifault[0] = 1\n\n      huzmax = hx[0]\n      if not ub[0]:\n         xub[0] = 0.0\n\n      if not lb[0]:\n         xlb[0] = 0.0\n\n      hulb = (xlb[0]-x[0])*hpx[0] + hx[0]\n      huub = (xub[0]-x[0])*hpx[0] + hx[0]\n      if (ub[0] and lb[0]):\n         huzmax = max(huub, hulb)\n          cu = exp((huub+hulb)*0.5-huzmax)*(xub[0]-xlb[0])  \n      else:\n         cu = 0.0\n         if (m[0] &lt; 2):\n             ifault[0] = 1\n\n      if (cu &gt; 0.0):\n          alcu = log(cu)\n      #set pointers\n      iipt = 5\n      iz = 8\n      ihuz = nn+iz\n      iscum = nn+ihuz\n      ix = nn+iscum\n      ihx = nn+ix\n      ihpx = nn+ihx\n      iwv[0] = ilow\n      iwv[1] = ihigh\n      iwv[2] = ns[0]\n      iwv[3] = 1\n      if lb[0]:\n         iwv[4] = 1\n      else:\n         iwv[4] = 0\n\n      if ub[0]:\n         iwv[5] = 1\n      else:\n         iwv[5] = 0\n\n      if ( ns[0] &lt; m[0]):\n         ifault[0] = 2\n\n      iwv[iipt+1] = 0\n      rwv[0] = hulb\n      rwv[1] = huub\n      rwv[2] = emax[0]\n      rwv[3] = eps\n      rwv[4] = cu\n      rwv[5] = alcu\n      rwv[6] = huzmax\n      rwv[7] = xlb[0]\n      rwv[8] = xub[0]\n      rwv[iscum+1] = 1.0\n      for i from 0 &lt;= i &lt; m[0]:\n         rwv[ix+i] = x[i]\n         rwv[ihx+i] = hx[i]\n         rwv[ihpx+i] = hpx[i]\n      i = 0\n      while (i &lt; m[0]):\n            update(&amp;iwv[3], &amp;iwv[0], &amp;iwv[1], &amp;iwv[iipt+1], &amp;rwv[iscum+1], &amp;rwv[4],\n                    &amp;rwv[ix+1], &amp;rwv[ihx+1], &amp;rwv[ihpx+1], &amp;rwv[iz+1],\n                    &amp;rwv[ihuz+1], &amp;rwv[6], &amp;rwv[2], lb, &amp;rwv[7], &amp;rwv[0], ub,\n                    &amp;rwv[8], &amp;rwv[1], ifault, &amp;rwv[3], &amp;rwv[5])\n            i = iwv[3]\n\ndef void update(int *n, int *ilow, int *ihigh, int* ipt, double* scum, double\n        *cu, double* x, double* hx, const double* hpx, double* z, double* huz,\n        double *huzmax, double *emax, int *lb, double *xlb, double *hulb, int *ub,\n        double *xub, double *huub, int* ifault, double *eps, double *alcu):\n\n\n      n[0] = n[0]+1\n      print \"number of points defining the hulls\", n[0]\n      print \" values of x: \" , x[0],x[1],x[n[0]] \n      print \"index of the smallest x(i)\", ilow[0] \n      print \" values of x: \" ,x[ilow[0]]                     \n      print \"Update z,huz and ipt   \"                              \n\ndef foo(int ns, int m, double emax,\n         np.ndarray[ndim=1, dtype=np.float64_t] x,\n         np.ndarray[ndim=1, dtype=np.float64_t] hx,\n         np.ndarray[ndim=1, dtype=np.float64_t] hpx,\n         int num):\n\n    cdef np.ndarray[ndim=1, dtype=np.float64_t] rwv\n    cdef np.ndarray[ndim=1, dtype=np.int64_t] iwv\n    # initializing arrays\n    rwv = np.zeros(ns*6+15, dtype=np.float64)\n    iwv = np.zeros(ns+7, dtype=np.int64)        \n    cdef double xlb = np.min(x)\n    cdef double xub = np.max(x)\n    cdef int lb=0\n    cdef int ub=0\n    cdef int ifault = 0\n    cdef double beta = 0.\n\n    initial(&amp;ns, &amp;m, &amp;emax,\n            &amp;x[0], \n            &amp;hx[0], \n            &amp;hpx[0], \n            &amp;lb, \n            &amp;xlb,\n            &amp;ub, \n            &amp;xub, \n            &amp;ifault, \n            &lt;int *&gt;(&amp;iwv[0]), \n            &amp;rwv[0] \n            )\n</code></pre>\n\n<p><strong>python code</strong></p>\n\n<pre><code>import numpy as np\nfrom test import foo\n\nm = 3\nns = 100\nemax = 64\n\nx = np.zeros(10, float)\nhx = np.zeros(10, float)\nhpx = np.zeros(10, float)\n\nx[0] = 0\nx[1] = 1.0\nx[2] = -1.0\nprint x\ndef normal(x):\n    return -x*x*0.5,-x\n\nhx[0], hpx[0] = normal(x[1])\nhx[1], hpx[1] = normal(x[2])\nhx[2], hpx[2] = normal(x[3])\nprint hpx\n\n\nnum = 20\nfoo(ns, m, emax, x, hx, hpx, num)\n</code></pre>\n"}, {"tags": ["c++", "c", "visual-studio", "character-encoding", "clion"], "answers": [{"tags": [], "owner": {"reputation": 313, "user_id": 2105501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45c64e49a69a60a94328fe105e936a3d?s=128&d=identicon&r=PG", "display_name": "Idan", "link": "https://stackoverflow.com/users/2105501/idan"}, "is_accepted": false, "score": 1, "last_activity_date": 1506075227, "last_edit_date": 1592644375, "creation_date": 1506075227, "answer_id": 46362260, "question_id": 46317752, "link": "https://stackoverflow.com/questions/46317752/how-to-change-project-character-set-in-jetbrains-clion/46362260#46362260", "title": "How to change Project Character Set in JetBrains Clion", "body": "<p>In CLion, you can change your project / file encoding under:</p>\n<blockquote>\n<p><strong>File</strong>-&gt;<strong>Settings</strong>-&gt;<strong>Editor</strong>-&gt;<strong>File encoding</strong>.</p>\n</blockquote>\n<p><a href=\"https://i.stack.imgur.com/NI5UX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NI5UX.png\" alt=\"CLion change encoding example\" /></a></p>\n<p>For further information, you can read: <a href=\"https://www.jetbrains.com/help/idea/configuring-individual-file-encoding.html\" rel=\"nofollow noreferrer\">https://www.jetbrains.com/help/idea/configuring-individual-file-encoding.html</a></p>\n"}, {"tags": [], "owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "is_accepted": true, "score": 2, "last_activity_date": 1506083582, "creation_date": 1506083582, "answer_id": 46364939, "question_id": 46317752, "link": "https://stackoverflow.com/questions/46317752/how-to-change-project-character-set-in-jetbrains-clion/46364939#46364939", "title": "How to change Project Character Set in JetBrains Clion", "body": "<p>All that this setting does is automatically set a preprocessor symbol.  Either <code>/D UNICODE</code> or <code>/D _MBCS</code> or nothing.</p>\n\n<p>It is the kind of setting you decide on very early and never change again.  With a bias towards Unicode, it doesn't make much sense to write C++ code and intentionally slow it down by using the Ansi adapter functions.  Visual Studio basically only has this setting because there are so many codebases out there that started life 20+ years ago, back when character sets still seemed a practical idea and Win9x was still popular.  Those days are over.</p>\n"}], "owner": {"reputation": 2152, "user_id": 3478155, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/24c1f942cac00e4715ebcbfc2a6291b4?s=128&d=identicon&r=PG&f=1", "display_name": "ilw", "link": "https://stackoverflow.com/users/3478155/ilw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1606, "favorite_count": 0, "accepted_answer_id": 46364939, "answer_count": 2, "score": 5, "last_activity_date": 1506094472, "creation_date": 1505898381, "last_edit_date": 1506094472, "question_id": 46317752, "link": "https://stackoverflow.com/questions/46317752/how-to-change-project-character-set-in-jetbrains-clion", "title": "How to change Project Character Set in JetBrains Clion", "body": "<p>I can change Project Character Set to Unicode or to Multi-Byte in Microsoft visual studio like what is shown in the picture.</p>\n\n<p><a href=\"https://i.stack.imgur.com/4bTXN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4bTXN.png\" alt=\"enter image description here\"></a></p>\n\n<p>But, is the same thing possible in <strong>clion</strong>?</p>\n"}, {"tags": ["c", "modulus", "integer-overflow", "memory-efficient"], "comments": [{"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 3, "creation_date": 1505895248, "post_id": 46316703, "comment_id": 79594707, "body": "By <code>a ^ b</code> you mean <code>a</code> raised to the power <code>b</code> or <code>bitwise XOR</code> of <code>a</code> and <code>b</code>?"}, {"owner": {"reputation": 1820, "user_id": 3849158, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/q1Gcg.png?s=128&g=1", "display_name": "izlin", "link": "https://stackoverflow.com/users/3849158/izlin"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1505895538, "post_id": 46316703, "comment_id": 79594906, "body": "@AjayBrahmakshatriya i thinks he means power because else it is much harder to get an overflow. However <code>^</code> in C is normally XOR, so pretty hard to say for sure."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 1820, "user_id": 3849158, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/q1Gcg.png?s=128&g=1", "display_name": "izlin", "link": "https://stackoverflow.com/users/3849158/izlin"}, "edited": false, "score": 0, "creation_date": 1505895585, "post_id": 46316703, "comment_id": 79594940, "body": "@izlin I figured he meant power but I was asking just to clarify."}, {"owner": {"reputation": 4852, "user_id": 5296568, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/25003db0bef370470e0f669a542960f8?s=128&d=identicon&r=PG&f=1", "display_name": "Maximilian Gerhardt", "link": "https://stackoverflow.com/users/5296568/maximilian-gerhardt"}, "edited": false, "score": 0, "creation_date": 1505896263, "post_id": 46316703, "comment_id": 79595365, "body": "Look at the iterative square-and-multiply algorithm for a general way of computing the exponentiation modulo n. (<a href=\"https://en.wikipedia.org/wiki/Exponentiation_by_squaring\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Exponentiation_by_squaring</a>). This can be even more efficient by using the k-ary- the improved k-ary or the sliding window method. Multiplications can be computed more efficiently when using the Karatsuba-Multiplication. Karatsuba + Sliding Window yields the fastest algorithm."}, {"owner": {"reputation": 1703, "user_id": 2204668, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/4870882fa42620da02bd089b4cd9672b?s=128&d=identicon&r=PG", "display_name": "Isaiah", "link": "https://stackoverflow.com/users/2204668/isaiah"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1505896621, "post_id": 46316703, "comment_id": 79595600, "body": "@AjayBrahmakshatriya, I did, thanks! Fixed it now!"}, {"owner": {"reputation": 1703, "user_id": 2204668, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/4870882fa42620da02bd089b4cd9672b?s=128&d=identicon&r=PG", "display_name": "Isaiah", "link": "https://stackoverflow.com/users/2204668/isaiah"}, "reply_to_user": {"reputation": 4852, "user_id": 5296568, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/25003db0bef370470e0f669a542960f8?s=128&d=identicon&r=PG&f=1", "display_name": "Maximilian Gerhardt", "link": "https://stackoverflow.com/users/5296568/maximilian-gerhardt"}, "edited": false, "score": 0, "creation_date": 1505896849, "post_id": 46316703, "comment_id": 79595728, "body": "@MaximilianGerhardt sorry I keep messing it up :]"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "reply_to_user": {"reputation": 4852, "user_id": 5296568, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/25003db0bef370470e0f669a542960f8?s=128&d=identicon&r=PG&f=1", "display_name": "Maximilian Gerhardt", "link": "https://stackoverflow.com/users/5296568/maximilian-gerhardt"}, "edited": false, "score": 0, "creation_date": 1505897010, "post_id": 46316703, "comment_id": 79595818, "body": "@MaximilianGerhardt you don&#39;t need to do the exponentiation as that would need a lot of time and memory for large powers"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1505897018, "post_id": 46316703, "comment_id": 79595822, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/32485750/calculate-abc-where-0-a-b-c-1018\">Calculate (a^b)%c where 0&lt;=a,b,c&lt;=10^18</a>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1505905241, "post_id": 46316703, "comment_id": 79601194, "body": "Post should clearly state <code>a,b</code> are integers."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1506042711, "post_id": 46316703, "comment_id": 79670629, "body": "the <code>pow()</code> function expects <code>double</code> for parameter types.  Not all integer values can be exactly represented via a <code>double</code>  so some integer values will not result in the same value after being run through this code."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1557499909, "post_id": 46316703, "comment_id": 98798235, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/11272437/calculating-abmod\">Calculating (a^b)%MOD</a>"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1557499923, "post_id": 46316703, "comment_id": 98798243, "body": "<a href=\"https://stackoverflow.com/q/27153665/995714\">Raising large number to large power and mod it by a large number?</a>, <a href=\"https://stackoverflow.com/q/32485750/995714\">Calculate (a^b)%c where 0&lt;=a,b,c&lt;=10^18</a>, <a href=\"https://stackoverflow.com/q/11272437/995714\">Calculating (a^b)%MOD</a>, <a href=\"https://stackoverflow.com/q/30138020/995714\">a to power b modulus k</a>..."}], "answers": [{"comments": [{"owner": {"reputation": 4852, "user_id": 5296568, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/25003db0bef370470e0f669a542960f8?s=128&d=identicon&r=PG&f=1", "display_name": "Maximilian Gerhardt", "link": "https://stackoverflow.com/users/5296568/maximilian-gerhardt"}, "edited": false, "score": 1, "creation_date": 1505896120, "post_id": 46316757, "comment_id": 79595279, "body": "The number of iterations for this algorithm would be <code>b</code> multiplications, which is very bad. The square-and-multiply algorithm achieves a complexity of <code>log2(b)</code> squarings and <code>hammingWeight(b)</code> (also at max <code>log2(b)</code>) multiplications. When <code>b=32768</code> your algorithm needs <code>32768</code> iterations, whereas the simple SQ+MUL needs 15 iterations."}, {"owner": {"reputation": 3705, "user_id": 8334991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v0H6m.jpg?s=128&g=1", "display_name": "Alexandre Fenyo", "link": "https://stackoverflow.com/users/8334991/alexandre-fenyo"}, "reply_to_user": {"reputation": 4852, "user_id": 5296568, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/25003db0bef370470e0f669a542960f8?s=128&d=identicon&r=PG&f=1", "display_name": "Maximilian Gerhardt", "link": "https://stackoverflow.com/users/5296568/maximilian-gerhardt"}, "edited": false, "score": 0, "creation_date": 1505896447, "post_id": 46316757, "comment_id": 79595486, "body": "Yes, you are totally right. I wanted to show the <b>simplest</b> algorithm that achieve the main goal in the question: not having an overflow in C. Of course, this is not the fastest algorithm, as you said."}, {"owner": {"reputation": 1703, "user_id": 2204668, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/4870882fa42620da02bd089b4cd9672b?s=128&d=identicon&r=PG", "display_name": "Isaiah", "link": "https://stackoverflow.com/users/2204668/isaiah"}, "edited": false, "score": 0, "creation_date": 1505896814, "post_id": 46316757, "comment_id": 79595710, "body": "@AlexandreFenyo thank you, this indeed works! However, I am also limited in the time it may take; the biggest Carmichael number  (a number  b that&#39;s not prime but also doesn&#39;t satify pow(a,b)%b == a with 2&lt;=a&lt;=b) within the limit for b is 29341, and this method would then have to be repeated 29341 as well, being considerably slow."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1505905943, "post_id": 46316757, "comment_id": 79601623, "body": "&quot;highest value for temp is 32767 ^ 2&quot; --&gt; I&#39;d say the highest value for temp is <code>32768</code>.  The <code>(temp * a) mod b</code> needs to be done with about 2x wider math."}, {"owner": {"reputation": 3705, "user_id": 8334991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v0H6m.jpg?s=128&g=1", "display_name": "Alexandre Fenyo", "link": "https://stackoverflow.com/users/8334991/alexandre-fenyo"}, "edited": false, "score": 0, "creation_date": 1505906304, "post_id": 46316757, "comment_id": 79601879, "body": "Yes your are right, I&#39;ve patched my answer. Thanks."}], "tags": [], "owner": {"reputation": 3705, "user_id": 8334991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v0H6m.jpg?s=128&g=1", "display_name": "Alexandre Fenyo", "link": "https://stackoverflow.com/users/8334991/alexandre-fenyo"}, "is_accepted": false, "score": 3, "last_activity_date": 1505906344, "last_edit_date": 1505906344, "creation_date": 1505895308, "answer_id": 46316757, "question_id": 46316703, "link": "https://stackoverflow.com/questions/46316703/how-to-efficiently-verify-whether-powa-b-b-a-in-c-without-overflow/46316757#46316757", "title": "How to efficiently verify whether pow(a, b) % b == a in C (without overflow)", "body": "<p>You are doing modular arithmetic in Z/bZ.</p>\n\n<p>Note that, in a quotient ring, the n-th power of the class of an element is the class of the n-th power of the element, so we have the following result:</p>\n\n<pre><code>(a^b) mod b = ((((a mod b) * a) mod b) * a) mod b [...] (b times)\n</code></pre>\n\n<p>So, you do not need a big integer library.</p>\n\n<p>You can simply write a C program using the following algorithm (pseudo-code):</p>\n\n<ul>\n<li>declare your variables a and b as integers.</li>\n<li>use a temporary variable temp that is initialized with a.</li>\n<li>do a loop with b steps, and compute <code>(temp * a) mod b</code> at each step, to get the new temp value.</li>\n<li>compare the result with a.</li>\n</ul>\n\n<p>With this formula, you can see that the highest value for temp is 32768, so you can choose an <strong>integer</strong> to store temp.</p>\n"}, {"comments": [{"owner": {"reputation": 1703, "user_id": 2204668, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/4870882fa42620da02bd089b4cd9672b?s=128&d=identicon&r=PG", "display_name": "Isaiah", "link": "https://stackoverflow.com/users/2204668/isaiah"}, "edited": false, "score": 0, "creation_date": 1505897741, "post_id": 46317398, "comment_id": 79596312, "body": "This works indeed! I had looked at this already but had difficulty implementing it, this seems to work! (but you forgot ; after res = 1 :). Thank you!"}, {"owner": {"reputation": 4852, "user_id": 5296568, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/25003db0bef370470e0f669a542960f8?s=128&d=identicon&r=PG&f=1", "display_name": "Maximilian Gerhardt", "link": "https://stackoverflow.com/users/5296568/maximilian-gerhardt"}, "edited": false, "score": 1, "creation_date": 1505897909, "post_id": 46317398, "comment_id": 79596440, "body": "Apart from data types (<code>short</code> or <code>unsigned short</code>, for input parameters, return type and <code>res</code> datatype to <code>unsigned long int</code> or <code>long int</code>), this looks good. Maybe also braces around <code>res = (res*num) % mod</code>. +1."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1505905596, "post_id": 46317398, "comment_id": 79601402, "body": "Corner case failure: This <code>pow_mod(num, 0, 1)</code> --&gt; 1 and should be 0.  Suggest change: <code>int res = 1%mod;</code>.  But then OP did say: 2 \u2264 a \u2264 b."}], "tags": [], "owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "is_accepted": true, "score": 5, "last_activity_date": 1505897927, "last_edit_date": 1505897927, "creation_date": 1505897282, "answer_id": 46317398, "question_id": 46316703, "link": "https://stackoverflow.com/questions/46316703/how-to-efficiently-verify-whether-powa-b-b-a-in-c-without-overflow/46317398#46317398", "title": "How to efficiently verify whether pow(a, b) % b == a in C (without overflow)", "body": "<p>You can use the <a href=\"https://en.wikipedia.org/wiki/Exponentiation_by_squaring\" rel=\"nofollow noreferrer\">Exponentiation by squaring</a> method.</p>\n\n<p>The idea is the following:</p>\n\n<ul>\n<li>Decompose <code>b</code> in binary form and decompose the product</li>\n<li>Notice that we always use <code>%b</code> which is below 32768, so the result will always fit in a 32 bit number.</li>\n</ul>\n\n<p>So the C code is:</p>\n\n<pre><code>/*\n * this function computes (num ** pow) % mod\n */\nint pow_mod(int num, int pow, int mod)\n{\n    int res = 1\n\n    while (pow&gt;0)\n    {\n        if (pow &amp; 1)\n        {\n            res = (res*num) % mod;\n        }\n        pow /= 2;\n        num = (num*num)%mod;\n    }\n\n    return res;\n}\n</code></pre>\n"}], "owner": {"reputation": 1703, "user_id": 2204668, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/4870882fa42620da02bd089b4cd9672b?s=128&d=identicon&r=PG", "display_name": "Isaiah", "link": "https://stackoverflow.com/users/2204668/isaiah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 0, "accepted_answer_id": 46317398, "answer_count": 2, "score": 3, "last_activity_date": 1505906344, "creation_date": 1505895177, "last_edit_date": 1505906264, "question_id": 46316703, "link": "https://stackoverflow.com/questions/46316703/how-to-efficiently-verify-whether-powa-b-b-a-in-c-without-overflow", "title": "How to efficiently verify whether pow(a, b) % b == a in C (without overflow)", "body": "<p>I'd like to verify whether  </p>\n\n<blockquote>\n  <p>pow(a, b) % b == a</p>\n</blockquote>\n\n<p>is true in C, with 2 \u2264 b \u2264 32768 (2<sup>15</sup>) and 2 \u2264 a \u2264 b with a and b being integers.</p>\n\n<p>However, directly computing <code>pow(a, b) % b</code> with b being a large number, this will quickly cause C to overflow. What would be a trick/efficient way of verifying whether this condition holds?  </p>\n\n<p>This question is based on finding a witness for Fermat's little theorem, which states that if this condition is false, b is not prime.  </p>\n\n<p>Also, I am also limited in the time it may take, it can't be too slow (near or over 2 seconds). The biggest Carmichael number, a number <code>b</code> that's not prime but also doesn't satisfy <code>pow(a, b)% b  == a</code> with <code>2 &lt;= a &lt;= b</code> (with b &lt;= 32768) is 29341. Thus the method for checking <code>pow(a, b) % b == a</code> with <code>2 &lt;= a &lt;= 29341</code> shouldn't be too slow. </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 852, "user_id": 3227496, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/874115077/picture?type=large", "display_name": "Hans Petter Taugb&#248;l Kragset", "link": "https://stackoverflow.com/users/3227496/hans-petter-taugb%c3%b8l-kragset"}, "edited": false, "score": 2, "creation_date": 1505892145, "post_id": 46315630, "comment_id": 79592771, "body": "Please read <a href=\"https://stackoverflow.com/help/mcve\">How to create a minimal, complete, and verifiable example</a>"}, {"owner": {"reputation": 4827, "user_id": 8051589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VNG6.png?s=128&g=1", "display_name": "Andre Kampling", "link": "https://stackoverflow.com/users/8051589/andre-kampling"}, "edited": false, "score": 1, "creation_date": 1505892186, "post_id": 46315630, "comment_id": 79592801, "body": "<a href=\"https://stackoverflow.com/questions/492384/how-to-find-the-sizeof-a-pointer-pointing-to-an-array\">How to find the &#39;sizeof&#39; (a pointer pointing to an array)?</a> --&gt; You can&#39;t... means your <code>int total = sizeof(a-&gt;seating);</code> fails."}, {"owner": {"reputation": 4827, "user_id": 8051589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VNG6.png?s=128&g=1", "display_name": "Andre Kampling", "link": "https://stackoverflow.com/users/8051589/andre-kampling"}, "edited": false, "score": 3, "creation_date": 1505892721, "post_id": 46315630, "comment_id": 79593144, "body": "You asked yesterday about the same code you show now and I commented already: &lt;&lt;You should take <a href=\"https://stackoverflow.com/questions/562303/the-definitive-c-book-guide-and-list\">a good C book</a> and learn the basics.&gt;&gt; I don&#39;t want to offend you but if you won&#39;t do that you will have questions again and again. It is simply more effective to really learn the basic stuff before asking here."}, {"owner": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 0, "creation_date": 1505939672, "post_id": 46315630, "comment_id": 79623437, "body": "That is a lot of unnecessary code.  Please edit your question down to the minimum code needed to reproduce the question."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 8631170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46550e59a851fc35d82cb76a102d5850?s=128&d=identicon&r=PG&f=1", "display_name": "Deathknight921", "link": "https://stackoverflow.com/users/8631170/deathknight921"}, "edited": false, "score": 0, "creation_date": 1505952192, "post_id": 46331305, "comment_id": 79627591, "body": "thanks for the help :D but the main was already given in the question (couldn&#39;t do anything about that). i resolved the array size matter by setting up global variables, and accessing them from there."}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "reply_to_user": {"reputation": 9, "user_id": 8631170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46550e59a851fc35d82cb76a102d5850?s=128&d=identicon&r=PG&f=1", "display_name": "Deathknight921", "link": "https://stackoverflow.com/users/8631170/deathknight921"}, "edited": false, "score": 0, "creation_date": 1505978768, "post_id": 46331305, "comment_id": 79635400, "body": "You&#39;re... helpless? I very highly doubt that. You could... stand up in class and say... &quot;This guy is telling me it&#39;s wrong to use <code>void main</code>. Why is he saying that?&quot;"}], "tags": [], "owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "is_accepted": false, "score": 1, "last_activity_date": 1505939571, "creation_date": 1505939571, "answer_id": 46331305, "question_id": 46315630, "link": "https://stackoverflow.com/questions/46315630/accessing-2d-arrays-in-c/46331305#46331305", "title": "accessing 2d arrays in C", "body": "<p>The sheer number of problems you seem to be experiencing are generally reflective of a certain percentage of the population who <em>doesn't read books</em>. I'm just putting it out there, that it seems like you're one of those people, and that it's pretty obvious to many of us. Do you want to seem like <em>one of those people</em>?</p>\n\n<p>Hopefully, you can prove me wrong, as <em>those people</em> shouldn't even bother to ask here if they're unwilling to read...</p>\n\n<hr>\n\n<pre><code>int total = sizeof(a-&gt;seating);\n</code></pre>\n\n<p>What even is this? Okay, for a start, a <code>sizeof</code> expression is a <code>size_t</code> type, not an <code>int</code> type. This makes sense when you don't want to have to write negative-handling code such as <code>check_boundaries</code>. It saves those who invest in <em>reading a book</em> many, many keystrokes.</p>\n\n<p>You need to modify your <code>struct auditorium_seating</code> (which is currently nothing more than a misguided <code>typedef</code>) to store that information, as the <code>sizeof</code> operator does most of its work <em>at compile time</em> rather than <em>runtime</em>, so it can't retrieve the size of <code>malloc</code>-returned objects.</p>\n\n<p>You seem to have some dilemma with regards to this, so allow me to get you started:</p>\n\n<pre><code>struct auditorium_seating {\n    size_t row_size, column_size;    // and along with this comes more code throughout your project\n    struct guest **seating;\n};\n\nint check_boundaries(size_t row, size_t column, struct auditorium_seatching *a) {\n    return (row &lt; a-&gt;row_size &amp;&amp; column &lt; a-&gt;column_size);\n}\n</code></pre>\n\n<p>When you modify <code>seating</code> (i.e. initialise, or \"add elements to it\"), you might need to also modify <code>row_size</code> or <code>column_size</code>. Go forth and make these changes to your code. That is all.</p>\n\n<hr>\n\n<blockquote>\n<pre><code>void main()\n</code></pre>\n</blockquote>\n\n<p>In C, <code>main</code> should (almost) <em>always</em> be declared to return <code>int</code>. When it isn't, you should know <em>why</em> it isn't. In this case, there's no evidence to suggest that you do know <em>why</em> you chose <code>void</code>, where-as there should be.</p>\n\n<p>Just use <code>int</code>, here, and... heed this warning: C is not the kind of language which necessarily punishes you with an error message when you do something wrong. Mistakes often go unnoticed for many years before they crop up as security vulnerabilities, <em>heartbleed</em> being one example.</p>\n\n<p>Please, if you haven't done so already, save us from another <em>heartbleed</em>, and get yourself a book to read!</p>\n\n<hr>\n\n<blockquote>\n<pre><code>/* we will read line by line **/\n</code></pre>\n</blockquote>\n\n<p><strong>Spoiler alert!</strong> That's not what <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/fscanf.html\" rel=\"nofollow noreferrer\">the manual</a> says!</p>\n\n<p><em>\"<code>s</code> Matches a sequence of bytes that are not white-space characters.\"</em></p>\n\n<p>It wouldn't surprise me if you missed this small detail, as those who prefer not to read books also prefer not to read in general. If you're one of <em>those people</em>, you <em>shouldn't</em> be a programmer. Pick fruit, instead.</p>\n\n<hr>\n\n<blockquote>\n<pre><code>printf(\"\\nA guest information is read.\");\n</code></pre>\n</blockquote>\n\n<p>There is a reason we put the <code>'\\n'</code> at the end. You would need to read to find that reason, of course. Hey, you're reading this answer! Why not read a book, which would tell you all about all of these things (and more)?</p>\n\n<p><code>'\\n'</code> causes an implicit <code>fflush</code> when it's written to a line-buffered stream. Hence, if you want to ensure that output appears immediately on the terminal, you need to put the <code>'\\n'</code> at the end, or call <code>fflush(stdout);</code> after <code>printf</code>... Your choice. I'd rather <em>the less hideous options</em>.</p>\n"}], "owner": {"reputation": 9, "user_id": 8631170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46550e59a851fc35d82cb76a102d5850?s=128&d=identicon&r=PG&f=1", "display_name": "Deathknight921", "link": "https://stackoverflow.com/users/8631170/deathknight921"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1505939571, "creation_date": 1505892028, "question_id": 46315630, "link": "https://stackoverflow.com/questions/46315630/accessing-2d-arrays-in-c", "title": "accessing 2d arrays in C", "body": "<p>Hi following is my code i need help in the check_boundary function as how can i retrieve my initialized 2d (seating) array so that i can compare it with the new row and column number, currently i am getting 0 0 row and column in that function if i print that. the seating array is instantiated in the auditorium_seating_init function. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nstruct guest {\n    char last_name[30];\n    char first_name[30];\n};\nstruct auditorium_seating {\n    struct guest **seating;\n};\nvoid guest_init_default(struct guest *g)\n{\n\n    strcpy_s(g-&gt;first_name,sizeof(g-&gt;first_name), \"???\");\n    strcpy_s(g-&gt;last_name, sizeof(g-&gt;last_name), \"???\");\n}\nvoid guest_init(struct guest *g, char *info)\n{\n    char *token,*token1;\n        token1 = strtok_s(info, \"/\",&amp;token);\n        strcpy_s(g-&gt;first_name,sizeof(g-&gt;first_name), token1);\n        token=strtok_s(NULL, \"/\", &amp;token);\n        strcpy_s(g-&gt;last_name, sizeof(g-&gt;last_name), token);\n\n}\nvoid guest_to_string(struct guest *g)\n{\n    printf(\"%c\", g-&gt;first_name[0]);\n    printf(\".%c\", g-&gt;last_name[0]);\n}\nvoid auditorium_seating_init(int rowNum, int columnNum, struct auditorium_seating *a)\n{\n    a-&gt;seating = malloc(rowNum * sizeof(a-&gt;seating));\n    for (int i = 0; i &lt; rowNum; i++) {\n        a-&gt;seating[i] = malloc(columnNum * sizeof(**a-&gt;seating));\n        for (int j = 0; j &lt; columnNum; j++) {\n\n            guest_init_default(&amp;a-&gt;seating[i][j]);\n        }\n    }\n\n}\nint assign_guest_at(int row, int col, struct auditorium_seating *a, struct guest* g)\n{\n\n    if ((strcmp(a-&gt;seating[row][col].first_name , \"???\") == 1 ) &amp;&amp; (strcmp(a-&gt;seating[row][col].last_name, \"???\") == 1))\n    {\n        a-&gt;seating[row][col] = *g;\n\n\n        return 1;\n    }\n    else\n    {\n        return 0;\n    }\n}\n</code></pre>\n\n<p>This function</p>\n\n<pre><code>int check_boundaries(int row, int col, struct auditorium_seating *a)\n{\n    int total = sizeof(a-&gt;seating);\n    //printf(\"total %d\", sizeof(a-&gt;seating));\n    //printf(\"col %d\", sizeof(a-&gt;seating) / sizeof(a-&gt;seating[0]));\n    //printf(\"row %d\", sizeof(a-&gt;seating[0]) / sizeof(a-&gt;seating[0][0]));\n    if (row &gt;= 0 &amp;&amp; col &gt;= 0 &amp;&amp; (col &lt;= sizeof(a-&gt;seating[0])) &amp;&amp; row &lt;= (total / sizeof(a-&gt;seating[0]))) {\n        //printf(\"col %p\",sizeof(a-&gt;seating[0]));\n        //printf(\"row %p\", total/sizeof(a-&gt;seating[0]));\n        return 1;\n    }\n    else\n    {\n        return 0;\n    }\n}\n</code></pre>\n\n<p>This is my main</p>\n\n<pre><code>void main() {\n    struct auditorium_seating auditorium_seating;\n    struct guest temp_guest;\n    int row, col, rowNum, columnNum;\n    char guest_info[30];\n    // Ask a user to enter a number of rows for an auditorium seating\n    printf(\"Please enter a number of rows for an auditorium seating.\");\n    scanf_s(\"%d\", &amp;rowNum);\n    // Ask a user to enter a number of columns for an auditorium seating\n    printf(\"Please enter a number of columns for an auditorium seating.\");\n    scanf_s(\"%d\", &amp;columnNum);\n    /*** reading a guest's information ***/\n    // auditorium_seating\n\n    //scanf_s(\"%c\", guest_info);\n    auditorium_seating_init(rowNum, columnNum, &amp;auditorium_seating);\n    printf(\"Please enter a guest information or enter \\\"Q\\\" to quit.\");\n    /*** reading a guest's information ***/\n    scanf_s(\"%s\", guest_info, sizeof(guest_info));\n    //scanf(\"%s\", guest_info);\n    /* we will read line by line **/\n\n    while ( strcmp(guest_info,\"Q\")==1) {\n\n        printf(\"\\nA guest information is read.\");\n        // printing information.\n        printf(\"%s\", guest_info);\n        // guest\n        guest_init(&amp;temp_guest, &amp;guest_info);\n        // Ask a user to decide where to seat a guest by asking\n        // for row and column of a seat\n        printf(\"Please enter a row number where the guest wants to sit.\");\n        scanf_s(\"%d\", &amp;row);\n        printf(\"Please enter a column number where the guest wants to sit.\");\n        scanf_s(\"%d\", &amp;col);\n        // Checking if the row number and column number are valid\n        // (exist in the theatre that we created.)\n        if (check_boundaries(row, col, &amp;auditorium_seating) == 0) {\n            printf(\"\\nrow or column number is not valid.\");\n            printf(\"A guest %s %s is not assigned a seat.\", temp_guest.first_name, temp_guest.last_name);\n        }\n        else {\n            // Assigning a seat for a guest\n            if (assign_guest_at(row, col, &amp;auditorium_seating, &amp;temp_guest) == 1) {\n                printf(\"\\nThe seat at row %d and column %d is assigned to the guest\", row, col);\n                guest_to_string(&amp;temp_guest);\n                auditorium_seating_to_string(&amp;auditorium_seating);\n            }\n            else {\n                printf(\"\\nThe seat at row %d and column %d is taken.\", row, col);\n            }\n        }\n        // Read the next guestInfo\n        printf(\"Please enter a guest information or enter \\\"Q\\\" to quit.\");\n        /*** reading a guest's information ***/\n        scanf_s(\"%s\", guest_info, sizeof(guest_info));\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "function", "fork", "calculator", "waitpid"], "comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1505891573, "post_id": 46315402, "comment_id": 79592440, "body": "Read <a href=\"http://advancedlinuxprogramming.com/\" rel=\"nofollow noreferrer\">advancedlinuxprogramming.com</a> and spend several days in reading stuff (including <a href=\"http://man7.org/linux/man-pages/man2/waitpid.2.html\" rel=\"nofollow noreferrer\">waitpid(2)</a>, <a href=\"http://man7.org/linux/man-pages/man2/fork.2.html\" rel=\"nofollow noreferrer\">fork(2)</a>, <a href=\"http://man7.org/linux/man-pages/man7/pipe.7.html\" rel=\"nofollow noreferrer\">pipe(7)</a>, <a href=\"http://man7.org/linux/man-pages/man2/waitpid.2.html\" rel=\"nofollow noreferrer\">execve(2)</a>, <a href=\"http://man7.org/linux/man-pages/man3/popen.3.html\" rel=\"nofollow noreferrer\">popen(3)</a>..). Your question shows a profound misunderstanding and don&#39;t have much sense. Read also about <a href=\"http://pages.cs.wisc.edu/~remzi/OSTEP/\" rel=\"nofollow noreferrer\">Operating Systems</a>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1505892632, "post_id": 46315402, "comment_id": 79593076, "body": "All your arithmetic is integer arithmetic; you&#39;ll never get a floating point value from it.  Your exit codes are limited to 255; that may cause problems too.  The nested ifs with the chain of else&#39;s feels clumsy.  You&#39;d do better forking and testing for the 0 return value from fork (the child) and doing some action else forking the next child."}, {"owner": {"reputation": 93, "user_id": 6166696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c9ae62a464b624ff1c9a26c2ec1c8f01?s=128&d=identicon&r=PG&f=1", "display_name": "Dreeww", "link": "https://stackoverflow.com/users/6166696/dreeww"}, "edited": false, "score": 0, "creation_date": 1505894066, "post_id": 46315402, "comment_id": 79593968, "body": "Yeah thats my problem i need a floating point return. So im wondering will casting after calling waitpid work?"}], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 6166696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c9ae62a464b624ff1c9a26c2ec1c8f01?s=128&d=identicon&r=PG&f=1", "display_name": "Dreeww", "link": "https://stackoverflow.com/users/6166696/dreeww"}, "edited": false, "score": 1, "creation_date": 1505894910, "post_id": 46315494, "comment_id": 79594504, "body": "Yeah i think my approach to the division calculator was wrong."}], "tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": true, "score": 3, "last_activity_date": 1505891602, "creation_date": 1505891602, "answer_id": 46315494, "question_id": 46315402, "link": "https://stackoverflow.com/questions/46315402/changing-parameters-of-waitpid/46315494#46315494", "title": "Changing Parameters of waitpid()", "body": "<p>The third parameter of <a href=\"https://linux.die.net/man/2/waitpid\" rel=\"nofollow noreferrer\"><code>pid_t waitpid(pid_t pid, int *status, int options);</code></a> is an <code>int</code>, thus you cannot pass a floating point value there.</p>\n\n<p>It wouldn't make sense to pass such a value there as a matter of fact. You need to study harder and reconsider your approach.</p>\n"}], "owner": {"reputation": 93, "user_id": 6166696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c9ae62a464b624ff1c9a26c2ec1c8f01?s=128&d=identicon&r=PG&f=1", "display_name": "Dreeww", "link": "https://stackoverflow.com/users/6166696/dreeww"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 46315494, "answer_count": 1, "score": 0, "last_activity_date": 1505891612, "creation_date": 1505891265, "last_edit_date": 1505891612, "question_id": 46315402, "link": "https://stackoverflow.com/questions/46315402/changing-parameters-of-waitpid", "title": "Changing Parameters of waitpid()", "body": "<p>I'm wondering if you can change the parameters of \n<code>waitpid()</code>\n At the moment I require continuous variable output ( <code>0.50</code> ) to be what is printed. However given that <code>waitpid()</code> only accepts integers when I try and printout it gives me 0. Unsure how to fix this or if this even is the problem.</p>\n\n<p>Calculation is meant to look like (1+(2 * 3)/(2 * 7)) = 0.5</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/wait.h&gt;\n\nint main(){\n\n\n    int a = 1, b = 2, c = 3, d = 2, e = 7;\n\n    int a_plus_pid, b_times_c_pid, d_times_e_pid;\n\n    int a_plus, b_times_c, d_times_e;\n\n    a_plus_pid = fork();\n    if(a_plus_pid)\n        {\n            b_times_c_pid = fork();\n            if(b_times_c_pid)\n            {\n                    d_times_e_pid = fork();\n                    if(d_times_e_pid)\n                    {\n\n                        waitpid(a_plus_pid, &amp;a_plus, 0);\n                        waitpid(b_times_c_pid, &amp;b_times_c, 0);\n                        waitpid(d_times_e_pid, &amp;d_times_e, 0);\n\n                        //Supposed to print 0.50\n                        printf(\"%d\" , ((a + (b_times_c))) / d_times_e);\n\n                    }\n                    else\n                    {\n                        exit(d*e);\n                    }\n            }\n            else\n            {\n                exit(b*c);\n            }\n        }\n        else\n        {\n             exit(a);\n        }\n\n}\n</code></pre>\n"}, {"tags": ["c", "recursion"], "comments": [{"owner": {"reputation": 2988, "user_id": 452414, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rDMfs.png?s=128&g=1", "display_name": "babon", "link": "https://stackoverflow.com/users/452414/babon"}, "edited": false, "score": 4, "creation_date": 1505889977, "post_id": 46315003, "comment_id": 79591507, "body": "I expected this <code>Count7(171)=0</code> to be <code>1</code> as there <i>is</i> a <code>7</code>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1505890152, "post_id": 46315003, "comment_id": 79591610, "body": "BTW: <code>count7(n)</code> is wrong, it should be <code>int count7(n)</code>. And please format your code correctly, just like they do in your C textbook."}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 2, "creation_date": 1505890924, "post_id": 46315003, "comment_id": 79592063, "body": "<code>n</code> is either <code>7</code> or it isn&#39;t, so your last line will never execute."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 2, "creation_date": 1505891011, "post_id": 46315003, "comment_id": 79592121, "body": "<code>int count7(int n){ \tif(!n) \t\treturn 0; \treturn (n % 10 == 7) + count7(n&#47;10); }</code>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1505892197, "post_id": 46315003, "comment_id": 79592805, "body": "Your code never reaches the recursion \u2014 for any value <code>n</code>, the value is either 0 or 7 or not 7, so the recursive code is never executed."}, {"owner": {"reputation": 47, "user_id": 8638848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de00125d570f7aabac6c2391e16a906c?s=128&d=identicon&r=PG&f=1", "display_name": "CryBaby", "link": "https://stackoverflow.com/users/8638848/crybaby"}, "edited": false, "score": 0, "creation_date": 1505892783, "post_id": 46315003, "comment_id": 79593191, "body": "say if n=5 which is not equal to 7 it will result in termination of program, Please correct me if i am wrong"}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1505892302, "post_id": 46315086, "comment_id": 79592864, "body": "You might also consider the case of <code>n &lt; 0</code>, but your point about every value being 0 or 7 or not 7 is valid \u2014 the OP&#39;s code never recurses."}], "tags": [], "owner": {"reputation": 2375, "user_id": 3985859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34af6d164c53c629e625c11a3d11bbcc?s=128&d=identicon&r=PG&f=1", "display_name": "Karsten Koop", "link": "https://stackoverflow.com/users/3985859/karsten-koop"}, "is_accepted": false, "score": 2, "last_activity_date": 1505890170, "creation_date": 1505890170, "answer_id": 46315086, "question_id": 46315003, "link": "https://stackoverflow.com/questions/46315003/coding-bat-beginner-recursion/46315086#46315086", "title": "Coding bat beginner recursion", "body": "<p>You have </p>\n\n<pre><code>if (n==7) return 1;\n</code></pre>\n\n<p>followed by</p>\n\n<pre><code>if (n!=7) return 0;\n</code></pre>\n\n<p>As <code>n</code> is either 7 or not 7, everything that comes after will never be called. Instead you probably want </p>\n\n<pre><code>if (n&lt;10) return 0;\n</code></pre>\n\n<p>as you want to call the recursion for numbers with more than 1 digit, and break here if you reached the last digit. </p>\n\n<p>BTW, you could also remove the <code>if (n==0)</code> part, as this is also covered by the <code>n&lt;10</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 2988, "user_id": 452414, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rDMfs.png?s=128&g=1", "display_name": "babon", "link": "https://stackoverflow.com/users/452414/babon"}, "is_accepted": false, "score": 0, "last_activity_date": 1505890877, "last_edit_date": 1505890877, "creation_date": 1505890450, "answer_id": 46315165, "question_id": 46315003, "link": "https://stackoverflow.com/questions/46315003/coding-bat-beginner-recursion/46315165#46315165", "title": "Coding bat beginner recursion", "body": "<p>The base case checks if there is just a single digit and if it is a <code>7</code> or not. Then, we recursively add the number of <code>7</code>s in the remaining digits to whatever was found before (<code>rem == 7 ? 1 : 0</code>). This is just another bare-bones program. I am sure you can pick up from here.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint count7(int i)\n{\n    int rem = i % 10;  // remainder\n    int quo = i / 10;  // quotient\n\n    if (rem == i) {    // base case - check for a single digit.\n        if (rem == 7)\n            return 1;\n        else\n            return 0;\n    } else {\n        return (rem == 7 ? 1 : 0) + count7(quo);\n    }\n}\n\nint main(void) {\n    int i = 12;\n    printf(\"%d\\n\", count7(i));\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 48, "user_id": 8249763, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wqyKNLz7G1M/AAAAAAAAAAI/AAAAAAAAHvY/ml7a2tm0hv4/photo.jpg?sz=128", "display_name": "Calden Rodrigues", "link": "https://stackoverflow.com/users/8249763/calden-rodrigues"}, "is_accepted": false, "score": 0, "last_activity_date": 1505894919, "creation_date": 1505894919, "answer_id": 46316623, "question_id": 46315003, "link": "https://stackoverflow.com/questions/46315003/coding-bat-beginner-recursion/46316623#46316623", "title": "Coding bat beginner recursion", "body": "<p>The following code is completely functional.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nvoid main()\n{\nprintf(\"%d\\n\",count7(717));\n}\nint count7(int n)\n{\nif(n==7)\n    return 1;\nelse if(n&lt;10)\n    return 0;\nelse\n    return count7(n%10)+count7(n/10);\n}  \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 47, "user_id": 8638848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de00125d570f7aabac6c2391e16a906c?s=128&d=identicon&r=PG&f=1", "display_name": "CryBaby", "link": "https://stackoverflow.com/users/8638848/crybaby"}, "edited": false, "score": 0, "creation_date": 1505909879, "post_id": 46318878, "comment_id": 79604368, "body": "yeah got it ...thanks for clearing . Is there any way i can become good at recursion."}, {"owner": {"reputation": 407, "user_id": 6566252, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7772f443cf60b1154e74ff398fbbe41d?s=128&d=identicon&r=PG&f=1", "display_name": "Bizzu", "link": "https://stackoverflow.com/users/6566252/bizzu"}, "reply_to_user": {"reputation": 47, "user_id": 8638848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de00125d570f7aabac6c2391e16a906c?s=128&d=identicon&r=PG&f=1", "display_name": "CryBaby", "link": "https://stackoverflow.com/users/8638848/crybaby"}, "edited": false, "score": 0, "creation_date": 1505910076, "post_id": 46318878, "comment_id": 79604521, "body": "The best way is practice, and use it only when you need :)"}, {"owner": {"reputation": 47, "user_id": 8638848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de00125d570f7aabac6c2391e16a906c?s=128&d=identicon&r=PG&f=1", "display_name": "CryBaby", "link": "https://stackoverflow.com/users/8638848/crybaby"}, "edited": false, "score": 0, "creation_date": 1505910616, "post_id": 46318878, "comment_id": 79604934, "body": "So the problem was with the base case, not the recursive function"}], "tags": [], "owner": {"reputation": 407, "user_id": 6566252, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7772f443cf60b1154e74ff398fbbe41d?s=128&d=identicon&r=PG&f=1", "display_name": "Bizzu", "link": "https://stackoverflow.com/users/6566252/bizzu"}, "is_accepted": false, "score": 0, "last_activity_date": 1505901748, "last_edit_date": 1505901748, "creation_date": 1505901297, "answer_id": 46318878, "question_id": 46315003, "link": "https://stackoverflow.com/questions/46315003/coding-bat-beginner-recursion/46318878#46318878", "title": "Coding bat beginner recursion", "body": "<p>There are some problems that I found in your code,</p>\n\n<p>The <code>critical problem</code> is that you check if <code>n!=7</code> and befor you check if <code>n==7</code> </p>\n\n<p>that combination will equal to Ask the condition <code>if() {} else {}</code> that mean that in this case\nyou will not get to the next line - <code>return count7(n%10)+count7(n/10)</code> Never!!!!</p>\n\n<p>Another thing that I saw is that you call at the return to <code>count7</code> with the remainder of the number, it will work, but if you need to do a simple operation (check only if the remainder ==7 ) so my advice is to use to <code>? :</code> condition and not to jump to function if you don't need.</p>\n\n<p>My Code to your problem:</p>\n\n<pre><code>int count7(int n)\n{\n    return n==0 ? 0 : (n==7 ? 1 : count7(n/10) + (n%10 == 7 ? 1 : 0) );\n}\n</code></pre>\n\n<p>And another code more readably (do the same work) : </p>\n\n<pre><code>int count7(int curNum)\n{\n    int curModNum=n%10;\n    int curDivNum=n/10;\n    if (currentNum==EMPTY_NUM) {\n        return EMPTY_NUM;\n    }\n    if (curNum==LUCKY_NUM) { \n        return ADD_ONE; \n    }\n    return count7(curDivNum) + (curModNum == LUCKY_NUM ? ADD_ONE : EMPTY_NUM); \n}\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 8638848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de00125d570f7aabac6c2391e16a906c?s=128&d=identicon&r=PG&f=1", "display_name": "CryBaby", "link": "https://stackoverflow.com/users/8638848/crybaby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1505901748, "creation_date": 1505889864, "last_edit_date": 1505891058, "question_id": 46315003, "link": "https://stackoverflow.com/questions/46315003/coding-bat-beginner-recursion", "title": "Coding bat beginner recursion", "body": "<p>I am unable to find the logic for recursion in the problem mentioned below.\nGiven a non-negative int n, return the count of the occurrences of 7 as a digit</p>\n\n<p>Eg. Count7(777)=3</p>\n\n<p>Eg. Count7(123)=0</p>\n\n<p>Eg. Count7(171)=1</p>\n\n<p>Here is the logic that i applied</p>\n\n<p>count number of 7 in ones place + count no of 7 in all the other place.</p>\n\n<p>eg 13767</p>\n\n<p>count number of 7 in (1)+ count number off 7 in (3767),just like factorial program where 5!=5*4!</p>\n\n<pre><code>count7(n)\n{\n    if (n==0) {\n        return 0;\n    }\n    if (n==7) { \n        return 1; \n    }\n    if (n!=7) {\n        return 0;\n    }\n    return count7(n%10)+count7(n/10)\n}\n</code></pre>\n\n<p>Any suggestion or help is appreciated .</p>\n"}, {"tags": ["c", "stack-memory"], "comments": [{"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 4, "creation_date": 1505888911, "post_id": 46314732, "comment_id": 79590952, "body": "If you know your initial stack pointer and you know the stack size, then you can easily calculate if current variable is in range. Simple example would be to do <code>int main(void) {int firstVar; char* ptrToFirstVar = (char *)&amp;firstVar; &#47;* Now you have brief beginning of stack *&#47; char *endOfStack = ptrToFirstVar - yourSTACKSIZE;</code> Then check if your variable is between start of stack and stack size."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 0, "creation_date": 1505889263, "post_id": 46314732, "comment_id": 79591124, "body": "@tilz0R or most platforms provide APIs to query this information."}, {"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1505889291, "post_id": 46314732, "comment_id": 79591137, "body": "@AjayBrahmakshatriya focus to <i>on most</i> part of your comment."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 0, "creation_date": 1505889348, "post_id": 46314732, "comment_id": 79591168, "body": "@tilz0R focus to <i>on modern systems</i> in OPs question."}, {"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1505889421, "post_id": 46314732, "comment_id": 79591213, "body": "@AjayBrahmakshatriya Embedded systems are for sure modern."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1505889422, "post_id": 46314732, "comment_id": 79591215, "body": "If you are windows you can look at - <code>NtCurrentTeb()</code>"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 4, "creation_date": 1505889488, "post_id": 46314732, "comment_id": 79591252, "body": "@tilz0R also, the approach of trying to determine stack bounds might not be enough since the variable could be on the stack of <i>another</i> thread."}, {"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1505889548, "post_id": 46314732, "comment_id": 79591287, "body": "@AjayBrahmakshatriya There was nothing mentioned about OS, but in this case sure, OS is the one who should check this. I&#39;m done here."}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 0, "creation_date": 1505893129, "post_id": 46314732, "comment_id": 79593417, "body": "I would abandon this idea. Considering threads, address space layout randomization, signal stacks, etc. People do crazy things all the time. What is the actual problem you&#39;re solving? When I ran into a problem with certain things being unsafe when on the stack (buffers for DMA, while waiting for the DMA to finish the stack could be swapped out), debugging it became such a hassle that it was just easier and safer to make the code safe when called with stack data."}, {"owner": {"reputation": 29662, "user_id": 432509, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/2vl0v.png?s=128&g=1", "display_name": "ideasman42", "link": "https://stackoverflow.com/users/432509/ideasman42"}, "reply_to_user": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 0, "creation_date": 1505903006, "post_id": 46314732, "comment_id": 79599821, "body": "@art it&#39;s a reasonable position to take, OTOH, just because this doesn&#39;t work in <i>all</i> cases. Doesn&#39;t mean there aren&#39;t times it could be useful, even in a limited situation <i>(as shown in the current answer).</i> The actual problem I rather leave out of this general question. I can always ask another question with the specifics."}], "answers": [{"tags": [], "owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "is_accepted": false, "score": 5, "last_activity_date": 1505889759, "creation_date": 1505889759, "answer_id": 46314986, "question_id": 46314732, "link": "https://stackoverflow.com/questions/46314732/how-to-detect-if-memory-is-from-the-stack-not-heap-or-a-static-variable/46314986#46314986", "title": "How to detect if memory is from the stack? (not heap or a static variable)", "body": "<p>Since stack and memory layout is not in the C standard, there is obviously no portable way to determine stack positions. \nHowever if you are compiling for a system managed by an operating system, there is good chance that the OS provides an API query the stack bounds. </p>\n\n<p>On Windows it can be done as -</p>\n\n<pre><code>#include &lt;windows.h&gt;\nstruct _TEB {\n        NT_TIB NtTib;\n};\n\n\nvoid *getStackBase(){\n        return NtCurrentTeb()-&gt;NtTib.StackBase;\n}\nvoid *getStackLimit(){\n        return NtCurrentTeb()-&gt;NtTib.StackLimit;\n}\n</code></pre>\n\n<p>But be aware that this will give the stack bounds of the current thread, the variable could be situated on another thread's stack. In that case you will have to iterate over the thread handles and compare with each stack bound. \nYou can use <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms686728(v=vs.85).aspx\" rel=\"noreferrer\">ThreadFirst</a> and <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms686731(v=vs.85).aspx\" rel=\"noreferrer\">ThreadNext</a> for that. </p>\n\n<p>On Linux you can read the <code>/proc/&lt;pid&gt;/maps</code> file and look for the <code>[stack]</code> entry.</p>\n"}], "owner": {"reputation": 29662, "user_id": 432509, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/2vl0v.png?s=128&g=1", "display_name": "ideasman42", "link": "https://stackoverflow.com/users/432509/ideasman42"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "answer_count": 1, "score": 7, "last_activity_date": 1505889759, "creation_date": 1505888860, "last_edit_date": 1505889111, "question_id": 46314732, "link": "https://stackoverflow.com/questions/46314732/how-to-detect-if-memory-is-from-the-stack-not-heap-or-a-static-variable", "title": "How to detect if memory is from the stack? (not heap or a static variable)", "body": "<p>While there is no officially supported way to do this.\nIs there a way (on modern systems), to detect if a pointer is from the stack (stack of the caller for example).</p>\n\n<p>Even if this is not going to work as part of actual code logic, it could help avoid errors in for the configurations that can detect it, eg:</p>\n\n<pre><code>void my_function(void *arg) {\n    /* Only some configurations can do this (depending on compiler &amp; arch). */\n#if THE_MOONS_ALIGN\n    assert(not_stack_memory(arg));\n#endif\n\n   /* ... actual logic ... */\n}\n</code></pre>\n"}, {"tags": ["python", "c", "subprocess", "64-bit", "8-bit"], "answers": [{"comments": [{"owner": {"reputation": 127, "user_id": 8626130, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/54f7f93470cce1043a98ffc3988af943?s=128&d=identicon&r=PG&f=1", "display_name": "BengBeng", "link": "https://stackoverflow.com/users/8626130/bengbeng"}, "edited": false, "score": 0, "creation_date": 1505889535, "post_id": 46314736, "comment_id": 79591282, "body": "Yup I&#39;m on Raspbian, crazy thing about this returning only 8 bit values. Any way if I for example have <code>long long int main()</code> there is the same problem. But I use your code and it gives mi this error : <code>ValueError: invalid literal for int() with base 10: b&#39;&#39;</code>"}, {"owner": {"reputation": 12557, "user_id": 1270789, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/FXwoB.png?s=128&g=1", "display_name": "Ken Y-N", "link": "https://stackoverflow.com/users/1270789/ken-y-n"}, "reply_to_user": {"reputation": 127, "user_id": 8626130, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/54f7f93470cce1043a98ffc3988af943?s=128&d=identicon&r=PG&f=1", "display_name": "BengBeng", "link": "https://stackoverflow.com/users/8626130/bengbeng"}, "edited": false, "score": 0, "creation_date": 1505890281, "post_id": 46314736, "comment_id": 79591711, "body": "Your code should have a <code>printf(&quot;%d&quot;, number);</code> as you indicate in your question. It looks as if you are not printing anything out."}], "tags": [], "owner": {"reputation": 12557, "user_id": 1270789, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/FXwoB.png?s=128&g=1", "display_name": "Ken Y-N", "link": "https://stackoverflow.com/users/1270789/ken-y-n"}, "is_accepted": false, "score": 3, "last_activity_date": 1505888870, "creation_date": 1505888870, "answer_id": 46314736, "question_id": 46314665, "link": "https://stackoverflow.com/questions/46314665/python-subprocess-gives-wrong-value-gives-8bit-value-instead-of-64-bit/46314736#46314736", "title": "Python subprocess gives wrong value (gives 8bit value instead of 64 bit)", "body": "<p>This isn't a problem with Python, but actually a feature of Linux. <a href=\"https://stackoverflow.com/a/5149267/1270789\">Looking at this answer</a>:</p>\n\n<blockquote>\n  <p>At the present time, most Unix-based systems only support 8-bit return values. Windows supports (at least) a 32-bit return value.</p>\n</blockquote>\n\n<p>So, assuming you are on Unix, then even though you have <code>int main()</code>, the return value is constrained from 0 to 255. Also from the linked question:</p>\n\n<pre><code>int main(void){\nreturn 256;\n}\necho $? ;  # out 0\n</code></pre>\n\n<p>You'll have to find another way to return the value - perhaps print it out? <a href=\"https://stackoverflow.com/a/11434568/1270789\">This answer shows how to do it</a>:</p>\n\n<pre><code>run = subprocess.Popen('./example', stdout = subprocess.PIPE,\n                        stderr = subprocess.PIPE, env={'LANG':'C++'})\ndata, error = run.communicate()\nnumberS = int(data)\n</code></pre>\n"}], "owner": {"reputation": 127, "user_id": 8626130, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/54f7f93470cce1043a98ffc3988af943?s=128&d=identicon&r=PG&f=1", "display_name": "BengBeng", "link": "https://stackoverflow.com/users/8626130/bengbeng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 2, "closed_date": 1505891966, "answer_count": 1, "score": 2, "last_activity_date": 1505888870, "creation_date": 1505888556, "question_id": 46314665, "link": "https://stackoverflow.com/questions/46314665/python-subprocess-gives-wrong-value-gives-8bit-value-instead-of-64-bit", "closed_reason": "Duplicate", "title": "Python subprocess gives wrong value (gives 8bit value instead of 64 bit)", "body": "<p>I'm testing subprocess option in Python. I wrote simple code in C and I want run it by subprocess in Python. This is how it looks :</p>\n\n<p>C code example.c (first I execute code and then in subprocess I'm using executable file) : </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(int argc, char *argv[]) {\n    int number= 2110;\n\n    while (1==1)\n    {\n        printf(\"%d\",number);\n        printf(\" return number: \")\n        return number;\n\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Python Code :</p>\n\n<pre><code>def subTest():\n    while True:\n        numberS = subprocess.call('./example')\n        print (numberS)\n</code></pre>\n\n<p>Output which I should have after run python code : </p>\n\n<pre><code>2110 return number: 2110\n</code></pre>\n\n<p>Output which I get :</p>\n\n<pre><code>2110 return number: 62\n</code></pre>\n\n<p>I test it on some 'numbers' and proper values I get up to 255 then 256 -> 0 etc why's that ? Why it gives 8bit values and how to do it to return proper values  ? </p>\n"}, {"tags": ["python", "c", "parsing"], "comments": [{"owner": {"reputation": 539, "user_id": 2805824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tBgwo.gif?s=128&g=1", "display_name": "Gaurav Pathak", "link": "https://stackoverflow.com/users/2805824/gaurav-pathak"}, "edited": false, "score": 0, "creation_date": 1505889300, "post_id": 46314481, "comment_id": 79591142, "body": "Well, is it 100% of the time that the functions in a *.c file start with <code>void</code>? Your regex <code>void\\s*_function__name_\\s*\\(.*\\)\\s*{</code> will always search for one and only one function not all the functions."}, {"owner": {"reputation": 539, "user_id": 2805824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tBgwo.gif?s=128&g=1", "display_name": "Gaurav Pathak", "link": "https://stackoverflow.com/users/2805824/gaurav-pathak"}, "edited": false, "score": 0, "creation_date": 1505889501, "post_id": 46314481, "comment_id": 79591260, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/1620851/python-script-to-print-all-function-definitions-of-a-c-c-file\">Python script to print all function definitions of a C/C++ file</a>"}, {"owner": {"reputation": 9, "user_id": 6887459, "user_type": "registered", "profile_image": "https://graph.facebook.com/10202560920020367/picture?type=large", "display_name": "mdameenh", "link": "https://stackoverflow.com/users/6887459/mdameenh"}, "reply_to_user": {"reputation": 539, "user_id": 2805824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tBgwo.gif?s=128&g=1", "display_name": "Gaurav Pathak", "link": "https://stackoverflow.com/users/2805824/gaurav-pathak"}, "edited": false, "score": 0, "creation_date": 1505889742, "post_id": 46314481, "comment_id": 79591390, "body": "yes, the return is always void."}, {"owner": {"reputation": 10709, "user_id": 3212865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B6qLg.jpg?s=128&g=1", "display_name": "spectras", "link": "https://stackoverflow.com/users/3212865/spectras"}, "reply_to_user": {"reputation": 539, "user_id": 2805824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tBgwo.gif?s=128&g=1", "display_name": "Gaurav Pathak", "link": "https://stackoverflow.com/users/2805824/gaurav-pathak"}, "edited": false, "score": 0, "creation_date": 1505893969, "post_id": 46314481, "comment_id": 79593914, "body": "@GauravPathak&gt; searching for all functions in a generic way simply cannot be done with a regular expression. On the other hand, searching for all functions with a known pattern in a known set of files might be doable. He&#39;s right exploiting the knowledge he has of his files."}, {"owner": {"reputation": 10709, "user_id": 3212865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B6qLg.jpg?s=128&g=1", "display_name": "spectras", "link": "https://stackoverflow.com/users/3212865/spectras"}, "edited": false, "score": 1, "creation_date": 1505894287, "post_id": 46314481, "comment_id": 79594101, "body": "@mdameenh&gt; On the other hand, this means you must show some samples of what you&#39;re trying to find, since the solution has to be tied to your specific use case."}, {"owner": {"reputation": 19199, "user_id": 131187, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/27eJi.jpg?s=128&g=1", "display_name": "Bill Bell", "link": "https://stackoverflow.com/users/131187/bill-bell"}, "edited": false, "score": 0, "creation_date": 1506014905, "post_id": 46314481, "comment_id": 79660070, "body": "Looks interesting! Can you show us a couple of instances of each of the kinds of functions you have to process? (Put them in your question.)"}], "owner": {"reputation": 9, "user_id": 6887459, "user_type": "registered", "profile_image": "https://graph.facebook.com/10202560920020367/picture?type=large", "display_name": "mdameenh", "link": "https://stackoverflow.com/users/6887459/mdameenh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1505889861, "creation_date": 1505887796, "last_edit_date": 1505889861, "question_id": 46314481, "link": "https://stackoverflow.com/questions/46314481/edit-parse-a-c-function-with-python", "title": "Edit/parse a c-function with python", "body": "<p>I am trying to modify few existing c-functions in my project, and add a line of code at the beginning of each function using python. But I am unable to obtain the first line inside a function.\nWhat I have tried: \n   -- using the gcc-addr2line utility to convert the absolute start address of function into the corresponding line inside c-code. However it doesn't always return the first line(in case the first operation is a conditional execution, it returns the line where first statement inside condition executes).</p>\n\n<p>-- also tried using regular expression to identify the start of function.\n(for ex: <code>void\\s*_function__name_\\s*\\(.*\\)\\s*{</code>). Doesn't return what I need. Also I am not very experienced with this. </p>\n\n<p>I do not have trouble finding the function definition, although I am not able to find the line where the first statement inside c-function exists. </p>\n"}, {"tags": ["c", "arrays", "multidimensional-array", "3d"], "answers": [{"comments": [{"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1505894402, "post_id": 46314388, "comment_id": 79594177, "body": "It is amazing how stupid bugs can hide in plain sight, invisible at first, when quick reading to understand the code."}], "tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": false, "score": 5, "last_activity_date": 1505887439, "creation_date": 1505887439, "answer_id": 46314388, "question_id": 46314138, "link": "https://stackoverflow.com/questions/46314138/sum-values-of-3d-array-in-c/46314388#46314388", "title": "sum values of 3d array in c", "body": "<p>There is a problem here</p>\n\n<pre><code>for(layerThree; layerThree&lt;10; layerThree++)\n</code></pre>\n\n<p>which is fine the first time this nested loop is iterated, because <code>layerThree</code> was initialised to <code>0</code> when it was defined. But for subsequent iterations, <code>layerThree</code> is not reset to <code>0</code>. In fact it is <code>10</code> so that loop will never iterate again. So the inner loop should be</p>\n\n<pre><code>for(layerThree = 0; layerThree &lt; 10; layerThree++)\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8604779, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212402291606620/picture?type=large", "display_name": "Jonah Lang", "link": "https://stackoverflow.com/users/8604779/jonah-lang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1505891650, "creation_date": 1505886406, "last_edit_date": 1505891650, "question_id": 46314138, "link": "https://stackoverflow.com/questions/46314138/sum-values-of-3d-array-in-c", "title": "sum values of 3d array in c", "body": "<p>Based on the test.h file, the function should output 1.000 as the average, but I am getting the wrong value output\nthe value held in each location of the array is 1.0, \nand 4*5*10 = 200 is total locations</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"test.h\"\n\nfloat avgLeaguePlayer(float leagueTeams[4][5][10]);\n\nint main()\n{\n        while (1)\n        {\n                printf(\"MENU\\n\");\n                printf(\"=====\\n\");\n                printf(\"  1. Entire League Average Player Rating\\n\");\n                printf(\"  2. Second Function\\n\");\n                printf(\"  3. Third Function\\n\");\n                printf(\"  4. Exit\\n\");\n                printf(\"Enter selection : \");\n\n                int sel;\n                float averagePlayer;\n                scanf(\"%d\", &amp;sel);\n                switch (sel)\n                {\n                case 1:\n                        averagePlayer = avgLeaguePlayer(leagueTeams);\n                        printf(\"Average Player Rating: %f\\n\", averagePlayer);\n                        break;\n                case 2:\n                        printf(\"2\\n\");\n                        // call function 2;\n                        break;\n                case 3:\n                        printf(\"3\\n\");\n                        // call function 3;\n                        break;\n                case 4:\n                        break;\n                default:\n                        printf(\"Invalid Input\\n\");\n                }\n                break;\n        }\n}\n\nfloat avgLeaguePlayer(float leagueTeams[4][5][10])\n{\n        int layerOne = 0;\n        int layerTwo = 0;\n        int layerThree = 0;\n        float sum = 0.0;\n        float avg = 0.0;\n\n        for (layerOne = 0; layerOne &lt; 4; layerOne++)\n        {\n                for (layerTwo = 0; layerTwo &lt; 5; layerTwo++)\n                {\n                        for (layerThree; layerThree &lt; 10; layerThree++)\n                        {\n                                sum += leagueTeams[layerOne][layerTwo][layerThree];\n                        }\n                }\n        }\n        avg = (sum / 200);\n        return avg;\n}\n</code></pre>\n\n<p>I need help formatting the code to get the correct output. I am new to c, thank you</p>\n"}, {"tags": ["c", "unicode", "bit-manipulation"], "comments": [{"owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "edited": false, "score": 1, "creation_date": 1505883762, "post_id": 46313622, "comment_id": 79588850, "body": "The value you&#39;re trying to get is UTF-8. You will need to convert it."}, {"owner": {"reputation": 39499, "user_id": 740553, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/s5cOX.jpg?s=128&g=1", "display_name": "Mike &#39;Pomax&#39; Kamermans", "link": "https://stackoverflow.com/users/740553/mike-pomax-kamermans"}, "edited": false, "score": 2, "creation_date": 1505883774, "post_id": 46313622, "comment_id": 79588856, "body": "Don&#39;t roll this yourself. People who have spent way more time than is healthy on the &quot;how to read in/write out unicode&quot; problem (which is a <i>hugely</i> complex subject) wrote excellent libraries to do this for you."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 1, "creation_date": 1505886761, "post_id": 46313622, "comment_id": 79589965, "body": "On what operating system (and version) and compiler (and version) and compilation flags?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1505908475, "post_id": 46313622, "comment_id": 79603409, "body": "&quot;after a few hours of getting nowhere&quot; --&gt; posting what you have done/tied would improve this post."}, {"owner": {"reputation": 55, "user_id": 6169961, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-VGNxJkXYSVw/AAAAAAAAAAI/AAAAAAAAADw/TDRas3RLHJ8/photo.jpg?sz=128", "display_name": "Noah Cardoza", "link": "https://stackoverflow.com/users/6169961/noah-cardoza"}, "reply_to_user": {"reputation": 39499, "user_id": 740553, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/s5cOX.jpg?s=128&g=1", "display_name": "Mike &#39;Pomax&#39; Kamermans", "link": "https://stackoverflow.com/users/740553/mike-pomax-kamermans"}, "edited": false, "score": 0, "creation_date": 1505947213, "post_id": 46313622, "comment_id": 79626357, "body": "I can&#39;t use any external libraries  @Mike&#39;Pomax&#39;Kamermans"}, {"owner": {"reputation": 39499, "user_id": 740553, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/s5cOX.jpg?s=128&g=1", "display_name": "Mike &#39;Pomax&#39; Kamermans", "link": "https://stackoverflow.com/users/740553/mike-pomax-kamermans"}, "edited": false, "score": 0, "creation_date": 1505966345, "post_id": 46313622, "comment_id": 79630610, "body": "@NoahCardoza that... makes no sense whatsoever. Of course you can. You just link them in."}, {"owner": {"reputation": 79873, "user_id": 205608, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/61eE0.png?s=128&g=1", "display_name": "O. Jones", "link": "https://stackoverflow.com/users/205608/o-jones"}, "edited": false, "score": 0, "creation_date": 1505989792, "post_id": 46313622, "comment_id": 79642867, "body": "I think we&#39;re looking at stupid professor tricks here. Ask the professor for more information."}], "answers": [{"comments": [{"owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "edited": false, "score": 0, "creation_date": 1505883836, "post_id": 46313636, "comment_id": 79588874, "body": "Or, depending on what OS he&#39;s using, there&#39;s probably some pretty decent Unicode functionality included with the system APIs."}], "tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 1, "last_activity_date": 1505888304, "last_edit_date": 1505888304, "creation_date": 1505883729, "answer_id": 46313636, "question_id": 46313622, "link": "https://stackoverflow.com/questions/46313622/read-bytes-from-int-to-write-unicode-c/46313636#46313636", "title": "Read bytes from int to write Unicode C", "body": "<p>Use some UTF-8/Unicode library, such as <a href=\"https://www.gnu.org/software/libunistring/\" rel=\"nofollow noreferrer\">libunistring</a>; many libraries have UTF8 related functions, e.g. <a href=\"https://developer.gnome.org/glib/stable/glib-Unicode-Manipulation.html\" rel=\"nofollow noreferrer\">Glib</a>. C11 has <em>some</em> <a href=\"http://en.cppreference.com/w/c/string/multibyte\" rel=\"nofollow noreferrer\">multibyte character</a> support (so check that your implementation uses UTF8...)</p>\n\n<p>Read more about <a href=\"https://en.wikipedia.org/wiki/Unicode\" rel=\"nofollow noreferrer\">Unicode</a> and <a href=\"https://en.wikipedia.org/wiki/UTF-8\" rel=\"nofollow noreferrer\">UTF-8</a> including <strong><a href=\"http://utf8everywhere.org/\" rel=\"nofollow noreferrer\">http://utf8everywhere.org/</a></strong></p>\n\n<p>Perhaps your OS or C implementations provide something.</p>\n\n<p>UTF-8 &amp; Unicode are complex (with delicate corner cases); so avoid reinventing the wheel and trying to make some function by yourself.</p>\n\n<p>Probably <code>L'\u263a'</code> means something different on Windows and Linux (e.g. because <code>sizeof(wchar_t)</code> can be different; it could be 16 or 32 bits). And your C source file can be UTF8 encoded (this is <em>often</em> the case) but might not be, so what exactly is <code>L'\u263a'</code> in your source code is debatable.</p>\n\n<p><sup>(in  theory the source code might not be UTF8)</sup></p>\n\n<p>For safety, better stick to UTF-8, assume and document that both the C source file and the implementation uses UTF-8, so use <a href=\"http://utf8everywhere.org/\" rel=\"nofollow noreferrer\">UTF-8 everywhere</a>, without any <code>wchar_t</code> or <code>L'\u263a'</code>, and have a <code>\"\\342\\230\\272\"</code> string (instead of <code>\"\u263a\"</code>), perhaps mentioning in a <em>comment</em> that it is <code>/*U+263A WHITE SMILING FACE  \u263a*/</code>; or at least use a string <code>\"\u263a\"</code> but avoid wide chars.</p>\n\n<p>In other words, I heard that a source code containing <code>L'\u263a'</code> is not portable between Windows and Linux (but I don't care since I never used Windows). So for portability reasons prefer at least using literal strings like <code>\"\u263a\"</code> (but <code>\"\\342\\230\\272\"</code> is even better) and explicitly document what encoding (preferably UTF-8) is used in both your source code and your application's input and output.</p>\n\n<p><a href=\"https://en.wikipedia.org/wiki/Character_encoding\" rel=\"nofollow noreferrer\">Character encoding</a> can become a nightmare. You'll find libraries such as  <a href=\"https://www.gnu.org/software/libiconv/\" rel=\"nofollow noreferrer\">libiconv</a> to deal with that. But in 2017 use <a href=\"http://utf8everywhere.org/\" rel=\"nofollow noreferrer\">UTF-8 everywhere</a> (both in your C source code and in the output of your program) hence avoid <code>L'\u263a'</code> in  your source code.</p>\n"}, {"comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 1, "creation_date": 1505884965, "post_id": 46313727, "comment_id": 79589235, "body": "Are you sure that <i>every</i> C11 implementation uses Unicode or UTF8? (what about EBCDIC-based ones). AFAIK some C implementations have 32 bits <code>char</code>-s and standards allow that"}, {"owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "reply_to_user": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1505885578, "post_id": 46313727, "comment_id": 79589473, "body": "It is part of the C11 standard.   Of course, many C compilers still don&#39;t implement C99 properly, let alone C11."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1505885647, "post_id": 46313727, "comment_id": 79589500, "body": "What is part of the standard? <code>c32rtomb</code> or UTF8? And what about implementations with wider than 8 bits <code>char</code>-s? (I&#39;m pretty sure the standard allows that, even if I don&#39;t know many implementations doing that). Also <code>wchar_t</code> has various sizes on different implementations (and that is why it is not very useful)"}, {"owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "reply_to_user": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1505885911, "post_id": 46313727, "comment_id": 79589594, "body": "uchar.h and c32rtomb are part of the standard"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 2, "creation_date": 1505885969, "post_id": 46313727, "comment_id": 79589619, "body": "But please cite where is UTF8 or Unicode mentioned. IIRC it is not that simple! (since 16 bits or 32 bits <code>char</code>-s are possible)"}, {"owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "reply_to_user": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1505886069, "post_id": 46313727, "comment_id": 79589659, "body": "Section 7.28 says &lt;uchar.h&gt; defines &quot;types and functions for manipulating Unicode characters.&quot;  It never mentions &quot;UTF8&quot; specifically, just Unicode multibyte character encodings.  As far as I&#39;m aware, UTF8 is the only byte-oriented Unicode encoding defined by the Unicode consortium."}, {"owner": {"reputation": 55, "user_id": 6169961, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-VGNxJkXYSVw/AAAAAAAAAAI/AAAAAAAAADw/TDRas3RLHJ8/photo.jpg?sz=128", "display_name": "Noah Cardoza", "link": "https://stackoverflow.com/users/6169961/noah-cardoza"}, "edited": false, "score": 0, "creation_date": 1505946913, "post_id": 46313727, "comment_id": 79626272, "body": "Sorry this won&#39;t work, I can only use the <code>unistd.h</code> library."}], "tags": [], "owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "is_accepted": false, "score": 1, "last_activity_date": 1505885925, "last_edit_date": 1505885925, "creation_date": 1505884187, "answer_id": 46313727, "question_id": 46313622, "link": "https://stackoverflow.com/questions/46313622/read-bytes-from-int-to-write-unicode-c/46313727#46313727", "title": "Read bytes from int to write Unicode C", "body": "<p>If you have a C11 compiler, it has a standard header  with unicode support.  You want the routine c32rtomb:</p>\n\n<pre><code>#include &lt;uchar.h&gt;\n\nchar buffer[4];\nlen = c32rtomb(buffer, L'\u263a', 0);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1505909271, "creation_date": 1505909271, "answer_id": 46321671, "question_id": 46313622, "link": "https://stackoverflow.com/questions/46313622/read-bytes-from-int-to-write-unicode-c/46321671#46321671", "title": "Read bytes from int to write Unicode C", "body": "<blockquote>\n  <p>Read bytes from int to write Unicode C<br>\n  I'm trying to get these {0xe2, 0x98, 0xba} from <code>int c = L'\u263a';</code></p>\n</blockquote>\n\n<p>If code can start from a <em>UTF\u22128 string literal</em>, suggest:  </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) {\n  char *s = u8\"\u263a\";\n  printf(\"0x%02hhx 0x%02hhx 0x%02hhx\\n\", s[0], s[1], s[2]);\n  return 0;\n}\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>0xe2 0x98 0xba\n</code></pre>\n\n<p>To make an integer, use a wide enough integer type like <code>uint32_t</code> and the values <code>s[0], s[1], s[2]</code></p>\n"}], "owner": {"reputation": 55, "user_id": 6169961, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-VGNxJkXYSVw/AAAAAAAAAAI/AAAAAAAAADw/TDRas3RLHJ8/photo.jpg?sz=128", "display_name": "Noah Cardoza", "link": "https://stackoverflow.com/users/6169961/noah-cardoza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "closed_date": 1505927525, "answer_count": 3, "score": -3, "last_activity_date": 1505947006, "creation_date": 1505883590, "last_edit_date": 1505947006, "question_id": 46313622, "link": "https://stackoverflow.com/questions/46313622/read-bytes-from-int-to-write-unicode-c", "closed_reason": "Not suitable for this site", "title": "Read bytes from int to write Unicode C", "body": "<p>In short, I'm trying to get these <code>{0xe2, 0x98, 0xba}</code> from <code>int c = L'\u263a';</code> without any libraries except <code>unistd</code>.</p>\n\n<p>I know it has to do with bit masks and what not but after a few hours of getting nowhere I need a hand.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c", "pointers", "linked-list", "nodes"], "comments": [{"owner": {"reputation": 846, "user_id": 4675426, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/6a40956551f38afd8a2c712b4780d73a?s=128&d=identicon&r=PG", "display_name": "Karthick", "link": "https://stackoverflow.com/users/4675426/karthick"}, "edited": false, "score": 2, "creation_date": 1505882193, "post_id": 46313340, "comment_id": 79588340, "body": "You are using local variable inside <code>addNode</code>. It goes out of scope when you return from the function. So  the next time when you call the function it might cause crash. And further you need to allocate seperate memory for <code>name</code> and use strcpy to copy <code>n</code> to <code>name</code>"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1505882337, "post_id": 46313340, "comment_id": 79588375, "body": "<code>Node new; --&gt; Node * new = malloc(sizeof * new);</code> (change other assignments accordingly), also need to check if <code>head</code> itself is <code>NULL</code>."}], "answers": [{"tags": [], "owner": {"reputation": 215710, "user_id": 134633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc6be45ddcfd038ba5e1e5fca319c7fa?s=128&d=identicon&r=PG", "display_name": "caf", "link": "https://stackoverflow.com/users/134633/caf"}, "is_accepted": true, "score": 1, "last_activity_date": 1505882518, "creation_date": 1505882518, "answer_id": 46313433, "question_id": 46313340, "link": "https://stackoverflow.com/questions/46313340/c-trying-to-add-a-node-to-the-end-of-a-linked-list-causes-crash/46313433#46313433", "title": "C- Trying to add a node to the end of a linked list causes crash", "body": "<pre><code>if(head-&gt;next == NULL){\n    Node new;\n    new.name = n;\n    new.next = NULL;\n    head-&gt;next = &amp;new;\n}\n</code></pre>\n\n<p>Your problem is actually here.  The variable <code>new</code> has <em>automatic storage duration</em>, which means that it ceases to exist at the end of the block in which it was declared - in this case, at the closing brace at the end of this <code>if()</code>.</p>\n\n<p>The pointer you have saved in <code>head-&gt;next</code> now points at a no-longer-existing object - this is called a \"dangling pointer\".  When you later use the dangling pointer, your program's behaviour is no longer defined.</p>\n\n<p>You instead want to allocate a <code>Node</code> that will live beyond the invocation of the function that created it - that's what <code>malloc()</code> is used for:</p>\n\n<pre><code>if(head-&gt;next == NULL) {\n    Node *new = malloc(sizeof *new);\n\n    if (new) {\n        new-&gt;name = n;\n        new-&gt;next = NULL;\n        head-&gt;next = new;\n    } else {\n        /* malloc failed */\n    }\n}\n</code></pre>\n\n<p>The object created with <code>malloc()</code> has a lifetime that extends until you pass a pointer to it to <code>free()</code>, which you would do if you were removing the Node from the linked list and discarding it.</p>\n"}], "owner": {"reputation": 17, "user_id": 3681503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/525f1e0518cb1080ca049342aa354454?s=128&d=identicon&r=PG&f=1", "display_name": "jaaj", "link": "https://stackoverflow.com/users/3681503/jaaj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "closed_date": 1506043764, "accepted_answer_id": 46313433, "answer_count": 1, "score": -1, "last_activity_date": 1505882518, "creation_date": 1505881893, "question_id": 46313340, "link": "https://stackoverflow.com/questions/46313340/c-trying-to-add-a-node-to-the-end-of-a-linked-list-causes-crash", "closed_reason": "Duplicate", "title": "C- Trying to add a node to the end of a linked list causes crash", "body": "<p>I am trying to implement a linked list in C. Here is my definition of a Node structure, followed by a function for adding a Node to the end of the linked list.</p>\n\n<pre><code>struct Node{\n    char *name;\n    struct Node *next;\n};\ntypedef struct Node Node;\n\nvoid addNode(Node *head, char n[100]){\n    if(head-&gt;next == NULL){\n        Node new;\n        new.name = n;\n        new.next = NULL;\n        head-&gt;next = &amp;new;\n    }\n    else{\n        addNode(head-&gt;next, n);\n    }\n}\n</code></pre>\n\n<p>I can create a head node and pass a pointer for it into the addNode function just fine to add a second node to the linked list. (Also worth mentioning that when I make a head node, I set its \"next\" pointer to NULL to represent the end of the linked list) The problem seems to be with the recursive call to addNode in the else branch of the addNode function, as my program works without crashing when I comment it out. Why is this causing my program to crash, and how can I fix it?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 18493, "user_id": 8176478, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9bfdd0a05bddc5a0bcaf042597babdef?s=128&d=identicon&r=PG&f=1", "display_name": "MKR", "link": "https://stackoverflow.com/users/8176478/mkr"}, "edited": false, "score": 0, "creation_date": 1505881338, "post_id": 46313139, "comment_id": 79588112, "body": "Does your code even compiles?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1505881391, "post_id": 46313139, "comment_id": 79588132, "body": "Do you want <code>n_quarters * 0.25</code>?  <code>n_quarters * 25</code> appears errant.  Is this true code?"}, {"owner": {"reputation": 6177, "user_id": 4948889, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/7f1b540c13a4b2663a9bf668f6a50145?s=128&d=identicon&r=PG", "display_name": "Jaffer Wilson", "link": "https://stackoverflow.com/users/4948889/jaffer-wilson"}, "edited": false, "score": 0, "creation_date": 1505881400, "post_id": 46313139, "comment_id": 79588136, "body": "What you want? Not clear yet."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1505881961, "post_id": 46313139, "comment_id": 79588270, "body": "Enable compiler warnings.  Then you&#39;ll see that you are missing numeric arguments to the last printf."}], "answers": [{"comments": [{"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1505882041, "post_id": 46313320, "comment_id": 79588300, "body": "This is passing a pointer where an integer argument is required.  The result is undefined, particularly on platforms where integers and pointers are different sizes.  You need to explicitly cast the pointer to an integer of the appropriate size, and use a matching format specifier."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1505882860, "post_id": 46313320, "comment_id": 79588543, "body": "The <code>void *</code> cast does not correct this.  It&#39;s still a pointer type and has all of the problems I mentioned.  One more time:  You to cast the pointer to an <i>integer</i> type."}], "tags": [], "owner": {"reputation": 11, "user_id": 5775498, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-N_iAMzI4tL8/AAAAAAAAAAI/AAAAAAAAABE/ULM10L1pU4o/photo.jpg?sz=128", "display_name": "Nick Kane", "link": "https://stackoverflow.com/users/5775498/nick-kane"}, "is_accepted": false, "score": 1, "last_activity_date": 1613521098, "last_edit_date": 1613521098, "creation_date": 1505881736, "answer_id": 46313320, "question_id": 46313139, "link": "https://stackoverflow.com/questions/46313139/how-do-i-display-comma-when-typing-two-variables-at-the-same-time/46313320#46313320", "title": "How do I display comma when typing two variables at the same time?", "body": "<p>Looks like your print statement is a bit off. It doesn't look like that code would compile, here is an example of how to use print:</p>\n<pre><code>int x = 10;\nprintf(&quot;x: %d, x address: %p\\n&quot;, x, (int *)&amp;x);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 0, "last_activity_date": 1505893882, "last_edit_date": 1505893882, "creation_date": 1505884884, "answer_id": 46313865, "question_id": 46313139, "link": "https://stackoverflow.com/questions/46313139/how-do-i-display-comma-when-typing-two-variables-at-the-same-time/46313865#46313865", "title": "How do I display comma when typing two variables at the same time?", "body": "<p>There are a number of problems with your code</p>\n\n<p>1) Undeclared variables, e.g. remaining_loonies</p>\n\n<p>2) The <code>scanf</code> is placed after all the calculations so the user input is just ignored</p>\n\n<p>3) The <code>printf</code> is called incorrectly</p>\n\n<p><code>printf</code> needs a format string and after the format string comes the variables you want to print. All separated by commas.</p>\n\n<p>In the format string the variables are given as <code>%</code> followed by a letter that tells the type of the variable to print, e.g. <code>%d</code> for a signed integer variable, <code>%u</code> for an unsigned integer variable, <code>%f</code> for a float variable and some more...</p>\n\n<p>So to print a single integer do </p>\n\n<pre><code>int my_quaters = 5;\n\n           format string\n       |------------------|\nprintf(\"I got %d quaters\\n\", my_quaters);\n              ^^             ^^\n           Integer type      The variable\n</code></pre>\n\n<p>When the <code>printf</code> is executed <code>%d</code> will be replaced by the current value of the variable <code>my_quaters</code> - so this will print:</p>\n\n<blockquote>\n  <p>I got 5 quaters</p>\n</blockquote>\n\n<p>To print two integers do </p>\n\n<pre><code>int my_quaters = 5;\nint my_pence = 15;\nprintf(\"I got %d quaters and %d pence \\n\", my_quaters, my_pence);\n              ^^             ^^            ^^          ^^\n           Integer type      Integer type  First var   Second var\n</code></pre>\n\n<p>this will print:</p>\n\n<blockquote>\n  <p>I got 5 quaters and 15 pence</p>\n</blockquote>\n\n<p>So in your case it is more like:</p>\n\n<pre><code>printf(\"\\nLoonies required:%d, balance owing $%.2f\\n\", n_loonies, remaining_loonies);\n</code></pre>\n\n<p><strong>note:</strong> The format string has a lot more options than I can mention here. Read a good book or man page for that.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8638335"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1613521098, "creation_date": 1505880546, "last_edit_date": 1505881018, "question_id": 46313139, "link": "https://stackoverflow.com/questions/46313139/how-do-i-display-comma-when-typing-two-variables-at-the-same-time", "title": "How do I display comma when typing two variables at the same time?", "body": "<p>I am asked to come up with a code register which its input is followed by:</p>\n\n<p>Please enter the amount to be paid: $8.68 \nLoonies required: 8, balance owing $0.68 \nQuarters required: 2, balance owing $0.18</p>\n\n<p>The first sentence is completed, but the second isn't, as the comma before the address overlaps with the comma before the word 'balance.'\nIs there any way to display comma just as above, and maintain the comma for the address?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void){\n\n    int n_loonies;\n    int n_quarters;\n    float remaining;\n    double amount;\n    amount = 8.68;\n    n_loonies = amount / 1;\n    remaining_loonies = amount -(n_loonies * 1);\n    n_quarters = amount / 0.25;\n    remaining_quarters = amount - (n_quarters * 25);\n\n    printf(\"Please enter the amount to be paid:$\");\n    scanf(\"%lf\", &amp;amount);\n    // printf(\"loonies required: n_loonies\");\n    // scanf(\"%d\", &amp;n_loonies);\n    printf(\"Loonies required:%d,n_loonies, balance owing $%d\\n);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "static-analysis", "wdk", "splint"], "answers": [{"tags": [], "owner": {"reputation": 583, "user_id": 5968729, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7cb220ef7cb166e0cae443b060242461?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick", "link": "https://stackoverflow.com/users/5968729/patrick"}, "is_accepted": false, "score": 0, "last_activity_date": 1506403060, "creation_date": 1506403060, "answer_id": 46418323, "question_id": 46313135, "link": "https://stackoverflow.com/questions/46313135/getting-splint-to-work-with-win32-integer-suffixes/46418323#46418323", "title": "Getting splint to work with win32 integer suffixes", "body": "<p>Extremely lame solution I did was to copy the problematic files over to another directory, edit them to remove splint problems and then configure splint to use them before the ones in the WinDDK...\\inc directory.</p>\n"}], "owner": {"reputation": 583, "user_id": 5968729, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7cb220ef7cb166e0cae443b060242461?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick", "link": "https://stackoverflow.com/users/5968729/patrick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1506403060, "creation_date": 1505880527, "question_id": 46313135, "link": "https://stackoverflow.com/questions/46313135/getting-splint-to-work-with-win32-integer-suffixes", "title": "Getting splint to work with win32 integer suffixes", "body": "<p>Splint encounters a parse error for a system header file that uses the size-specifying suffixes that windows compilers seem to use. So splint can't parse a file containing an expression like <code>0xffui8</code> (where ui8 means unsigned integer of 8 bits). How can I configure splint to get around this?</p>\n\n<p>Broader context: I am trying to get splint to work with WinDDK 7600.16385.1. File with example is <code>intsafe.h</code>.</p>\n"}, {"tags": ["c", "file", "fopen", "fgetc", "ftell"], "comments": [{"owner": {"reputation": 1077, "user_id": 507033, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/99eeb363c79d0bd9846d6d09f4379ba1?s=128&d=identicon&r=PG", "display_name": "Saustin", "link": "https://stackoverflow.com/users/507033/saustin"}, "edited": false, "score": 0, "creation_date": 1505880296, "post_id": 46313087, "comment_id": 79587830, "body": "Please see related question <a href=\"https://stackoverflow.com/questions/10651108/why-does-ftell-shows-wrong-position-after-fread?rq=1\" title=\"why does ftell shows wrong position after fread\">stackoverflow.com/questions/10651108/&hellip;</a>"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1505880326, "post_id": 46313087, "comment_id": 79587838, "body": "Are you using Windows by any chance?"}, {"owner": {"reputation": 187, "user_id": 7105441, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vXOKh40bCF0/AAAAAAAAAAI/AAAAAAAAAAA/ISRQp5Ex3NE/photo.jpg?sz=128", "display_name": "Chaitanya Vaishampayan", "link": "https://stackoverflow.com/users/7105441/chaitanya-vaishampayan"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1505880657, "post_id": 46313087, "comment_id": 79587941, "body": "@AjayBrahmakshatriya yes I am using windows."}, {"owner": {"reputation": 639, "user_id": 6834990, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Uaxy3XKnAjs/AAAAAAAAAAI/AAAAAAAAABI/52ROGOYFmTw/photo.jpg?sz=128", "display_name": "Rajeshkumar", "link": "https://stackoverflow.com/users/6834990/rajeshkumar"}, "edited": false, "score": 0, "creation_date": 1505884264, "post_id": 46313087, "comment_id": 79589007, "body": "@ChaitanyaVaishampayan Its giving correct output in gcc 5.4.0"}, {"owner": {"reputation": 187, "user_id": 7105441, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vXOKh40bCF0/AAAAAAAAAAI/AAAAAAAAAAA/ISRQp5Ex3NE/photo.jpg?sz=128", "display_name": "Chaitanya Vaishampayan", "link": "https://stackoverflow.com/users/7105441/chaitanya-vaishampayan"}, "reply_to_user": {"reputation": 639, "user_id": 6834990, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Uaxy3XKnAjs/AAAAAAAAAAI/AAAAAAAAABI/52ROGOYFmTw/photo.jpg?sz=128", "display_name": "Rajeshkumar", "link": "https://stackoverflow.com/users/6834990/rajeshkumar"}, "edited": false, "score": 0, "creation_date": 1505886551, "post_id": 46313087, "comment_id": 79589869, "body": "@Rajeshkumar Read the question again. The question is not about correct or wrong output but it is about why is the number 7 getting skipped."}, {"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1505887033, "post_id": 46313087, "comment_id": 79590101, "body": "Try it with &quot;rb&quot; for the mode."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1505909635, "post_id": 46313087, "comment_id": 79604184, "body": "Should have used <code>printf(&quot;%d&quot;, fgetc(f));</code> instead of <code>putchar(fgetc(f));</code> to garner more information."}], "answers": [{"comments": [{"owner": {"reputation": 187, "user_id": 7105441, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vXOKh40bCF0/AAAAAAAAAAI/AAAAAAAAAAA/ISRQp5Ex3NE/photo.jpg?sz=128", "display_name": "Chaitanya Vaishampayan", "link": "https://stackoverflow.com/users/7105441/chaitanya-vaishampayan"}, "edited": false, "score": 0, "creation_date": 1505888653, "post_id": 46314321, "comment_id": 79590804, "body": "Thanks a lot. It worked with &quot;rb&quot;. Can you please explain how does /r/n affects my program?"}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 187, "user_id": 7105441, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vXOKh40bCF0/AAAAAAAAAAI/AAAAAAAAAAA/ISRQp5Ex3NE/photo.jpg?sz=128", "display_name": "Chaitanya Vaishampayan", "link": "https://stackoverflow.com/users/7105441/chaitanya-vaishampayan"}, "edited": false, "score": 0, "creation_date": 1505888991, "post_id": 46314321, "comment_id": 79590996, "body": "@ChaitanyaVaishampayan updated. Hope that helps!"}, {"owner": {"reputation": 187, "user_id": 7105441, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vXOKh40bCF0/AAAAAAAAAAI/AAAAAAAAAAA/ISRQp5Ex3NE/photo.jpg?sz=128", "display_name": "Chaitanya Vaishampayan", "link": "https://stackoverflow.com/users/7105441/chaitanya-vaishampayan"}, "reply_to_user": {"reputation": 56328, "user_id": 4265352, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lzAUc5pYb24/AAAAAAAAAAI/AAAAAAAAAGQ/q3h7bZUnqrs/photo.jpg?sz=128", "display_name": "axiac", "link": "https://stackoverflow.com/users/4265352/axiac"}, "edited": false, "score": 0, "creation_date": 1505889247, "post_id": 46314321, "comment_id": 79591121, "body": "@axiac i mistakenly typed /r/n. I meant \\r\\n."}], "tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": true, "score": 1, "last_activity_date": 1505889284, "last_edit_date": 1505889284, "creation_date": 1505887178, "answer_id": 46314321, "question_id": 46313087, "link": "https://stackoverflow.com/questions/46313087/why-does-ftell-skips-some-positions-in-the-file/46314321#46314321", "title": "Why does ftell skips some positions in the file?", "body": "<p>The problem lies in the newline character, which in Windows is <code>\\r\\n</code> (<a href=\"https://stackoverflow.com/questions/7013034/does-windows-carriage-return-r-n-consist-of-two-characters-or-one-character\">Does Windows carriage return \\r\\n consist of two characters or one character?</a>).</p>\n\n<p>Try changing these:</p>\n\n<pre><code>fopen(\"myfile.txt\",\"r\");\n</code></pre>\n\n<p>to these:</p>\n\n<pre><code>fopen(\"myfile.txt\",\"rb\");\n</code></pre>\n\n<p>where <code>b</code> is for binary mode.</p>\n\n<p>Binary mode makes a difference on Windows where text mode maps the two character carriage return, line feed sequence to a single new-line character. Note: No mapping is needed on Linux.</p>\n"}], "owner": {"reputation": 187, "user_id": 7105441, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vXOKh40bCF0/AAAAAAAAAAI/AAAAAAAAAAA/ISRQp5Ex3NE/photo.jpg?sz=128", "display_name": "Chaitanya Vaishampayan", "link": "https://stackoverflow.com/users/7105441/chaitanya-vaishampayan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 230, "favorite_count": 0, "closed_date": 1506043852, "accepted_answer_id": 46314321, "answer_count": 1, "score": 4, "last_activity_date": 1505912280, "creation_date": 1505880196, "last_edit_date": 1505912280, "question_id": 46313087, "link": "https://stackoverflow.com/questions/46313087/why-does-ftell-skips-some-positions-in-the-file", "closed_reason": "Duplicate", "title": "Why does ftell skips some positions in the file?", "body": "<p>I have a text file named myfile.txt which reads:</p>\n\n<pre><code>line 1\nl\n</code></pre>\n\n<p>My code:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint main(){\n    FILE *f = fopen(\"myfile.txt\",\"r\");\n    if(f==NULL){\n        FILE *fp=fopen(\"myfile.txt\",\"w\");\n        fclose(fp);\n        f = fopen(\"myfile.txt\",\"r\");\n    }\n    while(!feof(f)){\n        printf(\"\\ncharacter number %d    \",ftell(f));\n        putchar(fgetc(f));      \n    }\n    fclose(f);\n    return 0;\n}\n</code></pre>\n\n<p>The output is :</p>\n\n<pre><code>character number 0    l\ncharacter number 1    i\ncharacter number 2    n\ncharacter number 3    e\ncharacter number 4\ncharacter number 5    1\ncharacter number 6\n\ncharacter number 8    l\ncharacter number 9     \u00a0\n</code></pre>\n\n<p>Whenever a \\n is encountered, the ftell skips one value for example it has skipped the value 7. Why is it so? Please explain me in detail, I want to know.</p>\n"}, {"tags": ["c", "gcc", "getline", "errno", "feof"], "answers": [{"comments": [{"owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 0, "creation_date": 1505951245, "post_id": 46332628, "comment_id": 79627393, "body": "Printing the GLIBC version is more important that the GCC version."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 0, "creation_date": 1505958974, "post_id": 46332628, "comment_id": 79628957, "body": "@o11c Perhaps &quot;ldd (cygwin) 2.9.0&quot;."}, {"owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 0, "creation_date": 1505975879, "post_id": 46332628, "comment_id": 79633744, "body": "Oh. cygwin uses some weird libc that is <i>always</i> buggy."}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1505979142, "post_id": 46332628, "comment_id": 79635601, "body": "OP has just admitted that his <i>small program</i> is 500 lines across 5 files and <i>it would take some time</i> to produce an SSCCE, apparently. Due to OPs attitude towards producing an SSCCE (believing <i>it would take some time</i>), I&#39;m leaning more towards this being a memory corruption bug which should be closed..."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1506003076, "post_id": 46332628, "comment_id": 79652540, "body": "@Sebivor  Agree OP code that demos the problem would be useful.   Note that the code here apparently shows the same bug and not memory corruption - at least due to the code itself.  I suspect a code bug in the gcc/cygwin library."}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 1, "creation_date": 1506003402, "post_id": 46332628, "comment_id": 79652811, "body": "@chux OP admitted he has no MCVE and so I wouldn&#39;t be so sure... He wrote <i>&quot;@Sebivor it&#39;s still 500 lines across 5 files, and it&#39;ll take some time to set up an SSCCE, especially because I&#39;ve already noticed that when I perturb the inputs in seemingly insignificant ways it changes the result. So I&#39;ll live dangerously until then&quot;</i>... Memory corruption, no? I think so! I&#39;m certain this is one of those cases of &quot;the OP is misleading us, without even realising&quot;, and we should <i>always</i> push <b>hard</b> for an MCVE in these cases."}, {"owner": {"reputation": 54577, "user_id": 1339987, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/76aa5ba88e0d95b6480113239fe50008?s=128&d=identicon&r=PG", "display_name": "djechlin", "link": "https://stackoverflow.com/users/1339987/djechlin"}, "edited": false, "score": 0, "creation_date": 1506040989, "post_id": 46332628, "comment_id": 79670267, "body": "I&#39;m trying this code, what do I need in test.bin? (I&#39;m on linux fyi, specifically cc version 4.9.2 (Debian 4.9.2-10) )"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 54577, "user_id": 1339987, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/76aa5ba88e0d95b6480113239fe50008?s=128&d=identicon&r=PG", "display_name": "djechlin", "link": "https://stackoverflow.com/users/1339987/djechlin"}, "edited": false, "score": 0, "creation_date": 1506043084, "post_id": 46332628, "comment_id": 79670719, "body": "@djechlin I am unfamiliar with that site.  You can compile/run this code on your own machine and report the results."}, {"owner": {"reputation": 54577, "user_id": 1339987, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/76aa5ba88e0d95b6480113239fe50008?s=128&d=identicon&r=PG", "display_name": "djechlin", "link": "https://stackoverflow.com/users/1339987/djechlin"}, "edited": false, "score": 0, "creation_date": 1506184162, "post_id": 46332628, "comment_id": 79721791, "body": "Your code has `  FILE *stream = fopen(&quot;c:\\\\tmp\\test.bin&quot;, &quot;wb&quot;);` I don&#39;t know what&#39;s in that file, and I&#39;m on Linux so I have to reorganize stuff some."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 54577, "user_id": 1339987, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/76aa5ba88e0d95b6480113239fe50008?s=128&d=identicon&r=PG", "display_name": "djechlin", "link": "https://stackoverflow.com/users/1339987/djechlin"}, "edited": false, "score": 0, "creation_date": 1506196798, "post_id": 46332628, "comment_id": 79725697, "body": "@djechlin This code <i>creates</i> <code>&quot;test.bin&quot;</code>.  It is filled with many <code>&#39;a&#39;</code> and finally an end-of-line."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1506196668, "last_edit_date": 1592644375, "creation_date": 1505946222, "answer_id": 46332628, "question_id": 46313018, "link": "https://stackoverflow.com/questions/46313018/getline-returns-1-eof-not-set-errno-not-set-when-given-very-large-input/46332628#46332628", "title": "getline returns -1, EOF not set, errno not set, when given very large input", "body": "<p>A test harness that shows the problem.</p>\n<p>A difference between this code and OP's is that the status of <code>errno</code> is always shown.</p>\n<hr />\n<p>When out-of-memory occurs, <code>errno</code> is set, but <code>getline()</code> returned the length exceeding the <code>capacity</code> - very strange -  and not -1.</p>\n<p>If this is compliant or not, I leave to your interpretation of the below. IMO it is not compliant. I would expect a return value of -1, if <code>errno</code> is set due to <code>getline()</code> for any reason in addition to <code>ferror()</code> or no read on end-of-file.</p>\n<p>I suspect the issue due to a deferred memory allocation.</p>\n<blockquote>\n<p><strong>RETURN VALUE</strong><br />\nOn success, <code>getline()</code> and <code>getdelim()</code> return the number of characters        read, including the delimiter character, but not including the terminating null byte ('\\0').  This value can be used to handle embedded null bytes in the line read.</p>\n<p>Both functions return -1 on failure to read a line (including end-of-file condition).  In the event of an error, errno is set to indicate  the cause.</p>\n<p><strong>ERRORS</strong><br />\nEINVAL Bad arguments (n or lineptr is NULL, or stream is not valid).<br />\nENOMEM Allocation or reallocation of the line buffer failed.</p>\n</blockquote>\n<hr />\n<p>Code also experiments with CR/LF vs LF, yet that did not appear relevant.</p>\n<hr />\n<pre><code>#include &lt;errno.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;stdio.h&gt;\n\nint djtest(unsigned sh, unsigned long long a, bool crflag) {\n  printf(&quot;sh:%2u a:%12llu crlf:%d   &quot;, sh, a, crflag);\n  FILE *stream = fopen(&quot;test.bin&quot;, &quot;wb&quot;);\n  if (stream == NULL) {\n    return printf(&quot;error fopen(wb)\\n&quot;);\n  }\n  char buf[1024 * 1204];\n  memset(buf, 'a', sizeof buf);\n  while (a &gt; 0) {\n    unsigned long long m = a;\n    if (m &gt; sizeof buf) m = sizeof buf;\n    size_t y = fwrite(buf, sizeof *buf, (size_t) m, stream);\n    if (y != m) {\n      return printf(&quot;error fwrite\\n&quot;);\n    }\n    a -= m;\n  }\n  if (fputs(crflag ? &quot;\\r\\n&quot; : &quot;\\n&quot;, stream)) {\n    return printf(&quot;error fputs\\n&quot;);\n  }\n  if (fclose(stream)) {\n    return printf(&quot;error fclose\\n&quot;);\n  }\n\n\n  stream = fopen(&quot;test.bin&quot;, &quot;r&quot;);\n  if (stream == NULL) {\n    return printf(&quot;error fopen(r)\\n&quot;);\n  }\n  char* line = NULL;\n  size_t capacity = 0;\n  ssize_t n = getline(&amp;line, &amp;capacity, stream);\n  int err = errno;\n  printf(&quot;cap:%12zu ssize_t:%12lld feof:%d ferror:%d errno:%2d line:%p %s   &quot;, //\n      capacity, (long long)n, feof(stream), ferror(stream), err, (void*)line, strerror(err));\n\n  free(line);\n\n  if (fclose(stream)) {\n    return printf(&quot;error fclose\\n&quot;);\n  }\n\n  return printf(&quot;Fin\\n&quot;);\n}\n\nint main() {\n  for (unsigned sh = 28; sh &lt; 31; sh++) {\n    unsigned long long a = 1ull &lt;&lt; sh;\n    djtest(sh, a, 0);\n    djtest(sh, a, 1);\n    fflush(stdout);\n    a *= 2;\n  }\n  printf(&quot;All done\\n&quot;);\n  return 0;\n}\n</code></pre>\n<p>Output</p>\n<pre><code>sh:28 a:   268435456 crlf:0   cap:   536870912 ssize_t:   268435457 feof:0 ferror:0 errno: 0 line:0xbff20008 No error   Fin\nsh:28 a:   268435456 crlf:1   cap:   536870912 ssize_t:   268435458 feof:0 ferror:0 errno: 0 line:0xbff20008 No error   Fin\nsh:29 a:   536870912 crlf:0   cap:  1073741824 ssize_t:   536870913 feof:0 ferror:0 errno: 0 line:0x1ff80008 No error   Fin\nsh:29 a:   536870912 crlf:1   cap:  1073741824 ssize_t:   536870914 feof:0 ferror:0 errno: 0 line:0x1ff80008 No error   Fin\nsh:30 a:  1073741824 crlf:0   cap:  1073741824 ssize_t:  1610088455 feof:0 ferror:0 errno:12 line:0x1ff80008 Cannot allocate memory   Fin\nsh:30 a:  1073741824 crlf:1   cap:  1073741824 ssize_t:  1610088455 feof:0 ferror:0 errno:12 line:0x1ff80008 Cannot allocate memory   Fin\nAll done\n</code></pre>\n<hr />\n<p>GNU C11 (GCC) version 6.4.0</p>\n"}], "owner": {"reputation": 54577, "user_id": 1339987, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/76aa5ba88e0d95b6480113239fe50008?s=128&d=identicon&r=PG", "display_name": "djechlin", "link": "https://stackoverflow.com/users/1339987/djechlin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 894, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1612908778, "creation_date": 1505879618, "last_edit_date": 1506184268, "question_id": 46313018, "link": "https://stackoverflow.com/questions/46313018/getline-returns-1-eof-not-set-errno-not-set-when-given-very-large-input", "title": "getline returns -1, EOF not set, errno not set, when given very large input", "body": "<p>I did not think these three conditions can happen at the same time. I have:</p>\n\n<pre><code>char* line = NULL;\nsize_t capacity = 0;\nssize_t n = getline(&amp;line, &amp;capacity, stdin);\nif (n == -1) {\n    int err = errno; // preserve it\n    if (feof(stdin) == 0) { // means not EOF\n        printf(strerror(err)); // \"Success\"\n    }\n}\n</code></pre>\n\n<p>The <code>getline</code> documentation claims </p>\n\n<blockquote>\n  <p>Both functions return -1 on failure to read a line (including end-of-file condition).  In the event of an error, errno is set to indicate the cause.</p>\n</blockquote>\n\n<p>So I have a non-EOF non-error condition?</p>\n\n<p>This is a small, single-threaded program. This error happened when it was fed a 2^30 character string as input (as a stress test, which found this behavior).</p>\n\n<p>Compiled with gcc C99 on Linux.</p>\n\n<p><strong>Edit</strong></p>\n\n<p>I put a fair amount of work into repro-ing this a few days later. I <em>was</em> using git so it's <em>very</em> easy to create another branch or tag with the repro-ing code, but I didn't observe that good practice. While working with what I believe was the buggy commit, my O.S. just took to killing my program with rc 137.</p>\n\n<p><strong>But</strong></p>\n\n<p>chux's test harness shows a related problem which is repro-able and I guess keeps this question on topic.</p>\n"}, {"tags": ["c++", "c", "encryption", "mscapi"], "comments": [{"owner": {"reputation": 8601, "user_id": 1485885, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/tdPE1.jpg?s=128&g=1", "display_name": "cbuchart", "link": "https://stackoverflow.com/users/1485885/cbuchart"}, "edited": false, "score": 0, "creation_date": 1506935619, "post_id": 46312900, "comment_id": 79999237, "body": "As a sidenote, you have one typo in your code: <code>NTE_EXITS</code> should be <code>NTE_EXISTS</code>."}], "owner": {"reputation": 228, "user_id": 2079852, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2381b4767d4d2d87375dd098d7aa509c?s=128&d=identicon&r=PG", "display_name": "Ibrahim", "link": "https://stackoverflow.com/users/2079852/ibrahim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 565, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1506437868, "creation_date": 1505878856, "question_id": 46312900, "link": "https://stackoverflow.com/questions/46312900/ncryptexport-aes-key", "title": "NCryptExport AES key", "body": "<p>I don\u2019t know if i am missing on something, I am trying to move legacy code to the Ngen, and i have to use the Key Storage Provider aka NCrypt</p>\n\n<p>I was doing some test to try to export an AES key, the first thing i found was that \nNCryptExport assuming that the best way is to export the key using pkcs7 and assuming that if I put an export key in the second parameter then this will be the key used for the pkc7 code\nI am getting an error NTE_INVALID_PARAMETER</p>\n\n<p>if I try to use use NCryptExport with NCRPT_OPAQUETRANSPORT_KEY I get NTE_INVALID_KEY_STATE\na code like that</p>\n\n<pre><code> NCRYPT_PROV_HANDLE hProv = NULL;\nSECURITY_STATUS pState = 0;\npState = NCryptOpenStorageProvider(&amp;hProv, NULL, 0);\nif (pState != ERROR_SUCCESS)\n{    \n         _wprintf_p(L\"NCryptOpenStorageProvider (%X). \", pState);\n          return -1;\n }\n NCRYPT_KEY_HANDLE hContainerKey = 0;\n pState = NCryptCreatePersistedKey(hProv, &amp;hContainerKey, BCRYPT_RSA_ALGORITHM, L\"TEST\", AT_KEYEXCHANGE, 0);\n if (pState == ERROR_SUCCESS)\n{\n    int KeyLength = 2048;\n    pState = NCryptSetProperty(hContainerKey, NCRYPT_LENGTH_PROPERTY, (PBYTE) &amp;KeyLength, sizeof(int), 0);\n    int allowPlainExport = NCRYPT_ALLOW_PLAINTEXT_EXPORT_FLAG;\n    pState = NCryptSetProperty(hContainerKey, NCRYPT_EXPORT_POLICY_PROPERTY, (PBYTE) &amp;allowPlainExport, sizeof(int), 0);\n\n}\nelse if(pState == NTE_EXITS)\n{\n    pState = NCryptOpenKey(hProv, &amp;hContainerKey, L\"Test Key 2\", AT_KEYEXCHANGE, 0);\n}\nelse{ NCryptFreeObject(hProv);\n    return -1;}\npState = NCryptFinalizeKey(hContainerKey, NCRYPT_WRITE_KEY_TO_LEGACY_STORE_FLAG);\n\nBYTE* blob = NULL;\n\nNCRYPT_KEY_HANDLE hKey = NULL;\n// Create a temporary key by setting null on the name as per documentation\npState = NCryptCreatePersistedKey(hProv,&amp;hKey, BCRYPT_AES_ALGORITHM , NULL, 0 , 0);\nif (pState != ERROR_SUCCESS)\n{\n\n    _wprintf_p(L\"NCryptCreatePersistedKey (%X). \", pState);\n    NCryptFreeObject(hContainerKey);\n    NCryptFreeObject(hProv);\n    return -1;\n\n}\n\nint KeyLength = 256;\nint blockLength = 128 / 8; // AES does support 256 block length !\nLPCTSTR chainMode = BCRYPT_CHAIN_MODE_ECB; // Just for testing\nDWORD allowExport = NCRYPT_ALLOW_EXPORT_FLAG;\n\npState = NCryptSetProperty(hKey, NCRYPT_LENGTH_PROPERTY, (PBYTE)&amp;KeyLength, sizeof(int), 0);\npState = NCryptSetProperty(hKey, NCRYPT_BLOCK_LENGTH_PROPERTY, (PBYTE)&amp;blockLength, sizeof(int), 0);\n\npState = NCryptSetProperty(hKey, NCRYPT_EXPORT_POLICY_PROPERTY, (PBYTE)&amp;allowExport, sizeof(int), 0);\npState = NCryptFinalizeKey(hKey, 0);\npState = NCryptSetProperty(hKey, NCRYPT_CHAINING_MODE_PROPERTY, (PBYTE)chainMode, _tcslen(chainMode) * sizeof(TCHAR), 0);\n//TEST key \nLPSTR Secret = \"Secret !Secret !Secret !Secret !\";\nblobSize = 0;\npState = NCryptEncrypt(hKey, (PBYTE) Secret, strlen(Secret), NULL,NULL, blobSize,&amp;blobSize, NCRYPT_NO_PADDING_FLAG);\n\nif (pState == ERROR_SUCCESS)\n{// if you are here the key looks fine\n    blob = new BYTE[blobSize];\n    pState = NCryptEncrypt(hKey, (PBYTE)Secret, strlen(Secret), NULL, blob, blobSize, &amp;blobSize, 0);\n    DWORD plainSize = 0;\n    pState = NCryptDecrypt(hKey, (PBYTE)blob, blobSize, NULL, NULL, plainSize, &amp;plainSize, 0);\n    BYTE* plain = new BYTE[plainSize];\n    pState = NCryptDecrypt(hKey, (PBYTE)blob, blobSize, NULL, plain, plainSize, &amp;plainSize, 0);\n\n    delete[]plain;\n    delete[] blob; \n // the result should be the same Secret !\n}\n\n//Open a certificate store handle. For the purposes of this test, it does not matter what certificates are there.\n//After getting this to work at least once, will look at actually selecting the certificates.\nHCERTSTORE hSysStore = NULL;\nif (hSysStore = CertOpenStore(\n    CERT_STORE_PROV_SYSTEM,          // The store provider type\n    0,                               // The encoding type is not needed\n    NULL,                            // Use the default HCRYPTPROV\n    CERT_SYSTEM_STORE_CURRENT_USER,  // Set the store location in a registry location\n    L\"MY\"                            // The store name as a Unicode string\n))\n{\n\n}\nelse\n{\n    NCryptFreeObject(hKey);\n    NCryptFreeObject(hContainerKey);\n    NCryptFreeObject(hProv);\n    return -1;\n}\n\n//Export the certificate store blob. Exporting as a store, saving to memory.\nCERT_BLOB certStoreBlob;\ncertStoreBlob.pbData = nullptr;\ncertStoreBlob.cbData = 0;\nBOOL result = CertSaveStore(hSysStore, 0, CERT_STORE_SAVE_AS_STORE, CERT_STORE_SAVE_TO_MEMORY, &amp;certStoreBlob, 0);\nif (!result)\n{\n    DWORD error = GetLastError();\n    CertCloseStore(hSysStore, CERT_CLOSE_STORE_CHECK_FLAG);\n    NCryptFreeObject(hKey);\n    NCryptFreeObject(hContainerKey);\n    NCryptFreeObject(hProv);\n    return -1;\n}\n\nvector&lt;BYTE&gt; certBlobData(certStoreBlob.cbData);\ncertStoreBlob.pbData = certBlobData.data();\nresult = CertSaveStore(hSysStore, 0, CERT_STORE_SAVE_AS_STORE, CERT_STORE_SAVE_TO_MEMORY, &amp;certStoreBlob, 0);\nif (!result)\n{\n    DWORD error = GetLastError();\n    CertCloseStore(hSysStore, CERT_CLOSE_STORE_CHECK_FLAG);\n    NCryptFreeObject(hKey);\n    NCryptFreeObject(hContainerKey);\n    NCryptFreeObject(hProv);\n    return -1;\n}\n\nCertCloseStore(hSysStore, CERT_CLOSE_STORE_CHECK_FLAG);\n\nblobSize = 0;\nNCryptBuffer *PKCS7 = new NCryptBuffer[2];\nPKCS7[0].BufferType = NCRYPTBUFFER_PKCS_ALG_OID;\nPKCS7[0].pvBuffer = szOID_RSAES_OAEP;\nPKCS7[0].cbBuffer = strlen(szOID_RSAES_OAEP);\nPKCS7[1].BufferType = NCRYPTBUFFER_CERT_BLOB;\nPKCS7[1].pvBuffer = NULL;\nPKCS7[1].cbBuffer = 0;\nNCryptBufferDesc paramInfo;// = new NCryptBufferDesc[3];\nparamInfo.ulVersion = NCRYPTBUFFER_VERSION;\nparamInfo.cBuffers = 2;\nparamInfo.pBuffers = PKCS7;\npState = NCryptExportKey(hKey, hContainerKey, NCRYPT_PKCS7_ENVELOPE_BLOB, &amp;paramInfo, NULL, blobSize, &amp;blobSize, 0);\nif (pState != ERROR_SUCCESS)\n{\n\n    _wprintf_p(L\"NCryptExportKey AES key (%X). \", pState);\n    NCryptFreeObject(hKey);\n    NCryptFreeObject(hContainerKey);\n    NCryptFreeObject(hProv);\n    return -1;\n\n}\n\nblob = new BYTE[blobSize];\nNCryptExportKey(hKey, hContainerKey, NCRYPT_PKCS7_ENVELOPE_BLOB, &amp;parmInfo, blob, blobSize, &amp;blobSize, 0);\n\nNCryptFreeObject(hKey);\nNCryptFreeObject(hContainerKey);\nNCryptFreeObject(hProv);\n</code></pre>\n"}, {"tags": ["c", "integer-overflow", "unsigned-integer"], "comments": [{"owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "edited": false, "score": 3, "creation_date": 1505878163, "post_id": 46312779, "comment_id": 79587335, "body": "Yes it is! You can set <code>n</code> to 255. :-P"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1505878235, "post_id": 46312779, "comment_id": 79587361, "body": "There&#39;s no such thing is &quot;integer underflow&quot;, In the generally accepted nomenclature, &quot;underflow&quot; can only happen in floating-point arithmetic. As your your question, the answer is simple: just set your <code>n</code> to <code>255</code>. The simplicity and triviality of the answer makes one suspect that you missed something in your question."}, {"owner": {"reputation": 111, "user_id": 5471313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5404bdf1fba855b68a6e6bbc36f6219c?s=128&d=identicon&r=PG&f=1", "display_name": "NEz", "link": "https://stackoverflow.com/users/5471313/nez"}, "edited": false, "score": 1, "creation_date": 1505878283, "post_id": 46312779, "comment_id": 79587371, "body": "i&#39;m sorry, i meant by giving negative value. i have updated the question"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1505878363, "post_id": 46312779, "comment_id": 79587394, "body": "What is the type of <code>n</code>? Anyway, it is not possible to answer the question about negative value of <code>n</code> without knowing the exact characteristics of  <code>size_t</code> type (its range, specifically). It is platform-dependent. And you should use <code>%zu</code> to print <code>size_t</code> values, not <code>%lu</code>."}, {"owner": {"reputation": 111, "user_id": 5471313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5404bdf1fba855b68a6e6bbc36f6219c?s=128&d=identicon&r=PG&f=1", "display_name": "NEz", "link": "https://stackoverflow.com/users/5471313/nez"}, "edited": false, "score": 0, "creation_date": 1505878500, "post_id": 46312779, "comment_id": 79587428, "body": "&quot;n&quot; is of type int, and size_t is usually unsigned long I think."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1505878545, "post_id": 46312779, "comment_id": 79587440, "body": "Firstly, &quot;usually&quot; is not good enough. Secondly, it does not help at all since the range of <code>unsigned long</code> is still implementation-dependent, which makes your question impossible to answer without exploring all possible combinations."}, {"owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "edited": false, "score": 1, "creation_date": 1505878604, "post_id": 46312779, "comment_id": 79587452, "body": "If you cast a variable containing <code>-1</code> to an <code>uint8_t</code>, you&#39;ll get <code>255</code>. However, <code>255</code> is less than <code>0x8000</code>, so I don&#39;t think you&#39;ll be able to get it by casting a negative to any integer type larger than 8 bits. And needless to say, I don&#39;t think you&#39;re going to find any modern platforms (or ancient ones, for that matter) on which <code>unsigned long</code> is only 8 bits in size."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "edited": false, "score": 0, "creation_date": 1505878848, "post_id": 46312779, "comment_id": 79587517, "body": "@Charles Srstka: On a weird imaginary platform with 64-bit <code>int</code> and 32-bit <code>size_t</code> it would be perfectly possible. Setting <code>i</code> to <code>-9223372036854775553</code> would result in <code>255</code> in <code>j</code>. But true, if <code>int</code> is not wider than <code>size_t</code> then negative value in <code>i</code> will never produce <code>255</code> in <code>j</code>."}, {"owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "reply_to_user": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1505878894, "post_id": 46312779, "comment_id": 79587537, "body": "@AnT Ah, you are correct. However, I would be quite shocked indeed to see any platform in which <code>int</code> was larger than <code>size_t</code>."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "edited": false, "score": 0, "creation_date": 1505880996, "post_id": 46312779, "comment_id": 79588018, "body": "@CharlesSrstka <code>unsigned long</code> must be at least 32 bits"}, {"owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1505882932, "post_id": 46312779, "comment_id": 79588565, "body": "@M.M You don&#39;t say!"}, {"owner": {"reputation": 5001, "user_id": 1182192, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/J6JgX.jpg?s=128&g=1", "display_name": "Abhineet", "link": "https://stackoverflow.com/users/1182192/abhineet"}, "edited": false, "score": 0, "creation_date": 1505883083, "post_id": 46312779, "comment_id": 79588619, "body": "What is <code>underflow</code>? Kindly remove all <code>underflow</code> words from your title and question."}], "answers": [{"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1505883487, "post_id": 46313404, "comment_id": 79588775, "body": "In the latter code, the behaviour is implementation-defined (and may raise a signal)"}], "tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": true, "score": 1, "last_activity_date": 1505883844, "last_edit_date": 1505883844, "creation_date": 1505882309, "answer_id": 46313404, "question_id": 46312779, "link": "https://stackoverflow.com/questions/46312779/integer-overflow-underflow/46313404#46313404", "title": "Integer overflow/underflow", "body": "<p>I think what you're looking for is</p>\n\n<pre><code>signed char i = -1;\nunsigned char j = i;\nprintf(\"%u\\n\", j);\n</code></pre>\n\n<p>In 8 bits, the signed number -1 \"wraps around\" to the unsigned value 255.</p>\n\n<p>You asked about <code>size_t</code> because, yes, it's an unsigned type, but it's typically 32 or even 64 bits.  At those sizes, the number 255 is representable (and has the same representation) in both the signed and unsigned variants, so there isn't a negative number that corresponds to 255.  But you can certainly see similar effects, using different values.  For example, on a machine with 32-bit ints, this code:</p>\n\n<pre><code>unsigned int i = 4294967041;\nint j = i;\nprintf(\"%d\\n\", j);\n</code></pre>\n\n<p>is likely to print -255.  This value comes about because 2^32 - 255 = 4294967041.</p>\n"}], "owner": {"reputation": 111, "user_id": 5471313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5404bdf1fba855b68a6e6bbc36f6219c?s=128&d=identicon&r=PG&f=1", "display_name": "NEz", "link": "https://stackoverflow.com/users/5471313/nez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 781, "favorite_count": 0, "accepted_answer_id": 46313404, "answer_count": 1, "score": 0, "last_activity_date": 1505883844, "creation_date": 1505878077, "last_edit_date": 1505878243, "question_id": 46312779, "link": "https://stackoverflow.com/questions/46312779/integer-overflow-underflow", "title": "Integer overflow/underflow", "body": "<p>I am learning about integer overflows and underflows and was wondering if it is it possible to control the value of j by giving a negative input n?</p>\n\n<pre><code>int i = n;\nsize_t j = i;\nprintf(\"%lu\",j);\n</code></pre>\n\n<p>for example, if I want the value of \"j\" to be 255, is it possible to craft the negative number \"n\" to give me that output?</p>\n"}, {"tags": ["c", "data-structures", "queue"], "answers": [{"comments": [{"owner": {"reputation": 1143, "user_id": 7474663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m6ZSf.jpg?s=128&g=1", "display_name": "Ashutosh Pathak", "link": "https://stackoverflow.com/users/7474663/ashutosh-pathak"}, "edited": false, "score": 0, "creation_date": 1505960740, "post_id": 46314931, "comment_id": 79629367, "body": "Thanks, man! replacing gets with scanf() worked. But still, I&#39;m only able to pass 80% of the test cases for this problem!"}], "tags": [], "owner": {"reputation": 337, "user_id": 2563058, "user_type": "registered", "accept_rate": 90, "profile_image": "https://graph.facebook.com/1513172627/picture?type=large", "display_name": "qwn", "link": "https://stackoverflow.com/users/2563058/qwn"}, "is_accepted": false, "score": 0, "last_activity_date": 1505889563, "creation_date": 1505889563, "answer_id": 46314931, "question_id": 46312640, "link": "https://stackoverflow.com/questions/46312640/printing-of-circular-queue-in-c/46314931#46314931", "title": "Printing of Circular Queue in C", "body": "<p>Some char remains in the stdin buffer after your input (scanf does not read newline char), either flush the stdin buffer <code>fflush(stdin)</code>or use <code>scanf(\"%s\", add_item)</code></p>\n\n<p>Also I might add that <code>gets</code> is prone to buffer overflow problems you are much better off using <code>fgets</code></p>\n"}], "owner": {"reputation": 1143, "user_id": 7474663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m6ZSf.jpg?s=128&g=1", "display_name": "Ashutosh Pathak", "link": "https://stackoverflow.com/users/7474663/ashutosh-pathak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 739, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1505889563, "creation_date": 1505877077, "question_id": 46312640, "link": "https://stackoverflow.com/questions/46312640/printing-of-circular-queue-in-c", "title": "Printing of Circular Queue in C", "body": "<p>I'm trying to get the output of this program correctly, but I'm not able to. This is because I'm not able to input any string in the insert() function after the line <em>\"printf(\"Enter the string to be inserted = \\n\");\"</em> although I am using gets() with proper header file.\nThe output I'm getting is something like this:</p>\n\n<pre><code>Choice 1 : Enter element into Queue \nChoice 2 : Delete element from Queue \nChoice 3 : Display \nAny other choice : Exit \nEnter your choice\n1\nEnter the string to be inserted =  \nChoice 1 : Enter element into Queue \nChoice 2 : Delete element from Queue \nChoice 3 : Display \nAny other choice : Exit \nEnter your choice\n1\nEnter the string to be inserted =  \nChoice 1 : Enter element into Queue \nChoice 2 : Delete element from Queue \nChoice 3 : Display \nAny other choice : Exit \nEnter your choice\n1\nEnter the string to be inserted =  \nChoice 1 : Enter element into Queue \nChoice 2 : Delete element from Queue \nChoice 3 : Display \nAny other choice : Exit \nEnter your choice\n3\nThe contents of the queue are \n\n\n\nChoice 1 : Enter element into Queue \nChoice 2 : Delete element from Queue \nChoice 3 : Display \nAny other choice : Exit \nEnter your choice\n2\nDeleted string is =\n\nChoice 1 : Enter element into Queue \nChoice 2 : Delete element from Queue \nChoice 3 : Display \nAny other choice : Exit \nEnter your choice\n3\nThe contents of the queue are \n\n\nChoice 1 : Enter element into Queue \nChoice 2 : Delete element from Queue \nChoice 3 : Display \nAny other choice : Exit \nEnter your choice\n2\nDeleted string is =\n\nChoice 1 : Enter element into Queue \nChoice 2 : Delete element from Queue \nChoice 3 : Display \nAny other choice : Exit \nEnter your choice\n3\nThe contents of the queue are \n\nChoice 1 : Enter element into Queue \nChoice 2 : Delete element from Queue \nChoice 3 : Display \nAny other choice : Exit \nEnter your choice\n2\nDeleted string is =\n\nChoice 1 : Enter element into Queue \nChoice 2 : Delete element from Queue \nChoice 3 : Display \nAny other choice : Exit \nEnter your choice\n3\nQueue is empty \nChoice 1 : Enter element into Queue \nChoice 2 : Delete element from Queue \nChoice 3 : Display \nAny other choice : Exit \nEnter your choice\n4\n</code></pre>\n\n<p>The program I've written is as follows:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;string.h&gt;\n#define MAX 5\n\nint front = 0;\nint rear = -1;\nchar queue_array[MAX][30];\n\nvoid insert();\nvoid Delete();\nvoid display();\n\nint main()\n{\n    int choice;\n    while(1)\n    {\n        printf(\"Choice 1 : Enter element into Queue\\n\");\n        printf(\"Choice 2 : Delete element from Queue\\n\");\n        printf(\"Choice 3 : Display\\n\");\n        printf(\"Any other choice : Exit\\n\");\n        printf(\"Enter your choice\\n\");\n        scanf(\"%d\", &amp;choice);\n        switch(choice)\n        {\n            case 1: insert();\n                    break;\n            case 2: Delete();\n                    break;\n            case 3: display();\n                    break;\n            default:exit(0);\n        } // End of switch()\n    } // End of while()\n} // End of main()\n\nvoid insert()\n{\n    char add_item[30];\n    if((front == 0 &amp;&amp; rear == MAX - 1) || (front != 0 &amp;&amp; rear == front - 1))\n        printf(\"Queue is full\\n\");\n    else\n    {\n        printf(\"Enter the string to be inserted = \\n\");\n        gets(add_item);\n        if(rear == MAX - 1 &amp;&amp; front != 0)\n        {\n            rear = 0;\n            strcpy(queue_array[rear], add_item);\n        }\n        else\n        {\n            rear = rear + 1;\n            strcpy(queue_array[rear], add_item);\n        }\n    }\n}\n\nvoid Delete()\n{\n    char del_item[30];\n    if(front == 0 &amp;&amp; rear == -1)\n    {\n        printf(\"Queue is empty\\n\");\n        return;\n    }\n    if(front == rear)\n    {\n        strcpy(del_item, queue_array[front]);\n        front = 0;\n        rear = -1;\n    }\n    else if(front == MAX - 1)\n    {\n        strcpy(del_item, queue_array[front]);\n        front = 0;\n    }\n    else\n    {\n        front = front + 1;\n        strcpy(del_item, queue_array[front]);\n    }\n    printf(\"Deleted string is =\\n\");\n    puts(del_item);\n} // End of delete()\n\nvoid display()\n{\n    int i, j;\n    if(front == 0 &amp;&amp; rear == -1)\n    {    \n        printf(\"Queue is empty\\n\");\n        return;\n    }\n    printf(\"The contents of the queue are \");\n    if(front &gt; rear)\n    {\n        for(i = 0; i &lt;= rear; i++)\n            puts(queue_array[i]);\n        for(j = front; j &lt; MAX - 1; j++)\n            puts(queue_array[j]);\n    }\n    else\n    {\n        for(i = front; i &lt;= rear; i++)\n            puts(queue_array[i]);\n    }\n    printf(\"\\n\");\n} // End of display()\n</code></pre>\n\n<p>I would really appreciate any help. Thanks in advance :)</p>\n"}, {"tags": ["c", "variables", "extern"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1505879315, "post_id": 46312564, "comment_id": 79587620, "body": "If you think about how <code>#include</code> works, you will realize that it&#39;s normal for the translation unit with the definition to also have the extern declaration"}], "answers": [{"comments": [{"owner": {"reputation": 417, "user_id": 7159879, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a2c00a33a360b1adf5d7b87e2df3759f?s=128&d=identicon&r=PG&f=1", "display_name": "user7159879", "link": "https://stackoverflow.com/users/7159879/user7159879"}, "edited": false, "score": 0, "creation_date": 1505878120, "post_id": 46312733, "comment_id": 79587330, "body": "So, in my case, although global variable has external linkage by default, using extern keyword here explicitly means it explicitly tells it has external linkage. Am I right?"}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "reply_to_user": {"reputation": 417, "user_id": 7159879, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a2c00a33a360b1adf5d7b87e2df3759f?s=128&d=identicon&r=PG&f=1", "display_name": "user7159879", "link": "https://stackoverflow.com/users/7159879/user7159879"}, "edited": false, "score": 0, "creation_date": 1505878287, "post_id": 46312733, "comment_id": 79587373, "body": "@user7159879 Right. This is an unusual way to declare a usual global variable."}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 1, "creation_date": 1505891775, "post_id": 46312733, "comment_id": 79592561, "body": "With and without <code>extern</code> is not exactly the same thing. Without <code>extern</code> it could be a <i>tentative definition</i>, with <code>extern</code> it can&#39;t."}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "reply_to_user": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 0, "creation_date": 1505902322, "post_id": 46312733, "comment_id": 79599376, "body": "@JensGustedt You are right, thank you for the note. I edited the answer to include an explanation."}], "tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": true, "score": 2, "last_activity_date": 1505902282, "last_edit_date": 1505902282, "creation_date": 1505877743, "answer_id": 46312733, "question_id": 46312564, "link": "https://stackoverflow.com/questions/46312564/what-does-it-mean-when-there-exist-both-declaration-of-variable-and-its-extern-d/46312733#46312733", "title": "what does it mean when there exist both declaration of variable and its extern declaration in the same file?", "body": "<p>The first declaration is unusual in that it specifies <code>extern</code> explicitly, rather than relying on the default. Since the variables are declared in the file scope, they have external linkage by default, i.e. in your case the declaration is equivalent<sup>*</sup> to</p>\n\n<pre><code>FILE *yyin, *yyout;\n</code></pre>\n\n<p>Recall that each variable has a <em>scope</em>, <em>storage duration</em>, and <em>linkage</em>. Keyword <code>extern</code> specifies that a variable has external linkage; other options for linkage are <code>static</code> and no linkage.</p>\n\n<p>Variables can have multiple declarations. As long as multiple declarations do not conflict with each other, C compiler can combine them.</p>\n\n<p>In your case variables <code>yyin</code> and <code>yyout</code> have a declaration that says the variables have external linkage, and a definition that initializes both variables to <code>NULL</code>.</p>\n\n<p><sup>*</sup>The reason it is equivalent is that there are no other declarations of <code>yyin</code> and <code>yyout</code>. In general, a declaration without <code>extern</code> could become a definition if no other definition is provided in the same translation unit. This is called <em>tentative definition</em>. The declaration with <code>extern</code> does not become a tentative definition.</p>\n"}], "owner": {"reputation": 417, "user_id": 7159879, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a2c00a33a360b1adf5d7b87e2df3759f?s=128&d=identicon&r=PG&f=1", "display_name": "user7159879", "link": "https://stackoverflow.com/users/7159879/user7159879"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 46312733, "answer_count": 1, "score": 3, "last_activity_date": 1505902282, "creation_date": 1505876571, "last_edit_date": 1505876934, "question_id": 46312564, "link": "https://stackoverflow.com/questions/46312564/what-does-it-mean-when-there-exist-both-declaration-of-variable-and-its-extern-d", "title": "what does it mean when there exist both declaration of variable and its extern declaration in the same file?", "body": "<p>While I analyze some source codes, I found following definitions <strong>in one file(.c), not different file</strong> (This is one of the codes in a file produced by flex and there is no included file(stdio.h, string.h, errno.h, stdlib.h, inttypes.h) that defines yyin ):</p>\n\n<pre><code>extern FILE *yyin, *yyout;\n\nFILE *yyin = (FILE*) 0, *yyout = (FILE *) 0;\n</code></pre>\n\n<p>I basically know what these statements mean. </p>\n\n<p>But, extern keyword is used to make use of definitions such as variable, and function that live in another file. (It does not allocate memory for it.)</p>\n\n<p>So, what I mean is that the code :</p>\n\n<pre><code>FILE *yyin = (FILE*) 0, *yyout = (FILE *) 0;\n</code></pre>\n\n<p>has to appear in another file, not in the same file.</p>\n\n<p>For instance,</p>\n\n<pre><code>a.c\n\nextern File *yyin;  /* It means that a.c want to use yyin declared in b.c */\n\nint main(void) {\n   yyin = *expressions*; /* yyin is variable in b.c */\n\n   return 0;\n}\n\nb.c\n\nFile *yyin = (FILE*) 0;\n</code></pre>\n\n<p>Why do they exist in the same file? Are there any special meanings when extern keyword and normal variable declaration using same name live in the same file?</p>\n"}, {"tags": ["c", "user-input"], "comments": [{"owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 0, "creation_date": 1505876535, "post_id": 46312523, "comment_id": 79586984, "body": "<code>input</code> never actually changes inside your loop, so it <code>input[0] != &#39;\\0&#39;</code> the first time through the loop then it will be the same the second time and the third and the 710143rd time"}], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 7675168, "user_type": "registered", "profile_image": "https://graph.facebook.com/706160779556907/picture?type=large", "display_name": "Alikeju Adejo", "link": "https://stackoverflow.com/users/7675168/alikeju-adejo"}, "edited": false, "score": 0, "creation_date": 1505878025, "post_id": 46312548, "comment_id": 79587305, "body": "I changed the <code>\\0</code> to a <code>\\n</code> and it still gives me an infinite loop. Still very confused on why this is happening."}, {"owner": {"reputation": 2928, "user_id": 5927758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QmcMj.png?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/5927758/mitch"}, "reply_to_user": {"reputation": 111, "user_id": 7675168, "user_type": "registered", "profile_image": "https://graph.facebook.com/706160779556907/picture?type=large", "display_name": "Alikeju Adejo", "link": "https://stackoverflow.com/users/7675168/alikeju-adejo"}, "edited": false, "score": 0, "creation_date": 1505878378, "post_id": 46312548, "comment_id": 79587397, "body": "what does the scanf statement look like"}, {"owner": {"reputation": 111, "user_id": 7675168, "user_type": "registered", "profile_image": "https://graph.facebook.com/706160779556907/picture?type=large", "display_name": "Alikeju Adejo", "link": "https://stackoverflow.com/users/7675168/alikeju-adejo"}, "edited": false, "score": 0, "creation_date": 1505878450, "post_id": 46312548, "comment_id": 79587410, "body": "<code>scanf(&quot;%s&quot;, &amp;input);</code>"}, {"owner": {"reputation": 111, "user_id": 7675168, "user_type": "registered", "profile_image": "https://graph.facebook.com/706160779556907/picture?type=large", "display_name": "Alikeju Adejo", "link": "https://stackoverflow.com/users/7675168/alikeju-adejo"}, "edited": false, "score": 0, "creation_date": 1505878756, "post_id": 46312548, "comment_id": 79587493, "body": "Okay, I will try it now. Thank you for your help and time."}, {"owner": {"reputation": 2928, "user_id": 5927758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QmcMj.png?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/5927758/mitch"}, "edited": false, "score": 0, "creation_date": 1505878871, "post_id": 46312548, "comment_id": 79587527, "body": "The above code will work, however if the user does not press enter you will have no access to what they inputted, make sure you record it"}, {"owner": {"reputation": 111, "user_id": 7675168, "user_type": "registered", "profile_image": "https://graph.facebook.com/706160779556907/picture?type=large", "display_name": "Alikeju Adejo", "link": "https://stackoverflow.com/users/7675168/alikeju-adejo"}, "edited": false, "score": 0, "creation_date": 1505879207, "post_id": 46312548, "comment_id": 79587601, "body": "Yes I just noticed that. But now it is not iterating through my linked list and not giving the desired output. :( I will do some debugging."}], "tags": [], "owner": {"reputation": 2928, "user_id": 5927758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QmcMj.png?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/5927758/mitch"}, "is_accepted": false, "score": 1, "last_activity_date": 1505876470, "creation_date": 1505876470, "answer_id": 46312548, "question_id": 46312523, "link": "https://stackoverflow.com/questions/46312523/terminating-program-on-an-empty-string-in-c/46312548#46312548", "title": "Terminating program on an empty string in C", "body": "<p>When the user presses enter they are not entering a NULL character, they are entering a newline. Try checking for <code>\\n</code></p>\n"}], "owner": {"reputation": 111, "user_id": 7675168, "user_type": "registered", "profile_image": "https://graph.facebook.com/706160779556907/picture?type=large", "display_name": "Alikeju Adejo", "link": "https://stackoverflow.com/users/7675168/alikeju-adejo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1506061929, "creation_date": 1505876244, "last_edit_date": 1506061929, "question_id": 46312523, "link": "https://stackoverflow.com/questions/46312523/terminating-program-on-an-empty-string-in-c", "title": "Terminating program on an empty string in C", "body": "<p>So, I am very new to C and I am trying to terminate my program on an empty string (when the user presses enter with nothing there) but for some reason it is giving me an infinite loop.</p>\n\n<p>Here is my code: </p>\n\n<pre><code>while(input[0] != '\\0') {\n    if(slot &lt; 27 &amp;&amp; slot &gt;= 0) {\n        struct LinkedList curr = files[slot];\n        if(strcmpci(input, curr.val) == 0) {\n            printf(\"%s, \\n\", curr.val);\n        }\n\n        while(curr.next != NULL) {\n            curr = (*(curr.next));\n            if(strcmpci(input, curr.val) == 0) {\n                printf(\"%s\\n\", curr.val);\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>and everywhere that I have went has told me to end my loop with this format </p>\n\n<pre><code>while(____ != '\\0') {\n}\n</code></pre>\n\n<p>so I am very confused.</p>\n"}, {"tags": ["c", "linux", "fork"], "comments": [{"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1505873327, "post_id": 46312154, "comment_id": 79586291, "body": "I would suggest adding comments to the code to preserve your understanding. For example, inside the first <code>if (fork ())</code> block, you can add a comment &quot;first fork returned non-zero, this is the parent&quot;. And continue through the whole program."}, {"owner": {"reputation": 23, "user_id": 8637805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/558d3c9793a9b49b2dc5f68991eee5c4?s=128&d=identicon&r=PG&f=1", "display_name": "Derek", "link": "https://stackoverflow.com/users/8637805/derek"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1505874170, "post_id": 46312154, "comment_id": 79586471, "body": "Made the edits, still looking for some further detailed assistance, thanks."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1505874229, "post_id": 46312154, "comment_id": 79586486, "body": "This code was asked about, presumably by someone else, in the last couple of weeks."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 8637805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/558d3c9793a9b49b2dc5f68991eee5c4?s=128&d=identicon&r=PG&f=1", "display_name": "Derek", "link": "https://stackoverflow.com/users/8637805/derek"}, "edited": false, "score": 0, "creation_date": 1505874149, "post_id": 46312187, "comment_id": 79586462, "body": "Hi @JohnDoe thanks for your reply.  So in the ` else if ` statement, is that process the child process or parent?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 23, "user_id": 8637805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/558d3c9793a9b49b2dc5f68991eee5c4?s=128&d=identicon&r=PG&f=1", "display_name": "Derek", "link": "https://stackoverflow.com/users/8637805/derek"}, "edited": false, "score": 0, "creation_date": 1505874631, "post_id": 46312187, "comment_id": 79586582, "body": "@Derek :  it is the child of the initial process and the parent of the final process."}, {"owner": {"reputation": 23, "user_id": 8637805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/558d3c9793a9b49b2dc5f68991eee5c4?s=128&d=identicon&r=PG&f=1", "display_name": "Derek", "link": "https://stackoverflow.com/users/8637805/derek"}, "edited": false, "score": 0, "creation_date": 1505874974, "post_id": 46312187, "comment_id": 79586650, "body": "Thanks for your reply.  Also, I just want to confirm how we know that ALL conditional statements will be executed?"}, {"owner": {"reputation": 1491, "user_id": 6232148, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9255cf10ac80e07a45561bbe5316a57f?s=128&d=identicon&r=PG&f=1", "display_name": "rma", "link": "https://stackoverflow.com/users/6232148/rma"}, "edited": false, "score": 0, "creation_date": 1505875348, "post_id": 46312187, "comment_id": 79586735, "body": "We know that all conditonal statements will be executed because the parent will always execute the if(), the child will always execute the else if() and the grandchild will always execute the else."}, {"owner": {"reputation": 23, "user_id": 8637805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/558d3c9793a9b49b2dc5f68991eee5c4?s=128&d=identicon&r=PG&f=1", "display_name": "Derek", "link": "https://stackoverflow.com/users/8637805/derek"}, "edited": false, "score": 0, "creation_date": 1506224435, "post_id": 46312187, "comment_id": 79730639, "body": "@JohnDoe how would I determine how many processes are created in total in this code?  I know the general formula for total # of processes is 2^n where n is the number of fork system calls."}, {"owner": {"reputation": 1491, "user_id": 6232148, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9255cf10ac80e07a45561bbe5316a57f?s=128&d=identicon&r=PG&f=1", "display_name": "rma", "link": "https://stackoverflow.com/users/6232148/rma"}, "edited": false, "score": 0, "creation_date": 1506240074, "post_id": 46312187, "comment_id": 79733458, "body": "Think about it logically for this example. It&#39;s small enough to trace through, so you can see the parent forks a child which forks a grandchild. It&#39;s not 2^n here because of the conditional statements"}], "tags": [], "owner": {"reputation": 1491, "user_id": 6232148, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9255cf10ac80e07a45561bbe5316a57f?s=128&d=identicon&r=PG&f=1", "display_name": "rma", "link": "https://stackoverflow.com/users/6232148/rma"}, "is_accepted": true, "score": 2, "last_activity_date": 1505873384, "creation_date": 1505873384, "answer_id": 46312187, "question_id": 46312154, "link": "https://stackoverflow.com/questions/46312154/fork-program-in-c/46312187#46312187", "title": "Fork() program in C", "body": "<p>The child process can be printed before the parent finishes. Remember, in the parent process, the call to <code>fork()</code> returns a nonzero number, while in the child it will return 0. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n\nint main() {  \n\nint i = 1;\n\n   if (fork ())\n        i++;\n   else if (fork())\n            i--;\n       else\n            i++;\n\n printf(\"%d\\n\", i);\n}\n</code></pre>\n\n<p>For the above code, the parent will execute the first if() statement, the child will execute the else if statement and the grandchild will execute the else statement. The child/grandchild/parent can be printed in any order. So, 2 0 2, 2 2 0 and 0 2 2 are all viable solutions.</p>\n"}], "owner": {"reputation": 23, "user_id": 8637805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/558d3c9793a9b49b2dc5f68991eee5c4?s=128&d=identicon&r=PG&f=1", "display_name": "Derek", "link": "https://stackoverflow.com/users/8637805/derek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 46312187, "answer_count": 1, "score": 0, "last_activity_date": 1505874075, "creation_date": 1505873068, "last_edit_date": 1505874075, "question_id": 46312154, "link": "https://stackoverflow.com/questions/46312154/fork-program-in-c", "title": "Fork() program in C", "body": "<p>so I am attempting to solve a problem in my book regarding the fork system call in C.</p>\n\n<p>Here is the following code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n\nint main() {  \n\nint i = 1;\n\n   if (fork ()) //parent process will return PID of child.\n        i++;\n   else if (fork()) //child process (becomes parent)\n            i--;\n       else //grandchild process returns 0\n            i++;\n\n printf(\"%d\\n\", i);\n}\n</code></pre>\n\n<p>After going through the code, I got 2 0 2 as the solution.  I am confused though since I don't know which order is correct? Can the child processes get printed out before the parent does? If so, another viable solution could be <strong>0 2 2 or 2 2 0.</strong>  How do I know if all the conditional statements will be executed?  I know in the first conditional, the <code>if</code> statement will be executed and will be the parent process (which will return the process ID of the child, and the value of i will increment to 2).  How would I know if the <code>else if</code> and <code>else</code>code will be executed?  Sorry, I am just confused and trying to wrap my head around this as this is a new topic for me.</p>\n\n<p>Any help would be greatly appreciated.  Thank you in advance.</p>\n"}, {"tags": ["c", "multithreading"], "answers": [{"tags": [], "owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "is_accepted": true, "score": 1, "last_activity_date": 1505871292, "creation_date": 1505871292, "answer_id": 46311963, "question_id": 46311877, "link": "https://stackoverflow.com/questions/46311877/core-dumped-trying-to-print-min-with-threads/46311963#46311963", "title": "Core Dumped - Trying to print Min with Threads", "body": "<p>You're passing <code>NULL</code> as the parameter to <code>myMin2</code>.  You need to pass <code>argv</code> instead.</p>\n\n<pre><code>pthread_create(&amp;tid, 0, myMin2, argv);\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 8242803, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/da131b9215a09e7c916ca12ea2fc3597?s=128&d=identicon&r=PG&f=1", "display_name": "NikkiNelson", "link": "https://stackoverflow.com/users/8242803/nikkinelson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 46311963, "answer_count": 1, "score": -1, "last_activity_date": 1506121760, "creation_date": 1505870707, "last_edit_date": 1506121760, "question_id": 46311877, "link": "https://stackoverflow.com/questions/46311877/core-dumped-trying-to-print-min-with-threads", "title": "Core Dumped - Trying to print Min with Threads", "body": "<p>I'm trying to use threads to print out the minimum number in an array I have done this in the following code for a static array:</p>\n\n<pre><code>#include &lt;pthread.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint length = 5;\nint nums[5] = {93, 12, 54, 72, 68};\nint r_min;\n\nvoid *myMin(void *param) {\n    int i;\n\n    r_min = nums[0];\n    for(i = 0; i &lt; length; ++i) {\n        if(r_min &gt; nums[i]) r_min = nums[i];\n    }\n    pthread_exit(0);\n}\n\nint main(int argc, char** argv) {\n    pthread_t tid;\n    pthread_create(&amp;tid, 0, myMin, NULL);\n    pthread_join(tid, NULL);\n    printf(\"Min = %d\\n\", r_min);\n    return 0;\n}\n</code></pre>\n\n<p>This correctly prints out \"12\" in my example, which is correct. I'm trying to now implement taking in numbers from the command line instead of the hard-coded array and printing out the correct response. My new code is as follows: </p>\n\n<pre><code>#include &lt;pthread.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint length = 5;\nint nums[5] = {93, 12, 54, 72, 68};\nint r_min;\n\nvoid *myMin(void *param) {\n    int i;\n\n    r_min = nums[0];\n    for(i = 0; i &lt; length; ++i) {\n        if(r_min &gt; nums[i]) r_min = nums[i];\n    }\n    pthread_exit(0);\n}\n\nvoid* myMin2(void *param) {\n    char** argv;\n    int i, j;\n    // printf(\"Test\");\n    argv = param;\n    for(i = 0; i &lt; length; ++i){\n        printf(\"%s\\n\", argv[i]);\n\n        if(i &gt; 0){\n            j = atoi(argv[1]);\n            printf(\" %d\\n\", j);\n        }\n    }\n\n    pthread_exit(0);\n}\n\nint main(int argc, char** argv) {\n    pthread_t tid;\n    length = argc;\n    pthread_create(&amp;tid, 0, myMin2, NULL);\n    pthread_join(tid, NULL);\n    printf(\"Min = %d\\n\", r_min);\n    return 0;\n}\n</code></pre>\n\n<p>I'm setting the length equal to the amount of arguments added (I can/will add a -1 there since calling the execution command counts as 1). When I call my new Min2 function I just get a segmentation fault (core dumped) and I'm not entirely sure why. I'm very new to the C language so this is all confusing stuff to me! Thanks for your assistance! :)</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 12557, "user_id": 1270789, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/FXwoB.png?s=128&g=1", "display_name": "Ken Y-N", "link": "https://stackoverflow.com/users/1270789/ken-y-n"}, "edited": false, "score": 1, "creation_date": 1505869480, "post_id": 46311728, "comment_id": 79585334, "body": "You&#39;re not going to fit a 7-digit number (plus the nul-terminator, of course) into <code>char phoneNum[6];</code>. And you want <code>strlen()</code>."}, {"owner": {"reputation": 1297, "user_id": 5042431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VZqF.jpg?s=128&g=1", "display_name": "Charles", "link": "https://stackoverflow.com/users/5042431/charles"}, "edited": false, "score": 0, "creation_date": 1505869527, "post_id": 46311728, "comment_id": 79585343, "body": "You&#39;ll also want to loop through and make sure all of the characters are numbers or a &#39;-&#39;"}], "answers": [{"tags": [], "owner": {"reputation": 4703, "user_id": 5375464, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3292ca87ff6c766b75dbe4b2ea0831da?s=128&d=identicon&r=PG&f=1", "display_name": "J...S", "link": "https://stackoverflow.com/users/5375464/j-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1505871206, "last_edit_date": 1505871206, "creation_date": 1505870689, "answer_id": 46311874, "question_id": 46311728, "link": "https://stackoverflow.com/questions/46311728/how-to-check-if-string-is-an-invalid-input/46311874#46311874", "title": "how to check if string is an invalid input", "body": "<p>To store a 7 character string, the character array size must be at least 8 to store the 7 characters and the <code>\\0</code> character to mark the end of string.\nIf you intend to store the modified string with the <code>-</code> in the same array, the size must be at least 9.</p>\n\n<pre><code>char phoneNum[9];\n</code></pre>\n\n<p>And user might enter more than 7 characters to cause overflow.</p>\n\n<p>Try</p>\n\n<pre><code>scanf(\"%7s\", phoneNum);\n</code></pre>\n\n<p>To find if the string is all numbers, use a loop</p>\n\n<pre><code>for(i=0; phoneNum[i]!='\\0'; ++i)\n{\n    if(!isdigit(phoneNum[i]))\n    {\n        break;\n    }\n}\nif(phoneNum[i]!='\\0')\n{\n    printf(\"\\nInvalid input.\");\n}\n</code></pre>\n\n<p>To find the length of the string, use <code>strlen()</code>.</p>\n\n<p>To insert a <code>-</code> at the 3rd index of string, you must shift all indices from that index till the end of string (including the <code>\\0</code> character).</p>\n\n<pre><code>for(i=8; i&gt;3; --i)\n{\n    phoneNum[i]=phoneNum[i-1];\n}\nphoneNum[3]='-';\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1505877350, "creation_date": 1505877350, "answer_id": 46312678, "question_id": 46311728, "link": "https://stackoverflow.com/questions/46311728/how-to-check-if-string-is-an-invalid-input/46312678#46312678", "title": "how to check if string is an invalid input", "body": "<blockquote>\n  <p>I'm looking to check initially if the users phone number is 7 digits long, if not or if any other character besides a number is entered.</p>\n</blockquote>\n\n<p>Avoid <code>scanf(\"%s\", phoneNum);</code>.  It is not limited in the amount it reads, does not read an entire <em>line</em> (misses spaces), and leaves the line's <code>'\\n'</code> in <code>stdin</code>.</p>\n\n<p>Use a large enough buffer for the job.  No need to be stingy.  Recommend a buffer  2x expected needs.</p>\n\n<pre><code>// Make a function to read a number and ask for input\nchar *read_phone(char *buf, size_t size, const char *prompt) {\n  char *reprompt = \"\";\n  while (1) {\n    printf(\"%s%s\", reprompt, prompt);\n    reprompt = \" Invalid Input\";  // ready re-prompt should code iterate\n    fflush(stdout); // Insure output is seen\n\n    // Read a line of user input in as a string.\n    if (fgets(buf, size, stdin) == NULL) {\n      return NULL;\n    }\n\n    // For OP to do, iterate with `i` through buf[] insuring expected pattern\n    int i = 0;\n    // next lines pseudo code\n    if (!OP_code_pattern(buf)) {\n      continue;  // try again\n    }\n\n    // If at end-of-line, lop it off\n    if (buf[i] == '\\n') {\n      buf[i] = '\\0';\n    }\n\n    // If at end of string - success\n    if (buf[i] == '\\0') {\n      return buf;\n    }\n  }\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7781271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0593c61ac9a9ef991f4f0011c9603315?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/7781271/josh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 852, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1505877350, "creation_date": 1505869286, "question_id": 46311728, "link": "https://stackoverflow.com/questions/46311728/how-to-check-if-string-is-an-invalid-input", "title": "how to check if string is an invalid input", "body": "<p>I am new to c all the help would be appreciated even if it's just linking me to another forum.</p>\n\n<p>I am writing a very basic program I am taking a 7 digit phone number and placing a \"-\" in between eg. \"1234567\" to \"123-4567\"</p>\n\n<p>I'm looking to check initially if the users phone number is 7 digits long, if not or if any other character besides a number is entered I'd like to display an \" Invalid Input\" and re-ask the question</p>\n\n<p>Thanks for all the help!</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n   char phoneNum[6];\n\n   printf(\"Enter your phone number\\n: \");\n   scanf(\"%s\", phoneNum);\n\n\n   printf(\"Your Phone Number: %.3s\", phoneNum);\n   printf(\"-%.4s\", phoneNum + 3);\n\n   return(0);\n}\n</code></pre>\n"}, {"tags": ["c", "macros", "c-preprocessor"], "comments": [{"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1505863108, "post_id": 46310987, "comment_id": 79583869, "body": "Can you be more specific about where these commas are going to come from and what they need to be &quot;shielded&quot; from? Do you want to be able to do something like <code>MYMACRO(1, 2, 3)</code> and somehow signal that <code>1, 2</code> is one argument?"}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1505863249, "post_id": 46310987, "comment_id": 79583908, "body": "Parentheses will shield the commas, but you&#39;ll have a hard time of removing them in them from the macro output without variadic macros. (Well, IDK how to do it without them, perhaps you&#39;ll come up with something.)"}, {"owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "reply_to_user": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 1, "creation_date": 1505863723, "post_id": 46310987, "comment_id": 79584037, "body": "@PSkocik who doesn&#39;t have variadic macros these days?"}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 0, "creation_date": 1505863770, "post_id": 46310987, "comment_id": 79584053, "body": "@o11c The OP, it would appear :("}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1505863812, "post_id": 46310987, "comment_id": 79584068, "body": "...and there is always the funky <code>do{...}while(0)</code>"}, {"owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "reply_to_user": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1505863997, "post_id": 46310987, "comment_id": 79584111, "body": "@PSkocik I&#39;m pretty sure the OP only means &quot;I need more stuff in <i>this</i> macro so variadic macros aren&#39;t <i>applicable</i>&quot;. My method lets multiple arguments contain commas."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1505864130, "post_id": 46310987, "comment_id": 79584143, "body": "...and the real answer is possibly:use a static function, and allow it to be inlined."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1505921975, "post_id": 46310987, "comment_id": 79613455, "body": "That macro is big enough that ideally it should be converted to a function.  However, since you&#39;re passing type names as arguments to the macro, that&#39;s not feasible.  You should really provide a motivating example use of the macro \u2014 an example of the call that needs commas that aren&#39;t manageable, along with an explanation of why the commas are needed."}], "answers": [{"comments": [{"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1505864558, "post_id": 46311121, "comment_id": 79584239, "body": "I believe <code>#define fancy_macro(a) printf(&quot;%s %s\\n&quot;, really_unparen a)</code> should suffice. (The <code>invoke</code> and <code>unparen</code> macros shouldn&#39;t be necessary)"}, {"owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "reply_to_user": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1505864732, "post_id": 46311121, "comment_id": 79584280, "body": "... huh. Then what did I have 20 minutes ago that <i>didn&#39;t</i> work?"}, {"owner": {"reputation": 1984, "user_id": 2132312, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/xv2d5.png?s=128&g=1", "display_name": "Matthew D. Scholefield", "link": "https://stackoverflow.com/users/2132312/matthew-d-scholefield"}, "edited": false, "score": 0, "creation_date": 1580268507, "post_id": 46311121, "comment_id": 106038330, "body": "Just something to note, this still doesn&#39;t conform to the C standard because of the use of a variadic macro."}], "tags": [], "owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "is_accepted": true, "score": 2, "last_activity_date": 1505864931, "last_edit_date": 1505864931, "creation_date": 1505863647, "answer_id": 46311121, "question_id": 46310987, "link": "https://stackoverflow.com/questions/46310987/c-how-to-shield-commas-in-macro-arguments/46311121#46311121", "title": "C: How to Shield Commas in Macro Arguments?", "body": "<p>Use parentheses to shield the comma, and then pass them through a special <code>unparen</code> macro, defined in the example below:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define really_unparen(...) __VA_ARGS__\n#define invoke(expr) expr\n#define unparen(args) invoke(really_unparen args)\n\n\n#define fancy_macro(a) printf(\"%s %s\\n\", unparen(a))\n\nint main()\n{\n    fancy_macro((\"Hello\", \"World\"));\n}\n</code></pre>\n\n<p>The trick here is that the <code>invoke</code> macro forces an extra expansion, allowing <code>really_unparen</code> to be called even though it's not followed by parentheses in the source.</p>\n\n<p>Edit: per comment below, this appears to not be necessary in this case. Though I'm sure I've hit a case where I needed it <em>sometime</em> ... and it doesn't hurt.</p>\n"}], "owner": {"reputation": 57, "user_id": 8628129, "user_type": "registered", "profile_image": "https://graph.facebook.com/1577817708927898/picture?type=large", "display_name": "Justin Olbrantz", "link": "https://stackoverflow.com/users/8628129/justin-olbrantz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1014, "favorite_count": 1, "accepted_answer_id": 46311121, "answer_count": 1, "score": 1, "last_activity_date": 1505864931, "creation_date": 1505862695, "question_id": 46310987, "link": "https://stackoverflow.com/questions/46310987/c-how-to-shield-commas-in-macro-arguments", "title": "C: How to Shield Commas in Macro Arguments?", "body": "<p>Is there a general method to shield comments in macro arguments in C? I know that parentheses can be used for this purpose, but that will not work in cases where added parentheses result in syntax errors in the macro output. I've heard that ({ }) works to shield commas in GCC, but I need this code to also work in VC++ (one of the recent versions which does conform to the C standard with regard to commas in macros). I also cannot use variadic macros in my case.</p>\n\n<p>The specific case I'm trying to do is this (lengthof is a macro defined elsewhere). I'm trying to write a single macro for the entire thing because this will be used many times, and having a multi-macro solution would add a large amount of additional testing code.</p>\n\n<pre><code>#define TEST_UNFUNC(func, res_type, res_set, op_type, op_set) \\\n{ \\\n    static const res_type res[] = res_set; \\\n    static const op_type op[] = op_set; \\\n    int i; \\\n    for (i = 0; i &lt; MIN(lengthof(res), lengthof(op)); i++) \\\n        assert(func(op[i]) == res[i]); \\\n}\n</code></pre>\n\n<p>If possible I would like a general answer and not merely a workaround specific to this particular macro.</p>\n"}, {"tags": ["c", "string"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1505861877, "post_id": 46310830, "comment_id": 79583571, "body": "<code>char *path = (char *) malloc(...)</code> You are leaking memory here. At least."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1505861887, "post_id": 46310830, "comment_id": 79583581, "body": "Speed has nothing to do with it. Code is sequential unless you are creating threads, and then speed would not be a problem if you synchronize correctly. Also, learn <code>snprintf()</code> instead of <code>strcat()</code> which is better in this case."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1505862084, "post_id": 46310830, "comment_id": 79583636, "body": "I would say your problem is undefined behavior due to mishandling a global variable. I often wonder why beginners use global variables when experts tend to avoid them, why to teach them then? Post <code>enq()</code>, I suspect you set <code>front-&gt;info</code> to <code>path</code> and then <code>free()</code> it, so you try to use a dangling pointer. Note that if you instead pass <code>path</code> as a parameter to <code>buildTree()</code> you would not have this problem."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 2, "creation_date": 1505862367, "post_id": 46310830, "comment_id": 79583709, "body": "<code>enq(path);</code> - anyone else curious what that does with that pointer, or is it just me. And just some advice: wedging recursion with global variables is nearly always a <i>bad</i> idea."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1505862679, "post_id": 46310830, "comment_id": 79583772, "body": "@WhozCraig There probably is another loop feeding pathames to this function. Possibly from a queue.."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1505865851, "post_id": 46310830, "comment_id": 79584534, "body": "@wildplasser  well, if OP has recursion AND global variables AND mulitple threads dequeueing, then I suspect there may be a little problem, yes;("}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1505912285, "post_id": 46310830, "comment_id": 79606106, "body": "You should post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}], "answers": [{"tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": false, "score": 2, "last_activity_date": 1505862683, "last_edit_date": 1505862683, "creation_date": 1505862375, "answer_id": 46310946, "question_id": 46310830, "link": "https://stackoverflow.com/questions/46310830/c-freeing-a-string-too-quickly-and-losing-value/46310946#46310946", "title": "C - Freeing a string too quickly and losing value?", "body": "<p>You should add comments to your code so that it is comprehensible. There is no way to tell what you are expecting <code>enq(path)</code> to do.</p>\n\n<p>When you pass information from one function to another, and the receiving function is going to put the information someplace to use it later, you have two choices. </p>\n\n<p>The receiving function can make a copy of the information for itself and manage the lifetime of that copy. In that case, the calling function can use a static buffer or free its copy when it's done calling the receiving function.</p>\n\n<p>Or the receiving function can take ownership of the information. In that case, the calling function must dynamically allocate the memory that will hold the information and it must not release it. It is the responsibility of the receiving function and its associated functions to free the memory when they're done with the information.</p>\n\n<p>If your <code>enq</code> function follows the \"take ownership\" pattern, then you are right to remove the call to <code>free</code> -- you shouldn't <code>free</code> a buffer that some other code has ownership of. (Though you should call <code>free</code> in the <code>else</code> path because there <code>enq</code> doesn't take ownership.) You should ensure that some other code somewhere does free that buffer at some later point where it's no longer needed.</p>\n"}], "owner": {"reputation": 1, "user_id": 8303464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75cb107deee48ecfe2001497b0cca25d?s=128&d=identicon&r=PG&f=1", "display_name": "Luke Noel", "link": "https://stackoverflow.com/users/8303464/luke-noel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1505863107, "creation_date": 1505861717, "last_edit_date": 1505863107, "question_id": 46310830, "link": "https://stackoverflow.com/questions/46310830/c-freeing-a-string-too-quickly-and-losing-value", "title": "C - Freeing a string too quickly and losing value?", "body": "<p>Working on a recursive file directory explorer. As of now the code all works, but I'm going for 0 memory leaks, and my <strong>path</strong> string is causing issues when I free() it. As of now, I have the free() commented out because it works this way. But if I uncomment the free() the program doesn't run properly because when it starts the recursion it doesn't have a <strong>path</strong> value anymore to use.</p>\n\n<p>Any help? Here is the code:</p>\n\n<pre><code>void buildTree() {\n    DIR *d;\n    struct dirent *dir;\n    d = opendir(front-&gt;info);\n    int root = 1;\n    if (d) {\n        while ((dir = readdir(d)) != NULL) {\n            char *path = (char *) malloc(2+strlen(front-&gt;info) + strlen(dir-&gt;d_name));\n            if (dir-&gt;d_type == DT_DIR) {\n                if (strcmp(dir-&gt;d_name, \".\") == 0 || strcmp(dir-&gt;d_name, \"..\") == 0)\n                    continue;   \n                strcpy(path, front-&gt;info);\n                strcat(path, \"/\");\n                strcat(path, dir-&gt;d_name);\n                printf(\"%d:%d:%s\\n\",level,root,path);\n                enq(path);\n            } else {\n                strcpy(path, front-&gt;info);\n                strcat(path, \"/\");\n                strcat(path, dir-&gt;d_name);\n                printf(\"%d:%d:%s\\n\",level,root,path);\n            }\n            root++;\n            //free(path);   \n        }\n        closedir(d);\n    }\n    level++;\n    deq();\n    if (front != NULL)\n        buildTree();\n}\n</code></pre>\n"}, {"tags": ["c", "windows", "portable-executable"], "comments": [{"owner": {"reputation": 623, "user_id": 4618553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64dbdd775be16db289526044e035ee18?s=128&d=identicon&r=PG&f=1", "display_name": "kirkpatt", "link": "https://stackoverflow.com/users/4618553/kirkpatt"}, "edited": false, "score": 0, "creation_date": 1505859754, "post_id": 46310443, "comment_id": 79582964, "body": "You may want to edit your question and add this function to it."}, {"owner": {"reputation": 11, "user_id": 8637079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/831d6aac2f46851c0705475d917dcbc3?s=128&d=identicon&r=PG&f=1", "display_name": "G63 AMG", "link": "https://stackoverflow.com/users/8637079/g63-amg"}, "reply_to_user": {"reputation": 623, "user_id": 4618553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64dbdd775be16db289526044e035ee18?s=128&d=identicon&r=PG&f=1", "display_name": "kirkpatt", "link": "https://stackoverflow.com/users/4618553/kirkpatt"}, "edited": false, "score": 0, "creation_date": 1505859919, "post_id": 46310443, "comment_id": 79583009, "body": "No reason to do that (my function has no value in the question, theres no issue (crash/bug)), I&#39;m just asking how can I find the typedef for any given PE on-the-fly. Manually and/or automatically."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 1, "creation_date": 1505860818, "post_id": 46310443, "comment_id": 79583273, "body": "WinMain is not executed as first. You have a lots of startup before that. \\"}, {"owner": {"reputation": 11, "user_id": 8637079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/831d6aac2f46851c0705475d917dcbc3?s=128&d=identicon&r=PG&f=1", "display_name": "G63 AMG", "link": "https://stackoverflow.com/users/8637079/g63-amg"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1505861157, "post_id": 46310443, "comment_id": 79583353, "body": "@PeterJ_01 Omg I know that dude, CRT and stuff (WinMainCRTStartup) and critical sections ... BUT THIS IS NOT WHAT IM ASKING!!!! Guys, please, I&#39;m just asking how to find out which datatypes a given entry point has and how can I find them out? Take a look at the <code>ADDITIONS</code> section and click the <code>here</code> href. You will see."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 1, "creation_date": 1505861774, "post_id": 46310443, "comment_id": 79583546, "body": "@G63 AMG you are rude dude."}, {"owner": {"reputation": 11, "user_id": 8637079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/831d6aac2f46851c0705475d917dcbc3?s=128&d=identicon&r=PG&f=1", "display_name": "G63 AMG", "link": "https://stackoverflow.com/users/8637079/g63-amg"}, "edited": false, "score": 0, "creation_date": 1505861884, "post_id": 46310443, "comment_id": 79583575, "body": "You are telling me things that I already know, why am I rude?"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1505862068, "post_id": 46310443, "comment_id": 79583631, "body": "it is not your entry point in your disassembly. You get to the exception handling init. But because you know everything and are rude - I will not give you more hints. Bye"}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1505866683, "post_id": 46310443, "comment_id": 79584737, "body": "The only information contained in the executable is the Win32 entry point.  Assuming the program uses a runtime, the application entry point could be anywhere; Windows neither knows nor cares.  You would have to reverse-engineer the runtime to figure this out, doing so automatically would be extremely difficult and far too broad for a Stack Overflow question.  But why do you want to find the application entry point in the first place?  You don&#39;t need it in order to run the executable."}, {"owner": {"reputation": 12601, "user_id": 514878, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2436423552aa319c4e960540ff091b0b?s=128&d=identicon&r=PG", "display_name": "FluffyKitten", "link": "https://stackoverflow.com/users/514878/fluffykitten"}, "edited": false, "score": 0, "creation_date": 1505867423, "post_id": 46310443, "comment_id": 79584896, "body": "Welcome to Stack Overflow. What have you already tried yourself to do this? Please review <a href=\"https://meta.stackoverflow.com/questions/261592/how-much-research-effort-is-expected-of-stack-overflow-users\">How much research effort is expected?</a>. Stack Overflow is not a coding service. You are expected to <b><i>research your issue and make a good attempt to write the code yourself</i></b> before posting. If you get stuck on something <i>specific</i>, come back and include a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> and a summary of what you tried, so we can help."}, {"owner": {"reputation": 11, "user_id": 8637079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/831d6aac2f46851c0705475d917dcbc3?s=128&d=identicon&r=PG&f=1", "display_name": "G63 AMG", "link": "https://stackoverflow.com/users/8637079/g63-amg"}, "reply_to_user": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1505879217, "post_id": 46310443, "comment_id": 79587602, "body": "@HarryJohnston Because I want to run it from memory"}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1505879959, "post_id": 46310443, "comment_id": 79587750, "body": "For that you only need the Win32 entry point, which always has the same signature.  Calling the Win32 entry point launches the runtime, which will in turn call the application entry point, e.g., WinMain.  Calling the application entry point directly wouldn&#39;t work anyway, because the runtime wouldn&#39;t be initialized."}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 1, "creation_date": 1505892987, "post_id": 46310443, "comment_id": 79593322, "body": "@RbMm, the entry point does get a pointer to the PEB, but that argument is typically ignored by Windows applications, which have no use for it."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 1, "creation_date": 1505893419, "post_id": 46310443, "comment_id": 79593597, "body": "@eryksun - yes, this is really true. and usually this is argument ignored. because it or not need for applications. or who use <i>PEB</i> get it by <code>RtlGetCurrentPeb()</code> or from <i>TEB</i>. so must be <code>void __stdcall ep (PEB* peb)</code>"}], "owner": {"reputation": 11, "user_id": 8637079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/831d6aac2f46851c0705475d917dcbc3?s=128&d=identicon&r=PG&f=1", "display_name": "G63 AMG", "link": "https://stackoverflow.com/users/8637079/g63-amg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 112, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1505865654, "creation_date": 1505858976, "last_edit_date": 1505865654, "question_id": 46310443, "link": "https://stackoverflow.com/questions/46310443/how-to-find-entry-point-typedef-for-a-given-pe", "title": "How to find entry-point typedef for a given PE?", "body": "<p>I wrote a simple function which will execute a given executable from memory. My question is, after I have resolved the import table, rebased the image, and parsed the PE sections. I am unable to execute <code>any given</code> executable.</p>\n\n<p>By <code>any given</code> I mean, I want to figure out how to know the entry-point type definition on-the-fly. Lets say my test executables entry-point has the following type</p>\n\n<pre><code>INT WINAPI WinMain(HMODULE base, HMODULE prev, LPSTR cmd, INT windowstatus);\n</code></pre>\n\n<p>so the <code>typedef</code> would be accordingly</p>\n\n<pre><code>typedef INT (WINAPI *WinMain)(HMODULE, HMODULE, LPSTR, INT);\n</code></pre>\n\n<p>But what if the entry-point of the executable isn't defined like that;</p>\n\n<ol>\n<li><p>How can I know which parameters it takes and pass them accordingly on the fly, and execute the image?</p></li>\n<li><p>Also, how can I find out how a given executables entry-point typedef would look like (manually)? </p></li>\n</ol>\n\n<p>Currently I have the above <code>typedef</code> but the executable I want to execute crashes after calling the entry-point, hence it's obviously not defined like that.</p>\n\n<p><strong>ADDITIONS</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/eyxJA.png\" rel=\"nofollow noreferrer\">Here</a> I have the entry-point for a given executable in IDA-PRO with softICE</p>\n\n<p>I'm assuming the <code>mov</code> instructions refer to the arguments passed to the entry function. But how can I know in which order they come and what data-type is assigned to each so I can typedef it?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 6, "creation_date": 1505857830, "post_id": 46310249, "comment_id": 79582397, "body": "You know, each standard (and not that standard too) function has a comprehensive documentation readily available. Try <a href=\"https://linux.die.net/man/3/isdigit\" rel=\"nofollow noreferrer\"><code>man isdigit</code></a>"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1505857985, "post_id": 46310249, "comment_id": 79582458, "body": "What makes you think that the return value of <code>scanf</code> will ever be equal to <code>\\0</code>? Did you try reading <b>any</b> documentation at all when you ran into the error?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 2, "creation_date": 1505858124, "post_id": 46310249, "comment_id": 79582500, "body": "@KenWhite Input like &quot;++&quot; will cause <code>scanf(&quot;%d:%d&quot;,&amp;hour, &amp;minute)</code> to return 0."}, {"owner": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "edited": false, "score": 3, "creation_date": 1505858397, "post_id": 46310249, "comment_id": 79582591, "body": "An <code>int</code> is an <code>int</code>. Calling <code>isdigit()</code> with an argument of type <code>int</code> does not do what you want. <code>isdigit()</code> takes a <i>character</i> as an argument and it will tell you if it is a numeric character, you know, <code>&#39;0&#39;</code> ... <code>&#39;9&#39;</code>. The fact that <code>isdigit()</code> is documented as taking an argument of type <code>int</code> instead of <code>char</code> is a historical accident."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1505859068, "post_id": 46310249, "comment_id": 79582765, "body": "@chux: And the proper way to write that comparison would be <code>!= 0</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1505859707, "post_id": 46310249, "comment_id": 79582947, "body": "@KenWhite <code>0</code> vs <code>&#39;\\0&#39;</code> is a style issue - both are <code>int</code> with a value of 0.  Certainly <code>scanf(&quot;%d:%d&quot;,&amp;hour, &amp;minute) == 2</code> is preferable."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "edited": false, "score": 4, "creation_date": 1505860000, "post_id": 46310249, "comment_id": 79583041, "body": "@rodrigo a C standard function taking <code>int</code> instead of <code>char</code> in not accidental.  None of those functions take a <code>char</code>.  <code>int</code> is used for performance and simplification.  <code>isdigt(int)</code> is defined for <code>unsigned char</code> values and <code>EOF</code>, too many for a <code>char</code>.  Works well with the return values from <code>fgetc()</code>."}, {"owner": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1505860293, "post_id": 46310249, "comment_id": 79583118, "body": "@chux: Yeah, and that&#39;s why doing <code>isdigit(&#39;&#233;&#39;)</code>, for example, is undefined, but <code>isdigit(-1)</code> is fine, which I wouldn&#39;t call it sensible design... The <code>EOF</code> might be useful as a sentinel return value (for <code>getc()</code> for example) but as input argument is rather useless."}, {"owner": {"reputation": 45, "user_id": 4230968, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh5.googleusercontent.com/-GwKGwAjadCc/AAAAAAAAAAI/AAAAAAAAAA4/cMg8j4ZLe_Q/photo.jpg?sz=128", "display_name": "Eddy Y", "link": "https://stackoverflow.com/users/4230968/eddy-y"}, "edited": false, "score": 0, "creation_date": 1505862275, "post_id": 46310249, "comment_id": 79583680, "body": "the \\0 is just used for when they want to stop inputting dive times, the program is just to input dive times and calculate the average, max dive time , and total dive time, but I need to make sure the input is in the format h:m (hour:minutes), is there a better way to check for non numeric chars?"}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1505860255, "post_id": 46310373, "comment_id": 79583108, "body": "Nice answer although it loses OP&#39;s apparent goal of detecting  &quot;invalid input&quot;."}, {"owner": {"reputation": 45, "user_id": 4230968, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh5.googleusercontent.com/-GwKGwAjadCc/AAAAAAAAAAI/AAAAAAAAAA4/cMg8j4ZLe_Q/photo.jpg?sz=128", "display_name": "Eddy Y", "link": "https://stackoverflow.com/users/4230968/eddy-y"}, "edited": false, "score": 0, "creation_date": 1505862435, "post_id": 46310373, "comment_id": 79583722, "body": "so i guess what i can do is typecast hour and minute to be chars?"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 45, "user_id": 4230968, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh5.googleusercontent.com/-GwKGwAjadCc/AAAAAAAAAAI/AAAAAAAAAA4/cMg8j4ZLe_Q/photo.jpg?sz=128", "display_name": "Eddy Y", "link": "https://stackoverflow.com/users/4230968/eddy-y"}, "edited": false, "score": 0, "creation_date": 1505863423, "post_id": 46310373, "comment_id": 79583958, "body": "@EddyY No!  Since you read the input using <code>%d</code>, it&#39;s already guaranteed to be numeric.  <code>%d</code> parses valid input, or nothing.  It&#39;s not possible for an <code>int</code> variable to contain something other than a number.  As someone already explained, calling <code>isdigit()</code> on these numbers does not do what you thought, and casting them to <code>char</code> wouldn&#39;t do that, either.  Suppose you read in the time 38:59.  If you cast the integer 38 to <code>char</code>, you&#39;ll get <code>&amp;</code> (which is not a digit).  If you cast the integer 49 to <code>char</code>, you&#39;ll get <code>;</code> (which is not a digit, either)."}, {"owner": {"reputation": 45, "user_id": 4230968, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh5.googleusercontent.com/-GwKGwAjadCc/AAAAAAAAAAI/AAAAAAAAAA4/cMg8j4ZLe_Q/photo.jpg?sz=128", "display_name": "Eddy Y", "link": "https://stackoverflow.com/users/4230968/eddy-y"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1505926790, "post_id": 46310373, "comment_id": 79616543, "body": "@SteveSummit a good alternative to checking for invalid inputs"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 45, "user_id": 4230968, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh5.googleusercontent.com/-GwKGwAjadCc/AAAAAAAAAAI/AAAAAAAAAA4/cMg8j4ZLe_Q/photo.jpg?sz=128", "display_name": "Eddy Y", "link": "https://stackoverflow.com/users/4230968/eddy-y"}, "edited": false, "score": 0, "creation_date": 1505944162, "post_id": 46310373, "comment_id": 79625279, "body": "@EddyY Sorry, I still don&#39;t understand what you&#39;re asking, but whatever it is, this comment thread probably isn&#39;t the best place for it; you should probably post a brand-new question.  In this question you were asking why <code>isdigit</code> didn&#39;t work, but it turned out that -- in this case -- you don&#39;t have to check for digits, because scanf <code>%d</code> is basically already doing that for you."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 45, "user_id": 4230968, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh5.googleusercontent.com/-GwKGwAjadCc/AAAAAAAAAAI/AAAAAAAAAA4/cMg8j4ZLe_Q/photo.jpg?sz=128", "display_name": "Eddy Y", "link": "https://stackoverflow.com/users/4230968/eddy-y"}, "edited": false, "score": 0, "creation_date": 1505945250, "post_id": 46310373, "comment_id": 79625696, "body": "@EddyY If you post another question, you should be clear what you want to do: (1) keep calling scanf, but do some different validation (other than checking for digits, which scanf is already doing) or some better handling of scanf&#39;s failure if the input does not contain digits, or (2) do your input and your validation using some technique(s) not involving scanf. (For question (2), my answer would involve: (a) <code>fgets</code>; (b) a way to break strings up based on whitespace or delimiters, perhaps based on <code>strtok</code> or the like; and finally, (c) functions like <code>atoi</code> and <code>strtol</code>.)"}], "tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": true, "score": 1, "last_activity_date": 1505858621, "creation_date": 1505858621, "answer_id": 46310373, "question_id": 46310249, "link": "https://stackoverflow.com/questions/46310249/how-to-use-isdigit-in-c/46310373#46310373", "title": "how to use isdigit() in C", "body": "<p>First, the reason for the floating exception is that <code>count</code> in expression <code>total/count</code> is zero when you break when entering the loop the first time or when you do not enter the loop at all. So check <code>count</code> before calculating something. Second, <code>scanf</code> returns the number of values successfully read in, which should be <code>2</code> in your case. Third, <code>isdigit</code> expects a character, i.e. something like <code>'0'</code>, not an integer ranging from <code>0</code> to something. When <code>scanf</code> with <code>%d</code> succeeds, you have already successfully read in a number (and nothing else).</p>\n\n<pre><code>int main()\n{\n  int hour=0, minute=0, total=0, maxDiveTime=0, counter=0, average=0;\n  printf (\"Enter dive times in the format of HH:MM (hours:minutes), Enter \\\\0 to stop\\n\");\n  while (scanf(\"%d:%d\",&amp;hour, &amp;minute) == 2)\n  {\n      if (((hour*60)+minute) &gt; (maxDiveTime))\n      {\n        maxDiveTime = ((hour*60)+minute);\n      }\n      total = total + (hour*60) + minute;\n      counter ++;\n  }\n\n  if (count &gt; 0) {\n    average = total/counter;\n    printf(\"The total divetime is %d:%d\\n\", total/60, total%60);\n    printf(\"The average divetime is %d:%d\\n\", average/60, average%60);\n    printf(\"The max divetime is %d\\n\", maxDiveTime );\n  }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 4230968, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh5.googleusercontent.com/-GwKGwAjadCc/AAAAAAAAAAI/AAAAAAAAAA4/cMg8j4ZLe_Q/photo.jpg?sz=128", "display_name": "Eddy Y", "link": "https://stackoverflow.com/users/4230968/eddy-y"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 825, "favorite_count": 0, "accepted_answer_id": 46310373, "answer_count": 1, "score": -1, "last_activity_date": 1505858621, "creation_date": 1505857749, "question_id": 46310249, "link": "https://stackoverflow.com/questions/46310249/how-to-use-isdigit-in-c", "title": "how to use isdigit() in C", "body": "<p>So I'm trying to use a isdigit() to check for non numeric values and for some reason when I put in a integer i get a floating exception error and my generated printf statement \"invalid input\". I am quite confused on why when i enter a digit it goes into my if statement where it is only true if it is NOT an integer </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;ctype.h&gt;\n\nint main()\n{\n  int hour=0, minute=0, total=0, maxDiveTime=0, counter=0, average=0;\n  printf (\"Enter dive times in the format of HH:MM (hours:minutes), Enter \\\\0 to stop\\n\");\n  while (scanf(\"%d:%d\",&amp;hour, &amp;minute) != '\\0')\n  {\n    if ((!isdigit(hour)) || (!isdigit(minute)))\n    {\n      printf(\"Invalid Input\\n\");\n      break;\n    }\n    else\n    {\n      if (((hour*60)+minute) &gt; (maxDiveTime))\n      {\n        maxDiveTime = ((hour*60)+minute);\n      }\n      total = total + (hour*60) + minute;\n      counter ++;\n    }\n  }\n    average = total/counter;\n    printf(\"The total divetime is %d:%d\\n\", total/60, total%60);\n    printf(\"The average divetime is %d:%d\\n\", average/60, average%60);\n    printf(\"The max divetime is %d\\n\", maxDiveTime );\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "makefile"], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 8635406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82316c7d38be7357132e097690a87b59?s=128&d=identicon&r=PG&f=1", "display_name": "jb1681", "link": "https://stackoverflow.com/users/8635406/jb1681"}, "is_accepted": true, "score": 0, "last_activity_date": 1506378957, "creation_date": 1506378957, "answer_id": 46415185, "question_id": 46309993, "link": "https://stackoverflow.com/questions/46309993/no-implicit-rule-found-in-makefile/46415185#46415185", "title": "No implicit rule found in makefile", "body": "<p>I found the problem. Apparently, even GNUWin32 make uses Unix style filenames for the targets and dependencies but in order to use the mkdir command, you must use Windows style filenames. </p>\n\n<blockquote>\n  <p>test/windows/%.o: ../test/windows/%.c</p>\n  \n  <p>mkdir test\\windows\\make_this_dir\\</p>\n</blockquote>\n\n<p>I hope this helps anyone with a similar issue.</p>\n"}], "owner": {"reputation": 41, "user_id": 8635406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82316c7d38be7357132e097690a87b59?s=128&d=identicon&r=PG&f=1", "display_name": "jb1681", "link": "https://stackoverflow.com/users/8635406/jb1681"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1216, "favorite_count": 0, "accepted_answer_id": 46415185, "answer_count": 1, "score": 1, "last_activity_date": 1506378957, "creation_date": 1505856367, "last_edit_date": 1505864698, "question_id": 46309993, "link": "https://stackoverflow.com/questions/46309993/no-implicit-rule-found-in-makefile", "title": "No implicit rule found in makefile", "body": "<p>My makefile execution fails each time due to a dependency. I don't want to overshare so I will try to only share the necessary info. I am using GNUWin32 make so that my windows box can execute it (a constraint I have to deal with) and I am able to compile/make a decent number of files in the src\\\\Framework\\...\\\\%.o realm from ..\\\\src\\\\Framework\\...\\\\%.c.</p>\n\n<p>It seems that as long as it is at least 2 folders deep, the Makefile works. Ex: src\\\\test.o doesn't compile but src\\\\tester\\\\test.o will compile.</p>\n\n<p>My error is as follows:</p>\n\n<blockquote>\n  <p>make: *** No rule to make target 'src\\\\control.o', needed by 'proj.elf'.  Stop.</p>\n</blockquote>\n\n<p>but I also have the following rule which is executed from a dependency of target all:</p>\n\n<blockquote>\n  <p>src\\\\%.o: ..\\\\src\\\\%.c</p>\n</blockquote>\n\n<p>which should make src\\\\control.o as long as ..\\\\src\\\\%.c exists.</p>\n\n<hr>\n\n<p>When I use <code>make -d all</code> I notice that it ends with </p>\n\n<blockquote>\n  <p>No implicit rule found for 'src\\\\control.o'.</p>\n  \n  <p>Finished prerequisites of target file 'src\\\\control.o'.</p>\n  \n  <p>Must remake target 'src\\\\control.o'</p>\n</blockquote>\n\n<p>If anyone has a solution to make this work I would be glad to hear it!</p>\n"}, {"tags": ["debian", "makefile", "gcc", "c"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "icarus"}, "edited": false, "score": 2, "creation_date": 1505858937, "post_id": 46313143, "comment_id": 79587911, "body": "You are clearly missing the header file when you compile directly. The file Make.defines is setting up CFLAGS so it can find it. I am surprised by the <code>[BOOK]</code> characters, the square brackets are special to the shell. Try using underscore instead or removing them completely."}, {"owner": {"reputation": 127, "user_id": 8340857, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8c04cc726e9708c29920e8afb5548e9?s=128&d=identicon&r=PG&f=1", "display_name": "digitalXmage", "link": "https://stackoverflow.com/users/8340857/digitalxmage"}, "edited": false, "score": 0, "creation_date": 1505861260, "post_id": 46313143, "comment_id": 79587912, "body": "@icarus noted and corrected thanks, i didn&#39;t know this."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1591872158, "post_id": 46313143, "comment_id": 110222924, "body": "Read <a href=\"https://modernc.gforge.inria.fr/\" rel=\"nofollow noreferrer\"><i>Modern C</i></a> and the documentation of  <a href=\"http://gcc.gnu.org/\" rel=\"nofollow noreferrer\">GCC</a>, <a href=\"https://www.gnu.org/software/make/manual/html_node/index.html\" rel=\"nofollow noreferrer\">GNU make</a>, <a href=\"https://sourceware.org/gdb/current/onlinedocs/gdb/\" rel=\"nofollow noreferrer\">GDB</a> and <a href=\"http://starynkevitch.net/Basile/bismon-chariot-doc.pdf\" rel=\"nofollow noreferrer\">this draft report</a>"}], "answers": [{"comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 1, "creation_date": 1591872274, "post_id": 46313144, "comment_id": 110222996, "body": "The occurrences of <code>[BOOK]</code>  seems confusing and probably should be replaced by something else"}, {"owner": {"reputation": 4998, "user_id": 7233423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/810e59b837c9e8b352615784397db0ea?s=128&d=identicon&r=PG&f=1", "display_name": "xhienne", "link": "https://stackoverflow.com/users/7233423/xhienne"}, "reply_to_user": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1591972862, "post_id": 46313144, "comment_id": 110265588, "body": "@BasileStarynkevitch Yes, this is unusual, confusing and error prone (shell&#39;s filename expansion). This is why I have added a warning in my answer. But since &quot;[BOOK]&quot; is what is used in the original question, until it is changed I have to use the same names."}], "tags": [], "owner": {"reputation": 4998, "user_id": 7233423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/810e59b837c9e8b352615784397db0ea?s=128&d=identicon&r=PG&f=1", "display_name": "xhienne", "link": "https://stackoverflow.com/users/7233423/xhienne"}, "is_accepted": true, "score": 3, "last_activity_date": 1505859421, "creation_date": 1505859421, "answer_id": 46313144, "question_id": 46313143, "link": "https://stackoverflow.com/questions/46313143/how-to-compile-c-code-with-the-unix-networking-programming-book-library/46313144#46313144", "title": "How to compile C code with the &quot;Unix networking programming book&quot; library?", "body": "<p>First your mistake in the Makefile:</p>\n\n<blockquote>\n  <p>make: Nothing to be done for 'all'.</p>\n</blockquote>\n\n<p>This means that all make targets (the content of the <code>PROGS</code> variable) exist and are more recent than their dependencies (i.e. what must be used to build them, IOW the source).</p>\n\n<p>It is unexpected for you because you didn't add the resulting binary to the <code>PROGS</code> variable, but the source file. Since it exists, Make considers it has nothing more to do. To correct this, change:</p>\n\n<pre><code>PROGS = [BOOK]daytimetcpcli.c ...\n</code></pre>\n\n<p>to</p>\n\n<pre><code>PROGS = [BOOK]daytimetcpcli ...\n</code></pre>\n\n<p>BTW, it's not a great idea to use special shell characters like <code>[</code> and <code>]</code> in your file name, don't forget to escape or quote them when using the file in shell commands.</p>\n\n<hr>\n\n<p>Now your mistake in the compilation command:</p>\n\n<blockquote>\n  <p>fatal error: unp.h: No such file or directory</p>\n</blockquote>\n\n<p>It means that you have not told <code>gcc</code> where to find the header files. Why would it work with <code>make</code>? Because the command in the Makefile includes additional options: <code>${CFLAGS}</code> and <code>${LIBS}</code>, two variables that are defined in <code>Make.defines</code> (see the <code>include</code> line).</p>\n\n<p>You correct compilation command should be:</p>\n\n<pre><code>gcc -o \"[BOOK]daytimetcpcli\" -I../lib -g -O2 -D_REENTRANT -Wall ../libunp.a -lpthread \"[BOOK]daytimetcpcli.c\"\n</code></pre>\n\n<p>(actually, the lines in the Makefile above only call the linker and CFLAGS is not necessary there; it is only used when creating the <code>.o</code> files whose compilation is implicit)</p>\n"}], "migrated_from": {"other_site": {"aliases": ["http://linux.stackexchange.com"], "markdown_extensions": ["Prettify"], "launch_date": 1294871917, "open_beta_date": 1282071600, "closed_beta_date": 1281466800, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/unix/Img/apple-touch-icon@2.png", "favicon_url": "https://cdn.sstatic.net/Sites/unix/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/unix/Img/apple-touch-icon.png", "audience": "users of Linux, FreeBSD and other Un*x-like operating systems", "site_url": "https://unix.stackexchange.com", "api_site_parameter": "unix", "logo_url": "https://cdn.sstatic.net/Sites/unix/Img/logo.png", "name": "Unix &amp; Linux", "site_type": "main_site"}, "on_date": 1505880566, "question_id": 393275}, "owner": {"reputation": 127, "user_id": 8340857, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8c04cc726e9708c29920e8afb5548e9?s=128&d=identicon&r=PG&f=1", "display_name": "digitalXmage", "link": "https://stackoverflow.com/users/8340857/digitalxmage"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1086, "favorite_count": 0, "accepted_answer_id": 46313144, "answer_count": 1, "score": 5, "last_activity_date": 1591871828, "creation_date": 1505855968, "question_id": 46313143, "link": "https://stackoverflow.com/questions/46313143/how-to-compile-c-code-with-the-unix-networking-programming-book-library", "title": "How to compile C code with the &quot;Unix networking programming book&quot; library?", "body": "<p><strong>Introduction</strong></p>\n\n<p>I've started following the book <em>Unix Network programming 2003</em>. I've downloaded the source code from the official website here: <a href=\"http://www.unpbook.com/src.html\" rel=\"noreferrer\">source code</a>. This includes a README file, which tells you how to build/compile all the files included for the book. </p>\n\n<p>I followed these instructions on this GitHub page (which also has the source code) <a href=\"https://github.com/ryuever/unix-network-programming-v3\" rel=\"noreferrer\">github</a> And managed to use the make files and configure the source successfully from what it seems.</p>\n\n<p><strong>Makefile to compile the examples provided</strong></p>\n\n<p>The first chapter of the program examples are in directory highlighted below.\nMy program is '<em>[BOOK]daytimetcpcli.c</em>' and placed it inside the Makefile provided. Makefile Inside the target directory:</p>\n\n<blockquote>\n  <p>unpv13e/intro$</p>\n</blockquote>\n\n<p>(includes all the other book example programs)</p>\n\n<pre><code>include ../Make.defines\n\nPROGS = [BOOK]daytimetcpcli.c daytimetcpcli1 daytimetcpcli2 daytimetcpcli3 \\\n    daytimetcpsrv daytimetcpsrv1 daytimetcpsrv2 daytimetcpsrv3 \\\n    daytimetcpcliv6 daytimetcpsrvv6 \\\n    byteorder\n\nall:    ${PROGS}\n\n\n\n\n[BOOK]daytimetcpcli:    [BOOK]daytimetcpcli.o\n    ${CC} ${CFLAGS} -o $@ [BOOK]daytimetcpcli.o ${LIBS}\n\ndaytimetcpcli1: daytimetcpcli1.o\n    ${CC} ${CFLAGS} -o $@ daytimetcpcli1.o ${LIBS}\n\ndaytimetcpcli2: daytimetcpcli2.o\n    ${CC} ${CFLAGS} -o $@ daytimetcpcli2.o ${LIBS}\n\ndaytimetcpcli3: daytimetcpcli3.o\n    ${CC} ${CFLAGS} -o $@ daytimetcpcli3.o ${LIBS}\n\ndaytimetcpsrv:  daytimetcpsrv.o\n    ${CC} ${CFLAGS} -o $@ daytimetcpsrv.o ${LIBS}\n\ndaytimetcpsrv1: daytimetcpsrv1.o\n    ${CC} ${CFLAGS} -o $@ daytimetcpsrv1.o ${LIBS}\n\ndaytimetcpsrv2: daytimetcpsrv2.o\n    ${CC} ${CFLAGS} -o $@ daytimetcpsrv2.o ${LIBS}\n\ndaytimetcpsrv3: daytimetcpsrv3.o\n    ${CC} ${CFLAGS} -o $@ daytimetcpsrv3.o ${LIBS}\n\ndaytimetcpcliv6:    daytimetcpcliv6.o\n    ${CC} ${CFLAGS} -o $@ daytimetcpcliv6.o ${LIBS}\n\ndaytimetcpsrvv6:    daytimetcpsrvv6.o\n    ${CC} ${CFLAGS} -o $@ daytimetcpsrvv6.o ${LIBS}\n\nbyteorder:  byteorder.o\n    ${CC} ${CFLAGS} -o $@ byteorder.o ${LIBS}\n\nclean:\n    rm -f ${PROGS} ${CLEANFILES}\n</code></pre>\n\n<p><strong>The Problem</strong></p>\n\n<p>I placed my file inside the Makefile. However when i run 'make' again. This occurs:</p>\n\n<blockquote>\n  <p>make: Nothing to be done for 'all'.</p>\n</blockquote>\n\n<p>I also tried just normal compiling with GCC:</p>\n\n<blockquote>\n  <p>gcc [BOOK]daytimetcpcli.c</p>\n  \n  <p>fatal error: unp.h: No such file or directory</p>\n</blockquote>\n\n<p>So my question is how do I compile my program with the Makefile provided? is what I've done correct? And I know I can compile with GCC, however I do not know the syntax to include the header files needed with GCC. Which is why I've attempted to do it with the Makefile. </p>\n\n<p>Which follows into my second question, how do I compile without the makefile? (using gcc with the correct -I <em>headers</em>)? gcc program.c -I unp.h ?</p>\n\n<p>*Note '[BOOK]daytimetcpcli.c' = daytimetcpcli.c in the source code provided on official website, in the source.</p>\n"}, {"tags": ["c", "execv"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1505856328, "post_id": 46309758, "comment_id": 79581866, "body": "Did you try it?"}], "answers": [{"comments": [{"owner": {"reputation": 2232, "user_id": 518879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0b5c3658ab0cf0f42e6eea42e80e1e7?s=128&d=identicon&r=PG", "display_name": "danger89", "link": "https://stackoverflow.com/users/518879/danger89"}, "edited": false, "score": 0, "creation_date": 1607298282, "post_id": 46310181, "comment_id": 115221381, "body": "I think <code>0</code> instead of <code>NULL</code> would be better."}], "tags": [], "owner": {"reputation": 353, "user_id": 1335475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77ef4c4df7698aec60571fd46af35cc0?s=128&d=identicon&r=PG", "display_name": "Blunt Jackson", "link": "https://stackoverflow.com/users/1335475/blunt-jackson"}, "is_accepted": true, "score": 0, "last_activity_date": 1505857422, "creation_date": 1505857422, "answer_id": 46310181, "question_id": 46309758, "link": "https://stackoverflow.com/questions/46309758/arguments-being-passed-into-execv-in-c/46310181#46310181", "title": "Arguments being passed into execv in C", "body": "<p>The FIRST parameter to execv is the application to exec. \"/bin/echo\" -- you might not want to rely on the availability of environment variables to find your application, so full path is preferred.</p>\n\n<p>The SECOND parameter to execv is a NULL terminated array of const strings that <em>repeat</em> the \"/bin/echo\" of the first parameter, so:</p>\n\n<pre><code>char *const params = { \"/bin/echo\", \"hello\", NULL };\n\nexecv(\"/bin/echo\", params);\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 5647448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92ba18382cc49a0d1d65584a22f65eb4?s=128&d=identicon&r=PG&f=1", "display_name": "zdale", "link": "https://stackoverflow.com/users/5647448/zdale"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1970, "favorite_count": 1, "accepted_answer_id": 46310181, "answer_count": 1, "score": -1, "last_activity_date": 1505866072, "creation_date": 1505855215, "last_edit_date": 1505866072, "question_id": 46309758, "link": "https://stackoverflow.com/questions/46309758/arguments-being-passed-into-execv-in-c", "title": "Arguments being passed into execv in C", "body": "<p>I am writing a program in C that forks and uses execv to call a command that is passed in to the original function.  </p>\n\n<p>So I would type in something like \"./program echo \"hello\"\" and the child of the fork in my program would use the bash command \"echo hello\".</p>\n\n<p>The execv man page is pretty vague, it says \"The first argument, by convention, should point to the filename associated with the file being executed.\"  I am trying to figure out if I'm understanding this right.</p>\n\n<p>From examples I've seen, this is how execv should be called:</p>\n\n<pre><code>execv(argv[0], argv);\n</code></pre>\n\n<p>But I know that argv[0] would just contain \"./program\".  So I am thinking this just exec's to the same function its inside of, but it is not what I've seen in examples. </p>\n\n<p>From what I know it should be this:</p>\n\n<pre><code>execv(argv[1],argv+1);\n</code></pre>\n\n<p>or </p>\n\n<pre><code>execv(argv[1],argv+2);\n</code></pre>\n\n<p>Can anyone help me understand this? Thanks.</p>\n"}, {"tags": ["c", "while-loop"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1505853607, "post_id": 46309386, "comment_id": 79580697, "body": "Your formula implementation is just wrong. You are just recalculating something you call <code>pi</code> each iteration, forgetting the previous values."}, {"owner": {"reputation": 551, "user_id": 4571206, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/yJHES.jpg?s=128&g=1", "display_name": "Abr001am", "link": "https://stackoverflow.com/users/4571206/abr001am"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1505853713, "post_id": 46309386, "comment_id": 79580753, "body": "@EugeneSh is right maybe you intended to write <code>pi+=</code>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 551, "user_id": 4571206, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/yJHES.jpg?s=128&g=1", "display_name": "Abr001am", "link": "https://stackoverflow.com/users/4571206/abr001am"}, "edited": false, "score": 0, "creation_date": 1505853733, "post_id": 46309386, "comment_id": 79580762, "body": "@Idle001 Not only that..."}], "answers": [{"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 0, "last_activity_date": 1505854650, "last_edit_date": 1505854650, "creation_date": 1505854154, "answer_id": 46309548, "question_id": 46309386, "link": "https://stackoverflow.com/questions/46309386/formula-nested-in-loop-wont-execute-properly/46309548#46309548", "title": "Formula nested in loop won&#39;t execute properly", "body": "<p>I would scale it as well for those calculations</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define Niterations 1000\n#define SCALE 1000\n\nint main(void) {\n\n    double pi = 4.0 * SCALE;\n    for(unsigned i = 0; i &lt; Niterations; i ++)\n    {\n        double f = 4.0 * SCALE / (3 + i * 2);\n        pi += (i &amp; 1) ? f : -f;\n    }\n\n    printf(\"N iterations = %u, pi = %lf\", Niterations, pi / SCALE);\n    // your code goes here\n    return 0;\n}\n</code></pre>\n\n<p>Test it <a href=\"https://ideone.com/mSZNyg\" rel=\"nofollow noreferrer\">https://ideone.com/mSZNyg</a></p>\n\n<p>Result: <code>N iterations = 10000, pi = 3.141692643590519029572760700830258429050445556640625000000000 ...</code></p>\n"}, {"comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1505854495, "post_id": 46309587, "comment_id": 79581128, "body": "withous scaling those calculations will be very imprecise."}], "tags": [], "owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "is_accepted": true, "score": 0, "last_activity_date": 1505854366, "creation_date": 1505854366, "answer_id": 46309587, "question_id": 46309386, "link": "https://stackoverflow.com/questions/46309386/formula-nested-in-loop-wont-execute-properly/46309587#46309587", "title": "Formula nested in loop won&#39;t execute properly", "body": "<p>First of all, make n and p integers.  </p>\n\n<p>Secondly n starts at 3 doesn't it?</p>\n\n<p>Third the Pi series is 4.0 (- fraction + fraction)...</p>\n\n<p>Finally you can printf using %.*lf to increase/limit the precision of the output.</p>\n\n<pre><code> if ( 2 == route )\n {\n    printf(\"piseries calculator\\n\");\n\n    double pi=4.0;\n    int n,p;\n\n    printf(\"define precision\");\n    scanf(\"%d\",&amp;p);\n\n    for(n=3;n&lt;p;n+=2)\n    {\n        pi -= 4.0/n;\n        n+=2;\n        pi += 4.0/n;\n    }\n    printf(\"%.*lf\",p,pi);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 8616207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6619bbd7fb4b7580c71da0e4c872f21?s=128&d=identicon&r=PG&f=1", "display_name": "Matthias NKR", "link": "https://stackoverflow.com/users/8616207/matthias-nkr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 46309587, "answer_count": 2, "score": -4, "last_activity_date": 1505863063, "creation_date": 1505853439, "last_edit_date": 1505863063, "question_id": 46309386, "link": "https://stackoverflow.com/questions/46309386/formula-nested-in-loop-wont-execute-properly", "title": "Formula nested in loop won&#39;t execute properly", "body": "<p>I'm trying to solve a code to run this series pi = 4 - 4/3 + 4/5 - 4/7 + 4/9 ... and so on. The thing is, as i run with higher values, the function tends to 4, not 3,1415.... The program seem to be running only the greatest value that n assumes. Also i cant make %%.lflf work to set decimals according to a variable, (p). The algorithm seems correct but after days i'm desperate for any help, greatly appreciated.</p>\n\n<pre><code>if ( 2 == route ) {\n    printf(\"piseries calculator\\n\");\n\n    double pi,n,p;\n\n    printf(\"define precision\");\n    scanf(\"%lf\",&amp;p);\n\n    n=0;\n\n    while (n++ &lt;= p ) {\n        pi = (4) - (n * ( 4 / ( 1 + 2 *(n)))) +( n * ( 4 / ( 3 + 2 * (n))));\n    }\n    printf(\"%%.lflf\",p,pi);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1505851910, "post_id": 46308934, "comment_id": 79579944, "body": "Those dimensions look especially messed up. That shouldn&#39;t be an array of array of pointer to char. If anything it should be a VLA of pointer to char. I.e., I&#39;d start by changing <code>char *arr[512][lineCount];</code> to <code>char *arr[lineCount];</code>. I&#39;d also have an ascending counter, starting at zero to index <code>arr</code> while building your list. Finally, <a href=\"http://en.cppreference.com/w/c/io/fgets\" rel=\"nofollow noreferrer\">fgets</a> is probably more appropriate for per-line work."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1505852299, "post_id": 46308934, "comment_id": 79580113, "body": "Enable compiler warnings.<code>savedLine != &#39;\\n&#39;</code> should warn as well as others:  Comparing a pointer to a character constant."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1505852896, "post_id": 46309162, "comment_id": 79580395, "body": "The amount used of each <code>arr[]</code> is not recorded.  Maybe a <code>&#39;\\0&#39;</code> on end-if-line, EOF?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1505853007, "post_id": 46309162, "comment_id": 79580442, "body": "@chux Thanks, fixed that."}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 1, "last_activity_date": 1505853173, "last_edit_date": 1505853173, "creation_date": 1505852479, "answer_id": 46309162, "question_id": 46308934, "link": "https://stackoverflow.com/questions/46308934/how-do-i-save-char-to-my-2d-array-using-fread/46309162#46309162", "title": "How do I save char to my 2d array using fread?", "body": "<p>You don't have a 2D array of characters, you have a 2D array of pointers, and you never assign anything to those pointers. But you don't need pointers at all. Just declare a <code>char</code> variable and read into its address, then copy it into the array.</p>\n\n<pre><code>char arr[lineCount][512];\nint pos = 0;\nwhile (lineCount &gt; 0) {\n    char tempChar;\n    size_t n = fread(&amp;tempChar, 1, 1, fd);\n    if (n == 0) { // EOF or error\n        break;\n    }\n    if (tempChar == '\\n') {\n        arr[lineCount-1][pos] = '\\0'; // Add trailing null to current line\n        lineCount--; // Start new line\n        pos = 0;\n    } else {\n        arr[lineCount-1][pos] = tempChar;\n        pos++;\n        if (pos == 511) { // Filled up current line, start new line\n            arr[lineCount-1][pos] = '\\0';\n            lineCount--;\n            pos = 0;\n        }\n    }\n}\n</code></pre>\n\n<p>Notice that you need to subtract 1 from <code>lineCount</code> when assigning to the array, because arrays are indexed from 0 to <code>size-1</code>. Also notice that you had the declaration of the array backwards.</p>\n"}], "owner": {"reputation": 3, "user_id": 8636603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ecf4e9feb2f3b183d8ab3c986ed303f?s=128&d=identicon&r=PG&f=1", "display_name": "geronimo", "link": "https://stackoverflow.com/users/8636603/geronimo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 46309162, "answer_count": 1, "score": -1, "last_activity_date": 1505853173, "creation_date": 1505851573, "last_edit_date": 1505851815, "question_id": 46308934, "link": "https://stackoverflow.com/questions/46308934/how-do-i-save-char-to-my-2d-array-using-fread", "title": "How do I save char to my 2d array using fread?", "body": "<pre><code>char *arr[512][lineCount];\nwhile(lineCount &gt; 0){       \n    char *savedLine = malloc(512);\n    while(1){\n    fread(savedLine, 1, 1,fd);\n    if(savedLine != '\\n'){\n        arr = savedLine;\n    }else{\n        break;\n    }\n    }lineCount --;\n}\n</code></pre>\n\n<p>So I'm trying to create a 2D char array that stores characters line by line.\nI am not allowed to use fgets so I used fread to store one char at a time until it reaches <code>'\\n'</code>. But it won't compile saying I can't compare pointer and integer (<code>savedLine != 'n'</code>) and array type is not assignable(<code>char *arr[512][lineCount]</code>). rest of the variables are declared in my code.</p>\n"}, {"tags": ["c", "char"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 2, "creation_date": 1505850340, "post_id": 46308626, "comment_id": 79579183, "body": "Undefined behavior for using the address of an object after the end of the object&#39;s lifetime."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1505850485, "post_id": 46308626, "comment_id": 79579255, "body": "Why the pointer-to-pointer? From everything I can see, you want single-indirection; not double."}, {"owner": {"reputation": 335, "user_id": 5327161, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh4.googleusercontent.com/-IxjuDTVEuws/AAAAAAAAAAI/AAAAAAAACeo/OtRCDRMxzEE/photo.jpg?sz=128", "display_name": "Vineet Patel", "link": "https://stackoverflow.com/users/5327161/vineet-patel"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1505850581, "post_id": 46308626, "comment_id": 79579304, "body": "@WhozCraig Because I have to dynamically change it&#39;s size, so I could create a temp array that&#39;s bigger than then set the pointer to that."}, {"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 1, "creation_date": 1505850749, "post_id": 46308626, "comment_id": 79579377, "body": "@VineetPatel you can do that with a <code>char*</code>"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1505850838, "post_id": 46308626, "comment_id": 79579432, "body": "<code>char *dyanmic;      dyanmic = malloc(2 * sizeof(char));      stack-&gt;dynamicArray = &amp;dyanmic; </code> saves a pointer to an object that no longer exists!"}, {"owner": {"reputation": 50669, "user_id": 1711796, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6pRI7.png?s=128&g=1", "display_name": "Bernhard Barker", "link": "https://stackoverflow.com/users/1711796/bernhard-barker"}, "edited": false, "score": 0, "creation_date": 1505850854, "post_id": 46308626, "comment_id": 79579441, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/2346806/what-is-a-segmentation-fault\">What is a segmentation fault?</a>"}, {"owner": {"reputation": 335, "user_id": 5327161, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh4.googleusercontent.com/-IxjuDTVEuws/AAAAAAAAAAI/AAAAAAAACeo/OtRCDRMxzEE/photo.jpg?sz=128", "display_name": "Vineet Patel", "link": "https://stackoverflow.com/users/5327161/vineet-patel"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1505850905, "post_id": 46308626, "comment_id": 79579467, "body": "@AjayBrahmakshatriya but I used malloc, shouldn&#39;t that memory still exist in the heap?"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1505851080, "post_id": 46308626, "comment_id": 79579566, "body": "@VineetPatel You used <code>malloc</code> for the value of <code>dynamic</code>, but that variable itself is in <code>auto</code> scope of the function. The pointer is the object that will die out after the function. The malloced memory will still remain. Why don&#39;t you make s<code>tack-&gt;dynamicArray</code> also <code>char*</code> and simply assign it?"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 2, "creation_date": 1505851130, "post_id": 46308626, "comment_id": 79579587, "body": "The memory of <i>what</i>? You&#39;re retaining the address of a local automatic variable that ceases to exist as soon as your function returns. There is a big difference between <code>&amp;dyanmic</code> and <code>dyanmic</code>. <a href=\"https://ideone.com/Ko1MSD\" rel=\"nofollow noreferrer\">See it live</a>."}, {"owner": {"reputation": 335, "user_id": 5327161, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh4.googleusercontent.com/-IxjuDTVEuws/AAAAAAAAAAI/AAAAAAAACeo/OtRCDRMxzEE/photo.jpg?sz=128", "display_name": "Vineet Patel", "link": "https://stackoverflow.com/users/5327161/vineet-patel"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1505851533, "post_id": 46308626, "comment_id": 79579786, "body": "@WhozCraig You&#39;re right, my bad."}, {"owner": {"reputation": 335, "user_id": 5327161, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh4.googleusercontent.com/-IxjuDTVEuws/AAAAAAAAAAI/AAAAAAAACeo/OtRCDRMxzEE/photo.jpg?sz=128", "display_name": "Vineet Patel", "link": "https://stackoverflow.com/users/5327161/vineet-patel"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1505852727, "post_id": 46308626, "comment_id": 79580323, "body": "@WhozCraig I ended up implemented your approach. Thank you!"}], "answers": [{"tags": [], "owner": {"reputation": 353, "user_id": 1335475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77ef4c4df7698aec60571fd46af35cc0?s=128&d=identicon&r=PG", "display_name": "Blunt Jackson", "link": "https://stackoverflow.com/users/1335475/blunt-jackson"}, "is_accepted": false, "score": 1, "last_activity_date": 1505851694, "creation_date": 1505851694, "answer_id": 46308962, "question_id": 46308626, "link": "https://stackoverflow.com/questions/46308626/pointer-to-pointer-to-char-in-struct-segmentation-fault/46308962#46308962", "title": "Pointer to pointer to char in struct, segmentation fault", "body": "<p>The following construct is confusing and ultimately incorrect:</p>\n\n<pre><code>for (i = 0; i &lt; stack.size; i++){\n      *(stack.dynamicArray)[i] = 'r'; \n      printf(\"%d value of the dynamic array: %c\\n\", i, *(stack.dynamicArray)[i]);\n}\n</code></pre>\n\n<p>You are actually referencing the FIRST level of ** by this construction. Try this instead:</p>\n\n<pre><code>for (i = 0; i &lt; stack.size; i++){\n    stack.dynamicArray[0][i] = 'r';\n    printf(\"%d value of the dynamic array: %c\\n\", i, stack.dynamicArray[0][i]);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 0, "last_activity_date": 1505853357, "creation_date": 1505853357, "answer_id": 46309372, "question_id": 46308626, "link": "https://stackoverflow.com/questions/46308626/pointer-to-pointer-to-char-in-struct-segmentation-fault/46309372#46309372", "title": "Pointer to pointer to char in struct, segmentation fault", "body": "<p>Abstracting ffrom the sense of this :)</p>\n\n<pre><code>char **dyanmic; \ndyanmic = malloc(sizeof(char *));\n*dyanmic = malloc(2 * sizeof(char)); \nstack-&gt;dynamicArray = dyanmic; \n</code></pre>\n"}], "owner": {"reputation": 335, "user_id": 5327161, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh4.googleusercontent.com/-IxjuDTVEuws/AAAAAAAAAAI/AAAAAAAACeo/OtRCDRMxzEE/photo.jpg?sz=128", "display_name": "Vineet Patel", "link": "https://stackoverflow.com/users/5327161/vineet-patel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1505854955, "creation_date": 1505850250, "last_edit_date": 1505854955, "question_id": 46308626, "link": "https://stackoverflow.com/questions/46308626/pointer-to-pointer-to-char-in-struct-segmentation-fault", "title": "Pointer to pointer to char in struct, segmentation fault", "body": "<p>So I have created a struct, in which one of the variable is a pointer to a dynamic array of chars. So I implemented it as a pointer to pointer. Then I used a separate function to initialize the struct: </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n//create a struct\ntypedef struct{\n    //use a double pointer\n    char **dynamicArray; \n    int size;\n    int topValue; \n}Stack; \n\n/*\n    Inintializes the stack\n    Dyanmic Array will have a size of 2\n*/\nvoid intializeStack(Stack *stack){\n    stack-&gt;size = 2; \n    stack-&gt;topValue = 0;\n\n    //create a dyanmic array of char and set the value in the struct to the address for the newly created array\n    char *dyanmic; \n    dyanmic = malloc(2 * sizeof(char)); \n    stack-&gt;dynamicArray = &amp;dyanmic; \n}\nint main(){\n\n    Stack stack; \n    intializeStack(&amp;stack);\n\n    printf(\"stack.size: %d\\n\", stack.size);\n    printf(\"stack.topValue: %d\\n\", stack.topValue); \n    int i; \n    for (i = 0; i &lt; stack.size; i++){\n        *(stack.dynamicArray)[i] = 'r'; \n        printf(\"%d value of the dynamic array: %c\\n\", i, *(stack.dynamicArray)[i]);\n    }\n\n    printf(\"Check if the stack is empty: %s\\n\",isEmpty(&amp;stack)?\"true\":\"false\");\n\n    return 0; \n}\n</code></pre>\n\n<p>The array is initially set to a size of 0. The problem is when I try to access the second element in the array, i get a segmentation fault error.</p>\n\n<pre><code>Segmentation fault (core dumped)\n</code></pre>\n\n<p>Am I doing something wrong in the implementation?</p>\n"}, {"tags": ["c", "while-loop"], "comments": [{"owner": {"reputation": 1297, "user_id": 5042431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VZqF.jpg?s=128&g=1", "display_name": "Charles", "link": "https://stackoverflow.com/users/5042431/charles"}, "edited": false, "score": 11, "creation_date": 1505847813, "post_id": 46308003, "comment_id": 79577859, "body": "<code>while (0 &lt; celsius &lt; 100)</code> this is not what you think it is. You mean <code>while(celsius &gt; 0 &amp;&amp; celsius &lt; 100)</code>"}, {"owner": {"reputation": 2153, "user_id": 3687725, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/1We1W.jpg?s=128&g=1", "display_name": "Preston Martin", "link": "https://stackoverflow.com/users/3687725/preston-martin"}, "edited": false, "score": 0, "creation_date": 1505847852, "post_id": 46308003, "comment_id": 79577883, "body": "What do you mean by work properly? It is outputting an error? Is it not outputting the correct results?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1505847909, "post_id": 46308003, "comment_id": 79577923, "body": "Turn on full warnings, you should see something like <code>comparison of constant 100 with boolean expression is always true</code>"}, {"owner": {"reputation": 6254, "user_id": 2261424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a0beda634f65f29aace865be9504e5e6?s=128&d=identicon&r=PG", "display_name": "AntonH", "link": "https://stackoverflow.com/users/2261424/antonh"}, "edited": false, "score": 0, "creation_date": 1505847939, "post_id": 46308003, "comment_id": 79577943, "body": "Also note: 1) that since you initialise your variable <code>Celsius</code> as 0, you won&#39;t even enter the loop anyway. 2) since you recalculate <code>celsius</code> each time, it may happen that you stop looping since you will lose precision and end up not rounding up, and will end up with an infinite loop."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1505847980, "post_id": 46308003, "comment_id": 79577959, "body": "Even if that was correct syntax, you&#39;d never get into the loop. You set <code>celsius</code> to <code>0</code>, so <code>0 &lt; celsius &lt; 100</code> will be false the first time."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1505848143, "post_id": 46308003, "comment_id": 79578054, "body": "What you want is: <code>for (int celsius = 0; celsius &lt; 100; ++celsius) {</code> instead of that really bizarre <code>while</code> loop with tons of internal modifications and re-assignments from &#176;F-&gt;&#176;C and &#176;C-&gt;&#176;F."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1505848154, "post_id": 46308003, "comment_id": 79578058, "body": "You also have a logic problem. You&#39;re incrementing <code>celsius</code>, but then immediately resetting it from <code>fahrenheit</code>."}, {"owner": {"reputation": 3212, "user_id": 2233706, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/224116af88436575b20ba30f2fd9d995?s=128&d=identicon&r=PG", "display_name": "user2233706", "link": "https://stackoverflow.com/users/2233706/user2233706"}, "edited": false, "score": 0, "creation_date": 1505848396, "post_id": 46308003, "comment_id": 79578187, "body": "If you do ``int celsius``` but use <code>%f</code> print modifier, you&#39;ll get weird results, so use <code>%i</code>."}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1505848071, "post_id": 46308029, "comment_id": 79578007, "body": "Not sure why <code>Celsius</code> is capitalized there."}, {"owner": {"reputation": 6254, "user_id": 2261424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a0beda634f65f29aace865be9504e5e6?s=128&d=identicon&r=PG", "display_name": "AntonH", "link": "https://stackoverflow.com/users/2261424/antonh"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1505848104, "post_id": 46308029, "comment_id": 79578032, "body": "@tadman I&#39;m guessing an autocorrect."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1505848158, "post_id": 46308029, "comment_id": 79578063, "body": "Fixed, so that&#39;s good."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 35, "user_id": 8616207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6619bbd7fb4b7580c71da0e4c872f21?s=128&d=identicon&r=PG&f=1", "display_name": "Matthias NKR", "link": "https://stackoverflow.com/users/8616207/matthias-nkr"}, "edited": false, "score": 0, "creation_date": 1505848978, "post_id": 46308029, "comment_id": 79578488, "body": "@MatthiasNKR No at all. You are welcome.:)"}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 0, "last_activity_date": 1505848107, "last_edit_date": 1505848107, "creation_date": 1505847862, "answer_id": 46308029, "question_id": 46308003, "link": "https://stackoverflow.com/questions/46308003/issues-on-creating-a-while-loop-in-c/46308029#46308029", "title": "Issues on creating a while loop in C", "body": "<p>Just write the condition like</p>\n\n<pre><code>while ( celsius++ &lt; 100)\n</code></pre>\n\n<p>and remove these statements from the loop</p>\n\n<pre><code>celsius = (5.0 / 9.0) * (fahrenheit-32);\n</code></pre>\n\n<p>and</p>\n\n<pre><code>celsius ++;\n</code></pre>\n\n<p>And after the loop it is enough to write</p>\n\n<pre><code>printf(\"Jobs done\");\n</code></pre>\n\n<p>without the if statement.</p>\n"}], "owner": {"reputation": 35, "user_id": 8616207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6619bbd7fb4b7580c71da0e4c872f21?s=128&d=identicon&r=PG&f=1", "display_name": "Matthias NKR", "link": "https://stackoverflow.com/users/8616207/matthias-nkr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "closed_date": 1505848024, "accepted_answer_id": 46308029, "answer_count": 1, "score": 0, "last_activity_date": 1505848193, "creation_date": 1505847747, "last_edit_date": 1505848193, "question_id": 46308003, "link": "https://stackoverflow.com/questions/46308003/issues-on-creating-a-while-loop-in-c", "closed_reason": "Duplicate", "title": "Issues on creating a while loop in C", "body": "<p>I need to run a while loop that prints every one of it's results, but can't get it to work properly. Here's what i have achieved:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n\nint main ()\n{\n    float fahrenheit;\n    int celsius;\n\n    printf(\"Table of calsius degrees in fahrenheit 1-100:\");\n    celsius=0;\n    fahrenheit=32;\n    while (0 &lt; celsius &lt; 100)\n    {\n        celsius = (5.0 / 9.0) * (fahrenheit-32);\n\n        fahrenheit = ((9.0 / 5.0) * celsius )+ 32;\n\n        printf (\"%f , %f\\n\", celsius,fahrenheit);\n        celsius ++;\n    }\n    if (celsius&gt;=101){\n        printf(\"Jobs done\");\n    }\n    return 0;\n\n}\n</code></pre>\n\n<p>Any help greatly appreciated. The goal was for it to print every value fahrenheit and celsius from 1 to 100.</p>\n"}, {"tags": ["c", "switch-statement"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 3, "creation_date": 1505847363, "post_id": 46307877, "comment_id": 79577608, "body": "Because C&#39;s <code>switch&#47;case</code> is not a <code>match</code>? You cannot use it like this, <code>case</code>s are simply integer constant expressions."}, {"owner": {"reputation": 6254, "user_id": 2261424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a0beda634f65f29aace865be9504e5e6?s=128&d=identicon&r=PG", "display_name": "AntonH", "link": "https://stackoverflow.com/users/2261424/antonh"}, "edited": false, "score": 2, "creation_date": 1505847371, "post_id": 46307877, "comment_id": 79577609, "body": "You can&#39;t put ranges in a <code>switch...case</code>, only individual values. You would have to chain <code>if...else if...else</code> statements."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1505847411, "post_id": 46307877, "comment_id": 79577643, "body": "Why do you trhink it is a <i>constant expression</i>?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1505847486, "post_id": 46307877, "comment_id": 79577681, "body": "Why would you use <code>case</code> where <code>if..else if..else</code> is the natural way to go?"}, {"owner": {"reputation": 2461, "user_id": 2405914, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/VoFWS.jpg?s=128&g=1", "display_name": "Leonardo Alves Machado", "link": "https://stackoverflow.com/users/2405914/leonardo-alves-machado"}, "edited": false, "score": 0, "creation_date": 1505847627, "post_id": 46307877, "comment_id": 79577749, "body": "You don&#39;t put a test under <code>case</code>. The <code>switch-case</code> statement is made for value select, not greater than, smaller than. Use <code>if-else</code> for that..."}, {"owner": {"reputation": 1451, "user_id": 7615877, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AbOhS.jpg?s=128&g=1", "display_name": "akshayk07", "link": "https://stackoverflow.com/users/7615877/akshayk07"}, "edited": false, "score": 0, "creation_date": 1505847705, "post_id": 46307877, "comment_id": 79577798, "body": "The value after case should be <code>int</code> or <code>char</code> strictly"}, {"owner": {"reputation": 6254, "user_id": 2261424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a0beda634f65f29aace865be9504e5e6?s=128&d=identicon&r=PG", "display_name": "AntonH", "link": "https://stackoverflow.com/users/2261424/antonh"}, "edited": false, "score": 0, "creation_date": 1505847805, "post_id": 46307877, "comment_id": 79577854, "body": "Note that the GCC compiler accepts ranges, but this is compiler specific: <a href=\"https://stackoverflow.com/questions/36748934/how-can-i-use-ranges-in-a-switch-case-statement-in-c\" title=\"how can i use ranges in a switch case statement in c\">stackoverflow.com/questions/36748934/&hellip;</a>"}, {"owner": {"reputation": 6254, "user_id": 2261424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a0beda634f65f29aace865be9504e5e6?s=128&d=identicon&r=PG", "display_name": "AntonH", "link": "https://stackoverflow.com/users/2261424/antonh"}, "edited": false, "score": 1, "creation_date": 1505847824, "post_id": 46307877, "comment_id": 79577865, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/36748934/how-can-i-use-ranges-in-a-switch-case-statement-in-c\">How can I use ranges in a switch case statement in C?</a>"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 1451, "user_id": 7615877, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AbOhS.jpg?s=128&g=1", "display_name": "akshayk07", "link": "https://stackoverflow.com/users/7615877/akshayk07"}, "edited": false, "score": 0, "creation_date": 1505847826, "post_id": 46307877, "comment_id": 79577867, "body": "@akshayk07 it is actually an <code>int</code> here but what he needs is a &quot;constant expression&quot;."}, {"owner": {"reputation": 1451, "user_id": 7615877, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AbOhS.jpg?s=128&g=1", "display_name": "akshayk07", "link": "https://stackoverflow.com/users/7615877/akshayk07"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1505847866, "post_id": 46307877, "comment_id": 79577889, "body": "@AjayBrahmakshatriya in C, <code>int</code> and <code>char</code> are essentially the same?"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 1451, "user_id": 7615877, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AbOhS.jpg?s=128&g=1", "display_name": "akshayk07", "link": "https://stackoverflow.com/users/7615877/akshayk07"}, "edited": false, "score": 0, "creation_date": 1505847953, "post_id": 46307877, "comment_id": 79577949, "body": "@akshayk07 And that is related why?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 1451, "user_id": 7615877, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AbOhS.jpg?s=128&g=1", "display_name": "akshayk07", "link": "https://stackoverflow.com/users/7615877/akshayk07"}, "edited": false, "score": 0, "creation_date": 1505847996, "post_id": 46307877, "comment_id": 79577969, "body": "@akshayk07 In C, <code>int</code> and <code>char</code> are different types."}, {"owner": {"reputation": 1451, "user_id": 7615877, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AbOhS.jpg?s=128&g=1", "display_name": "akshayk07", "link": "https://stackoverflow.com/users/7615877/akshayk07"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1505848012, "post_id": 46307877, "comment_id": 79577977, "body": "@AjayBrahmakshatriya You said it&#39;s just an <code>int</code> , but if they are the same..."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 1451, "user_id": 7615877, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AbOhS.jpg?s=128&g=1", "display_name": "akshayk07", "link": "https://stackoverflow.com/users/7615877/akshayk07"}, "edited": false, "score": 0, "creation_date": 1505848069, "post_id": 46307877, "comment_id": 79578005, "body": "@akshayk07 I am saying what he has here is an <code>int</code>, but it&#39;s not a constant expression."}], "answers": [{"comments": [{"owner": {"reputation": 1451, "user_id": 7615877, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AbOhS.jpg?s=128&g=1", "display_name": "akshayk07", "link": "https://stackoverflow.com/users/7615877/akshayk07"}, "edited": false, "score": 0, "creation_date": 1505847723, "post_id": 46307989, "comment_id": 79577806, "body": "I think the value after case should be <code>int</code> or <code>char</code> strictly."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 1451, "user_id": 7615877, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AbOhS.jpg?s=128&g=1", "display_name": "akshayk07", "link": "https://stackoverflow.com/users/7615877/akshayk07"}, "edited": false, "score": 0, "creation_date": 1505847882, "post_id": 46307989, "comment_id": 79577900, "body": "@akshayk07 Needs to be a <i>conditional-expression</i>.  <code>char</code> is not special here."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1505848421, "post_id": 46307989, "comment_id": 79578202, "body": "&quot;The constant-expression for a case must be the same data type ...&quot; is not for C.  Perhaps Java."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1505848532, "post_id": 46307989, "comment_id": 79578251, "body": "@AjayBrahmakshatriya <i>constant-expression</i> is defined as a <i>conditional-expression</i>."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1505848948, "post_id": 46307989, "comment_id": 79578469, "body": "@chux I did not know that! Thanks."}], "tags": [], "owner": {"reputation": 1055, "user_id": 3406936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2294a96c8fb728eca7525ea9de2e3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Shlomi Agiv", "link": "https://stackoverflow.com/users/3406936/shlomi-agiv"}, "is_accepted": false, "score": 0, "last_activity_date": 1505847991, "last_edit_date": 1505847991, "creation_date": 1505847674, "answer_id": 46307989, "question_id": 46307877, "link": "https://stackoverflow.com/questions/46307877/why-the-case-label-doesnt-reduce-to-an-integer-constant-in-this-particular-prog/46307989#46307989", "title": "Why the case label doesn&#39;t reduce to an integer constant in this particular program?", "body": "<p>you can't put a condition under a case. from <a href=\"https://www.tutorialspoint.com/cprogramming/switch_statement_in_c.htm\" rel=\"nofollow noreferrer\">https://www.tutorialspoint.com/cprogramming/switch_statement_in_c.htm</a>:</p>\n\n<p><em>The constant-expression for a case must be the same data type as the variable in the switch, and it must be a constant or a literal.</em></p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1505849279, "last_edit_date": 1505849279, "creation_date": 1505848941, "answer_id": 46308290, "question_id": 46307877, "link": "https://stackoverflow.com/questions/46307877/why-the-case-label-doesnt-reduce-to-an-integer-constant-in-this-particular-prog/46308290#46308290", "title": "Why the case label doesn&#39;t reduce to an integer constant in this particular program?", "body": "<p>The case must be constant.  <code>case (marks&gt;=90):</code> does not employ a constant.</p>\n\n<blockquote>\n  <p>The expression of each <code>case</code> label shall be an integer constant expression and no two of the <code>case</code> constant expressions in the <code>same</code> switch statement shall have the same value after conversion\" \u00a76.8.4.2 3 </p>\n</blockquote>\n\n<p>Example:</p>\n\n<pre><code>switch (grade) {\n  case 'A': printf(\"Excellent\"); break;\n  case 'B': printf(\"very good\"); break;\n  case 'C': // fall though (no break)\n  case 'D': printf(\"poor\"); break;\n  default: printf(\"Hmmm\");\n}\n</code></pre>\n\n<hr>\n\n<p>OP's code would be better served with <code>if(), else if(), else</code></p>\n\n<pre><code>// switch(marks){\n// case (marks&gt;=90):\nif (marks&gt;=90) {\n    printf(\"Excellent\");\n} else if (marks&gt;=75) {\n    printf(\"very good\");\n} else if (marks &lt; 40){  // Perhaps OP wants (marks &gt; 40) here\n    printf(\"poor\");\n} else {\n    printf(\"no marks available\");\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1505854909, "post_id": 46308362, "comment_id": 79581311, "body": "Good explanation.  In researching this it seems code like <code>case INT_MAX&#47;2: ...</code> is OK too.  As I see it. <code>case UINTMAX_MAX: ...</code> is OK too, although using wider that <code>int</code> is not something I have done in production code."}], "tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 1, "last_activity_date": 1505920144, "last_edit_date": 1505920144, "creation_date": 1505849238, "answer_id": 46308362, "question_id": 46307877, "link": "https://stackoverflow.com/questions/46307877/why-the-case-label-doesnt-reduce-to-an-integer-constant-in-this-particular-prog/46308362#46308362", "title": "Why the case label doesn&#39;t reduce to an integer constant in this particular program?", "body": "<p>To \"fix\" this, you would have to write</p>\n\n<pre><code>switch( marks )  // branch to the label corresponding to the value stored in marks\n{\n  case 100:\n  case  99:\n  // repeat with cases 98 through 91.  \n  case  90: \n    printf( \"Excellent!\\n\" );\n    break;\n\n  case 89:\n  case 88:\n  // repeat with cases 87 through 76\n  case 75:\n    printf( \"very good\\n\" );\n    break;\n\n  // pattern should be obvious from here\n}\n</code></pre>\n\n<p><code>case</code> labels <em>must</em> be integer constant expressions, basically something that can be evaluated at compile time.  Relational expressions like <code>marks &gt;= 90</code> don't count as constant expressions.</p>\n\n<p>A <code>switch</code> branches to the label corresponding to the <em>value</em> of <code>marks</code>; IOW, if you want to execute an action when the value of <code>marks</code> is anywhere from <code>90</code> to <code>100</code>, then you a separate label for each value as above.</p>\n\n<p>You would normally not use a <code>switch</code> statement where ranges of values are involved like this; this is better done with an <code>if-else</code> statement.  </p>\n\n<p><strong>Edit</strong></p>\n\n<p>For reference, the following may be used as <code>case</code> labels:</p>\n\n<ul>\n<li>An integer literal (decimal, hex, or octal format);</li>\n<li>A character constant (such as <code>'A'</code>, <code>'?'</code>, <code>'\\n'</code>, etc.);</li>\n<li>An enumeration constant;</li>\n<li>An arithmetic expression composed of any of the previous expressions;</li>\n<li>A macro that expands to any of the previous expressions;</li>\n</ul>\n\n<p>A <code>const</code>-qualified variable is not a <em>constant expression</em> as far as C is concerned, so you can't do something like this:</p>\n\n<pre><code>const int foo = 10;\n...\nswitch( bar )\n{\n  case foo: ... // compiler will yell at you here\n</code></pre>\n\n<p>You can't branch on strings in a <code>switch</code>; however, you can compute an integer hash for a string, and branch based on that:</p>\n\n<pre><code>#define FOO_HASH 0xb887389 // result of running hash function on \"foo\"\n#define BAR_HASH 0xb8860ba // result of running hash function on \"bar\"\n\n/**\n * djb2 is a popular hash function\n * see http://www.cse.yorku.ca/~oz/hash.html for others\n */\nunsigned long hash( const char *text )\n{\n  const unsigned char *str = (const unsigned char *) text;\n  unsigned long hash = 5381;\n  int c;\n\n  while (c = *str++)\n      hash = ((hash &lt;&lt; 5) + hash) + c; /* hash * 33 + c */\n\n  return hash;\n}\n\nchar text[SIZE];\nif ( !fgets( text, sizeof text, stdin ) )\n  // bail on input error\n\n// remove newline from text somehow\n\nswitch( hash( text ) )\n{\n  case FOO_HASH: \n    // do something\n    break;\n\n  case BAR_HASH: \n    // do something else\n    break;\n}\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 8636177, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72c82d7515ae53d792e67d0ae357224c?s=128&d=identicon&r=PG&f=1", "display_name": "Pranav Sinha", "link": "https://stackoverflow.com/users/8636177/pranav-sinha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 332, "favorite_count": 0, "answer_count": 3, "score": -2, "last_activity_date": 1505920144, "creation_date": 1505847259, "last_edit_date": 1505854018, "question_id": 46307877, "link": "https://stackoverflow.com/questions/46307877/why-the-case-label-doesnt-reduce-to-an-integer-constant-in-this-particular-prog", "title": "Why the case label doesn&#39;t reduce to an integer constant in this particular program?", "body": "<pre><code>int main() {\n    int marks;\n    printf(\"enter the marks :\");\n    scanf(\" %d\", &amp;marks);\n\n    switch (marks) {\n      case (marks &gt;= 90):\n        printf(\"Excellent\");\n        break;\n      case (marks &lt; 90 &amp;&amp; marks &gt;= 75):\n        printf(\"very good\");\n        break;\n      case (marks &lt; 40):\n        printf(\"poor\");\n        break;\n      default:\n        printf(\"no marks available\");\n    }\n    return 0;\n}\n</code></pre>\n\n<p>I recently started learning C and while running the <code>switch</code> statement I just ran into this case label error.</p>\n\n<p>Please someone fix this?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1505846271, "post_id": 46307568, "comment_id": 79576954, "body": "<code>int L(int x){if (x&lt;2) return x; return L(x-1) + L(x-2) + 1;}</code>"}, {"owner": {"reputation": 1451, "user_id": 7615877, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AbOhS.jpg?s=128&g=1", "display_name": "akshayk07", "link": "https://stackoverflow.com/users/7615877/akshayk07"}, "edited": false, "score": 4, "creation_date": 1505846312, "post_id": 46307568, "comment_id": 79576978, "body": "This is not a site to do your homework for you."}, {"owner": {"reputation": 1, "user_id": 7520908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e636ff9bae2e92b3b875f5a5f633c5c4?s=128&d=identicon&r=PG&f=1", "display_name": "Kawaljit Singh", "link": "https://stackoverflow.com/users/7520908/kawaljit-singh"}, "edited": false, "score": 0, "creation_date": 1505846381, "post_id": 46307568, "comment_id": 79577024, "body": "I am not asking you to do my homework. Just asking the logic"}, {"owner": {"reputation": 1451, "user_id": 7615877, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AbOhS.jpg?s=128&g=1", "display_name": "akshayk07", "link": "https://stackoverflow.com/users/7615877/akshayk07"}, "edited": false, "score": 0, "creation_date": 1505846504, "post_id": 46307568, "comment_id": 79577097, "body": "Well, the first comment did it."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 1, "creation_date": 1505846577, "post_id": 46307568, "comment_id": 79577142, "body": "@EOF-- this will give L(0) = 0, instead of L(0) = 1."}, {"owner": {"reputation": 1069, "user_id": 2557919, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3e30654c86a8784810f0ef72834a283d?s=128&d=identicon&r=PG", "display_name": "Oswald", "link": "https://stackoverflow.com/users/2557919/oswald"}, "edited": false, "score": 0, "creation_date": 1505846623, "post_id": 46307568, "comment_id": 79577163, "body": "EOF is right, becaus he&#39;s looking for x&gt;1"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1505846716, "post_id": 46307568, "comment_id": 79577217, "body": "@Oswald-- from this viewpoint, there is no need for <code>if (x &lt; 2) {}</code> then...."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1505847839, "post_id": 46307568, "comment_id": 79577874, "body": "@DavidBowling If you leave of the -- after the <code>@USERNAME</code>, the addressed user <i>may</i> actually be notified. On topic: you&#39;re right."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1505848208, "post_id": 46307568, "comment_id": 79578092, "body": "I&#39;m voting to close this question as off-topic because we&#39;re not going to do your homework for you."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1505848229, "post_id": 46307568, "comment_id": 79578107, "body": "@EOF -- funny. I always use a dash there; I&#39;ll have to start introducing a space! (Maybe that&#39;s why nobody ever listens to me....)"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 1, "creation_date": 1505848308, "post_id": 46307568, "comment_id": 79578144, "body": "@DavidBowling Well, that has to awkward. All the time you thought people were ignoring you. Reminds me of when I used to give out my cellphone number incorrectly..."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1505855529, "post_id": 46307568, "comment_id": 79581552, "body": "@EOF Was that <a href=\"https://en.wikipedia.org/wiki/867-5309/Jenny\" rel=\"nofollow noreferrer\">867-5309</a>?"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1505855732, "post_id": 46307568, "comment_id": 79581621, "body": "@chux Im not <i>quite</i> that old."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7520908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e636ff9bae2e92b3b875f5a5f633c5c4?s=128&d=identicon&r=PG&f=1", "display_name": "Kawaljit Singh", "link": "https://stackoverflow.com/users/7520908/kawaljit-singh"}, "edited": false, "score": 0, "creation_date": 1505847556, "post_id": 46307771, "comment_id": 79577716, "body": "Thanks @akshayk07"}], "tags": [], "owner": {"reputation": 1451, "user_id": 7615877, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AbOhS.jpg?s=128&g=1", "display_name": "akshayk07", "link": "https://stackoverflow.com/users/7615877/akshayk07"}, "is_accepted": true, "score": 1, "last_activity_date": 1505847472, "last_edit_date": 1505847472, "creation_date": 1505846891, "answer_id": 46307771, "question_id": 46307568, "link": "https://stackoverflow.com/questions/46307568/what-is-the-logic-to-find-out-leonardo-number-in-c-programming/46307771#46307771", "title": "What is the logic to find out Leonardo number in C programming?", "body": "<p>In your function <code>L(int x)</code></p>\n\n<p>If <code>x</code> is 0 or 1</p>\n\n<p><code>return 1;</code></p>\n\n<p>If <code>x</code> is greater than 1</p>\n\n<p><code>return L(x-1) + L(x-2) + 1;</code></p>\n\n<p>What I am doing using <code>L(x - 1)</code> is calling the function for the value <code>x - 1</code> and the value will be evaluated directly as 1 if it is 0 or 1, otherwise it call again for <code>(x - 1) - 1</code> i.e. <code>x - 2</code> and the process repeats.</p>\n\n<p>Same is the case for calling <code>L(x - 2)</code>.</p>\n\n<p>This is the logic, without the entire code.</p>\n\n<p>For more information on this kind of logic, try searching for Recursion.</p>\n"}], "owner": {"reputation": 1, "user_id": 7520908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e636ff9bae2e92b3b875f5a5f633c5c4?s=128&d=identicon&r=PG&f=1", "display_name": "Kawaljit Singh", "link": "https://stackoverflow.com/users/7520908/kawaljit-singh"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 286, "favorite_count": 0, "closed_date": 1505856516, "accepted_answer_id": 46307771, "answer_count": 1, "score": -8, "last_activity_date": 1505855351, "creation_date": 1505846135, "last_edit_date": 1505855351, "question_id": 46307568, "link": "https://stackoverflow.com/questions/46307568/what-is-the-logic-to-find-out-leonardo-number-in-c-programming", "closed_reason": "Needs details or clarity", "title": "What is the logic to find out Leonardo number in C programming?", "body": "<p>Leonardo number</p>\n\n<pre><code>L(x)= {\n    1               if x=0\n    1               if x=1\n    L(x-1)+L(x-2)+1 if x&gt;1\n}\n</code></pre>\n\n<p>If x>1, what logic can I apply to find out the Leonardo number?</p>\n"}, {"tags": ["c", "arrays", "for-loop", "boolean"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1505846084, "post_id": 46307546, "comment_id": 79576850, "body": "Traverse the arrays in parallel, one in ascending order, the other in reverse. And compare. Easy."}, {"owner": {"reputation": 177576, "user_id": 8620333, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WSmLn.png?s=128&g=1", "display_name": "Temani Afif", "link": "https://stackoverflow.com/users/8620333/temani-afif"}, "edited": false, "score": 1, "creation_date": 1505846126, "post_id": 46307546, "comment_id": 79576876, "body": "in one array use <b>i</b> as index and the onther one <b>n-i-1</b> where n is the lenght of both of them"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 1, "creation_date": 1505846257, "post_id": 46307546, "comment_id": 79576945, "body": "those look like 1d arrays to me. Also recommend using a more recent (version of your) compiler."}, {"owner": {"reputation": 1451, "user_id": 7615877, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AbOhS.jpg?s=128&g=1", "display_name": "akshayk07", "link": "https://stackoverflow.com/users/7615877/akshayk07"}, "edited": false, "score": 0, "creation_date": 1505846421, "post_id": 46307546, "comment_id": 79577046, "body": "There are many versions of gcc based on c89, c99, c11, etc. not just the one."}, {"owner": {"reputation": 41, "user_id": 7548712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98b71d89af07ca400bc1882be88b5836?s=128&d=identicon&r=PG&f=1", "display_name": "Far Sight", "link": "https://stackoverflow.com/users/7548712/far-sight"}, "edited": false, "score": 0, "creation_date": 1505846530, "post_id": 46307546, "comment_id": 79577115, "body": "im running the code on visual studio. It should work fine in visual studio. but I have to test the code on c89 compiler from our university before submitting our work."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1505846683, "post_id": 46307546, "comment_id": 79577198, "body": "If your U is requiring to use gcc, I would warmly suggest to ditch VS right now."}, {"owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 0, "creation_date": 1505846684, "post_id": 46307546, "comment_id": 79577201, "body": "GCC has had near-complete C99 support since the 3.0-3.1 era (2001-2002). MSVC has had semi-reasonable C99 support since 2013ish."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1505846686, "post_id": 46307546, "comment_id": 79577203, "body": "then my suggestion applies to your university :) But no <code>bool</code> is fine, just use <code>int</code>s. 0 is false, everything else is true."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1505846911, "post_id": 46307546, "comment_id": 79577318, "body": "&quot;So far I tried to read both 2d arrays and use if/else statements and  ...&quot;  Post that code."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1505847011, "post_id": 46307546, "comment_id": 79577391, "body": "So.. in the edited version, they should be mirrored <i>coumnwise</i>?"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1505847752, "post_id": 46307546, "comment_id": 79577824, "body": "@EugeneSh.: I am making assumptions based on what the OP tried to do with their raw text in their post. The mirror&#39;d text table is what I think they are trying to detect in code, but this post is probably not salvageable without the OP providing the code for their attempt."}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1505849134, "post_id": 46307546, "comment_id": 79578570, "body": "The first nested loop used to scan the first array: <code>for (a = 0; b &lt; row; i++)</code> --&gt; <code>for (a = 0; a &lt; row; a++)</code>"}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1505849761, "post_id": 46307546, "comment_id": 79578911, "body": "Have you copy pasted the code in your question from different functions? Right now, you are declaring <code>array_1</code> and <code>array_2</code>, filling <code>first_array</code> and <code>second_array</code> and checking <code>m1</code> and <code>m2</code>... Pick up one name or better split your code into more functions."}], "answers": [{"tags": [], "owner": {"reputation": 1505, "user_id": 2641513, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bGWLp.jpg?s=128&g=1", "display_name": "zoska", "link": "https://stackoverflow.com/users/2641513/zoska"}, "is_accepted": false, "score": 0, "last_activity_date": 1505849552, "creation_date": 1505849552, "answer_id": 46308440, "question_id": 46307546, "link": "https://stackoverflow.com/questions/46307546/how-to-check-if-two-arrays-are-mirror-images-of-each-other-in-c/46308440#46308440", "title": "How to check if two arrays are mirror images of each other in C?", "body": "<p>You wanted to read values to both matrices the same way (hint 1: use functions). So they will both look like this:</p>\n\n<p>First one:</p>\n\n<pre><code>{{m1[0][0], m1[0][1], m1[0][2],..., m1[0][99]},\n {m1[1][0], m1[1][1], m1[1][2],..., m1[1][99]},\n ...\n {m1[99][0], m1[99][1], ..., m1[99][99]}}\n</code></pre>\n\n<p>second one:</p>\n\n<pre><code>{{m2[0][0], m2[0][1], m2[0][2],..., m2[0][99]},\n {m2[1][0], m2[1][1], m2[1][2],..., m2[1][100]},\n ...\n {m2[99][0], m2[99][1], ..., m2[99][99]}}\n</code></pre>\n\n<p>But you have an error in first loop of reading m1 array: </p>\n\n<pre><code>for (a = 0; b &lt; row; i++)\n</code></pre>\n\n<p>And then inside your comparison loop, you have :</p>\n\n<pre><code>m1[row][col] != m2[row][col]\n</code></pre>\n\n<p>Which compares values of both matrices with the same indices. So instead of comparing <code>m1[0][0]</code> with <code>m2[0][99]</code> you are comparing <code>m1[0][0]</code> with <code>m2[0][0]</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 7548712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98b71d89af07ca400bc1882be88b5836?s=128&d=identicon&r=PG&f=1", "display_name": "Far Sight", "link": "https://stackoverflow.com/users/7548712/far-sight"}, "edited": false, "score": 0, "creation_date": 1505850279, "post_id": 46308481, "comment_id": 79579153, "body": "Thanks so much. I need to use it for both 2d and 3d matrixes but I understand how to start the for-loops so I should be fine now. Thanks. Btw, why is it necessary for size to be a constant?"}, {"owner": {"reputation": 2355, "user_id": 7745946, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/guDLD.png?s=128&g=1", "display_name": "Aashish", "link": "https://stackoverflow.com/users/7745946/aashish"}, "reply_to_user": {"reputation": 41, "user_id": 7548712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98b71d89af07ca400bc1882be88b5836?s=128&d=identicon&r=PG&f=1", "display_name": "Far Sight", "link": "https://stackoverflow.com/users/7548712/far-sight"}, "edited": false, "score": 0, "creation_date": 1505850470, "post_id": 46308481, "comment_id": 79579249, "body": "There is no constraint on size to be a constant. you can take size at runtime also."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 1, "creation_date": 1505853396, "post_id": 46308481, "comment_id": 79580608, "body": "Why do you need a <code>tmp</code> array?"}], "tags": [], "owner": {"reputation": 2355, "user_id": 7745946, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/guDLD.png?s=128&g=1", "display_name": "Aashish", "link": "https://stackoverflow.com/users/7745946/aashish"}, "is_accepted": false, "score": 0, "last_activity_date": 1505854298, "last_edit_date": 1505854298, "creation_date": 1505849681, "answer_id": 46308481, "question_id": 46307546, "link": "https://stackoverflow.com/questions/46307546/how-to-check-if-two-arrays-are-mirror-images-of-each-other-in-c/46308481#46308481", "title": "How to check if two arrays are mirror images of each other in C?", "body": "<p>Simple and short:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#define size 3\n\nint main (void){\n    int i,j,k,flag=1;\n    int array1[][size] = { { 2, 5, 10},{ 2, 1, 9 } }, array2[][size] = { {10, 5, 2 }, { 9, 1, 2 } };\n\n    //Check mirror image or not\n    for(i=0;i&lt;size-1;i++) {\n        for(j=0,k=size-1;j&lt;size;j++,k--) {\n            if(array1[i][j]!=array2[i][k]) {\n                flag=0;\n                break;\n            }\n        }\n    }\n    if(flag)\n        printf(\"Mirror image to each other\");\n    else\n        printf(\"Not a mirror image to each other\");\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 0, "last_activity_date": 1505853890, "creation_date": 1505853890, "answer_id": 46309486, "question_id": 46307546, "link": "https://stackoverflow.com/questions/46307546/how-to-check-if-two-arrays-are-mirror-images-of-each-other-in-c/46309486#46309486", "title": "How to check if two arrays are mirror images of each other in C?", "body": "<p>You can verify this property with 2 nested loops:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define COLS 3\n#define ROWS 2\n\nint main(void) {\n    int array1[ROWS][COLS] = { { 2, 5, 10 }, { 2, 1, 9 } };\n    int array2[ROWS][COLS] = { { 10, 5, 2 }, { 9, 1, 2 } };\n    int xmirror = 1;\n    int ymirror = 1;\n    int xymirror = 1;\n\n    for (int i = 0; i &lt; ROWS; i++) {\n        for (int j = 0; j &lt; COLS; j++) {\n            if (array1[i][j] != array2[i][COLS - 1 - j])\n                xmirror = 0;\n            if (array1[i][j] != array2[ROWS - 1 - i][j])\n                ymirror = 0;\n            if (array1[i][j] != array2[ROWS - 1 - i][COLS - 1 - j])\n                xymirror = 0;\n        }\n    }\n    if (xymirror)\n        printf(\"Mirror image to each other rowwise and columnwise\\n\");\n    if (ymirror)\n        printf(\"Mirror image to each other rowwise\\n\");\n    if (xmirror)\n        printf(\"Mirror image to each other columnwise\\n\");\n    if (xmirror + ymirror + xymirror == 0)\n        printf(\"Not a mirror image of each other\\n\");\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 7548712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98b71d89af07ca400bc1882be88b5836?s=128&d=identicon&r=PG&f=1", "display_name": "Far Sight", "link": "https://stackoverflow.com/users/7548712/far-sight"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1467, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1505854298, "creation_date": 1505846021, "last_edit_date": 1505850788, "question_id": 46307546, "link": "https://stackoverflow.com/questions/46307546/how-to-check-if-two-arrays-are-mirror-images-of-each-other-in-c", "title": "How to check if two arrays are mirror images of each other in C?", "body": "<p>I am trying to see how to use C to check if two 2d arrays are symmetrical/mirror to each other.</p>\n\n<p>So for example, if</p>\n\n<pre><code>array1 = { { 2, 5, 10 }, { 2, 1, 9 } };\narray2 = { { 10, 5, 2 }, { 9, 1, 2 } };\n</code></pre>\n\n<p>The arrays are really 2d arrays.</p>\n\n<p>How should I approach this?  So far I tried to read both 2d arrays and use if/else statements and a bool to check if both arrays are equal to each other or not. But I'm not sure how to check if they are mirror matrices of each other or not.</p>\n\n<pre><code>2 5 10  |  10 5 2\n2 1  9  |   9 1 2\n</code></pre>\n\n<p>The compiler is from 89. </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1505846115, "post_id": 46307479, "comment_id": 79576868, "body": "<a href=\"https://ideone.com/dosphN\" rel=\"nofollow noreferrer\">This</a> doesn&#39;t say so."}, {"owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1505846432, "post_id": 46307479, "comment_id": 79577051, "body": "@EOF Although similar, this doesn&#39;t seem to be exactly the same question as that one."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "edited": false, "score": 1, "creation_date": 1505846568, "post_id": 46307479, "comment_id": 79577136, "body": "@CharlesSrstka It&#39;s the canonical question about unexpected (for beginners) floating-point behavior. Fundamentally the same problem is displayed in this question."}, {"owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1505846742, "post_id": 46307479, "comment_id": 79577241, "body": "@EOF While that&#39;s true, it seems to me that the <i>reason</i> that it is fundamentally the same problem would not be obvious to a beginner, since they appear to be asking two different things to someone unfamiliar with the behaviors of floating-point math."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "edited": false, "score": 0, "creation_date": 1505846954, "post_id": 46307479, "comment_id": 79577350, "body": "@CharlesSrstka Well, stack overflow <i>does</i> have rules requiring the one asking the question to show <i>some</i> willingness to do their own research. Pointing out that floating-point problems are at the heart of the problem, and giving them a post discussing typical floating point problems should suffice."}, {"owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1505847021, "post_id": 46307479, "comment_id": 79577399, "body": "@EOF Isn&#39;t asking questions like this how one learns, though? We all were new to this stuff at some point, and this <i>is</i> a confusing topic for beginners."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "edited": false, "score": 0, "creation_date": 1505847136, "post_id": 46307479, "comment_id": 79577471, "body": "@CharlesSrstka No, asking bad questions does absolutely nothing to further the questioner&#39;s understanding. Now, formulating a question carefully might, and reading answers might, but not asking the question."}, {"owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1505847322, "post_id": 46307479, "comment_id": 79577574, "body": "@EOF But in order to <i>know</i> that this problem was caused by floating-point behavior, OP would have already had to <i>understand</i> floating-point behavior. Otherwise, there&#39;s no way for the OP to know what to research. I think the question has merit, and should be preserved."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "edited": false, "score": 0, "creation_date": 1505847521, "post_id": 46307479, "comment_id": 79577702, "body": "@CharlesSrstka And by marking the question as a duplicate of a question discussing floating-point behavior, the OP gets to understand that floating-point behavior is the cause of the behavior they observe. I fail to see the problem you have with this. I also fail to see what value this question, formatted as it is, will have for future reference for those who actually research themselves before asking a new question."}, {"owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1505847608, "post_id": 46307479, "comment_id": 79577740, "body": "@EOF Well, for one thing, the linked answer does not discuss the behavior involved in casting floating-point variables to integers, which is at the root of the problem OP is seeing."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1505855906, "post_id": 46307479, "comment_id": 79581693, "body": "Fundamentally, the problem is that computer floating point arithmetic does not match people&#39;s mental model, not least because computers work with binary (unless you happen to have a Power6 or later CPU; those do have decimal floating point arithmetic) whereas people work in decimal. Assumptions that work in decimal (such as <code>0.03</code> has an accurate representation) are not valid in binary. You could help yourself by using <code>double</code> instead of <code>float</code>; by computing in <code>double</code>; by printing the values computed in <code>double</code>. That would improve the accuracy of the answers. It wouldn&#39;t stop truncation."}], "answers": [{"tags": [], "owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "is_accepted": false, "score": 0, "last_activity_date": 1505846931, "last_edit_date": 1505846931, "creation_date": 1505846413, "answer_id": 46307641, "question_id": 46307479, "link": "https://stackoverflow.com/questions/46307479/program-output-is-different-from-manual-calculation-why-is-this-happening-c-lan/46307641#46307641", "title": "Program output is different from manual calculation why is this happening? C language", "body": "<p>Your problem is in the conversion of <code>float</code> to <code>int</code>. If you do your program with everything typed as <code>float</code>, you get the expected results:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#define s scanf\n#define p printf\nint main (){\n    float P,I,A;\n    float T,R;\n\n    p(\"PRINCIPAL: \");\n    s(\"%f\",&amp;P);\n    p(\"RATE: \");\n    s(\"%f\",&amp;R);\n    p(\"TERM: \");\n    s(\"%f\",&amp;T);\n    R = R/100;\n    I = P*R*T;\n    A = P+I;\n    p(\"I: %f\\nMA: %f\",I,A);\n\n    return 0;\n}\n</code></pre>\n\n<p>outputs:</p>\n\n<pre><code>PRINCIPAL: 1200\nRATE: 3\nTERM: 1\nI: 36.000000\nMA: 1236.000000\n</code></pre>\n\n<p>However, when you convert your <code>float</code> values to <code>int</code>, you just take the integer part; everything to the right of the decimal point gets deleted. So, even though it's printing as 36.000000 when I do it, it's possible that the value of <code>I</code> may be coming out to something like 35.9999999, due to imprecision in floating-point math, and simply displaying as 36.000000 due to rounding in the display process. In this case, you'll just get the 35, and lose everything else.</p>\n\n<p>To solve your problem, either leave everything as a <code>float</code>, or convert your <code>float</code>s to <code>int</code>s by rounding them\u2014for example, by using <code>lroundf</code> in <code>math.h</code>\u2014instead of just casting them.</p>\n"}, {"tags": [], "owner": {"reputation": 182, "user_id": 8547802, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dcBka.jpg?s=128&g=1", "display_name": "Gabriel Magri", "link": "https://stackoverflow.com/users/8547802/gabriel-magri"}, "is_accepted": false, "score": 0, "last_activity_date": 1505846434, "creation_date": 1505846434, "answer_id": 46307650, "question_id": 46307479, "link": "https://stackoverflow.com/questions/46307479/program-output-is-different-from-manual-calculation-why-is-this-happening-c-lan/46307650#46307650", "title": "Program output is different from manual calculation why is this happening? C language", "body": "<p>Your problem is with typecasting, please research on this subject a look at this, it's a little bit hude to explain in a simple text here.\nBut I can tell you, you are problably losing information when casting from float to int, because this two primitive types in C have diferent max length.\nYou can see changin the int variables to float and running your own program again, like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#define s scanf\n#define p printf\nvoid main (){\n    float P,I,A;\n    float T,R;\n    p(\"PRINCIPAL: \");\n    s(\"%f\",&amp;P);\n    p(\"RATE: \");\n    s(\"%f\",&amp;R);\n    p(\"TERM: \");\n    s(\"%f\",&amp;T);\n    R = R/100;\n    I = P*R*T;\n    A = P+I;\n    p(\"I: %f\\nMA: %f\",I,A);\n    getch();\n}\n</code></pre>\n\n<p>This will produce your desired output, just in float.</p>\n"}, {"tags": [], "owner": {"reputation": 2355, "user_id": 7745946, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/guDLD.png?s=128&g=1", "display_name": "Aashish", "link": "https://stackoverflow.com/users/7745946/aashish"}, "is_accepted": true, "score": 1, "last_activity_date": 1505846884, "creation_date": 1505846884, "answer_id": 46307767, "question_id": 46307479, "link": "https://stackoverflow.com/questions/46307479/program-output-is-different-from-manual-calculation-why-is-this-happening-c-lan/46307767#46307767", "title": "Program output is different from manual calculation why is this happening? C language", "body": "<p>You try to typecast <code>float</code> to <code>int</code> that causes some data loss. Just like we can not store the big object in the small bag.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#define s scanf\n#define p printf\nint main (){\n    int P;\n    float T,R,I,A;\n    p(\"PRINCIPAL: \");\n    s(\"%i\",&amp;P);\n    p(\"RATE: \");\n    s(\"%f\",&amp;R);\n    p(\"TERM: \");\n    s(\"%f\",&amp;T);\n    R = R/100;\n    I = P*R*T;\n    A = P+I;\n    p(\"\\nI: %f\\nMA: %f\",I,A);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 4995002, "user_type": "registered", "profile_image": "https://graph.facebook.com/826176354136229/picture?type=large", "display_name": "Amben Uchiha", "link": "https://stackoverflow.com/users/4995002/amben-uchiha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "closed_date": 1505855652, "accepted_answer_id": 46307767, "answer_count": 3, "score": -3, "last_activity_date": 1505846931, "creation_date": 1505845828, "question_id": 46307479, "link": "https://stackoverflow.com/questions/46307479/program-output-is-different-from-manual-calculation-why-is-this-happening-c-lan", "closed_reason": "Duplicate", "title": "Program output is different from manual calculation why is this happening? C language", "body": "<pre><code>#include &lt;stdio.h&gt;\n#define s scanf\n#define p printf\nvoid main (){\n    int P,I,A;\n    float T,R;\n    clrscr();\n    p(\"PRINCIPAL: \");\n    s(\"%i\",&amp;P);\n    p(\"RATE: \");\n    s(\"%f\",&amp;R);\n    p(\"TERM: \");\n    s(\"%f\",&amp;T);\n    R = R/100;\n    I = P*R*T;\n    A = P+I;\n    p(\"I: %i\\nMA: %i\",I,A);\n    getch();\n}\n</code></pre>\n\n<p>This really bugs me, if i put PRINCIPAL: 1200 RATE: 3 TERM:1 I: 35 MA: 1235 but if you compute in manually the answer should be I: 36 MA: 1236 the number is decreasing by 1. Why is it happening? why does the answer differ from computer and manual computing?</p>\n"}, {"tags": ["c++", "c", "scanf"], "comments": [{"owner": {"reputation": 7698, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1505845251, "post_id": 46307311, "comment_id": 79576440, "body": "Did you try <code>&quot;%c%c%c%c&quot;</code> as format string instead? Or use <a href=\"http://en.cppreference.com/w/cpp/io/basic_istream/get\" rel=\"nofollow noreferrer\"><code>std::istream::get()</code></a> in a loop. Also I don&#39;t see why you can&#39;t simply use <code>std::getline()</code>?"}, {"owner": {"reputation": 101, "user_id": 4707436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c9902ccfe19624247b98c3ab500a02f?s=128&d=identicon&r=PG", "display_name": "jumper0x08", "link": "https://stackoverflow.com/users/4707436/jumper0x08"}, "edited": false, "score": 0, "creation_date": 1505845557, "post_id": 46307311, "comment_id": 79576586, "body": "Do you only want to read dots? If so read the whole string using getline() into a std::string. You now have an array of characters."}], "answers": [{"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 4, "last_activity_date": 1505845527, "creation_date": 1505845527, "answer_id": 46307400, "question_id": 46307311, "link": "https://stackoverflow.com/questions/46307311/get-characters-not-separated-with-spaces-in-array-using-scanf/46307400#46307400", "title": "get characters (not separated with spaces) in array using scanf()", "body": "<p><code>scanf()</code> is a C runtime function.  In C++, you should be using <a href=\"http://en.cppreference.com/w/cpp/io/cin\" rel=\"nofollow noreferrer\"><code>std::cin</code></a> instead.  For instance, with <a href=\"http://en.cppreference.com/w/cpp/string/basic_string/getline\" rel=\"nofollow noreferrer\"><code>std::getline()</code></a>.  You can treat the returned <a href=\"http://en.cppreference.com/w/cpp/string/basic_string\" rel=\"nofollow noreferrer\"><code>std::string</code></a> like an array of characters.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1505862794, "creation_date": 1505862794, "answer_id": 46311010, "question_id": 46307311, "link": "https://stackoverflow.com/questions/46307311/get-characters-not-separated-with-spaces-in-array-using-scanf/46311010#46311010", "title": "get characters (not separated with spaces) in array using scanf()", "body": "<blockquote>\n  <p>User will input them as one line like this; <code>....</code> I need to save each dot in array,</p>\n</blockquote>\n\n<p>C solution:</p>\n\n<p>Define upper sane bound like 1000 and use a <em>scanset</em> <code>\"%[]\"</code>.  </p>\n\n<pre><code>// Read up to 1000 `.`\nchar dot[1000 + 1];\nif (scanf(\" %1000[.]\") == 1) {\n  //  Success\n  puts(dot);\n}\n</code></pre>\n\n<p>Additional code needed if other non-<code>.</code>, non -white-space characters need to be handled.</p>\n"}], "owner": {"reputation": 135, "user_id": 4700086, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c2f50503d14757454155c058707f03e3?s=128&d=identicon&r=PG", "display_name": "Personal Jesus", "link": "https://stackoverflow.com/users/4700086/personal-jesus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "closed_date": 1505863085, "answer_count": 2, "score": -3, "last_activity_date": 1505862794, "creation_date": 1505845185, "last_edit_date": 1505845991, "question_id": 46307311, "link": "https://stackoverflow.com/questions/46307311/get-characters-not-separated-with-spaces-in-array-using-scanf", "closed_reason": "Needs details or clarity", "title": "get characters (not separated with spaces) in array using scanf()", "body": "<p>I need to store characters from user's input in  array, BUT not one by one. User will input them as one line like this;</p>\n\n<pre><code>....\n</code></pre>\n\n<p>I need to save each dot in array, but I can't do this:</p>\n\n<pre><code>scanf(\"%s%s%s%s\", &amp;s[0], &amp;s[1], &amp;s[2], &amp;s[3])\n</code></pre>\n\n<p>because user can enter N number of dots. So it must be dynamic, I guess.</p>\n"}, {"tags": ["c", "pointers", "struct"], "comments": [{"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 4, "creation_date": 1505843480, "post_id": 46306589, "comment_id": 79575543, "body": "when printing pointers, use the <code>%p</code> format specifier and cast them to <code>void*</code>: <code>printf(&quot;production_plant_employees[%d].basic_info = %p&quot;, i, (void*)production_plant_employees[i].basic_info);</code> Also, <code>fflush(stdin);</code> is undefined behavior."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1505843969, "post_id": 46306589, "comment_id": 79575806, "body": "Look up the relative precedence and associativity of the operators involved.  In particular, look at the precedence of the dereferencing operator (<code>*</code>) relative to the member-selection (<code>.</code>) and indirect member selection (<code>-&gt;</code>) operators."}], "answers": [{"comments": [{"owner": {"reputation": 108, "user_id": 8544931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9ad1527376e28e32118a4b8f28fc65f?s=128&d=identicon&r=PG&f=1", "display_name": "Apollo", "link": "https://stackoverflow.com/users/8544931/apollo"}, "edited": false, "score": 0, "creation_date": 1505845126, "post_id": 46307199, "comment_id": 79576389, "body": "Oh boy... Thanks for answering so quickly, it works :D Btw. I was so close couple of minutes ago. Thanks a lot!"}], "tags": [], "owner": {"reputation": 985, "user_id": 6531241, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/XySrX.jpg?s=128&g=1", "display_name": "Karim Manaouil", "link": "https://stackoverflow.com/users/6531241/karim-manaouil"}, "is_accepted": true, "score": 3, "last_activity_date": 1505845037, "last_edit_date": 1505845037, "creation_date": 1505844722, "answer_id": 46307199, "question_id": 46306589, "link": "https://stackoverflow.com/questions/46306589/array-of-pointers-to-a-struct-with-pointers-in-that-struct/46307199#46307199", "title": "Array of pointers to a struct with pointers in that struct", "body": "<p>The right way to do it is (for access method 3): </p>\n\n<pre><code>printf(\"Name of %d. employee : %s\", i, (*(*(production_plant_employees +i)).basic_info).name);\n</code></pre>\n\n<p>First we start by dereferencing pointer <code>production_plant_employees +i</code>, now, we access member <code>basic_info</code> which is also a pointer &amp; needs to get dereferenced using the second <code>*</code> to access local member <code>name</code>.<br><br></p>\n\n<pre><code>ptr1 = production_plant_employees +i\nptr2 = (*ptr1).basic_info\ndata = (*ptr2).name\n</code></pre>\n\n<p>And thus (substituting <code>ptr2</code> in <code>data</code>:</p>\n\n<pre><code>data = (*(*ptr1).basic_info).name\n</code></pre>\n\n<p>&amp; finally by substituting <code>ptr1</code> :</p>\n\n<pre><code>data = (*(*(production_plant_employees +i)).basic_info).name\n</code></pre>\n"}], "owner": {"reputation": 108, "user_id": 8544931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9ad1527376e28e32118a4b8f28fc65f?s=128&d=identicon&r=PG&f=1", "display_name": "Apollo", "link": "https://stackoverflow.com/users/8544931/apollo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 46307199, "answer_count": 1, "score": 1, "last_activity_date": 1505847826, "creation_date": 1505842394, "last_edit_date": 1505847826, "question_id": 46306589, "link": "https://stackoverflow.com/questions/46306589/array-of-pointers-to-a-struct-with-pointers-in-that-struct", "title": "Array of pointers to a struct with pointers in that struct", "body": "<p>The part that is bothering me is the last <code>for</code> loop which I used just to test whether the data is entered correctly and that it is printed using <code>printf</code> properly. The three access methods used to print the data which I entered aren't quite clear to me.</p>\n\n<p>In <strong>access method #1</strong> I managed to print data properly using only one arrow operator to access name. The part I can't wrap my head around is why am I able to access the data without an error? I only used index to access each <code>production_plant_employees</code> structure. I know the brackets do the dereferencing, but I still don't understand what's happening there. I tried writing that part like this : <code>*(production_plant_employees + i)</code>, but it didn't work.</p>\n\n<p><strong>Access method #2</strong> is fully clear to me.</p>\n\n<p>Now the <strong>access method #3</strong>, that's the one I assumed would work, but it refuses to. When written, IDE shows no errors, but when I run the program, it stops.</p>\n\n<p>I am supposed to first access data in first pointer (which is <code>production_plant_employees</code>), and then then access data in second pointer (which is pointer <code>basic_info</code> which is in struct <code>employee</code>), and then, when I've gone through the 2 pointers, access the very data I am after (name, age, etc...), right?</p>\n\n<p>Also, could you please show me any other possible ways of accessing the data I'm after?</p>\n\n<pre><code>typedef struct basicdata{\n    char name[15];\n    char last_name[15];\n    char gender[2];\n    int age;\n    char birthplace[15];\n    char address[15];\n} BASICDATA;\n\ntypedef struct job_info {\n    int employment_year;\n    char job_position[20];\n    char employee_pay_grade[10];\n    int employee_grade;\n} JOB_INFO;\n\ntypedef struct employee{\n    BASICDATA *basic_info;\n    JOB_INFO *job_info;\n} EMPLOYEE;\n\n\nint main () {\n\n    int i;\n    int choice = 0;\n\n    EMPLOYEE *production_plant_employees;\n\n    printf(\"Enter number of employees : \\n\");\n    scanf(\"%d\", &amp;choice);\n\n    production_plant_employees = (EMPLOYEE*)calloc(choice, sizeof(EMPLOYEE));\n    if (production_plant_employees == NULL) {\n        printf(\"An error occured during memory allocation\\n\");\n    }\n\n    for(i = 0; i &lt; choice; ++i) {\n        production_plant_employees[i].basic_info = (BASICDATA*)calloc(choice, sizeof(BASICDATA));\n        if(production_plant_employees[i].basic_info == NULL) {\n            printf(\"An error occured during memory allocation\\n\");\n        }\n\n        production_plant_employees[i].job_info = (JOB_INFO*)calloc(choice, sizeof(JOB_INFO));\n        if(production_plant_employees[i].job_info == NULL) {\n            printf(\"An error occured during memory allocation\\n\");\n        }\n\n        printf(\"production_plant_employees[%d].basic_info = %d\\t%x\\n\", i, production_plant_employees[i].basic_info, production_plant_employees[i].basic_info);\n        printf(\"production_plant_employees[%d].job_info = %d\\t%x\\n\", i, production_plant_employees[i].job_info, production_plant_employees[i].job_info);\n    }\n\n    for(i = 0; i &lt; choice; ++i) {\n        fflush(stdin);\n        printf(\"Enter name : \\n\");\n        fgets(production_plant_employees[i].basic_info-&gt;name, 15, stdin);\n\n        printf(\"Name of %d. employee : %s\", i, production_plant_employees[i].basic_info-&gt;name) //access method#1\n        printf(\"Name of %d. employee : %s\", i, (production_plant_employees + i)-&gt;basic_info-&gt;name);  //access method #2\n        printf(\"Name of %d. employee : %s\", i, *(*(production_plant_employees +i)).basic_info-&gt;name); //access method #3 ---&gt; why isn't this working?\n        printf(\"\\n\\n\");\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "malloc"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1505850886, "post_id": 46306545, "comment_id": 79579459, "body": "<code>ans-&gt;size = size;     ans-&gt;A = ans + sizeof(struct Test);     ans-&gt;B = ans-&gt;A + sizeof(double)*size;     ans-&gt;C = ans-&gt;B + sizeof(int)*size;</code> is the wrong pointer math.  So advise against this approach."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1505852011, "post_id": 46306545, "comment_id": 79579983, "body": "The 2nd approach&#39;s pointer math is wrong.  Would need to use something like <code>ans-&gt;A = (void*) (ans + 1);  ans-&gt;B = (void*) (ans-&gt;A + size);  ans-&gt;C = (void *) (ans-&gt;B + size);</code>.  Yet that sets aside the important alignment issues which required further code adjustments.  Best to not use  second method until mastered pointer math and alignment."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 1381021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1f814a8a77858132771c20ef104dc193?s=128&d=identicon&r=PG", "display_name": "Caio", "link": "https://stackoverflow.com/users/1381021/caio"}, "edited": false, "score": 0, "creation_date": 1505844340, "post_id": 46306768, "comment_id": 79576019, "body": "I didn&#39;t seem this concept of alignment before. So, the best practice is really the first one. tks"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "reply_to_user": {"reputation": 45, "user_id": 1381021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1f814a8a77858132771c20ef104dc193?s=128&d=identicon&r=PG", "display_name": "Caio", "link": "https://stackoverflow.com/users/1381021/caio"}, "edited": false, "score": 0, "creation_date": 1505845664, "post_id": 46306768, "comment_id": 79576638, "body": "What do &quot;I don&#39;t seem this concept&quot; mean?"}, {"owner": {"reputation": 45, "user_id": 1381021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1f814a8a77858132771c20ef104dc193?s=128&d=identicon&r=PG", "display_name": "Caio", "link": "https://stackoverflow.com/users/1381021/caio"}, "edited": false, "score": 0, "creation_date": 1505846966, "post_id": 46306768, "comment_id": 79577360, "body": "Means I wrote wrong. &quot;I had never seen the concept...&quot;"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "reply_to_user": {"reputation": 45, "user_id": 1381021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1f814a8a77858132771c20ef104dc193?s=128&d=identicon&r=PG", "display_name": "Caio", "link": "https://stackoverflow.com/users/1381021/caio"}, "edited": false, "score": 0, "creation_date": 1505847896, "post_id": 46306768, "comment_id": 79577905, "body": "But you need to care about alignment as soon as a pointer is computed. <code>malloc</code> is guaranteed to give a well aligned pointer. If you implemented <code>malloc</code> you&#39;ll need to provide that guarantee. BTW many <code>malloc</code> are free software"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1505851226, "post_id": 46306768, "comment_id": 79579635, "body": "OP&#39;s 2nd method pointer math is faulty as well as having alignment issues."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1505851309, "post_id": 46306768, "comment_id": 79579681, "body": "Which I explained in my second sentence"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1505851606, "post_id": 46306768, "comment_id": 79579812, "body": "Agree 2nd sentence is about important alignment.  Setting that aside, OP&#39;s <code>ans-&gt;A = ans + sizeof(struct Test);</code> is un-reported wrong pointer math.  OP likely wanted <code>ans-&gt;A = (void*) (ans + 1);</code>"}], "tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": true, "score": 3, "last_activity_date": 1505852003, "last_edit_date": 1505852003, "creation_date": 1505843029, "answer_id": 46306768, "question_id": 46306545, "link": "https://stackoverflow.com/questions/46306545/best-strategy-in-dynamic-allocation-in-c-for-strcut-with-many-pointers/46306768#46306768", "title": "Best strategy in dynamic allocation in C for strcut with many pointers", "body": "<p>Both are possible, and which one you choose is your freedom. However, you should obey <a href=\"https://en.wikipedia.org/wiki/Data_structure_alignment\" rel=\"nofollow noreferrer\">alignment</a> constraints (perhaps using <code>alignas</code> and <code>alignof</code> from <a href=\"http://en.cppreference.com/w/c/types\" rel=\"nofollow noreferrer\"><code>&lt;stdalign.h&gt;</code></a> for the single allocation variant)</p>\n\n<p>Read also about <a href=\"https://en.wikipedia.org/wiki/Flexible_array_member\" rel=\"nofollow noreferrer\">flexible array members</a>, which permits a single <code>malloc</code> in the particular case you have only <em>one</em> array member.</p>\n\n<p>Notice that each call to <code>malloc</code> has its overhead (both in memory, perhaps consuming an extra word or two for internal management, and in time; a typical <code>malloc</code> takes less than a microsecond on my desktop).</p>\n\n<p>For long-lasting programs e.g. servers you might also care about <a href=\"https://en.wikipedia.org/wiki/Fragmentation_(computing)\" rel=\"nofollow noreferrer\">fragmentation</a> (not an issue for most short lived applications)</p>\n\n<p>The second approach (single <code>malloc</code>) might be slightly more <a href=\"https://en.wikipedia.org/wiki/CPU_cache\" rel=\"nofollow noreferrer\">cache</a> friendly. Most often, you won't care.</p>\n\n<p>BTW (as commented by <a href=\"https://stackoverflow.com/users/2410359/chux\">chux</a>)</p>\n\n<blockquote>\n<pre><code> ans-&gt;A = ans + sizeof(struct Test);\n</code></pre>\n</blockquote>\n\n<p>is wrong, because pointer arithmetic happens in units of the pointed type. You may want</p>\n\n<pre><code>   ans-&gt;A = ((char*)ans)+sizeof(struct Test);\n</code></pre>\n\n<p>and actually you should compute <code>mem_size</code> more carefully (using also <code>alignof</code> in it, or supposing that <code>alignof(long unsigned int) &gt;= alignof(double)</code> and so on) then prefer</p>\n\n<pre><code>   char* ad = malloc(mem_size);\n   if (!ad) return NULL;\n   ans = ad;\n   ans-&gt;A = ad + sizeof(struct Test);\n</code></pre>\n\n<p>The exact computation of <code>mem_size</code> (which needs some conditional and using <code>alignof</code>) and the real code is left as an exercise (I'm too lame to explain it here).</p>\n"}, {"tags": [], "owner": {"reputation": 4039, "user_id": 1397919, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/90c6f9c74ae14b8d63092782bd285ae7?s=128&d=identicon&r=PG", "display_name": "Dinesh", "link": "https://stackoverflow.com/users/1397919/dinesh"}, "is_accepted": false, "score": 3, "last_activity_date": 1505843414, "creation_date": 1505843414, "answer_id": 46306864, "question_id": 46306545, "link": "https://stackoverflow.com/questions/46306545/best-strategy-in-dynamic-allocation-in-c-for-strcut-with-many-pointers/46306864#46306864", "title": "Best strategy in dynamic allocation in C for strcut with many pointers", "body": "<p>In Plan A, you get memory fencing, architecture-specific memory alignment, ability to realloc. Of course one could refactor this a little bit so that error handling is not scattered all over - but that's a matter of personal style.</p>\n\n<p>In Plan B, you lose all that automatic stuff - you will have to take care of it. Then it might get very difficult to read.</p>\n\n<p>Depending on your allocator, you might have an easier time finding multiple smaller chunks of memory than one mega chunk. So, strategy-wise, you have to make your own decision - if you have your own allocator.</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1505851390, "post_id": 46307519, "comment_id": 79579724, "body": "For clearer code, could use <code>ans-&gt;A = malloc(sizeof *(ans-&gt;A) * size);</code>, etc.  No need for cast and size to the referenced data."}, {"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1505857833, "post_id": 46307519, "comment_id": 79582399, "body": "@chux you are right. Ty. Edited"}], "tags": [], "owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "is_accepted": false, "score": 1, "last_activity_date": 1505857765, "last_edit_date": 1505857765, "creation_date": 1505845939, "answer_id": 46307519, "question_id": 46306545, "link": "https://stackoverflow.com/questions/46306545/best-strategy-in-dynamic-allocation-in-c-for-strcut-with-many-pointers/46307519#46307519", "title": "Best strategy in dynamic allocation in C for strcut with many pointers", "body": "<p>Let me show you how to handle the error in a much cleaner way for your first case:</p>\n\n<pre><code>struct Test *alloc_test(long unsigned int size)\n{\n    struct Test *ans = malloc(sizeof(struct Test));\n    if(ans == NULL)\n    {\n        return NULL;\n    }\n\n    ans-&gt;size = size;\n    ans-&gt;A = malloc(sizeof(ans-&gt;A) * size);\n    ans-&gt;B = malloc(sizeof(ans-&gt;B) * size);\n    ans-&gt;C = malloc(sizeof(ans-&gt;C) * size);\n\n    if(ans-&gt;A == NULL || ans-&gt;B == NULL || ans-&gt;C == NULL)\n    {\n        free(ans-&gt;A);\n        free(ans-&gt;B);\n        free(ans-&gt;C);\n        free(ans);\n        return NULL;\n    }\n\n    return ans;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": false, "score": 0, "last_activity_date": 1505846167, "creation_date": 1505846167, "answer_id": 46307577, "question_id": 46306545, "link": "https://stackoverflow.com/questions/46306545/best-strategy-in-dynamic-allocation-in-c-for-strcut-with-many-pointers/46307577#46307577", "title": "Best strategy in dynamic allocation in C for strcut with many pointers", "body": "<p>You may not need to use multiple calls to <code>malloc()</code> or deal with alignment at all.</p>\n\n<p>If all the dynamically-allocated arrays will always have the same number of elements, use a <code>struct</code> that contains the actual <em>values</em>, and create an array of the <code>struct</code>:</p>\n\n<pre><code>typedef struct data\n{\n    double A;\n    double B;\n    int C;\n};\n</code></pre>\n\n<p>Allocation:</p>\n\n<pre><code>struct data *dataPtr = malloc( size * sizeof( *dataPtr ) );\n</code></pre>\n\n<p>Deallocation:</p>\n\n<pre><code>free( dataPtr );\n</code></pre>\n\n<p>Simple and easily understandable.</p>\n\n<p>If you need to carry the size around with the data, use a <code>struct</code> with a flexible array of <code>struct data</code>:</p>\n\n<pre><code>typedef struct test\n{\n    unsigned long size;\n    struct data[];\n}\n</code></pre>\n\n<p>Allocation:</p>\n\n<pre><code>struct test *testPtr = malloc( sizeof( *testPtr ) + size * sizeof( testPtr-&gt;data ) );\ntestPtr -&gt;size = size;\n</code></pre>\n\n<p>Deallocation:</p>\n\n<pre><code>free( testPtr );\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 1381021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1f814a8a77858132771c20ef104dc193?s=128&d=identicon&r=PG", "display_name": "Caio", "link": "https://stackoverflow.com/users/1381021/caio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "closed_date": 1505851102, "accepted_answer_id": 46306768, "answer_count": 4, "score": -1, "last_activity_date": 1505857765, "creation_date": 1505842234, "question_id": 46306545, "link": "https://stackoverflow.com/questions/46306545/best-strategy-in-dynamic-allocation-in-c-for-strcut-with-many-pointers", "closed_reason": "Opinion-based", "title": "Best strategy in dynamic allocation in C for strcut with many pointers", "body": "<p>I wonder what is the best strategy for alloc memory for a struct with many pointers within.</p>\n\n<p>Like this:</p>\n\n<pre><code>struct Test{\n    long unsigned int size;\n    double *A;\n    int *B;\n    double *C;\n};\n</code></pre>\n\n<p>Then I could use many allocations, like this:</p>\n\n<pre><code>struct Test *alloc_test(long unsigned int size){\n    struct Test *ans = (struct Test*)malloc(sizeof(struct Test));\n    if(ans == NULL){\n        return NULL;\n    }\n    ans-&gt;size = size;\n    ans-&gt;A = (double *)malloc(sizeof(double)*size);\n    if(ans-&gt;A == NULL){\n        free(ans);\n        return NULL;\n    }\n    ans-&gt;B = (int *)malloc(sizeof(int)*size);\n    if(ans-&gt;B == NULL){\n        free(ans-&gt;A);\n        free(ans);\n        return NULL;\n    }\n    ans-&gt;C = (double *)malloc(sizeof(double)*size);\n    if(ans-&gt;C == NULL){\n        free(ans-&gt;A);\n        free(ans-&gt;B);\n        free(ans);\n        return NULL;\n    }\n    return ans;\n}\n</code></pre>\n\n<p>Or I could usi a single allocation, like this:</p>\n\n<pre><code>struct Test *alloc_test(long unsigned int size){\n    long unsigned int mem_size = sizeof(struct Test) + sizeof(double)*2*size + sizeof(int)*size;\n    struct Test *ans = (struct Test*)malloc(mem_size);\n    if(ans == NULL){\n        return NULL;\n    }\n    ans-&gt;size = size;\n    ans-&gt;A = ans + sizeof(struct Test);\n    ans-&gt;B = ans-&gt;A + sizeof(double)*size;\n    ans-&gt;C = ans-&gt;B + sizeof(int)*size;\n    return ans;\n}\n</code></pre>\n\n<p>This is possible in that sittuation because this object shouldn't be realloced. In this case, does anyone knows the advantage of each one?</p>\n"}, {"tags": ["c", "linked-list", "singly-linked-list"], "comments": [{"owner": {"reputation": 35506, "user_id": 424129, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/067763e25885a77061483ece2443c527?s=128&d=identicon&r=PG&f=1", "display_name": "15ee8f99-57ff-4f92-890c-b56153", "link": "https://stackoverflow.com/users/424129/15ee8f99-57ff-4f92-890c-b56153"}, "edited": false, "score": 0, "creation_date": 1505841152, "post_id": 46306197, "comment_id": 79574404, "body": "Ankit, you can (at least partially) format your code here by selecting the entire block of code and pressing Ctrl+K."}, {"owner": {"reputation": 47412, "user_id": 3141234, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/78b45a835031f4ce03a6653b3262b5d3?s=128&d=identicon&r=PG", "display_name": "Alexander", "link": "https://stackoverflow.com/users/3141234/alexander"}, "edited": false, "score": 1, "creation_date": 1505841171, "post_id": 46306197, "comment_id": 79574411, "body": "You should really clean up the indentation and spacing on this. It&#39;s a mess."}, {"owner": {"reputation": 2988, "user_id": 452414, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rDMfs.png?s=128&g=1", "display_name": "babon", "link": "https://stackoverflow.com/users/452414/babon"}, "edited": false, "score": 1, "creation_date": 1505841623, "post_id": 46306197, "comment_id": 79574617, "body": "and you want to <code>free(head)</code> and set <code>head</code> to <code>NULL</code> when <code>(temp-&gt;next != NULL)</code>? Why?"}, {"owner": {"reputation": 49533, "user_id": 1057429, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XG8at.jpg?s=128&g=1", "display_name": "Nir Alfasi", "link": "https://stackoverflow.com/users/1057429/nir-alfasi"}, "edited": false, "score": 0, "creation_date": 1505841769, "post_id": 46306197, "comment_id": 79574688, "body": "you&#39;re checking the same condition in the <code>if</code> and in the <code>while</code> (under the <code>else</code> case). That means that the <code>while</code> will never get executed!"}, {"owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "edited": false, "score": 0, "creation_date": 1505842650, "post_id": 46306197, "comment_id": 79575153, "body": "You probably mean <code>if (temp-&gt;next == NULL) { free(head); head = NULL; }&#39;</code>. Wrong Boolean polarity in your test."}, {"owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "edited": false, "score": 0, "creation_date": 1505842743, "post_id": 46306197, "comment_id": 79575204, "body": "What if the list is already empty, and has no last node? You must consider all cases. The requirement &quot;delete the last node&quot; doesn&#39;t imply that the last node exists; computers are not people. You wouldn&#39;t ask a person to turn to the last page of a book that has no pages; but inside software, such things occur."}, {"owner": {"reputation": 11, "user_id": 7069427, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FCG6mabE6y0/AAAAAAAAAAI/AAAAAAAAAFI/4dId5PC9q48/photo.jpg?sz=128", "display_name": "Ankit Sharma", "link": "https://stackoverflow.com/users/7069427/ankit-sharma"}, "edited": false, "score": 0, "creation_date": 1506239227, "post_id": 46306197, "comment_id": 79733230, "body": "The problem with the code was with <b>if(temp-&gt;next==NULL)</b>. I used <b>if(temp-&gt;next!=NULL)</b> which was wrong. I figured this out later on."}], "answers": [{"comments": [{"owner": {"reputation": 1638, "user_id": 366956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dac48f00b4d8020a21400d54f8a5ff88?s=128&d=identicon&r=PG", "display_name": "Steve", "link": "https://stackoverflow.com/users/366956/steve"}, "edited": false, "score": 2, "creation_date": 1505841693, "post_id": 46306243, "comment_id": 79574654, "body": "You do need the condition or a link list with a single node will result in using an uninitialised prev pointer."}, {"owner": {"reputation": 368279, "user_id": 1288, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/fc763c6ff6c160ddad05741e87e517b6?s=128&d=identicon&r=PG", "display_name": "Bill the Lizard", "link": "https://stackoverflow.com/users/1288/bill-the-lizard"}, "reply_to_user": {"reputation": 1638, "user_id": 366956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dac48f00b4d8020a21400d54f8a5ff88?s=128&d=identicon&r=PG", "display_name": "Steve", "link": "https://stackoverflow.com/users/366956/steve"}, "edited": false, "score": 0, "creation_date": 1505841775, "post_id": 46306243, "comment_id": 79574692, "body": "@Steve Good point. My fault for not testing it out before making that suggestion."}], "tags": [], "owner": {"reputation": 368279, "user_id": 1288, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/fc763c6ff6c160ddad05741e87e517b6?s=128&d=identicon&r=PG", "display_name": "Bill the Lizard", "link": "https://stackoverflow.com/users/1288/bill-the-lizard"}, "is_accepted": false, "score": 1, "last_activity_date": 1505841720, "last_edit_date": 1505841720, "creation_date": 1505841234, "answer_id": 46306243, "question_id": 46306197, "link": "https://stackoverflow.com/questions/46306197/singly-linked-list-deleting-last-element/46306243#46306243", "title": "Singly Linked List deleting last element", "body": "<p>You're freeing the head node and setting it to null on the wrong condition.</p>\n\n<pre><code>if(temp-&gt;next!=NULL)\n</code></pre>\n\n<p>at the beginning should be </p>\n\n<pre><code>if(temp-&gt;next==NULL)\n</code></pre>\n\n<p>If the next node is <em>not</em> null, it means something is there and <code>temp</code> is not the last element.</p>\n"}, {"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 2, "last_activity_date": 1505842034, "creation_date": 1505842034, "answer_id": 46306487, "question_id": 46306197, "link": "https://stackoverflow.com/questions/46306197/singly-linked-list-deleting-last-element/46306487#46306487", "title": "Singly Linked List deleting last element", "body": "<p>There are 2 problems:</p>\n\n<ul>\n<li>the first test should be <code>if (temp-&gt;next == NULL)</code></li>\n<li>you should test if the list is empty before dereferencing <code>head</code> or <code>temp</code>.</li>\n</ul>\n\n<p>Here is a modified version:</p>\n\n<pre><code>void delete_last(void) {\n    if (head != NULL) {\n        Node *prev = NULL;\n        Node *temp = head;\n        while (temp-&gt;next != NULL) {\n            prev = temp;\n            temp = temp-&gt;next;\n        }\n        free(temp);\n        if (prev) {\n            prev-&gt;next = NULL;\n        } else {\n            head = NULL;\n        }\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 2, "last_activity_date": 1505844635, "last_edit_date": 1505844635, "creation_date": 1505842376, "answer_id": 46306583, "question_id": 46306197, "link": "https://stackoverflow.com/questions/46306197/singly-linked-list-deleting-last-element/46306583#46306583", "title": "Singly Linked List deleting last element", "body": "<p>For starters the function has undefined behavior in case when <code>head</code> is equal to <code>NULL</code> due to these statements</p>\n\n<pre><code>Node *temp = head, *prev;\n\nif (temp-&gt;next != NULL) {\n</code></pre>\n\n<p>And moreover the if statement with its sub-statement is logically incorrect.</p>\n\n<p>The function can look the following way</p>\n\n<pre><code>void delete_last() \n{\n    if ( head )\n    {\n        Node **last = &amp;head;\n\n        while ( ( *last )-&gt;next ) last = &amp;( *last )-&gt;next;\n\n        free( *last );\n        *last = NULL;\n    }\n}\n</code></pre>\n\n<p>Here is a demonstrative program</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct node\n{\n    int value;\n    struct node *next;\n} Node;\n\nNode *head;\n\nint push_front( int value )\n{\n    Node *new_node = malloc( sizeof( Node ) );\n    int success = new_node != NULL;\n\n    if ( success )\n    {\n        new_node-&gt;value = value;\n        new_node-&gt;next = head;\n        head = new_node;\n    }\n\n    return success;\n}\n\nvoid delete_last() \n{\n    if ( head )\n    {\n        Node **last = &amp;head;\n\n        while ( ( *last )-&gt;next ) last = &amp;( *last )-&gt;next;\n\n        free( *last );\n        *last = NULL;\n    }\n}\n\nvoid output()\n{\n    for ( Node *current = head; current; current = current-&gt;next )\n    {\n        printf( \"%d \", current-&gt;value );\n    }\n}\n\nint main(void) \n{\n    const int N = 10;\n\n    for ( int i = 0; i &lt; N; i++ )\n    {\n        push_front( i );\n        output();\n        putchar( '\\n' );\n    }\n\n    while ( head )\n    {\n        delete_last();\n        output();\n        putchar( '\\n' );\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Its output is</p>\n\n<pre><code>0 \n1 0 \n2 1 0 \n3 2 1 0 \n4 3 2 1 0 \n5 4 3 2 1 0 \n6 5 4 3 2 1 0 \n7 6 5 4 3 2 1 0 \n8 7 6 5 4 3 2 1 0 \n9 8 7 6 5 4 3 2 1 0 \n9 8 7 6 5 4 3 2 1 \n9 8 7 6 5 4 3 2 \n9 8 7 6 5 4 3 \n9 8 7 6 5 4 \n9 8 7 6 5 \n9 8 7 6 \n9 8 7 \n9 8 \n9 \n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7069427, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FCG6mabE6y0/AAAAAAAAAAI/AAAAAAAAAFI/4dId5PC9q48/photo.jpg?sz=128", "display_name": "Ankit Sharma", "link": "https://stackoverflow.com/users/7069427/ankit-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1505844726, "creation_date": 1505841026, "last_edit_date": 1505844726, "question_id": 46306197, "link": "https://stackoverflow.com/questions/46306197/singly-linked-list-deleting-last-element", "title": "Singly Linked List deleting last element", "body": "<p>When calling this function the whole of the List is being deleted. Here's my code.</p>\n\n<p><code>head</code> is a global variable.\n<code>struct node</code> is defined as <code>Node</code>.</p>\n\n<pre><code>void delete_last() {\n    Node *temp = head, *prev;\n\n    if (temp-&gt;next != NULL) {\n        free(head);\n        head = NULL;\n        return;\n    } else {\n        while (temp-&gt;next != NULL) {\n            prev = temp;\n            temp = temp-&gt;next;\n        }\n        free(temp);\n        prev-&gt;next = NULL;\n        return;\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "openmp", "icc", "intel-mic"], "comments": [{"owner": {"reputation": 80303, "user_id": 196561, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6836267883ea7234253b2100f222dbbc?s=128&d=identicon&r=PG", "display_name": "osgx", "link": "https://stackoverflow.com/users/196561/osgx"}, "edited": false, "score": 0, "creation_date": 1505949152, "post_id": 46306117, "comment_id": 79626881, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/14418908/openmp-parallel-for-with-floating-point-range\">OpenMP parallel for with floating-point range</a>"}], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 4953655, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9c46effeff92702f9de1a59e61fac7ac?s=128&d=identicon&r=PG&f=1", "display_name": "wasilis", "link": "https://stackoverflow.com/users/4953655/wasilis"}, "edited": false, "score": 0, "creation_date": 1505846295, "post_id": 46306857, "comment_id": 79576969, "body": "Actually the code includes multiple nested &quot;for loops&quot; in that way, and works fine in another edition of the code for parallelization in CUDA or in serial execution. So the only way to use correctly the OpenMP is to change the structure of my &quot;for loops&quot;. Thank you for your answer!"}, {"owner": {"reputation": 80303, "user_id": 196561, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6836267883ea7234253b2100f222dbbc?s=128&d=identicon&r=PG", "display_name": "osgx", "link": "https://stackoverflow.com/users/196561/osgx"}, "reply_to_user": {"reputation": 105, "user_id": 4953655, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9c46effeff92702f9de1a59e61fac7ac?s=128&d=identicon&r=PG&f=1", "display_name": "wasilis", "link": "https://stackoverflow.com/users/4953655/wasilis"}, "edited": false, "score": 1, "creation_date": 1505949752, "post_id": 46306857, "comment_id": 79627050, "body": "wasilis, check also <a href=\"http://www.openmp.org/wp-content/uploads/openmp-4.5.pdf#page=62\" rel=\"nofollow noreferrer\">openmp.org/wp-content/uploads/openmp-4.5.pdf#page=62</a> &quot;2.6 Canonical Loop Form&quot;, this is definition of loop form required after <code>#pragma omp for</code>, and only allowed are: integer type, random access iterator type (C++), and pointer type (and increment of ptrdiff_t type)"}], "tags": [], "owner": {"reputation": 80303, "user_id": 196561, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6836267883ea7234253b2100f222dbbc?s=128&d=identicon&r=PG", "display_name": "osgx", "link": "https://stackoverflow.com/users/196561/osgx"}, "is_accepted": false, "score": 4, "last_activity_date": 1505950445, "last_edit_date": 1505950445, "creation_date": 1505843399, "answer_id": 46306857, "question_id": 46306117, "link": "https://stackoverflow.com/questions/46306117/icc-compiler-error-parallel-loop-condition-does-not-test-loop-control-variabl/46306857#46306857", "title": "ICC compiler - error: parallel loop condition does not test loop control variable", "body": "<p>OpenMP requires loop variable to be of integer type:</p>\n\n<p><a href=\"http://www.openmp.org/wp-content/uploads/openmp-4.5.pdf#page=68\" rel=\"nofollow noreferrer\">http://www.openmp.org/wp-content/uploads/openmp-4.5.pdf#page=68</a></p>\n\n<blockquote>\n  <p>The syntax of the loop construct is as follows:</p>\n\n<pre><code>#pragma omp for  ...\n for-loops\n</code></pre>\n  \n  <p>...</p>\n  \n  <p>Specifically, all associated for-loops <strong>must have canonical loop form</strong> (see Section 2.6 on page 53).</p>\n  \n  <p>3 The iteration count for each associated loop is computed before entry to the outermost loop. If execution of any associated loop changes any of the values used to compute any of the iteration counts, then the behavior is unspecified.</p>\n  \n  <p>6 The integer type (or kind, for Fortran) used to compute the iteration count for the collapsed loop is  implementation defined.</p>\n</blockquote>\n\n<p>You can't use variables of floating type in openmp loop construction. Your first loop has <code>i</code> integer which is correct and second has <code>float</code> typed variable which is incorrect. Canonical loop form is defined in \"2.6 Canonical Loop Form\" - <a href=\"http://www.openmp.org/wp-content/uploads/openmp-4.5.pdf#page=62\" rel=\"nofollow noreferrer\">http://www.openmp.org/wp-content/uploads/openmp-4.5.pdf#page=62</a> as</p>\n\n<blockquote>\n<pre><code>for (init-expr; test-expr; incr-expr) structured-block\n...\nvar - One of the following:\n* A variable of a signed or unsigned integer type.\n* For C++, a variable of a random access iterator type.\n* For C, a variable of a pointer type\n\nincr-expr One of the following:\n ...\n* var += incr\n\n incr A loop invariant integer expression\n</code></pre>\n</blockquote>\n\n<p>and your second loop has not canonical form and can't be paralleled.</p>\n\n<pre><code>#pragma omp parallel for\nfor(x[0]=0.000000; x[0]&lt;10.000000; x[0]+=1.000000)\n</code></pre>\n\n<p>It will be hard to compiler to get loop iteration count in advance with floating point values of var and incr: some decimal constants can't be represented exactly in floating point format (for example, 0.2 in floating point is 0f3FC999999999999A; and 0.1 + 0.2 is 0.30000000000000004 in many languages, check <a href=\"https://0.30000000000000004.com/\" rel=\"nofollow noreferrer\">https://0.30000000000000004.com/</a>).</p>\n\n<p>You can try array of integers or <code>long</code>s or <code>long long</code>s:</p>\n\n<pre><code>#define MAX_DIMENSIONS  10\n\nlong long  x[MAX_DIMENSIONS];\nunsigned int i,y=0;\n\n#pragma offload target(mic) in(x[MAX_DIMENSIONS],i,y)\n{\n    #pragma omp parallel for\n    for(x[0]=0; x[0] &lt; 10; x[0] += 1)\n        /* code here */\n}\n</code></pre>\n\n<p>Or you can try to estimate correct loop count for floating point range before loop and then use integer iterators in parallel loop as var and incr (be sure to do correct rounding).</p>\n"}, {"comments": [{"owner": {"reputation": 80303, "user_id": 196561, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6836267883ea7234253b2100f222dbbc?s=128&d=identicon&r=PG", "display_name": "osgx", "link": "https://stackoverflow.com/users/196561/osgx"}, "edited": false, "score": 0, "creation_date": 1506055382, "post_id": 46340761, "comment_id": 79673748, "body": "Is doing N times of float increment (<code>float x; for(;i&lt;N;i++)x+=some_float_step</code>) always equal to (<code>int N = (b-a)&#47;step;</code>)? What about last iteration in case of non exact representation of step and high N?"}, {"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "reply_to_user": {"reputation": 80303, "user_id": 196561, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6836267883ea7234253b2100f222dbbc?s=128&d=identicon&r=PG", "display_name": "osgx", "link": "https://stackoverflow.com/users/196561/osgx"}, "edited": false, "score": 1, "creation_date": 1506082530, "post_id": 46340761, "comment_id": 79688367, "body": "@osgx, I think there are several cases where it&#39;s not equivalent actually. One of the most important is that <code>sum(x)</code> over n terms is not in general the same as <code>x*n</code> (i.e. repeated addition is not equivalent to multiplication) for floating point arithmetic. For integers this is not a problem but for floats it is. I just wanted to give an answer to show that it&#39;s possible to do work sharing with floating point iterators with OpenMP if one really really wants to do this."}, {"owner": {"reputation": 105, "user_id": 4953655, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9c46effeff92702f9de1a59e61fac7ac?s=128&d=identicon&r=PG&f=1", "display_name": "wasilis", "link": "https://stackoverflow.com/users/4953655/wasilis"}, "edited": false, "score": 0, "creation_date": 1507488375, "post_id": 46340761, "comment_id": 80218791, "body": "I really wanted to work with floating point iterators with OpenMP and that solution works perfect on my code. It was exactly what I needed. Thank you!"}, {"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "reply_to_user": {"reputation": 105, "user_id": 4953655, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9c46effeff92702f9de1a59e61fac7ac?s=128&d=identicon&r=PG&f=1", "display_name": "wasilis", "link": "https://stackoverflow.com/users/4953655/wasilis"}, "edited": false, "score": 1, "creation_date": 1507549573, "post_id": 46340761, "comment_id": 80240307, "body": "@wasilis, be aware that using floating point accumulators/iterators means that the number of iterations executed may depend on the number of threads since floating point arithmetic is not associative."}], "tags": [], "owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "is_accepted": true, "score": 2, "last_activity_date": 1505992546, "last_edit_date": 1505992546, "creation_date": 1505987380, "answer_id": 46340761, "question_id": 46306117, "link": "https://stackoverflow.com/questions/46306117/icc-compiler-error-parallel-loop-condition-does-not-test-loop-control-variabl/46340761#46340761", "title": "ICC compiler - error: parallel loop condition does not test loop control variable", "body": "<p>You can implement the working sharing manually like this</p>\n\n<pre><code>#pragma omp parallel\n{\n    float a = 0., b = 10.;\n    float step = 1.;\n    int N = (b-a)/step;\n    int ithread = omp_get_thread_num();\n    int nthreads = omp_get_num_threads();\n    float t0 = (ithread+0)*N/nthreads + a;\n    float t1 = (ithread+1)*N/nthreads + a;\n    for(float x=t0; x&lt;t1; x += step) {\n      //code\n    }\n}\n</code></pre>\n\n<p>This would be equivalent to </p>\n\n<pre><code>#pragma omp parallel for \nfor(float x=a; x&lt;b; x += step)\n</code></pre>\n\n<p>if the <code>omp for</code> construct supported floating point iterators. For other schedules such as dynamic you have to implement them differently. Note that it's possible the parallel code and then sequential code don't give the same result e.g. if <code>(b-a)/step</code> has a fractional part (but <code>(10.-0)/1. = 10.</code> is okay). Therefore it's probably best to change your code to use integer iterators to be safe.</p>\n"}], "owner": {"reputation": 105, "user_id": 4953655, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9c46effeff92702f9de1a59e61fac7ac?s=128&d=identicon&r=PG&f=1", "display_name": "wasilis", "link": "https://stackoverflow.com/users/4953655/wasilis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 510, "favorite_count": 0, "accepted_answer_id": 46340761, "answer_count": 2, "score": 1, "last_activity_date": 1507488338, "creation_date": 1505840761, "last_edit_date": 1507488338, "question_id": 46306117, "link": "https://stackoverflow.com/questions/46306117/icc-compiler-error-parallel-loop-condition-does-not-test-loop-control-variabl", "title": "ICC compiler - error: parallel loop condition does not test loop control variable", "body": "<p>I am trying to parallelize a \"for loop\" of my C/OpenMP code, after offload call on Intel MIC (Xeon Phi) card. I am using \"#pragma omp parallel for\" and it compiles good when I use an integer variable as \"loop control variable\". On my code I am using a float array as \"loop control variable\" and then I get the error \"parallel loop condition does not test loop control variable\".</p>\n\n<p>Code with no error:</p>\n\n<pre><code>#define MAX_DIMENSIONS  10\n\nunsigned long long  i,y=0;\n\n#pragma offload target(mic) in(i,y)\n{\n    #pragma omp parallel for\n    for(i=0;i&lt;10;i++)\n        /* code here */  \n}\n</code></pre>\n\n<p>Code with error:</p>\n\n<pre><code>#define MAX_DIMENSIONS  10\n\nfloat   x[MAX_DIMENSIONS];\nunsigned long long  i,y=0;\n\n#pragma offload target(mic) in(x[MAX_DIMENSIONS],i,y)\n{\n    #pragma omp parallel for\n    for(x[0]=0.000000; x[0]&lt;10.000000; x[0]+=1.000000)\n        /* code here */\n}\n</code></pre>\n\n<p>Is there any way to keep that float array notation in \"for loop\" in order to succeed the parallelization using OpenMP?</p>\n"}, {"tags": ["python", "c", "list", "argv"], "comments": [{"owner": {"reputation": 38371, "user_id": 3555845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e06f616d9a53b1ca18287d1049a28ee?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/3555845/daniel"}, "edited": false, "score": 0, "creation_date": 1505846238, "post_id": 46306031, "comment_id": 79576934, "body": "<code>argv</code> is not suitable for large data. Use interprocess communication, like pipes."}], "answers": [{"comments": [{"owner": {"reputation": 305, "user_id": 7801444, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/95ffc26f9e2c72941144dfc1d9abc50c?s=128&d=identicon&r=PG&f=1", "display_name": "PyCV", "link": "https://stackoverflow.com/users/7801444/pycv"}, "edited": false, "score": 0, "creation_date": 1505909861, "post_id": 46308012, "comment_id": 79604354, "body": "just an isignificant edit just in case someone tries to run the code. &#39;:&#39; missing in the penultimate line of the python code. Thanks for the answer."}], "tags": [], "owner": {"reputation": 1765, "user_id": 1106540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45196b9a98daeb606ee718a26e881b9b?s=128&d=identicon&r=PG", "display_name": "Ismael Luceno", "link": "https://stackoverflow.com/users/1106540/ismael-luceno"}, "is_accepted": true, "score": 2, "last_activity_date": 1505911331, "last_edit_date": 1505911331, "creation_date": 1505847786, "answer_id": 46308012, "question_id": 46306031, "link": "https://stackoverflow.com/questions/46306031/pass-list-of-list-from-python-to-c-as-uint64-t-matrix/46308012#46308012", "title": "Pass list of list from Python to C as uint64_t matrix", "body": "<p>There's many ways to do it, but the easiest is probably just flattening the matrix first:</p>\n\n<pre><code>def flatten(a):\n    yield len(a)\n    cols = max(len(i) for i in a)\n    yield cols\n    for i in a:\n        for j in i:\n            yield j\n        for j in range(0, cols - len(i)):\n            yield 0\n</code></pre>\n\n<p>Then you can use the result of that to feed the parameters to your C program, and from that you can build the matrix (C99 required):</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;inttypes.h&gt;\n\nvoid load_matrix(uint64_t *matrix, char **p, int alen) {\n    while (alen-- &gt; 0)\n        *matrix++ = atoi(*p++);\n}\n\nvoid do_work(uint64_t matrix[nrows][ncols], int nrows, int ncols) {\n    ...\n}\n\nint main(int argc, char **argv) {\n    int nrows = atoi(argv[1]), ncols = atoi(argv[2]);\n\n    // check ncols and nrows and argc\n    ...\n\n    uint64_t *matrix;\n    matrix = malloc(nrows * ncols * sizeof(*matrix));\n\n    // check matrix isn't NULL\n    ...\n\n    load_matrix(matrix, argv + 3, nrows * ncols);\n    do_work(matrix, nrows, ncols);\n    ...\n}\n</code></pre>\n\n<p>Keep in mind it's just an illustration, i.e. things like <code>atoi</code> aren't appropriate.</p>\n\n<p>If you want to use C89 you need to cope with a flat array, in the end it's the same thing.</p>\n\n<p>However, if the matrix is large, you don't really want that; you would serialize it in a similar way (perhaps with a more efficient implementation), but you would want to deal with binary data directly, and pass that through shared memory, a file, a socket, or a pipe to your C program, so there's no need for further processing.</p>\n\n<p>If you were working with a very large data set, then you definitely want to work with the same representation in both Python and C, and you probably want to use shared memory or files.</p>\n"}], "owner": {"reputation": 305, "user_id": 7801444, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/95ffc26f9e2c72941144dfc1d9abc50c?s=128&d=identicon&r=PG&f=1", "display_name": "PyCV", "link": "https://stackoverflow.com/users/7801444/pycv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 46308012, "answer_count": 1, "score": 0, "last_activity_date": 1505911331, "creation_date": 1505840438, "question_id": 46306031, "link": "https://stackoverflow.com/questions/46306031/pass-list-of-list-from-python-to-c-as-uint64-t-matrix", "title": "Pass list of list from Python to C as uint64_t matrix", "body": "<p>How can a list of list of numbers (uint64_t in C) for example: <code>a = [[1, 5, 9], [4, 6, 7], [8, 2, 3]]</code> be passed as an argument of a C program (via argv) and then be printed (or be able to access that data) in the C program as a 2D matrix?</p>\n\n<p>In my C program I'm working with non-predefined size matrices of unint64_t type (<code>uint64_t matrix[nrows][ncols]</code>)</p>\n"}, {"tags": ["c", "gcc", "makefile", "ld"], "comments": [{"owner": {"reputation": 985, "user_id": 6531241, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/XySrX.jpg?s=128&g=1", "display_name": "Karim Manaouil", "link": "https://stackoverflow.com/users/6531241/karim-manaouil"}, "edited": false, "score": 0, "creation_date": 1505841383, "post_id": 46305756, "comment_id": 79574500, "body": "Check out this utility called <a href=\"https://nixos.org/patchelf.html\" rel=\"nofollow noreferrer\">patchelf</a>. It is used to change dynamic linker &amp; RPATH of ELF binaries."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user3312948"}, "edited": false, "score": 0, "creation_date": 1505846395, "post_id": 46306749, "comment_id": 79577035, "body": "Thank you, I know about chroot, but what I exactly want to do is building my own distro with a different directory structure, this is why I need to prefix. I wanna move all:/etc,/lib,/lib64, ... to:/linux/etc,/linux/lib,/linux/lib64, ... This is why I need to prefix, I thought this is what rpath does. now I didn&#39;t get my answer, what shoul I do?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1505858302, "post_id": 46306749, "comment_id": 79582558, "body": "@MerajSahebdar, to the best of my knowledge, there is <i>nothing</i> that does exactly what you describe. To build your own distro with the layout you like, you&#39;ll need to build substantially everything from scratch.  Chroot is not what you want for the final product, but it could be a big piece of getting from here to there.  You could consider reading <a href=\"http://www.linuxfromscratch.org/lfs/read.html\" rel=\"nofollow noreferrer\">Linux from Scratch</a>.  Even if you don&#39;t follow exactly their recipe, it has a lot of information that you might find useful."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 0, "last_activity_date": 1505843417, "last_edit_date": 1505843417, "creation_date": 1505842950, "answer_id": 46306749, "question_id": 46305756, "link": "https://stackoverflow.com/questions/46305756/setting-shared-libraries-prefix-when-compiling/46306749#46306749", "title": "Setting shared libraries prefix when compiling", "body": "<p>The <code>-rpath</code> option does not specify a <em>prefix</em> for individual directories in the search path; rather, it specifies a colon-delimited list of <em>paths</em>.  The dynamic linker searches these directories first, but it continues on to the rest of the search path if it needs to do.  Thus, if you want the dynamic linker to resolve <code>libc.so.6</code> to <code>/pathtolib/lib/x86_64-linux-gnu/libc.so.6</code>, then you must specify not <code>/pathtolib</code> but <code>/pathtolib/lib/x86_64-linux-gnu</code> in your <code>rpath</code>.</p>\n\n<p>I am not aware of a link option or ELF header field that would instruct the dynamic linker to do what you seem to be asking: to modify the standard library search path by prefixing each element.  If you want to do something like that, then you probably need to provide your own dynamic linker.</p>\n\n<p>Alternatively, perhaps you want to construct and use a <a href=\"https://en.wikipedia.org/wiki/Chroot\" rel=\"nofollow noreferrer\">chroot</a> environment instead of of messing with rpaths.  That requires considerably more work to set up, but it would have the effect of allowing you to use a whole different set of libraries.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user3312948"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "accepted_answer_id": 46306749, "answer_count": 1, "score": 0, "last_activity_date": 1505843417, "creation_date": 1505839452, "question_id": 46305756, "link": "https://stackoverflow.com/questions/46305756/setting-shared-libraries-prefix-when-compiling", "title": "Setting shared libraries prefix when compiling", "body": "<p>I'm trying to compile a program, I need to set a prefix path on shared library path, I try using <code>-Wl,-rpath -Wl,-dynamic-linker</code> and what I got from <code>ldd</code> was:</p>\n\n<pre><code>linux-vdso.so.1 =&gt;  (0x00007fff75336000)\nlibc.so.6 =&gt; /lib/x86_64-linux-gnu/libc.so.6 (0x00007f19d55b8000)\n/pathtolib/lib64/ld-linux-x86-64.so.2 =&gt; /lib64/ld-linux-x86-64.so.2 (0x000055d3d67e1000)\n</code></pre>\n\n<p>but what I expecting to get was:</p>\n\n<pre><code>linux-vdso.so.1 =&gt;  (0x00007fff75336000)\nlibc.so.6 =&gt; /pathtolib/lib/x86_64-linux-gnu/libc.so.6 (0x00007f19d55b8000)\n/pathtolib/lib64/ld-linux-x86-64.so.2 =&gt; /lib64/ld-linux-x86-64.so.2 (0x000055d3d67e1000)\n</code></pre>\n\n<p>I really need to setup this and force program to use non-default path (/<strong>pathtolib</strong>) for all shared libraries.</p>\n\n<p>this is the command I used to compile:</p>\n\n<pre><code>gcc list/list.c -o bin/list -Wl,-rpath,/pathtolib -Wl,--dynamic-linker,/pathtolib/lib64/ld-linux-x86-64.so.2\n</code></pre>\n\n<hr>\n\n<p>what did I do wrong?!! :|</p>\n"}, {"tags": ["c", "string", "algorithm", "function", "pointers"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1505838429, "post_id": 46305396, "comment_id": 79573112, "body": "Upper case letters are lexicographically less than lower case. Use <code>tolower</code> on everything to ignore the case."}, {"owner": {"reputation": 1325, "user_id": 8055063, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/fUn28.png?s=128&g=1", "display_name": "Bite Bytes", "link": "https://stackoverflow.com/users/8055063/bite-bytes"}, "edited": false, "score": 0, "creation_date": 1505838445, "post_id": 46305396, "comment_id": 79573120, "body": "maybe because <code>strcmp</code> is case sensitive?"}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1505838500, "post_id": 46305396, "comment_id": 79573153, "body": "But @EugeneSh. skylight reports that the input is only with Case letters: <code>Peter Paul John Mary</code>."}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1505838749, "post_id": 46305396, "comment_id": 79573280, "body": "skylight, can you please provide a complete working minimal example? I wonder how you use <code>first</code> and <code>last</code> too."}, {"owner": {"reputation": 8660, "user_id": 5749570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d2d0247d580de0aae4511d84551f10?s=128&d=identicon&r=PG&f=1", "display_name": "VHS", "link": "https://stackoverflow.com/users/5749570/vhs"}, "edited": false, "score": 0, "creation_date": 1505839093, "post_id": 46305396, "comment_id": 79573448, "body": "You need to provide more code so that we can verify it."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1505903914, "post_id": 46305396, "comment_id": 79600396, "body": "Your code is incomplete; in particular, it seems to be missing a <code>main()</code> function and at least one <code>#include</code>. Please <a href=\"https://stackoverflow.com/posts/46305396/edit\">edit</a> your code so it&#39;s a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> of your problem, then we can try to reproduce and solve it. You should also read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>."}], "answers": [{"comments": [{"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1505838602, "post_id": 46305493, "comment_id": 79573203, "body": "skylight reports that the input is only with Case letters: <code>Peter Paul John Mary</code>"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "reply_to_user": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1505839984, "post_id": 46305493, "comment_id": 79573860, "body": "@gsamaras that isn&#39;t what is in the question, it clearly has &quot;But when i type with small letter, the output is perfect.&quot; in it."}, {"owner": {"reputation": 69, "user_id": 7438683, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/96471eca7d3852da9a344bb54f46d3e9?s=128&d=identicon&r=PG&f=1", "display_name": "skylight", "link": "https://stackoverflow.com/users/7438683/skylight"}, "edited": false, "score": 0, "creation_date": 1505889296, "post_id": 46305493, "comment_id": 79591141, "body": "this works. However when i enter one name, my first name returns ? and my last name return the input name. for eg: i enter peter, my first name is ? with a box and last name is peter @christurner"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "reply_to_user": {"reputation": 69, "user_id": 7438683, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/96471eca7d3852da9a344bb54f46d3e9?s=128&d=identicon&r=PG&f=1", "display_name": "skylight", "link": "https://stackoverflow.com/users/7438683/skylight"}, "edited": false, "score": 0, "creation_date": 1505896597, "post_id": 46305493, "comment_id": 79595588, "body": "@skylight the problem is you&#39;ve not shared enough of your code to identify where the problem is - how do you initialise <code>first</code> and <code>last</code> for example? Adding <code>*first=&#39;\\0&#39;; *last=&#39;\\0&#39;</code> at the start of <code>findMinMaxStr</code> would ensure they&#39;re at least empty strings to start with"}, {"owner": {"reputation": 69, "user_id": 7438683, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/96471eca7d3852da9a344bb54f46d3e9?s=128&d=identicon&r=PG&f=1", "display_name": "skylight", "link": "https://stackoverflow.com/users/7438683/skylight"}, "edited": false, "score": 0, "creation_date": 1505899175, "post_id": 46305493, "comment_id": 79597240, "body": "Okay i have edited my code. please take a look.Thanks @ChrisTurner"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "reply_to_user": {"reputation": 69, "user_id": 7438683, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/96471eca7d3852da9a344bb54f46d3e9?s=128&d=identicon&r=PG&f=1", "display_name": "skylight", "link": "https://stackoverflow.com/users/7438683/skylight"}, "edited": false, "score": 0, "creation_date": 1505900155, "post_id": 46305493, "comment_id": 79597927, "body": "@skylight yes, it&#39;s as expected - you&#39;re not initialising <code>first</code> or <code>last</code>"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1505903886, "post_id": 46305493, "comment_id": 79600384, "body": "<code>strcasecmp</code> isn&#39;t standard C - it might not be available on non-POSIX systems."}], "tags": [], "owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "is_accepted": true, "score": 0, "last_activity_date": 1505838524, "creation_date": 1505838524, "answer_id": 46305493, "question_id": 46305396, "link": "https://stackoverflow.com/questions/46305396/string-first-and-last-name-in-alphabetical-with-capital-letter/46305493#46305493", "title": "String - first and last name in alphabetical with capital letter", "body": "<p><code>strcmp</code> is case sensitive so \"Peter\" and \"peter\" are considered different. Instead you want to use <code>strcasecmp</code> as that will ignore the case of characters.</p>\n"}, {"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 1, "last_activity_date": 1505840986, "creation_date": 1505840986, "answer_id": 46306184, "question_id": 46305396, "link": "https://stackoverflow.com/questions/46305396/string-first-and-last-name-in-alphabetical-with-capital-letter/46306184#46306184", "title": "String - first and last name in alphabetical with capital letter", "body": "<p>There are some problems with your approach:</p>\n\n<ul>\n<li>You do not initialize <code>first</code>, nor <code>last</code>: comparing <code>word[i]</code> to an uninitialized array has undefined behavior.</li>\n<li>You only update <code>first</code> or <code>last</code>, but not both. If there is only one word, <code>first</code> <strong>and</strong> <code>last</code> should receive the only word.</li>\n<li><code>strcmp()</code> is case sensitive. If you want to determine the first and last names in a case insensitive way, you must write more code. A simplistic approach can be achieved with <code>tolower()</code> from <code>&lt;ctype.h&gt;</code> but a complete solution requires in depth understanding of rules for collation of names, which is very complex and locale specific.</li>\n</ul>\n\n<p>Here is a simplistic approach:</p>\n\n<pre><code>#include &lt;ctype.h&gt;\n\nint strcasecmp(const char *s1, const char *s2) {\n    for (;;) {\n        unsigned char c1 = tolower((unsigned char)*s1++);\n        unsigned char c2 = tolower((unsigned char)*s2++);\n        if (c1 != c2) {\n            return c1 &lt; c2 ? -1 : 1;\n        }\n        if (c1 == '\\0') {\n            return 0;\n        }\n    }\n}           \n\nvoid findMinMaxStr(char word[][40], char *first, char *last, int size) {\n    int k;\n\n    *first = *last = '\\0';\n    if (size &gt; 0) {\n        strcpy(first, word[0]);\n        strcpy(last, word[0]);\n        for (k = 1; k &lt; size; k++) {\n            if (strcasecmp(last, word[k]) &lt; 0) {\n                strcpy(last, word[k]);\n            } else\n            if (strcasecmp(first, word[k]) &gt; 0) { \n                strcpy(first, word[k]);\n            }\n        }\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 69, "user_id": 7438683, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/96471eca7d3852da9a344bb54f46d3e9?s=128&d=identicon&r=PG&f=1", "display_name": "skylight", "link": "https://stackoverflow.com/users/7438683/skylight"}, "edited": false, "score": 0, "creation_date": 1505889410, "post_id": 46306338, "comment_id": 79591208, "body": "i cant hardcode the names because the users have to enter how many names they want and type the name . for eg: enter size: 4; enter the 4 names: peter paul john mary; or enter size:2; enter the 2 names: peter paul @vlad"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 69, "user_id": 7438683, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/96471eca7d3852da9a344bb54f46d3e9?s=128&d=identicon&r=PG&f=1", "display_name": "skylight", "link": "https://stackoverflow.com/users/7438683/skylight"}, "edited": false, "score": 0, "creation_date": 1505900502, "post_id": 46306338, "comment_id": 79598174, "body": "@skylight It is a demonstrative program that shows the function in action. You can write any code using the function."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 0, "last_activity_date": 1505841547, "creation_date": 1505841547, "answer_id": 46306338, "question_id": 46305396, "link": "https://stackoverflow.com/questions/46305396/string-first-and-last-name-in-alphabetical-with-capital-letter/46306338#46306338", "title": "String - first and last name in alphabetical with capital letter", "body": "<p>From the presented code it is unclear how the arguments that correspond to the parameters <code>first</code> and <code>last</code> were declared and initialized.</p>\n\n<p>But in any case the function should not do coping.</p>\n\n<p>It can look the following way</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n#define N   40\n\nvoid findMinMaxStr( char word[][N], size_t size, char **first, char **last ) \n{\n    *first = *last = word[0];\n\n    for ( size_t i = 0; i &lt; size; i++ ) \n    {\n        if ( strcmp( word[i], *first ) &lt; 0 )\n        {\n            *first = word[i];\n        }\n        else if ( strcmp( *last, word[i] ) &lt; 0 )\n        {\n            *last = word[i];\n        }\n    }\n}\n\nint main(void) \n{\n    char word[][N] = { \"Peter\",  \"Paul\",  \"John\", \"Mary\" };\n    char *first, *last;\n\n    findMinMaxStr( word, sizeof( word ) / sizeof( *word ), &amp;first, &amp;last );\n\n    printf( \"First = \\\"%s\\\", last = \\\"%s\\\"\\n\", first, last );\n\n    return 0;\n}\n</code></pre>\n\n<p>The program output is</p>\n\n<pre><code>First = \"John\", last = \"Peter\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": false, "score": 0, "last_activity_date": 1505899621, "last_edit_date": 1505899621, "creation_date": 1505899252, "answer_id": 46318083, "question_id": 46305396, "link": "https://stackoverflow.com/questions/46305396/string-first-and-last-name-in-alphabetical-with-capital-letter/46318083#46318083", "title": "String - first and last name in alphabetical with capital letter", "body": "<p>Initialize <code>first</code> and <code>last</code> to <code>word[0]</code> and the start of your function, like this:</p>\n\n<pre><code>strcpy(first, word[0]);\nstrcpy(last, word[0]);\n</code></pre>\n\n<p>Then for an input of <code>Peter Paul john Mary</code>, you would get:</p>\n\n<blockquote>\n  <p>First word = Mary, Last word = john</p>\n</blockquote>\n\n<p>which is correct since upper case letters are lexicographically greater than the lower ones.</p>\n\n<p>For an input of <code>Peter Paul John Mary</code>, you should get:</p>\n\n<blockquote>\n  <p>First word = John, Last word = Peter</p>\n</blockquote>\n\n<p>which is also correct.</p>\n"}], "owner": {"reputation": 69, "user_id": 7438683, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/96471eca7d3852da9a344bb54f46d3e9?s=128&d=identicon&r=PG&f=1", "display_name": "skylight", "link": "https://stackoverflow.com/users/7438683/skylight"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 450, "favorite_count": 0, "accepted_answer_id": 46305493, "answer_count": 4, "score": 1, "last_activity_date": 1505900611, "creation_date": 1505838176, "last_edit_date": 1505900611, "question_id": 46305396, "link": "https://stackoverflow.com/questions/46305396/string-first-and-last-name-in-alphabetical-with-capital-letter", "title": "String - first and last name in alphabetical with capital letter", "body": "<p>I need to arrange the names accordingly in alphabetical order. I managed to get the desired output. However, when I type the name with first cap, eg: Peter, the output is different. </p>\n\n<p>EG input: <code>Peter Paul John Mary</code></p>\n\n<p>EG output: <code>First word = John, Last word = d</code></p>\n\n<p>But when I type with small letter, the output is perfect. </p>\n\n<p>Here is my code:</p>\n\n<pre><code>void findMinMaxStr(char word[][40], char *first, char *last, int size);\n\nint main() {\n    char word[SIZE][40];\n    char first[40], last[40];\n    int i, size;\n\n    printf(\"Enter size: \\n\");\n    scanf(\"%d\", &amp;size);\n    printf(\"Enter %d words: \\n\", size);\n    for (i = 0; i &lt; size; i++)\n        scanf(\"%s\", word[i]);\n\n    findMinMaxStr(word, first, last, size);\n    printf(\"First word = %s, Last word = %s\\n\", first, last);\n    return 0;\n}\n\nvoid findMinMaxStr(char word[][40], char *first, char *last, int size) {\n    /* Write your program code here */\n    int k, l;\n\n    for (k = 0; k &lt; size; k++) {\n        if (strcmp(word[k], last) &gt; 0) {\n            strcpy(last, word[k]);\n        } else\n        if (strcmp(word[k], first) &lt; 0) { \n            strcpy(first, word[k]);\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "winapi", "gpo"], "comments": [{"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 2, "creation_date": 1505851192, "post_id": 46305094, "comment_id": 79579618, "body": "the guids is listed at <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\GPExtensions</code>. for example - <a href=\"https://blogs.technet.microsoft.com/mempson/2010/12/01/group-policy-client-side-extension-list/\" rel=\"nofollow noreferrer\"><i>Group Policy Client Side Extension List</i></a>. the <code>GetAppliedGPOList</code> is looked under <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion&zwnj;&#8203;\\Group Policy\\History\\{GuidExtension}</code> key"}], "answers": [{"tags": [], "owner": {"reputation": 236, "user_id": 5376639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e027141f345e8a3070c9813d6e74fd?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Shchyrov", "link": "https://stackoverflow.com/users/5376639/anton-shchyrov"}, "is_accepted": false, "score": 0, "last_activity_date": 1531482658, "creation_date": 1531482658, "answer_id": 51324473, "question_id": 46305094, "link": "https://stackoverflow.com/questions/46305094/getappliedgpolist-and-pguidextension-value/51324473#51324473", "title": "GetAppliedGPOList and pGuidExtension value", "body": "<p>The guids is listed at </p>\n\n<pre><code>HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\GPExtensions\n</code></pre>\n\n<p>For example - <a href=\"https://blogs.technet.microsoft.com/mempson/2010/12/01/group-policy-client-side-extension-list/\" rel=\"nofollow noreferrer\">Group Policy Client Side Extension List</a>. The <code>GetAppliedGPOList</code> is looked under </p>\n\n<pre><code>HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Group Policy\\History\\{GuidExtension}\n</code></pre>\n\n<p>key</p>\n"}], "owner": {"reputation": 743, "user_id": 2355322, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/2wRIw.jpg?s=128&g=1", "display_name": "Sergio Calderon", "link": "https://stackoverflow.com/users/2355322/sergio-calderon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 212, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1531482658, "creation_date": 1505837239, "question_id": 46305094, "link": "https://stackoverflow.com/questions/46305094/getappliedgpolist-and-pguidextension-value", "title": "GetAppliedGPOList and pGuidExtension value", "body": "<p>I'm trying to use the <code>GetAppliedGPOList</code> function, but cannot find/understand what the <code>pGuidExtension</code> should be. </p>\n\n<p>Here's the simple code so far:</p>\n\n<pre><code>#include &lt;Windows.h&gt;\n#include &lt;UserEnv.h&gt;\n\nint wmain(int argc, WCHAR *argv[])\n{\n    //GetAppliedGPOList\n    DWORD flags = GPO_LIST_FLAG_MACHINE;\n    LPCWSTR machineName = NULL; //Local computer is used\n    PSID sidUser = NULL;\n\n    GUID *pGuidExtension;   //What is the GUID of the extension?\n\n    PGROUP_POLICY_OBJECT *ppGPOList;\n\n\n    return 0;\n}\n</code></pre>\n\n<p>Cannot run the function because I need to send that value.</p>\n\n<p>Any example about the <code>pGuidExtension</code> value?</p>\n\n<p>I did search here but found nothing about it.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["c", "arrays", "loops", "byte"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1505837363, "post_id": 46305080, "comment_id": 79572504, "body": "Your current code seem to me  like accessing array out of bounds. You know arrays are 0-based, don&#39;t you?"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1505838726, "post_id": 46305080, "comment_id": 79573275, "body": "The first byte of the buffer is not used? (<code>data_buffer[0]</code>)"}, {"owner": {"reputation": 672, "user_id": 5380436, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9674ebda3418199550aa56d2b3b04231?s=128&d=identicon&r=PG&f=1", "display_name": "Indigo", "link": "https://stackoverflow.com/users/5380436/indigo"}, "edited": false, "score": 0, "creation_date": 1505841818, "post_id": 46305080, "comment_id": 79574712, "body": "The first byte of the buffer contains a flag noting the type of data that follows. But I suppose yes, I am going out of bounds at the end."}], "answers": [{"tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": false, "score": 1, "last_activity_date": 1505837534, "last_edit_date": 1505837534, "creation_date": 1505837282, "answer_id": 46305113, "question_id": 46305080, "link": "https://stackoverflow.com/questions/46305080/read-from-array-two-bytes-at-a-time/46305113#46305113", "title": "Read from array two bytes at a time?", "body": "<p>Simply use a <code>uint16_t</code> instead, which is 2 bytes per element,</p>\n\n<pre><code>uint16_t data_buffer[32];\n</code></pre>\n\n<p>be careful with endianness if it can be a problem.</p>\n\n<p><strong>Note</strong>: it appears that you don't know that arrays are 0 indexed, so</p>\n\n<pre><code>for (int i = 1; i &lt; BUFFER_LEN + 1; i += 2)\n</code></pre>\n\n<p>shoul probably be (<em>most likely</em>),</p>\n\n<pre><code>for (int i = 0; i &lt; BUFFER_LEN; i += 2)\n</code></pre>\n\n<p>And in case you do what I suggest, then each element is 2 bytes so you'd need half the number of elements and of course you would increment <code>i</code> by 1</p>\n\n<pre><code>for (int i = 0; i &lt; BUFFER_LEN; ++i)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1505838439, "post_id": 46305128, "comment_id": 79573117, "body": "There may be a big/little endian problem here. Did you check that?"}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1505909011, "post_id": 46305128, "comment_id": 79603747, "body": "@PaulOgilvie, why? he is checking for <code>0xffff</code> which happens to be the same representation in little/big endian."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "reply_to_user": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1505918811, "post_id": 46305128, "comment_id": 79611010, "body": "@LuisColorado, If it would only concern <code>0xffff</code> then there would be no problem. Would that only be one use or example then there may be a problem which is not covered by the solution, nor does the solution indicate this assumption/limitation."}], "tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": true, "score": 2, "last_activity_date": 1505837691, "last_edit_date": 1505837691, "creation_date": 1505837331, "answer_id": 46305128, "question_id": 46305080, "link": "https://stackoverflow.com/questions/46305080/read-from-array-two-bytes-at-a-time/46305128#46305128", "title": "Read from array two bytes at a time?", "body": "<p>Change this:</p>\n\n<pre><code>uint8_t data_buffer[64];\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>uint16_t data_buffer[32];\n</code></pre>\n\n<p><a href=\"http://en.cppreference.com/w/cpp/types/integer\" rel=\"nofollow noreferrer\"><code>uint_16_t</code></a> uses 2 bytes (16 bits) per element (and adjust the size to half of 64).</p>\n\n<hr>\n\n<p>PS: Your code seems to access an array out of bounds, which invokes <em>Undefined Behavior</em>, here:</p>\n\n<pre><code>for(int i = 1; i &lt; BUFFER_LEN + 1; i += 2)\n</code></pre>\n\n<p>Array indexing starts from 0, so this should start from 0 and the condition should be <code>i &lt; BUFFER_LEN</code>.</p>\n\n<p>However, with my appraoch, you don't need to increment by two, so you simply do a clean for loop, like this:</p>\n\n<pre><code>for(int i = 0; i &lt; BUFFER_LEN; ++i)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 47412, "user_id": 3141234, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/78b45a835031f4ce03a6653b3262b5d3?s=128&d=identicon&r=PG", "display_name": "Alexander", "link": "https://stackoverflow.com/users/3141234/alexander"}, "is_accepted": false, "score": 0, "last_activity_date": 1505837447, "creation_date": 1505837447, "answer_id": 46305160, "question_id": 46305080, "link": "https://stackoverflow.com/questions/46305080/read-from-array-two-bytes-at-a-time/46305160#46305160", "title": "Read from array two bytes at a time?", "body": "<p>You can combine the two <code>uint8_t</code> elements into a single <code>uint16_t</code> by bhtshifting:</p>\n\n<pre><code>for (int i = 1; i &lt; BUFFER_LEN + 1; i += 2) {\n    uint16_t pair = data_buffer[i] &lt;&lt; 8 | data_buffer[i+1];\n    LEDState newLEDState = (pair == 0xffff) ? OFF : ON; // replace \"LEDState\" with the proper type\n    write_led_states(i/2 + 1, newLEDState);\n}\n</code></pre>\n"}], "owner": {"reputation": 672, "user_id": 5380436, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9674ebda3418199550aa56d2b3b04231?s=128&d=identicon&r=PG&f=1", "display_name": "Indigo", "link": "https://stackoverflow.com/users/5380436/indigo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 822, "favorite_count": 0, "accepted_answer_id": 46305128, "answer_count": 3, "score": 2, "last_activity_date": 1505841385, "creation_date": 1505837200, "last_edit_date": 1505837760, "question_id": 46305080, "link": "https://stackoverflow.com/questions/46305080/read-from-array-two-bytes-at-a-time", "title": "Read from array two bytes at a time?", "body": "<p>I declare an array </p>\n\n<pre><code>uint8_t data_buffer[64];\n</code></pre>\n\n<p>I write into it, and then I need to iterate over it looking at the data it stores. The data is written in groups of two.</p>\n\n<p>Right now I am doing something messy like this</p>\n\n<pre><code>for(int i = 1; i &lt; BUFFER_LEN + 1; i += 2)\n{\n    if(data_buffer[i] == 0xff &amp;&amp; data_buffer[i+1] == 0xff)\n    {\n        write_led_states(i/2 + 1, OFF);\n    }\n    else\n    {\n        write_led_states(i/2 + 1, ON);\n    }\n}\n</code></pre>\n\n<p>But I'd much prefer to be able to read two bytes of data at a time from the buffer so I could do something more like this:</p>\n\n<pre><code>for(int i = 1; i &lt; BUFFER_LEN + 1; i++)\n{\n    if(data_buffer[i] == 0xffff) // where data_buffer is being read two bytes at a time\n    {\n        write_led_states(i, OFF);\n    }\n    else\n    {\n        write_led_states(i, ON);\n    }\n}\n</code></pre>\n\n<p>Another way of saying what I want to do is to remap the indices so they go from looking like this:</p>\n\n<pre><code>[1][2][3][4][5][6][7][8]\n</code></pre>\n\n<p>to like this:</p>\n\n<pre><code>[1...][2...][3...][4...]\n</code></pre>\n\n<p>Is this possible?</p>\n"}, {"tags": ["c", "gcc", "linker", "lto"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1505837119, "post_id": 46304742, "comment_id": 79572366, "body": "Not sure what&#39;s exactly going on, but you are aware the objects the symbols designate (function?!) might not even exist anymore after re-compilation? For a debug-build, don&#39;t use LTO and use <code>-Og</code>"}, {"owner": {"reputation": 2118, "user_id": 293003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/7256049d410aa28c240527e1a779799e?s=128&d=identicon&r=PG", "display_name": "Nikratio", "link": "https://stackoverflow.com/users/293003/nikratio"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1505841968, "post_id": 46304742, "comment_id": 79574793, "body": "I don&#39;t understand your comment. What do you mean with &quot;re-compilation&quot;? I am compiling only once. And why should the function cease to exist? I am creating a shared object, so LTO ought to leave exported symbols well alone."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1505842036, "post_id": 46304742, "comment_id": 79574831, "body": "&quot;What do you mean with &quot;re-compilation&quot;? I am compiling only once.&quot; Before using a feature like LTO, it is always good to know what that actually does."}, {"owner": {"reputation": 2118, "user_id": 293003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/7256049d410aa28c240527e1a779799e?s=128&d=identicon&r=PG", "display_name": "Nikratio", "link": "https://stackoverflow.com/users/293003/nikratio"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1505843458, "post_id": 46304742, "comment_id": 79575533, "body": "Oh, that&#39;s what you mean. Still, my question stands: why should the function cease to exist?"}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1505849138, "post_id": 46304742, "comment_id": 79578573, "body": "Maybe try <code>#  define DLLEXPORT __attribute__((visibility(&quot;default&quot;),externally_visible))</code>"}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1505849165, "post_id": 46304742, "comment_id": 79578590, "body": "And then <code>DLLEXPORT int fun1(void)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 2118, "user_id": 293003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/7256049d410aa28c240527e1a779799e?s=128&d=identicon&r=PG", "display_name": "Nikratio", "link": "https://stackoverflow.com/users/293003/nikratio"}, "edited": false, "score": 1, "creation_date": 1505993440, "post_id": 46331820, "comment_id": 79645372, "body": "According to Drepper&#39;s &quot;How To Write Shared Libraries&quot; (which I consider pretty authoritative), the version script is correct as-is. It&#39;s interesting that the &quot;externally_visible&quot; fix works, but before I rely on it I&#39;d like to make sure that this is actually the right solution. Is this documented anywhere? After all, changing the version script or not using LTO also makes the symbol visible, but neither of that is truly solving the problem."}, {"owner": {"reputation": 26934, "user_id": 8316315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d833a8a46fea39d7bfca1540ea9c07?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Weimer", "link": "https://stackoverflow.com/users/8316315/florian-weimer"}, "edited": false, "score": 1, "creation_date": 1546634654, "post_id": 46331820, "comment_id": 94927075, "body": "I agree that not exporting the aliased definitions under the non-aliased names should be fine."}], "tags": [], "owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "is_accepted": false, "score": 3, "last_activity_date": 1594758056, "last_edit_date": 1594758056, "creation_date": 1505941792, "answer_id": 46331820, "question_id": 46304742, "link": "https://stackoverflow.com/questions/46304742/how-to-combine-lto-with-symbol-versioning/46331820#46331820", "title": "How to combine LTO with symbol versioning", "body": "<p>It looks like my <code>externally_visible</code> fix works. This is:</p>\n<pre><code>#define DLLEXPORT __attribute__((visibility(&quot;default&quot;),externally_visible))\n\nDLLEXPORT int fun1(void);\n</code></pre>\n<p>Also see: <a href=\"https://gcc.gnu.org/onlinedocs/gccint/WHOPR.html\" rel=\"nofollow noreferrer\">https://gcc.gnu.org/onlinedocs/gccint/WHOPR.html</a></p>\n<p>But I think your versionscript is wrong.</p>\n<p>If I take out the visibility overrides and change your versionscript by adding <code>fun1</code> and <code>fun2</code> then it works. Like:</p>\n<pre><code>v1 {\n    global:\n        fun; fun1;\n    local:\n        *;\n};\nv2 {\n    global:\n        fun; fun2;\n} v1;\n</code></pre>\n<p>The symbol alias targets have to be visible as well as the alias.</p>\n"}, {"tags": [], "owner": {"reputation": 26934, "user_id": 8316315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d833a8a46fea39d7bfca1540ea9c07?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Weimer", "link": "https://stackoverflow.com/users/8316315/florian-weimer"}, "is_accepted": true, "score": 4, "last_activity_date": 1546634928, "creation_date": 1546634928, "answer_id": 54045851, "question_id": 46304742, "link": "https://stackoverflow.com/questions/46304742/how-to-combine-lto-with-symbol-versioning/54045851#54045851", "title": "How to combine LTO with symbol versioning", "body": "<p><a href=\"https://gcc.gnu.org/wiki/whopr/driver\" rel=\"nofollow noreferrer\">WHOPR Driver Design</a> gives some strong hints to what is going on.  The function definitions <code>fun1</code> and <code>fun2</code> are not exported according to the version script.  The LTO plugin is able to use this information, and since GCC does not peek into the <code>asm</code> directives, it knows nothing about the <code>.symver</code> directive, and therefore removes the function definition.</p>\n\n<p>For now, adding <code>__attribute__ ((externally_visible))</code> is the workaround for this.  You also need to build with <code>-flto-partition=none</code>, so that the <code>.symver</code> directives do not land by accident in a different intermediate assembler file than the function definition (where it will not have the desired effect).</p>\n\n<p><a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=48200\" rel=\"nofollow noreferrer\">GCC PR 48200</a> tracks an enhancement request for symbol versioning at the compiler level, which would likely address this issue as well.</p>\n"}, {"tags": [], "owner": {"reputation": 203, "user_id": 1264227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/198012f67181ccd4e313a0cb80dedb3a?s=128&d=identicon&r=PG", "display_name": "AndrzejO", "link": "https://stackoverflow.com/users/1264227/andrzejo"}, "is_accepted": false, "score": 1, "last_activity_date": 1568127503, "creation_date": 1568127503, "answer_id": 57873485, "question_id": 46304742, "link": "https://stackoverflow.com/questions/46304742/how-to-combine-lto-with-symbol-versioning/57873485#57873485", "title": "How to combine LTO with symbol versioning", "body": "<p>I just hit the same problem - so thank you for asking this.  However I've found it to be more clean to use <code>__attribute__((used))</code>.  Since gcc is not scanning the top level assembler, it can't figure out that <code>fun1</code> and <code>fun2</code> are being used ... so it removes them.  So it looks to me that changing definition to:</p>\n\n<pre><code>__asm__(\".symver fun1,fun@v1\");\nint __attribute__((used)) fun1() {\n    printf(\"fun1 called\\n\");\n    return 1;\n}\n</code></pre>\n\n<p>should be sufficient.</p>\n"}], "owner": {"reputation": 2118, "user_id": 293003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/7256049d410aa28c240527e1a779799e?s=128&d=identicon&r=PG", "display_name": "Nikratio", "link": "https://stackoverflow.com/users/293003/nikratio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 996, "favorite_count": 2, "accepted_answer_id": 54045851, "answer_count": 3, "score": 7, "last_activity_date": 1594758056, "creation_date": 1505836030, "last_edit_date": 1505853990, "question_id": 46304742, "link": "https://stackoverflow.com/questions/46304742/how-to-combine-lto-with-symbol-versioning", "title": "How to combine LTO with symbol versioning", "body": "<p>I would like to compile a shared library using both symbol versioning and link-time optimization (LTO). However, as soon as I turn on LTO, some of the exported symbols vanish. Here is a minimal example:</p>\n\n<p>Start by defining two implementations of a function <em>fun</em>:</p>\n\n<pre><code>$ cat fun.c \n#include &lt;stdio.h&gt;\n\nint fun1(void);\nint fun2(void);\n\n__asm__(\".symver fun1,fun@v1\");\nint fun1() {\n    printf(\"fun1 called\\n\");\n    return 1;\n}\n\n__asm__(\".symver fun2,fun@@v2\");\nint fun2() {\n    printf(\"fun2 called\\n\");\n    return 2;\n}\n</code></pre>\n\n<p>Create a version script to ensure that only <em>fun</em> is exported:</p>\n\n<pre><code>$ cat versionscript \nv1 {\n    global:\n        fun;\n    local:\n        *;\n};\nv2 {\n    global:\n        fun;\n} v1;\n</code></pre>\n\n<p>First attempt, compile without LTO:</p>\n\n<pre><code>$ gcc -o fun.o -Wall -Wextra -O2 -fPIC -c fun.c\n$ gcc -o libfun.so.1 -shared -fPIC -Wl,--version-script,versionscript fun.o\n$ nm -D --with-symbol-versions libfun.so.1 | grep fun\n00000000000006b0 T fun@@v2\n0000000000000690 T fun@v1\n</code></pre>\n\n<p>..exactly as it should be. But if I compile with LTO:</p>\n\n<pre><code>$ gcc -o fun.o -Wall -Wextra -flto -O2 -fPIC -c fun.c\n$ gcc -o libfun.so.1 -flto -shared -fPIC -Wl,--version-script,versionscript fun.o\n$ nm -D --with-symbol-versions libfun.so.1 | grep fun\n</code></pre>\n\n<p>..no symbols exported anymore.</p>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 3, "creation_date": 1505834171, "post_id": 46304060, "comment_id": 79570488, "body": "3 looks pretty random to me. (<a href=\"https://www.random.org/analysis/dilbert.jpg\" rel=\"nofollow noreferrer\">here</a>)."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1505834308, "post_id": 46304060, "comment_id": 79570575, "body": "Is <code>3</code> less &quot;random&quot; than  <code>125</code>? And where is it specified it should be random at all?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7807032"}, "edited": false, "score": 0, "creation_date": 1505834429, "post_id": 46304060, "comment_id": 79570660, "body": "3 is not random its getting subtracted you can change the value and add it to  ptr2 and check"}, {"owner": {"reputation": 639, "user_id": 6834990, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Uaxy3XKnAjs/AAAAAAAAAAI/AAAAAAAAABI/52ROGOYFmTw/photo.jpg?sz=128", "display_name": "Rajeshkumar", "link": "https://stackoverflow.com/users/6834990/rajeshkumar"}, "edited": false, "score": 2, "creation_date": 1505834441, "post_id": 46304060, "comment_id": 79570664, "body": "Third line prints the address of ptr2.. it won&#39;t print 3."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 639, "user_id": 6834990, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Uaxy3XKnAjs/AAAAAAAAAAI/AAAAAAAAABI/52ROGOYFmTw/photo.jpg?sz=128", "display_name": "Rajeshkumar", "link": "https://stackoverflow.com/users/6834990/rajeshkumar"}, "edited": false, "score": 2, "creation_date": 1505834488, "post_id": 46304060, "comment_id": 79570704, "body": "@Rajeshkumar It can print anything, as specifying <code>%d</code> with a pointer is UB."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7807032"}, "edited": false, "score": 0, "creation_date": 1505834501, "post_id": 46304060, "comment_id": 79570710, "body": "thts what my question is then why it is not printing the address in the second print statement"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1505834546, "post_id": 46304060, "comment_id": 79570735, "body": "Your question wording is not matching the code comments."}, {"owner": {"reputation": 639, "user_id": 6834990, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Uaxy3XKnAjs/AAAAAAAAAAI/AAAAAAAAABI/52ROGOYFmTw/photo.jpg?sz=128", "display_name": "Rajeshkumar", "link": "https://stackoverflow.com/users/6834990/rajeshkumar"}, "edited": false, "score": 0, "creation_date": 1505834599, "post_id": 46304060, "comment_id": 79570764, "body": "@downtown.. In second print your are taking the address difference of ptr2 and ptr1"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7807032"}, "reply_to_user": {"reputation": 639, "user_id": 6834990, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Uaxy3XKnAjs/AAAAAAAAAAI/AAAAAAAAABI/52ROGOYFmTw/photo.jpg?sz=128", "display_name": "Rajeshkumar", "link": "https://stackoverflow.com/users/6834990/rajeshkumar"}, "edited": false, "score": 0, "creation_date": 1505834786, "post_id": 46304060, "comment_id": 79570875, "body": "@Rajeshkumar how does it prints the index only after an airthmatic operation why does it returns the index in the last one whts the difference?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1505835147, "post_id": 46304060, "comment_id": 79571121, "body": "There is no &quot;airthmatic&quot; word in English. There is &quot;arithmetic&quot;. I though it is typo, but you keep writing it."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1505835249, "post_id": 46304060, "comment_id": 79571173, "body": "Read about undefined behaviour and read the <code>printf</code> man-page (and the documenation of other functions you use) before asking."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7807032"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1505835487, "post_id": 46304060, "comment_id": 79571320, "body": "@EugeneSh. sorry i will correct my spelling thank you for that"}, {"owner": {"reputation": 17102, "user_id": 1022889, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WZOSZ.jpg?s=128&g=1", "display_name": "Cloud", "link": "https://stackoverflow.com/users/1022889/cloud"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1505930887, "post_id": 46304060, "comment_id": 79618865, "body": "@Eugene 3 is definitely more random than 42."}], "answers": [{"tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": false, "score": 2, "last_activity_date": 1505835119, "last_edit_date": 1505835119, "creation_date": 1505834548, "answer_id": 46304227, "question_id": 46304060, "link": "https://stackoverflow.com/questions/46304060/why-do-only-arithmetic-operations-print-out-a-value-and-not-a-normal-one/46304227#46304227", "title": "Why do only arithmetic operations print out a value and not a normal one", "body": "<p>Here is an explanation of what's happening on each printing line, with corrections:</p>\n\n<pre><code>printf(\"%f \", *ptr2);\n</code></pre>\n\n<p>This line outputs <code>90.5</code>, which is the value pointed to by <code>*(ptr1 + 3)</code>, which is the same as <code>ptr1[3]</code>.</p>\n\n<pre><code>printf(\"%td\", ptr2 - ptr1);\n</code></pre>\n\n<p>This line should use <code>%td</code> because the result of subtracting <code>ptr1</code> from <code>ptr2</code> produces a result of type <code>ptrdiff_t</code>. The result is the number of positions in the array of <code>float</code>s between <code>ptr2</code> and <code>ptr1</code>, which is <code>3</code>.</p>\n\n<p>Note that this works because both pointers are pointing into the same array; you cannot subtract just any two arbitrary pointers and get a well-defined answer. Subtracting pointers that are not pointing into the same array is undefined behavior.</p>\n\n<pre><code>printf(\"%p\", (void*)ptr2) ;\n</code></pre>\n\n<p>This line prints a numeric value of the pointer. You need to use <code>%p</code> instead of <code>%d</code>. Using <code>%d</code> produces undefined behavior, which in your case results in printing 3. Using <code>%p</code> and converting the pointer to <code>void*</code> fix undefined behavior; <a href=\"https://ideone.com/tFQwc6\" rel=\"nofollow noreferrer\">the result printed on ideone is different</a>.</p>\n\n<blockquote>\n  <p>How does it prints the index only after an arithmetic operation? Why does it returns the index in the last one? What's the difference?</p>\n</blockquote>\n\n<p>C has special rules that apply to arithmetic operations on pointers, called <em>pointer arithmetic</em>.</p>\n\n<p>A pointer by itself is not an index. However, you can add an integer to a pointer, and C will treat it as moving a pointer by the corresponding number of indexes to the right or to the left, depending on the sign of the integer. Moreover, C defines pointer subtraction in terms of the number of indexes, so the usual rules of arithmetic apply:</p>\n\n<pre><code>(p + i) - p = i\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7807032"}, "edited": false, "score": 0, "creation_date": 1505835776, "post_id": 46304276, "comment_id": 79571528, "body": "thank you for the recommend"}], "tags": [], "owner": {"reputation": 17102, "user_id": 1022889, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WZOSZ.jpg?s=128&g=1", "display_name": "Cloud", "link": "https://stackoverflow.com/users/1022889/cloud"}, "is_accepted": false, "score": 4, "last_activity_date": 1505835107, "last_edit_date": 1505835107, "creation_date": 1505834750, "answer_id": 46304276, "question_id": 46304060, "link": "https://stackoverflow.com/questions/46304060/why-do-only-arithmetic-operations-print-out-a-value-and-not-a-normal-one/46304276#46304276", "title": "Why do only arithmetic operations print out a value and not a normal one", "body": "<p>This is part of the fundamentals of <a href=\"/questions/tagged/c\" class=\"post-tag\" title=\"show questions tagged &#39;c&#39;\" rel=\"tag\">c</a>. <code>ptr1</code> could be expressed as either <code>ptr1 = &amp;arr[0]</code> or <code>ptr1 = arr</code>: both forms are equivalent. Additionally, your <code>ptr2</code> assignment could be expressed as either <code>ptr2 = ptr1 +3</code> or as <code>ptr2 = &amp;ptr1[3]</code>.</p>\n\n<p>The line in question:</p>\n\n<pre><code>printf(\"%d\", ptr2 - ptr1);\n</code></pre>\n\n<p>Subtracts one pointer value from another, and results in the number of \"gaps\" between the two pointers, assuming that each \"gap\" is the size of a <code>float</code>.</p>\n\n<p>The example below should provide more insight. The use of the <code>intptr_t</code> type is just so that I can manipulate a pointer as if it were a simple number.</p>\n\n<h1>Code Listing</h1>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n#define OFFSET  (3)\n\nint main(void)\n{\n    float arr[5] = {12.5, 10.0, 13.5, 90.5, 0.5};\n    float *ptr1 = &amp;arr[0];\n    float *ptr2 = ptr1 + OFFSET;\n\n    printf(\"%p %p\\n\", ptr1, ptr2);\n    printf(\"sizeof(float):%ld\\n\", sizeof(float));\n    printf(\"Distance between pointers (bytes):%ld\\n\", (intptr_t)ptr2 - (intptr_t)ptr1);\n    printf(\"Distance between pointers (gaps):%ld\\n\", ptr2 - ptr1);\n\n\n    return 0;\n}\n</code></pre>\n\n<h1>Sample Run</h1>\n\n<pre><code>0x7fffdc244800 0x7fffdc24480c\nsizeof(float):4\nDistance between pointers (bytes):12\nDistance between pointers (gaps):3\n</code></pre>\n\n<p>If you haven't already, I strongly recommend you buy/rent/borrow a copy of \"C Primer Plus\" by Prata, and do all the exercises in the chapters and the quizzes at the end. This very topic is covered at length early on in the book, and in great detail.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7807032"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 1, "closed_date": 1505844157, "answer_count": 2, "score": 0, "last_activity_date": 1505835209, "creation_date": 1505834063, "last_edit_date": 1505835209, "question_id": 46304060, "link": "https://stackoverflow.com/questions/46304060/why-do-only-arithmetic-operations-print-out-a-value-and-not-a-normal-one", "closed_reason": "Not suitable for this site", "title": "Why do only arithmetic operations print out a value and not a normal one", "body": "<pre><code>int main(){\n\n    float arr[5] = {12.5, 10.0, 13.5, 90.5, 0.5};\n    float *ptr1 = &amp;arr[0];\n    float *ptr2 = ptr1 + 3;\n    printf(\"%f \", *ptr2); // outputs 90.5  \n    printf(\"%d\", ptr2 - ptr1);  // outputs 3\n    printf(\"%d\",ptr2) ;\n\n   return 0;\n}\n</code></pre>\n\n<p>why the last line doesn't print 3 instead of some random value </p>\n"}, {"tags": ["c", "linux", "network-programming", "pthreads"], "comments": [{"owner": {"reputation": 128, "user_id": 6200701, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-LbBcYe8IlE0/AAAAAAAAAAI/AAAAAAAAAOA/vnhQeCw7ovc/photo.jpg?sz=128", "display_name": "Floaterz", "link": "https://stackoverflow.com/users/6200701/floaterz"}, "edited": false, "score": 1, "creation_date": 1505834037, "post_id": 46303944, "comment_id": 79570406, "body": "&quot;The pthread_join() function shall suspend execution of the calling thread until the target thread terminates.&quot; - which means it will block the main thread because the new thread will still be listening to any new calls. For more detailed info go here: <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/pthread_join.html\" rel=\"nofollow noreferrer\">pthread_join</a>"}, {"owner": {"reputation": 13, "user_id": 8634710, "user_type": "registered", "profile_image": "https://graph.facebook.com/1532019806891702/picture?type=large", "display_name": "Sneha Dolly", "link": "https://stackoverflow.com/users/8634710/sneha-dolly"}, "reply_to_user": {"reputation": 128, "user_id": 6200701, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-LbBcYe8IlE0/AAAAAAAAAAI/AAAAAAAAAOA/vnhQeCw7ovc/photo.jpg?sz=128", "display_name": "Floaterz", "link": "https://stackoverflow.com/users/6200701/floaterz"}, "edited": false, "score": 0, "creation_date": 1505834273, "post_id": 46303944, "comment_id": 79570557, "body": "So, without calling pthread_join() works for me?"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1505834333, "post_id": 46303944, "comment_id": 79570591, "body": "Protip - don&#39;t call pthread_join unless you have no choice.  In your case, an accept loop, there is no need to, ever."}, {"owner": {"reputation": 13, "user_id": 8634710, "user_type": "registered", "profile_image": "https://graph.facebook.com/1532019806891702/picture?type=large", "display_name": "Sneha Dolly", "link": "https://stackoverflow.com/users/8634710/sneha-dolly"}, "edited": false, "score": 0, "creation_date": 1505834467, "post_id": 46303944, "comment_id": 79570685, "body": "Then what scenarios pthread join() is used?. If the main thread is suspended. Its like calling one function after another. We no need of threads at all I feel."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1505835687, "post_id": 46303944, "comment_id": 79571466, "body": "@SnehaDolly if you are going to wait for them, one-by-one no, there is no point.  If your thread has the same lifetime as the process, eg. your accept() loop, or pooled threads,  join is not required and, if possible, should be avoided."}], "answers": [{"comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1505845644, "post_id": 46305250, "comment_id": 79576626, "body": "There is no point in using select() in the accept() loop.  Nothing is gained, and you have to make an extra system call.  You understand that select() is a blocking call, yes?"}, {"owner": {"reputation": 13, "user_id": 8634710, "user_type": "registered", "profile_image": "https://graph.facebook.com/1532019806891702/picture?type=large", "display_name": "Sneha Dolly", "link": "https://stackoverflow.com/users/8634710/sneha-dolly"}, "edited": false, "score": 0, "creation_date": 1505853450, "post_id": 46305250, "comment_id": 79580630, "body": "@Naresh. As said by Martin James, select call is blocking. Therefore the main application will block. I have a scenario where main application should not block. And I don&#39;t know when client ll come n connect."}], "tags": [], "owner": {"reputation": 13, "user_id": 3736516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/514660e17945926cf0af2beca3ecdb73?s=128&d=identicon&r=PG&f=1", "display_name": "Naresh", "link": "https://stackoverflow.com/users/3736516/naresh"}, "is_accepted": false, "score": 0, "last_activity_date": 1505837719, "creation_date": 1505837719, "answer_id": 46305250, "question_id": 46303944, "link": "https://stackoverflow.com/questions/46303944/server-socket-in-a-new-thread/46305250#46305250", "title": "server socket in a new thread", "body": "<p>One way would be to make the main server socket descriptor as non-blocking and use select system call. When select returns and the main socket descriptor is having data, create a new thread to handle the newly accepted connection. This way you can achieve parallelism, The new connection, which was created will have it's own context and will be scheduled as and when possible even though while accept() waits for a connection.</p>\n"}], "owner": {"reputation": 13, "user_id": 8634710, "user_type": "registered", "profile_image": "https://graph.facebook.com/1532019806891702/picture?type=large", "display_name": "Sneha Dolly", "link": "https://stackoverflow.com/users/8634710/sneha-dolly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1505837719, "creation_date": 1505833744, "question_id": 46303944, "link": "https://stackoverflow.com/questions/46303944/server-socket-in-a-new-thread", "title": "server socket in a new thread", "body": "<p>I want to create a server socket but  don't want to block my main application by the \"accept call\". So I will create a socket in main application. using pthread mechanism I created a new thread in which I will use \"accept call\" in it. After creating socket in main application, I called \"pthread join\". Now when this thread executes, \"accept call\" is again blocking the main application. I checked using gdb. How I should go about this problem?</p>\n"}, {"tags": ["c", "unix", "operating-system"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1505837925, "post_id": 46303547, "comment_id": 79572814, "body": "Are you sure that semaphores are the correct synchronization mechanism to use?  Consider condition variables..."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 8597232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b2abc24a24aaa8c0fce2af18b93a4d0?s=128&d=identicon&r=PG&f=1", "display_name": "Jing", "link": "https://stackoverflow.com/users/8597232/jing"}, "edited": false, "score": 0, "creation_date": 1505834024, "post_id": 46303750, "comment_id": 79570396, "body": "If I change that with this, the program doesn&#39;t start:   if((*portions)==0) {                                                                                                                                 sem_post(mutex)                                                                                       sem_post(empty)                                                                                       sem_wait(full)"}, {"owner": {"reputation": 4245, "user_id": 3613657, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16dbb100614d9c85c0a1689ef29f5f43?s=128&d=identicon&r=PG&f=1", "display_name": "Mathieu Border&#233;", "link": "https://stackoverflow.com/users/3613657/mathieu-border%c3%a9"}, "reply_to_user": {"reputation": 9, "user_id": 8597232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b2abc24a24aaa8c0fce2af18b93a4d0?s=128&d=identicon&r=PG&f=1", "display_name": "Jing", "link": "https://stackoverflow.com/users/8597232/jing"}, "edited": false, "score": 0, "creation_date": 1505834479, "post_id": 46303750, "comment_id": 79570695, "body": "Read the book I linked, your algorithm probably has more than 1 issue."}], "tags": [], "owner": {"reputation": 4245, "user_id": 3613657, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16dbb100614d9c85c0a1689ef29f5f43?s=128&d=identicon&r=PG&f=1", "display_name": "Mathieu Border&#233;", "link": "https://stackoverflow.com/users/3613657/mathieu-border%c3%a9"}, "is_accepted": false, "score": 1, "last_activity_date": 1505833059, "creation_date": 1505833059, "answer_id": 46303750, "question_id": 46303547, "link": "https://stackoverflow.com/questions/46303547/multiprocessing-race-sharing-a-variable/46303750#46303750", "title": "Multiprocessing race sharing a variable", "body": "<p>Your consumer takes the mutex, signals that the pot is empty and then never releases the mutex, in this way, the producer can never take the mutex and fill the pot and your process will deadlock.</p>\n\n<p><a href=\"https://www.google.be/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=2&amp;cad=rja&amp;uact=8&amp;ved=0ahUKEwjy76zVwbHWAhXMPFAKHQnhBY0QFggtMAE&amp;url=http%3A%2F%2Fgreenteapress.com%2Fsemaphores%2FLittleBookOfSemaphores.pdf&amp;usg=AFQjCNGZLhXbpHIWv9OlMLaBdb3u2XVXyQ\" rel=\"nofollow noreferrer\">For a better understanding, read the Producer Consumer section in this great book.</a></p>\n"}], "owner": {"reputation": 9, "user_id": 8597232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b2abc24a24aaa8c0fce2af18b93a4d0?s=128&d=identicon&r=PG&f=1", "display_name": "Jing", "link": "https://stackoverflow.com/users/8597232/jing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1505898891, "creation_date": 1505832566, "last_edit_date": 1505898891, "question_id": 46303547, "link": "https://stackoverflow.com/questions/46303547/multiprocessing-race-sharing-a-variable", "title": "Multiprocessing race sharing a variable", "body": "<p>I'm doing a simple Producer/Consumer problem. I have a producer(chef) that produces portions when consumer(savage) consumes all of them, so a savage has to wait until chef fills the pot. I don't understand what's my error because savages consume portions, but chef doesn't fill the pot.</p>\n\n<p>This is the program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;semaphore.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/ipc.h&gt;\n#include &lt;sys/sem.h&gt;\n#include &lt;sys/shm.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;fcntl.h&gt;\n\nint shmid, semid;\nint *portions;\nsem_t *mutex, *empty, *full;\n\nchar sem_1[]= \"mutex\";\nchar sem_2[]= \"full\";\nchar sem_3[]= \"empty\";\n\nvoid clear()\n{\n\n   if (shmctl(shmid,IPC_RMID,0) == -1) perror(\"shmctl\");\n}\n\nvoid producer(int num, int m)   \n{\n  int i;\n\n   while(1) { \n\n\n    }    \n}\n\nvoid consumer(int num, int rounds)   \n{\n\n       int i;\n\n\n\n}\n\n\nint main(int argc, char *argv[])\n{\n\nint i;\nint N, M, NROUNDS, pid;\n\n\nif (argc != 4)\n{\n    fprintf(stderr,\"insert N savages, M portions e NROUNDS\\n\");\n    exit(1);\n}\n\nN=atoi(argv[1]);\nM=atoi(argv[2]);\nNROUNDS=atoi(argv[3]);\n\n\n\n\n/* generate producer and consumers */\n\n\n\n\n      }\n\n  for(i=0;i&lt;N;i++) {\n    pid=wait(NULL);\n    printf(\"Terminate process %d\\n\", pid);\n  }   \n\n  clear();\n\n}\n</code></pre>\n\n<p>This is the output:</p>\n\n<pre><code>./a.out 3 5 3\n\nSavage[2] eats\nNumber of portions in pot: 4\nSavage[1] eats\nNumber of portions in pot: 3\nSavage[0] eats\nNumber of portions in pot: 2\nSavage[2] eats\nNumber of portions in pot: 1\nSavage[1] eats\nNumber of portions in pot: 0\nSavage[0] eats\nNumber of portions in pot: -1\nSavage[2] eats\nNumber of portions in pot: -2\nTerminate process 10287\nSavage[1] eats\nNumber of portions in pot: -3\nSavage[0] eats\nNumber of portions in pot: -4\nTerminate process 10285\nTerminate process 10286\n</code></pre>\n"}]