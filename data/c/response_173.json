[{"tags": ["c"], "comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 2, "creation_date": 1525302991, "post_id": 50144768, "comment_id": 87307794, "body": "Why are you looping twice for every character in name? I don&#39;t see the point. Also how did you create and initialized <code>chars</code>? Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 17, "user_id": 9701874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/501e1fa0a5fdc5004d8cb277b67af0ef?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/9701874/tyler"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1525303346, "post_id": 50144768, "comment_id": 87307856, "body": "i said its an array type struct read the description...is it any diffrent if i say Char char[50]?Char is struct {char,int}"}, {"owner": {"reputation": 17, "user_id": 9701874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/501e1fa0a5fdc5004d8cb277b67af0ef?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/9701874/tyler"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1525303503, "post_id": 50144768, "comment_id": 87307887, "body": "maybe description too long.my bad"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 1, "creation_date": 1525303723, "post_id": 50144768, "comment_id": 87307948, "body": "I advise you to rewrite your question, add correct punctuation marks, split it in paragraphs, add spaces after punctuation marks, your question is just hard to read. What is the meaning of <code>chars[i]</code>, what I mean, if you have 50 <code>chars</code>, what do <code>chars[0]</code>, <code>chars[1]</code>, etc. represent?"}, {"owner": {"reputation": 17, "user_id": 9701874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/501e1fa0a5fdc5004d8cb277b67af0ef?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/9701874/tyler"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1525303829, "post_id": 50144768, "comment_id": 87307974, "body": "chars[0] is the first element of the array chars with is type struct Char .which struct contains{char ch int occurs} in it"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1525304040, "post_id": 50144768, "comment_id": 87308019, "body": "That&#39;s not what I meant. Which characters does <code>chars[0]</code> store? <code>&#39;a&#39;</code>, <code>&#39;A&#39;</code>, the first character in <code>name</code>? I don&#39;t understand your loop. To be honest I don&#39;t really understand what you&#39;re asking."}, {"owner": {"reputation": 17, "user_id": 9701874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/501e1fa0a5fdc5004d8cb277b67af0ef?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/9701874/tyler"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1525304335, "post_id": 50144768, "comment_id": 87308077, "body": "i want to count how many times a character in a string occurs.i want to get a result in which the character goes in the char part of an element of the array (ch) and the times it occured in the occurs"}, {"owner": {"reputation": 17, "user_id": 9701874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/501e1fa0a5fdc5004d8cb277b67af0ef?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/9701874/tyler"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1525304395, "post_id": 50144768, "comment_id": 87308082, "body": "struct is like that{char ch     int occurs}and each element of chars is type struct(this struct)"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1525305188, "post_id": 50144768, "comment_id": 87308246, "body": "You have two indexes (<code>i</code> and <code>j</code>) and two arrays (<code>chars</code> and <code>name</code>). You need to decide which index goes with which array. Also, the conditional expression in the <code>for</code> loop needs to match the array."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1525305318, "post_id": 50144768, "comment_id": 87308275, "body": "There isn&#39;t a simple fix. The inner loop <code>for(i=0;i&lt;strlen(name);i++)</code> should be controlled by the current usage of the <code>struct</code> array (which you don&#39;t show), and <code>chars[i].ch=name[i];</code> should be <code>chars[i].ch=name[j];</code> the whole thing is very unclear."}, {"owner": {"reputation": 17, "user_id": 9701874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/501e1fa0a5fdc5004d8cb277b67af0ef?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/9701874/tyler"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1525324554, "post_id": 50144768, "comment_id": 87312958, "body": "@WeatherVane can u be more specific i didnt understand the first statement."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 9701874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/501e1fa0a5fdc5004d8cb277b67af0ef?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/9701874/tyler"}, "edited": false, "score": 0, "creation_date": 1525324768, "post_id": 50145334, "comment_id": 87313029, "body": "im trying to convert the first block of code into something that can run into mine.but i dont want to change the 2 loops or they way it looks.ive seen it run and it has structure same as mine.i just dont know what should i add.do i indent something diffrently?"}, {"owner": {"reputation": 17, "user_id": 9701874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/501e1fa0a5fdc5004d8cb277b67af0ef?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/9701874/tyler"}, "edited": false, "score": 0, "creation_date": 1525325718, "post_id": 50145334, "comment_id": 87313380, "body": "and im pretty sure it didnt have an conditions between the for lops"}], "tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": false, "score": 1, "last_activity_date": 1525307425, "creation_date": 1525307425, "answer_id": 50145334, "question_id": 50144768, "link": "https://stackoverflow.com/questions/50144768/save-character-and-occurance-in-an-array-of-type-structch-int-of-an-input-stri/50145334#50145334", "title": "save character and occurance in an array of type struct{ch,int} of an input string", "body": "<p>After reading your question many times, I think I understand your problem and\nwhat you want to do.</p>\n\n<p>The problem I see with you solution is that the inner loop is not correct. You\ncannot just run <code>strlen(name)</code> times, it's too inefficient as this is the upper\nbound, but you only need to check for all distinct values read so far. This number is on average smaller than <code>strlen(name)</code>.\nAlso you should first check the read character is already in <code>chars</code> and add it to it only if it\nhasn't been found. What you should do is rather something like this:</p>\n\n<pre><code>// pseudo code\nfor all characters in name:\n    found = False\n    for all distinct cached values:\n        if character is in cached value:\n            found = true\n            counter++\n    if found == False:\n        a new distinct value has been found\n        add a new cache entry\n</code></pre>\n\n<p>So the code could look like this:</p>\n\n<pre><code>Chars chars[50];\n\nsize_t len = strlen(name);\nsize_t dv = 0; // number of distinct values\n\n// initializing to 0\nmemset(chars, 0, sizeof chars);\n\nfor(size_t i = 0; i &lt; len; ++i)\n{\n    int found = 0;\n    for(size_t j = 0; j &lt; dv; ++j)\n    {\n        if(chars[j].ch == name[i])\n        {\n            found = 1;\n            chars[j].occurs++;\n            break; // break inner loop\n        }\n    }\n\n    if(found == 1)\n        continue;\n\n    // checking array bounds\n    if(dv == (sizeof chars / sizeof chars[0]) - 1)\n    {\n        fprintf(stderr, \"Too many distinct values, not enough space\\n\");\n        return ERROR_VALUE;\n    }\n\n    // a new distinct value has been found\n    chars[dv].ch = name[i];\n    chars[dv].occurs = 1;\n    dv++;\n}\n\nprintf(\"The string '%s' has these distinct values:\\n\", name);\nfor(size_t i = 0; i &lt; dv; ++i)\n{\n    printf(\"%c: %d times\\n\", chars[i].ch, chars[i].occurs);\n}\n</code></pre>\n\n<p>But like I said, this is not very efficient, the worst case is in <code>O(n\u00b2)</code>.</p>\n\n<p>A better approach would be to declare <code>chars</code> to be an array of dimension 256 of\n<code>int</code> values, a <code>chars[i]</code> represent the <code>i</code>-th character in the <a href=\"https://www.asciitable.com/\" rel=\"nofollow noreferrer\">ASCII</a> code:</p>\n\n<pre><code>int chars[256];\n\nsize_t len = strlen(name);\n\n// initializing to 0\nmemset(chars, 0, sizeof chars);\n\nfor(size_t i = 0; i &lt; len; ++i)\n    chars[(int) name[i]]++;\n\nprintf(\"The string '%s' has these distinct values:\\n\", name);\nfor(size_t i = 0; i &lt; 256; ++i)\n{\n    if(chars[i] &gt; 0)\n        printf(\"%c: %d times\\n\", (char) i, chars[i]);\n}\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 9701874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/501e1fa0a5fdc5004d8cb277b67af0ef?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/9701874/tyler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1525307425, "creation_date": 1525302490, "last_edit_date": 1525304946, "question_id": 50144768, "link": "https://stackoverflow.com/questions/50144768/save-character-and-occurance-in-an-array-of-type-structch-int-of-an-input-stri", "title": "save character and occurance in an array of type struct{ch,int} of an input string", "body": "<p><code>name</code> is the input string.</p>\n\n<p><code>chars</code> is an array of this structre</p>\n\n<pre><code>struct {\n    char ch;\n    int occurs;\n};\n</code></pre>\n\n<p>I want to count the times a certain character occurs and save both character and the occur value in the chars array.</p>\n\n<p>Also the <code>ch</code> part of all the array chars is set to <code>'\\0'</code> and the <code>int</code> part to <code>0</code>.</p>\n\n<p>****I want the structure of the code to remain the same just where can the fix be done and how?</p>\n\n<p>example: <code>yoyo</code> is the string input and I want for every character to be saved in the <code>chars</code> array like that (<code>y2 o2</code>).</p>\n\n<pre><code>for(j=0;j&lt;strlen(name);j++){\n    for(i=0;i&lt;strlen(name);i++){\n        if(chars[i].ch=='\\0'){\n            chars[i].ch=name[i];\n            chars[i].occurs=1;\n            break;\n        }\n        else if(chars[j].ch==name[i]){\n            chars[i].occurs++;\n            break;\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "clang"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1525302264, "post_id": 50144723, "comment_id": 87307647, "body": "The only thing I can think of is to (pre)sort the indexes."}, {"owner": {"reputation": 1818, "user_id": 2171758, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/0pO0W.jpg?s=128&g=1", "display_name": "salient", "link": "https://stackoverflow.com/users/2171758/salient"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1525302278, "post_id": 50144723, "comment_id": 87307650, "body": "Should mention that they are already sorted :)"}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1525302325, "post_id": 50144723, "comment_id": 87307659, "body": "Assuming the generated assembler has some vectorizations already?  I&#39;d consider placing const on things that are const.  Perhaps post the assembler and we can see how close to ideal it already is."}, {"owner": {"reputation": 1818, "user_id": 2171758, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/0pO0W.jpg?s=128&g=1", "display_name": "salient", "link": "https://stackoverflow.com/users/2171758/salient"}, "edited": false, "score": 0, "creation_date": 1525302421, "post_id": 50144723, "comment_id": 87307675, "body": "Yep. Added a <code>godbolt</code> link."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 1, "creation_date": 1525302470, "post_id": 50144723, "comment_id": 87307685, "body": "Depending on length, you might get good return from threading it and adding when complete."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 2, "creation_date": 1525302707, "post_id": 50144723, "comment_id": 87307732, "body": "Also, if you know length is going to be long enough, a little bit of loop unrolling might help too.  You&#39;d need to profile that though."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1525304702, "post_id": 50144723, "comment_id": 87308145, "body": "Did you try compiling it without the force vector part and measure?"}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1525305154, "post_id": 50144723, "comment_id": 87308242, "body": "One last though - add <code>#pragma clang loop vectorize(enable) interleave(enable)</code> right above the loop and remove the force vectorization flags and I think the generated code may improve.  You are then trusting the compiler to help you instead of forcing it.  <a href=\"https://llvm.org/docs/Vectorizers.html\" rel=\"nofollow noreferrer\">llvm.org/docs/Vectorizers.html</a>"}], "answers": [{"comments": [{"owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "edited": false, "score": 1, "creation_date": 1525309377, "post_id": 50145131, "comment_id": 87309124, "body": "This seems unlikely to give any benefit over clang&#39;s built-in unroller, and may well make things worse by interfering with it..."}], "tags": [], "owner": {"reputation": 45031, "user_id": 213136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b84a36c241e04175fcec402dac43018?s=128&d=identicon&r=PG", "display_name": "Bob Jarvis - Reinstate Monica", "link": "https://stackoverflow.com/users/213136/bob-jarvis-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1525305608, "creation_date": 1525305608, "answer_id": 50145131, "question_id": 50144723, "link": "https://stackoverflow.com/questions/50144723/performance-optimization-for-indexed-sum/50145131#50145131", "title": "Performance optimization for indexed sum", "body": "<p>Unwind the loop. I'd think that something like</p>\n\n<pre><code>#include \"stdint.h\"\n\nvoid IndexedSum(float buf[], uint32_t index[], int len, float *res)\n  {\n  float acc = 0;\n  int   i;\n\n  for(i = 0 ; i &lt; len-8 ; i += 8)\n    acc += (buf[index[i+0]] + \n            buf[index[i+1]]\n            buf[index[i+2]]\n            buf[index[i+3]]\n            buf[index[i+4]]\n            buf[index[i+5]]\n            buf[index[i+6]]\n            buf[index[i+7]])\n\n  while(i &lt; len)\n    acc += buf[index[i++]];\n\n  *res = acc;\n  }\n</code></pre>\n\n<p>should provide an improvement if <code>len</code> is sufficiently large. I thought about using <a href=\"https://en.wikipedia.org/wiki/Duff%27s_device\" rel=\"nofollow noreferrer\">Duff's device</a> but didn't want to introduce the potential performance penalty for doing everything through pointers. Might be an interesting performance comparison, though.</p>\n\n<p>Best of luck.</p>\n"}], "owner": {"reputation": 1818, "user_id": 2171758, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/0pO0W.jpg?s=128&g=1", "display_name": "salient", "link": "https://stackoverflow.com/users/2171758/salient"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1525305608, "creation_date": 1525302104, "last_edit_date": 1525302391, "question_id": 50144723, "link": "https://stackoverflow.com/questions/50144723/performance-optimization-for-indexed-sum", "title": "Performance optimization for indexed sum", "body": "<p>Given an array of floats, and another sorted array that indexes values into that array that should be summed \u2014 are there any ways to do potentially do better than this and the auto-vectorized code? Any applicable intrinsics?</p>\n\n<pre><code>#include \"stdint.h\"\n\nvoid IndexedSum(float buf[], uint32_t index[], int len, float *res) {\n    float acc = 0;\n    for(int i = 0; i &lt; len; i++) {\n       acc += buf[index[i]];\n    }\n    *res = acc;\n}\n</code></pre>\n\n<p>Currently compiling with <code>clang 6.0</code> with <code>-O3</code>, <code>-ffast-math</code> and <code>-mllvm -force-vector-width=8</code>:</p>\n\n<p><a href=\"https://godbolt.org/g/AVhA4L\" rel=\"nofollow noreferrer\">https://godbolt.org/g/AVhA4L</a></p>\n"}, {"tags": ["c", "bash"], "comments": [{"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1525301488, "post_id": 50144558, "comment_id": 87307484, "body": "Did you mean <code>&quot;$TEMP_DIRECTORY&quot;</code> and <code>&quot;$USR_DIR&quot;</code>? Did you really mean to put quotes around <code>&quot;cp -rf &quot;</code>?"}, {"owner": {"reputation": 12459, "user_id": 316082, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/a18baaf9417df189af31b53af03adb1c?s=128&d=identicon&r=PG", "display_name": "liv2hak", "link": "https://stackoverflow.com/users/316082/liv2hak"}, "reply_to_user": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1525303699, "post_id": 50144558, "comment_id": 87307939, "body": "@jxh - <code>TEMP_DIRECTORY</code> and <code>USER_DIR</code> are defined in the program by means of <code>#defines</code>"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 2, "creation_date": 1525304112, "post_id": 50144558, "comment_id": 87308032, "body": "Real code, please. Complete commands."}], "answers": [{"comments": [{"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1525312139, "post_id": 50145095, "comment_id": 87309708, "body": "Not a good practice to teach -- if one&#39;s temporary directory is <code>&#47;uploads&#47;$(rm -rf ~)&#47;hello.d</code>, behavior would be unfortunate. Much better to avoid <code>system()</code>; even if one is going to use a shell, passing parameterized content out-of-band from the script text (in either an environment variable or separate argv entry) is far safer."}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1525312241, "post_id": 50145095, "comment_id": 87309732, "body": "An example of the latter, still using a shell (bad for performance) but passing content through the environment (good for security) would be: <code>setenv(&quot;temp_directory&quot;, TEMP_DIRECTORY); setenv(&quot;usr_dir&quot;, USR_DIR); system(&quot;cp -rf \\&quot;$temp_directory\\&#47;*&quot; \\&quot;$usr_dir\\&quot;&#47;&quot;);</code>"}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1525312332, "post_id": 50145095, "comment_id": 87309750, "body": "...or, to avoid the shell altogether: <code>execvp(&quot;cp&quot;, char[][]{&quot;cp&quot;, &quot;-rf&quot;, TEMP_DIRECTORY &quot;&#47;.&quot;, USR_DIR &quot;&#47;&quot;});</code> -- obvs., needs to be invoked from a forked subprocess if intending to keep the parent alive. Had to remove the <code>*</code> since that that doesn&#39;t work without a shell involved, but <code>&#47;.</code> will serve the same use."}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1525312416, "post_id": 50145095, "comment_id": 87309774, "body": "(Yes, a path <i>compiled into script text</i> will presumably be vetted by a human, but real-world <code>cp</code> invocations frequently aren&#39;t, and use names that come from <code>readdir()</code> or other unvetted / manipulable sources)."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "reply_to_user": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1525315202, "post_id": 50145095, "comment_id": 87310392, "body": "@CharlesDuffy: I agree using the shell to execute the command is unsafe if the goal is to use environment variable substitution."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "reply_to_user": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1525367696, "post_id": 50145095, "comment_id": 87338946, "body": "@CharlesDuffy: Do you have an answer for the [c] tag that addresses these issues that I can link to?"}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1525371205, "post_id": 50145095, "comment_id": 87340798, "body": "Eh? I didn&#39;t say that &quot;using the shell to execute the command is unsafe if the goal is to use environment variable substitution&quot;. Quite the opposite: Using environment variable substitution is one of the <i>safe</i> ways to pass an argument into a shell, as opposed to the unsafe practice, demonstrated in this answer, of substituting literal content into a string passed to <code>system()</code>."}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1525371309, "post_id": 50145095, "comment_id": 87340841, "body": "That&#39;s not the <i>only</i> safe practice, just the first one that came to mind. As another example (no environment variables involved!) <code>execlp(&quot;sh&quot;, &quot;sh&quot;, &quot;-c&quot;, &quot;cp -rf -- \\&quot;$1\\&quot; \\&quot;$2\\&quot;&quot;, &quot;_&quot;, TEMP_DIRECTORY, USR_DIR, 0)</code> uses a shell but is safe (from shell injection vulnerabilities), because the values are out-of-band from the code."}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1525371356, "post_id": 50145095, "comment_id": 87340863, "body": "...unfortunately, the C tag isn&#39;t my usual haunt (haven&#39;t done C professionally for a significant amount of my time for nearing on 20 years now), so I don&#39;t have any suggestions handy."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "reply_to_user": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1525372703, "post_id": 50145095, "comment_id": 87341540, "body": "@CharlesDuffy: I think you are misinterpreting my intent. I am talking about the attacker setting the environment variable to some command instead of a simple string, thus injecting the command."}], "tags": [], "owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "is_accepted": false, "score": 0, "last_activity_date": 1525329347, "last_edit_date": 1525329347, "creation_date": 1525305366, "answer_id": 50145095, "question_id": 50144558, "link": "https://stackoverflow.com/questions/50144558/getting-the-list-of-files-to-be-copied-using-cp-command-in-a-c-program/50145095#50145095", "title": "getting the list of files to be copied using cp command in a C program", "body": "<p>If we treat the provided line of code as the actual code fragment you intend to use to perform the desired task, the answer to your query is <em>no</em>.</p>\n\n<p>Assuming:</p>\n\n<pre><code>#define TEMP_DIRECTORY \"/tmp\"\n#define USER_DIR \"/home/joe\"\n</code></pre>\n\n<p>Then the provided statement is simply an expression representing a string constant, and by itself performs no action. GCC with sufficient warnings will tell you that:</p>\n\n<blockquote>\n<pre><code>.code.tio.c: In function \u2018main\u2019:\n.code.tio.c:5:1: warning: statement with no effect [-Wunused-value]\n \"cp -rf \"TEMP_DIRECTORY\"/* \"USER_DIR\"/\";\n ^~~~~~~~~\n</code></pre>\n</blockquote>\n\n<p>To make the command take effect in your C code, you will need to pass the string to a function, such as <code>system()</code> or <code>popen()</code>.</p>\n\n<pre><code>const char *cmd = \"cp -rf \"TEMP_DIRECTORY\"/* \"USER_DIR\"/\";\nsystem(cmd);\n</code></pre>\n\n<p>However, since <code>system()</code> and <code>popen()</code> use the shell to execute the commands, they are susceptible to command injection attacks. If your <code>TEMP_DIRECTORY</code> and <code>USER_DIR</code> actually contain shell environment variables that you want expanded, it is better that you expand them yourself with <code>getenv()</code>, form the complete paths, and then invoke the command via <code>fork()</code> followed by one of the <code>exec()</code> variants. If you need the glob expansion, there is the POSIX utility <code>glob()</code>, or you can walk the directory yourself using functions from <code>&lt;dirent.h&gt;</code>.</p>\n"}], "owner": {"reputation": 12459, "user_id": 316082, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/a18baaf9417df189af31b53af03adb1c?s=128&d=identicon&r=PG", "display_name": "liv2hak", "link": "https://stackoverflow.com/users/316082/liv2hak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1525329347, "creation_date": 1525300773, "last_edit_date": 1525311119, "question_id": 50144558, "link": "https://stackoverflow.com/questions/50144558/getting-the-list-of-files-to-be-copied-using-cp-command-in-a-c-program", "title": "getting the list of files to be copied using cp command in a C program", "body": "<p>I have a bash command </p>\n\n<pre><code>\"cp -rf \"TEMP_DIRECTORY\"/* \"USER_DIR\"/\";\n</code></pre>\n\n<p>I am using that inside a C program.</p>\n\n<p><code>TEMP_DIRECTORY</code> and <code>USER_DIR</code> are defined using <code>#define</code>.</p>\n\n<p>I want to get the list of files inside <code>TEMP_DIRECTORY</code>. Can I do that with the above approach?</p>\n"}, {"tags": ["c", "xcode", "libarchive"], "comments": [{"owner": {"reputation": 1893, "user_id": 1787434, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/85f5a5c15e84e4a9aec84dc8be822010?s=128&d=identicon&r=PG", "display_name": "the_storyteller", "link": "https://stackoverflow.com/users/1787434/the-storyteller"}, "edited": false, "score": 3, "creation_date": 1525298853, "post_id": 50144208, "comment_id": 87306703, "body": "Ideally post a code snippet instead of a picture of code."}, {"owner": {"reputation": 1893, "user_id": 1787434, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/85f5a5c15e84e4a9aec84dc8be822010?s=128&d=identicon&r=PG", "display_name": "the_storyteller", "link": "https://stackoverflow.com/users/1787434/the-storyteller"}, "edited": false, "score": 3, "creation_date": 1525298994, "post_id": 50144208, "comment_id": 87306752, "body": "Have you included errno? <code>#include &lt;errno.h&gt;</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1525299484, "post_id": 50144208, "comment_id": 87306912, "body": "<code>ENOMEM</code> is not a C standard error code, yet quite common.  OTOH, <code>ERANGE</code> is C standard and defined in <code>&lt;errno.h&gt;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 91, "user_id": 6074435, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SQLLpvicTtc/AAAAAAAAAAI/AAAAAAAAAFU/qyrtdYU-WLc/photo.jpg?sz=128", "display_name": "Piou44", "link": "https://stackoverflow.com/users/6074435/piou44"}, "is_accepted": true, "score": 4, "last_activity_date": 1525300986, "creation_date": 1525300986, "answer_id": 50144587, "question_id": 50144208, "link": "https://stackoverflow.com/questions/50144208/use-of-undeclared-identifier-enomem/50144587#50144587", "title": "Use of undeclared identifier &#39;ENOMEM&#39;", "body": "<p><code>ENONEM</code> and <code>ERANGE</code> are macros that are defined in <code>errno.h</code>. As for <code>errno</code>, it is an integer variable set when some errors are occurred.<br/></p>\n\n<p>Thus, to access those variables/defines you need to add <code>#include &lt;errno.h&gt;</code> in your file.</p>\n\n<p>For more documentation : <a href=\"http://man7.org/linux/man-pages/man3/errno.3.html\" rel=\"nofollow noreferrer\">man errno</a></p>\n"}], "owner": {"reputation": 309, "user_id": 5861196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/de9qd.png?s=128&g=1", "display_name": "Habib Alejalil", "link": "https://stackoverflow.com/users/5861196/habib-alejalil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1147, "favorite_count": 0, "accepted_answer_id": 50144587, "answer_count": 1, "score": 1, "last_activity_date": 1525300986, "creation_date": 1525298685, "last_edit_date": 1525299817, "question_id": 50144208, "link": "https://stackoverflow.com/questions/50144208/use-of-undeclared-identifier-enomem", "title": "Use of undeclared identifier &#39;ENOMEM&#39;", "body": "<p>i using \"libarchive\" for my xcode project but get bellow errors</p>\n\n<pre><code>if (bytes_read &lt; mine-&gt;block_size &amp;&amp; ferror(mine-&gt;f)) {\n    archive_set_error(a, errno, \"Error reading file\");\n}\n</code></pre>\n\n<p>Use of undeclared identifier 'errno'</p>\n\n<pre><code>if (mine == NULL || b == NULL) {\n    archive_set_error(a, ENOMEM, \"No memory\");\n    free(mine);\n    free(b);\n    return (ARCHIVE_FATAL);\n}\n</code></pre>\n\n<p>Use of undeclared identifier 'ENOMEM'</p>\n\n<pre><code>if (format_number(archive_entry_uid(entry), h + USTAR_uid_offset, USTAR_uid_size, USTAR_uid_max_size, strict)) {\n    archive_set_error(&amp;a-&gt;archive, ERANGE, \"Numeric user ID too large\");\n    ret = ARCHIVE_FAILED;\n}\n</code></pre>\n\n<p>Use of undeclared identifier 'ERANGE'</p>\n\n<pre><code>   write_nulls(struct archive_write *a, size_t padding)\n{\n  int ret;\n  size_t to_write;\n\n   while (padding &gt; 0) {\n    to_write = padding &lt; a-&gt;null_length ? padding : a-&gt;null_length;\n    ret = (a-&gt;compressor.write)(a, a-&gt;nulls, to_write);\n    if (ret != ARCHIVE_OK)\n    return (ret);\n    padding -= to_write;\n}\nreturn (ARCHIVE_OK);}\n</code></pre>\n\n<p>No member named 'compressor' in 'struct archive_write'</p>\n\n<p>how i can fix this errors?</p>\n\n<p><a href=\"https://i.stack.imgur.com/5rJCD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5rJCD.png\" alt=\"screenshot of error\"></a></p>\n\n<p><a href=\"https://github.com/Tarsnap/tarsnap/blob/master/libarchive/archive_write_set_format_ustar.c\" rel=\"nofollow noreferrer\">https://github.com/Tarsnap/tarsnap/blob/master/libarchive/archive_write_set_format_ustar.c</a></p>\n"}, {"tags": ["c", "stm32", "uart", "sim900"], "owner": {"reputation": 5, "user_id": 9709371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea628f1882798b8cecab5e4616c50fa8?s=128&d=identicon&r=PG&f=1", "display_name": "zinhom69", "link": "https://stackoverflow.com/users/9709371/zinhom69"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1525306403, "creation_date": 1525298006, "last_edit_date": 1525306403, "question_id": 50144089, "link": "https://stackoverflow.com/questions/50144089/sim900-reception-buffer-issues", "title": "SIM900 Reception buffer issues", "body": "<p>Actually I'm working with SIM900, I have a problem with Reception character, so I can't receive an \"OK\" for each message that I send to the chip. I would like to send an SMS or make call.<br>\nI use STM32F429 waveshare board and below and the functions that I implemented for the communication:</p>\n\n<pre><code>void SIM900_Init(void)\n{\n  HAL_UART_Transmit(&amp;huart3, (uint8_t*)aTxBuffer1, sizeof(aTxBuffer1), 1000);\n  HAL_Delay(50);\n  HAL_UART_Transmit(&amp;huart3, (uint8_t*)aTxBuffer2, sizeof(aTxBuffer2), 1000);\n  HAL_Delay(50);\n}\nvoid SIM900_SendSMS(void)\n{\n  HAL_UART_Transmit(&amp;huart3, (uint8_t*)aTxBuffer3, sizeof(aTxBuffer3), 1000);\n  HAL_Delay(50);\n  HAL_UART_Transmit(&amp;huart3, (uint8_t*)aTxBuffer4, sizeof(aTxBuffer4), 1000);\n  HAL_Delay(50);\n  HAL_UART_Transmit(&amp;huart3, message, sizeof(message), 1000);\n  HAL_Delay(50);\n  HAL_UART_Transmit(&amp;huart3, (uint8_t*)CtrlZ, sizeof(CtrlZ), 1000);\n  HAL_Delay(50);\n}\n</code></pre>\n\n<p>In the main, I call these two functions like this:</p>\n\n<pre><code>  uint8_t aRxBuffer[255];\n.......\nSIM900_USART3_UART_Init();\n  SIM900_Init();\n  SIM900_SendSMS();\n\n\n  /* Infinite loop */\n  while (1)\n  {    \n    // Start receiving the data via USART3\n    HAL_UART_Receive(&amp;huart3, (uint8_t *)aRxBuffer, 255, 1000);\n\n    .........\n</code></pre>\n"}, {"tags": ["c", "recursion", "binary-search-tree"], "comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1525297871, "post_id": 50143991, "comment_id": 87306396, "body": "What is the semantic of <code>deleteGivenLevel</code>? To remove all nodes of level <code>level</code>?"}, {"owner": {"reputation": 5, "user_id": 6900462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9e04ea8a4ceef2e4e688b22eb1bb95d?s=128&d=identicon&r=PG&f=1", "display_name": "Hamza Makia", "link": "https://stackoverflow.com/users/6900462/hamza-makia"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1525298084, "post_id": 50143991, "comment_id": 87306450, "body": "Yes, it&#39;s supposed to delete all nodes of a given level."}, {"owner": {"reputation": 371, "user_id": 9710796, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155167830691216/picture?type=large", "display_name": "Vamsidhar Reddy Gaddam", "link": "https://stackoverflow.com/users/9710796/vamsidhar-reddy-gaddam"}, "edited": false, "score": 0, "creation_date": 1525298699, "post_id": 50143991, "comment_id": 87306646, "body": "Does your insert work at all? You are ignoring the return value in the while loop. Strange that you dont see errors in printing the tree."}, {"owner": {"reputation": 5, "user_id": 6900462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9e04ea8a4ceef2e4e688b22eb1bb95d?s=128&d=identicon&r=PG&f=1", "display_name": "Hamza Makia", "link": "https://stackoverflow.com/users/6900462/hamza-makia"}, "edited": false, "score": 0, "creation_date": 1525299717, "post_id": 50143991, "comment_id": 87306985, "body": "Yes everything works fine, even when ignoring the return value of the insert there is no difference."}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1525301605, "post_id": 50143991, "comment_id": 87307511, "body": "I haven&#39;t actually tested your code, but by inspection I think your deleteGivenLevel calls are storing pointers on the stack (parameter root) that have already been deleted by previous calls to deleteNode. Can you prove this doesn&#39;t happen? Or print the memory location before each free and inside your deleteGivenLevel calls as you unwind the stack?"}], "answers": [{"tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": true, "score": 0, "last_activity_date": 1525302399, "creation_date": 1525302399, "answer_id": 50144753, "question_id": 50143991, "link": "https://stackoverflow.com/questions/50143991/how-do-i-delete-a-level-of-nodes-in-a-binary-search-tree-in-c/50144753#50144753", "title": "How do I delete a level of nodes in a Binary Search Tree in C?", "body": "<p>The problem is the <code>deleteNode</code>.</p>\n\n<p>When you call <code>deleteNode</code> with a leaf (a node whose <code>left</code> and <code>right</code> children\nare <code>NULL</code>) as it's argument, this block is executed:</p>\n\n<pre><code>if (root-&gt;left == NULL)\n{\n    struct node *temp = root-&gt;right;\n    free(root);\n    return temp;\n}\nelse if (root-&gt;right == NULL)\n{\n    struct node *temp = root-&gt;left;\n    free(root);\n    return temp;\n}\n</code></pre>\n\n<p>The problem here is that you are freeing the leaf but the parent which is\npointing to the leaf does not get updated, thus it keeps pointing to already\nfreed memory and when you traverse the tree again, then you access invalid\nmemory. This yields undefined behaviour and it ends in a segfault.</p>\n\n<p>If you go step by step through the <code>deleteGivenLevel</code> function, eventually\n<code>root</code> will be the node with <code>key == 3</code>. Then you do</p>\n\n<pre><code>deleteGivenLevel(root-&gt;left, level-1);\n</code></pre>\n\n<p>where <code>root-&gt;left</code> is the leaf with <code>key == 2</code> and <code>level-1</code> is 0. That means\nthat the in the next call</p>\n\n<pre><code>if (level == 0)\n{\n    printf(\"\\n %d will be removed!\", root-&gt;key);\n    root = deleteNode(root, root-&gt;key);\n}\n</code></pre>\n\n<p>is executed where <code>root</code> is the leaf with <code>key == 2</code>. And here is the problem,\nthat node is removed, but because it is a leave, the node with <code>key == 3</code> whose\n<code>left</code> element points to the leaf, does not get updated.</p>\n\n<p>A quick fix would be to pass the parent node to <code>deleteNode</code> and\n<code>deleteGivenLevel</code> so that you can update the parent node properly. But you\nshould probably rethink you deleting strategy.</p>\n\n<pre><code>struct node* deleteNode(struct node* root, int key, struct node *parent)\n{\n    // base case\n    if (root == NULL) return root;\n\n    // If the key to be deleted is smaller than the root's key,\n    // then it lies in left subtree\n    if (key &lt; root-&gt;key)\n        root-&gt;left = deleteNode(root-&gt;left, key, NULL); // you could also call\n                                                        // with root as the\n                                                        // 3rd argument, but\n                                                        // you update the parent in this line\n                                                        // anyway\n\n\n    // If the key to be deleted is greater than the root's key,\n    // then it lies in right subtree\n    else if (key &gt; root-&gt;key)\n        root-&gt;right = deleteNode(root-&gt;right, key, NULL); // same as above\n\n    // if key is same as root's key, then This is the node\n    // to be deleted\n    else\n    {\n        // node with only one child or no child\n        if (root-&gt;left == NULL)\n        {\n            struct node *temp = root-&gt;right;\n\n            // update only if parent is present\n            if(parent)\n            {\n                if(root-&gt;key &lt; parent-&gt;key)\n                    parent-&gt;left = temp;\n                else\n                    parent-&gt;right = temp;\n            }\n\n            free(root);\n            return temp;\n        }\n        else if (root-&gt;right == NULL)\n        {\n\n            struct node *temp = root-&gt;left;\n\n            // update only if parent is present\n            if(parent)\n            {\n                if(root-&gt;key &lt; parent-&gt;key)\n                    parent-&gt;left = temp;\n                else\n                    parent-&gt;right = temp;\n            }\n\n            free(root);\n            return temp;\n        }\n\n        // node with two children: Get the inorder successor (smallest\n        // in the right subtree)\n        struct node* temp = minValueNode(root-&gt;right);\n\n        // Copy the inorder successor's content to this node\n        root-&gt;key = temp-&gt;key;\n\n        // Delete the inorder successor\n        root-&gt;right = deleteNode(root-&gt;right, temp-&gt;key, root);\n    }\n    return root;\n}\n\nvoid deleteGivenLevel(struct node* root, int level, struct node *parent)\n{\n    if (root == NULL)\n    {\n        return;\n    }\n    if (level == 0)\n    {\n        printf(\"\\n %d will be removed!\", root-&gt;key);\n        root = deleteNode(root, root-&gt;key, parent);\n    }\n    else if (level &gt; 0)\n    {\n        deleteGivenLevel(root-&gt;left, level-1, root);\n        deleteGivenLevel(root-&gt;right, level-1, root);\n    }\n}\n\nvoid free_tree(struct node *root)\n{\n    if(root == NULL)\n        return;\n\n    free_tree(root-&gt;left);\n    free_tree(root-&gt;right);\n    free(root);\n}\n</code></pre>\n\n<p>Now when you call <code>deleteGivenLevel</code> with the real root, <code>parent</code> should be set\nto <code>NULL</code>.</p>\n\n<p>I checked the code with this <code>main</code> function, note how <code>deleteGivenLevel</code> is\ncalled with <code>parent == NULL</code>:</p>\n\n<pre><code>int main()\n{\n    int level;\n    struct node *root = NULL;\n\n    int vals[] = { 5, 3, 8, 2, 4, 7, 9 };\n\n    for(size_t i = 0; i &lt; sizeof vals / sizeof *vals; ++i)\n        root = insert(root, vals[i]);\n\n    // print inoder traversal of the BST\n    printf(\"\\nBefore Deletion:\");\n    inorder(root);\n    puts(\"\");\n\n    level = 2;\n    deleteGivenLevel(root, level, NULL);\n\n    // print inoder traversal of the BST\n    printf(\"\\nAfter Deletion:\");\n    inorder(root);\n    puts(\"\");\n\n    free_tree(root);\n    return 0;\n}\n</code></pre>\n\n<p>and this was the output:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>$ valgrind ./a \n==24038== Memcheck, a memory error detector\n==24038== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.\n==24038== Using Valgrind-3.13.0 and LibVEX; rerun with -h for copyright info\n==24038== Command: ./a\n==24038== \n\nBefore Deletion:     2   3   4   5   7   8   9\n\n 2 will be removed!\n 4 will be removed!\n 7 will be removed!\n 9 will be removed!\nAfter Deletion:  3   5   8\n==24038== \n==24038== HEAP SUMMARY:\n==24038==     in use at exit: 0 bytes in 0 blocks\n==24038==   total heap usage: 8 allocs, 8 frees, 1,192 bytes allocated\n==24038== \n==24038== All heap blocks were freed -- no leaks are possible\n==24038== \n==24038== For counts of detected and suppressed errors, rerun with: -v\n==24038== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)\n</code></pre>\n\n<p>I also checked the code with more nodes and removing different levels, I didn't\nget a single segfault and it seemed to print the correct results anyway.</p>\n"}], "owner": {"reputation": 5, "user_id": 6900462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9e04ea8a4ceef2e4e688b22eb1bb95d?s=128&d=identicon&r=PG&f=1", "display_name": "Hamza Makia", "link": "https://stackoverflow.com/users/6900462/hamza-makia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 542, "favorite_count": 0, "accepted_answer_id": 50144753, "answer_count": 1, "score": 0, "last_activity_date": 1525302399, "creation_date": 1525297495, "question_id": 50143991, "link": "https://stackoverflow.com/questions/50143991/how-do-i-delete-a-level-of-nodes-in-a-binary-search-tree-in-c", "title": "How do I delete a level of nodes in a Binary Search Tree in C?", "body": "<p>Assuming we have the following BST:</p>\n\n<pre><code>      5           (level 0)\n   3       8      (level 1)\n2    4    7    9  (level 2)\n</code></pre>\n\n<p>When trying to delete level 0 or 1 everything is okay but when removing level 2. I get a segmentation fault</p>\n\n<pre><code>[1]    18636 segmentation fault  ./a.out\n</code></pre>\n\n<p>This is my code:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\nstruct node\n{\n    int key;\n    struct node *left, *right;\n};\n\n// A function to create a new BST node\nstruct node *newNode(int item)\n{\n    struct node *temp =  (struct node *)malloc(sizeof(struct node));\n    temp-&gt;key = item;\n    temp-&gt;left = temp-&gt;right = NULL;\n    return temp;\n}\n\n// A function to insert a new node with given key in BST\nstruct node* insert(struct node* node, int key)\n{\n    // If the tree is empty, return a new node\n    if (node == NULL) return newNode(key);\n\n    // Otherwise, recur down the tree\n    if (key &lt; node-&gt;key)\n        node-&gt;left  = insert(node-&gt;left, key);\n    else if (key &gt; node-&gt;key)\n        node-&gt;right = insert(node-&gt;right, key);\n\n    // return the (unchanged) node pointer\n    return node;\n}\n\n// Given a non-empty binary search tree, return the node with minimum\n// key value found in that tree. Note that the entire tree does not\n// need to be searched.\nstruct node * minValueNode(struct node* node)\n{\n    struct node* current = node;\n\n    // loop down to find the leftmost leaf\n    while (current-&gt;left != NULL)\n        current = current-&gt;left;\n\n    return current;\n}\n\nstruct node* deleteNode(struct node* root, int key)\n{\n    // base case\n    if (root == NULL) return root;\n\n    // If the key to be deleted is smaller than the root's key,\n    // then it lies in left subtree\n    if (key &lt; root-&gt;key)\n        root-&gt;left = deleteNode(root-&gt;left, key);\n\n    // If the key to be deleted is greater than the root's key,\n    // then it lies in right subtree\n    else if (key &gt; root-&gt;key)\n        root-&gt;right = deleteNode(root-&gt;right, key);\n\n    // if key is same as root's key, then This is the node\n    // to be deleted\n    else\n    {\n        // node with only one child or no child\n        if (root-&gt;left == NULL)\n        {\n            struct node *temp = root-&gt;right;\n            free(root);\n            return temp;\n        }\n        else if (root-&gt;right == NULL)\n        {\n            struct node *temp = root-&gt;left;\n            free(root);\n            return temp;\n        }\n\n        // node with two children: Get the inorder successor (smallest\n        // in the right subtree)\n        struct node* temp = minValueNode(root-&gt;right);\n\n        // Copy the inorder successor's content to this node\n        root-&gt;key = temp-&gt;key;\n\n        // Delete the inorder successor\n        root-&gt;right = deleteNode(root-&gt;right, temp-&gt;key);\n    }\n    return root;\n}\n\nvoid deleteGivenLevel(struct node* root, int level)\n{\n    if (root == NULL)\n    {\n        return;\n    }\n    if (level == 0)\n    {\n        printf(\"\\n %d will be removed!\", root-&gt;key);\n        root = deleteNode(root, root-&gt;key);\n    }\n    else if (level &gt; 0)\n    {\n        deleteGivenLevel(root-&gt;left, level-1);\n        deleteGivenLevel(root-&gt;right, level-1);\n    }\n}\n\n// A function to do inorder traversal of BST\nvoid inorder(struct node *root)\n{\n    if (root != NULL)\n    {\n        inorder(root-&gt;left);\n        printf(\"\\t %d\", root-&gt;key);\n        inorder(root-&gt;right);\n    }\n}\n\nint main()\n{\n    int input, level;\n    struct node *root = NULL;\n\n    printf(\"\\nEnter a number to go into the BST: \");\n    scanf(\"%d\",&amp;input);\n    root = insert(root, input);\n\n    while(1)\n    {\n        printf(\"\\nEnter another number (0 to stop): \");\n        scanf(\"%d\",&amp;input);\n        if (input==0)\n        {\n            break;\n        }\n        insert(root, input);\n    }\n\n    // print inoder traversal of the BST\n    printf(\"\\nBefore Deletion:\");\n    inorder(root);\n\n    printf(\"\\nWhich level would you like to delete? \");\n    scanf(\"%d\",&amp;level);\n    deleteGivenLevel(root, level);\n\n    // print inoder traversal of the BST\n    printf(\"\\nAfter Deletion:\");\n    inorder(root);\n    return 0;\n}\n</code></pre>\n\n<p>I've also noticed that it only works when I try to delete level 0 or 1. Other than that it doesn't work. If I add more nodes and I try to delete. It doesn't delete anything at all in that case.</p>\n"}, {"tags": ["c", "encoding", "character-encoding", "scanf"], "answers": [{"tags": [], "owner": {"reputation": 34, "user_id": 6853668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eadc6f042bdf70b4d72c4b9b3dfd9e59?s=128&d=identicon&r=PG&f=1", "display_name": "First Code", "link": "https://stackoverflow.com/users/6853668/first-code"}, "is_accepted": true, "score": 0, "last_activity_date": 1525714884, "creation_date": 1525714884, "answer_id": 50219720, "question_id": 50143671, "link": "https://stackoverflow.com/questions/50143671/turkish-character-reading-on-windows-console/50219720#50219720", "title": "Turkish character reading on Windows console", "body": "<p>It needs a command in cmd for solution of this problem. I solved. Just before program execution, command <code>chcp 1254</code>, then console can input Turkish characters.</p>\n"}], "owner": {"reputation": 34, "user_id": 6853668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eadc6f042bdf70b4d72c4b9b3dfd9e59?s=128&d=identicon&r=PG&f=1", "display_name": "First Code", "link": "https://stackoverflow.com/users/6853668/first-code"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "accepted_answer_id": 50219720, "answer_count": 1, "score": 0, "last_activity_date": 1525714884, "creation_date": 1525295754, "question_id": 50143671, "link": "https://stackoverflow.com/questions/50143671/turkish-character-reading-on-windows-console", "title": "Turkish character reading on Windows console", "body": "<p>I need to input Turkish characters from console in C. But I can't. This code working.</p>\n\n<pre><code>setlocale(LC_ALL, \"Turkish\");\nprintf(\"\u00fc \u011f \u0131 \u015f \u00e7 \u00f6\");\n</code></pre>\n\n<p>Output: <code>\u00fc \u011f \u0131 \u015f \u00e7 \u00f6</code></p>\n\n<p>But when I try to use, it don't working.</p>\n\n<pre><code>setlocale(LC_ALL, \"Turkish\");\nscanf(\"%c %c %c %c\", c, (c + 1), (c + 2), (c + 3));\nprintf(\"%c %c %c %c\", *c, *(c + 1), *(c + 2), *(c + 3));\n</code></pre>\n\n<p>Input: <code>\u011f \u00fc \u015f \u00e7</code></p>\n\n<p>Output: <code>\u00a7 ? Y \u253c</code></p>\n\n<p>My operating system is Windows. When I read a file characters, there is not problem. But only console inputs are problem. How can I solve this problem?</p>\n"}, {"tags": ["c", "arrays", "struct", "string-formatting", "modularity"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1525295460, "post_id": 50143552, "comment_id": 87305409, "body": "Why is it declared <code>char *name[20]</code>? That&#39;s an array of 20 pointers to <code>char</code>. Does a student really need 20 different names?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1525295494, "post_id": 50143552, "comment_id": 87305426, "body": "It should just be <code>char name[20]</code> to declare a single string that&#39;s up to 20 characters long."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1525295507, "post_id": 50143552, "comment_id": 87305432, "body": "And the same for <code>pass</code>."}, {"owner": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "edited": false, "score": 0, "creation_date": 1525295758, "post_id": 50143552, "comment_id": 87305535, "body": "You need to research how to handle the carriage return in the input.  This question has been asked and answered many times."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1525296384, "post_id": 50143552, "comment_id": 87305788, "body": "Please show the <code>student_confirm()</code> function. It may be that you ask for a Y/N response with <code>%c</code> format spec, which needs a space in front of that spec, because unlike most format sepcifiers, <code>%c</code> does not skip whitespace remaining from the previous input."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1525297219, "post_id": 50143552, "comment_id": 87306135, "body": "Note: don&#39;t use an  integer type for a phone number, which may have a leading <code>0</code> which will be lost. In any case a 32-bit <code>int</code> is not big enough."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1525297689, "post_id": 50143552, "comment_id": 87306320, "body": "Please see <a href=\"https://stackoverflow.com/questions/5240789/scanf-leaves-the-new-line-char-in-the-buffer\">scanf() leaves the new line char in the buffer</a>."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1525298139, "post_id": 50143552, "comment_id": 87306462, "body": "How do you account for the <code>&#39;\\n&#39;</code> left in <code>stdin</code> after <code>scanf(&quot; %d&quot;,&amp;student_ID);</code> and before <code>scanf(&quot;%s&quot;,&amp;student.name);</code>??"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1525298542, "post_id": 50143552, "comment_id": 87306595, "body": "(<b>note:</b> the leading space is not required in <code>&quot; %d&quot;</code>, but could sure be of some use in <code>&quot; %s&quot;</code>...)"}, {"owner": {"reputation": 21, "user_id": 8958308, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OCqUqqaPS6A/AAAAAAAAAAI/AAAAAAAAAA8/7yUI7KxDM4o/photo.jpg?sz=128", "display_name": "George Strawbridge", "link": "https://stackoverflow.com/users/8958308/george-strawbridge"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1525316131, "post_id": 50143552, "comment_id": 87310602, "body": "@WeatherVane - I&#39;ll have a look at student_confirm() tomorrow. I&#39;m in mobile right now and don&#39;t have the code accessible to me but I think you may be into something. DavidC.Rankin, it&#39;s possible I cannot account for it. I&#39;ll look over it tomorrow"}, {"owner": {"reputation": 21, "user_id": 8958308, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OCqUqqaPS6A/AAAAAAAAAAI/AAAAAAAAAA8/7yUI7KxDM4o/photo.jpg?sz=128", "display_name": "George Strawbridge", "link": "https://stackoverflow.com/users/8958308/george-strawbridge"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1525374607, "post_id": 50143552, "comment_id": 87342464, "body": "@WeatherVane student_confirm() function edited into the OP."}, {"owner": {"reputation": 42504, "user_id": 1161878, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0157ddd785dc01e95342e3661d34b42a?s=128&d=identicon&r=PG", "display_name": "Gene", "link": "https://stackoverflow.com/users/1161878/gene"}, "edited": false, "score": 0, "creation_date": 1525375000, "post_id": 50143552, "comment_id": 87342650, "body": "As others are hinting, <code>scanf</code> is tricky to use for console input. For example, if you try to read an integer field, the newline typed to end the integer won&#39;t be removed from the input buffer.  A following <code>scanf</code> to read a string will see it and immediately return an empty string.  With enough care, you can convince <code>scanf</code> to behave, but it might be simper in the long run to use <code>fgets</code> or write your own string input procedure and convert the resulting strings to other types as needed."}, {"owner": {"reputation": 21, "user_id": 8958308, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OCqUqqaPS6A/AAAAAAAAAAI/AAAAAAAAAA8/7yUI7KxDM4o/photo.jpg?sz=128", "display_name": "George Strawbridge", "link": "https://stackoverflow.com/users/8958308/george-strawbridge"}, "reply_to_user": {"reputation": 42504, "user_id": 1161878, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0157ddd785dc01e95342e3661d34b42a?s=128&d=identicon&r=PG", "display_name": "Gene", "link": "https://stackoverflow.com/users/1161878/gene"}, "edited": false, "score": 0, "creation_date": 1525431237, "post_id": 50143552, "comment_id": 87363425, "body": "@Gene could you possibly give me an example of how a problem line of my code could do the same thing with the &#39;fgets&#39; function. I&#39;ve only used that function for save files so would have no clue where to start."}, {"owner": {"reputation": 42504, "user_id": 1161878, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0157ddd785dc01e95342e3661d34b42a?s=128&d=identicon&r=PG", "display_name": "Gene", "link": "https://stackoverflow.com/users/1161878/gene"}, "edited": false, "score": 0, "creation_date": 1525449368, "post_id": 50143552, "comment_id": 87374900, "body": "Well, a hacky approach that might help is to change the string-reading scanfs by adding a space before the %s format specifier:  <code>scanf(&quot; %s&quot;, ...);</code>;  This causes <code>scanf</code> to skip any whitespace it sees before starting to read the string. That ought to cause it to skip buffered newlines. When all else fails, read the documentation: <b>Whitespace Character</b> paragraph here: <a href=\"http://www.cplusplus.com/reference/cstdio/scanf/\" rel=\"nofollow noreferrer\">cplusplus.com/reference/cstdio/scanf</a>"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 8958308, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OCqUqqaPS6A/AAAAAAAAAAI/AAAAAAAAAA8/7yUI7KxDM4o/photo.jpg?sz=128", "display_name": "George Strawbridge", "link": "https://stackoverflow.com/users/8958308/george-strawbridge"}, "edited": false, "score": 0, "creation_date": 1525297592, "post_id": 50143676, "comment_id": 87306282, "body": "Thanks for the reply. I feel kinda stupid now. I totally missed over that I&#39;d declared them both as pointers in the struct. I have removed the pointers and the address operator but am still stuck with the same problem (skipping over the input)"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 21, "user_id": 8958308, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OCqUqqaPS6A/AAAAAAAAAAI/AAAAAAAAAA8/7yUI7KxDM4o/photo.jpg?sz=128", "display_name": "George Strawbridge", "link": "https://stackoverflow.com/users/8958308/george-strawbridge"}, "edited": false, "score": 1, "creation_date": 1525297648, "post_id": 50143676, "comment_id": 87306299, "body": "@GeorgeStrawbridge please see my commment above, posted 20 minutes ago."}, {"owner": {"reputation": 21, "user_id": 8958308, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OCqUqqaPS6A/AAAAAAAAAAI/AAAAAAAAAA8/7yUI7KxDM4o/photo.jpg?sz=128", "display_name": "George Strawbridge", "link": "https://stackoverflow.com/users/8958308/george-strawbridge"}, "edited": false, "score": 0, "creation_date": 1525300371, "post_id": 50143676, "comment_id": 87307196, "body": "Yes, I knew about this for programs I&#39;ve written in the past. It completely skipped my mind. But adding the leading whitespace to name and pass makes the program skip even more, right down to the age line."}, {"owner": {"reputation": 21, "user_id": 8958308, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OCqUqqaPS6A/AAAAAAAAAAI/AAAAAAAAAA8/7yUI7KxDM4o/photo.jpg?sz=128", "display_name": "George Strawbridge", "link": "https://stackoverflow.com/users/8958308/george-strawbridge"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1525315925, "post_id": 50143676, "comment_id": 87310550, "body": "@WeatherVane please see my above post"}, {"owner": {"reputation": 21, "user_id": 8958308, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OCqUqqaPS6A/AAAAAAAAAAI/AAAAAAAAAA8/7yUI7KxDM4o/photo.jpg?sz=128", "display_name": "George Strawbridge", "link": "https://stackoverflow.com/users/8958308/george-strawbridge"}, "edited": false, "score": 0, "creation_date": 1525316457, "post_id": 50143676, "comment_id": 87310700, "body": "@KeineLust I have done everything mentioned/advised in this thread and if anything the problem has worsened. It&#39;s skipping over more user input now. I&#39;ll post my student_confirm() function tomorrow. It might be the underlying problem."}], "tags": [], "owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "is_accepted": false, "score": 1, "last_activity_date": 1525296629, "last_edit_date": 1525296629, "creation_date": 1525295796, "answer_id": 50143676, "question_id": 50143552, "link": "https://stackoverflow.com/questions/50143552/program-skipping-over-user-input-large-modular-library-info-system-in-c/50143676#50143676", "title": "Program skipping over user input (Large modular Library Info System in C)", "body": "<p>The compiler is explaining it to you</p>\n\n<pre><code>warning: format '%s' expects argument of type 'char *', but argument 2 has type 'char * (*)[20]'\n</code></pre>\n\n<hr>\n\n<pre><code>char *name[20];\n</code></pre>\n\n<p>is an array of pointers to <code>char</code>, instead, you want an array of <code>char</code>'s:</p>\n\n<pre><code>char name[20];\n</code></pre>\n\n<p>or a pointer to <code>char</code>:</p>\n\n<pre><code>char *name;\n\n...\nstudent.name = malloc(20);\n</code></pre>\n\n<p>and then</p>\n\n<pre><code>scanf(\"%s\", student.name); \n</code></pre>\n\n<p>Notice that you don't need to use the address of operator (<code>&amp;</code>) with <code>scanf(\"%s\", student.name)</code> because <code>student.name</code> is already (or decays into) a pointer.</p>\n\n<p>Same for <code>pass</code>.</p>\n"}], "owner": {"reputation": 21, "user_id": 8958308, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OCqUqqaPS6A/AAAAAAAAAAI/AAAAAAAAAA8/7yUI7KxDM4o/photo.jpg?sz=128", "display_name": "George Strawbridge", "link": "https://stackoverflow.com/users/8958308/george-strawbridge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1525374512, "creation_date": 1525295197, "last_edit_date": 1525374512, "question_id": 50143552, "link": "https://stackoverflow.com/questions/50143552/program-skipping-over-user-input-large-modular-library-info-system-in-c", "title": "Program skipping over user input (Large modular Library Info System in C)", "body": "<p>I'm currently in the process of programming the largest C program I have ever written, for a final assignment for one of my university modules. The program is modular, containing files such as main.c, librarian.c, students.c, and books.c. Each has their corresponding header file and I also have a file, structs.h, containing two structures: one for books and one for students.</p>\n\n<p>I'm currently facing a problem, where when the librarian tries to add a new student membership to the library, certain inputs are completely skipped over and I don't understand why.</p>\n\n<p>I'll try and include as little code as possible but this may be a challenge due to the size of my program.</p>\n\n<p>First, here's my student structure as it may be relevant:</p>\n\n<pre><code>struct STUDENT             //Structure variable for student\n{\n  int id;\n  char *name[20];\n  char *pass[20];\n  int mobile;\n  float fee;\n  int age;\n  char *cat;\n};\nstruct STUDENT student;\n</code></pre>\n\n<p>Now, the function that is causing me problems is this:</p>\n\n<pre><code>int student_data(int answer){ //Function to add data of student to LIS\n    student_confirm();\n    int x = 15, x1 = 30;\n    int student_ID;\n    gotoxy(x,7);printf(\"Enter the Information Bellow\");\n    gotoxy(x,10);printf(\"Student Name:\");  gotoxy(x1,10);scanf(\" %d\",&amp;student_ID);\n\n    if(student.id==student_ID){\n        gotoxy(x,11);printf(\"Id is already Exits\");\n        getch(); add_student();\n    }\n\n    student.id=student_ID;\n    gotoxy(x,11);printf(\"User Name:\");gotoxy(x1,11);scanf(\"%s\",&amp;student.name);       \n    gotoxy(x,12);printf(\"Password:\");gotoxy(x1,12);scanf(\"%s\",&amp;student.pass);\n    gotoxy(x,13);printf(\"Mobile:\");gotoxy(x1,13);scanf(\"%d\",&amp;student.mobile);\n    gotoxy(x,14);printf(\"Fee:\");gotoxy(x1,14);scanf(\"%f\",&amp;student.fee);        \n    gotoxy(x,15);printf(\"Age:\");gotoxy(x1,15);scanf(\"%d\",&amp;student.age);      \n\n    return 1;\n}\n</code></pre>\n\n<p>The student_confirm() function simply asks the user if they are sure they want to add a new student to the library. Now, when I run the program, I sign in as the librarian, go to add a student and am greeted with this in the console</p>\n\n<pre><code>                        *****Library Information System*****\n                        ***Brotherton Library***\n                                *1975*\n                ____________________________________________\n    Confirm you would like to add a new student: (Y/N)\n\n           Enter the Information Bellow\n\n\n           Student Name:\n           User Name:\n           Password:\n</code></pre>\n\n<p>It skips straight to Password, not allowing me to enter the prior two fields. I'm completely stumped by this. There's similar parts of code in my program (such as for adding books) that follow the same logic and they work just fine. I wasn't able to find anything via a search on here either.</p>\n\n<p>Now, I've only been programming in C for about 6 months so I'm definitely a beginner. I'm becoming somewhat proficient but there's so much more to learn, and so much that I don't know about regarding the language.</p>\n\n<p>Warnings I'm getting are:</p>\n\n<pre><code>    warning: format '%s' expects argument of type 'char *', but argument 2 has type 'char * (*)[20]' [-Wformat=]|\n</code></pre>\n\n<p>for both the fields that are skipped. Is this because arrays are technically pointers? I tried changing a few things around, but like I said my books struct uses exactly the same logic as the students one, and I have an add_books function which is more or less the same as the students one provided which works without any hiccups.</p>\n\n<p>Any help would be greatly appreciated and hopefully this question can help others in the future. Thanks guys and gals.</p>\n\n<p>edited to add the student_confirm() function:</p>\n\n<pre><code>int student_confirm(){ //Function to confirm adding of student\n  int x = 10;\n  char answer;\n  system(\"cls\");window();\n  printf(\"\\n\\n\\n\");\n  gotoxy(x,5);printf(\"Confirm you would like to add a new student: (Y/N)\");\n  if(getch() == 'y' || answer == 'Y')\n  student_data(answer);\n\n return 1;\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["c", "string", "scanf"], "comments": [{"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1525295262, "post_id": 50143550, "comment_id": 87305326, "body": "<code>calloc(0,sizeof(char));</code> doesn&#39;t give you enough space to use with <code>scanf(&quot;%s&quot;, texto)</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1525296696, "post_id": 50143550, "comment_id": 87305913, "body": "If you put <code>scanf(&quot;%c&quot;,&amp;del)</code> after the string input, it will take the newline remaining in the input buffer. Put a space before <code>%c</code> as in <code>scanf(&quot; %c&quot;,&amp;del)</code> because unlike most format specifiers, <code>%c</code> does not automatically skip whitespace remaining from the previous input. This one of the most frequent C problems."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1525297719, "post_id": 50143550, "comment_id": 87306330, "body": "Use good names instead of i,j.  Also, there is no reason to pass 0,0 as the initial values, they should be declared and initialized inside the routine."}], "answers": [{"tags": [], "owner": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "is_accepted": false, "score": 0, "last_activity_date": 1525296180, "last_edit_date": 1525296180, "creation_date": 1525295684, "answer_id": 50143664, "question_id": 50143550, "link": "https://stackoverflow.com/questions/50143550/so-if-i-scanfc-del-before-reading-the-string-it-works-but-after-it-doesn/50143664#50143664", "title": "So if I scanf(&quot;%c&quot;,del), before reading the string, it works, but after it doesn&#39;t", "body": "<p>You are only allocating space for one <code>char</code></p>\n\n<pre><code>texto = (char*)calloc(0, sizeof(char));\n</code></pre>\n\n<p>You need to allocate enough space for your entire string, including NULL terminator, this will let you have a string of 20 chars plus a NULL terminator</p>\n\n<pre><code>texto = (char*)calloc(21,  sizeof(char));\n</code></pre>\n\n<p>And you should at the very least control how many characters you can read into your string in <code>scanf()</code> so you can't overflow your buffer</p>\n\n<pre><code>scanf(\"%20s\", texto);\n</code></pre>\n\n<p>For safer and more robust user input, you should look up <code>fgets()</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 3624, "user_id": 8013471, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jh4jO.jpg?s=128&g=1", "display_name": "cse", "link": "https://stackoverflow.com/users/8013471/cse"}, "is_accepted": false, "score": 0, "last_activity_date": 1525295685, "creation_date": 1525295685, "answer_id": 50143665, "question_id": 50143550, "link": "https://stackoverflow.com/questions/50143550/so-if-i-scanfc-del-before-reading-the-string-it-works-but-after-it-doesn/50143665#50143665", "title": "So if I scanf(&quot;%c&quot;,del), before reading the string, it works, but after it doesn&#39;t", "body": "<p>The problem is that you have redeclared <code>del</code> in line:</p>\n\n<pre><code>char del;\nscanf(\"%c\",&amp;del);\n</code></pre>\n\n<p>So just remove second deceleration of <code>del</code>. </p>\n"}, {"tags": [], "owner": {"reputation": 4703, "user_id": 5375464, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3292ca87ff6c766b75dbe4b2ea0831da?s=128&d=identicon&r=PG&f=1", "display_name": "J...S", "link": "https://stackoverflow.com/users/5375464/j-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1525322089, "creation_date": 1525322089, "answer_id": 50147038, "question_id": 50143550, "link": "https://stackoverflow.com/questions/50143550/so-if-i-scanfc-del-before-reading-the-string-it-works-but-after-it-doesn/50147038#50147038", "title": "So if I scanf(&quot;%c&quot;,del), before reading the string, it works, but after it doesn&#39;t", "body": "<p>You have problem reading <code>del</code> after reading the string because, <code>scanf()</code> used to read the string leaves the final <code>\\n</code> in the input buffer unconsumed if your format string is like</p>\n\n<pre><code>scanf(\"%s\", stringname);\nscanf(\"%c\", charactername);\n</code></pre>\n\n<p>You could solve this by</p>\n\n<pre><code>scanf(\"%s\", stringname);\nscanf(\" %c\", charactername);\n</code></pre>\n\n<p>adding a space before the <code>%c</code> in the <code>scanf()</code> used to read the character. This will consume any white space character still left in the input buffer before reading the actual character.</p>\n\n<p>This is because for <code>%c</code> leading white space is not automatically skipped.</p>\n\n<p>Note that you are allocating memory only for a single character with</p>\n\n<pre><code>char* texto;\ntexto=(char*)calloc(0,sizeof(char));\n</code></pre>\n\n<p>instead you could do</p>\n\n<pre><code>char* texto;\ntexto=calloc(0,sizeof(char)*10);\n</code></pre>\n\n<p>where <code>10</code> is the size of the string including the <code>\\0</code> character. So you can read maximum 9 characters into <code>texto</code> otherwise overflow will occur.</p>\n\n<p>To avoid the overflow, while reading with <code>scanf()</code> use a width specifier as in </p>\n\n<pre><code>scanf(\"%9s\", texto);\n</code></pre>\n\n<p>You don't need to explicitly cast the return value of <code>calloc()</code> in C. The conversion to <code>char *</code> from the <code>void *</code> returned by <code>calloc()</code> will be done implicitly.</p>\n\n<p>And to delete you could just do</p>\n\n<pre><code>char* deleteChar(char* texto,int n,char del,int i,int j)\n{\n    char *ptr=strchr(texto, del);\n    if(ptr!=NULL)\n    {\n        sprintf(texto, \"%.*s%s\", ptr-texto, ptr+1);\n    }   \n}\n</code></pre>\n\n<p>You don't need to return <code>texto</code> because what was passed is an array.</p>\n\n<pre><code>char* deleteChar(char* texto,int n,char del,int i,int j)\n{\n    char *ptr=strchr(texto, del);\n    if(ptr!=NULL)\n    {\n        sprintf(texto, \"%.*s%s\", ptr-texto, texto, ptr+1);\n    }   \n}\n</code></pre>\n\n<p><code>strchr()</code> is used to get the first occurrence of a character in a string. </p>\n\n<p>Also, the return type of <code>main()</code> shouldn't be <code>void</code>. See <a href=\"https://stackoverflow.com/q/10915713/5375464\">Return type of main function</a>.</p>\n"}], "owner": {"reputation": 27, "user_id": 9719535, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211659746110109/picture?type=large", "display_name": "Matheus Dias", "link": "https://stackoverflow.com/users/9719535/matheus-dias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1525322172, "creation_date": 1525295193, "last_edit_date": 1525322172, "question_id": 50143550, "link": "https://stackoverflow.com/questions/50143550/so-if-i-scanfc-del-before-reading-the-string-it-works-but-after-it-doesn", "title": "So if I scanf(&quot;%c&quot;,del), before reading the string, it works, but after it doesn&#39;t", "body": "<p>So I made a program for deleting a char from a string, it looks like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nchar* deleteChar(char* texto,int n,char del,int i,int j)\n{\n    /*for(i=0,j=0;i&lt;n;i++)\n        if(texto[i]!=del)\n        {\n            texto[j]=texto=i;\n            j=+1;\n        }\n        for(n-i;n-i&lt;n;i--)\n            texto[n-i]=NULL;\n        return(texto);*/\n\n    if(i!=n)\n    {\n        if(texto[i]!=del)\n        {\n            texto[j]=texto[i];\n            j+=1;\n        }\n        i+=1;\n        texto=deleteChar(texto,n,del,i,j);\n    }\n    else\n    {\n        i=i-j;\n        for(n-i;n-i&lt;n;i--)\n            texto[n-i]=NULL;\n        return(texto);\n    }\n}\n\nvoid main()\n{\n    char del;\n    printf(\"Remover: \\n\");\n    scanf(\"%c\",&amp;del);\n\n    char* texto;\n    texto=(char*)calloc(0,sizeof(char));\n    printf(\"Texto: \\n\");\n    scanf(\"%s\",texto);\n    int n=0;\n    n=strlen(texto);\n\n    /*char del;\n    scanf(\"%c\",&amp;del);*/\n\n    texto=deleteChar(texto,n,del,0,0);\n    printf(\"%s \",texto);\n}\n</code></pre>\n\n<p>Focus on <code>main()</code>, for some reason if I <code>scanf(\"%c\",&amp;del)</code> after getting my string, the program breaks (before even getting the <code>del</code> input'), but if I do it after it works greatly.\nI have no idea why.</p>\n"}, {"tags": ["c", "bash", "string-formatting", "exploit"], "comments": [{"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1525291706, "post_id": 50142714, "comment_id": 87303675, "body": "It&#39;s very much by design and intent that you can&#39;t. That said, this wouldn&#39;t have worked for any old version of bash either -- in old versions, strings just got cut off at the first NUL, rather than having the NULs removed."}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 1, "creation_date": 1525291831, "post_id": 50142714, "comment_id": 87303726, "body": "Keep in mind that the argument vector is a list of C strings. C strings are NUL-delimited, so by definition they can&#39;t have NUL literals inside them -- any such literal would just be the end of the string."}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1525292185, "post_id": 50142714, "comment_id": 87303898, "body": "(Building shellcode without using NUL literals is a thing -- I&#39;m sure you can find resources on the topic if you look)."}, {"owner": {"reputation": 56, "user_id": 9730585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6eefd50913bc953a8f38d6d55c9d73b?s=128&d=identicon&r=PG&f=1", "display_name": "J0rdan", "link": "https://stackoverflow.com/users/9730585/j0rdan"}, "reply_to_user": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1525292397, "post_id": 50142714, "comment_id": 87303993, "body": "In the book I&#39;m reading the test_val lies at 0x08049794, so the author has no problem with the null byte."}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1525292414, "post_id": 50142714, "comment_id": 87304002, "body": "Right -- the author isn&#39;t even <i>trying</i> to pass a NUL byte there. But for your actual memory address, which contains a NUL byte in it, you need to use techniques they aren&#39;t teaching or demonstrating (and which are outside the scope of a reasonable question about bash)."}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1525292495, "post_id": 50142714, "comment_id": 87304053, "body": "BTW, there&#39;s no reason to use Python here. <code>$&#39;\\x2c&#39;</code> is the Bash literal for the byte with hex value 0x2c."}, {"owner": {"reputation": 56, "user_id": 9730585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6eefd50913bc953a8f38d6d55c9d73b?s=128&d=identicon&r=PG&f=1", "display_name": "J0rdan", "link": "https://stackoverflow.com/users/9730585/j0rdan"}, "reply_to_user": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1525292522, "post_id": 50142714, "comment_id": 87304065, "body": "I&#39;m not trying to built a shellcode. I&#39;m just trying to push the address of test_val on the stack Charles Duffy"}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1525292540, "post_id": 50142714, "comment_id": 87304073, "body": "Yes, but if that address contains a NUL byte -- <code>0x00</code> -- you <b>can&#39;t</b>. Not on an argv from bash, anyhow."}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1525292610, "post_id": 50142714, "comment_id": 87304109, "body": "...now, you actually <i>can</i> get a NUL byte in memory by splitting your argument list into two separate strings passed as different arguments (the first one being the pre-NUL piece, the second being the post-NUL piece), but that still doesn&#39;t help you, because the second string isn&#39;t <code>argv[1]</code>."}, {"owner": {"reputation": 56, "user_id": 9730585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6eefd50913bc953a8f38d6d55c9d73b?s=128&d=identicon&r=PG&f=1", "display_name": "J0rdan", "link": "https://stackoverflow.com/users/9730585/j0rdan"}, "reply_to_user": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1525292618, "post_id": 50142714, "comment_id": 87304111, "body": "I used python just to make my problem clear @CharlesDuffy"}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 1, "creation_date": 1525292777, "post_id": 50142714, "comment_id": 87304204, "body": "Doesn&#39;t matter. The point I&#39;m making holds -- the code given in your book <i>does not work</i> when the address contains a 0 byte, and never did with any version of bash that ever existed, even versions that didn&#39;t have the &quot;warning: ignored null byte&quot; error message."}, {"owner": {"reputation": 56, "user_id": 9730585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6eefd50913bc953a8f38d6d55c9d73b?s=128&d=identicon&r=PG&f=1", "display_name": "J0rdan", "link": "https://stackoverflow.com/users/9730585/j0rdan"}, "reply_to_user": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1525292840, "post_id": 50142714, "comment_id": 87304244, "body": "I know and this is driving me mad"}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1525293023, "post_id": 50142714, "comment_id": 87304327, "body": "...so, I&#39;d argue that what you have here is purely a C question -- ie. that if you want to get content onto the stack, you&#39;re better off not trying to use bash to do it (at least, not via the argv). I suppose you could do a length-based copy of a buffer from stdin -- that&#39;ll work well enough."}, {"owner": {"reputation": 56, "user_id": 9730585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6eefd50913bc953a8f38d6d55c9d73b?s=128&d=identicon&r=PG&f=1", "display_name": "J0rdan", "link": "https://stackoverflow.com/users/9730585/j0rdan"}, "reply_to_user": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1525293393, "post_id": 50142714, "comment_id": 87304499, "body": "And how should I pass this as arguments for my vulnerable program?"}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1525293484, "post_id": 50142714, "comment_id": 87304540, "body": "I already gave you two options: Use stdin, or pass as two separate arguments (relying on the NUL delimiter between them), and change <code>strcpy</code> to something that won&#39;t stop at the NUL. (The problem isn&#39;t just a bash one -- <code>strcpy</code> will stop at the NUL itself). Either way, you&#39;ll need to change your C code, since it&#39;s <b>innately incapable</b> of working with an address with a NUL."}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1525293592, "post_id": 50142714, "comment_id": 87304582, "body": "Passing length out-of-band from content (and then trusting it without validation) is a very traditional way to get this kind of vulnerability, btw; if your <code>argv[1]</code> were used as length of <code>argv[2]</code>, but then you overran it into <code>argv[3]</code>, there you are."}], "owner": {"reputation": 56, "user_id": 9730585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6eefd50913bc953a8f38d6d55c9d73b?s=128&d=identicon&r=PG&f=1", "display_name": "J0rdan", "link": "https://stackoverflow.com/users/9730585/j0rdan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1414, "favorite_count": 3, "answer_count": 0, "score": 2, "last_activity_date": 1525291550, "creation_date": 1525291550, "question_id": 50142714, "link": "https://stackoverflow.com/questions/50142714/bash-warning-ignored-null-byte-in-input", "title": "bash: warning: ignored null byte in input", "body": "<p>I've recently programmed a little C program that is vulnerable to a format string exploit. Here is the source code(it is copied from a book):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\nint main(int argc, char *argv[]) {\n    char text[1024];\n    static int test_val = -72;\n    strcpy(text, argv[1]);\n    printf(\"The right way to print user-controlled input:\\n\");\n    printf(\"%s\", text);\n    printf(\"\\nThe wrong way to print user-controlled input:\\n\");\n    printf(text);\n    printf(\"\\n\");\n\n    printf(\"[*] test_val @ 0x%08x = %d 0x%08x\\n\", &amp;test_val, test_val, test_val);\n}\n</code></pre>\n\n<p>I want to change the value of the test_val variable which has the following address:0x0040202c.\nSo when i pass the arguments through the bash terminal like this:</p>\n\n<pre><code>./vuln \"`python -c \"print 'AAAA' + '\\x2c\\x20\\x40\\x00' + '%x ' * 5\"`\"\n</code></pre>\n\n<p>I get the following output</p>\n\n<pre><code>bash: warning: command substitution: ignored null byte in input\nThe right way to print user-controlled input:\nAAAA, @%x %x %x %x %x \nThe wrong way to print user-controlled input:\nAAAA, @bfffeed0 bfffef1c 4005f7 41414141 2540202c \n[*] test_val @ 0x0040202c = -72 0xffffffb8\n</code></pre>\n\n<p>As a result I end up with the wrong address in memory (0x2540202c instead of 0x0040202c).</p>\n\n<p>Now my question is: How can I produce the leading 0's and give them as an argument to my program?</p>\n"}, {"tags": ["c", "modem", "atmel"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1525285633, "post_id": 50141212, "comment_id": 87300681, "body": "This <code>&#39;OK&#39;</code> is probably not what you think it is. <code>&#39;</code> is for single chars(possibly multibyte)."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1525285680, "post_id": 50141212, "comment_id": 87300708, "body": "What are the strict warnings you get for this code?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1525285743, "post_id": 50141212, "comment_id": 87300735, "body": "Pleae make a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1525285907, "post_id": 50141212, "comment_id": 87300827, "body": "<code>*reply == &quot;OK&quot;</code> this does also not what you think it does. For comparing strings use the appropriate string compare function, otherwise you compare pointers which are guaranteed to be different."}], "answers": [{"comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 13, "user_id": 9641814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/834b21bedea83f7e887cfb1e6f4c7f30?s=128&d=identicon&r=PG&f=1", "display_name": "masebee", "link": "https://stackoverflow.com/users/9641814/masebee"}, "edited": false, "score": 0, "creation_date": 1525286570, "post_id": 50141357, "comment_id": 87301145, "body": "@masebee Note that you need to do this for the number comparisons as well since you have strings containing numbers and not actual numbers."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1525286640, "post_id": 50141357, "comment_id": 87301188, "body": "@dbush Good point. Thought it obvious but will add it to the answer, if you do not mind."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 1, "creation_date": 1525286687, "post_id": 50141357, "comment_id": 87301209, "body": "@Yunnosch Go ahead."}], "tags": [], "owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "is_accepted": true, "score": 1, "last_activity_date": 1525286888, "last_edit_date": 1525286888, "creation_date": 1525286098, "answer_id": 50141357, "question_id": 50141212, "link": "https://stackoverflow.com/questions/50141212/evaluating-serial-replies-with-if-statement/50141357#50141357", "title": "Evaluating serial replies with if statement", "body": "<p>See <a href=\"http://en.cppreference.com/w/c/string/byte/strcmp\" rel=\"nofollow noreferrer\">http://en.cppreference.com/w/c/string/byte/strcmp</a></p>\n\n<p>For comparing the string <code>\"OK\"</code> (note the different quotes than in your code)<br>\nwith what a <code>char* reply</code> points to, use</p>\n\n<pre><code>strcmp(reply, \"OK\")\n</code></pre>\n\n<p>Note that this returns 0 for identity.<br>\nHence, an <code>if</code> similar to what you seem to try would be</p>\n\n<pre><code>if(!strcmp(reply, \"OK\"))\n</code></pre>\n\n<p>As mentioned by dbush in comment:<br>\nNote that you need to do this for the number comparisons as well, since you have strings containing numbers and not actual numbers.<br>\nSome of them (those comparing to a single character) misleadingly work, because you accidentally compare the first character of your reply string with a single-character char literal.</p>\n\n<p><em>(As usual for \"string\" read \"null-terminated sequence of <code>char</code>s.)</em></p>\n"}], "owner": {"reputation": 13, "user_id": 9641814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/834b21bedea83f7e887cfb1e6f4c7f30?s=128&d=identicon&r=PG&f=1", "display_name": "masebee", "link": "https://stackoverflow.com/users/9641814/masebee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 50141357, "answer_count": 1, "score": 1, "last_activity_date": 1525286888, "creation_date": 1525285526, "question_id": 50141212, "link": "https://stackoverflow.com/questions/50141212/evaluating-serial-replies-with-if-statement", "title": "Evaluating serial replies with if statement", "body": "<p>I am trying to read network statuses from a modem using an atmel MCU, and then debug/restart based on certain status replies. I do so with the following code (and this works):</p>\n\n<pre><code>scanf(\"%s\", state);\nprintf_P(PSTR(\"%s\\n%d\\n\"),state,tempstate);\n\n    if (*state=='4'|| *state=='7' || *state == '9' || *state == '11' || *state == '12' || *state == '13' ||*state == '19' || *state == '30' || *state == '31')\n    {\n        count++;\n        if(count == 5)\n            {\n                send_string(\"ATZ\\r\");\n                _delay_ms(10000);\n                count = 0;\n            }\n        else{}\n    }\n</code></pre>\n\n<p>However, when trying to do something similar in a pin change interrupt (used for a door switch) I can read the modem reply 'OK', but when trying to confirm that reply with an if statement, the reply is not recognized. See below.</p>\n\n<pre><code>    send_string(\"AT\\r\\n\");\n    scanf(\"%s\", reply);\n    printf_P(PSTR(\"\\n%s\"),reply);\n\n    if (*reply == 'OK')\n    {\n    printf_P(PSTR(\"\\nWill text contact now.\"));\n    send_string(\"AT*SMSM2M=\\\"15555555TESTING\\\"\\r\");\n    scanf(\"%s\", reply);\n    }\n</code></pre>\n\n<p>I cannot manage to get my code to enter that if statement after the 'OK' is received. Any help is appreciated. </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1525286127, "post_id": 50141195, "comment_id": 87300929, "body": "Use gdb for step-by-step debugging and valgrind for finding memory errors."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 2, "creation_date": 1525287701, "post_id": 50141195, "comment_id": 87301665, "body": "I recommend to remove the part which asks for book/tutorial. That part is off-topic. Instead spend more effort on describing how exactly your program misbehaves, e.g. do some debugging to find the exact line with the segfault."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 1, "creation_date": 1525288441, "post_id": 50141195, "comment_id": 87302054, "body": "The man page for <code>gets</code> even says &quot;Never use gets&quot;.  Take its advice and use <code>fgets</code>."}], "answers": [{"comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1525437483, "post_id": 50141368, "comment_id": 87367230, "body": "The first code example you provide is incorrect.   Given <code>array</code> is created as:  <code>char **array;</code> in the original post, the line in your answer: <code>*array=malloc(n*sizeof(char*));</code> will compile and build, but will result in dereferencing a null pointer at run-time.  This in turn will crash the program.  Remove the <code>*</code>...    <code>array=malloc(n*sizeof(char*));</code>.  You may have been thinking of using <code>*array</code> rather than the hard type in the malloc statement? eg.  <code>array = malloc(n*sizeof(*array));</code>  (this is fine, and in fact preferred)"}], "tags": [], "owner": {"reputation": 195, "user_id": 4432916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/773f5c33058603089e08b3f435dabde3?s=128&d=identicon&r=PG&f=1", "display_name": "thomachan", "link": "https://stackoverflow.com/users/4432916/thomachan"}, "is_accepted": false, "score": 1, "last_activity_date": 1525457944, "last_edit_date": 1525457944, "creation_date": 1525286138, "answer_id": 50141368, "question_id": 50141195, "link": "https://stackoverflow.com/questions/50141195/array-of-pointers-using-malloc-the-code-runs-into-a-segmentation-fault-help/50141368#50141368", "title": "Array of pointers using malloc : The code runs into a segmentation fault. Help! Thanks", "body": "<p>you allocated memory for pointer to pointer, but forgot to allocate for individual pointers( ie the strings).</p>\n\n<p>it can be modified as,</p>\n\n<pre><code>array=malloc(n*sizeof(char*));\n</code></pre>\n\n<p>to allocate memory for storing all the pointers for the strings.</p>\n\n<p>and </p>\n\n<pre><code>for( i = 0; i&lt;n; i++)\n{\n     array[i] = malloc(&lt;max length of string&gt;);\n}\n</code></pre>\n\n<p>then only you will have memory space allocated to store the strings</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 9731740, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MyBCoszPj0g/AAAAAAAAAAI/AAAAAAAAAY0/tTEGTEOSCYI/photo.jpg?sz=128", "display_name": "Milo", "link": "https://stackoverflow.com/users/9731740/milo"}, "edited": false, "score": 0, "creation_date": 1525290881, "post_id": 50142177, "comment_id": 87303281, "body": "Thanks a lot. your comment cleared a lot of doubts that I had in mind. and thanks for the last part, I almost forgot that I had to free the allocated memory as well. Thanks again &lt;3"}], "tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": true, "score": 0, "last_activity_date": 1525439470, "last_edit_date": 1525439470, "creation_date": 1525289426, "answer_id": 50142177, "question_id": 50141195, "link": "https://stackoverflow.com/questions/50141195/array-of-pointers-using-malloc-the-code-runs-into-a-segmentation-fault-help/50142177#50142177", "title": "Array of pointers using malloc : The code runs into a segmentation fault. Help! Thanks", "body": "<p>Your memory allocation for:</p>\n\n<pre><code>char **array;\narray=malloc(n*sizeof(char*)); //acquire storage for an array of pointes of size n//\n</code></pre>\n\n<p>only allocates memory for a set of pointers, but none for the space that is needed for the strings the pointers will point to.  A function can be defined to encapsulate these steps:</p>\n\n<pre><code>char **array = Create2DStr(numberOfStrings, maxLengthOfString);\n</code></pre>\n\n<p>Where <code>Create2DStr</code> can be implemented as follows: </p>\n\n<pre><code>char ** Create2DStr(ssize_t numStrings, ssize_t maxStrLen)\n{\n    int i;\n    char **a = {0};\n    a = calloc(numStrings, sizeof(char *));// Creates a set of pointers.\n    for(i=0;i&lt;numStrings; i++)\n    {\n      a[i] = calloc(maxStrLen + 1, 1);//creates space for strings pointed to.\n    }\n    return a;\n}\n</code></pre>\n\n<p>Caution:<br>\n - If creating memory in a loop using the same pointer, you should be familiar with <em><a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_realloc.htm\" rel=\"nofollow noreferrer\">realloc()</a></em><br>\n - <em>maxStrLen</em> in example should contain 1 byte more than the length of the longest string you need to accommodate.<br>\n - Do not forget to free everything you created in the reverse order they were created, i.e. free space for strings first (<code>maxStrLen</code> calls to <code>free()</code>), then free the pointers to each string last (1 call to <code>free()</code>)).   See following example:</p>\n\n<pre><code>free2DStr(&amp;array,numStrings);\n</code></pre>\n\n<p>The implementation of <code>free2DStr</code> can be done many ways, see below for an example.     </p>\n\n<pre><code>void free2DStr(char *** a, ssize_t numStrings)\n{\n    int i;\n    if(!(*a)) return;\n    for(i=0;i&lt;numStrings; i++)\n    {\n        if((*a)[i]) \n        {\n            free((*a)[i]);\n            (*a)[i] = NULL;\n        }\n    }\n    free((*a));\n    (*a) = NULL;\n}\n</code></pre>\n\n<p>Note that in this implementation the <em>address of</em> the object is used in the first argument to provide access to free the pointers residing at that location.</p>\n"}], "owner": {"reputation": 3, "user_id": 9731740, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MyBCoszPj0g/AAAAAAAAAAI/AAAAAAAAAY0/tTEGTEOSCYI/photo.jpg?sz=128", "display_name": "Milo", "link": "https://stackoverflow.com/users/9731740/milo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 50142177, "answer_count": 2, "score": 0, "last_activity_date": 1525457944, "creation_date": 1525285453, "last_edit_date": 1525288700, "question_id": 50141195, "link": "https://stackoverflow.com/questions/50141195/array-of-pointers-using-malloc-the-code-runs-into-a-segmentation-fault-help", "title": "Array of pointers using malloc : The code runs into a segmentation fault. Help! Thanks", "body": "<p>it seems I'm a bit confused here. As with the use of a pointer to an array of pointers. if I could fetch more info regarding the error, I would have. All I received is a code for a segmentation fault. Thanks :) </p>\n\n<p><strong>a program to find the longest input string.</strong></p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;malloc.h&gt;\n\nint main()\n{\n char **array;\n int i, n, *L, maxlen;\n\n\n printf(\"Enter the number of strings that you wish to store : \");\n scanf(\"%d\", &amp;n);\n\n array=malloc(n*sizeof(char*)); //acquire storage for an array of pointes of size n//\n L=malloc(sizeof(int)*n);// for the length array//\n for(i=0;i&lt;n;i++)\n {\n    printf(\"Enter string %d : \", i+1); //sometimes, prints upto this//\n    gets(array[i]); //sometimes skips the first string input and jumps to the second and stops at the third//\n    L[i]=strlength(array[i]);\n }\n maxlen=0;\n for(i=0;i&lt;n;i++)\n {\n    if(L[i]&gt;maxlen)\n        maxlen=L[i];\n }\n\n  printf(\"The string(s) with the maximum length with length %d are : \", maxlen);\n for(i=0;i&lt;n;i++)\n {\n     if(L[i]==maxlen)\n    {\n        printf(\"\\n%s.\", array[i]);\n    }\n }\n  return 0;\n }\n\nint strlength(char *array)\n{\nint j=0;\nwhile(array[j]!='\\0')\n  {\n\n    j++;\n  }\nreturn j;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1525285604, "post_id": 50141181, "comment_id": 87300668, "body": "Check the return value of <code>fopen_s</code>.  It returns 0 if successful."}, {"owner": {"reputation": 64, "user_id": 5120632, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4f4688202640c31ee3b499396d767349?s=128&d=identicon&r=PG", "display_name": "Mitchell Welch", "link": "https://stackoverflow.com/users/5120632/mitchell-welch"}, "reply_to_user": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1525285840, "post_id": 50141181, "comment_id": 87300786, "body": "@MFisherKDX how would I go about doing this? I set a breakpoint on the line where fp1 = fopen_s and checked the value of fp1. It says fp1 -&gt; _Placeholder - &lt;unable to read memory&gt; as the value."}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1525286015, "post_id": 50141181, "comment_id": 87300879, "body": "see my answer for more details"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1525286082, "post_id": 50141181, "comment_id": 87300911, "body": "Your code is invalid. The compiler clearly told you what the problem is. Did you just ignore the diagnostic message? The return value of <code>fopen_s</code> is an integer. It cannot be used to initialize a <code>FILE *</code> pointer."}], "answers": [{"tags": [], "owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "is_accepted": true, "score": 0, "last_activity_date": 1525286132, "last_edit_date": 1525286132, "creation_date": 1525285809, "answer_id": 50141287, "question_id": 50141181, "link": "https://stackoverflow.com/questions/50141181/issue-with-saving-3d-array-to-file/50141287#50141287", "title": "Issue with saving 3D array to file", "body": "<p><code>fopen_s</code> returns 0 if successful.  So your code:</p>\n\n<pre><code>FILE *fp1 = fopen_s(&amp;fp1, \"saves/board.csv\", \"wb\");  //create a file\nif (fp1 == NULL) {\n    printf(\"Error while opening the file.\\n\");\n</code></pre>\n\n<p>is wrong in that on success it overwrites the value <code>fp1</code> to zero and prints out </p>\n\n<blockquote>\n  <p>Error while opening the file.</p>\n</blockquote>\n\n<p>Instead try</p>\n\n<pre><code>FILE *fp1 = NULL;\nerrno_t ret = fopen_s(&amp;fp1, \"saves/board.csv\", \"wb\");\nif (!ret) {\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 0, "last_activity_date": 1525285858, "creation_date": 1525285858, "answer_id": 50141300, "question_id": 50141181, "link": "https://stackoverflow.com/questions/50141181/issue-with-saving-3d-array-to-file/50141300#50141300", "title": "Issue with saving 3D array to file", "body": "<p>You're using the <code>fopen_s</code> function incorrectly.  The function is declared as:</p>\n\n<pre><code>errno_t fopen_s(   \n   FILE** pFile,  \n   const char *filename,  \n   const char *mode   \n);  \n</code></pre>\n\n<p>You're assigning the return value, which is an error code, to your file descriptor.  Assuming the function returns successfully, the returned value is 0.  When assigning this value to a pointer, it's the same as assigning NULL.</p>\n\n<p>You should instead just check the return value without assigning it to <code>fp1</code>:</p>\n\n<pre><code>FILE *fp1;\nif (fopen_s(&amp;fp1, \"saves/board.csv\", \"wb\"))\n{\n    ...\n</code></pre>\n"}], "owner": {"reputation": 64, "user_id": 5120632, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4f4688202640c31ee3b499396d767349?s=128&d=identicon&r=PG", "display_name": "Mitchell Welch", "link": "https://stackoverflow.com/users/5120632/mitchell-welch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 50141287, "answer_count": 2, "score": 1, "last_activity_date": 1525286132, "creation_date": 1525285378, "question_id": 50141181, "link": "https://stackoverflow.com/questions/50141181/issue-with-saving-3d-array-to-file", "title": "Issue with saving 3D array to file", "body": "<p>For class I have made a chess game where I am trying to save the current board state to a csv file.</p>\n\n<p>I am using the following code:</p>\n\n<pre><code>    mkdir(\"saves\");\nFILE *fp1 = fopen_s(&amp;fp1, \"saves/board.csv\", \"wb\");  //create a file\nif (fp1 == NULL)\n{\n    printf(\"Error while opening the file.\\n\");\n    perror(\"Error: \");\n    return 0;\n}\n\nfwrite(board, sizeof(char), sizeof(board), fp1);\nfclose(fp1);\n</code></pre>\n\n<p>but it is erroring out on the fp1 == null. The perror is printing out \"File exists\" and it won't go any further. It creates the file (so if i change board.csv to something else that file would be created) but no data is saved to it. I don't understand why the file existing is causing it to error as surely it knows it just created it to write?</p>\n\n<p>The board is initalised as as board[8][8][2].</p>\n\n<p>Any help with this would be great :)</p>\n"}, {"tags": ["c", "arrays", "segmentation-fault", "pass-by-pointer"], "comments": [{"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 2, "creation_date": 1525284943, "post_id": 50141024, "comment_id": 87300359, "body": "precedence.  [] has higher precedence than *.  Use <code>(*data)[i][j]</code>"}, {"owner": {"reputation": 10709, "user_id": 3212865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B6qLg.jpg?s=128&g=1", "display_name": "spectras", "link": "https://stackoverflow.com/users/3212865/spectras"}, "edited": false, "score": 1, "creation_date": 1525284957, "post_id": 50141024, "comment_id": 87300373, "body": "Note: you&#39;re not creating a 2D array. Your creating a 1D array of pointers to 1D-arrays. Those are very different."}], "answers": [{"comments": [{"owner": {"reputation": 1587, "user_id": 5061485, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/2Ncmd.jpg?s=128&g=1", "display_name": "kingledion", "link": "https://stackoverflow.com/users/5061485/kingledion"}, "edited": false, "score": 0, "creation_date": 1525285171, "post_id": 50141096, "comment_id": 87300473, "body": "Thanks. This is a minimal example, so the triple pointer is necessary for the actual implementation."}], "tags": [], "owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "is_accepted": true, "score": 1, "last_activity_date": 1525285041, "creation_date": 1525285041, "answer_id": 50141096, "question_id": 50141024, "link": "https://stackoverflow.com/questions/50141024/why-did-my-array-get-transposed/50141096#50141096", "title": "Why did my array get transposed?", "body": "<p><code>*data[i][j]</code> does not do what you think. It is equivalent to <code>*(data[i][j])</code>. Your options are:</p>\n\n<ol>\n<li><p>Use <code>(*data)[i][j]</code> instead, or</p></li>\n<li><p>Pass <code>data</code> (instead of <code>&amp;data</code>) and use <code>data[i][j]</code> since passing a triple pointer isn't necessary here.</p></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 10709, "user_id": 3212865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B6qLg.jpg?s=128&g=1", "display_name": "spectras", "link": "https://stackoverflow.com/users/3212865/spectras"}, "edited": false, "score": 0, "creation_date": 1525285136, "post_id": 50141104, "comment_id": 87300454, "body": "That&#39;s ugly, use parenthesizes, like Kevin suggests."}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1525285165, "post_id": 50141104, "comment_id": 87300466, "body": "eh ... looks fine to me."}, {"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 1, "creation_date": 1525285265, "post_id": 50141104, "comment_id": 87300520, "body": "<i>ugly</i> is subjective. But to me <code>a[0]</code> has the meaning <i>access the first element of the array this points to</i> and <code>*a</code> has the meaning <i>dereference the pointer</i>. Even though they do the same thing the meaning is different."}], "tags": [], "owner": {"reputation": 1587, "user_id": 5061485, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/2Ncmd.jpg?s=128&g=1", "display_name": "kingledion", "link": "https://stackoverflow.com/users/5061485/kingledion"}, "is_accepted": false, "score": 1, "last_activity_date": 1525286153, "last_edit_date": 1525286153, "creation_date": 1525285076, "answer_id": 50141104, "question_id": 50141024, "link": "https://stackoverflow.com/questions/50141024/why-did-my-array-get-transposed/50141104#50141104", "title": "Why did my array get transposed?", "body": "<p>Sorry, just figured this out. The dereferencing using <code>[]</code> occurs before the deferencing using <code>*</code>. Therefore a call to <code>*data[i][j]</code> will cause the segmentation fault when i != 0, since the highest level pointer is only pointing to one thing, while the two lover levels of pointers point to arrays.</p>\n\n<p>A solution is to use <code>data[0][i][j]</code> instead. </p>\n"}], "owner": {"reputation": 1587, "user_id": 5061485, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/2Ncmd.jpg?s=128&g=1", "display_name": "kingledion", "link": "https://stackoverflow.com/users/5061485/kingledion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 50141096, "answer_count": 2, "score": 0, "last_activity_date": 1525286153, "creation_date": 1525284713, "question_id": 50141024, "link": "https://stackoverflow.com/questions/50141024/why-did-my-array-get-transposed", "title": "Why did my array get transposed?", "body": "<p>I want declare a 2D array of doubles (<code>double** data</code>). I want to pass this by address to a helper function; so I pass <code>&amp;data</code> and the helper function has argument <code>double*** d</code>.</p>\n\n<p>Passed this way, the indexing that I used for the 2D array in the main function is no longer working.</p>\n\n<p>Test code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid helperfunction(double*** data, int n, int c) {\n\n    printf(\"\\nIn helper function\\n\");\n\n    for (int i = 0; i &lt; n; i++) {\n        for (int j = 0; j &lt; c; j++) {\n            printf(\"(%i %i %lf) \", i, j, *data[i][j]);\n        }\n        printf(\"\\n\");\n    }\n\n}\n\nint main(int argc, char **argv) {\n\n    int n = 4; //number of rows\n    int c = 4; //number of columns\n\n    double count = 0.0;\n\n    double** data = malloc(n * sizeof(double*));\n\n    for (int i = 0; i &lt; n; i++) {\n        double* row = malloc(c * sizeof(double));\n        for (int j = 0; j &lt; c; j++) {\n            row[j] = count;\n            count += 1.2;\n        }\n        data[i] = row;\n    }\n\n    printf(\"In main function\\n\");\n\n    for (int i = 0; i &lt; n; i++) {\n        for (int j = 0; j &lt; c; j++) {\n            printf(\"(%i %i %lf) \", i, j, data[i][j]);\n        }\n        printf(\"\\n\");\n    }\n\n    helperfunction(&amp;data, n, c);\n\n    return 0;\n}\n</code></pre>\n\n<p>Output: </p>\n\n<pre><code>In main function\n(0 0 0.000000) (0 1 1.200000) (0 2 2.400000) (0 3 3.600000) \n(1 0 4.800000) (1 1 6.000000) (1 2 7.200000) (1 3 8.400000) \n(2 0 9.600000) (2 1 10.800000) (2 2 12.000000) (2 3 13.200000) \n(3 0 14.400000) (3 1 15.600000) (3 2 16.800000) (3 3 18.000000) \n\nIn helper function\n(0 0 0.000000) (0 1 4.800000) (0 2 9.600000) (0 3 14.400000) \nSegmentation fault (core dumped)\n</code></pre>\n\n<p>Obviously, something is wrong with the indexing when I deference the address (<code>*data[i][j]</code>) in the helper function. What is causing this?</p>\n"}, {"tags": ["c++", "c", "mingw", "mingw-w64"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1525283859, "post_id": 50140750, "comment_id": 87299858, "body": "What do you mean by &quot;variational arguments&quot;? There&#39;s no &quot;varargs&quot; here which is what I initially presumed you meant."}], "answers": [{"tags": [], "owner": {"reputation": 128, "user_id": 9560588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5183d03e3d4312d5660574befc9f026e?s=128&d=identicon&r=PG&f=1", "display_name": "VolkerG", "link": "https://stackoverflow.com/users/9560588/volkerg"}, "is_accepted": false, "score": 2, "last_activity_date": 1525283998, "creation_date": 1525283998, "answer_id": 50140861, "question_id": 50140750, "link": "https://stackoverflow.com/questions/50140750/possible-bug-with-variadic-arguments-on-mingw64-gcc/50140861#50140861", "title": "Possible bug with variadic arguments on mingw64-gcc", "body": "<p>The 0 in your <code>printf</code> has the wrong type, it is <code>int</code> not <code>long long</code>. Try to use <code>0ll</code> for the literal instead.</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 9731544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfcbe1ae75208026029993fff3525a61?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyT", "link": "https://stackoverflow.com/users/9731544/crazyt"}, "edited": false, "score": 0, "creation_date": 1525285275, "post_id": 50140862, "comment_id": 87300526, "body": "Well it wasn&#39;t reproduceable on a linux compiler so i thought it might be a compiler bug."}, {"owner": {"reputation": 13, "user_id": 9731544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfcbe1ae75208026029993fff3525a61?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyT", "link": "https://stackoverflow.com/users/9731544/crazyt"}, "edited": false, "score": 1, "creation_date": 1525285737, "post_id": 50140862, "comment_id": 87300733, "body": "Oh well ... lesson learned, &#39;-Wall&#39; would have worked on my example code."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 13, "user_id": 9731544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfcbe1ae75208026029993fff3525a61?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyT", "link": "https://stackoverflow.com/users/9731544/crazyt"}, "edited": false, "score": 0, "creation_date": 1525291899, "post_id": 50140862, "comment_id": 87303757, "body": "Yep! When in doubt, turn on <i>everything</i> to see if you&#39;ve missed something less than obvious. Happens to the best of us."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 2, "last_activity_date": 1525284003, "creation_date": 1525284003, "answer_id": 50140862, "question_id": 50140750, "link": "https://stackoverflow.com/questions/50140750/possible-bug-with-variadic-arguments-on-mingw64-gcc/50140862#50140862", "title": "Possible bug with variadic arguments on mingw64-gcc", "body": "<p>When I compile in <code>clang</code> I get this warning:</p>\n\n<blockquote>\n  <p>varby.cpp:12:63: warning: format specifies type 'unsigned long long' but the argument has type 'int' [-Wformat]</p>\n</blockquote>\n\n<p>This is probably the source of your issue as <code>0</code> is the wrong argument type.</p>\n\n<p>Fix it by making that a long-long as you want:</p>\n\n<pre><code>printf(\"but output is:\\n%llx %llx %llx %llx %llx\\n\",d,c,b,0LL,a);\n</code></pre>\n\n<p>A good rule of thumb is that one in a million bugs will be caused by the compiler, so always presume it's your fault until can prove otherwise. In this case turning on more warnings or trying to reproduce it in another compiler would've uncovered the problem.</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 9731544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfcbe1ae75208026029993fff3525a61?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyT", "link": "https://stackoverflow.com/users/9731544/crazyt"}, "edited": false, "score": 0, "creation_date": 1525284542, "post_id": 50140875, "comment_id": 87300185, "body": "Wow ... didn&#39;t expect that. Is there a reason they decided to make numbers just &#39;int&#39; instead of &#39;unsigned long long&#39; by default? I mean there could probably be alot of missing bugs that can&#39;t be fixed because you don&#39;t see them by compiler-warnings."}, {"owner": {"reputation": 13, "user_id": 9731544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfcbe1ae75208026029993fff3525a61?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyT", "link": "https://stackoverflow.com/users/9731544/crazyt"}, "edited": false, "score": 0, "creation_date": 1525284945, "post_id": 50140875, "comment_id": 87300361, "body": "Well the origin of my problem was actually the boost python library: <a href=\"https://github.com/boostorg/python/blob/develop/src/object/class.cpp#L621\" rel=\"nofollow noreferrer\">github.com/boostorg/python/blob/develop/src/object/&hellip;</a> Are i&#39;m right that in order to use that lib properly for 64-bit that i need to cast the 0&#39;s on that place?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 13, "user_id": 9731544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfcbe1ae75208026029993fff3525a61?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyT", "link": "https://stackoverflow.com/users/9731544/crazyt"}, "edited": false, "score": 0, "creation_date": 1525285193, "post_id": 50140875, "comment_id": 87300482, "body": "@CrazyT In this case, the format string is looking for a pointer to a null terminated string, so it should be passing in <code>(char *)NULL</code>  instead."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 3, "last_activity_date": 1525284088, "creation_date": 1525284088, "answer_id": 50140875, "question_id": 50140750, "link": "https://stackoverflow.com/questions/50140750/possible-bug-with-variadic-arguments-on-mingw64-gcc/50140875#50140875", "title": "Possible bug with variadic arguments on mingw64-gcc", "body": "<p>You have an argument type mismatch:</p>\n\n<pre><code> printf(\"but output is:\\n%llx %llx %llx %llx %llx\\n\",d,c,b,0,a);\n</code></pre>\n\n<p>The value 0 has type <code>int</code>, but the <code>%llx</code> format specifier is expecting a variable of type <code>unsigned long long int</code>.  Using the wrong format specifier invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.</p>\n\n<p>Because <code>printf</code> is a variadic function, it can't automatically convert this value to the proper type.  So you need to either use the correct format specifier:</p>\n\n<pre><code> printf(\"but output is:\\n%llx %llx %llx %d %llx\\n\",d,c,b,0,a);\n</code></pre>\n\n<p>Or cast the argument in question</p>\n\n<pre><code> printf(\"but output is:\\n%llx %llx %llx %llu %llx\\n\",d,c,b,(unsigned long long)0,a);\n</code></pre>\n\n<p>Or (in the case of a constant) use the proper type suffix</p>\n\n<pre><code> printf(\"but output is:\\n%llx %llx %llx %llu %llx\\n\",d,c,b,0ULL,a);\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9731544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfcbe1ae75208026029993fff3525a61?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyT", "link": "https://stackoverflow.com/users/9731544/crazyt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 50140875, "answer_count": 3, "score": -3, "last_activity_date": 1525284321, "creation_date": 1525283577, "last_edit_date": 1525284321, "question_id": 50140750, "link": "https://stackoverflow.com/questions/50140750/possible-bug-with-variadic-arguments-on-mingw64-gcc", "title": "Possible bug with variadic arguments on mingw64-gcc", "body": "<p>I had an annoying bug which I tried to track down, then I created an example and I'm still not 100% sure if it is a compiler problem.</p>\n\n<p>Let me give you some information about the version I used first.</p>\n\n<p><code>x86_64-w64-mingw32-g++  --version</code></p>\n\n<pre><code>x86_64-w64-mingw32-g++.exe (Rev1, Built by MSYS2 project) 7.2.0\nCopyright (C) 2017 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.  There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n</code></pre>\n\n<p>I know it is not the newest version, but it is the newest you could get for MSYS.</p>\n\n<p>This is the example code:</p>\n\n<pre><code>#include &lt;cstdint&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;cstdarg&gt;\n\nvoid test1(){\n    uint64_t a = 0x3333333333333333;\n    uint64_t b = 1;\n    uint64_t c = 2;\n    uint64_t d = 3;\n    printf(\"output should be:\\n3 2 1 0 3333333333333333\\n\");\n    printf(\"but output is:\\n%llx %llx %llx %llx %llx\\n\",d,c,b,0,a);\n}\nvoid test(uint64_t x1,uint64_t x2,uint64_t x3,uint64_t x4,uint64_t x5,uint64_t x6,\nuint64_t x21,uint64_t x22,uint64_t x23,uint64_t x24,uint64_t x25,uint64_t x26,\nuint64_t x31,uint64_t x32,uint64_t x33,uint64_t x34,uint64_t x35,uint64_t x36,\nuint64_t x41,uint64_t x42,uint64_t x43,uint64_t x44,uint64_t x45,uint64_t x46){\n    printf(\"start\\n\");\n}\nvoid test_(){\n        test(0x7777777777777771,0x7777777777777772,0x7777777777777773,0x7777777777777774,0x7777777777777775,0x7777777777777776,\n        0x7777777777777771,0x7777777777777772,0x7777777777777773,0x7777777777777774,0x7777777777777775,0x7777777777777776,\n        0x7777777777777771,0x7777777777777772,0x7777777777777773,0x7777777777777774,0x7777777777777775,0x7777777777777776,\n        0x7777777777777771,0x7777777777777772,0x7777777777777773,0x7777777777777774,0x7777777777777775,0x7777777777777776);\n}\nint main(int argc,char** argv){\n    test_();\n    test1();\n}\n</code></pre>\n\n<p>and compiled &amp; executed it with:</p>\n\n<p><code>x86_64-w64-mingw32-g++ -O0 test.cpp &amp;&amp; ./a.exe</code></p>\n\n<p>Now comes the surprising part, the output is:</p>\n\n<p><code>start\noutput should be:\n3 2 1 0 3333333333333333\nbut output is:\n3 2 1 7777777700000000 3333333333333333</code></p>\n\n<p>In the example above i use printf to produce and visualize the problem.</p>\n\n<p>It could happen on any other function instead of printf that uses variational arguments.</p>\n\n<p>For example: <code>void blah(a,b,...)</code></p>\n\n<p>For some reason the compiler does this unexpected thing.\nSearching by google didn't lead me to the right direction sadly.</p>\n\n<p>It leads me to the question if this is really a problem with the compiler (linux didn't have such a problem), or if it is a programming mistake (like forgetting to cast the 0 number).</p>\n\n<p>Taking a look at the disassembled code shows me the part that produces the problem:</p>\n\n<pre><code>objdump -M intel -S ./a.exe|egrep -A 30 'test1.+:'\n0000000000401570 &lt;_Z5test1v&gt;:\n  401570:       55                      push   rbp\n  401571:       48 89 e5                mov    rbp,rsp\n  401574:       48 83 ec 50             sub    rsp,0x50\n  401578:       48 b8 33 33 33 33 33    movabs rax,0x3333333333333333\n  40157f:       33 33 33\n  401582:       48 89 45 f8             mov    QWORD PTR [rbp-0x8],rax\n  401586:       48 c7 45 f0 01 00 00    mov    QWORD PTR [rbp-0x10],0x1\n  40158d:       00\n  40158e:       48 c7 45 e8 02 00 00    mov    QWORD PTR [rbp-0x18],0x2\n  401595:       00\n  401596:       48 c7 45 e0 03 00 00    mov    QWORD PTR [rbp-0x20],0x3\n  40159d:       00\n  40159e:       48 8d 0d 5b 7a 00 00    lea    rcx,[rip+0x7a5b]        # 409000 &lt;.rdata&gt;\n  4015a5:       e8 a6 66 00 00          call   407c50 &lt;_Z6printfPKcz&gt;\n  4015aa:       4c 8b 45 f0             mov    r8,QWORD PTR [rbp-0x10]\n  4015ae:       48 8b 4d e8             mov    rcx,QWORD PTR [rbp-0x18]\n  4015b2:       48 8b 45 e0             mov    rax,QWORD PTR [rbp-0x20]\n  4015b6:       48 8b 55 f8             mov    rdx,QWORD PTR [rbp-0x8]\n  4015ba:       48 89 54 24 28          mov    QWORD PTR [rsp+0x28],rdx\n  4015bf:       c7 44 24 20 00 00 00    mov    DWORD PTR [rsp+0x20],0x0\n  4015c6:       00\n  4015c7:       4d 89 c1                mov    r9,r8\n  4015ca:       49 89 c8                mov    r8,rcx\n  4015cd:       48 89 c2                mov    rdx,rax\n  4015d0:       48 8d 0d 59 7a 00 00    lea    rcx,[rip+0x7a59]        # 409030 &lt;.rdata+0x30&gt;\n  4015d7:       e8 74 66 00 00          call   407c50 &lt;_Z6printfPKcz&gt;\n  4015dc:       90                      nop\n  4015dd:       48 83 c4 50             add    rsp,0x50\n  4015e1:       5d                      pop    rbp\n  4015e2:       c3                      ret\n</code></pre>\n\n<p>and I have absolutely no clue why it uses that dword on offset 4015bf.\nMaybe somebody can shed some light on my problem or is able to test it with a newer mingw-version.</p>\n\n<p>(I already tried with a \"bionic beaver\" docker image of ubuntu, but sadly with the same result ... well it has the same version of x86_64-w64-mingw32-g++ anyway)</p>\n"}, {"tags": ["c", "operators", "ampersand"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 6, "creation_date": 1525283134, "post_id": 50140612, "comment_id": 87299467, "body": "<code>number&amp;-number</code> == <code>number &amp; (-number)</code>"}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1525283186, "post_id": 50140612, "comment_id": 87299495, "body": "It&#39;s just an operator-think unary minus and take it from there."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1525283213, "post_id": 50140612, "comment_id": 87299512, "body": "This is achieving -10 into the karma of the author of this code."}, {"owner": {"reputation": 40, "user_id": 6022781, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vKn8uTfON2A/AAAAAAAAAAI/AAAAAAAAACg/K8vO2dgh8xQ/photo.jpg?sz=128", "display_name": "Sinan Yumurtac\u0131", "link": "https://stackoverflow.com/users/6022781/sinan-yumurtac%c4%b1"}, "edited": false, "score": 0, "creation_date": 1525283277, "post_id": 50140612, "comment_id": 87299542, "body": "isn&#39;t that logical AND (which is supposed to return binary results)? I am getting 4 when I put in 4."}, {"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 1, "creation_date": 1525283347, "post_id": 50140612, "comment_id": 87299589, "body": "No, its binary AND."}, {"owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 0, "creation_date": 1525283690, "post_id": 50140612, "comment_id": 87299778, "body": "Isn&#39;t that taking the address of a temporary?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 0, "creation_date": 1525283929, "post_id": 50140612, "comment_id": 87299900, "body": "@DeiDei <code>-x</code> is not an lvalue."}, {"owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1525284137, "post_id": 50140612, "comment_id": 87299989, "body": "@EugeneSh. A temporary is not an lvalue either, no? What I meant was, doing <code>&amp;-x</code> causes undefined behavior. No?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 0, "creation_date": 1525284266, "post_id": 50140612, "comment_id": 87300063, "body": "@DeiDei What&#39;s &quot;temporary&quot;, anyway? The address can be taken only for result of <code>*</code>, <code>[]</code> or an lvalue as defined <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.5.3.2p1\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1525285783, "post_id": 50140612, "comment_id": 87300753, "body": "In this context, <code>&amp;</code> is the binary &quot;and&quot; operator. In other contexts, the same symbol is the unary address operator. Incidentally, <code>void main()</code> should be <code>int main(void)</code>. If you have a textbook that tells you to use <code>void main()</code>, its author doesn&#39;t know C well enough to be writing books about it."}], "answers": [{"tags": [], "owner": {"reputation": 40, "user_id": 6022781, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vKn8uTfON2A/AAAAAAAAAAI/AAAAAAAAACg/K8vO2dgh8xQ/photo.jpg?sz=128", "display_name": "Sinan Yumurtac\u0131", "link": "https://stackoverflow.com/users/6022781/sinan-yumurtac%c4%b1"}, "is_accepted": true, "score": 1, "last_activity_date": 1525283531, "creation_date": 1525283531, "answer_id": 50140739, "question_id": 50140612, "link": "https://stackoverflow.com/questions/50140612/what-does-using-ampersand-with-minus-operator-achieve/50140739#50140739", "title": "What does using ampersand (&amp;) with minus operator achieve?", "body": "<p>The ampersand is a binary AND operator. The minus is just a regular minus. Thanks to @tkausl</p>\n"}, {"comments": [{"owner": {"reputation": 5676, "user_id": 1574779, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/c25fada23fa21731be5f92ea16216424?s=128&d=identicon&r=PG", "display_name": "GPrathap", "link": "https://stackoverflow.com/users/1574779/gprathap"}, "edited": false, "score": 2, "creation_date": 1525286798, "post_id": 50141140, "comment_id": 87301260, "body": "Please provide a small description along with the code"}], "tags": [], "owner": {"reputation": 3, "user_id": 7290896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb8666281e063324f0dbbdef62fa1159?s=128&d=identicon&r=PG&f=1", "display_name": "Kamil", "link": "https://stackoverflow.com/users/7290896/kamil"}, "is_accepted": false, "score": 0, "last_activity_date": 1525285228, "creation_date": 1525285228, "answer_id": 50141140, "question_id": 50140612, "link": "https://stackoverflow.com/questions/50140612/what-does-using-ampersand-with-minus-operator-achieve/50141140#50141140", "title": "What does using ampersand (&amp;) with minus operator achieve?", "body": "<p>(number&amp;-number)   means   (number &amp; (-number))</p>\n"}, {"tags": [], "owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "is_accepted": false, "score": 6, "last_activity_date": 1525285528, "creation_date": 1525285528, "answer_id": 50141213, "question_id": 50140612, "link": "https://stackoverflow.com/questions/50140612/what-does-using-ampersand-with-minus-operator-achieve/50141213#50141213", "title": "What does using ampersand (&amp;) with minus operator achieve?", "body": "<p>This is a binary AND operator.  The expression <code>x &amp; -x</code> zeroes out all but the rightmost 1-bit in the number x. Then <code>x - (x &amp; -x)</code> zeroes only that bit, so the result is the original number with the rightmost 1-bit cleared.</p>\n"}], "owner": {"reputation": 40, "user_id": 6022781, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vKn8uTfON2A/AAAAAAAAAAI/AAAAAAAAACg/K8vO2dgh8xQ/photo.jpg?sz=128", "display_name": "Sinan Yumurtac\u0131", "link": "https://stackoverflow.com/users/6022781/sinan-yumurtac%c4%b1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 1, "accepted_answer_id": 50140739, "answer_count": 3, "score": -2, "last_activity_date": 1525285528, "creation_date": 1525283032, "question_id": 50140612, "link": "https://stackoverflow.com/questions/50140612/what-does-using-ampersand-with-minus-operator-achieve", "title": "What does using ampersand (&amp;) with minus operator achieve?", "body": "<p>I'm preparing for a programming contest and I have stumbled upon the question below.</p>\n\n<pre><code>void main(){\n    int number, result;\n    scanf(\"%d\",&amp;number);\n    result=number-(number&amp;-number); //this is what i'm struggling to understand\n    printf(\"%d\",result);  \n}\n</code></pre>\n\n<p>Note the use of \"&amp;-\" in the commented line. I couldn't figure out its function. I tried googling and reverse engineering but I couldn't find anything. </p>\n\n<p>Also, the question itself is not about the exact output because the variable \"number\" is dynamic. I just need to learn what the \"&amp;-\" part do.\nThanks!</p>\n"}, {"tags": ["c", "openal", "opus"], "comments": [{"owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "edited": false, "score": 0, "creation_date": 1525291277, "post_id": 50140595, "comment_id": 87303477, "body": "I&#39;m curious are you decoding the same number of bytes that you recorded to your raw buffer?  If you can post a link to those two files I&#39;d be willing to have a look."}], "answers": [{"tags": [], "owner": {"reputation": 3185, "user_id": 1519939, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6b475f2c218b347c815314aa5710264a?s=128&d=identicon&r=PG", "display_name": "Dmitry Poroh", "link": "https://stackoverflow.com/users/1519939/dmitry-poroh"}, "is_accepted": false, "score": 4, "last_activity_date": 1526070846, "creation_date": 1526070846, "answer_id": 50299892, "question_id": 50140595, "link": "https://stackoverflow.com/questions/50140595/encoding-pcm-and-decoding-opus-data-using-libopus-in-c/50299892#50299892", "title": "Encoding pcm and decoding opus data using libopus in C", "body": "<p>You cannot decode file.opus because you need some container to OPUS codec. This is important because OPUS is packet-oriented format. So it cannot decode stream of bytes. It can decode stream of packets.</p>\n\n<p>When you write packets to file one by one you loose packets boundaries and there is no way to restore them.</p>\n\n<p>You can choose one of possible formats:</p>\n\n<ul>\n<li>ogg</li>\n<li>matroska</li>\n</ul>\n\n<p>I think you can easily find convenient library to write them.</p>\n"}], "owner": {"reputation": 113, "user_id": 2760170, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000593318299/picture?type=large", "display_name": "Victor Queiroz", "link": "https://stackoverflow.com/users/2760170/victor-queiroz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1217, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1526070846, "creation_date": 1525282954, "last_edit_date": 1525283065, "question_id": 50140595, "link": "https://stackoverflow.com/questions/50140595/encoding-pcm-and-decoding-opus-data-using-libopus-in-c", "title": "Encoding pcm and decoding opus data using libopus in C", "body": "<p>I'm trying to encode incoming pcm data from hardware with libopus and then decode it using the same library but the result I'm getting is <code>decoded.raw</code> can be played using <code>aplay -t raw --rate=48000 --buffer-size=1920 --channels=1 --format=FLOAT_LE decoded.raw</code> command, but it's still just a white noise. <code>test.raw</code> file can be played with the same previous command just fine, no issues. But <code>test.opus</code> file can't be played in any manner whatsoever. Not sure what am I missing here, the data is being written just fine in <code>test.raw</code> so it's not a problem with recording strategy I think.</p>\n\n<pre><code>#include &lt;string&gt;\n#include &lt;AL/al.h&gt;\n#include &lt;AL/alc.h&gt;\n#include &lt;AL/alext.h&gt;\n#include &lt;opus/opus.h&gt;\n#include &lt;string.h&gt;\n\nint main() {\n    FILE* raw = fopen(\"test.raw\", \"w\");\n    FILE* opus = fopen(\"test.opus\", \"w\");\n    FILE* decoded = fopen(\"decoded.raw\", \"w\");\n    int i = 0;\n    size_t capture_frequency = 48000;\n    size_t samples_size = capture_frequency/25;\n    int channels_length = 1;\n\n    int error;\n    OpusEncoder* encoder = opus_encoder_create(capture_frequency, 1, OPUS_APPLICATION_VOIP, &amp;error);\n\n    if(error != OPUS_OK){\n        fprintf(stderr, \"failed to create codec\\n\");\n    }\n\n    const ALCchar* deviceName = alcGetString(NULL, ALC_CAPTURE_DEFAULT_DEVICE_SPECIFIER);\n    ALCdevice* device = alcCaptureOpenDevice(deviceName, capture_frequency, AL_FORMAT_MONO_FLOAT32, samples_size);\n\n    if(device == NULL) {\n        fprintf(stderr, \"could not open device\\n\");\n        return -1;\n    }\n\n    printf(\"Opened capture device \\\"%s\\\"\\n\", alcGetString(device, ALC_CAPTURE_DEFAULT_DEVICE_SPECIFIER));\n\n    alcCaptureStart(device);\n\n    OpusDecoder* decoder = opus_decoder_create(capture_frequency, channels_length, &amp;error);\n\n    if(error != OPUS_OK)\n        fprintf(stderr, \"failed to create decoder\\n\");\n\n    while(alcGetError(device) == ALC_NO_ERROR &amp;&amp; i &lt; 1000){\n        ALCint availableSamples = 0;\n        alcGetIntegerv(device, ALC_CAPTURE_SAMPLES, 1, &amp;availableSamples);\n\n        if(availableSamples &lt; samples_size)\n            continue;\n\n        float* buffer = (float*)malloc(samples_size*channels_length*sizeof(float));\n        alcCaptureSamples(device, buffer, samples_size);\n\n        printf(\"got %d samples, we needed %d\\n\", samples_size, samples_size);\n\n        unsigned char* output = (unsigned char*) malloc(4000);\n        int bytes_written = opus_encode_float(encoder, buffer, samples_size, output, 4000);\n\n        if(bytes_written &lt; 0){\n            if(bytes_written == OPUS_BAD_ARG)\n                fprintf(stderr, \"invalid args\\n\");\n            else\n                fprintf(stderr, \"failed to encode\\n\");\n            continue;\n        } else {\n            printf(\"got output from encoder %d\\n\", bytes_written);\n        }\n        fwrite(output, bytes_written, 1, opus);\n\n        float* output_pcm = (float*) malloc(samples_size*sizeof(float));\n        int decoded_bytes = opus_decode_float(decoder, output, bytes_written, output_pcm, samples_size, 1);\n\n        if(decoded_bytes &lt; 1)\n            fprintf(stderr, \"failed to decode bytes\\n\");\n        else {\n            printf(\"%d bytes decoded\\n\", decoded_bytes);\n        }\n\n        fwrite(output_pcm, samples_size*sizeof(float), 1, decoded);\n        fwrite(buffer, samples_size*sizeof(float), 1, raw);\n        i++;\n    }\n\n    fclose(opus);\n    fclose(raw);\n    fclose(decoded);\n    alcCaptureStop(device);\n    alcCaptureCloseDevice(device);\n    opus_decoder_destroy(decoder);\n    opus_encoder_destroy(encoder);\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers", "char"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1525282607, "post_id": 50140482, "comment_id": 87299193, "body": "If you can find the word, why can&#39;t you print it? Maybe copy it to another array before removing it from the string."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 3, "creation_date": 1525282646, "post_id": 50140482, "comment_id": 87299212, "body": "Show the code that tries to print it, we&#39;re not going to write it for you."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1525283286, "post_id": 50140482, "comment_id": 87299548, "body": "<code>gets(words);</code> - If that doesn&#39;t flag your compile with at-least warnings, if not outright errors, about type mismatching pointers, you seriously need to turn up your warning levels. You also need to forget you ever heard of the function <code>gets</code>. It has been removed from the standard library and should <b>never</b> be used."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1525283316, "post_id": 50140482, "comment_id": 87299571, "body": "Aside from <code>words</code> having the wrong type and <code>removeWord</code> being renamed to <code>removeAll</code>, it should work as expected.  What exactly are you having trouble printing?"}, {"owner": {"reputation": 23, "user_id": 9731648, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-HzZx3sxp6n4/AAAAAAAAAAI/AAAAAAAAAH0/bn5BoAdyG4k/photo.jpg?sz=128", "display_name": "Kyrylo Skobylko", "link": "https://stackoverflow.com/users/9731648/kyrylo-skobylko"}, "edited": false, "score": 0, "creation_date": 1525283953, "post_id": 50140482, "comment_id": 87299909, "body": "I need to print the new array using pointer, i&#39;ve tried but it gives me errors, the code that i&#39;ve tried is on 2nd edit."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 9731648, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-HzZx3sxp6n4/AAAAAAAAAAI/AAAAAAAAAH0/bn5BoAdyG4k/photo.jpg?sz=128", "display_name": "Kyrylo Skobylko", "link": "https://stackoverflow.com/users/9731648/kyrylo-skobylko"}, "edited": false, "score": 0, "creation_date": 1525284576, "post_id": 50140743, "comment_id": 87300200, "body": "Yeah that was my fault with this, but i also need to print new array(without deleted word) by using pointers."}, {"owner": {"reputation": 3624, "user_id": 8013471, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jh4jO.jpg?s=128&g=1", "display_name": "cse", "link": "https://stackoverflow.com/users/8013471/cse"}, "reply_to_user": {"reputation": 23, "user_id": 9731648, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-HzZx3sxp6n4/AAAAAAAAAAI/AAAAAAAAAH0/bn5BoAdyG4k/photo.jpg?sz=128", "display_name": "Kyrylo Skobylko", "link": "https://stackoverflow.com/users/9731648/kyrylo-skobylko"}, "edited": false, "score": 0, "creation_date": 1525285238, "post_id": 50140743, "comment_id": 87300505, "body": "@KyryloSkobylko For this you need to copy <i>the initial input</i>. Answer is updated. If you need something else then mention expected output."}, {"owner": {"reputation": 23, "user_id": 9731648, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-HzZx3sxp6n4/AAAAAAAAAAI/AAAAAAAAAH0/bn5BoAdyG4k/photo.jpg?sz=128", "display_name": "Kyrylo Skobylko", "link": "https://stackoverflow.com/users/9731648/kyrylo-skobylko"}, "edited": false, "score": 0, "creation_date": 1525285488, "post_id": 50140743, "comment_id": 87300614, "body": "That&#39;s good but i thought that output will be something like array address in memory(E.g 0x000008b) and then convert it back to normal view. P.s sorry for my bad english"}, {"owner": {"reputation": 3624, "user_id": 8013471, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jh4jO.jpg?s=128&g=1", "display_name": "cse", "link": "https://stackoverflow.com/users/8013471/cse"}, "reply_to_user": {"reputation": 23, "user_id": 9731648, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-HzZx3sxp6n4/AAAAAAAAAAI/AAAAAAAAAH0/bn5BoAdyG4k/photo.jpg?sz=128", "display_name": "Kyrylo Skobylko", "link": "https://stackoverflow.com/users/9731648/kyrylo-skobylko"}, "edited": false, "score": 0, "creation_date": 1525286584, "post_id": 50140743, "comment_id": 87301155, "body": "I&#39;m not sure what you are asking. But if you wants to print the address then use <code>%p</code> format specifier. e.g. <code>printf(&quot;%p&quot;, removeword);</code>."}, {"owner": {"reputation": 23, "user_id": 9731648, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-HzZx3sxp6n4/AAAAAAAAAAI/AAAAAAAAAH0/bn5BoAdyG4k/photo.jpg?sz=128", "display_name": "Kyrylo Skobylko", "link": "https://stackoverflow.com/users/9731648/kyrylo-skobylko"}, "edited": false, "score": 0, "creation_date": 1525286866, "post_id": 50140743, "comment_id": 87301291, "body": "Here&#39;s the example but in c++ where i used string: <a href=\"https://pastebin.com/KBC9AKRh\" rel=\"nofollow noreferrer\">Pastebin</a> . I just can&#39;t understand how to do it in C."}, {"owner": {"reputation": 3624, "user_id": 8013471, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jh4jO.jpg?s=128&g=1", "display_name": "cse", "link": "https://stackoverflow.com/users/8013471/cse"}, "reply_to_user": {"reputation": 23, "user_id": 9731648, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-HzZx3sxp6n4/AAAAAAAAAAI/AAAAAAAAAH0/bn5BoAdyG4k/photo.jpg?sz=128", "display_name": "Kyrylo Skobylko", "link": "https://stackoverflow.com/users/9731648/kyrylo-skobylko"}, "edited": false, "score": 0, "creation_date": 1525287114, "post_id": 50140743, "comment_id": 87301393, "body": "You are doing the same thing when you are passing parameters in <code>char * str</code> and <code>char * toRemove</code>. You can do the same using local variables instead of creating <i>parameters</i>."}], "tags": [], "owner": {"reputation": 3624, "user_id": 8013471, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jh4jO.jpg?s=128&g=1", "display_name": "cse", "link": "https://stackoverflow.com/users/8013471/cse"}, "is_accepted": true, "score": 0, "last_activity_date": 1525285144, "last_edit_date": 1525285144, "creation_date": 1525283545, "answer_id": 50140743, "question_id": 50140482, "link": "https://stackoverflow.com/questions/50140482/remove-first-word-from-char-array-and-print-it-out-using-pointers-in-c/50140743#50140743", "title": "Remove first word from char array and print it out using pointers in C", "body": "<p>In your code there are some compile time errors. Which is, you have decleared and used <code>void removeAll(char * str, char * toRemove);</code> function instead of <code>void removeWord(char * str, char * toRemove)</code>.</p>\n\n<p>Following is corrected working code. See it working <a href=\"https://ideone.com/1eLmCg\" rel=\"nofollow noreferrer\">here</a>:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nvoid removeWord(char * str, char * toRemove);\n\nint main(){\n    char words[100];\n    char origional[100];\n    char removeword[100];\n    printf(\"Enter your sentence: \");\n    gets(words);\n    printf(\"Enter word to delete: \");\n    gets(removeword);\n    strcpy(origional, words);\n    removeWord(words, removeword);\n    printf(\"\\nWord before deleting: %s\", origional);\n    printf(\"\\nWord after deleting: %s\", words);\n\n}\n\nvoid removeWord(char * str, char * toRemove)\n{\n    int i, j, stringLen, toRemoveLen;\n    int found;\n\n    stringLen   = strlen(str);\n    toRemoveLen = strlen(toRemove);\n\n\n    for(i=0; i &lt;= stringLen - toRemoveLen; i++)\n    {\n        found = 1;\n        for(j=0; j&lt;toRemoveLen; j++)\n        {\n            if(str[i + j] != toRemove[j])\n            {\n                found = 0;\n                break;\n            }\n        }\n\n        if(str[i + j] != ' ' &amp;&amp; str[i + j] != '\\t' &amp;&amp; str[i + j] != '\\n' &amp;&amp; str[i + j] != '\\0')\n        {\n            found = 0;\n        }\n\n\n        if(found == 1)\n        {\n            for(j=i; j&lt;=stringLen - toRemoveLen; j++)\n            {\n                str[j] = str[j + toRemoveLen];\n            }\n\n            stringLen = stringLen - toRemoveLen;\n\n            i--;\n        }\n    }\n}\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<pre><code>Enter your sentence: Hello there how are you?\nEnter word to delete: how\nWord before deleting: Hello there how are you?\nWord after deleting: Hello there  are you?\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 9731648, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-HzZx3sxp6n4/AAAAAAAAAAI/AAAAAAAAAH0/bn5BoAdyG4k/photo.jpg?sz=128", "display_name": "Kyrylo Skobylko", "link": "https://stackoverflow.com/users/9731648/kyrylo-skobylko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 586, "favorite_count": 0, "accepted_answer_id": 50140743, "answer_count": 1, "score": -2, "last_activity_date": 1525285144, "creation_date": 1525282536, "last_edit_date": 1525283978, "question_id": 50140482, "link": "https://stackoverflow.com/questions/50140482/remove-first-word-from-char-array-and-print-it-out-using-pointers-in-c", "title": "Remove first word from char array and print it out using pointers in C", "body": "<p>So i'm trying to make a small program where i have a string with word an i need to delete nth word from it and then print it out using pointers.</p>\n\n<p>I made a part where i can delete nth word but i can't understand how to print it using pointers.</p>\n\n<p>EDIT(Sorry i forgot to add the code):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nvoid removeAll(char * str, char * toRemove);\n\nint main(){\n    char *words[100];\n    char removeword[100];\n    printf(\"Enter your sentence: \");\n    gets(words);\n    printf(\"Enter word to delete: \");\n    gets(removeword);\n    removeAll(words, removeword);\n    printf(\"Word after deleting: %s\", words);\n\n}\n\nvoid removeWord(char * str, char * toRemove)\n{\n    int i, j, stringLen, toRemoveLen;\n    int found;\n\n    stringLen   = strlen(str);\n    toRemoveLen = strlen(toRemove);\n\n\n    for(i=0; i &lt;= stringLen - toRemoveLen; i++)\n    {\n        found = 1;\n        for(j=0; j&lt;toRemoveLen; j++)\n        {\n            if(str[i + j] != toRemove[j])\n            {\n                found = 0;\n                break;\n            }\n        }\n\n        if(str[i + j] != ' ' &amp;&amp; str[i + j] != '\\t' &amp;&amp; str[i + j] != '\\n' &amp;&amp; str[i + j] != '\\0')\n        {\n            found = 0;\n        }\n\n\n        if(found == 1)\n        {\n            for(j=i; j&lt;=stringLen - toRemoveLen; j++)\n            {\n                str[j] = str[j + toRemoveLen];\n            }\n\n            stringLen = stringLen - toRemoveLen;\n\n            i--;\n        }\n    }\n}\n</code></pre>\n\n<p>EDIT 2:</p>\n\n<pre><code>char *pWord = words;\nfor (int i=0; pWord[i]; ++i) {\n    const char *ch = pWord[i];\n    while(*ch) {\n        putchar(*ch++);\n        putchar('\\n');\n    }\n    putchar('\\n');\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 1, "creation_date": 1525281588, "post_id": 50140207, "comment_id": 87298648, "body": "how is sendPacket defined"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1525281637, "post_id": 50140207, "comment_id": 87298675, "body": "The type of <code>packet</code> is <code>char (*)[84]</code>. That is, it&#39;s a pointer to an array of 84 <code>char</code> elements. The type of <code>(buffer + i)</code> (which is also the exact same thing as <code>&amp;buffer[i]</code>) is <code>char *</code>, i.e. a pointer to a single <code>char</code>. Why do you think those two types are the same? What are you trying to do?"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1525281733, "post_id": 50140207, "comment_id": 87298739, "body": "he is trying to chop buffer up into 84 byte size chunks. Question is - exactly how is that chunk expected by sendPacket - char[84] or char * (with implict length)"}, {"owner": {"reputation": 10904, "user_id": 3499115, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/c593739208b1ddfe3eaae322ceecf5ce?s=128&d=identicon&r=PG", "display_name": "JBaczuk", "link": "https://stackoverflow.com/users/3499115/jbaczuk"}, "edited": false, "score": 0, "creation_date": 1525281738, "post_id": 50140207, "comment_id": 87298743, "body": "Trying to update the memory location of the first byte in the <code>84 byte char array</code> to the memory location of <code>(buffer + i)</code>"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1525281757, "post_id": 50140207, "comment_id": 87298752, "body": "how is sendPacket defined??"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1525281768, "post_id": 50140207, "comment_id": 87298759, "body": "What I think you&#39;re trying to do is to pass the data pointed to by <code>buffer + i</code> to the <code>sendPacket</code> function. Unless the<code>sendPacket</code> have a very strange definition, I think it&#39;s enough to do <code>sendPacket(buffer + i)</code>. No need for the <code>packet</code> variable."}, {"owner": {"reputation": 10904, "user_id": 3499115, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/c593739208b1ddfe3eaae322ceecf5ce?s=128&d=identicon&r=PG", "display_name": "JBaczuk", "link": "https://stackoverflow.com/users/3499115/jbaczuk"}, "reply_to_user": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1525281816, "post_id": 50140207, "comment_id": 87298791, "body": "@pm100 doesn&#39;t matter, that&#39;s not the problem.  Sorry the sendPacket function is confusing I&#39;ll edit that."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1525281860, "post_id": 50140207, "comment_id": 87298816, "body": "how is sendPacket defined???? - i am typing the correct code for you, but I need to know what snedPAcket expects"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 1, "creation_date": 1525281977, "post_id": 50140207, "comment_id": 87298868, "body": "i am trying to get OP&#39;s attention, next time ti will be in all caps"}, {"owner": {"reputation": 10904, "user_id": 3499115, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/c593739208b1ddfe3eaae322ceecf5ce?s=128&d=identicon&r=PG", "display_name": "JBaczuk", "link": "https://stackoverflow.com/users/3499115/jbaczuk"}, "reply_to_user": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1525281977, "post_id": 50140207, "comment_id": 87298869, "body": "@pm100 just assume its defined as <code>sendPacket(char packet[84])</code>"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1525282001, "post_id": 50140207, "comment_id": 87298888, "body": "is it defined like that or not? Makes a HUGE difference"}, {"owner": {"reputation": 10904, "user_id": 3499115, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/c593739208b1ddfe3eaae322ceecf5ce?s=128&d=identicon&r=PG", "display_name": "JBaczuk", "link": "https://stackoverflow.com/users/3499115/jbaczuk"}, "reply_to_user": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1525282086, "post_id": 50140207, "comment_id": 87298925, "body": "@pm100 yes, with some extra params that are not relevant"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1525282115, "post_id": 50140207, "comment_id": 87298936, "body": "First things first: you <b>can&#39;t assign an array</b> in C, no matter whether it&#39;s a regular one or a VLA. Typical solution: use <code>memcpy()</code> to copy the contents."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1525282364, "post_id": 50140207, "comment_id": 87299062, "body": "Whenever you see something like <code>char packet[size_is_irrelevant]</code> as a function arguments, it is <i>exactly</i> the same as <code>char *packet</code>."}], "answers": [{"comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1525282222, "post_id": 50140366, "comment_id": 87298995, "body": "If the <code>sendPacket</code> function expects a <code>const char *</code> argument, why use a temporary array and the <code>memcpy</code> at all?"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1525282247, "post_id": 50140366, "comment_id": 87299003, "body": "OP says its defined to take char[84]"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1525282285, "post_id": 50140366, "comment_id": 87299021, "body": "@pm100 Pass-by-value on a buffer like that is missing the whole point of buffers."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1525282317, "post_id": 50140366, "comment_id": 87299029, "body": "Actually, that&#39;s equal to plain <code>char *</code>. So there is a chance the function might modify the data and then a temporary buffer might be needed. If it doesn&#39;t modify then no temporary buffer is needed."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1525282328, "post_id": 50140366, "comment_id": 87299042, "body": "I agree - but he says that sendPAcket is defined to take char[84]"}, {"owner": {"reputation": 10904, "user_id": 3499115, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/c593739208b1ddfe3eaae322ceecf5ce?s=128&d=identicon&r=PG", "display_name": "JBaczuk", "link": "https://stackoverflow.com/users/3499115/jbaczuk"}, "edited": false, "score": 0, "creation_date": 1525282367, "post_id": 50140366, "comment_id": 87299066, "body": "@pm100 Good point that accepting char * might be better, I just have to make sure the code in sendPacket doesn&#39;t try to send more than 84 bytes."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 1, "creation_date": 1525282446, "post_id": 50140366, "comment_id": 87299112, "body": "so pass in a length"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1525282465, "post_id": 50140366, "comment_id": 87299123, "body": "@pm100 Doesn&#39;t matter. For any array-like argument declaration, it&#39;s exactly equal to a non-array pointer declaration. Doesn&#39;t matter if there&#39;s a size or not, <code>char packet[84]</code> is exactly equal to <code>char *packet</code> for a function argument."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1525282543, "post_id": 50140366, "comment_id": 87299162, "body": "can you pass char * to a function that expects char[84]. I thought not, the other way round works for sure"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1525282738, "post_id": 50140366, "comment_id": 87299269, "body": "just tried it - apparently you can pass char* to char[84] function. I am surprised"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1525283520, "post_id": 50140366, "comment_id": 87299683, "body": "There&#39;s no need to copy the array here since you can just pass a pointer to the first element you&#39;re interested in."}], "tags": [], "owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "is_accepted": true, "score": 2, "last_activity_date": 1525283241, "last_edit_date": 1525283241, "creation_date": 1525282131, "answer_id": 50140366, "question_id": 50140207, "link": "https://stackoverflow.com/questions/50140207/assign-variable-sized-array-to-fixed-sized-array-c/50140366#50140366", "title": "Assign variable sized array to fixed sized array c", "body": "<pre><code>int i = 0;\nint result = 0;\n\n// Iterate through all the bytes in the buffer\nfor (i = 0; i &lt; length; i = i + 84)\n{\n  char packet[84];\n  memcpy(packet, buffer[i],84);\n  result = sendPacket(packet);\n}\n\nreturn 0;  \n</code></pre>\n\n<p>note this does not deal with the case where buffer is not exact multiple of 84</p>\n\n<p>life would be easier if sendPAcket expected <code>char *</code> rather that <code>char [84]</code>. Then code would read</p>\n\n<pre><code>int i = 0;\nint result = 0; \n\n// Iterate through all the bytes in the buffer\nfor (i = 0; i &lt; length; i = i + 84)\n{\n  char packet[84];\n  memcpy(packet, buffer[i],84);\n  result = sendPacket(buffer[i]);\n}\n\nreturn 0;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 1, "last_activity_date": 1525282301, "creation_date": 1525282301, "answer_id": 50140411, "question_id": 50140207, "link": "https://stackoverflow.com/questions/50140207/assign-variable-sized-array-to-fixed-sized-array-c/50140411#50140411", "title": "Assign variable sized array to fixed sized array c", "body": "<p>This doesn't work:</p>\n\n<pre><code>packet = (buffer + i);\n</code></pre>\n\n<p>Because the types are not the same.  <code>packet</code> has type <code>char (*)[84]</code> (i.e. a pointer to an array of 84 <code>char</code>) while <code>buffer</code> has type <code>char *</code>.  You actually don't need this extra type.</p>\n\n<p>Given that <code>sendPacket</code> is defined as:</p>\n\n<pre><code>int sendPacket(char packet[84])\n</code></pre>\n\n<p>The parameter <code>packet</code> actually has type <code>char *</code>, since arrays as function parameters <em>decay</em> into a pointer to the first element.</p>\n\n<p>You can then call this function as follows:</p>\n\n<pre><code>result = sendPacket(buffer + i)\n</code></pre>\n\n<p>The expression <code>buffer + i</code> evaluates to the address of element <code>i</code> in the buffer.  Assuming <code>sendPacket</code> reads 84 bytes from this address, it will grab the next 84 bytes in the buffer.</p>\n"}], "owner": {"reputation": 10904, "user_id": 3499115, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/c593739208b1ddfe3eaae322ceecf5ce?s=128&d=identicon&r=PG", "display_name": "JBaczuk", "link": "https://stackoverflow.com/users/3499115/jbaczuk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 50140366, "answer_count": 2, "score": -3, "last_activity_date": 1525283241, "creation_date": 1525281424, "last_edit_date": 1525282799, "question_id": 50140207, "link": "https://stackoverflow.com/questions/50140207/assign-variable-sized-array-to-fixed-sized-array-c", "title": "Assign variable sized array to fixed sized array c", "body": "<p>I have a buffer of chars defined as <code>char *buffer</code>.  When I send my XBEE packet data, there is a fixed size requirement (84 bytes).  My problem is I don't know how to convert the buffer into 84 byte chunks as I iterate.  Here is what I get:</p>\n\n<pre><code>warning: assignment from incompatible pointer type [-Wincompatible-pointer-types]\n     packet = (buffer + i);\n            ^\n</code></pre>\n\n<p>And my code:</p>\n\n<pre><code>int sendSerialBuffer(char *buffer, int length)\n{\n  int i = 0;\n  int result = 0;\n  char (* packet)[84];\n\n  // Iterate through all the bytes in the buffer\n  for (i = 0; i &lt; length; i = i + 84)\n  {\n    packet = (buffer + i);\n    result = sendPacket(packet)\n  }\n  return 0;\n}\n</code></pre>\n\n<p><strong>Edit</strong>:\nI have also tried declaring packet like <code>char packet[84];</code> and get:</p>\n\n<pre><code>error: assignment to expression with array type\n     packet = (buffer + i);\n            ^\n</code></pre>\n\n<p>Also, sendPacket is defined as:<code>sendPacket(char packet[84]);</code></p>\n"}, {"tags": ["c", "string", "char", "scanf"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1525278715, "post_id": 50139432, "comment_id": 87297199, "body": "Have you ever checked the documentation of <code>scanf</code> ? None of your code snippets can work. Partially or fully."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1525278890, "post_id": 50139432, "comment_id": 87297295, "body": "@EugeneSh. what&#39;s wrong with the first one?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1525278940, "post_id": 50139432, "comment_id": 87297333, "body": "Ah. Let me correct myself. First one can work. Not clear what is &quot;partially&quot; here."}, {"owner": {"reputation": 121, "user_id": 9359127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef49d91435ed43fe69ab842a7fc564e8?s=128&d=identicon&r=PG&f=1", "display_name": "Gottaquest", "link": "https://stackoverflow.com/users/9359127/gottaquest"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1525279224, "post_id": 50139432, "comment_id": 87297485, "body": "@EugeneSh. it does..i am asking why two things do not work"}, {"owner": {"reputation": 2465, "user_id": 5462988, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9i3ex.jpg?s=128&g=1", "display_name": "anoopknr", "link": "https://stackoverflow.com/users/5462988/anoopknr"}, "edited": false, "score": 0, "creation_date": 1525279815, "post_id": 50139432, "comment_id": 87297757, "body": "Try <code>scanf(&quot;%1s&quot;,&amp;wasd);</code> . It Worked for me in <b>GCC</b>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 2465, "user_id": 5462988, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9i3ex.jpg?s=128&g=1", "display_name": "anoopknr", "link": "https://stackoverflow.com/users/5462988/anoopknr"}, "edited": false, "score": 0, "creation_date": 1525280015, "post_id": 50139432, "comment_id": 87297850, "body": "@anoopknr After some <a href=\"https://en.wikipedia.org/wiki/Humble_pie\" rel=\"nofollow noreferrer\">humble pie</a>  due to my comment. <code>scanf(&quot;%1s&quot;,&amp;wasd);</code> fails as that saves 2 characters, the 1 read and a <i>null character</i>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 2465, "user_id": 5462988, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9i3ex.jpg?s=128&g=1", "display_name": "anoopknr", "link": "https://stackoverflow.com/users/5462988/anoopknr"}, "edited": false, "score": 0, "creation_date": 1525289117, "post_id": 50139432, "comment_id": 87302384, "body": "@anoopknr adding to chux&#39; comment, &quot;<i>It Worked for me</i>&quot; doesn&#39;t have much value with C. <b>undefined behavior</b> might do whatever, including, just by chance, what you expected."}], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 9359127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef49d91435ed43fe69ab842a7fc564e8?s=128&d=identicon&r=PG&f=1", "display_name": "Gottaquest", "link": "https://stackoverflow.com/users/9359127/gottaquest"}, "edited": false, "score": 0, "creation_date": 1525281455, "post_id": 50139584, "comment_id": 87298571, "body": "thanks again for an answer. i read of getchar but tried to get used to scanf first. But i will check out the link when learning about getchar.  If you pass a pointer to a single char variable, - but when using %s i pass it to a char array..dont i?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 121, "user_id": 9359127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef49d91435ed43fe69ab842a7fc564e8?s=128&d=identicon&r=PG&f=1", "display_name": "Gottaquest", "link": "https://stackoverflow.com/users/9359127/gottaquest"}, "edited": false, "score": 0, "creation_date": 1525281804, "post_id": 50139584, "comment_id": 87298782, "body": "See the simple example code with <code>%9s</code> above. Field width must be one less than array size because the final <code>0</code> byte of the string isn&#39;t counted in the field width..."}, {"owner": {"reputation": 121, "user_id": 9359127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef49d91435ed43fe69ab842a7fc564e8?s=128&d=identicon&r=PG&f=1", "display_name": "Gottaquest", "link": "https://stackoverflow.com/users/9359127/gottaquest"}, "edited": false, "score": 0, "creation_date": 1525283032, "post_id": 50139584, "comment_id": 87299419, "body": "I used <code>char wasd[3]; scanf(&quot;%c&quot;, &amp;wasd[2]);</code>now. Why is the field width still to short when using  <code>char wasd[2]; scanf(&quot;%c&quot;, &amp;wasd[1]);</code> ? The 0 needs only one byte..+ the byte of the value of wasd"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 121, "user_id": 9359127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef49d91435ed43fe69ab842a7fc564e8?s=128&d=identicon&r=PG&f=1", "display_name": "Gottaquest", "link": "https://stackoverflow.com/users/9359127/gottaquest"}, "edited": false, "score": 0, "creation_date": 1525284745, "post_id": 50139584, "comment_id": 87300269, "body": "Huh? Now I don&#39;t understand anything. Why are you now combining <code>%c</code> with an array of <code>char</code>? With <code>%c</code> there&#39;s no field width -- the field width in my example is the <code>9</code> in <code>%9s</code>."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": true, "score": 2, "last_activity_date": 1525279223, "creation_date": 1525279223, "answer_id": 50139584, "question_id": 50139432, "link": "https://stackoverflow.com/questions/50139432/why-can-i-not-use-s-instead-of-c/50139584#50139584", "title": "Why can i not use %s instead of %c?", "body": "<p>Simple as that, <code>%s</code> is the conversion for a (non-empty) string. A <strong>string</strong> in C always ends with a <code>0</code> byte, so any non-empty string needs at least <strong>two</strong> bytes. If you pass a pointer to a single <code>char</code> variable, <code>scanf()</code> will just overwrite whatever is in memory after that variable -- you cause <strong>undefined behavior</strong> and anything can happen.</p>\n\n<hr>\n\n<p>Side note, <code>scanf(\"%s\", ..)</code>, even if you give it an <strong>array</strong> of <code>char</code>, will always overflow the buffer if something longer is entered, therefore causing <strong>undefined behavior</strong>. You have to include a field width like</p>\n\n<pre><code>char str[10];\nscanf(\"%9s\", str);\n</code></pre>\n\n<p>Best is not to use <code>scanf()</code> at all. For your single character input, you can just use <code>getchar()</code> (be aware it returns an <code>int</code>). You might also want to read my <a href=\"http://sekrit.de/webdocs/c/beginners-guide-away-from-scanf.html\" rel=\"nofollow noreferrer\">beginners' guide away from scanf</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 5000, "user_id": 8405835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sN3eq.png?s=128&g=1", "display_name": "Abhijit Pritam Dutta", "link": "https://stackoverflow.com/users/8405835/abhijit-pritam-dutta"}, "is_accepted": false, "score": 2, "last_activity_date": 1525279230, "creation_date": 1525279230, "answer_id": 50139587, "question_id": 50139432, "link": "https://stackoverflow.com/questions/50139432/why-can-i-not-use-s-instead-of-c/50139587#50139587", "title": "Why can i not use %s instead of %c?", "body": "<p>A <code>char</code> variable can hold only one byte of memory to hold a single character. But a string (array of characters) is different from a <code>char</code> variable as it is always ended with a null character <code>\\0</code> or numeric <code>0</code>. So in <code>scanf</code> you specifically mentioned whether you are reading a character or a string so that <code>scanf</code> can add a null character at the end of a string. So you are not suppose to use a <code>%s</code> to read a value for a <code>char</code> variable </p>\n"}], "owner": {"reputation": 121, "user_id": 9359127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef49d91435ed43fe69ab842a7fc564e8?s=128&d=identicon&r=PG&f=1", "display_name": "Gottaquest", "link": "https://stackoverflow.com/users/9359127/gottaquest"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187, "favorite_count": 0, "accepted_answer_id": 50139584, "answer_count": 2, "score": 0, "last_activity_date": 1525279230, "creation_date": 1525278642, "question_id": 50139432, "link": "https://stackoverflow.com/questions/50139432/why-can-i-not-use-s-instead-of-c", "title": "Why can i not use %s instead of %c?", "body": "<p>The whole function the question is about is about giving a two dimensional array initialized with {0} as output and making a user able to move a 1 over the field with</p>\n\n<pre><code>char wasd;\nscanf(\"%c\", &amp;wasd);\n</code></pre>\n\n<p>(the function to move by changing the value of the variable wasd is not important i think)\nnow my question is why using</p>\n\n<pre><code>scanf(\"%s\", &amp;wasd);\n</code></pre>\n\n<p>does only work partly(sometimes the 1 keeps being at a field and appears a 2nd time at the new place though it actually should be deleted)\nand</p>\n\n<pre><code>scanf(\"%.1s\", &amp;wasd);\n</code></pre>\n\n<p>leads to the field being printed out without stop until closing the execution program. I came up with using %.1s after researching the difference between %c and %s here <a href=\"https://stackoverflow.com/questions/10846024/why-does-cs-printf-format-string-have-both-c-and-s\">Why does C&#39;s printf format string have both %c and %s?</a>? If one <em>can</em> figure out the answer by reading through that, i am not clever or far enough with c learning to get it. \nI also found this <a href=\"https://stackoverflow.com/questions/42356070/fscanf-in-c-difference-between-s-and-c\">fscanf() in C - difference between %s and %c</a> but i do not know anything about EOF which one answer says is the cause of the problem so i would prefer getting an answer without it.\nThank you for an answer</p>\n"}, {"tags": ["c", "memory-leaks", "operating-system"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1525278686, "post_id": 50139427, "comment_id": 87297183, "body": "It&#39;s a &quot;feature&quot; of Linux. You can allocate as much memory as you want, <i>as long as you don&#39;t actually <b>use</b> it</i>. Try writing to a random byte in the memory you allocate, and you will see your system start terminating random processes soon enough."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1525278788, "post_id": 50139427, "comment_id": 87297244, "body": "You never use the memory. This can be catched at multiple levels. The compiler could already eliminate the code, it has no observable behavior. The OS could delay page allocations until there&#39;s a page fault. etc... To see something, fill the memory with some data other than <code>0</code>, which could be a special case."}, {"owner": {"reputation": 111, "user_id": 6005228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f69943610c00f7b20688542f5745f45a?s=128&d=identicon&r=PG&f=1", "display_name": "root", "link": "https://stackoverflow.com/users/6005228/root"}, "edited": false, "score": 0, "creation_date": 1525278907, "post_id": 50139427, "comment_id": 87297311, "body": "Ok, I can modify this to use malloc and a for loop iterating over an array assigning values, which somebody else did, and it produces the same result. Secondly, that doesn&#39;t explain why this code <i>will</i> fill a 64 bit Linux OS&#39; main memory."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1525279129, "post_id": 50139427, "comment_id": 87297435, "body": "The name is <b>overcommiting</b>."}, {"owner": {"reputation": 111, "user_id": 6005228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f69943610c00f7b20688542f5745f45a?s=128&d=identicon&r=PG&f=1", "display_name": "root", "link": "https://stackoverflow.com/users/6005228/root"}, "edited": false, "score": 1, "creation_date": 1525279261, "post_id": 50139427, "comment_id": 87297499, "body": "I don&#39;t think overcomitting is what I&#39;m running into here either. My physical desktop PC has 16 GB of RAM. This virtual machine is using 4 GB.  <a href=\"https://en.wikipedia.org/wiki/Memory_overcommitment\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Memory_overcommitment</a>"}, {"owner": {"reputation": 11762, "user_id": 6530695, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/53a7a617c8e419f2562f0b00e6be10b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/6530695/tony"}, "edited": false, "score": 0, "creation_date": 1525279437, "post_id": 50139427, "comment_id": 87297589, "body": "Did you even check the return value isn&#39;t <code>Null</code>?"}, {"owner": {"reputation": 111, "user_id": 6005228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f69943610c00f7b20688542f5745f45a?s=128&d=identicon&r=PG&f=1", "display_name": "root", "link": "https://stackoverflow.com/users/6005228/root"}, "edited": false, "score": 0, "creation_date": 1525279579, "post_id": 50139427, "comment_id": 87297663, "body": "Yes, I did. This program on a 32 bit OS can run for 12,084 iterations before the pointer starts becoming null. (At least on my machine, your specific number <i>may</i> vary)."}], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 6005228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f69943610c00f7b20688542f5745f45a?s=128&d=identicon&r=PG&f=1", "display_name": "root", "link": "https://stackoverflow.com/users/6005228/root"}, "edited": false, "score": 0, "creation_date": 1525279523, "post_id": 50139649, "comment_id": 87297632, "body": "If this is true, then why will it flood the physical ram and eventually the swap space of a 64 bit OS?"}, {"owner": {"reputation": 11762, "user_id": 6530695, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/53a7a617c8e419f2562f0b00e6be10b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/6530695/tony"}, "reply_to_user": {"reputation": 111, "user_id": 6005228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f69943610c00f7b20688542f5745f45a?s=128&d=identicon&r=PG&f=1", "display_name": "root", "link": "https://stackoverflow.com/users/6005228/root"}, "edited": false, "score": 0, "creation_date": 1525279634, "post_id": 50139649, "comment_id": 87297692, "body": "@LC14199 because that&#39;s how modern memory management is done. Your allocated memory is virtual until you actually write to it, then a physical page (actual chunk of memory) is needed and the RAM usage will increase. Take an OS book and read the memory-management chapter."}, {"owner": {"reputation": 111, "user_id": 6005228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f69943610c00f7b20688542f5745f45a?s=128&d=identicon&r=PG&f=1", "display_name": "root", "link": "https://stackoverflow.com/users/6005228/root"}, "reply_to_user": {"reputation": 11762, "user_id": 6530695, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/53a7a617c8e419f2562f0b00e6be10b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/6530695/tony"}, "edited": false, "score": 0, "creation_date": 1525279817, "post_id": 50139649, "comment_id": 87297758, "body": "@TonyTannous, calloc writes to the memory after it&#39;s allocated it. It initialises all memory with a value of 0. Which therefore makes the memory no longer virtual. Or at least, that&#39;s how I currently understand it anyway."}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "reply_to_user": {"reputation": 111, "user_id": 6005228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f69943610c00f7b20688542f5745f45a?s=128&d=identicon&r=PG&f=1", "display_name": "root", "link": "https://stackoverflow.com/users/6005228/root"}, "edited": false, "score": 0, "creation_date": 1525279862, "post_id": 50139649, "comment_id": 87297774, "body": "@LC14199: This is incorrect. <code>calloc</code> does not always write to the memory after allocating it."}, {"owner": {"reputation": 111, "user_id": 6005228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f69943610c00f7b20688542f5745f45a?s=128&d=identicon&r=PG&f=1", "display_name": "root", "link": "https://stackoverflow.com/users/6005228/root"}, "edited": false, "score": 0, "creation_date": 1525280055, "post_id": 50139649, "comment_id": 87297873, "body": "<a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_calloc.htm\" rel=\"nofollow noreferrer\">tutorialspoint.com/c_standard_library/c_function_calloc.htm</a>  By very definition on this page, &quot;The difference in malloc and calloc is that malloc does not set the memory to zero where as calloc sets allocated memory to zero.&quot;  So now I&#39;m rather curious as to know exactly how this works. I&#39;m testing your code right now.  Then of course there&#39;s this: <a href=\"https://stackoverflow.com/questions/1538420/difference-between-malloc-and-calloc\" title=\"difference between malloc and calloc\">stackoverflow.com/questions/1538420/&hellip;</a>"}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "reply_to_user": {"reputation": 111, "user_id": 6005228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f69943610c00f7b20688542f5745f45a?s=128&d=identicon&r=PG&f=1", "display_name": "root", "link": "https://stackoverflow.com/users/6005228/root"}, "edited": false, "score": 0, "creation_date": 1525280142, "post_id": 50139649, "comment_id": 87297921, "body": "@LC14199: That wording is imprecise. See <a href=\"https://stackoverflow.com/questions/2688466/why-mallocmemset-is-slower-than-calloc/2688522#2688522\" title=\"why mallocmemset is slower than calloc\">stackoverflow.com/questions/2688466/&hellip;</a>"}, {"owner": {"reputation": 111, "user_id": 6005228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f69943610c00f7b20688542f5745f45a?s=128&d=identicon&r=PG&f=1", "display_name": "root", "link": "https://stackoverflow.com/users/6005228/root"}, "edited": false, "score": 0, "creation_date": 1525280288, "post_id": 50139649, "comment_id": 87298003, "body": "Your code works as intended, so thank you for that. I&#39;m reading the other article right now."}, {"owner": {"reputation": 111, "user_id": 6005228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f69943610c00f7b20688542f5745f45a?s=128&d=identicon&r=PG&f=1", "display_name": "root", "link": "https://stackoverflow.com/users/6005228/root"}, "edited": false, "score": 0, "creation_date": 1525281368, "post_id": 50139649, "comment_id": 87298530, "body": "So @DietrichEpp just to clarify, this has absolutely nothing to do with pages being swapped in or out of memory due to them not being used, it&#39;s related to the fact that calloc (on its own) isn&#39;t even writing to them in the first place, hence it not consuming the physical ram. Is this understanding correct?"}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "reply_to_user": {"reputation": 111, "user_id": 6005228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f69943610c00f7b20688542f5745f45a?s=128&d=identicon&r=PG&f=1", "display_name": "root", "link": "https://stackoverflow.com/users/6005228/root"}, "edited": false, "score": 0, "creation_date": 1525281510, "post_id": 50139649, "comment_id": 87298606, "body": "@LC14199: Yes. The pages are not being used, RAM is not being used, swap is not being used, except for a little bit of overhead."}], "tags": [], "owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "is_accepted": true, "score": 5, "last_activity_date": 1525280355, "last_edit_date": 1525280355, "creation_date": 1525279438, "answer_id": 50139649, "question_id": 50139427, "link": "https://stackoverflow.com/questions/50139427/cannot-exhaust-physical-memory-in-32-bit-linux/50139649#50139649", "title": "Cannot Exhaust Physical Memory in 32 bit Linux", "body": "<p>The <code>malloc</code> and <code>calloc</code> functions do not technically allocate memory, despite their name. They actually allocate portions of your program's address space with OS-level read/write permissions. This is a subtle difference and is not relevant most of the time.</p>\n\n<p>This program, as written, only consumes address space. Eventually, <code>calloc</code> will start returning NULL but the program will continue running.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n// Note main should be int.\nint main() {\n    while (1) {\n        // Note calloc should not be cast.\n        int *a = calloc(65536, sizeof(int));\n    }\n}\n</code></pre>\n\n<p>If you write to the addresses returned from calloc, it will force the kernel to allocate memory to back those addresses.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\nint main() {\n    size_t size = 65536 * 4;\n    while (1) {\n        // Allocates address space.\n        void *p = calloc(size, 1);\n        // Forces the address space to have allocated memory behind it.\n        memset(p, 0, size);\n    }\n}\n</code></pre>\n\n<p>It's not enough to write to a single location in the block returned from <code>calloc</code> because the granularity for allocating actual memory is 4 KiB (the page size... 4 KiB is the most common). So you can get by with just writing to each page.</p>\n\n<h2>What about the 64-bit case?</h2>\n\n<p>There is some bookkeeping overhead for allocating address space. On a 64-bit system, you get something like 40 or 48 bits of address space, of which about half can be allocated to the program, which comes to at least 8 TiB. On a 32-bit system this comes to 2 GiB or so (depending on kernel configuration).</p>\n\n<p>So on a 64-bit system, you can allocate ~8 TiB, and a 32-bit system you can allocate ~2 GiB, and the overhead is what causes the problems. There is typically a small amount of overhead for each call to <code>malloc</code> or <code>calloc</code>.</p>\n\n<p>See also <a href=\"https://stackoverflow.com/questions/2688466/why-mallocmemset-is-slower-than-calloc/2688522#2688522\">Why malloc+memset is slower than calloc?</a></p>\n"}], "owner": {"reputation": 111, "user_id": 6005228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f69943610c00f7b20688542f5745f45a?s=128&d=identicon&r=PG&f=1", "display_name": "root", "link": "https://stackoverflow.com/users/6005228/root"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 50139649, "answer_count": 1, "score": 1, "last_activity_date": 1525280355, "creation_date": 1525278623, "last_edit_date": 1525278799, "question_id": 50139427, "link": "https://stackoverflow.com/questions/50139427/cannot-exhaust-physical-memory-in-32-bit-linux", "title": "Cannot Exhaust Physical Memory in 32 bit Linux", "body": "<p>So I've got an interesting OS based problem for you. I've spent the last few hours conversing with anyone I know who's experienced with C programming, and nobody seems to be able to come up with a definitive answer as to why this behaviour is occurring.</p>\n\n<p>I have a program that is intentionally designed to cause an extreme memory leak, (as an example of what happens when you don't free memory after allocating it). On 64 bit operating systems, (Windows, Linux, etc), it does what it should do. It fills physical ram, then fills the swap space of the OS. In Linux, the process is then terminated by the OS. In Windows however, it is not, and it continues running. The eventual result is a system crash.</p>\n\n<p>Here's the code:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nvoid main()\n{\n    while(1)\n    {\n        int *a;\n        a = (int*)calloc(65536, 4);\n    }\n}\n</code></pre>\n\n<p>However, if you compile and run this code on a 32 bit Linux distribution, it has no effect on physical memory usage at all. It uses approximately 1% of my 4 GB of allocated RAM, and it never rises after that. I don't have a legitimate copy of 32 Bit Windows to test on, so I can't be certain this occurs on 32 bit Windows as well.</p>\n\n<p>Can somebody please explain why the use of calloc will fill the physical ram of a 64 bit Linux OS, but not a 32 bit Linux OS?</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 3, "creation_date": 1525278179, "post_id": 50139288, "comment_id": 87296920, "body": "&quot;<i>From what I understand about C arrays, they store pointers to values</i>&quot; &lt;- no, they just store values :o and the code following looks <b>very</b> wrong :o"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1525278196, "post_id": 50139288, "comment_id": 87296926, "body": "<i>From what I understand about C arrays, they store pointers to values which are generated in sequence as per the space allocated</i> - hm. No. Arrays is just a <b>contiguous</b> memory region where values are stored sequentially."}, {"owner": {"reputation": 3186, "user_id": 4871483, "user_type": "registered", "accept_rate": 45, "profile_image": "https://lh5.googleusercontent.com/-HMwbAOtRjY4/AAAAAAAAAAI/AAAAAAAABQk/jXK1QQ0bfqw/photo.jpg?sz=128", "display_name": "ytpillai", "link": "https://stackoverflow.com/users/4871483/ytpillai"}, "edited": false, "score": 0, "creation_date": 1525278274, "post_id": 50139288, "comment_id": 87296960, "body": "Lol. Can you add an answer that explains it better? I&#39;ve been reading a few Unix and C books and it&#39;s just not clicking. There was a point today when I thought the dereference <code>*</code> was overloaded and sometimes return pointers and sometimes didn&#39;t, so I&#39;m lost."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1525278300, "post_id": 50139288, "comment_id": 87296975, "body": "I would add an answer if I fully understood what you are trying to do ...."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1525278313, "post_id": 50139288, "comment_id": 87296982, "body": "Forget about pointers for a moment. They are irrelevant for (this) array discussion."}], "answers": [{"comments": [{"owner": {"reputation": 3186, "user_id": 4871483, "user_type": "registered", "accept_rate": 45, "profile_image": "https://lh5.googleusercontent.com/-HMwbAOtRjY4/AAAAAAAAAAI/AAAAAAAABQk/jXK1QQ0bfqw/photo.jpg?sz=128", "display_name": "ytpillai", "link": "https://stackoverflow.com/users/4871483/ytpillai"}, "edited": false, "score": 0, "creation_date": 1525278861, "post_id": 50139373, "comment_id": 87297280, "body": "Changed my question to reflect a proper initialization. If arrays store values and not pointers as I understood, do they have to allocate all their memory at once (don&#39;t know where this would be, I thought this was allocated but heap but maybe I&#39;m wrong), so essentially arrays are pointers to a large chunk of memory that contains smaller subsets of data?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 3186, "user_id": 4871483, "user_type": "registered", "accept_rate": 45, "profile_image": "https://lh5.googleusercontent.com/-HMwbAOtRjY4/AAAAAAAAAAI/AAAAAAAABQk/jXK1QQ0bfqw/photo.jpg?sz=128", "display_name": "ytpillai", "link": "https://stackoverflow.com/users/4871483/ytpillai"}, "edited": false, "score": 1, "creation_date": 1525279458, "post_id": 50139373, "comment_id": 87297600, "body": "@ytpillai Arrays are allocated all at once, like all other types. Arrays are not pointers. Arrays are a collection of elements placed contiguously in memory, plus some weird conversion rules (almost all uses of an array in C code end up implicitly converting the array to a pointer to its first element (&quot;pointer decay&quot;))."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 3186, "user_id": 4871483, "user_type": "registered", "accept_rate": 45, "profile_image": "https://lh5.googleusercontent.com/-HMwbAOtRjY4/AAAAAAAAAAI/AAAAAAAABQk/jXK1QQ0bfqw/photo.jpg?sz=128", "display_name": "ytpillai", "link": "https://stackoverflow.com/users/4871483/ytpillai"}, "edited": false, "score": 0, "creation_date": 1525279600, "post_id": 50139373, "comment_id": 87297671, "body": "@ytpillai ... PS: If you see any tutorial talking about &quot;the name of an array&quot;, throw it away. Names don&#39;t matter."}, {"owner": {"reputation": 3186, "user_id": 4871483, "user_type": "registered", "accept_rate": 45, "profile_image": "https://lh5.googleusercontent.com/-HMwbAOtRjY4/AAAAAAAAAAI/AAAAAAAABQk/jXK1QQ0bfqw/photo.jpg?sz=128", "display_name": "ytpillai", "link": "https://stackoverflow.com/users/4871483/ytpillai"}, "edited": false, "score": 0, "creation_date": 1525286944, "post_id": 50139373, "comment_id": 87301328, "body": "Your answer is the best I&#39;ve ever seen. Thanks so much for the work you out into it, I can finally get past that whole confusion. I&#39;ve accepted but I think if you put it somewhere more accessible than this question as well you can really help a lot of people."}], "tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 4, "last_activity_date": 1525279331, "last_edit_date": 1525279331, "creation_date": 1525278410, "answer_id": 50139373, "question_id": 50139288, "link": "https://stackoverflow.com/questions/50139288/can-arrays-in-c-be-stored-in-non-sequential-pointers/50139373#50139373", "title": "Can arrays in C be stored in non-sequential pointers?", "body": "<blockquote>\n  <p>From what I understand about C arrays, they store pointers to values </p>\n</blockquote>\n\n<p>No, arrays store values directly. In fact, arrays essentially <em>are</em> their elements. C adds no additional structure.</p>\n\n<blockquote>\n<pre><code>char someCharArray[] = {'a', 'b', 'c'};\n</code></pre>\n</blockquote>\n\n<p>OK, here <code>someCharArray</code> consists of 3 bytes of memory. If it lives in static storage (e.g. because it's a global variable), this memory is typically part of the data section; if it lives in automatic memory (i.e. it's a local variable), it's typically placed on the stack.</p>\n\n<blockquote>\n  <p>Let's say my heap doesn't have sequential 12 bits for this array</p>\n</blockquote>\n\n<p>How is the heap involved here? Why 12 bits? C doesn't really support objects smaller than 1 byte (and bytes cannot be smaller than 8 bits).</p>\n\n<p>Let's say for the sake of an example that <code>someCharArray</code> ends up being placed at address 0xAB0000. Then the first element lives at 0xAB0000, the second element at 0xAB0001, and the third element at 0xAB0002.</p>\n\n<blockquote>\n<pre><code>char datPointer = someCharArray[1];\n</code></pre>\n</blockquote>\n\n<p><code>datPointer</code> is not a pointer, it's a single <code>char</code>. This code will assign <code>'b'</code> to <code>datPointer</code> (because <code>someCharArray[1]</code> is <code>'b'</code>).</p>\n\n<blockquote>\n<pre><code>char datWrongPointer = (someCharArray + 1);\n</code></pre>\n</blockquote>\n\n<p>This is a type error.</p>\n\n<p><code>someCharArray</code> evaluates to a pointer to its first element (as arrays do unless they're the operand of <code>sizeof</code> or <code>&amp;</code>). This gives us a value of type <code>char *</code> (and per above, the value is 0xAB0000).</p>\n\n<p>We add 1, which adds enough bytes to get to the next element in memory. Here the pointer type is <code>char *</code>, so we're adding <code>1 * sizeof (char)</code> (which is just <code>1 * 1</code>, which is just <code>1</code>) to the raw pointer value.</p>\n\n<p>We end up with a <code>char *</code> whose value is 0xAB0001.</p>\n\n<p>We then try to assign a pointer to a plain <code>char</code>, which is not valid. But we could dereference the pointer with <code>*</code> and fetch the value stored there:</p>\n\n<pre><code>char x = *(someCharArray + 1);  // 'b'\n</code></pre>\n\n<p>... or we could use a pointer variable:</p>\n\n<pre><code>char *ptr = someCharArray + 1;  // 0xAB0001 in this example\n</code></pre>\n"}], "owner": {"reputation": 3186, "user_id": 4871483, "user_type": "registered", "accept_rate": 45, "profile_image": "https://lh5.googleusercontent.com/-HMwbAOtRjY4/AAAAAAAAAAI/AAAAAAAABQk/jXK1QQ0bfqw/photo.jpg?sz=128", "display_name": "ytpillai", "link": "https://stackoverflow.com/users/4871483/ytpillai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 50139373, "answer_count": 1, "score": 0, "last_activity_date": 1525279331, "creation_date": 1525278118, "last_edit_date": 1525278733, "question_id": 50139288, "link": "https://stackoverflow.com/questions/50139288/can-arrays-in-c-be-stored-in-non-sequential-pointers", "title": "Can arrays in C be stored in non-sequential pointers?", "body": "<p>This is a conceptual question for me to understand C better. From what I understand about C arrays, they store pointers to values which are generated in sequence as per the space allocated. So for example, if I have this code </p>\n\n<pre><code>char someCharArray[] = {'a', 'b', 'c'};\n</code></pre>\n\n<p>Let's say my heap doesn't have sequential 12 bits for this array, so I store pointers to the following non-sequential addresses <code>0x001, 0x011, 0x040</code>. </p>\n\n<p>I know two ways of accessing values from this array as shown in <a href=\"https://stackoverflow.com/a/645111/4871483\">this answer</a>. </p>\n\n<p>Let's say I access the second element of the array like this</p>\n\n<pre><code>char datPointer = someCharArray[1];\n</code></pre>\n\n<p>In this case, <code>datPointer</code> will point to <code>0x011</code> because the address is stored in the array. </p>\n\n<p>However, wouldn't the following code return the wrong address?</p>\n\n<pre><code>char datWrongPointer = (someCharArray + 1);\n</code></pre>\n\n<p>Because I'm adding sequential addresses to the starting address of someCharArray, so assuming chars are 4 bits I'll get <code>datWrongPointer</code> to be <code>0x004</code> instead of what it should be? Maybe I'm misunderstanding the addition function but I'd appreciate if someone could explain it to me. </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1525277080, "post_id": 50138926, "comment_id": 87296223, "body": "Please read how to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> -- you just write &quot;<i>I can&#39;t do [foo]</i>&quot;, instead please include your input, your expected output and your actual output (<a href=\"https://stackoverflow.com/posts/50138926/edit\">edit your question</a> to include this information)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 2, "creation_date": 1525277210, "post_id": 50138926, "comment_id": 87296322, "body": "One thing to note anyways: <a href=\"https://stackoverflow.com/q/1694036/2371524\"><b>never use <code>gets()</code></b></a> and never use <code>scanf(&quot;%s&quot;, ...)</code> either which has the same flaw. For <code>scanf()</code>, use a <i>field width</i>, like in your example: <code>scanf(&quot;%99s&quot;, filename);</code>, or, better yet, <code>fgets()</code>. See also my <a href=\"http://sekrit.de/webdocs/c/beginners-guide-away-from-scanf.html\" rel=\"nofollow noreferrer\">beginners&#39; guide away from <code>scanf()</code></a>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1525277540, "post_id": 50138926, "comment_id": 87296517, "body": "And remember that <a href=\"http://en.cppreference.com/w/c/io/fgetc\" rel=\"nofollow noreferrer\"><code>fgetc</code></a> returns an <b><code>int</code></b>. This is rather important for that <code>EOF</code> check actually."}, {"owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "edited": false, "score": 1, "creation_date": 1525277895, "post_id": 50138926, "comment_id": 87296759, "body": "this <code>fptr = fopen(fptr, &quot;w&quot;);</code> doesn&#39;t make any sense as <code>fopen()</code> first argument is of <code>const chart*</code> type not <code>FILE*</code>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "edited": false, "score": 0, "creation_date": 1525278626, "post_id": 50138926, "comment_id": 87297151, "body": "Continuing a little on the comment by @achal: Once you fixed that, if your read-only open succeeded then you have a <i>resource leak</i> since you don&#39;t close the already opened file-handle."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1525455559, "post_id": 50138926, "comment_id": 87377945, "body": "regarding: <code>scanf(&quot;%s&quot;, filename);</code>  1) always check the returned value (not the parameter values) to assure the operation was successful.  (in this case, the returned value should be 1).  2) when using the &#39;%s&#39; and/or &#39;%[...]&#39; input format specifiers, always include a MAX CHARACTERS modifier that is 1 less than the length of the input buffer to avoid any buffer overflow because those input specifiers always append a NUL byte to the input."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1525455690, "post_id": 50138926, "comment_id": 87378013, "body": "when calling <code>fopen()</code>, always check (!=NULL) the returned value to assure the operation was successful."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1525455817, "post_id": 50138926, "comment_id": 87378070, "body": "when writing the signature for the <code>main()</code> function, if the parameters are not going to be used, then use the signature: <code>int main( void )</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1525455916, "post_id": 50138926, "comment_id": 87378129, "body": "it is a poor programming practice to include header files those contents are not used.  Suggest removing the <code>#include</code> statements for <code>unistd.h</code> and <code>string.h</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1525456171, "post_id": 50138926, "comment_id": 87378250, "body": "the file is being opened for <code>write</code> or <code>append</code>  then it is being written to.  At that time, the logical <code>file pointer</code> will be pointing just past the last character in the file.  So must be moved back to the beginning of the file, so the calls to <code>fgetc()</code> will work.    Suggest using <code>rewind()</code> for that purpose, before the first call to <code>fgets()</code>"}], "answers": [{"tags": [], "owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "is_accepted": false, "score": 0, "last_activity_date": 1525278856, "creation_date": 1525278856, "answer_id": 50139490, "question_id": 50138926, "link": "https://stackoverflow.com/questions/50138926/how-can-i-write-or-append-the-content-fo-text-file-then-display/50139490#50139490", "title": "How can I write or append the content fo text file then display?", "body": "<p>If you want to open a file for reading and to also append to it, you can do that with just one call to <code>fopen</code> by using the mode <code>a+</code>.</p>\n\n<pre><code>fptr = fopen(filename, \"a+\");\nif (fptr == NULL)\n{\n   // Handle not being able to open the file\n}\n</code></pre>\n\n<p>If the file doesn't exist, it will create it. The position for reading will be at the beginning of the file, but anything you write to it will be at the end.</p>\n"}, {"tags": [], "owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "is_accepted": false, "score": 0, "last_activity_date": 1525280968, "creation_date": 1525280968, "answer_id": 50140074, "question_id": 50138926, "link": "https://stackoverflow.com/questions/50138926/how-can-i-write-or-append-the-content-fo-text-file-then-display/50140074#50140074", "title": "How can I write or append the content fo text file then display?", "body": "<p>There are lot of bugs as mentioned by others in comments. I tried to explain in comments, read it carefully.</p>\n\n<pre><code>int main(int argc, char** argv) {\n        char filename[100], content[100];\n        FILE *fptr;\n\n        printf(\"Enter content: \\n\");\n        fgets(content,sizeof(content),stdin); /*use fgets() instead of gets()*/\n\n        printf(\"File name: \");\n        scanf(\"%s\", filename);\n\n\n        if ((fptr = fopen(filename, \"r\")) == NULL) {/*if doesn't exist */\n                fptr = fopen(filename, \"w\"); /*create it */\n                fprintf(fptr,\"%s\", content); /* and write it */\n        }\n        else{\n                /* it should be a+ if you want to read, as you are doing using fgetc() */\n                fptr = fopen(filename, \"a+\");/*if exist, write at end of file */\n                fprintf(fptr,\"%s\", content);/* write at end */\n        }\n        rewind(fptr);/* move the fptr to beginning to read further */\n        int c = 0; /* fgetc() returns integer */\n        while( (c = fgetc(fptr))!= EOF) {     \n                printf (\"%c\\n\", c);\n        } \n        fclose(fptr);\n        return 0;\n}\n</code></pre>\n\n<p>Use <code>fgets()</code> instead of <code>gets()</code>. Read here <a href=\"https://stackoverflow.com/questions/1694036/why-is-the-gets-function-so-dangerous-that-it-should-not-be-used\">Why is the gets function so dangerous that it should not be used?</a> </p>\n"}], "owner": {"reputation": 31, "user_id": 8442880, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-UK7aB5ME8fY/AAAAAAAAAAI/AAAAAAAAAeM/aBx2Mc6GVls/photo.jpg?sz=128", "display_name": "An M\u1ea1nh", "link": "https://stackoverflow.com/users/8442880/an-m%e1%ba%a1nh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1525280968, "creation_date": 1525276901, "question_id": 50138926, "link": "https://stackoverflow.com/questions/50138926/how-can-i-write-or-append-the-content-fo-text-file-then-display", "title": "How can I write or append the content fo text file then display?", "body": "<p>How can I write and create the file, append if the file exists, then display all string file text? I can't append the content to at the end of file text, then display all strings. Thank for reading!</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include&lt;string.h&gt;\n#include&lt;unistd.h&gt;\nint main(int argc, char** argv) {\nchar c, filename[100], content[100];\nFILE *fptr;\nprintf(\"File name: \");\nscanf(\"%s\", filename);\n\nprintf(\"Enter content: \");\ngets(content);\nif ((fptr = fopen(filename, \"r\")) == NULL)\n{\n    fptr = fopen(fptr, \"w\");\n   fprintf(fptr,\"%s\", content);    \n}\nelse{\n     fptr = fopen(fptr, \"a\");\n     fprintf(fptr,\"%s\", content);\n}\n\nc = fgetc(fptr);\nwhile (c != EOF)\n{     \n    printf (\"%c\", c);\n    c = fgetc(fptr);\n} \nfclose(fptr);\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c", "struct", "linked-list", "crash"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 3, "creation_date": 1525276394, "post_id": 50138700, "comment_id": 87295793, "body": "The address assigned to <code>start</code> does not get returned to the caller. You need to use double indrection (<code>list **start</code>) or return <code>start</code> as the function result. Note: if you had used a debugger to investigate this then the problem should have been immediately apparent."}, {"owner": {"reputation": 4031, "user_id": 7640269, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/szGUJ.png?s=128&g=1", "display_name": "danglingpointer", "link": "https://stackoverflow.com/users/7640269/danglingpointer"}, "edited": false, "score": 0, "creation_date": 1525276535, "post_id": 50138700, "comment_id": 87295893, "body": "What error you get from compiler? Would you paste that info? Perhaps make void display as int display()?"}, {"owner": {"reputation": 59, "user_id": 3256811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7edc6acef8dab4f2567fb35a8587135?s=128&d=identicon&r=PG&f=1", "display_name": "anmoloo7", "link": "https://stackoverflow.com/users/3256811/anmoloo7"}, "edited": false, "score": 0, "creation_date": 1525276769, "post_id": 50138700, "comment_id": 87296040, "body": "Compiler errors are 0 and 0 warning.using gcc"}, {"owner": {"reputation": 846, "user_id": 4675426, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/6a40956551f38afd8a2c712b4780d73a?s=128&d=identicon&r=PG", "display_name": "Karthick", "link": "https://stackoverflow.com/users/4675426/karthick"}, "edited": false, "score": 0, "creation_date": 1525277069, "post_id": 50138700, "comment_id": 87296221, "body": "How do you call the <code>create()</code> and <code>display()</code> function. Post the complete code"}, {"owner": {"reputation": 59, "user_id": 3256811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7edc6acef8dab4f2567fb35a8587135?s=128&d=identicon&r=PG&f=1", "display_name": "anmoloo7", "link": "https://stackoverflow.com/users/3256811/anmoloo7"}, "edited": false, "score": 0, "creation_date": 1525277351, "post_id": 50138700, "comment_id": 87296400, "body": "Full Code temporarily posted @ <a href=\"http://uman.ga/tmp\" rel=\"nofollow noreferrer\">uman.ga/tmp</a>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1525479838, "post_id": 50138700, "comment_id": 87386371, "body": "regarding: <code>scanf(&quot;%d&quot;,&amp;data);     if(data==0){         start=NULL;         return;     }</code>  The posted error handling is nonsense.  a 0 is a valid input.  This is what should have been done: `If( scanf(&quot;%d&quot;,&amp;data) != 1 ) { //handle error }  // implied else, scanf successful..."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1525480103, "post_id": 50138700, "comment_id": 87386406, "body": "regarding: <code>void display(list *start)</code> and <code>start=(list*)malloc(sizeof(list));</code>  1) the return type from any of the heap allocation functions is: <code>void*</code> which can be assigned to any pointer.  Casting just clutters the code.  2) always check (!=NULL) the returned value to assure the operation was successful.  3) to change where a pointer points, the address of the pointer must be passed 4) the signature should be <code>void create(list **start)</code>  then dereference the &#39;start&#39; via a single <code>*</code> to access the pointer location"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1525480264, "post_id": 50138700, "comment_id": 87386441, "body": "regarding: <code>start=(list*)malloc(sizeof(list));         start-&gt;data=data; create(start-&gt;right);</code>  this should be: <code>*start=malloc(sizeof(list));  if( !*start ) { perror( &quot;malloc failed: ); } else {  (* start)-&gt;data=data; create(&amp;(start-&gt;right));</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1525480992, "post_id": 50138700, "comment_id": 87386532, "body": "Nothing in the question text states that the user entering a 0 stops the recursive function: <code>create()</code>  so I have to assume that the checking for a 0 is a logic error."}], "answers": [{"comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1525480640, "post_id": 50139929, "comment_id": 87386504, "body": "so many errors in this answer, I don&#39;t know where to (sic) start"}], "tags": [], "owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "is_accepted": true, "score": 1, "last_activity_date": 1525280395, "creation_date": 1525280395, "answer_id": 50139929, "question_id": 50138700, "link": "https://stackoverflow.com/questions/50138700/pointers-and-linked-list-in-c-crash-on-display/50139929#50139929", "title": "Pointers and linked list in C | Crash on display", "body": "<p>Firstly, in <code>create()</code> function <code>start</code> should be of <code>list**</code> type if you want changes should affect in calling function <code>main()</code> function otherwise it's simply call by value.</p>\n\n<pre><code>void create(list **start) {\n  /*some code */\n}\n</code></pre>\n\n<p>Secondly, your recursive logic of linking node is correct as every time <code>start</code> points to new memory location &amp; every time old memory is lost so there is  no link between the nodes.</p>\n\n<p>So take extra <code>temp</code> pointer variable of <code>list</code> type. <code>create()</code> function looks like</p>\n\n<pre><code>void create(list **start,list *new){\n        int data;\n        printf(\"Input value : \");\n        scanf(\"%d\",&amp;data);\n        if(data != 0){\n                new = malloc(sizeof(list));/*allocate memory */\n                new-&gt;data = data;/*put the data */\n                new-&gt;right  = *start; /*new node right should be head ptr */\n                *(start) = new; /*update the head ptr */\n                create(start,new);\n        }\n        else\n                return;\n}\n</code></pre>\n\n<p>And from <code>main()</code> call the <code>create()</code> like this</p>\n\n<pre><code>int main(void) {\n        list *head_ptr = NULL, *temp = NULL;\n        create(&amp;head_ptr,temp);\n        display(head_ptr);\n        return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 546, "user_id": 9721071, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "\u043c\u0430\u043b\u0438\u043d \u0447\u0435\u043a\u0443\u0440\u043e\u0432", "link": "https://stackoverflow.com/users/9721071/%d0%bc%d0%b0%d0%bb%d0%b8%d0%bd-%d1%87%d0%b5%d0%ba%d1%83%d1%80%d0%be%d0%b2"}, "is_accepted": false, "score": 0, "last_activity_date": 1525281567, "creation_date": 1525281567, "answer_id": 50140253, "question_id": 50138700, "link": "https://stackoverflow.com/questions/50138700/pointers-and-linked-list-in-c-crash-on-display/50140253#50140253", "title": "Pointers and linked list in C | Crash on display", "body": "<p>The problem here is that <code>create()</code> allocates new nodes but loses the pointers to them, this is a perfect example of memory leak. </p>\n\n<p>This happens, because when you pass pointer to function, you pass it's value and the local parameter is just something on the stack that has this value - the local parameter is not the same pointer as the pointer you passed to the function, it only has the same value.</p>\n\n<p>So when you allocate new node, you make the local pointer point to the new node, not the pointer you passed to the function and when the function exits this local pointer does not exist anymore and you lose the reference to the located memory - memory leak happens.</p>\n\n<p>So how do you change the pointer you passed to the function from inside the function?It's simple - just pass to the function the address of the pointer.\nWhen you want to change some variable, you make a pointer point to it's address and then you dereference the pointer.Here you will do the same - take the address of the pointer and dereference a double pointer that points to it.\nJust minor changes are needed like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct node{\n    int data;\n    struct node *right;\n}list;\n\nvoid create(list **start){\n    int data;\n        printf(\"Input value : \");\n        scanf(\"%d\",&amp;data);\n        if(data==0){\n            start=NULL;\n            return;\n        }\n        else{\n            *start=(list*)malloc(sizeof(list));\n            (*start)-&gt;data=data;\n            create(&amp;(*start)-&gt;right);\n        }\n}\n\nvoid display(list *start){\n    printf(\"%d\",start-&gt;data);\n    if(start-&gt;right==NULL)return;\n    display(start-&gt;right);\n}\n\n\nint main(void){\n    list *LIST=NULL;\n\n    create(&amp;LIST);\n    display(LIST);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 3256811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7edc6acef8dab4f2567fb35a8587135?s=128&d=identicon&r=PG&f=1", "display_name": "anmoloo7", "link": "https://stackoverflow.com/users/3256811/anmoloo7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 233, "favorite_count": 0, "accepted_answer_id": 50139929, "answer_count": 2, "score": 0, "last_activity_date": 1525281567, "creation_date": 1525276246, "question_id": 50138700, "link": "https://stackoverflow.com/questions/50138700/pointers-and-linked-list-in-c-crash-on-display", "title": "Pointers and linked list in C | Crash on display", "body": "<p>On running display() , program crashes.May be there is a problem in create().\nI tried but i cant identify the problem.I am destroying their links but where? i dont know.It is a singly linked list.</p>\n\n<p>node structure is</p>\n\n<pre><code>typedef struct node{\n   int data;\n   struct node *right;\n}list;\n</code></pre>\n\n<p>Here is create()</p>\n\n<pre><code>void create(list *start){\nint data;\n    printf(\"Input value : \");\n    scanf(\"%d\",&amp;data);\n    if(data==0){\n        start=NULL;\n        return;\n    }\n    else{\n        start=(list*)malloc(sizeof(list));\n        start-&gt;data=data;\n        create(start-&gt;right);\n    }\n}\n</code></pre>\n\n<p>And display() is</p>\n\n<pre><code>void display(list *start){\n    printf(\"%d\",start-&gt;data);\n    if(start-&gt;right==NULL)return;\n    display(start-&gt;right);\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers", "hex"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1525276915, "post_id": 50138637, "comment_id": 87296124, "body": "a bit unclear what you want, there&#39;s no such thing as &quot;<i>hex data</i>&quot;. hexadecimal is just a way to write the data. A variable holding multiple bytes at once (e.g. an <code>unsigned long long</code>) is <b>not</b> necessarily the same as an array of bytes, because of <a href=\"https://en.wikipedia.org/wiki/Endianness\" rel=\"nofollow noreferrer\">endianness</a>. To get a proper answer, please <a href=\"https://stackoverflow.com/posts/50138637/edit\">edit</a> your question and create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1525278558, "post_id": 50138637, "comment_id": 87297114, "body": "@user8540390 With C99 code could use a <i>compound literal</i>: <code>Frame2Data((uint8_t [8]){ 5, 0, 0, 0, 0, 3, 0xE8, 0},sB,l);</code>  But what is best depends on 1) how that data is created and 2) is it used after <code>Frame2Data()</code>."}], "answers": [{"comments": [{"owner": {"reputation": 143, "user_id": 8540390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3d8fc1dec42ea6332e7ab53e73102b4?s=128&d=identicon&r=PG", "display_name": "user8540390", "link": "https://stackoverflow.com/users/8540390/user8540390"}, "edited": false, "score": 0, "creation_date": 1525312432, "post_id": 50139329, "comment_id": 87309777, "body": "Yes, since the length is equal to 7, mask is initialized to <code>0x7F</code>."}, {"owner": {"reputation": 143, "user_id": 8540390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3d8fc1dec42ea6332e7ab53e73102b4?s=128&d=identicon&r=PG", "display_name": "user8540390", "link": "https://stackoverflow.com/users/8540390/user8540390"}, "edited": false, "score": 0, "creation_date": 1525336440, "post_id": 50139329, "comment_id": 87318634, "body": "Yeah understood and got it.Thankyou"}], "tags": [], "owner": {"reputation": 87, "user_id": 9557323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7b5f2162e8f969ce9d2e7a75f995e6d?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrice Derepas", "link": "https://stackoverflow.com/users/9557323/fabrice-derepas"}, "is_accepted": true, "score": 1, "last_activity_date": 1525278269, "creation_date": 1525278269, "answer_id": 50139329, "question_id": 50138637, "link": "https://stackoverflow.com/questions/50138637/how-to-pass-hexadecimal-data-inside-the-following-function/50139329#50139329", "title": "How to pass hexadecimal data inside the following function", "body": "<p>To pass data written in hexadecimal to <code>data</code>, you can simply write:</p>\n\n<pre><code>uint8_t data [] = { 0x05, 0x00, 0x00, 0x00, 0x00, 0x03, 0xE8, 0x00};\n</code></pre>\n\n<p>Note that variable <code>mask</code> is uninitialized, because <code>l</code> is equal to 7 and all instructions to initialize variable <code>mask</code> are dead code, as show in red, with a source code analyzer:</p>\n\n<p><a href=\"https://taas.trust-in-soft.com/tsnippet/t/6d486c5b\" rel=\"nofollow noreferrer\">https://taas.trust-in-soft.com/tsnippet/t/6d486c5b</a></p>\n"}], "owner": {"reputation": 143, "user_id": 8540390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3d8fc1dec42ea6332e7ab53e73102b4?s=128&d=identicon&r=PG", "display_name": "user8540390", "link": "https://stackoverflow.com/users/8540390/user8540390"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 1, "accepted_answer_id": 50139329, "answer_count": 1, "score": 0, "last_activity_date": 1525312293, "creation_date": 1525275950, "last_edit_date": 1525312293, "question_id": 50138637, "link": "https://stackoverflow.com/questions/50138637/how-to-pass-hexadecimal-data-inside-the-following-function", "title": "How to pass hexadecimal data inside the following function", "body": "<p>I have my following program that has a function that will extract the particular Bytes from a frame of 8 Bytes data and will give a corresponding value needed based on the start bit and bit length (length counted from the start bit). </p>\n\n<p>How can i pass the data of 8 bytes which is in hexa decimal to my pointer *data in the main function.\nFor example this is my frame data in hexadecimal '05 00 00 00 00 03 E8 00'. Here is my program. Would be grat if someone help me to solve this. Should i take an array and pass the data as <code>0x05 0x00 0x00 0x00 0x00 0x03 0xE8 0x00</code> into the array and then give assign address of the array to the pointer variable? or just take a variable that holds <code>0x050000000003E800</code> and assign this address to the pointer.Are the both same?   Thanks in advance.</p>\n\n<pre><code>union u_t\n{\n  uint16_t u16;\n  uint8_t u8[2];\n};\nuint16_t Frame2Data(uint8_t *data,uint8_t startBit,uint16_t length)\n{\n  uint16_t mask;\n  uint8_t start;\n  uint8_t firstByte,offset;\n  uint8_t numShift;\n  union u_t ut;\n  /*if(length == 8)     //preliminary, has to be fixed by correct function.  \n    mask =  0xff;*/\n  if(length == 7)\n    mask = 0x7F;\n  if(length == 10)\n    mask = 0x3ff;\n  if(length == 12)\n    mask = 0xfff;\n\n  firstByte = startBit / 8;\n  offset = (firstByte+2) * 8;\n  start = startBit + length;\n  numShift = offset - start;\n  ut.u8[1] = data[firstByte];\n  ut.u8[0] = data[firstByte+1];\n  return (ut.u16 &gt;&gt; numShift) &amp; mask;\n}\nint main()\n{\n  ??????????\n  uint8_t sB = 46;\n  uint16_t l = 7;\n  uint16_t extractValue = Frame2Data(?,sB,l);\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "multithreading", "queue", "pthreads", "circular-buffer"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 4, "creation_date": 1525276050, "post_id": 50138604, "comment_id": 87295570, "body": "&quot;he problem is the size of the buffer is always 8 bytes&quot; How do you know? This looks fine to me. Well, except the function never returning the malloc&#39;ed pointer but using globals instead..."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1525276051, "post_id": 50138604, "comment_id": 87295571, "body": "Please don&#39;t put clarifications in comments but <a href=\"https://stackoverflow.com/posts/50138604/edit\">edit</a> your question and put them <i>there</i>."}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1525276170, "post_id": 50138604, "comment_id": 87295651, "body": "When you say you declare things, you are actually declaring pointers to things. I suspect you are seeing the size of the pointer, not the size of the thing pointed to. You can write <code>sizeof *q</code> to get the size of the default object q points to."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1525276173, "post_id": 50138604, "comment_id": 87295654, "body": "Proper naming is always a good idea. E.g. <code>struct plane *q;</code> should rather be named <code>struct plane *planequeue; </code>. This would avoid horrors like <code>q-&gt;q</code>."}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 1, "last_activity_date": 1525276703, "creation_date": 1525276703, "answer_id": 50138867, "question_id": 50138604, "link": "https://stackoverflow.com/questions/50138604/size-of-pointer-inside-a-struct/50138867#50138867", "title": "Size of pointer inside a struct", "body": "<p>If you're trying to get the size of the array by doing <code>sizeof(q-&gt;q)</code>, this won't work as you expect.</p>\n\n<p>Since the <code>q</code> field of <code>struct queue</code> is a pointer and not an array, <code>sizeof(q-&gt;q)</code> actually gives you the size of the pointer which on your machine appears to be 8 bytes in size.</p>\n\n<p>The language doesn't keep track of how much memory was allocated in a call to <code>malloc</code>, so you need to keep track of that yourself.  The good thing is that   you're already doing that.</p>\n\n<p>You correctly allocated room for an array of <code>struct place</code> of size <code>size</code> by using <code>malloc(sizeof(struct plane) * size)</code>, and you stored <code>size</code> in <code>q-&gt;capacity</code>.  So you know how big the array is.</p>\n"}], "owner": {"reputation": 23, "user_id": 5968298, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-F7VB5hLriok/AAAAAAAAAAI/AAAAAAAAAFY/8_Lmpe2dbIk/photo.jpg?sz=128", "display_name": "jo_tablanco", "link": "https://stackoverflow.com/users/5968298/jo-tablanco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 227, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1525276703, "creation_date": 1525275904, "last_edit_date": 1525276648, "question_id": 50138604, "link": "https://stackoverflow.com/questions/50138604/size-of-pointer-inside-a-struct", "title": "Size of pointer inside a struct", "body": "<p>So, I have this structure used to implement a circular buffer of another structure (<code>plane</code>)</p>\n\n<pre><code>typedef struct queue\n{\n    struct plane *q;        \n    int size, capacity, front, rear;  \n}queue;\n</code></pre>\n\n<p>After this I declare the structure</p>\n\n<pre><code>queue *q;\n</code></pre>\n\n<p>and later, to inicialize the buffer, I use this method</p>\n\n<pre><code>int queue_init(int size){\n\n    q = (queue*) malloc(sizeof(queue));\n\n    q-&gt;q=malloc(sizeof(struct plane) * size); \n\n    q-&gt;size = 0;\n    q-&gt;capacity = size;\n    q-&gt;front = 0;\n    q-&gt;rear = 0;\n\n    return 0;\n}\n</code></pre>\n\n<p>which is supposed to be the one that inicializes all the variables I need to use the buffer and the buffer itself with <code>q-&gt;q=malloc(sizeof(struct plane) * size);</code>. \nThe problem is the size of the buffer is always 8 bytes, where it should be as it says, <code>size</code> times the size of <code>plane</code>, which is actually 16.\nThe thing is how should I initialize the variables so I can get the buffer the size I want. I can't change the return value or the parameters of the function as limitations. \nThank you beforehand! </p>\n"}, {"tags": ["c", "pthreads"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 9731079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8416ebd63be2a12a4607d09af76e0be?s=128&d=identicon&r=PG&f=1", "display_name": "torae", "link": "https://stackoverflow.com/users/9731079/torae"}, "edited": false, "score": 0, "creation_date": 1525277270, "post_id": 50138902, "comment_id": 87296353, "body": "makes sense, thank you; also, it seems i&#39;ve missed the relock keyword in the OpenGroup doc."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "reply_to_user": {"reputation": 23, "user_id": 9731079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8416ebd63be2a12a4607d09af76e0be?s=128&d=identicon&r=PG&f=1", "display_name": "torae", "link": "https://stackoverflow.com/users/9731079/torae"}, "edited": false, "score": 0, "creation_date": 1525277688, "post_id": 50138902, "comment_id": 87296613, "body": "Not-directly-related but recursive mutexes are generally error-prone. See the <a href=\"https://groups.google.com/forum/message/raw?msg=comp.programming.threads/tcrTKnfP8HI/me2K7_byNdgJ\" rel=\"nofollow noreferrer\">commentary by Dave Butenhof</a>."}, {"owner": {"reputation": 23, "user_id": 9731079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8416ebd63be2a12a4607d09af76e0be?s=128&d=identicon&r=PG&f=1", "display_name": "torae", "link": "https://stackoverflow.com/users/9731079/torae"}, "edited": false, "score": 0, "creation_date": 1525278099, "post_id": 50138902, "comment_id": 87296874, "body": "i was thinking of implementing a retry mechanism with the use of them; retrying while the resource is locked, hm, seemed tempting; most probably will reconsider this; thank you once again."}], "tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": true, "score": 1, "last_activity_date": 1525276842, "creation_date": 1525276842, "answer_id": 50138902, "question_id": 50138578, "link": "https://stackoverflow.com/questions/50138578/pthread-mutex-recursive-blocks-on-second-thread/50138902#50138902", "title": "PTHREAD_MUTEX_RECURSIVE blocks on second thread", "body": "<blockquote>\n  <p>it blocks when the mutex is locked from another thread</p>\n</blockquote>\n\n<p>If the mutex is recursive and the thread that calls <code>pthread_mutex_lock</code> already holds that mutex, only then it'll return immediately. In your case, the <em>main</em> thread locks the mutex and a different thread attempts to acquire that mutex which gets blocked because it's held by a different. This is normal behaviour.</p>\n\n<p>If <em>any</em> thread can unlock any (recursive) mutex held by other thread(s), then recursive mutexes would be useless!</p>\n\n<p>See <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/pthread_mutex_lock.html\" rel=\"nofollow noreferrer\">POSIX</a> documentation too.</p>\n"}], "owner": {"reputation": 23, "user_id": 9731079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8416ebd63be2a12a4607d09af76e0be?s=128&d=identicon&r=PG&f=1", "display_name": "torae", "link": "https://stackoverflow.com/users/9731079/torae"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2196, "favorite_count": 0, "accepted_answer_id": 50138902, "answer_count": 1, "score": 2, "last_activity_date": 1525276842, "creation_date": 1525275807, "question_id": 50138578, "link": "https://stackoverflow.com/questions/50138578/pthread-mutex-recursive-blocks-on-second-thread", "title": "PTHREAD_MUTEX_RECURSIVE blocks on second thread", "body": "<p>I have the following problem with the PTHREAD_MUTEX_RECURSIVE: it blocks when the mutex is locked from another thread; </p>\n\n<pre><code>pthread_mutex_t m;\npthread_mutexattr_t ma;\n\nvoid* exec_th(void* arg) {\n    printf(\"THREAD %p before LOCK\\n\", pthread_self());\n\n    //second mutex lock\n    pthread_mutex_lock(&amp;m);\n    printf(\"THREAD %p after LOCK\\n\", pthread_self());\n\n    pthread_mutex_unlock(&amp;m);\n    printf(\"THREAD %p after UNLOCK\\n\", pthread_self());\n\n    return (void*)0;\n}\n\nint main() {\n    pthread_mutexattr_init(&amp;ma);\n    pthread_mutexattr_settype(&amp;ma, PTHREAD_MUTEX_RECURSIVE);\n    pthread_mutex_init(&amp;m, &amp;ma);\n\n    // first mutex lock\n    pthread_mutex_lock(&amp;m);\n\n    // create a thread that will call the same mutex\n    pthread_t t;\n    pthread_create(&amp;t, NULL, exec_th, NULL);\n\n    sleep(1); //just to see the console\n\n    pthread_mutex_unlock(&amp;m);\n}\n</code></pre>\n\n<p>The OpenGroup states: </p>\n\n<blockquote>\n  <p>A thread attempting to relock this mutex without first unlocking it\n  will succeed in locking the mutex. The relocking deadlock which can\n  occur with mutexes of type PTHREAD_MUTEX_NORMAL cannot occur with this\n  type of mutex</p>\n</blockquote>\n\n<p>Still, the above code generates the same behaviour for PTHREAD_MUTEX_RECURSIVE and PTHREAD_MUTEX_NORMAL:</p>\n\n<ul>\n<li>only <em>before LOCK</em> is printed before the sleep() in main();  </li>\n<li>the thread locks the mutex after it is released by the main();</li>\n</ul>\n\n<p>Any help is greatly appreciated, thank you.</p>\n"}, {"tags": ["c", "linux-kernel", "ioctl", "block-device"], "answers": [{"tags": [], "owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "is_accepted": true, "score": 4, "last_activity_date": 1525339668, "last_edit_date": 1525339668, "creation_date": 1525279784, "answer_id": 50139755, "question_id": 50138570, "link": "https://stackoverflow.com/questions/50138570/block-device-driver-understanding-received-ioctl/50139755#50139755", "title": "Block device driver - Understanding received ioctl", "body": "<p>Setting up a loop device (sudo <code>losetup loop0 /path/to/some/image</code>), the output of <code>strace dd if=/dev/loop0 of=out.data skip=10 bs=40 count=2</code> contains</p>\n\n<pre><code>open(\"/dev/loop0\", O_RDONLY)            = 3\ndup2(3, 0)                              = 0\nclose(3)                                = 0\nlseek(0, 0, SEEK_CUR)                   = 0\nioctl(0, MTIOCGET, 0x7fffac670080)      = -1 EINVAL (Invalid argument)\nlseek(0, 400, SEEK_CUR)                 = 400\nfstat(0, {st_mode=S_IFBLK|0660, st_rdev=makedev(7, 0), ...}) = 0\n</code></pre>\n\n<p>which indicates <code>dd</code> is trying to do an <code>MTIOCGET</code> ioctl on your block device.  <a href=\"http://man7.org/linux/man-pages/man4/st.4.html\" rel=\"nofollow noreferrer\"><code>man 4 st</code></a> shows</p>\n\n<blockquote>\n  <p>The st driver provides the interface to a variety of SCSI tape devices.\n  <br>[...]<br>\n  MTIOCGET \u2014 get status<br>\n  This request takes an argument of type (struct mtget *).</p>\n</blockquote>\n\n<p>In other words, <code>dd</code> suspects your block device might be some variety of SCSI tape device, and asks it for the status using the <code>ioctl()</code> you are seeing.</p>\n\n<p>It is perfectly okay for your driver to return <code>EINVAL</code> for this; that's what e.g. loop devices do, too.</p>\n"}], "owner": {"reputation": 773, "user_id": 7991581, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f0ffccced69419766694f1774f275a3a?s=128&d=identicon&r=PG&f=1", "display_name": "Arkaik", "link": "https://stackoverflow.com/users/7991581/arkaik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 559, "favorite_count": 0, "accepted_answer_id": 50139755, "answer_count": 1, "score": 2, "last_activity_date": 1525339668, "creation_date": 1525275780, "question_id": 50138570, "link": "https://stackoverflow.com/questions/50138570/block-device-driver-understanding-received-ioctl", "title": "Block device driver - Understanding received ioctl", "body": "<p>I just implemented a virtual block device and as I was playing with it I seen and strange behaviour related to ioctls.</p>\n\n<p>My device is just a memory zone divided in two 512 bytes sectors. I can currently read/write from/to it at a specific offset using system calls.</p>\n\n<p>The device is also protected against concurrent write access. It accept an unlimited number of reader but only one writter at time and only if nobody is currently reading from it.</p>\n\n<p>Ioctls aren't handled yet but despite of it I was logging related informations.</p>\n\n<pre><code>int block_mod_ioctl(struct block_device *bdev, fmode_t mode, unsigned int cmd, unsigned long arg)\n{\n    DEBUG(\"Entering IOCTL handling function\\n\");\n    switch(cmd)\n    {\n        default:\n            WARNING(\"Unknown ioctl call: %x\\n\", cmd);\n            WARNING(\"Ioctl: type=%x\\tnumber=%x\\tdirection=%x\\tsize=%x\\n\", _IOC_TYPE(cmd), _IOC_NR(cmd), _IOC_DIR(cmd), _IOC_SIZE(cmd));\n            return -1;\n    }\n    return 0;\n}\n</code></pre>\n\n<p>I was playing with <code>dd</code> and I found a strange behaviour that I don't understand after some digging around.</p>\n\n<pre><code># dd if=/dev/blkmodtest of=file.out seek=10\n[  107.367797] Oppened in read only mode\n[  107.368595] Read access: 1   Write access: 0\n[  107.370367] Reading from device\n[  107.372939] Closed read only mode\n[  107.373690] Read access: 0   Write access: 0\n2+0 records in\n2+0 records out\n1024 bytes (1.0 kB, 1.0 KiB) copied, 0.00584625 s, 175 kB/s\n\n# dd if=/dev/blkmodtest of=file.out skip=10\n[  111.982493] Oppened in read only mode\n[  111.983326] Read access: 1   Write access: 0\n[  111.985247] Unknown ioctl call: 80306d02\n[  111.986096] Ioctl: type=6d   number=2    direction=2 size=30\n[  111.987618] Unknown ioctl call: 80306d02\n[  111.988436] Ioctl: type=6d   number=2    direction=2 size=30\ndd: /dev/blkmodtest: cannot skip: Invalid argument\n[  111.991032] Closed read only mode\n[  111.991705] Read access: 0   Write access: 0\n0+0 records in\n0+0 records out\n0 bytes copied, 0.00783969 s, 0.0 kB/s\n</code></pre>\n\n<p>It seems that <code>dd</code> is issuing an ioctl call that my driver can't (obviously) handle. I know that I should not give <code>skip=10</code> but <code>seek=10</code> as I'm reading from the device but it was for test purpose.</p>\n\n<p>I'm currently trying to understand <strong><em>why</em></strong> this ioctl is issued and for <strong><em>what purpose</em></strong>?</p>\n\n<p>If I understand well the documentation I have found, the ioctl type is <code>'m'</code> which should be described into one of the following file (<a href=\"https://github.com/torvalds/linux/blob/master/Documentation/ioctl/ioctl-number.txt\" rel=\"nofollow noreferrer\">source</a>):</p>\n\n<pre><code>'m' 00-09   linux/mmtimer.h     conflict!\n'm' all linux/mtio.h        conflict!\n'm' all linux/soundcard.h   conflict!\n'm' all linux/synclink.h    conflict!\n'm' 00-19   drivers/message/fusion/mptctl.h conflict!\n'm' 00 drivers/scsi/megaraid/megaraid_ioctl.h conflict!\n</code></pre>\n\n<p>I have checked those files but I can't find useful information which would help me to go further into understanding what's happening in that specific case.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 11711, "user_id": 1361787, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/XR9JP.png?s=128&g=1", "display_name": "ChiefTwoPencils", "link": "https://stackoverflow.com/users/1361787/chieftwopencils"}, "edited": false, "score": 2, "creation_date": 1525275008, "post_id": 50138277, "comment_id": 87294907, "body": "Please put your code + in/output in your post."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 3, "creation_date": 1525275008, "post_id": 50138277, "comment_id": 87294909, "body": "Please don&#39;t post pictures of text. Post text"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 2, "creation_date": 1525275080, "post_id": 50138277, "comment_id": 87294964, "body": "We need you to post each of these two questions separately.  The short answer to question 1 is &quot;don&#39;t use any of those, use fgets and strtok, if your instructor hasn&#39;t taught you about fgets already they are teaching C Wrong\u2122&quot;.  The short answer to question 2 is &quot;the correct way to do that is <code>printf(&quot;%08x\\n&quot;, x);</code> and <code>x&gt;&gt;31</code> does something completely different, not at all what you want.&quot;  The long answer to each is several paragraphs long and we want them to be findable separately by future people having the same problems."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1525275125, "post_id": 50138277, "comment_id": 87294985, "body": "For Q1: What is it you want the user to input? Their age? gender? name? income? That&#39;s really important cause the way to do it depends on that. BTW: On terminology: A user <b>don&#39;t</b> inputs variables. A user inputs values that your program stores in appropriate variables."}, {"owner": {"reputation": 1, "user_id": 9731110, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Robert", "link": "https://stackoverflow.com/users/9731110/robert"}, "edited": false, "score": 0, "creation_date": 1525275388, "post_id": 50138277, "comment_id": 87295161, "body": "Hello, thank you all for the quick replies. I apologize for the lack of information on my question. I definitely should have paid more attention on how to post here. I will edit my question to make it make more sense."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1525275499, "post_id": 50138277, "comment_id": 87295229, "body": "For Q2: What do you mean by &quot;the 32bit binary code of ...&quot;? You do know that <code>&gt;&gt;</code> is a shift operator, right ?"}], "answers": [{"comments": [{"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1525275696, "post_id": 50138474, "comment_id": 87295344, "body": "Quote: &quot;signed and negative, in which case I believe it resolves to -1&quot; Well, maybe... According to the standard it is implementation defined so you can get any value."}], "tags": [], "owner": {"reputation": 401, "user_id": 532735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/361221a22572d5f2721207c7307a0975?s=128&d=identicon&r=PG", "display_name": "Dave Knight", "link": "https://stackoverflow.com/users/532735/dave-knight"}, "is_accepted": false, "score": 0, "last_activity_date": 1526046492, "last_edit_date": 1526046492, "creation_date": 1525275473, "answer_id": 50138474, "question_id": 50138277, "link": "https://stackoverflow.com/questions/50138277/a-few-questions-regarding-a-simple-c-programming-code/50138474#50138474", "title": "A few questions regarding a simple c programming code", "body": "<p>Re: scanf, I suggest reading the documentation for the function. This page is for Visual Studio 2015 but the examples should help you whichever IDE you're using:</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/w40768et.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/w40768et.aspx</a></p>\n\n<p>You are misunderstanding what the \">>\" operator does. (result1>>31) will shift result1 right by 31 bits. This will result in 0 for a 32 bit value unless it is unsigned and very large (more than 2^31, which is around 4 billion, in which case it will result in 1) or signed and negative, in which case I believe it resolves to -1.</p>\n\n<p>You can use >> to show the binary representation of a number, but you'll need to use it several times to extract each bit. The 0 you're seeing is the first bit of the 32 bit value.</p>\n\n<p>I would suggest you start by outputting each bit on a separate line, so that you can see what the code is doing, before outputting them concatenated together into a single 32-digit number.</p>\n"}], "owner": {"reputation": 1, "user_id": 9731110, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Robert", "link": "https://stackoverflow.com/users/9731110/robert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1526046492, "creation_date": 1525274770, "last_edit_date": 1525275130, "question_id": 50138277, "link": "https://stackoverflow.com/questions/50138277/a-few-questions-regarding-a-simple-c-programming-code", "title": "A few questions regarding a simple c programming code", "body": "<p>I've just recently started learning c programming at my school and have already stumbled upon simple obstacles. I call it simple because I can sense the solution being right there but just can't seem to get it to work.</p>\n\n<p>Question 1: I'm trying to have a person input 2 variables, one for X and one for Y. I've learned to use <code>char c; c = getchar();</code> and <code>scanf_s(\"%d\", &amp;n);</code></p>\n\n<p>I am wondering if I could use any of these two to make a person able to input 2 different variables for X and Y. I've also seen online that sometimes people are asked to input: x y( with a space in between) and the code will then recognize the first input as x and the input after the space to be the y.</p>\n\n<p>The second question is that I tried using the command <code>x&gt;&gt;31</code> to show the 32bit binary code of value x, but the output I get is 0. Any clue on how to fix that? for example I have a line of code that is: <code>printf(\"%d &amp; %d = %d %d\\n\", num1, num2, result1, result1&gt;&gt;31);</code> but the last %d shows <code>0</code> instead of the 32bit binary code of <code>result1</code>.<a href=\"https://i.stack.imgur.com/6rfUf.png\" rel=\"nofollow noreferrer\">picture of my code and the output I get</a></p>\n"}, {"tags": ["c", "malloc"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1525274644, "post_id": 50138197, "comment_id": 87294692, "body": "&quot;Pretty&quot; comments like that are are worse than useless. They&#39;re hard to maintain if they need to be changed, and content such as &quot;structures&quot; and &quot;graph things&quot; conveys no information beyond the already-blatantly obvious as to what the code is doing and why."}, {"owner": {"reputation": 11, "user_id": 8645847, "user_type": "registered", "profile_image": "https://graph.facebook.com/1942721269303220/picture?type=large", "display_name": "Samuel Jose", "link": "https://stackoverflow.com/users/8645847/samuel-jose"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1525274898, "post_id": 50138197, "comment_id": 87294845, "body": "I use those comments to help me find procedures and functions easier in long codes. It really helps me a lot."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1525275080, "post_id": 50138197, "comment_id": 87294963, "body": "Run it with the debugger. Visual Studio has a very easy to use debugger."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1525275095, "post_id": 50138197, "comment_id": 87294969, "body": "Learn about <a href=\"https://en.wikipedia.org/wiki/Ctags\" rel=\"nofollow noreferrer\">ctags</a> and <a href=\"http://valgrind.org/\" rel=\"nofollow noreferrer\">valgrind</a>"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1525283466, "post_id": 50138197, "comment_id": 87299655, "body": "Valgrind should have said a lot more than just &quot;core dumped&quot;.  Before that happened it should have printed information on invalid reads / writes or something similar.  Post the output of valgrind so we can see what really happened."}, {"owner": {"reputation": 11, "user_id": 8645847, "user_type": "registered", "profile_image": "https://graph.facebook.com/1942721269303220/picture?type=large", "display_name": "Samuel Jose", "link": "https://stackoverflow.com/users/8645847/samuel-jose"}, "edited": false, "score": 0, "creation_date": 1525283770, "post_id": 50138197, "comment_id": 87299804, "body": "I&#39;ve edited the post. I attached a picture of what valgrind outputs."}], "answers": [{"tags": [], "owner": {"reputation": 120, "user_id": 9582933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abd29d6b3ffbe2eb322206ed2b56fadd?s=128&d=identicon&r=PG", "display_name": "Arroganz", "link": "https://stackoverflow.com/users/9582933/arroganz"}, "is_accepted": false, "score": 1, "last_activity_date": 1525274979, "creation_date": 1525274979, "answer_id": 50138333, "question_id": 50138197, "link": "https://stackoverflow.com/questions/50138197/freeing-causes-crash/50138333#50138333", "title": "Freeing causes crash", "body": "<p>have you tried using Valgrind ? If so, are there any errors ?</p>\n\n<p>Valgrind is a tool to check memory leaks and memory violation. It replaces your system malloc by its own to observe your actions.</p>\n\n<p>Also please avoid using UPPERCASE functions, these should be reserved for macro and macro functions (<code>#define</code>).\nYou should also use <code>typedef</code> to rename your structs.\nFor example, </p>\n\n<pre><code>typedef struct s_myStruct\n{\n  ...\n} t_myStruct;\n\nt_mystruct *st = malloc(sizeof(t_mystruct));\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 8645847, "user_type": "registered", "profile_image": "https://graph.facebook.com/1942721269303220/picture?type=large", "display_name": "Samuel Jose", "link": "https://stackoverflow.com/users/8645847/samuel-jose"}, "edited": false, "score": 0, "creation_date": 1525276789, "post_id": 50138769, "comment_id": 87296054, "body": "Changed it that way..  Still crashes :( but i think it solved one problem"}, {"owner": {"reputation": 11, "user_id": 8645847, "user_type": "registered", "profile_image": "https://graph.facebook.com/1942721269303220/picture?type=large", "display_name": "Samuel Jose", "link": "https://stackoverflow.com/users/8645847/samuel-jose"}, "edited": false, "score": 0, "creation_date": 1525278311, "post_id": 50138769, "comment_id": 87296981, "body": "It still crashes. I tried adding printf after freePQ(PQ) to check if it passes through freePQ(PQ). It appears that it also crashes at freePQ."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 11, "user_id": 8645847, "user_type": "registered", "profile_image": "https://graph.facebook.com/1942721269303220/picture?type=large", "display_name": "Samuel Jose", "link": "https://stackoverflow.com/users/8645847/samuel-jose"}, "edited": false, "score": 0, "creation_date": 1525278631, "post_id": 50138769, "comment_id": 87297153, "body": "What if you don&#39;t call <code>DIJKSTRA</code> and <code>DISPLAY_PATH</code> ? Does it still crash?"}, {"owner": {"reputation": 11, "user_id": 8645847, "user_type": "registered", "profile_image": "https://graph.facebook.com/1942721269303220/picture?type=large", "display_name": "Samuel Jose", "link": "https://stackoverflow.com/users/8645847/samuel-jose"}, "edited": false, "score": 0, "creation_date": 1525283325, "post_id": 50138769, "comment_id": 87299577, "body": "Yea it still crashes. It appears that my code is able to free all mallocs but my code seems to be overdoing it."}], "tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 0, "last_activity_date": 1525277568, "last_edit_date": 1525277568, "creation_date": 1525276453, "answer_id": 50138769, "question_id": 50138197, "link": "https://stackoverflow.com/questions/50138197/freeing-causes-crash/50138769#50138769", "title": "Freeing causes crash", "body": "<p>This code seems wrong:</p>\n\n<pre><code>for (v = 0; v &lt;= graph-&gt;n+1; v++)\n{\n    struct node* temp = graph-&gt;LIST[v];\n</code></pre>\n\n<p>As <code>n</code> is initialized to <code>9</code> in <code>initGraph</code> this code will loop for v = 0, 1, ..., 10</p>\n\n<p>However, in <code>initGraph</code> you malloc'ed 10 elements so now you access <code>LIST</code> out of bounds.</p>\n\n<p>Try</p>\n\n<pre><code>for (v = 0; v &lt; graph-&gt;n+1; v++)\n{\n    struct node* temp = graph-&gt;LIST[v];\n</code></pre>\n\n<p>instead.</p>\n\n<p>Then look at this:</p>\n\n<pre><code>    struct node* temp = graph-&gt;LIST[v];\n    struct node* temp2 = temp-&gt;next;\n</code></pre>\n\n<p>What would happen if <code>graph-&gt;LIST[v]</code> is NULL?</p>\n\n<p>The program will crash when you do:</p>\n\n<pre><code>temp2 = temp-&gt;next\n</code></pre>\n\n<p>So you need to turn the code into something like:</p>\n\n<pre><code>    struct node* temp = graph-&gt;LIST[v];\n    while (temp!=NULL)\n    {\n        struct node* temp2 = temp-&gt;next;\n        free(temp);\n        temp = temp2;\n    }\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8645847, "user_type": "registered", "profile_image": "https://graph.facebook.com/1942721269303220/picture?type=large", "display_name": "Samuel Jose", "link": "https://stackoverflow.com/users/8645847/samuel-jose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1525283735, "creation_date": 1525274549, "last_edit_date": 1525283735, "question_id": 50138197, "link": "https://stackoverflow.com/questions/50138197/freeing-causes-crash", "title": "Freeing causes crash", "body": "<p>I am currently implementing a pseudocode of Dijkstra's Algorithm and I am having trouble in freeing the nodes. My code seems to be working fine except for the freeing part. I have freed all mallocs in the code but it still keeps on crashing. </p>\n\n<p>I  have checked all possible \"mis-free\" that might occur and I'm currently stuck with this.</p>\n\n<p>Here is my code.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;conio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;math.h&gt;\n\n//#####################################################################\n//#####################################################################\n//#####################################################################\n\n//#####################################################################\n//######################### Structures ################################\n//#####################################################################\n\nstruct node\n{\n    int vertex;\n    int cost;\n    struct node* next;\n};\n\nstruct PQ\n{\n    int* heap;\n    int* index;\n    double* key;\n    int sizePQ;\n};\n\n//#####################################################################\n//######################### Graph Things ##############################\n//#####################################################################\n\nstruct node* createNode(int v,int cost)\n{\n    struct node* newNode = malloc(sizeof(struct node));\n    newNode-&gt;vertex = v;\n    newNode-&gt;cost = cost;\n    newNode-&gt;next = NULL;\n    return newNode;\n}\n\nstruct G{\n    int n;\n    int* pred;\n    double* dist;\n    struct node** LIST;\n};\n\nstruct G* initGraph(int vertices)\n{\n    struct G* graph = malloc(sizeof(struct G));\n    graph-&gt;n = vertices-1;\n\n    graph-&gt;LIST = malloc(vertices * sizeof(struct node*));\n    graph-&gt;pred = malloc(vertices * sizeof(int));\n    graph-&gt;dist = malloc(vertices * sizeof(double));\n\n    int i;\n    for (i = 0; i &lt;= vertices; i++)\n        graph-&gt;LIST[i] = NULL;\n\n    return graph;\n}\n\nvoid addEdge(struct G* graph, int src, int dest, int cost)\n{\n    struct node* newNode = createNode(dest, cost);\n    newNode-&gt;next = graph-&gt;LIST[src];\n    graph-&gt;LIST[src] = newNode;\n}\n\nvoid freeG(struct G* graph){\n    int v;\n    for (v = 0; v &lt;= graph-&gt;n+1; v++)\n    {\n        struct node* temp = graph-&gt;LIST[v];\n        struct node* temp2 = temp-&gt;next;\n        while (temp!=NULL)\n        {\n            free(temp);\n            temp = temp2;\n            temp2 = temp-&gt;next;\n        }\n    }\n    free(graph-&gt;pred);\n    free(graph-&gt;dist);\n    free(graph-&gt;LIST);\n    free(graph);\n}\n\nvoid freePQ(struct PQ* PQ){\n    free(PQ-&gt;heap);\n    free(PQ-&gt;key);\n    free(PQ-&gt;index);\n    free(PQ);\n}\n//#####################################################################\n//############################ Procedures #############################\n//#####################################################################\n\nvoid PQ_UNDERFLOW(){\n    printf(\"Underflow Detected\");\n}\n\nvoid InitPQ(struct G* G,struct PQ* PQ, int s){\n    PQ-&gt;heap = malloc(G-&gt;n * sizeof(int));\n    PQ-&gt;index = malloc(G-&gt;n * sizeof(int));\n    PQ-&gt;key = malloc(G-&gt;n * sizeof(double));\n    PQ-&gt;sizePQ = G-&gt;n;\n   // printf(\"%i\",G-&gt;n);\n\n    int i = 1;\n    int v;\n    for(v=1;v&lt;=G-&gt;n;v++){\n        if(v==s){\n            PQ-&gt;heap[1]=s;\n            PQ-&gt;index[s]=1;\n            PQ-&gt;key[s]=0;\n        }\n        else{\n            ++i;\n            PQ-&gt;heap[i]=v;\n            PQ-&gt;index[v]=i;\n            PQ-&gt;key[v]=INFINITY;\n           // printf(\"%i//\",PQ-&gt;heap[i]);\n            //printf(\"%lf \",PQ-&gt;key[v]);\n        }\n    }\n}\n\nvoid HEAPIFY(struct PQ* PQ,int r){\n    //printf(\"%i\",PQ-&gt;heap[r]-1);\n    double k = PQ-&gt;key[PQ-&gt;heap[r]];\n    int l = PQ-&gt;heap[r];\n    int i = r, j = 2*i;\n    while(j&lt;=PQ-&gt;sizePQ){\n        if (j&lt;PQ-&gt;sizePQ &amp;&amp; PQ-&gt;key[PQ-&gt;heap[j+1]]&lt; PQ-&gt;key[PQ-&gt;heap[j]]){\n            ++j;\n        }\n        if(PQ-&gt;key[PQ-&gt;heap[j]]&lt;k){\n            PQ-&gt;heap[i]=PQ-&gt;heap[j];\n            PQ-&gt;index[PQ-&gt;heap[j]]=i;\n            i=j;\n            j=2*i;\n        }else break;\n    }\n    PQ-&gt;heap[i]=l;\n    PQ-&gt;index[l]=i;\n}\n\nint IsEmptyPQ(struct PQ* PQ){\n    return(PQ-&gt;sizePQ==0);\n}\n\nvoid EXTRACT_MIN(struct PQ* PQ, int *j){\n\n    if (PQ-&gt;sizePQ == 0) PQ_UNDERFLOW();\n    else{\n        *j=PQ-&gt;heap[1];\n        PQ-&gt;heap[1] = PQ-&gt;heap[PQ-&gt;sizePQ];\n        PQ-&gt;index[PQ-&gt;heap[1]]=1;\n        PQ-&gt;sizePQ=PQ-&gt;sizePQ-1;\n        HEAPIFY(PQ,1);\n    }\n}\n\nvoid DECREASE_KEY(struct PQ* PQ, int l, double newkey){\n    PQ-&gt;key[l] = newkey;\n    int i = PQ-&gt;index[l];//printf(\"pqindexl-&gt;%i\\n\",PQ-&gt;index[l]);\n    int j =floor(i/2);\n    while (i &gt; 1 &amp;&amp; PQ-&gt;key[PQ-&gt;heap[j]]&gt;newkey){\n        PQ-&gt;heap[i]= PQ-&gt;heap[j];\n        PQ-&gt;index[PQ-&gt;heap[j]]=i;\n        i=j; j =floor(i/2);\n    }\n    PQ-&gt;heap[i]=l;\n    PQ-&gt;index[l]=i;\n}\n//#####################################################################\n//############################ DIJKSTRA   #############################\n//#####################################################################\n\nvoid DIJKSTRA(struct G* G, struct PQ* PQ, int s){\n    InitPQ(G,PQ,s);\n    int u = 0,v;\n    double newval;\n    G-&gt;pred[s]=0;\n    while(!IsEmptyPQ(PQ)){\n        EXTRACT_MIN(PQ,&amp;u);\n        if (PQ-&gt;key[u]== INFINITY){break;}\n        struct node* a = G-&gt;LIST[u];\n        while (a!=NULL)\n        {\n            v = a-&gt;vertex;//printf(\"vertex = %i\\n\",a-&gt;vertex);\n            newval = PQ-&gt;key[u]+a-&gt;cost;\n            if (PQ-&gt;key[v]&gt;newval){\n                G-&gt;pred[v]=u;\n                DECREASE_KEY(PQ,v,newval);\n            }\n            a = a-&gt;next;\n        }\n    }\n    G-&gt;dist=PQ-&gt;key;\n}\n\n\n//#####################################################################\n//############################  print g   #############################\n//#####################################################################\n\nvoid DISPLAY_PATH(struct G* G, int s,int v){\n    int path[G-&gt;n];\n    int len = 1;\n    path[len]=v;\n    int i=v;\n    while(i!=s){\n        if(G-&gt;pred[i]==0){printf(\"No path found\");return;}\n        else{\n            i = G-&gt;pred[i];\n            ++len;\n            path[len]=i;\n        }\n    }\n    printf(\"Shortest path found: \");\n    while(len&gt;=1){\n        printf(\"%i\",path[len]);\n        if(len!=1)printf(\" -&gt; \");\n        len--;\n    }\n}\n\nvoid printGraph(struct G* graph)\n{\n    int v;\n    for (v = 1; v &lt;= graph-&gt;n; v++)\n    {\n        struct node* temp = graph-&gt;LIST[v];\n        printf(\"\\n Adjacency list of vertex %d\\n \", v);\n        while (temp)\n        {\n            printf(\"%d -&gt; \", temp-&gt;vertex);\n            temp = temp-&gt;next;\n        }\n        printf(\"\\n\");\n    }\n}\n//#####################################################################\n//#####################################################################\n//#####################################################################\nint main()\n{\n    struct G* graph = initGraph(10);\n    addEdge(graph, 1, 2, 4);\n    addEdge(graph, 1, 8, 8);\n    addEdge(graph, 2, 3, 8);\n    addEdge(graph, 2, 8, 11);\n    addEdge(graph, 3, 4, 7);\n    addEdge(graph, 3, 9, 2);\n    addEdge(graph, 3, 6, 4);\n    addEdge(graph, 4, 5, 9);\n    addEdge(graph, 4, 6, 14);\n    addEdge(graph, 5, 6, 10);\n    addEdge(graph, 6, 7, 2);\n    addEdge(graph, 7, 8, 1);\n    addEdge(graph, 7, 9, 6);\n    addEdge(graph, 8, 9, 7);\n    printGraph(graph);\n    printf(\"\\n\");\n\n    struct PQ* PQ=malloc(sizeof(struct PQ));\n    DIJKSTRA(graph, PQ, 1);\n    DISPLAY_PATH(graph,1,8);\n\n    freePQ(PQ);\n    freeG(graph);\n}\n</code></pre>\n\n<p>Everything works fine except for the freeing part. It prints the desired output for the algorithm but crashes at the end of the program. </p>\n\n<p>I also really want to understand how malloc and freeing works and this might give me more information about it.</p>\n\n<p><a href=\"https://i.stack.imgur.com/fqdo8.png\" rel=\"nofollow noreferrer\">Here's what happens everytime I run it</a></p>\n\n<p>EDIT: I have ran valgrind on my code and it appears to get an error called \"core dumped\". As far as i know, core dumped error occurs when I freed a node twice or more. I don't see any errors in my freeing codes though.</p>\n\n<p><a href=\"https://i.stack.imgur.com/wP0uR.png\" rel=\"nofollow noreferrer\">Here is what valgrind outputs</a></p>\n"}, {"tags": ["c", "pipe", "sigkill"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 4, "creation_date": 1525273917, "post_id": 50137875, "comment_id": 87294232, "body": "For one, you can&#39;t safely call functions that aren&#39;t async-signal-safe in a signal handler.  Assuming Linux, <a href=\"http://man7.org/linux/man-pages/man7/signal-safety.7.html\" rel=\"nofollow noreferrer\"><code>puts()</code> and <code>exit()</code> are not async-signal-safe</a>."}, {"owner": {"reputation": 37256, "user_id": 736308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/o5EqQ.jpg?s=128&g=1", "display_name": "cdarke", "link": "https://stackoverflow.com/users/736308/cdarke"}, "edited": false, "score": 1, "creation_date": 1525274401, "post_id": 50137875, "comment_id": 87294541, "body": "<code>void sigintHandler(int sig_num,char * myfifo)</code> is not valid, only an <code>int</code> (the signal number) is passed."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 1, "creation_date": 1525274911, "post_id": 50137875, "comment_id": 87294855, "body": "Read <a href=\"http://man7.org/linux/man-pages/man7/signal.7.html\" rel=\"nofollow noreferrer\">signal(7)</a> &amp; <a href=\"http://man7.org/linux/man-pages/man7/signal-safety.7.html\" rel=\"nofollow noreferrer\">signal-safety(7)</a>. FIFOs and signals are operating system specific. You probably need some <code>linux</code> or <code>POSIX</code> tag"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1525275342, "post_id": 50137875, "comment_id": 87295132, "body": "And enable your compiler warnings - and pay attention to them.  <code>sigaction(SIGINT, sigintHandler);</code> is even more wrong that I noticed at first - <code>sigaction()</code> is passed a signal number and two <code>struct sigaction *</code> values, not a signal number and a <code>void (*handler)(int)</code> signal handler function directly."}, {"owner": {"reputation": 11, "user_id": 9360392, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Qfiix3cRCGA/AAAAAAAAAAI/AAAAAAAAABM/llqJyfK9R5g/photo.jpg?sz=128", "display_name": "Oussema Ben Abdallah", "link": "https://stackoverflow.com/users/9360392/oussema-ben-abdallah"}, "reply_to_user": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1525276106, "post_id": 50137875, "comment_id": 87295603, "body": "So I get from your comment is that I should not use &quot;sigintHandler&quot; in order for me to delete my FIFO file ? @Basile Starynkevitch"}], "answers": [{"tags": [], "owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "is_accepted": true, "score": 0, "last_activity_date": 1525277444, "last_edit_date": 1525277444, "creation_date": 1525274221, "answer_id": 50138084, "question_id": 50137875, "link": "https://stackoverflow.com/questions/50137875/c-language-siginthandler/50138084#50138084", "title": "C language &amp; sigintHandler", "body": "<p>Firstly your way of setting a signal handler using <code>sigaction()</code> is not correct as you didn't fill all the member of <code>struct sigaction</code>. Fill all required member</p>\n\n<pre><code>struct sigaction info;\ninfo.sa_handler = sigintHandler;\nsigaction(SIGINT,&amp;info,NULL);\n</code></pre>\n\n<p>Secondly, to read data from <code>fifo</code> file <em>while loop</em> is not required as you are reading <code>MAX_BUF</code> at a time. Loop is not required, read like this</p>\n\n<pre><code>int ret = read(fd, buf, MAX_BUF);\nbuf[ret-1] = '\\0'; /*it should be null terminated */ \n</code></pre>\n\n<p>Thirdly, <code>sigintHandler()</code> excepts only one argument. From the manual page of <code>sigaction()</code></p>\n\n<pre><code>struct sigaction {\n        void     (*sa_handler)(int);  /*handler expects only 1 argument */\n        /* other member */\n}\n</code></pre>\n\n<p>Finally &amp; most importantly it is not safe to call functions like <code>printf()</code> &amp; <code>exit()</code> from within a signal handler.</p>\n\n<p>your <code>sigHandler()</code> looks like </p>\n\n<pre><code>static void sigintHandler(int sig_num) {\n        write(1,\"in isr\\n\",strlen(\"in isr\\n\"));\n        /*  set some flag variable here &amp; use that \n        flag variable in main() function to remove the fifo */\n}\n</code></pre>\n\n<p>see this <a href=\"https://stackoverflow.com/questions/16891019/how-to-avoid-using-printf-in-a-signal-handler\">How to avoid using printf in a signal handler?</a></p>\n\n<p>Here is the example code</p>\n\n<pre><code>static int fifo_flag = 0;\nstatic void sigintHandler(int sig_num) {\n        write(1,\"in isr\\n\",strlen(\"in isr\\n\"));\n        fifo_flag = 1;\n}\nint main(void){\n        printf(\"Access-Control-Allow-Origin: *\\n\");\n        printf(\"Content-Type: text/event-stream\\n\\n\");\n        int fd = 0, index = 0;\n        char buf[MAX_BUF];\n        #if 0\n        char *myfifo = \"data\";\n        #endif\n        //char * myfifo = \"/tmp/omcipipe\";\n        struct stat st;\n        struct sigaction info;\n        info.sa_handler = sigintHandler;\n        //info.sa_flags = /* set to defaulgs a/c to your requirement*/\n\n        if (stat(myfifo, &amp;st) != 0) {\n                mkfifo(myfifo, 0666);\n                perror(\"mkfifo\");\n        }\n        fd = open(myfifo, O_RDONLY | 0666);\n        if(fd == -1){\n                perror(\"open\");\n                return 0;\n        }\n        char ch = 0;\n        while(read(fd, &amp;ch, 1) &gt; 0) {\n                sigaction(SIGINT,&amp;info,NULL);/* if ctrl+c  is called */\n                buf[index] = ch;\n                //sleep(1);/* just to observe ctrl+c behaviour, not advised to use */\n                printf(\"%c\\n\",buf[index]);\n                index++;\n        }\n        buf[index] = '\\0';\n        printf(\"data: %s\", buf);\n        printf(\"\\n\");\n        puts( \"----closing----\");\n        close(fd);\n        if(fifo_flag == 1) { /*if flag is set, unlink fifo */\n                unlink(myfifo); /* you can unlink fifo file here */\n        }\n        return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 37256, "user_id": 736308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/o5EqQ.jpg?s=128&g=1", "display_name": "cdarke", "link": "https://stackoverflow.com/users/736308/cdarke"}, "edited": false, "score": 1, "creation_date": 1525274475, "post_id": 50138093, "comment_id": 87294583, "body": "How does <code>char * myfifo</code> get passed into the signal handler?"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 37256, "user_id": 736308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/o5EqQ.jpg?s=128&g=1", "display_name": "cdarke", "link": "https://stackoverflow.com/users/736308/cdarke"}, "edited": false, "score": 1, "creation_date": 1525274792, "post_id": 50138093, "comment_id": 87294776, "body": "@cdarke Good catch.  I didn&#39;t notice that problem in the code."}], "tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": false, "score": 0, "last_activity_date": 1525275064, "last_edit_date": 1525275064, "creation_date": 1525274250, "answer_id": 50138093, "question_id": 50137875, "link": "https://stackoverflow.com/questions/50137875/c-language-siginthandler/50138093#50138093", "title": "C language &amp; sigintHandler", "body": "<p>There are numerous problems with your code.</p>\n\n<p>This code assumes <code>read()</code> terminates data with a <code>'\\0'</code> character:</p>\n\n<pre><code>while (read(fd, buf, MAX_BUF)&gt;0)\n{\n    printf(\"data: %s\", buf);\n    printf(\"\\n\");\n    fflush(stdout);\n}\n</code></pre>\n\n<p><code>read()</code> merely reads raw bytes and nothing more.  It will not properly terminate strings with a <code>'\\0'</code> character.  So the <code>printf()</code> will almost certainly invoke undefined behavior.</p>\n\n<p>This code</p>\n\n<pre><code>sigaction(SIGINT, sigintHandler);\n</code></pre>\n\n<p>is just wrong.  <a href=\"http://man7.org/linux/man-pages/man2/sigaction.2.html\" rel=\"nofollow noreferrer\"><code>sigaction()</code> takes three parameters</a>:</p>\n\n<pre><code>   #include &lt;signal.h&gt;\n\n   int sigaction(int signum, const struct sigaction *act,\n                 struct sigaction *oldact);\n</code></pre>\n\n<p>You also can only make <a href=\"http://man7.org/linux/man-pages/man7/signal-safety.7.html\" rel=\"nofollow noreferrer\">async-signal-safe function calls from within a signal handler</a>.  This code</p>\n\n<pre><code> void sigintHandler(int sig_num,char * myfifo)\n{\nputs(\"hello you there .please don't leave \");\nunlink(myfifo);\nexit(0);\n}\n</code></pre>\n\n<p>calls <code>puts()</code> and <code>exit()</code>, neither of which are async-signal-safe.</p>\n\n<p>And as noted in the comments, the signal handler code assumes that <code>myfifo</code> is passed as the second parameter.  It isn't.  Per <a href=\"http://man7.org/linux/man-pages/man2/sigaction.2.html\" rel=\"nofollow noreferrer\">the sigaction man page</a> the second parameter is a <code>struct siginfo *</code> that contains information regarding the signal context - but only if the <code>struct sigaction</code> passed to the <code>sigaction()</code> call that registered the signal handler had the <code>SA_SIGINFO</code> flag set, and the handler set using the <code>sa_sigaction</code> member instead of the <code>sa_handler</code> member.</p>\n"}], "owner": {"reputation": 11, "user_id": 9360392, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Qfiix3cRCGA/AAAAAAAAAAI/AAAAAAAAABM/llqJyfK9R5g/photo.jpg?sz=128", "display_name": "Oussema Ben Abdallah", "link": "https://stackoverflow.com/users/9360392/oussema-ben-abdallah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 389, "favorite_count": 0, "accepted_answer_id": 50138084, "answer_count": 2, "score": 0, "last_activity_date": 1525277444, "creation_date": 1525273609, "question_id": 50137875, "link": "https://stackoverflow.com/questions/50137875/c-language-siginthandler", "title": "C language &amp; sigintHandler", "body": "<p>I want to delete the FIFO file when I suddenly click \"ctrl+c\"  . I want to catch that signal and then delete the after before actually killing the process .\nhere is my code and I don't know what went wrong :</p>\n\n<pre><code> #include &lt;fcntl.h&gt;\n #include &lt;stdio.h&gt;\n #include  &lt;stdlib.h&gt;\n #include &lt;sys/stat.h&gt;\n #include &lt;unistd.h&gt;\n #include &lt;signal.h&gt;\n #define MAX_BUF 512\n\n void sigintHandler(int sig_num,char * myfifo)\n{\nputs(\"hello you there .please don't leave \");\nunlink(myfifo);\nexit(0);\n}\n\nint main()\n{\n\nprintf(\"Access-Control-Allow-Origin: *\\n\");\nprintf(\"Content-Type: text/event-stream\\n\\n\");\nint fd;\nchar buf[MAX_BUF];\n\nchar * myfifo = \"/tmp/omcipipe\";\nstruct stat st;\n</code></pre>\n\n<p>//catch ctrl c </p>\n\n<pre><code> sigaction(SIGINT, sigintHandler);\n\n\n\n  //Create FIFO file \n     if (stat(myfifo, &amp;st) != 0)\n     mkfifo(myfifo, 0666);\n\n fd = open(myfifo, O_RDONLY);\nwhile (read(fd, buf, MAX_BUF)&gt;0)\n{\n    printf(\"data: %s\", buf);\n    printf(\"\\n\");\n    fflush(stdout);\n} \n\nputs( \"----closing----\"); \nclose(fd);\nunlink(myfifo);\nreturn 0;\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["c", "compiler-construction", "bison"], "comments": [{"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1525276133, "post_id": 50137766, "comment_id": 87295622, "body": "Have you tried running the code in a debugger? That would confirm exactly where the code is crashing and it is possible to see what the value of <code>$2</code> (or the variable that is actually used in the real code) is"}, {"owner": {"reputation": 1, "user_id": 8446612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/beu3L.jpg?s=128&g=1", "display_name": "T.Guo", "link": "https://stackoverflow.com/users/8446612/t-guo"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1525397958, "post_id": 50137766, "comment_id": 87349806, "body": "No, I didn&#39;t run this in a debugger. I will try to run the code in a debugger to find what happened. Thank you!!!"}], "answers": [{"tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": false, "score": 1, "last_activity_date": 1525278640, "last_edit_date": 1525278640, "creation_date": 1525277469, "answer_id": 50139075, "question_id": 50137766, "link": "https://stackoverflow.com/questions/50137766/bison-when-i-try-to-add-action-in-function-grammar-rule-the-segmentation-fault/50139075#50139075", "title": "Bison: When I try to add action in function grammar rule, the segmentation fault 11 occur", "body": "<p>Clearly, the problem occurs during the <code>dump</code> function when the token type is <code>FUNCTION_TYPE</code>. That's clear from the debugging output (<code>dump</code> is presumably executing when the segfault occurs) and from the change report (the problem occurs when an action sets the <code>st_type</code> field to <code>FUNCTION_TYPE</code>).</p>\n\n<p>Visual inspection of the <code>if</code> clause in <code>dump()</code> corresponding to that condition reveals the following obvious error:</p>\n\n<pre><code>fprintf(of,\"%-7s %s\",\"function returns \");\n</code></pre>\n\n<p>That call to <code>fprintf</code> has a format string with two <code>%s</code> conversions. However, there is only one argument to be inserted.</p>\n\n<p>The real question you should be asking yourself is \"How can I easily find stupid typos like this without spending a lot of time or resorting to outside experts?\"</p>\n\n<p>As a first approximation, that error is so common and easy to detect that most compilers will warn you about it. So your first step is to make sure you <em>always</em> compile with warnings enabled (<code>-Wall</code> if you are using gcc or clang), and that you read the warnings.</p>\n\n<p>Even without the warning, it would have been straight-forward to find the error with a debugger such as <code>gdb</code>. Just set a breakpoint at <code>dump</code> and single-step until the segfault occurs.</p>\n\n<p>Finally, you are making your life much more complicated when you first build a large complex program with a lot of components and only then start to debug it. In the long run, you will find that it is worth taking the time to test each component individually (your symbol table, for example), using some kind of test harness, and only assembling your more complex program when you are reasonably confident that the individual pieces work. That will avoid the difficulty of identifying where the error occurred (as in this case, where you were evidently distracted by your doubts about the parser generator, leading you to miss the actual problem which has nothing to do with the parser).</p>\n\n<hr>\n\n<p>By the way, <code>strncpy</code> is a definite red flag, although in this case you seem to have been lucky (or unlucky) enough to not encounter the bug. <code>strncpy</code> is pretty well never what you want, and if it is what you want then the length parameter should be the longest string you can accommodate rather than the length of the input string. (<code>strncpy</code> is intended for use in fixed-length formats, which is why it pads the output to the specified length.)</p>\n\n<p>If you use the length of the input string, then you have two problems: (1) the copy is <em>guaranteed</em> to not be NUL-terminated, leading to Undefined Behaviour; and (2) nothing stops the copy from overrunning the output buffer, in the case that the input string is too long.</p>\n\n<p>Even used correctly, <code>strncpy</code> requires you to manually NUL-terminate the output, which is a nuisance. A better solution is to first check that the string is not too long (<code>length &lt; SIZE</code>) and then use <code>strcpy</code>, which will correctly NUL-terminate. Even better is to make the name field a char* instead of an array, and dynamically allocate a string of the correct length (see <code>strdup</code>, for example), thereby avoiding having to arbitrarily limit the size of identifiers.</p>\n"}], "owner": {"reputation": 1, "user_id": 8446612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/beu3L.jpg?s=128&g=1", "display_name": "T.Guo", "link": "https://stackoverflow.com/users/8446612/t-guo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1525278640, "creation_date": 1525273293, "question_id": 50137766, "link": "https://stackoverflow.com/questions/50137766/bison-when-i-try-to-add-action-in-function-grammar-rule-the-segmentation-fault", "title": "Bison: When I try to add action in function grammar rule, the segmentation fault 11 occur", "body": "<p>I have a problem about segmentation fault 11.</p>\n\n<p>Every time, when I want to add action rules in function grammar blocks, I must get the segmentation fault 11.</p>\n\n<p>Therefore, I cannot get the dump.out, which is a file that record the identifiers for me.</p>\n\n<p>I do not think the problem is because of the scanner file, but that is still possible.</p>\n\n<p>Of course, the problem should have something about symbol table, but it is really strange.</p>\n\n<p>The problem just occurs like:</p>\n\n<p><strong>function: FN ID '(' ')' {if ($2->st_type == UNDEF) $2->st_type = FUNCTION_TYPE};</strong></p>\n\n<p>When I add action in the block, segmentation fault 11 will occur.</p>\n\n<p>However, this is okay.\n<strong>function: FN ID '(' ')' {};</strong></p>\n\n<p><strong>The parser file do not contains all contents since it is so many.</strong></p>\n\n<p><strong>I use mac os</strong></p>\n\n<p>I hope someone can help me.</p>\n\n<p>Thank you anyway</p>\n\n<hr>\n\n<p>Where the error occur </p>\n\n<pre><code>1: // Hello World Example\n&lt;fn&gt;\n&lt;id: main&gt;\n&lt;(&gt;\n&lt;)&gt;\n&lt;{&gt;\n2: fn main() {\n3:   // Print text to the console\n&lt;let&gt;\n&lt;mut&gt;\n&lt;id: a&gt;\n&lt;:&gt;\n&lt;int&gt;\n&lt;=&gt;\n&lt;integer: 10&gt;\n&lt;;&gt;\n4:   let mut a:int = 10;\n&lt;let&gt;\n&lt;mut&gt;\n&lt;id: b&gt;\n&lt;=&gt;\n&lt;string: 1199&gt;\n&lt;;&gt;\n5:   let mut b = \"1199\";\n&lt;let&gt;\n&lt;mut&gt;\n&lt;id: sum&gt;\n&lt;[&gt;\n&lt;str&gt;\n&lt;,&gt;\n&lt;integer: 10&gt;\n&lt;]&gt;\n&lt;;&gt;\n6:   let mut sum[str, 10];\n&lt;id: sum&gt;\n&lt;[&gt;\n&lt;integer: 0&gt;\n&lt;]&gt;\n&lt;=&gt;\n&lt;string: 100&gt;\n&lt;;&gt;\n7:   sum[0] = \"100\";\n&lt;id: b&gt;\n&lt;=&gt;\n&lt;string: 123&gt;\n&lt;+&gt;\n&lt;id: b&gt;\n&lt;;&gt;\n8:   b = \"123\" + b;\n&lt;println&gt;\n&lt;(&gt;\n&lt;string: Hello World&gt;\n&lt;)&gt;\n&lt;;&gt;\n9:   println (\"Hello World\");\n&lt;}&gt;\n10: }\n\nSymbol table:\na\nb\nsum\nmain\nSegmentation fault: 11\n</code></pre>\n\n<hr>\n\n<p>The input file</p>\n\n<pre><code>// Hello World Example\nfn main() {\n  // Print text to the console\n  let mut a:int = 10;\n  let mut b = \"1199\";\n  let mut sum[str, 10];\n  sum[0] = \"100\";\n  b = \"123\" + b;\n  println (\"Hello World\");\n}\n</code></pre>\n\n<hr>\n\n<p>This is my symbol table header file.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n/* maximum size of hash table */\n#define SIZE 211\n\n/* maximum size of tokens-identifiers */\n#define MAXTOKENLEN 40\n\n/* token types */\n#define UNDEF 0\n#define INT_TYPE 1\n#define REAL_TYPE 2\n#define STR_TYPE 3\n#define LOGIC_TYPE 4\n#define ARRAY_TYPE 5\n#define FUNCTION_TYPE 6\n/* new type for parser */\n#define CONST_INT_TYPE 7\n#define CONST_REAL_TYPE 8\n#define CONST_STR_TYPE 9\n#define CONST_LOGIC_TYPE 10\n\n/* how parameter is passed */\n#define BY_VALUE 1\n#define BY_REFER 2\n\n/*\n* Originally here, now it is in the symbols.c\n* current scope\n* int cur_scope = 0;\n*/\n\n/* parameter struct */\ntypedef struct Parameter{\n    int par_type;\n    char *param_name;\n    // to store value\n    int ival; double fval; char *st_sval; int bval; // boolean type\n    int passing; // value or reference\n    struct Parameter *next; // link to next one\n}Param;\n\n/* a linked list of references (lineno's) for each variable */\ntypedef struct Ref{ \n    int lineno;\n    struct Ref *next;\n    int type;\n}RefList;\n\n// struct that represents a list node\ntypedef struct list{\n    char st_name[MAXTOKENLEN];\n    int st_size;\n    int scope;\n    RefList *lines;\n    // to store value and sometimes more information\n    int st_ival; double st_fval; char *st_sval; int st_bval;\n    // type\n    int st_type;\n    int inf_type; // for arrays (info type) and functions (return type)\n    // array stuff\n    int *i_vals; double *f_vals; char **s_vals; int *b_vals; // boolean type\n    int array_size;\n    // function parameters\n    Param *parameters;\n    int num_of_pars; // Meanwhile, it record the current position of the parameters\n    // pointer to next item in the list\n    struct list *next;\n}list_t;\n\n/* the hash table */\nstatic list_t **hash_table;\n\n// Function Declarations\nvoid create(); // initialize hash table\nunsigned int hash(char *key); // hash function for insert\nvoid insert(char *name, int len, int type, int lineno); // insert entry\nlist_t *lookup(char *name); // search for entry\nlist_t *lookup_scope(char *name, int scope); // search for entry in scope\nvoid hide_scope(); // hide the current scope\nvoid incr_scope(); // go to next scope\nvoid dump(FILE *of); // dump file\n</code></pre>\n\n<hr>\n\n<p>This is symbol table code file.</p>\n\n<pre><code>#include \"symbols.h\"\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n/* current scope */\nint cur_scope = 0;\n\nvoid create()\n{\n    int i; \n    hash_table = malloc(SIZE * sizeof(list_t*));\n    for(i = 0; i &lt; SIZE; i++) hash_table[i] = NULL;\n}\n\nunsigned int hash(char *key)\n{\n    unsigned int hashval = 0;\n    for(;*key!='\\0';key++) hashval += *key;\n    hashval += key[0] % 11 + (key[0] &lt;&lt; 3) - key[0];\n    return hashval % SIZE;\n}\n\nvoid insert(char *name, int len, int type, int lineno)\n{\n    unsigned int hashval = hash(name); // hash function used\n    list_t *l = hash_table[hashval];\n\n    while ((l != NULL) &amp;&amp; (strcmp(name,l-&gt;st_name) != 0)) l = l-&gt;next;\n\n    /* variable not yet in table */\n    if (l == NULL){\n        l = (list_t*) malloc(sizeof(list_t));\n        strncpy(l-&gt;st_name, name, len);  \n        /* add to hashtable */\n        l-&gt;st_type = type;\n        l-&gt;scope = cur_scope;\n        l-&gt;lines = (RefList*) malloc(sizeof(RefList));\n        l-&gt;lines-&gt;lineno = lineno;\n        l-&gt;lines-&gt;next = NULL;\n        l-&gt;next = hash_table[hashval];\n        hash_table[hashval] = l; \n        // printf(\"Inserted %s for the first time with linenumber %d!\\n\", name, lineno); // error checking\n    }\n    /* found in table, so just add line number */\n    else{\n        l-&gt;scope = cur_scope;\n        RefList *t = l-&gt;lines;\n        while (t-&gt;next != NULL) t = t-&gt;next;\n        /* add linenumber to reference list */\n        t-&gt;next = (RefList*) malloc(sizeof(RefList));\n        t-&gt;next-&gt;lineno = lineno;\n        t-&gt;next-&gt;next = NULL;\n        // printf(\"Found %s again at line %d!\\n\", name, lineno);\n    }\n}\n\nlist_t *lookup(char *name)\n{ /* return symbol if found or NULL if not found */\n    unsigned int hashval = hash(name);\n    list_t *l = hash_table[hashval];\n    while ((l != NULL) &amp;&amp; (strcmp(name,l-&gt;st_name) != 0)) l = l-&gt;next;\n    return l; // NULL is not found\n}\n\nlist_t *lookup_scope(char *name, int scope)\n{ /* return symbol if found or NULL if not found */\n    unsigned int hashval = hash(name);\n    list_t *l = hash_table[hashval];\n    while ((l != NULL) &amp;&amp; (strcmp(name,l-&gt;st_name) != 0) &amp;&amp; (scope != l-&gt;scope)) l = l-&gt;next;\n    return l; // NULL is not found\n}\n\nvoid hide_scope()\n{ /* hide the current scope */\n    if(cur_scope &gt; 0) cur_scope--;\n}\nvoid incr_scope()\n{ /* go to next scope */\n    cur_scope++;\n}\n\n/* print to stdout by default */ \nvoid dump(FILE * of)\n{  \n  int i; int count; // record whether first line prints or not.\n\n  fprintf(of,\"------------ ----------------- -------------\\n\");\n  fprintf(of,\"Name         Type              Line Numbers\\n\");\n  fprintf(of,\"------------ ----------------- -------------\\n\");\n\n  for (i=0; i &lt; SIZE; ++i){ \n    if (hash_table[i] != NULL){ \n        list_t *l = hash_table[i];\n        while (l != NULL){ \n            RefList *t = l-&gt;lines;\n            fprintf(of,\"%-12s \",l-&gt;st_name);\n\n            printf(\"%s\\n\", l-&gt;st_name); // print out all the names in the symbol table\n\n            if (l-&gt;st_type == INT_TYPE) fprintf(of,\"%-7s\",\"int\");\n            else if (l-&gt;st_type == REAL_TYPE) fprintf(of,\"%-7s\",\"real\");\n            else if (l-&gt;st_type == STR_TYPE) fprintf(of,\"%-7s\",\"string\");\n            else if (l-&gt;st_type == LOGIC_TYPE)  fprintf(of,\"%-7s\",\"bool\");\n            else if (l-&gt;st_type == CONST_INT_TYPE) fprintf(of, \"%-7s\", \"const_int\"); // constant_int_type\n            else if (l-&gt;st_type == CONST_REAL_TYPE) fprintf(of, \"%-7s\", \"const_real\"); // constant_real_type\n            else if (l-&gt;st_type == CONST_STR_TYPE) fprintf(of, \"%-7s\", \"const_string\"); // constant_string_type\n            else if (l-&gt;st_type == CONST_LOGIC_TYPE) fprintf(of, \"%-7s\", \"const_bool\"); // const_logic_type\n            else if (l-&gt;st_type == ARRAY_TYPE){\n                fprintf(of,\"array of \");\n                if (l-&gt;inf_type == INT_TYPE)           fprintf(of,\"%-7s\",\"int\");\n                else if (l-&gt;inf_type  == REAL_TYPE)    fprintf(of,\"%-7s\",\"real\");\n                else if (l-&gt;inf_type  == STR_TYPE)     fprintf(of,\"%-7s\",\"string\");\n                else if (l-&gt;inf_type == LOGIC_TYPE)    fprintf(of,\"%-7s\",\"bool\");\n                else fprintf(of,\"%-7s\",\"undef\");\n            }\n            else if (l-&gt;st_type == FUNCTION_TYPE){\n                fprintf(of,\"%-7s %s\",\"function returns \");\n                if (l-&gt;inf_type == INT_TYPE)           fprintf(of,\"%-7s\",\"int\");\n                else if (l-&gt;inf_type  == REAL_TYPE)    fprintf(of,\"%-7s\",\"real\");\n                else if (l-&gt;inf_type  == STR_TYPE)     fprintf(of,\"%-7s\",\"string\");\n                else if (l-&gt;inf_type == LOGIC_TYPE)    fprintf(of,\"-7%s\",\"bool\");\n                else fprintf(of,\"%-7s\",\"undef\");\n            }\n            else fprintf(of,\"%-7s\",\"undef\"); // if UNDEF or 0\n\n            count = 0;\n            while (t != NULL){\n                if (count == 0)\n                {\n                if (l-&gt;st_type == INT_TYPE || l-&gt;st_type == REAL_TYPE || l-&gt;st_type == STR_TYPE || l-&gt;st_type == UNDEF)\n                    fprintf(of,\"%13d \", t-&gt;lineno);\n                else if (l-&gt;st_type == CONST_INT_TYPE || l-&gt;st_type == CONST_REAL_TYPE || l-&gt;st_type == CONST_STR_TYPE || l-&gt;st_type == CONST_LOGIC_TYPE)\n                    fprintf(of,\"%10d\", t-&gt;lineno);\n                else if (l-&gt;st_type == ARRAY_TYPE || l-&gt;st_type == FUNCTION_TYPE)\n                    fprintf(of,\"%4d\", t-&gt;lineno);\n                }\n                else\n                    fprintf(of,\"%3d\", t-&gt;lineno);\n                count++;\n                t = t-&gt;next;\n            }\n            fprintf(of,\"\\n\");\n            l = l-&gt;next;\n        }\n    }\n  }\n}\n</code></pre>\n\n<hr>\n\n<p>scanner file</p>\n\n<pre><code>%option noyywrap\n\n%{\n#include \"symbols.h\"\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include \"parser.tab.h\"\n\n#define LIST     strcat(buf,yytext)\n#define token(t) {LIST; printf(\"&lt;%s&gt;\\n\");}\n#define tokenInteger(t, i) {LIST; printf(\"&lt;%s: %d&gt;\\n\", t, i);}\n#define tokenReal(t, r) {LIST; printf(\"&lt;%s: %lf&gt;\\n\", t, r);}\n#define tokenString(t, s) {LIST; printf(\"&lt;%s: %s&gt;\\n\", t, s);}\n\n#define MAX_LINE_LENG 256\n\nextern FILE* yyin;\nextern FILE* yyout;\nint linenum = 1;\nchar buf[MAX_LINE_LENG];\nchar* tempStr;\nint indexForStr = 1;\nlist_t* temp;\n%}\n%x Comment\n%%\n\"//\".*              {LIST;}\n\n\"/*\"            {BEGIN(Comment); LIST;}\n&lt;Comment&gt;\"*/\"       {LIST; BEGIN(0);}\n&lt;Comment&gt;\\n             {LIST; printf(\"%d: %s\\n\", linenum++, buf); buf[0] = '\\0';}\n&lt;Comment&gt;.      {LIST;}\n\n\"bool\"      {\n                token(\"BOOL\");\n                return BOOL;\n                }\n\"break\"     {token(\"BREAK\"); return BREAK;}\n\"char\"      {token(\"CHAR\"); return CHAR;}\n\"continue\"  {token(\"CONTINUE\"); return CONTINUE;}\n\"do\"        {token(\"DO\"); return DO;}\n\"else\"      {token(\"ELSE\"); return ELSE;}\n\"enum\"      {token(\"ENUM\"); return ENUM;}\n\"extern\"    {token(\"EXTERN\"); return EXTERN;}\n\"false\"     {token(\"FALSE\"); yylval.boolVal = 0; return FALSE;}\n\"float\"     {\n                token(\"FLOAT\");\n                return FLOAT;\n                }\n\"for\"       {token(\"FOR\"); return FOR;}\n\"fn\"        {token(\"FN\"); return FN;}\n\"if\"        {token(\"IF\"); return IF;}\n\"in\"        {token(\"IN\"); return IN;}\n\"int\"       {\n                token(\"INT\");\n                return INT;\n                }\n\"let\"       {token(\"LET\"); return LET;}\n\"loop\"      {token(\"LOOP\"); return LOOP;}\n\"match\"     {token(\"MATCH\"); return MATCH;}\n\"mut\"       {token(\"MUT\"); return MUT;}\n\"print\"     {token(\"PRINT\"); return PRINT;}\n\"println\"   {token(\"PRINTLN\"); return PRINTLN;}\n\"pub\"       {token(\"PUB\"); return PUB;}\n\"return\"    {token(\"RETURN\"); return RETURN;}\n\"self\"      {token(\"SELF\"); return SELF;}\n\"static\"    {token(\"STATIC\"); return STATIC;}\n\"str\"       {\n                token(\"STR\");\n                return STR;\n                }\n\"struct\"    {token(\"STRUCT\"); return STRUCT;}\n\"true\"      {token(\"TRUE\"); yylval.boolVal = 1; return TRUE;}\n\"use\"       {token(\"USE\"); return USE;}\n\"where\"     {token(\"WHERE\"); return WHERE;}\n\"while\"     {token(\"WHILE\"); return WHILE;}\n\n\",\"         {token(\"','\"); return ',';}\n\":\"         {token(\"':'\"); return ':';}\n\";\"         {token(\"';'\"); return ';';}\n\"(\"         {token(\"'('\"); return '(';}\n\")\"         {token(\"')'\"); return ')';}\n\"[\"         {token(\"'['\"); return '[';}\n\"]\"         {token(\"']'\"); return ']';}\n\"{\"         {token(\"'{'\"); return '{';}\n\"}\"         {token(\"'}'\"); return '}';}\n\n\"+\"         {token(\"'+'\"); return '+';}\n\"-\"         {token(\"'-'\"); return '-';}\n\"*\"         {token(\"'*'\"); return '*';}\n\"/\"         {token(\"'/'\"); return '/';}\n\"++\"        {token(\"'++'\"); return '++';}\n\"--\"        {token(\"'--'\"); return '--';}\n\"%\"     {token(\"'%'\"); return '%';}\n\n\"&lt;\"         {token(\"'&lt;'\"); return LESS;}\n\"&lt;=\"        {token(\"'&lt;='\"); return '&lt;=';}\n\"&gt;=\"        {token(\"'&gt;='\"); return '&gt;=';}\n\"&gt;\"         {token(\"'&gt;'\"); return GREATER;}\n\"==\"        {token(\"'=='\"); return '==';}\n\"!=\"        {token(\"'!='\"); return '!=';}\n\n\"&amp;&amp;\"        {token(\"'&amp;&amp;'\"); return '&amp;&amp;';}\n\"||\"        {token(\"'||'\"); return '||';}\n\"!\"         {token(\"'!'\"); return EXCLAMATION;}\n\n\"=\"         {token(\"'='\"); return ASSIGN;}\n\n\"+=\"        {token(\"'+='\"); return '+=';}\n\"-=\"        {token(\"'-='\"); return '-=';}\n\"*=\"        {token(\"'*='\"); return '*=';}\n\"/=\"        {token(\"'/='\"); return '/=';}\n\n\"-&gt;\"            {token(\"'-&gt;'\"); return ARROW;}\n\"read\"          {token(\"'READ'\"); return READ;}\n\n[A-Z_a-z]([A-Z_a-z]|[0-9])*             {\n                                        insert(yytext, yyleng, UNDEF, linenum);\n                                        yylval.symptr = lookup(yytext);\n                                        tokenString(\"id\", yylval.symptr-&gt;st_name);\n                                        return ID;\n                                        }               \n\n\"0\"|[0-9][0-9]*                         {\n                                        sscanf(yytext, \"%d\", &amp;yylval.intVal);\n                                        tokenInteger(\"integer\", yylval.intVal);\n                                    return INTEGER;\n                                        }\n\n[0-9_]+\".\"[0-9_]|[0-9_][Ee][+-]?[0-9_]+ {\n                                        yylval.floatVal = atof(yytext);\n                                        tokenReal(\"real\", yylval.floatVal);\n                                    return REAL;\n                                        }\n\n\\\"([\\\\.]|[^\\\\\"])*\\\"                     {\n                                        tempStr = malloc((strlen(yytext) - 1) * sizeof(char));\n                                        for (int i = 0; i &lt; strlen(yytext) - 2; i++)\n                                        {\n                                                tempStr[i] = yytext[indexForStr];\n                                                indexForStr++;\n                                        }\n                                        tempStr[strlen(yytext) - 1] = '\\0';\n\n                                        yylval.stringVal = strdup(yytext);\n                                        tokenString(\"string\", tempStr);\n                                        free(tempStr);\n                                        indexForStr = 1;\n\n                                    return STRING;\n                                        }\n\n\\n      {\n        LIST;\n        printf(\"%d: %s\", linenum++, buf);\n        buf[0] = '\\0';\n        }\n\n[ \\t]*  {LIST;}\n\n.       {\n        LIST;\n        printf(\"%d:%s\\n\", linenum+1, buf);\n        printf(\"bad character:'%s'\\n\",yytext);\n        exit(-1);\n        }\n%%\n</code></pre>\n\n<hr>\n\n<p>parser file</p>\n\n<pre><code>%{\n#include \"symbols.c\"\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;math.h&gt;\n\n#define Trace(t, line)        printf(t, line) // Trace where the error occurs and print the line number\n\n#ifndef STRSIZE\n#define STRSIZE     40\n#endif\n\n#ifndef PARAMSIZE\n#define PARAMSIZE   40\n#endif\n\nextern FILE* yyin;\nextern FILE* yyout;\nextern int linenum;\nextern int yylex();\nvoid yyerror(char* msg);\n%}\n\n%union{\n    char* stringVal;\n    double floatVal;\n    int intVal;\n    int boolVal;\n    list_t* symptr;\n}\n\n/* tokens */\n%token &lt;symptr&gt; ID\n%token &lt;intVal&gt; INTEGER\n%token &lt;floatVal&gt; REAL\n%token &lt;stringVal&gt; STRING\n%token &lt;boolVal&gt; TRUE FALSE\n%token INT FLOAT STR BOOL\n%token BREAK CHAR CONTINUE DO ELSE\n%token ENUM EXTERN FOR\n%token FN IF IN LET \n%token LOOP MATCH MUT PRINT PRINTLN\n%token RETURN SELF STATIC STRUCT\n%token USE WHERE WHILE\n%token READ PUB\n%token LESS GREATER ASSIGN EXCLAMATION ARROW\n\n/* precedence for operators */\n%left '||'\n%left '&amp;&amp;'\n%left EXCLAMATION\n%left LESS '&lt;=' '&gt;=' GREATER '==' '!='\n%left '+' '-'\n%left '*' '/'\n%left UMINUS\n\n/* types */\n%type &lt;intVal&gt; integer_exp\n%type &lt;floatVal&gt; real_exp\n%type &lt;stringVal&gt; string_exp\n%type &lt;boolVal&gt; bool_exp\n\n%start program              /* the initial entry point */\n\n%%\nprogram:        functions | global_declaration functions\n                ;\n\nglobal_declaration:     global_declaration constant_declaration\n                        | global_declaration variable_declaration\n                        | global_declaration array_declaration\n                        | constant_declaration\n                        | variable_declaration\n                        | array_declaration\n                        ;\n\nlocal_declaration:      local_declaration constant_declaration\n                        | local_declaration variable_declaration\n                        | local_declaration array_declaration\n                        | constant_declaration\n                        | variable_declaration\n                        | array_declaration\n                        ;\n\nblock:          start local_declaration statements end               \n                | start local_declaration end                         \n                | start statements end                                \n                | start end                                           \n                ;\n\nstart:          '{'                                                 {\n                                                                    incr_scope();\n                                                                    }\n\nend:            '}'                                                 {\n                                                                    hide_scope();\n                                                                    }\n                ;\n\nfunctions:      functions function                                      \n                | function\n                ;\n\nfunction:       FN ID '(' ')' start local_declaration statements end{\n                                                                    if ($2-&gt;st_type == UNDEF)\n                                                                    {\n                                                                        $2-&gt;st_type = FUNCTION_TYPE;\n                                                                        $2-&gt;inf_type = UNDEF;\n                                                                    } \n                                                                    else\n                                                                    {\n                                                                        Trace(\"line %d: Redeclaration of identifier.\\n\", linenum);\n                                                                    }\n                                                                    }\n                | FN ID '(' ')' start statements end                {\n                                                                    if ($2-&gt;st_type == UNDEF)\n                                                                    {\n                                                                        $2-&gt;st_type = FUNCTION_TYPE;\n                                                                        $2-&gt;inf_type = UNDEF;\n                                                                    } \n                                                                    else\n                                                                    {\n                                                                        Trace(\"line %d: Redeclaration of identifier.\\n\", linenum);\n                                                                    }\n                                                                    }\n                | FN ID '(' ')' start local_declaration end         {\n                                                                    if ($2-&gt;st_type == UNDEF)\n                                                                    {\n                                                                        $2-&gt;st_type = FUNCTION_TYPE;\n                                                                        $2-&gt;inf_type = UNDEF;\n                                                                    } \n                                                                    else\n                                                                    {\n                                                                        Trace(\"line %d: Redeclaration of identifier.\\n\", linenum);\n                                                                    }\n                                                                    }\n                | FN ID '(' ')' start end                           {\n                                                                    if ($2-&gt;st_type == UNDEF)\n                                                                    {\n                                                                        $2-&gt;st_type = FUNCTION_TYPE;\n                                                                        $2-&gt;inf_type = UNDEF;\n                                                                    } \n                                                                    else\n                                                                    {\n                                                                        Trace(\"line %d: Redeclaration of identifier.\\n\", linenum);\n                                                                    }\n                ;\n\n%%\nvoid yyerror(char* msg)\n{\n    fprintf(stderr, \"line %d: %s\\n\", linenum, msg);\n}\n\nint main(int argc, char** argv)\n{\n    /* create the hash table */\n    create();\n\n    /* open the source program file */\n    if (argc != 2) {\n        printf (\"Usage: sc filename\\n\");\n        exit(1);\n    }\n    yyin = fopen(argv[1], \"r\");         /* open input file */\n\n    int flag;\n    flag = yyparse();\n\n    /* perform parsing */\n    if (flag == 1)                      /* parsing */\n        yyerror(\"Parsing error !\");     /* syntax error */\n\n    fclose(yyin);                       /* close input file */\n\n    /* output symbol table */\n    printf(\"\\nSymbol table:\\n\");\n    yyout = fopen(\"dump.out\", \"w\");\n    dump(yyout);\n    fclose(yyout);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1525272736, "post_id": 50137562, "comment_id": 87293423, "body": "Use an algorithm to find unique values?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1525272810, "post_id": 50137562, "comment_id": 87293479, "body": "There are many ways to get unique values from a collection, all of them easily searchable for in your favorite search engine."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 1, "creation_date": 1525272844, "post_id": 50137562, "comment_id": 87293502, "body": "Read about <a href=\"https://en.wikipedia.org/wiki/Hash_table\" rel=\"nofollow noreferrer\">hashtable</a>s to get some inspiration. But we won&#39;t do your homework. Your question is <b>off-topic</b>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1525272882, "post_id": 50137562, "comment_id": 87293534, "body": "@BasileStarynkevitch Hashtable sounds like an overkill :)"}, {"owner": {"reputation": 72, "user_id": 8900754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZDhvL.jpg?s=128&g=1", "display_name": "dernst", "link": "https://stackoverflow.com/users/8900754/dernst"}, "edited": false, "score": 0, "creation_date": 1525272974, "post_id": 50137562, "comment_id": 87293607, "body": "You will also need to store in memory all the cities that you encounter and check to see if the city is already in the list before adding a new one.  You might want to create a counter for each item in the list and increment it each time you find a matching city"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1525274909, "post_id": 50137562, "comment_id": 87294853, "body": "Well, I think your quest is too broad for SO as it is now. To improve it, you could post the code you have so far. Maybe then it will be a question that can be answered within the scope of SO"}], "answers": [{"comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1525273033, "post_id": 50137650, "comment_id": 87293656, "body": "What is a container?"}, {"owner": {"reputation": 3457, "user_id": 3753446, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/4Pipl.png?s=128&g=1", "display_name": "Magix", "link": "https://stackoverflow.com/users/3753446/magix"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1525273134, "post_id": 50137650, "comment_id": 87293723, "body": "Well, it can be a STL vector, a list, etc...  <a href=\"http://www.cplusplus.com/reference/stl/\" rel=\"nofollow noreferrer\">more reading</a>"}], "tags": [], "owner": {"reputation": 3457, "user_id": 3753446, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/4Pipl.png?s=128&g=1", "display_name": "Magix", "link": "https://stackoverflow.com/users/3753446/magix"}, "is_accepted": false, "score": 0, "last_activity_date": 1525274127, "last_edit_date": 1525274127, "creation_date": 1525272924, "answer_id": 50137650, "question_id": 50137562, "link": "https://stackoverflow.com/questions/50137562/c-how-count-number-of-unique-cities-in-a-text-file/50137650#50137650", "title": "C how count number of unique cities in a text file", "body": "<p>Here is what you want to do :</p>\n\n<ol>\n<li>Read your file line by line into an array (static or dynamically-allocated, depends on whether you know the number of lines at compilation time)</li>\n<li>Remove the contents of each line between the last space and the '\\n' character</li>\n<li>Eventually sanitize your text (put it all lowercase, etc...)</li>\n<li>Make the contents of your array unique (you'll have to think or google it, but don't worry, it's not that difficult)</li>\n<li>Count the number of elements in your array</li>\n</ol>\n\n<p>good luck ;-)</p>\n"}, {"comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1525273212, "post_id": 50137661, "comment_id": 87293788, "body": "Generally, sorting and traversing will give better time complexity."}, {"owner": {"reputation": 1, "user_id": 9730904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e71c987842086d2f4e6d1e650144ffdc?s=128&d=identicon&r=PG&f=1", "display_name": "GhostNANI", "link": "https://stackoverflow.com/users/9730904/ghostnani"}, "edited": false, "score": 0, "creation_date": 1525273318, "post_id": 50137661, "comment_id": 87293857, "body": "Alright thanks for the help i might just have an idea of how to do it"}], "tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 0, "last_activity_date": 1525272967, "creation_date": 1525272967, "answer_id": 50137661, "question_id": 50137562, "link": "https://stackoverflow.com/questions/50137562/c-how-count-number-of-unique-cities-in-a-text-file/50137661#50137661", "title": "C how count number of unique cities in a text file", "body": "<p>Read the first city. Put it in the first entry of an array.</p>\n\n<p>For every next city read, check each entry of the array if it is the same.</p>\n\n<p>If not, add it to the array.</p>\n\n<p>The number of entries in use of the array is the number of unique cities.</p>\n"}], "owner": {"reputation": 1, "user_id": 9730904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e71c987842086d2f4e6d1e650144ffdc?s=128&d=identicon&r=PG&f=1", "display_name": "GhostNANI", "link": "https://stackoverflow.com/users/9730904/ghostnani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1525274127, "creation_date": 1525272688, "question_id": 50137562, "link": "https://stackoverflow.com/questions/50137562/c-how-count-number-of-unique-cities-in-a-text-file", "title": "C how count number of unique cities in a text file", "body": "<p>How do i count the total number of cities that are unique?</p>\n\n<pre><code>For example my text file has  \nNew York  $255\nNew Jersey  $19.90\nFarmvill  $300\nTexas  $400\nNew York $17.90\n</code></pre>\n\n<p>I have tried reading the file line by line and counting the number of lines but it gave me 5 cities when there is only 4 unique cities. How should i go about this problem</p>\n"}, {"tags": ["c", "putty"], "comments": [{"owner": {"reputation": 144837, "user_id": 850848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c287735beca76400cb9b6d08bf591cb9?s=128&d=identicon&r=PG", "display_name": "Martin Prikryl", "link": "https://stackoverflow.com/users/850848/martin-prikryl"}, "edited": false, "score": 0, "creation_date": 1525271507, "post_id": 50137046, "comment_id": 87292576, "body": "Please move your question to <a href=\"https://superuser.com\">Super User</a> (delete here, re-post there). It&#39;s <a href=\"//stackoverflow.com/help/on-topic\">off-topic here</a>."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1525344889, "post_id": 50137046, "comment_id": 87324097, "body": "Please ask a separate question instead of drastically changing the current one."}], "owner": {"reputation": 61, "user_id": 9339048, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-WRlJOTw9r1s/AAAAAAAAAAI/AAAAAAAAAAw/9mfYiKpKbEw/photo.jpg?sz=128", "display_name": "codebase", "link": "https://stackoverflow.com/users/9339048/codebase"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 1, "closed_date": 1525272851, "answer_count": 0, "score": 2, "last_activity_date": 1525346708, "creation_date": 1525271044, "last_edit_date": 1525346708, "question_id": 50137046, "link": "https://stackoverflow.com/questions/50137046/utf-8-character-edit-is-not-ok-in-output-window", "closed_reason": "Not suitable for this site", "title": "UTF-8 Character edit is not OK in output window", "body": "<p>I have configured My putty to accept UTF-8 Character\n<img src=\"https://i.stack.imgur.com/VdI64.png\" alt=\"Putty configuration\"></p>\n\n<p>I have set the linux environmental variable as UTF-8.</p>\n\n<pre><code>export LANG=\"en_GB.UTF-8\"\n</code></pre>\n\n<p>How ever when I run my program, edit my use input the I have 2 press backspace key twice to delete the single character even though if the environmental values in active state. </p>\n\n<p>Also I tried and I could not able to set the environmental value through my c code . </p>\n\n<pre><code>if (setlocale(LC_ALL, \"en_US.UTF-8\") == NULL) {\n    abort();\n    }\n</code></pre>\n\n<p>what I have to do to get this problem solved?</p>\n"}, {"tags": ["c", "makefile", "porting", "atmel"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1525269425, "post_id": 50136416, "comment_id": 87290978, "body": "<i>fails</i>....how?"}, {"owner": {"reputation": 103, "user_id": 3049371, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aN1T1.gif?s=128&g=1", "display_name": "Adeesh Lemonickous", "link": "https://stackoverflow.com/users/3049371/adeesh-lemonickous"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1525270102, "post_id": 50136416, "comment_id": 87291487, "body": "Hi Eugene, sorry for the confusion, I added the error message to make it clear."}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1525270436, "post_id": 50136416, "comment_id": 87291747, "body": "What happens if you try building &quot;$(EXE_PATH)/$(APP_NAME).elf&quot;?"}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 3049371, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aN1T1.gif?s=128&g=1", "display_name": "Adeesh Lemonickous", "link": "https://stackoverflow.com/users/3049371/adeesh-lemonickous"}, "edited": false, "score": 0, "creation_date": 1525323867, "post_id": 50142545, "comment_id": 87312712, "body": "Hey, those are some great comments, thanks a lot. I had just moderately modified the makefile that Atmel gives with Bitcloud, so the problems with name manipulation, I knew of and have planned to improve soon. Last night I did exactly the thing you said, I took the <code>make -d</code> from both windows and linux and started going through the diff of both. Will update soon on what I find."}], "tags": [], "owner": {"reputation": 69991, "user_id": 939557, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3VPea.png?s=128&g=1", "display_name": "MadScientist", "link": "https://stackoverflow.com/users/939557/madscientist"}, "is_accepted": false, "score": 0, "last_activity_date": 1525290919, "creation_date": 1525290919, "answer_id": 50142545, "question_id": 50136416, "link": "https://stackoverflow.com/questions/50136416/makefile-executes-correctly-in-windows-but-not-linux/50142545#50142545", "title": "Makefile executes correctly in Windows but not Linux", "body": "<p>It's surprising that this works on Windows.  There are a number of things that are problematic in this makefile.  One:</p>\n\n<pre><code>OBJS = $(addprefix $(OBJ_PATH)/, $(notdir %/$(subst .c,.o,$(CSRCS))))\n</code></pre>\n\n<p>This is confusing.  <code>notdir</code> doesn't do anything with patterns so adding the <code>%/</code> (only to the first argument!) is not doing anything.  Also using <code>subst</code> is not a good idea because it changes every instance of <code>.c</code> even if it appears in the middle of a file; for example <code>../x.comp.c</code> would change to <code>../x.oomp.o</code>.  This line should be:</p>\n\n<pre><code>OBJS = $(patsubst %.c,$(OBJ_DIR)/%.o,$(notdir $(CSRCS)))\n</code></pre>\n\n<p>Next, this is not right:</p>\n\n<pre><code>$(OBJ_PATH)/%.o: $(SRCS)\n        $(CC) $(CFLAGS) $(filter %/$(subst .o,.c,$(notdir $@)), $(SRCS)) -o $@\n</code></pre>\n\n<p>This makes every object file depend on <em>all</em> the source files, so if you change any source file every object file will be rebuilt.  You might as well just create a shell script rather than using make.  That's why you have to go through contortions in the recipe to find the C file you want to compile.  Better would be to <a href=\"https://www.gnu.org/software/make/manual/html_node/Directory-Search.htm\" rel=\"nofollow noreferrer\">use VPATH</a>.  Also you need to have the <code>-c</code> option in your compiler line to build object files... I can't see it added to your <code>CFLAGS</code> but best practice doesn't put it there anyway:</p>\n\n<pre><code>vpath %.c $(sort $(dir $(CSRCS)))\n$(OBJ_PATH)/%.o: %.c\n        $(CC) $(CFLAGS) -c $&lt; -o $@\n</code></pre>\n\n<p>Next, this line is not good:</p>\n\n<pre><code>$(OBJS): directories\n</code></pre>\n\n<p>This will rebuild all objects whenever the <code>directories</code> target needs to be rebuilt, which is always because no rule ever creates that target: the <code>directories</code> target never creates a file named <code>directories</code> so it's always out of date.</p>\n\n<p>All that being said, I can't explain the error you're seeing.  The linker is complaining about a file that doesn't exist, but that file is (apparently) a prerequisite of the target which means if it didn't exist then make would try to create it, or complain if it couldn't.</p>\n\n<p>After fixing your makefile I recommend running <code>make -d</code> (redirect to a file since the output will be significant) and search for the <code>configServer.o</code> target and see what make has to say about it.</p>\n"}], "owner": {"reputation": 103, "user_id": 3049371, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aN1T1.gif?s=128&g=1", "display_name": "Adeesh Lemonickous", "link": "https://stackoverflow.com/users/3049371/adeesh-lemonickous"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1525290919, "creation_date": 1525269366, "last_edit_date": 1525269830, "question_id": 50136416, "link": "https://stackoverflow.com/questions/50136416/makefile-executes-correctly-in-windows-but-not-linux", "title": "Makefile executes correctly in Windows but not Linux", "body": "<p>I have a project which compiles swimmingly in windows using <code>make</code> but fails in linux. It's failing during implicit compilation to object files (I'll post an excerpt):</p>\n\n<pre><code>arm-none-eabi-gcc -Wl,-Map=All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/List\n/PMSCounter.map -Wl,--gc-sections -Wl,-T../../linkerScr/atsamr21g18a.ld -mthumb -nostartfiles -mcpu=cortex-m0plus All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/PMSCounterSensor.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/SZ_DbgLib.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/WSNVisualizer.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/WSNMessageSender.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/WSNCommandHandler.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/WSNRouter.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/WSNDemoApp.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/stdPdsMemAccess.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/stdPdsTimer.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/stdPdsMem.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/stdPdsWriteData.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/stdPdsCrcService.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/stdPdsInit.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/stdPdsEvents.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/stdPdsDataServer.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/fakePds.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/wlPdsTypesConverter.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/wlPdsTaskManager.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/wlPdsSecurity.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/wlPdsInit.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/wlPdsDataServer.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/S_Nv.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/S_XNv.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/D_XNv-SamR21.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/S_Nv-External.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/D_Nv.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/S_Nv_Stub.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/sysIdleHandler.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/sysSleep.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/sysStat.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/sysEventsHandler.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/sysQueue.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/sysUtils.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/sysAssert.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/sysDuplicateTable.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/sysInit.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/sysTaskManager.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/dbg.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/sysMutex.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/sysTimer.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/bspUsart.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/MaxL.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/bspTempSensor.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/buttons.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/fakeBSP.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/lcd.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/xyl2rgb.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/joyStick.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/bspUid.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/bspI2c.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/bspVoltageSensor.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/bspTaskManager.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/hs2xy.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/leds.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/bspSpi.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/csPersistentMem.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/csMem.o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/configServer.o -Wl,-\\( ../../../../BitCloud/lib/libBc_All_Atsamr21g18a_Rf233_Gcc.a ../../../../BitCloud/lib/libHAL_SamR21_Atsamr21g18a_8Mhz_Gcc.a  -Wl,-\\) -o All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Exe/PMSCounter.elf\narm-none-eabi-gcc: error: All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Obj/configServer.o: No such file or directory\narm-none-eabi-gcc: error: ../../../../BitCloud/lib/libHAL_SamR21_Atsamr21g18a_8Mhz_Gcc.a: No such file or directory\nMakefile_All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc:172: recipe for target 'All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Exe/PMSCounter.elf' failed\nmake[1]: *** [All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc/Exe/PMSCounter.elf] Error 1\nmake[1]: Leaving directory '/mnt/Data/Work_Senzopt/PMS/Codebase/Main_codebase/parking-counter/parking-counter-2/parking-counter-2/Applications/PMSCounter/makefiles/ATSAMR21G18A'\nMakefile:10: recipe for target 'all' failed\nmake: *** [all] Error 2\n</code></pre>\n\n<p>I tried doing <code>make -nd</code> in both windows and linux, and the first thing that happens in windows is all the *.o files are generated, while in linux it directly goes to the linking step. However, I am lost as to why that's happening because from looking at the makefile, I can't recognize the platform dependencies. I'd appreciate any hints about what I'm doing wrong, thank you! My makefile is:</p>\n\n<pre><code>COMPONENTS_PATH = ../../../../BitCloud/Components\nCONFIG_NAME = All_SamR21_Atsamr21g18a_Rf233_8Mhz_Gcc\nLIST_PATH = $(CONFIG_NAME)/List\nEXE_PATH = $(CONFIG_NAME)/Exe\nOBJ_PATH = $(CONFIG_NAME)/Obj\n\ninclude ../../../../BitCloud/lib/Makerules_Atsamr21g18a_Gcc\n\nDEFINES = \\\n  -DBOARD_SAMR21 \\\n  -DAT86RF233 \\\n  -DATSAMR21G18A \\\n  -DHAL_8MHz \\\n  -DNO_SECURITY_MODE \\\n  -DSTACK_TYPE_ALL \n\nINCLUDES = \\\n  -I../.. \\\n  -I../../include \\\n  -I../../../../BitCloud/Components/BSP/SAMR21/include \\\n  -I../../../../BitCloud/Components/SystemEnvironment/include \\\n  -I../../../../BitCloud/lib \\\n  -I../../../../BitCloud/Components/HAL/include \\\n  -I../../../../BitCloud/Components/BSP \\\n  -I../../../../BitCloud/Components/BSP/include \\\n  -I../../../../BitCloud/Components/NWK/include \\\n  -I../../../../BitCloud/Components/NWK/include/private \\\n  -I../../../../BitCloud/Components/ZDO/include \\\n  -I../../../../BitCloud/Components/ZDO/include/private \\\n  -I../../../../BitCloud/Components/APS/include \\\n  -I../../../../BitCloud/Components/APS/include/private \\\n  -I../../../../BitCloud/Components/SystemEnvironment/include \\\n  -I../../../../BitCloud/Components/ConfigServer/include \\\n  -I../../../../BitCloud/Components/ConfigServer/include/private \\\n  -I../../../../BitCloud/Components/PersistDataServer/include \\\n  -I../../../../BitCloud/Components/PersistDataServer/std/include \\\n  -I../../../../BitCloud/Components/PersistDataServer/wl/include \\\n  -I../../../../BitCloud/Components/ZLLPlatform/Infrastructure/N_Types/include \\\n  -I../../../../BitCloud/Components/ZLLPlatform/Infrastructure/N_Util/include \\\n  -I../../../../BitCloud/Components/ZLLPlatform/Infrastructure/N_Timer/include \\\n  -I../../../../BitCloud/Components/ZLLPlatform/Infrastructure/N_Task/include \\\n  -I../../../../BitCloud/Components/ZLLPlatform/Infrastructure/N_ErrH/include \\\n  -I../../../../BitCloud/Components/ZLLPlatform/Infrastructure/N_Log/include \\\n  -I../../../../BitCloud/Components/ZLLPlatform/Infrastructure/N_Memory/include \\\n  -I../../../../BitCloud/Components/ZLLPlatform/Infrastructure/N_Init/include \\\n  -I../../../../BitCloud/Components/ZLLPlatform/ZLL/S_Nv/include \\\n  -I../../../../BitCloud/Components/ZLLPlatform/ZLL/S_XNv/include \\\n  -I../../../../BitCloud/Components/ZLLPlatform/ZLL/D_Nv/include \\\n  -I../../../../BitCloud/Components/ZLLPlatform/ZLL/D_XNv/include \\\n  -I../../../../BitCloud/Components/ZLLPlatform/ZLL/D_XNv/src \\\n  -I../../../../BitCloud/Components/ZLLPlatform/ZLL/S_XNv/src \\\n  -I../../../../BitCloud/Components/Security/TrustCentre/include \\\n  -I../../../../BitCloud/Components/Security/ServiceProvider/include \\\n  -I../../../../BitCloud/Components/HAL/drivers/include \\\n  -I../../../../BitCloud/Components/HAL/drivers/VCP/include \\\n  -I../../../../BitCloud/Components/HAL/cortexm0+/atsamr21/common/include \\\n  -I../../../../BitCloud/Components/MAC_PHY/include \\\n  -I../../../../BitCloud/Components/MAC_PHY/MAC_ENV/include \\\n  -I../../../../BitCloud/Components/MAC_PHY/MAC_HWI/include \\\n  -I../../../../BitCloud/Components/MAC_PHY/MAC_HWD_PHY/include \\\n  -I../../../../BitCloud/Components/MAC_PHY/MAC_HWD_PHY/RF231_RF212/PHY/include \\\n  -I../../../../BitCloud/Components/MAC_PHY/MAC_HWD_PHY/RF231_RF212/MAC_HWD/include \n\nLIBS = \\\n  ../../../../BitCloud/lib/libBc_All_Atsamr21g18a_Rf233_Gcc.a \\\n  ../../../../BitCloud/lib/libHAL_SamR21_Atsamr21g18a_8Mhz_Gcc.a \n\nSRCS = \\\n  ../../src/PMSCounterSensor.c \\\n  ../../src/SZ_DbgLib.c \\\n  ../../src/WSNVisualizer.c \\\n  ../../src/WSNMessageSender.c \\\n  ../../src/WSNCommandHandler.c \\\n  ../../src/WSNRouter.c \\\n  ../../src/WSNDemoApp.c \\\n  ../../../../BitCloud/Components/PersistDataServer/std/src/stdPdsMemAccess.c \\\n  ../../../../BitCloud/Components/PersistDataServer/std/src/stdPdsTimer.c \\\n  ../../../../BitCloud/Components/PersistDataServer/std/src/stdPdsMem.c \\\n  ../../../../BitCloud/Components/PersistDataServer/std/src/stdPdsWriteData.c \\\n  ../../../../BitCloud/Components/PersistDataServer/std/src/stdPdsCrcService.c \\\n  ../../../../BitCloud/Components/PersistDataServer/std/src/stdPdsInit.c \\\n  ../../../../BitCloud/Components/PersistDataServer/std/src/stdPdsEvents.c \\\n  ../../../../BitCloud/Components/PersistDataServer/std/src/stdPdsDataServer.c \\\n  ../../../../BitCloud/Components/PersistDataServer/src/fakePds.c \\\n  ../../../../BitCloud/Components/PersistDataServer/wl/src/wlPdsTypesConverter.c \\\n  ../../../../BitCloud/Components/PersistDataServer/wl/src/wlPdsTaskManager.c \\\n  ../../../../BitCloud/Components/PersistDataServer/wl/src/wlPdsSecurity.c \\\n  ../../../../BitCloud/Components/PersistDataServer/wl/src/wlPdsInit.c \\\n  ../../../../BitCloud/Components/PersistDataServer/wl/src/wlPdsDataServer.c \\\n  ../../../../BitCloud/Components/ZLLPlatform/ZLL/S_Nv/src/S_Nv.c \\\n  ../../../../BitCloud/Components/ZLLPlatform/ZLL/S_XNv/src/S_XNv.c \\\n  ../../../../BitCloud/Components/ZLLPlatform/ZLL/D_XNv/src/D_XNv-SamR21.c \\\n  ../../../../BitCloud/Components/ZLLPlatform/ZLL/S_Nv/src/S_Nv-External.c \\\n  ../../../../BitCloud/Components/ZLLPlatform/ZLL/D_Nv/src/D_Nv.c \\\n  ../../../../BitCloud/Components/ZLLPlatform/ZLL/S_Nv/src/S_Nv_Stub.c \\\n  ../../../../BitCloud/Components/SystemEnvironment/src/sysIdleHandler.c \\\n  ../../../../BitCloud/Components/SystemEnvironment/src/sysSleep.c \\\n  ../../../../BitCloud/Components/SystemEnvironment/src/sysStat.c \\\n  ../../../../BitCloud/Components/SystemEnvironment/src/sysEventsHandler.c \\\n  ../../../../BitCloud/Components/SystemEnvironment/src/sysQueue.c \\\n  ../../../../BitCloud/Components/SystemEnvironment/src/sysUtils.c \\\n  ../../../../BitCloud/Components/SystemEnvironment/src/sysAssert.c \\\n  ../../../../BitCloud/Components/SystemEnvironment/src/sysDuplicateTable.c \\\n  ../../../../BitCloud/Components/SystemEnvironment/src/sysInit.c \\\n  ../../../../BitCloud/Components/SystemEnvironment/src/sysTaskManager.c \\\n  ../../../../BitCloud/Components/SystemEnvironment/src/dbg.c \\\n  ../../../../BitCloud/Components/SystemEnvironment/src/sysMutex.c \\\n  ../../../../BitCloud/Components/SystemEnvironment/src/sysTimer.c \\\n  ../../../../BitCloud/Components/BSP/SAMR21/src/bspUsart.c \\\n  ../../../../BitCloud/Components/BSP/SAMR21/src/MaxL.c \\\n  ../../../../BitCloud/Components/BSP/SAMR21/src/bspTempSensor.c \\\n  ../../../../BitCloud/Components/BSP/SAMR21/src/buttons.c \\\n  ../../../../BitCloud/Components/BSP/SAMR21/src/fakeBSP.c \\\n  ../../../../BitCloud/Components/BSP/SAMR21/src/lcd.c \\\n  ../../../../BitCloud/Components/BSP/SAMR21/src/xyl2rgb.c \\\n  ../../../../BitCloud/Components/BSP/SAMR21/src/joyStick.c \\\n  ../../../../BitCloud/Components/BSP/SAMR21/src/bspUid.c \\\n  ../../../../BitCloud/Components/BSP/SAMR21/src/bspI2c.c \\\n  ../../../../BitCloud/Components/BSP/SAMR21/src/bspVoltageSensor.c \\\n  ../../../../BitCloud/Components/BSP/SAMR21/src/bspTaskManager.c \\\n  ../../../../BitCloud/Components/BSP/SAMR21/src/hs2xy.c \\\n  ../../../../BitCloud/Components/BSP/SAMR21/src/leds.c \\\n  ../../../../BitCloud/Components/BSP/SAMR21/src/bspSpi.c \\\n  ../../../../BitCloud/Components/ConfigServer/src/csPersistentMem.c \\\n  ../../../../BitCloud/Components/ConfigServer/src/csMem.c \\\n  ../../../../BitCloud/Components/ConfigServer/src/configServer.c \n\nPREINCLUDE = MakerulesBc_All_Atsamr21g18a_Rf233_Gcc.h\n\nCSRCS = $(filter %.c, $(SRCS))\nOBJS = $(addprefix $(OBJ_PATH)/, $(notdir %/$(subst .c,.o,$(CSRCS))))\n\nASM_FILE_EXT = s\n\nifneq (, $(findstring .$(ASM_FILE_EXT), $(SRCS)))\n  ASRCS = $(filter %.$(ASM_FILE_EXT), $(SRCS))\n  OBJS += $(addprefix $(OBJ_PATH)/, $(notdir %$(subst .$(ASM_FILE_EXT),.o,$(ASRCS))))\nendif\n\nCFLAGS += $(DEFINES)\nCFLAGS += $(INCLUDES)\nCFLAGS += --include $(PREINCLUDE)\nCFLAGS += -g\n\nASFLAGS = $(INCLUDES)\nASFLAGS += $(filter -mcpu%,$(CFLAGS))\n\n$(OBJ_PATH)/%.o: $(SRCS)\n    $(CC) $(CFLAGS) $(filter %/$(subst .o,.c,$(notdir $@)), $(SRCS)) -o $@\n\n\nLD = $(CC)\nLINKER_FLAGS = -Wl,-Map=$(LIST_PATH)/$(APP_NAME).map -Wl,--gc-sections\nLINKER_FLAGS += -Wl,-T../../linkerScr/atsamr21g18a.ld\nLINKER_FLAGS += -mthumb -nostartfiles\nLINKER_FLAGS += $(filter -mcpu%,$(CFLAGS))\n\n.PHONY: all directories clean size root_files images\n\nimages: $(EXE_PATH)/$(APP_NAME).elf $(EXE_PATH)/$(APP_NAME).hex $(EXE_PATH)/$(APP_NAME).srec $(EXE_PATH)/$(APP_NAME).bin\n\nall: directories images root_files size\n\n\n\n\n$(OBJS): directories\n\n\n$(EXE_PATH)/$(APP_NAME).elf: $(OBJS)\n    echo $(OBJS)\n    $(LD) $(LINKER_FLAGS) $(OBJS) -Wl,-\\( $(LIBS) -Wl,-\\) -o $@\n\n$(EXE_PATH)/$(APP_NAME).srec: $(EXE_PATH)/$(APP_NAME).elf\n    $(OBJCOPY) -O srec --srec-len 128 $^ $@\n\n$(EXE_PATH)/$(APP_NAME).hex: $(EXE_PATH)/$(APP_NAME).elf\n    $(OBJCOPY) -O ihex -R .eeprom $^ $@\n\n$(EXE_PATH)/$(APP_NAME).bin: $(EXE_PATH)/$(APP_NAME).elf\n    $(OBJCOPY) -O binary --strip-debug --strip-unneeded -R .eeprom $^ $@\n\nroot_files: images\n    cp -f $(EXE_PATH)/*.* ./../../\n\nclean:\n    rm -rf $(CONFIG_NAME) ../../$(APP_NAME).elf ../../$(APP_NAME).hex ../../$(APP_NAME).srec ../../$(APP_NAME).bin\n\ndirectories:\n    @\"mkdir\" -p $(LIST_PATH)\n    @\"mkdir\" -p $(EXE_PATH)\n    @\"mkdir\" -p $(OBJ_PATH)\n\nsize: $(EXE_PATH)/$(APP_NAME).elf\n    @echo\n    @$(SIZE) -td $(EXE_PATH)/$(APP_NAME).elf\n\nifeq ($(MAKECMDGOALS), fresh)\ndirectories: clean\nendif\nfresh: all\n\n# eof Makefile\n</code></pre>\n"}, {"tags": ["c", "linux", "character-encoding", "embedded", "buildroot"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1525270197, "post_id": 50136355, "comment_id": 87291553, "body": "Hmmm, embedded Linux device 2nd output is hex yet the expected output is decimal.  Suggest hex <code>&quot;%x &quot;</code> for both to improve post clarity.  Also recommend to review <code>rc</code> in each iteration of  <code>while((rc ...</code> to see if it is not an unexpected value."}, {"owner": {"reputation": 335, "user_id": 9698161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2881d4f88da4ddcd701eccf723006f?s=128&d=identicon&r=PG&f=1", "display_name": "J.Panek", "link": "https://stackoverflow.com/users/9698161/j-panek"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1525270923, "post_id": 50136355, "comment_id": 87292131, "body": "My bad, I tried different outputs and didn&#39;t pay attention what I post. Corrected the output so it now shows the decimal value. At first <code>rc = 1</code> but after the first character is processed and the <code>&#176;</code> is next it changes to <code>rc = -1</code>. This stops the while loop because the encoding error has occurred. Hope this clarifies things a bit"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1525271275, "post_id": 50136355, "comment_id": 87292405, "body": "Did <code>setlocale(LC_CTYPE, &quot;en_US.utf8&quot;);</code> succeed on the <i>embedded Linux device</i>?  (return a string or null pointer?)"}, {"owner": {"reputation": 335, "user_id": 9698161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2881d4f88da4ddcd701eccf723006f?s=128&d=identicon&r=PG&f=1", "display_name": "J.Panek", "link": "https://stackoverflow.com/users/9698161/j-panek"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1525271558, "post_id": 50136355, "comment_id": 87292610, "body": "Yes,  the output is <code>(null)</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1525271635, "post_id": 50136355, "comment_id": 87292653, "body": "If the <i>embedded Linux device</i> return <code>null</code>, then &quot;en_US.utf8&quot; support is not expected.  <code>mbrtowc()</code> should return -1."}, {"owner": {"reputation": 335, "user_id": 9698161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2881d4f88da4ddcd701eccf723006f?s=128&d=identicon&r=PG&f=1", "display_name": "J.Panek", "link": "https://stackoverflow.com/users/9698161/j-panek"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1525272085, "post_id": 50136355, "comment_id": 87292970, "body": "So how can I change my locale (or other system settings) so that <code>mbrtowc()</code> expects UTF-8 characters? Encodings outside ASCII are pretty new to me. Edit: locale is not supported on the embedded device, I will add it first and report results."}], "answers": [{"comments": [{"owner": {"reputation": 335, "user_id": 9698161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2881d4f88da4ddcd701eccf723006f?s=128&d=identicon&r=PG&f=1", "display_name": "J.Panek", "link": "https://stackoverflow.com/users/9698161/j-panek"}, "edited": false, "score": 0, "creation_date": 1525681382, "post_id": 50181409, "comment_id": 87436660, "body": "Worked fine, but had to generate <code>en_US.UTF-8</code> locale instead of <code>en_US.utf8</code>. The <code>en_US.utf8</code> locale resulted in an error while building (not found). Thank you."}, {"owner": {"reputation": 2292, "user_id": 957841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef02f11ecbda985cd8136f4f68d60364?s=128&d=identicon&r=PG", "display_name": "Arnout", "link": "https://stackoverflow.com/users/957841/arnout"}, "reply_to_user": {"reputation": 335, "user_id": 9698161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2881d4f88da4ddcd701eccf723006f?s=128&d=identicon&r=PG&f=1", "display_name": "J.Panek", "link": "https://stackoverflow.com/users/9698161/j-panek"}, "edited": false, "score": 0, "creation_date": 1525776441, "post_id": 50181409, "comment_id": 87480712, "body": "OK, edited. When generating <code>en_US.UTF-8</code>, the <code>en_US.utf8</code> locale also becomes available, right?"}, {"owner": {"reputation": 335, "user_id": 9698161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2881d4f88da4ddcd701eccf723006f?s=128&d=identicon&r=PG&f=1", "display_name": "J.Panek", "link": "https://stackoverflow.com/users/9698161/j-panek"}, "edited": false, "score": 0, "creation_date": 1525795403, "post_id": 50181409, "comment_id": 87493039, "body": "Yes, just verified it. Both locales become available."}], "tags": [], "owner": {"reputation": 2292, "user_id": 957841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef02f11ecbda985cd8136f4f68d60364?s=128&d=identicon&r=PG", "display_name": "Arnout", "link": "https://stackoverflow.com/users/957841/arnout"}, "is_accepted": true, "score": 1, "last_activity_date": 1525776392, "last_edit_date": 1525776392, "creation_date": 1525459662, "answer_id": 50181409, "question_id": 50136355, "link": "https://stackoverflow.com/questions/50136355/mbrtowc-return-1-for-non-ascii-characters-on-embedded-device-but-not-on-linux-c/50181409#50181409", "title": "mbrtowc return -1 for non ASCII characters on embedded device but not on linux computer", "body": "<p>You need to make sure that the <code>en_US.utf8</code> locale is available on the embedded Linux build. By default, Buildroot limits the locales installed on the system in two ways:</p>\n\n<ul>\n<li>Only specific locales are generated, as specified by the <code>BR2_GENERATE_LOCALE</code> configure option. By default, this list is empty, so you only get the C locale. Set this config option to <code>en_US.UTF-8</code>.</li>\n<li>All locale data is removed at the end of the build, except the ones specified in <code>BR2_ENABLE_LOCALE_WHITELIST</code>. <code>en_US</code> is already in the default value, so probably you don't need to change this.</li>\n</ul>\n\n<p>Note that if you change these configuration options, you need to make a completely clean build (with <code>make clean; make</code>) for the change to take effect.</p>\n"}], "owner": {"reputation": 335, "user_id": 9698161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2881d4f88da4ddcd701eccf723006f?s=128&d=identicon&r=PG&f=1", "display_name": "J.Panek", "link": "https://stackoverflow.com/users/9698161/j-panek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 50181409, "answer_count": 1, "score": 0, "last_activity_date": 1525776392, "creation_date": 1525269172, "last_edit_date": 1525270792, "question_id": 50136355, "link": "https://stackoverflow.com/questions/50136355/mbrtowc-return-1-for-non-ascii-characters-on-embedded-device-but-not-on-linux-c", "title": "mbrtowc return -1 for non ASCII characters on embedded device but not on linux computer", "body": "<p><strong>Task</strong></p>\n\n<p>At the moment I am porting old DOS code for a device to Linux in pure C. The text is drawn on the surface with the help of bitfonts. I wrote a function which needs the Unicode codepoint to be passed and then draws the corresponding glyph (tested and works with different ASCII and non-ASCII characters). The old source code used DOS encoding but I am trying to use UTF-8 since multilanguage support is desired. I cannot use SDL_ttf or similar functions since the produced glyphs are not \"precise\" enough. Therefore I <strong>have</strong> to stick with bitfonts.</p>\n\n<p><strong>Issue</strong></p>\n\n<p>I wrote a small C test program to test the conversion of multibyte characters to their corresponding Unicode codepoint (inspired by <a href=\"http://en.cppreference.com/w/c/string/multibyte/mbrtowc\" rel=\"nofollow noreferrer\">http://en.cppreference.com/w/c/string/multibyte/mbrtowc</a>).</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;locale.h&gt;\n#include &lt;string.h&gt;\n#include &lt;wchar.h&gt;\n#include &lt;stdint.h&gt;\n\nint main(void)\n{\n   size_t n = 0, x = 0;\n   setlocale(LC_CTYPE, \"en_US.utf8\");\n   mbstate_t state = {0};\n   char in[] = \"!\u00b0\u6c34\"; // or u8\"z\u00df\u6c34\"\n   size_t in_sz = sizeof(in) / sizeof (*in);\n\n   printf(\"Processing %zu UTF-8 code units: [ \", in_sz);\n   for(n = 0; n &lt; in_sz; ++n)\n   {\n      printf(\"%#x \", (unsigned char)in[n]);\n   }\n   puts(\"]\");\n\n   wchar_t out[in_sz];\n   char* p_in = in, *end = in + in_sz;\n   wchar_t *p_out = out;\n   int rc = 0;\n   while((rc = mbrtowc(p_out, p_in, end - p_in, &amp;state)) &gt; 0)\n   {\n       p_in += rc;\n       p_out += 1;\n   }\n\n   size_t out_sz = p_out - out + 1;\n   printf(\"into %zu wchar_t units: [ \", out_sz);\n   for(x = 0; x &lt; out_sz; ++x)\n   {\n      printf(\"%u \", (unsigned short)out[x]);\n   }\n   puts(\"]\");\n}\n</code></pre>\n\n<p>The output is as expected:</p>\n\n<p><code>Processing 7 UTF-8 code units: [ 0x21 0xc2 0xb0 0xe6 0xb0 0xb4 0 ]\ninto 4 wchar_t units: [ 33 176 27700 0 ]</code></p>\n\n<p>When I run this code on my embedded Linux device I get the following as output:</p>\n\n<p><code>Processing 7 UTF-8 code units: [ 0x21 0xc2 0xb0 0xe6 0xb0 0xb4 0 ]\ninto 2 wchar_t units: [ 33 55264 ]\n</code>\nAfter the <code>!</code> character the mbrtowc output is -1, which, according to the documentation, occurs when an encoding error happened. I tested it with different signs and this error occurs only with non-ASCII characters. Error never occurred on Linux computer</p>\n\n<p><strong>Additional Information</strong></p>\n\n<p>I am using a PFM-540I Rev. B as pc on the embedded device. The Linux distribution is built using Buildroot.</p>\n"}, {"tags": ["c", "struct", "malloc", "free", "unions"], "comments": [{"owner": {"reputation": 2811, "user_id": 8417363, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/hO0vR.png?s=128&g=1", "display_name": "Jimenemex", "link": "https://stackoverflow.com/users/8417363/jimenemex"}, "edited": false, "score": 2, "creation_date": 1525268363, "post_id": 50136053, "comment_id": 87290147, "body": "What&#39;s your problem?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 3, "creation_date": 1525268424, "post_id": 50136053, "comment_id": 87290194, "body": "unrelated, but where did you find these funny <code>TRUE</code> and <code>FALSE</code> defines? Just use <code>1</code> and <code>0</code> (or include <code>stdbool.h</code> to have a <code>bool</code> type and the constants <code>true</code> and <code>false</code>)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 2, "creation_date": 1525268559, "post_id": 50136053, "comment_id": 87290317, "body": "but then, indeed, you should describe the actual problem. And shorten the code to the minimum necessary to reproduce it. It&#39;s all explained in <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1525270504, "post_id": 50136053, "comment_id": 87291797, "body": "Which line exactly does it crash on?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1525275797, "post_id": 50136053, "comment_id": 87295411, "body": "One major problem is that you dynamically allocate the object, but <code>print_1_</code> takes the object by value. You should pass it through a pointer instead. You can pass structs by value, but it is slow and it also means that any pointer they contain will point at whatever the copied-from struct&#39;s pointer pointed at, so it is not a clean copy."}, {"owner": {"reputation": 103, "user_id": 5730322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/981519cb56e973021df2cebc25ec9114?s=128&d=identicon&r=PG&f=1", "display_name": "Valter Ekholm", "link": "https://stackoverflow.com/users/5730322/valter-ekholm"}, "edited": false, "score": 0, "creation_date": 1525288932, "post_id": 50136053, "comment_id": 87302293, "body": "@FelixPalmen I&#39;m quite sure I found it on Stack Overflow."}, {"owner": {"reputation": 103, "user_id": 5730322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/981519cb56e973021df2cebc25ec9114?s=128&d=identicon&r=PG&f=1", "display_name": "Valter Ekholm", "link": "https://stackoverflow.com/users/5730322/valter-ekholm"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1525290035, "post_id": 50136053, "comment_id": 87302862, "body": "@Lundin - I have changed the function print_1_content to be taking a pointer instead, but same thing still happens."}, {"owner": {"reputation": 103, "user_id": 5730322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/981519cb56e973021df2cebc25ec9114?s=128&d=identicon&r=PG&f=1", "display_name": "Valter Ekholm", "link": "https://stackoverflow.com/users/5730322/valter-ekholm"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1525294804, "post_id": 50136053, "comment_id": 87305139, "body": "@ChrisTurner - It crashes at *content[(*number_of_content)-1] = temp_content_item2;"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1525342179, "post_id": 50136053, "comment_id": 87322385, "body": "FYI when you copy a struct, any parts of it that are allocated memory are also copied - it doesn&#39;t allocate new memory for you - so you can&#39;t free them. So doing <code>free_1_item(&amp;temp_content_item2)</code> after the line that is crashing is going to cause you issues."}, {"owner": {"reputation": 103, "user_id": 5730322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/981519cb56e973021df2cebc25ec9114?s=128&d=identicon&r=PG&f=1", "display_name": "Valter Ekholm", "link": "https://stackoverflow.com/users/5730322/valter-ekholm"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1525552535, "post_id": 50136053, "comment_id": 87404753, "body": "@ChrisTurner - Thank you, I removed that temp_content_item2, it was unnecessary, but now the Segmentation fault (core dumped) comes in the increase method... after several read lines, I wonder why."}, {"owner": {"reputation": 103, "user_id": 5730322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/981519cb56e973021df2cebc25ec9114?s=128&d=identicon&r=PG&f=1", "display_name": "Valter Ekholm", "link": "https://stackoverflow.com/users/5730322/valter-ekholm"}, "edited": false, "score": 0, "creation_date": 1526401224, "post_id": 50136053, "comment_id": 87726154, "body": "Hello... I found another error, the &quot;free(line);&quot; in the loop for each line in open_items_file... I moved it to after the loop."}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 5730322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/981519cb56e973021df2cebc25ec9114?s=128&d=identicon&r=PG&f=1", "display_name": "Valter Ekholm", "link": "https://stackoverflow.com/users/5730322/valter-ekholm"}, "edited": false, "score": 0, "creation_date": 1617894225, "post_id": 50152317, "comment_id": 118442273, "body": "Thank you... do you know why I get downvotes here? Greetings"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "reply_to_user": {"reputation": 103, "user_id": 5730322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/981519cb56e973021df2cebc25ec9114?s=128&d=identicon&r=PG&f=1", "display_name": "Valter Ekholm", "link": "https://stackoverflow.com/users/5730322/valter-ekholm"}, "edited": false, "score": 0, "creation_date": 1617990778, "post_id": 50152317, "comment_id": 118475782, "body": "@ValterEkholm no idea (you did ask this nearly 3 years ago), but usually it is because people think the question is of poor quality"}], "tags": [], "owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "is_accepted": true, "score": 1, "last_activity_date": 1525341936, "creation_date": 1525341936, "answer_id": 50152317, "question_id": 50136053, "link": "https://stackoverflow.com/questions/50136053/whats-wrong-when-copying-my-nested-struct/50152317#50152317", "title": "Whats wrong when copying my nested struct?", "body": "<p>So the problem as you've discovered is on this line:</p>\n\n<pre><code>*content[(*number_of_content)-1] = temp_content_item2;\n</code></pre>\n\n<p>It's because of operate precedence because <code>*content[(*number_of_content)-1]</code> is not the same as <code>(*content)[(*number_of_content)-1]</code>, it's actually doing <code>*(content[(*number_of_content)-1])</code>. So your code is doing the array indexing and then de-referencing which is pointing at some random place in memory. Replace that line with this and that will fix the current problem.</p>\n\n<pre><code>(*content)[(*number_of_content)-1] = temp_content_item2;\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 5730322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/981519cb56e973021df2cebc25ec9114?s=128&d=identicon&r=PG&f=1", "display_name": "Valter Ekholm", "link": "https://stackoverflow.com/users/5730322/valter-ekholm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 50152317, "answer_count": 1, "score": -2, "last_activity_date": 1526751283, "creation_date": 1525268298, "last_edit_date": 1526751283, "question_id": 50136053, "link": "https://stackoverflow.com/questions/50136053/whats-wrong-when-copying-my-nested-struct", "title": "Whats wrong when copying my nested struct?", "body": "<p>I code C to get better in programming and study... and have program that should generate a static web-page. It also saves the project as a text-file. I have separate functions to make object (realloc and put a new struct...), and have extracted the problem-code to a short program for this occasion... It's just for reading the 'project'. When I run it says:</p>\n\n<blockquote>\n  <p>Segmentation fault (core dumped)</p>\n</blockquote>\n\n<p>in the middle of the print_1_content</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define SELL_ITEM 1\n#define PARAGRAPH_ITEM 2\n\nstruct SellItem {\n  char  title[50];\n  int nr_of_img;\n  char ** image_files;//array of strings\n};\n\nstruct ParagraphItem{\n  char * text;\n};\n\nunion ContentItem{//one of the following only\n  struct SellItem s_item;\n  struct ParagraphItem p_item;\n};\n\nstruct Content{\n  int type;//1=sellitem 2=paragraph\n  union ContentItem c_item;\n};\n\nint open_items_file(struct Content **, int *, char *);\nint free_1_item(struct Content *);\nstruct Content import_1_content(char *);\nvoid increase(struct Content**, int *);\nvoid print_1_content(struct Content *);\nstruct Content import_1_content(char *);\nint free_1_item(struct Content *);\n\nint main (void)\n{\n  struct Content * content;\n  int content_count=0;\n\n  open_items_file(&amp;content, &amp;content_count, \"all_items.txt\");   \n  return 0;\n}\n\nint open_items_file(struct Content ** content, int * number_of_content, char * filename){\n  printf(\"open_items_file %s\\n\", filename);\n\n  FILE *fp = fopen(filename, \"r\");\n  char * line = NULL;\n\n  size_t len = 0;\n  ssize_t read;\n  int counter=0;\n\n  if(fp==NULL){\n    return 0;\n  }\n  //for each row\n  while ((read = getline(&amp;line, &amp;len, fp)) != -1) {\n\n  if((line[0]=='S' || line[0]=='P') &amp;&amp; line[1]=='-'){\n    if(line[3]==':'){\n      if(line[2]=='I'){\n        increase(content, number_of_content);\n        *content[(*number_of_content)-1] = import_1_content(line);\n      }\n      else{\n        //not sell/paragraph item\n      }\n    }//end if line[3]==':'\n  }//end if line[0] =='S' eller 'P'\n\n  counter++;\n}\nfree(line);\nfclose(fp);\nreturn counter;\n}\n\nvoid increase(struct Content** content, int *nr_of_content){\n\n  if((*nr_of_content)==0){\n    *content = malloc(sizeof(struct Content));\n  }\n  else{\n    *content = realloc(*content, (*nr_of_content+1) * sizeof(struct Content));\n  }\n\n  (*nr_of_content)++;\n}\n\nvoid print_1_content(struct Content * content){\n  //Print info\n}\n\nstruct Content import_1_content(char * text_line){\n  struct Content temp_content_item;\n  char * line_pointer = text_line;\n  char c;\n  line_pointer += 4;\n  if(text_line[0]=='S'){\n\n    temp_content_item.type = SELL_ITEM;\n    temp_content_item.c_item.s_item.nr_of_img=0;\n    int i=0;\n    char * temp_text;\n\n    while(*line_pointer != '|' &amp;&amp; *line_pointer != '\\n' &amp;&amp; i &lt; sizeof(temp_content_item.c_item.s_item.title)-1){\n      temp_content_item.c_item.s_item.title[i] = *line_pointer;\n      i++;//target index\n      line_pointer++;\n    }\n  temp_content_item.c_item.s_item.title[i]='\\0';\n\n  i=0;\n\n  //maybe images?\n  short read_img_counter=0;\n  if(*line_pointer == '|'){\n    line_pointer++; //jump over '|'\n    //img-file-name separ. by ';', row ends by '\\n'\n    while(*line_pointer != '\\n'){//outer image filename -loop\n      i=0;\n      while(*line_pointer != ';' &amp;&amp; *line_pointer != '\\n'){//steps thr lett\n        c = *line_pointer;      \n        if(i==0){//first letter\n          temp_text = malloc(2);\n        }\n        else if(i&gt;0){\n          temp_text = realloc(temp_text, i+2);//extra for '\\0'\n        }\n        temp_text[i] = c;\n        line_pointer++;\n        i++;\n      }\n      if(*line_pointer==';'){//another image\n        line_pointer++;//jump over ';'\n      }\n      else{\n      }\n      temp_text[i]='\\0';\n      //allocate\n      if(read_img_counter==0){//create array\n        temp_content_item.c_item.s_item.image_files = malloc(sizeof(char*));\n      }\n      else{//extend array\n        temp_content_item.c_item.s_item.image_files = realloc(temp_content_item.c_item.s_item.image_files, sizeof(char*) * (read_img_counter+1));\n      } \n      //allocate\n      temp_content_item.c_item.s_item.image_files[read_img_counter] = calloc(i+1, 1);\n      //copy\n      strncpy(temp_content_item.c_item.s_item.image_files[read_img_counter], temp_text, strlen(temp_text));\n      read_img_counter++;\n      temp_content_item.c_item.s_item.nr_of_img = read_img_counter;\n    }\n  }\n  else{\n    printf(\"Item had no img-files\\n\");\n  }\n}\nelse{ // text_line[0]=='P'\n  temp_content_item.type = PARAGRAPH_ITEM;\n  temp_content_item.c_item.p_item.text = calloc(strlen(text_line)-4,1);\n\n\n  int i=0;\n  while(*line_pointer != '\\0' &amp;&amp; *line_pointer != '\\n'){\n    temp_content_item.c_item.p_item.text[i] = *line_pointer;\n    i++;\n    line_pointer++;\n  }\n}\nprint_1_content(&amp;temp_content_item);\nreturn temp_content_item;\n}\n\nint free_1_item(struct Content * item){\n  if(item-&gt;type==SELL_ITEM){\n    if(item-&gt;c_item.s_item.nr_of_img &gt; 0){\n    //Freeing img-names\n    for(int i=0; i&lt;item-&gt;c_item.s_item.nr_of_img; i++){\n      free(item-&gt;c_item.s_item.image_files[i]);\n    }\n  }\nreturn 1;\n}\nelse if(item-&gt;type==PARAGRAPH_ITEM){\n  //freeing p_item\n  free(item-&gt;c_item.p_item.text);\n  return 1;\n}\nelse{\n  printf(\"error: unknown item\\n\");\n}\nreturn 0;\n}\n</code></pre>\n\n<p>The text file to read (all_items.txt) is like this, ends with a new-line, for the two content types of \"sell-item\" and \"paragraph-item\":</p>\n\n<pre><code>S-I:Shirt of cotton|image1.jpg;image2.jpg;image3.jpg\nP-I:A paragraph, as they are called.\nS-I:Trousers, loose style|image4.jpg\n</code></pre>\n"}, {"tags": ["c", "macros"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1525268710, "post_id": 50136047, "comment_id": 87290423, "body": "What&#39;s the point of having this macro? Why not simply call the function?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1525268978, "post_id": 50136047, "comment_id": 87290618, "body": "This might be an <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY problem</a>. Indeed, such a macro would be completely useless. But &quot;Apply&quot; rings a bell, are you trying to implement the <a href=\"https://en.wikipedia.org/wiki/Apply\" rel=\"nofollow noreferrer\">Apply HOF</a>? This won&#39;t work with a macro."}], "answers": [{"tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": false, "score": 1, "last_activity_date": 1525268382, "creation_date": 1525268382, "answer_id": 50136086, "question_id": 50136047, "link": "https://stackoverflow.com/questions/50136047/macro-with-function-parameter-which-calls-the-function/50136086#50136086", "title": "Macro with function parameter which calls the function", "body": "<p>You probably want this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define APPLY_FUNCTION(functionname) functionname()\n\nvoid function(void) {\n  printf(\"Function called\\n\");\n}\n\nint main()\n{\n  APPLY_FUNCTION(function);\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Function called\n</code></pre>\n\n<p>With your definition:</p>\n\n<pre><code>#define APPLY_FUNCTION(function)   (function)\n</code></pre>\n\n<p>The preprocessor generates following line:</p>\n\n<pre><code>(function);\n</code></pre>\n\n<p>This is syntaxically correct, but it doesn't call the function, hence the warning.</p>\n\n<p>BTW: you should call the macro rather <code>CALL_FUNCTION</code>. You don't <em>apply</em> a function, you <em>call</em> it.</p>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 0, "last_activity_date": 1525268851, "creation_date": 1525268851, "answer_id": 50136247, "question_id": 50136047, "link": "https://stackoverflow.com/questions/50136047/macro-with-function-parameter-which-calls-the-function/50136247#50136247", "title": "Macro with function parameter which calls the function", "body": "<p>The quick &amp; dirty version is simply this:</p>\n\n<pre><code>#define APPLY_FUNCTION(function) (function)()\n</code></pre>\n\n<p>where the <code>()</code> on the end means that this is a function call. </p>\n\n<hr>\n\n<p>I would however prefer to use a type safe C11 version instead:</p>\n\n<pre><code>#define APPLY_FUNCTION(function) _Generic((function), void (*)(void): (function)())\n</code></pre>\n\n<p>This prevents the user from passing the wrong kind of function to the macro.</p>\n"}], "owner": {"reputation": 21, "user_id": 6234910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e856d16dc674cef98cb43a2fe57b3861?s=128&d=identicon&r=PG&f=1", "display_name": "John Trend", "link": "https://stackoverflow.com/users/6234910/john-trend"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1525268851, "creation_date": 1525268271, "question_id": 50136047, "link": "https://stackoverflow.com/questions/50136047/macro-with-function-parameter-which-calls-the-function", "title": "Macro with function parameter which calls the function", "body": "<p>I need a macro which simply calls the function which is passed as parameter to that macro. The function is void type with no parameter.</p>\n\n<p>For example, if I have the following function:</p>\n\n<pre><code>void function(void) {\n//doSomething\n}\n</code></pre>\n\n<p>I need a macro, APPLY_FUNCTION which is called with the <strong>function</strong> parameter and simply calls that function:</p>\n\n<pre><code>APPLY_FUNCTION(function);\n</code></pre>\n\n<p>I've tried to define the macro like:</p>\n\n<pre><code>#define APPLY_FUNCTION(function)    (function)\n</code></pre>\n\n<p>But it does not work, when I try to call the macro I am getting a \"statement with no effect\" error.</p>\n\n<p>The question is how should I define that macro?</p>\n"}, {"tags": ["c", "shell", "graphics", "terminal", "ncurses"], "answers": [{"tags": [], "owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "is_accepted": true, "score": 0, "last_activity_date": 1525271333, "creation_date": 1525271333, "answer_id": 50137143, "question_id": 50136034, "link": "https://stackoverflow.com/questions/50136034/color-only-coloring-differs-from-textcolor-coloring/50137143#50137143", "title": "Color-Only Coloring Differs From Text+Color-Coloring", "body": "<p>A <code>chtype</code> contains character and attribute data. Setting a <code>chtype</code> to <code>COLOR_PAIR(COLOR_RED)</code>, you set the attribute data, not the character data, effectively initializing the character data to <code>0</code>.</p>\n\n<p>In the ASCII character set, the character code <code>0</code> corresponds to the NULL character, usually used for terminating strings in C.</p>\n\n<p>Now, realize that it is a non-printable character and as such is represented with <em>two</em> characters in textual representation: <code>^@</code>.</p>\n\n<p><code>addch</code> and friends operate on a higher abstraction level than the mere fields you got in your terminal, they operate on characters, including non-printable characters.</p>\n\n<p>From <code>man curs_addch</code>:</p>\n\n<blockquote>\n  <p>If  <code>ch</code>  is  any  [non-whitespace] control  character, it is drawn in <code>^X</code>\n  notation.\n         Calling <code>winch</code> after adding a control  character  does  not  return  the\n         character  itself, but instead returns the <code>^</code>-representation of the control character.</p>\n</blockquote>\n\n<p>Since ncurses sees that <code>COLOR_PAIR(RED)</code> contains the character code <code>0</code>, ncurses interprets it as a non-printable character and prints it accordingly, <strong>one</strong> character in <strong>two</strong> fields.</p>\n\n<hr>\n"}], "owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 50137143, "answer_count": 1, "score": 0, "last_activity_date": 1525271333, "creation_date": 1525268234, "last_edit_date": 1525268637, "question_id": 50136034, "link": "https://stackoverflow.com/questions/50136034/color-only-coloring-differs-from-textcolor-coloring", "title": "Color-Only Coloring Differs From Text+Color-Coloring", "body": "<p>If I print a character using a <code>chtype</code>, the ncurses container object for characters, only specifying a color like <code>COLOR_PAIR(SOME_PAIR)</code>, I get two characters of color. Using <code>' ' | COLOR_PAIR(SOME_PAIR)</code>, that is, OR-ing with a character, I get just one, as I expected.</p>\n\n<p>Try it yourself (build with <code>-lncurses</code>):</p>\n\n<pre><code>#include &lt;ncurses.h&gt;\n\n#define RED 1\n\nint main(void)\n{\n        initscr();\n        start_color();\n        curs_set(0);\n        init_pair(RED, COLOR_RED, COLOR_RED);\n\n        printw(\"Multiple: \");\n        addch(COLOR_PAIR(RED));\n\n        printw(\"\\t\\tSingle: \");\n        addch(' ' | COLOR_PAIR(RED));\n\n        getch();\n        endwin();\n}\n</code></pre>\n\n<p>It looks like this for me:<br>\n<a href=\"https://i.stack.imgur.com/eeAPw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eeAPw.png\" alt=\"Output of Program\"></a></p>\n\n<p>What's happening there? How can <code>addch</code> <em>ever</em> manipulate more than one character?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 628, "user_id": 8939165, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0gchW.jpg?s=128&g=1", "display_name": "Fabio_MO", "link": "https://stackoverflow.com/users/8939165/fabio-mo"}, "edited": false, "score": 1, "creation_date": 1525266134, "post_id": 50135250, "comment_id": 87288564, "body": "Take a look at this: <a href=\"https://stackoverflow.com/questions/10468128/how-do-you-make-an-array-of-structs-in-c\" title=\"how do you make an array of structs in c\">stackoverflow.com/questions/10468128/&hellip;</a>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1525266153, "post_id": 50135250, "comment_id": 87288578, "body": "I&#39;d say no. What are you trying to achieve. This might be an <a href=\"http://xyproblem.info\" rel=\"nofollow noreferrer\">XY Problem</a>. What&#39;s wrong with using an array? You definitely need one here."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1525266251, "post_id": 50135250, "comment_id": 87288648, "body": "Normally the 1 should be replaced by <code>[i]</code> or similar, but for some secret reason you don&#39;t want to use arrays."}, {"owner": {"reputation": 145, "user_id": 9277833, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2370dac57aee12261ae08fb777efe8ef?s=128&d=identicon&r=PG&f=1", "display_name": "VallyMan", "link": "https://stackoverflow.com/users/9277833/vallyman"}, "edited": false, "score": 0, "creation_date": 1525266396, "post_id": 50135250, "comment_id": 87288736, "body": "I wanted to see if it&#39;d be possible doing it without an array, thanks though guys, il use an array"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1525427216, "post_id": 50135250, "comment_id": 87361079, "body": "when calling any of the <code>scanf()</code> family of functions: 1) always check the returned value (not the parameter values) to assure the operation was successful."}], "answers": [{"tags": [], "owner": {"reputation": 1820, "user_id": 3849158, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/q1Gcg.png?s=128&g=1", "display_name": "izlin", "link": "https://stackoverflow.com/users/3849158/izlin"}, "is_accepted": false, "score": 3, "last_activity_date": 1525266406, "creation_date": 1525266406, "answer_id": 50135431, "question_id": 50135250, "link": "https://stackoverflow.com/questions/50135250/c-replacing-variable-number/50135431#50135431", "title": "C Replacing Variable Number", "body": "<p>You could use arrays instead of a fix name.\nFor example you could use something like</p>\n\n<pre><code>int CodeNumber[4] = {0};\nfor (i = 0; i &lt; 4; i++)\n{\n    printf(\"Enter the Code for Item #%d: \",i);\n    scanf(\"%d\", &amp;CodeNumber[i]);\n}\n</code></pre>\n\n<p>In my opinion an even better approach would be to use structs that hold your 3 integers inside:</p>\n\n<pre><code>struct item {\n  int CodeNumber;\n  int ...\n}\n</code></pre>\n\n<p>And then use it like this:</p>\n\n<pre><code>struct item myItem[4];\nfor (i = 0; i &lt; 4; i++)\n{\n    printf(\"Enter the Code for Item #%d: \",i);\n    scanf(\"%d\", &amp;(myItem[i].CodeNumber));\n    ...\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3457, "user_id": 3753446, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/4Pipl.png?s=128&g=1", "display_name": "Magix", "link": "https://stackoverflow.com/users/3753446/magix"}, "is_accepted": false, "score": 0, "last_activity_date": 1525266435, "creation_date": 1525266435, "answer_id": 50135439, "question_id": 50135250, "link": "https://stackoverflow.com/questions/50135250/c-replacing-variable-number/50135439#50135439", "title": "C Replacing Variable Number", "body": "<p>You should use an array to hold your variables, like so :</p>\n\n<pre><code>int data[4] = {0};\nfor(unsigned int i = 0; i &lt; 4; i++) {\n    printf(\"Enter the data for item #%d: \",i);\n    scanf(\"%d\", &amp;data[i]);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3457, "user_id": 3753446, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/4Pipl.png?s=128&g=1", "display_name": "Magix", "link": "https://stackoverflow.com/users/3753446/magix"}, "edited": false, "score": 0, "creation_date": 1525266527, "post_id": 50135457, "comment_id": 87288823, "body": "I am not responsible for any loss of SO reputation either :)"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1525266597, "post_id": 50135457, "comment_id": 87288871, "body": "@Quentin OK, I ignored that. Thanks."}, {"owner": {"reputation": 2626, "user_id": 300290, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wI1od.png?s=128&g=1", "display_name": "Mike Andrews", "link": "https://stackoverflow.com/users/300290/mike-andrews"}, "edited": false, "score": 2, "creation_date": 1525266631, "post_id": 50135457, "comment_id": 87288891, "body": "This is the only answer that directly achieves what the OP wanted!  :)"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1525266959, "post_id": 50135457, "comment_id": 87289125, "body": "Nice. Although you might want to mention that the boost preprocessor is guaranteed to work in C."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1525267018, "post_id": 50135457, "comment_id": 87289170, "body": "@Bathsheba well, I&#39;m not sure why people believe otherwise. The first line of the documentation is <i>&quot;The Boost Preprocessing library is a library of macros, with support for preprocessor metaprogramming. The library supports both C++ and C compilation.&quot;</i>"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1525267056, "post_id": 50135457, "comment_id": 87289196, "body": "@Quentin: Well, when old cats like me see a <code>hpp</code>, we think C++ header. Just sayin&#39;."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 3, "creation_date": 1525267133, "post_id": 50135457, "comment_id": 87289249, "body": "@Bathsheba added note for old cats."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1525267210, "post_id": 50135457, "comment_id": 87289305, "body": "@Quentin: Thank you - I&#39;ve upvoted and am now waiting to pounce on the downvoter."}, {"owner": {"reputation": 145, "user_id": 9277833, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2370dac57aee12261ae08fb777efe8ef?s=128&d=identicon&r=PG&f=1", "display_name": "VallyMan", "link": "https://stackoverflow.com/users/9277833/vallyman"}, "edited": false, "score": 0, "creation_date": 1525272622, "post_id": 50135457, "comment_id": 87293324, "body": "Thank you! This is amazing haha"}], "tags": [], "owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "is_accepted": true, "score": 3, "last_activity_date": 1525268166, "last_edit_date": 1525268166, "creation_date": 1525266481, "answer_id": 50135457, "question_id": 50135250, "link": "https://stackoverflow.com/questions/50135250/c-replacing-variable-number/50135457#50135457", "title": "C Replacing Variable Number", "body": "<p>Without an array? Challenge accepted. Good thing <a href=\"https://www.boost.org/doc/libs/1_67_0/libs/preprocessor/doc/index.html\" rel=\"nofollow noreferrer\">Boost.Preprocessor</a> also works with C!</p>\n\n<pre><code>#include &lt;boost/preprocessor/repetition/repeat_from_to.hpp&gt;\n#include &lt;boost/preprocessor/cat.hpp&gt;\n\n#define LOOP_BODY(z, n, data) \\\n    printf(\"Enter the Code for Item #%d: \", n); \\\n    scanf(\"%d\", &amp;BOOST_PP_CAT(CodeNumber, n)); \\\n    printf(\"Enter the Price for Item #%d: \", n); \\\n    scanf(\"%f\", &amp;BOOST_PP_CAT(Price, n)); \\\n    printf(\"Enter the Quantity for Item #%d: \", n); \\\n    scanf(\"%d\", &amp;BOOST_PP_CAT(Quantity, n));\n\nBOOST_PP_REPEAT_FROM_TO(1, 4, LOOP_BODY, ~)\n</code></pre>\n\n<p>I am not to be held responsible for any loss of personal or professional reputation, pride, life, limb; or the happenstance of any kind of apocalypse resulting from the use of the code above.</p>\n"}], "owner": {"reputation": 145, "user_id": 9277833, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2370dac57aee12261ae08fb777efe8ef?s=128&d=identicon&r=PG&f=1", "display_name": "VallyMan", "link": "https://stackoverflow.com/users/9277833/vallyman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 50135457, "answer_count": 3, "score": 0, "last_activity_date": 1525268166, "creation_date": 1525265899, "last_edit_date": 1525266087, "question_id": 50135250, "link": "https://stackoverflow.com/questions/50135250/c-replacing-variable-number", "title": "C Replacing Variable Number", "body": "<p>Is it possible to automate this program more in order to change the variable number?</p>\n\n<pre><code>    for (i = 1; i &lt; 4; i++)\n    {\n    printf(\"Enter the Code for Item #%d: \",i);\n    scanf(\"%d\", &amp;CodeNumber1);\n    printf(\"Enter the Price for Item #%d: \",i);\n    scanf(\"%f\", &amp;Price1);\n    printf(\"Enter the Quantity for Item #%d: \", i);\n    scanf(\"%d\", &amp;Quantity1);\n    }\n</code></pre>\n\n<p>So where the variable has 1 written, would it be possible to replace it with i?</p>\n\n<p>Without using an array</p>\n"}, {"tags": ["c", "multithreading", "winapi"], "comments": [{"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 1, "creation_date": 1525266418, "post_id": 50135073, "comment_id": 87288753, "body": "you not need any <code>_aligned_malloc</code> here. and <code>long l</code> will be aligned on 4 bytes, if you not use <code>#pragma(pack, N)</code> where <code>N</code> less than 4 (2 or 1). and at all, based on your initial question you need absolute else - rundown-protection"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 1, "creation_date": 1525266453, "post_id": 50135073, "comment_id": 87288775, "body": "You can rely on this if you use aligned structures. Which is the default. Local variables are also aligned. malloc is fine also. Unless you want unusual alignment like 16 byte."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1525296835, "post_id": 50135073, "comment_id": 87305977, "body": "Inside of <code>struct S</code>, <code>long l</code> will be X bytes away from the start of <code>char c</code>, where X is the alignment of <code>struct S</code>. But, that doesn&#39;t guarantee that instances of <code>struct S</code>, like <code>an_s</code>, are allocated at aligned memory addresses, thus <code>l</code> might not always be at an aligned 32-bit boundary. It depends on the alignment used when declaring <code>struct S</code>, and the alignment of code that is allocating <code>struct S</code>."}, {"owner": {"reputation": 1006, "user_id": 2369597, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yU383.jpg?s=128&g=1", "display_name": "Wad", "link": "https://stackoverflow.com/users/2369597/wad"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1525340257, "post_id": 50135073, "comment_id": 87321072, "body": "@Remy Lebeau, I&#39;m now confused.  David Heffernan says below that structures are aligned by default.  I&#39;m not saying you are wrong, I&#39;m saying I don&#39;t know what is right :\\ Furthermore, <a href=\"https://en.wikipedia.org/wiki/Data_structure_alignment\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Data_structure_alignment</a> tells me <i>The type of each member of the structure usually has a default alignment</i> - so if the first member is aligned all other members will follow aligned after that?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1525364656, "post_id": 50135073, "comment_id": 87337250, "body": "@Wad that is for <i>default</i> alignment. Look at <code>#pragma pack</code>, <code>alignas</code>, and other similar compiler directives that affect alignment. Think what happens when a structure has alignment &lt; 4, or is contained in another structure whose alignment is &lt; 4. <code>long l</code> in <code>struct S</code> will not be aligned correctly for interlocked/atomic access."}, {"owner": {"reputation": 1006, "user_id": 2369597, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yU383.jpg?s=128&g=1", "display_name": "Wad", "link": "https://stackoverflow.com/users/2369597/wad"}, "edited": false, "score": 0, "creation_date": 1525366363, "post_id": 50135073, "comment_id": 87338258, "body": "Right, ok.  So as long as I stick to default alignment and don&#39;t go using any of those directives, I am ok - correct?"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1525371805, "post_id": 50135073, "comment_id": 87341080, "body": "for alignment you ok. for code - no"}], "answers": [{"comments": [{"owner": {"reputation": 1006, "user_id": 2369597, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yU383.jpg?s=128&g=1", "display_name": "Wad", "link": "https://stackoverflow.com/users/2369597/wad"}, "edited": false, "score": 0, "creation_date": 1525268070, "post_id": 50135765, "comment_id": 87289915, "body": "Right, thanks.  I&#39;ve discussed this with a colleague who suggests that the reason MSDN stresses that variables must be 32bit aligned is in case someone does something (stupid?) like indexing into an array of chars and casting the result as a long, then using that in the Interlocked function; would you agree?"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "reply_to_user": {"reputation": 1006, "user_id": 2369597, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yU383.jpg?s=128&g=1", "display_name": "Wad", "link": "https://stackoverflow.com/users/2369597/wad"}, "edited": false, "score": 1, "creation_date": 1525270768, "post_id": 50135765, "comment_id": 87291997, "body": "Yes, that&#39;s one possibility. Another is using packed data structures."}], "tags": [], "owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "is_accepted": true, "score": 4, "last_activity_date": 1525267415, "creation_date": 1525267415, "answer_id": 50135765, "question_id": 50135073, "link": "https://stackoverflow.com/questions/50135073/interlocked-operations-and-alignment-with-aligned-malloc/50135765#50135765", "title": "Interlocked operations and alignment with _aligned_malloc", "body": "<p>If your structures are aligned, which is the default, then each member will be aligned suitable for the member type.</p>\n\n<p>As far as <code>malloc</code> goes, the <a href=\"https://docs.microsoft.com/en-gb/cpp/build/malloc-alignment\" rel=\"nofollow noreferrer\">documentation</a> for MSVC explains that on 32 targets the memory is 8 byte aligned, on 64 bit targets it is 16 byte aligned. So you are fine to use <code>malloc</code>. </p>\n"}], "owner": {"reputation": 1006, "user_id": 2369597, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yU383.jpg?s=128&g=1", "display_name": "Wad", "link": "https://stackoverflow.com/users/2369597/wad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 50135765, "answer_count": 1, "score": 0, "last_activity_date": 1525267415, "creation_date": 1525265345, "question_id": 50135073, "link": "https://stackoverflow.com/questions/50135073/interlocked-operations-and-alignment-with-aligned-malloc", "title": "Interlocked operations and alignment with _aligned_malloc", "body": "<p>I am concerned about alignment and <code>Interlocked</code> operations.  Again.  The documentation for these functions states that the varaible we want to update should be aligned on a 32bit boundary, and that we can achieve this via <code>_aligned_malloc</code>.  Fine.</p>\n\n<p>So I have this small test program:</p>\n\n<pre><code>struct S\n{\n    char c;\n    long l;\n}an_S;\n\nprintf(\"%p, %p\", (void*)(&amp;(an_S.c)), (void*)(&amp;(an_S.l)));\n</code></pre>\n\n<p>On release mode, output from this always gives me an address of the long which is 4 bytes after the address of the char, so hence it starts on a 32bit boundary.</p>\n\n<p>1) Is this purely by chance, or can I rely on this hence no need for <code>_aligned_malloc</code>?</p>\n\n<p>2) If I have to use <code>aligned_malloc</code>, can someone clarify how to do so?  I've read the documentation at <a href=\"https://msdn.microsoft.com/en-us/library/8z34s9c6.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/8z34s9c6.aspx</a> but that doesn't seem to show how to assign a value to the memory that is 'allocated'...</p>\n\n<p>3) (Assuming I do need <code>aligned_malloc</code>) If I want an array of structures that have a long variable like the above, that needs to be operated on via an Interlocked operation, do I need to add some sort of constructor to set this up or would there be an easier way of doing it?</p>\n\n<p>4) I did a Google search for _aligned_malloc+interlockedCompareExchange and it bought back only 70 results.  That tells me that either the bulk of the code out there that uses <code>InterlockedCompareExchange</code> (62,800 results) is wrong or <code>_aligned_malloc</code> isn't necessary.  Can someone please clarify?</p>\n"}, {"tags": ["c", "gcc"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1525264592, "post_id": 50134795, "comment_id": 87287537, "body": "&quot;<i>which I belive is the correct results.</i>&quot; &lt;- I wonder why you believe this? It&#39;s clearly not the same number."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1525264623, "post_id": 50134795, "comment_id": 87287559, "body": "A cast will convert your value to a different type. The value will <b>not</b> change, as long as it can be represented in the new type."}, {"owner": {"reputation": 167, "user_id": 3523954, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/100001198725079/picture?type=large", "display_name": "user3523954", "link": "https://stackoverflow.com/users/3523954/user3523954"}, "edited": false, "score": 0, "creation_date": 1525264820, "post_id": 50134795, "comment_id": 87287691, "body": "I believe because of this explanation <a href=\"https://en.wikipedia.org/wiki/Single-precision_floating-point_format\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Single-precision_floating-point_format</a> (see section Precision limits on integer values)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1525264871, "post_id": 50134795, "comment_id": 87287744, "body": "again, casts work on the values, not on the representations."}, {"owner": {"reputation": 167, "user_id": 3523954, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/100001198725079/picture?type=large", "display_name": "user3523954", "link": "https://stackoverflow.com/users/3523954/user3523954"}, "edited": false, "score": 0, "creation_date": 1525265062, "post_id": 50134795, "comment_id": 87287874, "body": "I can leave with loosing precision but getting 0 is totally wrong... or?"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1525266404, "post_id": 50134795, "comment_id": 87288742, "body": "How can something be &quot;totally wrong&quot; if the specification doesn&#39;t say what should be correct?"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 2, "creation_date": 1525267092, "post_id": 50134795, "comment_id": 87289221, "body": "@StoryTeller: There is a specification that says what the result of representing 424967295 and printing it is: Mathematics. <a href=\"https://stackoverflow.com/users/3523954/user3523954\">user3523954</a>\u2019s statement that they can live with losing precision but getting zero is wrong is a statement that they would like C to conform more closely to mathematics. For example, the result of converting an out-of-bounds floating-point value to integer could be saturation rather than undefined. Theirs was a fairly simple statement to understand, and your response comes across as mocking or abrasive."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1525267238, "post_id": 50134795, "comment_id": 87289318, "body": "@EricPostpischil I strongly disagree. There was more than enough explanation on how C works given. If OP insists this is &quot;wrong&quot;, I don&#39;t see any way to help further."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1525267252, "post_id": 50134795, "comment_id": 87289332, "body": "@EricPostpischil - Well, I&#39;m sorry you feel this way. But the point remains that the <b>C specification</b> leaves it hanging, and for a good reason (perhaps less so now, but a very good one historically nonetheless)."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1525267462, "post_id": 50134795, "comment_id": 87289475, "body": "@FelixPalmen: It is not a dispute about how C works. <a href=\"https://stackoverflow.com/users/3523954/user3523954\">user3523954</a>\u2019s comment does not say their C implementation is wrong (does not conform with the C standard). It is a statement they wished C worked differently. If you do not see a way to help further, then consider that C is Turing complete (aside from practical limitations on resources), so whatever algorithm OP desires could be implemented in some manner. Therefore there is a way to help them achieve the behavior they want."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1525267529, "post_id": 50134795, "comment_id": 87289528, "body": "@EricPostpischil - This is where you are wrong. The OP&#39;s comment most definitely indicates they believe their implementation is doing something wrong. And as you yourself indicated, they have reason to believe it, because Mathematics disagrees with their observed result."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1525267567, "post_id": 50134795, "comment_id": 87289551, "body": "@EricPostpischil the question was &quot;<i>What happens that I get 2 different results?</i>&quot;, the answer to that is <b>undefined behavior</b> (with a lot more explanation given). OP is unwilling to accept that fact."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1525267608, "post_id": 50134795, "comment_id": 87289580, "body": "@StoryTeller: No, it does not say they believe <b>their implementation</b> is doing something wrong. No noun phase in their comment refers to their implementation. Their comment indicates they want a different result. It does not say the fault for that lack is in their implementation."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1525267692, "post_id": 50134795, "comment_id": 87289645, "body": "@EricPostpischil just read the comments on my response. This discussion is pointless I guess ..."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1525267767, "post_id": 50134795, "comment_id": 87289700, "body": "@EricPostpischil - I suppose we&#39;ll have to agree to disagree about divining intent here. Both the OP&#39;s and in my own comments."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1525267837, "post_id": 50134795, "comment_id": 87289755, "body": "@FelixPalmen: OP has not indicated unwillingness to accept that the behavior is undefined. Rather, their comments show they do not actually understand the implications of behavior being undefined. Their comments suggest they think that if the C standard does not define the behavior, the behavior falls back to something else (which it does, of course, but they think that something else is more deterministic than it is). Nobody here has yet explained to them explicitly that undefined behavior can have a wide variety of results that easily differ when small changes in environment are made."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1525267851, "post_id": 50134795, "comment_id": 87289768, "body": "@StoryTeller: I will not agree to disagree. If you cannot or will not support your position, that is your issue. Nonetheless, I recommend you work harder to comprehend other people\u2019s thinking. When something looks cryptic, like a refusal to accept something, there is often a simple explanation when seen from another view."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1525267905, "post_id": 50134795, "comment_id": 87289807, "body": "@EricPostpischil - But I will not agree with you. So we are at an impasse. Nothing left to do, I&#39;m afraid. I&#39;ll forgive your own condescending tone this time. Have a good day."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1525267959, "post_id": 50134795, "comment_id": 87289839, "body": "@EricPostpischil quoting OP: &quot;<i>I understand the meaning of undefined</i>&quot;. Further quotes include &quot;<i>I don&#39;t agree.</i>&quot; and &quot;<i>A computer and a compiler are finite state machines.</i>&quot; (well, thanks a lot!). End of discussion for me, bye."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1525267970, "post_id": 50134795, "comment_id": 87289849, "body": "@StoryTeller: Yes, there are things left to do. You could ask questions of the OP instead of making abrupt statements. You could seek the gaps in their knowledge and the causes of their beliefs and then provide explanations."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1525268099, "post_id": 50134795, "comment_id": 87289936, "body": "@FelixPalmen: The fact that somebody says they understand the meaning of a word does not mean they fully understand its implications."}], "answers": [{"comments": [{"owner": {"reputation": 167, "user_id": 3523954, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/100001198725079/picture?type=large", "display_name": "user3523954", "link": "https://stackoverflow.com/users/3523954/user3523954"}, "edited": false, "score": 0, "creation_date": 1525264935, "post_id": 50134903, "comment_id": 87287778, "body": "I don&#39;t agree. The second piece of code does not show 0."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1525264937, "post_id": 50134903, "comment_id": 87287783, "body": "I believe the result of the conversion in this case is actually undefined. If I&#39;m reading <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.3.1.4p1\" rel=\"nofollow noreferrer\">6.3.1.4p1</a> correctly."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1525264992, "post_id": 50134903, "comment_id": 87287822, "body": "@StoryTeller that&#39;s correct -- I&#39;m already assuming a lot of things here ;) I&#39;ll word it better"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1525265066, "post_id": 50134903, "comment_id": 87287878, "body": "I know I know. But I think that note needs to be added to address the OP&#39;s confusion when casting to <code>signed int</code> first. It doesn&#39;t have to be the same value."}, {"owner": {"reputation": 167, "user_id": 3523954, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/100001198725079/picture?type=large", "display_name": "user3523954", "link": "https://stackoverflow.com/users/3523954/user3523954"}, "edited": false, "score": 0, "creation_date": 1525265221, "post_id": 50134903, "comment_id": 87287975, "body": "So both pieces of code run into the undefined problem ... right? How it can be so different results?! I understand the meaning of undefined  ,,, but still"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1525265279, "post_id": 50134903, "comment_id": 87288014, "body": "how? well your compiler is doing something different when a converted float value overflows a <b>signed</b> integer type. Not much to wonder about. That&#39;s the nature of <i>undefined</i>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1525265480, "post_id": 50134903, "comment_id": 87288134, "body": "Oh and .. you don&#39;t have to &quot;agree&quot; with my answers, thanks ;) Actually, I like <a href=\"https://stackoverflow.com/a/50134990/2371524\">dbush&#39;s answer</a> better, being more exact including a standard quote ... but it basically tells you the same thing."}, {"owner": {"reputation": 167, "user_id": 3523954, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/100001198725079/picture?type=large", "display_name": "user3523954", "link": "https://stackoverflow.com/users/3523954/user3523954"}, "edited": false, "score": 0, "creation_date": 1525265902, "post_id": 50134903, "comment_id": 87288414, "body": "and you don&#39;t have to take it personally. A computer and a compiler are finite state machines. Hard to believe that &quot;undefined&quot; has so different meaning in the 2 different situations ... May be put the blame on undefined to easily ..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1525265959, "post_id": 50134903, "comment_id": 87288448, "body": "so you don&#39;t see different &quot;states&quot; for different types to convert to? Then, well, just don&#39;t believe it."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 167, "user_id": 3523954, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/100001198725079/picture?type=large", "display_name": "user3523954", "link": "https://stackoverflow.com/users/3523954/user3523954"}, "edited": false, "score": 1, "creation_date": 1525266125, "post_id": 50134903, "comment_id": 87288558, "body": "@user3523954 <i>&quot;Hard to believe that &quot;undefined&quot; has so different meaning in the 2 different situations&quot;</i> - Believe it"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": false, "score": 1, "last_activity_date": 1525266831, "last_edit_date": 1525266831, "creation_date": 1525264834, "answer_id": 50134903, "question_id": 50134795, "link": "https://stackoverflow.com/questions/50134795/cast-float-to-unsigned-int-in-c-with-gcc/50134903#50134903", "title": "cast float to unsigned int in C with gcc", "body": "<p>Assuming IEEE 754 floating point numbers, the number <code>4294967295.0</code> can't be stored exactly in a <code>float</code>. It will be stored as <code>4294967296.0</code> instead (which is 2<sup>32</sup>).</p>\n\n<p>Further assuming your <code>unsigned int</code> has 32 value bits, this is just by one too large to fit in an <code>unsigned int</code>, so the result of the conversion is undefined according to the C standard -- <code>0</code> is a \"reasonable\" outcome.</p>\n\n<p>In your second case, you have <strong>undefined behavior</strong> as well, and I have no theory what's happening here on the representation level. Fact is, the number is <strong>much</strong> too large for a 32 bit signed <code>int</code> (still assuming this is what your machine uses).</p>\n\n<hr>\n\n<p>From this remark in your question:</p>\n\n<blockquote>\n  <p>prints 2147483648 which I belive is the correct results.</p>\n</blockquote>\n\n<p>I assume you wanted to see the <em>representation</em> of your <code>float</code> in memory. Casting will <strong>convert</strong> the <strong>value</strong>, so that's not the way to see the representation. The following code would do:</p>\n\n<pre><code>int main(void) {\n    const float maxFloat = 4294967295.0;\n    unsigned char *floatBytes = &amp;maxFloat;\n    for (int i=0; i &lt; sizeof maxFloat; ++i)\n    {\n        printf(\"0x%02x \", floatBytes[i]);\n    }\n    puts(\"\");\n}\n</code></pre>\n\n<p><a href=\"https://ideone.com/99G4NF\" rel=\"nofollow noreferrer\">online example</a></p>\n"}, {"comments": [{"owner": {"reputation": 167, "user_id": 3523954, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/100001198725079/picture?type=large", "display_name": "user3523954", "link": "https://stackoverflow.com/users/3523954/user3523954"}, "edited": false, "score": 0, "creation_date": 1525266983, "post_id": 50134990, "comment_id": 87289141, "body": "I still get 0 even if a compile with -O1. Probably is because of the old gcc (4.3.4) that I have."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 167, "user_id": 3523954, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/100001198725079/picture?type=large", "display_name": "user3523954", "link": "https://stackoverflow.com/users/3523954/user3523954"}, "edited": false, "score": 1, "creation_date": 1525268181, "post_id": 50134990, "comment_id": 87290000, "body": "@user3523954 That&#39;s another example of undefined behavior.  Because the standard imposes no requirements in this case, an implementation is free to do whatever it wants at any time and it doesn&#39;t have to document exactly what it&#39;s doing."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 4, "last_activity_date": 1525266662, "last_edit_date": 1525266662, "creation_date": 1525265117, "answer_id": 50134990, "question_id": 50134795, "link": "https://stackoverflow.com/questions/50134795/cast-float-to-unsigned-int-in-c-with-gcc/50134990#50134990", "title": "cast float to unsigned int in C with gcc", "body": "<p>If you first do this:</p>\n\n<pre><code>printf(\"%f\\n\", maxFloat);\n</code></pre>\n\n<p>The output you'll get is this:</p>\n\n<pre><code>4294967296.000000\n</code></pre>\n\n<p>Assuming a <code>float</code> is implemented as an IEEE754 single precision floating point type, the value 4294967295.0 cannot be represented exactly by this type because there's aren't enough bits of precision.  The closest value it <em>can</em> store is 4294967296.0.</p>\n\n<p>Assuming an <code>int</code> (and likewise <code>unsigned int</code>) is 32 bits, the value 4294967296.0 is outside the range of both of these types.  Converting a floating point type to an integer type when the value cannot be represented in the given integer type invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.</p>\n\n<p>This is detailed in section 6.3.1.4 of the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">C standard</a> which dictates conversion from floating point types to integer types:</p>\n\n<blockquote>\n  <p><em>1</em> When a finite value of real floating type is converted to an integer type other than _Bool, the fractional part is discarded (i.e.,\n  the value is truncated toward zero). If the value of the integral part\n  cannot be represented by the integer type, the behavior is undefined.<sup>61)</sup></p>\n  \n  <p>...</p>\n  \n  <p>61) The remaindering operation performed when a value of integer type\n  is converted to unsigned type need not be performed when a value of\n  real floating type is converted to unsigned type. Thus, the range of\n  portable real floating values is (\u22121, Utype_MAX+1).</p>\n</blockquote>\n\n<p>The footnote in the above passage is referencing section 6.3.1.3, which details integer to integer conversions:</p>\n\n<blockquote>\n  <p><em>1</em> When a value with integer type is converted to another integer type other than _Bool, if the value can be represented by the new\n  type, it is unchanged.</p>\n  \n  <p><em>2</em> Otherwise, if the new type is unsigned, the value is converted by repeatedly adding or subtracting one more than the maximum value that\n  can be represented in the new type until the value is in the range of\n  the new type.</p>\n  \n  <p><em>3</em> Otherwise, the new type is signed and the value cannot be represented in it; either the result is implementation-defined or an\n  implementation-defined signal is raised.</p>\n</blockquote>\n\n<p>The behavior you see in the first code snippet is consistent with an out-of-range conversion to an unsigned type <em>when the value in question is an integer</em>, however because the value being converted has a floating point type it is undefined behavior.  </p>\n\n<p>Just because one implementation does this doesn't mean that all will.  In fact, gcc gives a different result if you change the optimization settings.</p>\n\n<p>For example, on my machine using gcc 5.4.0, given this code:</p>\n\n<pre><code>float n = 4294967296;\nprintf(\"n=%f\\n\", n);\nunsigned int a = (unsigned int) n;\nint b = (signed int) n;\nunsigned int c = (unsigned int) (signed int) n;\nprintf(\"a=%u\\n\", a);\nprintf(\"b=%d\\n\", b);\nprintf(\"c=%u\\n\", c);\n</code></pre>\n\n<p>I get the following results with -O0:</p>\n\n<pre><code>n=4294967296.000000\na=0\nb=-2147483648\nc=2147483648\n</code></pre>\n\n<p>And this with -O1:</p>\n\n<pre><code>n=4294967296.000000\na=4294967295\nb=2147483647\nc=2147483647\n</code></pre>\n\n<p>If on the other hand <code>n</code> is defined as <code>long</code> or <code>long long</code>, you would always get this output:</p>\n\n<pre><code>n=4294967296\na=0\nb=0\nc=0\n</code></pre>\n\n<p>The conversion to unsigned is well defined by the C standard as sited above, and the conversion to signed is implementation defined, which <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Integers-implementation.html\" rel=\"nofollow noreferrer\">gcc defines</a> as follows:</p>\n\n<blockquote>\n  <p><em>The result of, or the signal raised by, converting an integer to a signed integer type when the value cannot be represented in an object\n  of that type (C90 6.2.1.2, C99 and C11 6.3.1.3).</em></p>\n  \n  <p>For conversion to a type of width N, the value is reduced modulo 2^N\n  to be within range of the type; no signal is raised.</p>\n</blockquote>\n"}], "owner": {"reputation": 167, "user_id": 3523954, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/100001198725079/picture?type=large", "display_name": "user3523954", "link": "https://stackoverflow.com/users/3523954/user3523954"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7407, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1525267235, "creation_date": 1525264488, "last_edit_date": 1525266285, "question_id": 50134795, "link": "https://stackoverflow.com/questions/50134795/cast-float-to-unsigned-int-in-c-with-gcc", "title": "cast float to unsigned int in C with gcc", "body": "<p>I am using gcc to test some simple casts between float to unsigned int.</p>\n\n<p>The following piece of code gives the result 0.</p>\n\n<pre><code>const float maxFloat = 4294967295.0;\nunsigned int a = (unsigned int) maxFloat;\nprintf(\"%u\\n\", a);\n</code></pre>\n\n<p>0 is printed (which I belive is very strange).</p>\n\n<p>On the other hand the following piece of code: </p>\n\n<pre><code>const float maxFloat = 4294967295.0;\nunsigned int a = (unsigned int) (signed int) maxFloat;\nprintf(\"%u\\n\", a);\n</code></pre>\n\n<p>prints 2147483648 which I belive is the correct results.</p>\n\n<p>What happens that I get 2 different results?</p>\n"}, {"tags": ["c", "multithreading", "pthreads", "printf", "pthread-join"], "comments": [{"owner": {"reputation": 846, "user_id": 4675426, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/6a40956551f38afd8a2c712b4780d73a?s=128&d=identicon&r=PG", "display_name": "Karthick", "link": "https://stackoverflow.com/users/4675426/karthick"}, "edited": false, "score": 4, "creation_date": 1525260828, "post_id": 50133647, "comment_id": 87285267, "body": "You should wait for the threads created using <code>pthread_join</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 2, "creation_date": 1525260905, "post_id": 50133647, "comment_id": 87285317, "body": "Your program exits as soon as the <b>main thread</b> exits. Well, in your code, that happens right after you created all the other threads, while they are still blocked at <code>sleep(1)</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 2, "creation_date": 1525261042, "post_id": 50133647, "comment_id": 87285419, "body": "side notes: there are simpler  ways to initialize an array of strings, the <code>malloc()</code> can be avoided (e.g. using an array of <code>int</code>, or maybe with <code>intptr_t</code> cast to <code>void *</code>), and there&#39;s a standard define for an error exit: <code>EXIT_FAILURE</code> -- so don&#39;t define your own."}, {"owner": {"reputation": 259, "user_id": 4933847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90b35b2f40e2f0992f834b130a4ef891?s=128&d=identicon&r=PG&f=1", "display_name": "Yos", "link": "https://stackoverflow.com/users/4933847/yos"}, "edited": false, "score": 0, "creation_date": 1525261705, "post_id": 50133647, "comment_id": 87285794, "body": "@FelixPalmen thank you for the side notes, and by the way, isn&#39;t the only reason we use <code>malloc</code> is that if <code>PrintHello</code> somehow modified <code>taskIdPtr</code> then other iterations of the loop wouldn&#39;t be affected? But if <code>PrintHello</code> doesn&#39;t modify <code>taskIdPtr</code> coulnd&#39;t I pass <code>t</code> as the last argument to <code>pthread_create</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1525262067, "post_id": 50133647, "comment_id": 87286015, "body": "The reason to pass a pointer is that <code>pthreads</code> define the interface that way. <code>void *</code> has the advantage that you can actually pass (a pointer to) anything. If you&#39;d just pass a pointer to your <code>t</code>, however, by the time your thread function accesses it, it will be changed by the <code>for</code> loop. So when passing a pointer to an <code>int</code>, you have to make sure each thread gets its own instance. But <code>malloc()</code> isn&#39;t the only way to do that, you could just prepare an <code>int</code> array (like you do with your strings) and pass each thread a pointer to one of its elements."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 2, "creation_date": 1525262141, "post_id": 50133647, "comment_id": 87286059, "body": "@Yos just passing <code>t</code> (<b>not</b> a pointer) wouldn&#39;t be correct, there&#39;s no guarantee any value of an <code>int</code> &quot;survives&quot; a roundtrip when converted into a pointer and back. But there&#39;s the type <code>intptr_t</code> that gives that guarantee, so you could simply make your <code>t</code> of that type and pass it directly, cast to <code>void *</code>."}, {"owner": {"reputation": 259, "user_id": 4933847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90b35b2f40e2f0992f834b130a4ef891?s=128&d=identicon&r=PG&f=1", "display_name": "Yos", "link": "https://stackoverflow.com/users/4933847/yos"}, "edited": false, "score": 0, "creation_date": 1525262635, "post_id": 50133647, "comment_id": 87286313, "body": "@FelixPalmen I tried passing <code>&amp;t</code> to <code>pthread_create</code> and using join and I get an output of 8 strings which <b>all</b>  say &quot;Task id = 0, message = English: Hello World!&quot;. According to your explanation I&#39;d think that for example currently <code>t=0</code> then I pass it to <code>pthread_create</code> and by that time <code>t=1</code> already. Then <code>PrintHello</code> would print out the 2nd string and id=1. But this is not what&#39;s happening. Did I understand your explanation correctly?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1525263150, "post_id": 50133647, "comment_id": 87286606, "body": "@Yos I just told you passing <code>&amp;t</code> is the <b>one</b> thing you <b>can&#39;t</b> do. What I explained was an example of what could happen -- it&#39;s not possible to predict as you can&#39;t know how your OS will schedule the threads. The thing is, your <code>main()</code> continues to modify <code>t</code>, so passing a pointer to it to a thread will of course not work correctly."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1525263440, "post_id": 50133647, "comment_id": 87286762, "body": "@FelixPalmen  <code>intptr_t</code> is able to hold any pointer value. Nowhere it is said that a pointer is able to hold any <code>intptr_t</code> value. Round-trip of pointer to intptr_t to pointer is guaranteed to work. Round trip of intptr_t to pointer to intptr_t is not. In practice it will work for small enough integers of any type, but no guarantee is given,"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1525263707, "post_id": 50133647, "comment_id": 87286946, "body": "@n.m. yes, I thought it was guaranteed in POSIX though .... but can&#39;t find a reference right now, maybe I&#39;m remembering wrong here"}, {"owner": {"reputation": 259, "user_id": 4933847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90b35b2f40e2f0992f834b130a4ef891?s=128&d=identicon&r=PG&f=1", "display_name": "Yos", "link": "https://stackoverflow.com/users/4933847/yos"}, "edited": false, "score": 0, "creation_date": 1525265630, "post_id": 50133647, "comment_id": 87288229, "body": "By the way, another possible solution of the problem is to call <code>pthread_exit(NULL)</code> as the last thing from <code>main</code> without calling <code>pthread_join</code>. Then <code>main</code> will block and wait for other threads to terminate. Found this here: <a href=\"https://computing.llnl.gov/tutorials/pthreads/\" rel=\"nofollow noreferrer\">computing.llnl.gov/tutorials/pthreads</a>"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1525261071, "post_id": 50133769, "comment_id": 87285436, "body": "That&#39;s cool as a comment, but for a (good) answer, I&#39;d expect <b>some</b> explanation."}, {"owner": {"reputation": 846, "user_id": 4675426, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/6a40956551f38afd8a2c712b4780d73a?s=128&d=identicon&r=PG", "display_name": "Karthick", "link": "https://stackoverflow.com/users/4675426/karthick"}, "edited": false, "score": 0, "creation_date": 1525261601, "post_id": 50133769, "comment_id": 87285740, "body": "@FelixPalmen Edited the answer"}], "tags": [], "owner": {"reputation": 846, "user_id": 4675426, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/6a40956551f38afd8a2c712b4780d73a?s=128&d=identicon&r=PG", "display_name": "Karthick", "link": "https://stackoverflow.com/users/4675426/karthick"}, "is_accepted": true, "score": 2, "last_activity_date": 1525261491, "last_edit_date": 1525261491, "creation_date": 1525260998, "answer_id": 50133769, "question_id": 50133647, "link": "https://stackoverflow.com/questions/50133647/why-printf-is-not-working-with-multple-threads-in-c/50133769#50133769", "title": "Why printf is not working with multple threads in c?", "body": "<p>The main process is exiting before the newly created threads gets executed. So you should wait for the threads created using <code>pthread_join</code>.</p>\n\n<p>As per the man page of <code>pthread_join</code></p>\n\n<p><code>int pthread_join(pthread_t thread, void **retval);</code></p>\n\n<p>The  pthread_join()  function waits for the thread specified by thread to terminate.  If that thread has already terminated, then pthread_join() returns immediately.  The thread specified by thread must be joinable.</p>\n"}, {"tags": [], "owner": {"reputation": 3624, "user_id": 8013471, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jh4jO.jpg?s=128&g=1", "display_name": "cse", "link": "https://stackoverflow.com/users/8013471/cse"}, "is_accepted": false, "score": 4, "last_activity_date": 1525262843, "creation_date": 1525262843, "answer_id": 50134308, "question_id": 50133647, "link": "https://stackoverflow.com/questions/50133647/why-printf-is-not-working-with-multple-threads-in-c/50134308#50134308", "title": "Why printf is not working with multple threads in c?", "body": "<p>The problem is that your <em>main thread</em> completes its execution and exits before any other child thread even prints a single message(Since in your child thread you are waiting for 1 second before doing anything).</p>\n\n<p>As soon as the <em>main thread</em> exits, all other child threads also exits and you don't see any message on your screen. </p>\n\n<p>Following is an extract of linux manual page of <a href=\"http://man7.org/linux/man-pages/man3/pthread_create.3.html\" rel=\"nofollow noreferrer\"><code>pthread_create()</code></a>:</p>\n\n<blockquote>\n  <p><strong>The new thread terminates in one of the following ways</strong>:</p>\n  \n  <ul>\n  <li>It calls pthread_exit(3), specifying an exit status value that is available to another thread in the same process that calls pthread_join(3).</li>\n  <li>It returns from start_routine().  This is equivalent to calling pthread_exit(3) with the value supplied in the return statement.</li>\n  <li>It is canceled (see pthread_cancel(3)).</li>\n  <li>Any of the threads in the process calls exit(3), or <strong>the main thread performs a return from main()</strong>.  This causes the termination of all threads in the process.</li>\n  </ul>\n</blockquote>\n\n<p>To solve this problem you should use <a href=\"http://man7.org/linux/man-pages/man3/pthread_join.3.html\" rel=\"nofollow noreferrer\"><code>int pthread_join(pthread_t thread, void **retval)</code></a>.</p>\n\n<p>Following is corrected code. See it <a href=\"https://ideone.com/5tAUMd\" rel=\"nofollow noreferrer\">working here</a>:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;unistd.h&gt;\n\n#define BAD_EXIT 1\n#define NUM_TASKS 8\n\nchar * messages[NUM_TASKS];\n\nvoid * PrintHello(void * taskIdPtr) {\n    int taskId;\n    sleep(1);\n    taskId = *((int *) taskIdPtr);\n    printf(\"Task id = %d, message = %s\\n\", taskId, messages[taskId]);\n    free(taskIdPtr);\n    pthread_exit(NULL);\n}\nint main(int argc, char ** argv) {\n    pthread_t threads[NUM_TASKS];\n    int * taskIdPtr;\n    int rc, t;\n    messages[0] = \"English: Hello World!\";\n    messages[1] = \"French: Bonjour, le monde!\";\n    messages[2] = \"Spanish: Hola al mundo\";\n    messages[3] = \"Klingon: Nuq neH!\";\n    messages[4] = \"German: Guten Tag, Welt!\";\n    messages[5] = \"Russian: Zdravstvytye, mir!\";\n    messages[6] = \"Japan: Sekai e konnichiwa!\";\n    messages[7] = \"Latin: Orbis, te saluto!\";\n\n    for(t = 0; t &lt; NUM_TASKS; t++) {\n        taskIdPtr = (int *) malloc(sizeof(int));\n        *taskIdPtr = t;\n        printf(\"Creating thread %d\\n\", t);\n        rc = pthread_create(&amp;threads[t], NULL, PrintHello, (void *) taskIdPtr);\n        if(rc) {\n            perror(\"Error :\");\n            exit(BAD_EXIT);\n        }\n    }\n\n    for(t = 0; t &lt; NUM_TASKS; t++)\n    {\n        pthread_join(threads[t], NULL);\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 259, "user_id": 4933847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90b35b2f40e2f0992f834b130a4ef891?s=128&d=identicon&r=PG&f=1", "display_name": "Yos", "link": "https://stackoverflow.com/users/4933847/yos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 478, "favorite_count": 0, "accepted_answer_id": 50133769, "answer_count": 2, "score": 0, "last_activity_date": 1525266160, "creation_date": 1525260641, "last_edit_date": 1525266160, "question_id": 50133647, "link": "https://stackoverflow.com/questions/50133647/why-printf-is-not-working-with-multple-threads-in-c", "title": "Why printf is not working with multple threads in c?", "body": "<p>In the code below I create 8 threads and each of those prints a string and its id. However, I don't see any <code>printf</code> output in <code>stdout</code> from <code>PrintHello</code> function. One strange thing that is happening is that if run the <code>main</code> using debugger (CLion) <code>printf</code> indeed outputs the intended output. I actually suspect that no code inside  <code>PrintHello</code> function is run, not just <code>printf</code>. What could be causing this?</p>\n\n<p>Also according to this <a href=\"https://stackoverflow.com/questions/23586682/how-to-use-printf-in-multiple-threads\">answer</a> <code>printf</code> is thread-safe so it shouldn't be an issue of different threads competing for <code>stdout</code>.</p>\n\n<p>This is the code (it as adapted from these <a href=\"https://courses.engr.illinois.edu/cs241/fa2010/ppt/10-pthread-examples.pdf\" rel=\"nofollow noreferrer\">slides</a>):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;ntsid.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;unistd.h&gt;\n\n#define BAD_EXIT 1\n#define NUM_TASKS 8\n\nchar * messages[NUM_TASKS];\n\nvoid * PrintHello(void * taskIdPtr) {\n    int taskId;\n    sleep(1);\n    taskId = *((int *) taskIdPtr);\n    printf(\"Task id = %d, message = %s\\n\", taskId, messages[taskId]);\n    free(taskIdPtr);\n    pthread_exit(NULL);\n}\nint main(int argc, char ** argv) {\n    pthread_t threads[NUM_TASKS];\n    int * taskIdPtr;\n    int rc, t;\n    messages[0] = \"English: Hello World!\";\n    messages[1] = \"French: Bonjour, le monde!\";\n    messages[2] = \"Spanish: Hola al mundo\";\n    messages[3] = \"Klingon: Nuq neH!\";\n    messages[4] = \"German: Guten Tag, Welt!\";\n    messages[5] = \"Russian: Zdravstvytye, mir!\";\n    messages[6] = \"Japan: Sekai e konnichiwa!\";\n    messages[7] = \"Latin: Orbis, te saluto!\";\n\n    for(t = 0; t &lt; NUM_TASKS; t++) {\n        taskIdPtr = (int *) malloc(sizeof(int));\n        *taskIdPtr = t;\n        printf(\"Creating thread %d\\n\", t);\n        rc = pthread_create(&amp;threads[t], NULL, PrintHello, (void *) taskIdPtr);\n        if(rc) {\n            perror(\"Error :\");\n            exit(BAD_EXIT);\n        }\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "if-statement", "while-loop"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1525260859, "post_id": 50133588, "comment_id": 87285286, "body": "This is probably the perfect time to <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">learn how to debug your programs</a>."}, {"owner": {"reputation": 434, "user_id": 9547778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c69e098ba8f12c4b7879e5b240442055?s=128&d=identicon&r=PG&f=1", "display_name": "Zoey Malkov", "link": "https://stackoverflow.com/users/9547778/zoey-malkov"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1525261132, "post_id": 50133588, "comment_id": 87285473, "body": "@Someprogrammerdude Spent about 30 minutes trying to. Im stuck"}, {"owner": {"reputation": 2531, "user_id": 3160529, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/409ccefcab7337f7dc87a4cac668de1d?s=128&d=identicon&r=PG", "display_name": "Shubham", "link": "https://stackoverflow.com/users/3160529/shubham"}, "edited": false, "score": 0, "creation_date": 1525261755, "post_id": 50133588, "comment_id": 87285825, "body": "@ZoeyMalkov Can you explain your logic?"}, {"owner": {"reputation": 434, "user_id": 9547778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c69e098ba8f12c4b7879e5b240442055?s=128&d=identicon&r=PG&f=1", "display_name": "Zoey Malkov", "link": "https://stackoverflow.com/users/9547778/zoey-malkov"}, "reply_to_user": {"reputation": 2531, "user_id": 3160529, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/409ccefcab7337f7dc87a4cac668de1d?s=128&d=identicon&r=PG", "display_name": "Shubham", "link": "https://stackoverflow.com/users/3160529/shubham"}, "edited": false, "score": 0, "creation_date": 1525262309, "post_id": 50133588, "comment_id": 87286149, "body": "@Shubham It finds the smallest and largest number from the user input (so 1 and 8). It then uses the smallest number (1) and goes through the array to find if there is a smallest_number + 1. So basically its looking for the number 2 in the array. If it finds the number 2, it does nothing until int i is greater than the array size (length). Once i is greater than the array size, int i resets to 0 and starts looking for a number in the array which is 2 + 1 (aka 3). So it repeats the process and tries to find the number 3."}, {"owner": {"reputation": 434, "user_id": 9547778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c69e098ba8f12c4b7879e5b240442055?s=128&d=identicon&r=PG&f=1", "display_name": "Zoey Malkov", "link": "https://stackoverflow.com/users/9547778/zoey-malkov"}, "reply_to_user": {"reputation": 2531, "user_id": 3160529, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/409ccefcab7337f7dc87a4cac668de1d?s=128&d=identicon&r=PG", "display_name": "Shubham", "link": "https://stackoverflow.com/users/3160529/shubham"}, "edited": false, "score": 0, "creation_date": 1525262394, "post_id": 50133588, "comment_id": 87286191, "body": "@Shubham If it doesn&#39;t find the number, then it prints the number out and then once int i is greater than the array size, it resets int i to 0"}], "answers": [{"tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": false, "score": 0, "last_activity_date": 1525261599, "creation_date": 1525261599, "answer_id": 50133934, "question_id": 50133588, "link": "https://stackoverflow.com/questions/50133588/filling-in-missing-numbers-from-an-array/50133934#50133934", "title": "Filling in missing numbers from an array", "body": "<p>You're doing a lot of thing I don't understand. Anyway, here's a quick attempt:</p>\n\n<pre><code>static void print_with_missing(const int *array, size_t length)\n{\n    int last = *array;\n    printf(\"%d\", last);\n    for (size_t i = 1; i &lt; length;)\n    {\n        while (array[i] != last + 1)\n        {\n            printf(\" %d\", ++last);\n        }\n        printf(\" %d\", array[i]);\n        last = array[i++];\n    }\n}\n</code></pre>\n\n<p>if called with your sample array (<code>{ 1, 2, 5, 7, 9 }</code>), the output is:</p>\n\n<pre><code>1 2 3 4 5 6 7 8 9\n</code></pre>\n\n<p>Note: it requires the input to be sorted, which seems to make sense. If you don't want to expose that, just call <code>qsort()</code> first inside the function, of course.</p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 969721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c24c2449277543103cc7c6a5307b11da?s=128&d=identicon&r=PG", "display_name": "Skeik", "link": "https://stackoverflow.com/users/969721/skeik"}, "is_accepted": false, "score": 1, "last_activity_date": 1525261850, "creation_date": 1525261850, "answer_id": 50134015, "question_id": 50133588, "link": "https://stackoverflow.com/questions/50133588/filling-in-missing-numbers-from-an-array/50134015#50134015", "title": "Filling in missing numbers from an array", "body": "<p>When you're having trouble with logic it's best to just go through it line by line and see what would happen. I don't quite understand what you're trying to do in the loop so let's go through it block by block and pretend we're using 1, 2, 5, 7, 9 as an input.</p>\n\n<pre><code>while(start_num &lt;= big_num_answer) {\n</code></pre>\n\n<p>Pretty straightforward. The while loop keeps going while start_num is below or equal to the largest number. start_num, in this case, is 1. </p>\n\n<pre><code>if(numbers[i] == start_num + 1) {\n    start_num += 1;\n    has_been_used = 1;\n}\n</code></pre>\n\n<p>i is 0, so this line evals to if(1==2). It's skipped. </p>\n\n<pre><code>else if(i &gt;= length &amp;&amp; has_been_used == 0) \n{\n    printf(\"%d\", start_num + 1);\n}\n</code></pre>\n\n<p>This evals to if(0 >= 5 AND 0=0). It's skipped and no numbers are outputted.</p>\n\n<pre><code>i++;\nif (i &gt; length) {\n    i = 0;\n}\n</code></pre>\n\n<p>i now is 1. Let's go through the loop again. </p>\n\n<pre><code>if(numbers[i] == start_num + 1) {\n    start_num += 1;\n    has_been_used = 1;\n}\n</code></pre>\n\n<p>Evals to if(2==2). So now start_num = 2, and has_been_used = 1. </p>\n\n<pre><code>else if(i &gt;= length &amp;&amp; has_been_used == 0) \n{\n    printf(\"%d\", start_num + 1);\n}\n</code></pre>\n\n<p>The else block is skipped entirely because the other condition was hit. And this block will never be hit again, because has_been_used has been set to 1 and you have no code that sets has_been_used back to 0. Since we ran through it now we can see at least one reason why the code doesn't output anything.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": false, "score": 0, "last_activity_date": 1525263335, "creation_date": 1525263335, "answer_id": 50134460, "question_id": 50133588, "link": "https://stackoverflow.com/questions/50133588/filling-in-missing-numbers-from-an-array/50134460#50134460", "title": "Filling in missing numbers from an array", "body": "<p>Here's another not too complicated idea of doing that without requiring sorted input, but providing sorted output:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;limits.h&gt;\n#include &lt;stdlib.h&gt;\n\nint numbers[1024];\nint max = INT_MIN;\nint min = INT_MAX;\nsize_t n;\n\nint main(void) {\n    while (n &lt; 1024)\n    {\n        // use something better then scanf for \"production quality\" code\n        if (scanf(\"%d\", numbers + n++) != 1) break;\n        if (numbers[n-1] &gt; max) max = numbers[n-1];\n        if (numbers[n-1] &lt; min) min = numbers[n-1];\n    }\n    if (max &gt; min &amp;&amp; max - min)\n    {\n        size_t rangesize = max - min - 1;\n\n        // use an array of \"markers\" for the numbers present in the input\n        char *used = calloc(1, rangesize);\n        if (!used) return 1;\n\n        // set the markers\n        for (size_t i = 0; i &lt; n; ++i)\n        {\n            if (numbers[i] &gt; min &amp;&amp; numbers[i] &lt; max)\n            {\n                used[numbers[i]-min-1] = 1;\n            }\n        }\n\n        // and use them for output\n        for (size_t i = 0; i &lt; rangesize; ++i)\n        {\n            if (!used[i])\n            {\n                printf(\"%d \", (int)i + min + 1);\n            }\n        }\n\n        puts(\"\");\n        free(used);\n    }\n}\n</code></pre>\n\n<p><a href=\"https://ideone.com/LLHNYs\" rel=\"nofollow noreferrer\">online demo</a></p>\n"}, {"tags": [], "owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "is_accepted": false, "score": 0, "last_activity_date": 1525263382, "creation_date": 1525263382, "answer_id": 50134470, "question_id": 50133588, "link": "https://stackoverflow.com/questions/50133588/filling-in-missing-numbers-from-an-array/50134470#50134470", "title": "Filling in missing numbers from an array", "body": "<p>Let's disect this:</p>\n\n<pre><code>int start_num = small_num_answer;\nwhile(start_num &lt;= big_num_answer) {\n</code></pre>\n\n<p>you want to loop from the smallest to the biggest number so far so good.</p>\n\n<pre><code>    if(numbers[i] == start_num + 1) {\n</code></pre>\n\n<p>trouble starts here I am not entirly sure but I think you want to check, whether the next number is also in the array but you only check <code>numbers[i]</code> instead of all elements of <code>numbers</code>.</p>\n\n<pre><code>        start_num += 1;\n        has_been_used = 1;\n</code></pre>\n\n<p>If the current number is there you increase your integer to search by one. And set a flag that it is in the array. But you never reset this value. So this will always be 1.</p>\n\n<pre><code>    } else if(i &gt;= length &amp;&amp; has_been_used == 0) {\n        printf(\"%d\", start_num + 1);\n    }\n</code></pre>\n\n<p>here you check if the array is still in bounds (way to late as you used <code>numbers[i]</code> without a check before. And check the (not working) flag, whether the number was in the input.</p>\n\n<pre><code>    i++;\n    if (i &gt; length) {\n        i = 0;\n    }\n}\n</code></pre>\n\n<p>At last you check that <code>i</code>is not larger then <code>length</code>, which is a good idea but <code>i = length</code> is already out of bounds as we start to count at <code>0</code>.</p>\n\n<hr>\n\n<p>I try to give you something in the spirit of your approach, but you will need a second loop to iterate <code>i</code>through the whole array.</p>\n\n<pre><code>while(start_num &lt; big_num_answer) {\n\n  for(i = 0; i &lt; length; i++){ //iterate though the whole array\n\n    if(numbers[i] == start_num + 1) {\n        has_been_used = 1;\n    }\n  }\n\n  if (has_been_used == 0){\n    printf(\"%d\", start_num + 1); //print if not found\n  }\n\n  has_been_used = 0; // reset flag\n  start_num++; // next elelemt\n}\n</code></pre>\n"}], "owner": {"reputation": 434, "user_id": 9547778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c69e098ba8f12c4b7879e5b240442055?s=128&d=identicon&r=PG&f=1", "display_name": "Zoey Malkov", "link": "https://stackoverflow.com/users/9547778/zoey-malkov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 282, "favorite_count": 0, "answer_count": 4, "score": -1, "last_activity_date": 1525263382, "creation_date": 1525260452, "question_id": 50133588, "link": "https://stackoverflow.com/questions/50133588/filling-in-missing-numbers-from-an-array", "title": "Filling in missing numbers from an array", "body": "<p>I am trying to fill in the missing numbers from a user input (which is stored in an array. For example, if the user inputs 9, 5, 2, 7, 1. My program must output the missing numbers which are 3, 4, 6, 8.</p>\n\n<p>You can see the missing numbers are bolded: 1, 2, <strong>3</strong>, <strong>4</strong>, 5, <strong>6</strong>, 7, <strong>8</strong></p>\n\n<p>However, my code doesn't seem to run. The while loop doesn't function. I feel like my logic is working, but its not outputting anything.</p>\n\n<pre><code>void missing_num(int length, int numbers[]) { // length is the length of the array\n\n// A function which finds the biggest number the user inputed\nint big_num_answer = biggest_num(length, numbers);\n\n// A functon which finds the smallest number the user inputed\nint small_num_answer = smallest_num(length, numbers);\n\nint has_been_used = 0;\nint i = 0;\nint start_num = small_num_answer;\nwhile(start_num &lt;= big_num_answer) {\n\n    if(numbers[i] == start_num + 1) {\n        start_num += 1;\n        has_been_used = 1;\n    } else if(i &gt;= length &amp;&amp; has_been_used == 0) {\n        printf(\"%d\", start_num + 1);\n    }\n\n    i++;\n    if (i &gt; length) {\n        i = 0;\n    }\n}\n\n}\n</code></pre>\n"}, {"tags": ["c", "profiling", "papi"], "comments": [{"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1525268988, "post_id": 50133099, "comment_id": 87290625, "body": "Have you used a debugger? What is the stack of the application while it freezes?"}, {"owner": {"reputation": 247, "user_id": 2174898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2239ce833a27b06e295754dac8ceb501?s=128&d=identicon&r=PG", "display_name": "dbilid", "link": "https://stackoverflow.com/users/2174898/dbilid"}, "reply_to_user": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1525270766, "post_id": 50133099, "comment_id": 87291995, "body": "I don&#39;t know how to do that since I cannot interrupt the execution of the program, in order for instance to execute command &quot;where&quot; in gdb"}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1525278417, "post_id": 50133099, "comment_id": 87297036, "body": "Just run the program with <code>gdb .&#47;a.out</code> and interrupt it with ctrl+c."}, {"owner": {"reputation": 247, "user_id": 2174898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2239ce833a27b06e295754dac8ceb501?s=128&d=identicon&r=PG", "display_name": "dbilid", "link": "https://stackoverflow.com/users/2174898/dbilid"}, "reply_to_user": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1525281501, "post_id": 50133099, "comment_id": 87298600, "body": "I cannot do that. Program is not responding to interrupt, and also if I kill the terminal, process becomes defunct."}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1525282424, "post_id": 50133099, "comment_id": 87299100, "body": "Have you tried exactly what I suggested? Typically <code>gdb</code> gets the interrupt and is going to tell you about the program&#39;s stack."}, {"owner": {"reputation": 247, "user_id": 2174898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2239ce833a27b06e295754dac8ceb501?s=128&d=identicon&r=PG", "display_name": "dbilid", "link": "https://stackoverflow.com/users/2174898/dbilid"}, "reply_to_user": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1525291634, "post_id": 50133099, "comment_id": 87303641, "body": "Yes, I tried but nothing happens.  By the way, I added kernel messages  in case it helps"}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1525333125, "post_id": 50133099, "comment_id": 87316680, "body": "Looks like a deadlock in the kernel. Shouldn&#39;t jesse be at least on 3.16.56-1?"}, {"owner": {"reputation": 247, "user_id": 2174898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2239ce833a27b06e295754dac8ceb501?s=128&d=identicon&r=PG", "display_name": "dbilid", "link": "https://stackoverflow.com/users/2174898/dbilid"}, "reply_to_user": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1525431584, "post_id": 50133099, "comment_id": 87363608, "body": "Yes, it should. I had an issue with a package that was keeping my dist-upgrade back. I fixed that, but the problem still remains with kernel 3.16.56-1. On the other hand, upgrading to Debian 9 with kernel 4.9.88-1 fixes the problem."}], "owner": {"reputation": 247, "user_id": 2174898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2239ce833a27b06e295754dac8ceb501?s=128&d=identicon&r=PG", "display_name": "dbilid", "link": "https://stackoverflow.com/users/2174898/dbilid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1525291445, "creation_date": 1525259015, "last_edit_date": 1525291445, "question_id": 50133099, "link": "https://stackoverflow.com/questions/50133099/execution-freezes-upon-calling-papi-start-counters", "title": "Execution freezes upon calling PAPI_start_counters", "body": "<p>I am facing a strange issue such that program freezes upon calling PAPI_start_counters function.</p>\n\n<p>For example, when I am using code from <a href=\"https://github.com/tpatki/papi-rapl/blob/master/src/examples/high_level.c\" rel=\"nofollow noreferrer\" title=\"here\">here</a> and after compiling as \"gcc -o papitest high_level.c -lpapi\" and running ./papitest I am getting output:\nThere are 11 counters in this system\n and then nothing. If I try to kill program with <kbd>Ctrl</kbd>+<kbd>C</kbd> nothing happens and also nothing happens with kill -9. My system is as follows:</p>\n\n<p>Operating System: Debian GNU/Linux 8 (jessie)\nKernel: Linux 3.16.0-5-amd64\nArchitecture: x86-64\nWith 32 cores of Intel(R) Xeon(R) CPU E5-4603 v2 @ 2.20GHz</p>\n\n<p>I remember using PAPI in the past on the same server running an older kernel.</p>\n\n<p>EDIT: here is what shows up when running dmesg:</p>\n\n<pre><code>[ 2039.025224] INFO: task papitest:2022 blocked for more than 120 seconds.\n[ 2039.025284]       Tainted: G         C    3.16.0-5-amd64 #1\n[ 2039.025335] \"echo 0 &gt; /proc/sys/kernel/hung_task_timeout_secs\" disables this message.\n[ 2039.025421] papitest        D ffff88081daf0050     0  2022   2008 0x00000000\n[ 2039.025427]  ffff88081fb180d0 0000000000000086 0000000000013b40 ffff88081e823fd8\n[ 2039.025431]  0000000000013b40 ffff88081daf0050 ffff88103f4619f8 ffff88081e823de0\n[ 2039.025435]  ffff88103f4619fc ffff88081daf0050 00000000ffffffff ffff88103f461a00\n[ 2039.025439] Call Trace:\n[ 2039.025447]  [&lt;ffffffff815227c5&gt;] ? schedule_preempt_disabled+0x25/0x70\n[ 2039.025452]  [&lt;ffffffff81524263&gt;] ? __mutex_lock_slowpath+0xd3/0x1d0\n[ 2039.025457]  [&lt;ffffffff81133fc0&gt;] ? remote_function+0x40/0x50\n[ 2039.025461]  [&lt;ffffffff8152437b&gt;] ? mutex_lock+0x1b/0x2a\n[ 2039.025466]  [&lt;ffffffff81134800&gt;] ? perf_event_read_value+0x30/0xd0\n[ 2039.025470]  [&lt;ffffffff811348cd&gt;] ? __perf_read_group_add+0x2d/0x190\n[ 2039.025475]  [&lt;ffffffff81136e1a&gt;] ? _perf_event_disable+0x5a/0xb0\n[ 2039.025479]  [&lt;ffffffff8113500f&gt;] ? perf_read+0xbf/0x250\n[ 2039.025483]  [&lt;ffffffff811afca3&gt;] ? vfs_read+0x93/0x170\n[ 2039.025486]  [&lt;ffffffff811b08d2&gt;] ? SyS_read+0x42/0xa0\n[ 2039.025492]  [&lt;ffffffff81525c00&gt;] ? system_call_fast_compare_end+0x10/0x15\n</code></pre>\n"}, {"tags": ["c", "c11"], "comments": [{"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 1, "creation_date": 1525259028, "post_id": 50132988, "comment_id": 87284049, "body": "Before doing <code>free(test);</code>, you just do <code>free(test_c);</code>. &quot;But what if it wasn&#39;t allocated?&quot; - what if <code>test</code> isn&#39;t allocated? There&#39;s general way to identify whether <code>test-&gt;test_c</code> is &quot;freeable&quot;. You need to manage that yourself."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1525259986, "post_id": 50132988, "comment_id": 87284665, "body": "Also see (possible dup): <a href=\"https://stackoverflow.com/q/13877546/1275169\">does free() follow pointers?</a>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1525362276, "post_id": 50132988, "comment_id": 87335850, "body": "As a rule of thumb, the code doing the allocation is the one responsible for freeing. So the correct way to design a program like this would be to create two files test.h and test.c. In test.c, one function &quot;test_allocate&quot; does the allocation and one function &quot;test_free&quot; does the freeing. The caller is responsible for calling both those functions, but not responsible for knowing the inner workings of the struct."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5381889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/700f119cbd12e1a4a64f63236d5964e3?s=128&d=identicon&r=PG&f=1", "display_name": "user923814624", "link": "https://stackoverflow.com/users/5381889/user923814624"}, "edited": false, "score": 0, "creation_date": 1525259302, "post_id": 50133094, "comment_id": 87284218, "body": "Thank you! I was missing the part about assigning NULL to a reference to prevent an attempt in deallocation of unallocated pointer. Now it&#39;s clear."}], "tags": [], "owner": {"reputation": 789, "user_id": 7868795, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/471c6f01b994a5aadf85dc6cfec40fc4?s=128&d=identicon&r=PG", "display_name": "Ra&#39;Jiska", "link": "https://stackoverflow.com/users/7868795/rajiska"}, "is_accepted": true, "score": 3, "last_activity_date": 1525258999, "creation_date": 1525258999, "answer_id": 50133094, "question_id": 50132988, "link": "https://stackoverflow.com/questions/50132988/how-to-correctly-free-a-structure-returned-from-a-function/50133094#50133094", "title": "How to correctly free a structure returned from a function?", "body": "<p>A structure can be deallocated just like any other pointer. You however have to ensure that all its allocated members are freed before doing so (failing to do so would most likely result in a memory leak of the members of your structure).</p>\n\n<pre><code>typedef struct test_t{\n    char *test_c;\n} test_t;\n\nint testFunc(test_t** output){\n    test_t* testStruct = malloc(sizeof(testStruct));\n    char* buf = malloc(sizeof(char)  * 5);\n    strcpy(buf, \"test\");\n    testStruct-&gt;test_c = buf;\n    *output = testStruct;\n    return 0;\n}\n\nint main() {\n    test_t* test;\n    testFunc(&amp;test);\n    printf(\"%s\\n\",test-&gt;test_c);\n    free(test-&gt;test_c);\n    free(test);\n    return 0;\n}\n</code></pre>\n\n<p>In case your structure doesn't allocate all of its elements, you can set their pointer to <code>NULL</code>, which once passed to <code>free (3)</code> would be equivalent to doing nothing.</p>\n"}, {"tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1525259240, "creation_date": 1525259240, "answer_id": 50133169, "question_id": 50132988, "link": "https://stackoverflow.com/questions/50132988/how-to-correctly-free-a-structure-returned-from-a-function/50133169#50133169", "title": "How to correctly free a structure returned from a function?", "body": "<blockquote>\n  <p>But how to do it properly? Should I just deallocate test_c explicitly first? But what if it wasn't allocated?</p>\n</blockquote>\n\n<p>Basic rule of thumb: if you write a function that allocates a resource, write a complementary one that deallocates it. So when applied to your example:</p>\n\n<pre><code>void testFree(test_t* toFree) {\n    free(toFree-&gt;test_c);\n    free(toFree);\n}\n</code></pre>\n\n<p>... and then ...</p>\n\n<pre><code>printf(\"%s\\n\",test-&gt;test_c);\ntestFree(test);\n</code></pre>\n\n<p>If <code>testFree</code> is implemented and exposed along with <code>testFunc</code>, the callers don't need to know your implementation details. The functions themselves, being part of the same library, will make sure the invariants are maintained properly. Should you ever switch allocation schemes, no calling code needs to change. You would just modify <code>testFree</code> to go along with the new <code>testFunc</code> and re-link.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8906987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b0f2439fdecb204bb999e5921bd798?s=128&d=identicon&r=PG&f=1", "display_name": "PabloML", "link": "https://stackoverflow.com/users/8906987/pabloml"}, "is_accepted": false, "score": 0, "last_activity_date": 1525259249, "creation_date": 1525259249, "answer_id": 50133175, "question_id": 50132988, "link": "https://stackoverflow.com/questions/50132988/how-to-correctly-free-a-structure-returned-from-a-function/50133175#50133175", "title": "How to correctly free a structure returned from a function?", "body": "<p>First, you'll need to free the memory you,ve allocated for the char in the struct given that you have initialized it. Otherwise, you'll get an error so before any free instruction you should check whether the pointer that holds the memory position for test_p you're trying to free isn't NULL. Besides, the free instruction should take *test as a parameter instead of test. </p>\n"}, {"tags": [], "owner": {"reputation": 827, "user_id": 7383242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c65444c41048c45464ae10a9cafa0c41?s=128&d=identicon&r=PG&f=1", "display_name": "medalib", "link": "https://stackoverflow.com/users/7383242/medalib"}, "is_accepted": false, "score": 0, "last_activity_date": 1525260204, "last_edit_date": 1525260204, "creation_date": 1525259434, "answer_id": 50133233, "question_id": 50132988, "link": "https://stackoverflow.com/questions/50132988/how-to-correctly-free-a-structure-returned-from-a-function/50133233#50133233", "title": "How to correctly free a structure returned from a function?", "body": "<blockquote>\n  <p>Should I just deallocate test_c explicitly first?</p>\n</blockquote>\n\n<p>Yes, you have to free <code>test_c</code> first, because, if you free <code>test</code>, you will lose the reference to <code>test_c</code>.</p>\n\n<blockquote>\n  <p>But what if it wasn't allocated?</p>\n</blockquote>\n\n<p>As you are returning <code>int</code> from <code>testFunc</code>, you can use it as a state of the allocation of your structure (although, returning a pointer would be a better idea IMHO):</p>\n\n<pre><code>int testFunc(test_t** output){\n    test_t* testStruct = malloc(sizeof(testStruct));\n    if (testStruct == NULL)\n    /* testStruct allocation failure. */\n         return -1;\n    char* buf = malloc(sizeof(char)  * 5);\n    if (buf == NULL) {\n    /* buf allocation failure. */\n         free(testStruct);\n         return -1;\n    }\n    strcpy(buf, \"test\");\n    testStruct-&gt;test_c = buf;\n    *output = testStruct;\n    return 0;\n}\n</code></pre>\n\n<p>After that, you check <code>testFunc</code> failure:</p>\n\n<pre><code>/* Check for allocation failure. */\nif (testFunc(&amp;test) == -1) {\n    fprintf(stderr, \"Allocation error\");\n    exit(EXIT_FAILURE);\n}\n/* Allocation succeeded. */\nprintf(\"%s\\n\",test-&gt;test_c);\nfree(test-&gt;test_c);\nfree(test)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 45031, "user_id": 213136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b84a36c241e04175fcec402dac43018?s=128&d=identicon&r=PG", "display_name": "Bob Jarvis - Reinstate Monica", "link": "https://stackoverflow.com/users/213136/bob-jarvis-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1525259519, "creation_date": 1525259519, "answer_id": 50133264, "question_id": 50132988, "link": "https://stackoverflow.com/questions/50132988/how-to-correctly-free-a-structure-returned-from-a-function/50133264#50133264", "title": "How to correctly free a structure returned from a function?", "body": "<p>You should have a procedure which allocates and initializes an instance of <code>test_t</code>. In C++ or other object-oriented languages this would be a constructor. In C you have to roll your own - something similar to the following:</p>\n\n<pre><code>test_t *create_test_t(char *init_test_c)\n  {\n  test_t *tt;\n\n  tt = malloc(sizeof(test_t));\n  if(init_test_c != NULL)\n    {\n    tt-&gt;test_c = malloc(strlen(init_test_c)+1);\n    strcpy(tt-&gt;test_c, init_test_c);\n    }\n  else\n    tt-&gt;test_c = NULL;\n  }\n</code></pre>\n\n<p>You'll also want a function to get rid of a <code>test_t</code> instance correctly. Something like:</p>\n\n<pre><code>void destroy_test_t(test_t *tt, bool static)\n  {\n  free(tt-&gt;test_c);\n\n  if(!static)\n    free(tt);\n  }\n</code></pre>\n\n<p>The <code>static</code> parameter is included to control whether <code>tt</code> should or should not be free'd. Obviously you don't want to attempt to free a pointer to a static instance of <code>test_t</code>, in which case you'd pass TRUE for <code>static</code>. For dynamically-allocated instances of <code>test_t</code>, e.g. those created using the <code>create_test_t</code> procedure, you'd pass FALSE for <code>static</code>.</p>\n\n<p>You then use these functions every time you need to create or destroy a <code>test_t</code>. </p>\n\n<p>Best of luck.</p>\n"}], "owner": {"reputation": 13, "user_id": 5381889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/700f119cbd12e1a4a64f63236d5964e3?s=128&d=identicon&r=PG&f=1", "display_name": "user923814624", "link": "https://stackoverflow.com/users/5381889/user923814624"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 50133094, "answer_count": 5, "score": 1, "last_activity_date": 1525260204, "creation_date": 1525258698, "question_id": 50132988, "link": "https://stackoverflow.com/questions/50132988/how-to-correctly-free-a-structure-returned-from-a-function", "title": "How to correctly free a structure returned from a function?", "body": "<p>I'm new to C and trying to figure out how to dispose of the structures, references to which are returned from a function. </p>\n\n<p>For example, this is roughly what I want to do. </p>\n\n<pre><code>typedef struct test_t{\n    char *test_c;\n} test_t;\n\nint testFunc(test_t** output){\n    test_t* testStruct = malloc(sizeof(testStruct));\n    char* buf = malloc(sizeof(char)  * 5);\n    strcpy(buf, \"test\");\n    testStruct-&gt;test_c = buf;\n    *output = testStruct;\n    return 0;\n}\n\nint main() {\n    test_t* test;\n    testFunc(&amp;test);\n    printf(\"%s\\n\",test-&gt;test_c);\n    free(test);\n    return 0;\n}\n</code></pre>\n\n<p>So in main I get the test struct. After <code>printf</code> (assume that there is some code after wards) I no longer need it and want to deallocate it. But how to do it properly? Should I just deallocate test_c explicitly first? But what if it wasn't allocated? </p>\n"}, {"tags": ["c", "string", "pointers"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1525258606, "post_id": 50132918, "comment_id": 87283780, "body": "<code>sprintf()</code> returns a value. You could use it."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1525259282, "post_id": 50132918, "comment_id": 87284200, "body": "&quot;returning string differs&quot; You do not use the string that is returned. How would you know?"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1525259856, "post_id": 50132918, "comment_id": 87284584, "body": "Not an exact dupe, but see here: <a href=\"https://stackoverflow.com/questions/2486235/initializing-a-pointer-in-a-separate-function-in-c\" title=\"initializing a pointer in a separate function in c\">stackoverflow.com/questions/2486235/&hellip;</a>"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1525259974, "post_id": 50132918, "comment_id": 87284656, "body": "Modifying the parameter <code>x</code> has no effect on the variable whose value you passed in. Use the returned pointer."}], "answers": [{"tags": [], "owner": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "is_accepted": false, "score": 1, "last_activity_date": 1525260320, "last_edit_date": 1525260320, "creation_date": 1525259805, "answer_id": 50133360, "question_id": 50132918, "link": "https://stackoverflow.com/questions/50132918/returning-string-differs-from-the-string-in-the-function-in-c/50133360#50133360", "title": "returning string differs from the string in the function in c", "body": "<p>The <code>x</code> pointer that is being printed out inside <code>dex_to_hex_converter()</code> has been moved to the middle of the character array.  So only half of the string is printed. </p>\n\n<pre><code>char [] = \"FFFFFFF0\\0\"\n               ^\n               |\n               x\n</code></pre>\n\n<p>When you return to <code>main()</code>, the pointer <code>x</code>, which was passed by value, returns to its original value pointing to the beginning of the character array, and so, the whole string is once again printed out.</p>\n\n<pre><code>char [] = \"FFFFFFF0\\0\"\n           ^\n           |\n           x\n</code></pre>\n\n<p>To access only the portion of the string you want...use the pointer returned, not the one passed in :</p>\n\n<pre><code>printf(\"ret=%s\\n\", dec_to_hex_converter(-16, x));\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 0, "last_activity_date": 1525260059, "creation_date": 1525260059, "answer_id": 50133458, "question_id": 50132918, "link": "https://stackoverflow.com/questions/50132918/returning-string-differs-from-the-string-in-the-function-in-c/50133458#50133458", "title": "returning string differs from the string in the function in c", "body": "<p>When you change <code>x</code> in the function, you only change a local pointer that was initialized with the <code>x</code> array from main.</p>\n\n<p>In fact the function declaration is seen by the compiler as:</p>\n\n<pre><code>char* dec_to_hex_converter(int num, char *x)\n</code></pre>\n\n<p>To really understand it, you could control the return value:</p>\n\n<pre><code>int main()\n{\n    char x[10];\n    char *cur = dec_to_hex_converter(-16,x);\n    printf(\"x2=%s (returned:%s\\n\", x, cur);\n    printf(\"delta %d\\n\", cur - x);\n    return 0;\n}\n</code></pre>\n\n<p>Output would be:</p>\n\n<pre><code>x1=FFF0\nx2=FFFFFFF0 (returned:FFF0)\ndelta 4\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "is_accepted": false, "score": 0, "last_activity_date": 1525260203, "creation_date": 1525260203, "answer_id": 50133507, "question_id": 50132918, "link": "https://stackoverflow.com/questions/50132918/returning-string-differs-from-the-string-in-the-function-in-c/50133507#50133507", "title": "returning string differs from the string in the function in c", "body": "<p>You seem to mix some concepts.\nIn your title you mention a string returned by a function.</p>\n\n<p>If you want to return a string you can use it as follows:</p>\n\n<pre><code>int main()\n{\n    char x[10];\n    char *result = dec_to_hex_converter(-16,x);\n    printf(\"x2=%s\\n\", result);\n}\n</code></pre>\n\n<p>In your code you try to change the passed pointer. This would require to pass a \"reference\" to it instead of the pointer itself. (In C there are no real references. You need to pass a pointer to the pointer instead)</p>\n\n<p>And most important you need to pass a modifyable lvalue to the function.\nThe address of an array is not modifyable.</p>\n"}], "owner": {"reputation": 87, "user_id": 5561853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef9cc699cea05e640044c1ec6afb8a9f?s=128&d=identicon&r=PG&f=1", "display_name": "shaked", "link": "https://stackoverflow.com/users/5561853/shaked"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1525294946, "creation_date": 1525258465, "last_edit_date": 1525294946, "question_id": 50132918, "link": "https://stackoverflow.com/questions/50132918/returning-string-differs-from-the-string-in-the-function-in-c", "title": "returning string differs from the string in the function in c", "body": "<p>I try to convert a decimal number to its its hexadecimal representation (and want to get only the fourth LSB digits).\nIt is seems that my function do works, but when i try to get the value of the number from the main function, i get all the digits and <code>x1!=x2</code>.\nWhere do I wrong?  </p>\n\n<p>here is my code:</p>\n\n<pre><code>char* dec_to_hex_converter(int num, char x[])\n{\nint i = 1;\nint size = 0;\n\nsprintf(x, \"%04X\\n\", num);\nsize = strlen(x);\nif (size &gt; 4)\n{\n    while (size &gt; 4)\n    {\n        x++;\n        size--;\n    }\n    x--;\n}\n*(x + 4) = '\\0';\nprintf(\"x1=%s\\n\", x);\nreturn x;\n}\n\nint main()\n{\n    char x[10];\n    dec_to_hex_converter(-16,x);\n    printf(\"x2=%s\\n\", x);\n}\n</code></pre>\n\n<p>I want to get <code>FFF0</code>\nbut when I print the result I get <code>FFFFFFF0</code> (ONLY OUTSIDE THE FUNCTION)</p>\n\n<p>thanks in advance</p>\n"}, {"tags": ["c", "buildroot"], "answers": [{"tags": [], "owner": {"reputation": 4748, "user_id": 643208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb7e82bc765b5427a74a8b29b074c37e?s=128&d=identicon&r=PG", "display_name": "Thomas Petazzoni", "link": "https://stackoverflow.com/users/643208/thomas-petazzoni"}, "is_accepted": false, "score": 4, "last_activity_date": 1525350458, "creation_date": 1525350458, "answer_id": 50155095, "question_id": 50132563, "link": "https://stackoverflow.com/questions/50132563/unable-to-execute-c-binary-on-costum-buildroot/50155095#50155095", "title": "Unable to execute C binary on costum Buildroot", "body": "<p>You must build your program with the cross-compiler provided by Buildroot, so that it uses the libraries matching the ones available on your ARM target. The compiler is <code>host/bin/arm-linux-gcc</code>.</p>\n"}], "owner": {"reputation": 11, "user_id": 7837524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14cb9f5b3e3ec6d728b6ca13061dd5f2?s=128&d=identicon&r=PG&f=1", "display_name": "Marcel T", "link": "https://stackoverflow.com/users/7837524/marcel-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1525350458, "creation_date": 1525257334, "question_id": 50132563, "link": "https://stackoverflow.com/questions/50132563/unable-to-execute-c-binary-on-costum-buildroot", "title": "Unable to execute C binary on costum Buildroot", "body": "<p>I'm unable to execute a C program on my ARM Cortex A7 running buildroot.\nAfter executing I get this error:</p>\n\n<p>./mcp23017 </p>\n\n<p>Could not open file (1): No such file or directory</p>\n\n<p>After searching I found out that I'm missing the correct interpreter on my buildroot.</p>\n\n<p><code>#cd /lib</code></p>\n\n<pre><code>ls\ndhcpcd               \nlibform.so           libncurses.so.6.0\nld-uClibc-1.0.28.so  libform.so.6         libpanel.so\nld-uClibc.so.0       libform.so.6.0       libpanel.so.6 \nld-uClibc.so.1       libgcc_s.so          libpanel.so.6.0\nlibatomic.so         libgcc_s.so.1        libuClibc-1.0.28.so\nlibatomic.so.1       libmagic.so          libz.so\nlibatomic.so.1.2.0   libmagic.so.1        libz.so.1\nlibc.so.0            libmagic.so.1.0.0    libz.so.1.2.11\nlibc.so.1            libmenu.so           modules\nlibcurl.so           libmenu.so.6         os-release\nlibcurl.so.4         libmenu.so.6.0       terminfo\nlibcurl.so.4.5.0     libncurses.so\nlibcurses.so         libncurses.so.6\n</code></pre>\n\n<p>I'm really stuck, could you tell me how I can cross compile with uclibc on my i386 laptop?\nOr do I have other options?</p>\n"}, {"tags": ["c", "linker", "shared-libraries", "dylib", "mach-o"], "comments": [{"owner": {"reputation": 1339, "user_id": 2141064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c56d69ec8f5e469a8c6ca22d60271e9b?s=128&d=identicon&r=PG", "display_name": "Lorinczy Zsigmond", "link": "https://stackoverflow.com/users/2141064/lorinczy-zsigmond"}, "edited": false, "score": 0, "creation_date": 1525540952, "post_id": 50132527, "comment_id": 87401158, "body": "When linking the main executable, you might try option <code>-Wl,-export_dynamic</code>"}], "answers": [{"comments": [{"owner": {"reputation": 4506, "user_id": 3344612, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/jwgap.jpg?s=128&g=1", "display_name": "Teivaz", "link": "https://stackoverflow.com/users/3344612/teivaz"}, "edited": false, "score": 0, "creation_date": 1525678684, "post_id": 50183179, "comment_id": 87435307, "body": "It seems like you wanted to say &quot;No, this is not possible&quot; because my question is not about bundles. What is the purpose of the <code>export_dynamic</code> flag. In my example of bundle everything works without it."}, {"owner": {"reputation": 15569, "user_id": 2302862, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e264db339bb96e343770fa38018e00f1?s=128&d=identicon&r=PG", "display_name": "Siguza", "link": "https://stackoverflow.com/users/2302862/siguza"}, "reply_to_user": {"reputation": 4506, "user_id": 3344612, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/jwgap.jpg?s=128&g=1", "display_name": "Teivaz", "link": "https://stackoverflow.com/users/3344612/teivaz"}, "edited": false, "score": 0, "creation_date": 1525783399, "post_id": 50183179, "comment_id": 87485188, "body": "From the <code>ld</code> man page: &quot;Preserves all global symbols in main executables during LTO. Without this option, Link Time Optimization is allowed to inline and remove global functions. This option is used when a main executable may load a plug-in which requires certain symbols from the main executable.&quot;"}, {"owner": {"reputation": 4506, "user_id": 3344612, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/jwgap.jpg?s=128&g=1", "display_name": "Teivaz", "link": "https://stackoverflow.com/users/3344612/teivaz"}, "edited": false, "score": 0, "creation_date": 1525784815, "post_id": 50183179, "comment_id": 87486069, "body": "that is interesting. I have built test project without this flag and it still managed to link and run. I\u2019ve checked as well on a large qt project and it still works without."}, {"owner": {"reputation": 15569, "user_id": 2302862, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e264db339bb96e343770fa38018e00f1?s=128&d=identicon&r=PG", "display_name": "Siguza", "link": "https://stackoverflow.com/users/2302862/siguza"}, "reply_to_user": {"reputation": 4506, "user_id": 3344612, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/jwgap.jpg?s=128&g=1", "display_name": "Teivaz", "link": "https://stackoverflow.com/users/3344612/teivaz"}, "edited": false, "score": 1, "creation_date": 1525790449, "post_id": 50183179, "comment_id": 87489883, "body": "Well, it&#39;s specific to LTO. Idk about other platforms, but on macOS that seems disabled by default (can be enabled with <code>-flto</code>). If I build my <code>main.c</code> with <code>-flto</code>, <code>func</code> disappears from the symbol table."}], "tags": [], "owner": {"reputation": 15569, "user_id": 2302862, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e264db339bb96e343770fa38018e00f1?s=128&d=identicon&r=PG", "display_name": "Siguza", "link": "https://stackoverflow.com/users/2302862/siguza"}, "is_accepted": false, "score": 1, "last_activity_date": 1525468778, "creation_date": 1525468778, "answer_id": 50183179, "question_id": 50132527, "link": "https://stackoverflow.com/questions/50132527/linking-to-an-executable-on-osx/50183179#50183179", "title": "Linking to an executable on OSX", "body": "<p>Yes this is possible, but then you'll want to create a <em>bundle</em> rather than a <em>shared library</em> (see <a href=\"https://stackoverflow.com/a/2339910\">this answer</a> for more detail).</p>\n\n<p>If you have a main application like so:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;dlfcn.h&gt;\n\nint func(void)\n{\n    return 42;\n}\n\nint main(void)\n{\n    void *dl = dlopen(\"plugin.so\", RTLD_LOCAL);\n    if(!dl) return -1;\n\n    int (*derp)(void) = dlsym(dl, \"derp\");\n    if(!derp) return -1;\n\n    printf(\"derp(): %i\\n\", derp());\n\n    return 0;\n}\n</code></pre>\n\n<pre class=\"lang-none prettyprint-override\"><code>clang -o main main.c -Wall -Wl,-export_dynamic\n</code></pre>\n\n<p>Then you can compile bundles against it like so:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>int func(void);\n\nint derp(void)\n{\n    return -func();\n}\n</code></pre>\n\n<pre class=\"lang-none prettyprint-override\"><code>clang -o plugin.so plugin.c -Wall -bundle -bundle_loader ./main\n</code></pre>\n"}], "owner": {"reputation": 4506, "user_id": 3344612, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/jwgap.jpg?s=128&g=1", "display_name": "Teivaz", "link": "https://stackoverflow.com/users/3344612/teivaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 383, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1574248850, "creation_date": 1525257255, "last_edit_date": 1574248850, "question_id": 50132527, "link": "https://stackoverflow.com/questions/50132527/linking-to-an-executable-on-osx", "title": "Linking to an executable on OSX", "body": "<p>On Windows it is possible to dynamically link to an executable with exported symbols. For example following code:</p>\n\n<pre><code>// main.c\nvoid __declspec(dllexport) interface_function() {}\nint main() {}\n\n// ext.c\nvoid interface_function();\nvoid extension_function() {\n    interface_function();\n}\n</code></pre>\n\n<p>With</p>\n\n<blockquote>\n  <p>cl.exe main.c<br>\n  cl.exe ext.c /LD /link main.lib</p>\n</blockquote>\n\n<p>would produce an executable <code>main.exe</code>, a static library <code>main.lib</code> for implicit linking, and a dynamic library <code>ext.dll</code>.</p>\n\n<p>Similar behavior can be achieved in OSX with shared libraries:</p>\n\n<pre><code>// main.c\nvoid interface_function() {}\nint main() {}\n\n// ext.c\nvoid interface_function();\nvoid extension_function() {\n    interface_function();\n}\n</code></pre>\n\n<p>With</p>\n\n<blockquote>\n  <p>gcc main.c -o main<br>\n  gcc ext.c -bundle -bundle_loader main -o ext.bundle</p>\n</blockquote>\n\n<p>it is virtually equivalent to the Windows setup.</p>\n\n<p>But for <code>dynamiclib</code>:</p>\n\n<pre><code>&gt; gcc ext.c -dynamiclib -o ext.dylib\n</code></pre>\n\n<p>and <code>shared</code>:</p>\n\n<pre><code>&gt; gcc ext.c -shared -o ext.so\n</code></pre>\n\n<p>I cannot get them to work because of undefined symbols on one hand and unable to load an executable with <code>-l</code> flag on the other.</p>\n\n<p>I can let them resolve undefined symbols in runtime with <code>-undefined dynamic_lookup</code>. But this is not a sustainable way because all the link errors are now happening in run-time instead.</p>\n\n<p>Is there a way to provide the list of symbols to dynamically load from an executable when linking as <code>-shared</code> and <code>-dynamiclib</code>?</p>\n"}, {"tags": ["c", "pointers", "linked-list"], "comments": [{"owner": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 1, "creation_date": 1525257408, "post_id": 50132466, "comment_id": 87283017, "body": "What did you discover when you ran this code in your debugger? Or have you not tried that yet?"}, {"owner": {"reputation": 5464, "user_id": 59527, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/5728955f444a62bbba61ba09690c50ab?s=128&d=identicon&r=PG", "display_name": "Sijmen Mulder", "link": "https://stackoverflow.com/users/59527/sijmen-mulder"}, "edited": false, "score": 0, "creation_date": 1525257456, "post_id": 50132466, "comment_id": 87283051, "body": "What&#39;s the output order? Note that you&#39;re adding elements to the front of your list, so one would expect the output is the reverse of the input."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1525258237, "post_id": 50132466, "comment_id": 87283559, "body": "<code>buffer = malloc(sizeof(struct Prova));</code> That might be a bit too small for some  numbers."}], "answers": [{"comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1525259449, "post_id": 50132971, "comment_id": 87284323, "body": "@H.S. sorry you&#39;re right, comment deleted. But the original code is still somewhat suspect. Anyway there is no need to allocate <code>buffer</code> dynamically."}], "tags": [], "owner": {"reputation": 9095, "user_id": 8542346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b206b49cec657d28a5876f8330780e?s=128&d=identicon&r=PG&f=1", "display_name": "H.S.", "link": "https://stackoverflow.com/users/8542346/h-s"}, "is_accepted": true, "score": 1, "last_activity_date": 1525262015, "last_edit_date": 1525262015, "creation_date": 1525258657, "answer_id": 50132971, "question_id": 50132466, "link": "https://stackoverflow.com/questions/50132466/how-to-load-data-from-file-into-linked-list-c/50132971#50132971", "title": "How to load data from file into linked list c", "body": "<p>The problem is occurring because of passing <code>sizeof(buffer)</code> to <code>fgets()</code>. <code>buffer</code> is a pointer and <code>sizeof(buffer)</code> will return either <code>4</code> or <code>8</code> based on underlying architecture <code>32</code> bit or <code>64</code> bit. Change this to:</p>\n\n<pre><code>while(fgets(buffer, sizeof(struct Prova), f))\n</code></pre>\n\n<p>as you are allocating <code>sizeof(struct Prova)</code> size to <code>buffer</code>.</p>\n\n<p>This is also not the correct solution of the problem. Reason is-</p>\n\n<p>Say, your file is having this data:</p>\n\n<pre><code>abcdefghijklmno 123456789\n</code></pre>\n\n<p>The name part is <code>15</code> character long which <code>nome</code> member can hold and <code>id</code> member can also hold the number <code>123456789</code> as it is less than <code>INT_MAX</code>. <code>fgets</code> read characters from the stream and the size of above-given data is <code>25</code> characters. In your code, you are allocating <code>sizeof(struct Prova)</code> size memory to <code>buffer</code> and size of <code>struct Prova</code> is <code>20</code> byte. Hence for the above-given data, <code>buffer</code> is not allocated enough memory to read the whole line in one go because the <code>fgets</code> reads until <code>size-1</code> characters have been read or either a newline or the end-of-file is reached, whichever happens first. So, in this case, the partial line will be read and passed to <code>sscanf()</code> and rest of the line will be read in next iteration and passed to <code>sscanf()</code> which will give the incorrect results.</p>\n\n<p>You should not allocate the memory to <code>buffer</code> based on the size of <code>struct Prova</code>. Instead, I would suggest taking <code>buffer</code> of some bigger size, like this (no need to allocate it dynamically):</p>\n\n<pre><code>char buffer[100];\n</code></pre>\n\n<p>ensure it should be bigger enough to accommodate a line of the file in one read of <code>fgets</code> or modify your code to not to fill <code>p.nome</code> and <code>p.id</code> until <code>fgets</code> hits newline character or EOF i.e. to make sure to read the whole line and then only <code>sscanf()</code> the <code>p.nome</code> and <code>p.id</code>.</p>\n"}], "owner": {"reputation": 102, "user_id": 9670079, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-r10wQVGNNJM/AAAAAAAAAAI/AAAAAAAAAAk/ZtmIxl8-q2E/photo.jpg?sz=128", "display_name": "St3ve R0nix", "link": "https://stackoverflow.com/users/9670079/st3ve-r0nix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1491, "favorite_count": 0, "accepted_answer_id": 50132971, "answer_count": 1, "score": 0, "last_activity_date": 1527082029, "creation_date": 1525257114, "last_edit_date": 1527082029, "question_id": 50132466, "link": "https://stackoverflow.com/questions/50132466/how-to-load-data-from-file-into-linked-list-c", "title": "How to load data from file into linked list c", "body": "<p>The program should read a simple text file and store the data ( name and id) into a linked list. </p>\n\n<p>This is the linked list:</p>\n\n<pre><code>struct Prova\n{\n char nome[16];\n int id;\n};\n\ntypedef struct Node {\n struct Prova  struttura;\n struct Node * next;\n\n}TNodo;\ntypedef TNodo* Nodo;\n</code></pre>\n\n<p>This function creates the linked list:</p>\n\n<pre><code>void NewList(struct Prova  p, Nodo * pp)\n{\n Nodo  temp;\n\n temp = (Nodo)malloc(sizeof(struct Node));\n\n temp-&gt;struttura = p;\n temp-&gt;next = *pp;\n\n *pp = temp;\n}\n</code></pre>\n\n<p>This is the function i wrote to read the file:</p>\n\n<pre><code>void Load(Nodo *pp)\n{\n  FILE *f;\n  struct Prova p;\n  char * buffer;\n  if(!(f = fopen(PATH, \"r\")))\n  {\n    perror(\"Error\");\n    exit(-1);\n  }\n\n  buffer = malloc(sizeof(struct Prova));\n\n  while(fgets(buffer, sizeof(buffer), f))\n    {\n      if(sscanf(buffer, \"%s%d\", p.nome, &amp;p.id) &gt; 0)\n      {\n        NewList(p, pp);\n      }\n    }\n\nfree(buffer);\nfclose(f);\n\n}\n</code></pre>\n\n<p>The text file i'm trying to read is this:</p>\n\n<pre><code>Stefano 31\nPaperino 23\nPippo 1\nPluto 14\n</code></pre>\n\n<p>The functions for displaying the list are these: </p>\n\n<pre><code>void View(struct Prova  p)\n{\n printf(\"%s %d\\n\", p.nome, p.id);\n\n}\n\nvoid ViewList(Nodo  nodo)\n{\nwhile(nodo != NULL)\n{\n  View(nodo-&gt;struttura);\n  nodo = nodo-&gt;next;\n}\n</code></pre>\n\n<p>The program compiles fine, but it outputs the data in a strange order.\nLet me know if you need more info, i think it's all related to the function Load() which is the newest.</p>\n\n<p>Main function is this: </p>\n\n<pre><code>int main()\n{\nint scelta;\n struct Prova test;\nNodo lista = NULL;\n do {\n   scelta = Menu();\n\n   switch (scelta)\n   {\n     case 1:   Load(&amp;lista); break     \n     case 2: ViewList(lista); break;\n     default: scelta = 0;\n   }\n\n } while (scelta != 0);\n\n return 0;\n}\n</code></pre>\n\n<p>For now the output is this: </p>\n\n<p><a href=\"https://i.stack.imgur.com/Wzgfj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Wzgfj.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "loops"], "comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1525257454, "post_id": 50132389, "comment_id": 87283046, "body": "Welcome to SO. <code>p-&gt;data = (char*)malloc(sizeof(char)*strlen(copy));</code> 1) You should not cast the return value of <code>malloc</code>. 2) To store a string you need <code>strlen+1</code> characters."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1525257949, "post_id": 50132389, "comment_id": 87283389, "body": "<code>if (str[j] &gt; str[j + 1])</code> For <code>i == 0</code> you access your array behind the last character: <code>if (str[j] &gt; str[j + 1])</code> This means you swap the terminating <code>&#39;\\0&#39;</code>byte moving towards the start of the string. In the next iteration the limit <code>strlen(str)</code> will be shorter and shorter...."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 2, "creation_date": 1525257961, "post_id": 50132389, "comment_id": 87283395, "body": "I suggest start using a debugger and step through your program."}], "answers": [{"tags": [], "owner": {"reputation": 87, "user_id": 9557323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7b5f2162e8f969ce9d2e7a75f995e6d?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrice Derepas", "link": "https://stackoverflow.com/users/9557323/fabrice-derepas"}, "is_accepted": false, "score": 1, "last_activity_date": 1525265557, "last_edit_date": 1525265557, "creation_date": 1525264643, "answer_id": 50134839, "question_id": 50132389, "link": "https://stackoverflow.com/questions/50132389/the-program-refuses-to-enter-into-the-for-loop/50134839#50134839", "title": "The program refuses to enter into the for loop", "body": "<p>The loop actually starts if the string size is greater than 0. Yet there is an undefined behaviour because you should allocate memory for the terminating 0:</p>\n\n<pre><code>p-&gt;data = (char*)malloc(sizeof(char)*strlen(copy)+1);\np-&gt;sig = (char*)malloc(sizeof(char)*strlen(str)+1);\n</code></pre>\n\n<p>Here is the reported issue without the \"+1\" in the malloc:</p>\n\n<p><a href=\"https://taas.trust-in-soft.com/tsnippet/t/0b30573d\" rel=\"nofollow noreferrer\">https://taas.trust-in-soft.com/tsnippet/t/0b30573d</a></p>\n"}], "owner": {"reputation": 7, "user_id": 9729758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/862a661598f39a9f48416b4ba3357f47?s=128&d=identicon&r=PG&f=1", "display_name": "jumpingscoutsman", "link": "https://stackoverflow.com/users/9729758/jumpingscoutsman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1525265557, "creation_date": 1525256854, "last_edit_date": 1525257651, "question_id": 50132389, "link": "https://stackoverflow.com/questions/50132389/the-program-refuses-to-enter-into-the-for-loop", "title": "The program refuses to enter into the for loop", "body": "<p>I am now working on a Binary Search Tree and for some reason, this loop wouldn't even start. We have tried various methods to test whether it's the problem of strlen() or even the data type issue. </p>\n\n<p>ElementType is char*.</p>\n\n<pre><code>void sortinsert(Node **root, ElementType str)\n{\n    int i, j;\n    char temp;\n    char copy[100];\n    strcpy(copy, str);\n\n    int k = strlen(str);\n    printf(\"%d\", k);\n\n    for (i = 0; i &lt; k; i++) {\n        /*printf(\"%s\", str);\n        printf(\"%c\", *str);*/\n        printf(\"%d\", i);\n        for (j = 0; j &lt; strlen(str) - i; j++) {\n            if (str[j] &gt; str[j + 1]) {\n                temp = str[j];\n                str[j] = str[j + 1];\n                str[j + 1] = temp;\n\n            }\n        }\n    }\n\n    Node *p = (Node *)malloc(sizeof(Node));\n    p-&gt;data = (char*)malloc(sizeof(char)*strlen(copy));\n    p-&gt;sig = (char*)malloc(sizeof(char)*strlen(str));\n\n    strcpy(p-&gt;sig, str);\n    strcpy(p-&gt;data, copy);\n\n    p-&gt;left = NULL;\n    p-&gt;right = NULL;\n    p-&gt;next = NULL;\n\n    Node *rootbackup;\n\n    if ((*root) == NULL) {\n        (*root) = p;\n    }\n    else {\n        rootbackup = *root;\n        if (strcmp((*root)-&gt;data, copy) &gt; 0) {\n            sortinsert(&amp;(*root)-&gt;left, copy);\n        }\n        else\n        {\n            if (strcmp((*root)-&gt;data,copy) &lt; 0)\n                sortinsert(&amp;(*root)-&gt;right, copy);\n        }\n        *root = rootbackup;\n    }\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1525256173, "post_id": 50132126, "comment_id": 87282145, "body": "Never <i>ever</i> use <code>gets</code>. It&#39;s a dangerous function which are prone to buffer overflows, and has therefore been removed from the C language. Use e.g. <a href=\"http://en.cppreference.com/w/c/io/fgets\" rel=\"nofollow noreferrer\"><code>fgets</code></a> instead. Also, passing an input-only streak (like <code>stdin</code>) to <code>fflush</code> is explicitly undefined behavior according to the C specification."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1525256308, "post_id": 50132126, "comment_id": 87282231, "body": "As for your problem, do you mean you enter two digits for the <code>ranking</code>? Why read it as a string if its a number? And remember that <code>char</code> strings are really called <b><i>null-terminated</b> byte strings. That *null-terminator</i> also needs space. A string of two characters needs space for <i>three</i> to include the terminator."}, {"owner": {"reputation": 13, "user_id": 9729626, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-SswEbFURC5k/AAAAAAAAAAI/AAAAAAAAACg/YaBL7YsfM6A/photo.jpg?sz=128", "display_name": "Alex Wibisono", "link": "https://stackoverflow.com/users/9729626/alex-wibisono"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1525257279, "post_id": 50132126, "comment_id": 87282913, "body": "no, i just want to put &#39;S&#39; or else to the level requirement and automaticly the program will know the level of the requirement"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1525259068, "post_id": 50132126, "comment_id": 87284078, "body": "Then you should probably read a <i>character</i> instead of a string. That will make your out-commented <code>switch</code> statement work as well. Which maybe was your problem?"}, {"owner": {"reputation": 13, "user_id": 9729626, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-SswEbFURC5k/AAAAAAAAAAI/AAAAAAAAACg/YaBL7YsfM6A/photo.jpg?sz=128", "display_name": "Alex Wibisono", "link": "https://stackoverflow.com/users/9729626/alex-wibisono"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1525273500, "post_id": 50132126, "comment_id": 87293973, "body": "this part  switch(questo[j].ranking)                {                case &#39;S&#39; :printf(&quot;80\\n\\n&quot;);break;                case &#39;A&#39; :printf(&quot;60\\n\\n&quot;);break;                case &#39;B&#39; :printf(&quot;40\\n\\n&quot;);break;                case &#39;C&#39; :printf(&quot;20\\n\\n&quot;);break;                case &#39;D&#39; :printf(&quot;10\\n\\n&quot;);break;                case &#39;E&#39; :printf(&quot;2\\n\\n&quot;);break;                }"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1525273753, "post_id": 50132126, "comment_id": 87294137, "body": "What <b><i>is</i></b> <code>questo[j].ranking</code>? What is (e.g.) <code>&#39;S&#39;</code>? Are those the same <i>type</i>?"}, {"owner": {"reputation": 13, "user_id": 9729626, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-SswEbFURC5k/AAAAAAAAAAI/AAAAAAAAACg/YaBL7YsfM6A/photo.jpg?sz=128", "display_name": "Alex Wibisono", "link": "https://stackoverflow.com/users/9729626/alex-wibisono"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1525273914, "post_id": 50132126, "comment_id": 87294230, "body": "maybe, but i think that the wrong part. is that the right syntax ???"}, {"owner": {"reputation": 13, "user_id": 9729626, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-SswEbFURC5k/AAAAAAAAAAI/AAAAAAAAACg/YaBL7YsfM6A/photo.jpg?sz=128", "display_name": "Alex Wibisono", "link": "https://stackoverflow.com/users/9729626/alex-wibisono"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1525279653, "post_id": 50132126, "comment_id": 87297702, "body": "nevermind, i use strcmp and it&#39;s work. thanks Some programmer dude and sorry for my bad english"}], "answers": [{"comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 13, "user_id": 9729626, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-SswEbFURC5k/AAAAAAAAAAI/AAAAAAAAACg/YaBL7YsfM6A/photo.jpg?sz=128", "display_name": "Alex Wibisono", "link": "https://stackoverflow.com/users/9729626/alex-wibisono"}, "edited": false, "score": 0, "creation_date": 1529641825, "post_id": 50148274, "comment_id": 88956852, "body": "@AlexWibisono You&#39;re welcome. Now please take some time to read <a href=\"https://stackoverflow.com/help/someone-answers\">What should I do when someone answers my question?</a> :)"}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 0, "last_activity_date": 1525328837, "creation_date": 1525328837, "answer_id": 50148274, "question_id": 50132126, "link": "https://stackoverflow.com/questions/50132126/so-i-have-this-code-but-some-part-of-it-cant-work-well/50148274#50148274", "title": "so i have this code, but some part of it cant work well", "body": "<p>The <code>ranking</code> member is supposed to be a single <code>char</code>, so declare it as such and then read it as such and use it as such:</p>\n\n<pre><code>// ...\n\nstruct Quest\n{\n   char nama[100];\n   int reward;\n   char ranking;  // Single-character rank\n};\n\n// ...\n\nscanf(\" %c\", &amp;questo[j].ranking);  // Leading space to skip initial white-space\n// TODO: Should really check what scanf returns\n\n// ...\n\nprintf(\"Rank\\t: %c\\n\",questo[j].ranking);\n\n// ...\n\nswitch (questo[j].ranking)\n{\ncase 'S':\n    // ...\n\ndefault:\n    // TODO: Handle the case if the rank is incorrect\n    break;\n}\n\n// ...\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9729626, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-SswEbFURC5k/AAAAAAAAAAI/AAAAAAAAACg/YaBL7YsfM6A/photo.jpg?sz=128", "display_name": "Alex Wibisono", "link": "https://stackoverflow.com/users/9729626/alex-wibisono"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 50148274, "answer_count": 1, "score": -2, "last_activity_date": 1525328837, "creation_date": 1525256012, "question_id": 50132126, "link": "https://stackoverflow.com/questions/50132126/so-i-have-this-code-but-some-part-of-it-cant-work-well", "title": "so i have this code, but some part of it cant work well", "body": "<p>so the broken part is in the Level Requirement, can you help me to solve it ?\nso the level requirement is S needs 80, A needs 60, B needs 40, C needs 20, D needs 10, E needs 2.\nand the code must uses struct\nand i think the wrong part is in the struct it self.\nthanks (just dont read the rest)</p>\n\n<p>so the broken part is in the Level Requirement, can you help me to solve it ?\nso the level requirement is S needs 80, A needs 60, B needs 40, C needs 20, D needs 10, E needs 2.\nand the code must uses struct\nand i think the wrong part is in the struct it self.\nso the broken part is in the Level Requirement, can you help me to solve it ?\nso the level requirement is S needs 80, A needs 60, B needs 40, C needs 20, D needs 10, E needs 2.\nand the code must uses struct\nand i think the wrong part is in the struct it self.\nso the broken part is in the Level Requirement, can you help me to solve it ?\nso the level requirement is S needs 80, A needs 60, B needs 40, C needs 20, D needs 10, E needs 2.\nand the code must uses struct\nand i think the wrong part is in the struct it self.\nso the broken part is in the Level Requirement, can you help me to solve it ?\nso the level requirement is S needs 80, A needs 60, B needs 40, C needs 20, D needs 10, E needs 2.\nand the code must uses struct\nand i think the wrong part is in the struct it self.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;conio.h&gt;\n#include &lt;windows.h&gt;\n\nstruct Hero\n{\n   char nama[50];\n   int level;\n   char job[10];\n};\n\nstruct Quest\n{\n   char nama[100];\n   int reward;\n   char ranking[2];\n};\n\nint main()\n{\n   int pilih,jhero=1,jquest=1;\n   struct Hero hiro[10];\n   struct Quest questo[10];\n   do\n   {\n       system(\"cls\");\n       printf(\"============================================\\n\");\n       printf(\"                 HERO GUILD\\n\");\n       printf(\"============================================\\n\");\n       printf(\"1. Member Registration\\n\");\n       printf(\"2. Post a quest\\n\");\n       printf(\"3. Show all member\\n\");\n       printf(\"4. Show all quest\\n\");\n       printf(\"0. Exit\\n\");\n       printf(\"Input : \");\n       scanf(\"%d\",&amp;pilih);\n       fflush(stdin);\n       switch(pilih)\n       {\n       case 2 :\n           system(\"cls\");\n           printf(\"============================================\\n\");\n           printf(\"         HERO GUILD - POST A QUEST\\n\");\n           printf(\"============================================\\n\");\n           printf(\"Title : \"); gets(questo[jquest].nama);fflush(stdin);\n           printf(\"Reward &lt;$&gt;:       \");scanf(\"%d\",&amp;questo[jquest].reward);fflush(stdin);\n           printf(\"Rank :    \");scanf(\"%s\",questo[jquest].ranking);fflush(stdin);\n           jquest++;\n           printf(\"Press Any Key To Continue...\");\n           getch();\n           break;\n       case 4 :\n           system(\"cls\");\n           int j;\n           printf(\"============================================\\n\");\n           printf(\"             HERO GUILD - QUEST\\n\");\n           printf(\"============================================\\n\");\n           for(j=1;j&lt;jquest;j++)\n           {\n               printf(\"Quest-%d\\n\",j);\n               printf(\"Title\\t: %s\\n\",questo[j].nama);\n               printf(\"Reward\\t: %d\\n\",questo[j].reward);\n               printf(\"Rank\\t: %s\\n\",questo[j].ranking);\n               printf(\"Level Requirement : &gt;= \");\n               /*switch(questo[j].ranking)\n               {\n               case 'S' :printf(\"80\\n\\n\");break;\n               case 'A' :printf(\"60\\n\\n\");break;\n               case 'B' :printf(\"40\\n\\n\");break;\n               case 'C' :printf(\"20\\n\\n\");break;\n               case 'D' :printf(\"10\\n\\n\");break;\n               case 'E' :printf(\"2\\n\\n\");break;\n               }*/\n           }\n           printf(\"Press Any Key To Continue...\");\n           getch();\n           break;\n       case 0 : return 0;\n       }\n   }while(1);\n }\n</code></pre>\n"}, {"tags": ["c", "arrays", "eclipse", "pointers", "struct"], "comments": [{"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 1, "creation_date": 1525255013, "post_id": 50131740, "comment_id": 87281392, "body": "<code>caricamento(&amp;personaX[5]);</code> should be <code>caricamento(personaX);</code> or <code>caricamento(&amp;personaX[0]);</code> to match the prototype in the .h file, but not in .c file."}, {"owner": {"reputation": 628, "user_id": 8939165, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0gchW.jpg?s=128&g=1", "display_name": "Fabio_MO", "link": "https://stackoverflow.com/users/8939165/fabio-mo"}, "edited": false, "score": 0, "creation_date": 1525255319, "post_id": 50131740, "comment_id": 87281613, "body": "Also your <code>k</code> in <code>for()</code> loop should be strictly &lt; tha 5 so: <code>for(k=0;k&lt;5;k++)</code>"}, {"owner": {"reputation": 16091, "user_id": 4975822, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c04e8c4c984d36bea8a6239574980fbd?s=128&d=identicon&r=PG&f=1", "display_name": "artm", "link": "https://stackoverflow.com/users/4975822/artm"}, "edited": false, "score": 0, "creation_date": 1525255382, "post_id": 50131740, "comment_id": 87281645, "body": "&quot;without errors&quot; - but were there warnings?"}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 1, "creation_date": 1525255585, "post_id": 50131740, "comment_id": 87281783, "body": "There is no <code>#include &quot;struct.h&quot;</code> at the top of your main."}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 1, "creation_date": 1525256006, "post_id": 50131740, "comment_id": 87282058, "body": "<code>s_persona personaX[5]</code> is an array of 5 <code>s_persona</code> structs. <code>s_pers* perso[5]</code> is an array of 5 <b>pointers</b> to <code>s_pers</code> structs. <code>&amp;personaX[5]</code> is a pointer to the memory address right after the array. Arrays indexes start with <code>0</code> in C, and end at <code>n-1</code>, so <code>personaX[5]</code> and <code>k &lt;= 5</code> are both wrong. You have two structs with same contents but different name, remove one of them."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1525256182, "post_id": 50131740, "comment_id": 87282147, "body": "Why do you have two different typedefs (<code>s_pers</code>, and <code>s_persona</code>) for the same data structure?"}, {"owner": {"reputation": 3, "user_id": 9156302, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208450282934790/picture?type=large", "display_name": "Gianmarco Moresi", "link": "https://stackoverflow.com/users/9156302/gianmarco-moresi"}, "edited": false, "score": 0, "creation_date": 1525258905, "post_id": 50131740, "comment_id": 87283968, "body": "Guys, I&#39;ve follow all your comments, but continue at doesn&#39;t working..."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1525456871, "post_id": 50131740, "comment_id": 87378576, "body": "place the struct definition + typedef in the header file, so both source files see the same definition."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1525456983, "post_id": 50131740, "comment_id": 87378625, "body": "in C, the index into an array has the range 0,,,(number of elements in array -1)   so any index == number of elements in array is actually one past the end of the array."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1525457226, "post_id": 50131740, "comment_id": 87378737, "body": "the posted code contains several &#39;magic&#39; numbers.  &#39;magic&#39; numbers are numbers with no basis.  I.E.  5, 28, 29.  &#39;magic&#39; numbers make the code much more difficult to understand, debug, etc. Suggest using an <code>enum</code> statement or <code>#define</code> statements to give those &#39;magic&#39; numbers meaningful names, then use those meaningful names throughout the code"}], "answers": [{"tags": [], "owner": {"reputation": 240, "user_id": 9720723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c697e80e81a423d96624378d2b8386c?s=128&d=identicon&r=PG&f=1", "display_name": "rmm19433", "link": "https://stackoverflow.com/users/9720723/rmm19433"}, "is_accepted": false, "score": 0, "last_activity_date": 1525264535, "creation_date": 1525264535, "answer_id": 50134808, "question_id": 50131740, "link": "https://stackoverflow.com/questions/50131740/application-crash-with-pointer-header-file-and-struct-array/50134808#50134808", "title": "Application crash with pointer, header file and struct array", "body": "<p>Your header is not used at all. It would be best to define the structure in the header and include the header in your source files (as mentioned in the comments above).</p>\n\n<pre><code>#ifndef STRUCT_H_\n#define STRUCT_H_\n\ntypedef struct{\n    char nome[29];\n    char cognome[28];\n    int et;\n} s_pers;\n\nvoid caricamento(s_pers *perso)\n\n#endif /* STRUCT_H_ */\n</code></pre>\n\n<p>Then in your main.c <code>include</code> the header and as also mentioned in the comments pass <code>personaX</code>. Otherwise you would pass the address of the sixth element, that does not even exist! Since arrays start at 0 you may only iterate until <code>k &lt; 5</code>.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;struct.h&gt;    /* include your header! */\n\n/* \n  Structure already defined in header, \n  no need to define it here! \n */\n\nint main(){\n    s_pers personaX[5];\n\n    caricamento(personaX);\n\n    int i;\n    for(i=0;i&lt;5;i++){\n        printf(\"Nome: %s\\t Cognome: %s\\t Eta': %d\\n\", \n            personaX[i].nome, personaX[i].cognome, personaX[i].et);\n    }\n\n    system(\"pause\");\n}\n</code></pre>\n\n<p>In your struct.c make sure to include your header and make sure your function matches the function declaration in your header file! Again make sure to stop at 5, so use <code>k &lt; 5</code>.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;struct.h&gt;    /* include your header! */\n\nvoid caricamento(s_pers* perso){\n    int k;\n\n    for(k=0;k&lt;5;k++){\n        printf(\"Inserisci nome dello studente: \");\n        scanf(\"%s\", perso[k].nome);\n\n        printf(\"Inserisci cognome dello studente: \");\n        scanf(\"%s\", perso[k].cognome);\n\n        printf(\"Inserisci l'eta' dello studente: \");\n        scanf(\"%d\", &amp;perso[k].et);\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9156302, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208450282934790/picture?type=large", "display_name": "Gianmarco Moresi", "link": "https://stackoverflow.com/users/9156302/gianmarco-moresi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1525264535, "creation_date": 1525254846, "question_id": 50131740, "link": "https://stackoverflow.com/questions/50131740/application-crash-with-pointer-header-file-and-struct-array", "title": "Application crash with pointer, header file and struct array", "body": "<p>I've created a project in C with 3 files, main.c where I write a main:</p>\n\n<p><strong>main.c</strong></p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\ntypedef struct{\n    char nome[29];\n    char cognome[28];\n    int et;\n}s_persona;\n\nint main(){\n    s_persona personaX[5];\n\n    caricamento(&amp;personaX[5]);\n\n    int i;\n\n    for(i=0;i&lt;=5;i++){\n        printf(\"Nome: %s\\t Cognome: %s\\t Eta': %d\\n\", personaX[i].nome, personaX[i].cognome, personaX[i].et);\n    }\n\n    system(\"pause\");\n}\n</code></pre>\n\n<p>then a <strong>header file</strong> with a prototype (struct.h):</p>\n\n<pre><code>#ifndef STRUCT_H_\n#define STRUCT_H_\n\nvoid caricamento(s_pers perso[5])\n\n#endif /* STRUCT_H_ */\n</code></pre>\n\n<p>and another source file with a function (struct.c):</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\ntypedef struct{\n    char nome[29];\n    char cognome[28];\n    int et;\n}s_pers;\n\nvoid caricamento(s_pers* perso[5]){\n    int k;\n\n    for(k=0;k&lt;=5;k++){\n        printf(\"Inserisci nome dello studente: \");\n        scanf(\"%s\", perso[k]-&gt;nome);\n\n        printf(\"Inserisci cognome dello studente: \");\n        scanf(\"%s\", perso[k]-&gt;cognome);\n\n        printf(\"Inserisci l'eta' dello studente: \");\n        scanf(\"%d\", &amp;perso[k]-&gt;et);\n    }\n}\n</code></pre>\n\n<p>Ok, there are all file that I used. Eclipse build project, without errors, but, whene I insert first string, the application stops working and crash. \nI try create another application be like this, but without use a struct array, and it's working perfectly... \nHow I resolve this? </p>\n\n<p>Thanks!! </p>\n"}, {"tags": ["c++", "c", "visual-studio-2012", "openssl"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1525253531, "post_id": 50131184, "comment_id": 87280370, "body": "Post your code.  And linking to a duplicate question without explaining what makes your situation different isn&#39;t going to get you an answer, it&#39;s just going to get your question closed as a duplicate."}, {"owner": {"reputation": 25, "user_id": 9721983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8090f148a13ac9c8471fb3b4b6fc7aab?s=128&d=identicon&r=PG&f=1", "display_name": "Samuel Hardson", "link": "https://stackoverflow.com/users/9721983/samuel-hardson"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1525254721, "post_id": 50131184, "comment_id": 87281191, "body": "@AndrewHenle code is simple , I have problem with linking openssl , Code added."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1525255444, "post_id": 50131184, "comment_id": 87281686, "body": "You need to put <code>#pragma comment(lib, &quot;libssl.lib&quot;)</code> or something similar  (not sure about the name of the actuel .lib file) into your source file."}, {"owner": {"reputation": 25, "user_id": 9721983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8090f148a13ac9c8471fb3b4b6fc7aab?s=128&d=identicon&r=PG&f=1", "display_name": "Samuel Hardson", "link": "https://stackoverflow.com/users/9721983/samuel-hardson"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1525255991, "post_id": 50131184, "comment_id": 87282052, "body": "@MichaelWalz thank you sir , I added <code>#pragma comment(lib, &quot;libcryptoMD.lib&quot;) #pragma comment(lib, &quot;libcryptoMDd.lib&quot;) #pragma comment(lib, &quot;libcryptoMT.lib&quot;) #pragma comment(lib, &quot;libcryptoMTd.lib&quot;) #pragma comment(lib, &quot;libsslMD.lib&quot;) #pragma comment(lib, &quot;libsslMDd.lib&quot;) #pragma comment(lib, &quot;libsslMT.lib&quot;) #pragma comment(lib, &quot;libsslMTd.lib&quot;)</code> and it&#39;s working now . if you can please write it to a new answer I will mark it ."}], "answers": [{"tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": true, "score": 3, "last_activity_date": 1525256098, "creation_date": 1525256098, "answer_id": 50132152, "question_id": 50131184, "link": "https://stackoverflow.com/questions/50131184/cant-fix-unresolved-external-symbol-aes-encrypt-even-with-lib-files/50132152#50132152", "title": "Can&#39;t fix unresolved external symbol _AES_encrypt even with lib files", "body": "<p>Your c file <em>compiles</em> fine, but it doesn't <em>link</em> correctly because you didn't instruct the linker to link with the necessary .lib files.</p>\n\n<p>You need to put <code>#pragma comment(lib, \"libssl.lib\")</code> or something similar (not sure about the name of the actuel .lib file) into your source file.</p>\n"}], "owner": {"reputation": 25, "user_id": 9721983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8090f148a13ac9c8471fb3b4b6fc7aab?s=128&d=identicon&r=PG&f=1", "display_name": "Samuel Hardson", "link": "https://stackoverflow.com/users/9721983/samuel-hardson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1219, "favorite_count": 0, "accepted_answer_id": 50132152, "answer_count": 1, "score": 0, "last_activity_date": 1525256098, "creation_date": 1525253035, "last_edit_date": 1525254687, "question_id": 50131184, "link": "https://stackoverflow.com/questions/50131184/cant-fix-unresolved-external-symbol-aes-encrypt-even-with-lib-files", "title": "Can&#39;t fix unresolved external symbol _AES_encrypt even with lib files", "body": "<p>I need to use openssl library for my encryption .</p>\n\n<p>I read this threads :</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/10718418/openssl-aes-h-linker-error-undefined-reference-to\">Openssl aes.h [Linker error] undefined reference to</a></li>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/799kze2z.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/799kze2z.aspx?f=255&amp;MSPPError=-2147217396</a></li>\n</ul>\n\n<p>What I did :</p>\n\n<ol>\n<li>Downloaded Pre-Compiled Library of OpenSSL for VS2012 from <a href=\"https://github.com/David-Reguera-Garcia-Dreg/Precompiled-OpenSSL-Windows/tree/master/openssl-1.1.0e-vs2012\" rel=\"nofollow noreferrer\">here</a> .</li>\n<li><p>Added this addresses in :</p>\n\n<blockquote>\n  <p>General > Additional Include Directories : <strong>openssl-1.1.0h\\openssl-1.1.0f-vs2012\\include</strong></p>\n  \n  <p>Linker > Additional Include Directories : <strong>openssl-1.1.0h\\openssl-1.1.0f-vs2012\\lib</strong></p>\n</blockquote></li>\n<li><p>I used Default sample of openssl but I get this errors :</p></li>\n</ol>\n\n<blockquote>\n  <p>1>AES_Encryption 2.obj : error LNK2001: unresolved external symbol\n  _AES_set_encrypt_key 1>AES_Encryption 2.obj : error LNK2001: unresolved external symbol _AES_decrypt 1>AES_Encryption 2.obj : error\n  LNK2001: unresolved external symbol _AES_encrypt 1>AES_Encryption\n  2.obj : error LNK2001: unresolved external symbol _AES_set_decrypt_key</p>\n</blockquote>\n\n<p>What i did wrong ?</p>\n\n<p>edit : and here's my simple code :</p>\n\n<pre><code>#include &lt;fstream&gt;\n#include &lt;iostream&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string&gt;\n#include &lt;openssl/aes.h&gt;\n\nvoid main()\n{\nunsigned char inbuffer[1024];\nunsigned char encryptedbuffer[1024];\nunsigned char outbuffer[1024];\n\nunsigned char oneKey[] = \"abc\";\nAES_KEY key; \n\nAES_set_encrypt_key(oneKey,128,&amp;key); /// error LNK2001: unresolved external symbol _AES_set_encrypt_key\ngetchar();\n\n}\n</code></pre>\n"}, {"tags": ["c", "memory", "malloc", "valgrind"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1525252802, "post_id": 50130968, "comment_id": 87279934, "body": "First, what type of argument does <code>malloc()</code> take?  Second, what does <code>malloc()</code> return when you  get the segfault?"}, {"owner": {"reputation": 41, "user_id": 9092117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d929faf5171d7d25f6ec6600e26f9339?s=128&d=identicon&r=PG&f=1", "display_name": "Brain Meme", "link": "https://stackoverflow.com/users/9092117/brain-meme"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1525253210, "post_id": 50130968, "comment_id": 87280198, "body": "@AndrewHenle Sorry I&#39;m not sure if I understand but I&#39;ll try my best to provide details. what I want to allocate is the size of a 2d integer array in a 1d format. (The input from commandline is the width of the array) The errors I&#39;m getting from the compiler is just Segmentation fault      (core dumped)"}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 0, "creation_date": 1525253877, "post_id": 50130968, "comment_id": 87280608, "body": "With any decent modern compiler you should be able to do <code>sizeof(double[v][v])</code> so you don&#39;t have to do the computations manually. Then, check the return of <code>malloc</code> for such large allocations. Third, try your code with small examples, such that you have any chance to debug."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 9092117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d929faf5171d7d25f6ec6600e26f9339?s=128&d=identicon&r=PG&f=1", "display_name": "Brain Meme", "link": "https://stackoverflow.com/users/9092117/brain-meme"}, "edited": false, "score": 0, "creation_date": 1525253543, "post_id": 50131138, "comment_id": 87280375, "body": "Hmm, so maybe it&#39;s possible that it overflowed, hence the silly error? It&#39;s definitely possible, although if that happens to be the case, I&#39;d be a little unhappy because the HPC I&#39;m using should have a lot more RAM than 400MB. Perhaps, though, I was just not allocated the space, but changing that line to size_t doesn&#39;t seem to have changed anything for me."}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 1, "creation_date": 1525253885, "post_id": 50131138, "comment_id": 87280611, "body": "Not only <code>SIZE</code> should be a <code>size_t</code>, but also <code>v</code>, so that <code>v*v</code> results already in a <code>size_t</code>. Otherwise the multiplication will be overflow if <code>v&gt;=50000</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1525254439, "post_id": 50131138, "comment_id": 87281000, "body": "@mch good one, I didn&#39;t look close enough at the source! will edit this answer."}, {"owner": {"reputation": 41, "user_id": 9092117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d929faf5171d7d25f6ec6600e26f9339?s=128&d=identicon&r=PG&f=1", "display_name": "Brain Meme", "link": "https://stackoverflow.com/users/9092117/brain-meme"}, "edited": false, "score": 0, "creation_date": 1525254763, "post_id": 50131138, "comment_id": 87281221, "body": "For checking malloc, I just need a conditional statement that sees whether the thing I malloc&#39;d is null or not right?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1525254945, "post_id": 50131138, "comment_id": 87281346, "body": "Right. Any <code>malloc()</code> <b>without</b> checking the return value is a bug. Common idiom: <code>x = malloc(sizeof *x); if (!x) { fputs(&quot;out of memory!&quot;, stderr); exit(EXIT_FAILURE); }</code>."}, {"owner": {"reputation": 41, "user_id": 9092117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d929faf5171d7d25f6ec6600e26f9339?s=128&d=identicon&r=PG&f=1", "display_name": "Brain Meme", "link": "https://stackoverflow.com/users/9092117/brain-meme"}, "edited": false, "score": 0, "creation_date": 1525255543, "post_id": 50131138, "comment_id": 87281759, "body": "Well I did some testing for smaller numbers and it did not return NULL so that&#39;s good. I also realized that in a different function I wrote, I accidentally left the range to a small number which resulted in an absurdly low computation time. ^^; So, thanks guys for the help! But I think I might&#39;ve trolled myself here by trying to allocate more memory than I actually needed."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": false, "score": 6, "last_activity_date": 1525254567, "last_edit_date": 1525254567, "creation_date": 1525252892, "answer_id": 50131138, "question_id": 50130968, "link": "https://stackoverflow.com/questions/50130968/valgrind-address-0x0-is-not-stackd-mallocd-or-recently-freed-for-larger-i/50131138#50131138", "title": "Valgrind: Address 0x0 is not stack&#39;d, malloc&#39;d or (recently) free&#39;d for larger input values only", "body": "<p>Have a look at some <a href=\"https://linux.die.net/man/3/malloc\" rel=\"nofollow noreferrer\"><code>malloc()</code> manual</a>: Its argument is of type <code>size_t</code> for a reason. <code>int</code> is not guaranteed to hold any possible object size, <code>size_t</code> is. And it is unsigned btw -- negative sizes don't make much sense.</p>\n\n<p>So just write</p>\n\n<pre><code>size_t SIZE = ((size_t)v) * v;\n</code></pre>\n\n<p>as your <code>v</code> is an <code>int</code> you have to force this multiplication to be done as <code>size_t</code> by casting one of the arguments.</p>\n\n<p>A slightly better way would be to make <code>v</code> an <code>unsigned long</code> and use <code>strtoul()</code> instead of <code>atoi()</code>.</p>\n\n<hr>\n\n<p>Then, <strong>check</strong> the result of your <code>malloc()</code> before you use it. It might still return <code>NULL</code>, even with a correct size argument. If it does, this simply means you <strong>don't have enough RAM available</strong> at that moment.</p>\n\n<p>After all, with <code>v=10000</code> and assuming an <code>int</code> takes four bytes (which is very common), you already attempt to allocate 400 MB at once.</p>\n"}], "owner": {"reputation": 41, "user_id": 9092117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d929faf5171d7d25f6ec6600e26f9339?s=128&d=identicon&r=PG&f=1", "display_name": "Brain Meme", "link": "https://stackoverflow.com/users/9092117/brain-meme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1573, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1525254567, "creation_date": 1525252296, "last_edit_date": 1525252632, "question_id": 50130968, "link": "https://stackoverflow.com/questions/50130968/valgrind-address-0x0-is-not-stackd-mallocd-or-recently-freed-for-larger-i", "title": "Valgrind: Address 0x0 is not stack&#39;d, malloc&#39;d or (recently) free&#39;d for larger input values only", "body": "<p>I'm trying to work on a Dijikstra implementation and this is the graph generation code that I have</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;limits.h&gt;\n#include &lt;math.h&gt;\n#define MAX 300\nint main (int argc, char *argv[]){\n    int v = atoi(argv[1]);\n    int SIZE = v*v;\n    int* adjMatrix = malloc(sizeof(int)* SIZE);\n    graphGeneration(adjMatrix, v);\n    free(adjMatrix);\n    return 0;\n}\n\nvoid graphGeneration(int* adj, int numV){\n    int i, j, r;\n    for(i = 0; i&lt; numV; i++){\n        for(j=0; j &lt; numV; j++){\n            if(i == j){\n                adj[i * numV + j] = 0;\n            }\n            else{\n                r = rand() % MAX;\n                adj[i * numV + j] = r;\n                adj[j * numV + i] = r;\n            }\n        }\n    }\n\n}\n</code></pre>\n\n<p>When I try a value of v in 1000's it seems to work fine, but when I try to enter a value of v = 10,000+ I get a segfault (Specifically at 50,000 is the number I noticed). Running valgrind gets me the error in the title at this method. \nReposting here for convenience:</p>\n\n<pre><code>Invalid write of size 4\nat 0x400800: graphGeneration \nby 0x4006E3: main\nAddress 0x0 is not stack'd, malloc'd or (recently) free'd\nAccess not within mapped region at address 0x0\n</code></pre>\n\n<p>Anyone have any ideas for how to debug this or if there are any obvious errors here?</p>\n\n<p>I also noticed this bit in valgrind</p>\n\n<pre><code>Warning: silly arg (-7179869184) to malloc()\n</code></pre>\n\n<p>which I'm not sure if it's related, but it seems like a strange thing as well.</p>\n"}, {"tags": ["c", "assembly", "x86", "att"], "comments": [{"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1525252391, "post_id": 50130949, "comment_id": 87279672, "body": "<i>How</i> did you &quot;translate it to assembly language&quot;?"}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 3, "creation_date": 1525252422, "post_id": 50130949, "comment_id": 87279691, "body": "it&#39;s AT&amp;T/gas syntax, where destination argument is second (it&#39;s reversed to Intel syntax found in Intel documentation, i.e. gas <code>addl %edx, %eax</code> = <code>add eax,edx</code> in Intel) There are several different assembly dialects for x86 in common use, so check what kind of tutorials/books you would like to read and which tools they use, check availability of tools, and stick to single dialect for beginning. It&#39;s not that difficult to learn the differences later, as the underlying machine code is of course the same one, but it&#39;s unneeded hassle in the beginning."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9585531"}, "edited": false, "score": 2, "creation_date": 1525252456, "post_id": 50130949, "comment_id": 87279707, "body": "i used gcc -S -m32 -fno-asynchronous-unwind-tables -o main0.s main0.c"}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 0, "creation_date": 1525252771, "post_id": 50130949, "comment_id": 87279903, "body": "I personally prefer Intel syntax and open source tools, so I&#39;m usually around tools like NASM, edb-debugger, etc... and use gcc only for C/C++ parts of code (you can still switch gcc to produce Intel-like dialect when using <code>-S</code>, but it&#39;s not exactly NASM one, and the GNU toolchain is generally expecting to be used with original AT&amp;T/gas syntax, so you may run into some corner case problems, when you are using it with the intel syntax option -&gt; it&#39;s certainly good enough to just check out something quickly, like <code>-S</code>, but I wouldn&#39;t use it to compile assembly files in some project)."}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 0, "creation_date": 1525252918, "post_id": 50130949, "comment_id": 87280017, "body": "<a href=\"https://stackoverflow.com/q/199966/4271923\">stackoverflow.com/q/199966/4271923</a> in case you are curious."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 2, "creation_date": 1525254581, "post_id": 50130949, "comment_id": 87281099, "body": "@Ped7g: I like to link <a href=\"https://stackoverflow.com/q/38552116\">How to remove &quot;noise&quot; from GCC/clang assembly output?</a> to show how to get asm out of gcc, because very early on it has a link to Matt Godbolt&#39;s CppCon2017 talk [\u201cWhat Has My Compiler Done for Me Lately? Unbolting the Compiler&#39;s Lid\u201d ](<a href=\"https://youtu.be/bSkpMdDe4g4\" rel=\"nofollow noreferrer\">youtu.be/bSkpMdDe4g4</a>)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9585531"}, "reply_to_user": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 0, "creation_date": 1525283103, "post_id": 50130949, "comment_id": 87299453, "body": "@Ped7g i followed the link you sent me and tried changing it to intel syntax but it just created a unreadable assembly code  first I used gcc -S -masm=intel main.c then I used   gcc -S -masm=intel -fno-pic -fno-asynchronous-unwind-tables main.c because I am using a 64 bit OS but I still get the same results"}, {"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "edited": false, "score": 0, "creation_date": 1525290266, "post_id": 50130949, "comment_id": 87302978, "body": "@momonosuke &quot;Unreadable assembly code&quot;? Can you give an example or a link to such code?"}], "owner": {"user_type": "does_not_exist", "display_name": "user9585531"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "closed_date": 1525254932, "answer_count": 0, "score": 1, "last_activity_date": 1525254884, "creation_date": 1525252233, "last_edit_date": 1525254884, "question_id": 50130949, "link": "https://stackoverflow.com/questions/50130949/addl-instruction-does-something-different", "closed_reason": "Duplicate", "title": "addl instruction does something different?", "body": "<p>I am confused of the add instruction in <code>x86</code>.</p>\n\n<p>this is the original <code>c</code> code:</p>\n\n<pre><code>int a = 1;\nint b = 2;\nint c = 0;\n\nvoid add() { \nc = a + b;      \n}\n</code></pre>\n\n<p>I translated it to assembly language and got this:</p>\n\n<pre><code>add:\npushl   %ebp\nmovl    %esp, %ebp\nmovl    a, %edx\nmovl    b, %eax\naddl    %edx, %eax // add instruction\nmovl    %eax, c    // why is it stored in eax?\npopl    %ebp\nret\n</code></pre>\n\n<p>Isn't the result of <code>edx+eax</code> supposed to be stored in <code>edx</code>?\nWhy is it stored in <code>eax</code>?\nOr could it be that my compiler handles things differently?</p>\n"}, {"tags": ["c", "malloc"], "comments": [{"owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "edited": false, "score": 1, "creation_date": 1525251361, "post_id": 50130662, "comment_id": 87279097, "body": "The tool Valgrind could tell you which code line modified  the freed memory."}, {"owner": {"reputation": 117, "user_id": 9438033, "user_type": "registered", "profile_image": "https://graph.facebook.com/1887832571437464/picture?type=large", "display_name": "Cameron Shirley", "link": "https://stackoverflow.com/users/9438033/cameron-shirley"}, "reply_to_user": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "edited": false, "score": 0, "creation_date": 1525338541, "post_id": 50130662, "comment_id": 87319946, "body": "Okay I&#39;ll have a look at it and see what I find. Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 9438033, "user_type": "registered", "profile_image": "https://graph.facebook.com/1887832571437464/picture?type=large", "display_name": "Cameron Shirley", "link": "https://stackoverflow.com/users/9438033/cameron-shirley"}, "edited": false, "score": 2, "creation_date": 1525338505, "post_id": 50130729, "comment_id": 87319924, "body": "There is no call to &#39;free()&#39; in my code though, when allocating memory to my 2D array of characters i call &#39;malloc()&#39; to allocate memory to the rows first using &#39;sizeof(char*)&#39; and then i call &#39;malloc()&#39; to allocate memory to the columns using &#39;sizeof(char)&#39; inside a while loop, iterating through each row."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": false, "score": 4, "last_activity_date": 1525251488, "creation_date": 1525251488, "answer_id": 50130729, "question_id": 50130662, "link": "https://stackoverflow.com/questions/50130662/malloc-error-incorrect-checksum/50130729#50130729", "title": "malloc error: incorrect checksum", "body": "<p>Your implementation of <code>malloc()</code> does additional checks not required by the C language standard. In this case, it seems to detect that some data in a memory block was modified <strong>after</strong> it was marked as free (by a call to <code>free()</code>). That's a bug in your program.</p>\n\n<p>To find the culprit, use a memory debugging tool. For *nix systems, there is <a href=\"http://valgrind.org/\" rel=\"nofollow noreferrer\">valgrind</a>. On windows, you can use <a href=\"http://drmemory.org/\" rel=\"nofollow noreferrer\">drmemory</a>. These tools replace the memory management functions of your standard library and will notify you instantly about errors such as writing to some memory that was already <code>free()</code>d.</p>\n"}], "owner": {"reputation": 117, "user_id": 9438033, "user_type": "registered", "profile_image": "https://graph.facebook.com/1887832571437464/picture?type=large", "display_name": "Cameron Shirley", "link": "https://stackoverflow.com/users/9438033/cameron-shirley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 297, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1525251488, "creation_date": 1525251179, "last_edit_date": 1525251281, "question_id": 50130662, "link": "https://stackoverflow.com/questions/50130662/malloc-error-incorrect-checksum", "title": "malloc error: incorrect checksum", "body": "<p>I am coding in C and receiving a malloc error with the error message: </p>\n\n<pre class=\"lang-none prettyprint-override\"><code>malloc: *** error for object 0x7fe9d44026d8: incorrect checksum for freed object - object was probably modified after being freed. \n*** set a breakpoint in malloc_error_break to debug\n</code></pre>\n\n<p>The objective of my code is to store a generated maze into a 2D array from a string that stores the maze using the read() function. I am not having trouble reading the maze into the string but when I pass the string, number of rows, and number of columns as parameters to a function </p>\n\n<p>What exactly does this malloc error mean? And how can I determine which part of my code is creating this error?</p>\n"}, {"tags": ["c", "cmake", "compilation"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1525251258, "post_id": 50130463, "comment_id": 87279048, "body": "Please <i>copy-paste the error message verbatim</i>. I am pretty sure the error doesn&#39;t misspell <i>undefined</i> but I cannot check the actual error message on your computer. People using the Google search might not find your question with a misspelt error message."}, {"owner": {"reputation": 325, "user_id": 7595201, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/7b0d47b066eebc4a352551e2e346c643?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick.H", "link": "https://stackoverflow.com/users/7595201/patrick-h"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1525251899, "post_id": 50130463, "comment_id": 87279385, "body": "@AnttiHaapala sorry! Thought it might be better than a german Error description"}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1525259597, "post_id": 50130463, "comment_id": 87284432, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/43136418/how-to-add-l-ell-compiler-flag-in-cmake\">How to add &quot;-l&quot; (ell) compiler flag in CMake</a>"}, {"owner": {"reputation": 325, "user_id": 7595201, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/7b0d47b066eebc4a352551e2e346c643?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick.H", "link": "https://stackoverflow.com/users/7595201/patrick-h"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1525265484, "post_id": 50130463, "comment_id": 87288138, "body": "@Tsyvarev it is not a duplicate since he has another Problem and linking does not work because it is not selfmade"}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1525268522, "post_id": 50130463, "comment_id": 87290285, "body": "You got linking problem, which you have tried to resolve by setting <code>CMAKE_C_FLAGS</code> variable. Referenced question explains, why this approach is wrong, and provides correct approach."}, {"owner": {"reputation": 325, "user_id": 7595201, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/7b0d47b066eebc4a352551e2e346c643?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick.H", "link": "https://stackoverflow.com/users/7595201/patrick-h"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1525268920, "post_id": 50130463, "comment_id": 87290569, "body": "@Tsyvarev yes I have tried exactly what was written there but probably I am too dumb, I know it is a linking problem but I cant solve it"}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1525269006, "post_id": 50130463, "comment_id": 87290637, "body": "Have you tried <code>target_link_libraries(TEI2_A3 m)</code>, as my answer to the referenced question suggests?"}, {"owner": {"reputation": 325, "user_id": 7595201, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/7b0d47b066eebc4a352551e2e346c643?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick.H", "link": "https://stackoverflow.com/users/7595201/patrick-h"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1525269114, "post_id": 50130463, "comment_id": 87290727, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/170225/discussion-between-patrick-h-and-tsyvarev\">continue this discussion in chat</a>."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 1, "creation_date": 1525269501, "post_id": 50130463, "comment_id": 87291030, "body": "Well, more suitable duplicate question would be: <a href=\"https://stackoverflow.com/questions/34625627/adding-math-library-with-cmake\" title=\"adding math library with cmake\">stackoverflow.com/questions/34625627/&hellip;</a>."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1525270517, "post_id": 50130463, "comment_id": 87291810, "body": "You can also produce the English error with <code>LC_MESSAGES=C cmake</code> - perhaps if you can provide the 2, then even better!"}], "owner": {"reputation": 325, "user_id": 7595201, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/7b0d47b066eebc4a352551e2e346c643?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick.H", "link": "https://stackoverflow.com/users/7595201/patrick-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 383, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1525251819, "creation_date": 1525250481, "last_edit_date": 1525251819, "question_id": 50130463, "link": "https://stackoverflow.com/questions/50130463/clion-add-lm-as-parameter-to-compiler", "title": "Clion Add --lm as Parameter to compiler", "body": "<p>I am trying to compile my project for the university, everything worked fine until I had to use the <strong>sin()</strong> function. I get the error:</p>\n\n<pre><code>/home/patrick/.local/share/JetBrains/Toolbox/apps/CLion/ch-0/181.4668.70/bin/cmake/bin/cmake --build /home/patrick/CLionProjects/Aufgabe4_TEI2/cmake-build-debug --target TEI2_A3 -- -j 2\n[ 33%] Linking C executable TEI2_A3\nCMakeFiles/TEI2_A3.dir/resources/wave.c.o: In Funktion \u00bbberechneSignalWert\u00ab:\n/home/patrick/CLionProjects/Aufgabe4_TEI2/resources/wave.c:38: Warnung: undefinierter Verweis auf \u00bbsin\u00ab\ncollect2: error: ld returned 1 exit status\nCMakeFiles/TEI2_A3.dir/build.make:120: recipe for target 'TEI2_A3' failed\nmake[3]: *** [TEI2_A3] Error 1\nCMakeFiles/Makefile2:67: recipe for target 'CMakeFiles/TEI2_A3.dir/all' failed\nmake[2]: *** [CMakeFiles/TEI2_A3.dir/all] Error 2\nCMakeFiles/Makefile2:79: recipe for target 'CMakeFiles/TEI2_A3.dir/rule' failed\nmake[1]: *** [CMakeFiles/TEI2_A3.dir/rule] Error 2\nMakefile:118: recipe for target 'TEI2_A3' failed\nmake: *** [TEI2_A3] Error 2\n</code></pre>\n\n<p>The project is a Cmake-Project, I have tried the answers out of this post: <a href=\"https://stackoverflow.com/questions/30645667/clion-cmakelists-txt-add-argv-arguments-to-configuration\">CLion CMakeLists.txt add argv arguments to configuration</a> but they did not work. Below my CMakeLists.txt</p>\n\n<pre><code>cmake_minimum_required(VERSION 3.9)\nproject(TEI2_A3 C)\n\nset(CMAKE_C_STANDARD 11)\n\nset(CMAKE_C_FLAGS \"-lm\")\n\ninclude_directories(.)\ninclude_directories(./../Aufgabe4_TEI2)\nadd_executable(TEI2_A3\n        test.wav\n        main.c resources/wave.h resources/wave.c)\n</code></pre>\n\n<p>You can one of my tries still in there. I know the problem about the <strong></strong>, but I couldn't solve it yet. Does anyone have an idea how to do this in CLion?</p>\n\n<p>My file looks like this</p>\n\n<pre><code>#define _CRT_SECURE_NO_WARNINGS\n#define M_PI 3.1415926535897932384626433832795028841971\n\n#include \"wave.h\"\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;math.h&gt;\n\nvoid writePCM(char * name, float *signal, int N, wavheader header)\n{\n    FILE *fileOut = fopen(name,\"wb\");\n    chunkheader dataheader;\n\n    header.riff_chunk_header.chunk_size =\n            /*Gr\u00f6\u00dfe chunks RIFF+fmt */ sizeof(header)/*36*/ - sizeof(chunkheader) /*8*/ /*subchunk header RIFF z\u00e4hlt nicht mit*/ +\n                                       /*Gr\u00f6\u00dfe subchunk data*/ sizeof(chunkheader) /*8*/ + N*4 ;\n    fwrite(&amp;header,sizeof(header),1,fileOut);\n\n    strncpy(dataheader.chunk_id,\"data\",4);\n    dataheader.chunk_size=N*4;\n    fwrite(&amp;dataheader,sizeof(dataheader),1,fileOut);\n    fwrite(signal,4,N,fileOut);\n\n    fclose(fileOut);\n}\n//Mittelwert der Sample_Rate: 6595.007324\nfloat mittelWert(float* array){\n    float sum = 0;\n    printf(\"Number of entries: %f\\n\", array[0]);\n    for (int j = 1; j &lt; array[0]; ++j) {\n        sum += fabs(array[j] - j-1);\n    }\n    return sum/array[0];\n}\n\n\nfloat berechneSignalWert(float n, float f, float a, float r){\n    return (float) sin(f * 2 * M_PI * (n / r));\n}\n\nfloat* sinusSignal(float* N, float frequenz, float amplitude, float Abtastrate){\n    float* array;\n    for (int n = 1; n &lt;= N[0]; ++n) {\n        array[n] = berechneSignalWert(n, frequenz, amplitude, Abtastrate);\n    }\n    return array;\n}\n</code></pre>\n\n<p>The function <strong>berechneSignalWert</strong> returns the error on the <strong>sin()</strong> call</p>\n"}, {"tags": ["c++", "c", "gcc", "cross-compiling", "elf"], "comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1525252480, "post_id": 50130317, "comment_id": 87279720, "body": "I know nothing about this but intuition and a quick Google suggests it&#39;s not necessarily trivial. Have a glimmer through <a href=\"https://sourceware.org/glibc/wiki/x32\" rel=\"nofollow noreferrer\">sourceware.org/glibc/wiki/x32</a> to see whether I&#39;m on the right track."}, {"owner": {"reputation": 30085, "user_id": 89847, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/7cd132a33dda5d9ee000f59082018763?s=128&d=identicon&r=PG", "display_name": "avakar", "link": "https://stackoverflow.com/users/89847/avakar"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1525253918, "post_id": 50130317, "comment_id": 87280635, "body": "@LightnessRacesinOrbit, thanks, that&#39;s an unfortunate clash of names, that lib is still x86_64, except with short longs and pointers."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1525255685, "post_id": 50130317, "comment_id": 87281850, "body": "How do you tell the processor it&#39;s now running 32-bit code, anyway?"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1525257384, "post_id": 50130317, "comment_id": 87282997, "body": "@avakar: What other differences are you looking for? Your program still has to be written in the correct instruction set; there&#39;s no way around that"}, {"owner": {"reputation": 30085, "user_id": 89847, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/7cd132a33dda5d9ee000f59082018763?s=128&d=identicon&r=PG", "display_name": "avakar", "link": "https://stackoverflow.com/users/89847/avakar"}, "edited": false, "score": 0, "creation_date": 1525257896, "post_id": 50130317, "comment_id": 87283359, "body": "The CPU will start in 32-bit mode, but I&#39;ll be switching it to 64-bit mode (from the 32-bit portion of the code) and then transferring control to the 64-bit code. Think kernel. As such, the two parts of the binary need to see each other&#39;s symbols. This is easy to do if I write the 32-bit portion in assembly, but I&#39;d rather have C available."}], "owner": {"reputation": 30085, "user_id": 89847, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/7cd132a33dda5d9ee000f59082018763?s=128&d=identicon&r=PG", "display_name": "avakar", "link": "https://stackoverflow.com/users/89847/avakar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1525252036, "creation_date": 1525250011, "last_edit_date": 1525252036, "question_id": 50130317, "link": "https://stackoverflow.com/questions/50130317/how-do-i-link-i386-code-fragment-into-an-x86-64-elf", "title": "How do I link i386 code fragment into an x86_64 elf?", "body": "<p>When assembling using GNU assembler, I can use the <code>--x32</code> command-line option to make it output 32-bit code into a x86_64 object file. I can then happily link it with 64-bit code produced by gcc and the two see each other's symbols.</p>\n\n<p>However, I'd like to write most of the 32-bit code in C instead of assembly. Can I make gcc output 32-bit code into x86_64 object files?</p>\n"}, {"tags": ["c", "avr"], "comments": [{"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 0, "creation_date": 1525254580, "post_id": 50130142, "comment_id": 87281097, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/1641957/is-an-array-name-a-pointer\">Is an array name a pointer?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "is_accepted": true, "score": 7, "last_activity_date": 1525249703, "creation_date": 1525249703, "answer_id": 50130205, "question_id": 50130142, "link": "https://stackoverflow.com/questions/50130142/avr-c-how-does-the-const-qualifier-behaves-in-a-look-up-table-declaration/50130205#50130205", "title": "AVR C - How does the const qualifier behaves in a look up table declaration?", "body": "<blockquote>\n  <p>an array, which is a pointer</p>\n</blockquote>\n\n<p>No, <em>no</em>, <strong>no</strong>. Arrays are <strong>not</strong> pointers. A pointer is an address (usually 4 or 8 bytes on current desktop systems). An array is a sequence of contiguous objects in memory, one after the other.</p>\n\n<p>In most expressions, arrays <em>decay</em> to pointers: when you use the name of an array, it is implicitly converted to a pointer to its first element. But that is just a conversion, just like <code>1</code> converts to <code>1.0</code> when initialising a variable of type <code>double</code>.</p>\n\n<p>Given the above, the answer is clear: <code>data</code> is an array of 7 objects of type <code>const uint8_t</code>, which means its contents cannot be modified. In expressions, <code>data</code> will implicitly convert to type <code>const uint8_t *</code> (pointer to constant 8-bit unsigned integer).</p>\n"}], "owner": {"reputation": 137, "user_id": 5616939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8323c0e701c71ca4cf3a7da1a90c4c0b?s=128&d=identicon&r=PG&f=1", "display_name": "Carlos M.", "link": "https://stackoverflow.com/users/5616939/carlos-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 50130205, "answer_count": 1, "score": 1, "last_activity_date": 1525249852, "creation_date": 1525249512, "last_edit_date": 1525249852, "question_id": 50130142, "link": "https://stackoverflow.com/questions/50130142/avr-c-how-does-the-const-qualifier-behaves-in-a-look-up-table-declaration", "title": "AVR C - How does the const qualifier behaves in a look up table declaration?", "body": "<p>I found the following code in a forum and i was wondering how does the <code>const</code> qualifier behaves in it?</p>\n\n<pre><code>const uint8_t data[] = { 15, 3, 41, 76, 2, 9, 5 };\n\nval = data[5];\n</code></pre>\n\n<p>Now, as i understand the <code>const</code> qualifier makes the variable <code>data[]</code> read-only so that, in this example, the contents of the array can't be modified.\nWhat confuses me is that the qualifier is being applied to an array, which is a pointer so the contents of the array can be modified but the pointer itself can't.</p>\n\n<p>Am i right?, or is the content of the array read-only?</p>\n"}, {"tags": ["c", "arrays", "while-loop"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1525249433, "post_id": 50130076, "comment_id": 87278011, "body": "A good book on C should answer this I guess ...."}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 3, "creation_date": 1525250105, "post_id": 50130076, "comment_id": 87278356, "body": "A book on C should also tell you that <code>main()</code> returns <code>int</code>."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1525250296, "post_id": 50130076, "comment_id": 87278473, "body": "For such a simple program it would be a good idea to simply simulate the behaviour on paper or step through it in a debugger. This should reveal the logic behind."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 9729152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcb691d28c96155cca2f5588f4209959?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Fitzpatrick", "link": "https://stackoverflow.com/users/9729152/aaron-fitzpatrick"}, "edited": false, "score": 0, "creation_date": 1525250120, "post_id": 50130190, "comment_id": 87278366, "body": "Cool thanks I&#39;ll have another look now, I had never read about dereferencing before, I clearly have a lot to learn. Thank you for the help!"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1525250263, "post_id": 50130190, "comment_id": 87278451, "body": "Good! don&#39;t forget to accept the answer if it solved your problem"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": true, "score": 3, "last_activity_date": 1525249662, "creation_date": 1525249662, "answer_id": 50130190, "question_id": 50130076, "link": "https://stackoverflow.com/questions/50130076/copying-one-array-to-another-using-a-while-loop/50130190#50130190", "title": "Copying one array to another using a while loop", "body": "<p>Things to know:</p>\n\n<ul>\n<li><p><code>*aa</code> dereferences the pointer <code>aa</code>, so accesses the element <code>aa</code> is pointing to right now</p></li>\n<li><p><code>aa++</code> increments <code>aa</code> by one. as <code>aa</code> is a pointer, it now points to the <strong>next</strong> element. This happens <strong>after</strong> evaluation.</p></li>\n<li><p>a <strong>string</strong> in C always ends with a <code>0</code> byte.</p></li>\n<li><p>in a <strong>boolean</strong> context, <code>0</code> is <em>false</em> and any other value is <em>true</em></p></li>\n<li><p>an <strong>assignment</strong> evaluates to the value that was assigned.</p></li>\n</ul>\n\n<p>So, when walking through your strings, eventually <code>*aa</code> will be <code>0</code> (the end of the string), which makes the whole expression <code>(*bb++ = *aa++)</code> have the value of <code>0</code> -- inside the <code>while</code> condition, this is false, causing the loop to exit.</p>\n"}], "owner": {"reputation": 23, "user_id": 9729152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcb691d28c96155cca2f5588f4209959?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Fitzpatrick", "link": "https://stackoverflow.com/users/9729152/aaron-fitzpatrick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 200, "favorite_count": 0, "accepted_answer_id": 50130190, "answer_count": 1, "score": 1, "last_activity_date": 1525249662, "creation_date": 1525249288, "question_id": 50130076, "link": "https://stackoverflow.com/questions/50130076/copying-one-array-to-another-using-a-while-loop", "title": "Copying one array to another using a while loop", "body": "<p>I came across the following piece of code that is supposed takes two different character arrays, copy one to another and then print them out;</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nvoid main()\n{\n  char a[15] = \"hello\";\n  char b[15] = \"goodbye\";\n  char * aa = a, *bb = b;\n  while ( (*bb++ = *aa++) );\n  printf(\"%s,%s\\n\",a,b);\n}\n</code></pre>\n\n<p>I'm not sure how the while statement is working here. It looks like it is copying the address of b to that of a, but I really don't know the underlying workings of what is going on here. Any help understanding this would be appreciated.</p>\n"}, {"tags": ["c", "arrays", "data-structures", "struct"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1525249062, "post_id": 50129998, "comment_id": 87277792, "body": "Use a variable to keep track of it?"}, {"owner": {"reputation": 160, "user_id": 8770494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/25C1x.jpg?s=128&g=1", "display_name": "P47 R1ck", "link": "https://stackoverflow.com/users/8770494/p47-r1ck"}, "edited": false, "score": 0, "creation_date": 1525300909, "post_id": 50129998, "comment_id": 87307344, "body": "@FelixPalmen That&#39;s how I do, already. Is the most reasonable solution."}], "answers": [{"comments": [{"owner": {"reputation": 160, "user_id": 8770494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/25C1x.jpg?s=128&g=1", "display_name": "P47 R1ck", "link": "https://stackoverflow.com/users/8770494/p47-r1ck"}, "edited": false, "score": 0, "creation_date": 1525300849, "post_id": 50130066, "comment_id": 87307320, "body": "Yes thanks. I think I remain at the idea of using a counter variable"}], "tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": false, "score": 0, "last_activity_date": 1525249256, "creation_date": 1525249256, "answer_id": 50130066, "question_id": 50129998, "link": "https://stackoverflow.com/questions/50129998/find-number-of-records-in-an-array-of-structures/50130066#50130066", "title": "Find number of records in an array of structures", "body": "<p>You can't, C doesn't have a way of knowing if a variable \"has a value\". All values are values, and no value is more real than any else.</p>\n\n<p>The answer is that additional state, i.e. some form of counter variable, is required to hold this information. Typically you use that when inserting new records, to know where the next record should go.</p>\n"}, {"comments": [{"owner": {"reputation": 160, "user_id": 8770494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/25C1x.jpg?s=128&g=1", "display_name": "P47 R1ck", "link": "https://stackoverflow.com/users/8770494/p47-r1ck"}, "edited": false, "score": 0, "creation_date": 1525249622, "post_id": 50130075, "comment_id": 87278117, "body": "So for array structures I can not use any strlen() like function?"}, {"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "reply_to_user": {"reputation": 160, "user_id": 8770494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/25C1x.jpg?s=128&g=1", "display_name": "P47 R1ck", "link": "https://stackoverflow.com/users/8770494/p47-r1ck"}, "edited": false, "score": 0, "creation_date": 1525250125, "post_id": 50130075, "comment_id": 87278373, "body": "@P47R1ck <code>strlen</code> works on a NUL-terminated string. That is a buffer of characters whose last element is <code>0</code>. If you have a <code>char x[10]</code> with random content, <code>strlen</code> will not work on it either. If you introduce a similar convention for your array (such as the terminator having <code>parameter == 0</code> or <code>parameter == ~0u</code>), you can build a function equivalent to <code>strlen</code>. I will add this to the answer."}], "tags": [], "owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "is_accepted": true, "score": 1, "last_activity_date": 1525250346, "last_edit_date": 1525250346, "creation_date": 1525249288, "answer_id": 50130075, "question_id": 50129998, "link": "https://stackoverflow.com/questions/50129998/find-number-of-records-in-an-array-of-structures/50130075#50130075", "title": "Find number of records in an array of structures", "body": "<p>C arrays are fixed-size: there are always exactly 50 objects in your array. If your program logic requires some of them to be \"inactive\" (e.g. not written yet), you must keep track of such information separately. For example, you could use a <code>size_t</code> variable to store the number of \"valid\" entries in the array.</p>\n\n<p>An alternative would be to designate a value of <code>remoteInstructionReceived_t</code> as a terminator, similarly to how <code>0</code> is used as a terminator for NUL-terminated strings. Then, you wouldn't have to track the \"useful length\" of the array separately, but you'd have to ensure a terminator always follows the last valid item in it.</p>\n\n<p>In general, length-tracking is likely both more efficient and more maintainable. I am only mentioning the second (terminator) option out of a sense of completeness.</p>\n"}, {"tags": [], "owner": {"reputation": 366, "user_id": 5090973, "user_type": "registered", "profile_image": "https://graph.facebook.com/709878705790690/picture?type=large", "display_name": "Bruno Silva", "link": "https://stackoverflow.com/users/5090973/bruno-silva"}, "is_accepted": false, "score": 0, "last_activity_date": 1525445281, "creation_date": 1525445281, "answer_id": 50177636, "question_id": 50129998, "link": "https://stackoverflow.com/questions/50129998/find-number-of-records-in-an-array-of-structures/50177636#50177636", "title": "Find number of records in an array of structures", "body": "<p>Have you considered using a different data structure? You can wrap your structure to allow the creation of a linked list, for example. The deletion would be real just by freeing memory. Besides, it's more efficient for some kinds of operation, such as addin elements in the middle of the list.</p>\n"}], "owner": {"reputation": 160, "user_id": 8770494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/25C1x.jpg?s=128&g=1", "display_name": "P47 R1ck", "link": "https://stackoverflow.com/users/8770494/p47-r1ck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "accepted_answer_id": 50130075, "answer_count": 3, "score": 1, "last_activity_date": 1525445281, "creation_date": 1525249023, "last_edit_date": 1525300724, "question_id": 50129998, "link": "https://stackoverflow.com/questions/50129998/find-number-of-records-in-an-array-of-structures", "title": "Find number of records in an array of structures", "body": "<p>Suppose we have a structure array of up to 50 elements that will be added in turn from a buffer write function. How do I find the current number of recordings made in array if the maximum number of items has not been reached?</p>\n\n<pre><code>typedef struct\n{\n    remoteInstructionReceived_t instruction;\n    uint16_t parameter;\n} instructionData_type;\n\nremoteInstructionReceived_t commandBuffer[50];\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 3, "creation_date": 1525247395, "post_id": 50129522, "comment_id": 87276926, "body": "<code>main()</code> --&gt; <code>int main(void)</code>"}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 4, "creation_date": 1525247448, "post_id": 50129522, "comment_id": 87276955, "body": "<i>&quot;C syntax is nothing like what I&#39;m used to - so what is the remedy for this?&quot;</i> - old wisdom would say that you should learn C syntax."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1525247884, "post_id": 50129522, "comment_id": 87277163, "body": "You know how it should look like with function <code>func</code>. What is the problem applying the same knowledge to function <code>main</code>?"}, {"owner": {"reputation": 265, "user_id": 2170009, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0c2eda2a692663ca1d552faf3b9a7c57?s=128&d=identicon&r=PG", "display_name": "mistermarko", "link": "https://stackoverflow.com/users/2170009/mistermarko"}, "reply_to_user": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1525248151, "post_id": 50129522, "comment_id": 87277288, "body": "@Groo I have a weird feeling I was in the process of doing that..."}, {"owner": {"reputation": 290, "user_id": 7427772, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/110ca972b1adb456c71100a18b1cf3d3?s=128&d=identicon&r=PG&f=1", "display_name": "Nark", "link": "https://stackoverflow.com/users/7427772/nark"}, "edited": false, "score": 0, "creation_date": 1525248446, "post_id": 50129522, "comment_id": 87277454, "body": "Btw, the only purpose of a <code>static</code> is to make your variable accessible from other .c file you&#39;ll be using to compile your program."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 290, "user_id": 7427772, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/110ca972b1adb456c71100a18b1cf3d3?s=128&d=identicon&r=PG&f=1", "display_name": "Nark", "link": "https://stackoverflow.com/users/7427772/nark"}, "edited": false, "score": 0, "creation_date": 1525250040, "post_id": 50129522, "comment_id": 87278326, "body": "@Nofix You mean the opposite, I guess. Adding <code>static</code> makes it non-accessible for other .c files."}, {"owner": {"reputation": 290, "user_id": 7427772, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/110ca972b1adb456c71100a18b1cf3d3?s=128&d=identicon&r=PG&f=1", "display_name": "Nark", "link": "https://stackoverflow.com/users/7427772/nark"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1525251763, "post_id": 50129522, "comment_id": 87279309, "body": "@Gerhardh Indeed, I meant the opposite, sorry."}], "answers": [{"comments": [{"owner": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "edited": false, "score": 0, "creation_date": 1525249412, "post_id": 50129575, "comment_id": 87277993, "body": "If your program runs in a hosted environment, arguments to main could be useful. For example filenames  The exact declaration of main looks like this:  int main(int argc, char *argv[]);"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "edited": false, "score": 0, "creation_date": 1525250173, "post_id": 50129575, "comment_id": 87278397, "body": "@Mike If the program does not use any parameters, there is no need to have a parameter to <code>main</code>. Therefore <code>int main (void)</code> is a valid version as well. But the empty parameter list is deprecated nowadays."}], "tags": [], "owner": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "is_accepted": true, "score": 4, "last_activity_date": 1525247486, "creation_date": 1525247486, "answer_id": 50129575, "question_id": 50129522, "link": "https://stackoverflow.com/questions/50129522/how-can-i-specify-the-correct-return-type/50129575#50129575", "title": "How can I specify the correct &#39;return type&#39;?", "body": "<p>You need to specify the return type for <code>main()</code></p>\n\n<pre><code>int main()\n</code></pre>\n\n<p>It's also a good idea to explicitly state that <code>main()</code> takes no arguments</p>\n\n<pre><code>int main(void)\n</code></pre>\n"}], "owner": {"reputation": 265, "user_id": 2170009, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0c2eda2a692663ca1d552faf3b9a7c57?s=128&d=identicon&r=PG", "display_name": "mistermarko", "link": "https://stackoverflow.com/users/2170009/mistermarko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "closed_date": 1525247775, "accepted_answer_id": 50129575, "answer_count": 1, "score": 0, "last_activity_date": 1525249329, "creation_date": 1525247253, "last_edit_date": 1525249329, "question_id": 50129522, "link": "https://stackoverflow.com/questions/50129522/how-can-i-specify-the-correct-return-type", "closed_reason": "Duplicate", "title": "How can I specify the correct &#39;return type&#39;?", "body": "<p>I have a <code>C</code> program which produces the error message:</p>\n\n<blockquote>\n  <p>p3-static-store-class.c:5:1 warning: return type defaults to 'int' [- \n      Wimplicit-int] main()</p>\n</blockquote>\n\n<p>with warning highlighted and a arrow highlighting the m in <code>main()</code>. The code is:  </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n/* function declaration */\nvoid func(void);\nstatic int count = 5; /* global variable */\nmain()\n{\n    while(count--)\n    {\n        func();\n    }\n    return 0;\n}\n\n/* function definition */\nvoid func(void)\n{\n    static int i = 5; /* local static variable */\n    i++;\n    printf(\"i is %d and count is %d\\n\", i, count);\n}\n</code></pre>\n\n<p>My attempt at specifying the return type produced a list of error messages, and <code>C</code> syntax is nothing like what I'm used to - so what is the remedy for this?</p>\n"}, {"tags": ["c", "callback", "raku", "nativecall"], "comments": [{"owner": {"reputation": 18919, "user_id": 891440, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/dd366bcdcf85991fa8af1b6d11d3ad49?s=128&d=identicon&r=PG", "display_name": "jjmerelo", "link": "https://stackoverflow.com/users/891440/jjmerelo"}, "reply_to_user": {"reputation": 25859, "user_id": 1077672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f00f8b55b0ade2c4748e94fb73a40662?s=128&d=identicon&r=PG", "display_name": "raiph", "link": "https://stackoverflow.com/users/1077672/raiph"}, "edited": false, "score": 1, "creation_date": 1525276169, "post_id": 50129510, "comment_id": 87295650, "body": "@raiph I don&#39;t know why I got that impression. Noted and changed. Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 1313, "user_id": 8087170, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osoUb.jpg?s=128&g=1", "display_name": "Fernando Santagata", "link": "https://stackoverflow.com/users/8087170/fernando-santagata"}, "edited": false, "score": 0, "creation_date": 1525337122, "post_id": 50142294, "comment_id": 87319021, "body": "Your solution works using an int32, but I wanted to allow the module users to pass any kind of data, so I prefer something like a Buf or Blob. Elsewhere I successfully used a Buf when the C declaration type was a void *, hence that was the first thing I tried here."}], "tags": [], "owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "is_accepted": true, "score": 4, "last_activity_date": 1525337942, "last_edit_date": 1525337942, "creation_date": 1525289846, "answer_id": 50142294, "question_id": 50129510, "link": "https://stackoverflow.com/questions/50129510/how-to-pass-user-data-to-a-callback-function/50142294#50142294", "title": "How to pass user data to a callback function", "body": "<p>I am not sure how to pass a <code>Buf</code> as user data since <code>Buf</code> is not a native type. But you could use for instance a <code>CStruct</code> instead:</p>\n\n<pre><code>class UserData is repr('CStruct') {\n    has int32 $.dummy;\n}\n</code></pre>\n\n<p>Then the declaration would be:</p>\n\n<pre><code>sub exif_content_foreach_entry(\n    ExifContent $exifcontent, \n    &amp;func (ExifEntry $entry, UserData $data),\n    UserData $user_data) is native(LIB) is export { * }\n</code></pre>\n\n<p>And the callback can be declared and defined as for example:</p>\n\n<pre><code>sub my-callback (ExifEntry $entry, UserData $data) {\n    say \"In callback\";\n    say \"Value of data: \", $data.dummy;\n}\n</code></pre>\n\n<p><strong>Edit</strong>: </p>\n\n<p>Here is a workaround to pass a Perl 6 type like <code>Buf</code> (i.e not a native type) to the callback using a closure. For example:</p>\n\n<pre><code>my $buf = Buf.new( 1, 2, 3);\nmy $callback = my sub (ExifEntry $entry, UserData $data) {\n    my-callback( $entry, $buf);\n}\n</code></pre>\n\n<p>Then declare the real callback <code>my-callback</code> like this:</p>\n\n<pre><code>sub my-callback (ExifEntry $entry, Buf $data) {\n    say \"In callback\";\n    say \"Value of data: \", $data;\n}\n</code></pre>\n\n<p>And call the library function like this:</p>\n\n<pre><code>exif_content_foreach_entry( $content, &amp;$callback, $data );\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1313, "user_id": 8087170, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osoUb.jpg?s=128&g=1", "display_name": "Fernando Santagata", "link": "https://stackoverflow.com/users/8087170/fernando-santagata"}, "edited": false, "score": 0, "creation_date": 1554803605, "post_id": 55526904, "comment_id": 97876719, "body": "Interesting module! Though in my case what I have to pass along is a Perl6 Str, not a native value, so if I have understood it right, I can&#39;t use your module."}, {"owner": {"reputation": 2965, "user_id": 5548927, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/56e4d9e2488329026ab4b65d05cda3fb?s=128&d=identicon&r=PG", "display_name": "Curt Tilmes", "link": "https://stackoverflow.com/users/5548927/curt-tilmes"}, "reply_to_user": {"reputation": 1313, "user_id": 8087170, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osoUb.jpg?s=128&g=1", "display_name": "Fernando Santagata", "link": "https://stackoverflow.com/users/8087170/fernando-santagata"}, "edited": false, "score": 0, "creation_date": 1554805662, "post_id": 55526904, "comment_id": 97877936, "body": "That should be fine -- Just <code>cb.store()</code> the Str associated with your C object pointer, then register the callback with the <code>cb.id()</code> of that pointer.  Then call <code>cb.lookup()</code> in the callback and it will return the Str."}, {"owner": {"reputation": 1313, "user_id": 8087170, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osoUb.jpg?s=128&g=1", "display_name": "Fernando Santagata", "link": "https://stackoverflow.com/users/8087170/fernando-santagata"}, "edited": false, "score": 0, "creation_date": 1554824189, "post_id": 55526904, "comment_id": 97889506, "body": "In my case I have no C object pointer: the C function I call has three arguments: a first argument which will be scanned internally, a callback function which is called when the scanner finds something and an additional pointer. The function will pass that pointer &quot;as is&quot; to the callback. I want to pass a Str variable to the function, which in turn will pass it to the callback. [continues]"}, {"owner": {"reputation": 1313, "user_id": 8087170, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osoUb.jpg?s=128&g=1", "display_name": "Fernando Santagata", "link": "https://stackoverflow.com/users/8087170/fernando-santagata"}, "edited": false, "score": 0, "creation_date": 1554824203, "post_id": 55526904, "comment_id": 97889514, "body": "<code>cb.store()</code> expects two arguments, but I have just one Str variable; if I try something like <code>cb.store($var, $var)</code> I get an error: <code>Native call expected return type with CPointer, CStruct, CArray, or VMArray representation, but got a P6opaque (Str)</code>. It comes from the <code>cb.id()</code> method invoked by <code>cb.store()</code> which tries to call <code>nativecast(int64, $thing)</code> passing along the Str."}, {"owner": {"reputation": 2965, "user_id": 5548927, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/56e4d9e2488329026ab4b65d05cda3fb?s=128&d=identicon&r=PG", "display_name": "Curt Tilmes", "link": "https://stackoverflow.com/users/5548927/curt-tilmes"}, "reply_to_user": {"reputation": 1313, "user_id": 8087170, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osoUb.jpg?s=128&g=1", "display_name": "Fernando Santagata", "link": "https://stackoverflow.com/users/8087170/fernando-santagata"}, "edited": false, "score": 0, "creation_date": 1554827835, "post_id": 55526904, "comment_id": 97891406, "body": "Hmm.. I&#39;ve always got some C thing I want to associate the callback with.  Then within the callback, it uses that thing to find the data.  Usually something I associate with a Perl CStruct or CPointer, some sort of handle that the callback gets to tell apart multiple instances."}], "tags": [], "owner": {"reputation": 2965, "user_id": 5548927, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/56e4d9e2488329026ab4b65d05cda3fb?s=128&d=identicon&r=PG", "display_name": "Curt Tilmes", "link": "https://stackoverflow.com/users/5548927/curt-tilmes"}, "is_accepted": false, "score": 3, "last_activity_date": 1554426174, "creation_date": 1554426174, "answer_id": 55526904, "question_id": 50129510, "link": "https://stackoverflow.com/questions/50129510/how-to-pass-user-data-to-a-callback-function/55526904#55526904", "title": "How to pass user data to a callback function", "body": "<p>I realize this is an old question and you've probably implemented workarounds long ago, but in the interest of catching others with a similar issue, I'll post my answer now.</p>\n\n<p>I've had to do this several times for different <code>NativeCall</code> library interfaces, so I decided to package it up into a <a href=\"https://github.com/CurtTilmes/perl6-nativehelpers-callback\" rel=\"nofollow noreferrer\">NativeHelpers::Callback</a> module.</p>\n\n<p>It provides some simple methods to associate a perl object with an <code>CPointer</code> and easily look it up from within a callback function.</p>\n\n<p>This is all untested, but something like this should work for your case:</p>\n\n<pre><code>use NativeHelpers::Callback :cb;                                                \n\nclass ExifEntry is repr('CPointer') { ... }                                     \n\nsub exif_content_foreach_entry(ExifContent $exifcontent,                        \n    &amp;func (ExifEntry $entry, int64), int64) is native(LIB) is export { * }      \n\nclass MyPerlObject {                                                            \n    has $.entry;                                                                \n    has Buf $.buf;                                                              \n    ...                                                                         \n}                                                                               \n\nsub MyCallBack(ExifEntry $entry, int64 $id) {                                   \n    my MyPerlObject $object = cb.lookup($id);\n    ... do stuff with $object ...                                   \n}                                                                               \n\nmy ExifEntry $entry = ...;                                                      \n\nmy MyPerlObject $object = MyPerlObject.new(:$entry, buf =&gt; ...);                \ncb.store($object, $entry);                                                      \nexif_content_foreach_entry($exifcontent, &amp;MyCallBack, cb.id($entry));           \n</code></pre>\n"}], "owner": {"reputation": 1313, "user_id": 8087170, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osoUb.jpg?s=128&g=1", "display_name": "Fernando Santagata", "link": "https://stackoverflow.com/users/8087170/fernando-santagata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 668, "favorite_count": 1, "accepted_answer_id": 50142294, "answer_count": 2, "score": 7, "last_activity_date": 1574835311, "creation_date": 1525247194, "last_edit_date": 1574835311, "question_id": 50129510, "link": "https://stackoverflow.com/questions/50129510/how-to-pass-user-data-to-a-callback-function", "title": "How to pass user data to a callback function", "body": "<p>I'm working on a NativeCall interface; there's a C function which accepts a callback, defined as:</p>\n\n<pre><code>typedef void (* ExifContentForeachEntryFunc) (ExifEntry *, void *user_data);\nvoid exif_content_foreach_entry (ExifContent *content, ExifContentForeachEntryFunc func, void *user_data);\n</code></pre>\n\n<p>My first take has been:</p>\n\n<pre><code>sub exif_content_foreach_entry(ExifContent $exifcontent, &amp;func (ExifEntry $entry, Buf $data), Buf $user_data) is native(LIB) is export { * }\n</code></pre>\n\n<p>but when invoked this function generates an error:</p>\n\n<pre><code>Internal error: unhandled dyncall callback argument type\n  in method CALL-ME at /opt/rakudo-pkg/share/perl6/sources/24DD121B5B4774C04A7084827BFAD92199756E03 (NativeCall) line 588\n</code></pre>\n\n<p>If I ignore the user_data argument, everything works, so the rest of the declaration is fine: I just don't get to pass any additional data to the callback function.</p>\n\n<p>On other occasions I used a Buf to pass a block of (possibly) binary data to a C function and it worked; the difference here is the callback function.\nAny idea how to solve this problem?</p>\n\n<p>(using perl6 2018.03)</p>\n"}, {"tags": ["c", "language-lawyer", "undefined-behavior", "string-literals", "memcmp"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 2, "creation_date": 1525247141, "post_id": 50129072, "comment_id": 87276823, "body": "Nitpick, but you didn&#39;t compare the literals. You compare two local arrays with the same content as the literals."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 2, "creation_date": 1525247198, "post_id": 50129072, "comment_id": 87276841, "body": "@StoryTeller: Smartypants ;-)"}], "answers": [{"comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1525246753, "post_id": 50129141, "comment_id": 87276616, "body": "While true, a standard library implementer that continues processing after the result is known, is a bad implementer... and they should feel bad."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 3, "creation_date": 1525247193, "post_id": 50129141, "comment_id": 87276838, "body": "When asking about undefined behavior, expect the worst possible library, compiler and machine architecture and, of course, the most idiotic implementations :)"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 2, "creation_date": 1525247240, "post_id": 50129141, "comment_id": 87276865, "body": "@StoryTeller: I&#39;m wondering though with increasing use of parallelisation whether or not future implementations could make gains by reading ahead."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1525247482, "post_id": 50129141, "comment_id": 87276965, "body": "@Bathsheba - Mmm.. haven&#39;t thought about that. My mind is often stuck in a single flow of control mentality. But still, not to return asap and continue processing intentionally... should still make our library implementer feel bad."}, {"owner": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "edited": false, "score": 0, "creation_date": 1525247551, "post_id": 50129141, "comment_id": 87276992, "body": "I guess the only way to be save is to check the length of the string in advance before doing the memcmp()"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "edited": false, "score": 0, "creation_date": 1525247632, "post_id": 50129141, "comment_id": 87277028, "body": "@Mike Or, of course, use <code>strcmp()</code>? :) Searching for the <code>NUL</code> byte, so you can use a function that doesn&#39;t check for <code>NUL</code> bytes, seems <i>kind of</i> silly."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1525247662, "post_id": 50129141, "comment_id": 87277045, "body": "@FelixPalmen - Radical idea, that is ;)"}, {"owner": {"reputation": 17446, "user_id": 311635, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0d4907cea9d97688aa7a5e722d742f71?s=128&d=identicon&r=PG", "display_name": "Rudi", "link": "https://stackoverflow.com/users/311635/rudi"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 4, "creation_date": 1525248525, "post_id": 50129141, "comment_id": 87277502, "body": "@StoryTeller The library is not required to access the memory via char pointers. It is more likely that the library is designed to access the memory with 34 or 64 bit width as long as the rest sequence is wide enough and aligned correctly, and only the wrong aligned first bytes, and the last bytes not fitting into this size are compared on single byte granularity. It is very likely that in this example the memory is compared with one single 32bit comparison."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 17446, "user_id": 311635, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0d4907cea9d97688aa7a5e722d742f71?s=128&d=identicon&r=PG", "display_name": "Rudi", "link": "https://stackoverflow.com/users/311635/rudi"}, "edited": false, "score": 0, "creation_date": 1525248748, "post_id": 50129141, "comment_id": 87277633, "body": "@Rudi - You are of course correct, but I didn&#39;t assume single byte granularity. Even at 64 bit access, assuming the two objects are large enough, continuing redundant access after the result is obtained (in however many instructions) is still silly."}, {"owner": {"reputation": 17446, "user_id": 311635, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0d4907cea9d97688aa7a5e722d742f71?s=128&d=identicon&r=PG", "display_name": "Rudi", "link": "https://stackoverflow.com/users/311635/rudi"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1525249348, "post_id": 50129141, "comment_id": 87277959, "body": "@StoryTeller Assuming a 32bit system and that both strings are aligned at a 32bit border on the stack, the out of bound access happens on the first comparison, since <code>str2</code> does not fit entirely into the first 32bits."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 17446, "user_id": 311635, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0d4907cea9d97688aa7a5e722d742f71?s=128&d=identicon&r=PG", "display_name": "Rudi", "link": "https://stackoverflow.com/users/311635/rudi"}, "edited": false, "score": 0, "creation_date": 1525249398, "post_id": 50129141, "comment_id": 87277988, "body": "@Rudi - For those two strings, sure. I was commenting in broader strokes."}, {"owner": {"reputation": 1459, "user_id": 5410505, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XNWBi.png?s=128&g=1", "display_name": "kamikaze", "link": "https://stackoverflow.com/users/5410505/kamikaze"}, "edited": false, "score": 0, "creation_date": 1525327234, "post_id": 50129141, "comment_id": 87313974, "body": "Wow, this is insane!"}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 11, "last_activity_date": 1525245967, "last_edit_date": 1525245967, "creation_date": 1525245737, "answer_id": 50129141, "question_id": 50129072, "link": "https://stackoverflow.com/questions/50129072/comparing-two-string-literals-using-memcmp/50129141#50129141", "title": "Comparing two string literals using memcmp", "body": "<p>The behaviour of your code is undefined. The C standard does not require that <code>memcmp</code> returns as soon as the result is known; that is it doesn't <em>necessarily</em> have to return when <code>\\0</code> is compared with <code>'c'</code> despite the value of <code>'c' == '\\0'</code> being <code>0</code> for any character encoding supported by the language. The standard also doesn't specify the order in which the lexicographical comparisons are to be made (although it would be tricky for an implementation <em>not</em> to start from the beginning).</p>\n\n<p><code>str2</code> is a <code>char[3]</code> type. It's possible that an attempt to access the 4th element is made.</p>\n\n<p>Reference: <a href=\"http://en.cppreference.com/w/c/string/byte/memcmp\" rel=\"noreferrer\">http://en.cppreference.com/w/c/string/byte/memcmp</a></p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1525246924, "post_id": 50129390, "comment_id": 87276696, "body": "1.)  the size of <code>str2</code> is <code>3</code>, not <code>2</code> 2.) please add a reference for your citation."}, {"owner": {"reputation": 328, "user_id": 9591612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CNYpQ.jpg?s=128&g=1", "display_name": "Sandeep", "link": "https://stackoverflow.com/users/9591612/sandeep"}, "edited": false, "score": 0, "creation_date": 1525247484, "post_id": 50129390, "comment_id": 87276968, "body": "@FelixPalmen 2 represents number of bytes you want to compare. It is not length of string."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1525247583, "post_id": 50129390, "comment_id": 87277009, "body": "And <code>str2</code> holds three(!) bytes. So your choice of <code>2</code> is kind of random. Still, my second remark was the more important one -- where&#39;s that citation from?"}, {"owner": {"reputation": 328, "user_id": 9591612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CNYpQ.jpg?s=128&g=1", "display_name": "Sandeep", "link": "https://stackoverflow.com/users/9591612/sandeep"}, "edited": false, "score": 0, "creation_date": 1525247923, "post_id": 50129390, "comment_id": 87277181, "body": "@FelixPalmen I see what you mean. Corrected my answer. Thanks."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1525247997, "post_id": 50129390, "comment_id": 87277218, "body": "Thanks, but what about <b>the source of your citation</b>? I didn&#39;t find this in the C standard description of <code>memcmp()</code>, so I&#39;m <b>really</b> curious where it comes from."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1525252797, "post_id": 50129390, "comment_id": 87279925, "body": "That <code>MIN</code> macro is gonna end up calling <code>strlen</code> two times for one of the two strings, for no reason"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1525275731, "post_id": 50129390, "comment_id": 87295374, "body": "IMHO, the C Standard could benefit from having a few more variations on memcmp, including ones which return a pointer to the first difference, or simply report whether two blocks are equal, and possibly allowing code to indicate whether to optimize for blocks whose early portion matches, or those whose early portion does not match (if blocks are expected to be equal, and code doesn&#39;t care which block is &quot;higher&quot;, using <code>diffs |= (*p1++ ^ *p2++)</code> and testing <code>diffs</code> at the end may be faster than branching after each comparison)."}], "tags": [], "owner": {"reputation": 328, "user_id": 9591612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CNYpQ.jpg?s=128&g=1", "display_name": "Sandeep", "link": "https://stackoverflow.com/users/9591612/sandeep"}, "is_accepted": false, "score": -2, "last_activity_date": 1525252054, "last_edit_date": 1525252054, "creation_date": 1525246773, "answer_id": 50129390, "question_id": 50129072, "link": "https://stackoverflow.com/questions/50129072/comparing-two-string-literals-using-memcmp/50129390#50129390", "title": "Comparing two string literals using memcmp", "body": "<p>Yes, behavior of your code is undefined. However, as long as you are using <code>if (memcmp(str1, str2, 3) == 0)</code> (note that byte count is 3 instead of 4. I.e. minimum of two), behavior of your code would be acceptable and correct. </p>\n\n<blockquote>\n  <p>The behavior is undefined if access occurs beyond the end of either object pointed to by lhs and rhs. The behavior is undefined if either lhs or rhs is a null pointer.</p>\n</blockquote>\n\n<p>In case of strcmp, it stops as soon as if finds <code>\\0</code>. However, for memcmp, </p>\n\n<blockquote>\n  <p>it is flawed assumption, that memcmp compares byte-by-byte and does not look at bytes beyond the first point of difference. The memcmp function makes no such guarantee. It is permitted to read all the bytes from both buffers before reporting the result of the comparison.</p>\n</blockquote>\n\n<p>So, I would write my code like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n#define MIN(X, Y) (((X) &lt; (Y)) ? (X) : (Y))\n\nint main() \n{\n  char str1[] = \"abcd\";\n  char str2[] = \"ab\";\n  int charsToCompare = MIN(strlen(str1), strlen(str2)) + 1;\n\n  if (memcmp(str1, str2, charsToCompare) == 0) \n  {\n    printf(\"equal string\\n\");\n  }\n  return 0;\n}\n</code></pre>\n\n<p>More details and analysis on <code>memcmp</code> can be found <a href=\"https://blogs.msdn.microsoft.com/oldnewthing/20101014-00/?p=12533\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 30168, "user_id": 5612562, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/gzBQY.jpg?s=128&g=1", "display_name": "msc", "link": "https://stackoverflow.com/users/5612562/msc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 995, "favorite_count": 1, "accepted_answer_id": 50129141, "answer_count": 2, "score": 8, "last_activity_date": 1525272067, "creation_date": 1525245471, "last_edit_date": 1525272067, "question_id": 50129072, "link": "https://stackoverflow.com/questions/50129072/comparing-two-string-literals-using-memcmp", "title": "Comparing two string literals using memcmp", "body": "<p>I have compared two string literals using the <code>memcmp</code> function. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main() \n{\n  char str1[] = \"abcd\";\n  char str2[] = \"ab\";\n\n  if (memcmp(str1, str2, 4) == 0) \n  {\n    printf(\"equal string\\n\");\n  }\n  return 0;\n}\n</code></pre>\n\n<p>In the above program, <code>str2</code> is shorter than the <code>str1</code>. It means string <code>str2</code> is accessed out of bounds.</p>\n\n<p>So, is this undefined behavior? </p>\n"}, {"tags": ["c", "arrays", "vector", "dynamic-memory-allocation"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1525245167, "post_id": 50128851, "comment_id": 87275751, "body": "Don&#39;t be a <a href=\"http://wiki.c2.com/?ThreeStarProgrammer\" rel=\"nofollow noreferrer\">Three Star Programmer</a>. Oh, and a pointer to a pointer is <b>not</b> a 2d-Array ..."}, {"owner": {"reputation": 33, "user_id": 9523910, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YupPQcpqQbM/AAAAAAAAAAI/AAAAAAAAAbA/Cq1kafKUd0g/photo.jpg?sz=128", "display_name": "Ultraviolence", "link": "https://stackoverflow.com/users/9523910/ultraviolence"}, "edited": false, "score": 0, "creation_date": 1525245325, "post_id": 50128851, "comment_id": 87275841, "body": "I was just introduced in class to pointers and my homework spesficially demands us to use three stars...sorry if it&#39;s dumb"}, {"owner": {"reputation": 4251, "user_id": 4605105, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-_cFfGx1khYs/AAAAAAAAAAI/AAAAAAAAGt0/vfQ_28nwAEE/photo.jpg?sz=128", "display_name": "&#212;rel", "link": "https://stackoverflow.com/users/4605105/%c3%94rel"}, "edited": false, "score": 0, "creation_date": 1525245329, "post_id": 50128851, "comment_id": 87275843, "body": "Use warnings, for example ` warning: format \u2018%d\u2019 expects argument of type \u2018int\u2019, but argument 2 has type \u2018int *\u2019 [-Wformat=]          printf(&quot;%d &quot;, *(sizes + j));`"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1525245955, "post_id": 50128851, "comment_id": 87276193, "body": "@Ultraviolence it&#39;s considered a <i>code smell</i> by many. of course you can make it work anyways -- just not a great idea, a different design would be better :)"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 9523910, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YupPQcpqQbM/AAAAAAAAAAI/AAAAAAAAAbA/Cq1kafKUd0g/photo.jpg?sz=128", "display_name": "Ultraviolence", "link": "https://stackoverflow.com/users/9523910/ultraviolence"}, "edited": false, "score": 0, "creation_date": 1525270968, "post_id": 50136724, "comment_id": 87292173, "body": "thank you so much bob,this actually made the program not crash.can&#39;t thank you enough!"}], "tags": [], "owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "is_accepted": true, "score": 1, "last_activity_date": 1525270173, "creation_date": 1525270173, "answer_id": 50136724, "question_id": 50128851, "link": "https://stackoverflow.com/questions/50128851/allocating-memory-to-2d-array-using-an-array-of-null-c/50136724#50136724", "title": "Allocating memory to 2D array using an array of NULL (c)", "body": "<p>One problem of OP's code is in the pointer arithmetic. Given:</p>\n\n<pre><code>int ***vectors;\n*vectors = malloc(size * sizeof(int*));\n</code></pre>\n\n<p>This loop:</p>\n\n<pre><code>for (i = 0; i &lt; size; i++)\n{\n    *(vectors + i) = NULL;\n}\n</code></pre>\n\n<p>Would iterate over the next unallocated <strong>pointer to pointer to pointer</strong> to int, while what the OP needs is</p>\n\n<pre><code>for (i = 0; i &lt; size; i++)\n{\n    *(*vectors + i) = NULL;     // or (*vectors)[i] = NULL;\n}\n</code></pre>\n\n<p>The same holds in the following loops, where <code>*(sizes + j)</code> is used instead of <code>*(*sizes + j)</code> (or <code>(*sizes)[j]</code>).</p>\n"}], "owner": {"reputation": 33, "user_id": 9523910, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YupPQcpqQbM/AAAAAAAAAAI/AAAAAAAAAbA/Cq1kafKUd0g/photo.jpg?sz=128", "display_name": "Ultraviolence", "link": "https://stackoverflow.com/users/9523910/ultraviolence"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 50136724, "answer_count": 1, "score": 0, "last_activity_date": 1525270173, "creation_date": 1525244632, "last_edit_date": 1525244965, "question_id": 50128851, "link": "https://stackoverflow.com/questions/50128851/allocating-memory-to-2d-array-using-an-array-of-null-c", "title": "Allocating memory to 2D array using an array of NULL (c)", "body": "<p>thanks for taking the time in reading this.<br>\nIn my question a \"vector\" is defined as a 1D dimensional array of integers.<br>\nTherefore an array of vectors would be a 2D dimensional array in which every vector can be of a different length.<br>\nI'm asked to use:<br>\nint** vectors- the 2D array<br>\nint size -an integer that represents how many vectors exist inside **vectors<br>\nint* sizes-a 1D array of integers that represents the length of the vectors</p>\n\n<p>for example,for:<br>\nvectors = {{4,3,4,3},{11,22,33,44,55,66},NULL,{5},{3,33,333,33,3}}.<br>\nsize is 5 (there are 5 vectors inside vectors).<br>\nsizes is {4,6,0,1,5} (4 is the length of the first vector and so on).<br>\nsize is inputted by the user at the beginning of main() and **vectors&amp;*sizes are dynimacilly allocated with size's value.</p>\n\n<p>I'm asked to write the function:<br>\nint init(int ***vectors, int **sizes, int size) which initializes **vectors to be an array of NULLs and *sizes to be an array of zeros.<br>\nI came up with this code:  </p>\n\n<pre><code>#define _CRT_SECURE_NO_WARNINGS\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\nint init(int*** vectors, int** sizes, int size)\n{\n    int i, k,j;\n    printf(\"check\\n\");\n    *vectors = (int**)malloc(size * sizeof(int*));\n    if (*vectors == NULL)\n        return 0;\n    for (i = 0; i &lt; size; i++)\n    {\n        *(vectors + i) = NULL;\n    }\n    printf(\"check 2\\n\");\n    for (k = 0; k&lt;size; k++)\n    {\n        if (*(vectors+k) != NULL)\n            printf(\"didn't work\\n\");\n        else\n            printf(\"current is null\\n\");\n    }\n    *sizes= (int*)malloc(size * sizeof(int));\n    if (*sizes == NULL)\n        return 0;\n    for (j= 0; j &lt; size; j++)\n    {\n        *(sizes + j) = 0;\n        printf(\"%d \", *(sizes + j));\n    }\n    printf(\"\\n\");\n    return 1;\n}\nint main()\n{\n    int size, i;\n    int** vectors = NULL;\n    int* sizes = NULL;\n    printf(\"\\nPlease enter an amount of vectors:\\n\");\n    scanf(\"%d\", &amp;size);\n    printf(\"%d\\n\", init(&amp;vectors, &amp;sizes, size));\n    printf(\"size is %d now\\n\", size);\n//  for (i = 0; i &lt; size; i++)\n    //  printf(\"%d \", *(sizes+i));\n    printf(\"check 3\\n\");\n    free(sizes);\n    free(vectors);\n    printf(\"check 4\\n\");\n    printf(\"check 5\\n\");\n    return 0;\n}\n</code></pre>\n\n<p>forgot to mention that init returns 0 if it fails to allocate memory and 1 otherwise.<br>\nprinting the \"checks\" was so I could see where the program fails.<br>\nthe problem is that no matter what,after printing the last check (check 5)\nthe program fails.(Run-Time Check Failure #2)<br>\nif anyone could help me understand what I'm doing wrong I would HIGHLY appreciate it.<br>\nthanks alot for reading and have an amazing day.\nedit:<br>\ni also printed the array sizes/vectors inside init just to see if it prints zeros/nulls,i don't actually need to do it.</p>\n"}, {"tags": ["c", "file"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1525244923, "post_id": 50128840, "comment_id": 87275628, "body": "I don&#39;t understand your problem, but I have the feeling it has to do with <a href=\"https://stackoverflow.com/q/5431941/2371524\">Why is \u201cwhile ( !feof (file) )\u201d always wrong?</a> -- apart from that, <a href=\"https://stackoverflow.com/q/1694036/2371524\"><b>never use <code>gets()</code>!</b></a>"}, {"owner": {"reputation": 13, "user_id": 9657347, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rLceCwn2W9M/AAAAAAAAAAI/AAAAAAAAAec/58fuCZ4ozM8/photo.jpg?sz=128", "display_name": "Alberto Zavala", "link": "https://stackoverflow.com/users/9657347/alberto-zavala"}, "edited": false, "score": 0, "creation_date": 1525245724, "post_id": 50128840, "comment_id": 87276063, "body": "I&#39;m supposed to create a single file, in this case &quot;Dat.txt&quot; which will have many names and many ages that I want, since the code works creating that file. I need to read it again (That&#39;s why I use w+), and based of the number of ages that I get while I&#39;m reading, I&#39;ll create a new file called &quot;Ages.txt&quot; which will have the number of ages that I counted."}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1525247826, "post_id": 50128840, "comment_id": 87277140, "body": "Had you tested the return value of <code>fscanf</code>, it would be evident: <code>fscanf(ap,&quot;%d&quot;,&amp;age);</code> returns 0 because it is trying to read a name and cannot decode it as an int. And <code>fflush(stdin)</code> in non standard and is only a Microsoft extension. It will not clean the input stream with gcc or clang..."}, {"owner": {"reputation": 13, "user_id": 9657347, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rLceCwn2W9M/AAAAAAAAAAI/AAAAAAAAAec/58fuCZ4ozM8/photo.jpg?sz=128", "display_name": "Alberto Zavala", "link": "https://stackoverflow.com/users/9657347/alberto-zavala"}, "edited": false, "score": 0, "creation_date": 1525249001, "post_id": 50128840, "comment_id": 87277761, "body": "I used &#39;fflush(stdin)&#39; because when I finish to write the age, automatically ask me for the next age in &#39;for&#39; loop, it seems like &#39;\\n&#39; is getting inside to the string.  and it kept me confuse about &#39;fscanf&#39; because I want to print the age separately when I&#39;m reading the file but I don&#39;t know how. I tried to print the string with &#39;puts(cad)&#39; and I noticed that the string came with the age... So not sure how to do it"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9657347, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rLceCwn2W9M/AAAAAAAAAAI/AAAAAAAAAec/58fuCZ4ozM8/photo.jpg?sz=128", "display_name": "Alberto Zavala", "link": "https://stackoverflow.com/users/9657347/alberto-zavala"}, "edited": false, "score": 0, "creation_date": 1525248243, "post_id": 50129482, "comment_id": 87277343, "body": "Thanks, that helped me with the loop, but I&#39;m still confused, if I use <i>puts(cad);</i> after <i>fscanf</i> inside While loop, I see that prints the name with the age, and if I try to print that number separately , using <i>printf(&quot;Age: %d\\n&quot;,age)</i> it prints the last age that was registered at the begging. Is there any way to print the age separately from the file?"}], "tags": [], "owner": {"reputation": 3624, "user_id": 8013471, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jh4jO.jpg?s=128&g=1", "display_name": "cse", "link": "https://stackoverflow.com/users/8013471/cse"}, "is_accepted": true, "score": 0, "last_activity_date": 1525252153, "last_edit_date": 1525252153, "creation_date": 1525247102, "answer_id": 50129482, "question_id": 50128840, "link": "https://stackoverflow.com/questions/50128840/passing-a-result-from-a-file-to-another-file/50129482#50129482", "title": "Passing a result from a file to another file", "body": "<p>Th problem is in line <code>fscanf(ap,\"%d\",&amp;age);</code> of<code>while</code> loop. This is because You have written a string fist and you are expecting to read an <code>int</code>.</p>\n\n<p>Replace it with following code snippet and it will solve your issue:</p>\n\n<pre><code>...\nrewind(ap);\nfgets(cad,T,ap);\nwhile(!feof(ap))     //Start counting the ages\n{\n   //Move pointer to 30, Since while writing to file width is set to 30(%-30s) \n   age = atoi(cad+30); \n   printf(\"%d\\n\",age);\n   ++cont;\n   fgets(cad,T, ap);\n}\nfprintf(ap2,\"%d\", cont);\n...\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9657347, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rLceCwn2W9M/AAAAAAAAAAI/AAAAAAAAAec/58fuCZ4ozM8/photo.jpg?sz=128", "display_name": "Alberto Zavala", "link": "https://stackoverflow.com/users/9657347/alberto-zavala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 50129482, "answer_count": 1, "score": 0, "last_activity_date": 1525252153, "creation_date": 1525244560, "question_id": 50128840, "link": "https://stackoverflow.com/questions/50128840/passing-a-result-from-a-file-to-another-file", "title": "Passing a result from a file to another file", "body": "<p>Greeting. I \nI crated a File that asks for name and age, I want to extract the number of ages that entered to the file, and that number print it on other file.\nI know that I can count based on how many names there are, or even the times I asked for information, but I need to count how many ages I got based on the number, in this case <em>int</em>, and print it on other file.\nHere is my code:</p>\n\n<pre><code>#define T 50\n#define A 5\nvoid main ()\n{\n   FILE *ap=NULL, *ap2=NULL;\n   char cad[T];\n   int age, x,cont=0;\n\n   ap=fopen(\"Dat.txt\", \"w+\"); //Open File\n   if(ap==NULL)\n   {  printf(\"Cant open the file\");\n      getch();\n      exit(1);\n   }\n   ap2=fopen(\"Ages.txt\",\"w\"); //Open File\n   if(ap2==NULL)\n   {  printf(\"Cant open the file\");\n      getch();\n      exit(1);\n   }\n   for(x=0;x&lt;A;x++) //Gets the information\n   {  printf(\"Name: \");\n      gets(cad);\n      printf(\"Age: \");\n      scanf(\"%d\",&amp;age);\n      fflush(stdin);\n      fprintf(ap,\"%-30s %d\\n\",cad,age);\n   }\n   rewind(ap);\n   fgets(cad,T,ap);\n   while(!feof(ap))     //Start counting the ages\n   {  fscanf(ap,\"%d\",&amp;age);\n      ++cont;\n   }\n   fprintf(ap2,\"%d\", cont);\n\n   fclose(ap); fclose(ap2); //Close both Files\n</code></pre>\n\n<p>It works fine creating the file \"Dat.txt\" with all the information if I comment the last 6 lines of code (except <em>fclose</em>), but it seems to enter into a Loop, because it doesn't do anything when I finish entering the information.</p>\n"}, {"tags": ["c", "struct"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1525245007, "post_id": 50128813, "comment_id": 87275672, "body": "You&#39;re using the <code>%f</code> format to read <code>double</code> values.  This is undefined behaviour (<code>%f</code> is for <code>float</code> types; <code>%lf</code> is for <code>double</code>).  Modern compilers normally warn you about this; if yours doesn&#39;t, find the options to turn the warnings on, or get a better compiler."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 3, "creation_date": 1525245234, "post_id": 50128813, "comment_id": 87275795, "body": "Please always enable warnings in your compiler. For GCC you should add <code>-Wall -Wextra -Wpedantic</code>. This will show you a number of warnings."}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1525245188, "post_id": 50128953, "comment_id": 87275770, "body": "Well spotted on the commas.  I think a novice programmer needs a bit more explanation; it&#39;s quite subtle."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1525245692, "post_id": 50128953, "comment_id": 87276049, "body": "@JonathanLeffler - Good suggestion. I tried to address it a little more in an edit, hopefully enough to make the point sink with a novice. I don&#39;t know how deep to delve into it, so it won&#39;t go over a novices head."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1525246177, "post_id": 50128953, "comment_id": 87276318, "body": "I don&#39;t know whether it is too detailed, but I might suggest that the original initializer is equivalent to <code>struct rect new_screen = { { 2, 2 }, { 2, 2 }, { 0, 0 }, { 0, 0 } };</code> because the <code>scanf()</code> calls return 2 (if the format strings are fixed), and those returned values overwrite the first four elements of the structures, and the other fields are initialized with zeros after the <code>scanf()</code> calls have set the values. So the data read from standard input is obliterated by the initialization. I debated whether to write <code>2.0</code> instead of <code>2</code> in the initializers; laziness left them as integers."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1525246368, "post_id": 50128953, "comment_id": 87276408, "body": "@JonathanLeffler - Writing the equivalent initializer is a superb idea. I added that in. Thank you!"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1525246472, "post_id": 50128953, "comment_id": 87276481, "body": "@JonathanLeffler - Upvote or not, those <i>are</i> good suggestions. So thanks anyway :)"}, {"owner": {"reputation": 131, "user_id": 9547974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9eb5b67fee7c96c441b3b8f869d6a3ea?s=128&d=identicon&r=PG&f=1", "display_name": "Milo", "link": "https://stackoverflow.com/users/9547974/milo"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1525248241, "post_id": 50128953, "comment_id": 87277339, "body": "@JonathanLeffler Thank you very much! this information helped me ALOT! I started computer science in the University out of interest, It turned out to be very hard, but because people like yourself I keep going on and learn something new each time I encounter a problem, thank you!"}, {"owner": {"reputation": 131, "user_id": 9547974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9eb5b67fee7c96c441b3b8f869d6a3ea?s=128&d=identicon&r=PG&f=1", "display_name": "Milo", "link": "https://stackoverflow.com/users/9547974/milo"}, "edited": false, "score": 0, "creation_date": 1525248420, "post_id": 50128953, "comment_id": 87277438, "body": "@StoryTeller thanks! one more question - will scanning the data into inner struct variables better be done with malloc?"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 131, "user_id": 9547974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9eb5b67fee7c96c441b3b8f869d6a3ea?s=128&d=identicon&r=PG&f=1", "display_name": "Milo", "link": "https://stackoverflow.com/users/9547974/milo"}, "edited": false, "score": 0, "creation_date": 1525248588, "post_id": 50128953, "comment_id": 87277536, "body": "@YaroslavMiloslavsky - I don&#39;t see why one would need <code>malloc</code> here. There&#39;s no call to dynamic memory allocation."}], "tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": true, "score": 4, "last_activity_date": 1525246339, "last_edit_date": 1525246339, "creation_date": 1525245010, "answer_id": 50128953, "question_id": 50128813, "link": "https://stackoverflow.com/questions/50128813/scanf-wont-scan-struct-inner-data/50128953#50128953", "title": "Scanf Won&#39;t Scan Struct Inner Data", "body": "<p>This here initialization...</p>\n\n<pre><code>struct rect new_screen = {\n   scanf(\"%f,%f\",&amp;new_screen.pt1.x,&amp;new_screen.pt1.y),\n   scanf(\"%f,%f\",&amp;new_screen.pt2.x,&amp;new_screen.pt2.y),\n   scanf(\"%f,%f\",&amp;new_screen.pt3.x,&amp;new_screen.pt3.y),\n   scanf(\"%f,%f\",&amp;new_screen.pt4.x,&amp;new_screen.pt4.y),\n};\n</code></pre>\n\n<p>... doesn't do what you think it does. <code>scanf</code> returns a single integer (consult its manual page for the meaning of the returned value), but your structure holds <code>struct point</code> fields. Which sums up to a total of 8 doubles, and 4 calls to <code>scanf</code>. Due to how initialization works in C, you can omit braces and initializers for some fields. So this is sadly valid code. But it initializes <code>new_screen.pt1</code> and <code>new_screen.pt2</code> only (four calls to <code>scanf</code> initialize the four doubles). The thing you scanned into them is immediately overwritten. The last two points aren't initialized by the braces, so they should be initizlied with zeros, again overwriting anything you may have scanned into them.</p>\n\n<p>The long and short of it, is that assuming all <code>scanf</code> invocations don't fail (and we ignore the problem with the format specifiers), you essentially wrote this:</p>\n\n<pre><code>struct rect new_screen = {\n  { 2, 2 },\n  { 2, 2 },\n  { 0, 0 },\n  { 0, 0 }\n};\n</code></pre>\n\n<p>The less wrong initialization would be:</p>\n\n<pre><code>struct rect new_screen;\nscanf(\"%lf,%lf\",&amp;new_screen.pt1.x,&amp;new_screen.pt1.y);\nscanf(\"%lf,%lf\",&amp;new_screen.pt2.x,&amp;new_screen.pt2.y);\nscanf(\"%lf,%lf\",&amp;new_screen.pt3.x,&amp;new_screen.pt3.y);\nscanf(\"%lf,%lf\",&amp;new_screen.pt4.x,&amp;new_screen.pt4.y);\n</code></pre>\n\n<p>It doesn't check that <code>scanf</code> succeeded (which is why it's only <em>less wrong</em>) but it will not trample the content of <code>new_screen</code> with the return value of <code>scanf</code>. I also fixed the format specifier (you used <code>%f</code>, but <code>double</code> variables require <code>%lf</code>).</p>\n\n<p>The above mistakes are also a testament to how important it is to compile with warnings enabled, and to address them. For instance, when I compiled your code with <code>gcc -pedantic-errors -Wall -Wextra</code> I got these warnings:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>warning: format '%f' expects argument of type 'float *', but argument 2 has type 'double *' [-Wformat=]\n    scanf(\"%f,%f\",&amp;new_screen.pt1.x,&amp;new_screen.pt1.y),\n\nwarning: missing braces around initializer [-Wmissing-braces]\n    struct rect new_screen={\n\nwarning: missing initializer for field 'pt3' of 'struct rect' [-Wmissing-field-initializers]\n    };\n</code></pre>\n\n<p>Make a habit of compiling with warnings enabled, and address them until the build is free of compiler diagnostics.</p>\n"}], "owner": {"reputation": 131, "user_id": 9547974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9eb5b67fee7c96c441b3b8f869d6a3ea?s=128&d=identicon&r=PG&f=1", "display_name": "Milo", "link": "https://stackoverflow.com/users/9547974/milo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 50128953, "answer_count": 1, "score": 2, "last_activity_date": 1525246339, "creation_date": 1525244435, "last_edit_date": 1525244898, "question_id": 50128813, "link": "https://stackoverflow.com/questions/50128813/scanf-wont-scan-struct-inner-data", "title": "Scanf Won&#39;t Scan Struct Inner Data", "body": "<p>I need help!</p>\n\n<p>It doesn't matter what I input I get the same output, it's like the program does not read the input from scanf, any ideas?</p>\n\n<p>I tried to get the input separately , to divide the scanf so I will get 8 scanf. \nBut with no luck.</p>\n\n<p>If you could help me out and point out on what I have been doing wrong i would appreciate that! </p>\n\n<pre><code> struct point{\n  double x;\n  double y;\n }pt1,pt2,pt3,pt4;\n\n struct rect{\n      struct point pt1;\n      struct point pt2;\n      struct point pt3;\n      struct point pt4;\n };\n\n  int main()\n {\n    struct rect new_screen={\n       scanf(\"%f,%f\",&amp;new_screen.pt1.x,&amp;new_screen.pt1.y),\n       scanf(\"%f,%f\",&amp;new_screen.pt2.x,&amp;new_screen.pt2.y),\n       scanf(\"%f,%f\",&amp;new_screen.pt3.x,&amp;new_screen.pt3.y),\n       scanf(\"%f,%f\",&amp;new_screen.pt4.x,&amp;new_screen.pt4.y),\n    };\n       printf(\"the middle between (%.2f,%.2f) and (%.2f,%.2f) is \",new_screen.pt1.x,new_screen.pt1.y,new_screen.pt3.x,new_screen.pt3.y);\n       print_point(middle(new_screen.pt1,new_screen.pt3));\n   return 0;\n }\n\n\n\n    struct point middle(struct point pt1, struct point pt2)\n    {\n        struct point tmp = {((pt1.x+pt2.x)/2),((pt1.y+pt2.y)/2)};\n        return tmp;\n    }\n    void print_point(struct point pt)\n    {\n        printf(\"(%.2f,%.2f)\",pt.x,pt.y);\n    }\n\n     output \n     the middle between (2.00,2.00) and (0.00,0.00) is (1.00,1.00)\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 6, "creation_date": 1525243863, "post_id": 50128579, "comment_id": 87275103, "body": "This could be an <a href=\"http://xyproblem.info/\" rel=\"nofollow noreferrer\">XY Problem</a>. You should <a href=\"https://stackoverflow.com/posts/50128579/edit\">edit</a>  your question and explain a bit more what you are  <i>actually</i> trying to achieve."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1525244250, "post_id": 50128579, "comment_id": 87275295, "body": "At the very least, it&#39;s unclear whether you need the binary as data for some processing or you want to use its functionality, therefore <b>link</b> it. Yes, edit this question please."}, {"owner": {"reputation": 4593, "user_id": 105104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b23920ac852e946b333d3f9d0d95c1?s=128&d=identicon&r=PG", "display_name": "dvhh", "link": "https://stackoverflow.com/users/105104/dvhh"}, "edited": false, "score": 0, "creation_date": 1525249241, "post_id": 50128579, "comment_id": 87277904, "body": "Your issue might not be C specific, you might want to look at <a href=\"https://stackoverflow.com/a/4158997\">stackoverflow.com/a/4158997</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9417702, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zhqKxLh3EVk/AAAAAAAAAAI/AAAAAAAAA5k/XlykBExXj0A/photo.jpg?sz=128", "display_name": "Saheen Shoukath", "link": "https://stackoverflow.com/users/9417702/saheen-shoukath"}, "edited": false, "score": 0, "creation_date": 1525253132, "post_id": 50130175, "comment_id": 87280142, "body": "well it&#39;s linux"}], "tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 0, "last_activity_date": 1525249624, "creation_date": 1525249624, "answer_id": 50130175, "question_id": 50128579, "link": "https://stackoverflow.com/questions/50128579/how-to-store-c-executable-binary-inside-a-c-source/50130175#50130175", "title": "How to store c executable binary inside a c source?", "body": "<p>I am sure it is possible to instruct the linker that the binary is a resource of the executable, so it will be included in the image.</p>\n\n<p>I am also sure it is possible for the executable to access the resource and write it out, name it as an executable of the OS (Windows/Linux/Mac) and then exec it.</p>\n\n<p><sup>(A complete solution would depend on the OS)</sup></p>\n"}, {"tags": [], "owner": {"reputation": 5464, "user_id": 59527, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/5728955f444a62bbba61ba09690c50ab?s=128&d=identicon&r=PG", "display_name": "Sijmen Mulder", "link": "https://stackoverflow.com/users/59527/sijmen-mulder"}, "is_accepted": false, "score": 1, "last_activity_date": 1525253764, "creation_date": 1525253764, "answer_id": 50131392, "question_id": 50128579, "link": "https://stackoverflow.com/questions/50128579/how-to-store-c-executable-binary-inside-a-c-source/50131392#50131392", "title": "How to store c executable binary inside a c source?", "body": "<p>On Unix-likes (including Linux), you can use <a href=\"https://linux.die.net/man/1/xxd\" rel=\"nofollow noreferrer\">xxd</a>:</p>\n\n<p><code>xxd -i program</code></p>\n\n<p>This generates a header file with the contents of the file as a char array, embedding it in your program.</p>\n\n<p>On Windows, you can embed the program as a resource. In your <code>.rc</code>, using 200 as a resource ID:</p>\n\n<p><code>200 RDCDATA \"program.exe\"</code></p>\n\n<p>Then in your program:</p>\n\n<pre><code>HANDLE resinfo = FindResource(instance, MAKEINTRESOURCE(200), RT_RCDATA);\nHANDLE reshandle = LoadResource(instance, resinfo);\nvoid *data = LockResource(reshandle);\nDWORD datasz = SizeOfResource(instance, resinfo);\n</code></pre>\n\n<p>In either case you'll need to write out the file to some location to run it. Don't forget to set the executable bit on Unix.</p>\n"}], "owner": {"reputation": 1, "user_id": 9417702, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zhqKxLh3EVk/AAAAAAAAAAI/AAAAAAAAA5k/XlykBExXj0A/photo.jpg?sz=128", "display_name": "Saheen Shoukath", "link": "https://stackoverflow.com/users/9417702/saheen-shoukath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "closed_date": 1525266187, "answer_count": 2, "score": 0, "last_activity_date": 1525253764, "creation_date": 1525243459, "last_edit_date": 1525252916, "question_id": 50128579, "link": "https://stackoverflow.com/questions/50128579/how-to-store-c-executable-binary-inside-a-c-source", "closed_reason": "Needs details or clarity", "title": "How to store c executable binary inside a c source?", "body": "<p>I need to add a binary code of  one of my c program to another binary from a c program.how do I do it?\nI need to add the binary content inside my c source.and use that c source to append that binary content to an existing binary.</p>\n"}, {"tags": ["c", "glibc", "libc", "memcmp"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 5, "creation_date": 1525242775, "post_id": 50128370, "comment_id": 87274608, "body": "Just a guess: nobody expects this function to be called in such a &quot;stupid&quot; way very often, so they don&#39;t bother to optimize this case? The compiler could still eliminate the code if it can be statically proved the pointers are the same..."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 2, "creation_date": 1525242791, "post_id": 50128370, "comment_id": 87274614, "body": "Why should anyone spend an instruction checking the pointers for equality which will not be true in any real world use case? The performance gain in a pure theoretical situation does not justify spending a single instruction for all other cases."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1525242879, "post_id": 50128370, "comment_id": 87274658, "body": "Also, leaving such things to the compiler avoids a compare instruction that would be pointless for any &quot;normal&quot; call."}, {"owner": {"reputation": 24134, "user_id": 179081, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/TJ9hg.png?s=128&g=1", "display_name": "Lyndon White", "link": "https://stackoverflow.com/users/179081/lyndon-white"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1525243598, "post_id": 50128370, "comment_id": 87274967, "body": "@Gerhardh it is hardly not true in <b>any</b> real world use-case.  Consider if one is using some form of <a href=\"https://en.wikipedia.org/wiki/String_interning\" rel=\"nofollow noreferrer\">interning</a>, if so then one will regularly get circumstances where you have two pointer&#39;s that are equal but that the compiler can&#39;t prove are equal. And if the author of the code doing the <code>memcmp</code> isn&#39;t the author of the code which does the interning. (say the <code>memcmp</code> is buried some 3rd party library function) then it is all but unavoidable."}], "answers": [{"comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1525249924, "post_id": 50128431, "comment_id": 87278267, "body": "That would require the compiler to know the meaning of <code>memcmp</code>."}, {"owner": {"reputation": 24134, "user_id": 179081, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/TJ9hg.png?s=128&g=1", "display_name": "Lyndon White", "link": "https://stackoverflow.com/users/179081/lyndon-white"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1525323240, "post_id": 50128431, "comment_id": 87312505, "body": "@PaulOgilvie which e.g. LLVM (for Clang) does: <a href=\"https://github.com/llvm-mirror/llvm/blob/886c0f8e39ce29ea99520f0ec20b81f1225ea32b/lib/Transforms/Utils/SimplifyLibCalls.cpp#L742-L745\" rel=\"nofollow noreferrer\">github.com/llvm-mirror/llvm/blob/&hellip;</a>"}], "tags": [], "owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "is_accepted": false, "score": 1, "last_activity_date": 1525242818, "creation_date": 1525242818, "answer_id": 50128431, "question_id": 50128370, "link": "https://stackoverflow.com/questions/50128370/why-do-memcmp-implementation-not-shortcut-memcmpq-p-n-for-the-case-where-q/50128431#50128431", "title": "Why do memcmp implementation not shortcut memcmp(q, p, n) for the case where q==p?", "body": "<p>I suspect it's due to practical utility concerns.</p>\n\n<p>In practice, few people supply same pointer to the 1st and 2nd arguments to <code>memcmp()</code>, so in most cases the extra condition test does nothing effectively and is thus a waste of effort.</p>\n\n<p>As Felix Palmen pointed out in comments, if two pointers can be statically confirmed to point to the same address, the compiler can do the optimization instead.</p>\n"}], "owner": {"reputation": 24134, "user_id": 179081, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/TJ9hg.png?s=128&g=1", "display_name": "Lyndon White", "link": "https://stackoverflow.com/users/179081/lyndon-white"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1525243640, "creation_date": 1525242507, "last_edit_date": 1525243640, "question_id": 50128370, "link": "https://stackoverflow.com/questions/50128370/why-do-memcmp-implementation-not-shortcut-memcmpq-p-n-for-the-case-where-q", "title": "Why do memcmp implementation not shortcut memcmp(q, p, n) for the case where q==p?", "body": "<p>If I pass <code>memcmp</code> the equal pointers for its first and second argument,\nI suspected that it might just return 0 without checking the elements -- since if the same pointer is passed the elements must be zero.\nIt seems like to me it is good optimization to check for pointer equality and exit early.</p>\n\n<p>I checked the <a href=\"https://sourceware.org/git/?p=glibc.git;a=blob;f=string/memcmp.c;h=aea5129917c635ed9851daed521c61887c520ad7;hb=HEAD\" rel=\"nofollow noreferrer\">glibc</a>\nand <a href=\"https://github.com/freebsd/freebsd/blob/d5b44dd10ef4e192bdbf61fe3a3e11d37f0eac5c/lib/libc/string/memcmp.c\" rel=\"nofollow noreferrer\">Free BSD LibC</a>\nimplementations and neither seem to be making this optimization. </p>\n\n<p>So I checked the standard (below):\nThe <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1256.pdf\" rel=\"nofollow noreferrer\">Open Standards draft version of C99</a> says nothing one way or the other:</p>\n\n<blockquote>\n  <p>7.21.4.1  The memcmp function Synopsis</p>\n\n<pre><code>#include &lt;string.h&gt;\nint memcmp(const void *s1, const void *s2, size_t n);\n</code></pre>\n  \n  <p>Description</p>\n  \n  <p>The memcmp function  compares  the  first n characters  of  the \n  object  pointed  to  by s1 to the first n characters of the object\n  pointed to by s2.</p>\n  \n  <p>Returns</p>\n  \n  <p>The memcmp function  returns  an  inte ger  greater  than,  equal  to,\n  or  less  than  zero, accordingly as the object pointed to by s1 is\n  greater than, equal to, or less than the object pointed to by s2</p>\n</blockquote>\n\n<p>As far as I can tell it doesn't forbid such an \"trick\", since one would still get the same returned values.\nIt is really is an implementation detail, AFAICT.</p>\n\n<p>Clearly the people writing these libraries have put much more thought into this than I have, so there is probably a good reason for not doing this.\nWhat is it?</p>\n"}, {"tags": ["c", "function", "syntax", "definition"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1525241617, "post_id": 50128164, "comment_id": 87274067, "body": "That&#39;s a K&amp;R style function definition.  In standard C, it would be <code>void testname(char *input, int arg0, int arg1) { \u2026 }</code>.  It shouldn&#39;t have been written like that \u2014 <code>void</code> was added when prototypes were added."}, {"owner": {"reputation": 43502, "user_id": 377953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hm9UN.jpg?s=128&g=1", "display_name": "taskinoor", "link": "https://stackoverflow.com/users/377953/taskinoor"}, "edited": false, "score": 0, "creation_date": 1525241741, "post_id": 50128164, "comment_id": 87274110, "body": "Should we be horrified to learn that K&amp;N style definition still exists in real codes?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1525241861, "post_id": 50128164, "comment_id": 87274158, "body": "I&#39;m still fighting with an archaic code base that still has K&amp;R functions in places \u2014 in code originally written when that was all there was.  I&#39;m actively working on cleaning up, but only a few hundred files still to go, with anywhere from 1 to 100 functions in the files.  Grump!  Yes, it horrifies me, but it is reality in some circles.  (Of course, there are more problems than just K&amp;R definitions \u2014 and most of those functions do have a prototype declaring the function, so it isn&#39;t quite as bad as it would be if that were not the case."}], "owner": {"reputation": 71, "user_id": 7777496, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/313a5deba66192c3c3826a86f29020d5?s=128&d=identicon&r=PG&f=1", "display_name": "Somesaint Gupta", "link": "https://stackoverflow.com/users/7777496/somesaint-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "closed_date": 1525241657, "answer_count": 0, "score": 0, "last_activity_date": 1525241575, "creation_date": 1525241545, "last_edit_date": 1525241575, "question_id": 50128164, "link": "https://stackoverflow.com/questions/50128164/c-function-defined-without-argument-types", "closed_reason": "Duplicate", "title": "C: Function defined without argument types", "body": "<p>I came across a code where the function definition is like this</p>\n\n<pre><code>void testname(input, arg0, arg1)\nchar *input;\n{\n    char buffer[BUF_SIZE];\n\n    char *ptr;\n\n    sprintf(testnamebuf, input, arg0, arg1);\n\n    ptr = buffer;\n\n\n    sprintf(ptr, \"%s\", testnamebuf);\n}\n</code></pre>\n\n<p>Could someone explain me how the function definition is working? It's a weird way of defining the function and it's the first time I'm seeing such a code.</p>\n"}, {"tags": ["c", "linux", "message-queue"], "comments": [{"owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "edited": false, "score": 0, "creation_date": 1525246062, "post_id": 50128097, "comment_id": 87276252, "body": "You didn&#39;t specify <code>msg_typ</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9478215"}, "reply_to_user": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "edited": false, "score": 0, "creation_date": 1525246796, "post_id": 50128097, "comment_id": 87276636, "body": "what msg_typ do with the struct msqid_ds?  msg_typ is in struct mesg_q. Answer for the question i asked."}, {"owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "edited": false, "score": 0, "creation_date": 1525247764, "post_id": 50128097, "comment_id": 87277099, "body": "You are sending whole <code>msgq</code> by calling <code>msgsnd()</code> second argument. You should update <code>msg_typ</code> value in same <code>msgq</code> variable."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9478215"}, "edited": false, "score": 0, "creation_date": 1525251970, "post_id": 50128986, "comment_id": 87279422, "body": "This code also giving the same output. what is the use of intnax_t there ?ialso giving the same output"}, {"owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "edited": false, "score": 0, "creation_date": 1525252211, "post_id": 50128986, "comment_id": 87279574, "body": "Enable the warning flag and check. Compile your code with  <code>-Wall -Wstrict-prototypes -Werror</code> . <i>This code giving same output ?</i> what output you are expecting ?"}, {"owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "edited": false, "score": 0, "creation_date": 1525252507, "post_id": 50128986, "comment_id": 87279739, "body": "Use <code>MSG_STAT</code> instead of <code>IPC_STAT</code>"}, {"owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "edited": false, "score": 0, "creation_date": 1525252529, "post_id": 50128986, "comment_id": 87279755, "body": "Read man page of <code>msgctl()</code> it says <code>msg_cbytes</code> is non standard. Better use POSIX ipc&#39;s"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9478215"}, "edited": false, "score": 0, "creation_date": 1525268929, "post_id": 50128986, "comment_id": 87290581, "body": "why im not getting the correct values from the parameters in struct msqid_ds?"}], "tags": [], "owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "is_accepted": false, "score": 0, "last_activity_date": 1525252461, "last_edit_date": 1525252461, "creation_date": 1525245162, "answer_id": 50128986, "question_id": 50128097, "link": "https://stackoverflow.com/questions/50128097/message-queue-no-proper-response/50128986#50128986", "title": "Message queue - No proper response", "body": "<p>First of all you should know why to use <code>message queue</code> IPC, I assume before using message queue, you have gone through <code>FIFO</code>. In <code>FIFO</code> what is condition for the processes to communicate each other ? that both process should be <strong>alive</strong> while communicating.</p>\n\n<p>To avoid above problem of <code>FIFO</code> you are using message queue, as in MQ you can put data at one time and can read at anytime, for that you have to specify the <code>mtype</code> i.e with what <code>mtype</code> process_1 is sending the data and with what <code>mtype</code> process_2 is receiving the data.</p>\n\n<p>From the manual page of <code>msgsnd</code></p>\n\n<pre><code>struct msgbuf {\n      long mtype;       /* message type, must be &gt; 0, I'm talking baout this */\n      char mtext[1];    /* message data */\n};\n</code></pre>\n\n<p>so in both the process(reader &amp; sender) specify the <code>mtype</code></p>\n\n<pre><code>msgq.msg_typ = 1; /*specify this in both process */\n</code></pre>\n\n<p>Secondly, <em>Time of last message send=1525240214- why this is showing junk values ?</em> => Its not junk data, its the time in seconds from EPOCH time, use <code>ctime()</code> to print in human readable format.</p>\n\n<p><strong>sender.c</strong></p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/ipc.h&gt;\n#include &lt;sys/msg.h&gt;\n#include&lt;stdint.h&gt;\nstruct mesg_q {\n        char msg_txt[100];\n        long msg_typ;\n};\nint main(void) {\n        int msgid;\n        struct mesg_q msgq;\n        struct msqid_ds info;\n        msgid=msgget((key_t)1234, 0666 | IPC_CREAT);\n        if(msgid== -1) {\n                printf(\"msgget failed\\n\");\n                return -1;\n        }\n        while(1) {\n                printf(\"Text Message\\n\");\n                fgets(msgq.msg_txt,sizeof(msgq.msg_txt),stdin);\n                /* with what msg_type you are sending, you didn't mention ? mention it */\n                msgq.msg_typ = 1; /* I am sending with msg_type 1 */\n                if(msgsnd(msgid,&amp;msgq,sizeof(msgq),msgq.msg_typ)==-1) {\n                        printf(\"Send failed\\n\");\n                        return -1;\n                }\n                else {\n                        printf(\"Message send\\n\");\n                }\n                msgctl(msgid, MSG_STAT, &amp;info);\n                printf(\"Time of last message send = %jd\\n\",(intmax_t)info.msg_stime);/* use the correct format specifier */\n                /* what ever time info.msg_stime printing, its not junk, its seconds from EPOCH, use ctime() to print in readable format */\n                printf(\"uid = %d\\n\",info.msg_perm.uid);\n        }\n        return 0;\n}\n</code></pre>\n\n<p><strong>receiver.c</strong></p>\n\n<pre><code>struct mesg_q {\n        char msg_txt[100];\n        long msg_typ;\n};\nint main(void ){\n        int msgid;\n        long int rec_buff=0;\n        struct mesg_q msgq;\n        struct msqid_ds info;\n        msgid=msgget((key_t)1234, 0666 | IPC_CREAT);\n        if(msgid == -1) {\n                printf(\"Msgget failed\\n\");\n                return -1;\n        }\n        while(1) {\n                /* with what msg_typ you are reciving, you have to mention ? u didn't */\n                msgq.msg_typ = 1;\n                if(msgrcv(msgid,&amp;msgq,sizeof(msgq),rec_buff, msgq.msg_typ)==-1) {\n                        printf(\"Mesg recv failed\\n\");\n                        return -1;\n                }\n                else{\n                        printf(\"Mesg Recvd\\n\");\n                }\n                printf(\"Recvd mesg=%s\\n\",msgq.msg_txt);\n\n                msgctl(msgid, MSG_STAT, &amp;info);\n                /* enable compiler warning, and use correct format specifier */\n                printf(\"Num:of bytes on queue= %u\\n\", (int)info.msg_cbytes);\n                printf(\"num:of messages on queue=%d\\n\", (int)info.msg_qnum);\n                printf(\"Max bytes on queue=%d\\n\", (int)info.msg_qbytes);\n                printf(\"Time of last message recvd=%jd\\n\",(intmax_t)info.msg_rtime);\n        }\n        return 0;\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9478215"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 110, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1525252461, "creation_date": 1525241204, "question_id": 50128097, "link": "https://stackoverflow.com/questions/50128097/message-queue-no-proper-response", "title": "Message queue - No proper response", "body": "<p>*I'm using message queues for sending and receiving messages but some parameters in the the structure msqid_ds no giving proper values why it happens?\n    *Time of last message send=1525240214- why this is showing junk values?</p>\n\n<pre><code>        struct mesg_q\n    {\n        char msg_txt[100];\n        long msg_typ;\n    };\n\n    int main()\n    {\n        int msgid;\n       key_t key;\n        char buffer[100]; \n\n        struct mesg_q msgq;\n         struc answerst msqid_ds info;\n     //  key = ftok(\"/home/yash72/krishna/thread_test/msgq.text\", 65);\n        msgid=msgget((key_t)1234, 0666 | IPC_CREAT);\n\n        if(msgid== -1)\n        {    \n            printf(\"msgget failed\\n\");\n            return -1;\n        }\n\n        while(1)\n        { \n            printf(\"Text Message\\n\");\n            fgets(msgq.msg_txt,100,stdin);\n\n            if(msgsnd(msgid,&amp;msgq,100,0)==-1)\n            {\n                printf(\"Send failed\\n\");\n                return -1;\n            }  \n            else\n            {\n                printf(\"Message send\\n\");\n            }    \n         msgctl(msgid, IPC_STAT, &amp;info);\n         printf(\"Time of last message send=%d\\n\",info.msg_stime);\n         printf(\"uid=%d\\n\",info.msg_perm.uid);\n        }   \n    }    \n\nOUTPUT:\n\n Text Message\nqwerty\nMessage send\nTime of last message send=1525240214 // Why this is showing junk?\nuid=0\nText Message\n\n\n\nReceiver code:\n</code></pre>\n\n<ul>\n<li><p>Reason for junk values from this code?</p>\n\n<p>struct mesg_q\n    {\n        char msg_txt[100];\n        long msg_typ;\n    };</p>\n\n<pre><code>int main()\n{\n    int msgid;\n    char buffer[100];\n    long int rec_buff=0;\n    key_t  key;\n    struct mesg_q msgq;\n     struct msqid_ds info;\n\n   // key = ftok(\"/home/yash72/krishna/thread_test/msgq.text\", 65);\n    msgid=msgget((key_t)1234, 0666 | IPC_CREAT);\n\n    if(msgid == -1)\n    {\n        printf(\"Msgget failed\\n\");\n        return -1;\n    }\n\n    while(1)\n\n    {\n        if(msgrcv(msgid,&amp;msgq,100,rec_buff,0)==-1)\n        {\n            printf(\"Mesg recv failed\\n\");\n            return -1;\n        }\n        else\n        {\n            printf(\"Mesg Recvd\\n\");\n        }\n        printf(\"Recvd mesg=%s\\n\",msgq.msg_txt);\n\n       msgctl(msgid, IPC_STAT, &amp;info);\n\n        printf(\"Num:of bytes on queue= %d\\n\", info.msg_cbytes);\n        printf(\"num:of messages on queue=%d\\n\", info.msg_qnum);\n        printf(\"Max bytes on queue=%d\\n\", info.msg_qbytes);\n        printf(\"Time of last message recvd=%d\\n\",info.msg_rtime);\n    }     \n}\n</code></pre>\n\n<p>OUTPUT;</p>\n\n<p>Number of bytes on queue= 0\nnumber of messages on queue=0\nMaximum bytes on queue=16384\nTime of last message received=1525240214</p>\n\n<p>what is the reason foe this incorrect values from struct msqid_ds ?</p></li>\n</ul>\n"}, {"tags": ["c", "encryption", "aes", "rsa"], "comments": [{"owner": {"reputation": 3794, "user_id": 7256714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adeb98b0e8995d8576ad5f66c0f982e5?s=128&d=identicon&r=PG&f=1", "display_name": "Pras", "link": "https://stackoverflow.com/users/7256714/pras"}, "edited": false, "score": 0, "creation_date": 1525241865, "post_id": 50127910, "comment_id": 87274160, "body": "It could happen if you used different key for decryption or the encrypted data fed to decryption is not exactly same as the one returned in encryption"}, {"owner": {"reputation": 801, "user_id": 4336593, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/19PVu.jpg?s=128&g=1", "display_name": "santobedi", "link": "https://stackoverflow.com/users/4336593/santobedi"}, "reply_to_user": {"reputation": 3794, "user_id": 7256714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adeb98b0e8995d8576ad5f66c0f982e5?s=128&d=identicon&r=PG&f=1", "display_name": "Pras", "link": "https://stackoverflow.com/users/7256714/pras"}, "edited": false, "score": 0, "creation_date": 1525241873, "post_id": 50127910, "comment_id": 87274163, "body": "I&#39;ve used the same key for both decryptions (before and after storing encrypted data). Also, the encrypted data fed to both decryptions are exactly same."}, {"owner": {"reputation": 1936, "user_id": 342544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e4b36cb0cd601592a4679a0f24c9477?s=128&d=identicon&r=PG", "display_name": "Henno Brandsma", "link": "https://stackoverflow.com/users/342544/henno-brandsma"}, "edited": false, "score": 1, "creation_date": 1526034663, "post_id": 50127910, "comment_id": 87596669, "body": "where does pubkeyfile come from? rsaEncrypt? This code is very incomplete"}, {"owner": {"reputation": 801, "user_id": 4336593, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/19PVu.jpg?s=128&g=1", "display_name": "santobedi", "link": "https://stackoverflow.com/users/4336593/santobedi"}, "reply_to_user": {"reputation": 1936, "user_id": 342544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e4b36cb0cd601592a4679a0f24c9477?s=128&d=identicon&r=PG", "display_name": "Henno Brandsma", "link": "https://stackoverflow.com/users/342544/henno-brandsma"}, "edited": false, "score": 0, "creation_date": 1526101614, "post_id": 50127910, "comment_id": 87622402, "body": "@HennoBrandsma I&#39;ve updated the code. My deadline is coming near and I am stuck at this error :(."}, {"owner": {"reputation": 1936, "user_id": 342544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e4b36cb0cd601592a4679a0f24c9477?s=128&d=identicon&r=PG", "display_name": "Henno Brandsma", "link": "https://stackoverflow.com/users/342544/henno-brandsma"}, "edited": false, "score": 0, "creation_date": 1526103659, "post_id": 50127910, "comment_id": 87622817, "body": "It&#39;s still incomplete: getPublikey? getPrivatekey? undefined still. No main either, so no way to see how this is called."}, {"owner": {"reputation": 1936, "user_id": 342544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e4b36cb0cd601592a4679a0f24c9477?s=128&d=identicon&r=PG", "display_name": "Henno Brandsma", "link": "https://stackoverflow.com/users/342544/henno-brandsma"}, "edited": false, "score": 0, "creation_date": 1526104067, "post_id": 50127910, "comment_id": 87622891, "body": "<code>strlen</code> on a binary message is also very bad."}, {"owner": {"reputation": 801, "user_id": 4336593, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/19PVu.jpg?s=128&g=1", "display_name": "santobedi", "link": "https://stackoverflow.com/users/4336593/santobedi"}, "reply_to_user": {"reputation": 1936, "user_id": 342544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e4b36cb0cd601592a4679a0f24c9477?s=128&d=identicon&r=PG", "display_name": "Henno Brandsma", "link": "https://stackoverflow.com/users/342544/henno-brandsma"}, "edited": false, "score": 0, "creation_date": 1526105547, "post_id": 50127910, "comment_id": 87623181, "body": "@HennoBrandsma I&#39;ve added the <code>getPublickey</code>and <code>getPrivatekey</code>  functions in the question. For sake of brevity, I hadn&#39;t mentioned them in the question."}, {"owner": {"reputation": 1936, "user_id": 342544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e4b36cb0cd601592a4679a0f24c9477?s=128&d=identicon&r=PG", "display_name": "Henno Brandsma", "link": "https://stackoverflow.com/users/342544/henno-brandsma"}, "edited": false, "score": 0, "creation_date": 1526106417, "post_id": 50127910, "comment_id": 87623375, "body": "RSA_KEY_Size is never checked. Do you just assume what you read in has that size, without checking? What pubkeyfile and privkeyfile are you using? Also generated in this program? serializeList is also missing."}, {"owner": {"reputation": 801, "user_id": 4336593, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/19PVu.jpg?s=128&g=1", "display_name": "santobedi", "link": "https://stackoverflow.com/users/4336593/santobedi"}, "reply_to_user": {"reputation": 1936, "user_id": 342544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e4b36cb0cd601592a4679a0f24c9477?s=128&d=identicon&r=PG", "display_name": "Henno Brandsma", "link": "https://stackoverflow.com/users/342544/henno-brandsma"}, "edited": false, "score": 0, "creation_date": 1526108988, "post_id": 50127910, "comment_id": 87623862, "body": "@HennoBrandsma I am using 3072bit key length while generating key pair, i.e. for the function RSA_generate_key_ex. So the key are of size 3072bit(384byte) and got the same size while debugging my code. And pubkeyfile and privkeyfile are just the path of  file for private and public key."}, {"owner": {"reputation": 1936, "user_id": 342544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e4b36cb0cd601592a4679a0f24c9477?s=128&d=identicon&r=PG", "display_name": "Henno Brandsma", "link": "https://stackoverflow.com/users/342544/henno-brandsma"}, "edited": false, "score": 0, "creation_date": 1526109726, "post_id": 50127910, "comment_id": 87624015, "body": "key is a pointer to 32 raw bytes? And iv too? What does serialise do?"}, {"owner": {"reputation": 801, "user_id": 4336593, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/19PVu.jpg?s=128&g=1", "display_name": "santobedi", "link": "https://stackoverflow.com/users/4336593/santobedi"}, "reply_to_user": {"reputation": 1936, "user_id": 342544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e4b36cb0cd601592a4679a0f24c9477?s=128&d=identicon&r=PG", "display_name": "Henno Brandsma", "link": "https://stackoverflow.com/users/342544/henno-brandsma"}, "edited": false, "score": 0, "creation_date": 1526110122, "post_id": 50127910, "comment_id": 87624097, "body": "@HennoBrandsma Yes, key and Iv are of 32 byte and serialize is a function to store the encrypted key and iv in a file."}, {"owner": {"reputation": 1936, "user_id": 342544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e4b36cb0cd601592a4679a0f24c9477?s=128&d=identicon&r=PG", "display_name": "Henno Brandsma", "link": "https://stackoverflow.com/users/342544/henno-brandsma"}, "edited": false, "score": 0, "creation_date": 1526110439, "post_id": 50127910, "comment_id": 87624165, "body": "Remove the call to strlen, if the encrypted data has a zero byte your input is too short."}, {"owner": {"reputation": 801, "user_id": 4336593, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/19PVu.jpg?s=128&g=1", "display_name": "santobedi", "link": "https://stackoverflow.com/users/4336593/santobedi"}, "reply_to_user": {"reputation": 1936, "user_id": 342544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e4b36cb0cd601592a4679a0f24c9477?s=128&d=identicon&r=PG", "display_name": "Henno Brandsma", "link": "https://stackoverflow.com/users/342544/henno-brandsma"}, "edited": false, "score": 0, "creation_date": 1526110835, "post_id": 50127910, "comment_id": 87624269, "body": "@HennoBrandsma What would be the replacement for it? how can we calculate the length? Is there any other option?"}, {"owner": {"reputation": 1936, "user_id": 342544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e4b36cb0cd601592a4679a0f24c9477?s=128&d=identicon&r=PG", "display_name": "Henno Brandsma", "link": "https://stackoverflow.com/users/342544/henno-brandsma"}, "edited": false, "score": 0, "creation_date": 1526112014, "post_id": 50127910, "comment_id": 87624559, "body": "you should keep the lengths for all data. If you&#39;re doing it right, when you write the data to file, you also write the length of each buffer of data before you write the buffer. So when you later read it, you know its length. For encrypted RSA data it&#39;s most likely RSA_KEY_size (almost surely in this openssl library). It looks like your deserialise does not work, and gives wrong length data."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1526157042, "post_id": 50127910, "comment_id": 87636781, "body": "Code after <code>fread(buffer, arrayLen, 1, filePtr);</code> assumes <code>arrayLen</code> bytes were read rather than checking and using the return value from <code>fread()</code>.  Better to change code to not make that assumption."}], "answers": [{"comments": [{"owner": {"reputation": 801, "user_id": 4336593, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/19PVu.jpg?s=128&g=1", "display_name": "santobedi", "link": "https://stackoverflow.com/users/4336593/santobedi"}, "edited": false, "score": 0, "creation_date": 1526115654, "post_id": 50304110, "comment_id": 87625398, "body": "I&#39;ve stored the length for all the data (as mentioned in the question code) in the function &#39;deserialize&#39;. In addition, I changed the <code>arrayLen</code> to <code>uint16_t</code>. However, the error still persists."}, {"owner": {"reputation": 1936, "user_id": 342544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e4b36cb0cd601592a4679a0f24c9477?s=128&d=identicon&r=PG", "display_name": "Henno Brandsma", "link": "https://stackoverflow.com/users/342544/henno-brandsma"}, "reply_to_user": {"reputation": 801, "user_id": 4336593, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/19PVu.jpg?s=128&g=1", "display_name": "santobedi", "link": "https://stackoverflow.com/users/4336593/santobedi"}, "edited": false, "score": 0, "creation_date": 1526115795, "post_id": 50304110, "comment_id": 87625425, "body": "@santobedi you also have to read and write it as 2 bytes, not 1. etc."}, {"owner": {"reputation": 1936, "user_id": 342544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e4b36cb0cd601592a4679a0f24c9477?s=128&d=identicon&r=PG", "display_name": "Henno Brandsma", "link": "https://stackoverflow.com/users/342544/henno-brandsma"}, "reply_to_user": {"reputation": 801, "user_id": 4336593, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/19PVu.jpg?s=128&g=1", "display_name": "santobedi", "link": "https://stackoverflow.com/users/4336593/santobedi"}, "edited": false, "score": 0, "creation_date": 1526533939, "post_id": 50304110, "comment_id": 87782995, "body": "@santobedi besides reading it as 2 bytes, also <i>write</i> it as such , so change serialize too."}], "tags": [], "owner": {"reputation": 1936, "user_id": 342544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e4b36cb0cd601592a4679a0f24c9477?s=128&d=identicon&r=PG", "display_name": "Henno Brandsma", "link": "https://stackoverflow.com/users/342544/henno-brandsma"}, "is_accepted": true, "score": 2, "last_activity_date": 1526112254, "creation_date": 1526112254, "answer_id": 50304110, "question_id": 50127910, "link": "https://stackoverflow.com/questions/50127910/openssl-rsa-routinesrsa-padding-check-pkcs1-type-2pkcs-decoding-error/50304110#50304110", "title": "OpenSSL rsa routines:RSA_padding_check_PKCS1_type_2:pkcs decoding error", "body": "<p><code>arrayLen</code> is only <code>uint8_t</code> which fits at most 255 , so your deserialised data is too short. You need <code>RSA_KEY_Size</code> bytes.</p>\n"}], "owner": {"reputation": 801, "user_id": 4336593, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/19PVu.jpg?s=128&g=1", "display_name": "santobedi", "link": "https://stackoverflow.com/users/4336593/santobedi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5853, "favorite_count": 2, "accepted_answer_id": 50304110, "answer_count": 1, "score": 2, "last_activity_date": 1527654741, "creation_date": 1525240268, "last_edit_date": 1527654741, "question_id": 50127910, "link": "https://stackoverflow.com/questions/50127910/openssl-rsa-routinesrsa-padding-check-pkcs1-type-2pkcs-decoding-error", "title": "OpenSSL rsa routines:RSA_padding_check_PKCS1_type_2:pkcs decoding error", "body": "<p>I'm trying to encrypt/decrypt an AES key/iv using RSA encryption algorithm using openssl in C.</p>\n\n<p>The decryption is working before storing the encrypted data into the file . But the decryption threw an error while decrypting the same encrypted data stored on the file. </p>\n\n<p>Here is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;openssl/pem.h&gt;\n#include &lt;openssl/ssl.h&gt;\n#include &lt;openssl/rsa.h&gt;\n#include &lt;openssl/evp.h&gt;\n#include &lt;openssl/bio.h&gt;\n#include &lt;openssl/err.h&gt;\n#include &lt;string.h&gt;\n\nint padding = RSA_PKCS1_PADDING;\n#define RSA_KEY_Size 384;\n#define AES_256_KEY_SIZE 32;\n\n// testing encryption/decryption\nint func(const char* pubkeyfile, unsigned char *key, unsigned char *iv)\n{\n    unsigned char  *encryptedkey = (unsigned char*)malloc(RSA_KEY_Size);\n    unsigned char  *encryptediv = (unsigned char*)malloc(RSA_KEY_Size);\n    unsigned char  *decryptedkey = (unsigned char*)malloc(AES_256_KEY_SIZE);\n    unsigned char  *decryptediv = (unsigned char*)malloc(AES_256_KEY_SIZE);\n\n    int result1 = rsaEncrypt(key, pubkeyfile, encryptedkey);\n    int result2 = rsaEncrypt(iv, pubkeyfile, encryptediv);\n\n    serialize(encryptedkey, encryptediv);\n\n    ///////tested here, this part working fine\n    int r1 = rsaDecrypt(encryptedkey, privkeyfile, decryptedkey);\n    int r2 = rsaDecrypt(encryptediv, privkeyfile, decryptediv);\n    ///////////////////////////////\n\n    unsigned char *getkey = (unsigned char*)malloc(RSA_KEY_Size);;\n    unsigned char *getiv = (unsigned char*)malloc(RSA_KEY_Size);;\n\n    deserialize(getkey, getiv);\n\n    unsigned char *ikey = (unsigned char*)malloc(AES_256_KEY_SIZE);\n    unsigned char *iiv = (unsigned char*)malloc(AES_256_KEY_SIZE);\n\n    //////////tested here, failed to decrypt after taking encrypted data from a file/////////////////\n    int r22 = rsaDecrypt(getiv, privkeyfile, iiv);\n    int r21 = rsaDecrypt(getkey, privkeyfile, ikey);\n    //////////////////////////////////////////////////\n    return 0;\n}\n\ntypedef struct item {\n    uint8_t keyivlen;\n    char keyiv[RSA_KEY_Size];\n    struct item *next;\n} list;\n\nint serialize(unsigned char* key, unsigned char* iv)\n{\n    list *ptr;\n    char *buffer;\n    int listLength;\n    list first, second;\n    ptr = &amp;first;\n\n    FILE *filePtr;\n    memcpy(first.keyiv, key, strlen(key));\n    first.keyivlen = strlen(first.keyiv);\n    first.next = &amp;second;\n\n    memcpy(second.keyiv, iv, strlen(iv));\n    second.keyivlen = strlen(second.keyiv);\n    second.next = 0;\n\n    listLength = listSize(ptr);\n    buffer = (char *)malloc(listLength);\n    serializeList(ptr, buffer);\n    filePtr = fopen(\"example.data\", \"wb+\");\n    fwrite(buffer, listLength, 1, filePtr);\n    fclose(filePtr);\n    free(buffer);\n    return 0;\n}\n\nint deserialize(unsigned char* key, unsigned char* iv)\n{\n    FILE *filePtr;\n    int listLength = 0;\n    int done = 0;\n    uint8_t arrayLen;\n    unsigned char *buffer;\n    int i = 0;\n    listLength = fileSize(\"example.data\");\n\n    filePtr = fopen(\"example.data\", \"rb\");\n    while (done &lt; listLength) {\n        fread(&amp;arrayLen, 1, 1, filePtr);\n        buffer = (unsigned char *)malloc(arrayLen + 1);\n        fread(buffer, arrayLen, 1, filePtr);\n        buffer[arrayLen] = '\\0';\n        if (i == 0)\n        {\n            memcpy(key, buffer, arrayLen + 1);\n        }\n        else\n        {\n            memcpy(iv, buffer, arrayLen + 1);\n        }\n        //addToList(arrayLen, buffer);\n        done += arrayLen + 1;\n        i++;\n        free(buffer);\n    }\n    //printList(start);\n\n    return 0;\n}\n</code></pre>\n\n<p>Here is the error:</p>\n\n<pre><code>error:0407109F:rsa routines:RSA_padding_check_PKCS1_type_2:pkcs decoding error\nerror:04065072:rsa routines:rsa_ossl_private_decrypt:padding check failed\n</code></pre>\n\n<p>And it fails in:</p>\n\n<pre><code>    int r22 = rsaDecrypt(getiv, privkeyfile, iiv);\n    int r21 = rsaDecrypt(getkey, privkeyfile, ikey);\n</code></pre>\n\n<p>What could be the reason for this error? </p>\n"}, {"tags": ["c", "string", "input", "scanf", "fgets"], "comments": [{"owner": {"reputation": 4703, "user_id": 5375464, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3292ca87ff6c766b75dbe4b2ea0831da?s=128&d=identicon&r=PG&f=1", "display_name": "J...S", "link": "https://stackoverflow.com/users/5375464/j-s"}, "edited": false, "score": 0, "creation_date": 1525240094, "post_id": 50127809, "comment_id": 87273490, "body": "What do you mean &quot;get string from input with all spaces&quot;? Can you give an example?"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 2, "creation_date": 1525240101, "post_id": 50127809, "comment_id": 87273494, "body": "I think you need to show a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, <b>Complete</b>, and Verifiable example</a>. Usually, this kind of problem occurs because some other input function left a newline character on the input."}, {"owner": {"reputation": 4703, "user_id": 5375464, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3292ca87ff6c766b75dbe4b2ea0831da?s=128&d=identicon&r=PG&f=1", "display_name": "J...S", "link": "https://stackoverflow.com/users/5375464/j-s"}, "edited": false, "score": 0, "creation_date": 1525240426, "post_id": 50127809, "comment_id": 87273598, "body": "What&#39;s your value for `MAX&#39;?"}, {"owner": {"reputation": 43, "user_id": 8810439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e4IeD.jpg?s=128&g=1", "display_name": "codergirrl", "link": "https://stackoverflow.com/users/8810439/codergirrl"}, "reply_to_user": {"reputation": 4703, "user_id": 5375464, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3292ca87ff6c766b75dbe4b2ea0831da?s=128&d=identicon&r=PG&f=1", "display_name": "J...S", "link": "https://stackoverflow.com/users/5375464/j-s"}, "edited": false, "score": 0, "creation_date": 1525240770, "post_id": 50127809, "comment_id": 87273729, "body": "@J...S MAX is 15. If I use scanf I get just  &quot;abc&quot; from &quot;abc def&quot;. So I used fgets to have all chars with space. But it works only in main."}], "answers": [{"tags": [], "owner": {"reputation": 3624, "user_id": 8013471, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jh4jO.jpg?s=128&g=1", "display_name": "cse", "link": "https://stackoverflow.com/users/8013471/cse"}, "is_accepted": true, "score": 1, "last_activity_date": 1525243980, "creation_date": 1525243980, "answer_id": 50128708, "question_id": 50127809, "link": "https://stackoverflow.com/questions/50127809/getting-string-with-spaces-from-input-in-a-switch-case-or-loop/50128708#50128708", "title": "getting string with spaces from input in a switch case or loop", "body": "<p>The problem is that <code>stdin</code> is not getting <em>flushed</em> properly.</p>\n\n<p>You need to manually <em>flush</em> it. (<em>fflush()</em> function is available. But it is <em>problematic</em>.) </p>\n\n<p>Following is an example code to solve your issue. See it <a href=\"https://ideone.com/rBBSqM\" rel=\"nofollow noreferrer\">working here</a>:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#define MAX 15\n\nint main(void) {\n    // your code goes here\n    char name[MAX];\n    char c;\n    int choice=1;\n    while(choice&gt;0 &amp;&amp; choice&lt;3)\n    {\n        printf(\"Enter your choice: \");\n        scanf(\"%d\", &amp;choice);\n\n        switch(choice)\n        {\n            case 1:\n\n                //Flush stdin\n                while ((c = getchar()) == '\\n');\n                ungetc(c, stdin);\n\n                printf(\"What is your name? \");\n                fgets(name, MAX, stdin);\n                if ((strlen(name) &gt; 0) &amp;&amp; (name[strlen(name) - 1] == '\\n'))\n                name[strlen(name) - 1] = '\\0';\n                printf(\"Hello %s. Nice to meet you.\\n\", name);\n            break;\n\n            case 2:\n                printf(\"Your choice is case 2\\n\");\n            break;\n        }\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 8810439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e4IeD.jpg?s=128&g=1", "display_name": "codergirrl", "link": "https://stackoverflow.com/users/8810439/codergirrl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 307, "favorite_count": 0, "accepted_answer_id": 50128708, "answer_count": 1, "score": 0, "last_activity_date": 1525243980, "creation_date": 1525239730, "question_id": 50127809, "link": "https://stackoverflow.com/questions/50127809/getting-string-with-spaces-from-input-in-a-switch-case-or-loop", "title": "getting string with spaces from input in a switch case or loop", "body": "<p>I try this code which I found on this website (<a href=\"https://stackoverflow.com/questions/1247989/how-do-you-allow-spaces-to-be-entered-using-scanf\">how-do-you-allow-spaces-to-be-entered-using-scanf</a>)</p>\n\n<pre><code>           char name[15];         //or char*name=malloc(15);\n           /* Ask user for name. */\n\n            printf(\"What is your name? \");\n\n            /* Get the name, with size limit. */\n\n            fgets(name, MAX, stdin);\n\n            /* Remove trailing newline, if there. */\n\n            if ((strlen(name) &gt; 0) &amp;&amp; (name[strlen(name) - 1] == '\\n'))\n                name[strlen(name) - 1] = '\\0';\n\n            /* Say hello. */\n\n            printf(\"Hello %s. Nice to meet you.\\n\", name);\n</code></pre>\n\n<p>When I run this code in main it works pretty well. Output is:</p>\n\n<pre><code> What is your name? j k rowling\nHello j k rowling. Nice to meet you.\n</code></pre>\n\n<p>But when I put this code in a while loop or in a switch case:</p>\n\n<pre><code>        char name[15];\n        switch (choice) {\n            case 1:\n            printf(\"What is your name? \");\n\n            /* Get the name, with size limit. */\n\n            fgets(name, MAX, stdin);\n\n            /* Remove trailing newline, if there. */\n\n            if ((strlen(name) &gt; 0) &amp;&amp; (name[strlen(name) - 1] == '\\n'))\n                name[strlen(name) - 1] = '\\0';\n\n            /* Say hello. */\n\n            printf(\"Hello %s. Nice to meet you.\\n\", name);\n\n\n            break;  }\n</code></pre>\n\n<p>The output is:</p>\n\n<pre><code>What is your name? Hello . Nice to meet you.\n</code></pre>\n\n<p>So, it doesn't wait to entering a string. maybe fgets doesn't work I don't know.</p>\n\n<p>How can I make this code work? Or any alternative to get string from input with all spaces. I tried this either:</p>\n\n<pre><code>switch (choice) {\n        case 1:\n            printf(\"What is your name? \");\n            scanf(\"%[^\\n]s\", name);\n            printf(\"%s\\n\", name);  }\n</code></pre>\n\n<p>output is:</p>\n\n<pre><code>What is your name? \u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\u2560\n</code></pre>\n\n<p>What is wrong with these? I use visiual studio. And I always get a trouble. Is this about it? </p>\n"}, {"tags": ["c", "string"], "comments": [{"owner": {"reputation": 142, "user_id": 8718926, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eedb47e5b986617bc0bf97a7e5ed1007?s=128&d=identicon&r=PG&f=1", "display_name": "Kanishk Tanwar", "link": "https://stackoverflow.com/users/8718926/kanishk-tanwar"}, "edited": false, "score": 0, "creation_date": 1525240175, "post_id": 50127799, "comment_id": 87273517, "body": "You want to extract two numbers separating by comma?"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1525240226, "post_id": 50127799, "comment_id": 87273535, "body": "Is it always <code>a,</code> that separates the two numbers? Or can it be a different letter? Can it be multiple letters?"}, {"owner": {"reputation": 142, "user_id": 8718926, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eedb47e5b986617bc0bf97a7e5ed1007?s=128&d=identicon&r=PG&f=1", "display_name": "Kanishk Tanwar", "link": "https://stackoverflow.com/users/8718926/kanishk-tanwar"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1525240280, "post_id": 50127799, "comment_id": 87273547, "body": "@user3386109 if it will not, this is what he is asking"}, {"owner": {"reputation": 142, "user_id": 8718926, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eedb47e5b986617bc0bf97a7e5ed1007?s=128&d=identicon&r=PG&f=1", "display_name": "Kanishk Tanwar", "link": "https://stackoverflow.com/users/8718926/kanishk-tanwar"}, "edited": false, "score": 0, "creation_date": 1525240349, "post_id": 50127799, "comment_id": 87273567, "body": "idk but best bet is to use loop indexing from 0 to len(string) and use if statement for finding if it is ascii(48-57) and store the result in an array"}, {"owner": {"reputation": 730, "user_id": 9360663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eAhe5.png?s=128&g=1", "display_name": "po.pe", "link": "https://stackoverflow.com/users/9360663/po-pe"}, "edited": false, "score": 0, "creation_date": 1525240585, "post_id": 50127799, "comment_id": 87273663, "body": "it&#39;s &quot;always&quot; &#39;a,&#39; that separates the two numbers... but the string could also look completely different, then I just have to recognize it."}], "answers": [{"comments": [{"owner": {"reputation": 730, "user_id": 9360663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eAhe5.png?s=128&g=1", "display_name": "po.pe", "link": "https://stackoverflow.com/users/9360663/po-pe"}, "edited": false, "score": 0, "creation_date": 1525241010, "post_id": 50127980, "comment_id": 87273821, "body": "Why didn&#39;t I see this... shame on me! Was alreading thinking of regex"}, {"owner": {"reputation": 730, "user_id": 9360663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eAhe5.png?s=128&g=1", "display_name": "po.pe", "link": "https://stackoverflow.com/users/9360663/po-pe"}, "edited": false, "score": 0, "creation_date": 1525241411, "post_id": 50127980, "comment_id": 87273982, "body": "Sorry one question,... what would happen in this case if the input string would be &quot;ewwf22&quot;? Would I have to catch that before the sscan()?"}, {"owner": {"reputation": 3624, "user_id": 8013471, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jh4jO.jpg?s=128&g=1", "display_name": "cse", "link": "https://stackoverflow.com/users/8013471/cse"}, "reply_to_user": {"reputation": 730, "user_id": 9360663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eAhe5.png?s=128&g=1", "display_name": "po.pe", "link": "https://stackoverflow.com/users/9360663/po-pe"}, "edited": false, "score": 0, "creation_date": 1525241546, "post_id": 50127980, "comment_id": 87274042, "body": "@Humpawumpa Yes, Because in above example <i>formatting string</i> is static. So it cannot fetch numeric part from input <code>ewwf22</code>. It will be problematic. You need to use another <code>sscanf()</code> for this."}, {"owner": {"reputation": 4703, "user_id": 5375464, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3292ca87ff6c766b75dbe4b2ea0831da?s=128&d=identicon&r=PG&f=1", "display_name": "J...S", "link": "https://stackoverflow.com/users/5375464/j-s"}, "reply_to_user": {"reputation": 730, "user_id": 9360663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eAhe5.png?s=128&g=1", "display_name": "po.pe", "link": "https://stackoverflow.com/users/9360663/po-pe"}, "edited": false, "score": 0, "creation_date": 1525241599, "post_id": 50127980, "comment_id": 87274061, "body": "@Humpawumpa <code>sscanf(&quot;%*[^0123456789]%d&quot;, &amp;b)</code> might suffice."}], "tags": [], "owner": {"reputation": 3624, "user_id": 8013471, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jh4jO.jpg?s=128&g=1", "display_name": "cse", "link": "https://stackoverflow.com/users/8013471/cse"}, "is_accepted": true, "score": 2, "last_activity_date": 1525240617, "creation_date": 1525240617, "answer_id": 50127980, "question_id": 50127799, "link": "https://stackoverflow.com/questions/50127799/extracting-numbers-from-string-in-c/50127980#50127980", "title": "Extracting Numbers from String in C", "body": "<p>Yes you can do this easily with <code>sscanf()</code>.</p>\n\n<p>Following is an example. See it <a href=\"https://ideone.com/gA2PKY\" rel=\"nofollow noreferrer\">working here</a>:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) {\n    float a;\n    int b;\n    char *sNum = \"43.533a,5532\";\n\n    sscanf(sNum, \"%fa,%d\", &amp;a, &amp;b);\n    printf(\"a= %f || b= %d\", a,b);\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Output</strong>:</p>\n\n<pre><code>a= 43.533001 || b= 5532\n</code></pre>\n\n<p><em>Note:</em> Since float is having precision to <code>6</code> decimal place by default, so you may need to consider it and correct it if necessary.</p>\n"}], "owner": {"reputation": 730, "user_id": 9360663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eAhe5.png?s=128&g=1", "display_name": "po.pe", "link": "https://stackoverflow.com/users/9360663/po-pe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "closed_date": 1525247761, "accepted_answer_id": 50127980, "answer_count": 1, "score": 0, "last_activity_date": 1525240617, "creation_date": 1525239683, "question_id": 50127799, "link": "https://stackoverflow.com/questions/50127799/extracting-numbers-from-string-in-c", "closed_reason": "Not suitable for this site", "title": "Extracting Numbers from String in C", "body": "<p>I have an ASCII string coming from UART that looks something like \"43.533a,5532\" and I'd like to extract the two numbers. My idea was to separate them using strtok with the comma as delimiter and then remove the last character from the first string and afterwards convert the numbers using atoi() or is there an easier way with sscanf()? String manipulation is nothing I'm regularly using.\nAnother problem is, if the String looks different, how could I catch that beforehand?</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 8, "creation_date": 1525238309, "post_id": 50127536, "comment_id": 87272931, "body": "It sounds like you misunderstood whatever the book was saying. The claim you&#39;re attributing to the book makes no sense."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1525238320, "post_id": 50127536, "comment_id": 87272938, "body": "A pointer is just a variable that holds the address to something else as its value. Where you normally think of a variable holding an immediate values, such as <code>int a = 5;</code>, a pointer would simply hold the address where <code>5</code> is stored, e.g. <code>int *b = &amp;a;</code>. In other words <code>b</code> <i>points</i> to where the value of <code>a</code> is stored (e.g. <code>b</code> <i>points</i> to <code>a</code>)."}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1525238360, "post_id": 50127536, "comment_id": 87272952, "body": "Each memory chunk has an address. A pointer is just a store whose contained value is a memory address. You can have a pointer containing any address you want, but referring to that address may not be possible (some are forbidden to use in some way)."}, {"owner": {"reputation": 55, "user_id": 9728148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e858c2b200c3ac3de010fe40b79e65ba?s=128&d=identicon&r=PG&f=1", "display_name": "chaotic", "link": "https://stackoverflow.com/users/9728148/chaotic"}, "edited": false, "score": 0, "creation_date": 1525238427, "post_id": 50127536, "comment_id": 87272974, "body": "So both stack AND heap have pointers to their values or pointers to their memory slots, or if <code>char*</code> pointers to the first element of that array? Or is it only heap."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1525238593, "post_id": 50127536, "comment_id": 87273026, "body": "A pointer is a pointer is a pointer --- it can hold any address -- whether that points to an address on the stack or whether it points to allocated memory -- makes no difference. It&#39;s just a pointer. (which is just a normal variable that holds the address to something else) A pointer must be initialized and store a valid address to something. When a pointer is declared it is <b>uninitialized</b> until it is assigned a value. (bad things happen when people attempt to use uninitialized pointers....)"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1525238698, "post_id": 50127536, "comment_id": 87273058, "body": "Every object has a size and int he stack it&#39;s all, wait for it, stacked one atop the other. You push your way up, and pop your way down. No ids are necessary, you just need to know how much stuff to put on and then how much to pull off when it goes out of scope. The compiler takes care of it for you."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 4, "creation_date": 1525239163, "post_id": 50127536, "comment_id": 87273192, "body": "It might help to post the exact text from the book"}, {"owner": {"reputation": 11455, "user_id": 10888, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/adbf81127c90a370ceab11b3087a8e4e?s=128&d=identicon&r=PG", "display_name": "Leonard", "link": "https://stackoverflow.com/users/10888/leonard"}, "edited": false, "score": 0, "creation_date": 1525239446, "post_id": 50127536, "comment_id": 87273276, "body": "And as another bit to foster your understanding, the stack is typically being used to allocate space for variables declared in a subroutine.  A pointer to a stack memory address will no longer be valid after a subroutine returns because that address can and will be re-used."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1525242050, "post_id": 50127536, "comment_id": 87274237, "body": "In my experience, the \u201dHead first\u201d books are pretty awful."}, {"owner": {"reputation": 144819, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 2, "creation_date": 1525242052, "post_id": 50127536, "comment_id": 87274239, "body": "Maybe the thing you have not realised is that there is an <i>implicit</i> stack pointer created by the compiler, not you, every time you call a function. All stack variables are referenced via offsets from this pointer you can&#39;t see."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1525244700, "post_id": 50127536, "comment_id": 87275516, "body": "I would assume that the book wants to tell you that you can access memory on the stack without using pointers. You can simply use <code>int var;</code> and lateron <code>var = 123;</code> in your function and don&#39;t need to bother with pointers. Memory on the heap cannot be accessed without explicitely using pointers."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "reply_to_user": {"reputation": 144819, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1525250816, "post_id": 50127536, "comment_id": 87278774, "body": "@MarkSetchell: You&#39;re thinking of x86. It&#39;s not universal. SPARC had a register file."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "reply_to_user": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1525251198, "post_id": 50127536, "comment_id": 87278998, "body": "@MSalters if your C program takes the address of a local, the SPARC compiler has to put that local somewhere addressable"}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "reply_to_user": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1525251472, "post_id": 50127536, "comment_id": 87279157, "body": "@Caleth: Actually, you might be surprised at how good compilers can be. For instance, if you just <code>printf</code> the address, you might find that the compiler never bothers to spill the register. The &quot;AS-IF&quot; rule is pretty powerful."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "reply_to_user": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1525251797, "post_id": 50127536, "comment_id": 87279327, "body": "@MSalters Ok, &quot;takes and <i>uses in some non-trivial way</i> the address of a local&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1525239330, "post_id": 50127688, "comment_id": 87273247, "body": "In C pretty much anything has an address. The exception are temporary values and objects declared as <code>register</code>."}], "tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": false, "score": 5, "last_activity_date": 1525239151, "creation_date": 1525239151, "answer_id": 50127688, "question_id": 50127536, "link": "https://stackoverflow.com/questions/50127536/how-is-memory-on-the-stack-identified-if-it-doesnt-have-pointers/50127688#50127688", "title": "How is memory on the stack identified if it doesn&#39;t have pointers?", "body": "<p>Every memory location has an <em>address</em>.  There is nothing like the idea you suggest that stack memory does not have addresses.</p>\n\n<p>A pointer value is the address of a memory location, and a pointer variable is a variable that can store a pointer value.</p>\n"}, {"comments": [{"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1525251623, "post_id": 50130186, "comment_id": 87279246, "body": "There&#39;s no guarantee that the stack is contiguous in virtual memory space either. It can be a linked list, in which case the data is not referenced by an offset. Remember, a function can&#39;t directly access stack variables from its caller, so there&#39;s no need for those to be located at an offset to its own."}, {"owner": {"reputation": 169, "user_id": 4617668, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-O2iZBdSrs8Q/AAAAAAAAAAI/AAAAAAAAACg/G2ewkgmA-HE/photo.jpg?sz=128", "display_name": "Jay Wai Tan", "link": "https://stackoverflow.com/users/4617668/jay-wai-tan"}, "reply_to_user": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1525361154, "post_id": 50130186, "comment_id": 87335145, "body": "Maybe I am not* understanding you correctly, can you elaborate on how a stack can be a linked list?"}], "tags": [], "owner": {"reputation": 169, "user_id": 4617668, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-O2iZBdSrs8Q/AAAAAAAAAAI/AAAAAAAAACg/G2ewkgmA-HE/photo.jpg?sz=128", "display_name": "Jay Wai Tan", "link": "https://stackoverflow.com/users/4617668/jay-wai-tan"}, "is_accepted": false, "score": 0, "last_activity_date": 1525249656, "creation_date": 1525249656, "answer_id": 50130186, "question_id": 50127536, "link": "https://stackoverflow.com/questions/50127536/how-is-memory-on-the-stack-identified-if-it-doesnt-have-pointers/50130186#50130186", "title": "How is memory on the stack identified if it doesn&#39;t have pointers?", "body": "<p>Data in the stack is referenced by an offset from the stack/base pointer.</p>\n\n<p>When your program is executed, a chunk of memory is allocated by the OS for its purposes. The stack will then be used by your program to store data that is required for normal execution. Note that this chunk of memory may not be sequential in the physical memory but a virtual memory space mapped by the OS.</p>\n\n<p>When a variable is defined locally in a function, the compiler will generate code that reads a chunk of data in the stack that is used to represent your variable. Care is taken by the compiler to ensure multiple variables will not occupy the same space. Note that a optimising compiler can still use the same space for several variables if previous definitions are deemed as useless within the execution flow (Not to be confused with lifetime validity of a variable in C++).</p>\n\n<p>This process however, is only applicable when you know exactly how much memory you need at compile time, meaning the compiler will be able to generate an offset for each named variable defined in your program. This means that there is no need to explicitly read a memory location, aka dereferencing of pointers. <strong>However, this does not mean that the variable itself does not reside in a memory location and does not have an address that can reference it.</strong> </p>\n\n<p>When writing programs that require dynamic memory allocation, you will have to explicitly tell the OS to allocate more memory to your program. Since this memory location is dynamic, the address will not be known at compile time, meaning data access can only be done via dereferencing memory locations. In this case, it will be the additional chunk of memory allocated by the OS.</p>\n\n<p>Last but not least, compilers can and will always try generate code that stores variables in registers, hence referencing a variable can be very different depending on the code generated.</p>\n"}], "owner": {"reputation": 55, "user_id": 9728148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e858c2b200c3ac3de010fe40b79e65ba?s=128&d=identicon&r=PG&f=1", "display_name": "chaotic", "link": "https://stackoverflow.com/users/9728148/chaotic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1525249656, "creation_date": 1525238086, "question_id": 50127536, "link": "https://stackoverflow.com/questions/50127536/how-is-memory-on-the-stack-identified-if-it-doesnt-have-pointers", "title": "How is memory on the stack identified if it doesn&#39;t have pointers?", "body": "<p>Correct me if I'm wrong but pointers are identifiers (an ID) given to each bit of memory. If the memory on the heap has pointers it can be identified which gives the code ability to delete, modify or even change it's size. The confusion comes when I've read a book saying stack doesn't have pointers.</p>\n\n<p>I've been reading the book 'Head First C', and it was talking about pointers. Was it simply refering to pointers just as an example? Or does the memory on the stack have some kind of pointer to memory?</p>\n\n<p>If not, how is it identified? The confusion or contradiction between web posts and books have really confused me on a subject I am only just understanding. Can anyone clear this up?</p>\n"}, {"tags": ["c", "gcc", "clang", "llvm"], "comments": [{"owner": {"reputation": 6533, "user_id": 1918193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b70a14318e0f417ecac47809f38fafc?s=128&d=identicon&r=PG", "display_name": "Marc Glisse", "link": "https://stackoverflow.com/users/1918193/marc-glisse"}, "edited": false, "score": 1, "creation_date": 1525243671, "post_id": 50126786, "comment_id": 87275003, "body": "Why do you want that? And what asm do you expect exactly? Some movabsq followed by a move to an XMM register (possibly through memory depending on the exact target) and finally the broadcast?"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1525259124, "post_id": 50126786, "comment_id": 87284118, "body": "The local variables are not global. The compiler is using registers for them. It is storing 0x8000000000000000 with effectively static storage duration. 0x8000000000000000 is a constant, not a variable. The compiler is free to implement it as it desires. What is your concern about how it is stored\u2014why do you care, what effect does it have for you?"}, {"owner": {"reputation": 1, "user_id": 6216198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c49dca7b41b98c2c844fc9116b4ff2e?s=128&d=identicon&r=PG&f=1", "display_name": "NealHu", "link": "https://stackoverflow.com/users/6216198/nealhu"}, "reply_to_user": {"reputation": 6533, "user_id": 1918193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b70a14318e0f417ecac47809f38fafc?s=128&d=identicon&r=PG", "display_name": "Marc Glisse", "link": "https://stackoverflow.com/users/1918193/marc-glisse"}, "edited": false, "score": 0, "creation_date": 1525259472, "post_id": 50126786, "comment_id": 87284345, "body": "@MarcGlisse @Eric Postpischil I want convert these asm to the go-asm by <code>c2goasm</code>. And I meet a issue <a href=\"https://github.com/minio/c2goasm/issues/8\" rel=\"nofollow noreferrer\">github.com/minio/c2goasm/issues/8</a>"}, {"owner": {"reputation": 1, "user_id": 6216198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c49dca7b41b98c2c844fc9116b4ff2e?s=128&d=identicon&r=PG&f=1", "display_name": "NealHu", "link": "https://stackoverflow.com/users/6216198/nealhu"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1525259653, "post_id": 50126786, "comment_id": 87284465, "body": "@EricPostpischil  I want convert these asm to the go-asm by c2goasm. And I meet a issue github.com/minio/c2goasm/issues/8"}, {"owner": {"reputation": 904, "user_id": 2714128, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2218a1e5916b32e837386473fece442e?s=128&d=identicon&r=PG&f=1", "display_name": "ConsistentProgrammer", "link": "https://stackoverflow.com/users/2714128/consistentprogrammer"}, "edited": false, "score": 0, "creation_date": 1525263885, "post_id": 50126786, "comment_id": 87287058, "body": "Compile using -Os flag. This will stop the generation of global jump tables. Tested with clang 3.8"}], "owner": {"reputation": 1, "user_id": 6216198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c49dca7b41b98c2c844fc9116b4ff2e?s=128&d=identicon&r=PG&f=1", "display_name": "NealHu", "link": "https://stackoverflow.com/users/6216198/nealhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 161, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1525232305, "creation_date": 1525232305, "question_id": 50126786, "link": "https://stackoverflow.com/questions/50126786/how-to-prevent-clang-llvm-compile-local-variables-to-global", "title": "How to prevent clang/llvm compile local variables to global?", "body": "<p>I have a C code:</p>\n\n<pre><code>int64_t sample_max(int64_t *beg, int64_t len) {\n    if (len == 0) {\n        return 0;\n    }\n    int64_t max = 0x8000000000000000;\n    int64_t *end = beg + len;\n    while (beg &lt; end) {\n        if (*beg &gt; max) {\n            max = *beg;\n        }\n        beg++;\n    }\n    return max;\n}\n</code></pre>\n\n<p>and complie it by clang:</p>\n\n<pre><code>clang -S -target x86_64-unknown-none -masm=intel -mno-red-zone -mstackrealign -mllvm -inline-threshold=1000 -fno-asynchronous-unwind-tables -fno-exceptions -fno-rtti -O3 -fno-builtin -ffast-math -mavx2 lib/sample.c -o lib/sample_avx2.s\n</code></pre>\n\n<p>and I found the clang/llvm complie the local variables \"max = 0x8000000000000000\" to global :</p>\n\n<pre><code>vpbroadcastq    ymm0, qword ptr [rip + .LCPI1_0]\n    vmovdqa ymm3, ymm0\n    vmovdqa ymm2, ymm0\n    vmovdqa ymm1, ymm0\n\n....\n\n.LCPI1_0:\n    .quad   -9223372036854775808    # 0x8000000000000000\n    .section    .rodata,\"a\",@progbits\n    .align  32\n</code></pre>\n\n<p>How to prevent clang/llvm compile local variables to global?\nCould we compile 0x8000000000000000 to a immediate values?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["c++", "c", "arrays"], "comments": [{"owner": {"reputation": 9953, "user_id": 8012206, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/z0Yl9.jpg?s=128&g=1", "display_name": "Joseph D.", "link": "https://stackoverflow.com/users/8012206/joseph-d"}, "edited": false, "score": 1, "creation_date": 1525232400, "post_id": 50126773, "comment_id": 87271497, "body": "could you give your expected output and sample input? quite confusing if your problem is with <code>isalpha</code>/<code>isdigit</code> or checking for palindromes"}, {"owner": {"reputation": 15, "user_id": 9274790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f740dcf9a5754b113223a0a022b6c184?s=128&d=identicon&r=PG&f=1", "display_name": "edmonda7", "link": "https://stackoverflow.com/users/9274790/edmonda7"}, "reply_to_user": {"reputation": 9953, "user_id": 8012206, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/z0Yl9.jpg?s=128&g=1", "display_name": "Joseph D.", "link": "https://stackoverflow.com/users/8012206/joseph-d"}, "edited": false, "score": 0, "creation_date": 1525232545, "post_id": 50126773, "comment_id": 87271525, "body": "@codekaizer yeah sure, for example my string in palind[] will be abc123 so i expect the other 2 string to have abc for the arrayAlpha and 123 for the arrayNum"}, {"owner": {"reputation": 9953, "user_id": 8012206, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/z0Yl9.jpg?s=128&g=1", "display_name": "Joseph D.", "link": "https://stackoverflow.com/users/8012206/joseph-d"}, "edited": false, "score": 0, "creation_date": 1525232629, "post_id": 50126773, "comment_id": 87271540, "body": "what is <code>palind</code>? <code>char*</code>? or <code>std::string</code>? or something else?"}, {"owner": {"reputation": 15, "user_id": 9274790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f740dcf9a5754b113223a0a022b6c184?s=128&d=identicon&r=PG&f=1", "display_name": "edmonda7", "link": "https://stackoverflow.com/users/9274790/edmonda7"}, "reply_to_user": {"reputation": 9953, "user_id": 8012206, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/z0Yl9.jpg?s=128&g=1", "display_name": "Joseph D.", "link": "https://stackoverflow.com/users/8012206/joseph-d"}, "edited": false, "score": 0, "creation_date": 1525232688, "post_id": 50126773, "comment_id": 87271552, "body": "@codekaizer the palind, arrayAlpha, and arrayNum are all char arrays set like &quot;char palind[30];&quot;"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1525232710, "post_id": 50126773, "comment_id": 87271557, "body": "@edmonda7 Just logically, don&#39;t you think you need two different subscripts instead of a single <code>k</code>?  What if there are 50 alpha characters and 1 digit character in <code>palin</code>?"}, {"owner": {"reputation": 15, "user_id": 9274790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f740dcf9a5754b113223a0a022b6c184?s=128&d=identicon&r=PG&f=1", "display_name": "edmonda7", "link": "https://stackoverflow.com/users/9274790/edmonda7"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1525232869, "post_id": 50126773, "comment_id": 87271595, "body": "@PaulMcKenzie but shouldnt it not matter because if the element is a digit it will copy into the new array and ignore the next if statement because isdigit will return false, no?"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1525232936, "post_id": 50126773, "comment_id": 87271615, "body": "@edmonda7 -- What if the only digit is the last character and there are 50 characters?  Your <code>k</code> subscript will not be <code>0</code>, it will be 49, and you will be writing to <code>arrayNum[49]</code> instead of <code>arrayNum[0]</code>.  You need two subscripts, one to keep track of where you are in the alpha array, and one to keep track of where you are in the digit array."}, {"owner": {"reputation": 15, "user_id": 9274790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f740dcf9a5754b113223a0a022b6c184?s=128&d=identicon&r=PG&f=1", "display_name": "edmonda7", "link": "https://stackoverflow.com/users/9274790/edmonda7"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1525233043, "post_id": 50126773, "comment_id": 87271637, "body": "@PaulMcKenzie Oh you&#39;re right i didn&#39;t think about that"}], "answers": [{"tags": [], "owner": {"reputation": 9953, "user_id": 8012206, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/z0Yl9.jpg?s=128&g=1", "display_name": "Joseph D.", "link": "https://stackoverflow.com/users/8012206/joseph-d"}, "is_accepted": true, "score": 1, "last_activity_date": 1525235313, "last_edit_date": 1525235313, "creation_date": 1525232522, "answer_id": 50126822, "question_id": 50126773, "link": "https://stackoverflow.com/questions/50126773/setting-char-arrays-equal-to-eachother-with-isdigit-and-isalpha/50126822#50126822", "title": "setting char arrays equal to eachother with isdigit and isalpha", "body": "<p>Given the input:</p>\n\n<pre><code>char palind[30] = \"12345abcde\";\n</code></pre>\n\n<ul>\n<li><p><code>arrayAlpha</code> is garbage.</p></li>\n<li><p><code>arrayNum</code> is <code>\"12345\"</code></p></li>\n</ul>\n\n<p>However,</p>\n\n<pre><code>char palind[30] = \"abcde12345\";\n</code></pre>\n\n<ul>\n<li><code>arrayAlpha</code> is <code>\"abcde\"</code>.</li>\n<li><code>arrayNum</code> is garbage.</li>\n</ul>\n\n<p>Thus, <code>[k]</code> is the problem when used in your <code>arrayNum</code> or <code>arrayAlpha</code> which doesn't start with <code>0</code>.</p>\n\n<p>Simple change will just be subtracting the length of the other.</p>\n\n<pre><code>arrayAlpha[k - strlen(arrayNum)] = palind[k];\narrayNum[k - strlen(arrayAlpha)] = palind[k];\n</code></pre>\n\n<p>since <code>lengthOfPalind = lengthOfArrayAlpha + lengthOfArrayNum</code> assuming <code>palind</code> only contains letters or numbers.</p>\n"}], "owner": {"reputation": 15, "user_id": 9274790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f740dcf9a5754b113223a0a022b6c184?s=128&d=identicon&r=PG&f=1", "display_name": "edmonda7", "link": "https://stackoverflow.com/users/9274790/edmonda7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 50126822, "answer_count": 1, "score": 0, "last_activity_date": 1525235313, "creation_date": 1525232212, "question_id": 50126773, "link": "https://stackoverflow.com/questions/50126773/setting-char-arrays-equal-to-eachother-with-isdigit-and-isalpha", "title": "setting char arrays equal to eachother with isdigit and isalpha", "body": "<p>Im trying to set a char array equal to 2 other arrays depending on if the element in the first array is a number or a letter. The code makes logical sense to me but the output for the 2 other strings after the for loop doesn't correspond to the logic. Is it because of a missing null value somewhere in the other 2 loops or is the code itself invalid? arrayAlpha, arrayNum, and palind are all char arrays set to a length of 30 elements while string length was already determined before the for loop began.</p>\n\n<pre><code>for(int k=0; k&lt;=stringLength; k++)\n{\n    if( isalpha(palind[k])){\n        arrayAlpha[k]=palind[k];}\n    if ( isdigit(palind[k]))\n    {\n        arrayNum[k]=palind[k];\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "cs50"], "comments": [{"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1525257930, "post_id": 50126758, "comment_id": 87283380, "body": "Please <a href=\"https://stackoverflow.com/posts/50126758/edit\">edit</a> your question to show <a href=\"http://whathaveyoutried.com\" rel=\"nofollow noreferrer\">the code you have so far</a>.  You should include at least an outline (but preferably a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>) of the code that you are having problems with, then we can try to help with the specific problem. You should also read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>."}, {"owner": {"reputation": 102, "user_id": 9564000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1caee334a40251f677778ef58980859?s=128&d=identicon&r=PG&f=1", "display_name": "amirkamizi", "link": "https://stackoverflow.com/users/9564000/amirkamizi"}, "reply_to_user": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1525268938, "post_id": 50126758, "comment_id": 87290588, "body": "@TobySpeight I&#39;ve added my full code"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1525269068, "post_id": 50126758, "comment_id": 87290685, "body": "You&#39;re not expected to show everything you&#39;ve written (see the &quot;minimal&quot; section of <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>).  That said, you&#39;re still missing a <code>main()</code> and at least one <code>#include</code> line before we can reproduce what you&#39;ve done."}], "answers": [{"comments": [{"owner": {"reputation": 102, "user_id": 9564000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1caee334a40251f677778ef58980859?s=128&d=identicon&r=PG&f=1", "display_name": "amirkamizi", "link": "https://stackoverflow.com/users/9564000/amirkamizi"}, "edited": false, "score": 0, "creation_date": 1525269047, "post_id": 50127093, "comment_id": 87290669, "body": "I&#39;ve added all the code so you could see what i was trying to do. now that you said for noteletter[1], i think i should write something like   noteletter.append(note[1])    what do you think? now that you can see all the code do you think i can solve it? I would be grateful if you could help :)"}], "tags": [], "owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "is_accepted": false, "score": 3, "last_activity_date": 1525234546, "creation_date": 1525234546, "answer_id": 50127093, "question_id": 50126758, "link": "https://stackoverflow.com/questions/50126758/cs50-pset3-music-segmentation-fault/50127093#50127093", "title": "CS50 pset3 Music segmentation fault", "body": "<p>Two problems I can see (assuming <code>string</code> is a typedef of <code>char*</code>)</p>\n\n<p>if <code>noteletter</code> has a length of 0 (value <code>= \"\"</code>) then what do you think <code>noteletter[1]</code> is doing?</p>\n\n<p>Even if <code>noteletter</code> was set to something bigger (e.g. <code>noteletter = \"ABC\";</code>) - writing to a literal string is undefined behavior.</p>\n\n<p>Try <code>char noteletter[3] = { 0 };</code> to get something that (at a quick glance) looks big enough.</p>\n\n<p>Another possible issue: if <code>note</code> is <code>NULL</code> or invalid then <code>strlen(note)</code> is not safe.</p>\n"}, {"tags": [], "owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "is_accepted": true, "score": 0, "last_activity_date": 1525297920, "creation_date": 1525297920, "answer_id": 50144063, "question_id": 50126758, "link": "https://stackoverflow.com/questions/50126758/cs50-pset3-music-segmentation-fault/50144063#50144063", "title": "CS50 pset3 Music segmentation fault", "body": "<p><em>(Posted answer on behalf of the question author)</em></p>\n\n<p>My problem was that I defined noteletter as string. I changed that part to </p>\n\n<pre><code>char noteletter[4];\nint noteoctav;\nif (strlen(note) == 3)\n{\n    noteletter[0] = note[0];\n    noteletter[1] = note[1];\n    noteletter[2] = '\\0';\n    noteoctav = note[2] - '0';\n}\nif (strlen(note)== 2)\n{\n    noteletter[0] = note[0];\n    noteletter[1] = '\\0';\n    noteoctav = note[1] - '0';\n}\n</code></pre>\n\n<p>and now it works :)</p>\n"}], "owner": {"reputation": 102, "user_id": 9564000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1caee334a40251f677778ef58980859?s=128&d=identicon&r=PG&f=1", "display_name": "amirkamizi", "link": "https://stackoverflow.com/users/9564000/amirkamizi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 226, "favorite_count": 0, "accepted_answer_id": 50144063, "answer_count": 2, "score": -1, "last_activity_date": 1525297920, "creation_date": 1525232121, "last_edit_date": 1525297906, "question_id": 50126758, "link": "https://stackoverflow.com/questions/50126758/cs50-pset3-music-segmentation-fault", "title": "CS50 pset3 Music segmentation fault", "body": "<p>Today I finished the music project, or at least I think I've finished it. \nOn helper.c when I run make it makes both notes and synthesizer files and with no errors. But when I want to run ./notes it gives me segmentation fault error. Even when I ran the program with check50 it gave me this error:</p>\n\n<blockquote>\n  <p>failed to execute program due to segmentation fault</p>\n</blockquote>\n\n<p>I personally think it might be because of turning string to int or the way I got the notes from the string. First I introduced one string for taking the note and one int for taking the ovtav of the note.</p>\n\n<p>The string note is something like D4 or C#4 </p>\n\n<p>So I will just copy this part, to check with you if I've done it correctly.</p>\n\n<pre><code>string noteletter=\"\";\nint noteoctav;\nif (strlen(note) == 3)\n{\n    noteletter[0] = note[0];\n    noteletter[1] = note[1];\n    noteoctav = note[2] - '0';\n}\nif (strlen(note)== 2)\n{\n    noteletter[0] = note[0];\n    noteoctav = note[1] - '0';\n}\n</code></pre>\n\n<h2>Update</h2>\n\n<p>Here I've added the full code so you can see what I am trying to do.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 1, "creation_date": 1525232138, "post_id": 50126709, "comment_id": 87271449, "body": "<code>block [row][col+1];</code> this accesses outside the bounds of your array when col = size-1. Edit your post to define what you mean by <i>Then I need the array to shift left</i>. It&#39;s hard to understand what your intended output is. Also <a href=\"https://stackoverflow.com/questions/1694036/why-is-the-gets-function-so-dangerous-that-it-should-not-be-used\">don&#39;t call <code>gets</code>, use <code>fgets</code> instead</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9728277, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bjSqUfL8yg8/AAAAAAAAAAI/AAAAAAAAEow/_A-Lkr_m7XU/photo.jpg?sz=128", "display_name": "Kevin Kannammalil", "link": "https://stackoverflow.com/users/9728277/kevin-kannammalil"}, "edited": false, "score": 0, "creation_date": 1525263959, "post_id": 50129684, "comment_id": 87287100, "body": "Thank you soo much for the help. It&#39;s just that I have a supply teacher who has no prior knowledge to comp sci, and I have her for the whole sem. So I&#39;m self teaching this and I&#39;m pretty new. So I dont know much about pointers except the basics. But I&#39;m guessing *block [i] is the same as block [i][]. I&#39;m also a little confused at what size_t is and the if statement that checks if the last value of the string is a &#39;\\n&#39;. Also I need clarification on the mem functions, as I&#39;ve never used or heard any of these before."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 1, "user_id": 9728277, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bjSqUfL8yg8/AAAAAAAAAAI/AAAAAAAAEow/_A-Lkr_m7XU/photo.jpg?sz=128", "display_name": "Kevin Kannammalil", "link": "https://stackoverflow.com/users/9728277/kevin-kannammalil"}, "edited": false, "score": 0, "creation_date": 1525289219, "post_id": 50129684, "comment_id": 87302434, "body": "Yes you got it. <code>*block[i]</code> is the same as <code>*(block[i] + 0)</code> in pointer notation which is simply <code>block[i][0]</code> in indexed notation. Remember a pointer is just a normal variable that holds the <i>address of</i> something else as its value. <code>memset</code> simply sets every byte to the character specified for a block of memory <code>size</code> big. <code>memmove</code> is just like <code>strcpy</code> for memory that overlaps, there is also <code>memcpy</code>. Both do the same thing, but since memory isn&#39;t terminated by <code>&#39;\\0&#39;</code>, you have to specify the number of bytes to copy. So I just copy elements <code>1-size</code> to <code>0</code> and move <code>0</code> to <code>size-1</code>."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 1, "user_id": 9728277, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bjSqUfL8yg8/AAAAAAAAAAI/AAAAAAAAEow/_A-Lkr_m7XU/photo.jpg?sz=128", "display_name": "Kevin Kannammalil", "link": "https://stackoverflow.com/users/9728277/kevin-kannammalil"}, "edited": false, "score": 0, "creation_date": 1525289340, "post_id": 50129684, "comment_id": 87302514, "body": "You can replace the <code>memxxx</code> functions with simple loops if you like, but there is less chance of an unintended error using the library functions that have been exhaustively tested. Every function has a <code>man page</code>, so any you are unclear on, just open a terminal and type, e.g. <code>man memmove</code>. (they are cryptic at first, but they give every relevant detail for every function in the C-library -- so make friends with them...)"}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 1, "last_activity_date": 1525297798, "last_edit_date": 1525297798, "creation_date": 1525247890, "answer_id": 50129684, "question_id": 50126709, "link": "https://stackoverflow.com/questions/50126709/why-does-my-program-crash-when-i-run-it/50129684#50129684", "title": "Why does my program crash when I run it", "body": "<p>First, you need to learn to count, there are <code>58-characters</code> in your sentence, and second, you are making this much harder on yourself than it needs to be...</p>\n\n<p>If I understand your question, you want to:</p>\n\n<ol>\n<li>read a sentence entered by the user; </li>\n<li>determine the length;</li>\n<li>modify the sentence and replace all <code>spaces</code> with <code>'_'</code> (underscores);</li>\n<li>form a square array of minimum sufficient size to hold the characters in the sentence (e.g. 58-chars, requires 8x8 array);</li>\n<li>fill the square array with the modified sentence and fill all empty elements of the array after the last character of the sentence with underscores; and</li>\n<li>shift each row in the array left by 1-character moving the 1st character to the place previously occupied by the last.</li>\n</ol>\n\n<p>You have already included the necessary headers that provide <code>memset</code> <code>memcpy</code> and <code>memmove</code> -- which will greatly simplify your task.</p>\n\n<p>To begin, as is mentioned in the comments <strong>never, never, ever use <code>gets</code></strong>. It is so insecure and so prone to exploit by buffer overrun, it has been completely removed from the C11 standard library. Use <code>fgets</code> instead, e.g.:</p>\n\n<pre><code>#define MAXS 1024   /* if you need a constant - define one (or more) */\n...    \n    char sentence [MAXS] = \"\";\n    size_t i, len = 0, size;\n\n    fputs (\"Please enter a sentence to be encrypted:\\n\", stdout);\n    if (!fgets (sentence, MAXS, stdin)) {   /* read/validate sentence */\n        fputs (\"error: user canceled input or EOF\\n\", stderr);\n        return 1;\n    }\n</code></pre>\n\n<p>Next when using <code>fgets</code>, it will read up to (and including) the trailing newline (<code>'\\n'</code>) generated by the user pressing <kbd>Enter</kbd>. You need to remove the trailing <code>'\\n'</code> from your sentence. You can do this with a simple check of the character at <code>length - 1</code>. If it is a <code>'\\n'</code>, simply overwrite it with the <em>nul-character</em> (<code>'\\0'</code> or simply the equivalent - <code>0</code>). </p>\n\n<p>If the last character is not <code>'\\n'</code>, then you need to check if the length of the string (<code>-1</code>) is the maximum your string can hold. If you have stored the maximum number of characters, and the final character isn't <code>'\\n'</code> -- that indicates that the user entered more characters than your buffer can hold -- meaning that there are characters in <code>stdin</code> that remain unread -- handle accordingly, e.g.</p>\n\n<pre><code>    len = strlen (sentence);                /* get sentence length */\n    if (len &amp;&amp; sentence[len - 1] == '\\n')   /* is last char '\\n' ? */\n        sentence[--len] = 0;                /* overwrite with nul-char */\n    else if (len == MAXS - 1) {  /* otherwise - input exceeds MAXS chars */\n        fprintf (stderr, \"error: string exceeds %d chars.\\n\", MAXS);\n        return 1;\n    }\n</code></pre>\n\n<p>How would you determine the needed size of your square array from the number of characters (<code>len</code>) of your sentence? The square-root of the length (as an integer value) + 1 is pretty simple:</p>\n\n<pre><code>    size = (size_t)sqrt(len);   /* set size (trucation intentional) */\n    if (len % size)\n        size += 1;\n</code></pre>\n\n<p>You may as well complete the modifications to your sentence at this point, replacing all <code>spaces</code> with <code>'_'</code>, e.g.</p>\n\n<pre><code>    for (i = 0; i &lt; len; i++)       /* replace ' ' with '_' */\n        if (sentence[i] == ' ')\n            sentence[i] = '_';\n</code></pre>\n\n<p>Now all you need to do is declare <code>block</code> as a 2D VLA (if you don't have the VLA extension, you can declare a pointer-to-pointer-to-char and allocate <code>size</code> number of pointers and assign an allocated block of <code>size</code> chars to each pointer using <code>malloc</code>). Since your original code makes use of a VLA, we will go that route.</p>\n\n<p>After declaring your VLA, all you need to do to fill it with your modified sentence assuring all other unused elements are underscores is to <code>memset</code> the array to all <code>'_'</code> before you <code>memcpy</code> your modified sentence to the array, e.g.:</p>\n\n<pre><code>    char block[size][size];             /* declare VLA */\n    memset (block, '_', size * size);   /* set all to '_' */\n    memcpy (block, sentence, len);      /* copy sentence to block */\n</code></pre>\n\n<p>That's it. All that remains is shifting each row to the left by 1-character. This can be accomplished by simply saving the first character in each row in a temporary variable and then using <code>memmove</code> to shift each character in the row left by 1, and then set the last character in the row to the temp char you saved. (you should use <code>memmove</code> instead of <code>memcpy</code> because the source and destination memory overlaps), e.g.</p>\n\n<pre><code>    /* shift the array left */\n    for (i = 0; i &lt; size; i++) {\n        char tmp = *block[i];           /* save 1st char in row */\n        memmove (block[i], &amp;block[i][1], size - 1);  /* shift row left by 1 */\n        block[i][size - 1] = tmp;       /* put 1st char as last */\n    }\n</code></pre>\n\n<p>That is all you need to do to accomplish what you state in your question if I understood you correctly. Putting it altogether, you could do something similar to:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;math.h&gt;\n\n#define MAXS 1024   /* if you need a constant - define one (or more) */\n\nvoid printarray (int size, char block [size][size])\n{\n    int row, col;\n\n    for (row = 0; row &lt; size; row++) {\n        for (col = 0; col &lt; size; col++)\n            putchar (block[row][col]);      /* don't use printf to output */\n        putchar ('\\n');                     /* a single-character */\n    }\n}\n\nint main (void) {\n\n    /* sentence is: \n     * \"Patience is a minor form of despair disguised as a virtue.\"\n     */\n    char sentence [MAXS] = \"\";\n    size_t i, len = 0, size;\n\n    fputs (\"Please enter a sentence to be encrypted:\\n\", stdout);\n    if (!fgets (sentence, MAXS, stdin)) {   /* read/validate sentence */\n        fputs (\"error: user canceled input or EOF\\n\", stderr);\n        return 1;\n    }\n    len = strlen (sentence);                /* get sentence length */\n    if (len &amp;&amp; sentence[len - 1] == '\\n')   /* is last char '\\n' ? */\n        sentence[--len] = 0;                /* overwrite with nul-char */\n    else if (len == MAXS - 1) {  /* otherwise - input exceeds MAXS chars */\n        fprintf (stderr, \"error: string exceeds %d chars.\\n\", MAXS);\n        return 1;\n    }\n    printf (\"\\nsentence: '%s'\\n\\n\", sentence);  /* output sentence */\n\n    size = (size_t)sqrt(len);   /* set size (trucation intentional) */\n    if (len % size)\n        size += 1;\n    printf(\"The number of chars is %zu and the size is %zu\\n\\n\", len, size);\n\n    for (i = 0; i &lt; len; i++)       /* replace ' ' with '_' */\n        if (sentence[i] == ' ')\n            sentence[i] = '_';\n\n    char block[size][size];             /* declare VLA */\n    memset (block, '_', size * size);   /* set all to '_' */\n    memcpy (block, sentence, len);      /* copy sentence to block */\n\n    printf (\"block array:\\n\\n\");        /* output original block array */\n    printarray (size, block);\n\n    /* shift the array left */\n    for (i = 0; i &lt; size; i++) {\n        char tmp = *block[i];           /* save 1st char in row */\n        memmove (block[i], &amp;block[i][1], size - 1);  /* shift row left by 1 */\n        block[i][size - 1] = tmp;       /* put 1st char as last */\n    }\n\n    printf (\"\\n\\nshifted block array:\\n\\n\");\n    printarray (size, block);\n\n    return 0;\n}\n</code></pre>\n\n<p>(<strong>note:</strong> if you are using windoze, replace all <code>%zu</code> <em>format specifiers</em> with <code>%lu</code> as windows does not provide the <code>z</code> modifier for <code>size_t</code>)</p>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/array_block_shift\nPlease enter a sentence to be encrypted:\nPatience is a minor form of despair disguised as a virtue.\n\nsentence: 'Patience is a minor form of despair disguised as a virtue.'\n\nThe number of chars is 58 and the size is 8\n\nblock array:\n\nPatience\n_is_a_mi\nnor_form\n_of_desp\nair_disg\nuised_as\n_a_virtu\ne.______\n\n\nshifted block array:\n\natienceP\nis_a_mi_\nor_formn\nof_desp_\nir_disga\nised_asu\na_virtu_\n.______e\n</code></pre>\n\n<hr>\n\n<p><strong><code>memxxx</code> Function Equivalents</strong></p>\n\n<p>Given your comments and questions regarding the <code>memxxx</code> functions, and the fact you are self-teaching, you may benefit from stepping through this equivalent re-write of the code using only simple loops instead of <code>memset</code>, <code>memcpy</code> and <code>memmove</code>. Though you are always better off using a tried and true library function, there is great learning value in peeling back the covers and looking at what they do inside.</p>\n\n<p>One note. <code>memcpy</code> and <code>memmove</code> do effectively the same thing, but <code>memcpy</code> is only defined where the <code>source</code> and <code>destination</code> of the copy do not overlap. <code>memmove</code> is safe for regions that do overlap. So in your case where we copy elements <code>1, 2, 3 ... 8</code> left by one to <code>0, 1, 2 ... 7</code> use of <code>memmove</code> was required because the regions overlap.</p>\n\n<p><strong>Advice -- Always Compile with Warnings Enabled -- Use the <code>man pages</code></strong></p>\n\n<p>Also, one final note before the example, always compile with <em>warnings enabled</em>, and do not accept code until it compiles without warning. The minimum warnings you should use are <code>-Wall -Wextra</code> (and you should also add <code>-pedantic</code> for a few additional warnings). I would also recommend <code>-Wshadow</code> to catch any unintentional shadowed variables that may cause problems.</p>\n\n<p>You should compile with these options as part of you compile string every time you compile. If you are on windows using VS (<code>cl.exe</code>), then at minimum use <code>/W3</code> (you can disable specific warnings on windows with <code>/wdXXXX</code> where <code>XXXX</code> is the warning code you wish to disable)</p>\n\n<p>Read and understand each warning. Yes, take the time to read and understand each one. The provide a concise description of the problem and provide the line number on which the problem occurs. Go address each one. You can learn just as much C just by listening to what the compiler is telling you as you can from most tutorials. </p>\n\n<p>(gcc/clang warnings are far superior to those provided by VS, and with VS if you enable <code>/Wall</code> you will get a number of general compiler related warnings that are non-code specific warnings, which with a 1/2 dozen <code>/wdxxxx</code> can be reduced to just what is relevant to your code)</p>\n\n<p>As mentioned in the comments below, if you are on Linux/Unix, the <code>man pages</code> give detailed usage information on every C-library function. Use them. Just open a terminal and, type e.g <code>man memmove</code> to learn about the <code>memmove</code> function. When you are learning (and even after you think you have learned a function) always consult <code>man functionname</code> if you have any question about how it is used or the proper parameters it takes and <strong>most importantly</strong> what values it returns on <strong>success</strong> and what values it returns to indicate <strong>failure</strong> (and whether additional information is set in <code>errno</code> which can be retrieved with <code>perror()</code> -- print error). If you just incorporate these basic tools that are available for you to use, you will reduce the frustration for learning 10-fold, and will be light-years ahead of your classmates in no time...</p>\n\n<p>On to the example, that does exactly what the code above does, but eliminating all reliance on <code>memxxx</code> (which will let you see why they can simplify your life)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n#define MAXS 1024   /* if you need a constant - define one (or more) */\n\nvoid printarray (int size, char block [size][size])\n{\n    int row, col;\n\n    for (row = 0; row &lt; size; row++) {\n        for (col = 0; col &lt; size; col++)\n            putchar (block[row][col]);      /* don't use printf to output */\n        putchar ('\\n');                     /* a single-character */\n    }\n}\n\nint main (void) {\n\n    /* sentence is:\n     * \"Patience is a minor form of despair disguised as a virtue.\"\n     */\n    char sentence [MAXS] = \"\";\n    size_t i, j, len = 0, size;\n\n    fputs (\"Please enter a sentence to be encrypted:\\n\", stdout);\n    if (!fgets (sentence, MAXS, stdin)) {   /* read/validate sentence */\n        fputs (\"error: user canceled input or EOF\\n\", stderr);\n        return 1;\n    }\n    len = strlen (sentence);                /* get sentence length */\n    if (len &amp;&amp; sentence[len - 1] == '\\n')   /* is last char '\\n' ? */\n        sentence[--len] = 0;                /* overwrite with nul-char */\n    else if (len == MAXS - 1) {  /* otherwise - input exceeds MAXS chars */\n        fprintf (stderr, \"error: string exceeds %d chars.\\n\", MAXS);\n        return 1;\n    }\n    printf (\"\\nsentence: '%s'\\n\\n\", sentence);  /* output sentence */\n\n    if (len &lt; 4) {\n        fputs (\"error: sentence less than 4 chars - too short.\\n\", stderr);\n        return 1;\n    }\n    for (size = 2; size * size &lt; len; size++) {}    /* set size */\n    printf(\"The number of chars is %zu and the size is %zu\\n\\n\", len, size);\n\n    for (i = 0; i &lt; len; i++)           /* replace ' ' with '_' */\n        if (sentence[i] == ' ')\n            sentence[i] = '_';\n\n    char block[size][size];             /* declare VLA */\n    for (i = 0; i &lt; size; i++)          /* initialize all element '_' */\n        for (j = 0; j &lt; size; j++)      /* (memset (block, '_', size) */\n            block[i][j] = '_';\n\n    size_t n = 0;\n    for (i = 0; i &lt; size; i++)          /* copy sentence to block */\n        for (j = 0; j &lt; size; j++)      /* (memcpy (block, sentence, len) */\n            if (n &lt; len)\n                block[i][j] = sentence[n++];\n            else\n                break;\n\n    printf (\"block array:\\n\\n\");        /* output original block array */\n    printarray (size, block);\n\n    /* shift the array left (memmove (block[i], &amp;block[i][1], size - 1)) */\n    for (i = 0; i &lt; size; i++) {\n        char tmp = block[i][0];         /* save 1st char in row */\n        for (j = 1; j &lt; size; j++)\n            block[i][j-1] = block[i][j];\n        block[i][size - 1] = tmp;       /* put 1st char as last */\n    }\n\n    printf (\"\\n\\nshifted block array:\\n\\n\");\n    printarray (size, block);\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>note:</strong> to more closely model what <code>memcpy (block, sentence, len)</code> actually does, you could use:</p>\n\n<pre><code>for (i = 0; i &lt; len; i++)           /* copy sentence to block */\n    (*block)[i] = sentence[i];      /* (memcpy (block, sentence, len) */\n</code></pre>\n\n<p>but note, this would only apply to 2D arrays where <code>len</code> is guaranteed to be less than <code>size * size</code>. Further, it would not apply to <code>char **</code> where you allocate for <code>size</code> pointers of <code>size</code> characters each. Why? Only an <em>array</em> guarantees that all elements will be sequential in memory. There is no such guarantee when using a collection of pointers and independently allocated blocks of memory to simulate a 2D array.</p>\n\n<p>The use/output is exactly the same.</p>\n\n<p>Look things over and let me know if I misunderstood your goals, or if you have further questions.</p>\n"}], "owner": {"reputation": 1, "user_id": 9728277, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bjSqUfL8yg8/AAAAAAAAAAI/AAAAAAAAEow/_A-Lkr_m7XU/photo.jpg?sz=128", "display_name": "Kevin Kannammalil", "link": "https://stackoverflow.com/users/9728277/kevin-kannammalil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1525297798, "creation_date": 1525231646, "question_id": 50126709, "link": "https://stackoverflow.com/questions/50126709/why-does-my-program-crash-when-i-run-it", "title": "Why does my program crash when I run it", "body": "<p>I have to make a program that enters a sentence to be encrypted by shifting the sentence. I have to first transfer the sentence to a 2D array, whose size must be a perfect square which maximizes the spaces needed. (For example if the number of characters in the sentence is 54, the size of the array would be 8 instead of 7, since it fits the whole sentence). The spaces and empty values in the sentence should be replaced by an underscore. Then I need the array to shift left, but it crashes.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;math.h&gt;\n\n\nvoid printArray (int size, char block [size][size])\n{\n    int row, col;\n    for (row = 0; row &lt; size; row++)\n{\n    printf(\"\\n\");\n    for (col = 0; col &lt; size; col++)\n    {\n        printf(\"%c\", block[row][col]);\n    }\n}\n}\n\nint main ()\n{\n// Sentence is \"Patience is a minor form of despair disguised as a virtue.\"\n\nchar sentence [1000];\nprintf(\"Please enter a sentence to be encrypted: \");\ngets (sentence);\n\nint numOfChar = strlen(sentence);\nint size = 1;\nwhile (size &lt;= (numOfChar/size))\n{\n    size++;\n}\nprintf(\"\\nThe number of chars is %d and the size is %d\", numOfChar, size);\n\n\nint n = (size * size) - numOfChar;                      // fills the             \nempty values with \"_\"'s\nchar fillBlank [n];\nint i;\nfor (i = 0; i &lt; n; i++)\n{\n    fillBlank[i]  = '_';\n}\nstrcat(sentence, fillBlank);\n\n// ------------------------------------------------ Makes the array ------------------------------------------- //\n\nchar block [size][size];\nint row;\nint col;\nint counter = 0;\n\nwhile (counter &lt; (size * size))\n{\n    for (row = 0; row &lt; size; row++)\n    {\n        for (col = 0; col &lt; size; col++)\n        {\n            if (sentence [counter] == ' ')\n                block [row][col] = '_';\n            else if (sentence[counter] == '\\0')\n                block [row][col] = '_';\n            else\n                block [row][col] = sentence [counter];\n            counter++;\n        }\n    }\n}\n\n// ------------------------------------------- Prints the array --------------------------------------------- //\n\nprintArray(size, block [size][size]);\n/*\nfor (row = 0; row &lt; size; row++)\n{\n    printf(\"\\n\");\n    for (col = 0; col &lt; size; col++)\n    {\n        printf(\"%c\", block[row][col]);\n    }\n}\n*/\n    // ------------------------------------------- Shifts the array left --------------------------------------- //\n\nprintf(\"\\n\\n\\n\");\nchar temp [size];\ncol = 0;\nfor (row = 0; row &lt; size; row++)\n{\n    temp [row] = block [row][col];\n}\n\nfor (row = 0; row &lt; size; row++)\n{\n    for (col = 0; col &lt; size; col++)\n    {\n        block [row][col] = block [row][col+1];\n    }\n}\n\ncol = 7;\nfor (row = 0; row &lt; size; row++)\n{\n    block [row][col] = temp [row];\n}\n\nprintArray(size, block [size][size]);\n/*\nfor (row = 0; row &lt; size; row++)\n{\n    printf(\"\\n\");\n    for (col = 0; col &lt; size; col++)\n    {\n        printf(\"%c\", block[row][col]);\n    }\n}\n*/\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c", "memory", "c-strings"], "comments": [{"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 3, "creation_date": 1525227964, "post_id": 50126309, "comment_id": 87270641, "body": "The short answer: it doesn&#39;t. It&#39;s up to you, the lowly programmer, to know how long your arrays are, and write your code appropriately. If you don&#39;t, your program will explode in a thunderous fireball, crashing and burning until only dust is left."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1525228061, "post_id": 50126309, "comment_id": 87270665, "body": "The first element doesn&#39;t know anything about it neighbors. If you are dealing with a <i>nul-termianted</i> string, then the code simply scans forward over each character until <code>&#39;\\0&#39;</code> is encountered. (which must be within your array/memory bounds) If it is an array of chars (not a string), then YOU are responsible for knowing how many characters fit within YOUR array bounds. (no tricks...)"}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 9728148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e858c2b200c3ac3de010fe40b79e65ba?s=128&d=identicon&r=PG&f=1", "display_name": "chaotic", "link": "https://stackoverflow.com/users/9728148/chaotic"}, "edited": false, "score": 0, "creation_date": 1525228222, "post_id": 50126332, "comment_id": 87270693, "body": "It&#39;s really hard adapating to the fact you NEED to know the index count of your arrays for pretty much any kind of string, coming from an language like C#, but thanks. This cleared it up."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1525228724, "post_id": 50126332, "comment_id": 87270812, "body": "There are tools (some of them are builtin to the compiler these days) that can check array bounds for you, but the C or C++ language standards do not specify a check is required, only that it is undefined to go (too far) beyond the bounds."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 55, "user_id": 9728148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e858c2b200c3ac3de010fe40b79e65ba?s=128&d=identicon&r=PG&f=1", "display_name": "chaotic", "link": "https://stackoverflow.com/users/9728148/chaotic"}, "edited": false, "score": 0, "creation_date": 1525235029, "post_id": 50126332, "comment_id": 87272057, "body": "@chaotic If instead of raw arrays you use std vector, length is stored at compile time.  If you use std array, you get checked indexing with at.  You can get types that can check, but also tyoes that do not."}], "tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": false, "score": 1, "last_activity_date": 1525228079, "creation_date": 1525228079, "answer_id": 50126332, "question_id": 50126309, "link": "https://stackoverflow.com/questions/50126309/how-do-memory-addresses-know-how-long-an-an-array-is/50126332#50126332", "title": "How do memory addresses know how long an an array is?", "body": "<p>It doesn't.</p>\n\n<p>Use a too-large value as an index and you read from/write to memory outside of the array.</p>\n\n<p>Do it in C++ and the optimizer may cache data and not refresh it and get insane program states (UB).</p>\n\n<p>Now, copy an array in a struct via <code>=</code>?  Size is then known at compile time, similarly no runtime markers used.</p>\n"}, {"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 3, "creation_date": 1525228306, "post_id": 50126344, "comment_id": 87270716, "body": "Legally, you can only access 1-past the end (though you cannot dereference that address), anything beyond invokes <i>Undefined Behavior</i>."}], "tags": [], "owner": {"reputation": 245, "user_id": 4821675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b5ad8d45779eb390bf7c22c9e2d0347?s=128&d=identicon&r=PG&f=1", "display_name": "minterm", "link": "https://stackoverflow.com/users/4821675/minterm"}, "is_accepted": false, "score": 1, "last_activity_date": 1525228214, "creation_date": 1525228214, "answer_id": 50126344, "question_id": 50126309, "link": "https://stackoverflow.com/questions/50126309/how-do-memory-addresses-know-how-long-an-an-array-is/50126344#50126344", "title": "How do memory addresses know how long an an array is?", "body": "<p>In those low-level languages, you can access an array even past what is allocated. You have to manually keep track of how long the array is. However, there are different data types, like linked lists, that can be built to keep track of the beginning and end of the data. For example, in Python, there are \"lists\" instead of \"arrays\", and the size of the list can be found out using the \"len\" built-in function.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 5087715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9467ca9f3048633923777895e2a620d0?s=128&d=identicon&r=PG&f=1", "display_name": "Cody Barrett", "link": "https://stackoverflow.com/users/5087715/cody-barrett"}, "is_accepted": false, "score": 1, "last_activity_date": 1525228652, "creation_date": 1525228652, "answer_id": 50126393, "question_id": 50126309, "link": "https://stackoverflow.com/questions/50126309/how-do-memory-addresses-know-how-long-an-an-array-is/50126393#50126393", "title": "How do memory addresses know how long an an array is?", "body": "<p>To answer your question, memory addresses do not \"know\" how long an array is. It all depends on your computer architecture and is discovered through CPU instructions. When you access the first element of the array, an instruction is decoded by your CPU and will proceed to grab the first byte of data in the given memory address. This first byte of data should contain an ascii value that pertains to a specific char element and will display your desired character. If you iterate through the string and implemented it correctly, there typically is a null character to which you can end your iteration. However, do note that the null character is not guaranteed to be there. </p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "is_accepted": false, "score": 1, "last_activity_date": 1525235850, "last_edit_date": 1525235850, "creation_date": 1525235432, "answer_id": 50127192, "question_id": 50126309, "link": "https://stackoverflow.com/questions/50126309/how-do-memory-addresses-know-how-long-an-an-array-is/50127192#50127192", "title": "How do memory addresses know how long an an array is?", "body": "<blockquote>\n  <p>I understand that if you store a string (or in C, better known as a\n  char array) it's actually just an address in memory of the first\n  element of that array.</p>\n</blockquote>\n\n<p>A [narrow] string literal has type <code>char[C]</code> where <code>C == 1+strlen(s)</code> (the 1 is for the <code>'\\0'</code> at the end, which the <code>strlen</code> function excludes from its return value).</p>\n\n<p>If you store a string literal in a variable of type <code>char*</code>, then it's indeed as you say: just an address in memory of the first element of that array.  That is how \"array decay\" works.</p>\n\n<p>If, however, you store a string literal in a variable of type <code>char[N]</code>, then how things work depends on <code>N</code> and <code>1+strlen(S)</code> (where <code>S</code> would be a string literal).  If <code>N &lt; 1+strlen(S)</code>, then only the first <code>N</code> chars are stored in the <code>char</code> array, and the array is not terminated by <code>'\\0'</code>.  If <code>N &gt;= 1+strlen(S)</code>, then all chars of <code>S</code> are stored in the <code>char</code> array, and any elements in excess of <code>1+strlen(S)</code> are zero-initialized per usual for arrays.</p>\n\n<blockquote>\n  <p>How does this first element of the array know how much it has to count\n  for the whole array, my own guess is it stops at the first occurrence\n  of <code>\\0</code> but am I right? I've ben told <code>\\0</code> is a sign that the array\n  has finished that you've hit the last element (or technically, 1 after\n  the last element).</p>\n</blockquote>\n\n<p>The first element doesn't store the count of the array unless you make it that way.  In the case of storing a string literal or any other <code>char</code> array in an object of type <code>char*</code>, you're discarding the size info, unless you stored the size in the first element manually (strings in the Pascal programming language do this).  Whether or not you stored the size, you're still responsible for tracking the size info.  If you initialize an object of type <code>char[N]</code> with a string literal, you keep the size info of the array, and the compiler tracks all <code>N</code> chars for the lifetime of the array.</p>\n"}], "owner": {"reputation": 55, "user_id": 9728148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e858c2b200c3ac3de010fe40b79e65ba?s=128&d=identicon&r=PG&f=1", "display_name": "chaotic", "link": "https://stackoverflow.com/users/9728148/chaotic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1525235850, "creation_date": 1525227826, "last_edit_date": 1525228411, "question_id": 50126309, "link": "https://stackoverflow.com/questions/50126309/how-do-memory-addresses-know-how-long-an-an-array-is", "title": "How do memory addresses know how long an an array is?", "body": "<p>I guess I can tag C++, Assembly and C as memory management works similarly in all languages.</p>\n\n<p>I've just hit the stage in C where I'm learning pointers. I understand that if you store a string (or in C, better known as a char array) it's actually just an address in memory of the first element of that array.</p>\n\n<p>How does this first element of the array know how much it has to count for the whole array, my own guess is it stops at the first occurrence of <code>\\0</code> but am I right? I've ben told <code>\\0</code> is a sign that the array has finished that you've hit the last element (or technically, 1 after the last element).</p>\n\n<p>I guess I posted this for validation of my maybe-right-answer. Can anyone explain it in better detail?</p>\n"}, {"tags": ["c", "eof"], "comments": [{"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 4, "creation_date": 1525226453, "post_id": 50126175, "comment_id": 87270328, "body": "The first thing to do will be to read the documentation of <code>read()</code>..."}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1525227348, "post_id": 50126175, "comment_id": 87270493, "body": "I bet the call to read crashes when it tries to write into the buffer that you gave it as the second parameter"}], "answers": [{"tags": [], "owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "is_accepted": true, "score": 1, "last_activity_date": 1525227354, "creation_date": 1525227354, "answer_id": 50126267, "question_id": 50126175, "link": "https://stackoverflow.com/questions/50126175/using-read-to-read-one-char-at-a-time-from-a-file/50126267#50126267", "title": "using read() to read one char at a time from a file", "body": "<p><code>read</code> does not return <code>EOF</code> if there is no more input. <code>read</code> normally returns the number of bytes read. Since you are intending to read only one byte, you expect <code>read</code> to return <code>1</code>. When it returns <code>0</code>, it means it has reached the end. If it returns <code>-1</code>, it means it encountered an error, and you should check <code>errno</code> for more information.</p>\n\n<p>Your program has other issues. Your use of <code>int *c</code> is completely wrong. Since <code>data</code> is already defined, you can use that to read the file, even if you only intend to use only the first byte of the buffer. You should check to see if input was actually obtained before attempting to print it.</p>\n\n<pre><code>char data[1024];\nint infile = open(inFileName, O_RDONLY);\nif(infile &lt; 0 ) {\n    perror(inFileName);\n    return 1;\n}\n\nint i = 0;\nfor(i =0; i&lt;30;++i){\n   int r = read(infile, data, 1);\n   if(r &lt;= 0){\n       if (r &lt; 0) perror(\"read\");\n       break;\n     }\n   printf(\"%c\\n\", data[0]);\n}\n</code></pre>\n"}], "owner": {"reputation": 294, "user_id": 4208237, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c755a1cc552ed94f2e6ef77bfdb64baf?s=128&d=identicon&r=PG&f=1", "display_name": "code kid", "link": "https://stackoverflow.com/users/4208237/code-kid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 347, "favorite_count": 0, "accepted_answer_id": 50126267, "answer_count": 1, "score": 1, "last_activity_date": 1525227354, "creation_date": 1525226359, "question_id": 50126175, "link": "https://stackoverflow.com/questions/50126175/using-read-to-read-one-char-at-a-time-from-a-file", "title": "using read() to read one char at a time from a file", "body": "<p>I would like to be able to read from a file one character at a time using read. I cannot use fgetc. I tried looking for EOF and I can't get it to work. Thanks for your help. </p>\n\n<pre><code>char data[1024];\nint infile = open(inFileName, O_RDONLY);\nif(infile &lt; 0 ) return 1;\n\nint *c = '\\0';\nint i = 0;\nfor(i =0; i&lt;30;++i){\n   read(infile, &amp;c, 1);\n   printf(\"%c\\n\", c);\n   if(c == EOF){\n       break;\n     }\n}\n</code></pre>\n"}, {"tags": ["c", "math", "codeblocks", "math.h"], "comments": [{"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1525226169, "post_id": 50126133, "comment_id": 87270262, "body": "I don&#39;t know this method of finding cubic roots, but most likely you are just looking at rounding error due to the <code>double</code> type, which, like <code>float</code>, is not exact.  <a href=\"https://stackoverflow.com/questions/4008395/rounding-problem-with-double-type\">See here</a> for more information."}], "answers": [{"tags": [], "owner": {"reputation": 38619, "user_id": 33252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d0b55a5e4a7eff1bf29eae5bd314f0d?s=128&d=identicon&r=PG", "display_name": "Doug Currie", "link": "https://stackoverflow.com/users/33252/doug-currie"}, "is_accepted": true, "score": 3, "last_activity_date": 1525227662, "creation_date": 1525227662, "answer_id": 50126294, "question_id": 50126133, "link": "https://stackoverflow.com/questions/50126133/double-automatic-rounding/50126294#50126294", "title": "Double automatic rounding", "body": "<p>Change the use of <code>abs</code> to <code>fabs</code> and the result is:</p>\n\n<pre><code>As ra\u00edzes s\u00e3o: &lt;-1.650629&gt;, &lt;-0.174685 + 1.546869i&gt;, &lt;-0.174685 - 1.546869i&gt;\n</code></pre>\n\n<p>The function <code>abs</code> returns an integer, whereas <code>fabs</code> works on doubles.</p>\n"}], "owner": {"reputation": 109, "user_id": 7892270, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2b5215acc873a1b800e39dbec4dfb295?s=128&d=identicon&r=PG&f=1", "display_name": "Murilo Pereira", "link": "https://stackoverflow.com/users/7892270/murilo-pereira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 50126294, "answer_count": 1, "score": 1, "last_activity_date": 1525227943, "creation_date": 1525225986, "question_id": 50126133, "link": "https://stackoverflow.com/questions/50126133/double-automatic-rounding", "title": "Double automatic rounding", "body": "<p>I'm developing a program that calculates the roots of a cubic equation with Tartaglia's method. The problem is when I print the value of the imaginary part, the program rounds the value of 1.54686889 to 1.50.</p>\n\n<p>I have tried to use float instead of double, but, without success.\nI'm using Code::Blocks 17.12</p>\n\n<p><strong>My code:</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n#include &lt;locale.h&gt;\n\n#define PI 3.14159265359\n\nint main(void)\n{\n    setlocale(LC_ALL,\"\");\n\n    double a, b, c, d, p, q, r, t, u, u3, v, v3, A, B, C, D, M, x1, x2, x2i, x3, x3i;\n\n    printf(\"Insira os coeficientes (a b c d): \");\n    scanf(\"%lf %lf %lf %lf\", &amp;a, &amp;b, &amp;c, &amp;d);\n\n    //Verifica se o coeficiente a \u00e9 v\u00e1lido\n    if(a != 0){\n        printf(\"\\nForma geral:\\n\");\n        printf(\"\\n (%.2lf)x\u00b3 + (%.2lf)x\u00b2 + (%.2lf)x + (%.2lf) = 0 \\n\", a, b, c, d);\n        A = b/a;\n        B = c/a;\n        C = d/a;\n\n        p = B - (pow(A, 2.0)/3.0);\n        q = C - ((A*B)/3.0) + (2.0*pow(A, 3.0))/27.0;\n        D = (pow(q, 2.0)/4.0) + (pow(p, 3.0)/27.0);\n\n        if(D &lt; 0){\n            M = pow(-1.0*D, 1.0/2.0);\n            r = sqrt(pow(q, 2.0)/4.0 + pow(M, 2.0));\n            t = acos(-1.0*q/2.0/r);\n\n            x1 = 2.0 * pow(r, 1.0/3.0) * cos(t/3.0) - A/3.0;\n            x2 = 2.0 * pow(r, 1.0/3.0) * cos((t + 2.0 * PI)/3.0) - A/3.0;\n            x3 = 2.0 * pow(r, 1.0/3.0) * cos((t + 4.0 * PI)/3.0) - A/3.0;\n\n            printf(\"\\nAs ra\u00edzes s\u00e3o: &lt;%lf&gt; &lt;%lf&gt; &lt;%lf&gt;\\n\", x1, x2, x3);\n        }\n        else{\n            u3 = (-1.0*q/2.0) + pow(D, 1.0/2.0);\n            if(u3 &lt; 0)\n                u = -1.0 * pow(-1.0*u3, 1.0/3.0);\n            else\n                u = pow(u3, 1.0/3.0);\n\n            v3 = (-1.0*q/2.0) - pow(D, 1.0/2.0);\n            if(v3 &lt; 0)\n                v = -1.0 * pow(-1.0*v3, 1.0/3.0);\n            else\n                v = pow(v3, 1.0/3.0);\n\n            x1 = u + v - A/3.0;\n\n            D = pow((A + x1), 2.0) + (4.0*C/x1);\n\n            x2 = -1.0 * (A + x1)/2.0;\n            x2i = pow(abs(D), 1.0/2.0)/2.0;\n\n            x3 = x2;\n            x3i = x2i;\n\n            if(D &lt; 0){\n                printf(\"\\nAs ra\u00edzes s\u00e3o: &lt;%lf&gt;, &lt;%lf + %lfi&gt;, &lt;%lf - %lfi&gt;\\n\", x1, x2, x2i, x3, x3i);\n            }\n            else{\n                x2 = x2 + x2i;\n                x3 = x3 - x3i;\n\n                printf(\"\\nAs ra\u00edzes s\u00e3o: &lt;%lf&gt;, &lt;%lf&gt;, &lt;%lf&gt;\\n\", x1, x2, x3);\n            }\n        }\n    }\n    else{\n        printf(\"O coeficiente &lt;a&gt; n\u00e3o pode ser igual a 0!\\n\");\n    }\n    printf(\"Fonte de pesquisa: http://www.matematicando.net.br/metodo-de-tartaglia-para-obter-raizes-de-equacao-do-3o-grau/\\n\");\n    system(\"pause\");\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>The console after printing:</strong>\n<a href=\"https://i.stack.imgur.com/JdhzA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JdhzA.png\" alt=\"The console after printing:\"></a></p>\n"}, {"tags": ["c", "arguments", "getopt", "argp"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1525225657, "post_id": 50125760, "comment_id": 87270168, "body": "The difficulty with parsing (and passing) unknown options on to FUSE is that you don&#39;t know whether the options take arguments or not, so you don&#39;t know how to continue parsing accurately.  There could also be problems with bunched options (<code>ls -ltr</code> has a bunched set of options in the <code>-ltr</code>; it could also be written <code>ls -l -t -r</code> and would have the same effect).  A lot depends on the rules that are already in effect."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "is_accepted": true, "score": 1, "last_activity_date": 1525224578, "creation_date": 1525224578, "answer_id": 50125982, "question_id": 50125760, "link": "https://stackoverflow.com/questions/50125760/c-how-to-allow-unrecognized-options-in-argp-or-getopt/50125982#50125982", "title": "C - how to allow unrecognized options in Argp or Getopt?", "body": "<p><strong>Argp</strong></p>\n\n<p>From <a href=\"https://www.gnu.org/software/libc/manual/html_node/Argp-Flags.html#Argp-Flags\" rel=\"nofollow noreferrer\">the \"Argp Flags\" section of the documentation</a>:</p>\n\n<blockquote>\n  <p><code>ARGP_NO_ERRS</code></p>\n  \n  <p><strong>Don't print error messages for unknown options to stderr</strong>; unless this\n  flag is set, <code>ARGP_PARSE_ARGV0</code> is ignored, as <code>argv[0]</code> is used as the\n  program name in the error messages. This flag implies <code>ARGP_NO_EXIT</code>.\n  This is based on the assumption that silent exiting upon errors is bad\n  behavior.</p>\n</blockquote>\n\n<p><strong>Getopt</strong></p>\n\n<p>For <code>getopt</code> (as well as <code>getopt_long</code> and <code>getopt_long_only</code>), you simply set the global variable <code>opterr</code> to 0 before calling the function.  Alternatively, you can use a short option string with a leading <code>:</code> character as in <code>\":o:v\"</code> to handle <code>-o output-file</code> and <code>-v</code> (<code>:</code> will be returned if <code>-o</code> is missing its argument and <code>?</code> if any option that does not exist in your option string is found).</p>\n"}], "owner": {"reputation": 4264, "user_id": 2111737, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3cbb6d8cbe739789803ace7db751e3ef?s=128&d=identicon&r=PG", "display_name": "Lapsio", "link": "https://stackoverflow.com/users/2111737/lapsio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 413, "favorite_count": 0, "accepted_answer_id": 50125982, "answer_count": 1, "score": 0, "last_activity_date": 1525224578, "creation_date": 1525222474, "question_id": 50125760, "link": "https://stackoverflow.com/questions/50125760/c-how-to-allow-unrecognized-options-in-argp-or-getopt", "title": "C - how to allow unrecognized options in Argp or Getopt?", "body": "<p>I'm writing FUSE filesystem which uses some arguments. I'd like to pass all unrecognized options to FUSE (because it has its own options). Can I do that using <code>argp</code> or <code>getopt</code>? For now both give me \"Unknown option\" error.</p>\n"}, {"tags": ["c", "linux-kernel", "linux-device-driver"], "answers": [{"tags": [], "owner": {"reputation": 3598, "user_id": 4822941, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/06bJl.jpg?s=128&g=1", "display_name": "employee of the month", "link": "https://stackoverflow.com/users/4822941/employee-of-the-month"}, "is_accepted": false, "score": 0, "last_activity_date": 1525255392, "creation_date": 1525255392, "answer_id": 50131941, "question_id": 50125698, "link": "https://stackoverflow.com/questions/50125698/getting-sys-call-table-in-linux-kernel-4-15-on-64-bit/50131941#50131941", "title": "getting sys call table in linux kernel 4.15 on 64 bit", "body": "<p>This is not a \"certain address\". close syscall number is 3, thus the very first address you are testing is START_ADDRESS + 3 * sizeof(void *) and it equals precisely to the faulting address.</p>\n\n<p>This then suggests that the params you used here are wrong to begin with.</p>\n\n<p>The real question is why are you looking for a system call table, let alone in this manner. In vast majority of cases you <em>don't</em> want to overwrite any syscall entries.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 10871119, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/4d1b5e633dbf9172b27f136389914fca?s=128&d=identicon&r=PG", "display_name": "user10871119", "link": "https://stackoverflow.com/users/10871119/user10871119"}, "is_accepted": false, "score": 1, "last_activity_date": 1546684145, "last_edit_date": 1546684145, "creation_date": 1546683439, "answer_id": 54050991, "question_id": 50125698, "link": "https://stackoverflow.com/questions/50125698/getting-sys-call-table-in-linux-kernel-4-15-on-64-bit/54050991#54050991", "title": "getting sys call table in linux kernel 4.15 on 64 bit", "body": "<p>Just use the kernel function <code>kallsyms_lookup_name(\"sys_call_table\")</code> in <code>\"linux/kallsyms.h\"</code>. That will return the address of the system call table as found in the <code>/proc/kallsyms</code> file. Don't worry if the address found in </p>\n\n<pre><code>/boot/System.map-`uname -r`\n</code></pre>\n\n<p>is different; you still found the <code>sys_call_table</code>.</p>\n"}], "owner": {"reputation": 51, "user_id": 9727890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57cc2e6a88c29a42e99156f7b68b0248?s=128&d=identicon&r=PG&f=1", "display_name": "jordy90", "link": "https://stackoverflow.com/users/9727890/jordy90"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 848, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1562679761, "creation_date": 1525221850, "question_id": 50125698, "link": "https://stackoverflow.com/questions/50125698/getting-sys-call-table-in-linux-kernel-4-15-on-64-bit", "title": "getting sys call table in linux kernel 4.15 on 64 bit", "body": "<p>So I have been trying to get the sys call table by brute forcing and the module keeps bringing up an error at a certain address \"ffffffff81000018\". The following is the code I have used:</p>\n\n<pre><code>#include&lt;linux/kernel.h&gt;\n#include&lt;linux/module.h&gt;\n#include&lt;linux/dirent.h&gt;\n#include&lt;linux/syscalls.h&gt;\n#include&lt;linux/sysfs.h&gt;\n#include&lt;linux/list.h&gt;\n#include&lt;linux/proc_fs.h&gt;\n#include&lt;linux/string.h&gt;\n#include&lt;linux/uaccess.h&gt;\n#include&lt;linux/fs.h&gt;\n#include&lt;linux/unistd.h&gt;\n#include&lt;linux/cred.h&gt;\n\n\n#if defined __x86_64__\n    #define START_ADDRESS 0xffffffff81000000\n    #define END_ADDRESS 0xffffffffa2000000\n#endif\n\nMODULE_LICENSE(\"GPL\");\n\nvoid **syscall_table;\n\nvoid **find_syscall_table(void)\n{\n\n    void **sctable;\n    void *i = (void *) START_ADDRESS;\n\n    while ( i &lt; (void *) END_ADDRESS )\n    {\n        sctable = (void *)i;\n\n        if (sctable[__NR_close] == (void *)sys_close)\n        {\n            return sctable;\n        }\n\n        i += sizeof(void *);\n    }\n\n    return NULL;\n\n}\n\nint init_module(void)\n{\n    syscall_table = (void *)find_syscall_table();\n\n    if (syscall_table != NULL)\n        pr_info(\"Found sys_call_table at %p\\n\", syscall_table);\n    return 0;\n}\n\nvoid cleanup_module(void)\n{\n    pr_info(\"Good bye kernel!!!!\");\n    return;\n}\n</code></pre>\n\n<p>and the problem am get is the following</p>\n\n<pre><code>[ 1376.153652] BUG: unable to handle kernel paging request at ffffffff81000018\n[ 1376.153660] IP: init_module+0x1b/0x50 [hide_file]\n[ 1376.153662] PGD 1bc0e067 P4D 1bc0e067 PUD 1bc0f063 PMD 0 \n[ 1376.153666] Oops: 0000 [#1] SMP PTI\n[ 1376.153668] Modules linked in: hide_file(O+) fuse bnep pci_stub vboxpci(O) vboxnetadp(O) vboxnetflt(O) vboxdrv(O) binfmt_misc nls_ascii nls_cp437 vfat fat uvcvideo videobuf2_vmalloc videobuf2_memops videobuf2_v4l2 videobuf2_core snd_soc_skl videodev snd_hda_codec_hdmi media intel_rapl snd_soc_skl_ipc snd_hda_ext_core x86_pkg_temp_thermal btusb intel_powerclamp snd_soc_sst_dsp coretemp snd_soc_sst_ipc btrtl btbcm snd_soc_acpi btintel snd_hda_codec_realtek snd_hda_codec_generic snd_soc_core bluetooth snd_compress kvm drbg ansi_cprng snd_hda_intel ecdh_generic i915 irqbypass snd_hda_codec snd_hda_core arc4 wmi_bmof rtsx_pci_ms intel_cstate snd_hwdep iwlmvm snd_pcm mac80211 iwlwifi intel_uncore thinkpad_acpi drm_kms_helper mei_me snd_timer memstick nvram cfg80211 efi_pstore intel_rapl_perf snd evdev\n[ 1376.153706]  efivars sg drm soundcore mei joydev pcspkr serio_raw rfkill wmi shpchp intel_pch_thermal iTCO_wdt iTCO_vendor_support battery ac video i2c_algo_bit button tpm_crb efivarfs ip_tables x_tables autofs4 ext4 crc16 mbcache jbd2 crc32c_generic fscrypto ecb hid_generic usbhid hid sd_mod crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel pcbc rtsx_pci_sdmmc mmc_core aesni_intel aes_x86_64 crypto_simd glue_helper cryptd rtsx_pci ahci mfd_core e1000e libahci xhci_pci ptp psmouse pps_core libata xhci_hcd i2c_i801 scsi_mod usbcore usb_common thermal\n[ 1376.153737] CPU: 0 PID: 2244 Comm: insmod Tainted: G           O     4.15.0-kali2-amd64 #1 Debian 4.15.11-1kali1\n[ 1376.153742] RIP: 0010:init_module+0x1b/0x50 [hide_file]\n[ 1376.153743] RSP: 0018:ffffc0adc85cfcc8 EFLAGS: 00010246\n[ 1376.153745] RAX: 0000000000000000 RBX: 0000000000000000 RCX: 0000000000000000\n[ 1376.153747] RDX: 000000000004e55a RSI: ffffffff81000000 RDI: ffffffffc0eea030\n[ 1376.153749] RBP: ffffffffc0eea030 R08: ffff9965a2424b60 R09: ffffffffbcb0b288\n[ 1376.153750] R10: ffffea3746bc08c0 R11: 0000000000000000 R12: ffff9965521f7a60\n[ 1376.153752] R13: ffffffffc0eec018 R14: 0000000000000001 R15: ffff9964ff2474e0\n[ 1376.153754] FS:  00007f2e082e8b80(0000) GS:ffff9965a2400000(0000) knlGS:0000000000000000\n[ 1376.153755] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\n[ 1376.153757] CR2: ffffffff81000018 CR3: 0000000154c84002 CR4: 00000000003606f0\n[ 1376.153758] Call Trace:\n[ 1376.153763]  do_one_initcall+0x4e/0x18d\n[ 1376.153768]  ? free_unref_page_commit+0x95/0x110\n[ 1376.153770]  ? _cond_resched+0x15/0x40\n[ 1376.153773]  ? kmem_cache_alloc_trace+0x14b/0x1a0\n[ 1376.153777]  ? do_init_module+0x22/0x201\n[ 1376.153779]  do_init_module+0x5b/0x201\n[ 1376.153783]  load_module.constprop.54+0x2725/0x2c70\n[ 1376.153786]  ? vfs_read+0x113/0x130\n[ 1376.153789]  ? SYSC_finit_module+0xe9/0x110\n[ 1376.153792]  SYSC_finit_module+0xe9/0x110\n[ 1376.153795]  do_syscall_64+0x6e/0x130\n[ 1376.153798]  entry_SYSCALL_64_after_hwframe+0x3d/0xa2\n[ 1376.153801] RIP: 0033:0x7f2e07c178f9\n[ 1376.153802] RSP: 002b:00007ffd4e622498 EFLAGS: 00000246 ORIG_RAX: 0000000000000139\n[ 1376.153804] RAX: ffffffffffffffda RBX: 00005629814157b0 RCX: 00007f2e07c178f9\n[ 1376.153806] RDX: 0000000000000000 RSI: 000056297fbc9a78 RDI: 0000000000000003\n[ 1376.153807] RBP: 000056297fbc9a78 R08: 0000000000000000 R09: 00007f2e07edd000\n[ 1376.153809] R10: 0000000000000003 R11: 0000000000000246 R12: 0000000000000000\n[ 1376.153810] R13: 0000562981415760 R14: 0000000000000000 R15: 0000000000000000\n[ 1376.153812] Code: c2 bc 75 ea f3 c3 31 c0 c3 0f 1f 80 00 00 00 00 0f 1f 44 00 00 48 c7 c6 00 00 00 81 eb 0d 48 83 c6 08 48 81 fe 00 00 00 a2 74 19 &lt;48&gt; 81 7e 18 d0 c5 c2 bc 75 e9 48 85 f6 48 89 35 e1 22 00 00 75 \n[ 1376.153844] RIP: init_module+0x1b/0x50 [hide_file] RSP: ffffc0adc85cfcc8\n[ 1376.153845] CR2: ffffffff81000018\n[ 1376.153847] ---[ end trace ec4600bb069abdd2 ]---\n</code></pre>\n\n<p>Could anyone please guide me on how to solve this problem so as to be able to hijack sys calls.\nThanks.</p>\n"}, {"tags": ["c", "insert", "structure"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1525224094, "post_id": 50125661, "comment_id": 87269834, "body": "<code>now</code> is a pointer to <code>struct Student</code>, <code>f</code> is a pointer to character(s). One of these things is not like the other..."}], "answers": [{"tags": [], "owner": {"reputation": 1123, "user_id": 6250527, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/33ee24677f6e95dadfa3220634449197?s=128&d=identicon&r=PG&f=1", "display_name": "Stephen.W", "link": "https://stackoverflow.com/users/6250527/stephen-w"}, "is_accepted": false, "score": 0, "last_activity_date": 1525222228, "creation_date": 1525222228, "answer_id": 50125730, "question_id": 50125661, "link": "https://stackoverflow.com/questions/50125661/how-to-insert-a-structure-into-a-node-of-a-linkedlist-using-c/50125730#50125730", "title": "How to insert a Structure into a node of a LinkedList using C?", "body": "<p>You assignd <code>temp-&gt;now</code> to incompatible pointer <code>f</code>, I guess the compiler has complained for that.</p>\n"}, {"tags": [], "owner": {"reputation": 352, "user_id": 2123548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf77cf1daaa005dafb62e9d9ab94690c?s=128&d=identicon&r=PG", "display_name": "Anirudh", "link": "https://stackoverflow.com/users/2123548/anirudh"}, "is_accepted": false, "score": 0, "last_activity_date": 1525225083, "creation_date": 1525225083, "answer_id": 50126048, "question_id": 50125661, "link": "https://stackoverflow.com/questions/50125661/how-to-insert-a-structure-into-a-node-of-a-linkedlist-using-c/50126048#50126048", "title": "How to insert a Structure into a node of a LinkedList using C?", "body": "<p>Inside the linked list Node you have another pointer to the STRUCT so first you need to allocate memory for that also. </p>\n\n<p><code>temp-&gt;now = (struct Student *) malloc(sizeof(struct Student));</code></p>\n\n<p>Now you can access the individual fields and the update them accordingly. \n<code>strncpy(temp-&gt;now.firstname, f, sizeof(temp-&gt;now.firstname));</code></p>\n\n<pre><code>strncpy(temp-&gt;now.lastname, f, sizeof(temp-&gt;now.lastname));\ntemp-&gt;now.score = s;\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6896571, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-LTxSsl8IIv4/AAAAAAAAAAI/AAAAAAAAtFo/cTBHwsW8h3I/photo.jpg?sz=128", "display_name": "Vester", "link": "https://stackoverflow.com/users/6896571/vester"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1525225083, "creation_date": 1525221551, "question_id": 50125661, "link": "https://stackoverflow.com/questions/50125661/how-to-insert-a-structure-into-a-node-of-a-linkedlist-using-c", "title": "How to insert a Structure into a node of a LinkedList using C?", "body": "<p>so I'm trying to enter the information of a Student, including first name, last name, score, and zip code, into a single node. I would then be able to insert the info of another student into the next node, and so on, and be able to access them.</p>\n\n<p>The part I'm having issues with is adding lastname, score, and zip code into the node. If anyone can help, I would greatly appreciate it. It's probably something really simple, but I simply don't know how.</p>\n\n<p>You can see the problem arise in the insert function. I'm able to insert the first name, but not the last name. Something may be wrong with my fundamentals, but if they are, just let me know.</p>\n\n<p>Thank you.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n/* inserting nodes at the END of a linked list */\n\nvoid Insert(char *f, char *l, float s, char *z);\nvoid Print();\n\nstruct node\n{\n    struct Student *now;\n    struct node *next;\n};\n\nstruct node *head; /* it will be created in the GLOBAL region of the memory */\nstruct node *tail = NULL;\n\nstruct Student {\n    char firstname[20];\n    char lastname[20];\n    float score;\n    char zip[20];\n};\n\n\nint main()\n{\n    //int i,n,x;\n    //int x;\n    head = NULL;\n\n    char first[20];\n    char last[20];\n    float score;\n    char zip[20];\n\n\n\n    printf(\"\\nPlease input records of students: \");\n\n    printf(\"\\nFirst name: \");\n    scanf(\"%s\", first);\n\n    printf(\"\\nLast name: \");\n    scanf(\"%s\", last);\n\n    printf(\"\\nScore: \");\n    scanf(\"%f\", &amp;score);\n\n    printf(\"\\nZip code: \");\n    scanf(\"%s\", zip);\n\n    printf(\"\\n------ This is the Print records function so far: \\n\\n\");\n    Insert(first, last, score, zip);\n\n    Print();\n\n    return 0;\n}\n\nvoid Insert(char *f, char *l, float s, char *z)\n{\n    struct node *temp = (struct node*) malloc(sizeof(struct node));\n\n    temp-&gt;now=f;\n\n    // Problem: how do I insert the other variables (last, score, zip) into a student structure and into node?\n    //temp-&gt;now.lastname =l; //Doesn't work\n    temp-&gt;next=NULL;\n\n    if (head == NULL)\n    {\n        head=temp;\n        tail=temp;\n        return;\n    }\n    tail-&gt;next=temp;\n    tail=temp;\n}\n\nvoid Delete(int n)\n{\n    struct node* temp1 = head;\n    int i;\n\n    if (n==1)\n    {\n\n        head = temp1-&gt;next; /*head now points to the second node */\n\n        free(temp1);\n\n        return;\n\n    }\n\n    for(i=0; i&lt;n-2; i++)\n        temp1=temp1-&gt;next; /* temp1 points to (n-1)th node */\n    struct node* temp2 = temp1-&gt;next; /* nth node */\n    temp1-&gt;next = temp2-&gt;next; /*(n+1)th node */\n    free(temp2); /* delete temp2 */\n}\n\nvoid Print()\n{\n    struct node* temp = (struct node*) malloc(sizeof(struct node));\n    temp = head;\n\n    while (temp!=NULL)\n    {\n        printf(\"%s \",temp-&gt;now);\n        temp = temp-&gt;next;\n    }\n\n    printf(\"\\n\");\n}\n</code></pre>\n"}, {"tags": ["c", "gcc", "compiler-errors"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 3, "creation_date": 1525221517, "post_id": 50125642, "comment_id": 87269329, "body": "Whats the HTML supposed to do in the C code?"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 2, "creation_date": 1525222792, "post_id": 50125642, "comment_id": 87269568, "body": "So, you tried to copy and paste from a web page?"}, {"owner": {"reputation": 1322, "user_id": 2693146, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KTITg.jpg?s=128&g=1", "display_name": "Isiah Meadows", "link": "https://stackoverflow.com/users/2693146/isiah-meadows"}, "edited": false, "score": 0, "creation_date": 1525225698, "post_id": 50125642, "comment_id": 87270172, "body": "Strip the <code>&lt;span&gt;</code>s from the code, and you&#39;ll fix all your issues. ;-)"}, {"owner": {"reputation": 1322, "user_id": 2693146, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KTITg.jpg?s=128&g=1", "display_name": "Isiah Meadows", "link": "https://stackoverflow.com/users/2693146/isiah-meadows"}, "edited": false, "score": 0, "creation_date": 1525225802, "post_id": 50125642, "comment_id": 87270185, "body": "Oh, and also, please, if you&#39;re going to copy/paste code, please don&#39;t just copy it and assume it&#39;ll work unconditionally. Make sure you verify that 1. you copied it correctly, and 2. it actually does what you want it to do."}, {"owner": {"reputation": 1, "user_id": 9727891, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CWnGAU_I480/AAAAAAAAAAI/AAAAAAAAAO8/nOCB1GQ_CW0/photo.jpg?sz=128", "display_name": "mwaqaryb", "link": "https://stackoverflow.com/users/9727891/mwaqaryb"}, "reply_to_user": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1525311273, "post_id": 50125642, "comment_id": 87309503, "body": "@jxh yes I copied it from web"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9727891, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CWnGAU_I480/AAAAAAAAAAI/AAAAAAAAAO8/nOCB1GQ_CW0/photo.jpg?sz=128", "display_name": "mwaqaryb", "link": "https://stackoverflow.com/users/9727891/mwaqaryb"}, "edited": false, "score": 0, "creation_date": 1525311369, "post_id": 50125764, "comment_id": 87309530, "body": "Thank you, it fixed"}, {"owner": {"reputation": 2000, "user_id": 9443618, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hx2BI.jpg?s=128&g=1", "display_name": "H&#233;ctor Manuel Mart&#237;nez Dur&#225;n", "link": "https://stackoverflow.com/users/9443618/h%c3%a9ctor-manuel-mart%c3%adnez-dur%c3%a1n"}, "reply_to_user": {"reputation": 1, "user_id": 9727891, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CWnGAU_I480/AAAAAAAAAAI/AAAAAAAAAO8/nOCB1GQ_CW0/photo.jpg?sz=128", "display_name": "mwaqaryb", "link": "https://stackoverflow.com/users/9727891/mwaqaryb"}, "edited": false, "score": 0, "creation_date": 1527298496, "post_id": 50125764, "comment_id": 88089027, "body": "@mwaqaryb click on the gray check"}], "tags": [], "owner": {"reputation": 2000, "user_id": 9443618, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hx2BI.jpg?s=128&g=1", "display_name": "H&#233;ctor Manuel Mart&#237;nez Dur&#225;n", "link": "https://stackoverflow.com/users/9443618/h%c3%a9ctor-manuel-mart%c3%adnez-dur%c3%a1n"}, "is_accepted": false, "score": 0, "last_activity_date": 1525222519, "creation_date": 1525222519, "answer_id": 50125764, "question_id": 50125642, "link": "https://stackoverflow.com/questions/50125642/expected-declaration-specifiers-or-before-token/50125764#50125764", "title": "Expected declaration specifiers or &#39;\u2026&#39; before &#39;&lt;&#39; token?", "body": "<p>The problem here is that you are mixing two completely different languages. <code>HTML</code> and <code>C</code> have nothing to do with each other, see that they are even for different platforms.</p>\n\n<p>Remove all <code>HTML</code> tags from your code and you will see that the error disappears.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;string.h&gt;\n\nint main(int argc, char *argv[])\n{\n    char *ptr;\n    if(argc &lt; 3)\n    {\n        printf(\"Usage: %s environment variable\\n\", argv[0]);\n    }\n    ptr = getenv(argv[1]); /* get env var location */\n    ptr += (strlen(argv[0]) - strlen(argv[2]))*2; /* adjust for program name */\n    printf(\"%s will be at %p\\n\", argv[1], ptr);\n}\n</code></pre>\n\n<p>I do not know for what reason you do this, but either way it's not possible.</p>\n"}], "owner": {"reputation": 1, "user_id": 9727891, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CWnGAU_I480/AAAAAAAAAAI/AAAAAAAAAO8/nOCB1GQ_CW0/photo.jpg?sz=128", "display_name": "mwaqaryb", "link": "https://stackoverflow.com/users/9727891/mwaqaryb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 439, "favorite_count": 1, "answer_count": 1, "score": -2, "last_activity_date": 1525222519, "creation_date": 1525221348, "question_id": 50125642, "link": "https://stackoverflow.com/questions/50125642/expected-declaration-specifiers-or-before-token", "title": "Expected declaration specifiers or &#39;\u2026&#39; before &#39;&lt;&#39; token?", "body": "<p>This is my code that gives following error on compilation: Expected declaration specifiers or '\u2026' before '&lt;' token\nline # 5</p>\n\n<p>//Code</p>\n\n<pre><code>    #include&lt;stdio.h&gt;\n    #include&lt;stdlib.h&gt;\n    #include&lt;string.h&gt;\n\n    int main(int argc, &lt;span id=\"IL_AD1\" class=\"IL_AD\"&gt;char&lt;/span&gt; *argv[])// line 5\n    {\n        char *ptr;\n        if(argc &lt; 3)\n        {\n            printf(\"Usage: %s &lt;&lt;span id=\"IL_AD2\" class=\"IL_AD\"&gt;environment variable&lt;/span&gt;&gt; &lt;target program name&gt;\\n\", argv[0]);\n            &lt;span id=\"IL_AD3\" class=\"IL_AD\"&gt;exit&lt;/span&gt;(0);\n        }\n        ptr = getenv(argv[1]); /* get env var location */\n        ptr += (strlen(argv[0]) - strlen(argv[2]))*2; /* adjust for program name */\n        printf(\"%s will be at %p\\n\", argv[1], ptr);\n    }\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 42504, "user_id": 1161878, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0157ddd785dc01e95342e3661d34b42a?s=128&d=identicon&r=PG", "display_name": "Gene", "link": "https://stackoverflow.com/users/1161878/gene"}, "edited": false, "score": 1, "creation_date": 1525222008, "post_id": 50125491, "comment_id": 87269438, "body": "Your solution will find the median in O(n) time. It&#39;s not hard to find the k&#39;th largest number in a BST (which of course lets you find the median, too) in O(log n) time if you make it an order statistic tree. The order statistics support doesn&#39;t make any other tree operation asymptotically slower."}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1525222026, "post_id": 50125491, "comment_id": 87269441, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/29989788/find-median-in-binary-search-tree\">Find median in binary search tree</a>"}], "answers": [{"tags": [], "owner": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "is_accepted": false, "score": 0, "last_activity_date": 1525221622, "creation_date": 1525221622, "answer_id": 50125674, "question_id": 50125491, "link": "https://stackoverflow.com/questions/50125491/find-and-delete-median-in-c-binary-search-tree/50125674#50125674", "title": "Find and Delete Median In C Binary Search Tree", "body": "<p>You already have a working function <code>counNodes()</code> which traverses the nodes in order, for counting the number of nodes.  What if you use that exact code in a new function that finds the Nth node in the tree :</p>\n\n<pre><code>struct Node *findNth(struct Node* root, int nth) {\n    struct Node *current, *pre;\n    int count = 0;\n    if (root == NULL)\n        return count;\n    current = root;\n    while (current != NULL)\n    {\n        if (current-&gt;left == NULL)\n        {\n            count++;\n            if (count == nth) {\n                return current;\n            } else {\n                current = current-&gt;right;;\n            }\n        } else\n        {\n            pre = current-&gt;left;\n            while (pre-&gt;right != NULL &amp;&amp; pre-&gt;right != current)\n                pre = pre-&gt;right;\n            if (pre-&gt;right == NULL)\n            {\n                pre-&gt;right = current;\n                current = current-&gt;left;\n            } else\n            {\n                pre-&gt;right = NULL;\n                count++;\n                if (count == nth) {\n                    return current;\n                } else {\n                    current = current-&gt;right;\n                }\n            }\n        }\n    }\n\n    printf(\"Could not find nth(%d)\\n\", nth);\n    exit(1);\n}\n\n\nint FINDM(struct Node *root)\n{\n    if (root == NULL)\n        return 0;\n    int count = counNodes(root);\n\n    struct Node *n = findNth(root, (count + 1) / 2);\n\n    return n-&gt;key;\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9408453"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 119, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1525221622, "creation_date": 1525219945, "question_id": 50125491, "link": "https://stackoverflow.com/questions/50125491/find-and-delete-median-in-c-binary-search-tree", "title": "Find and Delete Median In C Binary Search Tree", "body": "<p>I am working on Data structures in C and i need to find the Median of the values in the B.S.T and delete the median then showcase the new B.S.T but i haven't managed.I don't really know where am going wrong.Please help me out on this. I also need to be able to find a value that is closest to the mean and delete it</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\nstruct Node\n{\nint key;\nstruct Node* left, *right;\n};\n\n//Function to create new BST NODE\nstruct Node *newNode (int item)\n{\nstruct Node *temp = (struct Node *)malloc(sizeof(struct Node));\ntemp-&gt;key = item;\ntemp-&gt;left = temp-&gt;right = NULL;\nreturn temp;\n}\n//Function to perform INORDER traversal operation\nvoid inorder(struct Node *root)\n{\nif(root!=NULL)\n{\ninorder(root-&gt;left);\nprintf(\"%d\\n\",root-&gt;key);\ninorder (root-&gt;right);\n}\n} \n//Function to insert new node with given key in BST\nstruct Node* insert (struct Node* node, int key)\n{\n//if tree is empty\nif(node==NULL) return newNode(key);\n//else, recur down the tree\nif(key&lt; node-&gt;key)\nnode-&gt;left  = insert(node-&gt;left,key);\nelse if(key &gt; node-&gt;key)\nnode-&gt;right  = insert(node-&gt;right,key);\n//Return the (unchanged) node pointer\nreturn node;    \n}\n\n\n//Given a non-empty BST ,return node with minimum key value found in that          tree. Whole tree not really searched\nstruct Node * minValueNode(struct Node* node)\n{\nstruct Node* current =node;\n//loop down to find the left-most leaf\nwhile (current-&gt;left !=NULL)\n    current = current-&gt;left;\nreturn current;\n}\n//Given the BST and key, function to deleted the key to return new root\nstruct Node* deleteNode(struct Node* root, int key)\n{\nif(root == NULL) return root;\nif(key&lt;root-&gt;key)\n    root-&gt;left = deleteNode(root-&gt;left,key);\nelse if (key&gt; root-&gt;key)\n    root-&gt;right = deleteNode(root-&gt;right, key);\nelse\n{\n    //node with one or no child\n    if(root-&gt;left == NULL)\n    {\n        struct Node *temp = root-&gt;right;\n        free(root);\n        return temp;\n    }\n else if (root-&gt;right == NULL)\n {\n    struct Node *temp = root-&gt;left;\n    free(root);\n    return temp;\n}\n//node with two children\nstruct Node* temp = minValueNode(root-&gt;right);\n//copy the inorder successor to this node\nroot-&gt;key = temp-&gt;key;\n//delete the inorder successor\nroot-&gt;right = deleteNode(root-&gt;right, temp-&gt;key);\n}\nreturn root;\n}\n//Function to count nodes in a BST using Morris Inorder traversal\nint counNodes(struct Node *root)\n{\nstruct Node *current, *pre;\nint count =0;\nif(root == NULL)\n    return count;\ncurrent = root;\nwhile(current!=NULL)\n{\n    if(current-&gt;left == NULL)\n    {\n        count++;\n        current = current-&gt;right;;\n    }\n    else\n    {\n        pre = current-&gt;left;\n        while(pre-&gt;right !=NULL &amp;&amp; pre-&gt;right !=current) \n        pre=pre-&gt;right;\n        if(pre-&gt;right == NULL)\n        {\n            pre-&gt;right = current;\n            current= current-&gt;left;\n        }\n        else\n        {\n            pre-&gt;right = NULL;\n            count++;\n            current = current-&gt;right;\n        }\n    }\n}\nreturn count;\n} \n/*FUNCTION TO FIND MEDIAN */\nint FINDM(struct Node *root)\n{\nif(root == NULL)\n    return 0;\n    int count = counNodes(root);\n    int currCount=0;\n    struct Node *current = root, *pre, *prev;\n    while(current !=NULL)\n    {\n        if(current-&gt;left == NULL)\n        {\n            currCount++;\n            if(count%2!=0 &amp;&amp; currCount ==(count+1)/2)\n                return (prev-&gt;key);\n                //EVEN NUMBERS\n                else if(count%2==0 &amp;&amp; currCount==(count/2)+1)\n                    return (prev-&gt;key + current-&gt;key)/2;\n                    prev = current;\n                    current = current-&gt;right;\n                }\n                else\n                {\n                    pre=current-&gt;left;\n                    while(pre-&gt;right !=NULL &amp;&amp; pre-&gt;right !=current)\n                    pre= pre-&gt;right;\n                    if(pre-&gt;right = NULL)\n                    {\n                        pre-&gt;right = current;\n                        current = current-&gt;left;\n                    }\n                    else\n                    {\n                        pre-&gt;right = NULL;\n                        prev = pre;\n                        currCount++;\n                        if(count%2!=0 &amp;&amp; currCount == (count+1)/2)\n                            return (current-&gt;key);\n    else if(count%2==0 &amp;&amp; currCount ==  (count/2)+1)\n                                return (prev-&gt;key+current-&gt;key)/2;\n                                prev = current;\n                                current = current-&gt;right;\n                            }\n                        }\n                    }\n                }\n\n  //Driver Program to test functions above\nint main()\n{\n// values are 28,90,0,32,56,78,212,34,62\nstruct Node *root =NULL;\n\nroot=insert(root,65);\ninsert(root, 28);\ninsert(root, 90);\ninsert(root,0);\ninsert(root, 32);\ninsert(root,56);\ninsert(root, 78);\ninsert(root,212);\ninsert(root,34);\ninsert(root,62);\n\nprintf(\"InOrder Traversal of Tree\\n\");\ninorder(root);\n\nprintf(\"\\nDelete 65!\\n\");\nroot=deleteNode(root,65);\nprintf(\"Modified Tree\\n\");\ninorder(root);\n\nprintf(\"\\nMEDIAN \");\nFINDM(root);\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c", "opencl", "pyopencl"], "answers": [{"comments": [{"owner": {"reputation": 68, "user_id": 2154436, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/46c3e257fd487ecea3a5c10576449fcb?s=128&d=identicon&r=PG", "display_name": "Willian Britto", "link": "https://stackoverflow.com/users/2154436/willian-britto"}, "edited": false, "score": 0, "creation_date": 1525237544, "post_id": 50127369, "comment_id": 87272691, "body": "The problem is that even with a GPU running in the speed of light, the program would be slow as hell if I divide it into chunks, because each step of the program will need the results of the previous step, so even if I use the fastest SSD i&#39;ll be copying 10GB to the GPU, then writing results to the SSD, then loading another 10GB.... and this bottleneck would hide any gains from using a GPU."}, {"owner": {"reputation": 2747, "user_id": 1865305, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/350f7a2681c8cfc62f9597feb28ba9d1?s=128&d=identicon&r=PG", "display_name": "benshope", "link": "https://stackoverflow.com/users/1865305/benshope"}, "reply_to_user": {"reputation": 68, "user_id": 2154436, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/46c3e257fd487ecea3a5c10576449fcb?s=128&d=identicon&r=PG", "display_name": "Willian Britto", "link": "https://stackoverflow.com/users/2154436/willian-britto"}, "edited": false, "score": 0, "creation_date": 1525237920, "post_id": 50127369, "comment_id": 87272811, "body": "@WillianBritto yes, is possible that buying a huge amount RAM is the best choice for your situation"}], "tags": [], "owner": {"reputation": 2747, "user_id": 1865305, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/350f7a2681c8cfc62f9597feb28ba9d1?s=128&d=identicon&r=PG", "display_name": "benshope", "link": "https://stackoverflow.com/users/1865305/benshope"}, "is_accepted": false, "score": 0, "last_activity_date": 1525238722, "last_edit_date": 1525238722, "creation_date": 1525236854, "answer_id": 50127369, "question_id": 50125282, "link": "https://stackoverflow.com/questions/50125282/does-opencl-on-an-apu-capable-of-using-the-whole-memory/50127369#50127369", "title": "Does OpenCL on an APU capable of using the whole memory?", "body": "<p>Yes, it is possible to have a 32GB computer and to devote ~28GB of it's RAM to any program.  When you are writing an OpenCL program, all management of memory spaces (on-chip and off-chip) must be done manually.  I do not think you can run an OpenCL kernel that seems to directly accessing RAM, but even if you could, that would not be particularly worth thinking about because the power of OpenCL is in fine-grained management of RAM, L2, and L1 - not in allowing programmers to consider their program as operating against just RAM.</p>\n\n<p>Take some time, dive deep into memory management, and gain a very firm grasp of your computer's several memory spaces of varying sizes, connection speeds, and connection bandwidths.</p>\n\n<p>You seem to be thinking about buying a huge amount of RAM to solve your problem.  Hopefully you can find a better way to architect your solution - one that does not involve buying 128GB of RAM.  </p>\n\n<p>That said, some programs are inherently hard to parallelize.  For these programs you might just want to buy a ton of RAM (and maybe even skip OpenCL entirely and run it on the CPU)</p>\n"}], "owner": {"reputation": 68, "user_id": 2154436, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/46c3e257fd487ecea3a5c10576449fcb?s=128&d=identicon&r=PG", "display_name": "Willian Britto", "link": "https://stackoverflow.com/users/2154436/willian-britto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1525238722, "creation_date": 1525218168, "last_edit_date": 1525237054, "question_id": 50125282, "link": "https://stackoverflow.com/questions/50125282/does-opencl-on-an-apu-capable-of-using-the-whole-memory", "title": "Does OpenCL on an APU capable of using the whole memory?", "body": "<p>Is it possible to build a machine with something like 32GB of RAM, and use about ~28GB with OpenCL?</p>\n\n<p>My current APU is an Athlon 5350, with a \"global memory size\" reported of 2142658560. I played a little with pyopencl with the CL_MEM_USE_HOST_PTR, but I didn't find a way for doing that.</p>\n\n<p>Is that possible at all?\nMay be with some new generation APU, like Ryzen Vega?</p>\n\n<p>NOTE: I'm a non-professional and newbie, I didn't spend a hour yet studing OpenCL because before investing money and time on this, I want to know if it's possible at all... so sorry if this is a stupid question.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2237, "user_id": 8347081, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C2gg5Z3zU2w/AAAAAAAAAAI/AAAAAAAABXE/M2GK2Eixhms/photo.jpg?sz=128", "display_name": "mypetlion", "link": "https://stackoverflow.com/users/8347081/mypetlion"}, "edited": false, "score": 1, "creation_date": 1525217126, "post_id": 50125126, "comment_id": 87268371, "body": "A string literal is one that appears in the actual source code. As opposed to one that is (for example) created behind the scenes by <code>sprintf</code> or some such thing. It&#39;s one where the actual representation is right there in the source code for all to see."}, {"owner": {"reputation": 21, "user_id": 9727799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8ff658ea846a9f7a5433946c936d2e2?s=128&d=identicon&r=PG&f=1", "display_name": "partikao", "link": "https://stackoverflow.com/users/9727799/partikao"}, "reply_to_user": {"reputation": 2237, "user_id": 8347081, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C2gg5Z3zU2w/AAAAAAAAAAI/AAAAAAAABXE/M2GK2Eixhms/photo.jpg?sz=128", "display_name": "mypetlion", "link": "https://stackoverflow.com/users/8347081/mypetlion"}, "edited": false, "score": 0, "creation_date": 1525217181, "post_id": 50125126, "comment_id": 87268388, "body": "I think this has been referred to as a &quot;hard coded string&quot; in other languages? If I&#39;m right then I understand it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 2, "creation_date": 1525217216, "post_id": 50125126, "comment_id": 87268395, "body": "&quot; as C++ is just a parent of C&quot; - no, it isn&#39;t."}, {"owner": {"reputation": 21, "user_id": 9727799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8ff658ea846a9f7a5433946c936d2e2?s=128&d=identicon&r=PG&f=1", "display_name": "partikao", "link": "https://stackoverflow.com/users/9727799/partikao"}, "edited": false, "score": 1, "creation_date": 1525217281, "post_id": 50125126, "comment_id": 87268415, "body": "You can&#39;t say it isn&#39;t as you didn&#39;t ask what I meant by defining it as a &quot;parent.&quot; (maybe a &#39;child&#39; would be a better definition). From my limited knowledge, C++ is a rewrite of C with extended features. I apologize if I&#39;m wrong but answers in both languages would be similar, or exact even."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 2, "creation_date": 1525217441, "post_id": 50125126, "comment_id": 87268455, "body": "&quot;you didn&#39;t ask what I meant by defining it as a &quot;parent.&quot;.&quot; -  if we had to do that, we would have to ask what you mean by every word in your question, which is obviously not possible. I&#39;ve removed the C++ tag as you specifically say your question is about C."}, {"owner": {"reputation": 21, "user_id": 9727799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8ff658ea846a9f7a5433946c936d2e2?s=128&d=identicon&r=PG&f=1", "display_name": "partikao", "link": "https://stackoverflow.com/users/9727799/partikao"}, "edited": false, "score": 0, "creation_date": 1525217494, "post_id": 50125126, "comment_id": 87268469, "body": "I understand that. I&#39;ll put it down to bad naming and improve my writing in future questions, I apologize."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 1, "creation_date": 1525217613, "post_id": 50125126, "comment_id": 87268495, "body": "@partikao You&#39;re correct in saying that C++ is mostly a superset of C. It&#39;s just that here on SO people usually prefer when you ask about C <i>or</i> C++, because in some cases answers for C and C++ would differ drastically. (Not in this case, though.)"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1525219836, "post_id": 50125126, "comment_id": 87268964, "body": "C++ <i>was</i> almost completely a superset but since C99 there has been <i>more</i> divergence, not less."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 1, "creation_date": 1525221306, "post_id": 50125126, "comment_id": 87269279, "body": "@HolyBlackCat There is sufficient difference between C and C++ that make a proper answer to OP&#39;s question different especially the language&#39;s use of <i>literal</i>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1525221833, "post_id": 50125126, "comment_id": 87269400, "body": "@partikao Note that the first C++ compilers started off as C++ source --&gt; C source --&gt; code &quot;compliers&quot;.  So initially, anything C++ could do (albeit more convoluted), C could do making C++ a subset.  Much has evolved since then including a general separation of the languages."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1525221863, "post_id": 50125126, "comment_id": 87269407, "body": "@chux I wasn&#39;t aware of that difference before seeing your answer."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 9727799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8ff658ea846a9f7a5433946c936d2e2?s=128&d=identicon&r=PG&f=1", "display_name": "partikao", "link": "https://stackoverflow.com/users/9727799/partikao"}, "edited": false, "score": 0, "creation_date": 1525217404, "post_id": 50125169, "comment_id": 87268446, "body": "I think I understand. A literal string is simple just something like <code>function_name(&quot;literal string&quot;)</code>. Although one thing, would something like <code>auto literalString = &quot;literal string&quot;</code> still be a literal string, as it doesn&#39;t really fall under &quot;constant&quot; as the variable itself <code>literalString</code> can be changed."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "reply_to_user": {"reputation": 21, "user_id": 9727799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8ff658ea846a9f7a5433946c936d2e2?s=128&d=identicon&r=PG&f=1", "display_name": "partikao", "link": "https://stackoverflow.com/users/9727799/partikao"}, "edited": false, "score": 0, "creation_date": 1525217469, "post_id": 50125169, "comment_id": 87268463, "body": "@partikao <code>auto literalString = &quot;literal string&quot;</code> is not a literal because it has a name. Literals don&#39;t."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 1, "creation_date": 1525227456, "post_id": 50125169, "comment_id": 87270516, "body": "To clarify <code>&quot;literal string&quot;</code> is a literal, <code>literalString</code> is not - it&#39;s a pointer to a const char."}], "tags": [], "owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "is_accepted": true, "score": 5, "last_activity_date": 1525221646, "last_edit_date": 1525221646, "creation_date": 1525217269, "answer_id": 50125169, "question_id": 50125126, "link": "https://stackoverflow.com/questions/50125126/what-is-a-literal-string-char-array-in-c/50125169#50125169", "title": "What is a literal string &amp; char array in C?", "body": "<p>A string literal is an unnamed string constant in the source code. E.g. <code>\"abc\"</code> is a string literal.</p>\n\n<p>If you do something like <code>char str[] = \"abc\";</code>, then you could say that <code>str</code> is <em>initialized with a literal</em>. <code>str</code> itself is not a literal, since it's not <em>unnamed</em>.</p>\n\n<p>A string (or C-string, rather) is a contiguous sequence of bytes, terminated with a null byte.</p>\n\n<p>A char array is not necessarily a C-string, since it might lack a terminating null byte.</p>\n"}, {"comments": [{"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1525221783, "post_id": 50125548, "comment_id": 87269386, "body": "Touche, I didn&#39;t know about this difference in naming between C and C++."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 4, "last_activity_date": 1525221971, "last_edit_date": 1525221971, "creation_date": 1525220482, "answer_id": 50125548, "question_id": 50125126, "link": "https://stackoverflow.com/questions/50125126/what-is-a-literal-string-char-array-in-c/50125548#50125548", "title": "What is a literal string &amp; char array in C?", "body": "<blockquote>\n  <p>What is a literal string &amp; char array in C?</p>\n</blockquote>\n\n<p>C has 2 kinds of <em>literals</em>:  <em>string literals</em> and <em>compound literals</em>.  Both are unnamed and both can have their address taken.  <em>string literals</em> can have more than 1 <em>null character</em> in them.</p>\n\n<p>In the C library, a <em>string</em> is characters up to and including the first <em>null character</em>. So a <em>string</em> always has one and only one <em>null character</em>, else it is not a <em>string</em>. A <em>string</em> may be <code>char</code>, <code>signed char</code>, <code>unsigned char</code>.</p>\n\n<pre><code>//          v---v string literal 6 char long\nchar *s1 = \"hello\";\nchar *s2 = \"hello\\0world\";\n//          ^----------^  string literal 12 char long\n\nchar **s3 = &amp;\"hello\";  // valid\n\n//        v------------v  compound literal\nint *p1 = (int []){2, 4};\nint **p2 = &amp;(int []){2, 4};  // vlaid \n</code></pre>\n\n<p>C specifies the following as constants, not literals, like  <code>123</code>, <code>'x'</code> and <code>456.7</code>.  These <em>constants</em> can not have their address taken.  </p>\n\n<pre><code>int *p3 = &amp;7; // not valid\n</code></pre>\n\n<p>C++ and C differ in many of these regards.</p>\n\n<hr>\n\n<p>A <code>char</code>array is an <em>array</em> of <code>char</code>.  An array may consist of many <em>null characters</em>.</p>\n\n<pre><code>char a1[3];          // `a1` is a char array size 3\nchar a2[3] = \"123\";  // `a2` is a char array size 3 with 0 null characters \nchar a3[4] = \"456\";  // `a3` is a char array size 4\nchar a4[] = \"789\";   // `a4` is a char array size 4\nchar a5[4] = { 0 };  // `a5` is a char array size 4, all null characters\n</code></pre>\n\n<p>The following <code>t*</code> are <em>not</em> <code>char</code> arrays, but pointers to <code>char</code>.</p>\n\n<pre><code>char *t1;\nchar *t2 = \"123\";\nint *t3 = (char){'x'};  \n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9727799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8ff658ea846a9f7a5433946c936d2e2?s=128&d=identicon&r=PG&f=1", "display_name": "partikao", "link": "https://stackoverflow.com/users/9727799/partikao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 427, "favorite_count": 1, "accepted_answer_id": 50125169, "answer_count": 2, "score": 0, "last_activity_date": 1525221971, "creation_date": 1525216873, "last_edit_date": 1525217271, "question_id": 50125126, "link": "https://stackoverflow.com/questions/50125126/what-is-a-literal-string-char-array-in-c", "title": "What is a literal string &amp; char array in C?", "body": "<p>Firstly, I included C++ as C++ is just a parent of C, so I'm guessing both answers apply here, although the language I'm asking about and focusing on in this question is C, and not C++.</p>\n\n<p>So I began reading the C book 'Head First C' not so long ago. In the book (page 43/278) it will answer a question for you. Are there any differences between\nliteral strings and character arrays.</p>\n\n<p>I was totally thrown by this as I didn't know what a literal string was. I understand a string is just a array of characters, but what makes a 'string' literal? And why is it mentioning string in C if C doesn't actually provide any class (like a modern language such as C# or Java would) for string.</p>\n\n<p>Can anyone help clean up this confusion? I really struggle to understand what Microsoft had to say about this <a href=\"https://msdn.microsoft.com/en-us/library/8kc54dd5.aspx\" rel=\"nofollow noreferrer\">here</a> and think I need a more simple explanation I can understand.</p>\n"}, {"tags": ["c", "ubuntu", "tcp"], "answers": [{"tags": [], "owner": {"reputation": 1733, "user_id": 5018637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa5267033b2b33f15648273cbe845534?s=128&d=identicon&r=PG&f=1", "display_name": "user464502", "link": "https://stackoverflow.com/users/5018637/user464502"}, "is_accepted": false, "score": 0, "last_activity_date": 1525219492, "creation_date": 1525219492, "answer_id": 50125445, "question_id": 50125001, "link": "https://stackoverflow.com/questions/50125001/nslooup-c-cant-deal-with-http-https/50125445#50125445", "title": "nslooup.c can&#39;t deal with http / https?", "body": "<p><code>http://www.yahoo.com</code> isn't a hostname, it is rather a url.  A url\nhas (or can have) several components, but in this case, it's\njust a protocol (the 'http' part, and a hostname, which is the\n<code>www.yahoo.com</code> part.  So, that part, being an actual hostname\nwill (or could, there could be other errors) get resolved,\nwhereas the url, not being a hostname, will fail.  You may need\nto write or use a url parser if you need to do this sort of thing\nmore generally.</p>\n"}], "owner": {"reputation": 39, "user_id": 8065972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HE2cC.png?s=128&g=1", "display_name": "StevenU", "link": "https://stackoverflow.com/users/8065972/stevenu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 20, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1525219492, "creation_date": 1525215835, "question_id": 50125001, "link": "https://stackoverflow.com/questions/50125001/nslooup-c-cant-deal-with-http-https", "title": "nslooup.c can&#39;t deal with http / https?", "body": "<p>I'm trying to do my very first steps at udp/tcp c programing, and I've encounter with a problem.\nAfter compiling and running nslookup.c (I'm using linux Ubuntu) I've receive web information, as long I didn't type protocol before the domain.\nFor example, typing <code>./nslookup www.yahoo.com</code> - will work fine.\nHow ever, typing <code>./nslookup http://www.yahoo.com</code> - will lead to an error :<code>Error in resolving hostname</code>.</p>\n\n<p>here is the code I'm using:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netdb.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;arpa/inet.h&gt;\n\nint main(int argc, char* argv[]) {\n  struct addrinfo* res;\n  char* hostname;\n  char* hostaddr;\n  struct sockaddr_in* saddr;\n\n  if (argc != 2) {\n    perror(\"Usage: hostnamelookup &lt;hostname&gt;\\n\");\n    exit(1);\n  }\n\n  hostname = argv[1];\n\n  if (0 != getaddrinfo(hostname, NULL, NULL, &amp;res)) {\n    fprintf(stderr, \"Error in resolving hostname %s\\n\", hostname);\n    exit(1);\n  }\n\n  saddr = (struct sockaddr_in*)res-&gt;ai_addr;\n  hostaddr = inet_ntoa(saddr-&gt;sin_addr);\n\n  printf(\"Address for %s is %s\\n\", hostname, hostaddr);\n  exit(0);\n}\n</code></pre>\n\n<p>What is the reason for this issue?\nThanks</p>\n"}, {"tags": ["c", "mpi"], "answers": [{"comments": [{"owner": {"reputation": 1361, "user_id": 1454931, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c78af4d3124429c45c35cceaf4b73c79?s=128&d=identicon&r=PG&f=1", "display_name": "OD IUM", "link": "https://stackoverflow.com/users/1454931/od-ium"}, "edited": false, "score": 0, "creation_date": 1525251478, "post_id": 50125766, "comment_id": 87279163, "body": "Just ran a couple of benchmarks on a Cray xe6 and it seems like using derived datatypes is about 10x as fast. I guess there&#39;s some optimization going on but I can&#39;t figure out what it might be. On my local machine on the other hand, using mpi derived datatypes results in larger communication time"}, {"owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "reply_to_user": {"reputation": 1361, "user_id": 1454931, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c78af4d3124429c45c35cceaf4b73c79?s=128&d=identicon&r=PG&f=1", "display_name": "OD IUM", "link": "https://stackoverflow.com/users/1454931/od-ium"}, "edited": false, "score": 0, "creation_date": 1525332410, "post_id": 50125766, "comment_id": 87316288, "body": "great feedback ! under the hood packing/unpacking could be multithreaded, and/or the hardware could support sending/receiving non contiguous buffers."}], "tags": [], "owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "is_accepted": false, "score": 1, "last_activity_date": 1525222547, "creation_date": 1525222547, "answer_id": 50125766, "question_id": 50124884, "link": "https://stackoverflow.com/questions/50124884/whats-the-benefit-of-mpi-derived-datatypes/50125766#50125766", "title": "What&#39;s the benefit of mpi derived datatypes", "body": "<p>Basically, you can manually pack/unpack the data to/from a contiguous buffer or used a derived datatype.</p>\n\n<ul>\n<li><p>manual pack/unpack requires more code, more memory, but packing/unpacking time can be reduced by <code>OpenMP</code> for example.</p></li>\n<li><p>a derived datatype requires less code, less memory, but data is generally packed/unpacked under the hood and this is generally performed by a single thread.</p></li>\n</ul>\n\n<p>Bottome line, using a derived datatype saves you copying data to/from a buffer, but might not always be the fastest option.</p>\n"}], "owner": {"reputation": 1361, "user_id": 1454931, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c78af4d3124429c45c35cceaf4b73c79?s=128&d=identicon&r=PG&f=1", "display_name": "OD IUM", "link": "https://stackoverflow.com/users/1454931/od-ium"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1525222547, "creation_date": 1525214835, "question_id": 50124884, "link": "https://stackoverflow.com/questions/50124884/whats-the-benefit-of-mpi-derived-datatypes", "title": "What&#39;s the benefit of mpi derived datatypes", "body": "<p>Let's suppose my 3d grid of procs needs to communicate 2d arrays with all nearest neighbors. I could simply store the 2d array as a 1d array to make the data contiguous and use send/recv. Can I expect any performance benefit if I used e.g. Mpi_type_vector instead?</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1525211543, "post_id": 50124354, "comment_id": 87266811, "body": "No. Arrays are contiguous. But aliasing is bad for other reasons. Where this <code>int</code> came from?"}, {"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 0, "creation_date": 1525212063, "post_id": 50124354, "comment_id": 87267006, "body": "<a href=\"https://stackoverflow.com/questions/6290956/one-dimensional-access-to-a-multidimensional-array-is-it-well-defined-behaviour\" title=\"one dimensional access to a multidimensional array is it well defined behaviour\">stackoverflow.com/questions/6290956/&hellip;</a>"}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1525213018, "post_id": 50124354, "comment_id": 87267305, "body": "It is not uncommon to use a flat memory segment to represent a multi-dimensional array of any number of dimensions.  If you want to do that, you could easily write the functions to index into the memory segment based on the row, column, etc. values.  For example, you frequently see a sparse matrix represented as a flat array."}, {"owner": {"reputation": 16085, "user_id": 58805, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9e65438df95dc28b6024e20e11562dc3?s=128&d=identicon&r=PG", "display_name": "Calmarius", "link": "https://stackoverflow.com/users/58805/calmarius"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1525255532, "post_id": 50124354, "comment_id": 87281752, "body": "@EugeneSh. Sorry the original question was about int arrays then I changed it to char, but forgot to change the cast."}], "answers": [{"comments": [{"owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1525213843, "post_id": 50124591, "comment_id": 87267540, "body": "While <code>Foo[M][N]</code> and <code>Foo*</code> are different types, the actual access to memory happens via a <code>Foo*</code> in both cases: <code>foo[y][x]</code> is equivalent to <code>*(*(foo + y) + x)</code> which invokes array-pointer-decay two times to yield a single <code>Foo*</code> that is finally dereferenced. Doesn&#39;t that guarantee that the compiler has to assume aliasing anyway?"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1525214458, "post_id": 50124591, "comment_id": 87267739, "body": "@cmaster: The Standard is absolutely horrible at handling anything even remotely resembling corner cases.  The Standard makes very clear that given <code>FOO foo[M][N]</code>, a compiler would be entitled to assume that <code>foo[0][x]</code> and <code>foo[1][y]</code> are disjoint because <code>foo[0]</code> is an array object, and pointer arithmetic on a pointer to an array element is only allowed to yield a pointer to, or just past, an element of the same array, and &quot;just past&quot; pointers can&#39;t be dereferenced.  It&#39;s not clear what needs to be done to convert a pointer to an array element into a pointer unaffiliated with the array."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1525214596, "post_id": 50124591, "comment_id": 87267791, "body": "@cmaster: On the other hand, the way 6.5p7 is written would cause evaluation of even something as simple as <code>foo[0][0]</code> to invoke Undefined Behavior unless <code>FOO</code> is a character type, since it does not allow objects of aggregate types to have their storage accessed via lvalues of their constituent types (though it does allow the reverse)."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1525227552, "post_id": 50124591, "comment_id": 87270541, "body": "<a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.5p7\" rel=\"nofollow noreferrer\">C11 Standard - 6.5 Expressions (7, bullet 1)</a> <i>&quot;a type compatible with the effective type of the object&quot;</i> muddies the waters still. I have still not seen a concise description of the boundaries of what <i>&quot;a type compatible with the effective type of the object&quot;</i> is limited to. I&#39;m not saying there is anything incorrectly stated, but indexing a flat array with a pointer to type of size X would seem to be supported as type compatible with the effective type of the array. (the onus is on the programmer to stay in bounds (or 1 past it)."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1525229389, "post_id": 50124591, "comment_id": 87270934, "body": "@DavidC.Rankin: The language in the Standard is absurdly vague.  If a compiler recognizes the use of a derived lvalue to access the parent, stretching the bounds of what types are allowable isn&#39;t necessary.  If a compiler can&#39;t recognize the use of derived lvalues, stretching the bounds of what types are allowed isn&#39;t sufficient."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1525229874, "post_id": 50124591, "comment_id": 87271038, "body": "Well, that&#39;s about as clear and concise a statement regarding 6.5(6)&amp;(7) as I&#39;ve ever seen..."}, {"owner": {"reputation": 16085, "user_id": 58805, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9e65438df95dc28b6024e20e11562dc3?s=128&d=identicon&r=PG", "display_name": "Calmarius", "link": "https://stackoverflow.com/users/58805/calmarius"}, "edited": false, "score": 0, "creation_date": 1525255583, "post_id": 50124591, "comment_id": 87281781, "body": "Sorry the original question was about int arrays then I changed it to char, but forgot to change the cast. (because ints are usually aligned so the x86 alignment argument wouldn&#39;t apply)"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1525272706, "post_id": 50124591, "comment_id": 87293397, "body": "@DavidC.Rankin: It irks me that ever since Defect Report #028 made it clear that the predecessor to 6.5p7 was insufficient, the Standard has added complexity without bothering to define the behavior of things as simple as <code>someStruct.member = 23;</code> for non-character-type members."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1525288400, "post_id": 50124591, "comment_id": 87302034, "body": "They have generated no-end of debate among those who care enough to read and try and stay within the defined standard. In the real world I&#39;m both a professional engineer and attorney -- I&#39;m good at discerning technical references. 6.5p7 might as well be goggeldygoop the way it is written. The gist of the language is clear, but it provides zero clarity or guidance for what is and what isn&#39;t a type compatible with the effective type on the margins."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1525288991, "post_id": 50124591, "comment_id": 87302315, "body": "@DavidC.Rankin: Actually, the lack of clarity is with what it means for an lvalue to be &quot;used&quot; to perform a given access.  The fact that a <code>union u</code> contains a <code>struct s</code> does not imply blanket permission to use an lvalue of type <code>struct s</code> to modify the storage belonging to a <code>union u</code> nor any of its constituents, but a pointer formed from an lvalue or pointer of a different type should be usable to address and/or access storage in the context where it is formed, or in nested contexts where it is the exclusive means of addressing/accessing that storage."}], "tags": [], "owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "is_accepted": false, "score": 4, "last_activity_date": 1525212857, "creation_date": 1525212857, "answer_id": 50124591, "question_id": 50124354, "link": "https://stackoverflow.com/questions/50124354/can-arrays-of-different-layout-alias/50124591#50124591", "title": "Can arrays of different layout alias?", "body": "<p>The Standard requires that for any type <code>Foo</code>, the size of a <code>Foo[N]</code> be exactly <code>N * sizeof (Foo)</code>.  It does not, however, specify any circumstances in which an object of type <code>Foo[M][N]</code> (or even a <code>Foo[N]</code>) may be accessed using an lvalue of type <code>Foo</code>, unless <code>Foo</code> happens to be a character type.  Obviously it would be absurd to suggest that arrays of non-character type should not be accessible using subscript expressions, but the way N1570 6.5p7 is written doesn't actually allow that.</p>\n\n<p>When using character types, the Standard seems to intend that a pointer to an object of size <code>N</code> may be converted to character type and treated as though it were a <code>char[N]</code>; functions like <code>memcpy</code> and <code>fwrite</code> rely upon such abilities.  Still, the Standard doesn't explicitly say such a thing.</p>\n\n<p>If one assumes that the intention of the Standard was to allow the elements of a <code>Foo[M][N]</code> to be accessed using an lvalue of a non-character type <code>Foo</code> in at least some circumstances, defining what those circumstances are would likely answer the question of when one may use a \"flattened\" pointer to access a multi-dimensional array.</p>\n\n<p>Personally, I think that an lvalue <code>D</code> which is derived from an lvalue of another type (e.g., given <code>Foo myArray[10][12]; Foo *p = myArray[5];</code>, I would regard <code>myArray[5]</code> as being an lvalue derived from <code>myArray</code>, <code>myArray[5][0]</code> as derived from <code>myArray[0]</code>, and <code>*p</code> as derived from <code>myArray[5][0]</code>) should be usable to access storage within the object identified by the original, at least until either:</p>\n\n<ol>\n<li><p>The same storage is accessed via some means not derived from <code>D</code>.</p></li>\n<li><p>An lvalue is produced that isn't derived from <code>D</code>, that will be used to access that storage in conflicting fashion, or produce another lvalue that will be.</p></li>\n<li><p>Code enters a loop or function wherein either of the above occurs.</p></li>\n</ol>\n\n<p>Applying that principle, and treating a cast to an array-element type as \"laundering\" the exact type of the array, casting a <code>Foo[M][N]</code> to a <code>Foo*</code> would yield a pointer which could access all elements of the array <em>as long as the array isn't accessed via any other means</em>.  A compiler that makes any bona fide effort to stay out of a programmer's way should have no trouble with such code.  Unfortunately, the Standard doesn't specify <em>any</em> situations where compilers are required to allow derived lvalues to access parent objects, and some compiler writers interpret that as an invitation to ignore the possibility that lvalues might access storage associated with other lvalues from which they are derived.</p>\n"}], "owner": {"reputation": 16085, "user_id": 58805, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9e65438df95dc28b6024e20e11562dc3?s=128&d=identicon&r=PG", "display_name": "Calmarius", "link": "https://stackoverflow.com/users/58805/calmarius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1525255490, "creation_date": 1525211425, "last_edit_date": 1525255490, "question_id": 50124354, "link": "https://stackoverflow.com/questions/50124354/can-arrays-of-different-layout-alias", "title": "Can arrays of different layout alias?", "body": "<p>Let's say I have an <code>N*M</code> flat array and I would like to use as a multidimensional array. But instead of manually indexing it as <code>array[row*M + column]</code> I thought I will point a pointer to a multidimensional array of it.</p>\n\n<pre><code>char flatArray[N*M];\nchar (*multidimensional)[M] = (char (*)[M])flatArray;\n</code></pre>\n\n<p>Then accessing the contents of flat array via the <code>multidimensional</code> pointer.</p>\n\n<p>It works with and without optimization and compiles without warnings.</p>\n\n<p>But my concern is that the compiler may want to be smart in the future and if the length of the row is not a power of 2 it may pad it so it can generate code that exploits the x86 addressing, so the array access would be a single <code>mov eax, [4*ebx+ecx]</code> instead of having to calculate the index first with a few instructions before each time the array is accessed.</p>\n\n<p>The question is: Are standards compliant C compilers allowed pad the rows in a multidimensional array to generate faster code? </p>\n"}, {"tags": ["c", "windows", "sockets", "tcp", "sdl-net"], "comments": [{"owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 0, "creation_date": 1525211306, "post_id": 50123901, "comment_id": 87266712, "body": "Looks like a null pointer dereference. Provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, your question is off-topic without it."}], "answers": [{"tags": [], "owner": {"reputation": 21663, "user_id": 9305398, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cqJvE.png?s=128&g=1", "display_name": "Acorn", "link": "https://stackoverflow.com/users/9305398/acorn"}, "is_accepted": false, "score": 0, "last_activity_date": 1525212526, "creation_date": 1525212526, "answer_id": 50124550, "question_id": 50123901, "link": "https://stackoverflow.com/questions/50123901/can-t-add-tcp-socket-to-a-socket-set-with-sdl-net/50124550#50124550", "title": "Can&#39; t add TCP socket to a socket set with SDL_NET", "body": "<p>There are several typos:</p>\n\n<pre><code>if (socketSet = NULL)\n</code></pre>\n\n<p>Assigning <code>NULL</code> to <code>socketSet</code>, which makes the condition false and therefore later you are using it to call <code>SDLNet_TCP_AddSocket</code> with a null pointer.</p>\n\n<pre><code>printf(\"Failed to create the socket set: %s\\n\", SDLNet_GetError);\n</code></pre>\n\n<p>Missing <code>()</code>.</p>\n\n<p>In general, it is a good idea to enable as many warnings as possible to avoid trivial typos like these.</p>\n"}], "owner": {"reputation": 21, "user_id": 9727446, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "David Guirguis", "link": "https://stackoverflow.com/users/9727446/david-guirguis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 149, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1525212526, "creation_date": 1525209198, "last_edit_date": 1525210572, "question_id": 50123901, "link": "https://stackoverflow.com/questions/50123901/can-t-add-tcp-socket-to-a-socket-set-with-sdl-net", "title": "Can&#39; t add TCP socket to a socket set with SDL_NET", "body": "<p>I get this error trying to add my socket to a <em>socket set</em>:</p>\n\n<blockquote>\n  <p>Exception thrown at 0x69702631 (SDL2_net.dll) in PROJECTNAME.exe: 0xC0000005: Access violation reading location 0x00000000.</p>\n</blockquote>\n\n<p>I am not sure what I am missing. Here is the relating code.</p>\n\n<pre><code>SDL_Init(SDL_INIT_EVERYTHING);\nSDLNet_Init();\nIPaddress serverIP;\n\nSDLNet_SocketSet socketSet = SDLNet_AllocSocketSet(10); \nif (socketSet = NULL)\n{\n    printf(\"Failed to create the socket set: %s\\n\", SDLNet_GetError);\n}\n\nif (SDLNet_ResolveHost(&amp;serverIP, NULL, 1234) == -1)\n{\n    printf(\"SDLNet_ResolveHost: %s \\n\", SDLNet_GetError());\n    exit(1);\n}\n\nTCPsocket serverSocket;\nserverSocket = SDLNet_TCP_Open(&amp;serverIP); \n\nif (!serverSocket)\n{\n    printf(\"SDLNet_TCP_Open: %s\\n\", SDLNet_GetError());\n\n}\nelse\n{\n    printf(\"Successfully created server socket \\n\");\n}\nint numused;\n\nnumused = SDLNet_TCP_AddSocket(socketSet, serverSocket);\nif (numused == -1)\n{\n    printf(\"SDLNet_Addsocket: %s \\n\", SDLNet_GetError());\n    while (1)\n    {\n        printf(\"1\");\n    }\n}\n</code></pre>\n\n<p>Any help would be appreciated.</p>\n"}, {"tags": ["c", "linux", "ubuntu"], "comments": [{"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 2, "creation_date": 1525207887, "post_id": 50123629, "comment_id": 87265419, "body": "What do you mean by &quot;when i make&quot;? can you paste the exact error you are getting and the exact command that triggers it?"}, {"owner": {"reputation": 13, "user_id": 7080903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91b65b24517b676f2884b505a674c17d?s=128&d=identicon&r=PG&f=1", "display_name": "alex Brock", "link": "https://stackoverflow.com/users/7080903/alex-brock"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1525208000, "post_id": 50123629, "comment_id": 87265475, "body": "When I run the make command to compile my project...."}, {"owner": {"reputation": 13, "user_id": 7080903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91b65b24517b676f2884b505a674c17d?s=128&d=identicon&r=PG&f=1", "display_name": "alex Brock", "link": "https://stackoverflow.com/users/7080903/alex-brock"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1525208039, "post_id": 50123629, "comment_id": 87265491, "body": "Here&#39;s the error:  In function <code>main&#39;: &#47;home&#47;bobo_baggins&#47;Documents&#47;212&#47;project&#47;ball-demo&#47;source&#47;ba&zwnj;&#8203;ll.c:232: undefined reference to </code>sleep&#39; /home/bobo_baggins/Documents/212/project/ball-demo/source/ba&zwnj;&#8203;ll.c:240: undefined reference to `sleep&#39; collect2: error: ld returned 1 exit status"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 4, "creation_date": 1525208090, "post_id": 50123629, "comment_id": 87265512, "body": "Please post the <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> that shows the problem, and the compiler&#39;s messages <i>in the question</i>."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1525208315, "post_id": 50123629, "comment_id": 87265613, "body": "Does a much simpler program that uses <code>sleep</code> link successfully?"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1525209597, "post_id": 50123629, "comment_id": 87266101, "body": "Add to your question how you are compiling your program with a sample program that illustrates the problem. I can only imagine that you are compiling with <code>-nostdlib</code>."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1525209773, "post_id": 50123629, "comment_id": 87266173, "body": "reopening, even if I know that it&#39;s a mistake. note I should have known OP was running linux by the paths in the comments..."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1525214574, "post_id": 50123629, "comment_id": 87267786, "body": "Search all your source code. There&#39;s a good chance some piece of code is doing something very odd with <code>sleep</code>, such as defining a different function also called &quot;sleep&quot;. it&#39;s also possible there&#39;s something wrong with the make file."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1525222965, "post_id": 50123629, "comment_id": 87269599, "body": "Please show your makefile and state the system. Since Stack Overflow hides the Close reason from you: <i>Questions seeking debugging help (&quot;why isn&#39;t this code working?&quot;) must include the desired behavior, a specific problem or error and the shortest code necessary to reproduce it in the question itself. Questions without a clear problem statement are not useful to other readers. See: <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>.</i>"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7080903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91b65b24517b676f2884b505a674c17d?s=128&d=identicon&r=PG&f=1", "display_name": "alex Brock", "link": "https://stackoverflow.com/users/7080903/alex-brock"}, "edited": false, "score": 0, "creation_date": 1525209071, "post_id": 50123777, "comment_id": 87265909, "body": "You are correct, when I made a test file for sleep it worked fine. So I&#39;m using a makefile provided by my professor, how to ensure I&#39;ve include the correct library?"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 13, "user_id": 7080903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91b65b24517b676f2884b505a674c17d?s=128&d=identicon&r=PG&f=1", "display_name": "alex Brock", "link": "https://stackoverflow.com/users/7080903/alex-brock"}, "edited": false, "score": 1, "creation_date": 1525210576, "post_id": 50123777, "comment_id": 87266474, "body": "@alexBrock You&#39;re probably going to need to ask your professor for help.  It&#39;s a bit hard to imagine how (or why) he&#39;s managed to disable linking against the standard library (the one that does have <code>sleep</code> in it).  You might be able to post the whole Makefile, and someone here might be able to see a good way to fix it, but if it&#39;s goofy enough to disable the standard libraries, I can easily imagine it&#39;s goofy enough to be incomprehensible."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 13, "user_id": 7080903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91b65b24517b676f2884b505a674c17d?s=128&d=identicon&r=PG&f=1", "display_name": "alex Brock", "link": "https://stackoverflow.com/users/7080903/alex-brock"}, "edited": false, "score": 2, "creation_date": 1525210612, "post_id": 50123777, "comment_id": 87266484, "body": "@alexBrock update your question with the makefile and we\u2019ll be able to tell you what\u2019s wrong."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1525211180, "post_id": 50123777, "comment_id": 87266673, "body": "<code>sleep</code> is <i>declared</i> in the header, not <i>defined</i>."}], "tags": [], "owner": {"reputation": 536, "user_id": 8519332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G93ON.jpg?s=128&g=1", "display_name": "Varrak", "link": "https://stackoverflow.com/users/8519332/varrak"}, "is_accepted": false, "score": 1, "last_activity_date": 1525212431, "last_edit_date": 1525212431, "creation_date": 1525208465, "answer_id": 50123777, "question_id": 50123629, "link": "https://stackoverflow.com/questions/50123629/linux-undefined-reference-to-sleep-even-though-i-included-unistd-h/50123777#50123777", "title": "Linux: Undefined reference to &quot;sleep&quot;, even though I included unistd.h", "body": "<p>This is a linker error, not a compiler error (you can see that from the \"ld returned 1 exit status\" part - ld is the linker). So sleep is declared in the header, which compiles fine, but you need to ensure you include the correct library/binary file for the linking stage.</p>\n"}, {"tags": [], "owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "is_accepted": false, "score": 1, "last_activity_date": 1525219618, "last_edit_date": 1525219618, "creation_date": 1525217642, "answer_id": 50125232, "question_id": 50123629, "link": "https://stackoverflow.com/questions/50123629/linux-undefined-reference-to-sleep-even-though-i-included-unistd-h/50125232#50125232", "title": "Linux: Undefined reference to &quot;sleep&quot;, even though I included unistd.h", "body": "<p>I can roughly replicate the reported behavior with the following program:</p>\n\n<pre><code>#include &lt;unistd.h&gt;\n\nint main (void) {\n    sleep(1);\n    return 0;\n}\n\nvoid _start (void) {\n    asm(\"call main;\"\n        \"mov %eax,%ebx;\"\n        \"movl $1,%eax;\"\n        \"int  $0x80;\");\n}\n</code></pre>\n\n<p>But, it must be compiled with <code>-nostdlib</code>. From this <a href=\"https://tio.run/##XU9BCoMwELznFUuqoGCK3gop/UKPPZaYpDYQo5goQvHr3Sae2s5tZ2Z3ZiXrpEQ8GCftrDScZ2d8UMfnhRDjAvTCOCiWwagSXgQivNV6LJqS79Okwzw5qDnZCEk2uPsgpvCzInxfUCms3c9xupMJtB8WyLVYq1y3659gIWuqJH7zqRNk9XqqOY0VNsS3fFjReWRXZKNWwgUjkd1iGjI3xF@saT8\" rel=\"nofollow noreferrer\" title=\"C (gcc) \u2013 Try It Online\">TIO</a> example, I get:</p>\n\n<blockquote>\n<pre><code>/tmp/ccfjKQV4.o: In function `main':\n.code.tio.c:(.text+0xa): undefined reference to `sleep'\ncollect2: error: ld returned 1 exit status\n</code></pre>\n</blockquote>\n\n<p>Which pretty closely matches the output you are reporting. To fix this, you need to provide <code>libc</code> when linking the program. This can be accomplished by adding <code>-lc</code>, as demonstrated at this <a href=\"https://tio.run/##XU9BCoMwELznFUuqoGCK3gop/UKPPZaYpDYQo5goQvHr3Sae2s5tZnZ3ZiXrpEQ8GCftrDScZ2d8UMfnhRDjAvTCOCiWwagSXgQivNV6LJqS72zSYZ4c1JxshKQxuPsgpvCzInxfUCms3c9xuosJtB8WyLVYq1y3659hIWuqZH7rqRNk9XqqOY0VNsS3fFjReWRWIrsiG7USLphIbjERmRviP9a0Hw\" rel=\"nofollow noreferrer\" title=\"C (gcc) \u2013 Try It Online\">TIO</a> example. But, if you are using <code>-nostdlib</code>, <strong>this solution may not be viable</strong> (more on that later).</p>\n\n<hr>\n\n<h3><code>_start</code></h3>\n\n<p>The sample program I provided is an example of how to create an x86 linux program that will call <code>main</code> and then call <code>exit</code> without needing to use the C runtime. Without the standard C runtime, linux will attempt to jump to a routine called <code>_start</code>. Since there is no C library, <code>exit</code> is called via assembly.</p>\n\n<hr>\n\n<h3><code>-nostdlib</code></h3>\n\n<p>The <code>-nostdlib</code> option is telling the compiler to not include the standard C runtime and C libraries when building the executable. This is sometimes used in embedded software development where the embedded platform has its own runtime. If this software is intended to run on an embedded platform, it may be erroneous to include <code>-lc</code> to the link line, since it may cause interference with embedded system's library. In that case, you may need to implement your own version of <code>sleep</code> or find a different way to pause your program.</p>\n"}], "owner": {"reputation": 13, "user_id": 7080903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91b65b24517b676f2884b505a674c17d?s=128&d=identicon&r=PG&f=1", "display_name": "alex Brock", "link": "https://stackoverflow.com/users/7080903/alex-brock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1177, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1525219618, "creation_date": 1525207757, "last_edit_date": 1525217800, "question_id": 50123629, "link": "https://stackoverflow.com/questions/50123629/linux-undefined-reference-to-sleep-even-though-i-included-unistd-h", "title": "Linux: Undefined reference to &quot;sleep&quot;, even though I included unistd.h", "body": "<p>Trying to use <code>sleep()</code> to pause my program briefly.\nExcept when I \"make\" I get an <code>undefined reference to sleep</code>, even though I <code>#include &lt;unistd.h&gt;</code> at the top.</p>\n\n<blockquote>\n<pre><code>In function `main':\n[...]/source/ball.c:232: undefined reference to `sleep' \n[...]/source/ball.c:240: undefined reference to `sleep'\ncollect2: error: ld returned 1 exit status\n</code></pre>\n</blockquote>\n\n<p>I'm using linux.\nAny suggestions?\nThanks</p>\n\n<p>EDIT: This Is not a duplicate question because every other time this question has been asked, the user was running it on Windows. The solution. for me, is not simply to include the windows header.</p>\n\n<p>EDIT(2): The link to that other question does not help me. That's why I made a new post. I'm not on windows!!</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1875, "user_id": 8803266, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0PJdh.png?s=128&g=1", "display_name": "Oliver Baumann", "link": "https://stackoverflow.com/users/8803266/oliver-baumann"}, "edited": false, "score": 7, "creation_date": 1525207552, "post_id": 50123551, "comment_id": 87265254, "body": "What&#39;s the error?"}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 4, "creation_date": 1525207577, "post_id": 50123551, "comment_id": 87265271, "body": "I think you just need to <code>return str;</code>."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 2, "creation_date": 1525207585, "post_id": 50123551, "comment_id": 87265273, "body": "Change <code>return *str</code> into <code>return str</code>. Your form returns a <code>char</code> and <i>not</i> a pointer to to a <code>char</code> array. Recompile with <code>-Wall</code> to help."}, {"owner": {"reputation": 1, "user_id": 9727383, "user_type": "registered", "profile_image": "https://graph.facebook.com/1981914178803612/picture?type=large", "display_name": "Ethan", "link": "https://stackoverflow.com/users/9727383/ethan"}, "edited": false, "score": 0, "creation_date": 1525207743, "post_id": 50123551, "comment_id": 87265331, "body": "main.c:19:12: warning: implicit declaration of function &#39;getResources&#39; is invalid in C99 [-Wimplicit-function-declaration]"}, {"owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "edited": false, "score": 3, "creation_date": 1525207754, "post_id": 50123551, "comment_id": 87265344, "body": "<code>sizeof(str)</code> is going to get you the size of a pointer (usually 4 on a 32-bit machine, 8 on a 64-bit machine), not the size of your buffer. This is pretty much always going to be larger than the size of your buffer, which is only 3 bytes. This is going to cause an overflow, which will crash if you&#39;re lucky, or do much worse things if you&#39;re not."}, {"owner": {"reputation": 1, "user_id": 9727383, "user_type": "registered", "profile_image": "https://graph.facebook.com/1981914178803612/picture?type=large", "display_name": "Ethan", "link": "https://stackoverflow.com/users/9727383/ethan"}, "edited": false, "score": 0, "creation_date": 1525207772, "post_id": 50123551, "comment_id": 87265357, "body": "^ main.c:30:10: warning: incompatible pointer to integer conversion initializing &#39;char&#39; with an expression of type &#39;char *&#39;; dereference with * [-Wint-conversion]  main.c:31:11: warning: incompatible integer to pointer conversion passing &#39;char&#39; to parameter of type &#39;char *&#39;; take the address with &amp; [-Wint-conversion]"}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1525207811, "post_id": 50123551, "comment_id": 87265374, "body": "You&#39;ll need to add a function prototype before main: <code>char* getResources(void);</code>"}, {"owner": {"reputation": 5768, "user_id": 3088572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/769f723b0fd6eb8c99d5f65b39392b18?s=128&d=identicon&r=PG&f=1", "display_name": "alvits", "link": "https://stackoverflow.com/users/3088572/alvits"}, "edited": false, "score": 0, "creation_date": 1525207811, "post_id": 50123551, "comment_id": 87265375, "body": "You don&#39;t have a function prototype. THat&#39;s what the compiler warning means."}, {"owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "edited": false, "score": 4, "creation_date": 1525207846, "post_id": 50123551, "comment_id": 87265388, "body": "Honestly, I&#39;d suggest getting a good book on the C language, or taking a class. Coding in C without having a solid understanding of the fundamentals can cause pretty catastrophic failures."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 1, "creation_date": 1525207936, "post_id": 50123551, "comment_id": 87265441, "body": "Your length is <code>3</code> [very short]. Try doing the malloc with (e.g. <code>80</code> instead of <code>3</code>) and do: <code>fgets(str,80,stdin)</code> because your current <code>fgets</code> length claims <i>more</i> space than you actually allocated. Better yet (e.g.): <code>#define LEN 80</code> and replace the hard coded values with <code>LEN</code>"}, {"owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "reply_to_user": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1525207974, "post_id": 50123551, "comment_id": 87265463, "body": "@CraigEstey The <code>#define</code> method is the correct way to go about this."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1525209272, "post_id": 50123551, "comment_id": 87265982, "body": "@Ethan please add your comment about <i>warning: incompatible pointer</i> into the question."}], "answers": [{"tags": [], "owner": {"reputation": 827, "user_id": 7383242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c65444c41048c45464ae10a9cafa0c41?s=128&d=identicon&r=PG&f=1", "display_name": "medalib", "link": "https://stackoverflow.com/users/7383242/medalib"}, "is_accepted": false, "score": 2, "last_activity_date": 1525208101, "creation_date": 1525208101, "answer_id": 50123703, "question_id": 50123551, "link": "https://stackoverflow.com/questions/50123551/trying-to-create-a-function-in-c-that-takes-in-user-input-and-returns-a-string-o/50123703#50123703", "title": "trying to create a function in c that takes in user input and returns a string of char", "body": "<p>Your problem here is that you are returning <code>*str</code> instead of the pointer <code>str</code>:</p>\n\n<pre><code>return str;\n</code></pre>\n\n<p>Also, you are reading <code>sizeof(str)</code> characters, which is the size of a pointer, that can vary across platforms.\nSo instead, you need to change that to <code>3</code>, the number of characters allocated for <code>str</code>:</p>\n\n<pre><code>fgets(str, 3, stdin); \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1875, "user_id": 8803266, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0PJdh.png?s=128&g=1", "display_name": "Oliver Baumann", "link": "https://stackoverflow.com/users/8803266/oliver-baumann"}, "is_accepted": false, "score": 0, "last_activity_date": 1525208592, "creation_date": 1525208592, "answer_id": 50123797, "question_id": 50123551, "link": "https://stackoverflow.com/questions/50123551/trying-to-create-a-function-in-c-that-takes-in-user-input-and-returns-a-string-o/50123797#50123797", "title": "trying to create a function in c that takes in user input and returns a string of char", "body": "<p>This solution is probably among the worst pieces of C code out there, but it compiles without a warning. Please definitely make sure to read all comments made on your answer, and the info given in the answer by medalib and Andrea.\nMy code merely condenses all that into a chunk of stuff you can copy paste...</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\n// define it before you use it; a prototype would also have worked\nchar* getResources(){\n       char *str = (char *) malloc(sizeof(char) * 3);\n       // second param is size of input to be expected;\n       // you passed it the size of a pointer, which is most \n       // definitely not what you want\n       fgets(str, 3, stdin);      /* read in a line */\n       // return the pointer; str is already declared as a pointer,\n       // a further * will only de-reference that again\n       return str;\n }\n\nint main(){\n    char *c = getResources();\n    printf(\"%s\\n\", c);\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 1, "creation_date": 1525209054, "post_id": 50123804, "comment_id": 87265903, "body": "Never cast the return value from <code>malloc</code>. It&#39;s not necessary and it hides coding errors."}, {"owner": {"reputation": 827, "user_id": 7383242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c65444c41048c45464ae10a9cafa0c41?s=128&d=identicon&r=PG&f=1", "display_name": "medalib", "link": "https://stackoverflow.com/users/7383242/medalib"}, "edited": false, "score": 1, "creation_date": 1525209179, "post_id": 50123804, "comment_id": 87265945, "body": "It will be better if the type of <code>str_size</code> is <code>size_t</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1525209484, "post_id": 50123804, "comment_id": 87266051, "body": "<code>sizeof(char)</code> is <code>1</code> by definition, and a buffer size of <code>3</code> for user input is useless."}, {"owner": {"reputation": 901, "user_id": 1012950, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d0e314e13ea5b4d95f68a7772cec5feb?s=128&d=identicon&r=PG", "display_name": "Andrea Carron", "link": "https://stackoverflow.com/users/1012950/andrea-carron"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1525210090, "post_id": 50123804, "comment_id": 87266312, "body": "I changed the code according to your suggestions. @WeatherVane The length of the user input depends on what kind of input is expected. For example, it may need just the country code to get the correct resources, therefore 3 is the right length for &quot;it\\0&quot;, &quot;en\\n&quot;, &quot;fr\\0&quot; and so on."}], "tags": [], "owner": {"reputation": 901, "user_id": 1012950, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d0e314e13ea5b4d95f68a7772cec5feb?s=128&d=identicon&r=PG", "display_name": "Andrea Carron", "link": "https://stackoverflow.com/users/1012950/andrea-carron"}, "is_accepted": false, "score": 3, "last_activity_date": 1525210030, "last_edit_date": 1525210030, "creation_date": 1525208619, "answer_id": 50123804, "question_id": 50123551, "link": "https://stackoverflow.com/questions/50123551/trying-to-create-a-function-in-c-that-takes-in-user-input-and-returns-a-string-o/50123804#50123804", "title": "trying to create a function in c that takes in user input and returns a string of char", "body": "<p>There are many errors in your code.</p>\n\n<p>The first one is the return value of the <em>getResources()</em> function. You are returning the value pointed by (<em>*str</em>), which is a single char, but you want to return the whole array.\nTo fix it you should write <em>return str</em>.</p>\n\n<p>The second one is in the <em>sizeof()</em> operator, which is a compile-time operator. Since it is executed on compile time, it doesn't now the size of the char array malloc-ed at runtime, but only the size of the pointer itself.\nTherefore you can't use it this way, but you have to replace it with the actual size of the array.</p>\n\n<p>The third one is in the functions order. You can't use a function that wasn't previously declared. You can either move the full function above the main() or you can just declare it above the main() and leave the implementation behind it.</p>\n\n<p>Finally, the main() function should return an integer.</p>\n\n<p>Bonus tip: don't forget to free the malloc-ed pointer when you don't need it anymore</p>\n\n<p>The fixed code may be as follow:</p>\n\n<pre><code> char * getResources(){\n   size_t str_size = 3;\n   char *str = malloc(str_size);\n   fgets(str, str_size, stdin);      /* read in a line */\n   return str;\n }\n\n int main(){\n    char *c = getResources();\n    /* do something with c */\n    free(c);\n    return 0;\n }\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9727383, "user_type": "registered", "profile_image": "https://graph.facebook.com/1981914178803612/picture?type=large", "display_name": "Ethan", "link": "https://stackoverflow.com/users/9727383/ethan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "closed_date": 1525209709, "answer_count": 3, "score": -1, "last_activity_date": 1525210030, "creation_date": 1525207379, "last_edit_date": 1525207637, "question_id": 50123551, "link": "https://stackoverflow.com/questions/50123551/trying-to-create-a-function-in-c-that-takes-in-user-input-and-returns-a-string-o", "closed_reason": "Not suitable for this site", "title": "trying to create a function in c that takes in user input and returns a string of char", "body": "<p>No matter what I try I get an error. I'll remove the pointer, remove the malloc, I've tried reading in the user input in dfferent ways. I come form a java background and very confused on why none of this is working. Also I am not trying to return an array of strings i am just trying to return a string or a single array of chars in c</p>\n\n<pre><code> main(){\n        char *c = getResources();\n }\n\n char * getResources(){\n       char *str = (char *) malloc(sizeof(char) * 3);\n       fgets(str, sizeof(str), stdin);      /* read in a line */\n       return *str;\n }\n</code></pre>\n"}, {"tags": ["c", "assembly", "gdb"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1525207180, "post_id": 50123450, "comment_id": 87265107, "body": "Please post more detail in the question, which doesn&#39;t make much sense."}, {"owner": {"reputation": 179, "user_id": 8534332, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YxIW1AIdAIc/AAAAAAAAAAI/AAAAAAAAAEM/y3LbqaUJTxI/photo.jpg?sz=128", "display_name": "Alex Matt", "link": "https://stackoverflow.com/users/8534332/alex-matt"}, "edited": false, "score": 0, "creation_date": 1525207927, "post_id": 50123450, "comment_id": 87265437, "body": "I think i meant &quot;instructions&quot;, my terminology is not that good. Point is, the exercise I&#39;m doing says that I&#39;m supposed to use the &quot;x/??i *main&quot; command and then figure put how many instructions are on main"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1525208498, "post_id": 50123450, "comment_id": 87265690, "body": "Still no clearer than mud. Please ask a proper question."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1525208785, "post_id": 50123450, "comment_id": 87265795, "body": "Without a concrete example this question can&#39;t really be answered. Also what do you mean by &quot;how many instructions&quot;? As in how many execute during operation, or how many are in the code? An optimizing compiler might unroll loops for speed even if it seems like &quot;more instructions&quot;."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1525209173, "post_id": 50123450, "comment_id": 87265943, "body": "compile then disassemble and count manually.  understand that different compilers or different versions of the same compiler as well as compiler settings/options can/will give vastly different results while still providing functionally correct code.  (and as tadman pointed out are you asking about total number or a particular execution path or what?)"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1525209879, "post_id": 50123450, "comment_id": 87266224, "body": "@tadman: With the comment and edit, it is clear."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1525209886, "post_id": 50123450, "comment_id": 87266227, "body": "also understand that while assembly language tries to be one to one, it is not, in particular compilers generate a lot of extra directives and other communication with the assembler.  In gdb though this should be more of a disassembly than the compiled to assembly so that is a lot cleaner."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1525210432, "post_id": 50123450, "comment_id": 87266420, "body": "@EricPostpischil It&#39;s still vague to me, but I guess you&#39;ve got a handle on it."}], "answers": [{"comments": [{"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1525209995, "post_id": 50123999, "comment_id": 87266271, "body": "I dont think x86 was specified...good chance that it is though."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1525210028, "post_id": 50123999, "comment_id": 87266280, "body": "@old_timer: Hence the \u201cit may be something like\u2026\u201d"}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 1, "last_activity_date": 1525209994, "last_edit_date": 1525209994, "creation_date": 1525209644, "answer_id": 50123999, "question_id": 50123450, "link": "https://stackoverflow.com/questions/50123450/figure-out-number-of-commands-from-assembly-form/50123999#50123999", "title": "Figure out number of commands from assembly form", "body": "<p>In the debugger, type <code>x/10i main</code>. That shows the first ten instructions after the <code>main</code> entry point. (You can use a number other than ten, as you prefer.) Look for a return instruction. It may be something like <code>ret</code> or <code>retq</code>. If it does not appear in the first ten instructions, press return. (This repeats/continues the previous command, showing the next ten instructions. You an also type <code>x/10i</code> to continue from the current location.) When you see the return instruction, count the instructions from <code>main</code> to it.</p>\n\n<p>You can also compile to assembly with GCC\u2019s <code>-S</code> switch. This will produce a file containing assembly source, name <code>foo.s</code> if your source file was named <code>foo.c</code>. Then you can look at it in a text editor to count instructions from the <code>main:</code> label to the return. (This file may be cluttered with various other information\u2014labels with no instructions, comments inserts by the compiler for information/debugging purposes, special assembler directives that are not instructions, and so on, so counting instructions in it may be difficult if you are unfamiliar with which things are instructions and which are not. The debugger may be easier to use for this task since it shows raw instructions.)</p>\n\n<p>Technically, a function in C does not necessarily compile to a simple set of sequential instructions. The compiler may embed code from called functions into the calling function. It could, in theory, put the instructions for one function in multiple different places (although compilers tend not to do this, in my experience), with jumps between them. So counting instructions is not generally useful for more than simple classroom exercises and learning explorations.</p>\n"}], "owner": {"reputation": 179, "user_id": 8534332, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YxIW1AIdAIc/AAAAAAAAAAI/AAAAAAAAAEM/y3LbqaUJTxI/photo.jpg?sz=128", "display_name": "Alex Matt", "link": "https://stackoverflow.com/users/8534332/alex-matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1525209994, "creation_date": 1525206877, "last_edit_date": 1525207874, "question_id": 50123450, "link": "https://stackoverflow.com/questions/50123450/figure-out-number-of-commands-from-assembly-form", "title": "Figure out number of commands from assembly form", "body": "<p>I have a C file and i converted it into assembly form and i'd like to figure out how many instructions are on the main function using gdb and the assembly file. How can i do that?</p>\n"}, {"tags": ["c", "assembly"], "comments": [{"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 2, "creation_date": 1525206386, "post_id": 50123296, "comment_id": 87264757, "body": "compile with <code>-O2</code> and the assembly is <code>ret</code>."}, {"owner": {"reputation": 39, "user_id": 9593593, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ken44gGOC-o/AAAAAAAAAAI/AAAAAAAAAFc/LcVuPw22bnQ/photo.jpg?sz=128", "display_name": "ino", "link": "https://stackoverflow.com/users/9593593/ino"}, "reply_to_user": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1525206584, "post_id": 50123296, "comment_id": 87264851, "body": "@bolov: Thank you, and sorry for the possible duplication. As far as the compilation parameter is concerned, it does work. However, why doesn&#39;t the compiler do this by default? Are there any advantages/disadvantages?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1525206600, "post_id": 50123296, "comment_id": 87264860, "body": "Possibly optimisation never calls or codes a function that does nothing."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1525206729, "post_id": 50123296, "comment_id": 87264912, "body": "its a generic thing that not all compilers necessarily do.  prologue/epilogue or google stack frame, etc...how often are there functions with parameters vs functions without parameters?  or with or without local variables.  cheap and easy to just put that code in there and assume its there, later on if you optimize you add more work to your compiler to maybe take it out."}, {"owner": {"reputation": 39, "user_id": 9593593, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ken44gGOC-o/AAAAAAAAAAI/AAAAAAAAAFc/LcVuPw22bnQ/photo.jpg?sz=128", "display_name": "ino", "link": "https://stackoverflow.com/users/9593593/ino"}, "reply_to_user": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1525206750, "post_id": 50123296, "comment_id": 87264924, "body": "@old_timer: Would this mean that these assembly code operations (given above) are not optimized, and that they can slow down the program?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1525206850, "post_id": 50123296, "comment_id": 87264965, "body": "Of course unnecesssary code can slow down."}, {"owner": {"reputation": 39, "user_id": 9593593, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ken44gGOC-o/AAAAAAAAAAI/AAAAAAAAAFc/LcVuPw22bnQ/photo.jpg?sz=128", "display_name": "ino", "link": "https://stackoverflow.com/users/9593593/ino"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1525206905, "post_id": 50123296, "comment_id": 87264987, "body": "@WeatherVane: Okay, I understand. Thank you for your answer ;)"}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 0, "creation_date": 1525207075, "post_id": 50123296, "comment_id": 87265069, "body": "the advantage is, that you did ran the compiler with optimizer switched off, which makes the compilation process much faster. When you are developing C or C++ application, you often need to run new code quickly to debug it, and verify what it does, but you don&#39;t care about it&#39;s slower performance, plus the unoptimized code is easier to follow for debugger to allow &quot;per line&quot; debugging. In the optimized code the lines are often reordered or removed completely, so stepping over &quot;single line&quot; in optimized code often makes little sense."}, {"owner": {"reputation": 39, "user_id": 9593593, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ken44gGOC-o/AAAAAAAAAAI/AAAAAAAAAFc/LcVuPw22bnQ/photo.jpg?sz=128", "display_name": "ino", "link": "https://stackoverflow.com/users/9593593/ino"}, "reply_to_user": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 0, "creation_date": 1525207506, "post_id": 50123296, "comment_id": 87265245, "body": "@Ped7g: Thanks, that&#39;s exactly what I expected :)"}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1525208765, "post_id": 50123296, "comment_id": 87265788, "body": "unoptimized is the least risky and you will see some software standards where humans might be at risk, flight computers, cars, etc.  they may dictate no optimization.  it is easier or closer to possible to validate a compiler when you dont optimize.  but for the rest of us it has to do with training and habits, some folks IDEs just do it, some folks do it by habit, others never learned to and dont.  unoptimized has lots and lots of extra code in it variables are often kept in memory going back and forth rather than staying in a register."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1525208833, "post_id": 50123296, "comment_id": 87265815, "body": "does the function actually have anything to store or access on the stack is arguably an optimization.   so sure even this function with nothing going on, unoptimized could end up with some amount of generic framework code that most certainly burns execution time..."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1525219998, "post_id": 50123296, "comment_id": 87269001, "body": "A quick search on <i>function prologue</i> and <i>function epilogue</i> may be enlightening."}, {"owner": {"reputation": 39, "user_id": 9593593, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ken44gGOC-o/AAAAAAAAAAI/AAAAAAAAAFc/LcVuPw22bnQ/photo.jpg?sz=128", "display_name": "ino", "link": "https://stackoverflow.com/users/9593593/ino"}, "reply_to_user": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1525380621, "post_id": 50123296, "comment_id": 87345299, "body": "@old_timer: Would this mean that a sustained use of assembler variables (I&#39;m thinking <i>NASM variables</i>, example: <code>MyVar db &#39;hello&#39;</code>) would slow down the program? How can we do to get maximum and optimum optimization, while having a fast program in fact?"}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1525387465, "post_id": 50123296, "comment_id": 87347565, "body": "declaring a variable doesnt necessarily have a direct performance cost (there can be side effects), if you dont use the variable and simply declare it then there is no code to execute to deal with it so you dont burn that time."}, {"owner": {"reputation": 39, "user_id": 9593593, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ken44gGOC-o/AAAAAAAAAAI/AAAAAAAAAFc/LcVuPw22bnQ/photo.jpg?sz=128", "display_name": "ino", "link": "https://stackoverflow.com/users/9593593/ino"}, "reply_to_user": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1525505955, "post_id": 50123296, "comment_id": 87390614, "body": "@old_timer: thanks to you :D"}], "owner": {"reputation": 39, "user_id": 9593593, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ken44gGOC-o/AAAAAAAAAAI/AAAAAAAAAFc/LcVuPw22bnQ/photo.jpg?sz=128", "display_name": "ino", "link": "https://stackoverflow.com/users/9593593/ino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "closed_date": 1525207069, "answer_count": 0, "score": 0, "last_activity_date": 1525206156, "creation_date": 1525206156, "question_id": 50123296, "link": "https://stackoverflow.com/questions/50123296/why-do-all-c-functions-converted-to-assembler-start-and-end-with-some-identical", "closed_reason": "Duplicate", "title": "Why do all C functions converted to assembler start and end with some identical operations?", "body": "<p>When I compile a simple C code into assembler (x86-64 under gcc, but it doesn't matter), the labels corresponding to the C functions each have the same construction :</p>\n\n<pre><code>void foo() {\n\n}\n</code></pre>\n\n<p>Is compiled in :</p>\n\n<pre><code>foo:\n        push    rbp\n        mov     rbp, rsp\n        nop\n        pop     rbp\n        ret\n</code></pre>\n\n<p>Why? This function does nothing. I thought I understood that these assembler instructions are \"stack pointers\". But I still don't grasp their uses in the program. Could you explain that to me?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 6196, "user_id": 5822075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1ba9afcd0c36d9685e3e1b5f2f82be2?s=128&d=identicon&r=PG&f=1", "display_name": "e0k", "link": "https://stackoverflow.com/users/5822075/e0k"}, "edited": false, "score": 0, "creation_date": 1525203856, "post_id": 50122743, "comment_id": 87263617, "body": "Are you passing the matrices by value to your functions?"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1525203989, "post_id": 50122743, "comment_id": 87263668, "body": "In <code>criarMatrix</code>, the allocation loops aren&#39;t using <code>dY</code> and <code>dX</code> correctly. You allocate with <code>dX</code> and loop with <code>dY</code>. That code can only work if <code>dX</code> and <code>dY</code> are the same, i.e. a square matrix."}, {"owner": {"reputation": 27, "user_id": 9719535, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211659746110109/picture?type=large", "display_name": "Matheus Dias", "link": "https://stackoverflow.com/users/9719535/matheus-dias"}, "edited": false, "score": 0, "creation_date": 1525204622, "post_id": 50122743, "comment_id": 87263934, "body": "wait, how it is not correct?  Im allocating dX, than looping dY      mat.mat=(int**)malloc(mat.dX<i>sizeof(int</i>));         for (index=0;index&lt;mat.dY;index++)             mat.mat[index]=(int*)malloc(mat.dY*sizeof(int));"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1525207097, "post_id": 50122743, "comment_id": 87265077, "body": "For example, let&#39;s say <code>dX</code> is 3 and <code>dY</code> is 500. So the first <code>malloc</code> allocates memory for 3 pointers. And then the <code>for</code> loop goes from 0 to 499, creating 500 pointers to put in that memory."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 4810256, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c44eaa53b3749afbe3edee6f7978c317?s=128&d=identicon&r=PG&f=1", "display_name": "Thyaga", "link": "https://stackoverflow.com/users/4810256/thyaga"}, "is_accepted": false, "score": 1, "last_activity_date": 1525204868, "creation_date": 1525204868, "answer_id": 50123024, "question_id": 50122743, "link": "https://stackoverflow.com/questions/50122743/allocated-memory-for-a-matrix-cant-be-filled-for-some-specific-values/50123024#50123024", "title": "Allocated memory for a matrix can&#39;t be filled for some specific values", "body": "<p>This line <code>for (index=0;index&lt;mat.dY;index++)</code> after the 1st <code>malloc</code> should have <code>index &lt; mat.dX</code>.</p>\n\n<p>You have allocated the 1st dimension with <code>dX</code>, so the loop for the 2nd dimension should run from <code>0..dX-1</code></p>\n"}], "owner": {"reputation": 27, "user_id": 9719535, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211659746110109/picture?type=large", "display_name": "Matheus Dias", "link": "https://stackoverflow.com/users/9719535/matheus-dias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1525204868, "creation_date": 1525203580, "question_id": 50122743, "link": "https://stackoverflow.com/questions/50122743/allocated-memory-for-a-matrix-cant-be-filled-for-some-specific-values", "title": "Allocated memory for a matrix can&#39;t be filled for some specific values", "body": "<p>So i made this program, where it crates 2 matrixes(m1**,m2**), than multiple them.\nBut it randomly crashes with some values (exemples: m1[2][1], m2[2][1]; \nm1[4]m2[3], in this last instance it breakes before i choocle m2 values).\nI know the problem happens after allocating memory, so it might be when the matrixes are being filled (preencherMatrix funtion).\nI don't know why, could you help me?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n\ntypedef struct\n{\n    int dX,dY;\n    int** mat;\n} MATRIX;\n\nMATRIX criarMatrix (MATRIX mat)\n{\n    int aux;\n\n    printf(\"MATRIX \\n\");\n    printf(\"Dimensao X: \\n\");\n    scanf(\"%d\",&amp;aux);\n    mat.dX=aux;\n    printf(\"Dimensao Y: \\n\");\n    scanf(\"%d\",&amp;aux);\n    mat.dY=(int)aux;\n\n    int index;\n\n    mat.mat=(int**)malloc(mat.dX*sizeof(int*));\n        for (index=0;index&lt;mat.dY;index++)\n            mat.mat[index]=(int*)malloc(mat.dY*sizeof(int));\n\n    return(mat);\n}\n\nMATRIX preencherMatrix (MATRIX mat)\n{\n    int x,y;\n\n    for(x=0;x&lt;mat.dX;x++)\n    {\n        for(y=0;y&lt;mat.dY;y++)\n        {\n            mat.mat[x][y]=rand()%11;\n        }\n    }\n    return(mat);\n}\n\nvoid printMatrix (MATRIX mat)\n{\n    int x,y;\n\n    printf(\"\\n................... \\n\");\n    for(x=0;x&lt;mat.dX;x++)\n    {\n        for(y=0;y&lt;mat.dY;y++)\n        {\n            printf(\"%d \",mat.mat[x][y]);\n        }\n    printf(\"\\n\");\n    }\n    printf(\"................... \\n\");\n}\n\nMATRIX multiplicaMatrix (MATRIX m1, MATRIX m2)\n{\n    int x,y,i,j;\n\n    x=m1.dX;\n    y=m2.dY;\n\n    for(i=0;i&lt;x;i++)\n    {\n        for(j=0;j&lt;y;j++)\n        {\n            m1.mat[i][j]=m1.mat[i][j]*m2.mat[j][i];\n        }\n    }\n    return(m1);\n}\n\nvoid main ()\n{\n    srand(time(NULL));\n\n    MATRIX m1;\n    MATRIX m2;\n\n    m1=criarMatrix(m1);\n    m1=preencherMatrix(m1);\n    printMatrix(m1);\n\n    m2=criarMatrix(m2);\n    m2=preencherMatrix(m2);\n    printMatrix(m2);\n\n    if (m1.dX!=m2.dY)\n    {\n        printf(\"Numero de colunas de M1 e diferente do numero de filas de M2\\n \\n\");\n        return(-1);\n    }\n\n    m1=multiplicaMatrix(m1,m2);\n    printMatrix(m1);\n}\n</code></pre>\n"}, {"tags": ["c", "macros", "goto"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1525205041, "post_id": 50122630, "comment_id": 87264123, "body": "What is the difference between &quot;goto a central error-processing label: error&quot; and &quot;call an error processing function&quot;? What is the reason for using a method which I consider extinct with C64 basic? What forces you to do it this way?"}, {"owner": {"reputation": 151, "user_id": 7666730, "user_type": "registered", "profile_image": "https://graph.facebook.com/1252417574793743/picture?type=large", "display_name": "Andreas Otto", "link": "https://stackoverflow.com/users/7666730/andreas-otto"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1525241645, "post_id": 50122630, "comment_id": 87274076, "body": "@Yunnosch 1. if u use a error-processing-function <code>epf</code> you end up in the same problem as above just replace &quot;goto label&quot; with <code>return epf(\u2026)</code>\u2026 2. BUT the <code>epf</code> has NO access to the variables in the context &gt; this mean you have ti write a &quot;specific&quot; <code>epf</code>-call for every &quot;usage&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1525212340, "post_id": 50122855, "comment_id": 87267123, "body": "When you start <i>brace wrapping</i> macros -- it&#39;s time to rewrite the macro as a function... This is non-portable and your compiler should warn that you are using an extension."}, {"owner": {"reputation": 21663, "user_id": 9305398, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cqJvE.png?s=128&g=1", "display_name": "Acorn", "link": "https://stackoverflow.com/users/9305398/acorn"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1525212947, "post_id": 50122855, "comment_id": 87267285, "body": "@DavidC.Rankin: it is not possible to write it as a function if you want to jump to a label (6.8.6.1.1); and OP said it wasn&#39;t possible to use <code>setjump</code>/<code>longjmp</code>. As for being portable, in practice it is so since it is supported by the 3 major compilers."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1525215399, "post_id": 50122855, "comment_id": 87268001, "body": "Not saying you can&#39;t use it, obviously it was created as an extension to serve just the purpose you are putting it to. What I&#39;m saying is given the option of a function or brace-enclosed macro -- go with the function. You eliminate all portability issues and pitfalls associated with macro use. It is convenient as hell to use, but you end up re-writing lots of code if you need to compile on windoze."}, {"owner": {"reputation": 21663, "user_id": 9305398, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cqJvE.png?s=128&g=1", "display_name": "Acorn", "link": "https://stackoverflow.com/users/9305398/acorn"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1525274298, "post_id": 50122855, "comment_id": 87294481, "body": "@DavidC.Rankin: I guess you are referring to MSVC -- you could always use the other compilers in that case. And, <i>technically</i>, MSVC is not a C compiler anyway so we could just ignore it in questions tagged as C. :)"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1525284951, "post_id": 50122855, "comment_id": 87300367, "body": "I was talking about the VS compiler <code>cl.exe</code>."}], "tags": [], "owner": {"reputation": 21663, "user_id": 9305398, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cqJvE.png?s=128&g=1", "display_name": "Acorn", "link": "https://stackoverflow.com/users/9305398/acorn"}, "is_accepted": false, "score": 2, "last_activity_date": 1525204519, "last_edit_date": 1525204519, "creation_date": 1525204099, "answer_id": 50122855, "question_id": 50122630, "link": "https://stackoverflow.com/questions/50122630/how-to-jump-to-label-inside-a-macro-function-that-returns-a-value/50122855#50122855", "title": "How to jump to label inside a macro/function that returns a value", "body": "<p>If you are able to use the <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Statement-Exprs.html\" rel=\"nofollow noreferrer\">GNU statement expression extension</a> (supported in gcc, clang and icc), it is pretty straightforward:</p>\n\n<pre><code>#define ReadI_something(ctx) \\\n    ({ \\\n        int i; \\\n        if (ReadI(ctx, &amp;i) == ERROR) \\\n            goto error; \\\n        i; \\\n    })\n</code></pre>\n\n<p>Then you can do:</p>\n\n<pre><code>int i = ReadI_something(ctx);\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 7666730, "user_type": "registered", "profile_image": "https://graph.facebook.com/1252417574793743/picture?type=large", "display_name": "Andreas Otto", "link": "https://stackoverflow.com/users/7666730/andreas-otto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 276, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1525240459, "creation_date": 1525203050, "last_edit_date": 1525240459, "question_id": 50122630, "link": "https://stackoverflow.com/questions/50122630/how-to-jump-to-label-inside-a-macro-function-that-returns-a-value", "title": "How to jump to label inside a macro/function that returns a value", "body": "<p>I have the following function:</p>\n\n<pre><code>enum MqErrorE ReadI(struct MqS* ctx, int *i);\n</code></pre>\n\n<p>The function stores a result in <code>i</code> and returns <code>OK</code> or <code>ERROR</code> flag.</p>\n\n<p>If the function returns <code>ERROR</code>, I want to jump to a label called <code>error</code>.</p>\n\n<pre><code>int i; \nif (ReadI(ctx,&amp;i) == ERROR)\n    goto error; \n// ...\nerror:\n    // do some error processing\n</code></pre>\n\n<p>To make the code more \"user-friendly\" I would like to do something like:</p>\n\n<pre><code>int i; \ni = ReadI_something(ctx); // on error jump to \"label\" \n// ... \nerror: \n    //... \n</code></pre>\n\n<p>In other words, I need <code>ReadI_something</code> to return a value but also to be able to jump to the label.</p>\n\n<p>As a restriction I want to avoid using <code>longjmp</code>/<code>setjmp</code>.</p>\n\n<p>How can I write a macro or function to do so?</p>\n"}]