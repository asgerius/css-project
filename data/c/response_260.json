[{"tags": ["c", "linux", "memory-management", "memory-leaks"], "answers": [{"tags": [], "owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "is_accepted": false, "score": 5, "last_activity_date": 1577832190, "creation_date": 1577832190, "answer_id": 59548925, "question_id": 59548890, "link": "https://stackoverflow.com/questions/59548890/why-doesnt-kernel-clear-the-memory-allocated-by-second-malloc-in-a-process/59548925#59548925", "title": "Why doesn&#39;t kernel clear the memory allocated by second malloc in a process?", "body": "<p>Getting a chunk of memory from the OS for your memory pool and reusing memory already in your memory pool are two different things. </p>\n\n<p>The OS may zero the memory when you first get it but it is up to the \"malloc\" implementation whether it zeros memory (either on free or malloc).</p>\n"}, {"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 2, "last_activity_date": 1577834286, "creation_date": 1577834286, "answer_id": 59549081, "question_id": 59548890, "link": "https://stackoverflow.com/questions/59548890/why-doesnt-kernel-clear-the-memory-allocated-by-second-malloc-in-a-process/59549081#59549081", "title": "Why doesn&#39;t kernel clear the memory allocated by second malloc in a process?", "body": "<p>The answer to <em>\"how does the kernel know that the memory is first assigned to a process\"</em> is that the process (via the C library) makes a request to the kernel to allocate it some memory, so the kernel knows that the memory should not reveal its previous contents (and zeroing the allocated memory is one way of ensuring that information does not leak between processes). </p>\n\n<p>The answer to <em>\"how does the kernel know that the memory is reassigned \u2026\"</em> is \"it doesn't\" \u2014 that information is private to the process and the kernel has no knowledge of what the process does to reuse the memory.</p>\n"}], "owner": {"reputation": 51, "user_id": 12633987, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAYQy7CjRNLDm2rVxIUDmBsaM39jknVbd42bqY=k-s128", "display_name": "Zhi", "link": "https://stackoverflow.com/users/12633987/zhi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1577834286, "creation_date": 1577831762, "last_edit_date": 1577834017, "question_id": 59548890, "link": "https://stackoverflow.com/questions/59548890/why-doesnt-kernel-clear-the-memory-allocated-by-second-malloc-in-a-process", "title": "Why doesn&#39;t kernel clear the memory allocated by second malloc in a process?", "body": "<p>Follow these two questions:</p>\n\n<ol>\n<li><p><a href=\"https://stackoverflow.com/questions/6004816/\">Kernel zeroes memory?</a></p></li>\n<li><p><a href=\"https://unix.stackexchange.com/questions/509232/\">If the heap is zero-initialized for security then why is the stack merely uninitialized?</a></p></li>\n</ol>\n\n<pre><code>#include &lt;stddef.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nconst size_t n = 4;\nconst size_t m = 0x10;\n\nint main()\n{\n        int *p = malloc(m*sizeof(int));\n        printf(\"%p \", p);\n        for (size_t i = 0; i &lt; m; ++i) {\n            printf(\"%d\", p[i]);\n        }\n        printf(\"\\n\");\n\n        memset(p,9,m*sizeof(int));\n        free(p);\n\n        int *v = malloc(m*sizeof(int));\n        printf(\"%p \", v);\n        for (size_t j = 0; j &lt; m; ++j) {\n            printf(\"%x\", v[j]);\n        }\n\n        printf(\"\\n\");\n        return 0;\n}\n</code></pre>\n\n<p>OUTPUT:</p>\n\n<pre><code>0xaaaae7082260 0000000000000000\n0xaaaae7082260 0090909099090909909090990909099090909909090990909099090909909090990909099090909909090990909099090909\n</code></pre>\n\n<p>I have a question: In a process, the assigned memory by <code>malloc</code> is set 0 when first using <code>malloc</code>. But reusing <code>malloc</code> to allocate a new memory after <code>free</code> the first assigned memory, the new memory has the same virtual address and same content with the first memory.</p>\n\n<p>My question: How does the kernel know that the memory is first assigned to a process and is needed to be set zero?</p>\n\n<p>And how does the kernel know that the memory is reassigned to the same process and doesn't need to be cleared?</p>\n"}, {"tags": ["c", "sorting", "readdir", "partial-ordering"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1577839735, "post_id": 59548856, "comment_id": 105267828, "body": "On a POSIX system, you can also use <a href=\"https://pubs.opengroup.org/onlinepubs/9699919799/functions/nftw.html\" rel=\"nofollow noreferrer\"><code>nftw()</code> to walk a directory tree</a>."}], "answers": [{"comments": [{"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 2, "creation_date": 1577835427, "post_id": 59548885, "comment_id": 105267366, "body": "Regarding option 2, <code>seekdir</code> and <code>rewinddir</code> exist, so they might be a touch faster and [may?] be more robust if there are active insertions/deletions [by another process] in the directories (e.g. more likely to get an atomic view)"}, {"owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "reply_to_user": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1577837253, "post_id": 59548885, "comment_id": 105267574, "body": "@CraigEstey: Indeed, better to rewind that re-open."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1577839778, "post_id": 59548885, "comment_id": 105267834, "body": "Third option on a POSIX system:  <code>nftw()</code>."}], "tags": [], "owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "is_accepted": true, "score": 5, "last_activity_date": 1577837287, "last_edit_date": 1577837287, "creation_date": 1577831693, "answer_id": 59548885, "question_id": 59548856, "link": "https://stackoverflow.com/questions/59548856/readdir-in-a-sequential-behavior/59548885#59548885", "title": "Readdir() in a sequential behavior", "body": "<p>I'd say you have two options:</p>\n\n<ol>\n<li>Insert all of the <code>readdir()</code> results into a sorted data structure (or just put them in some array and sort it). And - I mean sorted in the sense of \"file &lt; directory and no other order\".</li>\n<li>Read all of the entries <em>twice</em> - once, ignore all the subdirectories and print just the files; then use <code>rewinddir()</code>, then read all of the entries again, ignoring all of the regular files and only printing the subdirectories.</li>\n</ol>\n\n<p>Option 2 is probably simpler - but with more library calls and system calls.</p>\n"}], "owner": {"reputation": 57, "user_id": 4484281, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/kOJHV.jpg?s=128&g=1", "display_name": "nullptr", "link": "https://stackoverflow.com/users/4484281/nullptr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 59548885, "answer_count": 1, "score": 2, "last_activity_date": 1577837287, "creation_date": 1577831390, "last_edit_date": 1577833570, "question_id": 59548856, "link": "https://stackoverflow.com/questions/59548856/readdir-in-a-sequential-behavior", "title": "Readdir() in a sequential behavior", "body": "<pre><code>int indent = 0;\nint listDir(const char* dirname){\n    DIR* dir;\n    struct dirent* d;\n    if(!(dir = opendir(dirname)))\n        return -1;\n    while((d = readdir(dir)) != NULL){\n        if(strcmp(d-&gt;d_name, \".\") == 0 || strcmp(d-&gt;d_name, \"..\") == 0 ){\n            continue;\n        }\n        else if(d-&gt;d_type != DT_DIR){ // Any except folders.\n            printf(\"%*s- %s:%ld\\n\", indent, \"\", d-&gt;d_name, d-&gt;d_ino);\n        }\n        else if(d-&gt;d_type == DT_DIR){ // Folders only\n            printf(\"%*s[%s]\\n\", indent, \"\", d-&gt;d_name);\n            char path[1024];\n            snprintf(path, sizeof(path), \"%s/%s\", dirname, d-&gt;d_name);\n            indent +=2;\n            listDir(path);\n            indent -=2;\n        }\n</code></pre>\n\n<p>This function works just fine, but the only thing is that it outputs the following result as an example: \n<a href=\"https://i.stack.imgur.com/0sW0C.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0sW0C.png\" alt=\"Output of the above function\"></a></p>\n\n<p>I need the output to be the container folder, files and then folders. The folders should be at the end of the list. For example, the above output should be:</p>\n\n<p><a href=\"https://i.stack.imgur.com/znm5C.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/znm5C.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2704, "user_id": 193772, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c7998bc97debca020f3296ffa3e259f4?s=128&d=identicon&r=PG", "display_name": "twodayslate", "link": "https://stackoverflow.com/users/193772/twodayslate"}, "edited": false, "score": 2, "creation_date": 1577829181, "post_id": 59548672, "comment_id": 105266383, "body": "<code>sizeof(a)</code> returns the size of a pointer, not the size of the allocated memory"}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1577829217, "post_id": 59548672, "comment_id": 105266385, "body": "<code>a</code> is a pointer, <code>sizeof(a)</code> is the size of a pointer (to int), <code>sizeof(a[0])</code> is the size of an <code>int</code>. Compare with <code>int a[4]; sizeof a &#47; sizeof *a;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "is_accepted": false, "score": 1, "last_activity_date": 1577829176, "creation_date": 1577829176, "answer_id": 59548689, "question_id": 59548672, "link": "https://stackoverflow.com/questions/59548672/unexpected-value-returned-from-sizeof/59548689#59548689", "title": "Unexpected value returned from sizeof", "body": "<p>You are thinking that <code>a</code> is an array of 4 elements.<br>\nBut it is not.  It is a pointer.</p>\n\n<p>I'm deducing that your system is a 64-bit system with 8-byte pointers.</p>\n\n<p>So <code>sizeof(a)</code> is 8.  And <code>sizeof(a[0])</code> is <code>sizeof(int)</code> is 4 bytes.</p>\n\n<p>So the expression becomes <code>8/4 == 2</code>.</p>\n\n<hr>\n\n<p>If you had declared <code>a</code> as <code>int a[4];</code>\nThen you would indeed get 4 for a result.</p>\n"}, {"tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": true, "score": 2, "last_activity_date": 1577829191, "creation_date": 1577829191, "answer_id": 59548690, "question_id": 59548672, "link": "https://stackoverflow.com/questions/59548672/unexpected-value-returned-from-sizeof/59548690#59548690", "title": "Unexpected value returned from sizeof", "body": "<p><code>sizeof</code> is not a magical \"how much space did I <code>malloc</code> into this pointer\" function. The idiom you're using only works with real arrays, not pointers being dereferenced as arrays. Here, it means <code>sizeof(int*)/sizeof(int)</code>, which is clearly not useful.</p>\n"}], "owner": {"reputation": 791, "user_id": 9105207, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BiyPF.png?s=128&g=1", "display_name": "Tal Rofe", "link": "https://stackoverflow.com/users/9105207/tal-rofe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "closed_date": 1577829252, "accepted_answer_id": 59548690, "answer_count": 2, "score": -3, "last_activity_date": 1578259599, "creation_date": 1577828993, "last_edit_date": 1578259599, "question_id": 59548672, "link": "https://stackoverflow.com/questions/59548672/unexpected-value-returned-from-sizeof", "closed_reason": "Duplicate", "title": "Unexpected value returned from sizeof", "body": "<p>I allocate an array <code>a</code> 4 blocks (each is of size <code>sizeof(int)</code>). Then I try to print the length of the array with the following code: </p>\n\n<pre><code>int main() {\n    int *a = malloc(4 * sizeof(int));\n    printf(\"%d\", sizeof(a)/sizeof(a[0]));\n    return 0;\n}\n</code></pre>\n\n<p>Once I run this code, it prints <code>2</code>, although I expected <code>4</code>. Why is it?</p>\n"}, {"tags": ["c", "sqlite", "input"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1577837090, "post_id": 59548475, "comment_id": 105267554, "body": "<code>long</code> and <code>long double</code> are <i>binary</i> floating point types.  &quot;limit the number to only have two <i>decimals</i>&quot; is not a property of those types."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1577837142, "post_id": 59548475, "comment_id": 105267561, "body": "Is that truly 23.3 and not 23.4 in the example that made 23.3999615?"}, {"owner": {"reputation": 59, "user_id": 11736350, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5UHJhM9WtdY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc2aLxWXcd6OJhtINbaKy89-So2ug/photo.jpg?sz=128", "display_name": "MaG", "link": "https://stackoverflow.com/users/11736350/mag"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1577841646, "post_id": 59548475, "comment_id": 105268048, "body": "@chux-ReinstateMonica I understand, but can&#39;t find any other function for particularly float binding"}, {"owner": {"reputation": 59, "user_id": 11736350, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5UHJhM9WtdY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc2aLxWXcd6OJhtINbaKy89-So2ug/photo.jpg?sz=128", "display_name": "MaG", "link": "https://stackoverflow.com/users/11736350/mag"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1577841704, "post_id": 59548475, "comment_id": 105268052, "body": "@chux-ReinstateMonica as far as I remember it was 23.3, I didn&#39;t save the input anywhere so might be mistaken"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 1, "creation_date": 1577844373, "post_id": 59548475, "comment_id": 105268297, "body": "The closest ieee754 double to 23.4 is 23.3999996185302734375, which is what sqlite would store internally. So if you meant 23.4 and not 23.3, that result makes sense. See <a href=\"https://stackoverflow.com/questions/588004/is-floating-point-math-broken\">Is Floating Point Math Broken?</a>"}, {"owner": {"reputation": 59, "user_id": 11736350, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5UHJhM9WtdY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc2aLxWXcd6OJhtINbaKy89-So2ug/photo.jpg?sz=128", "display_name": "MaG", "link": "https://stackoverflow.com/users/11736350/mag"}, "reply_to_user": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1577908116, "post_id": 59548475, "comment_id": 105279696, "body": "@Shawn yes, but it&#39;s not the point of my question... I want to store number with two decimals only, but couldn&#39;t find any other way rather than using bind_double"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1577925998, "post_id": 59548475, "comment_id": 105282902, "body": "Just round it to the desired precision when formatting as a string for display?"}], "owner": {"reputation": 59, "user_id": 11736350, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5UHJhM9WtdY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc2aLxWXcd6OJhtINbaKy89-So2ug/photo.jpg?sz=128", "display_name": "MaG", "link": "https://stackoverflow.com/users/11736350/mag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1577826718, "creation_date": 1577826718, "question_id": 59548475, "link": "https://stackoverflow.com/questions/59548475/how-to-bind-a-float-value-in-a-sqlite3-database", "title": "How to bind a float value in a sqlite3 database?", "body": "<p>I need to insert a float value that I get from the user to the sqlite3 database. For this, I am using <strong>sqlite3_bind_double()</strong> function.\nThe problem is that even if I enter a value of 23.3 in the database I still get a long double as 23.3999615.\nHow can I limit the number to only have two decimals to be stored in the database?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 2, "creation_date": 1577826253, "post_id": 59548418, "comment_id": 105265870, "body": "<code>count_grd</code> is a local variable. Setting it does not change the value of <code>c</code> in the caller. Need to pass in a pointer to the pointer if you want to change it inside the function."}, {"owner": {"reputation": 791, "user_id": 9105207, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BiyPF.png?s=128&g=1", "display_name": "Tal Rofe", "link": "https://stackoverflow.com/users/9105207/tal-rofe"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1577826507, "post_id": 59548418, "comment_id": 105265921, "body": "@kaylum So I should change it to <code>int** count_grd</code>? What if I&#39;m forbidden to change it?"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1577826703, "post_id": 59548418, "comment_id": 105265954, "body": "Yes. But I don&#39;t know what you mean by &quot;forbidden to change it&quot;. An alternative is to have <code>main</code> define the array instead of allocating inside the function. But not sure if that meets your needs."}, {"owner": {"reputation": 791, "user_id": 9105207, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BiyPF.png?s=128&g=1", "display_name": "Tal Rofe", "link": "https://stackoverflow.com/users/9105207/tal-rofe"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1577826901, "post_id": 59548418, "comment_id": 105265995, "body": "@kaylum I need to implement the <code>GradeStat</code> function as given (cannot change the parameters). My <code>main</code> function is only for testing my implementation.."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1577827042, "post_id": 59548418, "comment_id": 105266018, "body": "Then I guess they are expecting you to pass in an array instead of allocating it in <code>GradeStat</code> as I stated. That&#39;s a requirements issue and you may need to clarify with your teaching staff if unsure."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1577828282, "post_id": 59548418, "comment_id": 105266224, "body": "<code>a</code> is declared <code>int</code>, but it&#39;s being passed to an <code>int*</code> argument. You need to declare <code>a</code> as an array in <code>main()</code> just like <code>c</code>."}, {"owner": {"reputation": 791, "user_id": 9105207, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BiyPF.png?s=128&g=1", "display_name": "Tal Rofe", "link": "https://stackoverflow.com/users/9105207/tal-rofe"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1577828435, "post_id": 59548418, "comment_id": 105266254, "body": "@Barmar Thanks. I guess the correct format is to write <code>int *x</code> and not <code>int* x</code>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1577828598, "post_id": 59548418, "comment_id": 105266282, "body": "@TalRofe Yes, it&#39;s a common beginner error to think that <code>int* c,a;</code> means <code>int *c; int *a;</code>. The spacing is not significant in the language, but writing it that way will make it clearer to human readers."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1577829997, "post_id": 59548418, "comment_id": 105266529, "body": "regarding: <code>int** temp = malloc(len * sizeof(int*));</code>  This creates an array of pointers to pointers, however, where all those pointers are pointed to is never set to any specific value.  Suggest each entry be set via a call to <code>malloc()</code>."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1577831947, "post_id": 59548418, "comment_id": 105266866, "body": "@Barmar,  The kind of problem you have pointed out is why the axiom: <i>only one statement per line and (at most) one variable declaration per statement.</i> should be followed"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1577832063, "post_id": 59548418, "comment_id": 105266882, "body": "Regarding the comment: <i>Thanks. I guess the correct format is to write int *x and not int</i> x*  It makes absolutely no difference if the <code>*</code> is to the left, the right, or in the middle,"}, {"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 1, "creation_date": 1577832213, "post_id": 59548418, "comment_id": 105266909, "body": "When one can&#39;t explain in a one-line comment what the allocation scheme is, it&#39;s time (for your teacher) to re-think the prototype of the function."}], "owner": {"reputation": 791, "user_id": 9105207, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BiyPF.png?s=128&g=1", "display_name": "Tal Rofe", "link": "https://stackoverflow.com/users/9105207/tal-rofe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 1, "closed_date": 1577840157, "answer_count": 0, "score": 1, "last_activity_date": 1577831212, "creation_date": 1577826098, "question_id": 59548418, "link": "https://stackoverflow.com/questions/59548418/failing-to-test-a-function-in-main", "closed_reason": "Duplicate", "title": "Failing to test a function in main", "body": "<p>I try to test my GradeStat function, but it fails in main in the highlighted line: <code>printf(\"%d\", c[0]);</code>.. It gives me ERROR: <code>segmentation fault</code> but I can't tell why..</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint** GradeStat(int* Grades, int size_grades, int grd_range, int* count_grd, int* avg_grd) {\n    const int len = 100/grd_range+1;\n    int** collector = malloc(len * sizeof(int*));\n    count_grd = calloc(len, sizeof(int));\n    avg_grd = calloc(len, sizeof(int));\n    size_t i;\n    for(i=0; i&lt;size_grades; i++)\n        count_grd[Grades[i]/grd_range]++;\n    for(i=0; i&lt;len; i++) {\n        if (count_grd[i] == 0)\n            collector[i] = NULL;\n        else\n            collector[i] = malloc(count_grd[i] * sizeof(int));\n    }\n    int** temp = malloc(len * sizeof(int*));\n    for(i=0; i&lt;len; i++) {\n        temp[i] = collector[i];\n    }\n    for(i=0; i&lt;size_grades; i++) {\n        *(collector[Grades[i]/grd_range]++) = Grades[i];\n        avg_grd[Grades[i]/grd_range] += Grades[i]/count_grd[Grades[i]/grd_range];\n    }\n    for(i=0; i&lt;len; i++) {\n        collector[i] = temp[i];\n    }\n    free(temp);\n    return collector;\n}\n\nint main() {\n    int** arr;\n    int grd[8] = {10, 43, 46, 49, 80, 60, 98, 100};\n    int* c,a;\n    arr = GradeStat(grd, 8, 10, c, a);\n    ------&gt;  printf(\"%d\", c[0]);  &lt;-------\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "asynchronous", "pipe", "epoll"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1577825113, "post_id": 59548278, "comment_id": 105265673, "body": "Welcome to Stackoverflow. Please show the actual code as a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal verifiable example</a>. English language is imprecise so it is necessary to show the code to make things clear."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1577825550, "post_id": 59548278, "comment_id": 105265750, "body": "Fork and popen is a heavyweight operation for handling one connection."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1577826059, "post_id": 59548278, "comment_id": 105265835, "body": "You don&#39;t need to use AIO, just set the pipe to non-blocking mode if you don&#39;t want to block in <code>read()</code>."}, {"owner": {"reputation": 5, "user_id": 10823279, "user_type": "registered", "profile_image": "https://graph.facebook.com/1936405333081353/picture?type=large", "display_name": "Radu Ni\u0163escu", "link": "https://stackoverflow.com/users/10823279/radu-ni%c5%a3escu"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1577827010, "post_id": 59548278, "comment_id": 105266011, "body": "@Barmar Setting it to non blocking seems to have solved the problem. Now I have to investigate why this is actually happening but for the moment that seems to be the solution. Thank you!"}], "owner": {"reputation": 5, "user_id": 10823279, "user_type": "registered", "profile_image": "https://graph.facebook.com/1936405333081353/picture?type=large", "display_name": "Radu Ni\u0163escu", "link": "https://stackoverflow.com/users/10823279/radu-ni%c5%a3escu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1577825002, "creation_date": 1577824674, "last_edit_date": 1577825002, "question_id": 59548278, "link": "https://stackoverflow.com/questions/59548278/reading-pipe-in-c-with-libaio", "title": "Reading pipe in C with libaio", "body": "<p>I am trying to create a web server in C that uses epoll for multiplexing IO. I was trying to make it capable of generating PHP pages. </p>\n\n<p>What I did: For each connection I read the path, created unnamed pipe, called forked then I redirected the output of the child process to the pipe and used <code>execvp(\"php\", (char *const *) argv);</code>. In the parent process I added the pipe to epoll with EPOLLIN and then I wait for it in the main loop. When it was signaled I used <code>io_prep_pread</code> from libaio to read asynchronously, and then when the read part is finished I would send the buffer to the client.</p>\n\n<p>The problem is the right result is outputted like 5-10% of the time. Is the logic I presented correct or should I wait for the child process to send <code>SIGCHLD</code> and then start reading the pipe?</p>\n"}, {"tags": ["c", "compilation", "stack"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1577824588, "post_id": 59548259, "comment_id": 105265564, "body": "<code>scanf(&quot;%d&quot;, size):</code> ==&gt; <code>scanf(&quot;%d&quot;, &amp;size);</code>"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 1, "creation_date": 1577824625, "post_id": 59548259, "comment_id": 105265568, "body": "VLAs, <code>alloca</code>, assembly code that modifies the stack pointer."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1577824651, "post_id": 59548259, "comment_id": 105265575, "body": "Are you talking about the size of a specific stack frame, or the whole stack?"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 4, "creation_date": 1577824688, "post_id": 59548259, "comment_id": 105265585, "body": "Each function call requires certain stack use. Now think about whether it is possible to know at compile time how many times every function will be called and how deep every call stack is. It is not possible because some inputs are not known until runtime."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1577824749, "post_id": 59548259, "comment_id": 105265597, "body": "...it may be impossible for the compiler to know how many times a recursive function will be called."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 2, "creation_date": 1577868029, "post_id": 59548259, "comment_id": 105270846, "body": ".....external library and system calls....."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1577868145, "post_id": 59548259, "comment_id": 105270874, "body": "...multiple stacks...."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 2, "creation_date": 1577868266, "post_id": 59548259, "comment_id": 105270894, "body": "...interrupts and callbacks...."}], "answers": [{"comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 2, "creation_date": 1577824894, "post_id": 59548294, "comment_id": 105265614, "body": "That&#39;s true and a good point. But there are also other (arguably stronger) reasons such as exact function calls being unknown until runtime."}, {"owner": {"user_type": "does_not_exist", "display_name": "user12633902"}, "edited": false, "score": 0, "creation_date": 1577824958, "post_id": 59548294, "comment_id": 105265631, "body": "ye but doesn&#39;t the compiler know the value of <code>n</code>?"}, {"owner": {"reputation": 11893, "user_id": 12098405, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C7IUyuZ5qqE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rehqQyGdh463Xz2DY8S4TYPhnDvzA/photo.jpg?sz=128", "display_name": "dash-o", "link": "https://stackoverflow.com/users/12098405/dash-o"}, "edited": false, "score": 0, "creation_date": 1577825074, "post_id": 59548294, "comment_id": 105265657, "body": "@josh If &#39;n&#39; is read from the outsize (scanf, ...) the compiler will not know the size of N."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1577825092, "post_id": 59548294, "comment_id": 105265666, "body": "@Josh The compiler is not that smart."}], "tags": [], "owner": {"reputation": 11893, "user_id": 12098405, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C7IUyuZ5qqE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rehqQyGdh463Xz2DY8S4TYPhnDvzA/photo.jpg?sz=128", "display_name": "dash-o", "link": "https://stackoverflow.com/users/12098405/dash-o"}, "is_accepted": false, "score": 1, "last_activity_date": 1577825130, "last_edit_date": 1577825130, "creation_date": 1577824808, "answer_id": 59548294, "question_id": 59548259, "link": "https://stackoverflow.com/questions/59548259/why-cant-the-size-of-stack-be-determined-at-compile-time/59548294#59548294", "title": "Why can&#39;t the size of stack be determined at compile time?", "body": "<p>With C99, it is possible to create Variable length array (VLA) on the stack. Those arrays will have dynamic size based on runtime parameters, or calculated expressions. In those cases, not possible to calculate stack size until runtime.</p>\n\n<p>For example:</p>\n\n<pre><code>int f(int n) {\n    // Size based on input\n    int x[n] ;\n\n    // Dynamic size\n    int m = n+5000 ;\n    int y[mm] ;\n\n};\n</code></pre>\n\n<p>Needless to say that if the allocation of a single function can not be calculated, it is not possible to calculate the stack size of a complete program</p>\n"}, {"tags": [], "owner": {"reputation": 5813, "user_id": 1075282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70efe94a6c2237ec96f429402a03a27d?s=128&d=identicon&r=PG", "display_name": "Renat", "link": "https://stackoverflow.com/users/1075282/renat"}, "is_accepted": false, "score": 0, "last_activity_date": 1577824968, "creation_date": 1577824968, "answer_id": 59548312, "question_id": 59548259, "link": "https://stackoverflow.com/questions/59548259/why-cant-the-size-of-stack-be-determined-at-compile-time/59548312#59548312", "title": "Why can&#39;t the size of stack be determined at compile time?", "body": "<p>Stack memory is allocated at the entry of the function. That's why the stack size depends on the sequence of function calls, which is not defined at compile time (e.g. any <code>if</code>, <code>switch</code> can change the function call sequence)</p>\n"}, {"comments": [{"owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 0, "creation_date": 1578061636, "post_id": 59549377, "comment_id": 105326707, "body": "C and other languages allow variable parameter lists (i.e. <code>function foo(int x, ...)</code>), so you&#39;d have to eliminate that as well. And for the compiler to compute a max call depth, it would need full knowledge of all external function calls and their dependencies. It would have trouble with things like passing callback function pointers to other functions. Probably more things we&#39;d have to restrict. I think it becomes a &quot;theoretically possible,&quot; but impractical, exercise. But probably not on the order of the halting problem."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 0, "creation_date": 1578066682, "post_id": 59549377, "comment_id": 105329146, "body": "@JimMischel As the question is tagged C, and C, by default does not allow  other languages, disallowing  other languages is not needed.  I suspect your idea about call back function applies.  This is not only theoretically possible, but done with some today&#39;s compiler&#39;s as given in the example link."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1579841518, "last_edit_date": 1579841518, "creation_date": 1577840020, "answer_id": 59549377, "question_id": 59548259, "link": "https://stackoverflow.com/questions/59548259/why-cant-the-size-of-stack-be-determined-at-compile-time/59549377#59549377", "title": "Why can&#39;t the size of stack be determined at compile time?", "body": "<blockquote>\n  <p>Why can't the size of stack be determined at compile time?<br>\n  But aren't all the stack variables already present in a function?</p>\n</blockquote>\n\n<p>2 things that prevent compile time stack size computation:</p>\n\n<p><a href=\"https://en.wikipedia.org/wiki/Variable-length_array\" rel=\"nofollow noreferrer\">Variable logic arrays</a> allow for a run-time determined amount of memory usage of the \"stack\". Other non-standard functions like <code>alloca()</code> do so also.</p>\n\n<p><em>Recursion</em> allows for a run-time determined depth of function calls and thus a run-time determined amount of memory usage even if each function memory usage was constant. <a href=\"https://stackoverflow.com/questions/59548259/why-cant-the-size-of-stack-be-determined-at-compile-time/59549377#comment105265597_59548259\">@Weather Vane</a></p>\n\n<hr>\n\n<p>Were it not for these 2 and maybe <a href=\"https://stackoverflow.com/questions/59548259/why-cant-the-size-of-stack-be-determined-at-compile-time/59549377?noredirect=1#comment105326707_59549377\">others</a>,  code could be analysed at compile time to determine stack usage, max function depth and then possible not even use a \"stack\" in classic sense, storing all \"stack\" memory in a fixed space.  Some compilers provide for this. <a href=\"https://www.ccsinfo.com/forum/viewtopic.php?t=36099\" rel=\"nofollow noreferrer\">e.g.</a></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user12633902"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 390, "favorite_count": 0, "answer_count": 3, "score": -2, "last_activity_date": 1579841518, "creation_date": 1577824414, "last_edit_date": 1577840428, "question_id": 59548259, "link": "https://stackoverflow.com/questions/59548259/why-cant-the-size-of-stack-be-determined-at-compile-time", "title": "Why can&#39;t the size of stack be determined at compile time?", "body": "<p>I have read that the size of heap and stack cannot be computed at compile time and needs to be evaluated at runtime.</p>\n\n<p>I can think of this code which allocates heap based on user input and needs the runtime:</p>\n\n<pre><code>int size;\nscanf(\"%d\", &amp;size):\nvoid *ptr= malloc(size);\n</code></pre>\n\n<p>But aren't all the stack variables already present in a function? given their data type (<code>int</code>, <code>char</code>, <code>long</code> etc.) why can't the compiler calculate the size?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 5, "creation_date": 1577824534, "post_id": 59548243, "comment_id": 105265553, "body": "Welcome to Stackoverflow. &quot;isn&#39;t working&quot; is never a good problem description. Describe in what ways it is not working. Does it crash? Does it get wrong results sometimes? Wrong results all the time? etc. Also, it&#39;s an SO requirement to provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal verifiable example</a> for all debugging requests."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 2, "creation_date": 1577829448, "post_id": 59548243, "comment_id": 105266437, "body": "Read <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">this article</a> for some tips on debugging your code."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12539051, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f3317b160aee9d8ee7722eab9cd2ca7?s=128&d=identicon&r=PG&f=1", "display_name": "Teutonium", "link": "https://stackoverflow.com/users/12539051/teutonium"}, "edited": false, "score": 0, "creation_date": 1577830348, "post_id": 59548604, "comment_id": 105266585, "body": "Thanks, it was my mistake when copying the code to SO, after changing it it&#39;s still not working, I added a couple of examples to see if it&#39;s easier to understand what I wanted with the function push_down, also added an example of it running."}, {"owner": {"reputation": 1774, "user_id": 1201456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b33a546c937f65ce7ef0f29ca0f6a84d?s=128&d=identicon&r=PG", "display_name": "nickelpro", "link": "https://stackoverflow.com/users/1201456/nickelpro"}, "reply_to_user": {"reputation": 1, "user_id": 12539051, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f3317b160aee9d8ee7722eab9cd2ca7?s=128&d=identicon&r=PG&f=1", "display_name": "Teutonium", "link": "https://stackoverflow.com/users/12539051/teutonium"}, "edited": false, "score": 0, "creation_date": 1577830480, "post_id": 59548604, "comment_id": 105266609, "body": "@Teutonium You&#39;re best of providing a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">Minimal, Reproducible, Example</a> for people to use rather than just the problem function. People are more likely to help with code that compiles that they can just pop into a debugger than try to reason through your code off SO."}], "tags": [], "owner": {"reputation": 1774, "user_id": 1201456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b33a546c937f65ce7ef0f29ca0f6a84d?s=128&d=identicon&r=PG", "display_name": "nickelpro", "link": "https://stackoverflow.com/users/1201456/nickelpro"}, "is_accepted": false, "score": 0, "last_activity_date": 1577828173, "creation_date": 1577828173, "answer_id": 59548604, "question_id": 59548243, "link": "https://stackoverflow.com/questions/59548243/move-values-down-in-a-matrix-c/59548604#59548604", "title": "Move values down in a Matrix C", "body": "<p>Your example isn't reproducible and I'm not certain exactly what you're trying to do, but this is the obvious error:</p>\n\n<pre><code>for (int a = 0 ; a &gt; game_size - i ; ++a) \n  {\n    if(grid[a][j]!=0)\n    {\n      num=grid[a][j];\n      replace=a;\n\n    }\n}\n</code></pre>\n\n<p>This loop will never run, <code>a</code> is zero and will never be greater than <code>game_size - 1</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 12539051, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f3317b160aee9d8ee7722eab9cd2ca7?s=128&d=identicon&r=PG&f=1", "display_name": "Teutonium", "link": "https://stackoverflow.com/users/12539051/teutonium"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1577829851, "creation_date": 1577824252, "last_edit_date": 1577829851, "question_id": 59548243, "link": "https://stackoverflow.com/questions/59548243/move-values-down-in-a-matrix-c", "title": "Move values down in a Matrix C", "body": "<p>I'm still a noob at programming and still don't know many of the functions that I'm able to use so I kept to the basics, I was trying to create the game 2048 in C, for that I decided to make a function to push numbers in certain directions, either upwards, downwards, left or right. My up function is working, but my down function isn't even though I did the opposite of what I did in my up function. In the push_down function the numbers actually do what they do in the push_up functions, they move up instead of down.</p>\n\n<p>Would love to know why it isn't working if anyone can spot my mistake</p>\n\n<pre><code>\n//this one is working\nvoid push_up(int game_size, int grid[game_size][game_size])\n{\n    int replace;\n    int num=0;\n    for (int j = 0; j &lt; game_size ; ++j)\n    {\n        for (int i = 0; i &lt; game_size ; ++i)\n        {\n            replace = 100;\n            if(grid[i][j]==0)                \n            {\n                for (int a = game_size - 1 ; a &gt; 0 + i ; --a) \n                {\n                    if(grid[a][j]!=0)\n                    {\n                        num=grid[a][j];\n                        replace=a;\n\n                    }\n                }\n                grid[i][j]=num; \n                num=0;\n            }\n            if(replace!=100){\n            grid[replace][j]=0;  \n            }\n        }\n    }\n}\n\n</code></pre>\n\n<pre><code>// this one isn't working\nvoid push_down(int game_size, int grid[game_size][game_size])\n{\n    int replace;\n    int num=0;\n    for (int j = 0; j &lt; game_size ; ++j)\n    {\n        for (int i = game_size - 1; i &gt;= 0 ; --i) \n        {\n            replace = 100;\n            if(grid[i][j]==0)               \n            {\n                for (int a = 0 ; a &lt; game_size - i ; ++a) \n                {\n                    if(grid[a][j]!=0)\n                    {\n                        num=grid[a][j];\n                        replace=a;\n\n                    }\n                }\n                grid[i][j]=num; //\n                num=0;\n            }\n            if(replace!=100){\n            grid[replace][j]=0;  \n            }\n        }\n    }\n}\n\n</code></pre>\n\n<p>What I did in both is mainly to run the column(either upwards or downwards depending on the function) trying to find a zero, lock the position of the  zero and try to find the next number in that column by running the column in the opposite direction, the last number (if a number was even found) would be used to fill that zero and the position where the number was would be filled with 0.</p>\n\n<p>So, let me give an example of what I wanted with these function:</p>\n\n<p>In the first function (push_up) I wanted and was able to do a function that would transform this matrix :</p>\n\n<p>4 2 4 0<br>\n0 0 0 0<br>\n0 4 2 2<br>\n2 0 4 2   </p>\n\n<p>into this one:                                                                                                                                                                  </p>\n\n<p>4 2 4 2<br>\n2 4 2 2<br>\n0 0 4 0<br>\n0 0 0 0 </p>\n\n<p>So, all the values would move to the highest position possible inside the column.</p>\n\n<p>In the second function what I wanted was to transform this matrix:</p>\n\n<p>4 2 4 0<br>\n0 0 0 0<br>\n0 4 2 2<br>\n2 0 4 2  </p>\n\n<p>into this one:                                                                                                                                                                   </p>\n\n<p>0 0 0 0<br>\n0 0 4 0<br>\n4 2 2 2<br>\n2 4 4 2 </p>\n\n<p>All the values would move to the lowest possible position inside the matrix. But I wasn't able to, by running the function what I get is:</p>\n\n<p>This is the original matrix:</p>\n\n<p>0 0 0 0</p>\n\n<p>4 0 0 2</p>\n\n<p>2 0 0 4</p>\n\n<p>0 2 0 0</p>\n\n<p>This is the matrix after using the function push_down:</p>\n\n<p>2 2 0 4</p>\n\n<p>4 0 0 2</p>\n\n<p>0 0 0 0</p>\n\n<p>0 0 0 0</p>\n\n<p>There are probably easier ways to do this, I would love to hear them but I would also love to know where my logic went wrong in the push_down function since in the push_up function it's working fine.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 12, "creation_date": 1577824160, "post_id": 59548224, "comment_id": 105265474, "body": "No that is not guaranteed."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 7, "creation_date": 1577824290, "post_id": 59548224, "comment_id": 105265499, "body": "It&#39;s actually unlikely. Many <code>malloc()</code> implementations put bookkeeping information in the memory before the beginning of the allocation. So you would not expect any two allocations to be contiguous."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1577824437, "post_id": 59548224, "comment_id": 105265531, "body": "Also, <code>malloc</code> can set aside more memory than was requested, to make its memory management easier."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1577824449, "post_id": 59548224, "comment_id": 105265538, "body": "Test it out yourself."}, {"owner": {"reputation": 42504, "user_id": 1161878, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0157ddd785dc01e95342e3661d34b42a?s=128&d=identicon&r=PG", "display_name": "Gene", "link": "https://stackoverflow.com/users/1161878/gene"}, "edited": false, "score": 0, "creation_date": 1577825066, "post_id": 59548224, "comment_id": 105265653, "body": "First the C language standard doesn&#39;t say anything must be true about different <code>malloc</code> returns. Even in practice, if the <code>count_grd[i]</code> values are greater than 1, adjacent <code>collector[i]</code> values can <i>never</i> be one apart. The location <code>collector[i] + 1</code> lies within the block pointed to by <code>collector[i]</code>."}, {"owner": {"reputation": 95, "user_id": 11923505, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-C6rwhQ11j2c/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc9jkyB24w3AUZ5sNzK1lOdvZn_Uw/photo.jpg?sz=128", "display_name": "C. R. Ward", "link": "https://stackoverflow.com/users/11923505/c-r-ward"}, "edited": false, "score": 0, "creation_date": 1577825635, "post_id": 59548224, "comment_id": 105265767, "body": "Contiguous allocation is a recommended programming technique for making progress on your question. \u2014R"}, {"owner": {"reputation": 952, "user_id": 12521158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8e745b4953a3ecbe3a1f7147089a7a7?s=128&d=identicon&r=PG&f=1", "display_name": "kopecs", "link": "https://stackoverflow.com/users/12521158/kopecs"}, "edited": false, "score": 0, "creation_date": 1577834198, "post_id": 59548224, "comment_id": 105267201, "body": "I <i>believe</i> its even undefined behaviour to compare those two pointers."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 952, "user_id": 12521158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8e745b4953a3ecbe3a1f7147089a7a7?s=128&d=identicon&r=PG&f=1", "display_name": "kopecs", "link": "https://stackoverflow.com/users/12521158/kopecs"}, "edited": false, "score": 2, "creation_date": 1577835229, "post_id": 59548224, "comment_id": 105267343, "body": "@kopecs: Comparing unrelated pointers for equality is defined. Comparing for order (<code>&lt;</code> etc.) is not."}], "owner": {"reputation": 791, "user_id": 9105207, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BiyPF.png?s=128&g=1", "display_name": "Tal Rofe", "link": "https://stackoverflow.com/users/9105207/tal-rofe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1577824071, "creation_date": 1577824071, "question_id": 59548224, "link": "https://stackoverflow.com/questions/59548224/is-it-correct-that-these-specific-pointers-are-adjacent-in-memory", "title": "Is it correct that these specific pointers are adjacent in memory?", "body": "<p>given the following code: </p>\n\n<pre><code>int** GradeStat(int* Grades, int size_grades, int grd_range, int* count_grd, int* avg_grd) {\n    const int len = 100/grd_range+1;\n    int** collector = malloc(len * sizeof(int*));\n    size_t i;\n    for(i=0; i&lt;len; i++) {\n         collector[i] = malloc(count_grd[i] * sizeof(int));\n    }\n    return collector;\n}\n</code></pre>\n\n<p>Is it correct to assume that for any <code>0&lt;j&lt;len</code> the following is correct: <code>collector[j]=collector[j-1]+1</code>?</p>\n"}, {"tags": ["c", "arrays", "pointers", "types"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1577823326, "post_id": 59548092, "comment_id": 105265272, "body": "You could try <code>static const void *permu[]</code>? You would then have to cast it when accessed. Alternatively you can make each array one-dimensional and work out the indexing yourself."}, {"owner": {"reputation": 344, "user_id": 8311608, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7e57fea478c7a2ca25e1f06d914a1f27?s=128&d=identicon&r=PG&f=1", "display_name": "Cedric Sun", "link": "https://stackoverflow.com/users/8311608/cedric-sun"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1577823619, "post_id": 59548092, "comment_id": 105265349, "body": "@WeatherVane yes, that works, thanks! Just make it an answer and I&#39;ll accept it :)"}], "answers": [{"tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": true, "score": 1, "last_activity_date": 1577823655, "creation_date": 1577823655, "answer_id": 59548182, "question_id": 59548092, "link": "https://stackoverflow.com/questions/59548092/determine-the-type-of-an-array-which-stores-the-pointer-to-other-arrays-of-diffe/59548182#59548182", "title": "Determine the type of an array which stores the pointer to other arrays of different dimensions", "body": "<p>You could try </p>\n\n<pre><code>static const void *permu[] = { };\n</code></pre>\n\n<p>You would then have to cast it when accessed.</p>\n\n<p>Alternatively you can make each array one-dimensional and work out the indexing yourself.</p>\n"}, {"comments": [{"owner": {"reputation": 344, "user_id": 8311608, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7e57fea478c7a2ca25e1f06d914a1f27?s=128&d=identicon&r=PG&f=1", "display_name": "Cedric Sun", "link": "https://stackoverflow.com/users/8311608/cedric-sun"}, "edited": false, "score": 0, "creation_date": 1577826480, "post_id": 59548381, "comment_id": 105265914, "body": "I&#39;m somewhat reluctant to the VLA in C. Do you think it will slow down the program? (cuz the factorial sequence blows up really fast)"}, {"owner": {"reputation": 344, "user_id": 8311608, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7e57fea478c7a2ca25e1f06d914a1f27?s=128&d=identicon&r=PG&f=1", "display_name": "Cedric Sun", "link": "https://stackoverflow.com/users/8311608/cedric-sun"}, "edited": false, "score": 0, "creation_date": 1577826977, "post_id": 59548381, "comment_id": 105266006, "body": "Wait, this is not VLA right? It&#39;s just a type cast and no real allocation is done on stack ... I&#39;m right?"}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "reply_to_user": {"reputation": 344, "user_id": 8311608, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7e57fea478c7a2ca25e1f06d914a1f27?s=128&d=identicon&r=PG&f=1", "display_name": "Cedric Sun", "link": "https://stackoverflow.com/users/8311608/cedric-sun"}, "edited": false, "score": 0, "creation_date": 1577839087, "post_id": 59548381, "comment_id": 105267759, "body": "It is a VLA type because it is a pointer to an array where the size is a variable. No, it&#39;s not slow because there is no stack allocation."}], "tags": [], "owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "is_accepted": false, "score": 1, "last_activity_date": 1577825710, "creation_date": 1577825710, "answer_id": 59548381, "question_id": 59548092, "link": "https://stackoverflow.com/questions/59548092/determine-the-type-of-an-array-which-stores-the-pointer-to-other-arrays-of-diffe/59548381#59548381", "title": "Determine the type of an array which stores the pointer to other arrays of different dimensions", "body": "<p>The correct declaration is</p>\n\n<pre><code>static const char (*permu[9])[] = {0,      0,      permu2, permu3, permu4,\n                                   permu5, permu6, permu7, permu8};\n</code></pre>\n\n<p><code>permu</code> is an array of 9 pointers to arrays of unknown numbers of <code>const char</code>s. Writing the <code>9</code> is optional; it can be inferred from the initializer. You <em>could</em> instead make it an array of pointers to <code>void</code>, as in the other answer, but it's best to preserve as much information as possible. You use it like this:</p>\n\n<pre><code>const int n = 4;\nconst char (*perms)[n] = permu[n];\nfor (size_t i = 0; i &lt; fac_seq[n]; i++) {\n    for (size_t j = 0; j &lt; n; j++) {\n        printf(\"%2d\", perms[i][j]);\n    }\n    putchar('\\n');\n}\n</code></pre>\n\n<p>Note that I perform a cast with the assignment to <code>perms</code>. I take a pointer to an array of unknown size and convert it to a pointer where the array size is actually <code>n</code>. This is what allows the double <code>[]</code> syntax later: the type <code>const char[n]</code> has a defined size (<code>sizeof(char)*n</code>), so we know how far we need to skip for <code>perms[i]</code>.</p>\n\n<p><a href=\"https://godbolt.org/z/_Ffgi7\" rel=\"nofollow noreferrer\">Godbolt</a></p>\n"}], "owner": {"reputation": 344, "user_id": 8311608, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7e57fea478c7a2ca25e1f06d914a1f27?s=128&d=identicon&r=PG&f=1", "display_name": "Cedric Sun", "link": "https://stackoverflow.com/users/8311608/cedric-sun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 59548182, "answer_count": 2, "score": 2, "last_activity_date": 1577825710, "creation_date": 1577822817, "question_id": 59548092, "link": "https://stackoverflow.com/questions/59548092/determine-the-type-of-an-array-which-stores-the-pointer-to-other-arrays-of-diffe", "title": "Determine the type of an array which stores the pointer to other arrays of different dimensions", "body": "<p>I have many constant 2D arrays of all possible permutation of integer in [0,LEN) for many LEN:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>static const char permu2[][2] = {{0, 1}, {1, 0}};\nstatic const char permu3[][3] = {{0, 1, 2}, {0, 2, 1}, {1, 0, 2},\n                                {1, 2, 0}, {2, 0, 1}, {2, 1, 0}};\nstatic const char permu4[][4] = {\n    {0, 1, 2, 3}, {0, 1, 3, 2}, {0, 2, 1, 3}, {0, 2, 3, 1}, {0, 3, 1, 2},\n    {0, 3, 2, 1}, {1, 0, 2, 3}, {1, 0, 3, 2}, {1, 2, 0, 3}, {1, 2, 3, 0},\n    {1, 3, 0, 2}, {1, 3, 2, 0}, {2, 0, 1, 3}, {2, 0, 3, 1}, {2, 1, 0, 3},\n    {2, 1, 3, 0}, {2, 3, 0, 1}, {2, 3, 1, 0}, {3, 0, 1, 2}, {3, 0, 2, 1},\n    {3, 1, 0, 2}, {3, 1, 2, 0}, {3, 2, 0, 1}, {3, 2, 1, 0}};\nstatic const char permu5[][5] = {{0, 1, 2, 3, 4}, {0, 1, 2, 4, 3}, {0, 1, 3, 2, 4}, /*... */}\n// and many more as you can imagine...\n</code></pre>\n\n<p>And I'd like to store the pointers to those arrays in another array:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>static const char *permu[] = {0,      0,      permu2, permu3, permu4,\n                             permu5, permu6, permu7, permu8};\nstatic const int fac_seq[] = {1,   1,    2,     6,      24,      120,\n                              720, 5040, 40320, 362880, 3628800, 39916800};\n</code></pre>\n\n<p>So that for a given LEN=n, I can access those constants in this way:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>const int n = 8;\nfor ( size_t i = 0; i &lt; fac_seq[n]; i++ ) {\n    for ( size_t j = 0; j &lt; n; j++ ) {\n        printf( \"%2d\", *( permu[n] + n*i  + j ) );\n    }\n    putchar( '\\n' );\n}\n</code></pre>\n\n<p>Although this will compile and work correctly, the compiler (gcc) complains like:</p>\n\n<pre><code>30.c:1966:47: warning: initialization from incompatible pointer type [-Wincompatible-pointer-types]\n static const char *permu[] = {0,      0,      permu2, permu3, permu4,\n                                               ^~~~~~\n30.c:1966:47: note: (near initialization for \u2018permu[2]\u2019)\n30.c:1966:55: warning: initialization from incompatible pointer type [-Wincompatible-pointer-types]\n static const char *permu[] = {0,      0,      permu2, permu3, permu4,\n                                                       ^~~~~~\n30.c:1966:55: note: (near initialization for \u2018permu[3]\u2019)\n</code></pre>\n\n<p>What should be the right type for the <code>permu</code> array? I tried <code>const char **permu[]</code> and still got the same warnings.</p>\n"}, {"tags": ["python", "c", "python-c-api"], "comments": [{"owner": {"reputation": 39426, "user_id": 812183, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/9639bd6ee5dfd07ff05fb848e67e9657?s=128&d=identicon&r=PG", "display_name": "Anthony Sottile", "link": "https://stackoverflow.com/users/812183/anthony-sottile"}, "edited": false, "score": 2, "creation_date": 1577827327, "post_id": 59547905, "comment_id": 105266072, "body": "not sure about the debugging tools on windows, but the bug in this case is you&#39;re looking up the Nth argument instead of the Nth element of the only argument"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1577873209, "post_id": 59547905, "comment_id": 105271762, "body": "The problem is <b>you</b>. You must check <b>each and every single return value</b> of <b>every C API function</b> and if they return a failure code, <b>your function must exit with <code>return NULL;</code> which will cause an exception be thrown in the Python side, with the error message as the description</b>."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1577873364, "post_id": 59547905, "comment_id": 105271794, "body": "And that every really means every, including <code>PyNumber_Multiply</code>, <code>PyTuple_GetItem</code>, <code>Py_BuildValue</code> and <code>PyTuple_New</code>. The <code>PyTuple_SET_ITEM</code> can&#39;t fail, but you can write out of bounds."}], "answers": [{"tags": [], "owner": {"reputation": 1774, "user_id": 1201456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b33a546c937f65ce7ef0f29ca0f6a84d?s=128&d=identicon&r=PG", "display_name": "nickelpro", "link": "https://stackoverflow.com/users/1201456/nickelpro"}, "is_accepted": false, "score": -1, "last_activity_date": 1577829729, "creation_date": 1577829729, "answer_id": 59548730, "question_id": 59547905, "link": "https://stackoverflow.com/questions/59547905/python-c-api-failing-silently/59548730#59548730", "title": "Python C Api failing silently", "body": "<p>The problem is this loop:</p>\n\n<pre><code>for (int c = 0; c &lt; 16; c++) {\n    PyObject *newValue = PyNumber_Multiply(PyTuple_GetItem(args, c), Py_BuildValue(\"%u\", (int)2));\n    PyTuple_SET_ITEM(ret, c, newValue);\n}\n</code></pre>\n\n<p>By calling <code>PyTuple_GetItem(args, c)</code> you're taking the <code>c</code>'th argument provided to your function, but you only provide a single argument. The tuple containing the floats. You probably meant to do something like this:</p>\n\n<pre><code>PyObject *input = PyTuple_GetItem(args, 0); \nfor (int c = 0; c &lt; 16; c++) {\n    PyObject *newValue = PyNumber_Multiply(PyTuple_GetItem(input, c), Py_BuildValue(\"%u\", (int)2));\n    PyTuple_SET_ITEM(ret, c, newValue);\n}\n</code></pre>\n"}], "owner": {"reputation": 306, "user_id": 6166724, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/265de70a8d7be78a0ff0fd7d0b9d6a2c?s=128&d=identicon&r=PG&f=1", "display_name": "XCode", "link": "https://stackoverflow.com/users/6166724/xcode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1577829729, "creation_date": 1577821166, "last_edit_date": 1577826721, "question_id": 59547905, "link": "https://stackoverflow.com/questions/59547905/python-c-api-failing-silently", "title": "Python C Api failing silently", "body": "<p>I'm trying to make a Python interface for my C-application, but when I run it the shell just resets and no error is printed. Here is my code:</p>\n\n<pre><code>#include &lt;Python.h&gt;\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdbool.h&gt;\n\nstatic PyObject *method_doubletuple(self, args)\n    PyObject *self;\n    PyObject *args;\n{\n    PyObject *ret = PyTuple_New(16);\n    for (int c = 0; c &lt; 16; c++) {\n        PyObject *newValue = PyNumber_Multiply(PyTuple_GetItem(args, c), Py_BuildValue(\"%u\", (int)2));\n        PyTuple_SET_ITEM(ret, c, newValue);\n    }\n    return ret;\n}\n\nstatic PyMethodDef PyTestMethods[] = {\n    {\"system\", method_doubletuple, METH_VARARGS, \"Doubles the value of a tuple with 16 elements\"},\n    {NULL, NULL, 0, NULL}\n};\n\nstatic struct PyModuleDef pytestmodule = {\n    PyModuleDef_HEAD_INIT,\n    \"pytest\",\n    \"pytest\",\n    -1,\n    PyTestMethods\n};\n\nPyMODINIT_FUNC PyInit_pytest(void) {\n    return PyModule_Create(&amp;pytestmodule);\n}\n</code></pre>\n\n<pre><code>C:\\Users\\jotje\\Desktop\\Chess\\SampleCModule&gt;python setup.py install\nrunning install\nrunning build\nrunning build_ext\nbuilding 'pytest' extension\nC:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Community\\VC\\Tools\\MSVC\\14.16.27023\\bin\\HostX86\\x64\\cl.exe /c /nologo /Ox /W3 /GL /DNDEBUG /MD -IC:\\Users\\jotje\\AppData\\Local\\Programs\\Python\\Python36\\include -IC:\\Users\\jotje\\AppData\\Local\\Programs\\Python\\Python36\\include \"-IC:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Community\\VC\\Tools\\MSVC\\14.16.27023\\include\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.16299.0\\ucrt\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.16299.0\\shared\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.16299.0\\um\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.16299.0\\winrt\" \"-IC:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.16299.0\\cppwinrt\" /Tcaddarray.c /Fobuild\\temp.win-amd64-3.6\\Release\\addarray.obj\naddarray.c\naddarray.c(20): warning C4113: 'PyObject *(__cdecl *)()' differs in parameter lists from 'PyCFunction'\nC:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Community\\VC\\Tools\\MSVC\\14.16.27023\\bin\\HostX86\\x64\\link.exe /nologo /INCREMENTAL:NO /LTCG /DLL /MANIFEST:EMBED,ID=2 /MANIFESTUAC:NO /LIBPATH:C:\\Users\\jotje\\AppData\\Local\\Programs\\Python\\Python36\\libs /LIBPATH:C:\\Users\\jotje\\AppData\\Local\\Programs\\Python\\Python36\\PCbuild\\amd64 \"/LIBPATH:C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Community\\VC\\Tools\\MSVC\\14.16.27023\\lib\\x64\" \"/LIBPATH:C:\\Program Files (x86)\\Windows Kits\\10\\lib\\10.0.16299.0\\ucrt\\x64\" \"/LIBPATH:C:\\Program Files (x86)\\Windows Kits\\10\\lib\\10.0.16299.0\\um\\x64\" /EXPORT:PyInit_pytest build\\temp.win-amd64-3.6\\Release\\addarray.obj /OUT:build\\lib.win-amd64-3.6\\pytest.cp36-win_amd64.pyd /IMPLIB:build\\temp.win-amd64-3.6\\Release\\pytest.cp36-win_amd64.lib\n   Creating library build\\temp.win-amd64-3.6\\Release\\pytest.cp36-win_amd64.lib and object build\\temp.win-amd64-3.6\\Release\\pytest.cp36-win_amd64.exp\nGenerating code\nFinished generating code\nrunning install_lib\ncopying build\\lib.win-amd64-3.6\\pytest.cp36-win_amd64.pyd -&gt; C:\\Users\\jotje\\AppData\\Local\\Programs\\Python\\Python36\\Lib\\site-packages\nrunning install_egg_info\nRemoving C:\\Users\\jotje\\AppData\\Local\\Programs\\Python\\Python36\\Lib\\site-packages\\pytest-1.0.0-py3.6.egg-info\nWriting C:\\Users\\jotje\\AppData\\Local\\Programs\\Python\\Python36\\Lib\\site-packages\\pytest-1.0.0-py3.6.egg-info\n\nC:\\Users\\jotje\\Desktop\\Chess\\SampleCModule&gt;python\nPython 3.6.6 (v3.6.6:4cf1f54eb7, Jun 27 2018, 03:37:03) [MSC v.1900 64 bit (AMD64)] on win32\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n&gt;&gt;&gt; import pytest\n&gt;&gt;&gt; pytest.doubletuple((4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4))\n\nC:\\Users\\jotje\\Desktop\\Chess\\SampleCModule&gt;\n</code></pre>\n\n<p>If anyone knows how to get an error message or logs or something which would point out the problem, and maybe tell me what I'm doing wrong that would be great.</p>\n"}, {"tags": ["c", "memory", "design-patterns"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1577821244, "post_id": 59547761, "comment_id": 105264847, "body": "Yes it is reasonable. Second question is not that answerable as it is largely opinions based."}, {"owner": {"reputation": 95, "user_id": 11923505, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-C6rwhQ11j2c/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc9jkyB24w3AUZ5sNzK1lOdvZn_Uw/photo.jpg?sz=128", "display_name": "C. R. Ward", "link": "https://stackoverflow.com/users/11923505/c-r-ward"}, "edited": false, "score": 0, "creation_date": 1577821515, "post_id": 59547761, "comment_id": 105264906, "body": "The answer depends upon the usage, so there is no fixed answer here."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1577821740, "post_id": 59547761, "comment_id": 105264959, "body": "I would name them <code>machine_create</code> and <code>machine_destroy</code> so they sort of fit the bill of namespacing in C. If you want the user to be unable to modify <code>Machine</code> then I would go for 3, otherwise I would go for 2."}, {"owner": {"reputation": 9633, "user_id": 550587, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9a21bbc68fb81529f7c3c9d99e92a280?s=128&d=identicon&r=PG", "display_name": "Matthew", "link": "https://stackoverflow.com/users/550587/matthew"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1577823511, "post_id": 59547761, "comment_id": 105265321, "body": "Opinions are what I&#39;m after here @kaylum. It was my understanding that design patterns are allowed as questions in StackOverflow. I am asking how libraries typically do this kind of thing, so that I conform to common design."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1577823642, "post_id": 59547761, "comment_id": 105265357, "body": "Opinions based questions are expressly <a href=\"https://stackoverflow.com/help/on-topic\">off-topic</a> on Stackoverflow."}, {"owner": {"reputation": 9633, "user_id": 550587, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9a21bbc68fb81529f7c3c9d99e92a280?s=128&d=identicon&r=PG", "display_name": "Matthew", "link": "https://stackoverflow.com/users/550587/matthew"}, "edited": false, "score": 0, "creation_date": 1577823872, "post_id": 59547761, "comment_id": 105265414, "body": "Where is the appropriate place to ask design pattern questions then (and why is there a design pattern tag on StackOverflow...)?"}], "answers": [{"comments": [{"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "reply_to_user": {"reputation": 9633, "user_id": 550587, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9a21bbc68fb81529f7c3c9d99e92a280?s=128&d=identicon&r=PG", "display_name": "Matthew", "link": "https://stackoverflow.com/users/550587/matthew"}, "edited": false, "score": 0, "creation_date": 1577826138, "post_id": 59547913, "comment_id": 105265849, "body": "@Matthew You can accept the answer to reward it."}], "tags": [], "owner": {"reputation": 1774, "user_id": 1201456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b33a546c937f65ce7ef0f29ca0f6a84d?s=128&d=identicon&r=PG", "display_name": "nickelpro", "link": "https://stackoverflow.com/users/1201456/nickelpro"}, "is_accepted": false, "score": 2, "last_activity_date": 1577821231, "creation_date": 1577821231, "answer_id": 59547913, "question_id": 59547761, "link": "https://stackoverflow.com/questions/59547761/should-functions-that-create-structs-return-the-struct-or-a-pointer/59547913#59547913", "title": "Should functions that create structs return the struct or a pointer?", "body": "<p>They're all reasonable and libraries take all three paths, its a matter of style and application.</p>\n\n<p>Generally for lightweight structures with only a couple of fields, a stack-based approach is used because it avoids the complication of dynamic memory management and the performance hit is minimal.</p>\n\n<p>The second approach of allowing the library consumer to allocate memory is also common when structures grow beyond the nebulous two-to-three field initialization. If the library doesn't need to allocate dynamic memory for its operations this is generally the preferred path.</p>\n\n<p>The final path is extremely common in libraries that have non-trivial operations that will need to allocate dynamic memory in the course of their operations. In this case a mechanism is usually provided for the library consumer define their own memory allocation functions for the library to use. Typically this is done with a macro, but other solutions using function pointers also exist.</p>\n\n<p>It's considered bad form for a library to call the standard <code>malloc</code> and <code>free</code> functions without providing any opportunity for the consumer application to define how it wants to library to handle dynamic memory.</p>\n"}], "owner": {"reputation": 9633, "user_id": 550587, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9a21bbc68fb81529f7c3c9d99e92a280?s=128&d=identicon&r=PG", "display_name": "Matthew", "link": "https://stackoverflow.com/users/550587/matthew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "closed_date": 1577822228, "answer_count": 1, "score": 1, "last_activity_date": 1577821231, "creation_date": 1577819828, "question_id": 59547761, "link": "https://stackoverflow.com/questions/59547761/should-functions-that-create-structs-return-the-struct-or-a-pointer", "closed_reason": "Opinion-based", "title": "Should functions that create structs return the struct or a pointer?", "body": "<p>I'm learning C and this is one that I can't totally figure out.  I have some code like:</p>\n\n<pre><code>typedef struct machine {\n  char * name;\n} machine;\n\nmachine create_machine(char * name)\n{\n  Machine machine = { .name = name };\n\n  return machine;\n}\n</code></pre>\n\n<p>But this means that the machine is on the stack. If the user wants it on the heap they have to create a machine themselves. So I'd need a function like this instead:</p>\n\n<pre><code>typedef struct machine {\n  char * name;\n} machine;\n\nmachine * init_machine(Machine * machine, char * name)\n{\n  machine-&gt;name = name;\n\n  return machine;\n}\n</code></pre>\n\n<p>The third option is to have <code>create_machine</code> create a machine and put it on the heap. Then also have a teardown function:</p>\n\n<pre><code>typedef struct machine {\n  char * name;\n} machine;\n\nmachine * create_machine(char * name)\n{\n  Machine *machine = malloc(sizeof *machine);\n  machine-&gt;name = name;\n\n  return machine;\n}\n\nvoid machine_teardown(Machine * machine)\n{\n  free(machine);\n}\n</code></pre>\n\n<p>I'm leaning towards the 2nd pattern here. Have a <code>create_machine</code> that returns a machine, but then also provide an \"init\" function that can be called. This gives the consumer the option of putting it either on the stack or the heap.</p>\n\n<p>Does this sound like a reasonable conclusion? What is the pattern that most libraries take here?</p>\n"}, {"tags": ["c", "gcc", "compiler-optimization", "pow"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1577834617, "post_id": 59547742, "comment_id": 105267267, "body": "As the two answers I see note, you have an unnecessary call to <code>pow()</code> in that code.  I don&#39;t think the answers mention that you have an unnecessary call to <code>fun()</code> in your first program.   Note that if you enter a number that is 13 or larger, your factorial code will suffer from a signed integer overflow, leading to undefined behaviour."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1577840282, "post_id": 59547742, "comment_id": 105267894, "body": "@JonathanLeffler Mine does."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1577840725, "post_id": 59547742, "comment_id": 105267951, "body": "I see mention of the unnecessary call to <code>pow()</code> and recognized that both answers mention that.  I still don\u2019t see the reference to <code>fun()</code> by name, but on a re-re-read, I do see a contextual reference to it, which is why I missed it before."}], "answers": [{"comments": [{"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 1, "creation_date": 1577820070, "post_id": 59547755, "comment_id": 105264611, "body": "You might note that there&#39;s no need for the first call to <code>powr</code>, and that having a function prototype is required for everything but C99."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 3, "creation_date": 1577820094, "post_id": 59547755, "comment_id": 105264616, "body": "It might be the problem. The C standard allows for implicit inclusion."}, {"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1577822931, "post_id": 59547755, "comment_id": 105265191, "body": "@Bathsheba: C++ allows standard headers to include other standard headers. The C standard does not.  That said, gcc does have a built-in named <code>pow()</code> and what happens on my simple tests is that the code gets compiled using the built-in&#39;s prototype (<code>double pow(double, double)</code>) but the function defined in the source file is what gets called (incorrectly). The general advice of declaring functions and objects before calling them is always good."}], "tags": [], "owner": {"reputation": 4859, "user_id": 7431860, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/P6Jko.jpg?s=128&g=1", "display_name": "Nick Reed", "link": "https://stackoverflow.com/users/7431860/nick-reed"}, "is_accepted": false, "score": 5, "last_activity_date": 1577821955, "last_edit_date": 1577821955, "creation_date": 1577819774, "answer_id": 59547755, "question_id": 59547742, "link": "https://stackoverflow.com/questions/59547742/why-is-my-factorial-program-working-but-my-almost-identical-pow-program-is-not-w/59547755#59547755", "title": "Why is my factorial program working but my almost identical pow program is not working?", "body": "<p>A few issues are present here. First and foremost, you didn't declare a prototype for your function before calling it the first time. To do so, you need to place <code>int pow(int, int);</code> above <code>main</code>. This lets the compiler know exactly what your function expects and what it returns. </p>\n\n<p>Ordinarily, this wouldn't cause the behavior you're seeing (though it <em>is</em> bad practice), but there's also already a function named <code>pow</code> in the C library. Since you never gave it a definition of your own, it's being implicitly included in your code. Now, it's expecting you to put two doubles in and get a double out.</p>\n\n<p>Add the prototype at the top and rename your function, and you'll fix both of these issues at once.</p>\n\n<p><a href=\"https://repl.it/repls/CanineDisgustingVirtualmemory\" rel=\"nofollow noreferrer\">Demo</a></p>\n\n<p>(Also, for what it's worth, you've got an unnecessary call.)</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n\nint powr(int, int);    // helps avoid compiler warnings\n\nint main()\n{\n    int m, n;\n\n    printf(\"enter the no=\");\n    scanf(\"%d%d\", &amp;m, &amp;n);\n    powr(m, n);             // unnecessary\n    printf(\"%d\\n\", powr(m, n));\n\n    return 0;\n}\n\nint powr(int m, int n)\n{\n    if(n == 0)\n        return 1;\n    else\n        return powr(m, n - 1) * m;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "is_accepted": false, "score": 3, "last_activity_date": 1577821166, "last_edit_date": 1577821166, "creation_date": 1577820433, "answer_id": 59547830, "question_id": 59547742, "link": "https://stackoverflow.com/questions/59547742/why-is-my-factorial-program-working-but-my-almost-identical-pow-program-is-not-w/59547830#59547830", "title": "Why is my factorial program working but my almost identical pow program is not working?", "body": "<p>For a little backstory behind this: The GNU C compiler (presumably what you're using) has implicit declarations for most of the Standard C Library functions that can be optimized in target-specific ways. <code>pow</code> is one of them.</p>\n\n<p>To fix this, you should rename your <code>pow</code> function to something not reserved by the Standard C library and provide a prototype for it, like so:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint power(int m, int n);\n</code></pre>\n\n<p>If you compile in strict C89/C90 compliance mode, you don't even need to provide a prototype due to <a href=\"https://stackoverflow.com/questions/9182763/implicit-function-declarations-in-c\">implicit function declaration rules</a>. However, if you compile with <em>any other standard</em> (which is the default and highly recommended), you'll need to provide a prototype for that function, as shown above.</p>\n\n<p>I'd also like to note that you have an unnecessary call to your power-computing program (also present in the factorial-computing program):</p>\n\n<pre><code>scanf(\"%d%d\", &amp;m, &amp;n);\npower(m, n); // here\nprintf(\"%d\\n\", power(m, n));\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 12633596, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAXaIWA07DMUaIqrKyP5PF1mfKzWQfFsMVS3U_jDw=k-s128", "display_name": "mayank raj", "link": "https://stackoverflow.com/users/12633596/mayank-raj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "answer_count": 2, "score": 5, "last_activity_date": 1577821955, "creation_date": 1577819580, "last_edit_date": 1577821936, "question_id": 59547742, "link": "https://stackoverflow.com/questions/59547742/why-is-my-factorial-program-working-but-my-almost-identical-pow-program-is-not-w", "title": "Why is my factorial program working but my almost identical pow program is not working?", "body": "<p>Here is my factorial program&mdash;this is executing and giving a correct result:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    int n;\n\n    printf(\"enter the no=\");\n    scanf(\"%d\", &amp;n);\n    fun(n);\n    printf(\"%d\\n\", fun(n));\n\n    return 0;\n}\n\nint fun(int n)\n{\n    if(n == 0)\n        return 1;\n    else\n        return fun(n - 1) * n;\n}\n</code></pre>\n\n<p>This is my program to compute the power of a number&mdash;this is giving 0 instead of the correct result and yet is almost identical:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    int m, n;\n\n    printf(\"enter the no=\");\n    scanf(\"%d%d\", &amp;m, &amp;n);\n    pow(m, n);\n    printf(\"%d\\n\", pow(m, n));\n\n    return 0;\n}\nint pow(int m, int n)\n{\n    if(n == 0)\n        return 1;\n    else\n        return pow(m, n - 1) * m;\n}\n</code></pre>\n\n<p>Both are running on same compiler.</p>\n\n<p>Why is my factorial program working but my almost identical power program is not working?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1577819525, "post_id": 59547721, "comment_id": 105264489, "body": "<code>(int**)calloc(sub_range, sizeof(int));</code> you want to allocate <code>sub_range</code> <i>pointers</i> to int, not ints. Tip: <code>realloc(NULL</code> is equal to <code>malloc</code>. Just <code>realloc(class_grd[place_in_sub_range</code> there is  no need to handle the if explicitly. <code>if (class_grd[i] == 0) {             class_grd[i] = NULL;</code> NULL is 0, this is doing nothing."}, {"owner": {"reputation": 29, "user_id": 11127455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239de104b661d35eb6d86b1dd59f1e96?s=128&d=identicon&r=PG&f=1", "display_name": "dor", "link": "https://stackoverflow.com/users/11127455/dor"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1577822008, "post_id": 59547721, "comment_id": 105265001, "body": "i was wrong, i meant to do: class_grd = (int**)calloc(sub_range, sizeof(int *));  now my code is run in the system. but i still get the problem with the place the grade in the right range."}, {"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 0, "creation_date": 1577830533, "post_id": 59547721, "comment_id": 105266617, "body": "I don&#39;t understand the grade range thing; how do they get <code>100&#47;range+1</code>? It is true that [0..100] contains a prime number of integer elements, so as long as the numbers aren&#39;t 1 or 101 it&#39;s <code>floor(101&#47;range)+1</code>? ASC?"}, {"owner": {"reputation": 29, "user_id": 11127455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239de104b661d35eb6d86b1dd59f1e96?s=128&d=identicon&r=PG&f=1", "display_name": "dor", "link": "https://stackoverflow.com/users/11127455/dor"}, "reply_to_user": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 0, "creation_date": 1577832254, "post_id": 59547721, "comment_id": 105266918, "body": "@Neil if the range on the grades is 10 so you basically have 11 sub-group in that range: 0-9, 10-19,...,90-99, 100 (it&#39;s 11 group in of grades), so to get to that number you need to take the maximum grade division it with the rage of the grades and add 1.  another example is: you have range of grades in the value of 15, meaning you have 7 groups of grades ranges: 0-14, 15-30,...., 63-78,..., 95-100. you get the groups of ranges number again with the same calculation."}, {"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 0, "creation_date": 1577992716, "post_id": 59547721, "comment_id": 105305404, "body": "Right, <code>ceil(n&#47;k) = floor((n-1)&#47;k)+1</code> for <code>n &gt; 1, k &gt; 0</code>, <a href=\"https://math.stackexchange.com/q/421509\">like this</a>."}, {"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 0, "creation_date": 1577996461, "post_id": 59547721, "comment_id": 105306820, "body": "What is wrong with <code>grade&#47;division</code>. Could you comment on the return type a little more? What is <code>sub-group by ASC</code>? What is <code>count array</code>? If all that matters is the count of the grades, a <a href=\"https://en.wikipedia.org/wiki/Histogram\" rel=\"nofollow noreferrer\">histogram will be appropriate</a>. However, &quot;need to set NULL,&quot; leads me to believe <a href=\"https://en.wikipedia.org/wiki/Hash_table#Separate_chaining_with_linked_lists\" rel=\"nofollow noreferrer\">that a constant hash table</a> will be more what they are looking for."}], "owner": {"reputation": 29, "user_id": 11127455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239de104b661d35eb6d86b1dd59f1e96?s=128&d=identicon&r=PG&f=1", "display_name": "dor", "link": "https://stackoverflow.com/users/11127455/dor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1577819408, "creation_date": 1577819408, "question_id": 59547721, "link": "https://stackoverflow.com/questions/59547721/dynamic-allocation-pointer-to-pointer-in-c", "title": "dynamic allocation - pointer to pointer in c", "body": "<p>i got exercise from school.</p>\n\n<p>I need to write a function that get array of grades, the size of the array, int number that represent the range of the grades, array that represent the count of the number of the grades in the same range and array that sum the grade of in the range.</p>\n\n<ol>\n<li><p>the function will create sub groups to the grades, for exmaple: if the range of the grades is 10 so that sub groups is: 0-9, 10-19, 20-29, 30-39,...,90-99,100.\nthe range is 10 so the number of the sub-groups is 100/range + 1 (11 in that example which the range is 10).</p></li>\n<li><p>the function will return array that is pointer to pointer, each element in this array will represent the sub-group by ASC.\nif there is no values in the range (sub-group) we need to set NULL.</p></li>\n<li><p>the count array will count the number of the grade in the same range,\nand the sum array will sum those grades.\nwe can assume that the size of those arrays are also 100/range + 1.</p></li>\n</ol>\n\n<p>important: i need to use dynamic allocate memroy.</p>\n\n<p>i think i have the problem to calculate to which index in the range i need to put the grade, it work in some cases, but not to all.</p>\n\n<p>examples:</p>\n\n<pre><code>    int grades[SIZE_GRADES] = {98,45,77,65,89,90,100,43,54,67,55,88,76,67,33,23,45,76,72,76};\n    int avg_grd1[100 / GRD_RANGE1 + 1];\n    int avg_grd2[100 / GRD_RANGE2 + 1];\n    int count_grd1[100 / GRD_RANGE1 + 1];\n    int count_grd2[100 / GRD_RANGE2 + 1];\n    int** arr1 = GradeStat(grades, SIZE_GRADES, GRD_RANGE1, count_grd1, avg_grd1);\n    int** arr2 = GradeStat(grades, SIZE_GRADES, GRD_RANGE2, count_grd2, avg_grd2);\n\n#define GRD_RANGE1 10\n#define GRD_RANGE2 7\n#define SIZE_GRADES 20\n</code></pre>\n\n<p>those are working for me.\nbut what i insert this arrays it didn't: (same vars, just different array).</p>\n\n<pre><code>    int grades[SIZE_GRADES] = { 45,46,58,68,70,73,74,78,90,94 };\n\n#define GRD_RANGE1 10\n#define GRD_RANGE2 15\n#define SIZE_GRADES 10\n</code></pre>\n\n<p>and that's my code:</p>\n\n<pre><code>int** GradeStat(int* Grades, int size_grades, int grd_range, int* count_grd, int* avg_grd)\n{\n    int sub_range = 100 / grd_range + 1;\n    int** class_grd;\n    int place_in_sub_range;\n\n    // alocate memory.\n    class_grd = (int**)calloc(sub_range, sizeof(int));\n    if (class_grd == NULL) {\n        exit(1);\n    }\n\n    for (int i = 0; i &lt; sub_range; i++) {\n        count_grd[i] = 0;\n    }\n    for (int i = 0; i &lt; sub_range; i++) {\n        avg_grd[i] = 0;\n    }\n\n    for (int i = 0; i &lt; SIZE_GRADES; i++) {\n        // the index (place) in the pointer of pointer.\n        place_in_sub_range = Grades[i] / grd_range;\n\n        if (place_in_sub_range &lt;= sub_range) {\n\n            // create new pointer that relevant to the range.\n            if (class_grd[place_in_sub_range] == 0) {\n                // alocate memory, set the grade and set the address of the pointer inside the pointer to pointer array.\n                int* sub_range_pointer = (int*)calloc(1, sizeof(int));\n                if (sub_range_pointer == NULL) {\n                    exit(1);\n                }\n                // save the grade in the memory.\n                *sub_range_pointer = Grades[i];\n                // set the pointer address in the poinet of pointer array.\n                class_grd[place_in_sub_range] = sub_range_pointer;\n                // count the number of grades in each range.\n                count_grd[place_in_sub_range]++;\n                // set the grade in the sum array.\n                avg_grd[place_in_sub_range] = Grades[i];\n            }\n            else {\n                // find out how many elemnts is exist, realloc + add new grade and add the grade to there.\n                int* sub_range_pointer = (int*)realloc(class_grd[place_in_sub_range], count_grd[place_in_sub_range] * sizeof(int) + sizeof(int));\n                if (sub_range_pointer == NULL) {\n                    exit(1);\n                }\n                // set the grade in the relevant range.\n                sub_range_pointer[count_grd[place_in_sub_range]] = Grades[i];\n                // set the pointer address in the poinet of pointer array.\n                class_grd[place_in_sub_range] = sub_range_pointer;\n                // raise the number of grades in the relevant range.\n                count_grd[place_in_sub_range]++;\n                // set the grade in the sum array.\n                avg_grd[place_in_sub_range] = (avg_grd[place_in_sub_range] + Grades[i]) / 2;\n            }\n        }\n        //else {\n        //  return NULL;\n        //}\n    }\n    for (int i = 0; i &lt; sub_range; i++) {\n        if (class_grd[i] == 0) {\n            class_grd[i] = NULL;\n        }\n    }\n\n    // return the pointer of pointer array.\n    return class_grd;\n</code></pre>\n\n<p>so on arr1 my code is working,\nbut on the arr2 it isn't.</p>\n\n<p>i see that when i take the 45 or 46 grade and divine it in the range i'm inserting it to the 3 index (and it should be the second).\nWhen I'm running the code through  the school test checker i get this error:</p>\n\n<pre><code>timeout: the monitored command dumped core ../runTrain.sh: line 1: 21344 Segmentation fault timeout -k 5s 5s ./MainTrain.exe &gt; ./mainTrain.log\n</code></pre>\n"}, {"tags": ["c", "memory", "io", "dma", "pci"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1577834876, "post_id": 59547694, "comment_id": 105267308, "body": "The only reasonable answer is &quot;it depends&quot; \u2014 and it depends on many factors (most of which I probably don&#39;t know about)."}, {"owner": {"reputation": 9461, "user_id": 8422330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0f90445d03447c587d1e595d531f69?s=128&d=identicon&r=PG&f=1", "display_name": "prl", "link": "https://stackoverflow.com/users/8422330/prl"}, "edited": false, "score": 0, "creation_date": 1577850027, "post_id": 59547694, "comment_id": 105268736, "body": "You are correct that DMA concerns a device accessing main memory. It is somewhat related to your question, as I mentioned in my answer."}, {"owner": {"reputation": 667, "user_id": 2762678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee48142c79e0272fef5875126ebe6912?s=128&d=identicon&r=PG&f=1", "display_name": "QnA", "link": "https://stackoverflow.com/users/2762678/qna"}, "edited": false, "score": 0, "creation_date": 1578251849, "post_id": 59547694, "comment_id": 105370636, "body": "found this link to be useful <a href=\"https://stackoverflow.com/a/36463477/2762678\">stackoverflow.com/a/36463477/2762678</a>"}], "answers": [{"comments": [{"owner": {"reputation": 667, "user_id": 2762678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee48142c79e0272fef5875126ebe6912?s=128&d=identicon&r=PG&f=1", "display_name": "QnA", "link": "https://stackoverflow.com/users/2762678/qna"}, "edited": false, "score": 0, "creation_date": 1578109223, "post_id": 59549889, "comment_id": 105341578, "body": "Thanks, @prl. &quot;The best way to do bulk transfer of data to a device is to have the device itself perform DMA&quot; - then why does PCIe devices have memory mapped in the first place? If they map a few bytes and use them as control registers that would be understandable, but they can map more than a few mega bytes."}], "tags": [], "owner": {"reputation": 9461, "user_id": 8422330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0f90445d03447c587d1e595d531f69?s=128&d=identicon&r=PG&f=1", "display_name": "prl", "link": "https://stackoverflow.com/users/8422330/prl"}, "is_accepted": true, "score": 1, "last_activity_date": 1577850235, "creation_date": 1577850235, "answer_id": 59549889, "question_id": 59547694, "link": "https://stackoverflow.com/questions/59547694/is-accessing-mapped-device-memory-slow-in-terms-of-latency/59549889#59549889", "title": "Is accessing mapped device memory slow (in terms of latency)?", "body": "<p>Yes, accessing memory-mapped I/O (MMIO) is slow.</p>\n\n<p>The primary reason that it is slow is that it is typically uncacheable,\nso every access has to go all the way to the device.\nIn x86 systems, which I am most familiar with, cacheable memory is accessed in 64-byte chunks,\neven though processor instructions typically access memory in 1, 2, 4, or 8 byte chunks.\nIf multiple processor instructions access adjacent cacheable memory locations, all but the first access are satisfied from the cache. For similar accesses to device memory, every access incurs the full latency to the device and back.</p>\n\n<p>The second reason is that the path from the processors to memory are critical to performance and are highly optimized.\nThe path to devices has always been slow, so software is designed to compensate for that, and optimizing the performance of MMIO isn't a priority.</p>\n\n<p>Another related reason is that PCI has ordering rules that require accesses to be buffered and processed in a strict order.\nThe memory system can handle ordering in a much more flexible way. For example, a dirty cache line may be written to memory at any convenient time. MMIO accesses must be performed precisely in the order that they are executed by the CPU.</p>\n\n<p>The best way to do bulk transfer of data to a device is to have the device itself perform DMA, \"pulling\" the data from memory into the device, rather than \"pushing\" it from the CPU to the device. (This also reduces the load on the CPU, freeing it to do other useful work.)</p>\n"}], "owner": {"reputation": 667, "user_id": 2762678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee48142c79e0272fef5875126ebe6912?s=128&d=identicon&r=PG&f=1", "display_name": "QnA", "link": "https://stackoverflow.com/users/2762678/qna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 218, "favorite_count": 1, "accepted_answer_id": 59549889, "answer_count": 1, "score": 1, "last_activity_date": 1577850235, "creation_date": 1577819178, "last_edit_date": 1577819627, "question_id": 59547694, "link": "https://stackoverflow.com/questions/59547694/is-accessing-mapped-device-memory-slow-in-terms-of-latency", "title": "Is accessing mapped device memory slow (in terms of latency)?", "body": "<p>I know the question is vague.. but here is what I hope to learn: the MCU directs some part of memory address to devices on the PCI bus, hence in theory user/kernel code can directly read/write device memory as if it were  main memory. But data in and out of PCI Express devices are packaged/serialized/transmitted in lanes, which means each read/write incurs significant overhead, such as packaging (add headers) and un-packaging. So that means it is not ideal for user/kernel to read device memory a byte at a time, instead it should do some sort of bulk transfer. If so, what is the preferred mechanism and API?</p>\n\n<p>BTW, I know there is DMA, but it seems to me that DMA does not require device memory to be directly mapped into main memory address space - DMA is about letting device access main memory, and my question is the other way, letting user/kernel access device memory. So I am guessing it is not related to the question above, is that correct?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 4, "creation_date": 1577815378, "post_id": 59547242, "comment_id": 105263462, "body": "Read <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">this article</a> for tips on debugging your code. This is a critical skill to learn as you learn to write code."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1577816661, "post_id": 59547242, "comment_id": 105263832, "body": "You definitely should learn how to use a debugger, to single step through your code, inspecting all relevant variables to understand what is <i>really</i> going on."}, {"owner": {"reputation": 65, "user_id": 12633374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b056f3bded22e3b940bfaa66a867c34d?s=128&d=identicon&r=PG&f=1", "display_name": "user1780131", "link": "https://stackoverflow.com/users/12633374/user1780131"}, "edited": false, "score": 0, "creation_date": 1577816800, "post_id": 59547242, "comment_id": 105263879, "body": "Yeah that&#39;s on my to do list, whenever I get some free time, but thanks"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1577816821, "post_id": 59547242, "comment_id": 105263883, "body": "Why did you delete the relevant code?"}, {"owner": {"reputation": 65, "user_id": 12633374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b056f3bded22e3b940bfaa66a867c34d?s=128&d=identicon&r=PG&f=1", "display_name": "user1780131", "link": "https://stackoverflow.com/users/12633374/user1780131"}, "edited": false, "score": 0, "creation_date": 1577816921, "post_id": 59547242, "comment_id": 105263906, "body": "Must&#39;ve accidentally happened, fixing it."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1577816956, "post_id": 59547242, "comment_id": 105263918, "body": "The current version is not compilable, so it is not a question seeking help to debug. Also it never has been a specific question, so as it stands it is off-topic. I&#39;d rolled it back to the previous version."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1577817094, "post_id": 59547242, "comment_id": 105263952, "body": "Still incomplete, compared to the 1st version."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1577817139, "post_id": 59547242, "comment_id": 105263969, "body": "Goto to the edit-history, scroll down to version 1 and click the &quot;rollback&quot; button."}, {"owner": {"reputation": 65, "user_id": 12633374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b056f3bded22e3b940bfaa66a867c34d?s=128&d=identicon&r=PG&f=1", "display_name": "user1780131", "link": "https://stackoverflow.com/users/12633374/user1780131"}, "edited": false, "score": 0, "creation_date": 1577817626, "post_id": 59547242, "comment_id": 105264094, "body": "Fixed now, edited it to user suggestion but guess not"}], "answers": [{"comments": [{"owner": {"reputation": 1910, "user_id": 10305444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdffaf7c0a3d7d398e9b004acd125cd6?s=128&d=identicon&r=PG", "display_name": "Maifee Ul Asad", "link": "https://stackoverflow.com/users/10305444/maifee-ul-asad"}, "edited": false, "score": 0, "creation_date": 1577816467, "post_id": 59547370, "comment_id": 105263766, "body": "if he is using pointer then why is he even returning that value?? isn&#39;t it odd ? He should pass that as pointer"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 1910, "user_id": 10305444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdffaf7c0a3d7d398e9b004acd125cd6?s=128&d=identicon&r=PG", "display_name": "Maifee Ul Asad", "link": "https://stackoverflow.com/users/10305444/maifee-ul-asad"}, "edited": false, "score": 0, "creation_date": 1577816529, "post_id": 59547370, "comment_id": 105263786, "body": "@MaifeeUlAsad: There often are different solutions for one problem."}, {"owner": {"reputation": 1910, "user_id": 10305444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdffaf7c0a3d7d398e9b004acd125cd6?s=128&d=identicon&r=PG", "display_name": "Maifee Ul Asad", "link": "https://stackoverflow.com/users/10305444/maifee-ul-asad"}, "edited": false, "score": 0, "creation_date": 1577816648, "post_id": 59547370, "comment_id": 105263825, "body": "of course there is.. then why use pointer.. isn&#39;t it like eating food without test ??"}, {"owner": {"reputation": 65, "user_id": 12633374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b056f3bded22e3b940bfaa66a867c34d?s=128&d=identicon&r=PG&f=1", "display_name": "user1780131", "link": "https://stackoverflow.com/users/12633374/user1780131"}, "edited": false, "score": 0, "creation_date": 1577816882, "post_id": 59547370, "comment_id": 105263898, "body": "Thanks, that was the issue indeed :)"}], "tags": [], "owner": {"reputation": 9095, "user_id": 8542346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b206b49cec657d28a5876f8330780e?s=128&d=identicon&r=PG&f=1", "display_name": "H.S.", "link": "https://stackoverflow.com/users/8542346/h-s"}, "is_accepted": true, "score": 1, "last_activity_date": 1577816272, "creation_date": 1577816272, "answer_id": 59547370, "question_id": 59547242, "link": "https://stackoverflow.com/questions/59547242/how-can-i-modify-a-string-thats-in-an-array-of-pointers/59547370#59547370", "title": "How can I modify a string that&#39;s in an array of pointers?", "body": "<p>The function <code>encrypt_char()</code> returns the encrypted character but you are not assigning it. In the <code>encrypt_words()</code> you need to do:</p>\n\n<pre><code>tempArr[j] = encrypt_char(key, tempArr[j]);\n</code></pre>\n\n<p>With this, I am getting the expected output:</p>\n\n<pre><code>$ ./a.out\nSILVER\nLOSCTK\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 12633374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b056f3bded22e3b940bfaa66a867c34d?s=128&d=identicon&r=PG&f=1", "display_name": "user1780131", "link": "https://stackoverflow.com/users/12633374/user1780131"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 59547370, "answer_count": 1, "score": 1, "last_activity_date": 1577817588, "creation_date": 1577815284, "last_edit_date": 1577817588, "question_id": 59547242, "link": "https://stackoverflow.com/questions/59547242/how-can-i-modify-a-string-thats-in-an-array-of-pointers", "title": "How can I modify a string that&#39;s in an array of pointers?", "body": "<p>I wrote the following code, in short it's supposed to \"encrypt\" the user inputted message according to the key array in the main function, say if the user inputs the word \"holidays\" then it should print it out as \"qoervmhj\", and if the input is \"SILVER\" then the output should be \"LOSCTK\" and so forth. Now when I try to run the code, it just prints the input without modifying it for some reason, I can't pinpoint the problem, I suspect it's got something to do with the encrypt_words function, my thought process was that since \"words\" is an array of pointers, I could just access the content of \"words[i]\", encrypt it and then copy it back to \"words[i]\", but now I am not sure, would appreciate any help. </p>\n\n<pre><code>      /*-------------------------------------------------------------------------\n  Include files:\n--------------------------------------------------------------------------*/\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define KEY_SIZE 52\n#define WORDS_ARRAY_SIZE 100\n#define MAX_STR_LEN 50\n#define ARR_PLACE 71\n\nchar encrypt_char(unsigned char key[KEY_SIZE], char ch);\nint read_words(char* words[], int size, int max_str_len);\nvoid encrypt_words(char* words[], int num_words, unsigned char key[KEY_SIZE]);\nvoid release_memory(char* words[], int num_words);\n\nvoid print_words(char* words[], int num_words)\n{\n    int i;\n    for ( i = 0; i &lt; num_words; i++) {\n        printf(\"%s\\n\", words[i]);\n    }\n}\n\n/*--------------------------------------------------------------------------------------------*/\n\nint main()\n{\n    unsigned char key[KEY_SIZE] = {\n\n        '&gt;', 'W', 'E', 'R', 'T', 'Y', 'U', 'I', 'O', 'P', '~', 'S', 'D',\n        'F', 'G', '*', 'J', 'K', 'L', 'Z', 'X', 'C', 'V', 'B', '+', 'M',\n        'm','b','n','v','z','c','@','q','r','u','i','e','r',\n        't','o','p','w','$','j','g','d','%','s','f','h','k'\n    };\n    int num_words =0, i;\n    char* words[WORDS_ARRAY_SIZE];\n\n    for ( i = 0; i &lt; WORDS_ARRAY_SIZE; i++) {\n        words[i] = NULL;\n    }\n\n    num_words = read_words(words, WORDS_ARRAY_SIZE, MAX_STR_LEN);\n    if (num_words == -1)\n    {\n    printf(\"Failed to read words.\\n\");\n    return 0;\n    }\n    encrypt_words(words, num_words, key);\n    print_words(words, num_words);\n    release_memory(words, num_words);\n    return 0;\n}\n\n/*--------------------------------------------------------------------------------------------*/\nchar encrypt_char(unsigned char key[KEY_SIZE], char ch)\n{\n    int temp=0;\n    if(ch&gt;='A' &amp;&amp; ch&lt;='Z')\n        {\n        temp=ch-'A';\n        }\n\n    else if(ch&gt;='a' &amp;&amp; ch&lt;='z')\n        {\n        temp=ch-ARR_PLACE;\n        }\n\n    return key[temp];\n}\n\n/*--------------------------------------------------------------------------------------------*/\n\nint read_words(char* words[], int size, int max_str_len)\n{\n    int counter=0;\n    int length=0;\n    char tempWord[max_str_len];\n    while(counter&lt;size &amp;&amp; (scanf(\"%s\", tempWord)!=EOF))\n        {\n          length=strlen(tempWord);\n          words[counter] = (char*)malloc(sizeof(char)*(length)+1);\n          if(words[counter]==NULL)\n          {\n              return -1;\n          }\n\n          strcpy(words[counter], tempWord);\n          counter++;\n          continue;\n        }\n\n\n\n    return counter;\n\n}\n\n/*--------------------------------------------------------------------------------------------*/\n\nvoid encrypt_words(char* words[], int num_words, unsigned char key[KEY_SIZE])\n{\n    char tempArr[MAX_STR_LEN];\n    for(int i=0; i&lt;num_words; i++)\n    {\n        strcpy(tempArr, words[i]);\n        int length=strlen(tempArr);\n        for(int j=0; j&lt;length; j++)\n        {\n            encrypt_char(key, tempArr[j]);\n        }\n\n        strcpy(words[i],tempArr);\n    }\n\n}\n\n/*--------------------------------------------------------------------------------------------*/\n\nvoid release_memory(char* words[], int num_words)\n{\n    int i=0;\n    while(i&lt;num_words)\n    {\n        free(words[i]);\n        i++;\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "linux-kernel", "arm", "watchdog"], "comments": [{"owner": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1577999611, "post_id": 59547136, "comment_id": 105307856, "body": "Can&#39;t you open in non-exclusive mode in all processes?"}, {"owner": {"reputation": 18888, "user_id": 1880339, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/0PkGx.png?s=128&g=1", "display_name": "artless noise", "link": "https://stackoverflow.com/users/1880339/artless-noise"}, "edited": false, "score": 0, "creation_date": 1578060559, "post_id": 59547136, "comment_id": 105326204, "body": "A better way is an ipc to kicker.  You circumvent the wdog if you kick from two places."}, {"owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "edited": false, "score": 1, "creation_date": 1580426243, "post_id": 59547136, "comment_id": 106103992, "body": "Most hardware only supports one watchdog timer.  If you want two processes that feed the watchdog, you can fork after opening it -- but you still only have one watchdog.  There&#39;s no way to set it up so that it will trigger if either process dies; only if both die."}, {"owner": {"reputation": 75, "user_id": 12548220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80d07553f91fc0ebf58abb73b86027a1?s=128&d=identicon&r=PG&f=1", "display_name": "yfr24493AzzrggAcom", "link": "https://stackoverflow.com/users/12548220/yfr24493azzrggacom"}, "reply_to_user": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "edited": false, "score": 0, "creation_date": 1580463046, "post_id": 59547136, "comment_id": 106113327, "body": "@Chris Dodd that not the question.  The post talking about 1 watchdog (/dev/watchdog) that ping from 2 processes"}, {"owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "edited": false, "score": 1, "creation_date": 1580491400, "post_id": 59547136, "comment_id": 106127552, "body": "@yfr24493AzzrggAcom: Not clear what you are asking -- having two processes sending pings to one watchdog is pretty much pointless and defeats the whole point of a watchdog (which is to detect if a process died).  What are you trying to do?"}, {"owner": {"reputation": 150, "user_id": 6724071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e153cb6ddbc1f7142eea547d6ae2dff?s=128&d=identicon&r=PG&f=1", "display_name": "JonBelanger", "link": "https://stackoverflow.com/users/6724071/jonbelanger"}, "edited": false, "score": 0, "creation_date": 1580592708, "post_id": 59547136, "comment_id": 106150102, "body": "How are you opening the file handle?  You may also have to set up the configuration for it, but let&#39;s start with the first question."}], "answers": [{"tags": [], "owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "is_accepted": false, "score": 3, "last_activity_date": 1580821925, "last_edit_date": 1580821925, "creation_date": 1580782967, "answer_id": 60049717, "question_id": 59547136, "link": "https://stackoverflow.com/questions/59547136/how-to-ping-dev-watchdog-from-2-processes/60049717#60049717", "title": "How to ping /dev/watchdog from 2 processes?", "body": "<p>Due to the implementation of <code>/dev/watchdog</code> in the kernel, only one process can use it at the same time, so opening <code>/dev/watchdog</code> from two different processes is not possible.</p>\n\n<p>You can see this right in the source code of the Linux kernel, specifically in <a href=\"https://elixir.bootlin.com/linux/latest/source/drivers/watchdog/watchdog_dev.c#L838\" rel=\"nofollow noreferrer\"><code>drivers/watchdog/watchdog_dev.c</code></a>. Here's the relevant snippet of code:</p>\n\n<pre><code>/*\n *  watchdog_open: open the /dev/watchdog* devices.\n *  @inode: inode of device\n *  @file: file handle to device\n *\n *  When the /dev/watchdog* device gets opened, we start the watchdog.\n *  Watch out: the /dev/watchdog device is single open, so we make sure\n *  it can only be opened once.\n */\n\nstatic int watchdog_open(struct inode *inode, struct file *file)\n{\n    /* ... */\n\n    /* the watchdog is single open! */\n    if (test_and_set_bit(_WDOG_DEV_OPEN, &amp;wd_data-&gt;status))\n        return -EBUSY;\n\n    /* ... */\n</code></pre>\n\n<p>If you want to feed the watchdog from two different processes, you can work around this issue by creating a simple \"master\" program that talks to the watchdog while orchestrating the two subprocesses as you wish. This can be done in different ways (pipes, sockets, threads, etc). A single <a href=\"http://man7.org/linux/man-pages/man3/popen.3.html\" rel=\"nofollow noreferrer\"><code>popen()</code></a> per child process is the simplest way.</p>\n\n<p>Here's a working example, <code>master.c</code>:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;sys/ioctl.h&gt;\n#include &lt;linux/watchdog.h&gt;\n\nint main(int argc, char **argv) {\n    int watchdog_fd;\n    FILE *child1_fp, *child2_fp;\n\n    if (argc != 3 || !argv[1] || !*argv[1] || !argv[2] || !*argv[2]) {\n        fprintf(stderr, \"Usage: %s 'CHILD_1_COMMAND' 'CHILD_2_COMMAND'\\n\", argv[0]);\n        return 1;\n    }\n\n    // Open a fd to talk to the watchdog.\n    watchdog_fd = open(\"/dev/watchdog\", O_RDWR);\n    if (watchdog_fd == -1) {\n        perror(\"open failed\");\n        return 1;\n    }\n\n    // Start the first process.\n    child1_fp = popen(argv[1], \"r\");\n    if (child1_fp == NULL) {\n        perror(\"popen (1) failed\");\n        return 1;\n    }\n\n    // Start the second process.\n    child2_fp = popen(argv[2], \"r\");\n    if (child2_fp == NULL) {\n        perror(\"popen (2) failed\");\n        return 1;\n    }\n\n    while (1) {\n        char tmp;\n        size_t count;\n\n        // Get one byte of data from each of the two processes.\n        count = fread(&amp;tmp, 1, 1, child1_fp);\n        count += fread(&amp;tmp, 1, 1, child2_fp);\n\n        // If both processes provided the data, ping the watchdog.\n        if (count == 2) {\n            if (ioctl(watchdog_fd, WDIOC_KEEPALIVE, 0) &lt; 0)\n                perror(\"ioctl failed\");\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>And two identical programs <code>a.c</code> and <code>b.c</code> just for testing purposes:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n\nint main(void) {\n    setvbuf(stdout, NULL, _IONBF, 0);\n\n    while (1) {\n        putchar('x');\n        sleep(10);\n    }\n}\n</code></pre>\n\n<p>Compile and run:</p>\n\n<pre><code>$ gcc -o master master.c\n$ gcc -o a a.c\n$ gcc -o b b.c\n\n$ ./master ./a ./b\n</code></pre>\n\n<p>In the above example code, <code>master</code> pings the watchdog <em>if and only if</em> the two children are alive and running: if one of the two hangs or dies, the master will stop pinging the watchdog. However, it's simple to rework the logic to work differently, and it's also simple to make it work with more than two child processes.</p>\n"}], "owner": {"reputation": 75, "user_id": 12548220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80d07553f91fc0ebf58abb73b86027a1?s=128&d=identicon&r=PG&f=1", "display_name": "yfr24493AzzrggAcom", "link": "https://stackoverflow.com/users/12548220/yfr24493azzrggacom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 642, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1580931895, "creation_date": 1577814637, "last_edit_date": 1580931895, "question_id": 59547136, "link": "https://stackoverflow.com/questions/59547136/how-to-ping-dev-watchdog-from-2-processes", "title": "How to ping /dev/watchdog from 2 processes?", "body": "<p>In Linux (running on ARM) there is one process that has an open fd to <code>/dev/watchdog/</code> and is sending an <code>ioctl()</code> each few seconds as a keep alive:</p>\n\n<pre><code>while (1) { \n    ioctl(fd, WDIOC_KEEPALIVE, 0);\n    sleep(10);\n}\n</code></pre>\n\n<p>I want to send the keep alive from another process too, but I can't open another fd to <code>/dev/watchdog/</code>: when I tried to echo to <code>/dev/watchdog/</code> I get the error \"Device or resource busy\".</p>\n\n<ol>\n<li><p>Where I can see that the watchdog is defined to work only with 1 process at a time? (I saw in another Linux that some processes can open fd to <code>/dev/watchdog/</code>).</p></li>\n<li><p>What can I do to feed the watchdog from 2 processes?</p></li>\n</ol>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 43, "user_id": 10600202, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ipVSVo5kGOQ/AAAAAAAAAAI/AAAAAAAAAXI/07G8uaFfsRo/photo.jpg?sz=128", "display_name": "Allan", "link": "https://stackoverflow.com/users/10600202/allan"}, "edited": false, "score": 0, "creation_date": 1577813969, "post_id": 59547011, "comment_id": 105263066, "body": "Thank you. Your question sparked a solution in my mind."}, {"owner": {"reputation": 43, "user_id": 10600202, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ipVSVo5kGOQ/AAAAAAAAAAI/AAAAAAAAAXI/07G8uaFfsRo/photo.jpg?sz=128", "display_name": "Allan", "link": "https://stackoverflow.com/users/10600202/allan"}, "edited": false, "score": 0, "creation_date": 1577814040, "post_id": 59547011, "comment_id": 105263086, "body": "but that didnt work"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1577814066, "post_id": 59547011, "comment_id": 105263092, "body": "That function is all kinds of wrong. It almost looks like a different author wrote it. Even if you fix the null check, <code>head</code> is <i>still</i> null at the end of the function, thereby returning NULL to the caller and leaking memory as a bonus."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1577814123, "post_id": 59547011, "comment_id": 105263110, "body": "<a href=\"https://www.geeksforgeeks.org/linked-list-set-1-introduction/\" rel=\"nofollow noreferrer\">Go back to the basics</a>  (there are several links on this page with suggestions relevant to your assignment.)"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 10600202, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ipVSVo5kGOQ/AAAAAAAAAAI/AAAAAAAAAXI/07G8uaFfsRo/photo.jpg?sz=128", "display_name": "Allan", "link": "https://stackoverflow.com/users/10600202/allan"}, "edited": false, "score": 0, "creation_date": 1577814231, "post_id": 59547060, "comment_id": 105263143, "body": "How to solve it then"}, {"owner": {"reputation": 43, "user_id": 10600202, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ipVSVo5kGOQ/AAAAAAAAAAI/AAAAAAAAAXI/07G8uaFfsRo/photo.jpg?sz=128", "display_name": "Allan", "link": "https://stackoverflow.com/users/10600202/allan"}, "edited": false, "score": 0, "creation_date": 1577814458, "post_id": 59547060, "comment_id": 105263203, "body": "Doesn&#39;t work. I&#39;ve tried initialing head. But shows the same error."}], "tags": [], "owner": {"reputation": 1141, "user_id": 6384727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4f80d10dadbe83078d01fff8f98ad4e?s=128&d=identicon&r=PG&f=1", "display_name": "E.N.D", "link": "https://stackoverflow.com/users/6384727/e-n-d"}, "is_accepted": false, "score": 1, "last_activity_date": 1577813891, "creation_date": 1577813891, "answer_id": 59547060, "question_id": 59547011, "link": "https://stackoverflow.com/questions/59547011/why-is-hackerrank-showing-segmentation-error-for-the-following-c-code/59547060#59547060", "title": "Why is Hackerrank showing segmentation error for the following C code?", "body": "<p>If head is NULL, then when your code does <code>SinglyLinkedListNode *p = head;</code>, p is NULL and thus <code>p-&gt;next</code> in while loop's condition should throw bad access aka SegFault.</p>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 10600202, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ipVSVo5kGOQ/AAAAAAAAAAI/AAAAAAAAAXI/07G8uaFfsRo/photo.jpg?sz=128", "display_name": "Allan", "link": "https://stackoverflow.com/users/10600202/allan"}, "edited": false, "score": 0, "creation_date": 1578638071, "post_id": 59547247, "comment_id": 105511021, "body": "Thanks so much. Helped a lot."}], "tags": [], "owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "is_accepted": true, "score": 2, "last_activity_date": 1577841750, "last_edit_date": 1577841750, "creation_date": 1577815318, "answer_id": 59547247, "question_id": 59547011, "link": "https://stackoverflow.com/questions/59547011/why-is-hackerrank-showing-segmentation-error-for-the-following-c-code/59547247#59547247", "title": "Why is Hackerrank showing segmentation error for the following C code?", "body": "<p>You never check <code>head</code> for <code>NULL</code> prior to enumeration of the list. If there is no \"there\" there, this:</p>\n\n<pre><code>SinglyLinkedListNode* insertNodeAtTail(SinglyLinkedListNode* head, int data) {\n    SinglyLinkedListNode *newNode = (SinglyLinkedListNode*)malloc(sizeof(SinglyLinkedListNode));\n    SinglyLinkedListNode *p = head;\n\n    // HERE. If head was NULL then so is p, therefore p-&gt;next is BAD\n    while (p-&gt;next != NULL) {\n        p = p-&gt;next;\n    }\n    newNode-&gt;data = data;\n    newNode-&gt;next = p-&gt;next;\n    p-&gt;next = newNode;\n    return head;\n}\n</code></pre>\n\n<p>There are multiple ways to address this, one simple to understand, one efficient to code. Among the things to consider:</p>\n\n<ol>\n<li>Use either a prev-pointer or a pointer-to-pointer solution to acquire the last node in the list.</li>\n<li>This is C code. <a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">Don't cast <code>malloc</code> in C code</a></li>\n</ol>\n\n<p>One possible solution is the following. Though it is easier to understand what is going on, it takes more code than an alternate solution which I'll show in a moment:</p>\n\n<pre><code>SinglyLinkedListNode* insertNodeAtTail(SinglyLinkedListNode* head, int data)\n{\n    SinglyLinkedListNode *prev = NULL;\n    SinglyLinkedListNode *p = head;\n    while (p)\n    {\n        prev = p;\n        p = p-&gt;next;\n    }\n\n    p = malloc(sizeof *p);\n    p-&gt;data = data;\n    p-&gt;next = NULL;\n\n    if (prev)\n        prev-&gt;next = p;\n    else\n        head = p;\n\n    return head;\n}\n</code></pre>\n\n<p>An alternative involves using a pointer to pointer, and utilizing the address of pointers within the list itself, rather than walking by pointer-value. It's more difficult to understand, but considerably less code.</p>\n\n<pre><code>SinglyLinkedListNode* insertNodeAtTail(SinglyLinkedListNode* head, int data)\n{\n    SinglyLinkedListNode **pp = &amp;head;\n    while (*pp)\n        pp = &amp;(*pp)-&gt;next;\n\n    *pp = malloc(sizeof **pp);\n    (*pp)-&gt;data = data;\n    (*pp)-&gt;next = NULL;\n\n    return head;\n}\n</code></pre>\n\n<p>Note that if <code>head</code> contains <code>NULL</code> on entry, the loop immediately terminates, <code>pp</code> still holds the address of the <code>head</code> pointer, populates it with a new node, then returns whatever <code>head</code> contains (the new node address). If <code>head</code> did <em>not</em> contain <code>NULL</code> on entry then <code>pp</code> contains the address of the last <code>next</code> pointer in the list (which will contain <code>NULL</code>) and the new node is hung right there. In that case <code>head</code> remains unchanged and the original <code>head</code> is simply returned.</p>\n\n<p>Hope it helps.</p>\n"}], "owner": {"reputation": 43, "user_id": 10600202, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ipVSVo5kGOQ/AAAAAAAAAAI/AAAAAAAAAXI/07G8uaFfsRo/photo.jpg?sz=128", "display_name": "Allan", "link": "https://stackoverflow.com/users/10600202/allan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 368, "favorite_count": 0, "closed_date": 1577869080, "accepted_answer_id": 59547247, "answer_count": 2, "score": -2, "last_activity_date": 1577841750, "creation_date": 1577813523, "question_id": 59547011, "link": "https://stackoverflow.com/questions/59547011/why-is-hackerrank-showing-segmentation-error-for-the-following-c-code", "closed_reason": "Needs details or clarity", "title": "Why is Hackerrank showing segmentation error for the following C code?", "body": "<p><strong>Hackerrank Problem Description:</strong></p>\n\n<p>You are given the pointer to the head node of a linked list and an integer to add to the list. Create a new node with the given integer. Insert this node at the tail of the linked list and return the head node of the linked list formed after inserting this new node. The given head pointer may be null, meaning that the initial list is empty.</p>\n\n<p><strong>Input Format</strong></p>\n\n<p>You have to complete the SinglyLinkedListNode insertAtTail(SinglyLinkedListNode head, int data) method. It takes two arguments: the head of the linked list and the integer to insert at tail. You should not read any input from the stdin/console.</p>\n\n<p>The input is handled by code editor and is as follows:\nThe first line contains an integer , denoting the elements of the linked list.\nThe next  lines contain an integer each, denoting the element that needs to be inserted at tail.</p>\n\n<p><strong>Constraints</strong></p>\n\n<p><strong>Output Format</strong></p>\n\n<p>Insert the new node at the tail and just return the head of the updated linked list. Do not print anything to stdout/console.</p>\n\n<p>The output is handled by code in the editor and is as follows:\nPrint the elements of the linked list from head to tail, each in a new line.</p>\n\n<p><strong>Sample Input</strong></p>\n\n<p>5\n141\n302\n164\n530\n474</p>\n\n<p><strong>Sample Output</strong></p>\n\n<p>141\n302\n164\n530\n474</p>\n\n<p><strong>Explanation</strong></p>\n\n<p>First, the linked list is NULL. </p>\n\n<p>After inserting 141, the list is 141 -> NULL.</p>\n\n<p>After inserting 302, the list is 141 -> 302 -> NULL.</p>\n\n<p>After inserting 164, the list is 141 -> 302 -> 164 -> NULL.</p>\n\n<p>After inserting 530, the list is 141 -> 302 -> 164 -> 530 -> NULL. </p>\n\n<p>After inserting 474, the list is 141 -> 302 -> 164 -> 530 -> 474 -> NULL, which is the final list.</p>\n\n<p><strong>My code:</strong></p>\n\n<pre><code>#include &lt;assert.h&gt;\n#include &lt;limits.h&gt;\n#include &lt;math.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;stddef.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nchar* readline();\n\ntypedef struct SinglyLinkedListNode SinglyLinkedListNode;\ntypedef struct SinglyLinkedList SinglyLinkedList;\n\nstruct SinglyLinkedListNode {\n    int data;\n    SinglyLinkedListNode* next;\n};\n\nstruct SinglyLinkedList {\n    SinglyLinkedListNode* head;\n};\n\nSinglyLinkedListNode* create_singly_linked_list_node(int node_data) {\n    SinglyLinkedListNode* node = malloc(sizeof(SinglyLinkedListNode));\n\n    node-&gt;data = node_data;\n    node-&gt;next = NULL;\n\n    return node;\n}\n\nvoid print_singly_linked_list(SinglyLinkedListNode* node, char* sep, FILE* fptr) {\n    while (node) {\n        fprintf(fptr, \"%d\", node-&gt;data);\n\n        node = node-&gt;next;\n\n        if (node) {\n            fprintf(fptr, \"%s\", sep);\n        }\n    }\n}\n\nvoid free_singly_linked_list(SinglyLinkedListNode* node) {\n    while (node) {\n        SinglyLinkedListNode* temp = node;\n        node = node-&gt;next;\n\n        free(temp);\n    }\n}\n\n// Complete the insertNodeAtTail function below.\n\n/*\n * For your reference:\n *\n * SinglyLinkedListNode {\n *     int data;\n *     SinglyLinkedListNode* next;\n * };\n *\n */\n//This is the required function which I have written\nSinglyLinkedListNode* insertNodeAtTail(SinglyLinkedListNode* head, int data) {\nSinglyLinkedListNode *newNode = (SinglyLinkedListNode*)malloc (sizeof(SinglyLinkedListNode));\n SinglyLinkedListNode *p = head;\nwhile(p-&gt;next!=NULL){\n    p=p-&gt;next;\n}\nnewNode-&gt;data = data;\nnewNode -&gt;next = p-&gt;next;\np -&gt;next = newNode;\nreturn head;\n\n}\n\n\nint main()\n{\n    FILE* fptr = fopen(getenv(\"OUTPUT_PATH\"), \"w\");\n\n    SinglyLinkedList* llist = malloc(sizeof(SinglyLinkedList));\n    llist-&gt;head = NULL;\n\n    char* llist_count_endptr;\n    char* llist_count_str = readline();\n    int llist_count = strtol(llist_count_str, &amp;llist_count_endptr, 10);\n\n    if (llist_count_endptr == llist_count_str || *llist_count_endptr != '\\0') { exit(EXIT_FAILURE); }\n\n    for (int i = 0; i &lt; llist_count; i++) {\n        char* llist_item_endptr;\n        char* llist_item_str = readline();\n        int llist_item = strtol(llist_item_str, &amp;llist_item_endptr, 10);\n\n        if (llist_item_endptr == llist_item_str || *llist_item_endptr != '\\0') { exit(EXIT_FAILURE); }\n\n        SinglyLinkedListNode* llist_head = insertNodeAtTail(llist-&gt;head, llist_item);\n        llist-&gt;head = llist_head;\n    }\n\n\n\n    char *sep = \"\\n\";\n\n    print_singly_linked_list(llist-&gt;head, sep, fptr);\n    fprintf(fptr, \"\\n\");\n\n    free_singly_linked_list(llist-&gt;head);\n\n    fclose(fptr);\n\n    return 0;\n}\n\nchar* readline() {\n    size_t alloc_length = 1024;\n    size_t data_length = 0;\n    char* data = malloc(alloc_length);\n\n    while (true) {\n        char* cursor = data + data_length;\n        char* line = fgets(cursor, alloc_length - data_length, stdin);\n\n        if (!line) {\n            break;\n        }\n\n        data_length += strlen(cursor);\n\n        if (data_length &lt; alloc_length - 1 || data[data_length - 1] == '\\n') {\n            break;\n        }\n\n        alloc_length &lt;&lt;= 1;\n\n        data = realloc(data, alloc_length);\n\n        if (!line) {\n            break;\n        }\n    }\n\n    if (data[data_length - 1] == '\\n') {\n        data[data_length - 1] = '\\0';\n\n        data = realloc(data, data_length);\n    } else {\n        data = realloc(data, data_length + 1);\n\n        data[data_length] = '\\0';\n    }\n\n    return data;\n}\n</code></pre>\n\n<p><strong>Output:</strong>\nCore was generated by `./Solution'.\nProgram terminated with signal SIGSEGV, Segmentation fault.</p>\n"}, {"tags": ["c", "arm", "embedded", "stm32", "gpio"], "answers": [{"comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1577879976, "post_id": 59546939, "comment_id": 105273157, "body": "This answer goes too far. OP did not ask - how to create my own startup and libc"}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1577881806, "post_id": 59546939, "comment_id": 105273512, "body": "The op can ignore that part and look at the C code.  If you want to replace the delay function then you want to control the thing from boot (control clock rate), cant start in the middle and/or need to know what the setup was up front to know how to undo it or use it to both setup the gpio and do the time measurement.  might as well provide a complete few dozen lines of code sample that does 100%. 100% of the code is provided and any version of gcc/binutils from a decade and a half ago or so till now should build it.  Navigating a hybrid is too hard to show here and not as simple."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1577882140, "post_id": 59546939, "comment_id": 105273578, "body": "The OP did ask how to do it without the library, the startup is generally part of the environment including library from the chip vendor, its a turn key package.  Being free from the library means being free from the package, you will find implementations where they are intimately linked and non-separable."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 1, "creation_date": 1577882389, "post_id": 59546939, "comment_id": 105273617, "body": "no. OP asked how to do it without the STM HAL Library. STM provided startup code is not the part of it, and is not also the part of it. BTW your startup is not C compliant."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 1, "creation_date": 1577882483, "post_id": 59546939, "comment_id": 105273637, "body": "Secondly CMSIS headers are not part of the library and strongly suggest to use those definitions even if you want to be 100% bare metal. #defines are not libraries"}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1577882622, "post_id": 59546939, "comment_id": 105273675, "body": "If you look at both how arm is trying to use CMSIS and how badly they are implemented by the chip vendors, it is a strong suggestion to not use them and or learn how to not use them.  ARM and cortex-ms were around a long while before this CMSIS mess came about.  And the world survived.  it is not arms business to try to drive how the chip vendors deal with their own portion of the chip the arm part is nearly invisible as so little of the code deals with it (as we see with chip vendors coming out with matching parts using risc-v)"}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1577882740, "post_id": 59546939, "comment_id": 105273704, "body": "It is a valuable life lesson and good for a professional if that is what the OP is interested in being in this field to understand the problems with CMSIS in particular, as well as the problems with libraries in general as your boss wont care if you try to blame the library (that you should have inspected, blessed and as a result owned) when the product fails.  It will be you that gets fired.  Learn both, learn the pros and cons of both, but you have to start somewhere."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1577882862, "post_id": 59546939, "comment_id": 105273736, "body": "Please feel free to vote to delete this answer if you are unhappy with it."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1577883313, "post_id": 59546939, "comment_id": 105273853, "body": "First of all - Happy New Year :). Secondly CMSIS is split into two main things - definitions and some libraries which I do not use. The first part with human friendly definitions and typedefs is 100% OK\\"}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1577893525, "post_id": 59546939, "comment_id": 105276118, "body": "Happy New year as well.  The OP didnt want libraries, the ST registers are part of the library. I could re-write this or use an ST timer rather than the ARM timer and get rid of any ARM registers (to avoid an ARM library).  Please just provide your answer than just beat up on mine, I dont know why we have to go through this every time.  Give the OP choices, kinda the point of this site, they get to choose between the answers as to one matches what they were after."}, {"owner": {"reputation": 7344, "user_id": 1455622, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/5pFTF.png?s=128&g=1", "display_name": "Scheintod", "link": "https://stackoverflow.com/users/1455622/scheintod"}, "edited": false, "score": 0, "creation_date": 1583842045, "post_id": 59546939, "comment_id": 107242371, "body": "I think this is a very good and complete answer which matches the question exactly. (And it is very usefull for me right now because that&#39;s exactly what I&#39;m trying to do currently: programming an stm32f103 without cmsis &quot;mess&quot; and saving about 90% flash space, so thanks for that.)"}, {"owner": {"reputation": 545, "user_id": 1628578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8db01b707fb307310461898e0847477f?s=128&d=identicon&r=PG", "display_name": "Kamilion", "link": "https://stackoverflow.com/users/1628578/kamilion"}, "edited": false, "score": 0, "creation_date": 1611634306, "post_id": 59546939, "comment_id": 116508357, "body": "Wow, thanks so much, old_timer, this was exactly what I wanted to know."}], "tags": [], "owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "is_accepted": false, "score": 4, "last_activity_date": 1615498417, "last_edit_date": 1615498417, "creation_date": 1577812964, "answer_id": 59546939, "question_id": 59546305, "link": "https://stackoverflow.com/questions/59546305/stm32f103-gpio-ports/59546939#59546939", "title": "STM32F103 GPIO Ports", "body": "<p>It is very good to know how to do bare metal without the canned libraries, and or to be able to read through those libraries and understand what you are getting yourself into by using them.</p>\n<p>This blinks port C pin 13 that is where you generally find the user led on the stm32 blue pill boards.  You can figure it out from here and the documentation for the STM32F103C8.</p>\n<p>flash.s</p>\n<pre><code>.thumb\n\n.thumb_func\n.global _start\n_start:\nstacktop: .word 0x20001000\n.word reset\n.word loop\n.word loop\n.word loop\n.word loop\n.word loop\n.word loop\n.word loop\n.word loop\n.word loop\n.word loop\n.word loop\n.word loop\n.word loop\n.word loop\n\n.thumb_func\nreset:\n    bl notmain\n    b loop\n.thumb_func\nloop:   b .\n\n.thumb_func\n.globl PUT32\nPUT32:\n    str r1,[r0]\n    bx lr\n\n.thumb_func\n.globl GET32\nGET32:\n    ldr r0,[r0]\n    bx lr\n</code></pre>\n<p>so.c</p>\n<pre><code>void PUT32 ( unsigned int, unsigned int );\nunsigned int GET32 ( unsigned int );\n\n#define GPIOCBASE 0x40011000\n#define RCCBASE 0x40021000\n\n#define STK_CSR 0xE000E010\n#define STK_RVR 0xE000E014\n#define STK_CVR 0xE000E018\n#define STK_MASK 0x00FFFFFF\n\nstatic int delay ( unsigned int n )\n{\n    unsigned int ra;\n\n    while(n--)\n    {\n        while(1)\n        {\n            ra=GET32(STK_CSR);\n            if(ra&amp;(1&lt;&lt;16)) break;\n        }\n    }\n    return(0);\n}\n\nint notmain ( void )\n{\n    unsigned int ra;\n    unsigned int rx;\n\n    ra=GET32(RCCBASE+0x18);\n    ra|=1&lt;&lt;4; //enable port c\n    PUT32(RCCBASE+0x18,ra);\n    //config\n    ra=GET32(GPIOCBASE+0x04);\n    ra&amp;=~(3&lt;&lt;20);   //PC13\n    ra|=1&lt;&lt;20;      //PC13\n    ra&amp;=~(3&lt;&lt;22);   //PC13\n    ra|=0&lt;&lt;22;      //PC13\n    PUT32(GPIOCBASE+0x04,ra);\n\n    PUT32(STK_CSR,4);\n    PUT32(STK_RVR,1000000-1);\n    PUT32(STK_CVR,0x00000000);\n    PUT32(STK_CSR,5);\n\n    for(rx=0;;rx++)\n    {\n        PUT32(GPIOCBASE+0x10,1&lt;&lt;(13+0));\n        delay(50);\n        PUT32(GPIOCBASE+0x10,1&lt;&lt;(13+16));\n        delay(50);\n    }\n    return(0);\n}\n</code></pre>\n<p>flash.ld</p>\n<pre><code>MEMORY\n{\n    rom : ORIGIN = 0x08000000, LENGTH = 0x1000\n    ram : ORIGIN = 0x20000000, LENGTH = 0x1000\n}\nSECTIONS\n{\n    .text : { *(.text*) } &gt; rom\n    .rodata : { *(.rodata*) } &gt; rom\n    .bss : { *(.bss*) } &gt; ram\n}\n</code></pre>\n<p>build</p>\n<pre><code>arm-none-eabi-as --warn --fatal-warnings flash.s -o flash.o\narm-none-eabi-gcc -Wall -Werror -O2 -nostdlib -nostartfiles -ffreestanding  -mthumb -c so.c -o so.o\narm-none-eabi-ld -o so.elf -T flash.ld flash.o so.o\narm-none-eabi-objdump -D so.elf &gt; so.list\narm-none-eabi-objcopy so.elf so.bin -O binary\n</code></pre>\n<p>PUT32/GET32 is IMO a highly recommended style of abstraction, decades of experience and it has many benefits over the volatile pointer or worse the misuse of unions thing that is the current FAD.  Not meant to be a library but to show code that does not require any libraries, only the files provided are required.</p>\n<p>Most mcus you need to enable clocks to the peripheral before you can talk to it.  You can see the read-modify-write of an RCC register.</p>\n<p>Most MCUs the GPIO pins reset to inputs so you need to set one to an output to drive/blink an led.  Even within the STM32 world but certainly across brands/families the GPIO (and other) peripherals are not expected to be identical nor even compatible so you have to refer to the documentation for that part and it will show how to make a pin an output. very good idea to read-modify-write instead of just write, but since you are in complete control over the chip you can just write if you wish, try that later.</p>\n<p>This chip has a nice register that allows us to change the output state of one or more but not necessarily all GPIO outputs in a single write, no read-modify-write required.  So I can set or clear pin 13 of GPIOC without affecting the state of the other GPIOC pins.</p>\n<p>Some cortex-ms have a systick timer, for example not all cortex-m3s have to have one it is up to the chip folks usually and some cores may not have the option.  This chip does so you can use it.  In this example the timer is set to roll over every 1 million clocks, the delay function waits for N number of rollovers before returning.  so 50,000,000 clocks between led state changes.  since this code runs right from reset without messing with the clocking or other systems, the internal HSI 8MHz clock is used 50/8 = 6.25 seconds between led state changes.  systick is very easy to use, but remember it is a 24 bit counter not 32 so if you want to do now vs then you must mask it.</p>\n<p>I don't remember if it is an up counter</p>\n<p>elapsed = (now - then) &amp; 0x00FFFFFF;</p>\n<p>or down</p>\n<p>elapsed = (then - now) &amp; 0x00FFFFFF;</p>\n<p>(now = GET32(systick count register address))</p>\n<p>The systick timer is in the arm documentation not the chip documentation necessarily although sometimes ST produces their own version, you want the arm one for sure and maybe then the st one.  infocenter.arm.com (you have to give up an email address or you can Google sometimes you get lucky, someone will illegally post them somewhere) this chip will tell you it uses a cortex-m3 so find the technical reference manual for the cortex-m3 in that you will find it is based on architecture armv7-m so under architecture find the armv7-m documentation, between these you see how the vector table works, the systick timer and its addresses, etc.</p>\n<p>Examine vector table</p>\n<pre><code>Disassembly of section .text:\n\n08000000 &lt;_start&gt;:\n 8000000:   20001000    andcs   r1, r0, r0\n 8000004:   08000041    stmdaeq r0, {r0, r6}\n 8000008:   08000047    stmdaeq r0, {r0, r1, r2, r6}\n 800000c:   08000047    stmdaeq r0, {r0, r1, r2, r6}\n 8000010:   08000047    stmdaeq r0, {r0, r1, r2, r6}\n 8000014:   08000047    stmdaeq r0, {r0, r1, r2, r6}\n 8000018:   08000047    stmdaeq r0, {r0, r1, r2, r6}\n 800001c:   08000047    stmdaeq r0, {r0, r1, r2, r6}\n 8000020:   08000047    stmdaeq r0, {r0, r1, r2, r6}\n 8000024:   08000047    stmdaeq r0, {r0, r1, r2, r6}\n 8000028:   08000047    stmdaeq r0, {r0, r1, r2, r6}\n 800002c:   08000047    stmdaeq r0, {r0, r1, r2, r6}\n 8000030:   08000047    stmdaeq r0, {r0, r1, r2, r6}\n 8000034:   08000047    stmdaeq r0, {r0, r1, r2, r6}\n 8000038:   08000047    stmdaeq r0, {r0, r1, r2, r6}\n 800003c:   08000047    stmdaeq r0, {r0, r1, r2, r6}\n\n08000040 &lt;reset&gt;:\n 8000040:   f000 f806   bl  8000050 &lt;notmain&gt;\n 8000044:   e7ff        b.n 8000046 &lt;loop&gt;\n\n08000046 &lt;loop&gt;:\n 8000046:   e7fe        b.n 8000046 &lt;loop&gt;\n</code></pre>\n<p>The entry point code with our vector table which starts off with the value we would like to put in the stack pointer on reset should be the first thing, then vector tables which are the address of the handler ORRed with 1 (not as easy to find in the docs sometimes).  the disassembly of these addresses is because I used the disassembler to view them those are not actual instructions in the vector table it is a table of vectors.  the tool is just doing its best to disassemble everything, if you look at the rest of the output it also disassembles the ascii tables and other things which are also not code.</p>\n<p>.data is not supported in this example a bunch more work would be required.</p>\n<p>I recommend if/when you get yours working you then examine the HAL library sources to see that when you dig through layers of sometimes bloated or scary code, you will end up with the same core registers, they may choose to always configure all the gpio registers for example, speed and pull up/down, turn off the alternate function, etc.  Or not.  the above knows it is coming out of reset and the state of the system so doesn't go to those lengths for some peripherals you can pop the reset for that peripheral and put it in a known state rather than try to make a library that anticipates it being left in any condition and trying to configure from that state.  YMMV.</p>\n<p>It is good professionally to know how to work at this level as well as how to use libraries.  An MCU chip vendor will often have two libraries, certainly for older parts like these, the current library product and the legacy library product, when a new library comes out to keep it fresh and competitive (looking) the oldest one will drop off from support and you sometimes have current and prior.  depends on the vendor, depends on the part, depends on how they manage their software products (same goes for their IDEs and other tools).</p>\n<p>Most of the stm32 parts esp a blue pill and other boards you can get do not require the fancy IDEs to program but external hardware is sometimes required unless you get a NUCLEO or Discovery board then you have at least enough to program the part with free software not attached to ST.  with a nucleo it is mbed style where you simply copy the .bin file to the virtual usb drive and the board takes care of programming the development MCU.</p>\n"}, {"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 7, "last_activity_date": 1577894735, "creation_date": 1577894735, "answer_id": 59553996, "question_id": 59546305, "link": "https://stackoverflow.com/questions/59546305/stm32f103-gpio-ports/59553996#59553996", "title": "STM32F103 GPIO Ports", "body": "<p>Using GPIO using registers is very easy. You fo not have to write your own startup (as ion the @old_timer answer).  Only 2 steps are needed</p>\n\n<p>you will need the STM provided CMSIS headers with datatypes declarations and human readable #defines and the <a href=\"https://www.st.com/content/ccc/resource/technical/document/reference_manual/59/b9/ba/7f/11/af/43/d5/CD00171190.pdf/files/CD00171190.pdf/jcr:content/translations/en.CD00171190.pdf\" rel=\"noreferrer\">reference manual</a></p>\n\n<ol>\n<li>Enable GPIO port clock. \necample: <code>RCC -&gt; APB2ENR |= RCC_APB2ENR_IOPAEN;</code></li>\n<li>Configure the pins using CRL/CRH GPIO registers </li>\n</ol>\n\n<pre><code>#define GPIO_OUTPUT_2MHz (0b10)\n#define GPIO_OUTPUT_PUSH_PULL (0 &lt;&lt; 2)\n  GPIOA -&gt; CRL &amp;= ~(GPIO_CRL_MODE0 | GPIO_CRL_CNF0);\n  GPIOA -&gt; CRL |= GPIO_OUTPUT_2MHz | GPIO_OUTPUT_PUSH_PULL; \n</code></pre>\n\n<ol start=\"3\">\n<li>Manipulate the output</li>\n</ol>\n\n<pre><code>  /* to toggle */\n  GPIOA -&gt; ODR ^= (1 &lt;&lt; pinNummer);\n  /* to set */\n  GPIOA -&gt; BSRR = (1 &lt;&lt; pinNummer);\n  /* to reset */\n  GPIOA -&gt; BRR = (1 &lt;&lt; pinNummer);\n  //or\n  GPIOA -&gt; BSRR = (1 &lt;&lt; (pinNummer + 16));\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 8321831, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-4xzAtoi1gjU/AAAAAAAAAAI/AAAAAAAAACY/0dc0jhOJEmI/photo.jpg?sz=128", "display_name": "GiGeNCo", "link": "https://stackoverflow.com/users/8321831/gigenco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3204, "favorite_count": 3, "answer_count": 2, "score": 2, "last_activity_date": 1615498417, "creation_date": 1577808462, "last_edit_date": 1577817479, "question_id": 59546305, "link": "https://stackoverflow.com/questions/59546305/stm32f103-gpio-ports", "title": "STM32F103 GPIO Ports", "body": "<p>I have a STM32F103C8 MCU, and I want to control GPIO registers without Cube MX. The MCU has an embedded LED and I want control it. I'm currently using CubeMX and IAR Software, and I make the pin an output (in CubeMX) with this code: </p>\n\n<pre><code>HAL_GPIO_TogglePin(Ld2_GPIO_Port,Ld2_Pin); \nHAL_Delay(1000); \n</code></pre>\n\n<p>This works, but I want to do it without Cube and HAL library; I want to edit the register files directly.</p>\n"}, {"tags": ["c", "string", "malloc", "realloc"], "comments": [{"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 3, "creation_date": 1577808404, "post_id": 59546274, "comment_id": 105261449, "body": "I wouldn&#39;t do this.  Just do a single allocation for the largest string you expect."}, {"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 1, "creation_date": 1577808406, "post_id": 59546274, "comment_id": 105261451, "body": "Whats the <code>char sub[700];</code> for?"}, {"owner": {"reputation": 20017, "user_id": 2282011, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/p8sXJ.jpg?s=128&g=1", "display_name": "Devolus", "link": "https://stackoverflow.com/users/2282011/devolus"}, "edited": false, "score": 1, "creation_date": 1577808583, "post_id": 59546274, "comment_id": 105261505, "body": "If this should become more than an exercise, I would rather preallocate a reasonable sized string. allocation is expensive, so in a real world parser, this would mean bad performance. If a string is bigger than your assumed size, you still can reallocate. My personal rule: Avoid allocations wherever possible."}, {"owner": {"reputation": 95, "user_id": 4355433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cd7579e982ead7d2a818dfc5e8a502f?s=128&d=identicon&r=PG&f=1", "display_name": "JR87", "link": "https://stackoverflow.com/users/4355433/jr87"}, "edited": false, "score": 0, "creation_date": 1577809668, "post_id": 59546274, "comment_id": 105261794, "body": "<code>sub[700];</code> was old code I forgot to remove. Devolus, thank you for the explanation. So it would be a serious performance hit, which is good enough for me. Thank you all for input; I&#39;ll allocate the largest I&#39;d expect."}, {"owner": {"reputation": 697, "user_id": 2096928, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/du211.png?s=128&g=1", "display_name": "Joel Trauger", "link": "https://stackoverflow.com/users/2096928/joel-trauger"}, "edited": false, "score": 0, "creation_date": 1577810581, "post_id": 59546274, "comment_id": 105262082, "body": "If you absolutely must allocate memory at run time, you can calculate the length of the string before allocating it and then assign the value instead of lengthening the array with every input character. Just a thought."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1577833348, "post_id": 59546274, "comment_id": 105267101, "body": "You list <code>{}:</code> as characters to ignore \u2014 you&#39;re likely to need to ignore <code>[],</code> too \u2014 at least until you start verifying that the JSON is well-formed, at which point all of those characters become important."}, {"owner": {"reputation": 95, "user_id": 4355433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cd7579e982ead7d2a818dfc5e8a502f?s=128&d=identicon&r=PG&f=1", "display_name": "JR87", "link": "https://stackoverflow.com/users/4355433/jr87"}, "edited": false, "score": 0, "creation_date": 1577884483, "post_id": 59546274, "comment_id": 105274156, "body": "Jonathan, thanks for the recommendation. I&#39;m actually trying to build a parser that can convert JSON into a schema; specifically poorly formed. It&#39;s a problem I&#39;m running into in my job; and so on the side I&#39;m seeing how likely it is to solve it. I&#39;m not sure how possible it is, but it&#39;s a fun project and it&#39;ll help me learn more C"}], "owner": {"reputation": 95, "user_id": 4355433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cd7579e982ead7d2a818dfc5e8a502f?s=128&d=identicon&r=PG&f=1", "display_name": "JR87", "link": "https://stackoverflow.com/users/4355433/jr87"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1577809788, "creation_date": 1577808232, "last_edit_date": 1577809788, "question_id": 59546274, "link": "https://stackoverflow.com/questions/59546274/c-malloc-realloc-and-dynamic-strings", "title": "C - malloc/realloc and dynamic strings", "body": "<p>I've been practicing some pointer concepts so I can fully grasp how to use them. I'm working on a scanner/parser for JSON files in C as practice. The first step is to check character by character and confirm it's a character I want to keep. {, }, and : are all ignored; at least for extracting them.</p>\n\n<p>The idea is to read in character by character and keep count of the size, and to append this to a string. I've got a simple program that prints out a name. I haven't added the free yet</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nchar *stringBuilder(char c, int size, char *Strng)\n{\n    int arryPosit=size-1;\n    Strng[arryPosit]=c;\n\n    return Strng;\n}\n\nint main() {\n    char c1 = 'J';\n    char c2= 'o';\n    char c3 = 's';\n    char c4= 'h';\n    char c5= '\\n';\n    char *myString=NULL;\n\n    myString= (char *) malloc(1* sizeof(char));\n\n    myString = stringBuilder(c1,1,myString);\n    myString= (char *) realloc(myString, 2* sizeof(char));\n\n    myString = stringBuilder(c2,2,myString);\n    myString= (char *) realloc(myString, 3* sizeof(char));\n\n    myString = stringBuilder(c3,3,myString);\n    myString= (char *) realloc(myString, 4* sizeof(char));\n\n    myString = stringBuilder(c4,4,myString);\n    myString= (char *) realloc(myString, 5* sizeof(char));\n\n    myString = stringBuilder(c5,5,myString);\n\n    printf(myString);\n    free(myString);\n}\n</code></pre>\n\n<p>The idea is to dynamically allocate and reallocate memory as new characters come in. This is a simple proof of concept I wrote. While it works, I'm wondering if there's a better way to do this. The reason I'm reallocating, at least in my head, is because the strings I'll be working with could be 15 characters, or 4. I don't want to over allocate memory; but I am new to using pointers correctly. Is this concept on the right track, is there another way or something I might be missing?</p>\n\n<p>See comments for answer.</p>\n"}, {"tags": ["c", "ipc", "shared-memory"], "comments": [{"owner": {"reputation": 677, "user_id": 3852949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e3e6512e50f5faea8d696e3edb5d8eb?s=128&d=identicon&r=PG&f=1", "display_name": "Storm", "link": "https://stackoverflow.com/users/3852949/storm"}, "edited": false, "score": 0, "creation_date": 1577808792, "post_id": 59546136, "comment_id": 105261565, "body": "<a href=\"https://linux.die.net/man/2/shmat\" rel=\"nofollow noreferrer\">void *shmat(int shmid, const void *shmaddr, int shmflg);</a>"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1577813359, "post_id": 59546136, "comment_id": 105262903, "body": "&quot;<i>can we access an nth element of that shared memory</i>&quot; in terms of addressing access to SHM is not different from accessing local memory."}], "answers": [{"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1577811226, "post_id": 59546442, "comment_id": 105262270, "body": "<code>*((int *)data + 3)</code>?  If the shared memory is really an <code>int[30]</code>, declaring <code>data</code> as an <code>int *</code> and accessing the fourth element as <code>data[3]</code> is a lot simpler."}], "tags": [], "owner": {"reputation": 677, "user_id": 3852949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e3e6512e50f5faea8d696e3edb5d8eb?s=128&d=identicon&r=PG&f=1", "display_name": "Storm", "link": "https://stackoverflow.com/users/3852949/storm"}, "is_accepted": false, "score": 0, "last_activity_date": 1577811663, "last_edit_date": 1577811663, "creation_date": 1577809417, "answer_id": 59546442, "question_id": 59546136, "link": "https://stackoverflow.com/questions/59546136/accessing-a-specific-element-on-ipc-shared-memory/59546442#59546442", "title": "Accessing a specific element on IPC shared memory", "body": "<p>Why don't you access it like you would do with a normal pointer ? For instance :</p>\n\n<pre><code>int shmid = shmget(key, 30 * sizeof(int), 0644 | IPC_CREATE);\nvoid* data = shmat(shmid, (void *)0, 0);\nint element = *((int *)data + 3);\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 8147103, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-AAQzY4hRRWo/AAAAAAAAAAI/AAAAAAAAAEs/E09gHQvVVOo/photo.jpg?sz=128", "display_name": "Amine &#214;zil", "link": "https://stackoverflow.com/users/8147103/amine-%c3%96zil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1577811663, "creation_date": 1577807439, "last_edit_date": 1577808550, "question_id": 59546136, "link": "https://stackoverflow.com/questions/59546136/accessing-a-specific-element-on-ipc-shared-memory", "title": "Accessing a specific element on IPC shared memory", "body": "<p>I'm reading about shared memory, and a question popped up in my head - since the signature of shmget is <code>int shmget(key_t key, size_t size,int shmflg)</code> then we can allocate for example a shared memory of 30 integers by passing <code>30*sizeof(int)</code> as argument to shmget, so my question is can we access an nth element of that shared memory ? (can we access the 4th integer of our shared memory for example?)</p>\n"}, {"tags": ["c", "process", "locking", "fork", "ipc"], "comments": [{"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1577808179, "post_id": 59545961, "comment_id": 105261386, "body": "It&#39;s hard for me to understand what you&#39;re asking but I think you have a complete misunderstanding of what the <code>dup2</code> function does. It does not seem useful at all for your problem."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1577808272, "post_id": 59545961, "comment_id": 105261408, "body": "I also don&#39;t understand what you think <code>lockf</code> does here."}], "answers": [{"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 0, "last_activity_date": 1577831929, "last_edit_date": 1577831929, "creation_date": 1577831147, "answer_id": 59548835, "question_id": 59545961, "link": "https://stackoverflow.com/questions/59545961/how-can-i-clean-a-file-descriptor-after-writing-into-a-file-with-dup2/59548835#59548835", "title": "How can I clean a file descriptor after writing into a file with dup2()?", "body": "<p>Nothing is written to <code>fichier</code> because you don't use <code>fflush(stdout)</code> and the buffer is not full before you switch standard output to write to <code>copie</code>.</p>\n\n<p>The <code>lseek()</code> calls are mostly pointless; the writing will occur at the end of the file because of <code>O_APPEND</code>.  The logic behind them is to ensure that the whole file is locked, but \u2026</p>\n\n<p>The <code>lockf()</code> calls are pointless; the <code>O_APPEND</code> flag ensures that writing takes place at the end of the file, and the contents of separate concurrent write calls in separate processes are not interleaved for disk files.</p>\n\n<p>Putting this together, along with a loop to wait for the child processes to die, leads to:</p>\n\n<pre><code>#include &lt;fcntl.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;unistd.h&gt;\n\nstatic void fils(char *chaine)\n{\n    int fic1 = open(\"fichier\", O_CREAT | O_APPEND | O_WRONLY, S_IRUSR | S_IWUSR);\n    dup2(fic1, 1);\n    close(fic1);\n\n    printf(\"%d a ecrit %s\\n\", (int)getpid(), chaine);\n    fflush(stdout);\n\n    int fic2 = open(\"copie\", O_CREAT | O_APPEND | O_WRONLY, S_IRUSR | S_IWUSR);\n    dup2(fic2, 1);\n    close(fic2);\n    printf(\"%d a ecrit %s\\n\", (int)getpid(), chaine);\n    fflush(stdout);\n\n    int attente = rand() % 2;\n    fprintf(stderr, \"%d attente de %d dans fichier et copie\\n\", (int)getpid(), attente);\n    sleep(attente);\n\n    exit(EXIT_SUCCESS);\n}\n\nint main(int argc, char **argv)\n{\n    int i;\n    pid_t pid;\n\n    remove(\"fichier\");\n    remove(\"copie\");\n\n    for (i = 1; i &lt; argc; i++)\n    {\n        if ((pid = fork()) &lt; 0)\n        {\n            fprintf(stderr, \"Erreur fork\\n\");\n            exit(EXIT_FAILURE);\n        }\n        else if (pid == 0)\n        {\n            fils(argv[i]);\n        }\n    }\n\n    int corpse;\n    int status;\n    while ((corpse = wait(&amp;status)) &gt; 0)\n    {\n        printf(\"%d: child %d exited with status 0x%.4X\\n\",\n               (int)getpid(), corpse, status);\n    }\n    return(EXIT_SUCCESS);\n}\n</code></pre>\n\n<p>When I ran that, I got the output:</p>\n\n<pre><code>$ open29 hello haha hene\n95396 attente de 1 dans fichier et copie\n95395 attente de 1 dans fichier et copie\n95397 attente de 1 dans fichier et copie\n95394: child 95397 exited with status 0x0000\n95394: child 95396 exited with status 0x0000\n95394: child 95395 exited with status 0x0000\n$ cat fichier\n95395 a ecrit hello\n95396 a ecrit haha\n95397 a ecrit hene\n$ cat copie\n95396 a ecrit haha\n95395 a ecrit hello\n95397 a ecrit hene\n$\n</code></pre>\n\n<p>Note that the children all slept for the same amount of time.  It takes care in seeding with <code>srand()</code> to have different sequences in the different children (for example, call <code>srand(getpid())</code> in each child, at the top of <code>fils()</code>).</p>\n\n<p>I did also run a version of your code retaining your locking scheme but with <code>fflush(stdout)</code> after the calls to <code>printf()</code>.  The output was not materially different.  The file <code>fichier</code> contained lines with <code>hello</code>, <code>hene</code>, <code>haha</code>; the file <code>copie</code> contained lines with <code>hello</code>, <code>haha</code>, <code>hene</code>.  The key change is the use of <code>fflush(stdout);</code> to get the data written to <code>fichier</code> as well as <code>copie</code>.</p>\n"}], "owner": {"reputation": 503, "user_id": 2690373, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/rJRrt.jpg?s=128&g=1", "display_name": "Iem-Prog", "link": "https://stackoverflow.com/users/2690373/iem-prog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 110, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1577831929, "creation_date": 1577806407, "last_edit_date": 1577806872, "question_id": 59545961, "link": "https://stackoverflow.com/questions/59545961/how-can-i-clean-a-file-descriptor-after-writing-into-a-file-with-dup2", "title": "How can I clean a file descriptor after writing into a file with dup2()?", "body": "<p>I would like to write a program that writes argument passed by terminal on two files named (fichier, copie).</p>\n\n<p><strong>First</strong>, same order of arguments in both files, as well order provided in terminal using a child process for each argument.</p>\n\n<p><strong>Secondly</strong>, same order of arguments in both files eventhough it will be different from the order of arguments provided in terminal.</p>\n\n<p>I have written the code below using \"locking\" in order to write each argument in both files (fichier, copie), but it seems that I cannot get the arguments written in both files. I get all the arguments written in the second file (copie) due to dup2() function (I think I have an issue with file descriptor).</p>\n\n<p>I would be very glad if someone could explain to me how can I clear the file descriptors and get the arguments written in both files.</p>\n\n<p><strong><em>Command:</em></strong>  ./try hello haha hene</p>\n\n<p><strong><em>Output:</em></strong> in the \"copie\" file, but the \"fichier\" file is empty</p>\n\n<ol>\n<li>88961 a ecrit haha </li>\n<li>88961 a ecrit haha </li>\n<li>88962 a ecrit hene </li>\n<li>88962 a ecrit hene </li>\n<li>88960 a ecrit hello </li>\n<li>88960 a ecrit hello</li>\n</ol>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;fcntl.h&gt;\n\nvoid fils(char *chaine){\n    int fic1 = open(\"fichier\", O_CREAT|O_APPEND|O_WRONLY,S_IRUSR|S_IWUSR);\n    lseek(fic1 ,0 ,SEEK_SET);\n    lockf(fic1 ,F_LOCK,0);\n    dup2(fic1, 1);\n\n    printf(\"%d a ecrit %s\\n\",getpid(),chaine);\n    lseek(fic1 ,0 ,SEEK_SET);\n    lockf(fic1 ,F_ULOCK,0);\n\n    int fic2 = open(\"copie\", O_CREAT|O_APPEND|O_WRONLY,S_IRUSR|S_IWUSR);\n    lseek(fic2 ,0 ,SEEK_SET);\n    lockf(fic2 ,F_LOCK,0);\n    dup2(fic2, 1);\n    printf(\"%d a ecrit %s\\n\",getpid(),chaine);\n\n    int attente=rand()%2;\n    fprintf(stderr,\"%d attente de %d dans fichier et copie\\n\",getpid(),attente);\n    sleep(attente);\n\n    lseek(fic2 ,0 ,SEEK_SET);\n    lockf(fic2 ,F_ULOCK,0);\n    close(fic1);\n    close(fic2);\n\n    exit(EXIT_SUCCESS);\n}\n\nint main(int argc,char **argv){\n\n    int i;\n    pid_t pid;\n    system(\"rm -f fichier copie\");\n\n    for(i=1;i&lt;argc;i++){\n        if((pid=fork())&lt;0){\n            printf(\"Erreur fork\\n\");\n            exit(EXIT_FAILURE);\n        }else if(pid==0){\n            fils(argv[i]);\n        }\n    }\n    exit(EXIT_SUCCESS);\n}\n</code></pre>\n"}, {"tags": ["c", "firebase", "unity3d", "firebase-authentication", "firebase-analytics"], "comments": [{"owner": {"reputation": 418, "user_id": 12624874, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1eRvj.jpg?s=128&g=1", "display_name": "Philippe B.", "link": "https://stackoverflow.com/users/12624874/philippe-b"}, "edited": false, "score": 3, "creation_date": 1577806234, "post_id": 59545895, "comment_id": 105260729, "body": "Is the JDK downloaded by Unity the same as the one in JAVA_HOME ?"}, {"owner": {"reputation": 307, "user_id": 10645179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e48602dfcf2b7f865f1caa64d4fdce91?s=128&d=identicon&r=PG&f=1", "display_name": "Beginner_", "link": "https://stackoverflow.com/users/10645179/beginner"}, "reply_to_user": {"reputation": 418, "user_id": 12624874, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1eRvj.jpg?s=128&g=1", "display_name": "Philippe B.", "link": "https://stackoverflow.com/users/12624874/philippe-b"}, "edited": false, "score": 0, "creation_date": 1577806372, "post_id": 59545895, "comment_id": 105260772, "body": "No. I don&#39;t know where is the JDK downloaded by Unity. Is there a way to find it?"}, {"owner": {"reputation": 418, "user_id": 12624874, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1eRvj.jpg?s=128&g=1", "display_name": "Philippe B.", "link": "https://stackoverflow.com/users/12624874/philippe-b"}, "edited": false, "score": 2, "creation_date": 1577806572, "post_id": 59545895, "comment_id": 105260844, "body": "Check this link : <a href=\"https://docs.unity3d.com/Manual/android-sdksetup.html\" rel=\"nofollow noreferrer\">environnement setup</a>, try to use the JDK from your JAVA_HOME maybe this will do the trick."}, {"owner": {"reputation": 307, "user_id": 10645179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e48602dfcf2b7f865f1caa64d4fdce91?s=128&d=identicon&r=PG&f=1", "display_name": "Beginner_", "link": "https://stackoverflow.com/users/10645179/beginner"}, "reply_to_user": {"reputation": 418, "user_id": 12624874, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1eRvj.jpg?s=128&g=1", "display_name": "Philippe B.", "link": "https://stackoverflow.com/users/12624874/philippe-b"}, "edited": false, "score": 0, "creation_date": 1577973920, "post_id": 59545895, "comment_id": 105297073, "body": "OpenJDK downloaded. In other words, should [UnityProjectName\\AndroidPlayer\\Tools\\OpenJDK\\Windows] be set to JAVA_HOME? I tried it once but it didn&#39;t work. [UnityProjectName\\...\\Windows] cannot be set to JAVA_HOME and can only be used for Unity?"}, {"owner": {"reputation": 418, "user_id": 12624874, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1eRvj.jpg?s=128&g=1", "display_name": "Philippe B.", "link": "https://stackoverflow.com/users/12624874/philippe-b"}, "edited": false, "score": 1, "creation_date": 1577975293, "post_id": 59545895, "comment_id": 105297730, "body": "For what I have seen, if you change your JDK path in your Unity environment you must restart Unity. Your JAVA_HOME must point to a valid path (check if you have the JDK installed where your JAVA_HOME points). Unity also precognise to use a x64 version of the JDK. There doesn&#39;t seems to be any problem in your path, you don&#39;t have <code>\\bin</code> at the end which is a common error. I don&#39;t think setting OpenJDK to your JAVA_HOME is a good idea since other application might use it as well.  <b>TL;DR :</b> Check your if your JAVA_HOME points to a good path (x64), restart unity, retry."}, {"owner": {"reputation": 307, "user_id": 10645179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e48602dfcf2b7f865f1caa64d4fdce91?s=128&d=identicon&r=PG&f=1", "display_name": "Beginner_", "link": "https://stackoverflow.com/users/10645179/beginner"}, "reply_to_user": {"reputation": 418, "user_id": 12624874, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1eRvj.jpg?s=128&g=1", "display_name": "Philippe B.", "link": "https://stackoverflow.com/users/12624874/philippe-b"}, "edited": false, "score": 0, "creation_date": 1577978824, "post_id": 59545895, "comment_id": 105299540, "body": "I specified the latest downloaded JDK in JAVA_HOME, but the error was not fixed. and in Unity, [JDK Installed with Unity] is checked. Is this state correct?"}, {"owner": {"reputation": 418, "user_id": 12624874, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1eRvj.jpg?s=128&g=1", "display_name": "Philippe B.", "link": "https://stackoverflow.com/users/12624874/philippe-b"}, "edited": false, "score": 1, "creation_date": 1577979029, "post_id": 59545895, "comment_id": 105299643, "body": "Have you tried to uncheck it and use the one from your JAVA_HOME ?"}, {"owner": {"reputation": 307, "user_id": 10645179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e48602dfcf2b7f865f1caa64d4fdce91?s=128&d=identicon&r=PG&f=1", "display_name": "Beginner_", "link": "https://stackoverflow.com/users/10645179/beginner"}, "reply_to_user": {"reputation": 418, "user_id": 12624874, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1eRvj.jpg?s=128&g=1", "display_name": "Philippe B.", "link": "https://stackoverflow.com/users/12624874/philippe-b"}, "edited": false, "score": 0, "creation_date": 1578647434, "post_id": 59545895, "comment_id": 105514598, "body": "Yes. I removed the check and specified JAVA_HOME and tried various things, but it did not cure. But there was something else weird. I imported Firebase Analytics first, but later imported Auth. At this time, I deleted some files to complete the Auth import. Does Firebase Analytics and Auth interfere? Should they not be used together?  Sorry for the late comment."}, {"owner": {"reputation": 418, "user_id": 12624874, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1eRvj.jpg?s=128&g=1", "display_name": "Philippe B.", "link": "https://stackoverflow.com/users/12624874/philippe-b"}, "edited": false, "score": 0, "creation_date": 1578669758, "post_id": 59545895, "comment_id": 105525899, "body": "To be honest, I don&#39;t know very well Firebase Analytics nor Auth. If this files are related to your JDK maybe that could interfere but I can&#39;t help you more, I&#39;m at a loss here. Have you tried the answer Pux0r3 provided ?"}], "answers": [{"comments": [{"owner": {"reputation": 307, "user_id": 10645179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e48602dfcf2b7f865f1caa64d4fdce91?s=128&d=identicon&r=PG&f=1", "display_name": "Beginner_", "link": "https://stackoverflow.com/users/10645179/beginner"}, "edited": false, "score": 0, "creation_date": 1578724710, "post_id": 59583852, "comment_id": 105540318, "body": "thank you for your answer. I have never used PowerShell. I tried get-command javac but got an error. Is my usage correct?Here is the error:   + get-command C:\\Java\\jdk-13.0.1 + ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~     + CategoryInfo          : ObjectNotFound: (C:\\Java\\jdk-13.0.1:String) [Get-Command], CommandNotFoundException     + FullyQualifiedErrorId : CommandNotFoundException,Microsoft.PowerShell.Commands.GetCo&zwnj;&#8203;mmandCommand"}, {"owner": {"reputation": 1983, "user_id": 3043663, "user_type": "registered", "profile_image": "https://graph.facebook.com/290200030/picture?type=large", "display_name": "Patrick Martin", "link": "https://stackoverflow.com/users/3043663/patrick-martin"}, "reply_to_user": {"reputation": 307, "user_id": 10645179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e48602dfcf2b7f865f1caa64d4fdce91?s=128&d=identicon&r=PG&f=1", "display_name": "Beginner_", "link": "https://stackoverflow.com/users/10645179/beginner"}, "edited": false, "score": 0, "creation_date": 1578843306, "post_id": 59583852, "comment_id": 105563025, "body": "Omit the path. <code>get-command javac</code> will tell you if javac is in your path and which one takes precedence. Java has a tendency of installing versions side by side, so this can help you make sure you configured the right one. This is what I mean with making sure <code>JAVA_HOME</code> matches the one in your <code>PATH</code>."}], "tags": [], "owner": {"reputation": 1983, "user_id": 3043663, "user_type": "registered", "profile_image": "https://graph.facebook.com/290200030/picture?type=large", "display_name": "Patrick Martin", "link": "https://stackoverflow.com/users/3043663/patrick-martin"}, "is_accepted": false, "score": 2, "last_activity_date": 1578077680, "creation_date": 1578077680, "answer_id": 59583852, "question_id": 59545895, "link": "https://stackoverflow.com/questions/59545895/resolution-failed-you-application-will-not-run-see-the-log-for-details/59583852#59583852", "title": "&quot;Resolution Failed! You application will not run, see the log for details&quot;", "body": "<p>I actually don't have <code>JAVA_HOME</code> setup on my Windows machine but have <code>javac</code> in my path. Just removing that variable might be enough to get you unstuck.</p>\n\n<p>I will also throw in that I tend to want to do a full logout when changing environment variables to make sure there's nothing holding on to old stuff.</p>\n\n<p>In your comments, I see that others have suggested checking your architecture (x86 vs x64). I would also suggest making sure the <code>JAVA_HOME</code> matches <code>javac</code> (what's in your <code>PATH</code>). You can easily find this in powershell with <code>get-command javac</code>.</p>\n\n<p>Whatever solves your issue, if any of this does, this sounds a lot like a bug. I would recommend <a href=\"https://github.com/googlesamples/unity-jar-resolver/issues\" rel=\"nofollow noreferrer\">filing an issue against the unity-jar-resolver repository</a> or with <a href=\"https://firebase.google.com/support\" rel=\"nofollow noreferrer\">Firebase Support directly</a>. Include any steps you've tried, this thread, and a workaround if anything here helps. I found <a href=\"https://github.com/googlesamples/unity-jar-resolver/issues/160\" rel=\"nofollow noreferrer\">this semi-related bug</a>, but I'm pretty sure you're running into something different.</p>\n"}], "owner": {"reputation": 307, "user_id": 10645179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e48602dfcf2b7f865f1caa64d4fdce91?s=128&d=identicon&r=PG&f=1", "display_name": "Beginner_", "link": "https://stackoverflow.com/users/10645179/beginner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1149, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1605204088, "creation_date": 1577805909, "last_edit_date": 1592644375, "question_id": 59545895, "link": "https://stackoverflow.com/questions/59545895/resolution-failed-you-application-will-not-run-see-the-log-for-details", "title": "&quot;Resolution Failed! You application will not run, see the log for details&quot;", "body": "<p>I'm trying to run Force Resolve with Firebase, but it fails and doesn't work.</p>\n<p><a href=\"https://i.stack.imgur.com/1i07x.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1i07x.jpg\" alt=\"Resolution Failed!\" /></a></p>\n<p>JAVA_HOME of Windows is also set to the latest JDK, and the JDK in Unity uses the one prepared by Unity (JDK Installed with Unity is true).</p>\n<p>I don't know what other information is needed. What should I do?</p>\n<hr />\n<pre><code>Gradle failed to fetch dependencies.\nFailed to run 'C:\\UnityProjects\\UnityProjectName\\Temp\\PlayServicesResolverGradle\\gradlew.bat --no-daemon -b &quot;C:\\UnityProjects\\UnityProjectName\\Temp\\PlayServicesResolverGradle\\PlayServicesResolver.scripts.download_artifacts.gradle&quot; &quot;-PANDROID_HOME=C:/Program Files/Unity/Editor/2019.2.6f1/Editor/Data/PlaybackEngines/AndroidPlayer\\SDK&quot; &quot;-PTARGET_DIR=C:\\UnityProjects\\UnityProjectName\\Assets\\Plugins\\Android&quot; &quot;-PMAVEN_REPOS=file:///C:/UnityProjects/Craft%20Offensive/Assets/Firebase/m2repository&quot; &quot;-PPACKAGES_TO_COPY=com.google.firebase:firebase-analytics:17.2.0;com.google.firebase:firebase-iid:[20.0.0];com.google.firebase:firebase-analytics-unity:6.6.0;com.google.firebase:firebase-common:19.1.0;com.google.firebase:firebase-app-unity:6.6.0;com.google.firebase:firebase-auth:19.0.0;com.google.firebase:firebase-auth-unity:6.6.0;com.google.firebase:firebase-database:19.1.0;com.google.firebase:firebase-database-unity:6.6.0;com.google.firebase:firebase-messaging:20.0.0;com.google.firebase:firebase-messaging-unity:6.6.0&quot; &quot;-PUSE_JETIFIER=1&quot; &quot;-PDATA_BINDING_VERSION=3.4.0&quot;'\nstdout:\nERROR: JAVA_HOME is set to an invalid directory: C:\\Program Files\\Java\\jdk1.8.0_161\nPlease set the JAVA_HOME variable in your environment to match the\nlocation of your Java installation.\nstderr:\nexit code: 1\nUnityEngine.Debug:LogError(Object)\nGoogle.Logger:Log(String, LogLevel) (at Z:/tmp/tmp.cfOHeQ7pJN/third_party/unity/unity_jar_resolver/source/VersionHandlerImpl/src/Logger.cs:103)\nGooglePlayServices.PlayServicesResolver:Log(String, LogLevel) (at Z:/tmp/tmp.CbcF1w0aJu/third_party/unity/unity_jar_resolver/source/PlayServicesResolver/src/PlayServicesResolver.cs:957)\nGooglePlayServices.&lt;GradleResolution&gt;c__AnonStorey1:&lt;&gt;m__2(Result) (at Z:/tmp/tmp.CbcF1w0aJu/third_party/unity/unity_jar_resolver/source/PlayServicesResolver/src/GradleResolver.cs:369)\nGooglePlayServices.&lt;GradleResolution&gt;c__AnonStorey2:&lt;&gt;m__0() (at Z:/tmp/tmp.CbcF1w0aJu/third_party/unity/unity_jar_resolver/source/PlayServicesResolver/src/GradleResolver.cs:468)\nGoogle.RunOnMainThread:ExecuteNext() (at Z:/tmp/tmp.cfOHeQ7pJN/third_party/unity/unity_jar_resolver/source/VersionHandlerImpl/src/RunOnMainThread.cs:377)\nGoogle.RunOnMainThread:&lt;ExecuteAll&gt;m__1() (at Z:/tmp/tmp.cfOHeQ7pJN/third_party/unity/unity_jar_resolver/source/VersionHandlerImpl/src/RunOnMainThread.cs:408)\nGoogle.RunOnMainThread:RunAction(Action) (at Z:/tmp/tmp.cfOHeQ7pJN/third_party/unity/unity_jar_resolver/source/VersionHandlerImpl/src/RunOnMainThread.cs:234)\nGoogle.RunOnMainThread:ExecuteAll() (at Z:/tmp/tmp.cfOHeQ7pJN/third_party/unity/unity_jar_resolver/source/VersionHandlerImpl/src/RunOnMainThread.cs:406)\nGoogle.RunOnMainThread:Run(Action, Boolean) (at Z:/tmp/tmp.cfOHeQ7pJN/third_party/unity/unity_jar_resolver/source/VersionHandlerImpl/src/RunOnMainThread.cs:363)\nGooglePlayServices.&lt;GradleResolution&gt;c__AnonStorey1:&lt;&gt;m__8(Result) (at Z:/tmp/tmp.CbcF1w0aJu/third_party/unity/unity_jar_resolver/source/PlayServicesResolver/src/GradleResolver.cs:468)\nGooglePlayServices.ProgressReporter:SignalComplete() (at Z:/tmp/tmp.CbcF1w0aJu/third_party/unity/unity_jar_resolver/source/PlayServicesResolver/src/CommandLineDialog.cs:116)\nGooglePlayServices.ProgressReporter:CommandLineToolCompletion(Result) (at Z:/tmp/tmp.CbcF1w0aJu/third_party/unity/unity_jar_resolver/source/PlayServicesResolver/src/CommandLineDialog.cs:107)\nGooglePlayServices.&lt;RunAsync&gt;c__AnonStorey1:&lt;&gt;m__0() (at Z:/tmp/tmp.CbcF1w0aJu/third_party/unity/unity_jar_resolver/source/PlayServicesResolver/src/CommandLine.cs:137)\nGoogle.RunOnMainThread:ExecuteNext() (at Z:/tmp/tmp.cfOHeQ7pJN/third_party/unity/unity_jar_resolver/source/VersionHandlerImpl/src/RunOnMainThread.cs:377)\nGoogle.RunOnMainThread:&lt;ExecuteAll&gt;m__1() (at Z:/tmp/tmp.cfOHeQ7pJN/third_party/unity/unity_jar_resolver/source/VersionHandlerImpl/src/RunOnMainThread.cs:408)\nGoogle.RunOnMainThread:RunAction(Action) (at Z:/tmp/tmp.cfOHeQ7pJN/third_party/unity/unity_jar_resolver/source/VersionHandlerImpl/src/RunOnMainThread.cs:234)\nGoogle.RunOnMainThread:ExecuteAll() (at Z:/tmp/tmp.cfOHeQ7pJN/third_party/unity/unity_jar_resolver/source/VersionHandlerImpl/src/RunOnMainThread.cs:406)\nUnityEditor.EditorApplication:Internal_CallUpdateFunctions()\n</code></pre>\n<h2>\u3000</h2>\n<pre><code>Resolution failed\nFailed to fetch the following dependencies:\ncom.google.firebase:firebase-analytics:17.2.0\ncom.google.firebase:firebase-iid:[20.0.0]\ncom.google.firebase:firebase-analytics-unity:6.6.0\ncom.google.firebase:firebase-common:19.1.0\ncom.google.firebase:firebase-app-unity:6.6.0\ncom.google.firebase:firebase-auth:19.0.0\ncom.google.firebase:firebase-auth-unity:6.6.0\ncom.google.firebase:firebase-database:19.1.0\ncom.google.firebase:firebase-database-unity:6.6.0\ncom.google.firebase:firebase-messaging:20.0.0\ncom.google.firebase:firebase-messaging-unity:6.6.0\nUnityEngine.Debug:LogError(Object)\nGoogle.Logger:Log(String, LogLevel) (at Z:/tmp/tmp.cfOHeQ7pJN/third_party/unity/unity_jar_resolver/source/VersionHandlerImpl/src/Logger.cs:103)\nGooglePlayServices.PlayServicesResolver:Log(String, LogLevel) (at Z:/tmp/tmp.CbcF1w0aJu/third_party/unity/unity_jar_resolver/source/PlayServicesResolver/src/PlayServicesResolver.cs:957)\nGooglePlayServices.GradleResolver:LogMissingDependenciesError(List`1) (at Z:/tmp/tmp.CbcF1w0aJu/third_party/unity/unity_jar_resolver/source/PlayServicesResolver/src/GradleResolver.cs:91)\nGooglePlayServices.&lt;DoResolutionUnsafe&gt;c__AnonStorey6:&lt;&gt;m__1(List`1) (at Z:/tmp/tmp.CbcF1w0aJu/third_party/unity/unity_jar_resolver/source/PlayServicesResolver/src/GradleResolver.cs:760)\nGooglePlayServices.&lt;GradleResolution&gt;c__AnonStorey1:&lt;&gt;m__0() (at Z:/tmp/tmp.CbcF1w0aJu/third_party/unity/unity_jar_resolver/source/PlayServicesResolver/src/GradleResolver.cs:295)\nGooglePlayServices.&lt;GradleResolution&gt;c__AnonStorey1:&lt;&gt;m__2(Result) (at Z:/tmp/tmp.CbcF1w0aJu/third_party/unity/unity_jar_resolver/source/PlayServicesResolver/src/GradleResolver.cs:372)\nGooglePlayServices.&lt;GradleResolution&gt;c__AnonStorey2:&lt;&gt;m__0() (at Z:/tmp/tmp.CbcF1w0aJu/third_party/unity/unity_jar_resolver/source/PlayServicesResolver/src/GradleResolver.cs:468)\nGoogle.RunOnMainThread:ExecuteNext() (at Z:/tmp/tmp.cfOHeQ7pJN/third_party/unity/unity_jar_resolver/source/VersionHandlerImpl/src/RunOnMainThread.cs:377)\nGoogle.RunOnMainThread:&lt;ExecuteAll&gt;m__1() (at Z:/tmp/tmp.cfOHeQ7pJN/third_party/unity/unity_jar_resolver/source/VersionHandlerImpl/src/RunOnMainThread.cs:408)\nGoogle.RunOnMainThread:RunAction(Action) (at Z:/tmp/tmp.cfOHeQ7pJN/third_party/unity/unity_jar_resolver/source/VersionHandlerImpl/src/RunOnMainThread.cs:234)\nGoogle.RunOnMainThread:ExecuteAll() (at Z:/tmp/tmp.cfOHeQ7pJN/third_party/unity/unity_jar_resolver/source/VersionHandlerImpl/src/RunOnMainThread.cs:406)\nGoogle.RunOnMainThread:Run(Action, Boolean) (at Z:/tmp/tmp.cfOHeQ7pJN/third_party/unity/unity_jar_resolver/source/VersionHandlerImpl/src/RunOnMainThread.cs:363)\nGooglePlayServices.&lt;GradleResolution&gt;c__AnonStorey1:&lt;&gt;m__8(Result) (at Z:/tmp/tmp.CbcF1w0aJu/third_party/unity/unity_jar_resolver/source/PlayServicesResolver/src/GradleResolver.cs:468)\nGooglePlayServices.ProgressReporter:SignalComplete() (at Z:/tmp/tmp.CbcF1w0aJu/third_party/unity/unity_jar_resolver/source/PlayServicesResolver/src/CommandLineDialog.cs:116) GooglePlayServices.ProgressReporter:CommandLineToolCompletion(Result) (at Z:/tmp/tmp.CbcF1w0aJu/third_party/unity/unity_jar_resolver/source/PlayServicesResolver/src/CommandLineDialog.cs:107)\nGooglePlayServices.&lt;RunAsync&gt;c__AnonStorey1:&lt;&gt;m__0() (at Z:/tmp/tmp.CbcF1w0aJu/third_party/unity/unity_jar_resolver/source/PlayServicesResolver/src/CommandLine.cs:137)\nGoogle.RunOnMainThread:ExecuteNext() (at Z:/tmp/tmp.cfOHeQ7pJN/third_party/unity/unity_jar_resolver/source/VersionHandlerImpl/src/RunOnMainThread.cs:377)\nGoogle.RunOnMainThread:&lt;ExecuteAll&gt;m__1() (at Z:/tmp/tmp.cfOHeQ7pJN/third_party/unity/unity_jar_resolver/source/VersionHandlerImpl/src/RunOnMainThread.cs:408)\nGoogle.RunOnMainThread:RunAction(Action) (at Z:/tmp/tmp.cfOHeQ7pJN/third_party/unity/unity_jar_resolver/source/VersionHandlerImpl/src/RunOnMainThread.cs:234)\nGoogle.RunOnMainThread:ExecuteAll() (at Z:/tmp/tmp.cfOHeQ7pJN/third_party/unity/unity_jar_resolver/source/VersionHandlerImpl/src/RunOnMainThread.cs:406)\nUnityEditor.EditorApplication:Internal_CallUpdateFunctions()\n</code></pre>\n<hr />\n<h2>Firebase Analytics and Auth</h2>\n<p>I also use Firebase Analytics with Auth.\nI imported Analytics first into my project and then Auth.\nAt that time, I was warned to delete some Analytics files.\nI then allowed those files to be deleted.</p>\n<p>I also imported Analytics again and tried to import Auth.\nI skipped the warning and left the file.</p>\n<p>But the error remains both.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 5, "creation_date": 1577804832, "post_id": 59545707, "comment_id": 105260274, "body": "What does <code>strcmp</code> return? (If you don&#39;t know, type <code>man strcmp</code> and read what it tells you.)"}, {"owner": {"reputation": 7369, "user_id": 2436655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f13e1ea8bbf6506462623c85acb8e32?s=128&d=identicon&r=PG&f=1", "display_name": "pzaenger", "link": "https://stackoverflow.com/users/2436655/pzaenger"}, "edited": false, "score": 3, "creation_date": 1577804841, "post_id": 59545707, "comment_id": 105260278, "body": "Read the <a href=\"http://www.cplusplus.com/reference/cstring/strcmp/\" rel=\"nofollow noreferrer\"><code>strcmp</code></a> reference. You need to check the returned value of <code>strcmp</code>."}, {"owner": {"reputation": 65, "user_id": 9968353, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-vyZkdglwb6A/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1mngI8cea0MCRF4YdKPJkl0sXhfw/mo/photo.jpg?sz=128", "display_name": "mendel", "link": "https://stackoverflow.com/users/9968353/mendel"}, "edited": false, "score": 0, "creation_date": 1577805172, "post_id": 59545707, "comment_id": 105260385, "body": "I change all the strcmp(...) to strcmp() == 0, then the programme does not print anything and exited"}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1577805521, "post_id": 59545707, "comment_id": 105260496, "body": "Show you updated code (edit your question). I just tried your code with the simple <code>strcmp() == 0</code> modification and it worked fine (although you do need a defensive check to make sure the command is given adequate arguments)."}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 9968353, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-vyZkdglwb6A/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1mngI8cea0MCRF4YdKPJkl0sXhfw/mo/photo.jpg?sz=128", "display_name": "mendel", "link": "https://stackoverflow.com/users/9968353/mendel"}, "edited": false, "score": 0, "creation_date": 1577805294, "post_id": 59545796, "comment_id": 105260422, "body": "Why the if(strcmp(argv[1],name) == 0) does not work"}, {"owner": {"reputation": 65, "user_id": 9968353, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-vyZkdglwb6A/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1mngI8cea0MCRF4YdKPJkl0sXhfw/mo/photo.jpg?sz=128", "display_name": "mendel", "link": "https://stackoverflow.com/users/9968353/mendel"}, "edited": false, "score": 0, "creation_date": 1577805344, "post_id": 59545796, "comment_id": 105260443, "body": "one is bool one is int, so the type is not comparable?"}, {"owner": {"reputation": 697, "user_id": 2096928, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/du211.png?s=128&g=1", "display_name": "Joel Trauger", "link": "https://stackoverflow.com/users/2096928/joel-trauger"}, "reply_to_user": {"reputation": 65, "user_id": 9968353, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-vyZkdglwb6A/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1mngI8cea0MCRF4YdKPJkl0sXhfw/mo/photo.jpg?sz=128", "display_name": "mendel", "link": "https://stackoverflow.com/users/9968353/mendel"}, "edited": false, "score": 0, "creation_date": 1577805583, "post_id": 59545796, "comment_id": 105260509, "body": "you need to look at the <a href=\"https://linux.die.net/man/3/strcmp\" rel=\"nofollow noreferrer\">man pages for <code>strcmp</code></a>. &quot;<i>The strcmp() function compares the two strings *s1* and *s2*. It returns an integer less than, equal to, or greater than zero if *s1* is found, respectively, to be less than, to match, or be greater than *s2*.</i>&quot; In other words, it works if you compare it to 0...which I just verified with my own compiler. Perhaps you should update your original post with your modified code so we can see where you might have done something wrong."}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "reply_to_user": {"reputation": 65, "user_id": 9968353, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-vyZkdglwb6A/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1mngI8cea0MCRF4YdKPJkl0sXhfw/mo/photo.jpg?sz=128", "display_name": "mendel", "link": "https://stackoverflow.com/users/9968353/mendel"}, "edited": false, "score": 0, "creation_date": 1577805602, "post_id": 59545796, "comment_id": 105260514, "body": "@mendel the <code>== 0</code> should work. There&#39;s something else wrong with your code you&#39;re not showing."}, {"owner": {"reputation": 697, "user_id": 2096928, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/du211.png?s=128&g=1", "display_name": "Joel Trauger", "link": "https://stackoverflow.com/users/2096928/joel-trauger"}, "reply_to_user": {"reputation": 65, "user_id": 9968353, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-vyZkdglwb6A/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1mngI8cea0MCRF4YdKPJkl0sXhfw/mo/photo.jpg?sz=128", "display_name": "mendel", "link": "https://stackoverflow.com/users/9968353/mendel"}, "edited": false, "score": 0, "creation_date": 1577805956, "post_id": 59545796, "comment_id": 105260634, "body": "@mendel see this link <a href=\"https://onlinegdb.com/S1zw_JKyI\" rel=\"nofollow noreferrer\">onlinegdb.com/S1zw_JKyI</a> that shows your modifications working."}, {"owner": {"reputation": 65, "user_id": 9968353, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-vyZkdglwb6A/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1mngI8cea0MCRF4YdKPJkl0sXhfw/mo/photo.jpg?sz=128", "display_name": "mendel", "link": "https://stackoverflow.com/users/9968353/mendel"}, "edited": false, "score": 0, "creation_date": 1577806707, "post_id": 59545796, "comment_id": 105260905, "body": "The strcmp has been solved, but there are still some problem with this code"}, {"owner": {"reputation": 697, "user_id": 2096928, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/du211.png?s=128&g=1", "display_name": "Joel Trauger", "link": "https://stackoverflow.com/users/2096928/joel-trauger"}, "reply_to_user": {"reputation": 65, "user_id": 9968353, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-vyZkdglwb6A/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1mngI8cea0MCRF4YdKPJkl0sXhfw/mo/photo.jpg?sz=128", "display_name": "mendel", "link": "https://stackoverflow.com/users/9968353/mendel"}, "edited": false, "score": 0, "creation_date": 1577808181, "post_id": 59545796, "comment_id": 105261387, "body": "@mendel see my edit. Sorry if it&#39;s long-winded, but I felt it was necessary to encompass the broadening of your question. If you have any further questions, please make a new post for each one so you can get clear and concise answers to those questions and not have them get lost in the shuffle."}], "tags": [], "owner": {"reputation": 697, "user_id": 2096928, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/du211.png?s=128&g=1", "display_name": "Joel Trauger", "link": "https://stackoverflow.com/users/2096928/joel-trauger"}, "is_accepted": true, "score": 5, "last_activity_date": 1577808114, "last_edit_date": 1592644375, "creation_date": 1577805220, "answer_id": 59545796, "question_id": 59545707, "link": "https://stackoverflow.com/questions/59545707/problem-in-calling-a-function-converting-string-to-lowercase-using-c/59545796#59545796", "title": "problem in calling a function converting string to lowercase using c", "body": "<p><code>strcmp</code> returns a value that represents how argument 1 compares to argument 2 alphabetically. If they are equal, it returns 0 which is numerically equivalent to the <code>false</code> boolean. Thus you need to modify your if statements like this:</p>\n<pre class=\"lang-c prettyprint-override\"><code>        if(!strcmp(argv[1],name)){\n            printf(&quot;name_key = 1;&quot;);\n            name_key = 1;\n        }else if(!strcmp(argv[1],key)){\n            printf(&quot;name_key = 2;&quot;);\n            name_key = 2;\n        }\n        if (!strcmp(argv[2],cs)){\n            printf(&quot;cs_ci = 1;&quot;);\n            cs_ci = 1;\n        }else if(!strcmp(argv[2],ci)){\n            printf(&quot;cs_ci = 2;&quot;);\n            cs_ci = 2;\n        }\n        if (!strcmp(argv[3],ever)){\n            printf(&quot;ever_once = 1;&quot;);\n            ever_once = 1;\n        }else if(!strcmp(argv[3],once)){\n            printf(&quot;ever_once = 2;&quot;);\n            ever_once = 2;\n        }\n</code></pre>\n<p>This way if the two strings are equivalent alphabetically, then <code>strcmp</code> will return 0 which will be negated to assume the value of <code>true</code> and the program execution will enter the if block. If the two strings are NOT equal, then <code>strcmp</code> will return either a positive or a negative value which is equivalent to the boolean <code>true</code>. Negating this will assume the value of <code>false</code> and the program execution will <strong>not</strong> enter the if block.</p>\n<p>Hope this helps!</p>\n<hr />\n<h1>EDIT:</h1>\n<p>To help you understand why your to_lowercase function might not be working properly, you have to understand two things about arrays:</p>\n<ol>\n<li>Firstly, the array contents are not passed to the function. The C language (and thus all compilers/interpreters) only passes the single value of any variable to a function when it is called. In this case, the array only contains the memory address of the first element of the array. That address is passed to the function instead of the array as a whole.</li>\n<li>Secondly, an array declaration is simply a pointer to the first location of a contiguous set of locations in memory. When you reference the first element of an array you are accessing the first memory location pointed to by the pointer. When you reference the second, third, or even fourth element of the array, you are accessing the locations in memory that are exactly 2 or 3 or even 4 memory locations away from the first element.</li>\n</ol>\n<p>So what can we do with this? What happens when we change the values pointed to by the pointer? Remember, when you modify an array, (without intervention of some memory allocation tricks) <strong>the memory locations pointed to by the pointer do not change.</strong> <em>Only</em> the values in those memory locations change. This is why we cannot copy arrays by simply typing: <code>array1 = array2</code>. All this is doing is copying the pointer in <code>array2</code> to <code>array1</code>. Any modifications you make to <code>array2</code> will have a side effect of also being made in <code>array1</code> because they both now point to the same locations in memory!</p>\n<p>So if you think you have an error in your <code>to_lowercase</code> function, try this modification to it. I cannot test your complete code because my GCC compiler is for Linux, but it should work for you:</p>\n<pre class=\"lang-c prettyprint-override\"><code>void to_lowercase(char *str)\n{\n    for(int i = 0; str[i]; i++)\n    {\n        str[i] = tolower(str[i]);\n    }\n}\n</code></pre>\n<p><strong>HOW DOES THIS WORK?</strong></p>\n<p>When we pass an array to a function, we are passing the value of the <em>array <strong>pointer</strong></em>. Thus the function only receives a location in memory. By utilizing this pointer, we can advance through memory to the other locations pointed to by that pointer (via <code>str[i]</code>) and modify them freely without affecting the value of the pointer itself.</p>\n<p>Hope this helps.</p>\n"}, {"comments": [{"owner": {"reputation": 697, "user_id": 2096928, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/du211.png?s=128&g=1", "display_name": "Joel Trauger", "link": "https://stackoverflow.com/users/2096928/joel-trauger"}, "edited": false, "score": 0, "creation_date": 1577808397, "post_id": 59546265, "comment_id": 105261446, "body": "I didn&#39;t even address the fact that declaring and returning <code>newStr</code> within a function was essentially returning an address to a location in memory that the program probably doesn&#39;t even have access to once the function returns. It&#39;s far easier (in my opinion) to just modify the contents of the array directly in a void function and return nothing."}], "tags": [], "owner": {"reputation": 45031, "user_id": 213136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b84a36c241e04175fcec402dac43018?s=128&d=identicon&r=PG", "display_name": "Bob Jarvis - Reinstate Monica", "link": "https://stackoverflow.com/users/213136/bob-jarvis-reinstate-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1577808194, "creation_date": 1577808194, "answer_id": 59546265, "question_id": 59545707, "link": "https://stackoverflow.com/questions/59545707/problem-in-calling-a-function-converting-string-to-lowercase-using-c/59546265#59546265", "title": "problem in calling a function converting string to lowercase using c", "body": "<p>You're correct - your <code>to_lowercase</code> function is doing multiple things wrong:</p>\n\n<ol>\n<li>The way this function is currently written <code>newStr</code> is defining an array of <code>char *</code>, not an array of <code>char</code>.</li>\n<li>You're then returning <code>newStr</code>, which is an automatic variable defined on the stack. As soon as the function returns <code>newStr</code> is subject to being overwritten by any other subroutine calls which are made.</li>\n</ol>\n\n<p>You could choose to define <code>to_lowercase</code> as</p>\n\n<pre><code>const char * to_lowercase(char* str){\n    char *newStr = malloc(strlen(str)+1);\n\n    for(int i = 0; str[i]; i++)\n      newStr[i] = tolower(str[i]);\n\n    return newStr;\n}\n</code></pre>\n\n<p>but this means that you'd have to be careful to free the memory allocated in <code>to_lowercase</code> each time you use it.</p>\n\n<p>A better idea might be to write <code>to_lowercase</code> in such a manner that it changes the string it's passed to lower case in-place:</p>\n\n<pre><code>char *to_lowercase(char* str){\n    for(char *p = str; *p; p++)\n      *p = tolower(*p);\n\n    return str;\n}\n</code></pre>\n\n<p>This overwrites the original content of <code>str</code> so you'll need to be sure to account for that in your code.</p>\n"}], "owner": {"reputation": 65, "user_id": 9968353, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-vyZkdglwb6A/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1mngI8cea0MCRF4YdKPJkl0sXhfw/mo/photo.jpg?sz=128", "display_name": "mendel", "link": "https://stackoverflow.com/users/9968353/mendel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "closed_date": 1577840374, "accepted_answer_id": 59545796, "answer_count": 2, "score": 0, "last_activity_date": 1577808572, "creation_date": 1577804667, "last_edit_date": 1577808572, "question_id": 59545707, "link": "https://stackoverflow.com/questions/59545707/problem-in-calling-a-function-converting-string-to-lowercase-using-c", "closed_reason": "Needs details or clarity", "title": "problem in calling a function converting string to lowercase using c", "body": "<p>Below is the c code to kill a window in a versatile way.</p>\n\n<p>When I call it in this way, it shows the message and then got stuck.</p>\n\n<pre><code>killWindowsVersatile.exe key ci ever 2 1000 \"Super\"\n\n...closing window with argument:key,ci,ever,2,1000,Super,\nname_key = 2;\ncs_ci = 2;\never_once = 1;\ndelay for 2 seconds start...\nremaining 2 seconds ...\nremaining 1 seconds ...\nremaining 0 seconds ...\nentering ever mode\n</code></pre>\n\n<p>Below is the code of the file:\nIt kills window either by name or a key word, and can delay for seconds, and can be case sensitive or insensitive. It can also loop the command by itself in a interval time of spacing.</p>\n\n<p>There may be something wrong in the to_lowercase function. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#define WINVER 0x0600\n#define _WIN32_IE 0x0500\n#include &lt;windows.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;ctype.h&gt;\n\nint name_key,cs_ci,ever_once,delay;\n\n//the order of function is important! you cannot call something before defined !\nconst char * to_lowercase(char* str){\n    int len = strlen(str);\n    char * newStr[len];\n    for(int i = 0; str[i]; i++){\n      newStr[i] = tolower(str[i]);\n    }\n    return newStr;\n}\n\nBOOL CALLBACK WindowFoundCB(HWND hwnd, char* param){\n    char *key = (char*) param;\n    char title[256]; // This way, you have allocated 256 bytes for the Window name.\n    GetWindowText(hwnd, title, 256);\n    HWND me = GetConsoleWindow();\n    if (IsWindowVisible(hwnd) &amp;&amp; hwnd != me){\n        if(cs_ci==1){\n            char *p = strstr(title,key);\n            if (p!= NULL){\n                SendMessage(hwnd, WM_SYSCOMMAND, SC_CLOSE, 0);\n                printf(\"==== close a window by key [%s]: &lt;%s&gt;\\n\",key,title);\n            }\n        }else if(cs_ci==2){\n            char title_lower[256];\n            char key_lower[256];\n            strcpy(title_lower,to_lowercase(title));\n            strcpy(key_lower,to_lowercase(key));\n            //char *title_lower = to_lowercase(title);\n            //char *key_lower = to_lowercase(key);\n            char *p = strstr(title_lower,key_lower);\n            if (p!= NULL){\n                SendMessage(hwnd, WM_SYSCOMMAND, SC_CLOSE, 0);\n                printf(\"==== close a window by key [%s]: &lt;%s&gt;\\n\",key,title);\n            }\n        }\n    }\n    return TRUE;\n}\n\nint dealwithonce(int name_key,int cs_ci,char *argv[],int argc){\n\n    for(int i = 6; i &lt; argc; i++){\n        if(name_key == 1){\n            HWND hwnd = FindWindow(NULL, argv[i]);\n            if(hwnd){\n                char strIte[256]; // This way, you have allocated 256 bytes for the Window name.\n                GetWindowText(hwnd, strIte, 256);\n                if( (cs_ci==2) || ((cs_ci==1)&amp;&amp; !strcmp(strIte,argv[i])) ){\n                    SendMessage(hwnd, WM_SYSCOMMAND, SC_CLOSE, 0);\n                    printf(\"==== close a window by name [%s]\\n\",argv[i]);\n                }\n            }\n        }else if(name_key == 2){\n            char* aStr = argv[i];\n            EnumWindows(WindowFoundCB,aStr);\n        }\n    }\n}\n\nint main(int argc, char *argv[])\n{\n    // argumrnt check\n        printf(\"...closing window with argument:\");\n        for(int i = 1; i &lt; argc; i++){\n            printf(\"%s,\", argv[i]);\n        }\n        printf(\"\\n\");\n\n    // argument parse\n        if(argc &lt; 7){\n            printf(\"%s\\n\",\"you must input 5 arguments at least!\");\n            printf(\"%s\\n\",\"arg1: [name] or [key]\");\n            printf(\"%s\\n\",\"arg2: [cs] for case-sensitive or [ci] for case-insensitive\");\n            printf(\"%s\\n\",\"arg3: [ever] for forever or [once] for once\");\n            printf(\"%s\\n\",\"arg4: the seconds for delay before start., 0,1,2...\");\n            printf(\"%s\\n\",\"arg5: the milliseconds of Cycle for ever mode., 1,2,500,1000,...\");\n            printf(\"%s\\n\",\"arg6+: the assembly of any strings\");\n            return 0;\n        };\n\n        if(!strcmp(argv[1],\"name\")){\n            printf(\"name_key = 1;\\n\");\n            name_key = 1;\n        }else if(!strcmp(argv[1],\"key\")){\n            printf(\"name_key = 2;\\n\");\n            name_key = 2;\n        }\n        if (!strcmp(argv[2],\"cs\")){\n            printf(\"cs_ci = 1;\\n\");\n            cs_ci = 1;\n        }else if(!strcmp(argv[2],\"ci\")){\n            printf(\"cs_ci = 2;\\n\");\n            cs_ci = 2;\n        }\n        if (!strcmp(argv[3],\"ever\")){\n            printf(\"ever_once = 1;\\n\");\n            ever_once = 1;\n        }else if(!strcmp(argv[3],\"once\")){\n            printf(\"ever_once = 2;\\n\");\n            ever_once = 2;\n        }\n\n        // delay\n        delay = atoi(argv[4]);\n        if(delay &gt; 0){\n            printf(\"delay for %d seconds start...\\n\",delay);\n            for(int i=delay;i&gt;=0;i--){\n                printf(\"remaining %d seconds ...\\n\",i);\n                Sleep(1000);\n            }\n        }\n\n        //cycle\n        int interval = atoi(argv[5]);\n\n        // ever or not\n        if(ever_once == 1){\n            printf(\"entering ever mode\\n\");\n            while(1){\n                dealwithonce(name_key,cs_ci,argv,argc);\n                Sleep(interval);\n            }\n        }else if(ever_once == 2){\n            printf(\"entering once mode\\n\");\n            dealwithonce(name_key,cs_ci,argv,argc);\n        }\n        return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "pointers", "struct"], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 1, "last_activity_date": 1577804496, "creation_date": 1577804496, "answer_id": 59545666, "question_id": 59545626, "link": "https://stackoverflow.com/questions/59545626/adding-a-int-from-a-struct-pointer/59545666#59545666", "title": "adding a int from a struct pointer", "body": "<p>You declare <code>advanceDay</code> to return a value, but you don't return anything.  You invoke <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a> by failing to return a value from this function and then subsequently attempting to use the return value.</p>\n\n<p>Create a copy of the passed in <code>struct date</code>, perform the operation on the copy, and return it.</p>\n\n<pre><code>struct date advanceDay(struct date d) {\n    struct date nextDay;\n    nextDay.day = nextDay.day+1;\n    return nextDay;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 952, "user_id": 12521158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8e745b4953a3ecbe3a1f7147089a7a7?s=128&d=identicon&r=PG&f=1", "display_name": "kopecs", "link": "https://stackoverflow.com/users/12521158/kopecs"}, "edited": false, "score": 1, "creation_date": 1577813245, "post_id": 59545699, "comment_id": 105262867, "body": "I think you forgot to change the return type to <code>void</code> in your fixed code."}, {"owner": {"reputation": 249903, "user_id": 2422776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2353050223ebecb113741c29458de4b2?s=128&d=identicon&r=PG", "display_name": "Mureinik", "link": "https://stackoverflow.com/users/2422776/mureinik"}, "reply_to_user": {"reputation": 952, "user_id": 12521158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8e745b4953a3ecbe3a1f7147089a7a7?s=128&d=identicon&r=PG&f=1", "display_name": "kopecs", "link": "https://stackoverflow.com/users/12521158/kopecs"}, "edited": false, "score": 0, "creation_date": 1577815023, "post_id": 59545699, "comment_id": 105263360, "body": "@kopecs indeed, copy-and-bug :-( Thanks for noticing, edited and fixed."}], "tags": [], "owner": {"reputation": 249903, "user_id": 2422776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2353050223ebecb113741c29458de4b2?s=128&d=identicon&r=PG", "display_name": "Mureinik", "link": "https://stackoverflow.com/users/2422776/mureinik"}, "is_accepted": true, "score": 2, "last_activity_date": 1577814990, "last_edit_date": 1577814990, "creation_date": 1577804646, "answer_id": 59545699, "question_id": 59545626, "link": "https://stackoverflow.com/questions/59545626/adding-a-int-from-a-struct-pointer/59545699#59545699", "title": "adding a int from a struct pointer", "body": "<p>Note that <code>advanceDay</code> doesn't explicitly return anything, resulting in undefined behavior (and probably reading uninitialized memory - the compiler should have warned you about it).</p>\n\n<p>Instead, you could pass a <code>struct date*</code> to the function, and update it in place:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>void advanceDay(struct date * d) {\n    d-&gt;day = d-&gt;day + 1;\n}\n</code></pre>\n\n<p>Note that your main also needs to change accordingly:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>int main(void) {\n    struct date today;\n    readDate(&amp;today);\n    printDate(today);\n    advanceDay(&amp;today); /* no retrun value here */\n    printDate(today); /* today was updated in-place */\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 357, "user_id": 11805611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e29dac1699fd306834e9a2d4eb0ff86a?s=128&d=identicon&r=PG&f=1", "display_name": "Katie Melosto", "link": "https://stackoverflow.com/users/11805611/katie-melosto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 59545699, "answer_count": 2, "score": 3, "last_activity_date": 1577814990, "creation_date": 1577804261, "last_edit_date": 1577804933, "question_id": 59545626, "link": "https://stackoverflow.com/questions/59545626/adding-a-int-from-a-struct-pointer", "title": "adding a int from a struct pointer", "body": "<p>I'm trying to increase the day of a date struct in C. I keep getting a return where the memory seems to be adding [not the actual int day in the struct].</p>\n\n<p>For example, if I INPUT:</p>\n\n<blockquote>\n  <p>2018 10 2</p>\n</blockquote>\n\n<p>I should get</p>\n\n<p>OUTPUT:</p>\n\n<blockquote>\n  <p>10/03/2018</p>\n</blockquote>\n\n<p>INSTEAD, I GET:                                                                   </p>\n\n<blockquote>\n  <p>32594/10/-352487872 </p>\n</blockquote>\n\n<p>I believe I'm not using pointers correctly in the method: <code>advanceDay(struct date d)</code></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nstruct date {\n        int year;\n        int month;\n        int day;\n    };\n\n/* function prototypes */\nvoid printDate(struct date);\nvoid readDate(struct date *);\nstruct date advanceDay(struct date); \n\nint main(void) {\n    struct date today, tomorrow;\n    readDate(&amp;today);\n    printDate(today);\n    tomorrow = advanceDay(today);\n    printDate(tomorrow);\n    return 0;\n}\n\n/* add your function definitions here */\nvoid printDate(struct date d) {\n    printf(\"%02d/%02d/%04d\\n\", d.month, d.day, d.year);\n}\n\nvoid readDate(struct date *d){\n    scanf(\"%d %d %d\", &amp;(d-&gt;year), &amp;(d-&gt;month), &amp;(d-&gt;day));\n}\n\nstruct date advanceDay(struct date d) {\n    d.day = d.day+1;\n}\n\n</code></pre>\n\n<p>I've tried to change\n<code>d.day = d.day+1;</code>\nto \n<code>d.day = (*d.day)+1;</code>\nBut I get an error. I've tried the -> and also moving around the *</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1980, "user_id": 11517179, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zH4UW.gif?s=128&g=1", "display_name": "daShier", "link": "https://stackoverflow.com/users/11517179/dashier"}, "edited": false, "score": 4, "creation_date": 1577803649, "post_id": 59545516, "comment_id": 105259879, "body": "Because the name of an array is already a pointer to the first element."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 1980, "user_id": 11517179, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zH4UW.gif?s=128&g=1", "display_name": "daShier", "link": "https://stackoverflow.com/users/11517179/dashier"}, "edited": false, "score": 3, "creation_date": 1577804051, "post_id": 59545516, "comment_id": 105260008, "body": "@daShier: No it isn&#39;t. It&#39;s still an array. The mechanism by which it can be &quot;regarded&quot; as pointer is by <i>decay</i>."}], "answers": [{"comments": [{"owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "edited": false, "score": 2, "creation_date": 1577803719, "post_id": 59545532, "comment_id": 105259911, "body": "Actually, character arrays <i>are not</i> pointers - they just decay to such in certain circumstances (like when used as function parameters)."}, {"owner": {"reputation": 2849, "user_id": 6496264, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-4GXZ7-7uHNc/AAAAAAAAAAI/AAAAAAAAAFM/ax4-x7Z13Ew/photo.jpg?sz=128", "display_name": "Sami Hult", "link": "https://stackoverflow.com/users/6496264/sami-hult"}, "reply_to_user": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "edited": false, "score": 1, "creation_date": 1577804023, "post_id": 59545532, "comment_id": 105260003, "body": "I&#39;m not sure that helps here to understand the difference. But I&#39;ll try to formulate (edits are welcome too) a more correct and thorough answer later, unless a more helpful emerges and the question is not actually a duplicate."}, {"owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "edited": false, "score": 1, "creation_date": 1577804111, "post_id": 59545532, "comment_id": 105260027, "body": "Please do so! Remember, your answer may well be looked upon by many, many people, over the coming decades. Accuracy is all! (BTW, I meant no insult to your answer - just suggesting an improvement, as many have done to posts that I&#39;ve made.)"}, {"owner": {"reputation": 2849, "user_id": 6496264, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-4GXZ7-7uHNc/AAAAAAAAAAI/AAAAAAAAAFM/ax4-x7Z13Ew/photo.jpg?sz=128", "display_name": "Sami Hult", "link": "https://stackoverflow.com/users/6496264/sami-hult"}, "reply_to_user": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "edited": false, "score": 0, "creation_date": 1577804182, "post_id": 59545532, "comment_id": 105260049, "body": "Yes, I completely agree."}], "tags": [], "owner": {"reputation": 2849, "user_id": 6496264, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-4GXZ7-7uHNc/AAAAAAAAAAI/AAAAAAAAAFM/ax4-x7Z13Ew/photo.jpg?sz=128", "display_name": "Sami Hult", "link": "https://stackoverflow.com/users/6496264/sami-hult"}, "is_accepted": false, "score": 3, "last_activity_date": 1577804932, "last_edit_date": 1577804932, "creation_date": 1577803645, "answer_id": 59545532, "question_id": 59545516, "link": "https://stackoverflow.com/questions/59545516/why-does-an-integer-need-an-ampersand-when-formatting-a-pointer-in-printf-while/59545532#59545532", "title": "Why does an integer need an ampersand when formatting a pointer in printf while a character array doesn&#39;t in C?", "body": "<p><code>&amp;</code> will yield the pointer to the value (reference it). Character arrays are already treated as pointers in that context.</p>\n\n<p>I dare you to try comparing values of <code>buffer_one</code> and <code>&amp;buffer_one</code>. They are of different types, and compiler should warn you, but the actual value should be the same, nevertheless.</p>\n\n<pre><code>char buffer_one[8];\nassert(buffer_one == &amp;buffer_one); // should pass\n</code></pre>\n\n<p>Note that this is different from character pointers that can be used as string variables as well (from practical point of view). Referencing a pointer yields an address to that pointer:</p>\n\n<pre><code>char *test = \"lorem\";\nassert(test != &amp;test); // should pass\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 6, "last_activity_date": 1577803910, "creation_date": 1577803910, "answer_id": 59545570, "question_id": 59545516, "link": "https://stackoverflow.com/questions/59545516/why-does-an-integer-need-an-ampersand-when-formatting-a-pointer-in-printf-while/59545570#59545570", "title": "Why does an integer need an ampersand when formatting a pointer in printf while a character array doesn&#39;t in C?", "body": "<p>Although <code>buffer_one</code> is a <code>char[8]</code> type, under certain instances, such as when passed as a function parameter, it <em>decays</em> to a pointer set to the first element of the array. That pointer will be a <code>char*</code> type.</p>\n\n<p>Since the first parameter of <code>strcpy</code> is expected to be a <code>char*</code> type, compilation is successful.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1577805219, "last_edit_date": 1577805219, "creation_date": 1577804916, "answer_id": 59545757, "question_id": 59545516, "link": "https://stackoverflow.com/questions/59545516/why-does-an-integer-need-an-ampersand-when-formatting-a-pointer-in-printf-while/59545757#59545757", "title": "Why does an integer need an ampersand when formatting a pointer in printf while a character array doesn&#39;t in C?", "body": "<blockquote>\n  <p>Why does an integer need an ampersand when formatting a pointer in printf while a character array doesn't?</p>\n</blockquote>\n\n<p>To print the pointer of an object like <code>int</code> or <code>char []</code>, code uses <code>&amp;</code> to get the address of the object.</p>\n\n<pre><code>int value = 5;\nchar buffer_one[8];\n\nprintf(\"Address of an int: %p\\n\", (void *) &amp;value);\nprintf(\"Address of an array: %p\\n\", (void *) &amp;buffer_one);\n</code></pre>\n\n<p>If code does not use <code>&amp;</code>, then the object must be or convert to a pointer.  In the following, the array <code>buffer_one</code> is converted to the address of it first element.</p>\n\n<pre><code>printf(\"Address of initial array element: %p\\n\", (void *) buffer_one);\n</code></pre>\n\n<p><strong>Conclusion</strong> The <code>&amp;value</code> is needed as the <code>int</code> does not automatically convert to a pointer.  <code>buffer_one</code> does not need a <code>&amp;</code> as it converts to a pointer in this usage.  <code>buffer_one</code> can also use a <code>&amp;</code>, like any object.</p>\n\n<hr>\n\n<p>The address of the array <code>buffer_one</code> is the same memory location as the address of its first element. Although its is <em>very common</em>, that the last 2 prints above will print the same pointer, C does not require this.  The address of the array and the address of the <code>char</code> are <em>equivalent</em>, though not necessarily encoded the same.</p>\n"}], "owner": {"reputation": 77, "user_id": 5273909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbd276c23c9b8d73acba63ce13337830?s=128&d=identicon&r=PG&f=1", "display_name": "Magusviper", "link": "https://stackoverflow.com/users/5273909/magusviper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 59545570, "answer_count": 3, "score": 2, "last_activity_date": 1577805219, "creation_date": 1577803557, "question_id": 59545516, "link": "https://stackoverflow.com/questions/59545516/why-does-an-integer-need-an-ampersand-when-formatting-a-pointer-in-printf-while", "title": "Why does an integer need an ampersand when formatting a pointer in printf while a character array doesn&#39;t in C?", "body": "<p>Specifically, when I want to format the pointer of said integer. I'm working through The Art of Exploitation, and it stuck out to me in the following code snippet.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(int argc, char *argv[]) {\n    int value = 5;\n    char buffer_one[8], buffer_two[8];\n\n    strcpy(buffer_one, \"one\"); /* Put \"one\" into buffer_one. */\n    strcpy(buffer_two, \"two\"); /* Put \"two\" into buffer_two. */\n\n    printf(\"[BEFORE] buffer_two is at %p and contains \\'%s\\'\\n\", buffer_two, buffer_two);\n    printf(\"[BEFORE] buffer_one is at %p and contains \\'%s\\'\\n\", buffer_one, buffer_one);\n    printf(\"[BEFORE] value is at %p and is %d (0x%08x)\\n\", &amp;value, value, value);\n\n    printf(\"\\n[STRCPY] copying %d bytes into buffer_two\\n\\n\", strlen(argv[1]));\n    strcpy(buffer_two, argv[1]); /* Copy first argument into buffer_two. */\n\n    printf(\"[AFTER] buffer_two is at %p and contains \\'%s\\'\\n\", buffer_two, buffer_two);\n    printf(\"[AFTER] buffer_one is at %p and contains \\'%s\\'\\n\", buffer_one, buffer_one);\n    printf(\"[AFTER] value is at %p and is %d (0x%08x)\\n\", &amp;value, value, value);\n}\n</code></pre>\n"}, {"tags": ["c", "webassembly"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user3520669"}, "edited": false, "score": 1, "creation_date": 1577803834, "post_id": 59545527, "comment_id": 105259931, "body": "Both emrun and the minimal python server solutions work. Seems like the only way to serve WASM is through a web server."}, {"owner": {"reputation": 1953, "user_id": 6400614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sp43M.jpg?s=128&g=1", "display_name": "Rahul Bharadwaj", "link": "https://stackoverflow.com/users/6400614/rahul-bharadwaj"}, "edited": false, "score": 0, "creation_date": 1577803895, "post_id": 59545527, "comment_id": 105259956, "body": "Correct, the developer docs says the following: <code>Finally, to actually run the program, we cannot simply open the HTML file in a web browser because cross-origin requests are not supported for the file protocol scheme. We have to actually serve the output files over HTTP.</code>"}], "tags": [], "owner": {"reputation": 1953, "user_id": 6400614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sp43M.jpg?s=128&g=1", "display_name": "Rahul Bharadwaj", "link": "https://stackoverflow.com/users/6400614/rahul-bharadwaj"}, "is_accepted": true, "score": 5, "last_activity_date": 1577803941, "last_edit_date": 1577803941, "creation_date": 1577803626, "answer_id": 59545527, "question_id": 59545455, "link": "https://stackoverflow.com/questions/59545455/web-assembly-typeerror-networkerror-when-attempting-to-fetch-resource/59545527#59545527", "title": "Web Assembly - TypeError: NetworkError when attempting to fetch resource", "body": "<p>I had the same issue and I tried a few solutions, these seem to work:</p>\n\n<p>(1) See if the <code>emrun</code> webserver can run the file via:</p>\n\n<pre><code>emrun --no_browser --port 8080 .\n</code></pre>\n\n<p>(and open the site in your browser, i.e. <code>localhost:8080</code>)</p>\n\n<p>(2) If not, then try using this <code>git</code> repo for <code>emsdk</code> :</p>\n\n<pre><code>git clone https://github.com/juj/emsdk.git\ncd emsdk\n./emsdk install latest\n./emsdk activate latest\nsource ./emsdk_env.sh\n</code></pre>\n\n<p>And then try <code>emrun</code> as in method (1).</p>\n\n<p>CORS is enabled and that prevents the <code>.wasm</code> file from being downloaded. So running a small server to access the <code>html</code> files works (this includes a simple python server via <code>python3 -m http.server</code> !)</p>\n\n<p>This is also mentioned in the developer guide:</p>\n\n<blockquote>\n  <p>Finally, to actually run the program, we cannot simply open the HTML\n  file in a web browser because cross-origin requests are not supported\n  for the file protocol scheme. We have to actually serve the output\n  files over HTTP.</p>\n</blockquote>\n\n<p>You can refer all this information from here: <a href=\"https://webassembly.org/getting-started/developers-guide/\" rel=\"noreferrer\">https://webassembly.org/getting-started/developers-guide/</a> </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user3520669"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 635, "favorite_count": 2, "accepted_answer_id": 59545527, "answer_count": 1, "score": 5, "last_activity_date": 1577803941, "creation_date": 1577803163, "question_id": 59545455, "link": "https://stackoverflow.com/questions/59545455/web-assembly-typeerror-networkerror-when-attempting-to-fetch-resource", "title": "Web Assembly - TypeError: NetworkError when attempting to fetch resource", "body": "<p>I'm attempting to compile a simple hello world program from C into web assembly. I've been following the guide provided by MDN (<a href=\"https://developer.mozilla.org/en-US/docs/WebAssembly/C_to_wasm\" rel=\"noreferrer\">https://developer.mozilla.org/en-US/docs/WebAssembly/C_to_wasm</a>). Upon navigating to the HTML page via Firefox 71 I receive a <code>TypeError: \u201cNetworkError when attempting to fetch resource.\u201d</code> error.</p>\n\n<p>Here's the C code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint\nmain(int argc, char *argv[]) {\n    printf(\"hello, world!\");\n    return 0;\n}\n</code></pre>\n\n<p>And the command used to compile:</p>\n\n<pre><code>emcc hello.c -s WASM=1 -o hello.html\n</code></pre>\n\n<p>Am I missing something? Has anyone else encountered this problem? Thank you in advance.</p>\n"}, {"tags": ["c", "winapi", "utf-8", "console"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1577803636, "post_id": 59545262, "comment_id": 105259873, "body": "Outputting in UTF-8 is a separate matter from the console rendering the glyphs you expect.  The question mark is a very common replacement character, displayed by many text systems when the font in use does not have a glyph for a given character."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1577803808, "post_id": 59545262, "comment_id": 105259928, "body": "See this closely-related question: <a href=\"https://stackoverflow.com/questions/388490/how-to-use-unicode-characters-in-windows-command-line/388500#388500\">How to use unicode characters in Windows command line</a>.  It is a tad old, so maybe things have changed, but do note this particularly on-point comment from the accepted answer: &quot;Console font rendering supports only Unicode characters in BMP (in other words: below U+10000).&quot;"}, {"owner": {"reputation": 29, "user_id": 12599964, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QlYTyZRSkc0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rch2DDEKTu5ZN9U-YKfKYg7fjcdaw/photo.jpg?sz=128", "display_name": "Tianchen Tang", "link": "https://stackoverflow.com/users/12599964/tianchen-tang"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1577804585, "post_id": 59545262, "comment_id": 105260196, "body": "@JohnBollinger Thanks for the reply, I have already tried changing the console codepage by <code>SetConsoleOutputCP</code> function.  It&#39;s still not working at all."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 1, "creation_date": 1577807754, "post_id": 59545262, "comment_id": 105261245, "body": "convert utf-8 to wide char string via MultiByteToWideChar(CP_UTF8, ...) and then call <code>WriteConsoleW</code>"}, {"owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 1, "creation_date": 1577816263, "post_id": 59545262, "comment_id": 105263712, "body": "Windows console supports UTF8 output (not input) for Windows 8 and 10+, call <code>SetConsoleOutputCP</code> with UTF8 string <code>u8&quot;\u4f60\u597d\u554a\uff01ABC&quot;</code>. Or use <code>_setmode(_fileno(stdout), _O_WTEXT);</code> with UTF16 for compatibility."}, {"owner": {"reputation": 29, "user_id": 12599964, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QlYTyZRSkc0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rch2DDEKTu5ZN9U-YKfKYg7fjcdaw/photo.jpg?sz=128", "display_name": "Tianchen Tang", "link": "https://stackoverflow.com/users/12599964/tianchen-tang"}, "reply_to_user": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 0, "creation_date": 1577883210, "post_id": 59545262, "comment_id": 105273829, "body": "@BarmakShemirani Thanks! That&#39;s exactly what I needed.  But why utf-8 strings and ANSI strings are not compatible to each other in windows?  I can do it in linux without any problems."}, {"owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 0, "creation_date": 1577888851, "post_id": 59545262, "comment_id": 105275149, "body": "@TianchenTang, That&#39;s also related to the compiler. Visual Studio requires explicit u8 prefix, because Windows uses UTF16 internally, with ANSI backup support. On the other hand, gcc may assume the strings are UTF8, because Linux uses UTF8 internally."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 12599964, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QlYTyZRSkc0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rch2DDEKTu5ZN9U-YKfKYg7fjcdaw/photo.jpg?sz=128", "display_name": "Tianchen Tang", "link": "https://stackoverflow.com/users/12599964/tianchen-tang"}, "edited": false, "score": 0, "creation_date": 1577882988, "post_id": 59550496, "comment_id": 105273774, "body": "Isn&#39;t wprint outputting utf-16 strings in your code?  &#39;L&#39; prefix indicates a wchar_t string, which is utf-16 string?  If so, why setting codepage to utf-8 is working?"}, {"owner": {"reputation": 8787, "user_id": 6601582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd0a2f69702729da5aaa628bc58811a7?s=128&d=identicon&r=PG&f=1", "display_name": "Rita Han", "link": "https://stackoverflow.com/users/6601582/rita-han"}, "reply_to_user": {"reputation": 29, "user_id": 12599964, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QlYTyZRSkc0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rch2DDEKTu5ZN9U-YKfKYg7fjcdaw/photo.jpg?sz=128", "display_name": "Tianchen Tang", "link": "https://stackoverflow.com/users/12599964/tianchen-tang"}, "edited": false, "score": 0, "creation_date": 1577929570, "post_id": 59550496, "comment_id": 105283377, "body": "@TianchenTangt In order to print Chinese, two-bytes character is required at least. So you need <a href=\"https://en.wikipedia.org/wiki/UTF-8\" rel=\"nofollow noreferrer\">UTF-8</a> contains two bytes which is <a href=\"https://docs.microsoft.com/en-us/cpp/c-runtime-library/unicode-the-wide-character-set?view=vs-2019\" rel=\"nofollow noreferrer\">wide character</a> requires <code>wprintf</code> to print."}], "tags": [], "owner": {"reputation": 8787, "user_id": 6601582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd0a2f69702729da5aaa628bc58811a7?s=128&d=identicon&r=PG&f=1", "display_name": "Rita Han", "link": "https://stackoverflow.com/users/6601582/rita-han"}, "is_accepted": false, "score": 0, "last_activity_date": 1577861106, "creation_date": 1577861106, "answer_id": 59550496, "question_id": 59545262, "link": "https://stackoverflow.com/questions/59545262/how-to-write-utf-8-strings-to-windows-console/59550496#59550496", "title": "How to write UTF-8 strings to windows console?", "body": "<blockquote>\n  <p>When I used _setmode to set stdout to _O_U8TEXT, it threw an assertion\n  error</p>\n</blockquote>\n\n<p><a href=\"https://docs.microsoft.com/en-us/cpp/c-runtime-library/reference/printf-printf-l-wprintf-wprintf-l?view=vs-2019\" rel=\"nofollow noreferrer\"><code>printf</code></a> does not currently support output into a <code>UNICODE</code> stream. Use <code>wprintf</code> instead.</p>\n\n<p>You can try the following code to see if it helps:</p>\n\n<pre><code>//Sets the output code page used by the console associated with the calling process.\nSetConsoleOutputCP(CP_UTF8); //Unicode (UTF-8)\n_setmode(_fileno(stdout), _O_U8TEXT); // _O_U16TEXT / _O_WTEXT\n\nwprintf(L\"\u4f60\u597d\u554a\uff01ABC\");\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/UIQb8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UIQb8.png\" alt=\"enter image description here\"></a></p>\n\n<p>Refer to <a href=\"https://docs.microsoft.com/en-us/windows/win32/intl/code-page-identifiers?redirectedfrom=MSDN\" rel=\"nofollow noreferrer\">Code Page Identifiers</a>, <a href=\"https://docs.microsoft.com/en-us/windows/console/setconsoleoutputcp\" rel=\"nofollow noreferrer\">SetConsoleOutputCP</a> and <a href=\"https://docs.microsoft.com/en-us/cpp/c-runtime-library/reference/setmode?view=vs-2019\" rel=\"nofollow noreferrer\">_setmode</a>.</p>\n"}], "owner": {"reputation": 29, "user_id": 12599964, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QlYTyZRSkc0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rch2DDEKTu5ZN9U-YKfKYg7fjcdaw/photo.jpg?sz=128", "display_name": "Tianchen Tang", "link": "https://stackoverflow.com/users/12599964/tianchen-tang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 239, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1593806835, "creation_date": 1577802145, "last_edit_date": 1577807303, "question_id": 59545262, "link": "https://stackoverflow.com/questions/59545262/how-to-write-utf-8-strings-to-windows-console", "title": "How to write UTF-8 strings to windows console?", "body": "<p>In win32 api I can display unicode by setting stdout mode to _O_U16TEXT and using wprintf.  But how can I write UTF-8 strings to console using printf?  </p>\n\n<p>When I used _setmode to set stdout to _O_U8TEXT, it threw an assertion error:  <a href=\"https://i.stack.imgur.com/27Bsa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/27Bsa.png\" alt=\"assertion error\"></a></p>\n\n<p>I also tried to set console output codepage to UTF-8, the character was replaced by question mark: <a href=\"https://i.stack.imgur.com/kJk0Y.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kJk0Y.png\" alt=\"enter image description here\"></a> </p>\n\n<p><strong>Code:</strong></p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;Windows.h&gt;\n#include &lt;io.h&gt;\n#include &lt;fcntl.h&gt;\n\nint main(int argc, const char *argv[])\n{\n    //SetConsoleOutputCP(CP_UTF8);\n    //_setmode(_fileno(stdout), _O_U8TEXT);\n    printf(\"\u4f60\u597d\u554a\uff01ABC\");\n}\n</code></pre>\n"}, {"tags": ["c", "valgrind", "cs50"], "comments": [{"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1577795952, "post_id": 59544257, "comment_id": 105257360, "body": "Which line is dictionary.c:114?"}, {"owner": {"reputation": 37, "user_id": 12458723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nSqSy.jpg?s=128&g=1", "display_name": "Rusty", "link": "https://stackoverflow.com/users/12458723/rusty"}, "reply_to_user": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1577796609, "post_id": 59544257, "comment_id": 105257577, "body": "node *n = malloc(sizeof(node));"}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1577796718, "post_id": 59544257, "comment_id": 105257610, "body": "That doesn&#39;t seem likely, as no variables are read there so there can&#39;t be access of an uninitialized value. Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 37, "user_id": 12458723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nSqSy.jpg?s=128&g=1", "display_name": "Rusty", "link": "https://stackoverflow.com/users/12458723/rusty"}, "reply_to_user": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1577796982, "post_id": 59544257, "comment_id": 105257720, "body": "im sorry that was 116 i gave you, 114 is the if statement above that checks for NULL"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1577799366, "post_id": 59544257, "comment_id": 105258520, "body": "That line numbering is not consistent with the valgrind output either, and I don&#39;t see a matching pattern anywhere in that code.  That leaves me inclined to suspect that the source presented does not correspond to the binary that was tested.  Perhaps you need to rebuild the binary against the current sources?"}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 12458723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nSqSy.jpg?s=128&g=1", "display_name": "Rusty", "link": "https://stackoverflow.com/users/12458723/rusty"}, "edited": false, "score": 0, "creation_date": 1577801017, "post_id": 59544873, "comment_id": 105259029, "body": "had been banging my head on that one for hours"}], "tags": [], "owner": {"reputation": 4475, "user_id": 5577076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qG4gB.png?s=128&g=1", "display_name": "DinoCoderSaurus", "link": "https://stackoverflow.com/users/5577076/dinocodersaurus"}, "is_accepted": true, "score": 0, "last_activity_date": 1577799750, "creation_date": 1577799750, "answer_id": 59544873, "question_id": 59544257, "link": "https://stackoverflow.com/questions/59544257/cs50-speller-uninitialised-value-was-created-by-a-heap-allocation-error/59544873#59544873", "title": "Cs50 Speller Uninitialised value was created by a heap allocation error", "body": "<p>Several immediate problems:</p>\n\n<p>If word contains an apostrophe, all pointers in root are set to NULL here:</p>\n\n<pre><code>for (int j = 0; j &lt; N; j++)\n                    {\n                        root-&gt;children[j] = NULL;\n                    }\n</code></pre>\n\n<p>Typo? That will make them \"unfreeable\" (not to mention, check will never find them).</p>\n\n<p>Same problem in the <code>else</code> branch:</p>\n\n<pre><code>for (int k = 0; k &lt; N; k++)\n                    {\n                        root-&gt;children[k] = NULL;\n                    }\n</code></pre>\n\n<p>The apostrophe check needs to be discrete. It also looks like program doesn't \"save\" enough pointers, but you won't be able to work through that until these big structural problems are corrected. </p>\n"}], "owner": {"reputation": 37, "user_id": 12458723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nSqSy.jpg?s=128&g=1", "display_name": "Rusty", "link": "https://stackoverflow.com/users/12458723/rusty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 59544873, "answer_count": 1, "score": 1, "last_activity_date": 1577799750, "creation_date": 1577795821, "question_id": 59544257, "link": "https://stackoverflow.com/questions/59544257/cs50-speller-uninitialised-value-was-created-by-a-heap-allocation-error", "title": "Cs50 Speller Uninitialised value was created by a heap allocation error", "body": "<p>I have some code that is supposed to take a dictionary file, read each word and add it to trie data structure setting a bool to true on the final node of the word.</p>\n\n<p>It runs but when i check words against the dictionary later in the check() function it was always saying false. </p>\n\n<p>Valgrind is throwing this error;</p>\n\n<pre><code>    ==20700== \n    ==20700== Conditional jump or move depends on uninitialised value(s)\n    ==20700==    at 0x40116F: load (dictionary.c:114)\n    ==20700==    by 0x400834: main (speller.c:40)\n    ==20700==  Uninitialised value was created by a heap allocation\n    ==20700==    at 0x4C2FB0F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n    ==20700==    by 0x401180: load (dictionary.c:116)\n    ==20700==    by 0x400834: main (speller.c:40)\n    ==20700== \n    Killed\n</code></pre>\n\n<p>I had a look around and added the loops that itterate through children[] and initialise to NULL after creating a new node, but still seem to have the issue.</p>\n\n<pre><code>// Represents a node in a trie\ntypedef struct node\n{\n    bool is_word;\n    struct node *children[N];\n}\nnode;\n\n// Represents a trie\nnode *root;\n\n// Loads dictionary into memory, returning true if successful else false\nbool load(const char *dictionary)\n{\n    // Initialize trie\n    root = malloc(sizeof(node));\n    if (root == NULL)\n    {\n        return false;\n    }\n    root-&gt;is_word = false;\n    for (int i = 0; i &lt; N; i++)\n    {\n        root-&gt;children[i] = NULL;\n    }\n\n    // Open dictionary\n    FILE *file = fopen(dictionary, \"r\");\n    if (file == NULL)\n    {\n        unload();\n        return false;\n    }\n\n    //declare pointer to store adress of current node\n    node *ptr = root;\n\n    // Buffer for a word\n    char word[LENGTH + 1];\n\n    for (int i = 0; i &lt; LENGTH + 1; i++)\n        {\n            word[i] = 0;\n        }\n\n    int size = 0;\n\n    // Insert words into trie\n    while (fscanf(file, \"%s\", word) != EOF)\n    {\n\n        // make pointer to current place in trie structure and intitialise to root\n        ptr = root;\n\n        // make variable to store chaacter as int representing position in alphabet\n        int alphaindex;\n\n        // iterate over letters in word\n        for (int i =0; i &lt; LENGTH; i++)\n        {\n\n\n\n            // if word i == to ' character check ptr children and make new node if necesary\n            if ((int)&amp;word[i] == '\\'')\n            {\n                alphaindex = 26;\n                if (ptr-&gt; children[alphaindex] == NULL)\n                {\n                    node *n = malloc(sizeof(node));\n\n                    if (n == NULL)\n                    {\n                        return 1;\n                    }\n\n                    root-&gt;is_word = false;\n\n                    for (int j = 0; j &lt; N; j++)\n                    {\n                        root-&gt;children[j] = NULL;\n                    }\n\n\n                    // set 27th element of children to new node\n                    ptr -&gt; children[alphaindex] = n;\n                }\n\n                // set ptr to ptr[26]\n\n                ptr = ptr -&gt; children[alphaindex];\n\n            }\n\n            else\n            {\n\n                // adjust alphainex\n                alphaindex = islower((int) word[i]) ? (int) word[i] - 97 : (int) word[i] - 65;\n\n                //check location for NULL and make new index if necessary\n                if (ptr -&gt; children[alphaindex] == NULL)\n                {\n                    node *n = malloc(sizeof(node));\n\n                    if (n == NULL)\n                    {\n                        return 1;\n                    }\n\n                    root-&gt;is_word = false;\n\n                    for (int k = 0; k &lt; N; k++)\n                    {\n                        root-&gt;children[k] = NULL;\n                    }\n\n                    // set children[alphaindex] to new node\n                    ptr -&gt; children[alphaindex] = n;\n\n                    //set ptr to new alphaindex element of array which its self points to the new node\n                    ptr = ptr -&gt; children[alphaindex];\n                }\n\n                else\n                {\n\n                //set ptr to new alphaindex element of array which its self points to the new node\n                ptr = ptr -&gt; children[alphaindex];\n\n                }\n\n\n            }\n\n\n\n            // if the character is 0 word is over, set is_word and return to while loop\n            if((char) word[i + 1] == 0)\n            {\n                ptr -&gt; is_word = true;\n                size ++;\n                break;\n            }\n\n\n\n        }\n\n\n\n    }\n\n    printf(\"Size of dictionary = %i\\n\", size);\n\n    // Close dictionary\n    fclose(file);\n\n    // Indicate success\n    return true;\n}\n</code></pre>\n\n<p>Im fairly sure that as the conditional with this error is where I evaluate weather or not to make a new node that this will be causing the errors when i try to test words against it later.</p>\n\n<p>Thanks in advance for your help</p>\n\n<p>Alex</p>\n"}, {"tags": ["c", "memory-leaks", "winbgi"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1577798501, "post_id": 59544233, "comment_id": 105258191, "body": "Please post a compilable <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> for others to test, you will get help much more faster that way."}], "answers": [{"tags": [], "owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "is_accepted": true, "score": 1, "last_activity_date": 1577806815, "creation_date": 1577806815, "answer_id": 59546031, "question_id": 59544233, "link": "https://stackoverflow.com/questions/59544233/why-is-winbgi-function-settextstyle-occupying-memory-on-the-heap/59546031#59546031", "title": "Why is winbgi function settextstyle() occupying memory on the heap?", "body": "<p>Pull the latest winbgi sources from <a href=\"https://www.cs.colorado.edu/~main/cs1300/bgi/\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>There was a bug (missing call to <code>DeleteObject()</code> after <code>SelectObject()</code> to set a new font in <code>set_font()</code>) within <code>text.cxx</code> which the code linked fixes.</p>\n"}], "owner": {"reputation": 13, "user_id": 12620517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94d8d0501cc82dd1c64575a9eaaf9daa?s=128&d=identicon&r=PG&f=1", "display_name": "Michu01", "link": "https://stackoverflow.com/users/12620517/michu01"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 59546031, "answer_count": 1, "score": 1, "last_activity_date": 1577812260, "creation_date": 1577795663, "last_edit_date": 1577812260, "question_id": 59544233, "link": "https://stackoverflow.com/questions/59544233/why-is-winbgi-function-settextstyle-occupying-memory-on-the-heap", "title": "Why is winbgi function settextstyle() occupying memory on the heap?", "body": "<p>I am making a snake game in C using <code>winbgi</code> library. I have a problem with function <code>settextstyle()</code>. Every call of function adds memory to the heap (about 50kb). I have to use this function in loop, so at some point the heap starts to overflow. Is there a way to release memory occupied by this function? Or some other way to change the size of the text in <code>winbgi</code>?</p>\n\n<pre><code>while(1)\n{\n    settextstyle(DEFAULT_FONT, HORIZ_DIR, 4)\n    outtext(...)\n    settextstyle(DEFAULT_FONT, HORIZ_DIR, 2)\n    outtext(...)\n}\n</code></pre>\n"}, {"tags": ["c", "winapi"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1577794184, "post_id": 59543798, "comment_id": 105256742, "body": "Your <code>WindowFoundCB</code> expects a <code>char*</code>. You are passing a <code>char**</code>."}, {"owner": {"reputation": 65, "user_id": 9968353, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-vyZkdglwb6A/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1mngI8cea0MCRF4YdKPJkl0sXhfw/mo/photo.jpg?sz=128", "display_name": "mendel", "link": "https://stackoverflow.com/users/9968353/mendel"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1577794285, "post_id": 59543798, "comment_id": 105256778, "body": "Hi, I use EnumWindows(WindowFoundCB,aStr) instead, but this time the programme exit upon start."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 2, "creation_date": 1577794461, "post_id": 59543798, "comment_id": 105256835, "body": "You successfully closed your own window.  Use GetConsoleWindow() to bypass your own."}, {"owner": {"reputation": 65, "user_id": 9968353, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-vyZkdglwb6A/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1mngI8cea0MCRF4YdKPJkl0sXhfw/mo/photo.jpg?sz=128", "display_name": "mendel", "link": "https://stackoverflow.com/users/9968353/mendel"}, "edited": false, "score": 0, "creation_date": 1577794646, "post_id": 59543798, "comment_id": 105256899, "body": "My own window title does not have the matched keyword, so the strstr should return NULL?"}, {"owner": {"reputation": 65, "user_id": 9968353, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-vyZkdglwb6A/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1mngI8cea0MCRF4YdKPJkl0sXhfw/mo/photo.jpg?sz=128", "display_name": "mendel", "link": "https://stackoverflow.com/users/9968353/mendel"}, "edited": false, "score": 1, "creation_date": 1577794777, "post_id": 59543798, "comment_id": 105256944, "body": "Hi, Hans Passant,  It worked! Thank you for your suggestion!"}], "answers": [{"tags": [], "owner": {"reputation": 8787, "user_id": 6601582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd0a2f69702729da5aaa628bc58811a7?s=128&d=identicon&r=PG&f=1", "display_name": "Rita Han", "link": "https://stackoverflow.com/users/6601582/rita-han"}, "is_accepted": false, "score": 0, "last_activity_date": 1577849711, "creation_date": 1577849711, "answer_id": 59549864, "question_id": 59543798, "link": "https://stackoverflow.com/questions/59543798/close-window-by-keyword/59549864#59549864", "title": "Close window by keyword", "body": "<p>As @GSerg and @Hans Passant pointed out, there are two issues:</p>\n\n<ol>\n<li>Pass <code>aStr</code> instead of <code>&amp;aStr</code> to <code>EnumWindows</code>.</li>\n</ol>\n\n<p><code>lParam</code> of <a href=\"https://docs.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-enumwindows\" rel=\"nofollow noreferrer\"><code>EnumWindows</code></a> is an application-defined value to be passed to the callback function. The callback function you defined expect <code>char*</code> instead of <code>char**</code>.</p>\n\n<ol start=\"2\">\n<li>When you call your application from command window your keyword will be included in your console window title like below picture shows. (\"project\" is the keyword here.) So your application window will also be closed since it contains the keyword. Exclude it using <code>GetConsoleWindow()</code>.</li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/6wNJI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6wNJI.png\" alt=\"enter image description here\"></a> </p>\n\n<pre><code>ownWnd = GetConsoleWindow();\n//...\nif ((p != NULL) &amp;&amp; (hwnd != ownWnd)) {\n    SendMessage(hwnd, WM_SYSCOMMAND, SC_CLOSE, 0);\n    printf(\"==== close a window by key [%s]: &lt;%s&gt;\\n\", key, strIte);\n}\n</code></pre>\n\n<blockquote>\n  <p>By the way, is there a way to make case-insensitive compare for\n  searching of keyword here?</p>\n</blockquote>\n\n<p>You can convert both keyword and window title to lowercase and then compare them.</p>\n\n<pre><code>char* aStr = argv[i];\n//To lowercase\nfor (int i = 0; aStr[i]; i++) {\n    aStr[i] = tolower(aStr[i]);\n}\nEnumWindows(WindowFoundCB, aStr);\n\n//...\n\n//To lowercase\nfor (int i = 0; strIte[i]; i++) {\n    strIte[i] = tolower(strIte[i]);\n}\n\nchar *p = strstr(strIte, key);\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 9968353, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-vyZkdglwb6A/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1mngI8cea0MCRF4YdKPJkl0sXhfw/mo/photo.jpg?sz=128", "display_name": "mendel", "link": "https://stackoverflow.com/users/9968353/mendel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 116, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1577849711, "creation_date": 1577793226, "last_edit_date": 1577794187, "question_id": 59543798, "link": "https://stackoverflow.com/questions/59543798/close-window-by-keyword", "title": "Close window by keyword", "body": "<p>I want to close all the windows that has any keywords assigned. Below is the C code:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#define WINVER 0x0600\n#define _WIN32_IE 0x0500\n#include &lt;windows.h&gt;\n#include &lt;stdint.h&gt;\n\nBOOL CALLBACK WindowFoundCB(HWND hwnd, char* param) {\n    char *key = (char*) param;\n    char strIte[256]; // This way, you have allocated 256 bytes for the Window name.\n    GetWindowText(hwnd, strIte, 256);\n    if (IsWindowVisible(hwnd)){\n        char *p = strstr(strIte,key);\n        if (p!= NULL){\n            SendMessage(hwnd, WM_SYSCOMMAND, SC_CLOSE, 0);\n            printf(\"==== close a window by key [%s]: &lt;%s&gt;\\n\",key,strIte);\n        }\n    }\n    return TRUE;\n}\n\nint main(int argc, char *argv[])\n{   int i;\n    for (i = 1; i &lt; argc; i++){\n        printf(\"...keep closing window 1Hz for: %s\\n\", argv[i]);\n    }\n    if (argc &gt; 1){\n        while (1){\n            for (i = 1; i &lt; argc; i++){\n                char* aStr = argv[i];\n                EnumWindows(WindowFoundCB,&amp;aStr);\n             }\n            Sleep(1000);\n        }\n    }\n    return 0;\n}\n</code></pre>\n\n<p>However, when I run it, it only prints the message:</p>\n\n<blockquote>\n  <p>...keep closing window 1Hz for : myKeyword</p>\n</blockquote>\n\n<p>Then there is no further reaction at all, even if I have a window named \"jjjj myKeyword--\".</p>\n\n<p>By the way, is there a way to make case-insensitive compare for searching of keyword here?\nThanks.</p>\n"}, {"tags": ["c++", "c", "winapi", "serial-port", "readfile"], "comments": [{"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1577793091, "post_id": 59543756, "comment_id": 105256383, "body": "Show a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Don&#39;t just dump all of your code."}, {"owner": {"reputation": 299, "user_id": 10731634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f5b15c49038da56b3d64b2c3b8d0429?s=128&d=identicon&r=PG&f=1", "display_name": "Code-Lover", "link": "https://stackoverflow.com/users/10731634/code-lover"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1577793804, "post_id": 59543756, "comment_id": 105256606, "body": "@IInspectable I removed the parts that dont relate to this problem but i think the parts that i didnt remove relate to problem and i cant figure out what is wrong. please dont downvote"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 2, "creation_date": 1577795062, "post_id": 59543756, "comment_id": 105257045, "body": "The brace at the end of <code>case WAIT_OBJECT_0:{</code> is mis-matched.  A consistent and conventional indentation and alignment style would make that obvious, and if you are going to ask others to review your code it is a good idea to make it as readable as possible in any case.  This is a mess."}, {"owner": {"reputation": 299, "user_id": 10731634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f5b15c49038da56b3d64b2c3b8d0429?s=128&d=identicon&r=PG&f=1", "display_name": "Code-Lover", "link": "https://stackoverflow.com/users/10731634/code-lover"}, "edited": false, "score": 0, "creation_date": 1577795172, "post_id": 59543756, "comment_id": 105257088, "body": "@ Clifford You are right im sorry thats because of frequent edits that i made. Im editing"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 2, "creation_date": 1577795302, "post_id": 59543756, "comment_id": 105257131, "body": "You <i>must</i> copy and paste exactly the code that is generating the error, not edit it in the question, otherwise how can we rely on the fact that it even exhibits the problem?"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1577795459, "post_id": 59543756, "comment_id": 105257181, "body": "Please indent your code properly. This does not just only help us to read and understand your code but also yourself to better see what you are doing, trust me. As it stands the code is not very readable."}, {"owner": {"reputation": 299, "user_id": 10731634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f5b15c49038da56b3d64b2c3b8d0429?s=128&d=identicon&r=PG&f=1", "display_name": "Code-Lover", "link": "https://stackoverflow.com/users/10731634/code-lover"}, "reply_to_user": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1577795476, "post_id": 59543756, "comment_id": 105257188, "body": "@Clifford By editing i mean removing the parts that are not necessary for this question"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 1, "creation_date": 1577795530, "post_id": 59543756, "comment_id": 105257207, "body": "The code from <code>&#47;&#47;Reading</code> onward is not inside a function body - if that is a separate  code fragment, you should separate it from <code>SuccessfulRead()</code> otherwise it is not valid as a single block of code."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 1, "creation_date": 1577795623, "post_id": 59543756, "comment_id": 105257246, "body": "Yes, it was wrong before that edit.  If you don&#39;t know what is wron, you are hardly qualified to determine what is irrelevant.  Besides it is still mismatched in you edit."}, {"owner": {"reputation": 299, "user_id": 10731634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f5b15c49038da56b3d64b2c3b8d0429?s=128&d=identicon&r=PG&f=1", "display_name": "Code-Lover", "link": "https://stackoverflow.com/users/10731634/code-lover"}, "edited": false, "score": 0, "creation_date": 1577795763, "post_id": 59543756, "comment_id": 105257286, "body": "@ Clifford  thanks for taking your time here. Im trying to indent it properly so that others can review it"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 2, "creation_date": 1577795909, "post_id": 59543756, "comment_id": 105257350, "body": "Format it in the <i>real</i> code, compile and run it to make sure it still exhibits the same problem, then post it - <i>do not</i> try to fix it in the question.  Any decent code editor will format it for you, but may be confused by your mixture of brace positioning style.  There is a good chance that in fixing the formatting you will discover your error."}, {"owner": {"reputation": 299, "user_id": 10731634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f5b15c49038da56b3d64b2c3b8d0429?s=128&d=identicon&r=PG&f=1", "display_name": "Code-Lover", "link": "https://stackoverflow.com/users/10731634/code-lover"}, "edited": false, "score": 0, "creation_date": 1577796190, "post_id": 59543756, "comment_id": 105257445, "body": "@ Clifford it is compiled and worked for me the problem is that it does not work in client&#39;s device. Thats why i posted the question here"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 1, "creation_date": 1577796591, "post_id": 59543756, "comment_id": 105257569, "body": "You miss my point; <i>you</i> may have code that compiles, but that is not the code you have posted.  You have to post the code that is failing, not something just <i>similar</i> (and invalid).  Have you ever considered stepping the code in a debugger - the error will be come rather obvious I think."}, {"owner": {"reputation": 1964, "user_id": 8666197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67e412c92534ae5c8ae3b0e9cb7b7360?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel S\u0119k", "link": "https://stackoverflow.com/users/8666197/daniel-s%c4%99k"}, "edited": false, "score": 1, "creation_date": 1577863860, "post_id": 59543756, "comment_id": 105270228, "body": "<i>&quot;When reading from a communications device, the behavior of ReadFile is determined by the current communication time-out as set and retrieved by using the SetCommTimeouts and GetCommTimeouts functions. Unpredictable results can occur if you fail to set the time-out values. For more information about communication time-outs, see COMMTIMEOUTS.&quot;</i> <a href=\"https://docs.microsoft.com/en-us/windows/win32/api/fileapi/nf-fileapi-readfile\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/windows/win32/api/fileapi/n&zwnj;&#8203;f-fileapi-readfile</a>"}, {"owner": {"reputation": 299, "user_id": 10731634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f5b15c49038da56b3d64b2c3b8d0429?s=128&d=identicon&r=PG&f=1", "display_name": "Code-Lover", "link": "https://stackoverflow.com/users/10731634/code-lover"}, "reply_to_user": {"reputation": 1964, "user_id": 8666197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67e412c92534ae5c8ae3b0e9cb7b7360?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel S\u0119k", "link": "https://stackoverflow.com/users/8666197/daniel-s%c4%99k"}, "edited": false, "score": 0, "creation_date": 1577903334, "post_id": 59543756, "comment_id": 105278631, "body": "@Daniel S\u0119k Thanks . Ive set the values for time-out to 3 seconds. Can it be possible to be incompatible with the device? How can i find the values to meet the device&#39;s requirements?"}], "answers": [{"tags": [], "owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "is_accepted": false, "score": 1, "last_activity_date": 1577796363, "creation_date": 1577796363, "answer_id": 59544328, "question_id": 59543756, "link": "https://stackoverflow.com/questions/59543756/readfile-reads-less-bytes-than-the-specified-value-in-its-argument/59544328#59544328", "title": "ReadFile() reads less bytes than the specified value in its argument", "body": "<p>Here:</p>\n\n<pre><code>        int res=SuccessfulRead(lpBuf,dwRead);\n        if(!res){//less than two bytes read that is one byte readed\n</code></pre>\n\n<p>the comment suggests that you are expecting >= two bytes, but <code>SuccessfulRead()</code> only returns non-zero when <em>exactly</em> two bytes are read:</p>\n\n<pre><code>if( bytesRead == 2 ){ // EXACTLY two bytes!!!\n    //...\n    return 1;\n}\n</code></pre>\n\n<p>You need:</p>\n\n<pre><code>if( bytesRead &lt;= 2 ){ // AT LEAST two bytes\n...\n</code></pre>\n\n<p>for the comment to be correct.</p>\n"}], "owner": {"reputation": 299, "user_id": 10731634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f5b15c49038da56b3d64b2c3b8d0429?s=128&d=identicon&r=PG&f=1", "display_name": "Code-Lover", "link": "https://stackoverflow.com/users/10731634/code-lover"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "closed_date": 1577810740, "answer_count": 1, "score": -1, "last_activity_date": 1577812048, "creation_date": 1577792960, "last_edit_date": 1577812048, "question_id": 59543756, "link": "https://stackoverflow.com/questions/59543756/readfile-reads-less-bytes-than-the-specified-value-in-its-argument", "closed_reason": "Not suitable for this site", "title": "ReadFile() reads less bytes than the specified value in its argument", "body": "<p>I have this code for reading bytes from serial port , but with client's device the message <code>\"No enough information\"</code>\nis displayed and he says there is enough information in the serial port but this message \nis displayed. </p>\n\n<pre><code>int SuccessfulRead(unsigned char * s , DWORD bytesRead){\n\n    if( bytesRead == 2 ){\n        //...\n        return 1;\n    }\n\n    return 0;\n}\n\n//Reading\n\nint i=1 , breakWhile=0 ;\nwhile(!breakWhile)\n{\nDWORD dwRead;\nBOOL fWaitingOnRead = FALSE; //overlapped\nOVERLAPPED osReader = {0};\nunsigned char lpBuf[2];\n\nosReader.hEvent = CreateEvent(NULL, TRUE, FALSE, NULL);\nif (osReader.hEvent == NULL){\nMessageBox( NULL , L\"Unable to create event\" , L\"Error\" , MB_OK);\nbreakWhile=1;\n}\nif (!fWaitingOnRead) {\n   // Issue read operation.\n   if (!ReadFile(hPort2, lpBuf, 2, &amp;dwRead,&amp;osReader)) {\n       if (GetLastError() != ERROR_IO_PENDING){     \n           MessageBox(NULL , L\"Error in communication\" , L\"ERROR\" , MB_OK);\n           break;\n       }\n       else\n           fWaitingOnRead = TRUE;\n   }\n   else {\n       // read completed immediately\n       int res=SuccessfulRead(lpBuf,dwRead);\n       if( !res){\n           MessageBox(NULL , L\"No enough information\" , L\"\" , MB_OK);\n           break;\n       }\n   }\n}\n\n\n\n#define READ_TIMEOUT   2000      // milliseconds\nDWORD dwRes=0;\nif (fWaitingOnRead) {\ndwRes = WaitForSingleObject(osReader.hEvent,READ_TIMEOUT);\nswitch(dwRes)\n{\n    // Read completed.\n    case WAIT_OBJECT_0:{\n        if (!GetOverlappedResult(hPort2, &amp;osReader, &amp;dwRead,FALSE))\n            MessageBox(NULL , L\"Error in GetOverlappedResult\" , L\"Error\" , MB_OK);\n\n        else{\n            // Read completed successfully.\n            int res=SuccessfulRead(lpBuf,dwRead);\n            if(!res){//less than two bytes read that is one byte readed\n            MessageBox(NULL , L\"No enough information\" , L\"\" , MB_OK);\n            breakWhile=1;//exit loop\n            }\n        //Reset flag so that another opertion can be issued.\n        fWaitingOnRead = FALSE;\n                     }\n        break;\n    case WAIT_TIMEOUT:\n        if( i==1){//failed in first try\n            MessageBox(NULL , L\"There is no data please try again\", L\"\" , MB_OK);\n        }\n\n\n        breakWhile=1;//exit loop\n\n        break;\n                       }\n}\n                  }\nCloseHandle(osReader.hEvent);\ni++;\n}\n</code></pre>\n\n<p>It must read 2 bytes every time because of <code>ReadFile(hPort2, lpBuf, 2, &amp;dwRead,&amp;osReader)</code> , but it reads 1 byte in first time so it means there is not more than 1 byte in the serial port.\nBut seems like <code>code vision</code> reads that bytes and why this program only reads 1 byte when there is more than 2 bytes ? when in <code>ReadFile()</code> the bytes to read is 2.</p>\n\n<p>Why does not it work and how to make it work? </p>\n\n<p>Can it be related to <code>timeout</code> value?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c", "average"], "comments": [{"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1577788396, "post_id": 59542837, "comment_id": 105254752, "body": "Please format your code properly, and please give us an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 2153, "user_id": 7003331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kBN0r.jpg?s=128&g=1", "display_name": "Deepak Patankar", "link": "https://stackoverflow.com/users/7003331/deepak-patankar"}, "edited": false, "score": 0, "creation_date": 1577788536, "post_id": 59542837, "comment_id": 105254817, "body": "What does AA, BA... mean ? How much score we will get for BA ? How to calculate it ?"}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 1, "creation_date": 1577788571, "post_id": 59542837, "comment_id": 105254830, "body": "If <code>n</code> is an array of char, then you want <code>scanf(&quot;%s&quot;, n)</code>.  You could explicitly write <code>&amp;n[0]</code>, but it is more idiomatic to just write <code>n</code>.  It is wrong to write <code>&amp;n</code>"}, {"owner": {"reputation": 655, "user_id": 3616601, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d9dbe1da7416f8fa9b0cf1d0974269e7?s=128&d=identicon&r=PG&f=1", "display_name": "Phantom", "link": "https://stackoverflow.com/users/3616601/phantom"}, "reply_to_user": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1577788696, "post_id": 59542837, "comment_id": 105254883, "body": "@WilliamPursell and more, <code>n</code> is an <code>int</code> array, and <code>scanf(&quot;%s&quot;, n)</code> is to read a string (into an <code>int</code>array)"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1577789447, "post_id": 59542837, "comment_id": 105255164, "body": "What is &quot;the 4(AA)* credit of lecture&quot;? Is <code>credit</code> meant to be a `weight factor?"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 3522, "user_id": 4964791, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aVT1l.jpg?s=128&g=1", "display_name": "RamblinRose", "link": "https://stackoverflow.com/users/4964791/ramblinrose"}, "edited": false, "score": 2, "creation_date": 1577790217, "post_id": 59542837, "comment_id": 105255445, "body": "@RamblinRose : Not <code>gets()</code> - deprecated and dangerous; use <code>fgets()</code>."}, {"owner": {"reputation": 3522, "user_id": 4964791, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aVT1l.jpg?s=128&g=1", "display_name": "RamblinRose", "link": "https://stackoverflow.com/users/4964791/ramblinrose"}, "reply_to_user": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1577791464, "post_id": 59542837, "comment_id": 105255851, "body": "@Clifford argh! Indeed."}, {"owner": {"reputation": 284, "user_id": 12571460, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCfdmLEtpNndCH3GzEC7Pps5wv1KvzZiwCtjEHs=k-s128", "display_name": "Lxer Lx", "link": "https://stackoverflow.com/users/12571460/lxer-lx"}, "reply_to_user": {"reputation": 3522, "user_id": 4964791, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aVT1l.jpg?s=128&g=1", "display_name": "RamblinRose", "link": "https://stackoverflow.com/users/4964791/ramblinrose"}, "edited": false, "score": 0, "creation_date": 1577791522, "post_id": 59542837, "comment_id": 105255864, "body": "@RamblinRose Never suggest <code>gets()</code>. It cannot be used safely."}, {"owner": {"reputation": 284, "user_id": 12571460, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCfdmLEtpNndCH3GzEC7Pps5wv1KvzZiwCtjEHs=k-s128", "display_name": "Lxer Lx", "link": "https://stackoverflow.com/users/12571460/lxer-lx"}, "edited": false, "score": 0, "creation_date": 1577792767, "post_id": 59542837, "comment_id": 105256285, "body": "<code>%s</code> expects a pointer to the initial element of a character array in <code>scanf(&quot;%s&quot;,&amp;n);</code>. But <code>n</code> in the code is defined as <code>int n[5]</code>, that is, an array of <code>int</code>. That does not match."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1577795820, "post_id": 59542837, "comment_id": 105257309, "body": "Gain system needs further explanation. AA is 4, BA is 3.5 but what is AB? What follows BA?"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1577795851, "post_id": 59542837, "comment_id": 105257326, "body": "Never ever do <code>scanf(%s ...)</code> Like in <b>never</b>"}, {"owner": {"reputation": 23, "user_id": 12631610, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCX99at87Z1nf4PcsfoAXpQpKW63ISmaa86L1j-=k-s128", "display_name": "Abdullah Kaya", "link": "https://stackoverflow.com/users/12631610/abdullah-kaya"}, "edited": false, "score": 0, "creation_date": 1577796454, "post_id": 59542837, "comment_id": 105257523, "body": "Letter grade system is AA= 4 BA=3.5 BB=3 CB=2.5 CC=2 DC=1.5 DD=1 FF=0"}, {"owner": {"reputation": 23, "user_id": 12631610, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCX99at87Z1nf4PcsfoAXpQpKW63ISmaa86L1j-=k-s128", "display_name": "Abdullah Kaya", "link": "https://stackoverflow.com/users/12631610/abdullah-kaya"}, "edited": false, "score": 0, "creation_date": 1577796623, "post_id": 59542837, "comment_id": 105257582, "body": "I couldnt understand how to format can anybody tell me clearly?"}, {"owner": {"reputation": 284, "user_id": 12571460, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCfdmLEtpNndCH3GzEC7Pps5wv1KvzZiwCtjEHs=k-s128", "display_name": "Lxer Lx", "link": "https://stackoverflow.com/users/12571460/lxer-lx"}, "edited": false, "score": 0, "creation_date": 1577799474, "post_id": 59542837, "comment_id": 105258560, "body": "Enable all compiler warnings, compile and correct inaccuracies in the code  looking at compiler messages. It is impossible to understand from the code what your are trying to do."}], "answers": [{"tags": [], "owner": {"reputation": 6053, "user_id": 11336762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hGPr6.jpg?s=128&g=1", "display_name": "Roberto Caboni", "link": "https://stackoverflow.com/users/11336762/roberto-caboni"}, "is_accepted": true, "score": 1, "last_activity_date": 1577809167, "creation_date": 1577809167, "answer_id": 59546405, "question_id": 59542837, "link": "https://stackoverflow.com/questions/59542837/how-can-i-calculate-university-grade-average-in-case-of-literal-grades/59546405#59546405", "title": "How can I calculate University grade average in case of literal grades?", "body": "<p>Your problem is to translate literal grades to numeric values-</p>\n\n<p>There are different ways to achieve your goal: I choose a solution that performs direct comparison of input grades with the set of allowed ones. This can be done in an elegant way by defining a <strong>look-up table</strong>.</p>\n\n<p>The proposed solution will <strong>not</strong> contain:</p>\n\n<ul>\n<li>The input retrieval from the user. This is up to you, especially because if you correctly define the <em>engine</em>, the user interface is a detail that can be implemented in different ways (not only with a loop of <code>scanf</code>s but also, for example, processing an input text file).</li>\n<li>A case insensitive management. Only capital letters grades (eg. \"BA\") will be admitted. You will easily be able to accept lower characters grades with minor changes.</li>\n<li>The management of extra lecture info such as lecture name.</li>\n</ul>\n\n<p><strong>The example code</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\ntypedef struct\n{\n  char  literal[3];\n  float numeric;\n} GradeInfo_t; \n\ntypedef struct\n{\n  /* Add all the extra info relevant to you: lecture name etcetera */\n  unsigned int credits;\n  char         grade[3];\n} LectureInfo_t;\n</code></pre>\n\n<p>As you can see, if you want to write efficient code, some structures can be defined in order to put together relevant data. In this way you will be able (later) to define and array of structs that will make possible to you to loop through them.</p>\n\n<p>The first structure will make possible the association between the single grade and its numerical value. The second one contains input lectures info.</p>\n\n<pre><code>/* Look-Up table to translate litaral grades into numeric values */\nstatic const GradeInfo_t gradeLUT[] =\n{\n  { \"AA\", 4.0 },\n  { \"BA\", 3.5 },\n  { \"BB\", 3.0 },\n  { \"CB\", 2.5 },\n  { \"CC\", 2.0 },\n  { \"DC\", 1.5 },\n  { \"DD\", 1.0 },\n  { \"FF\", 0.0 }\n};\n\nstatic const LectureInfo_t lecturesTestArray[] =\n{\n  { 4, \"BB\" }, \n  { 3, \"AA\" }, \n  { 4, \"CC\" }, \n  { 5, \"BA\" }, \n  { 3, \"BB\" }, \n  { 4, \"DD\" },\n  { 4, \"QQ\" }, /* Unexpected literal. Will the program skip it? */\n  { 3, \"DC\" }, \n  { 6, \"AA\" }, \n  { 5, \"BA\" }, \n  { 4, \"CB\" }, \n  { 2, \"FF\" }, \n};\n\n</code></pre>\n\n<p>Here I use the previosly defined structs in order to define two arrays:</p>\n\n<ol>\n<li>a <strong>look-up table</strong> with all the grades string literals and their corresponding numerical values</li>\n<li>a test set of lectures with their <em>credits-grades couples</em>. In inserted also a wrong grade. I want the program to discard it. The expected average grade is <strong>2,75581395348837</strong>.</li>\n</ol>\n\n<pre><code>\n\nint main(void)\n{\n  /* Here you get grades and lecture info from the user. I define them        *\n   * globally using a test array.                                             */\n  int totalCredits = 0, i, j;\n  int testElems=(sizeof(lecturesTestArray)/sizeof(LectureInfo_t));\n  int totalGradeValues=(sizeof(gradeLUT)/sizeof(GradeInfo_t));;\n  float gainsSum = 0, average;\n\n  /* For every element of the test lecture array */\n  for( i=0; i&lt;testElems; i++)\n  {\n    /* Until a matching grade is found */\n    for( j=0; j&lt;totalGradeValues; j++)\n    {\n      /* Compare current lecture grade with current gradeInfo */\n      if(strcmp(lecturesTestArray[i].grade, gradeLUT[j].literal) == 0 )\n      {\n        /* that's it! Process its data */\n        totalCredits += lecturesTestArray[i].credits;\n        gainsSum += lecturesTestArray[i].credits * gradeLUT[j].numeric;\n        break;\n      }\n    }\n\n    /* Just for fun: let's check that the \"wrong\" grade has been skipped */\n    if( j == totalGradeValues )\n    {\n      printf(\"Grade %s (index %d) is wrong and has not been processed!\\n\", lecturesTestArray[i].grade, i);\n    }\n  }\n\n  /* Test array consumed! Lets calculate average and print it */\n  average = gainsSum / totalCredits;\n\n  printf(\"Average grade is %0.2f\", average);\n\n  return 0;\n}\n</code></pre>\n\n<p>The main. I just loop through the test values finding the grade related to them and updating the calculation. I skip the <em>wrong</em> input value. I finally calculate the average value printing it (with just two decimals, like in your example).</p>\n\n<p><strong>This is the output:</strong></p>\n\n<pre><code>Grade QQ (index 6) is wrong and has not been processed!\nAverage grade is 2.76\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 12631610, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCX99at87Z1nf4PcsfoAXpQpKW63ISmaa86L1j-=k-s128", "display_name": "Abdullah Kaya", "link": "https://stackoverflow.com/users/12631610/abdullah-kaya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "accepted_answer_id": 59546405, "answer_count": 1, "score": 2, "last_activity_date": 1577809167, "creation_date": 1577788033, "last_edit_date": 1577806906, "question_id": 59542837, "link": "https://stackoverflow.com/questions/59542837/how-can-i-calculate-university-grade-average-in-case-of-literal-grades", "title": "How can I calculate University grade average in case of literal grades?", "body": "<p>I am trying to write a C program that gets data from the user and calculates his/her average.</p>\n\n<p>It simply gets the credit of lecture and letter grade of lecture. Litelal grade system is given below:</p>\n\n<ul>\n<li>AA=4</li>\n<li>BA=3.5</li>\n<li>BB=3</li>\n<li>CB=2.5</li>\n<li>CC=2</li>\n<li>DC=1.5</li>\n<li>DD= 1</li>\n<li>FF=0</li>\n</ul>\n\n<p>Gain can be found by multiplying corresponding value of letter grade (eg. AA=4) and Credit number of lesson. For example, if grade is <em>\"AA\"</em>, the <em>gain</em> contribution of that lecture to the average value will be <code>4*credit_of_lecture</code>. </p>\n\n<p>The weight grade average is calculated by <code>total_gain/total_credit_number</code>.</p>\n\n<p>For each lecture</p>\n\n<ol>\n<li>Gain is calculated. </li>\n<li>Gains are added to each other.</li>\n<li>Average is calculated.</li>\n</ol>\n\n<p><strong>Another example</strong></p>\n\n<p>If my current weigth grade average is 3.00 with 47 credits, then this means I have 141 gain points so far. This semester I take 2 courses letter grade of one of them is AA  with 3 credits and the other is BB with 3 credits. For this semestr my gain will be 21 (4*3 + 3*3). 21 is added to former gain (141). Total gain is now 162. total credit is 47+3+3= 53. New weitgh grade average is 162/53= 3.05</p>\n\n<p><strong>My code</strong></p>\n\n<p>The thing I couldn't do is that when user enters <code>AA</code> or <code>BA</code> how to use condition state to set gain? If user enters <code>aa</code> with 3 credits then the gain will be 12 and if user enters <code>ba</code> with 2 credits gain will be 7</p>\n\n<p>To simplfy, (e.g) I obtained 47 credits so far and my grade average is 2.66. </p>\n\n<p>This semester I take 6 courses</p>\n\n<ul>\n<li>course a is 4 credit aa, </li>\n<li>course b is 3 credit ba,  </li>\n<li>course c is 3 credit dd etc. </li>\n</ul>\n\n<p>What will be the my final grade average?</p>\n\n<pre><code>int main(){\n    int sayi,i,j /*credit number of the lectur*/;\n    int kredi /*obtained credit*/, abd, gain;\n    float gurtalama; //current grade average\n\n    int x[2],n[5];// x will be letter grade n will be name of the lecture.\n\n    printf(\"number of obtained credits: \"); //gets the number of obtained credits\n    scanf(\"%d\",&amp;kredi);\n\n    printf(\"current grade average : \"); // current weight grade average\n    scanf(\"%f\",&amp;gurtalama);\n\n    printf(\"how many lectures you take this semestr? : \"); // number of lectures are get to decide how many times the for loop will work\n    scanf(\"%d\",&amp;sayi);\n\n    for(i=0;i&lt;sayi;i++) {\n        printf(\"Name of the lecture: \"); // this is for not to confuse it may not be necessary\n        scanf(\"%s\",&amp;n);\n\n        printf(\"Credit number of lecture: \"); //for each lecture, lecture credit\n        scanf(\"%d\",&amp;j);\n\n        printf(\"Letter grade of lecture: \"); // letter grade to convert it into 4 based system\n        scanf(\"%s\",&amp;x);\n\n        printf(\"%s \",n);            //Name of the lecture\n        printf(\"%d Kredi. \",j);     //Credit of lecture\n        printf(\"%s \\n\",x);          //letter grade of lecture\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "pointers", "recursion", "linked-list", "free"], "comments": [{"owner": {"reputation": 655, "user_id": 3616601, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d9dbe1da7416f8fa9b0cf1d0974269e7?s=128&d=identicon&r=PG&f=1", "display_name": "Phantom", "link": "https://stackoverflow.com/users/3616601/phantom"}, "edited": false, "score": 0, "creation_date": 1577789146, "post_id": 59542778, "comment_id": 105255043, "body": "In your <code>free_node</code> function I can see 3 <code>free()</code> calls. Do you know which one is causing the segfault? You should try to use some debuger to find out the problem (gdb, valgrind for example)"}, {"owner": {"reputation": 67, "user_id": 12426385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2274023a0f14c94f5ba0f2dda9c91b34?s=128&d=identicon&r=PG&f=1", "display_name": "Grey_dev1997", "link": "https://stackoverflow.com/users/12426385/grey-dev1997"}, "reply_to_user": {"reputation": 655, "user_id": 3616601, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d9dbe1da7416f8fa9b0cf1d0974269e7?s=128&d=identicon&r=PG&f=1", "display_name": "Phantom", "link": "https://stackoverflow.com/users/3616601/phantom"}, "edited": false, "score": 0, "creation_date": 1577792385, "post_id": 59542778, "comment_id": 105256165, "body": "@Phantom Your advice was correct and I narrowed down the problem further: the segfault occurs in <code>free_node</code> at the <code>free(node);</code> call."}, {"owner": {"reputation": 1599, "user_id": 9948091, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JANyt.png?s=128&g=1", "display_name": "HAL9000", "link": "https://stackoverflow.com/users/9948091/hal9000"}, "edited": false, "score": 0, "creation_date": 1577792686, "post_id": 59542778, "comment_id": 105256254, "body": "This error should have been caught by reading compiler warnings."}, {"owner": {"reputation": 67, "user_id": 12426385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2274023a0f14c94f5ba0f2dda9c91b34?s=128&d=identicon&r=PG&f=1", "display_name": "Grey_dev1997", "link": "https://stackoverflow.com/users/12426385/grey-dev1997"}, "reply_to_user": {"reputation": 655, "user_id": 3616601, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d9dbe1da7416f8fa9b0cf1d0974269e7?s=128&d=identicon&r=PG&f=1", "display_name": "Phantom", "link": "https://stackoverflow.com/users/3616601/phantom"}, "edited": false, "score": 0, "creation_date": 1577792761, "post_id": 59542778, "comment_id": 105256284, "body": "@Phantom Your advice was correct and I narrowed down the problem further: the segfault occurs in <code>free_node</code> at the <code>if( node-&gt;next == NULL) {free(node-&gt;value);}</code> call.  The programm succesfully frees the  <code>usage_test</code>, however when the second node <code>usage_test2</code> is send in, it free all nodes but when it exits the recursion it triggers a segfault at <code>if( node-&gt;next == NULL) {free(node-&gt;value);}</code> call."}, {"owner": {"reputation": 2429, "user_id": 1098603, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/sb0id.png?s=128&g=1", "display_name": "Matthieu", "link": "https://stackoverflow.com/users/1098603/matthieu"}, "edited": false, "score": 0, "creation_date": 1577792807, "post_id": 59542778, "comment_id": 105256301, "body": "You can use <a href=\"https://linux.die.net/man/3/strdup\" rel=\"nofollow noreferrer\"><code>strdup()</code></a> to allocate a copy of a string."}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 12426385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2274023a0f14c94f5ba0f2dda9c91b34?s=128&d=identicon&r=PG&f=1", "display_name": "Grey_dev1997", "link": "https://stackoverflow.com/users/12426385/grey-dev1997"}, "edited": false, "score": 0, "creation_date": 1577793009, "post_id": 59543607, "comment_id": 105256352, "body": "Thanks allot! This solved my problem in fact! @dragosht"}], "tags": [], "owner": {"reputation": 3177, "user_id": 1221236, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/230d4a82674b9e02c0b95e4ecf7468ae?s=128&d=identicon&r=PG", "display_name": "dragosht", "link": "https://stackoverflow.com/users/1221236/dragosht"}, "is_accepted": true, "score": 3, "last_activity_date": 1577792784, "last_edit_date": 1577792784, "creation_date": 1577792150, "answer_id": 59543607, "question_id": 59542778, "link": "https://stackoverflow.com/questions/59542778/destructor-function-doesnt-work-as-intended-and-i-get-a-segmentation-fault-c/59543607#59543607", "title": "Destructor function doesnt work as intended and I get a segmentation fault (C)", "body": "<p>This code here:</p>\n\n<pre><code>Lnode* new_long_node = new_lnode(usage_test, usage_test2);\nfree_lnode(new_long_node);\n</code></pre>\n\n<p>is wrong and it's pretty simple to figure it out as it issues a quite-obvious warning:</p>\n\n<pre><code>test.c: In function \u2018main\u2019:\ntest.c:105:3: warning: passing argument 2 of \u2018new_lnode\u2019 from incompatible pointer type [enabled by default]\ntest.c:25:8: note: expected \u2018struct Lnode *\u2019 but argument is of type \u2018struct WishList *\u2019\n</code></pre>\n\n<p>So you're linking your nodes wrong. Just inferring from your API, I think you want to do something like this instead:</p>\n\n<pre><code>Lnode* new_long_node1 = new_lnode(usage_test, NULL);\nLnode* new_long_node2 = new_lnode(usage_test2, new_long_node1);\nfree_lnode(new_long_node2);\n</code></pre>\n\n<p>Oh, and that <code>s_copy</code> function of yours is in fact a <code>strdup</code> not <code>strcopy</code>.</p>\n"}], "owner": {"reputation": 67, "user_id": 12426385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2274023a0f14c94f5ba0f2dda9c91b34?s=128&d=identicon&r=PG&f=1", "display_name": "Grey_dev1997", "link": "https://stackoverflow.com/users/12426385/grey-dev1997"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 59543607, "answer_count": 1, "score": 1, "last_activity_date": 1577792784, "creation_date": 1577787732, "last_edit_date": 1577792593, "question_id": 59542778, "link": "https://stackoverflow.com/questions/59542778/destructor-function-doesnt-work-as-intended-and-i-get-a-segmentation-fault-c", "title": "Destructor function doesnt work as intended and I get a segmentation fault (C)", "body": "<p>I am currently working on some homework and I need some help.</p>\n\n<p>The function <code>free_lnode</code> triggers a <code>Segmentation fault(core dumped)</code> once called. Before the core gets dumped I receieve the message that I am trying to free an unknown pointer.</p>\n\n<p>I have narrowed down the problem and commented it in my code below, however I am unaware how to fix the error in the <code>free_lnode</code> function.</p>\n\n<p>The implementation of the  functions <code>free_lnode</code> and <code>free_node</code> need to be done via recursion!!!</p>\n\n<p><strong>Note:</strong> <em>My code uses 2 function from the professors lib:</em></p>\n\n<ul>\n<li><code>xcalloc</code> works the same way as <code>calloc</code> with the addition that it checks for NULL by itself*</li>\n<li><p><code>s_copy</code> works like <code>strcpy</code>, however the copy is dynamically allocated</p>\n\n<p><em>These function are not the cause for the errors and are handled in the destructor functions.</em></p></li>\n</ul>\n\n<p>Thanks in advance and a happy new year!</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n\ntypedef struct Node {\n    char* value;\n    int count;\n    struct Node *next;\n} Node;\n\ntypedef struct WishList {\n    Node *first;\n    char *name;\n} WishList;\n\ntypedef struct Lnode{\n    WishList* value;\n    struct Lnode* next;\n} Lnode;\n\n/********* Constructor functions ********/\n\n\nLnode* new_lnode(WishList* value, Lnode* next){\n    Lnode* lnode = xcalloc(1, sizeof(Lnode)); //same as calloc only checks for NULL itself\n    lnode-&gt;value = value;\n    lnode-&gt;next = next;\n    return lnode;\n}\n\n\nWishList* new_wish_list(char* name, Node* node) {\n    WishList* list = xcalloc(1, sizeof(WishList)); //same as calloc only checks for NULL itself\n    list-&gt;name = s_copy(name); // s_copy performs dynamic allocation\n    list-&gt;first = node;\n    return list;\n}\n\nNode* new_node(char* value, int count, Node* next) {\n    Node* node = xcalloc(1, sizeof(Node)); //same as calloc only checks for NULL itself\n    node-&gt;value = s_copy(value); // s_copy performs dynamic allocation\n    node-&gt;count = count;\n    node-&gt;next = next;\n    return node;\n}\n\n/********* Destructor functions ********/\n\n// Recursive destructor function ==&gt; Works\nvoid free_node(Node* node){\n    if(node-&gt;next){\n      free(node-&gt;value);\n      free_node(node-&gt;next);\n    }\n\n    if(node-&gt;next == NULL){\n      free(node-&gt;value);\n    }\n    free(node);\n}\n\n// destructor function ==&gt; Works\nvoid free_wish_list(WishList* list){\n    free_node(list-&gt;first);\n    free(list-&gt;name);\n    free(list);\n}\n\n// Recursive destructor function =&gt; TODO: DEBUG\nvoid free_lnode(Lnode* lnode){\n    if(lnode-&gt;next){\n      printf(\"DEBUG\\n\"); // is triggered twice before segmentation is dumped\n      free_wish_list(lnode-&gt;value); //fails to free second wishlist, Console output: trying to free an unknown pointer &lt;some memory location&gt;, segmentation fault (core dumped)\n      printf(\"DEBUG\\n\"); // is only triggered once before segmentation dumped\n      free_lnode(lnode-&gt;next);\n    }\n    if(lnode-&gt;next == NULL){\n      free_wish_list(lnode-&gt;value);\n    }\n    free(lnode);\n}\n/************************************/\n\n\nint main(){\n\n  Node* a = NULL;\n  a = new_node(\"test1\", 1, NULL);\n  Node* b = new_node(\"test2\", 1, a);\n  Node* c = new_node(\"test3\", 1, b);\n  Node* d = new_node(\"test4\", 1, c);\n  Node* e = new_node(\"test5\", 1, d);\n\n  WishList* usage_test = new_wish_list(\"Epic_Test\", e);\n\n  Node* f = NULL;\n  f = new_node(\"test6\", 1, NULL);\n  Node* g = new_node(\"test7\", 1, f);\n  Node* h = new_node(\"test8\", 1, g);\n  Node* k = new_node(\"test9\", 1, h);\n\n  WishList* usage_test2 = new_wish_list(\"Epic_Test2\", k);\n\n  Lnode* new_long_node = new_lnode(usage_test, usage_test2);\n  free_lnode(new_long_node);\n\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linker-errors", "undefined-reference", "openwrt", "uci"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1577786867, "post_id": 59542536, "comment_id": 105254176, "body": "The linker could not find the symbol <code>uci_alloc_context</code> A source file or library are missing in the link phase."}, {"owner": {"reputation": 7, "user_id": 11464477, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lwOMO5L97HY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reDEOMbuRgS1CB33sKRJE-SGzurSQ/mo/photo.jpg?sz=128", "display_name": "Sheik", "link": "https://stackoverflow.com/users/11464477/sheik"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1577791954, "post_id": 59542536, "comment_id": 105256007, "body": "@Paul Ogilvie Yes I am missing libuci but how to link it. I used -luci for that reason but thats not correct."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1577794973, "post_id": 59542536, "comment_id": 105257021, "body": "Please show to whole command you use to compile and link."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1577794990, "post_id": 59542536, "comment_id": 105257026, "body": "Perhaps this answer <a href=\"https://stackoverflow.com/a/59503982/694576\">stackoverflow.com/a/59503982/694576</a> helps you."}], "owner": {"reputation": 7, "user_id": 11464477, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lwOMO5L97HY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reDEOMbuRgS1CB33sKRJE-SGzurSQ/mo/photo.jpg?sz=128", "display_name": "Sheik", "link": "https://stackoverflow.com/users/11464477/sheik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 323, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1577795009, "creation_date": 1577786548, "last_edit_date": 1577795009, "question_id": 59542536, "link": "https://stackoverflow.com/questions/59542536/uci-api-c-text0x1c-undefined-reference-to-uci-alloc-context", "title": "uci_api.c:(.text+0x1c): undefined reference to `uci_alloc_context&#39;", "body": "<p>Getting this error:</p>\n\n<pre><code>uci_api.c:(.text+0x1c): undefined reference to `uci_alloc_context'\n</code></pre>\n\n<p>while compiling a C file which includes <code>uci</code> API like <code>uci_set uci_alloc_context</code>, <code>uci_load</code> even though I compile with <code>-luci</code>. Is there any dependent packages?</p>\n"}, {"tags": ["c", "linked-list"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1577855215, "post_id": 59542465, "comment_id": 105269174, "body": "regarding: <code>#define NULL 0</code>   This is not a valid definition of NULL.   A valid definition would be <code>#define NULL void *0</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1577855522, "post_id": 59542465, "comment_id": 105269199, "body": "the posted code does not compile!   it is missing the prototype for <code>printf()</code> and <code>fopen()</code> and <code>scanf()</code> and <code>fscanf()</code>  and NULL   and <code>FILE</code>  and <code>fclose()</code> all of this could have been corrected by including the header file: <code>stdio.h</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1577855936, "post_id": 59542465, "comment_id": 105269240, "body": "regarding the statement: <code>void main()</code>   There are only two valid signatures for <code>main()</code>   they are: <code>int main( void )</code> and <code>int main( int argc, char *argv[] )</code>   Notice they both have a return type of <code>int</code>, not <code>void</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1577856102, "post_id": 59542465, "comment_id": 105269260, "body": "the function name <code>read()</code> is a well known function.  It is a poor programming practice to try to replace the definitions of C library functions with a &#39;home grown&#39; function"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1577856230, "post_id": 59542465, "comment_id": 105269277, "body": "in the definition of the <code>struct student</code>, this field: <code>struct student *next</code>  is not valid because it is missing the required trailing semicolor <code>;</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1577856427, "post_id": 59542465, "comment_id": 105269301, "body": "regarding these statements/prototypes:  <code>void read(node *p);     void create(node *p);     int count(node *p);     void print(node *p);</code>   The scope of these prototypes is the function: <code>main()</code> they are not seen when working with the actual function signatures.  So the compiler will &#39;assume&#39; that the  parameter types are all &#39;int`"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1577856760, "post_id": 59542465, "comment_id": 105269352, "body": "regarding: <code>scanf(&quot;%s&quot;,filename);</code>  1) When using the &#39;input format specifiers&#39; <code>%s</code> and/or <code>%[...]</code> always include a max characters modifier that is 1 less than the length of the input buffer because these specifiers always append a NUL byte to the input.  This also avoids any possibility of a buffer overflow and the resulting undefined behavior.   2)  always check the returned value (not the parameter values) to assure the operation was successful.  Those functions always return the number of successful input conversions.  Suggest: <code>if( scanf(&quot;%29s&quot;,filename) != 1) { &#47;&#47;handle error }</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1577857060, "post_id": 59542465, "comment_id": 105269387, "body": "regarding: <code>if(fp == NULL)     {         return; &#47;&#47; file doesn&#39;t exist     }</code>  You should always inform the user of such a problem.  When the error is from a C library function, you should also display the text reason the system thinks the error occurred.  All this output should be to <code>stderr</code>.  The function: <code>perror()</code> is made for this purpose."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1577857304, "post_id": 59542465, "comment_id": 105269417, "body": "regarding: ``head=(node *)malloc(sizeof(node));`  1) in C, the returned type is <code>void*</code> which can be assigned to any pointer.  Casting just clutters the code.  Suggest removing that cast.  2)  always check (!=NULL) the returned value to assure the operation was successful.  If not successful, call: <code>perror( &quot;malloc failed&quot; );</code> followed by cleaning up and <code>exit( EXIT_FAILURE ):</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1577857774, "post_id": 59542465, "comment_id": 105269477, "body": "in function: <code>read()</code> the code fails to set the  <code>next</code> field in the just <code>malloc()</code>d struct  to NULL.  This is probably the root of your current problem"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1577861110, "post_id": 59542465, "comment_id": 105269849, "body": "You may take some inspiration from <a href=\"https://pastebin.com/5MPLU4wB\" rel=\"nofollow noreferrer\">Singly Linked List (node only, no wrapper)</a>"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 12524689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e20994a46597b1169383992e75d6bc80?s=128&d=identicon&r=PG&f=1", "display_name": "ThisIsHard", "link": "https://stackoverflow.com/users/12524689/thisishard"}, "edited": false, "score": 0, "creation_date": 1577789479, "post_id": 59542623, "comment_id": 105255184, "body": "Can you explain more by  I&#39;m not assigning my data to the node?"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 25, "user_id": 12524689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e20994a46597b1169383992e75d6bc80?s=128&d=identicon&r=PG&f=1", "display_name": "ThisIsHard", "link": "https://stackoverflow.com/users/12524689/thisishard"}, "edited": false, "score": 1, "creation_date": 1577789564, "post_id": 59542623, "comment_id": 105255223, "body": "You allocate a pointer <code>list-&gt;next</code> but never assign any value to any field of the allocated memory. I am not sure what might be unclear here..."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 25, "user_id": 12524689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e20994a46597b1169383992e75d6bc80?s=128&d=identicon&r=PG&f=1", "display_name": "ThisIsHard", "link": "https://stackoverflow.com/users/12524689/thisishard"}, "edited": false, "score": 0, "creation_date": 1577797067, "post_id": 59542623, "comment_id": 105257746, "body": "Or put it this way: where do you think, you use that new node?"}, {"owner": {"reputation": 25, "user_id": 12524689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e20994a46597b1169383992e75d6bc80?s=128&d=identicon&r=PG&f=1", "display_name": "ThisIsHard", "link": "https://stackoverflow.com/users/12524689/thisishard"}, "edited": false, "score": 0, "creation_date": 1577799515, "post_id": 59542623, "comment_id": 105258572, "body": "Sorry im really new at this. I assume you meant that I always read the file and assign it at the first node instead going to the next one ?"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 25, "user_id": 12524689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e20994a46597b1169383992e75d6bc80?s=128&d=identicon&r=PG&f=1", "display_name": "ThisIsHard", "link": "https://stackoverflow.com/users/12524689/thisishard"}, "edited": false, "score": 0, "creation_date": 1577799995, "post_id": 59542623, "comment_id": 105258717, "body": "Yes, correct. You do not switch to the new/next node."}, {"owner": {"reputation": 25, "user_id": 12524689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e20994a46597b1169383992e75d6bc80?s=128&d=identicon&r=PG&f=1", "display_name": "ThisIsHard", "link": "https://stackoverflow.com/users/12524689/thisishard"}, "edited": false, "score": 0, "creation_date": 1577805031, "post_id": 59542623, "comment_id": 105260335, "body": "This will sound very silly but how do i do that ? I though list-&gt;next=(node*)malloc(sizeof(node)); supposed to move the node to next one after making it ?"}], "tags": [], "owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "is_accepted": true, "score": 1, "last_activity_date": 1577806857, "last_edit_date": 1577806857, "creation_date": 1577787004, "answer_id": 59542623, "question_id": 59542465, "link": "https://stackoverflow.com/questions/59542465/why-is-my-print-function-only-read-the-last-element-and-garbage-then-stop-resp/59542623#59542623", "title": "Why is my &quot;print&quot; function only read the last element and garbage then stop responding?", "body": "<blockquote>\n  <p>It looks like it printed the last line and next line(which is garbage).I think the problem is in the read function?</p>\n</blockquote>\n\n<p>This is correct. </p>\n\n<p>And here is why:</p>\n\n<pre><code>    while(fscanf(fp, \"%s %d %f\", list-&gt;name, &amp;list-&gt;id, &amp;list-&gt;marks) == 3)\n    {\n        printf(\"%s \\t%d \\t%f\\n\", list-&gt;name,list-&gt;id,list-&gt;marks);//check\n        list-&gt;next=(node*)malloc(sizeof(node));//create next node\n    }\n</code></pre>\n\n<p>In this loop you always read all the data in the first element of your list.\nYou allocate some new node but you never assign anything to it. \nYou even do not terminate the list by assigning <code>NULL</code> to <code>list-&gt;next-&gt;next</code>.</p>\n\n<p>This causes various problems:</p>\n\n<ul>\n<li>You allocate memory for each iteration but only the last one is accessible via <code>list-&gt;next</code>. All other memory blocks are lost.</li>\n<li>You have an unterminated list which causes undefined behaviour when you try to iterate over all nodes during printing.</li>\n<li>You read all data into 1 location meaning you've lost all but the last line from your file.</li>\n</ul>\n\n<p>To fix this you need to change it like this:</p>\n\n<pre><code>    while(fscanf(fp, \"%s %d %f\", list-&gt;name, &amp;list-&gt;id, &amp;list-&gt;marks) == 3)\n    {\n        printf(\"%s \\t%d \\t%f\\n\", list-&gt;name,list-&gt;id,list-&gt;marks);//check\n        list-&gt;next=(node*)malloc(sizeof(node));//create next node\n        if (list-&gt;next != NULL)\n        {\n            list = list-&gt;next; // Advance to new node\n            list-&gt;next = NULL; // Terminate list at this node (until a new one is added)\n        }\n        else\n        {\n          // error handling\n          exit(1);\n        }\n    }\n</code></pre>\n\n<p>Besides that:</p>\n\n<ul>\n<li>You are obviously not using an embedded system where <code>main</code> might have <code>void</code> return type. For all hosted environments it has to return <code>int</code>.</li>\n<li>Why do you define standard macro <code>NULL</code>? You should included the C standard header that defined it. Besides that <code>NULL</code>is a pointer value. Why do you use integer type?</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 1, "last_activity_date": 1577860464, "creation_date": 1577860464, "answer_id": 59550441, "question_id": 59542465, "link": "https://stackoverflow.com/questions/59542465/why-is-my-print-function-only-read-the-last-element-and-garbage-then-stop-resp/59550441#59550441", "title": "Why is my &quot;print&quot; function only read the last element and garbage then stop responding?", "body": "<p>The following proposed code:</p>\n\n<ol>\n<li>cleanly compiles</li>\n<li>performs most error checking</li>\n<li>actually produce a linked list of <code>struct student</code> </li>\n<li>documents why each header file is included</li>\n<li>eliminates most of the 'magic' numbers</li>\n<li>initializes the <code>next</code> field properly</li>\n<li>fails to pass the allocated memory areas to <code>free()</code></li>\n<li>properly passes the address of <code>head</code> to the <code>read()</code> function so when the list is empty, the contents of <code>head</code> can be updated with the pointer to the first <code>node</code></li>\n<li>properly initializes the <code>head</code> pointer to NULL</li>\n<li>properly links each new node to the prior node</li>\n</ol>\n\n<p>and now, the proposed code:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;   // FILE, fopen, fclose, scanf(), fscanf(), printf()\n#include &lt;stdio.h&gt;    // malloc(), free(), exit(), EXIT_FAILURE\n#include &lt;string.h&gt;   // memcpy()\n\n#define MAX_NAME_LEN 20\n#define MAX_FILENAME_LEN 30\n\nstruct student\n{\n    int id;\n    char name[ MAX_NAME_LEN ];\n    float marks;\n    struct student *next;\n};\ntypedef struct student node;\n\n\nvoid read_echo_records  (node **p);\nvoid create(node *p);\nint  count (node *p);\nvoid print (node *p);\n\n\nint main( void )\n{\n    node *head = NULL;\n\n    read_echo_records( &amp;head);\n    printf(\"\\n\");\n    print(head);\n}\n\n\nvoid read_echo_records(node **list)\n{\n    FILE *fp;\n    char filename[ MAX_FILENAME_LEN ];\n    printf(\"input file name: \");\n    scanf(\"%29s\",filename);\n\n    fp = fopen( filename, \"r\" );\n    if( fp == NULL )\n    {\n        perror( \"fopen failed\" );\n        exit( EXIT_FAILURE );\n    }\n\n    node *current = *list;\n    node *prior   = *list;\n    node workspace;\n    workspace.next = NULL;\n\n    while(fscanf(fp, \"%s %d %f\", workspace.name, &amp;workspace.id, &amp;workspace.marks) == 3)\n    {\n        printf(\"%s \\t%d \\t%f\\n\", workspace.name, workspace.id, workspace.marks);//check\n\n        if( ! (current = malloc(sizeof(node))) )//create next node\n        {\n            perror( \"malloc failed\" );\n            fclose( fp );\n            exit( EXIT_FAILURE );\n        }\n\n        memcpy( current, &amp;workspace, sizeof( node ) );\n        *prior-&gt;next = current;\n        prior = current;\n    }\n    fclose(fp);\n    return;\n}\n\n\nvoid print(node*list)\n{\n    node *current = list;\n    if( ! current )\n    {\n        printf( \"%s\\n\", \"list is empty\" );\n        return;\n    }\n\n    while( current-&gt;next )\n    {\n       printf( \"ID=%d\\n\", current-&gt;id );\n       printf( \"Name=%s\\n\", current-&gt;name );\n       printf( \"Marks=%f\\n\", current-&gt;marks );\n       printf( \"\\n\");\n       current = current-&gt;next;\n    } \n}\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 12524689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e20994a46597b1169383992e75d6bc80?s=128&d=identicon&r=PG&f=1", "display_name": "ThisIsHard", "link": "https://stackoverflow.com/users/12524689/thisishard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 59542623, "answer_count": 2, "score": 1, "last_activity_date": 1577860464, "creation_date": 1577786107, "question_id": 59542465, "link": "https://stackoverflow.com/questions/59542465/why-is-my-print-function-only-read-the-last-element-and-garbage-then-stop-resp", "title": "Why is my &quot;print&quot; function only read the last element and garbage then stop responding?", "body": "<pre><code>#include &lt;stdlib.h&gt;\n#define NULL 0\n\nstruct student\n{\n    int id;\n    char name[20];\n    float marks;\n    struct student *next\n};\ntypedef struct student node;\nvoid main()\n{\n    node *head;\n    void read(node *p);\n    void create(node *p);\n    int count(node *p);\n    void print(node *p);\n    head=(node *)malloc(sizeof(node));\n    read(head);\n    printf(\"\\n\");\n    print(head);\n}\nvoid read(node *list)\n{\n    FILE *fp;\n    char filename[30];\n    printf(\"input file name: \");\n    scanf(\"%s\",filename);\n    fp=fopen(filename,\"r\");\n\n    if(fp == NULL)\n    {\n        return; // file doesn't exist\n    }\n    while(fscanf(fp, \"%s %d %f\", list-&gt;name, &amp;list-&gt;id, &amp;list-&gt;marks) == 3)\n    {\n        printf(\"%s \\t%d \\t%f\\n\", list-&gt;name,list-&gt;id,list-&gt;marks);//check\n        list-&gt;next=(node*)malloc(sizeof(node));//create next node\n    }\n    fclose(fp);\n    return;\n}\nvoid print(node*list)\n{\n    if(list-&gt;next!=NULL)\n       {\n           printf(\"ID=%d\\n\",list-&gt;id);\n           printf(\"Name=%s\\n\",list-&gt;name);\n           printf(\"Marks=%f\\n\",list-&gt;marks);\n           printf(\"\\n\");\n           if(list-&gt;next-&gt;next==NULL)\n            {\n                printf(\"%d\",list-&gt;next-&gt;id);\n            }\n           print(list-&gt;next);\n       }\n       return;\n}\n</code></pre>\n\n<p>It looks like it printed the last line and next line(which is garbage).I think the problem is in the read function ? Since I dont feel the way I check it is accurate.\nAnyway i have not been able to fix this, so it will be very helpful if someone can teach me where is the fault and better way to fix it. </p>\n\n<p>output:</p>\n\n<pre><code>input file name: input.txt.txt\nstudent01       1       95.000000\nstudent03       3       90.000000\nstudent05       5       86.000000\nstudent07       7       83.000000\nstudent09       9       98.000000\nstudent10       10      93.000000\nstudent08       8       92.000000\nstudent06       6       96.000000\nstudent04       4       93.000000\nstudent02       2       88.000000\n\nID=2\nName=student02\nMarks=88.000000\n\nID=11552328\n\u2591ame=P\nMarks=13640062821560266000000000000000000.000000\n\n\nProcess returned -1073741819 (0xC0000005)   execution time : 6.737 s\nPress any key to continue.\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 363, "user_id": 5868851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fiyld.jpg?s=128&g=1", "display_name": "Zelnes", "link": "https://stackoverflow.com/users/5868851/zelnes"}, "edited": false, "score": 0, "creation_date": 1577786062, "post_id": 59542393, "comment_id": 105253899, "body": "In the prototypes you have not written the types of the arguments. It should be something like <code>bool haveSameElems(int *var1, int *var2, int size)</code>"}, {"owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 0, "creation_date": 1577786080, "post_id": 59542393, "comment_id": 105253910, "body": "Your function declaration and definition is wrong \u2026 you need to specify data types for your parameters! Furthermore, <code>main</code> must return <code>int</code>. Lastly, <code>haveSameElems</code> does not always return a value."}, {"owner": {"reputation": 363, "user_id": 5868851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fiyld.jpg?s=128&g=1", "display_name": "Zelnes", "link": "https://stackoverflow.com/users/5868851/zelnes"}, "edited": false, "score": 0, "creation_date": 1577786247, "post_id": 59542393, "comment_id": 105253971, "body": "Also, your function is not doing what you say you want. Here, you will just check that at least your arrays have a common value, because you <code>return true</code>"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1577788380, "post_id": 59542393, "comment_id": 105254748, "body": "@Veronika Kovaleva And where is there the recursive function?"}, {"owner": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "edited": false, "score": 0, "creation_date": 1577792554, "post_id": 59542393, "comment_id": 105256216, "body": "Defining a function without type specifier is, unfortunately, accepted by actual compilers due to the compliance with old K&amp;R grammar still accepted, and defaults the objects to <code>int</code> type. So while the function definition is still accepted when you try to use the <code>int</code> defaulted variables, <code>arr1</code> and <code>arr2</code>, as arrays the compiler triggers the error."}], "answers": [{"tags": [], "owner": {"reputation": 3326, "user_id": 1286628, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/3bed893585a9edc032201bed4dbca3a6?s=128&d=identicon&r=PG", "display_name": "wkschwartz", "link": "https://stackoverflow.com/users/1286628/wkschwartz"}, "is_accepted": false, "score": 0, "last_activity_date": 1577795479, "last_edit_date": 1577795479, "creation_date": 1577794976, "answer_id": 59544109, "question_id": 59542393, "link": "https://stackoverflow.com/questions/59542393/error-expression-must-have-a-pointer-to-object-type-in-c/59544109#59544109", "title": "Error &quot;Expression must have a pointer to object type&quot; in C", "body": "<p>Your function declaration <code>bool haveSameElems(arr1, arr2, size)</code> is implicitly the same as <code>bool haveSameElems(int arr1, int arr2, int size)</code>, per <a href=\"https://stackoverflow.com/questions/59542393/error-expression-must-have-a-pointer-to-object-type-in-c#comment105256216_59542393\">Frankie_C</a>. To use <code>arr1</code> and <code>arr2</code> as arrays, they must be declared as pointers: <code>bool haveSameElems(int *arr1, int *arr2, int size)</code>. So you need to add those two asterisks in both the function declaration at the top of your code and in the function definition it corresponds to. It\u2019s good practice <em>always explicitly</em> to write types and not rely on the old K&amp;R style implicit <code>int</code> types Frankie_C wrote about in his comment. You can read more about it in the bottom box <a href=\"https://en.cppreference.com/w/c/language/function_definition\" rel=\"nofollow noreferrer\">here</a> and in the \u201csubscript\u201d section <a href=\"https://en.cppreference.com/w/c/language/operator_member_access\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>You also <a href=\"https://en.cppreference.com/w/c/language/return\" rel=\"nofollow noreferrer\">need</a> a <code>return false</code> at the end of <code>haveSameElems</code>, and <code>main</code> must return type <code>int</code> if you\u2019re using an older C complier. See <a href=\"https://en.cppreference.com/w/c/language/main_function\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 1, "user_id": 12467377, "user_type": "registered", "profile_image": "https://graph.facebook.com/2880716941940657/picture?type=large", "display_name": "Veronika Kovaleva", "link": "https://stackoverflow.com/users/12467377/veronika-kovaleva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1577795479, "creation_date": 1577785876, "last_edit_date": 1577790352, "question_id": 59542393, "link": "https://stackoverflow.com/questions/59542393/error-expression-must-have-a-pointer-to-object-type-in-c", "title": "Error &quot;Expression must have a pointer to object type&quot; in C", "body": "<p>I'm trying to build a Boolean function to check if two unsorted arrays have the same elements. But every time I try to debug the program,I keep getting an error \"Expression must have a pointer to object type\". I have tried everything. Nothing seem to be working. Can anyone please let me know what I am doing wrong?</p>\n\n<pre><code>\n#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n#include &lt;stdlib.h&gt;\n#include&lt;stdbool.h&gt;\n\nbool haveSameElems(arr1, arr2, size);\n\nvoid main()\n{\n    int size;\n\n    scanf(\"%d\", &amp;size);\n    int* arr1 = (int*)calloc(size, sizeof(int));\n    for (int i = 0; i &lt; size; i++)\n    {\n        scanf(\"%d \", &amp;arr1[i]);\n    }\n    int* arr2 = (int*)calloc(size, sizeof(int));\n    for (int i = 0; i &lt; size; i++)\n    {\n        scanf(\"%d \", &amp;arr2[i]);\n    }\n\n    bool ans = haveSameElems(arr1, arr2, size);\n\n    printf(\"%s\", ans ? \"true\" : \"false\");\n}\n\nbool haveSameElems(arr1, arr2, size)\n{\n    for (int i = 0; i &lt; size; i++)\n    {\n        for (int j = 0; j &lt; size; j++)\n        {\n            if (arr1[i] == arr2[j]) // I keep getting the error here \n            {\n                return true;\n            }\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "buffer-overflow"], "comments": [{"owner": {"reputation": 699, "user_id": 7562074, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mYiplUjiang/AAAAAAAAAAI/AAAAAAAAASg/IuJhDArg780/photo.jpg?sz=128", "display_name": "Roy Avidan", "link": "https://stackoverflow.com/users/7562074/roy-avidan"}, "edited": false, "score": 0, "creation_date": 1577782923, "post_id": 59541677, "comment_id": 105252836, "body": "Since the array is not global I don&#39;t think it is possible."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 1, "creation_date": 1577782941, "post_id": 59541677, "comment_id": 105252847, "body": "Side note: <code>void main()</code> is not legal C (except in stand-alone environments)..."}, {"owner": {"reputation": 3177, "user_id": 1221236, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/230d4a82674b9e02c0b95e4ecf7468ae?s=128&d=identicon&r=PG", "display_name": "dragosht", "link": "https://stackoverflow.com/users/1221236/dragosht"}, "edited": false, "score": 0, "creation_date": 1577783378, "post_id": 59541677, "comment_id": 105252990, "body": "61 characters won&#39;t do it. You have to go deeper into the <code>main</code>&#39;s stack frame to overwrite <code>isAdmin</code>. I suggest you use <code>gdb</code>/<code>examine memory</code> to view your exact stack layout."}, {"owner": {"reputation": 6031, "user_id": 10871900, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-noQwojQppnY/AAAAAAAAAAI/AAAAAAAAACs/59RU8UyHFSk/photo.jpg?sz=128", "display_name": "dan1st", "link": "https://stackoverflow.com/users/10871900/dan1st"}, "edited": false, "score": 1, "creation_date": 1577783793, "post_id": 59541677, "comment_id": 105253130, "body": "From the Linux man page: <code>Never use gets()</code>"}, {"owner": {"reputation": 6031, "user_id": 10871900, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-noQwojQppnY/AAAAAAAAAAI/AAAAAAAAACs/59RU8UyHFSk/photo.jpg?sz=128", "display_name": "dan1st", "link": "https://stackoverflow.com/users/10871900/dan1st"}, "edited": false, "score": 0, "creation_date": 1577783875, "post_id": 59541677, "comment_id": 105253157, "body": "If you add the wrong call, it would be vulnerable."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 1, "creation_date": 1577785000, "post_id": 59541677, "comment_id": 105253555, "body": "<code>gets</code> actually has been removed from the standard (since C11)..."}, {"owner": {"reputation": 33, "user_id": 12631181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f159cb2271d13ab161c1ab52f3ea9ab2?s=128&d=identicon&r=PG&f=1", "display_name": "Berkan", "link": "https://stackoverflow.com/users/12631181/berkan"}, "edited": false, "score": 0, "creation_date": 1577785815, "post_id": 59541677, "comment_id": 105253831, "body": "Yes I know, but this is just an exercise for beginners."}], "answers": [{"comments": [{"owner": {"reputation": 3177, "user_id": 1221236, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/230d4a82674b9e02c0b95e4ecf7468ae?s=128&d=identicon&r=PG", "display_name": "dragosht", "link": "https://stackoverflow.com/users/1221236/dragosht"}, "edited": false, "score": 1, "creation_date": 1577783847, "post_id": 59541986, "comment_id": 105253150, "body": "What about <code>g()</code>&#39;s return address? You&#39;re not mentioning that ..."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1577784238, "post_id": 59541986, "comment_id": 105253281, "body": "In addition to the return address: There won&#39;t be 60 bytes twice on the stack, before the second 60 bytes are pushed, the previous 60 ones are popped from. On the other hand, alignment requirements might enforce some gaps in between the variables."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1577784917, "post_id": 59541986, "comment_id": 105253531, "body": "ASCII characters are just numerical values as well, e. g. <code>a</code> has value 97. Apart from, there&#39;s no guarantee that user&#39;s system uses ASCII (most likely, some ASCII compatible, but extended characterset, e. g. utf-8 or CP1252). If you manage to overwrite isAdmin (and to return successfully from g!), then <i>any</i> value other than 0 is fine to trigger the if..."}, {"owner": {"reputation": 23, "user_id": 11911043, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lA3Z9cOjBwI/AAAAAAAAAAI/AAAAAAAAACc/AwvE2ckE7Xc/photo.jpg?sz=128", "display_name": "QuantumX", "link": "https://stackoverflow.com/users/11911043/quantumx"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1577812375, "post_id": 59541986, "comment_id": 105262624, "body": "@Aconcagua how would you input the character value 1? There is literally no key for it, since its Start of Header"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1577963041, "post_id": 59541986, "comment_id": 105292149, "body": "There&#39;s no need to input exact character value of 1. <i>Any</i> value is fine, as long as it is not 0. So &#39;a&#39; (decimal 97) is fine as well. <code>if(1012)</code> will do just exactly the same as <code>if(1)</code>."}], "tags": [], "owner": {"reputation": 23, "user_id": 11911043, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lA3Z9cOjBwI/AAAAAAAAAAI/AAAAAAAAACc/AwvE2ckE7Xc/photo.jpg?sz=128", "display_name": "QuantumX", "link": "https://stackoverflow.com/users/11911043/quantumx"}, "is_accepted": false, "score": -2, "last_activity_date": 1577783673, "creation_date": 1577783673, "answer_id": 59541986, "question_id": 59541677, "link": "https://stackoverflow.com/questions/59541677/is-it-possible-to-exploit-the-following-code/59541986#59541986", "title": "Is it possible to exploit the following code?", "body": "<p>Yes you can exploit it but not with standard input. Basically first isAdmin is pushed to the stack, then when calling g you push 60 bytes and after this again 60 bytes. When you manage to write a 1 in byte 120-124 (sizeof(int = 4)) isAdmin will be 1. When using gets() you can only use Ascii characters. There is no key for entering a 1 and I am not sure how gets behaves in this case.</p>\n"}, {"comments": [{"owner": {"reputation": 3177, "user_id": 1221236, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/230d4a82674b9e02c0b95e4ecf7468ae?s=128&d=identicon&r=PG", "display_name": "dragosht", "link": "https://stackoverflow.com/users/1221236/dragosht"}, "edited": false, "score": 2, "creation_date": 1577784447, "post_id": 59542028, "comment_id": 105253349, "body": "You&#39;re right. But I sense this is just an idealistic exercise on IA-32 with no ASLR and stack protection, in which case it would actually work. You just need to  fill in the right return address to <code>main()</code> in the buffer - that won&#39;t change if ASLR is down. Then you would just go past that and overwrite <code>isAdmin</code> on the stack. Obviously portability was not targeted here ..."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 3177, "user_id": 1221236, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/230d4a82674b9e02c0b95e4ecf7468ae?s=128&d=identicon&r=PG", "display_name": "dragosht", "link": "https://stackoverflow.com/users/1221236/dragosht"}, "edited": false, "score": 0, "creation_date": 1577784670, "post_id": 59542028, "comment_id": 105253437, "body": "@dragosht Still portability is an issue: If question author uses MSVC, she/he won&#39;t be able to compile that."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 3177, "user_id": 1221236, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/230d4a82674b9e02c0b95e4ecf7468ae?s=128&d=identicon&r=PG", "display_name": "dragosht", "link": "https://stackoverflow.com/users/1221236/dragosht"}, "edited": false, "score": 1, "creation_date": 1577784861, "post_id": 59542028, "comment_id": 105253513, "body": "@dragosht And how would you want to get that return address from outside? Pretty difficult. Enforcing inlining is much simpler to avoid the return address issue. And with that, I managed to produce desired result on a standard Windows environment (Win7), just needed to make sure to provide enough input to cover the alignment gaps in between the variables..."}, {"owner": {"reputation": 3177, "user_id": 1221236, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/230d4a82674b9e02c0b95e4ecf7468ae?s=128&d=identicon&r=PG", "display_name": "dragosht", "link": "https://stackoverflow.com/users/1221236/dragosht"}, "edited": false, "score": 0, "creation_date": 1577785264, "post_id": 59542028, "comment_id": 105253643, "body": "I&#39;m pretty sure the OP strictly runs this on some 32-bit Linux, and compiles his code with no optimization options so that address can easily be retrieved with <code>gdb</code>. I think this sort of low level hacking exercise is called a logic bomb. There were plenty of such questions on StackOverflow some time ago ..."}, {"owner": {"reputation": 33, "user_id": 12631181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f159cb2271d13ab161c1ab52f3ea9ab2?s=128&d=identicon&r=PG&f=1", "display_name": "Berkan", "link": "https://stackoverflow.com/users/12631181/berkan"}, "reply_to_user": {"reputation": 3177, "user_id": 1221236, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/230d4a82674b9e02c0b95e4ecf7468ae?s=128&d=identicon&r=PG", "display_name": "dragosht", "link": "https://stackoverflow.com/users/1221236/dragosht"}, "edited": false, "score": 0, "creation_date": 1577785759, "post_id": 59542028, "comment_id": 105253817, "body": "I compiled the code with <code>gcc -g -o buf buf11.c -m32 -mpreferred-stack-boundary=2 -fno-stack-protector</code>, I have a sense about where you guys are going to but I&#39;m not able to exploit it, Is it possible to share the payload? @dragosht Indeed, It is meant to retrieve the address easily from gdb."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 33, "user_id": 12631181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f159cb2271d13ab161c1ab52f3ea9ab2?s=128&d=identicon&r=PG&f=1", "display_name": "Berkan", "link": "https://stackoverflow.com/users/12631181/berkan"}, "edited": false, "score": 1, "creation_date": 1577786363, "post_id": 59542028, "comment_id": 105254002, "body": "@Berkan I reduced the array size to four characters and still needed to input 25 characters to provoke printing &#39;you won&#39;. You might need even more surplus characters, depending on how the variables are aligned on stack on your system..."}], "tags": [], "owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "is_accepted": true, "score": 2, "last_activity_date": 1577783913, "creation_date": 1577783913, "answer_id": 59542028, "question_id": 59541677, "link": "https://stackoverflow.com/questions/59541677/is-it-possible-to-exploit-the-following-code/59542028#59542028", "title": "Is it possible to exploit the following code?", "body": "<p>That simple it won't work!</p>\n\n<p>It first depends on if the stack is growing top down or bottom up. With the latter you won't be able at all to overwrite variables on stack of the calling function, they reside in front of the array.</p>\n\n<p>With the latter (admitted, the far more common variant), you might manage successfully to overwrite the <code>isAdmin</code> variable. However, when calling a function, there's quite a bit of data reserved on stack, at very, very least, you'll find the return address there. And that one will be overwritten, too! So your programme would continue, or better: try to continue, at some arbitrary address in memory. The most likely result is a crash of your programme.</p>\n\n<p>So your only realistic chance is inlining the function, e. g. with GCC:</p>\n\n<pre><code>inline void g() __attribute__((always_inline));\nvoid g()\n{\n    char buff[64];\n    gets(buff);\n}\n</code></pre>\n\n<p>Be aware that this is not portable code, the <code>__attribute__</code> annotation is GCC (and clang) specific.</p>\n\n<p>That way, I indeed managed to produce your desired result (still requiring a top down stack!). You might need to provide quite a number of extra bytes, alignment issues might enforce quite some gaps in between the variables. However, depending on how much data you overwrite, you might still produce a crash (possibly before any output is produced).</p>\n\n<p>In any case, you are far in the land of undefined behaviour, so there is absolutely no guarantee that you really get what you want, <em>anything</em> might happen instead.</p>\n"}], "owner": {"reputation": 33, "user_id": 12631181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f159cb2271d13ab161c1ab52f3ea9ab2?s=128&d=identicon&r=PG&f=1", "display_name": "Berkan", "link": "https://stackoverflow.com/users/12631181/berkan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 59542028, "answer_count": 2, "score": 3, "last_activity_date": 1577783913, "creation_date": 1577781806, "last_edit_date": 1577783771, "question_id": 59541677, "link": "https://stackoverflow.com/questions/59541677/is-it-possible-to-exploit-the-following-code", "title": "Is it possible to exploit the following code?", "body": "<p>I tried to exploit the following code but without succes. I tried an input of 60 + 1 characters but it didn't work.</p>\n\n<p>CFI using labels is enabled. Stack canaries, non-executable stack and ASLR are disabled. Can you make the program print \"You won!\\n\"? (suppose isAdmin is a global variable instead of a variable defined in main(). Is it still possible to exploit the code?)</p>\n\n<pre><code>void g() {\n   char buff[60];\n   gets(buff);\n}\n\nvoid main() {\n   int isAdmin = 1;\n   g();\n   isAdmin = 0;\n   g();\n   if (isAdmin) { printf(\"You won!\\n\"); }\n}\n</code></pre>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 15, "user_id": 12235204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6e88940c3d4529b07c36504fe2c49ba?s=128&d=identicon&r=PG&f=1", "display_name": "Kritsos", "link": "https://stackoverflow.com/users/12235204/kritsos"}, "reply_to_user": {"reputation": 81087, "user_id": 104458, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/cc46b8a10ecb92e61aaeb1efe436a0c8?s=128&d=identicon&r=PG", "display_name": "selbie", "link": "https://stackoverflow.com/users/104458/selbie"}, "edited": false, "score": 0, "creation_date": 1577781118, "post_id": 59541496, "comment_id": 105252263, "body": "No i don&#39;t think so because if strcspn doesn&#39;t find what it&#39;s looking for it returns the length of the string."}, {"owner": {"reputation": 81087, "user_id": 104458, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/cc46b8a10ecb92e61aaeb1efe436a0c8?s=128&d=identicon&r=PG", "display_name": "selbie", "link": "https://stackoverflow.com/users/104458/selbie"}, "edited": false, "score": 0, "creation_date": 1577781316, "post_id": 59541496, "comment_id": 105252313, "body": "What input do you type to trigger the crash?"}, {"owner": {"reputation": 15, "user_id": 12235204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6e88940c3d4529b07c36504fe2c49ba?s=128&d=identicon&r=PG&f=1", "display_name": "Kritsos", "link": "https://stackoverflow.com/users/12235204/kritsos"}, "reply_to_user": {"reputation": 81087, "user_id": 104458, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/cc46b8a10ecb92e61aaeb1efe436a0c8?s=128&d=identicon&r=PG", "display_name": "selbie", "link": "https://stackoverflow.com/users/104458/selbie"}, "edited": false, "score": 0, "creation_date": 1577781653, "post_id": 59541496, "comment_id": 105252411, "body": "That&#39;s the problem i don&#39;t know. The program works perfectly for eveyrthing i type in but i am supposed to submit it to a bot which automatically tests my code. There are 3 test cases (in which my code works fine) plus one hidden test case which probably has a big amount of input to test my memory allocation. My code crashes on the last test case and only shows me that a realloc() invalid next size error occured."}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1577782439, "post_id": 59541496, "comment_id": 105252673, "body": "<code>char ** option; ... strlen(option)</code>  You probably meant to pass something different to strlen."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1577782561, "post_id": 59541496, "comment_id": 105252712, "body": "For starters, with <code>if(A[0] == &#39; &#39;) ...A[i] = A[i + 1];</code>, <code>length</code> is never reduced before the next nested <code>for(i = 0;i &lt; length;i++) ... for(k = i;k &lt; length;k++) ...</code> set of loops. That could cause all sorts of havoc if you are off by one."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 12235204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6e88940c3d4529b07c36504fe2c49ba?s=128&d=identicon&r=PG&f=1", "display_name": "Kritsos", "link": "https://stackoverflow.com/users/12235204/kritsos"}, "edited": false, "score": 0, "creation_date": 1577783070, "post_id": 59541800, "comment_id": 105252892, "body": "Thank you so much that was it. Unfortunately our professor for some reason tasked us with a string handling project in c (which doesn&#39;t even have a built-in string data type...) without telling us about structures, linked lists or buffer management and on top of that he said that our program will be tested on a very limited memory resources environment that&#39;s why EVERYTHING has to be dynamically allocated."}, {"owner": {"reputation": 81087, "user_id": 104458, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/cc46b8a10ecb92e61aaeb1efe436a0c8?s=128&d=identicon&r=PG", "display_name": "selbie", "link": "https://stackoverflow.com/users/104458/selbie"}, "reply_to_user": {"reputation": 15, "user_id": 12235204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6e88940c3d4529b07c36504fe2c49ba?s=128&d=identicon&r=PG&f=1", "display_name": "Kritsos", "link": "https://stackoverflow.com/users/12235204/kritsos"}, "edited": false, "score": 0, "creation_date": 1577819452, "post_id": 59541800, "comment_id": 105264476, "body": "I just amended the answer to include some general code review advice that will improve the readability of your code. And if you improve the readability of code, you ultimately improve the ability to debug it."}], "tags": [], "owner": {"reputation": 81087, "user_id": 104458, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/cc46b8a10ecb92e61aaeb1efe436a0c8?s=128&d=identicon&r=PG", "display_name": "selbie", "link": "https://stackoverflow.com/users/104458/selbie"}, "is_accepted": true, "score": 1, "last_activity_date": 1577819401, "last_edit_date": 1577819401, "creation_date": 1577782473, "answer_id": 59541800, "question_id": 59541496, "link": "https://stackoverflow.com/questions/59541496/what-is-causing-the-realloc-invalid-next-size-error/59541800#59541800", "title": "What is causing the realloc() invalid next size error?", "body": "<p>These lines look suspicious:</p>\n\n<pre><code>            while (paragraphs[num_par - 1][i] != ' ')\n                words[num_words - 1][j++] = paragraphs[num_par - 1][i++];\n</code></pre>\n\n<p>It's not checking for the end of line condition.</p>\n\n<p>Shouldn't it be this:</p>\n\n<pre><code>while ( (paragraphs[num_par - 1][i] != '\\0') &amp;&amp;\n        (paragraphs[num_par - 1][i] != ' '))\n{\n   words[num_words - 1][j++] = paragraphs[num_par - 1][i++];\n}\n</code></pre>\n\n<p>Some general advice.  Your code goes way overboard with the amount of mallocs and reallocs.   There's more code dealing with memory management than there is actual program logic. And it leaves much to be desired wrt to formatting and style.  It would take a long time for me to write up how to improve it for readability and debuggability, but consider submitting it to <a href=\"https://codereview.stackexchange.com/\">CodeReview</a> after you get all the bugs out.</p>\n\n<p><strong>Some more general advice</strong></p>\n\n<p>Use curly brace blocks for all <code>if</code> and <code>for</code> blocks, even for \"single lines\".  Instead of this:</p>\n\n<pre><code>for (i = 0; i &lt; length; i++)\n    if (!((A[i] &gt;= 'a' &amp;&amp; A[i] &lt;= 'z') || (A[i] &gt;= 'A' &amp;&amp; A[i] &lt;= 'Z')) &amp;&amp; (A[i + 1] == ' ' || A[i + 1] == '\\0'))\n        for (k = i; k &lt; length; k++)\n            A[k] = A[k + 1];\n</code></pre>\n\n<p>This:</p>\n\n<pre><code>for (i = 0; i &lt; length; i++)\n{\n    if (!((A[i] &gt;= 'a' &amp;&amp; A[i] &lt;= 'z') || (A[i] &gt;= 'A' &amp;&amp; A[i] &lt;= 'Z')) &amp;&amp; (A[i + 1] == ' ' || A[i + 1] == '\\0'))\n    {\n        for (k = i; k &lt; length; k++)\n        {\n            A[k] = A[k + 1];\n        }\n    }\n}\n</code></pre>\n\n<p>Your <code>remove_special_char</code> function appears to just exist to remove punctuation chars from a string. It appears to do this by replacing all the punctuation chars with spaces.  Then removes all the spaces, then does some other double-nested for loop after that.  I think the entire function could be replaced as follows:</p>\n\n<pre><code>int isPunctuation(char c)\n{\n    return ((c == '.') || (c == ',') || (c == '!') || (c == '?') || (c == ';'));\n}\n\nvoid remove_special_char(char* str)\n{\n    char* ptrRead = str;\n    char* ptrWrite = str;\n\n    while (*ptrRead)\n    {\n        if (!isPunctuation(*ptrRead))\n        {\n            *ptrWrite = *ptrRead;\n            ptrWrite++;\n        }\n        ptrRead++;\n    }\n    *ptrWrite = '\\0';\n}\n</code></pre>\n\n<p>You consistently reference array indices <code>number-1</code> and that makes your really hard to read.</p>\n\n<pre><code> sentences[num_sent - 1][j++] = option[i++];\n</code></pre>\n\n<p>If you had just incremented <code>num_sent</code> after the fact, then your code would read as follows:</p>\n\n<pre><code>sentences[num_sent][j++] = option[i++];\n\n// increment num_sent at the end of the loop\n</code></pre>\n\n<p>Further, don't increment index values while they are being used.  It's much harder to debug and read.  Better:</p>\n\n<pre><code>sentences[num_sent][j] = option[i];\ni++;\nj++;\n</code></pre>\n\n<p>Don't inline functions within functions such as the case here:</p>\n\n<pre><code>realloc(words[num_words - 1], (strlen(words[num_words - 1]) + 1) * sizeof(char));\n</code></pre>\n\n<p>Better:</p>\n\n<pre><code>wordsize = strlen(words[num_words]) + 1;\nwords[num_words] realloc(words[num_words], wordsize * sizeof(char));\n</code></pre>\n\n<p><code>sizeof(char)</code> I think is always 1 (at least in C++), but I digress.  But if you are expected to do that, write a helper function:</p>\n\n<pre><code>char* reallocateCharsForString(char* existing, size_t newlength)\n{\n    return (char*)realloc(existing, (newlength+1) * sizeof(char));\n}\n</code></pre>\n\n<p>Now you got your <code>+1</code> and <code>sizeof(char)</code> nusances abstracted into a single function.  Now your allocation statements look much better:</p>\n\n<pre><code>wordlength = strlen(words[num_words]);\nwords[num_words] = reallocateCharsForString(words[num_words], wordlength);\n</code></pre>\n\n<p>You could do a similar abstraction for <code>malloc</code> as well.</p>\n\n<p>Hope this helps.</p>\n"}, {"tags": [], "owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "is_accepted": false, "score": 0, "last_activity_date": 1577804981, "last_edit_date": 1577804981, "creation_date": 1577803973, "answer_id": 59545584, "question_id": 59541496, "link": "https://stackoverflow.com/questions/59541496/what-is-causing-the-realloc-invalid-next-size-error/59545584#59545584", "title": "What is causing the realloc() invalid next size error?", "body": "<p><code>sizeof(char)</code> is by definition 1;  It's better to write:</p>\n\n<pre><code> words[num_words - 1] = malloc(50 * sizeof(*words[0]));\n</code></pre>\n\n<p>or given it's a buffer of bytes, just</p>\n\n<pre><code> words[num_words - 1] = malloc(50);\n</code></pre>\n\n<hr>\n\n<p>There are many dangers in using <code>malloc()</code> and <code>realloc()</code> (especially with the latter):</p>\n\n<ul>\n<li>Both:  a reallocation of size 0 may return a non-NULL pointer that can't be dereferenced.  The only solution to this problem is to add a check for 0 before calling <code>*alloc()</code>.</li>\n<li>Both:  if the multiplication <code>nmemb * sizeof(*ptr)</code> would overflow, the resulting allocation will be smaller than expected, which will more than likely bite you.  A solution to that is <a href=\"http://man7.org/linux/man-pages/man3/reallocarray.3.html\" rel=\"nofollow noreferrer\"><code>reallocarray()</code></a>, which is present in some implementations (GLIBC and BSD at least).  Also <code>calloc()</code> (only solves <code>malloc()</code>) may be even safer for you if you use it for strings.  <a href=\"https://man.openbsd.org/recallocarray\" rel=\"nofollow noreferrer\"><code>recallocarray()</code></a> would be even better, but is harder to find implementations using it.</li>\n<li><code>realloc()</code>:  Asigning the result of <code>realloc()</code> without checking that it didn't fail will cause a memory leak when it fails.  A partial solution would be to use <a href=\"https://linux.die.net/man/3/reallocf\" rel=\"nofollow noreferrer\"><code>reallocf()</code></a>, although it may not be what you want.  It is present in BSD.  A better solution would be to add checks before the assignment.</li>\n<li>Both: If you don't check after the asignment if the pointer is non-NULL, your program will break if you try to dereference it.  The solution would be to write your own checks.</li>\n</ul>\n"}], "owner": {"reputation": 15, "user_id": 12235204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6e88940c3d4529b07c36504fe2c49ba?s=128&d=identicon&r=PG&f=1", "display_name": "Kritsos", "link": "https://stackoverflow.com/users/12235204/kritsos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 59541800, "answer_count": 2, "score": 0, "last_activity_date": 1577821857, "creation_date": 1577780610, "last_edit_date": 1577821857, "question_id": 59541496, "link": "https://stackoverflow.com/questions/59541496/what-is-causing-the-realloc-invalid-next-size-error", "title": "What is causing the realloc() invalid next size error?", "body": "<p>I have to write a program that at first reads text from the user and separates that text into paragraphs, sentences and words. I have managed to get it working for small texts but for big ones i get an realloc() invalid next size error. I have managed to trace the block that cause the error but i can't figure out why it is caused. Here is the code\n(<a href=\"https://gist.github.com/Kritsos/ed576224a36db0f68323bec6d541c286\" rel=\"nofollow noreferrer\">https://gist.github.com/Kritsos/ed576224a36db0f68323bec6d541c286</a>):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nvoid remove_special_char(char *A)\n{\n    int k, length, i;\n\n    length = strlen(A);\n    do\n    {\n        k = strcspn(A, \".,!?;\");\n        if(k != length)\n            A[k] = ' ';\n    }\n    while(k != length);\n\n    if(A[0] == ' ')\n        for(i = 0;i &lt; length;i++)\n            A[i] = A[i + 1];\n\n    for(i = 0;i &lt; length;i++)\n        if(!((A[i] &gt;= 'a' &amp;&amp; A[i] &lt;= 'z') || (A[i] &gt;= 'A' &amp;&amp; A[i] &lt;= 'Z')) &amp;&amp; (A[i + 1] == ' ' || A[i + 1] == '\\0'))\n            for(k = i;k &lt; length;k++)\n                A[k] = A[k + 1];\n\n\n}\n\nint main()\n{\n    char **paragraphs = malloc(sizeof(char *)), **sentences = malloc(sizeof(char *)), **words = malloc(sizeof(char *)), *option;\n    int num_par = 0, num_sent = 0, num_words = 0, i, quit = 0, count, length, j;\n\n    if(paragraphs == NULL || sentences == NULL || words == NULL)\n        return 1;\n\n    do\n    {\n        option = malloc(10000 * sizeof(char));\n        if(option == NULL)\n            return 1;\n        fgets(option, 10000, stdin);\n        option[strcspn(option, \"\\n\")] = '\\0';\n        length = strlen(option);\n        option = realloc(option, (length + 1) * sizeof(char));\n        if(option == NULL)\n            return 1;\n\n        if(strstr(option, \"ap:\"))\n        {\n            //paragraphs\n            num_par++;\n            paragraphs = realloc(paragraphs, num_par * sizeof(char *));\n            if(paragraphs == NULL)\n                return 1;\n            paragraphs[num_par - 1] = malloc((length - 2) * sizeof(char)); //length - 2 --&gt; -3 ap: + 1 '\\0'\n            if(paragraphs[num_par - 1] == NULL)\n                return 1;\n            strcpy(paragraphs[num_par - 1], option + 3);\n            remove_special_char(paragraphs[num_par - 1]);\n\n            //sentences\n            count = 0;//number of sentences\n            for(i = 0;i &lt; length;i++)\n                if(option[i] == '.' || option[i] == '!' || option[i] == '?' || option[i] == ';')\n                    count++;\n\n            i = 3;\n            while(count &gt; 0)\n            {\n                num_sent++;\n                sentences = realloc(sentences, num_sent * sizeof(char *));\n                if(sentences == NULL)\n                    return 1;\n                sentences[num_sent - 1] = malloc(200 * sizeof(char));\n                if(sentences[num_sent - 1] == NULL)\n                    return 1;\n\n                j = 0;\n                while(option[i] != '.' &amp;&amp; option[i] != '!' &amp;&amp; option[i] != '?' &amp;&amp; option[i] != ';')\n                    sentences[num_sent - 1][j++] = option[i++];\n                i++;\n                sentences[num_sent - 1][j] = '\\0';\n                sentences[num_sent - 1] = realloc(sentences[num_sent - 1], (strlen(sentences[num_sent - 1]) + 1) * sizeof(char));\n                if(sentences[num_sent - 1] == NULL)\n                    return 1;\n                remove_special_char(sentences[num_sent - 1]);\n                count--;\n            }\n\n  //THIS BLOCK RIGHT HERE CAUSES THE ERROR           \n            //words\n            count = 1; //number of words in paragraphs[num_par - 1] &amp;&amp; words = spaces + 1\n            length = strlen(paragraphs[num_par - 1]);\n            for(i = 0;i &lt; length;i++)\n                if(paragraphs[num_par - 1][i] == ' ')\n                    count++;\n\n            i = 0;\n            while(count &gt; 0)\n            {\n                num_words++;\n                words = realloc(words, num_words * sizeof(char *));\n                if(words == NULL)\n                    return 1;\n\n                words[num_words - 1] = malloc(50 * sizeof(char));\n                if(words[num_words - 1] == NULL)\n                    return 1;\n\n                j = 0;\n                while(paragraphs[num_par - 1][i] != ' ')\n                    words[num_words - 1][j++] = paragraphs[num_par - 1][i++];\n                i++;\n                words[num_words - 1][j] = '\\0';\n                words[num_words - 1] = realloc(words[num_words - 1], (strlen(words[num_words - 1]) + 1) * sizeof(char));\n                if(words[num_words - 1] == NULL)\n                    return 1;\n                count--;\n            }\n  //END OF FAULTY BLOCK\n        }\n\n        if(strstr(option, \"qt\"))\n            quit = 1;\n        free(option);\n\n    }\n    while(!(quit));\n\n    //test\n    for(i = 0;i &lt; num_par;i++)\n        printf(\"%s\\n\", paragraphs[i]);\n    printf(\"--------------- %d\\n\",num_par);\n    for(i = 0;i &lt; num_sent;i++)\n        printf(\"%s\\n\", sentences[i]);\n    printf(\"--------------- %d\\n\",num_sent);\n    for(i = 0;i &lt; num_words;i++)\n        printf(\"%s\\n\", words[i]);\n    printf(\"--------------- %d\\n\",num_words);\n\n    //memory leaks\n    for(i = 0;i &lt; num_par;i++)\n        free(paragraphs[i]);\n    free(paragraphs);\n    for(i = 0;i &lt; num_sent;i++)\n        free(sentences[i]);\n    free(sentences);\n    for(i = 0;i &lt; num_words;i++)\n        free(words[i]);\n    free(words);\n\n    return 0;\n}\n\n</code></pre>\n\n<p>Also i am sorry it is a bit difficult to read and follow. Here is the valgrind report:</p>\n\n<pre><code>==6252== Invalid read of size 1\n==6252==    at 0x109033: main (main.c:112)\n==6252==  Address 0x522fd66 is 0 bytes after a block of size 6 alloc'd\n==6252==    at 0x4C2FB0F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==6252==    by 0x108BEB: main (main.c:57)\n==6252== \n==6252== Invalid read of size 1\n==6252==    at 0x10900F: main (main.c:113)\n==6252==  Address 0x522fd66 is 0 bytes after a block of size 6 alloc'd\n==6252==    at 0x4C2FB0F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==6252==    by 0x108BEB: main (main.c:57)\n==6252== \n==6252== Invalid write of size 1\n==6252==    at 0x109012: main (main.c:113)\n==6252==  Address 0x522ffe2 is 0 bytes after a block of size 50 alloc'd\n==6252==    at 0x4C2FB0F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==6252==    by 0x108F91: main (main.c:107)\n==6252== \n==6252== \n==6252== More than 10000000 total errors detected.  I'm not reporting any more.\n==6252== Final error counts will be inaccurate.  Go fix your program!\n==6252== Rerun with --error-limit=no to disable this cutoff.  Note\n==6252== that errors may occur in your program without prior warning from\n==6252== Valgrind, because errors are no longer being displayed.\n==6252== \n==6252== \n==6252== Process terminating with default action of signal 11 (SIGSEGV)\n==6252==  Access not within mapped region at address 0x562D000\n==6252==    at 0x109012: main (main.c:113)\n==6252==  If you believe this happened as a result of a stack\n==6252==  overflow in your program's main thread (unlikely but\n==6252==  possible), you can try to increase the size of the\n==6252==  main thread stack using the --main-stacksize= flag.\n==6252==  The main thread stack size used in this run was 8388608.\n==6252== \n==6252== HEAP SUMMARY:\n==6252==     in use at exit: 94 bytes in 7 blocks\n==6252==   total heap usage: 13 allocs, 6 frees, 11,342 bytes allocated\n==6252== \n==6252== LEAK SUMMARY:\n==6252==    definitely lost: 0 bytes in 0 blocks\n==6252==    indirectly lost: 0 bytes in 0 blocks\n==6252==      possibly lost: 0 bytes in 0 blocks\n==6252==    still reachable: 94 bytes in 7 blocks\n==6252==         suppressed: 0 bytes in 0 blocks\n==6252== Rerun with --leak-check=full to see details of leaked memory\n==6252== \n==6252== For counts of detected and suppressed errors, rerun with: -v\n==6252== ERROR SUMMARY: 10000000 errors from 3 contexts (suppressed: 0 from 0)\nSegmentation fault (core dumped)\n</code></pre>\n"}, {"tags": ["c", "segmentation-fault", "pass-by-reference", "coredump"], "comments": [{"owner": {"reputation": 301, "user_id": 4287117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec64f958fb4cc3f79c4b7677670d0811?s=128&d=identicon&r=PG&f=1", "display_name": "Siddharth", "link": "https://stackoverflow.com/users/4287117/siddharth"}, "edited": false, "score": 0, "creation_date": 1577780700, "post_id": 59541487, "comment_id": 105252138, "body": "have you tried debugging the program?"}, {"owner": {"reputation": 3177, "user_id": 1221236, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/230d4a82674b9e02c0b95e4ecf7468ae?s=128&d=identicon&r=PG", "display_name": "dragosht", "link": "https://stackoverflow.com/users/1221236/dragosht"}, "edited": false, "score": 10, "creation_date": 1577781359, "post_id": 59541487, "comment_id": 105252325, "body": "*buff[*length] -&gt; (*buff)[*length]"}, {"owner": {"reputation": 31465, "user_id": 128384, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cf6f92bfb2a16c0e2c6ca7aef4440862?s=128&d=identicon&r=PG", "display_name": "stijn", "link": "https://stackoverflow.com/users/128384/stijn"}, "edited": false, "score": 1, "creation_date": 1577781512, "post_id": 59541487, "comment_id": 105252373, "body": "Note there are standard C functions for reading input see e.g. <a href=\"https://stackoverflow.com/questions/15883568/reading-from-stdin\">stackoverflow.com/questions/15883568/reading-from-stdin</a>"}, {"owner": {"reputation": 699, "user_id": 7562074, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mYiplUjiang/AAAAAAAAAAI/AAAAAAAAASg/IuJhDArg780/photo.jpg?sz=128", "display_name": "Roy Avidan", "link": "https://stackoverflow.com/users/7562074/roy-avidan"}, "edited": false, "score": 0, "creation_date": 1577783093, "post_id": 59541487, "comment_id": 105252899, "body": "EOF usually is -1, so your comparison won&#39;t work with <code>unsigned char</code>. Consider changing <code>chr</code> type to <code>int</code> and casting it to <code>unsigned char</code> when necessary."}], "owner": {"reputation": 31, "user_id": 12097843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5762f1cf0c31b83ca47b37456fd274f8?s=128&d=identicon&r=PG&f=1", "display_name": "avidlearner", "link": "https://stackoverflow.com/users/12097843/avidlearner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "closed_date": 1577783317, "answer_count": 0, "score": 2, "last_activity_date": 1577780736, "creation_date": 1577780576, "last_edit_date": 1577780736, "question_id": 59541487, "link": "https://stackoverflow.com/questions/59541487/why-am-i-getting-a-segmentation-fault-when-iterating-over-an-array", "closed_reason": "Not suitable for this site", "title": "Why am I getting a segmentation fault when iterating over an array?", "body": "<p>I extracted the function in question from my main project and simplified it in order to demonstrate the problem I have:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nvoid read_input(unsigned char **buff, unsigned int *length){\n\n    unsigned int buff_size = 36;\n    *buff = (unsigned char *) malloc(buff_size);\n    memset(*buff, 0, buff_size);\n    unsigned char chr;\n    while((chr=getchar()) != '\\n' &amp;&amp; chr != EOF){\n        *buff[*length] = chr;\n        printf(\"%c\\n\", *buff[*length]);\n        ++(*length);\n\n    }\n}\n\nint main(int argc, char **argv){\n\n    unsigned char *buff;\n    unsigned int length = 0;\n\n    read_input(&amp;buff, &amp;length);\n    printf(\"%s, %i\\n\", buff, length);\n\n}\n</code></pre>\n\n<p>If I run the program, and type <code>test</code>, the output is:</p>\n\n<p><code>t</code></p>\n\n<p><code>Segmentation fault (core dumped)</code></p>\n\n<p>Why is this happening and how can I fix it?</p>\n"}, {"tags": ["c", "loops"], "answers": [{"tags": [], "owner": {"reputation": 1122, "user_id": 4139593, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wPItEJaVcpo/AAAAAAAAAAI/AAAAAAAAAIA/wDUIxQKRNvA/photo.jpg?sz=128", "display_name": "TruthSeeker", "link": "https://stackoverflow.com/users/4139593/truthseeker"}, "is_accepted": false, "score": -1, "last_activity_date": 1577775994, "creation_date": 1577775994, "answer_id": 59540779, "question_id": 59540637, "link": "https://stackoverflow.com/questions/59540637/is-there-anything-wrong-to-check-the-identity-of-the-matrix/59540779#59540779", "title": "Is there anything wrong to check the identity of the matrix?", "body": "<p>If you notice  <code>if(i=j)</code> is not a comparison but assignment. Update with <code>if(i==j)</code> for comparison</p>\n"}, {"comments": [{"owner": {"reputation": 506, "user_id": 12552748, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oxFq6.jpg?s=128&g=1", "display_name": "Hoang Nam", "link": "https://stackoverflow.com/users/12552748/hoang-nam"}, "edited": false, "score": 0, "creation_date": 1577777060, "post_id": 59540856, "comment_id": 105251045, "body": "I don&#39;t know why but I don&#39;t have any warning at all. Maybe my gcc don&#39;t have such a good quality as yours. Which compiler have you been using?"}, {"owner": {"reputation": 2246, "user_id": 5108631, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/Bm0c3.jpg?s=128&g=1", "display_name": "Youssef13", "link": "https://stackoverflow.com/users/5108631/youssef13"}, "reply_to_user": {"reputation": 506, "user_id": 12552748, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oxFq6.jpg?s=128&g=1", "display_name": "Hoang Nam", "link": "https://stackoverflow.com/users/12552748/hoang-nam"}, "edited": false, "score": 0, "creation_date": 1577777183, "post_id": 59540856, "comment_id": 105251081, "body": "@HoangNam, I&#39;m using GCC. Did you enable <code>-Wall</code> compiler flag ?"}, {"owner": {"reputation": 506, "user_id": 12552748, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oxFq6.jpg?s=128&g=1", "display_name": "Hoang Nam", "link": "https://stackoverflow.com/users/12552748/hoang-nam"}, "edited": false, "score": 0, "creation_date": 1577777388, "post_id": 59540856, "comment_id": 105251135, "body": "How can I enable it? I&#39;m now using gcc on ubuntu"}, {"owner": {"reputation": 2246, "user_id": 5108631, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/Bm0c3.jpg?s=128&g=1", "display_name": "Youssef13", "link": "https://stackoverflow.com/users/5108631/youssef13"}, "reply_to_user": {"reputation": 506, "user_id": 12552748, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oxFq6.jpg?s=128&g=1", "display_name": "Hoang Nam", "link": "https://stackoverflow.com/users/12552748/hoang-nam"}, "edited": false, "score": 0, "creation_date": 1577777535, "post_id": 59540856, "comment_id": 105251180, "body": "@HoangNam, I think <code>gcc -Wall main.c</code> would do the trick. I&#39;ve also updated the answer with some additional notes."}, {"owner": {"reputation": 506, "user_id": 12552748, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oxFq6.jpg?s=128&g=1", "display_name": "Hoang Nam", "link": "https://stackoverflow.com/users/12552748/hoang-nam"}, "edited": false, "score": 0, "creation_date": 1577778077, "post_id": 59540856, "comment_id": 105251338, "body": "I got your additional information. That&#39;s really useful and makes my program much better now"}], "tags": [], "owner": {"reputation": 2246, "user_id": 5108631, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/Bm0c3.jpg?s=128&g=1", "display_name": "Youssef13", "link": "https://stackoverflow.com/users/5108631/youssef13"}, "is_accepted": true, "score": 0, "last_activity_date": 1577777757, "last_edit_date": 1577777757, "creation_date": 1577776565, "answer_id": 59540856, "question_id": 59540637, "link": "https://stackoverflow.com/questions/59540637/is-there-anything-wrong-to-check-the-identity-of-the-matrix/59540856#59540856", "title": "Is there anything wrong to check the identity of the matrix?", "body": "<p><strong>ALWAYS</strong> enable compile warnings.</p>\n\n<p>Your code gives the following compile-warnings:</p>\n\n<pre><code>warning: suggest parentheses around assignment used as truth value [-Wparentheses]\nwarning: suggest explicit braces to avoid ambiguous \u2018else\u2019 [-Wparentheses]\n</code></pre>\n\n<p><strong>The first warning</strong> is because you use <code>=</code> which is assignment operator. The compiler I tried on suggested using parentheses which isn't actually what you need. But, at least, the compiler pointed you to a problem where you use assignment as a truth value.\nSurely, the compiler wouldn't know if you really want to know it as a truth value or you just used <code>=</code> by mistake instead of <code>==</code>. But <strong>you know</strong> that you meant comparison not assignment.</p>\n\n<p><strong>The second warning</strong> is on the following segment of the program:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>if(i==j)\n  if(a[i][j]!=1)\n    error=1;\n  else\n   if(a[i][j]!=0)\n    error=1;\n</code></pre>\n\n<p>You should add braces to be clear on which if the else statement belongs to. C compilers don't infer that by indentation. So, both of the following segments will be identical:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>if(i==j)\n    if(a[i][j]!=1)\n        error=1;\n    else\n        if(a[i][j]!=0)\n            error=1;\n</code></pre>\n\n<pre class=\"lang-c prettyprint-override\"><code>if(i==j)\n    if(a[i][j]!=1)\n        error=1;\nelse\n    if(a[i][j]!=0)\n        error=1;\n</code></pre>\n\n<p>You need to add curly braces to be clear. I also think you've a logical-error. Like the following:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>if(i==j)\n{\n    if(a[i][j]!=1)\n        error=1;\n}\nelse\n{\n    if(a[i][j]!=0)\n        error=1;\n}\n</code></pre>\n\n<p>See how more cleaner, readable, and free of compile-warnings is this ?</p>\n\n<hr>\n\n<p>There is another thing that caught my eyes, which is your usage of <code>isdigit</code>. Your usage of <code>isdigit</code> is totally wrong. This function takes an int which represents an ASCII code, and it returns a positive integer if thie ASCII code represents a digit; returns 0 otherwise. You actually don't pass an ASCII code (char variable). The variable is already of type <code>int</code> and that's it. You don't need to do any checks against it.</p>\n\n<p>Another thing that's not much important, is to improve performance a little bit but breaking the loops when <code>error</code> variable is set to 1.</p>\n\n<p>You don't need to continue the loop if you already known it's not identity matrix.</p>\n"}], "owner": {"reputation": 506, "user_id": 12552748, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oxFq6.jpg?s=128&g=1", "display_name": "Hoang Nam", "link": "https://stackoverflow.com/users/12552748/hoang-nam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 59540856, "answer_count": 2, "score": 0, "last_activity_date": 1577777757, "creation_date": 1577775007, "question_id": 59540637, "link": "https://stackoverflow.com/questions/59540637/is-there-anything-wrong-to-check-the-identity-of-the-matrix", "title": "Is there anything wrong to check the identity of the matrix?", "body": "<p>I've got a question to check if the input matrix is an identity matrix. I don't know why I can't get the proper check with my own program and I do not get any syntax error. I think I've got logical error but I can't figure it out.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;ctype.h&gt;\n#define MAX 100\n\nint main()\n{\n  int a[MAX][MAX];\n  int n, error=0, i=0, j=0;\n  do\n    {\n      printf(\"The size of the matrix you want to check: \\n\");\n      scanf(\"%d\", &amp;n);\n      if(n&lt;1)\n    printf(\"Your number is invalid\\n\");\n    }while(n&lt;1);\n  for(i=0; i&lt;n; i++)\n  {\n    for(j=0; j&lt;n; j++)\n      {\n    printf(\"a[%d][%d]= \", i+1, j+1);\n    do\n      {\n        scanf(\"%d\", &amp;a[i][j]);\n        if(isdigit(a[i][j]))\n          printf(\"Yo number is invalid\\n\");\n      }while(isdigit(a[i][j]));\n      }\n  }\n  for(i=0; i&lt;n; i++)\n    {\n    for(j=0; j&lt;n; j++)\n      {\n    if(i=j)\n      if(a[i][j]!=1)\n        error=1;\n      else\n       if(a[i][j]!=0)\n        error=1;\n      }\n    }\n  if(error==1)\n    printf(\"This matrix is not an identity\\n\");\n  else\n    printf(\"This matrix is is an indentity\\n\");\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "function-declaration"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 6, "creation_date": 1577773759, "post_id": 59540419, "comment_id": 105250159, "body": "Lots of UB with <code>unsigned int fun1()</code> assumed to be <code>int fun1()</code>.  Save time, enable all warnings."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1577797063, "post_id": 59540419, "comment_id": 105257744, "body": "Your C implementation uses 32-bit <code>int</code>. When <code>fun1</code> is not declared, it assumes the return type is <code>int</code>. When the actual <code>fun1</code> returns the <code>unsigned</code> value 3064476672, which is out of the <code>int</code> range, your C implementation is interpreting it as the corresponding <code>int</code> value 3064476672\u22122^32 = \u22121230490624. When it shifts this right 8 bits, it gets \u22121230490624/256 = \u22124806604. When you pass this <code>int</code> value to <code>printf</code> and ask it to print it with <code>%u</code>, it interprets it as the corresponding <code>unsigned</code> value, \u22124806604+2^32 = 4290160692\u2026"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1577797073, "post_id": 59540419, "comment_id": 105257748, "body": "\u2026 While this is effectively what happened in this instance, the behavior is not defined by the C standard and should not be relied on."}], "answers": [{"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1577797112, "post_id": 59540440, "comment_id": 105257758, "body": "It is factually untrue that, when the C standard does not define the behavior, anything can happen."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1577800352, "post_id": 59540440, "comment_id": 105258828, "body": "@EricPostpischil are you looking to start a philosophical discussion? I suppose it will not happen that pi changes to equal 3"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1577806120, "post_id": 59540440, "comment_id": 105260695, "body": "It is not philosophical. As my comment clearly states, it is a matter of fact. It is untrue that anything can happen. When the C standard does not define the behavior, a C implementation remains governed by its own specification, by the properties of the system it operates in, by the specifications of its hardware, by laws regulating consumer products where applicable, and by physics and logic. Furthermore, these things have significant practical consequences. One is that beginners can be scared that doing things wrong may break something. They should be reassured they can experiment freely\u2026"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1577806202, "post_id": 59540440, "comment_id": 105260721, "body": "\u2026 Another is that debugging would be impossible or difficult if the statement that anything can happen were true. In fact, the actual consequences of doing things that are not defined by the C standard often have recognizable symptoms or patterns that give clues to the problem, and these can be used to diagnose, find, and fix the problem. It does a disservice to students to tell them \u201canything can happen\u201d when we ought to be helping them learn more than just \u201cHere is the edge of the C standard; if you go further, you will fall off a cliff and cannot be helped.\u201d"}], "tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": false, "score": 2, "last_activity_date": 1577773797, "creation_date": 1577773797, "answer_id": 59540440, "question_id": 59540419, "link": "https://stackoverflow.com/questions/59540419/bitshifting-value-returned-by-implicitly-declared-function-producing-wrong-resul/59540440#59540440", "title": "Bitshifting value returned by implicitly declared function producing wrong result", "body": "<p>The program has undefined behaviour:</p>\n\n<ul>\n<li>In C99 and later, due to calling an undeclared function (this is a constraint violation in fact);</li>\n<li>In C89, due to calling an undeclared function whose definition is not compatible with <code>int f();</code> .</li>\n</ul>\n\n<p>Since the behaviour is undefined, anything can happen -- which includes unexpected output.</p>\n"}, {"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": true, "score": 1, "last_activity_date": 1577815872, "creation_date": 1577815872, "answer_id": 59547320, "question_id": 59540419, "link": "https://stackoverflow.com/questions/59540419/bitshifting-value-returned-by-implicitly-declared-function-producing-wrong-resul/59547320#59547320", "title": "Bitshifting value returned by implicitly declared function producing wrong result", "body": "<p>Your C implementation uses 32-bit <code>int</code>. When <code>fun1</code> is not declared, it assumes the return type is <code>int</code>. (This stems from C language history, when <code>int</code> was a default type. It is not called for by the current C standard.)</p>\n\n<p>When the actual <code>fun1</code> returns the <code>unsigned</code> value 3064476672, which is out of the <code>int</code> range, your C implementation is interpreting it as the corresponding <code>int</code> value 3064476672 \u2212 2<sup>32</sup> = \u22121230490624. (Because of this mismatch in types, the behavior is not defined by the C standard.)</p>\n\n<p>When your C implementation shifts this right 8 bits, it gets \u22121230490624 / 256 = \u22124806604. (Right shifts of negative values are implementation-defined. The arithmetic shift used by your compiler, which effectively replicates the sign bit of a two\u2019s complement representation when shifting right, is common.)</p>\n\n<p>When you pass this <code>int</code> value to <code>printf</code> and ask it to print it with <code>%u</code>, <code>printf</code> interprets the <code>int</code> value \u22124806604 as the corresponding unsigned value, \u22124806604 + 2<sup>32</sup> = 4290160692. (Due to the mismatch in types, with <code>%u</code> requiring <code>unsigned</code> while you are passing an <code>int</code>, the behavior is not defined by the C standard.)</p>\n\n<p>While this is effectively what happened in this instance, the behavior is not defined by the C standard and should not be relied on.</p>\n"}], "owner": {"reputation": 87, "user_id": 8070714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0afd79db577fbb232e96e6a48c81874?s=128&d=identicon&r=PG&f=1", "display_name": "Bpaul", "link": "https://stackoverflow.com/users/8070714/bpaul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 59547320, "answer_count": 2, "score": 0, "last_activity_date": 1577815872, "creation_date": 1577773642, "question_id": 59540419, "link": "https://stackoverflow.com/questions/59540419/bitshifting-value-returned-by-implicitly-declared-function-producing-wrong-resul", "title": "Bitshifting value returned by implicitly declared function producing wrong result", "body": "<p>There are <strong>two functions</strong> returning the <strong>same value</strong>. One of the function is <strong>not declared</strong>. Bit shifting both the values by the same constant produces different results. Cannot get a handle on what's is happening underneath. Can someone provide some light. Here is the code</p>\n\n<p><strong>main.c</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n//unsigned int fun1();\nunsigned int fun2()\n{\n        return 3064476672;\n}\n\nint main() {    \n        unsigned int b = fun1() &gt;&gt; 8;\n        printf(\"Bit shift result of function 1: %u, \\n\", b);\n\n        b = fun2() &gt;&gt; 8;\n        printf(\"Bit shift result of function 2: %u, \\n\", b);    \n}\n</code></pre>\n\n<p><strong>func.c</strong></p>\n\n<pre><code>unsigned int fun1()\n{\n        return 3064476672;\n}\n</code></pre>\n\n<p><strong>Result with <code>fun1</code> undeclared</strong><p>\nBit shift result of function 1: 4290160692,<p>\nBit shift result of function 2: 11970612,</p>\n\n<p><strong>Result with <code>fun1</code> declared</strong></p>\n\n<p>Bit shift result of function 1: 11970612,<p>\nBit shift result of function 2: 11970612,</p>\n"}, {"tags": ["javascript", "c", "python-3.x", "algorithm", "sorting"], "comments": [{"owner": {"reputation": 161, "user_id": 11033349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/562fa9cafe9d59e6db746da5f9789852?s=128&d=identicon&r=PG&f=1", "display_name": "T. Feix", "link": "https://stackoverflow.com/users/11033349/t-feix"}, "edited": false, "score": 0, "creation_date": 1577781833, "post_id": 59540324, "comment_id": 105252481, "body": "Do you want the sloution in python or in js?"}], "answers": [{"comments": [{"owner": {"reputation": 161, "user_id": 11033349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/562fa9cafe9d59e6db746da5f9789852?s=128&d=identicon&r=PG&f=1", "display_name": "T. Feix", "link": "https://stackoverflow.com/users/11033349/t-feix"}, "edited": false, "score": 0, "creation_date": 1577781790, "post_id": 59541616, "comment_id": 105252464, "body": "Hello, I&#39;ve got a question. Your answer is javascript, mine is python. Do you have an idea which language he wanted to have? I mean, the tags are both included."}, {"owner": {"reputation": 138, "user_id": 10911242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56d36edcc94a17d299b872b1e38afecd?s=128&d=identicon&r=PG&f=1", "display_name": "risbo", "link": "https://stackoverflow.com/users/10911242/risbo"}, "reply_to_user": {"reputation": 161, "user_id": 11033349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/562fa9cafe9d59e6db746da5f9789852?s=128&d=identicon&r=PG&f=1", "display_name": "T. Feix", "link": "https://stackoverflow.com/users/11033349/t-feix"}, "edited": false, "score": 0, "creation_date": 1577791735, "post_id": 59541616, "comment_id": 105255939, "body": "Hello, thanks for your comment. I had &quot;C&quot; in mind when wrote my answer  :), had no idea what language OP prefer.I am supposing that the answer is readable for everybody who use  tagged languages - #c, #java-script and #python.  Actually, my intention was to offer  &quot;algorithm-oriented&quot; answer that explains how to address elements of matrix  in desired way."}], "tags": [], "owner": {"reputation": 138, "user_id": 10911242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56d36edcc94a17d299b872b1e38afecd?s=128&d=identicon&r=PG&f=1", "display_name": "risbo", "link": "https://stackoverflow.com/users/10911242/risbo"}, "is_accepted": false, "score": 0, "last_activity_date": 1577781379, "creation_date": 1577781379, "answer_id": 59541616, "question_id": 59540324, "link": "https://stackoverflow.com/questions/59540324/occurance-of-a-word-in-a-matrix-present-in-left-to-right-downwards-or-diagonal/59541616#59541616", "title": "Occurance of a word in a matrix present in left to right, downwards or diagonal towards left(upward or downward)", "body": "<p>For diagonal search downward to left you should use loop similar to this,\nsupposing that it is related to rows, and j to columns, and \nboth indices start with zero in top-left corner:</p>\n\n<p>For diagonal search upward left rows should be decremented and columns incremented:</p>\n\n<pre><code>int i = n-1;\nint j = 0;\nwhile(i &gt;=0 )\n{\n     //access element x[i][j] and store to a resulting string\n   i--;\n   j++;   \n}\n// compare resulting string to predefined string\n</code></pre>\n\n<p>For diagonal search upward to left rows and columns should be decremented :</p>\n\n<pre><code>int i = n-1;\nint j = n-1;\nwhile(i &gt;= 0)\n{\n    //access element x[i][j] and store to a resulting string\n   i--;\n   j--;   \n}\n// compare resulting string to predefined string\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 161, "user_id": 11033349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/562fa9cafe9d59e6db746da5f9789852?s=128&d=identicon&r=PG&f=1", "display_name": "T. Feix", "link": "https://stackoverflow.com/users/11033349/t-feix"}, "is_accepted": false, "score": 0, "last_activity_date": 1577781561, "creation_date": 1577781561, "answer_id": 59541637, "question_id": 59540324, "link": "https://stackoverflow.com/questions/59540324/occurance-of-a-word-in-a-matrix-present-in-left-to-right-downwards-or-diagonal/59541637#59541637", "title": "Occurance of a word in a matrix present in left to right, downwards or diagonal towards left(upward or downward)", "body": "<p>First, you have to find all tuples that make up a combination so that the string can be read.</p>\n\n<p>According to my opinion, it's easier when you assign every position of the grid a specific number, so in a 3x3 matrix it would be:</p>\n\n<pre><code>A H G    # A is 1; H is 2; G is 3; next line: C is 4; B is 5...\nC B M\nF U S\n</code></pre>\n\n<p>So making a universal solution to determine that numbers would be sorting them in a list (I don't know your input format, so I assume it's a list):</p>\n\n<pre><code>m = ['A', 'H', 'G', 'C', 'B', 'M', 'F', 'U', 'S']\n</code></pre>\n\n<p>Next, to find all tuples, we need to look at the example above.\nIn the positions of the list thats, <code>[0, 1, 2], [3, 4, 5], [6, 7, 8], [0, 3, 6], [1, 4, 7], [2, 5, 8]</code>\nand finnaly <code>[0, 4, 8], [2, 4, 6]</code>.</p>\n\n<p>This is an algorithm to solve that:</p>\n\n<pre><code>def findTp(dimension):\n    l1 = []\n    l2 = []\n    lRes = []\n    lR = range(0, dimension**2)\n    for c in range(dimension**2):\n        l1.append(lR[c:c+dimension])\n    lRes.append(l1[::dimension])\n\n    lR = []\n    for i in range(dimension**2):\n        lR.append(i)\n    for i in range(dimension):\n        lRes.append(lR[i::dimension])\n\n    lR = []\n    for i in range(dimension**2):\n        lR.append(i)\n    lRes.append(lR[::dimension+1])\n    d = lR[dimension-1::dimension-1][:dimension]\n    lRes.append(d)\n\n    return lRes\n</code></pre>\n\n<p>Next, we will do some magic to extract the first list to <code>lRes</code>:</p>\n\n<pre><code>a = findTp(dimension)\nb = a[1:]\nc = a[0]\nfor i in c:\n    b.append(i)\n</code></pre>\n\n<p>Now, we have the result stored in <code>b</code>.</p>\n\n<p>Hope that helped.</p>\n"}], "owner": {"reputation": 15, "user_id": 8932908, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/ea41916e39a5bb79c41313ab6e64f9f5?s=128&d=identicon&r=PG", "display_name": "Amar Bal", "link": "https://stackoverflow.com/users/8932908/amar-bal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1577781561, "creation_date": 1577773004, "last_edit_date": 1577775303, "question_id": 59540324, "link": "https://stackoverflow.com/questions/59540324/occurance-of-a-word-in-a-matrix-present-in-left-to-right-downwards-or-diagonal", "title": "Occurance of a word in a matrix present in left to right, downwards or diagonal towards left(upward or downward)", "body": "<p>I have a input that defines the dimension of matrix, then \nI have a square matrix of that dimension containing random alphabets given as input, I have a input string i want to search the string in the matrix, i can search this string in <strong>left to right horizontally</strong>, <strong>vertically downwards</strong> or <strong>diagonally towards left</strong>(both upwards and downwards)</p>\n\n<p>say for a given matrix </p>\n\n<pre><code>n = 3\nA A K\nA S K\nA K K\n\n  00 01 02\n00 A  A  K \n10 A  S  K\n20 A  K  K\n</code></pre>\n\n<p>and for a given string ASK i have to search all the occurrence of 'ASK'</p>\n\n<p>The output will be <strong><code>4</code></strong> as there are four occurance of 'ASK'</p>\n\n<p>2 are simple one : 01,11,21 and second : 10,11,12</p>\n\n<p>But i cant understand how to match the string diagonally upwards or downwards towards left.\nthe 3rd : 02,11,20 and the 4th: 22,11,00</p>\n"}, {"tags": ["c", "loops", "char"], "comments": [{"owner": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "edited": false, "score": 4, "creation_date": 1577771254, "post_id": 59540055, "comment_id": 105249662, "body": "This does not go on for infinite time"}, {"owner": {"reputation": 103, "user_id": 5432742, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7NQmA9u7KxU/AAAAAAAAAAI/AAAAAAAAAKs/nR1LhvE7Ovg/photo.jpg?sz=128", "display_name": "Huzaifa", "link": "https://stackoverflow.com/users/5432742/huzaifa"}, "edited": false, "score": 1, "creation_date": 1577771303, "post_id": 59540055, "comment_id": 105249676, "body": "Yes. The output will be just 1234."}, {"owner": {"reputation": 2937, "user_id": 12488509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vr6bR.png?s=128&g=1", "display_name": "bhristov", "link": "https://stackoverflow.com/users/12488509/bhristov"}, "edited": false, "score": 0, "creation_date": 1577771513, "post_id": 59540055, "comment_id": 105249706, "body": "I am not able to reproduce it"}, {"owner": {"reputation": 79, "user_id": 12582632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/246d9a1483dbe98d9aad5a33ccacec16?s=128&d=identicon&r=PG&f=1", "display_name": "Sumit", "link": "https://stackoverflow.com/users/12582632/sumit"}, "edited": false, "score": 0, "creation_date": 1577773264, "post_id": 59540055, "comment_id": 105250049, "body": "Sorry! It&#39;s 255 not just 5."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1577773686, "post_id": 59540055, "comment_id": 105250134, "body": "lol @ the edit .."}, {"owner": {"reputation": 6137, "user_id": 3870547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66b3e98f2a1ec4b92a87aa6c76e095d8?s=128&d=identicon&r=PG&f=1", "display_name": "zmag", "link": "https://stackoverflow.com/users/3870547/zmag"}, "edited": false, "score": 1, "creation_date": 1577779667, "post_id": 59540055, "comment_id": 105251797, "body": "Edited code makes sense. <code>j</code> never reaches <code>255</code> because the type of variable <code>j</code> is <b>signed char</b>. if <code>j</code> was <code>127</code> and added <code>1</code> again, it would become <code>-128</code>."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "reply_to_user": {"reputation": 6137, "user_id": 3870547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66b3e98f2a1ec4b92a87aa6c76e095d8?s=128&d=identicon&r=PG&f=1", "display_name": "zmag", "link": "https://stackoverflow.com/users/3870547/zmag"}, "edited": false, "score": 0, "creation_date": 1577798954, "post_id": 59540055, "comment_id": 105258366, "body": "@zmag -- <code>char</code> values may be treated as either <code>signed char</code> or <code>unsigned char</code> values, depending upon the implementation, but <code>j</code> has type <code>char</code> in the above code, not <code>signed char</code>."}], "answers": [{"comments": [{"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1577793338, "post_id": 59543659, "comment_id": 105256466, "body": "<code>UCHAR_MAX</code> may be 255, in which case <code>j = j+1</code> will wrap around (if <code>char</code> is <code>unsigned</code>) and the <code>j &lt;= 255</code> condition of the <code>while</code> loop will always be true."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1577797915, "post_id": 59543659, "comment_id": 105258008, "body": "If <code>char</code> is signed and eight bits, then <code>j+1</code> eventually exceeds the <code>char</code> range and the result of <code>j = j+1;</code> is implementation-defined. It may signal, so the loop may terminate."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1577805462, "post_id": 59543659, "comment_id": 105260480, "body": "@EricPostpischil ; For sure, but I am yet to see an implementation where that would happen.  As a systems level language, C implementations do not normally rely on system features such as signalling.  And to not behave in this way would break a great deal of existing code - which compiler developers also tend to avoid.  That said, as I suggest to remove all doubt and ambiguity, don&#39;t use a <code>char</code>."}], "tags": [], "owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "is_accepted": false, "score": 1, "last_activity_date": 1577793594, "last_edit_date": 1577793594, "creation_date": 1577792422, "answer_id": 59543659, "question_id": 59540055, "link": "https://stackoverflow.com/questions/59540055/how-its-going-on-infinite-times/59543659#59543659", "title": "How it&#39;s going on infinite times?", "body": "<p>In C <code>char</code> may be signed or unsigned - that is implementation dependent. If <code>signed</code>, then the range (on most platforms) is -128 to +127 so always less than 255.</p>\n\n<p>Changing the type as follows:</p>\n\n<pre><code>unsigned char j=1;\n</code></pre>\n\n<p>will remove the ambiguity.  But even then <code>j &lt;= 255</code> will always be true on most common platforms because it can never be greater then 255.  In this case it will \"wrap\" to zero, so:</p>\n\n<pre><code>while(j != 0)\n</code></pre>\n\n<p>will work, or more simply and with no platform dependency issues, just change the type of <code>j</code> to <code>int</code>:</p>\n\n<pre><code>int j=1;\n</code></pre>\n\n<p>which makes much more sense.</p>\n"}], "owner": {"reputation": 79, "user_id": 12582632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/246d9a1483dbe98d9aad5a33ccacec16?s=128&d=identicon&r=PG&f=1", "display_name": "Sumit", "link": "https://stackoverflow.com/users/12582632/sumit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1577796252, "creation_date": 1577770948, "last_edit_date": 1577773244, "question_id": 59540055, "link": "https://stackoverflow.com/questions/59540055/how-its-going-on-infinite-times", "title": "How it&#39;s going on infinite times?", "body": "<p>I tried to understand the logic behind it but couldn't. What is happening behind the scene and how it's going on for infinite times?</p>\n\n<pre><code>    char j=1;\n    while(j &lt;= 255)\n    {\n        printf(\"%d\", j);\n        j = j+1;\n    }\n</code></pre>\n"}, {"tags": ["c", "arrays", "postfix-notation", "infix-notation"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1577768998, "post_id": 59539816, "comment_id": 105249255, "body": "Use a debugger to find out where the exception is triggered and then use it to trace and examine the code execution."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1577769012, "post_id": 59539816, "comment_id": 105249258, "body": "<code>printf(&quot;%s &quot;, *stk[0]);</code> -&gt; <code>printf(&quot;%s &quot;, stk[0]);</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1577769496, "post_id": 59539816, "comment_id": 105249345, "body": "<code>strcat(bwparens, pop1)</code> fails as <code>bwparens</code> is not a <i>string</i>."}], "answers": [{"tags": [], "owner": {"reputation": 2937, "user_id": 12488509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vr6bR.png?s=128&g=1", "display_name": "bhristov", "link": "https://stackoverflow.com/users/12488509/bhristov"}, "is_accepted": false, "score": 1, "last_activity_date": 1577771705, "creation_date": 1577771705, "answer_id": 59540135, "question_id": 59539816, "link": "https://stackoverflow.com/questions/59539816/converting-postfix-to-infix-notation-using-array-stack/59540135#59540135", "title": "Converting postfix to infix notation using array stack", "body": "<p>You are setting exp to be always equal to the null terminate and this results in an infinite loop:</p>\n\n<pre><code>while (*exp = '\\0')\n</code></pre>\n\n<p>I think that this may be one of the issues.</p>\n\n<p>I hope that this helps.</p>\n"}], "owner": {"reputation": 317, "user_id": 3672911, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8edbfe32b3b106619b93e079919e37e8?s=128&d=identicon&r=PG&f=1", "display_name": "Larynx", "link": "https://stackoverflow.com/users/3672911/larynx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1577771705, "creation_date": 1577768768, "last_edit_date": 1577769075, "question_id": 59539816, "link": "https://stackoverflow.com/questions/59539816/converting-postfix-to-infix-notation-using-array-stack", "title": "Converting postfix to infix notation using array stack", "body": "<p>I'm trying to write a program for converting postfix to infix notation, but it is not easy for me.  </p>\n\n<pre><code>pfix  stack          explanation (@ is space)  \n---------------------------------------------  \n3     3  \n4     3 4  \n5     3 4 5  \n+     3 (4@+@5)      if exp[i] is op, do some action  \n*     (3@*@(4@+@5))  if exp[i] is op, do some action  \n</code></pre>\n\n<p>Some action means that it pops twice from the stack, insert \"space+operator+space\", and wrap it with parenthesis. Then push it into stack.</p>\n\n<p>But when I execute this program, it does not work at all.   </p>\n\n<p><strong>cygwin_exception::open_stackdumpfile: Dumping stack trace to post2in.exe.stackdump</strong></p>\n\n<p>How can I fix this?  </p>\n\n<p>Thanks.   </p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;ctype.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define M 20\n#define N 20\n\nchar stk[M][N];  // array of string\nint top = -1;\n\nvoid push(char (*)[N], char *);\nchar *pop(char (*)[N]);\nvoid getexp(char *);\nint isop(char);\n\nint main() {\n  char *exp = \"abc+*\";\n  getexp(exp);\n  printf(\"%s \", *stk[0]);\n  return 0;\n}\n\nvoid getexp(char *exp) {\n  while (*exp = '\\0') {\n\n    /* if space or tab, skip */\n    if (*exp == ' ' || *exp == '\\t') exp++;\n\n    /* if digit or point, get whole number and store it into array stack */\n    else if (isdigit(*exp) || *exp == '.') {\n      char digits[20];\n      int i = 0;\n      while (*exp != ' ' &amp;&amp; *exp != '\\0') {\n        digits[i++] = *exp++;\n      }\n      digits[i] = '\\0';\n      push(stk, digits);\n    }\n\n    /* if operator, pop twice and wrap them with parenthesis with operator */\n    else if (isop(*exp)) {\n      char bwparens[20], pop1[20], pop2[20], temp[4];\n      strcpy(pop2, pop(stk));\n      strcpy(pop1, pop(stk));\n      temp[0] = ' ';\n      temp[1] = *exp;\n      temp[2] = ' ';\n      temp[3] = '\\0';\n      bwparens[0] = '(';\n      strcat(strcat(strcat(bwparens, pop1), temp), \")\\0\");\n      push(stk, bwparens);\n      exp++;\n    }\n  }\n}\n\nint isop(char chr) {\n  return (chr == '+' || chr == '-' || chr == '*' || chr == '/' || chr == '%');\n}\n\nvoid push(char stk[M][N], char *exp) {\n  if (top == -1) {\n    printf(\"Stack is full\");\n    exit(EXIT_FAILURE);\n  } else\n    strcpy(stk[++top], exp);\n}\n\nchar *pop(char stk[M][N]) {\n  if (top == -1) {\n    printf(\"Stack is empty.\\n\");\n    exit(EXIT_FAILURE);\n  } else {\n    return stk[top--];\n  }\n}\n</code></pre>\n"}, {"tags": ["c", "file"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1577767977, "post_id": 59539694, "comment_id": 105249069, "body": "So what is the problem if the write doesn&#39;t fail? Be aware that UBIFS has compression so the write can succeed even if it appears that the target directory does not have enough space."}, {"owner": {"reputation": 11, "user_id": 12525407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fde1ad940becd75b660b71c28a81a95b?s=128&d=identicon&r=PG&f=1", "display_name": "gauri", "link": "https://stackoverflow.com/users/12525407/gauri"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1577770443, "post_id": 59539694, "comment_id": 105249489, "body": "if target dir not have enough space then I want to return -1. It show write action false so I will take necessary action on that"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1577770611, "post_id": 59539694, "comment_id": 105249518, "body": "But it didn&#39;t fail. That&#39;s why it didn&#39;t return an error. It seems you are expecting it to fail when it isn&#39;t going to. It is not obvious from command line how much more can be written to a ubifs file system so that may be leading you to an incorrect conclusion that the write should fail."}], "answers": [{"comments": [{"owner": {"reputation": 523, "user_id": 2232308, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b1d346912e7da136d247b3d88f7f52f7?s=128&d=identicon&r=PG", "display_name": "mirage", "link": "https://stackoverflow.com/users/2232308/mirage"}, "reply_to_user": {"reputation": 11, "user_id": 12525407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fde1ad940becd75b660b71c28a81a95b?s=128&d=identicon&r=PG&f=1", "display_name": "gauri", "link": "https://stackoverflow.com/users/12525407/gauri"}, "edited": false, "score": 0, "creation_date": 1577787858, "post_id": 59540845, "comment_id": 105254527, "body": "From the manual: Calling fsync() does not necessarily ensure that the entry in the        directory containing the file has also reached disk.  For that an        explicit fsync() on a file descriptor for the directory is also        needed"}, {"owner": {"reputation": 11, "user_id": 12525407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fde1ad940becd75b660b71c28a81a95b?s=128&d=identicon&r=PG&f=1", "display_name": "gauri", "link": "https://stackoverflow.com/users/12525407/gauri"}, "edited": false, "score": 0, "creation_date": 1577788243, "post_id": 59540845, "comment_id": 105254690, "body": "int destFileNo = fileno(destination);     int statusFlush = fflush(destination);     printf(&quot;fflush status; :: %d\\n&quot;, statusFlush);     int statusvalue = fsync(destFileNo);     printf(stderr,&quot;\\n statusvalue :: %d\\n&quot;, statusvalue); I have sed this one"}, {"owner": {"reputation": 523, "user_id": 2232308, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b1d346912e7da136d247b3d88f7f52f7?s=128&d=identicon&r=PG", "display_name": "mirage", "link": "https://stackoverflow.com/users/2232308/mirage"}, "reply_to_user": {"reputation": 11, "user_id": 12525407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fde1ad940becd75b660b71c28a81a95b?s=128&d=identicon&r=PG&f=1", "display_name": "gauri", "link": "https://stackoverflow.com/users/12525407/gauri"}, "edited": false, "score": 0, "creation_date": 1577794354, "post_id": 59540845, "comment_id": 105256802, "body": "@gauri in that case the write happened as expected. Why do you think the sync is failing ?"}], "tags": [], "owner": {"reputation": 523, "user_id": 2232308, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b1d346912e7da136d247b3d88f7f52f7?s=128&d=identicon&r=PG", "display_name": "mirage", "link": "https://stackoverflow.com/users/2232308/mirage"}, "is_accepted": false, "score": 0, "last_activity_date": 1577776515, "creation_date": 1577776515, "answer_id": 59540845, "question_id": 59539694, "link": "https://stackoverflow.com/questions/59539694/copy-file-from-source-to-destination-in-ubi-file-system/59540845#59540845", "title": "copy file from source to destination in UBI file system", "body": "<p>You can use fsync to verify the write-back status.</p>\n\n<p>To quote from the following source: </p>\n\n<blockquote>\n  <p>transfers (\"flushes\") all modified in-core data of ... the file\n  referred to by the file descriptor fd to the disk device (or other\n  permanent storage device) so that all changed information can be\n  retrieved even if the system crashes or is rebooted.  This includes\n  writing through or flushing a disk cache if present</p>\n</blockquote>\n\n<p><a href=\"http://man7.org/linux/man-pages/man2/fdatasync.2.html\" rel=\"nofollow noreferrer\">http://man7.org/linux/man-pages/man2/fdatasync.2.html</a></p>\n"}], "owner": {"reputation": 11, "user_id": 12525407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fde1ad940becd75b660b71c28a81a95b?s=128&d=identicon&r=PG&f=1", "display_name": "gauri", "link": "https://stackoverflow.com/users/12525407/gauri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1577776515, "creation_date": 1577767479, "last_edit_date": 1577776010, "question_id": 59539694, "link": "https://stackoverflow.com/questions/59539694/copy-file-from-source-to-destination-in-ubi-file-system", "title": "copy file from source to destination in UBI file system", "body": "<p>I want to copy file from source to destination. But in case of destination folder size is small compare to source file. It does not fail write, always return success and this behaviour I have observed in UBI file system only.</p>\n\n<pre><code>while ((size = fread(buffer, 1, BUFSIZ, source)) &gt; 0)\n{\n    size_t size_2 = fwrite(buffer, 1, size, destination);\n    if (size_2 != size)\n    {\n        retval = -1;\n        break;\n    }\n}\n</code></pre>\n\n<p>In UBIFS supports write-back, In which file changes are cached and go to the flash later. Any one know how to verify write status for this.</p>\n"}, {"tags": ["c++", "c", "mesa"], "comments": [{"owner": {"reputation": 192, "user_id": 6943262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e1d451b2abb790c1cf0a1f80a301dfa?s=128&d=identicon&r=PG&f=1", "display_name": "paxbun", "link": "https://stackoverflow.com/users/6943262/paxbun"}, "edited": false, "score": 0, "creation_date": 1577767276, "post_id": 59539604, "comment_id": 105248935, "body": "I&#39;m using WSL on windows, and got the same error in different library when using CRLF instead of LF. Maybe this will help."}, {"owner": {"reputation": 39426, "user_id": 812183, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/9639bd6ee5dfd07ff05fb848e67e9657?s=128&d=identicon&r=PG", "display_name": "Anthony Sottile", "link": "https://stackoverflow.com/users/812183/anthony-sottile"}, "edited": false, "score": 10, "creation_date": 1577767443, "post_id": 59539604, "comment_id": 105248955, "body": "this is a bit out there, but this looks like what happens when you <code>git clone</code> a repository on a platform which does not have symlink support (such as windows)"}, {"owner": {"reputation": 3641, "user_id": 4400820, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/-zJIsBHmva1w/AAAAAAAAAAI/AAAAAAAAAFA/VyUtonEauos/photo.jpg?sz=128", "display_name": "D. Ben Knoble", "link": "https://stackoverflow.com/users/4400820/d-ben-knoble"}, "reply_to_user": {"reputation": 39426, "user_id": 812183, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/9639bd6ee5dfd07ff05fb848e67e9657?s=128&d=identicon&r=PG", "display_name": "Anthony Sottile", "link": "https://stackoverflow.com/users/812183/anthony-sottile"}, "edited": false, "score": 1, "creation_date": 1577767645, "post_id": 59539604, "comment_id": 105248997, "body": "@AnthonySottile my thoughts exactly. Regardless, it\u2019s almost certainly intended to be a symlink."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 3, "creation_date": 1577768170, "post_id": 59539604, "comment_id": 105249104, "body": "<a href=\"https://stackoverflow.com/a/42137273/560648\">stackoverflow.com/a/42137273/560648</a>"}, {"owner": {"reputation": 69, "user_id": 10831671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/388aaa89e82d554017da7398ec07e73b?s=128&d=identicon&r=PG&f=1", "display_name": "Y.L", "link": "https://stackoverflow.com/users/10831671/y-l"}, "reply_to_user": {"reputation": 39426, "user_id": 812183, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/9639bd6ee5dfd07ff05fb848e67e9657?s=128&d=identicon&r=PG", "display_name": "Anthony Sottile", "link": "https://stackoverflow.com/users/812183/anthony-sottile"}, "edited": false, "score": 0, "creation_date": 1577773310, "post_id": 59539604, "comment_id": 105250057, "body": "@AnthonySottile Thanks! I think this is the root cause. I actually have cloned the repo into windows and update to my own git server because some wired network issue happend."}], "answers": [{"tags": [], "owner": {"reputation": 69, "user_id": 10831671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/388aaa89e82d554017da7398ec07e73b?s=128&d=identicon&r=PG&f=1", "display_name": "Y.L", "link": "https://stackoverflow.com/users/10831671/y-l"}, "is_accepted": false, "score": 1, "last_activity_date": 1577783223, "creation_date": 1577783223, "answer_id": 59541912, "question_id": 59539604, "link": "https://stackoverflow.com/questions/59539604/why-this-c-file-just-have-one-line-xx-xx-c/59541912#59541912", "title": "Why this .c file just have one line &quot;../xx/xx.c&quot;?", "body": "<p>As AnthonySottile's comment said, this error is about the symbol link support. I have cloned this repo to windows before and upload to my own git server. And the error occured when I trying to build the source code from my git.</p>\n\n<p>I try to clone the repo from mesa3d.org, and the issue resolved.</p>\n\n<p>Thanks for the help, guys.</p>\n"}], "owner": {"reputation": 69, "user_id": 10831671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/388aaa89e82d554017da7398ec07e73b?s=128&d=identicon&r=PG&f=1", "display_name": "Y.L", "link": "https://stackoverflow.com/users/10831671/y-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 253, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1577783223, "creation_date": 1577766606, "question_id": 59539604, "link": "https://stackoverflow.com/questions/59539604/why-this-c-file-just-have-one-line-xx-xx-c", "title": "Why this .c file just have one line &quot;../xx/xx.c&quot;?", "body": "<p>I want to build mesa3d source code for some reason. I follow the guide on <a href=\"https://mesa3d.org/install.html\" rel=\"nofollow noreferrer\">https://mesa3d.org/install.html</a> and the build environment is fedora31 and gcc9.2, but there are some build error when I trying to build the code with running <code>ninja install</code>.</p>\n\n<blockquote>\n  <p>FAILED: src/mesa/drivers/dri/r200/58cd8d4@@r200@sta/radeon_buffer_objects.c.o \n  cc -Isrc/mesa/drivers/dri/r200/58cd8d4@@r200@sta -Isrc/mesa/drivers/dri/r200 -I../src/mesa/drivers/dri/r200 -Iinclude -I../include -Isrc -I../src -Isrc/mapi -I../src/mapi -Isrc/mesa -I../src/mesa -I../src/gallium/include -Isrc/gallium/auxiliary -I../src/gallium/auxiliary -Isrc/mesa/drivers/dri/common -I../src/mesa/drivers/dri/common -Isrc/util -I../src/util -I../src/mesa/drivers/dri/r200/server -Isrc/util/xmlpool -I/usr/include/libdrm -fdiagnostics-color=always -pipe -D_FILE_OFFSET_BITS=64 -Wall -Winvalid-pch -std=c99 -O2 -g -D__STDC_CONSTANT_MACROS -D__STDC_FORMAT_MACROS -D__STDC_LIMIT_MACROS '-DPACKAGE_VERSION=\"20.0.0-devel\"' '-DPACKAGE_BUGREPORT=\"https://gitlab.freedesktop.org/mesa/mesa/issues\"' -DUSE_ELF_TLS -DHAVE_ST_VDPAU -DENABLE_ST_OMX_BELLAGIO=0 -DENABLE_ST_OMX_TIZONIA=0 -DHAVE_X11_PLATFORM -DGLX_INDIRECT_RENDERING -DGLX_DIRECT_RENDERING -DGLX_USE_DRM -DHAVE_DRM_PLATFORM -DHAVE_SURFACELESS_PLATFORM -DENABLE_SHADER_CACHE -DHAVE___BUILTIN_BSWAP32 -DHAVE___BUILTIN_BSWAP64 -DHAVE___BUILTIN_CLZ -DHAVE___BUILTIN_CLZLL -DHAVE___BUILTIN_CTZ -DHAVE___BUILTIN_EXPECT -DHAVE___BUILTIN_FFS -DHAVE___BUILTIN_FFSLL -DHAVE___BUILTIN_POPCOUNT -DHAVE___BUILTIN_POPCOUNTLL -DHAVE___BUILTIN_UNREACHABLE -DHAVE_FUNC_ATTRIBUTE_CONST -DHAVE_FUNC_ATTRIBUTE_FLATTEN -DHAVE_FUNC_ATTRIBUTE_MALLOC -DHAVE_FUNC_ATTRIBUTE_PURE -DHAVE_FUNC_ATTRIBUTE_UNUSED -DHAVE_FUNC_ATTRIBUTE_WARN_UNUSED_RESULT -DHAVE_FUNC_ATTRIBUTE_WEAK -DHAVE_FUNC_ATTRIBUTE_FORMAT -DHAVE_FUNC_ATTRIBUTE_PACKED -DHAVE_FUNC_ATTRIBUTE_RETURNS_NONNULL -DHAVE_FUNC_ATTRIBUTE_VISIBILITY -DHAVE_FUNC_ATTRIBUTE_ALIAS -DHAVE_FUNC_ATTRIBUTE_NORETURN -DHAVE_UINT128 -D_GNU_SOURCE -DUSE_SSE41 -DUSE_GCC_ATOMIC_BUILTINS -DUSE_X86_64_ASM -DMAJOR_IN_SYSMACROS -DHAVE_SYS_SYSCTL_H -DHAVE_LINUX_FUTEX_H -DHAVE_ENDIAN_H -DHAVE_DLFCN_H -DHAVE_EXECINFO_H -DHAVE_SYS_SHM_H -DHAVE_CET_H -DHAVE_STRTOF -DHAVE_MKOSTEMP -DHAVE_TIMESPEC_GET -DHAVE_MEMFD_CREATE -DHAVE_RANDOM_R -DHAVE_FLOCK -DHAVE_STRTOK_R -DHAVE_PROGRAM_INVOCATION_NAME -DHAVE_POSIX_MEMALIGN -DHAVE_STRTOD_L -DHAVE_DLADDR -DHAVE_DL_ITERATE_PHDR -DHAVE_ZLIB -DHAVE_PTHREAD -DHAVE_PTHREAD_SETAFFINITY -DHAVE_LIBDRM -DLLVM_AVAILABLE '-DMESA_LLVM_VERSION_STRING=\"9.0.0\"' -DHAVE_VALGRIND -DHAVE_WAYLAND_PLATFORM -DWL_HIDE_DEPRECATED -DHAVE_DRI3 -DHAVE_DRI3_MODIFIERS -Werror=implicit-function-declaration -Werror=missing-prototypes -Werror=return-type -Werror=empty-body -Werror=incompatible-pointer-types -Wno-missing-field-initializers -Wno-format-truncation -fno-math-errno -fno-trapping-math -Werror=format -Wformat-security -fPIC -fvisibility=hidden -DRADEON_R200 -MD -MQ 'src/mesa/drivers/dri/r200/58cd8d4@@r200@sta/radeon_buffer_objects.c.o' -MF 'src/mesa/drivers/dri/r200/58cd8d4@@r200@sta/radeon_buffer_objects.c.o.d' -o 'src/mesa/drivers/dri/r200/58cd8d4@@r200@sta/radeon_buffer_objects.c.o' -c ../src/mesa/drivers/dri/r200/radeon_buffer_objects.c\n  ../src/mesa/drivers/dri/r200/radeon_buffer_objects.c:1:1: error: expected identifier or '(' before '.' token</p>\n</blockquote>\n\n<pre><code>1 | ../radeon/radeon_buffer_objects.c\n  | ^\n</code></pre>\n\n<p>Then I check the radeon_buffer_objects.c, and this file just have one file path in it.</p>\n\n<blockquote>\n  <p>../radeon/radeon_buffer_objects.c</p>\n</blockquote>\n\n<p>I'm not very familier with gcc and clang. What is that mean? And how can I resolve this build error?</p>\n"}, {"tags": ["c", "data-structures", "adt", "abstract-data-type"], "comments": [{"owner": {"reputation": 9367, "user_id": 4454124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c094d8979fb41b789a7c7f21d9329359?s=128&d=identicon&r=PG&f=1", "display_name": "mnistic", "link": "https://stackoverflow.com/users/4454124/mnistic"}, "edited": false, "score": 0, "creation_date": 1577765548, "post_id": 59539453, "comment_id": 105248637, "body": "You should provide relevant parts of the .h file (ones that define <code>List</code>, <code>ListElement</code>, <code>CopyListElement</code> and <code>FreeListElement</code>)"}, {"owner": {"reputation": 69, "user_id": 9343512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c559622f64dc7d9b74732cefdaa47f1a?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/9343512/tom"}, "reply_to_user": {"reputation": 9367, "user_id": 4454124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c094d8979fb41b789a7c7f21d9329359?s=128&d=identicon&r=PG&f=1", "display_name": "mnistic", "link": "https://stackoverflow.com/users/4454124/mnistic"}, "edited": false, "score": 0, "creation_date": 1577765792, "post_id": 59539453, "comment_id": 105248663, "body": "@mnistic updated"}, {"owner": {"reputation": 9367, "user_id": 4454124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c094d8979fb41b789a7c7f21d9329359?s=128&d=identicon&r=PG&f=1", "display_name": "mnistic", "link": "https://stackoverflow.com/users/4454124/mnistic"}, "edited": false, "score": 2, "creation_date": 1577766530, "post_id": 59539453, "comment_id": 105248790, "body": "The code looks OK to me... Hard to say much more without debugging this library."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1577770328, "post_id": 59539453, "comment_id": 105249472, "body": "It is very much impossible to tell what&#39;s wrong with your binary library."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1577773953, "post_id": 59539453, "comment_id": 105250218, "body": "Aside: <code>sizeof(char)*strlen(elem) + 1</code> is not conceptually correct.  Better as <code>sizeof(char)*(strlen(elem) + 1)</code>.  Best as <code>strlen(elem) + 1</code> since <code>sizeof(char)</code> is 1."}], "owner": {"reputation": 69, "user_id": 9343512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c559622f64dc7d9b74732cefdaa47f1a?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/9343512/tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1577765780, "creation_date": 1577765248, "last_edit_date": 1577765780, "question_id": 59539453, "link": "https://stackoverflow.com/questions/59539453/cannot-create-an-adt", "title": "Cannot create an ADT", "body": "<p>I have been given a task to work with an ADT, I have been given it's .h file and a precompiled library of some sort that is supposed to be the implementation, however I cannot create a new instance of said ADT as the creator function always returns NULL.</p>\n\n<pre><code>/**\n* Allocates a new List.\n*\n* Creates a new empty list. This function receives the functions which will be\n* used for copying elements into the list and freeing them when needed.\n* For example, in order to create a list of strings one need to define these\n* two functions:\n* @code\n* ListElement copyString(ListElement str);\n* void freeString(ListElement str);\n* @endcode\n* And then create a list as follows:\n* @code\n* List listOfStrings = listCreate(copyString, freeString);\n* @endcode\n*\n* @param copyElement Function pointer to be used for copying elements into\n* the list or when copying the list.\n* @param freeElement Function pointer to be used for removing elements from\n* the list.\n* @return\n*   NULL - if one of the parameters is NULL or allocations failed.\n*   A new List in case of success.\n*/\nList listCreate(CopyListElement copyElement, FreeListElement freeElement);\n</code></pre>\n\n<p>Here are CopyListElement and FreeElement: (I'm trying to use the ADT with just a string as is required)</p>\n\n<pre><code>istElement listElementCopy(ListElement elem)\n{\n    char *cpy = malloc(sizeof(char)*strlen(elem) + 1);\n\n    for(int i = 0; i &lt; strlen(elem); i++)\n        cpy[i] = ((char *)elem)[i];\n\n    cpy[strlen(elem)] = '\\0';\n\n    return cpy;\n}\n\nvoid listElementFree(ListElement elem)\n{\n    free(elem);\n}\n</code></pre>\n\n<p>Here is the test I ran to determine that the ADT was returning NULL:</p>\n\n<pre><code>int main()\n{\n    List result = listCreate(listElementCopy, listElementFree);\n    if(result == NULL)\n        printf(\"Fail\\n\");\n}\n</code></pre>\n\n<p>more relevant info:</p>\n\n<pre><code>/** Type for defining the list */\ntypedef struct List_t *List;\n\n/** Type used for returning error codes from list functions */\ntypedef enum ListResult_t {\n    LIST_SUCCESS,\n    LIST_NULL_ARGUMENT,\n    LIST_OUT_OF_MEMORY,\n    LIST_INVALID_CURRENT,\n} ListResult;\n\n/** Element data type for list container */\ntypedef void* ListElement;\n\n/**\n* Type of function for copying an element of the list.\n*\n* Such a function should be supplied to a list to allow it to copy its\n* elements. The function supplied should be able to dynamically copy the\n* object and return a pointer to a newly allocated object.\n* If this function fails for some reason, it should return NULL.\n*\n* For example, here is a proper function for copying a string that can be\n* used for storing strings in a list:\n* @code\n* ListElement copyString(ListElement str) {\n*   assert(str);\n*   char* copy = malloc(strlen(str) + 1);\n*   return copy ? strcpy(copy, str) : NULL;\n* }\n* @endcode\n*/\ntypedef ListElement(*CopyListElement)(ListElement);\n\n/** Type of function for deallocating an element of the list */\ntypedef void(*FreeListElement)(ListElement);\n</code></pre>\n"}, {"tags": ["c", "file"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1577760338, "post_id": 59538971, "comment_id": 105247908, "body": "<code>gets(s);</code> -&gt; <code>gets(s[i]);</code> (and presumably a transcribe typo: <code>x++</code> -&gt; <code>i++</code>)"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1577760511, "post_id": 59538971, "comment_id": 105247939, "body": "Note that you don&#39;t actually need <code>s</code> to be a 2D array since you are only reading/writing one line at a time."}, {"owner": {"reputation": 11, "user_id": 12404857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5a8f0413367f5c37f9d964ad03fa6a1?s=128&d=identicon&r=PG&f=1", "display_name": "mikep199", "link": "https://stackoverflow.com/users/12404857/mikep199"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1577762051, "post_id": 59538971, "comment_id": 105248138, "body": "Thank you for your answer.I changed it from gets(s) to gets(s[i]) as you suggested and it worked. How would that work without a 2d array though?? The cycle just stops at the first iteration when the char array is 1d."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1577762215, "post_id": 59538971, "comment_id": 105248164, "body": "Change <code>s</code> to be <code>char s[100];</code> and then just use <code>s</code> in all the <code>gets</code>, <code>fprintf</code>, <code>fgets</code> and <code>printf</code> calls. You don&#39;t actually need the previous line&#39;s contents so each iteration can just over-write the same <code>s</code> buffer."}, {"owner": {"reputation": 952, "user_id": 12521158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8e745b4953a3ecbe3a1f7147089a7a7?s=128&d=identicon&r=PG&f=1", "display_name": "kopecs", "link": "https://stackoverflow.com/users/12521158/kopecs"}, "edited": false, "score": 0, "creation_date": 1577762364, "post_id": 59538971, "comment_id": 105248191, "body": "You also don&#39;t need to redeclare <code>i</code> later in your program (after you open the file), in fact, you already set it to be 0 in the for loop immediately afterwards anyway, so you can just totally remove that line; a better solution might be to make a local <code>i</code> in each loop (i.e. have <code>for(int i=0; i &lt; 10; i++)</code>) and refactor your while loop to a for loop."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1577762532, "post_id": 59538971, "comment_id": 105248226, "body": "Another problem is the location of <code>if(fpointer==NULL)</code>. You need to do that check <b>before</b> using <code>fpointer</code>"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1577767988, "post_id": 59538971, "comment_id": 105249071, "body": "Copy/paste only code that you have tested.  Your source does not compile."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1577790999, "post_id": 59538971, "comment_id": 105255708, "body": "If your compiler lets you use <code>gets</code>, you need to throw it away and get a better compiler. If your book tells you to use <code>gets</code>, you need to throw it away and get a better book. If your professor tells you to use <code>gets</code>, he should be fired on the spot."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1577791303, "post_id": 59538971, "comment_id": 105255800, "body": "<a href=\"https://stackoverflow.com/questions/1694036/why-is-the-gets-function-so-dangerous-that-it-should-not-be-used\">About gets</a>."}], "answers": [{"comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1577798671, "post_id": 59542999, "comment_id": 105258262, "body": "It&#39;s better now, but you don&#39;t really need an array at all, you only use one line at a time. Also it&#39;s essential to check every call to a library function that may fail."}], "tags": [], "owner": {"reputation": 1132, "user_id": 10048703, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g4Etl.png?s=128&g=1", "display_name": "davidm", "link": "https://stackoverflow.com/users/10048703/davidm"}, "is_accepted": false, "score": 1, "last_activity_date": 1577810811, "last_edit_date": 1577810811, "creation_date": 1577788961, "answer_id": 59542999, "question_id": 59538971, "link": "https://stackoverflow.com/questions/59538971/why-does-my-code-create-the-text-file-ok-but-only-reads-the-first-string-of-my/59542999#59542999", "title": "Why does my code create the text file OK, but only reads the first string of my text?", "body": "<p>The following should work. You have a typo <code>x++</code> and I changed the input method to <code>fgets</code>. Also for convenience I added the macros <code>NUM_OF_SEN</code> and <code>LENGHT</code>. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#define NUM_OF_SEN 2\n#define LENGHT 100\n\nint main(){\n    char s[LENGHT];\n    FILE *fpointer;\n\n    fpointer=fopen(\"file.pp\", \"w+\");\n\n    if(fpointer==NULL){\n        fprintf(stderr,\"mistake\");\n        EXIT_FAILURE;\n    }\n\n    for(int i=0; i &lt; NUM_OF_SEN; i++){ \n        printf(\"Enter a sentence:\\n\");  \n        fgets(s, LENGHT, stdin); \n        fprintf(fpointer,\"%s\", s); \n    }\n\n    rewind(fpointer);\n    for(int i=0;i&lt;NUM_OF_SEN;i++){   \n        fgets(s, LENGHT, fpointer);\n        printf(\"The %d sentence is: %s \\n\",i+1,s);    \n    } \n\n    fclose(fpointer);\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28522, "user_id": 459943, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1820b3c909a14f78a3b8c5aa46f9759f?s=128&d=identicon&r=PG", "display_name": "Lion King", "link": "https://stackoverflow.com/users/459943/lion-king"}, "is_accepted": false, "score": 0, "last_activity_date": 1577803713, "last_edit_date": 1577803713, "creation_date": 1577802196, "answer_id": 59545272, "question_id": 59538971, "link": "https://stackoverflow.com/questions/59538971/why-does-my-code-create-the-text-file-ok-but-only-reads-the-first-string-of-my/59545272#59545272", "title": "Why does my code create the text file OK, but only reads the first string of my text?", "body": "<p>In short, the following code does what you want. Don't forget each line is explained by a comment.</p>\n\n<pre><code>#define LINES 3\n#define CHARS 100\n\nint main(int argc, char** argv) {\n\n    // A buffer variable for Writing data to the file\n    char writeBuff[CHARS];\n    // A buffer variable for reading data from the file\n    char readBuff[CHARS];\n    // File handler\n    FILE *fpointer = NULL;\n    // i, counter are just counters\n    int i = 0, counter = 0;\n\n    // Open the file to write/append\n    fpointer = fopen(\"file.txt\", \"a\");\n    // a Loop to write several sentence\n    for (i = 0; i &lt; LINES; i++) {\n        printf(\"Enter a sentence: \");\n        // Put the stdin content into the \"writeBuff\" variable\n        fgets(writeBuff, CHARS, stdin);\n        // Put the \"writeBuff\" variable into the file\n        fprintf(fpointer, \"%s\", writeBuff);\n    }\n    // Close the file that will be opened later for reading \n    // (To make the recently added sentences possible for reading)\n    fclose(fpointer);\n\n    // Open the file again for reading\n    fpointer = fopen(\"file.txt\", \"r\");\n    // A loop to read each line in the file\n    while(fgets(readBuff, CHARS, fpointer) != NULL){\n        // Print the file content line by line \n        printf(\"The %d sentence is: %s\", counter+1, readBuff);\n        // Just a counter\n        counter++;\n    }\n    // Finally, close the file forever\n    fclose(fpointer);\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 12404857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5a8f0413367f5c37f9d964ad03fa6a1?s=128&d=identicon&r=PG&f=1", "display_name": "mikep199", "link": "https://stackoverflow.com/users/12404857/mikep199"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1577810811, "creation_date": 1577759790, "last_edit_date": 1577760248, "question_id": 59538971, "link": "https://stackoverflow.com/questions/59538971/why-does-my-code-create-the-text-file-ok-but-only-reads-the-first-string-of-my", "title": "Why does my code create the text file OK, but only reads the first string of my text?", "body": "<p>I am currently trying to create a file with a text and then read the file and print it on my screen.My current code is this:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>int main(){\n    char s[10][100];\n\n    FILE *fpointer;\n    fpointer=fopen(\"file.pp\",\"w\");\n    int i=0\n    while(i&lt;10){ \n        printf(\"enter a sentence:\\n\");  \n        gets(s); \n        fprintf(fpointer,\"%s\\n\", s); \n        x++;\n    }\n\n    fpointer=fopen(\"file.pp\",\"r\");\n    int i=0;\n    for(i=0;i&lt;10;i++){\n\n        fgets(s[i],100,fpointer);\n\n        printf(\"the %d sentence is: %s \\n\",i+1,s[i]);    \n    }\n    if(fpointer==NULL){\n        fprintf(stderr,\"mistake\");\n        EXIT_FAILURE;\n    }\n\n    fclose(fpointer);\n    return 0;\n}\n</code></pre>\n\n<p>The creation of the file works fine, same with the creation of the text. My problem is the reading of the contents: the first line is displayed correctly followed by the rest of the lines that are just a bunch of symbols. I would imagine that the problem is the way I use <code>fgets</code> but I can't seem to be able to resolve it.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 952, "user_id": 12521158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8e745b4953a3ecbe3a1f7147089a7a7?s=128&d=identicon&r=PG&f=1", "display_name": "kopecs", "link": "https://stackoverflow.com/users/12521158/kopecs"}, "edited": false, "score": 3, "creation_date": 1577758568, "post_id": 59538774, "comment_id": 105247675, "body": "Could you also show <code>moreEncode</code>? As this is it isn&#39;t a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">Minimum, Reproducible Example</a>."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1577758578, "post_id": 59538774, "comment_id": 105247676, "body": "Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal verifiable example</a>. In particular, we need to see <code>morseEncode</code>. Also, suggest you run your program in a debugger. That is the best way for you to find the problem."}, {"owner": {"reputation": 952, "user_id": 12521158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8e745b4953a3ecbe3a1f7147089a7a7?s=128&d=identicon&r=PG&f=1", "display_name": "kopecs", "link": "https://stackoverflow.com/users/12521158/kopecs"}, "edited": false, "score": 0, "creation_date": 1577758639, "post_id": 59538774, "comment_id": 105247683, "body": "Unrelated to your issue, but also take a look at <a href=\"https://stackoverflow.com/a/605858/12521158\">Do I cast the result of <code>malloc</code>?</a>"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 2, "creation_date": 1577758644, "post_id": 59538774, "comment_id": 105247684, "body": "<code>char* s =(char*) malloc(lenght+1); s = &quot;Hello&quot;;</code> That isn&#39;t the correct way to copy a string into a char buffer. Use <code>strcpy</code>. As it is, the <code>malloc</code> memory is lost and a memory leak occurs."}, {"owner": {"reputation": 952, "user_id": 12521158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8e745b4953a3ecbe3a1f7147089a7a7?s=128&d=identicon&r=PG&f=1", "display_name": "kopecs", "link": "https://stackoverflow.com/users/12521158/kopecs"}, "edited": false, "score": 0, "creation_date": 1577759569, "post_id": 59538774, "comment_id": 105247797, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/164194/why-do-i-get-a-segmentation-fault-when-writing-to-a-string-initialized-with-cha\">Why do I get a segmentation fault when writing to a string initialized with &quot;char *s&quot; but not &quot;char s&#91;&#93;&quot;?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1577759748, "post_id": 59538937, "comment_id": 105247824, "body": "OP claims <code>morseCode(s)</code> causes a seg fault but <code>morseCode(&quot;Hello&quot;)</code> does not. Your answer does not seem to address that point clearly."}, {"owner": {"reputation": 952, "user_id": 12521158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8e745b4953a3ecbe3a1f7147089a7a7?s=128&d=identicon&r=PG&f=1", "display_name": "kopecs", "link": "https://stackoverflow.com/users/12521158/kopecs"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1577760114, "post_id": 59538937, "comment_id": 105247876, "body": "@kaylum I&#39;d hazard a guess that it&#39;s some compiler specific behaviour; both are undefined, the compiler OP is using might just happen to put literals in read only memory when they aren&#39;t used to initialise  <code>char*</code>s or something similar. The fact that its undefined <i>does</i> in fact address that inconsistency. I&#39;d agree that without OP disclosing what compiler targeting what system they&#39;re using (or providing the source of <code>morseEncode</code>) why that behaviour is different is impossible to diagnose perfectly, but the fact that they&#39;re different doesn&#39;t make one any more well defined."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1577760201, "post_id": 59538937, "comment_id": 105247887, "body": "I agree. I&#39;m just pointing out your answer doesn&#39;t clearly/explicitly explain the apparent difference in behaviour that the OP has observed."}, {"owner": {"reputation": 952, "user_id": 12521158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8e745b4953a3ecbe3a1f7147089a7a7?s=128&d=identicon&r=PG&f=1", "display_name": "kopecs", "link": "https://stackoverflow.com/users/12521158/kopecs"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1577760461, "post_id": 59538937, "comment_id": 105247932, "body": "@kaylum I figured pointing it out as undefined behaviour would encompass enough, but I&#39;ve added an addendum now!"}], "tags": [], "owner": {"reputation": 952, "user_id": 12521158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8e745b4953a3ecbe3a1f7147089a7a7?s=128&d=identicon&r=PG&f=1", "display_name": "kopecs", "link": "https://stackoverflow.com/users/12521158/kopecs"}, "is_accepted": false, "score": 1, "last_activity_date": 1577760419, "last_edit_date": 1577760419, "creation_date": 1577759493, "answer_id": 59538937, "question_id": 59538774, "link": "https://stackoverflow.com/questions/59538774/segmation-fault-when-sending-a-string-as-a-paremeter/59538937#59538937", "title": "Segmation fault when sending a string as a paremeter", "body": "<p>This is a result of passing the variable <code>s</code> to <code>morseEncode</code> (which presumably modifies it) as modifying <code>s</code> is <a href=\"https://stackoverflow.com/a/4105123/12521158\">undefined behaviour</a>. Specifically, modifying a string literal in such a manner is undefined behaviour per 6.4.5p6 [from C99:TC3]</p>\n\n<blockquote>\n  <p>It is unspecified whether these (string literal) arrays are distinct provided their\n  elements have the appropriate values. If the program attempts to\n  modify such an array, the behavior is undefined.</p>\n</blockquote>\n\n<p>(text in parentheses added by me)</p>\n\n<p>You might also want to take a look at <a href=\"https://stackoverflow.com/questions/164194/why-do-i-get-a-segmentation-fault-when-writing-to-a-string-initialized-with-cha\">this question</a>.</p>\n\n<p>You could instead declare <code>s</code> like so (with automatic storage duration).</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>char s[] = \"Hello\";\n</code></pre>\n\n<p>If you need <code>s</code> to be a pointer you could try</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>// Yes, sizeof(char) will always be 1 and you could remove it.\nchar *s = malloc(sizeof(char) * (strlen(\"Hello\") + 1)); \nstrcpy(s, \"Hello\");\n\n// Your code that uses s here\n\nfree(s) // Important!\n</code></pre>\n\n<hr>\n\n<p>As an additional note @kaylum has pointed out that the original answer didn't provide a justification as to why calling the function in the two different ways produced different results. This is because the undefined behaviour you're running into just so happened to be undefined in a different way for each call. If I write out a similar program and compile it using <code>gcc</code> (with no flags) I end up running into a segfault both ways; on the other hand, compiling with <code>clang -O</code> both work! Its simply a product of whatever segment(s) of memory your specific compiler has decided you place each of those sequences of characters.</p>\n"}], "owner": {"reputation": 1, "user_id": 12628977, "user_type": "registered", "profile_image": "https://graph.facebook.com/2645926768856938/picture?type=large", "display_name": "Turqay Umudzad\u0259", "link": "https://stackoverflow.com/users/12628977/turqay-umudzad%c9%99"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "closed_date": 1577784399, "answer_count": 1, "score": -3, "last_activity_date": 1577763715, "creation_date": 1577757973, "last_edit_date": 1577763715, "question_id": 59538774, "link": "https://stackoverflow.com/questions/59538774/segmation-fault-when-sending-a-string-as-a-paremeter", "closed_reason": "Not suitable for this site", "title": "Segmation fault when sending a string as a paremeter", "body": "<p>I am trying to write a program that converts a string to morse code. It currently works fine whenever input is a string literal but whenever I send a string as a variable I get a segmentation fault.</p>\n\n<pre><code>void morseCode(char* s)\n{\n    for (int i = 0; s[i]!='\\0'; i++)\n        printf(\"%s\",morseEncode(s[i])); //morseEncode is a function which returns char* of morse code\n}\n\n\nint main()\n{\n    int length = strlen(\"Hello\");\n    char* s = (char*) malloc(length + 1);\n    s = \"Hello\";\n\n    morseCode(s);       // Segmentation fault\n    morseCode(\"Hello\"); // works fine\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1577752886, "post_id": 59538351, "comment_id": 105246750, "body": "<i>&#39;scanning &quot;MENYVAL=1&quot;&#39;</i> Do you mean this literally? Because your program only accepts a number, not a &quot;MENUVAL=&quot; prefix"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 2, "creation_date": 1577752911, "post_id": 59538351, "comment_id": 105246757, "body": "There is no code shown in this question that can output &quot;Manufacturer Choice&quot;. Present your <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1577752943, "post_id": 59538351, "comment_id": 105246763, "body": "<i>&quot;the code reads the print in ADDVEHICLE but then returns to the switch code in int main without asking for input.&quot;</i> We have no way of knowing what ADDVEHICLE does because you did not show it to us (there is instead ADDFORDON)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11596041"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1577753057, "post_id": 59538351, "comment_id": 105246781, "body": "yes scanning the number 1, sorry for the confusion, I will edit that into the body of text"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 3, "creation_date": 1577753119, "post_id": 59538351, "comment_id": 105246799, "body": "<code>scanf(&quot;%i&quot;, &amp;MENYVAL);</code> leaves the newline in the buffer, so <code>fgets</code> scans empty."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1577753248, "post_id": 59538351, "comment_id": 105246818, "body": "@KamilCuk If you have an answer please put it in the answer section where it can undergo the normal peer review thank you"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11596041"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1577753572, "post_id": 59538351, "comment_id": 105246869, "body": "@KamilCuk Do you have any recommendation on how i can solve that? I am still not comfortable with programming and struggle with a lot of it"}], "answers": [{"tags": [], "owner": {"reputation": 1692, "user_id": 12433504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/667a21f48cc9b08d6adf0005669d9955?s=128&d=identicon&r=PG", "display_name": "VillageTech", "link": "https://stackoverflow.com/users/12433504/villagetech"}, "is_accepted": true, "score": 2, "last_activity_date": 1577753649, "creation_date": 1577753649, "answer_id": 59538440, "question_id": 59538351, "link": "https://stackoverflow.com/questions/59538351/code-skipped-when-calling-function-from-switch/59538440#59538440", "title": "Code skipped when calling function from switch", "body": "<p>Probably the '\\n' character, remaining after execution of <code>scanf()</code> before <code>switch</code>, is readed inside <code>ADDFORDON()</code> function by <code>fgets()</code> call. Add \"buffer flusher\" before <code>fgets()</code> like below:</p>\n\n<pre><code>void ADDVEHICLE() {\n    FILE *fp;\n    char CAR[50];\n\n    fp = fopen(\"FILE.txt\", \"a\");\n\n    if (!fp) {\n        printf(\"ERROR\");\n    }\n\n    // flush buffer here!\n    scanf(\"%s\"); // this reads any characters remaining in input buffer then ignores them\n\n    printf(\"\\n Manufacturer\");\n\n    fgets(CAR, sizeof(CAR), stdin);\n    fprintf(fp, \"%s\", CAR);\n\n    fclose(fp);\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11596041"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "closed_date": 1577753880, "accepted_answer_id": 59538440, "answer_count": 1, "score": 0, "last_activity_date": 1577753649, "creation_date": 1577752615, "last_edit_date": 1577753099, "question_id": 59538351, "link": "https://stackoverflow.com/questions/59538351/code-skipped-when-calling-function-from-switch", "closed_reason": "Duplicate", "title": "Code skipped when calling function from switch", "body": "<p>I have a code that is suppose to ask a user for a car manufacturer and then store it inside a txt file (this is part of introductory course in C). I have the following menu for calling the function inside int main</p>\n\n<pre><code>while(1)\n{\n     printf(\"Choice\");\n     scanf(\"%i\", &amp;MENYVAL);\n    switch(MENYVAL){\n            case 1 : ADDVEHICLE();      break;\n            case 2 : read();            break;\n            default: printf(\"No choice was made\");\n    }\n            printf(\"\\tChoice\");\n            scanf(\"%i\", &amp;MENYVAL);\n}\n</code></pre>\n\n<p>where \"ADDVEHICLE\" is the following function</p>\n\n<pre><code>void ADDVEHICLE() {\nFILE *fp;\nchar CAR[50];\n\nfp = fopen(\"FILE.txt\", \"a\");\n\nif(!fp) {\n    printf(\"ERROR\");\n}\n\nprintf(\"\\n Manufacturer\");\nfgets(CAR, sizeof(CAR), stdin);\nfprintf(fp, \"%s\", CAR);\n\nfclose(fp);}\n</code></pre>\n\n<p>When running the program and scanning \"MENYVAL=1\"\nI get the output</p>\n\n<pre><code>Manufacturer Choice\n</code></pre>\n\n<p>I.e the code reads the print in ADDVEHICLE but then returns to the switch code in int main without asking for input.</p>\n\n<p>Attempts: \nIf I remove the switch code and just call the function ADDVEHICLE the code works fine, I can input text which is stored in the correct txt file.</p>\n\n<p>I tested adding after \"fprinf\" the following code (which i believe tries to flush the buffer) see <a href=\"https://stackoverflow.com/questions/10938882/how-can-i-flush-unread-data-from-a-tty-input-queue-on-a-unix-system\">link</a> for inspiration:</p>\n\n<pre><code>while (!EOF) { fprintf(fp, \"%s\", \"\\t\");} \n</code></pre>\n\n<p>with no success.</p>\n\n<p>PS. I am programming on a linux VM but I am not sure if it is correct to use the tag, I apologize if the tag is incorrect</p>\n"}, {"tags": ["c", "system-calls", "ptrace"], "answers": [{"tags": [], "owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "is_accepted": false, "score": 1, "last_activity_date": 1577750288, "creation_date": 1577750288, "answer_id": 59538121, "question_id": 59538074, "link": "https://stackoverflow.com/questions/59538074/ptrace-get-syscall-info-undeclared-including-sys-ptrace-h-doesnt-seem-to-get-a/59538121#59538121", "title": "PTRACE_GET_SYSCALL_INFO undeclared: including sys/ptrace.h doesn&#39;t seem to get all ptrace code", "body": "<p>This is because glibc is not fully up-to-date on all the latest Linux features. You can <code>#include &lt;linux/ptrace.h&gt;</code> and <code>#include &lt;sys/ptrace.h&gt;</code> to get <code>PTRACE_GET_SYSCALL_INFO</code>.</p>\n"}], "owner": {"reputation": 127, "user_id": 5781079, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-p6fEVLJjskk/AAAAAAAAAAI/AAAAAAAAAMI/ias3mr1ibc4/photo.jpg?sz=128", "display_name": "NotAPro", "link": "https://stackoverflow.com/users/5781079/notapro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 326, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1577750574, "creation_date": 1577749841, "last_edit_date": 1577750574, "question_id": 59538074, "link": "https://stackoverflow.com/questions/59538074/ptrace-get-syscall-info-undeclared-including-sys-ptrace-h-doesnt-seem-to-get-a", "title": "PTRACE_GET_SYSCALL_INFO undeclared: including sys/ptrace.h doesn&#39;t seem to get all ptrace code", "body": "<p>From the man page:</p>\n\n<blockquote>\n  <p>PTRACE_GET_SYSCALL_INFO (since Linux 5.3)</p>\n  \n  <p>Retrieve information about the system call that caused the stop.  The\n  information is placed into the buffer pointed by the data argument,\n  which should be a pointer to a buffer of type struct\n  ptrace_syscall_info.  The addr argument contains the size of the\n  buffer pointed to by the data argument (i.e., sizeof(struct\n  ptrace_syscall_info)).  The return value contains the number of\n  bytes available to be written by the kernel.  If the size of the\n  data to be written by the kernel exceeds the size specified by the\n  addr argument, the output data is truncated.</p>\n</blockquote>\n\n<pre><code>&gt;cat /proc/version\nLinux version 5.3.0-kali2-amd64 (devel@kali.org) (gcc version 9.2.1 20191109 (Debian 9.2.1-19)) #1 SMP Debian 5.3.9-3kali1 (2019-11-20)\n&gt;\n</code></pre>\n\n<p>Now, I have this small program I've written, consisting of two files.</p>\n\n<h2>helpers.h</h2>\n\n<pre><code>#ifndef HELPERS\n#define HELPERS\n//helpers.h\n#include &lt;errno.h&gt;\n#include &lt;sys/ptrace.h&gt;\n#include &lt;sys/types.h&gt;\n\n\nconst char* op_to_string(__u8 op)\n{\n    switch (op) {\n        case (PTRACE_SYSCALL_INFO_ENTRY):\n            return \"SYSCALL_INFO_ENTRY\";\n            break;\n        case (PTRACE_SYSCALL_INFO_EXIT):\n            return \"SYSCALL_INFO_EXIT\";\n            break;\n        case (PTRACE_SYSCALL_INFO_SECCOMP):\n            return \"SYSCALL_INFO_SECCOMP\";\n            break;\n        default:\n            fprintf(stderr, \"op-to-string: Invalid op code\");\n    }\n}\n\n\nvoid err_wrap(const int ret, const int success, const char *msg)\n{\n    if (ret != success)\n    {\n        perror(msg);\n    }\n}\n\n\nvoid print_regs(const struct user_regs_struct regs) {\n  printf (\"r15:     %16llx %30s\\n\", regs.r15, \"general purpose registers\");\n  printf (\"r14:     %16llx\\n\", regs.r14);\n  printf (\"r13:     %16llx\\n\", regs.r13);\n  printf (\"r12:     %16llx\\n\", regs.r12);\n  printf (\"rbp:     %16llx\\n\", regs.rbp);\n  printf (\"rbx:     %16llx\\n\", regs.rbx);\n  printf (\"r11:     %16llx\\n\", regs.r11);\n  printf (\"r10:     %16llx\\n\", regs.r10);\n  printf (\"r9:      %16llx   %s\\n\", regs.r9, \"6.\");\n  printf (\"r8:      %16llx   %s\\n\", regs.r8, \"5.\");\n  printf (\"rax:     %16llx\\n\", regs.rax);\n  printf (\"rcx:     %16llx   %s\\n\", regs.rcx, \"4.\");\n  printf (\"rdx:     %16llx   %s\\n\", regs.rdx, \"3.\");\n  printf (\"rsi:     %16llx   %s\\n\", regs.rsi, \"2.\");\n  printf (\"rdi:     %16llx %30s\\n\", regs.rdi, \"1. function/syscall argument\"); // aka \"parameter registers\"\n  printf (\"orig_rax:%16llx\\n\", regs.orig_rax);\n  printf (\"rip:     %16llx %30s\\n\", regs.rip, \"instruction pointer\");\n  printf (\"cs:      %16llx\\n\", regs.cs);\n  printf (\"eflags:  %16llx\\n\", regs.eflags);\n  printf (\"rsp:     %16llx %30s\\n\", regs.rsp, \"  Stack Pointer (current location in stack)\");\n  printf (\"ss:      %16llx\\n\", regs.ss);\n  printf (\"fs_base: %16llx\\n\", regs.fs_base);\n  printf (\"gs_base: %16llx\\n\", regs.gs_base);\n  printf (\"ds:      %16llx\\n\", regs.ds);\n  printf (\"es:      %16llx\\n\", regs.es);\n  printf (\"fs:      %16llx\\n\", regs.fs);\n  printf (\"gs:      %16llx\\n\", regs.gs);\n}\n\nvoid print_syscall_info(struct ptrace_syscall_info sys_info) {\n    __u8 op = sys_info.op;\n    printf(\"Type of system call stop:   %20s   (%x)\\n\", op_to_string(op), op);\n    printf(\"Arch:   %16llx\\n\", sys_info.arch);\n}\n\n#endif\n</code></pre>\n\n<h2>tracetest.c</h2>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/user.h&gt;\n\n#include &lt;syscall.h&gt;\n\n#include \"helpers.h\"\n\n// long ptrace(enum __ptrace_request request, pid_t pid,\n                   // void *addr, void *data);\n\n\n\nvoid child_code();\nvoid parent_code(pid_t pid);\n\nint main(const int argc, char *argv[])\n{\n    pid_t pid;\n    switch (pid = fork())\n    {\n        case -1:\n            perror(\"fork\");\n            break;\n        case 0:\n            child_code();\n            break;\n        default: //parent code\n            parent_code(pid);\n    }\n\n    return 0;\n}\n\nvoid parent_code(pid_t pid)\n{\n    printf(\"Parent code\\n\");\n    int status;\n    if (wait(&amp;status) == -1)\n    {\n        perror(\"parent wait one\");\n    }\n    printf(\"Finished waiting\\n\");\n    printf(\"PID wait status is:     %llx\\n\", status);\n    printf(\"My PID is     %d\\n\", getpid());\n    err_wrap(\n        ptrace(PTRACE_SETOPTIONS, pid, 0, PTRACE_O_EXITKILL), \n        0, \"ptrace-set-options\");\n    struct user_regs_struct regs;\n    struct ptrace_syscall_info syscall_info;\n\n    while(1)\n    {\n        err_wrap(ptrace(PTRACE_SYSCALL, pid, 0, 0), 0, \"ptrace-syscall first\"); //Stop at next syscall.\n        if (wait(&amp;status) == -1)\n        {\n            perror(\"parent wait one\");\n        }\n        printf(\"syscall-entry-stop\\n\");\n        err_wrap(\n            ptrace(PTRACE_GET_SYSCALL_INFO, pid, sizeof(struct ptrace_syscall_info), &amp;syscall_info),\n            0, \"ptrace-get-syscall-info\");\n        err_wrap(\n            ptrace(PTRACE_GETREGS, pid, 0, &amp;regs),\n            0,\n            \"ptrace-getregs\");\n\n        print_regs(regs);\n        print_syscall_info(syscall_info);\n    }\n\n}\n\nvoid child_code() {\n    printf(\"Child code\\n\");\n    printf(\"Parent is:   %d\\n\", getppid());\n    err_wrap(ptrace(PTRACE_TRACEME, 0,0,0), 0, \"ptrace-traceme\");\n    err_wrap(raise(SIGSTOP), 0, \"raise\");\n\n    unsigned int pleb = 0xffbbcde8;\n    int x = 0;\n    printf(\"Hello WoRld\\n\");\n\n    printf(\"Pleb is:     %llx\\n\", pleb);\n    printf(\"x is:        %d\\n\", x);\n}\n</code></pre>\n\n<p>All things considered, my code should run normally without errors, but it seems like the PTRACE_GET_SYSCALL_INFO stuff isn't actually included, as gcc is complaining:</p>\n\n<pre><code>&gt;gcc -g -o tracetest tracetest.c\nIn file included from tracetest.c:10:\nhelpers.h:9:26: error: unknown type name \u2018__u8\u2019\n    9 | const char* op_to_string(__u8 op)\n      |                          ^~~~\nhelpers.h:72:32: warning: \u2018struct ptrace_syscall_info\u2019 declared inside parameter list will not be visible outside of this definition or declaration\n   72 | void print_syscall_info(struct ptrace_syscall_info sys_info) {\n      |                                ^~~~~~~~~~~~~~~~~~~\nhelpers.h:72:52: error: parameter 1 (\u2018sys_info\u2019) has incomplete type\n   72 | void print_syscall_info(struct ptrace_syscall_info sys_info) {\n      |                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~\nhelpers.h: In function \u2018print_syscall_info\u2019:\nhelpers.h:73:2: error: unknown type name \u2018__u8\u2019\n   73 |  __u8 op = sys_info.op;\n      |  ^~~~\nhelpers.h:74:54: warning: implicit declaration of function \u2018op_to_string\u2019 [-Wimplicit-function-declaration]\n   74 |  printf(\"Type of system call stop:   %20s   (%x)\\n\", op_to_string(op), op);\n      |                                                      ^~~~~~~~~~~~\ntracetest.c: In function \u2018parent_code\u2019:\ntracetest.c:55:29: error: storage size of \u2018syscall_info\u2019 isn\u2019t known\n   55 |  struct ptrace_syscall_info syscall_info;\n      |                             ^~~~~~~~~~~~\ntracetest.c:66:11: error: \u2018PTRACE_GET_SYSCALL_INFO\u2019 undeclared (first use in this function); did you mean \u2018PTRACE_GETSIGINFO\u2019?\n   66 |    ptrace(PTRACE_GET_SYSCALL_INFO, pid, sizeof(struct ptrace_syscall_info), &amp;syscall_info),\n      |           ^~~~~~~~~~~~~~~~~~~~~~~\n      |           PTRACE_GETSIGINFO\ntracetest.c:66:11: note: each undeclared identifier is reported only once for each function it appears in\ntracetest.c:66:48: error: invalid application of \u2018sizeof\u2019 to incomplete type \u2018struct ptrace_syscall_info\u2019\n   66 |    ptrace(PTRACE_GET_SYSCALL_INFO, pid, sizeof(struct ptrace_syscall_info), &amp;syscall_info),\n      |                                                ^~~~~~\n</code></pre>\n\n<p>However, if I <code>#include &lt;linux/ptrace.h&gt;</code>, then I don't get these errors, but instead it says implicit declaration of function ptrace.h, which to be honest I think isn't very good either.</p>\n\n<p><strong>What am I supposed to be including to make this function as intended?</strong> I also included <code>sys/types.h</code>, but I'm still getting errors about <code>__u8</code> being an unknown type name, but it's a type used in the ptrace.c source code, so it shouldn't be throwing any errors.</p>\n\n<p>The top of the ptrace man page says:</p>\n\n<pre><code>#include &lt;sys/ptrace.h&gt;\nlong ptrace(enum __ptrace_request request, pid_t pid,\n            void *addr, void *data);`\n</code></pre>\n\n<p>So I would have thought this single include would be enough, but it's not working.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c", "linux", "mmap", "huge-pages"], "answers": [{"comments": [{"owner": {"reputation": 531, "user_id": 8339821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0148d1cfa01aea7231cf3195f54f2d78?s=128&d=identicon&r=PG&f=1", "display_name": "user14063792468", "link": "https://stackoverflow.com/users/8339821/user14063792468"}, "edited": false, "score": 1, "creation_date": 1577750676, "post_id": 59538105, "comment_id": 105246293, "body": "Thank you, this explains it all. By the way.. Can you farther advice me? Ideally I would like to <code>mmap</code> a file. And as of today, my system do not allow me to <code>mmap</code> with both <code>fd</code> and <code>MAP_HUGETLB</code> flags. Any way to read a file with hugepages? Just to test and forget about it, I know there will be not much, if any, gains."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "reply_to_user": {"reputation": 531, "user_id": 8339821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0148d1cfa01aea7231cf3195f54f2d78?s=128&d=identicon&r=PG&f=1", "display_name": "user14063792468", "link": "https://stackoverflow.com/users/8339821/user14063792468"}, "edited": false, "score": 0, "creation_date": 1577750933, "post_id": 59538105, "comment_id": 105246346, "body": "@\u042f\u0440\u043e\u0441\u043b\u0430\u0432\u041c\u0430\u0448\u043a\u043e Here&#39;s some relevant documentation: <a href=\"https://www.kernel.org/doc/Documentation/vm/hugetlbpage.txt\" rel=\"nofollow noreferrer\">kernel.org/doc/Documentation/vm/hugetlbpage.txt</a> (it seems as if you have to have a filesystem mounted with hugepages to be able to use <code>MAP_HUGETLB</code>)"}], "tags": [], "owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "is_accepted": true, "score": 1, "last_activity_date": 1577750154, "creation_date": 1577750154, "answer_id": 59538105, "question_id": 59537934, "link": "https://stackoverflow.com/questions/59537934/map-hugetlb-undefined/59538105#59538105", "title": "MAP_HUGETLB undefined", "body": "<p>You have to <code>#define _GNU_SOURCE</code> before <code>#include &lt;sys/mman.h&gt;</code> because this is a nonstandard flag.</p>\n"}], "owner": {"reputation": 531, "user_id": 8339821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0148d1cfa01aea7231cf3195f54f2d78?s=128&d=identicon&r=PG&f=1", "display_name": "user14063792468", "link": "https://stackoverflow.com/users/8339821/user14063792468"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 197, "favorite_count": 0, "accepted_answer_id": 59538105, "answer_count": 1, "score": 1, "last_activity_date": 1577750154, "creation_date": 1577748447, "question_id": 59537934, "link": "https://stackoverflow.com/questions/59537934/map-hugetlb-undefined", "title": "MAP_HUGETLB undefined", "body": "<p>I want to test huge memory page allocation on Linux. Just to have another method up in the sleeve. But my test simply fails to compile.</p>\n\n<pre><code>pa = mmap(0, 1024*1024*2, PROT_READ, MAP_PRIVATE|MAP_HUGETLB, -1, 0)\n</code></pre>\n\n<p>Produces:</p>\n\n<pre><code>error: use of undeclared identifier 'MAP_HUGETLB'\n</code></pre>\n\n<p>Ideally I wish to mmap a file. But anonimous memory will also do.</p>\n\n<p>The output from <code>hugeadm --pool-list</code>:</p>\n\n<pre><code>  Size      Minimum  Current  Maximum  Default\n2097152     1024     1024     1024        *\n1073741824  0        0        0\n</code></pre>\n\n<p>The question is, how could I allocate memory, backed by huge pages?</p>\n"}, {"tags": ["c", "linked-list"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1577747555, "post_id": 59537801, "comment_id": 105245623, "body": "You&#39;re going to need to at least sketch this out in C. We can&#39;t do all the work for you."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1577747810, "post_id": 59537801, "comment_id": 105245688, "body": "I don&#39;t think there&#39;s anything in C that&#39;s equivalent to that."}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1577748116, "post_id": 59537801, "comment_id": 105245742, "body": "So what&#39;s the difference in functionality between <code>new(P^.next);</code> and <code>P^.next:= new created node;</code>?"}, {"owner": {"reputation": 13, "user_id": 12628280, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDiaAu-RFWclwcB-5H_fzs0pRsptmoJa-Ic2h0beA=k-s128", "display_name": "Depressed-Dev", "link": "https://stackoverflow.com/users/12628280/depressed-dev"}, "reply_to_user": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1577748448, "post_id": 59537801, "comment_id": 105245818, "body": "@interjay  difference is if you don&#39;t use new (P^.next) the code looks like this:     new (temp);     p^.next:= temp;     p:= temp; you basically have to creat a temporary pointer and use it along the way."}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1577748686, "post_id": 59537801, "comment_id": 105245873, "body": "If this is about saving a line, you can just write <code>p-&gt;next = malloc(sizeof(struct node));</code> in one line. If not, then I don&#39;t understand what you&#39;re asking."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1577750536, "post_id": 59537801, "comment_id": 105246266, "body": "Or you can do <code>p-&gt;next = malloc(sizeof(*p-&gt;next));</code>."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1577763966, "post_id": 59537801, "comment_id": 105248447, "body": "<i>&quot;what this instruction does is basically creating another node and chains it to the previous one instead of creating a temporary node and then writing the chaining code by yourself,&quot;</i> -- is semantics. Regardless whether you call it temporary or you simply call it a node, you must allocate one new node for each node you add to the list. Whether you do that in one-line of code or three is irrelevant."}], "answers": [{"tags": [], "owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "is_accepted": true, "score": 0, "last_activity_date": 1577750743, "creation_date": 1577750743, "answer_id": 59538167, "question_id": 59537801, "link": "https://stackoverflow.com/questions/59537801/forward-chaining-a-linked-list-in-c/59538167#59538167", "title": "Forward-Chaining a linked list in C", "body": "<p>I'm fairly certain that this:</p>\n\n<pre><code>if(head==NULL)\n  head=p;\nelse\n  prev-&gt;next=p;\n\nprev=p;\n</code></pre>\n\n<p>is not the same as this:</p>\n\n<pre><code>new(P^.next);\n</code></pre>\n\n<p>but if you want an equivalent of <code>new(P^.next);</code>, you can use <code>malloc</code> to allocate memory:</p>\n\n<pre><code>p-&gt;next = malloc(sizeof(*p-&gt;next));\n</code></pre>\n\n<p>You should make sure to check if the pointer returned by <code>malloc</code> is <code>NULL</code>, too:</p>\n\n<pre><code>if(!p-&gt;next)\n{\n    perror(\"malloc()\");\n    return EXIT_FAILURE;\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 12628280, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDiaAu-RFWclwcB-5H_fzs0pRsptmoJa-Ic2h0beA=k-s128", "display_name": "Depressed-Dev", "link": "https://stackoverflow.com/users/12628280/depressed-dev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 0, "accepted_answer_id": 59538167, "answer_count": 1, "score": 1, "last_activity_date": 1577796170, "creation_date": 1577747298, "last_edit_date": 1577796170, "question_id": 59537801, "link": "https://stackoverflow.com/questions/59537801/forward-chaining-a-linked-list-in-c", "title": "Forward-Chaining a linked list in C", "body": "<p>Hello a \"newbie C\" dev here, I'm looking for some help to translate this program written in Pascal to C:</p>\n\n<pre><code>type T = ^list;\n list=record\n info: integer;\n next: T;\nend;\nvar\n L,P: T; i,ui,n: integer;\n\nbegin\nwrite('Enter number of elements in your list: '); readln(n);\nwriteln;\n\nNew(L); //Creating a node\nP := L; //assining P as a pointer\n\ni:= 1;\nwhile (i &lt;= n) do\nbegin\nwriteln('enter a number: '); readln(ui);\nP^.info:= ui;\nnew (P^.next); // creat a second node and automaticaly chain it to the previous one which means \nP^.next:= new created P\nP:= P^.next;\ni:= i + 1;\nend;\nP^.next:= nil;\n\nP:= L;\nwriteln('your list looks like this: ');\nwhile (P &lt;&gt; nil) do\nbegin\nwrite(P^.info,' ');\nP:= P^.next;\nend;\n\nreadln;\nend.\n</code></pre>\n\n<p>this a program that creates a linked list using a while loop using the forward-chaining technique, which means it creates only one node and uses it to create other nodes and chain them automatically inside the loop.\nthe equivalnt of this code in C is the following:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct node\n{\n    int data;\n    struct node *next;\n};\n\nint main()\n{\n    struct node *prev,*head,*p;\n    int n,i;\n    printf (\"number of elements:\");\n    scanf(\"%d\",&amp;n);\n    head=NULL;\n    for(i=0;i&lt;n;i++)\n    {\n        p=malloc(sizeof(struct node));\n        scanf(\"%d\",&amp;p-&gt;data);\n        p-&gt;next=NULL;\n        if(head==NULL)\n            head=p;\n        else\n            prev-&gt;next=p;\n        prev=p;\n    }\n    return 0;\n}\n</code></pre>\n\n<p>my problem is that I want to create the same code in C, but I couldn't find a solution to the \"auto-chaining\" I mentioned before, specifically I'm looking for a way to write the following instruction in C:</p>\n\n<pre><code>new(P^.next);\n</code></pre>\n\n<p>what this instruction does is basically creating another node and chains it to the previous one instead of creating a temporary node and then writing the chaining code by yourself, it's like you're saying:</p>\n\n<pre><code>P^.next:= new created node;\n</code></pre>\n\n<p>I could be more detailed, I want to know how to replace this code in C:</p>\n\n<pre><code>if(head==NULL)\n  head=p;\nelse\n  prev-&gt;next=p;\n\nprev=p;\n</code></pre>\n\n<p>and write in a simple instruction like the on in pascal</p>\n\n<blockquote>\n  <p>new(P^.next);</p>\n</blockquote>\n"}, {"tags": ["c", "malloc", "dynamic-memory-allocation"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 8, "creation_date": 1577740691, "post_id": 59536923, "comment_id": 105243557, "body": "why would you want to do this?"}, {"owner": {"reputation": 952, "user_id": 12521158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8e745b4953a3ecbe3a1f7147089a7a7?s=128&d=identicon&r=PG&f=1", "display_name": "kopecs", "link": "https://stackoverflow.com/users/12521158/kopecs"}, "edited": false, "score": 0, "creation_date": 1577740757, "post_id": 59536923, "comment_id": 105243584, "body": "Besides maybe having <code>*nx = x</code> instead of using <code>[0]</code> and adding a check to make sure <code>malloc</code> doesn&#39;t return <code>NULL</code> my only though is why."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1577740803, "post_id": 59536923, "comment_id": 105243599, "body": "Excellent way to fragment your heap."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1577740921, "post_id": 59536923, "comment_id": 105243635, "body": "@EugeneSh. That happens whether you do it by defining functions for all your types, or write out the malloc code in each place."}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1577740981, "post_id": 59536923, "comment_id": 105243661, "body": "@Christian Gibbons, My first thought is that they want an initializing allocator, but the initialization only works for simple types. So yeah, why would one dynamically dynamically allocate simple values?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1577802676, "post_id": 59536923, "comment_id": 105259518, "body": "&quot;Is there a better way to accomplish this?&quot; --&gt; Handle <code>heapify_...(0)</code> and cope with out-of-memory, else this is not much different than VLA which fails to handle those two."}], "answers": [{"comments": [{"owner": {"reputation": 538, "user_id": 787747, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7eaa871d67277f21afecd9d1ac95d705?s=128&d=identicon&r=PG", "display_name": "crinklywrappr", "link": "https://stackoverflow.com/users/787747/crinklywrappr"}, "edited": false, "score": 1, "creation_date": 1577741988, "post_id": 59537003, "comment_id": 105244006, "body": "I&#39;m fairly certain the C preprocessor restricts <code>sizeof</code>."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 538, "user_id": 787747, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7eaa871d67277f21afecd9d1ac95d705?s=128&d=identicon&r=PG", "display_name": "crinklywrappr", "link": "https://stackoverflow.com/users/787747/crinklywrappr"}, "edited": false, "score": 1, "creation_date": 1577742054, "post_id": 59537003, "comment_id": 105244032, "body": "@crinklywrappr What do you mean?"}, {"owner": {"reputation": 538, "user_id": 787747, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7eaa871d67277f21afecd9d1ac95d705?s=128&d=identicon&r=PG", "display_name": "crinklywrappr", "link": "https://stackoverflow.com/users/787747/crinklywrappr"}, "edited": false, "score": 0, "creation_date": 1577742276, "post_id": 59537003, "comment_id": 105244105, "body": "I ran across this about an hour ago.  I didn&#39;t test it so I don&#39;t know if it&#39;s true or not.  Still learning :-) <a href=\"https://stackoverflow.com/a/4079267/787747\">stackoverflow.com/a/4079267/787747</a>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1577742354, "post_id": 59537003, "comment_id": 105244133, "body": "This is not the case here. We do not ask the preprocessor to evaluate <code>sizeof</code>, we just ask it to place it as is where the macro is being expanded."}, {"owner": {"reputation": 538, "user_id": 787747, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7eaa871d67277f21afecd9d1ac95d705?s=128&d=identicon&r=PG", "display_name": "crinklywrappr", "link": "https://stackoverflow.com/users/787747/crinklywrappr"}, "edited": false, "score": 0, "creation_date": 1577742438, "post_id": 59537003, "comment_id": 105244166, "body": "I am enlightened.  Thanks! (="}, {"owner": {"reputation": 284, "user_id": 12571460, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCfdmLEtpNndCH3GzEC7Pps5wv1KvzZiwCtjEHs=k-s128", "display_name": "Lxer Lx", "link": "https://stackoverflow.com/users/12571460/lxer-lx"}, "reply_to_user": {"reputation": 538, "user_id": 787747, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7eaa871d67277f21afecd9d1ac95d705?s=128&d=identicon&r=PG", "display_name": "crinklywrappr", "link": "https://stackoverflow.com/users/787747/crinklywrappr"}, "edited": false, "score": 0, "creation_date": 1577743664, "post_id": 59537003, "comment_id": 105244581, "body": "@crinklywrappr You are confusing with this kind of preprocessing directives: <code>#if sizeof(int) == 4</code>. This directive is not valid because the preprocessor does not understand the <code>sizeof</code> operator (so, it cannot evaluate it). But this is not the case here. What at issue here is a textual replacement only ."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1577752705, "post_id": 59537003, "comment_id": 105246706, "body": "The &quot;_Bool users legendary league society hotline integration team&quot; (b.u.l.l.s.h.i.t.) wishes to lodge a complaint that <code>_Bool</code> was not on the <code>_Generic</code> list.  Their motto: &quot;Don&#39;t step on the <code>_Bool</code>!  \ud83d\ude09"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1577779810, "post_id": 59537003, "comment_id": 105251851, "body": "@chux-ReinstateMonica: Noted, thanks! I suppose I will have to add wide character support too?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1577802387, "post_id": 59537003, "comment_id": 105259424, "body": "I do not think <code>wchar_t</code> (and others) are   intrinsic types.  &quot;<code>wchar_t</code>, an integer type defined in the <code>&lt;stddef.h&gt;</code> header&quot;. May collided with  others."}], "tags": [], "owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "is_accepted": true, "score": 6, "last_activity_date": 1577779783, "last_edit_date": 1577779783, "creation_date": 1577740987, "answer_id": 59537003, "question_id": 59536923, "link": "https://stackoverflow.com/questions/59536923/generic-value-initialized-allocator/59537003#59537003", "title": "Generic value initialized allocator", "body": "<p>Since this is C:</p>\n\n<pre><code>void * heapify (const void *p, size_t sz) {\n    void *x = malloc(sz);\n    if (x) memcpy(x, p, sz);\n    return x;\n}\n</code></pre>\n\n<p>Then, if you insist:</p>\n\n<pre><code>#define defheapify(nm, T, sz) \\\nT* heapify_##nm (const T x) { return heapify(&amp;x, sz); }\n</code></pre>\n\n<p>But, <code>sz</code> is redundant if you have <code>T</code>, so:</p>\n\n<pre><code>#define defheapify(nm, T) \\\nT* heapify_##nm (const T x) { return heapify(&amp;x, sizeof(x)); }\n</code></pre>\n\n<p>However, if you are only ever concerned about the types you listed in your question, you can use a <code>_Generic</code> switch instead and simplify your interface. With the code below, you can remove the task of figuring out the type of the variable or constant you are dealing with. Just always call <code>heapify_any</code>.</p>\n\n<pre><code>#define heapify_T(T, X) \\\n(T *)heapify(&amp;(struct{ T x; }){X}.x, sizeof(T))\n\n#define heapify_G(T, X) T:heapify_T(T, X)\n\n#define heapify_any(X) _Generic( \\\nX, \\\nheapify_G(_Bool, X), \\\nheapify_G(char, X), \\\nheapify_G(signed char, X), \\\nheapify_G(unsigned char, X), \\\nheapify_G(short int, X), \\\nheapify_G(unsigned short int, X), \\\nheapify_G(int, X), \\\nheapify_G(unsigned int, X), \\\nheapify_G(long int, X), \\\nheapify_G(unsigned long int, X), \\\nheapify_G(long long int, X), \\\nheapify_G(unsigned long long int, X), \\\nheapify_G(float, X), \\\nheapify_G(double, X), \\\nheapify_G(long double, X), \\\ndefault:(void)0 \\\n)\n</code></pre>\n\n<p>There is no such thing as a literal <code>short</code> (or <code>char</code> or <code>_Bool</code>) value in C, so you would need a variable or a cast to use the <code>heapify_any</code> macro above.</p>\n\n<pre><code>short int *si = heapify_any((short)20);\nprintf(\"%hd\\n\", *si);\n</code></pre>\n\n<p><a href=\"https://tio.run/##jVPLjpswFN3zFVeMWtkIosm0q6TTSt3MZqRukJrFSBExNlhybGSbCibKr5deIJlOyKNlYaTzuhacy5KCse5OaqbqnMMX53NpZuXX4ARScjPFrNQFYt0vI3OIoORZJUULhBntPIxoFYOTr3ztwb1S2AWAz8g08AjbTCnDCFLLgZECSENhy7esakkTQ28/kpb72mpolsE@CO5yLqTmx6HrlKQxrCi8BCSFiB5g8pHgNWvmd5CiEfZ0t9rPmvFORpCU0vOop0NUupiEn0sz3RJUrp@45lYyguNXMR5/o9bfjVG9@RRmZWbPUScLzXO4TNb6Ju1KYz1I7W84b2huGy@yyujiHwOvSwbmfxOu64Qy2QU4N/VG8StTT0n8o1mt/IL0raT3iNAOR2E1pQbSV3Yo39ung763D/fLCRo5ifj7XjSH2la4Jl6Q8EOZv@gw7pXIDNS760DUTvzz2cOnz8/TkGcxhrTHjKFgEG0m7rF4dD71u9G@gW8Q4mbwEBYQikw5HvaJ@6D7zYTKCtcluPSPbD7vkornmfaSdcmPLvnJrTUW37i6eP4B\" rel=\"nofollow noreferrer\" title=\"C (gcc) \u2013 Try It Online\">Try it online!</a></p>\n"}], "owner": {"reputation": 538, "user_id": 787747, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7eaa871d67277f21afecd9d1ac95d705?s=128&d=identicon&r=PG", "display_name": "crinklywrappr", "link": "https://stackoverflow.com/users/787747/crinklywrappr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 1, "accepted_answer_id": 59537003, "answer_count": 1, "score": 4, "last_activity_date": 1577779783, "creation_date": 1577740564, "last_edit_date": 1577747381, "question_id": 59536923, "link": "https://stackoverflow.com/questions/59536923/generic-value-initialized-allocator", "title": "Generic value initialized allocator", "body": "<p>Messing around with / learning C.  I want a one-liner for moving stack values into the heap and this is the best I could come up with.</p>\n\n<pre><code>#define defheapify(nm, T, sz) \\\n  T* heapify_##nm (const T x) { \\\n    T *nx = malloc(sz); \\\n    nx[0] = x; \\\n    return nx; \\\n  }\n\ndefheapify(char, char, sizeof(char));\ndefheapify(uchar, unsigned char, sizeof(unsigned char));\ndefheapify(short_int, short int, sizeof(short int));\ndefheapify(ushort_int, unsigned short int, sizeof(unsigned short int));\ndefheapify(int, int, sizeof(int));\ndefheapify(uint, unsigned int, sizeof(unsigned int));\ndefheapify(long_int, long int, sizeof(long int));\ndefheapify(ulong_int, unsigned long int, sizeof(unsigned long int));\ndefheapify(long_long_int, long long int, sizeof(long long int));\ndefheapify(ulong_long_int, unsigned long long int, sizeof(unsigned long long int));\ndefheapify(float, float, sizeof(float));\ndefheapify(double, double, sizeof(double));\ndefheapify(long_double, long double, sizeof(long double));\n</code></pre>\n\n<p>It seems to work:</p>\n\n<pre><code>  short int *si = heapify_short_int(20);\n  printf(\"%d\\n\", ((int*)si)[0]); /* =&gt; 20 */\n</code></pre>\n\n<p>Is there a better way to accomplish this?</p>\n"}, {"tags": ["c", "arrays", "recursion"], "comments": [{"owner": {"reputation": 20017, "user_id": 2282011, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/p8sXJ.jpg?s=128&g=1", "display_name": "Devolus", "link": "https://stackoverflow.com/users/2282011/devolus"}, "edited": false, "score": 0, "creation_date": 1577739046, "post_id": 59536694, "comment_id": 105243016, "body": "What do you mean by &quot;very ascending&quot;?"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 20017, "user_id": 2282011, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/p8sXJ.jpg?s=128&g=1", "display_name": "Devolus", "link": "https://stackoverflow.com/users/2282011/devolus"}, "edited": false, "score": 0, "creation_date": 1577739120, "post_id": 59536694, "comment_id": 105243032, "body": "@Devolus strictly monotonically increasing, I presume..."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 2, "creation_date": 1577739125, "post_id": 59536694, "comment_id": 105243034, "body": "Check compiler warnings. <code>check_order_recursive</code> is supposed to return something but doesn&#39;t in all cases."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1577739128, "post_id": 59536694, "comment_id": 105243036, "body": "@Tiran What does &quot; send a pointer = 1&quot; mean?"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1577739188, "post_id": 59536694, "comment_id": 105243064, "body": "i.e. missing <code>return     check_order_recursion(*arr, n - 1, *p);</code>"}, {"owner": {"reputation": 103, "user_id": 12514651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wJ8vT.jpg?s=128&g=1", "display_name": "Tiran", "link": "https://stackoverflow.com/users/12514651/tiran"}, "edited": false, "score": 0, "creation_date": 1577739808, "post_id": 59536694, "comment_id": 105243304, "body": "[very ascending = 1, 2, 3...] [ ascending = 1, 2, 3, 3, 4, 5...]"}, {"owner": {"reputation": 103, "user_id": 12514651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wJ8vT.jpg?s=128&g=1", "display_name": "Tiran", "link": "https://stackoverflow.com/users/12514651/tiran"}, "reply_to_user": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1577739903, "post_id": 59536694, "comment_id": 105243342, "body": "@VladfromMoscow just send the value of 1/0 via a pointer from the function to main."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1577739963, "post_id": 59536694, "comment_id": 105243356, "body": "@Tiran This does not make sense."}, {"owner": {"reputation": 103, "user_id": 12514651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wJ8vT.jpg?s=128&g=1", "display_name": "Tiran", "link": "https://stackoverflow.com/users/12514651/tiran"}, "reply_to_user": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1577740239, "post_id": 59536694, "comment_id": 105243425, "body": "@VladfromMoscow we just learned about pointers this week, and they want us to use it in different ways, here for example i just need to send 1 or 0 back to main to print depending on the array&#39;s order."}, {"owner": {"reputation": 103, "user_id": 12514651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wJ8vT.jpg?s=128&g=1", "display_name": "Tiran", "link": "https://stackoverflow.com/users/12514651/tiran"}, "edited": false, "score": 0, "creation_date": 1577740277, "post_id": 59536694, "comment_id": 105243440, "body": "sorry if my English isn&#39;t very understandable"}, {"owner": {"reputation": 103, "user_id": 12514651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wJ8vT.jpg?s=128&g=1", "display_name": "Tiran", "link": "https://stackoverflow.com/users/12514651/tiran"}, "edited": false, "score": 0, "creation_date": 1577741356, "post_id": 59536694, "comment_id": 105243799, "body": "fixed it!, the problem was sending &quot;p&quot; and &quot;arr&quot; as pointers to the recursion."}], "owner": {"reputation": 103, "user_id": 12514651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wJ8vT.jpg?s=128&g=1", "display_name": "Tiran", "link": "https://stackoverflow.com/users/12514651/tiran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "closed_date": 1577739232, "answer_count": 0, "score": 0, "last_activity_date": 1577739190, "creation_date": 1577738941, "last_edit_date": 1577739190, "question_id": 59536694, "link": "https://stackoverflow.com/questions/59536694/check-order-of-array-in-c-using-recursion-and-malloc", "closed_reason": "Duplicate", "title": "check order of array in c, using recursion and malloc", "body": "<p>i have an error i can't seem to figure out for hours.\n    First off the problem is:</p>\n\n<blockquote>\n  <p>use a recursive function to determine whether an array is 'very ascending', 'ascending', or 'not ascending',</p>\n  \n  <ul>\n  <li>if very ascending return 1 and send a pointer = 1,</li>\n  <li>if ascending return 1 and send a pointer = 0,</li>\n  <li>if not ascending return 0 and send a pointer = 0.\"</li>\n  </ul>\n</blockquote>\n\n<p>i have done it without recursion, but when i use the recursive function i get an error for trying to use \"unhandled exception\" (or memory that's not mine - i think).</p>\n\n<p>On a side note: I am new to dynamic memory and i tried doing it with <code>malloc</code> on the recursive function.</p>\n\n<p>non-recursive working function:</p>\n\n<pre><code>\n#include &lt;stdio.h&gt;\n#define N 5\n\nvoid inputArray(int *arr)\n{\n    int i;\n    for (i = 0; i &lt; N; i++)\n    {\n        scanf_s(\"%d\", &amp;arr[i]);\n    }\n}\n\nint check_order(int *arr, int *n)\n{\n    int i;\n    for (i = 0; i &lt; N - 1; i++)\n    {\n        if (arr[i + 1] &lt; arr[i])\n        {\n            *n = 0;\n            return 0;\n        }\n        if (arr[i + 1] == arr[i])\n        {\n            *n = 0;\n        }\n    }\n    return 1;\n}\n\nvoid main()\n{\n    int arr[N], n = 1;\n    printf(\"enter 5 variables for array:\\n\");\n    inputArray(&amp;arr);\n    printf(\"[very ascending: 1, 1] | [ascending: 1, 0] | [not ascending: 0, 0]\\n\");\n    printf(\"(%d, %d)\\n\", check_order(&amp;arr, &amp;n), n);\n    return 0;\n}\n//********************************************************************\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid inputArray(int *arr, int n)\n{\n    int i;\n    printf(\"enter %d variables for array:\\n\", n);\n    for (i = 0; i &lt; n; i++)\n    {\n        scanf_s(\"%d\", &amp;arr[i]);\n    }\n    return;\n}\n</code></pre>\n\n<p>recursive function:</p>\n\n<pre><code>\nint check_order_recursive(int *arr, int n, int *p)\n{\n    if (n &lt; 2)\n    {\n        return 1;\n    }\n    if (arr[n - 1] &lt; arr[n - 2])\n    {\n        *p = 0;\n        return 0;\n    }\n    if (arr[n - 1] == arr[n - 2])\n    {\n        *p = 0;\n    }\n    check_order_recursion(*arr, n - 1, *p);\n}\n\nvoid main()\n{\n    int *arr, n, p = 1;\n\n    printf(\"how many elemants in the array?:\\n\");\n    scanf_s(\"%d\", &amp;n);\n    arr = (int*)malloc(sizeof(int) * n);\n    inputArray(arr, n);\n\n    printf(\"[very ascending: 1, 1] | [ascending: 1, 0] | [not ascending: 0, 0]\\n\");\n    printf(\"(%d, %d)\\n\", check_order_recursive(arr, n, &amp;p), p);\n    free(arr);\n    return;\n}\n\n</code></pre>\n"}, {"tags": ["c++", "c", "cmake"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1577887914, "post_id": 59536644, "comment_id": 105274914, "body": "Please post an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Please post the sources of the files you created and specify where you created them, so that others can reproduce the same error. I guess - did you set <code>CMAKE_MYCOMPILER_LINK_EXECUTABLE</code>?"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1577889454, "post_id": 59536644, "comment_id": 105275282, "body": "You are just using gcc, why not just specify a toolchain file?"}, {"owner": {"reputation": 20017, "user_id": 2282011, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/p8sXJ.jpg?s=128&g=1", "display_name": "Devolus", "link": "https://stackoverflow.com/users/2282011/devolus"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1577889532, "post_id": 59536644, "comment_id": 105275294, "body": "Because this is a special gcc which requires different parameters. Also I didn&#39;t want to use a toolchain. I already have a working setup, but I rather wanted to add this to the cmake system like a regular compiler which also doesn&#39;t need a toolchain parameter."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1577889561, "post_id": 59536644, "comment_id": 105275299, "body": "<code>m68k-amigaos-gcc</code> is a normal gcc. Maybe just set <code>CMAKE_COMPILER_PREFIX</code> and include <code>CMakeDetermineCCompiler.cmake</code> (or something like that)? Why would go with <a href=\"https://github.com/Kitware/CMake/blob/master/Modules/CMakeCInformation.cmake#L177\" rel=\"nofollow noreferrer\">reinventing the wheel</a>? <code>my &quot;own&quot; compiler in CMake</code> - but you are not setuping  your &quot;compiler&quot;, you are setuping your language &quot;AMIGA_C&quot;. It seems you are still compiling C++ sources, just set <code>CMAKE_CXX_COMPILER</code> to your own compiler and use the language to CXX."}, {"owner": {"reputation": 20017, "user_id": 2282011, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/p8sXJ.jpg?s=128&g=1", "display_name": "Devolus", "link": "https://stackoverflow.com/users/2282011/devolus"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1577889674, "post_id": 59536644, "comment_id": 105275317, "body": "Yes, but it still requires a different setup. I also wanted to add other setups as well, so this is just one example. The question was not how to get it work, but how to setup my &quot;own&quot; compiler in CMake (which in this case might be some gcc port, but doesn&#39;t have to)."}, {"owner": {"reputation": 20017, "user_id": 2282011, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/p8sXJ.jpg?s=128&g=1", "display_name": "Devolus", "link": "https://stackoverflow.com/users/2282011/devolus"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1577889766, "post_id": 59536644, "comment_id": 105275333, "body": "Where would I set this? You mean in CMakeDetermineAMIGA_CCompiler?"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1577889909, "post_id": 59536644, "comment_id": 105275359, "body": "To provide a custom compiler with custom semantics that supports C++, you should aim to provide the platform files, like ex. <a href=\"https://github.com/Kitware/CMake/blob/master/Modules/Platform/Linux-Intel.cmake\" rel=\"nofollow noreferrer\">Linux-intel</a>."}, {"owner": {"reputation": 20017, "user_id": 2282011, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/p8sXJ.jpg?s=128&g=1", "display_name": "Devolus", "link": "https://stackoverflow.com/users/2282011/devolus"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1577890051, "post_id": 59536644, "comment_id": 105275403, "body": "Hmm. So I would have to create a &quot;Amiga_C.cmake&quot; platform file? And how do I enable this? Because when I just run &#39;cmake . -Bbuild-dir&#39;  it only finds the local compiler of the host, whcih of course is not what I need. I still would have the same problem though, when I try to create AMIGA_VASM language, though, or is there is some better alternative?"}], "owner": {"reputation": 20017, "user_id": 2282011, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/p8sXJ.jpg?s=128&g=1", "display_name": "Devolus", "link": "https://stackoverflow.com/users/2282011/devolus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 148, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1577889452, "creation_date": 1577738595, "last_edit_date": 1577889452, "question_id": 59536644, "link": "https://stackoverflow.com/questions/59536644/cmake-custom-compiler-linker-language-not-found", "title": "CMake Custom compiler linker language not found", "body": "<p>I try to add a custom compiler to CMake and I have been using this answer to create it: <a href=\"https://stackoverflow.com/questions/38293535/generic-rule-from-makefile-to-cmake\">Generic rule from makefile to CMake</a></p>\n\n<p>When I use <code>enable_languange(MYCOMPILER)</code> this works, but then I have to add also <code>set_target_properties()</code> to be able to compile everything.</p>\n\n<p>I wanted that the user can write his project with just</p>\n\n<p><code>project(MyProject MYCOMPILER)</code></p>\n\n<p>The files are copied in a global directory \"/opt/amiga/utils/CMake\" and the path also includes \"/opt/amiga/utils\", so CMake is able to find and process the files, which I confirmed by putting message statements in there.\nbut then I get an error from CMake:</p>\n\n<p><code>CMake Error: Cannot determine link language for target \"MyProject\"</code></p>\n\n<p>So what exactly is required that CMake is recognizing the linking stage as well?</p>\n\n<h1>CMakeDetermineAMIGA_CCompiler.cmake</h1>\n\n<pre><code>set(AMIGA_COMPILER_NAME $ENV{CC})\n\nif (NOT AMIGA_COMPILER_NAME)\n    set(AMIGA_COMPILER_NAME m68k-amigaos-gcc)\nendif()\n\nfind_path(AMIGA_COMPILER_PATH\n\n    NAMES\n    \"${AMIGA_COMPILER_NAME}\"\n    \"${AMIGA_COMPILER_NAME}.exe\"\n\n    CMAKE_FIND_ROOT_PATH_BOTH\n)\n\nif (\"${AMIGA_COMPILER_PATH}\" STREQUAL \"AMIGA_COMPILER_PATH-NOTFOUND\")\n    message(FATAL_ERROR \"'${AMIGA_COMPILER_NAME}' not found. Make sure that '${AMIGA_COMPILER_NAME}' is in PATH!\")\nendif (\"${AMIGA_COMPILER_PATH}\" STREQUAL \"AMIGA_COMPILER_PATH-NOTFOUND\")\n\n# Remove the &lt;path&gt;/bin part\nget_filename_component(AMIGA_PATH_PREFIX ${AMIGA_COMPILER_PATH} DIRECTORY)\nset(AMIGA_PATH_PREFIX \"${AMIGA_PATH_PREFIX}/\")\n\nfind_program(\n    AMIGA_COMPILER \n        NAMES\n            \"${AMIGA_COMPILER_NAME}\" \n            \"${AMIGA_COMPILER_NAME}.exe\" \n        HINTS \"${AMIGA_COMPILER_PATH}\"\n        DOC \"gcc Amiga OS 1.x\" \n)\n\nif (\"${AMIGA_COMPILER}\" STREQUAL \"AMIGA_COMPILER-NOTFOUND\")\n    message(FATAL_ERROR \"'${AMIGA_COMPILER_NAME}' not found. Make sure that '${AMIGA_COMPILER_NAME}[.exe]' is in PATH!\")\nendif (\"${AMIGA_COMPILER}\" STREQUAL \"AMIGA_COMPILER-NOTFOUND\")\nmark_as_advanced(CMAKE_${ASM_DIALECT}_COMPILER)\n\nset(CMAKE_AMIGA_C_COMPILER \"${AMIGA_COMPILER}\")\nset(CMAKE_AMIGA_C_SOURCE_FILE_EXTENSIONS c;C;cpp;cxx;CPP;CXX;cc;CC)\nset(CMAKE_AMIGA_C_OUTPUT_EXTENSION .o)\nset(CMAKE_AMIGA_C_COMPILER_ENV_VAR \"CC\")\n\n# Configure variables set in this file for fast reload later on\nconfigure_file(${CMAKE_CURRENT_LIST_DIR}/CMakeAMIGA_CCompiler.cmake.in\n               ${CMAKE_PLATFORM_INFO_DIR}/CMakeAMIGA_CCompiler.cmake)\n</code></pre>\n\n<h1>CMakeAMIGA_CInformation.cmake</h1>\n\n<pre><code>SET(BUILD_SHARED_LIBS OFF)\n\nset(CMAKE_AMIGA_C_FLAGS \"--save-temps -Wall -pedantic -mcrt=nix13 -fno-exceptions -fno-rtti\")\nset(CMAKE_AMIGA_C_FLAGS_DEBUG \"${CMAKE_ASM_FLAGS} -D_DEBUG -g -mregparm\")\nset(CMAKE_AMIGA_C_FLAGS_RELEASE \"${CMAKE_ASM_FLAGS} --O2 -mregparm\")\n\nset(CMAKE_INCLUDE_FLAG_AMIGA_C \"-I\")\n\nif(NOT CMAKE_AMIGA_C_COMPILE_OBJECT)\n    message(STATUS \"Enable AMIGA_C\")\n    set(CMAKE_AMIGA_C_COMPILE_OBJECT \"&lt;CMAKE_AMIGA_C_COMPILER&gt; &lt;DEFINES&gt; &lt;INCLUDES&gt; &lt;FLAGS&gt; -o &lt;OBJECT&gt; &lt;SOURCE&gt;\")\nendif()\n\nif(NOT CMAKE_AMIGA_C_CREATE_STATIC_LIBRARY)\n    set(CMAKE_AMIGA_C_CREATE_STATIC_LIBRARY\n        \"&lt;CMAKE_AR&gt; cr &lt;TARGET&gt; &lt;LINK_FLAGS&gt; &lt;OBJECTS&gt; \"\n        \"&lt;CMAKE_RANLIB&gt; &lt;TARGET&gt; \")\nendif()\n\nif(NOT DEFINED CMAKE_AMIGA_C_ARCHIVE_CREATE)\n  set(CMAKE_AMIGA_C_ARCHIVE_CREATE \"&lt;CMAKE_AR&gt; qc &lt;TARGET&gt; &lt;LINK_FLAGS&gt; &lt;OBJECTS&gt;\")\nendif()\n\nif(NOT DEFINED CMAKE_AMIGA_C_ARCHIVE_APPEND)\n  set(CMAKE_AMIGA_C_ARCHIVE_APPEND \"&lt;CMAKE_AR&gt; q  &lt;TARGET&gt; &lt;LINK_FLAGS&gt; &lt;OBJECTS&gt;\")\nendif()\n\nif(NOT DEFINED CMAKE_AMIGA_C_ARCHIVE_FINISH)\n  set(CMAKE_AMIGA_C_ARCHIVE_FINISH \"&lt;CMAKE_RANLIB&gt; &lt;TARGET&gt;\")\nendif() \n\nif(NOT CMAKE_AMIGA_C_LINK_EXECUTABLE)\n  set(CMAKE_AMIGA_C_LINK_EXECUTABLE\n    \"&lt;CMAKE_AMIGA_C_COMPILER&gt; &lt;FLAGS&gt; &lt;CMAKE_AMIGA_C_LINK_FLAGS&gt; &lt;LINK_FLAGS&gt; &lt;OBJECTS&gt;  -o &lt;TARGET&gt; &lt;LINK_LIBRARIES&gt;\")\nendif()\n\nset(CMAKE_AMIGA_C_INFORMATION_LOADED 1)\n</code></pre>\n\n<h1>CMakeAMIGA_CCompiler.cmake.in</h1>\n\n<pre><code>set(CMAKE_AMIGA_C_COMPILER \"@CMAKE_AMIGA_C_COMPILER@\")\nset(CMAKE_AMIGA_C_COMPILER_LOADED 1)\nset(CMAKE_AMIGA_C_SOURCE_FILE_EXTENSIONS @CMAKE_AMIGA_C_DIALECT_SOURCE_FILE_EXTENSIONS@)\nset(CMAKE_AMIGA_C_OUTPUT_EXTENSION @CMAKE_AMIGA_C_OUTPUT_EXTENSION@)\nset(CMAKE_AMIGA_C_COMPILER_ENV_VAR \"@CMAKE_AMIGA_C_DIALECT_COMPILER_ENV_VAR@\")\n</code></pre>\n\n<h1>CMakeTestAMIGA_CCompiler.cmake</h1>\n\n<pre><code>set(CMAKE_AMIGA_C_COMPILER_WORKS 1 CACHE INTERNAL \"\")\n</code></pre>\n\n<h1>CMakeLists.txt</h1>\n\n<pre><code>cmake_minimum_required(VERSION 3.0)\nproject(Test AMIGA_C)\nset(TARGET ${PROJECT_NAME}) \n\nset(SOURCES\n    main.cpp\n)\n\nadd_executable(${TARGET} ${SOURCES})\n</code></pre>\n"}, {"tags": ["c", "assembly", "stack"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1577737927, "post_id": 59536518, "comment_id": 105242663, "body": "4 and 3 are put in registers ESI and EDI, not the stack."}, {"owner": {"user_type": "does_not_exist", "display_name": "user12627591"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1577738015, "post_id": 59536518, "comment_id": 105242694, "body": "Look under &lt;add&gt;"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1577738220, "post_id": 59536518, "comment_id": 105242757, "body": "Ah, you mean the code of <code>add()</code> itself, not the code in <code>main()</code> that calls it."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1577738376, "post_id": 59536518, "comment_id": 105242801, "body": "Why do you think they will be cleared? There is no standard or even convention that requires that. An implementation certainly could do that but most don&#39;t as that would be costly."}, {"owner": {"reputation": 10217, "user_id": 471930, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tds8p.png?s=128&g=1", "display_name": "Jasen", "link": "https://stackoverflow.com/users/471930/jasen"}, "edited": false, "score": 1, "creation_date": 1577740819, "post_id": 59536518, "comment_id": 105243606, "body": "I can&#39;t figuere &quot;add&quot; out, where is SP lowered below the local variables?"}, {"owner": {"reputation": 9461, "user_id": 8422330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0f90445d03447c587d1e595d531f69?s=128&d=identicon&r=PG&f=1", "display_name": "prl", "link": "https://stackoverflow.com/users/8422330/prl"}, "reply_to_user": {"reputation": 10217, "user_id": 471930, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tds8p.png?s=128&g=1", "display_name": "Jasen", "link": "https://stackoverflow.com/users/471930/jasen"}, "edited": false, "score": 1, "creation_date": 1577743676, "post_id": 59536518, "comment_id": 105244585, "body": "@Jasen, the compiler is taking advantage of the \u201cred zone\u201d. <a href=\"https://en.m.wikipedia.org/wiki/Red_zone_(computing)\" rel=\"nofollow noreferrer\">en.m.wikipedia.org/wiki/Red_zone_(computing)</a>"}, {"owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "reply_to_user": {"reputation": 9461, "user_id": 8422330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0f90445d03447c587d1e595d531f69?s=128&d=identicon&r=PG&f=1", "display_name": "prl", "link": "https://stackoverflow.com/users/8422330/prl"}, "edited": false, "score": 0, "creation_date": 1577753933, "post_id": 59536518, "comment_id": 105246929, "body": "@prl - The OS isn&#39;t specified, and Windows does not have a &quot;red zone&quot;."}, {"owner": {"reputation": 9461, "user_id": 8422330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0f90445d03447c587d1e595d531f69?s=128&d=identicon&r=PG&f=1", "display_name": "prl", "link": "https://stackoverflow.com/users/8422330/prl"}, "reply_to_user": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "edited": false, "score": 0, "creation_date": 1577772706, "post_id": 59536518, "comment_id": 105249937, "body": "@rcgldr, do you have another explanation for why the compiler-generated code accesses memory below the stack pointer? Also, Windows compilers don\u2019t pass parameters in RDI and RSI."}, {"owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "reply_to_user": {"reputation": 9461, "user_id": 8422330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0f90445d03447c587d1e595d531f69?s=128&d=identicon&r=PG&f=1", "display_name": "prl", "link": "https://stackoverflow.com/users/8422330/prl"}, "edited": false, "score": 0, "creation_date": 1577787573, "post_id": 59536518, "comment_id": 105254413, "body": "@prl - Yes, Windows doesn&#39;t pass parameters in RDI and RSI, but the OP and others reading this may not be aware of that."}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 1, "last_activity_date": 1577738332, "creation_date": 1577738332, "answer_id": 59536599, "question_id": 59536518, "link": "https://stackoverflow.com/questions/59536518/what-happens-to-arguments-pushed-on-the-stack-when-a-function-call-returns/59536599#59536599", "title": "What happens to arguments pushed on the stack when a function call returns?", "body": "<p>When you call the <code>pop</code> instruction, the value at the top of the stack is stored in the specified register and the SP (stack pointer) register is incremented (on x86 the stack grows down).  It does NOT modify the memory location that was previously the top of the stack as there's no need to do so.</p>\n\n<p>Whatever value was at the top of the stack will remain there until a new value is pushed on top of it.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user12627591"}, "edited": false, "score": 0, "creation_date": 1577738535, "post_id": 59536619, "comment_id": 105242857, "body": "ahh i see, so since ESP isn&#39;t even incremented, that region of memory belonging to 3 and 4 are just a one time use and will be overwritten the next time stack is used."}, {"owner": {"user_type": "does_not_exist", "display_name": "user12627591"}, "edited": false, "score": 0, "creation_date": 1577738567, "post_id": 59536619, "comment_id": 105242861, "body": "I like to add a side question, does &quot;pop rbp&quot; increment the stack pointer?"}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 0, "creation_date": 1577738588, "post_id": 59536619, "comment_id": 105242868, "body": "@Josh Right, that&#39;s exactly what&#39;s going to happen the next time the stack space is needed."}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 1, "creation_date": 1577738752, "post_id": 59536619, "comment_id": 105242930, "body": "@Josh Yes, pop operation moves the stack pointer in the direction opposite to push. The actual direction depends on the architecture: on some systems push is an increment, while on other systems it&#39;s a decrement."}], "tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": true, "score": 5, "last_activity_date": 1577738537, "last_edit_date": 1577738537, "creation_date": 1577738432, "answer_id": 59536619, "question_id": 59536518, "link": "https://stackoverflow.com/questions/59536518/what-happens-to-arguments-pushed-on-the-stack-when-a-function-call-returns/59536619#59536619", "title": "What happens to arguments pushed on the stack when a function call returns?", "body": "<blockquote>\n  <p>But values 4 and 3 under add are still on the stack</p>\n</blockquote>\n\n<p>Not really, because stack no longer covers the memory where <code>4</code> and <code>3</code> are stored. They are in the memory beyond the stack pointer. Although the values are still in the place in memory that used to be part of stack, they are now part of uninitialized garbage. Accessing them after the stack has moved on, e.g. by storing their addresses, would be undefined behavior.</p>\n\n<blockquote>\n  <p>Are they not supposed to be cleared?</p>\n</blockquote>\n\n<p>No, clearing these values is unnecessary, and could impact run-time efficiency of the program.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user12627591"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 59536619, "answer_count": 2, "score": 4, "last_activity_date": 1577738537, "creation_date": 1577737762, "last_edit_date": 1577738051, "question_id": 59536518, "link": "https://stackoverflow.com/questions/59536518/what-happens-to-arguments-pushed-on-the-stack-when-a-function-call-returns", "title": "What happens to arguments pushed on the stack when a function call returns?", "body": "<p>Assume this C code:</p>\n\n<pre><code>int add(int a, int b){\n int c = a+b;\n return c;\n}\n\nint main(){\n  int c = add(3,4);\n  printf(\"%d\", c);\n  return 0;\n}\n\n</code></pre>\n\n<p>When calling <code>add</code> the following happens:</p>\n\n<pre><code>Push 4 on the stack\nPush 3 on the stack\nPush the address of `printf` on the stack (return address)\ncall `add`\n// do stuff under add\npop the stack and and goto `printf`\n</code></pre>\n\n<p>But values 4 and 3 under <code>add</code> are still on the stack <code>-0x18(%rbp)</code>. Are they not supposed to be cleared?</p>\n\n<pre><code>00000000000005fa &lt;add&gt;:\n 5fa:   55                      push   %rbp\n 5fb:   48 89 e5                mov    %rsp,%rbp\n 5fe:   89 7d ec                mov    %edi,-0x14(%rbp)\n 601:   89 75 e8                mov    %esi,-0x18(%rbp)\n 604:   8b 55 ec                mov    -0x14(%rbp),%edx\n 607:   8b 45 e8                mov    -0x18(%rbp),%eax\n 60a:   01 d0                   add    %edx,%eax\n 60c:   89 45 fc                mov    %eax,-0x4(%rbp)\n 60f:   8b 45 fc                mov    -0x4(%rbp),%eax\n 612:   5d                      pop    %rbp\n 613:   c3                      retq   \n\n0000000000000614 &lt;main&gt;:\n 614:   55                      push   %rbp\n 615:   48 89 e5                mov    %rsp,%rbp\n 618:   be 04 00 00 00          mov    $0x4,%esi\n 61d:   bf 03 00 00 00          mov    $0x3,%edi\n 622:   e8 d3 ff ff ff          callq  5fa &lt;add&gt;\n 627:   5d                      pop    %rbp\n 628:   c3                      retq  \n</code></pre>\n"}, {"tags": ["c", "assembly", "code-injection", "shellcode"], "comments": [{"owner": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "edited": false, "score": 1, "creation_date": 1577738353, "post_id": 59536438, "comment_id": 105242795, "body": "the <code>call</code> instruction in your case uses a relative offset, relative to its location.  When you move this piece of code to a different location, it starts jumping to a wrong place. So, your call needs a different form with an absolute address."}, {"owner": {"reputation": 433, "user_id": 3649174, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0da70c533c8778a9912da68a4a6f82f4?s=128&d=identicon&r=PG&f=1", "display_name": "VIII", "link": "https://stackoverflow.com/users/3649174/viii"}, "edited": false, "score": 0, "creation_date": 1577748433, "post_id": 59536438, "comment_id": 105245813, "body": "Try to debugging ... or try to use shellcode compiler plugin from binary ninja"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1577778220, "post_id": 59536438, "comment_id": 105251369, "body": "Sure, you could embed the <i>absolute</i> address of the target function into the shellcode.  like <code>mov eax, 0x12345678</code> ; <code>call eax</code>."}], "answers": [{"tags": [], "owner": {"reputation": 433, "user_id": 3649174, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0da70c533c8778a9912da68a4a6f82f4?s=128&d=identicon&r=PG&f=1", "display_name": "VIII", "link": "https://stackoverflow.com/users/3649174/viii"}, "is_accepted": true, "score": 1, "last_activity_date": 1577843346, "creation_date": 1577843346, "answer_id": 59549534, "question_id": 59536438, "link": "https://stackoverflow.com/questions/59536438/calling-x86-local-function-using-shellcode/59549534#59549534", "title": "Calling x86 local function using shellcode", "body": "<p>Following Peter Cordes comment, you could embed the absolute address of the target function into the shellcode.</p>\n\n<p>To find function address <code>redirect()</code>, I'm using <code>nm</code>, so the command is :</p>\n\n<p><code>% nm &lt;binary&gt; | grep redirect</code> </p>\n\n<p>Output : <code>080484bb T redirect</code></p>\n\n<p>So, I rewrite your shellcode to modify, something adding <code>redirect()</code> function address :</p>\n\n<p><strong>test_shellcode</strong> :</p>\n\n<pre><code>push ebp\ndec eax\nmov ebp,esp\ndec eax\nsub esp,0x10\nmov eax,0x080484bb    ; redirect() function address\ncall eax\nmov dword [ebp-0x4],eax\nmov eax,dword [ebp-0x4]\nleave\nret\n</code></pre>\n\n<p><strong>test_shellcode2</strong> :</p>\n\n<pre><code>push ebp\ndec eax\nmov ebp,esp\ndec eax\nsub esp,0x10\nmov eax,0x80484bb    ; redirect() function address\ncall eax\nmov eax,0x0\ncall 0x1c\nmov dword [ebp-0x4],eax\nmov eax,dword [ebp-0x4]\nleave\nret\n</code></pre>\n\n<p>Here, I modified your code :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nvoid redirect() {\n    FILE *out = fopen(\"redirect.txt\", \"w\");\n    fprintf(out, \"REDIRECT WORKED\");\n    fclose(out);\n}\n\nvoid f_func() {\n//    unsigned char *f_code_original = \"\\x55\\x48\\x89\\xe5\\x48\\x83\\xec\\x10\\xb8\\x00\\x00\\x00\\x00\\xe8\\x00\\x00\\x00\\x00\\x89\\x45\\xfc\\xb8\\x2a\\x00\\x00\\x00\\xc9\\xc3\";\n//    unsigned char f_code_modified[] = \"\\x55\\x48\\x89\\xe5\\x48\\x83\\xec\\x10\\xb8\\x00\\x00\\x00\\x00\\xe8\\xbb\\x84\\x04\\x08\\xb8\\x00\\x00\\x00\\x00\\xe8\\x00\\x00\\x00\\x00\\x89\\x45\\xfc\\x8b\\x45\\xfc\\xc9\\xc3\";\n\n// Here shellcode, I wrote :\n\n    unsigned char *test_shellcode = \"\\x55\\x48\\x89\\xe5\\x48\\x83\\xec\\x10\\xb8\\xbb\\x84\\x04\\x08\\xff\\xd0\\x89\\x45\\xfc\\x8b\\x45\\xfc\\xc9\\xc3\";\n\n//    unsigned char *test_shellcode2 = \"\\x55\\x48\\x89\\xe5\\x48\\x83\\xec\\x10\\xb8\\xbb\\x84\\x04\\x08\\xff\\xd0\\xb8\\x00\\x00\\x00\\x00\\xe8\\xa3\\x7f\\xfb\\xf7\\x89\\x45\\xfc\\x8b\\x45\\xfc\\xc9\\xc3\";\n\n    int value = 0;\n\n    int (*f)() = (int (*)())test_shellcode;\n    value = f();\n\n    printf(\"%d\\n\", value);\n}\n\nint main(int argc, char **argv) {\n    f_func();\n}\n</code></pre>\n\n<p>Compile with <code>-fPIC -fno-stack-protector -z execstack</code>, so yeah it's work. This is for example I'm using <strong>test_shellcode</strong> :</p>\n\n<pre><code>% ls -l\ntotal 16\n-rwxrwxr-x 1 febri febri 7548 Jan  1 08:40 shell\n-rw-rw-r-- 1 febri febri 1075 Jan  1 08:39 shell.c\ndrwxrwxr-x 2 febri febri 4096 Jan  1 08:16 shellcode\n% ./shell\n0\n% ls -l  \ntotal 20\n-rw-rw-r-- 1 febri febri   15 Jan  1 08:41 redirect.txt\n-rwxrwxr-x 1 febri febri 7548 Jan  1 08:40 shell\n-rw-rw-r-- 1 febri febri 1075 Jan  1 08:39 shell.c\ndrwxrwxr-x 2 febri febri 4096 Jan  1 08:16 shellcode\n% cat redirect.txt\nREDIRECT WORKED\n</code></pre>\n\n<p>But, if I'm using <strong>test_shellcode2</strong>, I get <code>Segmentation fault</code>, but It's work :</p>\n\n<pre><code>% ls -l\ntotal 16\n-rwxrwxr-x 1 febri febri 7548 Jan  1 08:46 shell\n-rw-rw-r-- 1 febri febri 1076 Jan  1 08:46 shell.c\ndrwxrwxr-x 2 febri febri 4096 Jan  1 08:16 shellcode\n% ./shell\n[1]    7465 segmentation fault (core dumped)  ./shell\n% ls -l\ntotal 20\n-rw-rw-r-- 1 febri febri   15 Jan  1 08:46 redirect.txt\n-rwxrwxr-x 1 febri febri 7548 Jan  1 08:46 shell\n-rw-rw-r-- 1 febri febri 1076 Jan  1 08:46 shell.c\ndrwxrwxr-x 2 febri febri 4096 Jan  1 08:16 shellcode\n% cat redirect.txt\nREDIRECT WORKED                                                                                                                                                  % \n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 1074030, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/42c25f51d33985cfb06f1d64ba811289?s=128&d=identicon&r=PG", "display_name": "user1074030", "link": "https://stackoverflow.com/users/1074030/user1074030"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 338, "favorite_count": 0, "accepted_answer_id": 59549534, "answer_count": 1, "score": 0, "last_activity_date": 1577843346, "creation_date": 1577737367, "question_id": 59536438, "link": "https://stackoverflow.com/questions/59536438/calling-x86-local-function-using-shellcode", "title": "Calling x86 local function using shellcode", "body": "<p>I would like to use redirect the flow to a local function and then returning to the original one using a shellcode. <br />\nI defined two simple functions and use objdump to get their assembly code:</p>\n\n<pre><code>// unsigned char *g_code = \"\\x55\\x48\\x89\\xe5\\xb8\\x2a\\x00\\x00\\x00\\x5d\\xc3\";\nint g() {\n    return 42;\n}\n\n// unsigned char *f_code_original = \"\\x55\\x48\\x89\\xe5\\x48\\x83\\xec\\x10\\xb8\\x00\\x00\\x00\\x00\\xe8\\x00\\x00\\x00\\x00\\x89\\x45\\xfc\\xb8\\x2a\\x00\\x00\\x00\\xc9\\xc3\";\nint f() {\n    int x = g();\n    return 42;\n}\n</code></pre>\n\n<p>In a different file, I have a function that I want to call between the two instructions of f:</p>\n\n<pre><code>void redirect() {\n    FILE *out = fopen(\"redirect.txt\", \"w\");\n    fprintf(out, \"REDIRECT WORKED\");\n    fclose(out);\n}\n</code></pre>\n\n<p>For that I use the following code, compiled with -fPIC -fno-stack-protector -z execstack:</p>\n\n<pre><code>void f_func() {\n    unsigned char *f_code_original = \"\\x55\\x48\\x89\\xe5\\x48\\x83\\xec\\x10\\xb8\\x00\\x00\\x00\\x00\\xe8\\x00\\x00\\x00\\x00\\x89\\x45\\xfc\\xb8\\x2a\\x00\\x00\\x00\\xc9\\xc3\";\n    unsigned char f_code_modified[] = \"\\x55\\x48\\x89\\xe5\\x48\\x83\\xec\\x10\\xb8\\x00\\x00\\x00\\x00\\xe8\\xfb\\xfe\\xff\\xff\\xb8\\x00\\x00\\x00\\x00\\xe8\\x00\\x00\\x00\\x00\\x89\\x45\\xfc\\x8b\\x45\\xfc\\xc9\\xc3\";\n\n    int value = 0;\n\n    int (*f)() = (int (*)())f_code_modified;\n    value = f();\n\n    printf(\"%d\\n\", value);\n}\n</code></pre>\n\n<p>If I use the original code of f (as I got it from objdump) it works.\nI wanted to modify it in order to call my redirect function, then resume the current execution.</p>\n\n<p>Assembly code (for f_code_modified):</p>\n\n<pre><code>0:  55                      push   ebp\n1:  48                      dec    eax\n2:  89 e5                   mov    ebp,esp\n4:  48                      dec    eax\n5:  83 ec 10                sub    esp,0x10\n8:  b8 00 00 00 00          mov    eax,0x0       &lt;==\nd:  e8 fb fe ff ff          call   0xffffff0d    &lt;==\n12: b8 00 00 00 00          mov    eax,0x0\n17: e8 00 00 00 00          call   0x1c\n1c: 89 45 fc                mov    DWORD PTR [ebp-0x4],eax\n1f: 8b 45 fc                mov    eax,DWORD PTR [ebp-0x4]\n22: c9                      leave\n23: c3                      ret \n</code></pre>\n\n<p>This looks similar if I make the calls directly from main (int x = g(); redirect(); return 42;), but I think that the call instruction at d: e8 .. .. .. .. is relative the current instruction pointer.</p>\n\n<p>If I run the program like this it gives segmentation fault.</p>\n\n<p>Question: Is there a way I can find the current instruction pointer at runtime, then write the shellcode as \\xe8\\x??\\x??\\x??\\x?? to call the function redirect? What do I have to modify? I have already tried with -fPIC and getting the address of redirect (using &amp;), but it doesn't work.</p>\n"}, {"tags": ["c", "string", "memory-management", "embedded"], "comments": [{"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1577737369, "post_id": 59536402, "comment_id": 105242460, "body": "because <code>&quot;A&quot;</code> is the array <code>char[2]{&#39;A&#39;, 0}</code> and <code>p</code> points to the first element of the array."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1577737392, "post_id": 59536402, "comment_id": 105242465, "body": "In the first example the third argument <code>p</code> is a pointer, which is incompatible with <code>%c</code> format. In the second example <code>%s</code> <i>does</i> expect a pointer."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1577737397, "post_id": 59536402, "comment_id": 105242467, "body": "because <code>%c</code> is expecting <code>char</code>, while <code>%s</code> is expecting <code>char*</code>."}, {"owner": {"reputation": 3, "user_id": 12627430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b51548f861c6dc1d871ce9986dcbbf0?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak", "link": "https://stackoverflow.com/users/12627430/deepak"}, "edited": false, "score": 0, "creation_date": 1577737485, "post_id": 59536402, "comment_id": 105242501, "body": "but pointer is used to store address only but why it is printing string."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1577737517, "post_id": 59536402, "comment_id": 105242515, "body": "Because in the second example <code>%s</code> expects a pointer. Which is what it gets."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1577737548, "post_id": 59536402, "comment_id": 105242526, "body": "Because <code>printf</code> is implemented in such a way, that when it sees <code>%s</code>, it will take that address and will print the string starting at that address."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1577737767, "post_id": 59536402, "comment_id": 105242609, "body": "In C, a string is an array of characters ending with a null byte. Arrays are converted to a pointers when passed as function parameters, so <code>%s</code> expects the argument to be a pointer."}, {"owner": {"reputation": 3, "user_id": 12627430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b51548f861c6dc1d871ce9986dcbbf0?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak", "link": "https://stackoverflow.com/users/12627430/deepak"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1577737778, "post_id": 59536402, "comment_id": 105242613, "body": "@WeatherVane, I tried with format specifier %s in example 1 but i am getting segmentation fault."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1577737817, "post_id": 59536402, "comment_id": 105242624, "body": "That&#39;s because <code>char a</code> is not a string."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1577737885, "post_id": 59536402, "comment_id": 105242652, "body": "In the first example you pass <code>*p</code> for <code>%c</code> and it works, you also pass <code>p</code> for <code>%c</code> and it doesn&#39;t work. Why do you expect them both to work?"}, {"owner": {"reputation": 284, "user_id": 12571460, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCfdmLEtpNndCH3GzEC7Pps5wv1KvzZiwCtjEHs=k-s128", "display_name": "Lxer Lx", "link": "https://stackoverflow.com/users/12571460/lxer-lx"}, "edited": false, "score": 0, "creation_date": 1577738120, "post_id": 59536402, "comment_id": 105242735, "body": "<code>p</code> does not point to a string (or, more precisely, to the initial element of a string) in example 1."}, {"owner": {"reputation": 3, "user_id": 12627430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b51548f861c6dc1d871ce9986dcbbf0?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak", "link": "https://stackoverflow.com/users/12627430/deepak"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1577738668, "post_id": 59536402, "comment_id": 105242894, "body": "@WeatherVane, I am not bother about that 1st example of *p and p, In 2nd example &#39;P&#39; is used to store base address of string only then if we want to print &#39;p&#39; it should print address (or) if you give other format specifier then it should give junk value."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1577738851, "post_id": 59536402, "comment_id": 105242962, "body": "I suggest you change the string in the example to the <code>&quot;ABC&quot;</code> of which you speak. You&#39;&#39;ll then get different results from <code>%c</code> (<code>A</code>) and <code>%s</code> (<code>ABC</code>)."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1577745168, "post_id": 59536402, "comment_id": 105245014, "body": "Pointers don&#39;t store strings. The string has its own storage in memory somewhere, and the pointer tells you where that storage is"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1577789886, "post_id": 59536402, "comment_id": 105255340, "body": "The question in your title appears to bear little relationship to the body text."}], "answers": [{"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 1, "last_activity_date": 1577738460, "creation_date": 1577738460, "answer_id": 59536625, "question_id": 59536402, "link": "https://stackoverflow.com/questions/59536402/pointers-are-used-to-store-address-but-in-strings-like-char-ptr-abc-then-i/59536625#59536625", "title": "Pointers are used to store address, but in strings like char *ptr = &quot;abc&quot; then if you print &#39;ptr&#39; why it is printed abc instead of address", "body": "<blockquote>\n  <p>1.From above output if we want to print 'p' value then it's getting garbage value.</p>\n</blockquote>\n\n<p>The <code>%c</code> conversion specifier expects its argument to have type <code>char</code>.  <code>p</code> has type <code>char *</code> and stores the address of <code>a</code>.  Because of this type mismatch, the behavior is <em>undefined</em> and the output could quite literally be anything.  One possibility is that <code>printf</code> is trying to interpret the first byte of <code>p</code> as a <code>char</code>, but the value is likely outside the range of printable characters in the basic character set, so you get a glyph in whatever extended character set is used by the system.  </p>\n\n<blockquote>\n  <p>2.From above output if we want to print 'p' value then it's print as A.</p>\n</blockquote>\n\n<p>The <code>%s</code> conversion specifier expects its argument to have type <code>char *</code> and to point to the first character in a <em>string</em>.  It then prints each successive character of that string until it sees the string terminator.  If your string was <code>\"ABC\"</code>, then the output would be <code>p: &lt;some address&gt; *p: A p: ABC</code>.  </p>\n"}], "owner": {"reputation": 3, "user_id": 12627430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b51548f861c6dc1d871ce9986dcbbf0?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak", "link": "https://stackoverflow.com/users/12627430/deepak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1577994921, "creation_date": 1577737143, "last_edit_date": 1577994921, "question_id": 59536402, "link": "https://stackoverflow.com/questions/59536402/pointers-are-used-to-store-address-but-in-strings-like-char-ptr-abc-then-i", "title": "Pointers are used to store address, but in strings like char *ptr = &quot;abc&quot; then if you print &#39;ptr&#39; why it is printed abc instead of address", "body": "<p>Pointers are used for mainly to store the address of other variable like below code,</p>\n\n<pre><code>char a='A',*p;\np=&amp;a;\nprintf(\"p: %p *p: %c p: %c\\n\",p,*p,p);\n\noutput: p: 0x7ffc81b8d9ef *p: A p: \ufffd\n</code></pre>\n\n<p>1.From above output if we want to print 'p' value then it's getting garbage value.</p>\n\n<p><em>In strings</em></p>\n\n<pre><code>char *p =\"A\";\nprintf(\"p: %p *p: %c p: %s\\n\",p,*p,p);\n\noutput:p: 0x55ce091de714 *p: A p: A\n</code></pre>\n\n<p>2.From above output if we want to print 'p' value then it's print as A. </p>\n\n<p>From 1 &amp; 2 'p' is used for store the address only but in 2nd case why it is printing total string and\nwhy it is unable to print value in 1st case.</p>\n\n<p>How can we ensure this ?</p>\n"}, {"tags": ["c", "pointers", "gcc", "malloc", "void-pointers"], "comments": [{"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1577733993, "post_id": 59535810, "comment_id": 105241327, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/246280/is-void-an-acceptable-type-in-ansi-c\">Is void** an acceptable type in ANSI-C?</a>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1577734718, "post_id": 59535810, "comment_id": 105241567, "body": "&quot;I have this macro: ... <code>callocs</code>,  and I would like it to be a function to improve safety&quot; --&gt;   By &quot;it&quot;, sounds like you want <code>callocs</code> to be a function, yet in the first idea, <code>callocs</code> remains a macro. Please clarify."}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1577734843, "post_id": 59535810, "comment_id": 105241600, "body": "@chux-ReinstateMonica I meant having all the code that can be in a function be moved into a function, and the remaining (<code>sizeof(**ptr_)</code>, which can&#39;t go into a function) go into a less dangerous macro."}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "reply_to_user": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1577734938, "post_id": 59535810, "comment_id": 105241622, "body": "@JosephSible-ReinstateMonica I&#39;m not sure.  It says it&#39;s not portable, which I suspected.  But on POSIX all pointers have the same representation, which would make it (the explicit cast) portable (on POSIX at least) if that were the only problem.  But still I don&#39;t know if on some weird GCC optimizations that would bite me.  There is also the problem that malloc (and calloc) are a bit special and I don&#39;t know if the compiler will do the right thing through a <code>void **</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1577736234, "post_id": 59535810, "comment_id": 105242066, "body": "CacahueteFrito &quot;But on POSIX all pointers have the same representation&quot; are you sure object pointers and function pointer are specified by POSIX to have the same representation?  IAC, I think it is only object pointers of concern for this post."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1577736307, "post_id": 59535810, "comment_id": 105242100, "body": "The code is somewhat dubious. <code>calloc</code> of 0 elements is allowed to return a null pointer, but it isn&#39;t a failure as such."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1577736436, "post_id": 59535810, "comment_id": 105242140, "body": "@AnttiHaapala C17 changed that a bit."}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1577736779, "post_id": 59535810, "comment_id": 105242252, "body": "@AnttiHaapala Although it may or may not be an error for the standard, I think for a simple &amp; safe usage of this macro/function, I should return != 0, so that if return == 0 the pointer can be dereferenced and else it can&#39;t."}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1577736965, "post_id": 59535810, "comment_id": 105242312, "body": "@chux-ReinstateMonica About POSIX: I&#39;m not completely sure, but here&#39;s all I could get: <a href=\"https://pubs.opengroup.org/onlinepubs/009695399/functions/dlsym.html\" rel=\"nofollow noreferrer\">pubs.opengroup.org/onlinepubs/009695399/functions/dlsym.html</a>"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1577736974, "post_id": 59535810, "comment_id": 105242316, "body": "You can&#39;t reference a pointer that was callocated with 0 elements even if non-null"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1577737039, "post_id": 59535810, "comment_id": 105242341, "body": "@cacahuete: that is about convertability of  <i>values</i> not representation"}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1577737146, "post_id": 59535810, "comment_id": 105242388, "body": "@AnttiHaapala Am I missing something?  <code>if (!size || !nmemb)</code> calloc will return <code>NULL</code>, and therefore I will store <code>NULL</code> in the passed pointer and return a non-zero error code, so that the user doesn&#39;t try to further use the pointer."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1577737206, "post_id": 59535810, "comment_id": 105242408, "body": "On the contrary, the documentation explicitly says that only cast to and from void * is allowed, not to any other pointer type"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1577737383, "post_id": 59535810, "comment_id": 105242463, "body": "<i>&quot;If either nelem or elsize is 0, then either <b>a null pointer or a unique pointer value that can be successfully passed to free() shall be returned.</b>&quot;</i>"}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1577738090, "post_id": 59535810, "comment_id": 105242720, "body": "@AnttiHaapala OK, so to be safer I should prevent calling <code>calloc(0, whatever)</code> or <code>calloc(whatever, 0)</code> and manage those error cases myself instead.  Thanks!"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1577751385, "post_id": 59535810, "comment_id": 105246441, "body": "CacahueteFrito On the side issue of allocating zero memory, code could use <code>if (size == 0 || count = 0) ptr = malloc(1);</code> or <code>if (size == 0 || count = 0) ptr = NULL;</code> and avoid implementation defined behavior.  The first follows your model more.  the 2nd is more space conservative."}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1577751768, "post_id": 59535810, "comment_id": 105246513, "body": "@chux-ReinstateMonica  I did the second one, mainly because someone could write <code>callocs(&amp;ptr, 0)</code> (for some obscure reasons) and expect not having to free the pointer.  Also it is more logic that if my function returns a non-zero error code, meaning that something went wrong, I can&#39;t expect that the user will still free the pointer.  Safer to return NULL and avoid leaks at all.  I chose to differentiate error codes into positive (zero size allocation) and negative (allocation failure) to better inform the user.  BTW, great answer!"}], "answers": [{"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 1, "last_activity_date": 1577750960, "last_edit_date": 1577750960, "creation_date": 1577750631, "answer_id": 59538156, "question_id": 59535810, "link": "https://stackoverflow.com/questions/59535810/allocating-through-a-pointer-to-a-pointer-parameter/59538156#59538156", "title": "Allocating through a pointer to a pointer parameter", "body": "<blockquote>\n  <p>Is a simple explicit cast to (void **) safe?:<br>\n  And if not, would an intermediate pointer of type void * be enough?:</p>\n</blockquote>\n\n<p>The <code>(void **)</code> approach is reasonable, yet relies on <code>some_other_type **</code> being compatible with <code>void **</code>.  It falls under:</p>\n\n<blockquote>\n  <p>A pointer to an object type may be converted to a pointer to a different object type. If the resulting pointer is not correctly aligned for the referenced type, the behavior is undefined. Otherwise, when converted back again, the result shall compare equal to the original pointer. C17dr \u00a7 6.3.2.2 7</p>\n</blockquote>\n\n<p>So trouble in a rare case of a pointer to one type has a different alignment requirement than a pointer to a <code>void *</code>.  I doubt such an implementation exists.  To be clear, this is a difference of alignment requirement of pointer types, not the objects they point to.</p>\n\n<hr>\n\n<blockquote>\n  <p>Is there any other solution?</p>\n</blockquote>\n\n<p>To avoid \"passing argument 1 of callocs__ from incompatible pointer type\" and to maintain type correctness, consider making the helper function <code>callocs__()</code> as</p>\n\n<pre><code>void *callocs__(ptrdiff_t nmemb, size_t size, int *error);\n// ^------------return pointer to allocated data\n</code></pre>\n\n<p>Then </p>\n\n<pre><code>#define callocs(ptr, nmemb) (                             \\\n{                                                         \\\n        __auto_type     ptr_    = (ptr);                  \\\n        int error;                                        \\\n        *ptr = callocs__(nmemb, sizeof(**ptr_), &amp;error);  \\\n        error;                                            \\\n}                                                         \\\n)\n</code></pre>\n\n<hr>\n\n<p>Note: I applaud the the overall objective of making a function to handle the  subtle <a href=\"https://en.wiktionary.org/wiki/vagary\" rel=\"nofollow noreferrer\">vagaries</a> of <code>*alloc()</code>.</p>\n"}], "owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 59538156, "answer_count": 1, "score": 3, "last_activity_date": 1577750960, "creation_date": 1577733387, "last_edit_date": 1577734681, "question_id": 59535810, "link": "https://stackoverflow.com/questions/59535810/allocating-through-a-pointer-to-a-pointer-parameter", "title": "Allocating through a pointer to a pointer parameter", "body": "<p>I have this macro:</p>\n\n<pre><code>\n/*\n * int  callocs(type **ptr, size_t nmemb);\n *\n * Safe &amp; simple wrapper for `calloc()`.\n *\n * PARAMETERS:\n * ptr:     Memory will be allocated, and a pointer to it will be stored\n *          in *ptr.\n * nmemb:   Number of elements in the array.\n *\n * RETURN:\n *  0:          OK.\n *  != 0:       Failed.\n *\n * FEATURES:\n * - Safely computes the element size (second argument to `calloc()`).\n * - Returns non-zero on error.\n * - Doesn't cast.\n * - The pointer stored in `*ptr` is always a valid pointer or NULL.\n *\n * EXAMPLE:\n *      #define ALX_NO_PREFIX\n *      #include &lt;libalx/base/stdlib/alloc/callocs.h&gt;\n *\n *              int *arr;\n *\n *              if (callocs(&amp;arr, 7))       // int arr[7];\n *                      goto err;\n *\n *              // `arr` has been succesfully allocated here\n *              free(arr);\n *      err:\n *              // No memory leaks\n */\n#define callocs(ptr, nmemb) (                                           \\\n{                                                                       \\\n        __auto_type     ptr_    = (ptr);                                \\\n                                                                        \\\n        *ptr_   = calloc(nmemb, sizeof(**ptr_));                        \\\n                                                                        \\\n        !(*ptr_);                                                       \\\n}                                                                       \\\n)\n</code></pre>\n\n<p>and I would like it to be a function to improve safety.  This would be the first idea:</p>\n\n<pre><code>#define callocs(ptr, nmemb) (                                           \\\n{                                                                       \\\n        __auto_type     ptr_    = (ptr);                                \\\n                                                                        \\\n        callocs__(ptr_, nmemb, sizeof(**ptr_));                         \\\n}                                                                       \\\n)\n\n\nint     callocs__(void **ptr, ptrdiff_t nmemb, size_t size)\n{\n\n        if (nmemb &lt; 0)\n                goto ovf;\n\n        *ptr    = calloc(nmemb, size);\n\n        return  !*ptr;\novf:\n        errno   = ENOMEM;\n        *ptr    = NULL;\n        return  ENOMEM;\n}\n</code></pre>\n\n<p>But then the compiler complains with:</p>\n\n<pre><code>error: passing argument 1 of callocs__ from incompatible pointer type [-Werror=incompatible-pointer-types]\nnote: in expansion of macro callocs\nnote: expected void ** but argument is of type struct My_Struct **\n</code></pre>\n\n<p>Is a simple explicit cast to <code>(void **)</code> safe?:</p>\n\n<pre><code>#define callocs(ptr, nmemb) (                                           \\\n{                                                                       \\\n        __auto_type     ptr_    = (ptr);                                \\\n                                                                        \\\n        callocs__((void **)ptr_, nmemb, sizeof(**ptr_));                \\\n}                                                                       \\\n)\n</code></pre>\n\n<p>By safe I mean both from the Standard point of view (which I guess is not) and from implementations point of view (in this specific case, GNU C) (which I'm not sure).</p>\n\n<p>And if not, would an intermediate pointer of type <code>void *</code> be enough?:</p>\n\n<pre><code>#define callocs(ptr, nmemb) (                                           \\\n{                                                                       \\\n        __auto_type     ptr_    = (ptr);                                \\\n        void            *vp_;                                           \\\n        int             ret_;                                           \\\n                                                                        \\\n        ret_    = callocs__(&amp;vp_, nmemb, sizeof(**ptr_))                \\\n        *ptr_   = vp_;                                                  \\\n        ret_;                                                           \\\n}                                                                       \\\n)\n</code></pre>\n\n<p>Is there any other solution?</p>\n"}, {"tags": ["c", "function", "recursion", "sum", "definition"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1577731161, "post_id": 59535393, "comment_id": 105240352, "body": "Considering that you have a general statement outside of a function, the code you show won&#39;t even build. Perhaps that one of your problems (you have more than that)? If you ask questions about build errors, then include the actual errors you&#39;re wondering about in the question, copy-pasted in full and complete as text. Also please take some time to read about <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask good questions</a>, as well as <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">this question checklist</a>."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1577731228, "post_id": 59535393, "comment_id": 105240373, "body": "The defining characteristic of a recursive function is that it calls itself.  Your function does not do so.  Consider how you might do without variable <code>adder</code>, making use instead of the return value of a recursive call to <code>sum()</code>."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1577731321, "post_id": 59535393, "comment_id": 105240399, "body": "<code>return(sum);</code> - you don&#39;t have anything named <code>sum</code> except the function itself. Please, first write <i>some</i> code to calculate the sum, which is compiling and giving the correct result. Them change it to comply with your extra requirements. And let alone C. Can you write down a recursive formula for sum?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1577735427, "post_id": 59535393, "comment_id": 105241785, "body": "A recursive call is just like any other call to any function, and the syntax is exactly the same."}], "answers": [{"comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1577732111, "post_id": 59535535, "comment_id": 105240678, "body": "Why is this better? What changes did you make? Why did you make those changes? Code-only answers with no explanation is highly discourage because they tend to promote <a href=\"https://en.wikipedia.org/wiki/Cargo_cult_programming\" rel=\"nofollow noreferrer\">cargo cult programming</a> which is bad. And posting comments in answers (like your question) is also wrong. Please read (or refresh) <a href=\"https://stackoverflow.com/help/how-to-answer\">how to write good answers</a>."}, {"owner": {"reputation": 274, "user_id": 8977486, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7II8r.png?s=128&g=1", "display_name": "infinite", "link": "https://stackoverflow.com/users/8977486/infinite"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1577732421, "post_id": 59535535, "comment_id": 105240801, "body": "@Someprogrammerdude Will take care in future."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1577732526, "post_id": 59535535, "comment_id": 105240838, "body": "The leading whitespace is not needed in <code>&quot; %d&quot;</code> since the <code>%d</code> directive automatically discards leading whitespace."}, {"owner": {"reputation": 284, "user_id": 12571460, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCfdmLEtpNndCH3GzEC7Pps5wv1KvzZiwCtjEHs=k-s128", "display_name": "Lxer Lx", "link": "https://stackoverflow.com/users/12571460/lxer-lx"}, "edited": false, "score": 0, "creation_date": 1577733943, "post_id": 59535535, "comment_id": 105241310, "body": "What is the point of using a file scope variable <code>sum_val</code>, instead of returning the resulting sum from the function?"}], "tags": [], "owner": {"reputation": 274, "user_id": 8977486, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7II8r.png?s=128&g=1", "display_name": "infinite", "link": "https://stackoverflow.com/users/8977486/infinite"}, "is_accepted": false, "score": 0, "last_activity_date": 1577731807, "creation_date": 1577731807, "answer_id": 59535535, "question_id": 59535393, "link": "https://stackoverflow.com/questions/59535393/having-trouble-creating-a-program-that-uses-recursion/59535535#59535535", "title": "Having trouble creating a program that uses recursion", "body": "<p>change your code to:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint sum_val=0;\n\nvoid sum(int numba) \n{\n    if(numba&gt;=1)\n    {\n        sum_val=sum_val+numba;\n        sum(numba-1);\n    }\n}\n\nint main() \n{\n    int nummba;\n    printf(\"Enter in a number: \");\n    scanf(\" %d\",&amp;nummba);\n    sum(nummba);\n    printf(\"The sum of numbers from 1 to %d is %d.\", nummba, sum_val);\n    return(0);\n}\n</code></pre>\n\n<p>Did you compile your code?</p>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 2, "last_activity_date": 1577732485, "last_edit_date": 1577732485, "creation_date": 1577731915, "answer_id": 59535560, "question_id": 59535393, "link": "https://stackoverflow.com/questions/59535393/having-trouble-creating-a-program-that-uses-recursion/59535560#59535560", "title": "Having trouble creating a program that uses recursion", "body": "<p>For starters there is no need to use global variables.</p>\n\n<p>Secondly in these statements</p>\n\n<pre><code>return(sum);\n</code></pre>\n\n<p>and </p>\n\n<pre><code>return(sum+adder);\n</code></pre>\n\n<p><code>sum</code> is a pointer to function. So the expressions of the return statements do not make sense.</p>\n\n<p>Moreover this code snippet</p>\n\n<pre><code>int adder;\nadder=1;\n</code></pre>\n\n<p>will not even compile because you may not use statements in the file scope. At least you should write</p>\n\n<pre><code>int adder = 1;\n</code></pre>\n\n<p>The function can look the following way</p>\n\n<pre><code>unsigned long long int sum( unsigned int n )\n{\n    return n == 0 ? 0 : n + sum( n - 1 );\n}\n</code></pre>\n\n<p>Here is a demonstrative program.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nunsigned long long int sum( unsigned int n )\n{\n    return n == 0 ? 0 : n + sum( n - 1 );\n}\n\nint main(void) \n{\n    printf( \"Enter in a non-negative number: \" );\n\n    unsigned int n = 0;\n\n    scanf( \"%u\", &amp;n );\n\n    printf( \"The sum of numbers from 0 to %u is %llu.\\n\", n, sum( n ) );\n\n    return 0;\n}\n</code></pre>\n\n<p>Its output might look like</p>\n\n<pre><code>Enter in a non-negative number: 10\nThe sum of numbers from 0 to 10 is 55.\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1577733169, "post_id": 59535692, "comment_id": 105241080, "body": "And a third solution would be <code>return n * (n+1) &#47; 2;</code>. If we are discussing options here..."}, {"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1577733199, "post_id": 59535692, "comment_id": 105241088, "body": "Yes of course. How did I miss that? :)"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1577734040, "post_id": 59535692, "comment_id": 105241344, "body": "<code>sizeof(line) - 1</code> --&gt; <code>sizeof line</code>: <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.21.7.2p2\" rel=\"nofollow noreferrer\"><code>fgets()</code> reads at most one less than the maximum number of characters specified, leaving room for the <code>\\0</code> terminator.</a> More significantly, <code>sum()</code> needs to return something when the base case is not satisfied; maybe you meant something like: <code>n += sum(n - 1);</code> --&gt; <code>return n + sum(n - 1)</code>. Also, careful with negative numbers in the input...."}, {"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1577734327, "post_id": 59535692, "comment_id": 105241441, "body": "@exnihilo good points; edited. As for negative numbers, <code>unsigned</code> could be used in place of <code>int</code> but that requires to change the conversion specifier from <code>%d</code> to <code>%u</code>, and since the OP mentioned that he is a beginner, I don&#39;t want to overwhelm him by making a lot of changes to the code."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 2, "creation_date": 1577734399, "post_id": 59535692, "comment_id": 105241469, "body": "I wouldn&#39;t worry about introducing <code>unsigned</code> types, but you could make clear in the input prompt that input should be non-negative ;)"}, {"owner": {"reputation": 284, "user_id": 12571460, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCfdmLEtpNndCH3GzEC7Pps5wv1KvzZiwCtjEHs=k-s128", "display_name": "Lxer Lx", "link": "https://stackoverflow.com/users/12571460/lxer-lx"}, "edited": false, "score": 1, "creation_date": 1577735179, "post_id": 59535692, "comment_id": 105241700, "body": "I&#39;d change the comparison in order to check negative values: <code>if (n &lt;= 0) return 0; else return n + sum(n - 1);</code> (or a one-liner: <code>int sum (int n) { return n &gt; 0 ? n + sum(n - 1) : 0; }</code>). But I woudn&#39;t write a recursive function for this task, in the first place. The original question is not a good example to use recursion."}], "tags": [], "owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "is_accepted": false, "score": 1, "last_activity_date": 1577734095, "last_edit_date": 1577734095, "creation_date": 1577732599, "answer_id": 59535692, "question_id": 59535393, "link": "https://stackoverflow.com/questions/59535393/having-trouble-creating-a-program-that-uses-recursion/59535692#59535692", "title": "Having trouble creating a program that uses recursion", "body": "<p>Recursion requires that a function calls itself. You are not doing this, so you do not have a recursive function in the first place. Consider the following code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint sum(int n) {\n    if (n == 0)\n        return n;\n    else\n        return n + sum(n - 1);\n}\n\nint main() {\n    int n;\n    char line[100];\n\n    printf(\"Enter in a number: \");\n    fgets(line, sizeof(line), stdin);\n\n    sscanf(line, \"%d\", &amp;n);\n    printf(\"The sum of numbers from 1 to %d is %d.\\n\", n, sum(n));\n\n    return(0);\n}\n</code></pre>\n\n<p>If you find recursion a bit difficult for now, you can opt for a less difficult solution using a <code>while</code> loop:</p>\n\n<pre><code>int sum(int n)\n{\n    int i = 0;\n    int j = 1;\n\n    while (j &lt;= n)\n    {\n        i += j++;\n    }\n    return i;\n}\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 12627139, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mD1dIJLtV9RQL9E88IEeK4vv9p5HCj8BBeS7B6ESw=k-s128", "display_name": "Codingnoob", "link": "https://stackoverflow.com/users/12627139/codingnoob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "closed_date": 1577751402, "answer_count": 3, "score": 0, "last_activity_date": 1577734095, "creation_date": 1577731010, "last_edit_date": 1577732814, "question_id": 59535393, "link": "https://stackoverflow.com/questions/59535393/having-trouble-creating-a-program-that-uses-recursion", "closed_reason": "Needs details or clarity", "title": "Having trouble creating a program that uses recursion", "body": "<p>I'm trying to write a program that calculates 1+2+3...+n with recursion. I'm just starting to learn C so I'm pretty bad...\nHere's what I have right now:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint adder;\nadder=1;\nint sum(int numba) {\n    if (adder==numba) {\n        return(sum);\n    }\n    return(sum+adder);\n    ++adder;\n}\n\nint main() {\n    char line[100];\n    int nummba;\n    printf(\"Enter in a number: \");\n    fgets(line, sizeof(line), stdin);\n    sscanf(line, \"%d\", nummba);\n    printf(\"The sum of numbers from 1 to %d is %d.\", nummba, sum(nummba));\n    return(0);\n\n}\n</code></pre>\n\n<p>Obviously doesn't work...\nHow do I use recursion to solve 1+2+3...n?\nThanks.</p>\n"}, {"tags": ["c++", "c", "linker"], "answers": [{"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 2, "last_activity_date": 1577734222, "last_edit_date": 1577734222, "creation_date": 1577733408, "answer_id": 59535817, "question_id": 59535357, "link": "https://stackoverflow.com/questions/59535357/why-is-the-entry-in-my-linker-script-not-being-set-to-the-address-sectio/59535817#59535817", "title": "Why is the ENTRY() in my linker script not being set to the . = &lt;address&gt; section?", "body": "<blockquote>\n  <p>I should see the main() symbol located at 0x200000, right?</p>\n</blockquote>\n\n<p>No. Imagine how many things have to be done before main is called. Libraries have to be initialized, constructors and destructors called (C++), on many systems .bss zeroed and .data initialized + many other things I do not remember now.</p>\n\n<p>The <code>main</code> is the entry point of the <code>C</code> program but is not (in almost all known implementarions) the entry point of the executable file.</p>\n\n<p>if you want <strong>your</strong> function to be called first, place it in the separate segment and amend the linker script</p>\n\n<pre><code>    .text : {\n            *(.beforetext) \n            . = ALIGN(8);\n            __text_start = .;\n            *(.text)\n            . = ALIGN(8);\n    }\n</code></pre>\n\n<pre><code>\nextern unsigned __text_start;\n\nvoid __attribute__((section(\".beforetext\"))) myEntryFunc(void) \n{\n ....\n\n ((void (*)(void))(&amp;__text_start))(); // call the original executable entry point\n}\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 8021689, "user_type": "registered", "profile_image": "https://graph.facebook.com/1632796396733035/picture?type=large", "display_name": "Jon Taylor", "link": "https://stackoverflow.com/users/8021689/jon-taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1577734222, "creation_date": 1577730841, "question_id": 59535357, "link": "https://stackoverflow.com/questions/59535357/why-is-the-entry-in-my-linker-script-not-being-set-to-the-address-sectio", "title": "Why is the ENTRY() in my linker script not being set to the . = &lt;address&gt; section?", "body": "<p>I am trying to relocate the entry point of a statically-linked binary I am building to a fixed value, so it can be loaded into that area of memory by a bootloader and jumped into with a function pointer dereference.  Here is the loader script I am using:</p>\n\n<pre><code>ENTRY(main)\nSECTIONS\n{\n        . = 0x0000000000200000;\n        .text : {\n                *(.text)\n                . = ALIGN(8);\n        }\n        .data : {\n                *(.data)\n                *(.rodata)\n                . = ALIGN(8);\n        }\n        __bss_start = .;\n        .bss : {\n                bss = .; _bss = .; __bss = .;\n                *(.bss);\n        }\n        end = .; _end = .; __end = .;\n\n  .preinit_array    :\n  {\n    PROVIDE_HIDDEN (__preinit_array_start = .);\n    KEEP (*(.preinit_array))\n    PROVIDE_HIDDEN (__preinit_array_end = .);\n  }\n  .init_array    :\n  {\n    PROVIDE_HIDDEN (__init_array_start = .);\n    KEEP (*(SORT_BY_INIT_PRIORITY(.init_array.*) SORT_BY_INIT_PRIORITY(.ctors.*)))\n    KEEP (*(.init_array EXCLUDE_FILE (*crtbegin.o *crtbegin?.o *crtend.o *crtend?.o ) .ctors))\n    PROVIDE_HIDDEN (__init_array_end = .);\n  }\n  .fini_array    :\n  {\n    PROVIDE_HIDDEN (__fini_array_start = .);\n    KEEP (*(SORT_BY_INIT_PRIORITY(.fini_array.*) SORT_BY_INIT_PRIORITY(.dtors.*)))\n    KEEP (*(.fini_array EXCLUDE_FILE (*crtbegin.o *crtbegin?.o *crtend.o *crtend?.o ) .dtors))\n    PROVIDE_HIDDEN (__fini_array_end = .);\n  }\n}\n</code></pre>\n\n<p>Here is the command line I am using for the final link:</p>\n\n<pre><code>...\nCC = g++\nCFLAGS = -g -mcmodel=large -fPIC -T src/controlix.ld -Wl,--no-relax -static -nostdlib -static-libgcc\n...\n$(CC) $(CFLAGS) $(shell find bin/ -name \"*.o\") -o $(TARGET_OBJ)\n</code></pre>\n\n<p>(Details of the rest of the build system omitted for brevity, I don't think any of it is pertinent)</p>\n\n<p>So, I am assuming that when I look at the resultant controlix.o binary, I should see the main() symbol located at 0x200000, right?  Wrong:</p>\n\n<pre><code>$ nm bin/controlix.o |grep main\n000000000021d0c6 t _GLOBAL__sub_D_main.cpp\n000000000021d087 t _GLOBAL__sub_I_main.cpp\n000000000021cef1 T main\n0000000000256e11 t _ZL8eiremainPtS_P7LDPARMS\n</code></pre>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["c", "string", "char", "null-terminated"], "comments": [{"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 2, "creation_date": 1577728868, "post_id": 59534956, "comment_id": 105239573, "body": "<code>strcpy(p, &quot;abcdefghijklmnopqrstuvwxyz123456789abcdefghijklmnopqrstuvwx&zwnj;&#8203;yz&quot;);</code> invokes <i>undefined behavior</i> - any results you get from this code are meaningless"}, {"owner": {"reputation": 354, "user_id": 11389043, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-I_o3Ep6MDig/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc0hwvbl7DiKIK7zqQbH5zk3uSsBw/mo/photo.jpg?sz=128", "display_name": "Alex B", "link": "https://stackoverflow.com/users/11389043/alex-b"}, "reply_to_user": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 4, "creation_date": 1577728983, "post_id": 59534956, "comment_id": 105239604, "body": "<code>char *p = malloc(sizeof(char));</code> = you allocate 1 byte and copy a far longer string later on to this address, so you&#39;re overwriting random memory locations (@UnholySheep)   And the addresses differ by more than 1 byte because memory is usually allocated on aligned addresses. How it is aligned differs by compiler and system, but usually alignments are on 4, 8, 16 or 32 byte boundaries."}, {"owner": {"reputation": 354, "user_id": 11389043, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-I_o3Ep6MDig/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc0hwvbl7DiKIK7zqQbH5zk3uSsBw/mo/photo.jpg?sz=128", "display_name": "Alex B", "link": "https://stackoverflow.com/users/11389043/alex-b"}, "edited": false, "score": 1, "creation_date": 1577729189, "post_id": 59534956, "comment_id": 105239677, "body": "The zero-termination is caused by strcpy. Look it up :-)"}, {"owner": {"reputation": 2429, "user_id": 1098603, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/sb0id.png?s=128&g=1", "display_name": "Matthieu", "link": "https://stackoverflow.com/users/1098603/matthieu"}, "reply_to_user": {"reputation": 354, "user_id": 11389043, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-I_o3Ep6MDig/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc0hwvbl7DiKIK7zqQbH5zk3uSsBw/mo/photo.jpg?sz=128", "display_name": "Alex B", "link": "https://stackoverflow.com/users/11389043/alex-b"}, "edited": false, "score": 0, "creation_date": 1577729559, "post_id": 59534956, "comment_id": 105239788, "body": "@AlexB why not make an answer out of your two comments?"}, {"owner": {"reputation": 354, "user_id": 11389043, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-I_o3Ep6MDig/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc0hwvbl7DiKIK7zqQbH5zk3uSsBw/mo/photo.jpg?sz=128", "display_name": "Alex B", "link": "https://stackoverflow.com/users/11389043/alex-b"}, "reply_to_user": {"reputation": 274, "user_id": 8977486, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7II8r.png?s=128&g=1", "display_name": "infinite", "link": "https://stackoverflow.com/users/8977486/infinite"}, "edited": false, "score": 1, "creation_date": 1577729660, "post_id": 59534956, "comment_id": 105239824, "body": "@infinite chars can start on any byte address, but malloc always allocates aligned storage. Which alignment it chooses is undefined."}, {"owner": {"reputation": 180, "user_id": 10481046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0WIaY.png?s=128&g=1", "display_name": "JaeMann Yeh", "link": "https://stackoverflow.com/users/10481046/jaemann-yeh"}, "edited": false, "score": 1, "creation_date": 1577729744, "post_id": 59534956, "comment_id": 105239860, "body": "&quot;abcdefghijklmnopqrstuvwxyz123456789abcdefghijklmnopqrstuvwx&zwnj;&#8203;yz&quot; has a null and strcpy copies the null."}, {"owner": {"reputation": 354, "user_id": 11389043, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-I_o3Ep6MDig/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc0hwvbl7DiKIK7zqQbH5zk3uSsBw/mo/photo.jpg?sz=128", "display_name": "Alex B", "link": "https://stackoverflow.com/users/11389043/alex-b"}, "reply_to_user": {"reputation": 2429, "user_id": 1098603, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/sb0id.png?s=128&g=1", "display_name": "Matthieu", "link": "https://stackoverflow.com/users/1098603/matthieu"}, "edited": false, "score": 1, "creation_date": 1577730151, "post_id": 59534956, "comment_id": 105240019, "body": "Just did, thanks for the heads-up @Matthieu"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1577739357, "post_id": 59534956, "comment_id": 105243124, "body": "<code>NULL</code> is (a macro that expands to) a <i>null pointer constant</i>. It&#39;s not related to the <i>null character</i> that terminates a string. Strings are null-terminated, not NULL-terminated."}], "answers": [{"tags": [], "owner": {"reputation": 354, "user_id": 11389043, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-I_o3Ep6MDig/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc0hwvbl7DiKIK7zqQbH5zk3uSsBw/mo/photo.jpg?sz=128", "display_name": "Alex B", "link": "https://stackoverflow.com/users/11389043/alex-b"}, "is_accepted": false, "score": 1, "last_activity_date": 1577730011, "creation_date": 1577730011, "answer_id": 59535185, "question_id": 59534956, "link": "https://stackoverflow.com/questions/59534956/char-pointer-null-termination-and-memory-allocation/59535185#59535185", "title": "Char pointer NULL termination and memory allocation", "body": "<ol>\n<li>You allocate 1 byte of storage for both <code>p</code> and <code>q</code></li>\n<li>You copy a string far longer than that (in fact, any string longer than an empty string wouldn't fit) to <code>p</code>, which triggers undefined behavior.</li>\n</ol>\n\n<p>Since the C std lib underneath the compiler (its malloc implementation in fact) seems to choose 32 byte aligned allocations and since no other allocations happen in between, the two pointers are in your case 32 bytes apart.</p>\n\n<p><code>strcpy</code> copies the too-long string to <code>p</code> including a zero-terminator (see c docs).</p>\n\n<p><code>q</code> will thus point to <code>p</code> + 32 bytes, explaining the remaining behavior.</p>\n\n<p>Side note: If you're approaching C, especially as a beginner, always have the docs ready. Undefined behavior strikes more often than not.</p>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 2, "last_activity_date": 1577730284, "creation_date": 1577730284, "answer_id": 59535237, "question_id": 59534956, "link": "https://stackoverflow.com/questions/59534956/char-pointer-null-termination-and-memory-allocation/59535237#59535237", "title": "Char pointer NULL termination and memory allocation", "body": "<blockquote>\n  <ol>\n  <li>Why there is a difference of 32 bytes between address of p and q. I have allocated 1 byte only for P. How automatically 32 byte difference\n  between successive malloc?</li>\n  </ol>\n</blockquote>\n\n<p>Because that's how your implementation chooses to do it.  There's no requirement for any particular relationship between the return values of any two calls to <code>malloc()</code>, even consecutive ones such as yours.</p>\n\n<p>In practice, C implementations tend to allocate memory with multi-byte granularity, even when the requested size is less, and that's what you appear to be observing.  That absolutely does not mean it's ok to access memory beyond the boundaries of what you explicitly requested.</p>\n\n<blockquote>\n  <ol start=\"2\">\n  <li>I have not NULL terminated my Strings. How printf detecting the \\0 termination?</li>\n  <li>How strlen is also working fine without a \\0 termination?</li>\n  </ol>\n</blockquote>\n\n<p>Who says your strings are not terminated?  The string literal certainly is.  Beyond that, you produce undefined behavior by overrunning the bounds of the allocated space to which <code>p</code> points, so anything can happen.</p>\n\n<p>If you want to speculate about the UB then you might guess based on the observed output that the <code>strcpy</code> copies bytes from the source string into the memory starting at <code>*p</code>, continuing through all the unallocated bytes between that and <code>*q</code>, and on into the unallocated space beyond <code>*q</code> until eventually it copies the nul byte.  You might then guess that <code>printf</code> and <code>strlen</code> similarly read from one or the other starting point into the unallocated regions.</p>\n\n<p>That might or might not accurately describe what actually happens, and under no circumstance should you interpret the observed results as an indication that such program behavior is either predictable or acceptable.  In particular, such behavior often produces corruption of the allocator's metadata, which might manifest when you attempt to free the allocated space or allocate other space.</p>\n"}], "owner": {"reputation": 1, "user_id": 12626895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f6735935023c7621bad945268b1e168?s=128&d=identicon&r=PG&f=1", "display_name": "JDS", "link": "https://stackoverflow.com/users/12626895/jds"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "closed_date": 1577736599, "answer_count": 2, "score": -1, "last_activity_date": 1577736876, "creation_date": 1577728789, "last_edit_date": 1577728904, "question_id": 59534956, "link": "https://stackoverflow.com/questions/59534956/char-pointer-null-termination-and-memory-allocation", "closed_reason": "Duplicate", "title": "Char pointer NULL termination and memory allocation", "body": "<p>I have the following program : My program compiles fine and gives the output as mentioned below . I have some question on output which is listed at the bottom.\n*******************************************************************************/</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n    char *p = malloc(sizeof(char));\n    char *q = malloc(sizeof(char));\n    printf(\"address of p = %p \\n\", p); A\n    printf(\"address of q = %p \\n\", q); B\n    strcpy(p, \"abcdefghijklmnopqrstuvwxyz123456789abcdefghijklmnopqrstuvwxyz\");\n    printf(\"Value in P : %s \\n\", p); C\n    printf(\"Value in q : %s\\n\", q); D\n    printf(\"string length of P : %d \\n\", strlen(p)); E\n    printf(\"string lenght of q : %d\\n\", strlen(q)); F\n\n    return 0;\n}\n\n===OUTPUT ==\naddress of p = 0xbbf010 \naddress of q = 0xbbf030 \nValue in P : abcdefghijklmnopqrstuvwxyz123456789abcdefghijklmnopqrstuvwxyz \nValue in q : 789abcdefghijklmnopqrstuvwxyz\nstring length of P : 61 \nstring lenght of q : 29\n</code></pre>\n\n<p>=====OUTPUT END==</p>\n\n<p>Questions :<br>\n1. Why there is a difference of 32 bytes between address of p and q. I have allocated 1 byte only for P. How automatically 32 byte difference between successive <code>malloc</code>?<br>\n2. I have not <code>NULL</code> terminated my Strings. How <code>printf</code> detecting the <code>\\0</code> termination?<br>\n3. How <code>strlen</code> is also working fine without a <code>\\0</code> termination?</p>\n"}, {"tags": ["c", "standards"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1577727308, "post_id": 59534546, "comment_id": 105239010, "body": "There is p4 in 6.7.2.2 which is adding confusion: <i>Each enumerated type shall be compatible with char, a signed integer type, or an unsigned integer type. The choice of type is implementation-defined, but shall be capable of representing the values of all the members of the enumeration.</i>"}], "answers": [{"tags": [], "owner": {"reputation": 5024, "user_id": 4439794, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/ogyE1.png?s=128&g=1", "display_name": "Trevor", "link": "https://stackoverflow.com/users/4439794/trevor"}, "is_accepted": false, "score": 6, "last_activity_date": 1577751597, "last_edit_date": 1577751597, "creation_date": 1577727989, "answer_id": 59534819, "question_id": 59534546, "link": "https://stackoverflow.com/questions/59534546/undefined-behaviour-by-declaration/59534819#59534819", "title": "Undefined behaviour by declaration", "body": "<p>The standard also states that:</p>\n\n<blockquote>\n  <p>Each subsequent enumerator with <code>no=</code> defines  its  enumeration  constant\n  as  the  value  of  the  constant  expression  obtained  by adding <code>1</code> to\n  the value of the previous enumeration constant.</p>\n</blockquote>\n\n<p>A good-enough C compiler should give you <code>error: overflow in enumeration values</code>, so you won't even pass the compiling phase.  </p>\n\n<p>If you do this instead, you might get rid of that warning:</p>\n\n<pre><code>enum {\n   x = INT_MAX,\n   y = INT_MAX + 1,\n};\n</code></pre>\n\n<p>Anyway, even if you get no problem with compiling: yes, it's undefined behavior because you got signed integer overflow.</p>\n"}], "owner": {"reputation": 11406, "user_id": 282614, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9cd35c711e222946f9503628827a32ce?s=128&d=identicon&r=PG", "display_name": "Dacav", "link": "https://stackoverflow.com/users/282614/dacav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 1, "closed_date": 1577770846, "answer_count": 1, "score": 9, "last_activity_date": 1577751597, "creation_date": 1577726532, "last_edit_date": 1592644375, "question_id": 59534546, "link": "https://stackoverflow.com/questions/59534546/undefined-behaviour-by-declaration", "closed_reason": "Duplicate", "title": "Undefined behaviour by declaration", "body": "<p>Let's talk about <code>enum</code> in C.</p>\n<p>According to the C standard (ISO/IEC 9899:201x), the following statements hold true:</p>\n<ul>\n<li>\u00a7 6.7.2.2:</li>\n</ul>\n<blockquote>\n<p>The expression that defines the value of an enumeration constant shall be an integer constant expression that has a value representable as an int.</p>\n<p>The identifiers in an enumerator list are declared as constants that have type int and may appear wherever such are permitted.127) An enumerator with = defines its enumeration constant as the value of the constant expression. If the first enumerator has no =, the value of its enumeration constant is 0. Each subsequent enumerator with no = defines its enumeration constant as the value of the constant expression obtained by adding 1 to the value of the previous enumeration constant. [...]</p>\n</blockquote>\n<ul>\n<li>\u00a7 6.5:</li>\n</ul>\n<blockquote>\n<p>If an exceptional condition occurs during the evaluation of an expression (that is, if the result is not mathematically defined or not in the range of representable values for its type), the behavior is undefined.</p>\n</blockquote>\n<p>Analogously to <a href=\"https://stackoverflow.com/questions/53681947/can-an-enum-hold-unsigned-integers-greater-than-int-max\">can an enum hold unsigned integers greater than INT_MAX?</a>, should I infer that the following is undefined?</p>\n<pre><code>#include &lt;limits.h&gt;\nenum {\n   x = INT_MAX,\n   y,\n};\n</code></pre>\n"}, {"tags": ["android", "c", "raspberry-pi"], "answers": [{"comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1577727539, "post_id": 59534729, "comment_id": 105239090, "body": "A cloud web service might be more convenient, but you don&#39;t need it for this, and it will cost extra."}, {"owner": {"reputation": 1132, "user_id": 10048703, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g4Etl.png?s=128&g=1", "display_name": "davidm", "link": "https://stackoverflow.com/users/10048703/davidm"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1577727780, "post_id": 59534729, "comment_id": 105239165, "body": "I agree, but you have to consider each option, it all depends on what the OP wants to implement."}, {"owner": {"reputation": 395, "user_id": 6569194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7356e402fcc1faecddad079bbe9814dc?s=128&d=identicon&r=PG&f=1", "display_name": "Amaterastis", "link": "https://stackoverflow.com/users/6569194/amaterastis"}, "edited": false, "score": 1, "creation_date": 1577742796, "post_id": 59534729, "comment_id": 105244292, "body": "Yeah, I understand now. I was only familiar with LAN network so I was thinking with that logic. Thank you for the suggestions. They actually help and point in the right direction. :)"}], "tags": [], "owner": {"reputation": 1132, "user_id": 10048703, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g4Etl.png?s=128&g=1", "display_name": "davidm", "link": "https://stackoverflow.com/users/10048703/davidm"}, "is_accepted": true, "score": 1, "last_activity_date": 1577727952, "last_edit_date": 1577727952, "creation_date": 1577727424, "answer_id": 59534729, "question_id": 59534446, "link": "https://stackoverflow.com/questions/59534446/rpi-create-a-rpi-server-which-can-be-accessed-from-another-device/59534729#59534729", "title": "RPi: Create a RPi server which can be accessed from another device", "body": "<p>In my opinion the easiest way to acheive your goal way is the following:</p>\n\n<ol>\n<li>Connect your RPi to your router like any other standard device.</li>\n<li>If you want to reach your RPi from the Internet you gonna need to do some <a href=\"https://en.wikipedia.org/wiki/Port_forwarding\" rel=\"nofollow noreferrer\">port forwarding</a> on your router,+.</li>\n<li>On the RPi install a web server like <a href=\"https://httpd.apache.org/\" rel=\"nofollow noreferrer\">Apache</a> or <a href=\"https://www.nginx.com/\" rel=\"nofollow noreferrer\">NGINX</a> and to store some data you gonna need a database.\n3.1. Maybe checkout <a href=\"https://www.djangoproject.com/\" rel=\"nofollow noreferrer\">Python Django</a> it can facilitate the development of the API.</li>\n<li>Finally you need to develop the App.</li>\n</ol>\n\n<p>Before you start developing consider all the possible solutions maybe a cloud web service could help you and save some time. </p>\n\n<p>Also check <a href=\"http://mqtt.org/\" rel=\"nofollow noreferrer\">MQTT</a> which is a lightweight protocol designed for IoT devices and could also help if you need to send commands or other data from the App to the RPi  and vice versa. <a href=\"https://android.jlelse.eu/about-the-mqtt-protocol-for-iot-on-android-efb4973577b\" rel=\"nofollow noreferrer\">Link.</a> </p>\n\n<p>This are few suggestions since you didn't specify what is your idea.</p>\n"}], "owner": {"reputation": 395, "user_id": 6569194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7356e402fcc1faecddad079bbe9814dc?s=128&d=identicon&r=PG&f=1", "display_name": "Amaterastis", "link": "https://stackoverflow.com/users/6569194/amaterastis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "closed_date": 1577730434, "accepted_answer_id": 59534729, "answer_count": 1, "score": 1, "last_activity_date": 1577727952, "creation_date": 1577725977, "question_id": 59534446, "link": "https://stackoverflow.com/questions/59534446/rpi-create-a-rpi-server-which-can-be-accessed-from-another-device", "closed_reason": "Needs more focus", "title": "RPi: Create a RPi server which can be accessed from another device", "body": "<p>I am trying to do the following:</p>\n\n<pre><code>(1) Connect RPi to a network (home router);\n(2) Make RPi as a server;\n(3) Create an Android application which can connect to RPi;\n(4) Connect Android application which uses Mobile Data to RPi from anywhere in the world.\n</code></pre>\n\n<p>Can anyone guide me in brute how to do this?\nWhat should I do with client/server applications to make it possible?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 354, "user_id": 11389043, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-I_o3Ep6MDig/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc0hwvbl7DiKIK7zqQbH5zk3uSsBw/mo/photo.jpg?sz=128", "display_name": "Alex B", "link": "https://stackoverflow.com/users/11389043/alex-b"}, "edited": false, "score": 3, "creation_date": 1577723813, "post_id": 59533998, "comment_id": 105237682, "body": "You pass <code>len</code> as parameter <code>size_res</code>, but <code>len</code> itself is a pointer which is uninitialized. Change <code>int* len</code> to <code>int len</code> and change the argument from <code>, len</code> to <code>, &amp;len</code>."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1577723937, "post_id": 59533998, "comment_id": 105237745, "body": "Why do you compute the string length every time through the loop?  Why not compute it once, before entering the loop, and save the result?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1577724960, "post_id": 59533998, "comment_id": 105238146, "body": "You do not allocate enough space for <code>barr</code>.  You provide space sufficient for <code>size_arr</code> <i>bytes</i>, but you need up to enough space for that many <i>pointers</i> (to <code>char</code>)."}, {"owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 0, "creation_date": 1577741328, "post_id": 59533998, "comment_id": 105243790, "body": "Comments are not for extended discussion; this conversation has been <a href=\"https://chat.stackoverflow.com/rooms/205107/discussion-on-question-by-tal-rofe-return-the-strings-that-are-smaller-lexicogr\">moved to chat</a>."}], "owner": {"reputation": 791, "user_id": 9105207, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BiyPF.png?s=128&g=1", "display_name": "Tal Rofe", "link": "https://stackoverflow.com/users/9105207/tal-rofe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1577726075, "creation_date": 1577723670, "last_edit_date": 1577726075, "question_id": 59533998, "link": "https://stackoverflow.com/questions/59533998/return-the-strings-that-are-smaller-lexicographically-from-a-given-string", "title": "Return the strings that are smaller (lexicographically) from a given string", "body": "<p>Given array of strings, its size and another 1 string, I need to return an array of strings, which these strings are <code>&lt;</code> (<strong>lexicographically</strong>) from the given string. Also: return the length of the returned array using given pointer <code>size_res</code>.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nchar** LowerSTR(char* arr[], int size_arr, char* str, int* size_res) {\n    size_t i, j;\n    char** barr = malloc(size_arr);\n    *size_res = 0;\n    ------&gt; printf(\"TEST\"); &lt;-----\n\n    for(i=0; i&lt;size_arr; i++) {\n        for(j=0; j&lt;strlen(str); j++) {\n            if (arr[i][j] == '\\0' || (int)(arr[i][j]) &lt; (int)(str[j])) {\n                barr[(*size_res)++] = arr[i];\n                break;\n            }\n            else if ((int)(arr[i][j]) == (int)(str[j])) {\n                continue;\n            }\n            else {\n                break;\n            }\n        }\n    }\n\n    if (*size_res == 0) return NULL;\n    return barr;\n}\n</code></pre>\n\n<p>I tried to test my code with this main:</p>\n\n<pre><code>int main() {\n    int* len;\n    char* arr[] = {\"hello\", \"hola\"};\n    char** ans = LowerSTR(arr, 2, \"bonjour\", len);\n    printf(\"%d\", *len);\n\n    return 0;\n}\n</code></pre>\n\n<p>But the line above the test <code>printf</code>(highlighted with <code>----&gt; &lt;----</code> in the function) causes error: <code>segmentation fault</code> - I cannot understand why..</p>\n\n<p>code with <code>strcmp</code>:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nchar** LowerSTR(char* arr[], int size_arr, char* str, int* size_res) {\n    size_t i;\n    char** barr = malloc(size_arr);\n    *size_res = 0;\n\n    for(i=0; i&lt;size_arr; i++) {\n        if (strcmp(arr[i], str) &lt;= 0)\n            barr[(*size_res)++] = arr[i];\n    }\n\n    if (*size_res == 0) return NULL;\n    return barr;\n}\n</code></pre>\n"}, {"tags": ["c", "string", "c-strings", "strcat"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1577722624, "post_id": 59533719, "comment_id": 105237216, "body": "Please think about the reason you allocate <code>len + 1</code> bytes... Why is the <code>+1</code> there? Do you <i>use</i> the extra byte you allocate?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1577722668, "post_id": 59533719, "comment_id": 105237231, "body": "Also please think about what happens to the memory you allocate in <code>reverseWord</code>. When and where is it free&#39;d?"}, {"owner": {"reputation": 2089, "user_id": 5616565, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/xdEXf.jpg?s=128&g=1", "display_name": "DarkSuniuM", "link": "https://stackoverflow.com/users/5616565/darksunium"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1577723230, "post_id": 59533719, "comment_id": 105237460, "body": "@Someprogrammerdude Actually I&#39;m a C newbie, Thanks for pointing out the thing I need to read more about, The first one, I have no Idea, The second one was one of my concerns, but ofcourse I can&#39;t <code>free</code> a variable and then return it"}, {"owner": {"reputation": 697, "user_id": 2096928, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/du211.png?s=128&g=1", "display_name": "Joel Trauger", "link": "https://stackoverflow.com/users/2096928/joel-trauger"}, "edited": false, "score": 1, "creation_date": 1577723454, "post_id": 59533719, "comment_id": 105237545, "body": "consider the use of the <code>strtok</code> function and how it can prevent you from leaking memory. pass the output of <code>strtok</code> to your reverse word function and then perform an in-place reversal by swapping elements of the word until the end of it is reached. How can you use the null-terminated C-string output of <code>strtok</code> to avoid carving up your RAM by using <code>malloc</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 2089, "user_id": 5616565, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/xdEXf.jpg?s=128&g=1", "display_name": "DarkSuniuM", "link": "https://stackoverflow.com/users/5616565/darksunium"}, "edited": false, "score": 0, "creation_date": 1577723529, "post_id": 59533780, "comment_id": 105237570, "body": "It did actually work, But I can&#39;t understand how, First <code>temp_word[0] = &#39;\\0&#39;</code>, Why are we putting a NULL pointer at the start of the string?"}, {"owner": {"reputation": 2089, "user_id": 5616565, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/xdEXf.jpg?s=128&g=1", "display_name": "DarkSuniuM", "link": "https://stackoverflow.com/users/5616565/darksunium"}, "edited": false, "score": 0, "creation_date": 1577724002, "post_id": 59533780, "comment_id": 105237774, "body": "I meant null character*"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 2089, "user_id": 5616565, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/xdEXf.jpg?s=128&g=1", "display_name": "DarkSuniuM", "link": "https://stackoverflow.com/users/5616565/darksunium"}, "edited": false, "score": 1, "creation_date": 1577725889, "post_id": 59533780, "comment_id": 105238500, "body": "@DarkSuniuM: Not a null-pointer but a null-character. Quoting my answer: &quot;<i>&quot;C&quot;-strings, ... in fact are char-arrays with at least one element being equal to &#39;\\0&#39;.</i>&quot;"}], "tags": [], "owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "is_accepted": true, "score": 1, "last_activity_date": 1577722963, "last_edit_date": 1577722963, "creation_date": 1577722634, "answer_id": 59533780, "question_id": 59533719, "link": "https://stackoverflow.com/questions/59533719/strcat-adds-junk-to-the-string/59533780#59533780", "title": "strcat adds junk to the string", "body": "<p><code>strcat()</code> expects addresses of the 1st character of \"C\"-strings, which in fact are <code>char</code>-arrays with at least one element being equal to <code>'\\0'</code>.</p>\n\n<p>Neither the memory <code>temp_word</code> points to nor the memory <code>&amp;temp_char</code> points to meet such requirements.</p>\n\n<p>Due to this the infamous undefined behaviour is invoked, anything can happen from then on.</p>\n\n<p>A possible fix would be to change</p>\n\n<pre><code>      temp_word = (char *) malloc (text_size + 1);\n</code></pre>\n\n<p>to become</p>\n\n<pre><code>      temp_word = malloc (text_size + 1); /* Not the issue but the cast is \n                                             just useless in C. */\n      temp_word[0] = '\\0';\n</code></pre>\n\n<p>and this</p>\n\n<pre><code>        strcat(temp_word, &amp;temp_char);\n</code></pre>\n\n<p>to become</p>\n\n<pre><code>        strcat(temp_word, (char[2]){temp_char});\n</code></pre>\n\n<hr>\n\n<p>There might be other issues with the rest of the code.</p>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 1, "last_activity_date": 1577726503, "last_edit_date": 1577726503, "creation_date": 1577724234, "answer_id": 59534121, "question_id": 59533719, "link": "https://stackoverflow.com/questions/59533719/strcat-adds-junk-to-the-string/59534121#59534121", "title": "strcat adds junk to the string", "body": "<p>The function strcat deals with strings.</p>\n\n<p>In this code snippet</p>\n\n<pre><code>  // assign and cast test[i+j] to temp_char as a character,\n  // (it reads it as string by default)\n  temp_char = (char) text[i+j];\n\n  // concat temp_char to the temp_word\n  strcat(temp_word, &amp;temp_char); // &lt;= PROBLEM\n</code></pre>\n\n<p>neither the pointer <code>temp_word</code> nor the pointer <code>&amp;temp_char</code> points to a string.</p>\n\n<p>Moreover array <code>output</code> is not appended with the terminating-zero character for example when the source string consists from blanks.</p>\n\n<p>In any case your approach is too complicated and has many redundant code as for example the condition in the for loop and the condition in the if statement that duplicate each other.</p>\n\n<pre><code>  for(i = 0; i &lt; len; i++) {\n\n    //\u2026\n\n    // if the text[i] is NULL, just get out of the loop\n    if (text[i] == '\\0') {\n      break;\n    }\n</code></pre>\n\n<p>The function can be written simpler as it is shown in the demonstrative program below.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nchar * reverse_words( const char *s )\n{\n    char *result = malloc( strlen( s ) + 1 );\n\n    if ( result != NULL )\n    {\n        char *p = result;\n\n        while ( *s != '\\0' )\n        {\n            while ( isblank( ( unsigned char )*s ) )\n            {\n                *p++ = *s++;\n            }\n\n\n            const char *q = s;\n\n            while ( !isblank( ( unsigned char )*q ) &amp;&amp; *q != '\\0' ) ++q;\n\n            for ( const char *tmp = q; tmp != s; )\n            {\n                *p++ = *--tmp;\n            }\n\n            s = q;\n        }\n\n        *p = '\\0';\n    }\n\n    return result;\n}\n\nint main(void) \n{\n    const char *s = \"Hello World\";\n\n    char *result = reverse_words( s );\n\n    puts( s );\n    puts( result );\n\n    free( result );\n\n    return 0;\n}\n</code></pre>\n\n<p>The program output is</p>\n\n<pre><code>Hello World\nolleH dlroW\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 995, "user_id": 2693741, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/9awAN.png?s=128&g=1", "display_name": "Ikarus", "link": "https://stackoverflow.com/users/2693741/ikarus"}, "is_accepted": false, "score": 2, "last_activity_date": 1577728276, "last_edit_date": 1577728276, "creation_date": 1577725090, "answer_id": 59534278, "question_id": 59533719, "link": "https://stackoverflow.com/questions/59533719/strcat-adds-junk-to-the-string/59534278#59534278", "title": "strcat adds junk to the string", "body": "<p>The root cause of junk characters is you use wrong input for the 2nd argument of strcat function. see explain below:</p>\n\n<p>At the beginning of your function you declare:</p>\n\n<pre><code>  int i, j;\n  size_t len = strlen(text);\n  size_t text_size = len * sizeof(char);\n  // output containst the output or the result\n  char *output;\n\n  // temp_word is a temporary variable,\n  // it contains each word and it will be\n  // empty after each space.\n  char *temp_word;\n\n  // temp_char is a temporary variable,\n  // it contains the current character\n  // within the for loop below.\n  char temp_char;\n</code></pre>\n\n<p>you can print variable's addresses in stack, they will be something like this:</p>\n\n<pre><code>printf(\"&amp;temp_char=%p,&amp;temp_word=%p,&amp;output=%p,&amp;text_size=%p\\n\", &amp;temp_char, &amp;temp_word,&amp;output,&amp;text_size);\nresult:    \n&amp;temp_char=0x7ffeea172a9f,&amp;temp_word=0x7ffeea172aa0,&amp;output=0x7ffeea172aa8,&amp;text_size=0x7ffeea172ab0\n</code></pre>\n\n<p>As you can see, &amp;temp_char(0x7ffeea172a9f) is at the bottom of the stack, next 1 byte is &amp;temp_word(0x7ffeea172aa0), next 8 bytes is &amp;output(0x7ffeea172aa8), and so on(I used 64bit OS, so it takes 8 bytes for a pointer)</p>\n\n<pre><code> // concat temp_char to the temp_word\n  strcat(temp_word, &amp;temp_char); // &lt;= PROBLEM\n</code></pre>\n\n<p>refer strcat description here: <a href=\"http://www.cplusplus.com/reference/cstring/strcat/\" rel=\"nofollow noreferrer\">http://www.cplusplus.com/reference/cstring/strcat/</a></p>\n\n<p>the strcat second argument = &amp;temp_char = 0x7ffeea172a9f. strcat considers that &amp;temp_char(0x7ffeea172a9f) is the starting point of the source string, <strong>instead of adding only one char as you expect it will append to temp_word all characters starting from &amp;temp_char(0x7ffeea172a9f) , until it meets terminating null character</strong></p>\n"}], "owner": {"reputation": 2089, "user_id": 5616565, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/xdEXf.jpg?s=128&g=1", "display_name": "DarkSuniuM", "link": "https://stackoverflow.com/users/5616565/darksunium"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 241, "favorite_count": 0, "accepted_answer_id": 59533780, "answer_count": 3, "score": 2, "last_activity_date": 1577728276, "creation_date": 1577722308, "last_edit_date": 1577723132, "question_id": 59533719, "link": "https://stackoverflow.com/questions/59533719/strcat-adds-junk-to-the-string", "title": "strcat adds junk to the string", "body": "<p>I'm trying to reverse a sentence, without changing the order of words,</p>\n\n<p>For example: \"Hello World\" => \"olleH dlroW\"</p>\n\n<p>Here is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nchar * reverseWords(const char *text);\nchar * reverseWord(char *word);\n\nint main () {\n  char *text = \"Hello World\";\n  char *result = reverseWords(text);\n  char *expected_result = \"olleH dlroW\";\n  printf(\"%s == %s\\n\", result, expected_result);\n  printf(\"%d\\n\", strcmp(result, expected_result));\n  return 0;\n}\n\nchar *\nreverseWords (const char *text) {\n  // This function takes a string and reverses it words.\n  int i, j;\n  size_t len = strlen(text);\n  size_t text_size = len * sizeof(char);\n  // output containst the output or the result\n  char *output;\n\n  // temp_word is a temporary variable,\n  // it contains each word and it will be\n  // empty after each space.\n  char *temp_word;\n\n  // temp_char is a temporary variable,\n  // it contains the current character\n  // within the for loop below.\n  char temp_char;\n\n  // allocating memory for output.\n  output = (char *) malloc (text_size + 1);\n\n  for(i = 0; i &lt; len; i++) {\n\n    // if the text[i] is space, just append it\n    if (text[i] == ' ') {\n      output[i] = ' ';\n    }\n\n    // if the text[i] is NULL, just get out of the loop\n    if (text[i] == '\\0') {\n      break;\n    }\n\n    // allocate memory for the temp_word\n    temp_word = (char *) malloc (text_size + 1);\n\n    // set j to 0, so we can iterate only on the word\n    j = 0;\n\n    // while text[i + j] is not space or NULL, continue the loop\n    while((text[i + j] != ' ') &amp;&amp; (text[i + j] != '\\0')) {\n\n      // assign and cast test[i+j] to temp_char as a character,\n      // (it reads it as string by default)\n      temp_char = (char) text[i+j];\n\n      // concat temp_char to the temp_word\n      strcat(temp_word, &amp;temp_char); // &lt;= PROBLEM\n\n      // add one to j\n      j++;\n    }\n\n    // after the loop, concat the reversed version\n    // of the word to the output\n    strcat(output, reverseWord(temp_word));\n\n    // if text[i+j] is space, concat space to the output\n    if (text[i+j] == ' ')\n      strcat(output, \" \");\n\n    // free the memory allocated for the temp_word\n    free(temp_word);\n\n    // add j to i, so u can skip \n    // the character that already read.\n    i += j;\n  }\n\n  return output;\n}\n\nchar *\nreverseWord (char *word) {\n  int i, j;\n  size_t len = strlen(word);\n  char *output;\n\n  output = (char *) malloc (len + 1);\n\n  j = 0;\n  for(i = (len - 1); i &gt;= 0; i--) {\n    output[j++] = word[i];\n  }\n\n  return output;\n}\n</code></pre>\n\n<p>The problem is the line I marked with <code>&lt;= PROBLEM</code>, On the first word which in this case is \"Hello\", it does everything just fine.</p>\n\n<p>On the second word which in this case is \"World\", It adds junky characters to the <code>temp_word</code>,\nI checked it with <code>gdb</code>, <code>temp_char</code> doesn't contain the junk, but when <code>strcat</code> runs, the latest character appended to the <code>temp_word</code> would be something like <code>W\\006</code>,</p>\n\n<p>It appends <code>\\006</code> to all of the characters within the second word,</p>\n\n<p>The output that I see on the terminal is fine, but printing out <code>strcmp</code> and comparting the <code>result</code> with <code>expected_result</code> returns <code>-94</code>.</p>\n\n<ul>\n<li>What can be the problem?</li>\n<li>What's the <code>\\006</code> character?</li>\n<li>Why <code>strcat</code> adds it?</li>\n<li>How can I prevent this behavior?</li>\n</ul>\n"}, {"tags": ["c", "casting", "type-conversion", "printf"], "comments": [{"owner": {"reputation": 361, "user_id": 10735411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e4b74e688eb9cbb88a994a3916865d2?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doe", "link": "https://stackoverflow.com/users/10735411/j-doe"}, "edited": false, "score": 5, "creation_date": 1577720797, "post_id": 59533345, "comment_id": 105236376, "body": "the types of the arguments must match the format string. if they don&#39;t you have to cast. otherwise it would be undefined behaviour."}, {"owner": {"reputation": 513, "user_id": 10532629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/827650de0b201131dc41e1aa1317fb77?s=128&d=identicon&r=PG&f=1", "display_name": "kalpaj agrawalla", "link": "https://stackoverflow.com/users/10532629/kalpaj-agrawalla"}, "edited": false, "score": 0, "creation_date": 1577720934, "post_id": 59533345, "comment_id": 105236433, "body": "how come line 12 give 0.000000 as double result? Please provide the correct OUTPUT"}, {"owner": {"reputation": 57, "user_id": 12603465, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDQ1jW5xMxrKjTpSFwX-sbzNvUGtBwdUHG6O0KCwQ=k-s128", "display_name": "Gabriele Berselli", "link": "https://stackoverflow.com/users/12603465/gabriele-berselli"}, "reply_to_user": {"reputation": 513, "user_id": 10532629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/827650de0b201131dc41e1aa1317fb77?s=128&d=identicon&r=PG&f=1", "display_name": "kalpaj agrawalla", "link": "https://stackoverflow.com/users/10532629/kalpaj-agrawalla"}, "edited": false, "score": 0, "creation_date": 1577722892, "post_id": 59533345, "comment_id": 105237322, "body": "I do not modify the OUTPUT, try it yourself &amp; you&#39;ll get my result @kalpajagrawalla . So my question remain."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 2, "creation_date": 1577723142, "post_id": 59533345, "comment_id": 105237423, "body": "No, we do not get your result. For \u201cWith no preliminar assignment,\u201d I get \u201c&quot;z&quot; is: 73896 (integer)  or 2.000000 (double) or 2.000000(float)\u201d. There is a rule that the <b>type</b> of an argument must match the <b>conversion specifier</b> in order for the behavior to be defined. When you pass a <code>float</code> argument (<code>z</code>) for the conversion specification <code>%d</code>, you break this rule. At the last, that messes up how passing arguments to <code>printf</code> works. That means <code>printf</code> gets the wrong data. It behaves differently on different implementations. And it means what is printed is not showing you what is in <code>z</code>."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1577724475, "post_id": 59533345, "comment_id": 105237955, "body": "Correct: \u201cAt the last\u201d should have been \u201cAt the least.\u201d"}, {"owner": {"reputation": 57, "user_id": 12603465, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDQ1jW5xMxrKjTpSFwX-sbzNvUGtBwdUHG6O0KCwQ=k-s128", "display_name": "Gabriele Berselli", "link": "https://stackoverflow.com/users/12603465/gabriele-berselli"}, "edited": false, "score": 0, "creation_date": 1577725379, "post_id": 59533345, "comment_id": 105238297, "body": "I copy/paste my code to a blank page and it still result 0 in all cases (%d, %f, %fl). I&#39;m using gcc compiler for that with the cmd line <b>gcc es1.c -o es1.exe</b>. I&#39;m not understanding why you are having different values from 0."}, {"owner": {"reputation": 1975, "user_id": 6070341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHHZU.png?s=128&g=1", "display_name": "Costantino Grana", "link": "https://stackoverflow.com/users/6070341/costantino-grana"}, "edited": false, "score": 0, "creation_date": 1577750847, "post_id": 59533345, "comment_id": 105246328, "body": "I guess that your professor avoided to use any I/O function, suggesting that you should refrain to use <code>printf()</code> as a debugger, when we are nearly in 2020 and a debugger is easily available on any platform."}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 12603465, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDQ1jW5xMxrKjTpSFwX-sbzNvUGtBwdUHG6O0KCwQ=k-s128", "display_name": "Gabriele Berselli", "link": "https://stackoverflow.com/users/12603465/gabriele-berselli"}, "edited": false, "score": 1, "creation_date": 1577724998, "post_id": 59533869, "comment_id": 105238165, "body": "I did not use the cmd line &quot;gcc -Wall ecc....&quot; but now I&#39;m seeing what you was referring and is true (I&#39;m learning C and from now it will become my first action in compiling phase, so thank you). As you suggested, I added &quot;(int)&quot; in all printf func before the first &quot;z&quot;(referred to %d) to specify the integer conversion. So I have another question, the printf() was not outputting the &quot;real&quot; value of z in ALL CASES (%d, %fl, %f) because it was in an undefined behaviour state due to the mismatch between %d (format type) and z (float var.)?"}, {"owner": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "reply_to_user": {"reputation": 57, "user_id": 12603465, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDQ1jW5xMxrKjTpSFwX-sbzNvUGtBwdUHG6O0KCwQ=k-s128", "display_name": "Gabriele Berselli", "link": "https://stackoverflow.com/users/12603465/gabriele-berselli"}, "edited": false, "score": 1, "creation_date": 1577726872, "post_id": 59533869, "comment_id": 105238842, "body": "If you mean before the explicit cast, I gave an explanation in the answer. To go more into the point is that the code that extract the required arguments from the calling stack use the dimension (the <code>sizeof</code>) of the parameter type. If in your system <code>sizeof(int)==4</code> and <code>sizeof(double)==8</code>, the function read the first 4 bytes of the <code>double</code> on the stack, and interpreted it as an <code>int</code>. If they were 0 you got it. Then the following arguments were accessed at a wrong offset. A complete mess-up."}], "tags": [], "owner": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "is_accepted": true, "score": 2, "last_activity_date": 1577724044, "last_edit_date": 1577724044, "creation_date": 1577723044, "answer_id": 59533869, "question_id": 59533345, "link": "https://stackoverflow.com/questions/59533345/conversion-type-in-printf-with-no-casting-operator/59533869#59533869", "title": "Conversion type in printf (with no casting operator)", "body": "<p><code>printf()</code>, as many variadic functions, use a format string to tell to the function which kind of parameters expect on the call stack, <strong>but this doesn't imply that any conversion is actuated on such parameters based on the format string</strong>.</p>\n\n<p>Anyway any decent compiler will warn you about the format/parameters type mismatch, this means that you deliberately ignored them..</p>\n\n<p>Probably you are making a confusion between <strong>argument promotions</strong> and format specifier.</p>\n\n<p>In variable arguments functions the parameters not explicitly defined, those identified by <code>...</code>, are handled in a standard way as described in C standard <strong>ISO/IEC 9899:201x, \u00a76.5.2.2 Function calls</strong>. In subparagraph <strong>6</strong> we read:</p>\n\n<blockquote>\n  <p>If the expression that denotes the called function has a type that\n  does not include a prototype, the integer promotions are performed on\n  each argument, and arguments that have type <code>float</code> are promoted to\n  <code>double</code>. <strong>These are called the default argument promotions</strong>.</p>\n  \n  <p>If the\n  number of arguments does not equal the number of parameters, the\n  behavior is undefined. If the function is defined with a type that\n  includes a prototype, and either the prototype ends with an ellipsis\n  (, ...) or the types of the arguments after promotion are not\n  compatible with the types of the parameters, the behavior is\n  undefined. If the function is defined with a type that does not\n  include a prototype, and the types of the arguments after promotion\n  are not compatible with those of the parameters after promotion, the\n  behavior is undefined, except for the following cases:</p>\n</blockquote>\n\n<ul>\n<li><blockquote>\n  <p>one promoted\n  type is a signed integer type, the other promoted type is the\n  corresponding unsigned integer type, and the value is representable in\n  both types;</p>\n</blockquote></li>\n<li><blockquote>\n  <p>both types are pointers to qualified or unqualified    > versions of a character type or void.</p>\n</blockquote></li>\n</ul>\n\n<p>So if you want have a meaningful output you <strong>must explicetely convert parameters</strong> as in:</p>\n\n<pre><code>printf(\" is: %d (integer)  or %lf (double) or %f(float)\\n\", (int)z, z, z);\n</code></pre>\n\n<p>Note that only the cast to <code>int</code> is due, leaving the other 2 entries to default promotion that will convert <code>float</code> to <code>double</code> satisfying what the function expect based on the format string. Without the explicit cast the compiler will promote the variable <code>z</code> from <code>float</code> to <code>double</code>, as per the default argument promotion rules, while the <code>printf()</code> code will try to access it as an <code>int</code>.</p>\n\n<p>The problem of values all zero in your code is due to the mismatch in the parameters size <code>int</code>/<code>double</code> that broken the stack unwrap.</p>\n"}, {"comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1577723686, "post_id": 59533953, "comment_id": 105237624, "body": "<code>float</code>s are promoted to <code>double</code>s so there is not need to cast a <code>float</code> to <code>double</code>. Or do you do this to keep things clearer?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1577724095, "post_id": 59533953, "comment_id": 105237818, "body": "You are quite correct, @alk, including your guess about my intention.  It is not necessary to go into the details of the default argument promotions to answer the question, and I don&#39;t think doing so would improve the answer relative to using a cast to explicitly express conformance with the type-matching requirement."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 2, "last_activity_date": 1577723769, "last_edit_date": 1577723769, "creation_date": 1577723480, "answer_id": 59533953, "question_id": 59533345, "link": "https://stackoverflow.com/questions/59533345/conversion-type-in-printf-with-no-casting-operator/59533953#59533953", "title": "Conversion type in printf (with no casting operator)", "body": "<blockquote>\n  <p>why am I having 0 as result in all the printf?</p>\n</blockquote>\n\n<p>You have an incomplete understanding of the significance of formatting directives in a <code>printf</code> format string.  <em>Above all else</em> they convey to <code>printf</code> the data type of their corresponding arguments, which are not otherwise known to <code>printf</code>.  They also specify details of how to format the value, but that is secondary to the question of how to interpret the argument list.  If the directives do not correspond correctly to the actual argument types, then the resulting behavior is wholly undefined.  Certainly <code>printf</code> can produce surprising output in such cases,<sup>*</sup> but in principle, <em>anything</em> could happen.</p>\n\n<p>Thus a statement such as this ...</p>\n\n<blockquote>\n<pre><code>   printf(\"\\\"z\\\" is: %d (integer)  or %lf (double) or %f(float)\\n\\n\\n\", z, z, z);\n</code></pre>\n</blockquote>\n\n<p>... where conversion directives specify different, incompatible types for the same value, is <em>always</em> incorrect.  One way to correct it would be to convert the arguments to the correct types, like so:</p>\n\n<pre><code>    printf(\"\\\"z\\\" is: %d (integer)  or %lf (double) or %f(float)\\n\\n\\n\", (int) z, (double) z, z);\n</code></pre>\n\n<p>But that's not particularly useful for your apparent purpose.  It appears that all the conversions you're actually interested in happen before or during each assignment to <code>z</code>, so nothing is gained by considering the results of afterward converting that result to other data types.  This, then, would be a better correction:</p>\n\n<pre><code>    printf(\"\\\"z\\\" is: %f(float)\\n\\n\\n\", z);\n</code></pre>\n\n<p>Alternatively, to separate the effects of conversion during assignment from the effects of conversion during arithmetic computation, you could perform <em>different</em> assignments to variables of the different types of interest.  For example,</p>\n\n<pre><code>    int x = 5;\n    int y = 2;\n    int zi;\n    double zd;\n    float zf;\n\n    // ...\n\n    zi = x / y;\n    zd = x / y;\n    zf = x / y;\n\n    // ...\n\n    printf(\"\\\"z\\\" is: %d (integer)  or %lf (double) or %f(float)\\n\\n\\n\", zi, zd, zf);\n</code></pre>\n\n<hr>\n\n<p><sup>*</sup> This is the answer to the actual question posed.</p>\n"}], "owner": {"reputation": 57, "user_id": 12603465, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDQ1jW5xMxrKjTpSFwX-sbzNvUGtBwdUHG6O0KCwQ=k-s128", "display_name": "Gabriele Berselli", "link": "https://stackoverflow.com/users/12603465/gabriele-berselli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 59533869, "answer_count": 2, "score": 1, "last_activity_date": 1577724044, "creation_date": 1577720610, "last_edit_date": 1577721940, "question_id": 59533345, "link": "https://stackoverflow.com/questions/59533345/conversion-type-in-printf-with-no-casting-operator", "title": "Conversion type in printf (with no casting operator)", "body": "<p>I'm trying to run the following code for a demonstration of how conversion works.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main()\n{\n    int x=5;\n    int y=2;\n    float z;\n    printf(\"x=%d\\n\", x);\n    printf(\"y=%d\\n\", y);\n\n    //Doing division as it is\n    z= x/y;\n    printf(\"With no preliminar assignment: (z=x/y)\\n\");\n    printf(\"\\\"z\\\" is: %d (integer)  or %lf (double) or %f(float)\\n\\n\\n\", z, z, z);\n\n    //Doing assignment before division\n    printf(\"With the assignment: (z=x)\\n\");\n    z=x;\n    printf(\"\\\"z\\\" before division is:\");\n    printf(\"%d (integer)  or %lf (double) or %f(float)\\n\", z, z, z);\n\n    //Doing division after assignment\n    z/=y;\n    printf(\"\\\"z\\\" after division with assignment: (z=z/y)\");\n    printf(\" is: %d (integer)  or %lf (double) or %f(float)\\n\", z, z, z);\n\n    return 0;\n}\n</code></pre>\n\n<p>The OUTPUT is:</p>\n\n<pre><code>x=5\ny=2\nWith no preliminar assignment: (z=x/y)\n\"z\" is: 0 (integer)  or 0.000000 (double) or 0.000000(float)\n\n\nWith the assignment: (z=x)\n\"z\" before division is:0 (integer)  or 0.000000 (double) or 0.000000(float)\n\"z\" after division with assignment: (z=z/y) is: 0 (integer)  or 0.000000 (double) or 0.000000(float)\n</code></pre>\n\n<p>This leave me with a doubt, also because my professor at University wrote the following code:</p>\n\n<pre><code>int x=5;\nint y=2;\nfloat z;\n\nint main (void) {\n    z = x / y;\n    return 0;\n}\n</code></pre>\n\n<p>And for him, z will assume 2.0 (Which is logically correct, but not in printf).</p>\n\n<p>So my final question is, why am I having 0 as result in all the printf?\n(I would like to not to use type casting operator)</p>\n"}, {"tags": ["c", "arrays", "struct", "queue", "message-queue"], "comments": [{"owner": {"reputation": 1651, "user_id": 635822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fd51a3c79639c315af5864adc731298?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/635822/jason"}, "edited": false, "score": 0, "creation_date": 1577731359, "post_id": 59533211, "comment_id": 105240412, "body": "Are you sure you are only creating 1?  At <code>pq = createQ(qs[i].id);</code>, it looks like you are creating many, but replacing <code>pq</code> with the new one each iteration."}, {"owner": {"reputation": 67, "user_id": 12601715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f659b1d375b7c4fc027326386d131ca1?s=128&d=identicon&r=PG&f=1", "display_name": "Mr Mosby", "link": "https://stackoverflow.com/users/12601715/mr-mosby"}, "reply_to_user": {"reputation": 1651, "user_id": 635822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fd51a3c79639c315af5864adc731298?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/635822/jason"}, "edited": false, "score": 0, "creation_date": 1577895173, "post_id": 59533211, "comment_id": 105276522, "body": "@Jason i am not 100% sure, i think you are right. How would i fix it to not replace with each iteration?"}], "answers": [{"tags": [], "owner": {"reputation": 1651, "user_id": 635822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fd51a3c79639c315af5864adc731298?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/635822/jason"}, "is_accepted": true, "score": 0, "last_activity_date": 1577994786, "last_edit_date": 1577994786, "creation_date": 1577990405, "answer_id": 59568397, "question_id": 59533211, "link": "https://stackoverflow.com/questions/59533211/multiple-queues-not-being-created-c/59568397#59568397", "title": "Multiple queues not being created - C", "body": "<p>This line here is creating a memory leak:</p>\n\n<pre><code>pq = createQ(qs[i].id);\n</code></pre>\n\n<p><code>createQ</code> is returning a valid pointer to an instance of <code>queue_t</code> and assigning it to <code>pq</code>.  However, on the next iteration, <code>pq</code> will be assigned to a new instance of <code>queue_t</code>. <code>pq</code> can only point to a single instance of <code>queue_t</code>, so instance from the last iteration is no longer reachable.  This is a classic memory leak.  There are a handful of approaches to fix this, but it boils down to having more than one pointer to <code>queue_t</code>.  It looks like you took a stab at a correct approach with the <code>MsgQs_t</code> structure.  I will provide a solution that fits with what it looks like you were trying to do.</p>\n\n<p>First this definition:</p>\n\n<pre><code>typedef struct MsgQs{\n    int id;\n    queue_t *qs[MAX_QUEUES];\n}MsgQs_t;\n</code></pre>\n\n<p>When you create an instance of <code>MsgQs_t</code>, you now have an array <code>queue_t*</code> of a fixed size <code>MAX_QUEUES</code>.  The <code>malloc</code> in createQ is over-writing this array of queue_t*.  You've already allocated space for your pointers when you instantiate <code>MsgQs_t</code>.  This is just a misunderstanding of the stack vs. heap allocation.  Here is a simpler example with <code>char*</code>.</p>\n\n<pre><code>char* charptr = malloc(10);  /* heap allocation requires malloc */\nchar chararray[10];          /* This is ALREADY allocated 10 chars on the stack */\n</code></pre>\n\n<p>So you could just assign directly to the struct member <code>qs</code>.  It's hard to tell, but it looks like your intention was to actually have 1 <code>id</code> per queue.  If that is the case, your struct definition should look like this:</p>\n\n<pre><code>typedef struct MsgQs{\n    int id;\n    queue_t *msgQueue; /* changed name to avoid confusion */\n}MsgQs_t;\n</code></pre>\n\n<p>You also want to change the <code>malloc</code> size in <code>initializeMsgQs_t</code>:</p>\n\n<pre><code>//This allocates MAX_QUEUES MsgQs_t structs\nMsgQs_t* qs = malloc(MAX_QUEUES * sizeof(MsgQs_t));\n\n//This only allocates 1:\nMsgQs_t* qs = malloc(sizeof(MsgQs_t));\n</code></pre>\n\n<p>Now, you have a heap allocated array of <code>MAX_QUEUES</code> structs of type <code>MsgQs_t</code>.  Then, you can assign to them directly in the loop.  Below, is a re-written version of the loop.  I changed the while loop because we don't want to loop passed MAX_QUEUES.  Accessing <code>qs[MAX_QUEUES]</code> will be undefined behavior and likely result in a segmentation fault.</p>\n\n<pre><code>while (i &lt; MAX_QUEUES) {\n    printf(\"\\n1) Create new queue\");\n    printf(\"\\n0) Quit\");\n    printf(\"\\nEnter choice: \");\n    scanf(\"%c\", &amp;choice);\n    getchar();\n\n    switch(choice) {\n        case '1': //createQ\n            printf(\"\\nCreating a queue!\\nEnter Queue-ID (Ex. 1234):\");\n            scanf(\"%d\", &amp;qs[i].id);\n            getchar();\n            qs[i].msgQueue = createQ();\n            printf(\"Queue with ID %d has been created successfully!\\n\", qs[i].id);\n            i++;\n            break;\n        case '0':\n            printf(\"\\nQuitting\");\n            exit(1);\n        default:\n            printf(\"Incorrect. Re-enter.\\n\");\n            break;\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 12601715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f659b1d375b7c4fc027326386d131ca1?s=128&d=identicon&r=PG&f=1", "display_name": "Mr Mosby", "link": "https://stackoverflow.com/users/12601715/mr-mosby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 59568397, "answer_count": 1, "score": 0, "last_activity_date": 1577994786, "creation_date": 1577719998, "question_id": 59533211, "link": "https://stackoverflow.com/questions/59533211/multiple-queues-not-being-created-c", "title": "Multiple queues not being created - C", "body": "<p>At first i was creating this program to cater for one queue, and everything was working. I currently am trying to create multiple queues, by using an array of structure with each queue being identified with it's own ID. But as it seems it is still only creating only one queue(as when i use a function with listing all the queues it is only listing one) and i need some help in fixing it. The code can be found below:</p>\n\n<pre><code>    #define MAX_MESSAGES 5\n    #define MAX_MSG_LEN 20\n    #define MAX_QUEUES 5\n\n    typedef struct queue{\n        int front, rear, size;\n        char elements[MAX_MESSAGES][MAX_MSG_LEN];\n    }queue_t;\n\n    typedef struct MsgQs{\n        int id;\n        queue_t *qs[MAX_QUEUES];\n    }MsgQs_t;\n\n\nint main(){\nint id, i = 0;\n\n    MsgQs_t *qs = initializeMsgQs_t();\n    //MsgQs_t *qs = NULL;\n    queue_t *pq = NULL;\n\nwhile(1){\n        printf(\"\\n1) Create new queue\");\n        printf(\"\\n0) Quit\");\n        printf(\"\\nEnter choice:\");\n        scanf(\" %c\", &amp;choice);\n        getchar();\n\n        switch(choice){\n            case '1': //createQ\n                printf(\"\\nCreating a queue!\\nEnter Queue-ID (Ex. 1234):\");\n                scanf(\"%d\", &amp;qs[i].id);\n                pq = createQ(qs[i].id);\n                printf(\"Queue with ID %d has been created successfully!\\n\", qs[i].id);\n                i++;\n                break;\n            case '0':\n                printf(\"\\nQuitting\");\n                exit(1);\n            default:\n                printf(\"Incorrect. Re-enter.\\n\");\n                break;\n        }\n    }\n}\n\nMsgQs_t* initializeMsgQs_t(){\n    MsgQs_t* qs = malloc(sizeof(MsgQs_t));\n\n    return qs;\n}\n\nqueue_t* createQ(){\n\n    queue_t* pq = malloc (sizeof(queue_t));\n\n    pq -&gt; front = 0;\n    pq -&gt; rear = 0;\n    pq -&gt; size = 0;\n\n    return pq;\n}\n</code></pre>\n\n<p>I have many more functions regarding these multiple queues although i minimized the program to indicate the first problem i have in my program. </p>\n"}, {"tags": ["c", "pointers", "malloc", "free", "c-strings"], "comments": [{"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1577720032, "post_id": 59533155, "comment_id": 105236043, "body": "You assign an invalid address to <code>words[i]</code> since you freed it and can&#39;t use it anymore."}, {"owner": {"reputation": 39, "user_id": 12603566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5698b0e405036cb8b46f30387405c569?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel98", "link": "https://stackoverflow.com/users/12603566/daniel98"}, "reply_to_user": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1577720151, "post_id": 59533155, "comment_id": 105236098, "body": "so where I should call free?"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 12603566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5698b0e405036cb8b46f30387405c569?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel98", "link": "https://stackoverflow.com/users/12603566/daniel98"}, "edited": false, "score": 0, "creation_date": 1577720478, "post_id": 59533183, "comment_id": 105236259, "body": "Can someone suggest where is the prober location to call free with every iteration?"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 39, "user_id": 12603566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5698b0e405036cb8b46f30387405c569?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel98", "link": "https://stackoverflow.com/users/12603566/daniel98"}, "edited": false, "score": 0, "creation_date": 1577720745, "post_id": 59533183, "comment_id": 105236355, "body": "@Daniel98: The question is not &quot;<i>where [...] to call free()</i>&quot; but how to not avoid to &quot;<i>mess up the program&#39;s memory management</i>&quot;."}], "tags": [], "owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "is_accepted": false, "score": 0, "last_activity_date": 1577720342, "last_edit_date": 1577720342, "creation_date": 1577719863, "answer_id": 59533183, "question_id": 59533155, "link": "https://stackoverflow.com/questions/59533155/calling-free-after-malloc-causes-unexpected-behaviour/59533183#59533183", "title": "Calling free() after malloc causes unexpected behaviour", "body": "<pre><code>        strcpy(ExtendedWord,word);\n</code></pre>\n\n<p><code>strcpy()</code> expects as 2nd parameter the address of the 1st character of a \"C\"-string, which in fact is a <code>char</code>-array with at least one element being equal to <code>'\\0'</code>.</p>\n\n<p>The memory <code>word</code> points to does not meet such requirements.</p>\n\n<p>Due to this the infamous undefined behaviour is invoked, probably messing up the program's memory management, which in turn causes <code>free()</code> to fail.</p>\n"}, {"comments": [{"owner": {"reputation": 39, "user_id": 12603566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5698b0e405036cb8b46f30387405c569?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel98", "link": "https://stackoverflow.com/users/12603566/daniel98"}, "edited": false, "score": 0, "creation_date": 1577720891, "post_id": 59533381, "comment_id": 105236417, "body": "why should I null terminate before passing to strcpy? It will just keep copying the other parts which don&#39;t affect my code at all?"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 39, "user_id": 12603566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5698b0e405036cb8b46f30387405c569?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel98", "link": "https://stackoverflow.com/users/12603566/daniel98"}, "edited": false, "score": 2, "creation_date": 1577720986, "post_id": 59533381, "comment_id": 105236453, "body": "<code>strcpy</code> requires that the source string be null terminated. Either set the null terminator before passing to <code>strcpy</code> or use <code>memcpy</code> with the appropriate size as I did in the above code."}, {"owner": {"reputation": 39, "user_id": 12603566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5698b0e405036cb8b46f30387405c569?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel98", "link": "https://stackoverflow.com/users/12603566/daniel98"}, "edited": false, "score": 0, "creation_date": 1577721283, "post_id": 59533381, "comment_id": 105236578, "body": "ok and what about you should reallocate the array before copying the new character at its end. how does this make a difference?"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 39, "user_id": 12603566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5698b0e405036cb8b46f30387405c569?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel98", "link": "https://stackoverflow.com/users/12603566/daniel98"}, "edited": false, "score": 0, "creation_date": 1577724214, "post_id": 59533381, "comment_id": 105237872, "body": "If you want to use strcpy, you must set the null terminator so the current array is too short for both the new character and the null terminator. You could possibly set the character and use memcpy to copy i+1 bytes to the newly allocated array. It would work only because you increment the size one byte at a time and you also allocate one extra byte for the null terminator. Reallocating before copying is just a more generic approach, that works for any amount of extra data."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 0, "last_activity_date": 1577721033, "last_edit_date": 1577721033, "creation_date": 1577720797, "answer_id": 59533381, "question_id": 59533155, "link": "https://stackoverflow.com/questions/59533155/calling-free-after-malloc-causes-unexpected-behaviour/59533381#59533381", "title": "Calling free() after malloc causes unexpected behaviour", "body": "<p>There are multiple problems in your code:</p>\n\n<ul>\n<li>you free the newly allocated block instead of the previous one.</li>\n<li>you so not null terminate the string before passing it to <code>strcpy</code></li>\n<li><code>word</code> should be initialized as <code>NULL</code> or to a block of allocated memory, not to point to a local array which you cannot pass to <code>free()</code>.</li>\n<li>you should reallocate the array <strong>before</strong> copying the new character at its end.</li>\n</ul>\n\n<p>Here is a modified version:</p>\n\n<pre><code>int read_words(char *words[], int size, int max_str_len) {\n    int i, j;\n    for (i = 0; i &lt; size; i++) {\n        char *word = malloc(1);\n        if (word == NULL)\n            return -1;\n        for (j = 0; j &lt; max_str_len; ++j) {\n            int ch;\n            char *ExtendedWord;\n            if ((ch = getchar()) == EOF || ch == 'R') {\n                size = -1;\n                break;\n            }\n            if (ch == ' ' || c == '\\n')\n                break;\n            /* reallocate array for one more character and a null terminator */\n            ExtendedWord = malloc(i + 2);\n            if (ExtendedWord == NULL)\n                return -1;\n            memcpy(ExtendedWord, word, i);\n            free(word);\n            word = ExtendedWord;\n            word[j] = ch;\n        }\n        if (size == -1) {\n            free(word);\n            break;\n        }\n        word[j] = '\\0';\n        words[i] = word;\n    }\n    return i;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 0, "last_activity_date": 1577721285, "last_edit_date": 1577721285, "creation_date": 1577720925, "answer_id": 59533411, "question_id": 59533155, "link": "https://stackoverflow.com/questions/59533155/calling-free-after-malloc-causes-unexpected-behaviour/59533411#59533411", "title": "Calling free() after malloc causes unexpected behaviour", "body": "<blockquote>\n  <p>I Read that I should call free() as soon as I could do that to free the memory</p>\n</blockquote>\n\n<p>That description is a little ambiguous.  It is reasonable only if you interpret \"as soon as I could do that\" to mean the same as \"as soon as I no longer need the allocated memory\".</p>\n\n<blockquote>\n  <p>but when I call free in this way my code stops working correctly. what's the problem? </p>\n</blockquote>\n\n<p>The problem with respect to <code>free</code> is that you free the memory before you are done with it.  Subsequently attempting to access that memory produces undefined behavior.</p>\n\n<p>There are other problems with the code, too, discussed in other answers, but this is how the <code>free</code> fits into the picture.</p>\n\n<blockquote>\n  <p>I want to call free in every iteration and when an error occurs.</p>\n</blockquote>\n\n<p>Inasmuch as it appears that your function intends to provide pointers to the allocated memory to its caller via the <code>words</code> array, you <em>must not</em> free that memory anywhere within the scope of the function, because the caller (it must be presumed) intends to use it.  Therefore the caller must assume the responsibility for freeing it.  The function's documentation should clearly describe that responsibility.</p>\n\n<p>Perhaps the confusion arises here:</p>\n\n<blockquote>\n<pre><code>           word=ExtendedWord;\n</code></pre>\n</blockquote>\n\n<p>It is essential to understand that the assignment copies <em>the pointer</em>, not the space to which it points.  Afterward, <code>word</code> points to the same (dynamically allocated) space that <code>ExtendedWord</code> does, so that freeing <code>ExtendedWord</code> invalidates both copies of the pointer.</p>\n"}], "owner": {"reputation": 39, "user_id": 12603566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5698b0e405036cb8b46f30387405c569?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel98", "link": "https://stackoverflow.com/users/12603566/daniel98"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1577723038, "creation_date": 1577719717, "last_edit_date": 1577723038, "question_id": 59533155, "link": "https://stackoverflow.com/questions/59533155/calling-free-after-malloc-causes-unexpected-behaviour", "title": "Calling free() after malloc causes unexpected behaviour", "body": "<p>Hi I read that I should call <code>free()</code> as soon as I could do that to free the memory but when I call free in this way my code stops working correctly. what's the problem?</p>\n\n<p>I want to call <code>free()</code> in every iteration and when an error occurs.</p>\n\n<pre><code>int read_words(char *words[], int size, int max_str_len) {\n    int i, j;\n    char *ExtendedWord = NULL;\n    for (i = 0; i &lt; size &amp;&amp; size != -1; ++i) {\n        char tmp[1], ch, *word = tmp;\n        for (j = 0; j &lt; max_str_len; ++j) {\n            if (scanf(\"%c\", &amp;ch) == EOF || ch == 'R') {\n                size = -1;\n                break;\n            }\n            if (ch == ' ')\n                break;\n            word[j] = ch;\n            ExtendedWord = malloc((i + 2) * sizeof(char));\n            if (ExtendedWord == NULL)\n                return -1;\n            strcpy(ExtendedWord, word);\n            word = ExtendedWord;\n            free(ExtendedWord);\n        }\n        word[j] = '\\0';\n        words[i] = word;\n    }\n    return i;\n}\n</code></pre>\n"}, {"tags": ["c", "bit-manipulation", "logical-operators"], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 11128127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13efa329b269f6353dc2f3ed41c24c63?s=128&d=identicon&r=PG&f=1", "display_name": "St&#233;phane", "link": "https://stackoverflow.com/users/11128127/st%c3%a9phane"}, "edited": false, "score": 0, "creation_date": 1577720691, "post_id": 59532804, "comment_id": 105236331, "body": "Thanks to all answers ! it&#39;s so simple I&#39;ve forgotten what I&#39;ve seen in course in my student days"}, {"owner": {"reputation": 6031, "user_id": 10871900, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-noQwojQppnY/AAAAAAAAAAI/AAAAAAAAACs/59RU8UyHFSk/photo.jpg?sz=128", "display_name": "dan1st", "link": "https://stackoverflow.com/users/10871900/dan1st"}, "reply_to_user": {"reputation": 109, "user_id": 11128127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13efa329b269f6353dc2f3ed41c24c63?s=128&d=identicon&r=PG&f=1", "display_name": "St&#233;phane", "link": "https://stackoverflow.com/users/11128127/st%c3%a9phane"}, "edited": false, "score": 0, "creation_date": 1577720889, "post_id": 59532804, "comment_id": 105236416, "body": "If an answer helped you, you can accept it but you can only accept one answer(decide what answer helped you mostly). You can also upvote answers(not just one) if you like them."}], "tags": [], "owner": {"reputation": 6031, "user_id": 10871900, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-noQwojQppnY/AAAAAAAAAAI/AAAAAAAAACs/59RU8UyHFSk/photo.jpg?sz=128", "display_name": "dan1st", "link": "https://stackoverflow.com/users/10871900/dan1st"}, "is_accepted": false, "score": 0, "last_activity_date": 1577718329, "last_edit_date": 1577718329, "creation_date": 1577717977, "answer_id": 59532804, "question_id": 59532767, "link": "https://stackoverflow.com/questions/59532767/result-of-bitwise-or-operator-in-c/59532804#59532804", "title": "Result of bitwise OR operator in c", "body": "<p>Yes it is correct.</p>\n\n<pre><code>512 =01000000000\n1024=10000000000\n1536=11000000000\n</code></pre>\n\n<p>OR-Calculation:</p>\n\n<pre><code> 10000000000\n|01000000000\n=11000000000\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 249903, "user_id": 2422776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2353050223ebecb113741c29458de4b2?s=128&d=identicon&r=PG", "display_name": "Mureinik", "link": "https://stackoverflow.com/users/2422776/mureinik"}, "is_accepted": false, "score": 0, "last_activity_date": 1577717985, "creation_date": 1577717985, "answer_id": 59532807, "question_id": 59532767, "link": "https://stackoverflow.com/questions/59532767/result-of-bitwise-or-operator-in-c/59532807#59532807", "title": "Result of bitwise OR operator in c", "body": "<p>In a word - yes. Note that <code>1024</code> and <code>512</code> don't have \"1\" bits in the same positions, so the result of bitwise-oring them is the same as adding them.</p>\n"}, {"tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": true, "score": 2, "last_activity_date": 1577718478, "last_edit_date": 1577718478, "creation_date": 1577717993, "answer_id": 59532808, "question_id": 59532767, "link": "https://stackoverflow.com/questions/59532767/result-of-bitwise-or-operator-in-c/59532808#59532808", "title": "Result of bitwise OR operator in c", "body": "<p>Yes, the result is correct: in fact, OR-ing 1024 and 512 yields the same number as adding them.</p>\n\n<p>This is a convenient \"shortcut\" for OR-ing powers of two: since their digits never occupy the same position, addition is the same as \"OR\".</p>\n\n<p>The same principle is in play here as with adding decimal numbers with zeros in all but a single position, when non-zero positions do not overlap: adding, say, 6000+900+30+7 is the same as writing down the individual digits into 6937, because place values do not interact with each other. OR-ing distinct powers of two in binary is the same as writing down all ones in positions designated by numbers being OR-ed.</p>\n\n<p>Note that the expression <code>(SEFLG_NOABERR|SEFLG_NOGDEFL)</code> is evaluated at compile time, so replacing it with 1536 is not going to yield any run-time improvement.</p>\n"}], "owner": {"reputation": 109, "user_id": 11128127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13efa329b269f6353dc2f3ed41c24c63?s=128&d=identicon&r=PG&f=1", "display_name": "St&#233;phane", "link": "https://stackoverflow.com/users/11128127/st%c3%a9phane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 59532808, "answer_count": 3, "score": 3, "last_activity_date": 1577718478, "creation_date": 1577717809, "question_id": 59532767, "link": "https://stackoverflow.com/questions/59532767/result-of-bitwise-or-operator-in-c", "title": "Result of bitwise OR operator in c", "body": "<p>I have a question about bitwise OR | operator from c to rust.</p>\n\n<p>I have this lot of define to convert from c to rust, and i\u2019m not sure of the flag SEFLG_ASTROMETRIC.</p>\n\n<pre><code>#define SEFLG_JPLEPH    1       /* use JPL ephemeris */\n#define SEFLG_SWIEPH    2       /* use SWISSEPH ephemeris */\n#define SEFLG_MOSEPH    4       /* use Moshier ephemeris */\n\n#define SEFLG_HELCTR    8      /* heliocentric position */\n#define SEFLG_TRUEPOS   16     /* true/geometric position, not apparent position */\n#define SEFLG_J2000 32     /* no precession, i.e. give J2000 equinox */\n#define SEFLG_NONUT 64     /* no nutation, i.e. mean equinox of date */\n#define SEFLG_SPEED3    128    /* speed from 3 positions (do not use it,\n                                * SEFLG_SPEED is faster and more precise.) */\n#define SEFLG_SPEED 256    /* high precision speed  */\n#define SEFLG_NOGDEFL   512    /* turn off gravitational deflection */\n#define SEFLG_NOABERR   1024   /* turn off 'annual' aberration of light */\n#define SEFLG_ASTROMETRIC (SEFLG_NOABERR|SEFLG_NOGDEFL) /* astrometric position,\n                                * i.e. with light-time, but without aberration and\n                    * light deflection */\n#define SEFLG_EQUATORIAL (2*1024)    /* equatorial positions are wanted */\n#define SEFLG_XYZ   (4*1024)     /* cartesian, not polar, coordinates */\n#define SEFLG_RADIANS   (8*1024)     /* coordinates in radians, not degrees */\n#define SEFLG_BARYCTR   (16*1024)    /* barycentric position */\n#define SEFLG_TOPOCTR   (32*1024)    /* topocentric position */\n#define SEFLG_ORBEL_AA SEFLG_TOPOCTR /* used for Astronomical Almanac mode in\n                                      * calculation of Kepler elipses */\n#define SEFLG_SIDEREAL  (64*1024)    /* sidereal position */\n#define SEFLG_ICRS  (128*1024)   /* ICRS (DE406 reference frame) */\n#define SEFLG_DPSIDEPS_1980 (256*1024) /* reproduce JPL Horizons\n                                      * 1962 - today to 0.002 arcsec. */\n#define SEFLG_JPLHOR    SEFLG_DPSIDEPS_1980\n#define SEFLG_JPLHOR_APPROX (512*1024)   /* approximate JPL Horizons 1962 - today */\n</code></pre>\n\n<p>1024 | 512</p>\n\n<p>I tried with the calculator of my mac 1024 OR 512 and the result is 1536. Is this result correct ?</p>\n"}, {"tags": ["c++", "c", "visual-studio", "casting"], "comments": [{"owner": {"reputation": 354, "user_id": 11389043, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-I_o3Ep6MDig/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc0hwvbl7DiKIK7zqQbH5zk3uSsBw/mo/photo.jpg?sz=128", "display_name": "Alex B", "link": "https://stackoverflow.com/users/11389043/alex-b"}, "edited": false, "score": 0, "creation_date": 1577717554, "post_id": 59532657, "comment_id": 105234988, "body": "<code>reinterpret_cast&lt;AsmVmxCallType&gt;(CODE)</code> should work, assuming AsmVmxCallType is a pointer type. Of course this breaks C compatibility."}], "answers": [{"tags": [], "owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "is_accepted": false, "score": 2, "last_activity_date": 1577719765, "creation_date": 1577719765, "answer_id": 59533165, "question_id": 59532657, "link": "https://stackoverflow.com/questions/59532657/unable-to-compile-with-error-c2440-due-to-type-cast-from-c-to-c/59533165#59533165", "title": "Unable to compile with Error C2440 due to type cast from C to C++", "body": "<p>You can first cast <code>CODE</code> to a void pointer, then cast that to your function pointer:</p>\n\n<pre><code>AsmVmxCallType AsmVmxCall = (AsmVmxCallType)(void *)CODE;\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 12523465, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-L3zpqCFXAn8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3resZrlacOTbA8aJRCIQZ_RXN844BQ/photo.jpg?sz=128", "display_name": "Roger Feng", "link": "https://stackoverflow.com/users/12523465/roger-feng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1577719765, "creation_date": 1577717323, "last_edit_date": 1577718742, "question_id": 59532657, "link": "https://stackoverflow.com/questions/59532657/unable-to-compile-with-error-c2440-due-to-type-cast-from-c-to-c", "title": "Unable to compile with Error C2440 due to type cast from C to C++", "body": "<pre><code>inline BOOL FupVmCall(ULONG_PTR hypercall_number, void *context) {\n#pragma section(\".asm\", read, execute)\n  __declspec(allocate(\".asm\")) static const BYTE CODE[] = {\n      0x0F, 0x01, 0xC1, //    vmcall\n      0x74, 0x0E,       //    jz      short errorWithCode\n      0x72, 0x04,       //    jb      short errorWithoutCode\n      0x48, 0x33, 0xC0, //    xor     rax, rax\n      0xC3,             //    retn\n                        // errorWithoutCode:\n      0x48, 0xC7, 0xC0, 0x02, 0x00, 0x00, 0x00, //    mov     rax, 2\n      0xC3,                                     //    retn\n                                                // errorWithCode:\n      0x48, 0xC7, 0xC0, 0x01, 0x00, 0x00, 0x00, //    mov     rax, 1\n      0xC3,                                     //    retn\n  };\n\n  typedef unsigned char(__stdcall * AsmVmxCallType)(\n      _In_ ULONG_PTR hypercall_number, _In_opt_ void *context);\n\n#pragma warning(suppress : 4055)\n  AsmVmxCallType AsmVmxCall = (AsmVmxCallType)CODE;\n\n  __try {\n    return AsmVmxCall(hypercall_number, context) == 0;\n  } __except (EXCEPTION_EXECUTE_HANDLER) {\n    SetLastError(GetExceptionCode());\n    return FALSE;\n  }\n}\n</code></pre>\n\n<p>I am trying to compile above code from C++ project with VS2019</p>\n\n<p>If I change main file to main.c, it compiles without any problem</p>\n\n<p>However, If I change it to main.cpp, I get C2440 type cast problem.</p>\n\n<pre><code>C2440   'type cast': cannot convert from 'const BYTE [27]' to 'AsmVmxCallType'\n</code></pre>\n\n<pre><code>AsmVmxCallType AsmVmxCall = (AsmVmxCallType)CODE;\n</code></pre>\n\n<p>I even tried to wrap with <code>extern \"C\"</code> but did not solve the issue.</p>\n\n<p>How can I make this typecast?</p>\n"}, {"tags": ["c++", "c", "linux", "file", "fopen"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1577716810, "post_id": 59532527, "comment_id": 105234642, "body": "A little nitpicking about terms, a <code>FILE *</code> is a C file stream (not to be confused with C++ stream objects), while the integer returned by e.g. <code>open</code> is a <i>descriptor</i> (in the case of <code>open</code> it&#39;s a file descriptor)."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1577716925, "post_id": 59532527, "comment_id": 105234706, "body": "As for your problem, <code>open</code> followed by <code>fdopen</code> is probably the simplest and most straight-forward way, unless you want to bother with <a href=\"https://pubs.opengroup.org/onlinepubs/9699919799/functions/chmod.html\" rel=\"nofollow noreferrer\"><code>chmod</code></a> after opening the file."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1577716961, "post_id": 59532527, "comment_id": 105234725, "body": "Lastly a little more nitpicking: There&#39;s no <code>fopen_s</code> function in the C, C++ or POSIX standards, it&#39;s a Microsoft Visual C++ CRT specific extension."}, {"owner": {"reputation": 803, "user_id": 8214369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eaad6d5047a978a9498deb0e2171069d?s=128&d=identicon&r=PG&f=1", "display_name": "Irad K", "link": "https://stackoverflow.com/users/8214369/irad-k"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1577717090, "post_id": 59532527, "comment_id": 105234777, "body": "Hi, I&#39;ve read about fopen_s here <code>https:&#47;&#47;en.cppreference.com&#47;w&#47;c&#47;io&#47;fopen</code> so I assumed it also support posix."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1577717116, "post_id": 59532527, "comment_id": 105234788, "body": "@Someprogrammerdude There is an <code>fopen_s()</code> in the <b>optional</b> Annex K of the C11 standard.  No significant implementation other than Microsoft&#39;s exists, and Microsoft&#39;s doesn&#39;t fully comply with the C standard anyway."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1577717344, "post_id": 59532527, "comment_id": 105234898, "body": "You could <code>fopen</code> with <code>chmod</code>, but that won&#39;t be atomic."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1577717377, "post_id": 59532527, "comment_id": 105234912, "body": "@IradK Read this for some data on the &quot;safer&quot; <code>*_s()</code> functions:  <a href=\"https://stackoverflow.com/questions/50724726/why-didnt-gcc-implement-s-functions\" title=\"why didnt gcc implement s functions\">stackoverflow.com/questions/50724726/&hellip;</a>"}, {"owner": {"reputation": 803, "user_id": 8214369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eaad6d5047a978a9498deb0e2171069d?s=128&d=identicon&r=PG&f=1", "display_name": "Irad K", "link": "https://stackoverflow.com/users/8214369/irad-k"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1577717465, "post_id": 59532527, "comment_id": 105234954, "body": "@KamilCuk, perhaps you can provide simple code block to demonstrate your idea ?"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1577718928, "post_id": 59532527, "comment_id": 105235553, "body": "@KamilCuk There is no atomic way to create a file with a guaranteed set of permissions.  The mode passed to <code>open()</code> is subject to modification via the <code>umask</code> setting, and that <code>umask</code> setting can be changed between its being set/checked and any subsequent call to <code>open()</code>."}], "answers": [{"tags": [], "owner": {"reputation": 130, "user_id": 7432614, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--2ytgbMhDsI/AAAAAAAAAAI/AAAAAAAAAGE/GpuydtIRoHA/photo.jpg?sz=128", "display_name": "Alexander Ryker", "link": "https://stackoverflow.com/users/7432614/alexander-ryker"}, "is_accepted": false, "score": 2, "last_activity_date": 1577717105, "creation_date": 1577717105, "answer_id": 59532620, "question_id": 59532527, "link": "https://stackoverflow.com/questions/59532527/create-accessible-file-from-root-privilege-process/59532620#59532620", "title": "Create accessible file from root privilege process", "body": "<p>No. The technique you described (<code>open</code> followed by <code>fdopen</code>) is the correct way to achieve what you want to do. As Some programmer dude pointed out, you could call <code>chmod</code> from your program to change the file permissions after it's created, but that's a more roundabout way to do it.</p>\n"}, {"comments": [{"owner": {"reputation": 803, "user_id": 8214369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eaad6d5047a978a9498deb0e2171069d?s=128&d=identicon&r=PG&f=1", "display_name": "Irad K", "link": "https://stackoverflow.com/users/8214369/irad-k"}, "edited": false, "score": 0, "creation_date": 1577719935, "post_id": 59532925, "comment_id": 105235986, "body": "in your solution of calling <code>fchmod</code> right after <code>fopen</code>, should I check if the file was created or simply changing the permissions anyway ?"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 803, "user_id": 8214369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eaad6d5047a978a9498deb0e2171069d?s=128&d=identicon&r=PG&f=1", "display_name": "Irad K", "link": "https://stackoverflow.com/users/8214369/irad-k"}, "edited": false, "score": 0, "creation_date": 1577722302, "post_id": 59532925, "comment_id": 105237052, "body": "@IradK You&#39;d need to check for success from <code>fopen()</code>, else making the <code>fileno()</code> call with a <code>NULL</code> parameter would potentially invoke undefined behavior, likely a <code>SIGSEGV</code> here."}], "tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": true, "score": 1, "last_activity_date": 1577718526, "creation_date": 1577718526, "answer_id": 59532925, "question_id": 59532527, "link": "https://stackoverflow.com/questions/59532527/create-accessible-file-from-root-privilege-process/59532925#59532925", "title": "Create accessible file from root privilege process", "body": "<blockquote>\n  <p>I could use int open(const char *pathname, int flags, mode_t mode); and thus control the file permissions (represented by mode_t)</p>\n</blockquote>\n\n<p>Not really.  Unless you set <a href=\"https://pubs.opengroup.org/onlinepubs/9699919799/functions/umask.html\" rel=\"nofollow noreferrer\">your process's <code>umask</code> setting</a>.  Because the permissions passed to <code>open()</code> are not the permissions the created file is necessarily created with.</p>\n\n<p><a href=\"https://pubs.opengroup.org/onlinepubs/9699919799/functions/open.html\" rel=\"nofollow noreferrer\">Per POSIX <code>open()</code></a> (bolding mine):</p>\n\n<blockquote>\n  <p>the access permission bits (see <a href=\"https://pubs.opengroup.org/onlinepubs/9699919799/basedefs/sys_stat.h.html\" rel=\"nofollow noreferrer\"><code>&lt;sys/stat.h&gt;</code></a>) of the file mode shall be set to the value of the argument following the <code>oflag</code> argument taken as type <code>mode_t</code> <strong>modified as follows</strong>: a bitwise AND is performed on the file-mode bits and the corresponding bits in the complement of the process' file mode creation mask. Thus, all bits in the file mode whose corresponding bit in the file mode creation mask is set are cleared.</p>\n</blockquote>\n\n<p>So</p>\n\n<pre><code>int fd = open( someFileName, O_CREAT | O_RDWR, 0644 );\n</code></pre>\n\n<p>is <strong>NOT</strong> guaranteed to set the file permissions to <code>0644</code>.</p>\n\n<p>If your file creation mask is set to <code>0077</code>, then the file will actually be created with permissions set to <code>0600</code>.</p>\n\n<p>Note that the <code>umask()</code> setting is a process-wide property, and it's not really a good idea to change it much.  And if you're trying to write general-purpose code that has no side effects, it's a bad idea to change it at all.  For example, changing the <code>umask()</code> setting in a multithreaded process in order to allow wider access to files being created can cause \nsecurity problems if another thread creates a file at the same time.</p>\n\n<p>The best way to set file permissions to be exactly what you want is to set file permissions to be exactly what you want with <a href=\"https://pubs.opengroup.org/onlinepubs/9699919799/functions/fchmod.html\" rel=\"nofollow noreferrer\"><code>fchmod()</code></a>:</p>\n\n<pre><code>FILE *f = fopen(...);\nfchmod( fileno( f ), 0644 );\n</code></pre>\n\n<p>In fact, since the <code>umask()</code> setting is a process-wide property, it's always possible in general that it can be changed by another thread at any time, <strong>so setting the permissions explicitly via <code>chmod()</code> or <code>fchmod()</code> is the only guaranteed way to get exactly the permissions specified in all circumstances</strong>.</p>\n"}], "owner": {"reputation": 803, "user_id": 8214369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eaad6d5047a978a9498deb0e2171069d?s=128&d=identicon&r=PG&f=1", "display_name": "Irad K", "link": "https://stackoverflow.com/users/8214369/irad-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 59532925, "answer_count": 2, "score": 0, "last_activity_date": 1577718526, "creation_date": 1577716571, "question_id": 59532527, "link": "https://stackoverflow.com/questions/59532527/create-accessible-file-from-root-privilege-process", "title": "Create accessible file from root privilege process", "body": "<p>I'm having a bunch of processes from different privileges, all running a shared code that open (and create if needed) a file for write using fopen_s with \"a+\" flag. </p>\n\n<p>However, since no permissions that supplied to this command, and a root process create the file first, than other non-root processes couldn't access this file. </p>\n\n<p>I could use <code>int open(const char *pathname, int flags, mode_t mode);</code> and thus control the file permissions (represented by mode_t) to allow access for everyone, but I need the file descriptor (<code>FILE *</code>) and not fileID. so I can use <code>FILE *fdopen(int fd, const char *mode);</code> in order to make the conversion. </p>\n\n<p>Perhaps there's a more straight forward way to do it ? </p>\n"}, {"tags": ["c", "linux", "operating-system"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 2, "creation_date": 1577715013, "post_id": 59532130, "comment_id": 105233908, "body": "It sounds like Windows Subsystem for Linux doesn&#39;t have msgget. In other words: you can&#39;t."}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1577719833, "post_id": 59532130, "comment_id": 105235942, "body": "Run Linux in a VM instead?"}], "owner": {"reputation": 1, "user_id": 12625540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c063ec8ce1a8984129ee71f118949ca?s=128&d=identicon&r=PG&f=1", "display_name": "Kird", "link": "https://stackoverflow.com/users/12625540/kird"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 224, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1577715177, "creation_date": 1577714622, "last_edit_date": 1577715177, "question_id": 59532130, "link": "https://stackoverflow.com/questions/59532130/msgget-fail-function-not-implemented", "title": "Msgget fail: function not implemented", "body": "<p>I am writing client-server app on C and I faced with problem:</p>\n\n<p><code>msgget() fail: Function not implemented</code></p>\n\n<p>I am using Windows Subsystem for Linux with Ubuntu 18.04, may this problem appears cause of WSL?</p>\n\n<p>Here is part of my code:</p>\n\n<pre><code>#include &lt;sys/types.h&gt;\n#include &lt;sys/ipc.h&gt;\n#include &lt;sys/msg.h&gt;\n\n int msg_id;\n msg_id = msgget(IPC_PRIVATE, IPC_CREAT | 0600);\n if (msg_id &lt; 0) {\n     perror(\"msgget\");\n     return EXIT_FAILURE;\n }\n</code></pre>\n\n<p>then I do:\n<code>gcc server.c -o server</code>\nand\n<code>./server</code>\nbut then I get this error with msgget</p>\n\n<p>How should I fix my code?</p>\n"}, {"tags": ["c", "arrays", "multidimensional-array"], "comments": [{"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 1, "creation_date": 1577714535, "post_id": 59532055, "comment_id": 105233701, "body": "You say you have written the function as <code>int print2DArray( int arrayLen, int elementLen, int array[arrayLen][elementLen])</code>.   But you haven&#39;t.   Instead, you have done <code>int print2DArray(int array[][], int arrayLen, int elementLen)</code> which is something completely different (and invalid)."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1577714556, "post_id": 59532055, "comment_id": 105233712, "body": "<code>int array[][]</code> isn&#39;t a valid argument, so forget that. And before this goes on, you&#39;ve already determined your compiler <i>does</i> support VLAs (variable-length-arrays) ? It must, or your <code>int print2DArray( int arrayLen, int elementLen, int array[arrayLen][elementLen])</code> stands no chance of working."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1577715439, "post_id": 59532055, "comment_id": 105234094, "body": "Post the code that causes &quot;I&#39;ve tried to initialize function as  <code>int print2DArray( int arrayLen, int elementLen, int array[arrayLen][elementLen])</code>&quot;.  I suspect you have a transcription error."}, {"owner": {"reputation": 21, "user_id": 4866934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8295b4a51e3d1a0e0e44a18b5678f2d?s=128&d=identicon&r=PG&f=1", "display_name": "Chris M", "link": "https://stackoverflow.com/users/4866934/chris-m"}, "reply_to_user": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1577715471, "post_id": 59532055, "comment_id": 105234108, "body": "@Peter I know, I&#39;ve meant that I&#39;ve tried both methods."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1577715625, "post_id": 59532055, "comment_id": 105234167, "body": "@ChrisM &quot; I&#39;ve tried both methods.&quot; --&gt; yet the post does not show exactly what you tried.  Post shows the code of one failed approach, but   talks about the other.  Post the 2nd code too.  Other useful info: what compiler and version are you using.version?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1577716348, "post_id": 59532055, "comment_id": 105234463, "body": "ChrisM &quot;I&#39;m using tcc for windows and according to documentation it is supposed to support C99 VLA&quot; --&gt; The compiler appears to be in a mode that simply does not accept VLA.  Maybe the compiler options are set for pre-C89, no VLA or &quot;support C99&quot; is only &quot;support most of C99&quot;."}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1577717193, "post_id": 59532055, "comment_id": 105234826, "body": "Note that all of your functions are supposed to return an <code>int</code> value, but none of them actually does."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1577717263, "post_id": 59532055, "comment_id": 105234861, "body": "I meant pre-C99 <a href=\"https://stackoverflow.com/questions/59532055/function-for-printing-2d-arrays-of-uknown-size-in-c/59532632#comment105234463_59532055\">above</a>, not pre C89."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1577715876, "post_id": 59532345, "comment_id": 105234258, "body": "Good first step, yet if <code>int print2DArray(int arrayLen, int elementLen, int arr[][elementLen]);</code> works, so should OP&#39;s <code>int print2DArray( int arrayLen, int elementLen, int array[arrayLen][elementLen])</code> which made a reported error."}, {"owner": {"reputation": 3002, "user_id": 4228131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RyKUe.jpg?s=128&g=1", "display_name": "WedaPashi", "link": "https://stackoverflow.com/users/4228131/wedapashi"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1577715925, "post_id": 59532345, "comment_id": 105234292, "body": "@chux-ReinstateMonica: It should work for C99, right?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1577716022, "post_id": 59532345, "comment_id": 105234328, "body": "Yes, <code>int print2DArray( int arrayLen, int elementLen, int array[arrayLen][elementLen])</code> would work in C99 - and optionally in C11,C17."}, {"owner": {"reputation": 3002, "user_id": 4228131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RyKUe.jpg?s=128&g=1", "display_name": "WedaPashi", "link": "https://stackoverflow.com/users/4228131/wedapashi"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1577716078, "post_id": 59532345, "comment_id": 105234354, "body": "I guess then problem is with how OP is calling this function. Needs to have a look at that."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1577717885, "post_id": 59532345, "comment_id": 105235135, "body": "Answer has weakness, but not a DV."}, {"owner": {"reputation": 3002, "user_id": 4228131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RyKUe.jpg?s=128&g=1", "display_name": "WedaPashi", "link": "https://stackoverflow.com/users/4228131/wedapashi"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1577942142, "post_id": 59532345, "comment_id": 105285328, "body": "@chux-ReinstateMonica: Thank you. I have edited the code to <code>return 0</code> from the <code>print2DArray</code> function. The compiler would have warned there unless it returns something. I think in C we are allowed not opting to catch a return value from a function returning something. Apart from these are there any weaknesses that you think that can be improved on?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1577985850, "post_id": 59532345, "comment_id": 105302813, "body": "Some ideas: &quot;Unless you are using a C99 compiler,&quot; is incorrect as C11,C17 optionally work too.  The key attribute is support for VLA (not mentioned here).   Example uses a 3x3 matrix. Using a non-square matrix improves clarity as to which dimension is what in example code.  OP use <code>int</code> for array dimensions, <code>size_t</code> would be better, yet perhaps better to deal with OP&#39;s primary issues first.  Last 2 lines look like they should have been comments to the question."}, {"owner": {"reputation": 3002, "user_id": 4228131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RyKUe.jpg?s=128&g=1", "display_name": "WedaPashi", "link": "https://stackoverflow.com/users/4228131/wedapashi"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1578029216, "post_id": 59532345, "comment_id": 105314460, "body": "@chux-ReinstateMonica: Thanks a lot. That wisdom comes with experience :-) I hope I&#39;ll get there. I am not sure if I should make those improvements in the answer just like that, because then it will be unfair with other answers, since it will be a collective effort and not an individual one."}], "tags": [], "owner": {"reputation": 3002, "user_id": 4228131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RyKUe.jpg?s=128&g=1", "display_name": "WedaPashi", "link": "https://stackoverflow.com/users/4228131/wedapashi"}, "is_accepted": false, "score": 1, "last_activity_date": 1578029293, "last_edit_date": 1578029293, "creation_date": 1577715729, "answer_id": 59532345, "question_id": 59532055, "link": "https://stackoverflow.com/questions/59532055/function-for-printing-2d-arrays-of-uknown-size-in-c/59532345#59532345", "title": "Function for printing 2D arrays of uknown size in C", "body": "<p>Unless you are using a C99 compiler, </p>\n\n<pre><code>int print2DArray( int arrayLen, int elementLen, int array[arrayLen][elementLen])\n</code></pre>\n\n<p>is not possible.</p>\n\n<p>Even if you are using C99 compiler, your code has a problem. You need to pass one of the dimension first.</p>\n\n<pre><code>int print2DArray(int arrayLen, int elementLen, int arr[][elementLen]);\n</code></pre>\n\n<p>So,</p>\n\n<pre><code>int print2DArray(int arrayLen, int elementLen, int arr[][elementLen]) \n{\n    // Your code\n    int i;\n    int j;\n\n    for (i = 0; i &lt; arrayLen; i++)\n    {\n        for (j=0; j &lt; elementLen; j++)\n        {\n            printf(\"%5d\", array[i][j]);\n        }\n        printf(\"\\n\");\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>This can be used as </p>\n\n<pre><code>int main(void) \n{ \n    int i32Array[3][3] = {{-15, 4, 36}, {45, 55, 12}, {-89, 568, -44568}}; \n    int m = 3, n = 3; \n    // I am not sure why 'print2DArray' would return an int \n    // (or anything at all for that matter). \n    // If you can establish a case for it, \n    // modify the function and the value it is supposed to return,\n    // And catch it below.\n\n    print2DArray(m, n, i32Array); \n\n    return 0; \n}\n</code></pre>\n\n<p>I am not sure how you are calling <code>print2DArray</code> function. Unless you post that piece of code, it is difficult to resolve your problem. Confirm that you are calling the function correctly as shown above.</p>\n"}, {"comments": [{"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1577943128, "post_id": 59532632, "comment_id": 105285556, "body": "Doesn&#39;t this approach cause undefined behavior of the type mentioned in <a href=\"http://port70.net/~nsz/c/c11/n1570.html#J.2\" rel=\"nofollow noreferrer\">Annex J.2</a>: &quot;<i>An array subscript is out of range, even if an object is apparently accessible with the given subscript (as in the lvalue expression a[1][7] given the declaration int a[4][5]) (6.5.6)</i>&quot; and <a href=\"https://stackoverflow.com/questions/6290956/one-dimensional-access-to-a-multidimensional-array-is-it-well-defined-behaviour\">discussed here</a>?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1577986679, "post_id": 59532632, "comment_id": 105303166, "body": "@exnihilo Interesting:  I would say it is not UB given <code>const int *array</code> does not carry limitations of the 2 dimensions of <code>int array[ARRAY_LEN][ELEMENT_LEN]</code>, only that the overall indexing is limited by <code>ARRAY_LEN*ELEMENT_LEN</code> and no <a href=\"https://stackoverflow.com/a/6293364/2410359\">aliasing</a> in <code>print2DArrayX()</code>."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 4, "last_activity_date": 1577718217, "last_edit_date": 1577718217, "creation_date": 1577717179, "answer_id": 59532632, "question_id": 59532055, "link": "https://stackoverflow.com/questions/59532055/function-for-printing-2d-arrays-of-uknown-size-in-c/59532632#59532632", "title": "Function for printing 2D arrays of uknown size in C", "body": "<p>It appears OP's compiler (or the mode it is used) does not support <em>variable length array</em> (VLA) as a function parameter.</p>\n\n<p>Below is a non-VLA approach.</p>\n\n<pre><code>void print2DArrayX(int arrayLen, int elementLen, const int *array) {\n  int i;\n  int j;\n\n  for (i = 0; i &lt; arrayLen; i++) {\n    for (j = 0; j &lt; elementLen; j++) {\n      printf(\"%5d\", array[i*elementLen + j]);\n    }\n    printf(\"\\n\");\n  }\n}\n</code></pre>\n\n<p>Call with address of first <code>int</code>, not the 2D array</p>\n\n<pre><code>#define ARRAY_LEN 3\n#define ELEMENT_LEN 4\nint array[ARRAY_LEN][ELEMENT_LEN] = { 0 };\n...\nprint2DArrayX(ARRAY_LEN, ELEMENT_LEN, array[0]);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1577717577, "post_id": 59532674, "comment_id": 105234999, "body": "&quot;A bit strange since documentation says it does.&quot; --&gt; best to post the errant tcc quote and the version of tcc."}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1577717889, "post_id": 59532674, "comment_id": 105235137, "body": "Do you mean this doc: <a href=\"https://bellard.org/tcc/tcc-doc.html#Clang\" rel=\"nofollow noreferrer\">bellard.org/tcc/tcc-doc.html#Clang</a> ? I haven&#39;t found any way to specify a particular standard, though."}, {"owner": {"reputation": 21, "user_id": 4866934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8295b4a51e3d1a0e0e44a18b5678f2d?s=128&d=identicon&r=PG&f=1", "display_name": "Chris M", "link": "https://stackoverflow.com/users/4866934/chris-m"}, "reply_to_user": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1577719183, "post_id": 59532674, "comment_id": 105235662, "body": "@Bob__ yes, this little document. Since tcc &#39;help&#39; doesn&#39;t show any options for specifying a standard I&#39;d assume that VLA is &#39;on&#39; by default. To be honest at least I found out that VLA isn&#39;t part of ANSI C standard. I have to stay within ANSI C, so it&#39;s not a real problem for me."}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1577720738, "post_id": 59532674, "comment_id": 105236352, "body": "Not to open that can of worms, but even if it&#39;s common to refer to C89 as ANSI C, the <a href=\"https://webstore.ansi.org/Standards/ISO/ISOIEC98992018\" rel=\"nofollow noreferrer\">current ANSI C standard</a> is C18."}], "tags": [], "owner": {"reputation": 21, "user_id": 4866934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8295b4a51e3d1a0e0e44a18b5678f2d?s=128&d=identicon&r=PG&f=1", "display_name": "Chris M", "link": "https://stackoverflow.com/users/4866934/chris-m"}, "is_accepted": false, "score": 1, "last_activity_date": 1577717818, "last_edit_date": 1577717818, "creation_date": 1577717388, "answer_id": 59532674, "question_id": 59532055, "link": "https://stackoverflow.com/questions/59532055/function-for-printing-2d-arrays-of-uknown-size-in-c/59532674#59532674", "title": "Function for printing 2D arrays of uknown size in C", "body": "<p>Ok, so thanks for all the answers - they were very helpful. I've just tried to use gcc in linux and as you've pointed out this approach works fine:</p>\n\n<p><code>int print2DArray( int arrayLen, int elementLen, int array[arrayLen][elementLen])</code></p>\n\n<p>I guess <strong>tcc (tiny c compiler, windows version 0.9.27) doesn't support VLA</strong> after all. A bit strange since documentation says it does.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 5895482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/034b6b0418e4a06c385178cf55283bb7?s=128&d=identicon&r=PG&f=1", "display_name": "Salah Eddine", "link": "https://stackoverflow.com/users/5895482/salah-eddine"}, "is_accepted": false, "score": 1, "last_activity_date": 1577720994, "creation_date": 1577720994, "answer_id": 59533432, "question_id": 59532055, "link": "https://stackoverflow.com/questions/59532055/function-for-printing-2d-arrays-of-uknown-size-in-c/59533432#59533432", "title": "Function for printing 2D arrays of uknown size in C", "body": "<p>How about you try this solution.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n\nint print2DArray(int* array, int arrayLen, int elementLen)\n{\n    int i;\n    int j;\n\n    for (i = 0; i &lt; arrayLen; i++)\n    {\n        for (j=0; j &lt; elementLen; j++)\n        {\n            printf(\"%5d \", *(array+j+elementLen*i));\n        }\n        printf(\"\\n\");\n    }\n\n}\n\nint main(){\n    int arr[2][6] = {   {9,258,9,96,-8,5},\n                        {1,1212,-3,45,27,-6}\n                      };\n    print2DArray(*arr,2,6);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 4866934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8295b4a51e3d1a0e0e44a18b5678f2d?s=128&d=identicon&r=PG&f=1", "display_name": "Chris M", "link": "https://stackoverflow.com/users/4866934/chris-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1578029293, "creation_date": 1577714223, "last_edit_date": 1577715975, "question_id": 59532055, "link": "https://stackoverflow.com/questions/59532055/function-for-printing-2d-arrays-of-uknown-size-in-c", "title": "Function for printing 2D arrays of uknown size in C", "body": "<p>I'm new to C programming and I've run into a problem when creating 2D array printing function. When I try to execute the code below I get:</p>\n\n<p><code>points.c:13: error: unknown array element size</code></p>\n\n<p>As I've checked there are very similar codes online, which are supposed to work. I've tried to initialize function as </p>\n\n<p><code>int print2DArray( int arrayLen, int elementLen, int array[arrayLen][elementLen])</code></p>\n\n<p>but it raises:</p>\n\n<p><code>points.c:3: error: 'arrayLen' undeclared</code></p>\n\n<p>Could somebody tell me what's wrong with this code and how to fix it? I also don't understand why very similar function for 1D arrays works just fine. It has to be in pure C.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n//supposed to print 2D array:\nint print2DArray(int array[][], int arrayLen, int elementLen)\n{\n    int i;\n    int j;\n\n    for (i = 0; i &lt; arrayLen; i++)\n    {\n        for (j=0; j &lt; elementLen; j++)\n        {\n            printf(\"%5d\", array[i][j]);\n        }\n        printf(\"\\n\");\n    }\n}\n\n//prints 1D array:\n\nint printArray( int array[], int arrayLen)\n{\n    int i;\n    for (i = 0; i &lt; arrayLen; i++)\n    {\n        printf(\"%d\", array[i]);\n    }\n}\n</code></pre>\n\n<p>--- edit ---</p>\n\n<p>I undestand most of you pointed out that the function has to be called like that: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint print2DArray( int arrayLen, int elementLen, int array[arrayLen][elementLen])\n{\n    int i;\n    int j;\n\n    for (i = 0; i &lt; arrayLen; i++)\n    {\n        for (j=0; j &lt; elementLen; j++)\n        {\n            printf(\"%5d\", array[i][j]);\n        }\n        printf(\"\\n\");\n    }\n}\n</code></pre>\n\n<p>This raises an error:</p>\n\n<p><code>points.c:3: error: 'arrayLen' undeclared</code></p>\n\n<p>I'm using tcc for windows and according to documentation it is supposed to support C99 VLA.</p>\n"}, {"tags": ["c++", "c", "iar"], "comments": [{"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1577713257, "post_id": 59531838, "comment_id": 105233105, "body": "Which compiler do you use? Maybe VLAs are not supported."}, {"owner": {"reputation": 7060, "user_id": 105466, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/jMWs6.png?s=128&g=1", "display_name": "SurvivalMachine", "link": "https://stackoverflow.com/users/105466/survivalmachine"}, "edited": false, "score": 1, "creation_date": 1577713272, "post_id": 59531838, "comment_id": 105233112, "body": "No, the size is not constant."}, {"owner": {"reputation": 7060, "user_id": 105466, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/jMWs6.png?s=128&g=1", "display_name": "SurvivalMachine", "link": "https://stackoverflow.com/users/105466/survivalmachine"}, "edited": false, "score": 0, "creation_date": 1577714595, "post_id": 59531838, "comment_id": 105233724, "body": "You should remove the <code>c++</code> tag because you mentioned that you&#39;re using C89."}], "answers": [{"comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1577713909, "post_id": 59531869, "comment_id": 105233407, "body": "It&#39;s also specific to IAR compiler running in C89 dialect mode (or with VLA not allowed)."}, {"owner": {"reputation": 1, "user_id": 12625356, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDkrB7FV4X6ksA26qy5hKyR7elQKCIEpwuYR9PgkQ=k-s128", "display_name": "Serapmirage", "link": "https://stackoverflow.com/users/12625356/serapmirage"}, "edited": false, "score": 0, "creation_date": 1577714022, "post_id": 59531869, "comment_id": 105233477, "body": "\u0131 try to compile this code in IAR WORKBENCH for static analysis . \u0131t support C89"}, {"owner": {"reputation": 7060, "user_id": 105466, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/jMWs6.png?s=128&g=1", "display_name": "SurvivalMachine", "link": "https://stackoverflow.com/users/105466/survivalmachine"}, "reply_to_user": {"reputation": 1, "user_id": 12625356, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDkrB7FV4X6ksA26qy5hKyR7elQKCIEpwuYR9PgkQ=k-s128", "display_name": "Serapmirage", "link": "https://stackoverflow.com/users/12625356/serapmirage"}, "edited": false, "score": 0, "creation_date": 1577773973, "post_id": 59531869, "comment_id": 105250226, "body": "@Serapmirage if this solves your issue, you should accept the Answer so others can find it more easily."}], "tags": [], "owner": {"reputation": 7060, "user_id": 105466, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/jMWs6.png?s=128&g=1", "display_name": "SurvivalMachine", "link": "https://stackoverflow.com/users/105466/survivalmachine"}, "is_accepted": false, "score": 0, "last_activity_date": 1577714467, "last_edit_date": 1577714467, "creation_date": 1577713373, "answer_id": 59531869, "question_id": 59531838, "link": "https://stackoverflow.com/questions/59531838/how-to-solve-expression-must-have-a-constant-value-error-in-iar/59531869#59531869", "title": "How to solve expression must have a constant value error in IAR?", "body": "<p>C89 doesn't have variable length arrays, so</p>\n\n<p>this line is wrong:</p>\n\n<pre><code>int x[n];\n</code></pre>\n\n<p>It depends on the function parameter <code>n</code> which is not a compile-time constant.</p>\n\n<p>You could replace the raw array with a <code>malloc</code>:</p>\n\n<pre><code>int* x = malloc( n * sizeof( int ) );\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12625356, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDkrB7FV4X6ksA26qy5hKyR7elQKCIEpwuYR9PgkQ=k-s128", "display_name": "Serapmirage", "link": "https://stackoverflow.com/users/12625356/serapmirage"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1577714467, "creation_date": 1577713191, "question_id": 59531838, "link": "https://stackoverflow.com/questions/59531838/how-to-solve-expression-must-have-a-constant-value-error-in-iar", "title": "How to solve expression must have a constant value error in IAR?", "body": "<p>I get the compile error: <code>\"expression must have a constant value\"</code>, even though size is a constant. where is my fault \u0131 can't find it??</p>\n\n<pre><code> void foo(int n)\n    {\n    int x[n];\n    int i = 5;\n    if (i == 0)\n    i--;\n    x[i] = 5; //OK, since i is 4\n    }\n</code></pre>\n"}, {"tags": ["c", "dynamic-arrays"], "comments": [{"owner": {"reputation": 53, "user_id": 12608121, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5N52e7Kxf1M/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdFKz_eA4HLfkFyJzooD7X7_D9gMA/photo.jpg?sz=128", "display_name": "Gulshan Mishra", "link": "https://stackoverflow.com/users/12608121/gulshan-mishra"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1577713363, "post_id": 59531788, "comment_id": 105233161, "body": "@WhozCriag I would be grateful If you explain this a bit more"}], "answers": [{"tags": [], "owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "is_accepted": true, "score": 1, "last_activity_date": 1577714134, "creation_date": 1577714134, "answer_id": 59532032, "question_id": 59531788, "link": "https://stackoverflow.com/questions/59531788/program-terminated-with-signal-sigabrt-aborted/59532032#59532032", "title": "Program terminated with signal SIGABRT, Aborted", "body": "<p>Your code potentially invokes <em>undefined behavior</em> in at least one location, and <em>definitely</em> invokes it in another.</p>\n\n<p><code>realloc</code> allows an input pointer value that is either:</p>\n\n<ol>\n<li><code>NULL</code></li>\n<li>A value returned from <code>malloc</code>, <code>calloc</code>, or <code>realloc</code></li>\n</ol>\n\n<p>Your initial allocation of <code>seqList</code> :</p>\n\n<pre><code>seqList = (int**)malloc(n * sizeof(int*));\n</code></pre>\n\n<p>creates a sequence of pointers to int. Those pointers are <em>indeterminate</em> (they have no determined value, be it NULL or any other valid value) that can be passed to <code>realloc</code>. Therefore, later in code when you do this:</p>\n\n<pre><code>seqList[i] = (int*)realloc(seqList[i], sizeof(int)*l_sub_seq[i]);\nhere ======================^^^^^^^^^^\n</code></pre>\n\n<p>You're invoke <em>undefined behavior</em>. You can address this by ensuring your intial array contents are null-populated, either by using zero-filling <code>calloc</code> (easiest), or by loop, memset, whatever.</p>\n\n<p>Later, at the end of your program, you do this:</p>\n\n<pre><code>for (int i = 0; i &lt; n; i++)\n    free(l_sub_seq);\n</code></pre>\n\n<p>That's nonsense. <code>l_sub_seq</code> was allocated with:</p>\n\n<pre><code>int *l_sub_seq = (int*)calloc(n, sizeof(int));\n</code></pre>\n\n<p>It should be free'd <em>once</em>, not in some loop, repeatedly passing the same pointer value over and over to <code>free</code>.</p>\n\n<pre><code>free(l_sub_seq); // no loop.\n</code></pre>\n\n<p>Whether the rest of your program \"works\" is up to you to decide, but the reasons for your termination woes are likely from the issues covered above.</p>\n"}], "owner": {"reputation": 53, "user_id": 12608121, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5N52e7Kxf1M/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdFKz_eA4HLfkFyJzooD7X7_D9gMA/photo.jpg?sz=128", "display_name": "Gulshan Mishra", "link": "https://stackoverflow.com/users/12608121/gulshan-mishra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 718, "favorite_count": 0, "accepted_answer_id": 59532032, "answer_count": 1, "score": 0, "last_activity_date": 1577717804, "creation_date": 1577712983, "last_edit_date": 1577717804, "question_id": 59531788, "link": "https://stackoverflow.com/questions/59531788/program-terminated-with-signal-sigabrt-aborted", "title": "Program terminated with signal SIGABRT, Aborted", "body": "<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\nint main(void)\n{\n    int **seqList, n, q;\n    scanf(\"%d %d\", &amp;n, &amp;q);\n    seqList = (int**)malloc(n * sizeof(int*));\n    int *l_sub_seq = (int*)calloc(n, sizeof(int));//length of subsequences of all sequences                                              \n    int lastAnswer = 0;\n\n    while(q--)\n    {\n        int type, x, y, i;\n        scanf(\"%d %d %d\", &amp;type, &amp;x, &amp;y);\n        i = (x^lastAnswer) % n;\n        switch(type)\n        {\n            case 1:\n            l_sub_seq[i]++;\n            seqList[i] = (int*)realloc(seqList[i], sizeof(int)*l_sub_seq[i]);\n            seqList[i][l_sub_seq[i] - 1] = y;\n            break;\n\n            case 2:\n            lastAnswer = seqList[i][y%l_sub_seq[i]];\n            printf(\"\\n\");\n            break;\n        }\n    }\n    for(int i = 0; i &lt; n; i++)\n        free(seqList[i]);\n    free(seqList);\n\n    for(int i = 0; i &lt; n; i++)\n        free(l_sub_seq);\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Compiler message:</strong><br></p>\n\n<blockquote>\n  <p>free(): double free detected in tcache 2<br> Reading symbols from\n  Solution...done.<br> [New LWP 335079]<br> [Thread debugging using\n  libthread_db enabled]<br> Using host libthread_db library\n  \"/lib/x86_64-linux-gnu/libthread_db.so.1\".<br> Core was generated by\n  `./Solution'.<br> Program terminated with signal SIGABRT, Aborted.<br>\n  <em>#0  __GI_raise (sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:50</em><br></p>\n</blockquote>\n"}, {"tags": ["c", "arrays", "for-loop"], "comments": [{"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1577712842, "post_id": 59531731, "comment_id": 105232898, "body": "Your array <code>arr</code> is not initialized."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1577712875, "post_id": 59531731, "comment_id": 105232917, "body": "You&#39;re not storing <i>anything</i> to <code>arr</code> in that loop, Sans initialization, the content of <code>arr</code> is <i>indeterminate</i>."}, {"owner": {"reputation": 133, "user_id": 7177756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lufcl.jpg?s=128&g=1", "display_name": "Joao Jorge", "link": "https://stackoverflow.com/users/7177756/joao-jorge"}, "edited": false, "score": 0, "creation_date": 1577713169, "post_id": 59531731, "comment_id": 105233064, "body": "You are printing out something that has not been initialized yet. what do you really want?"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 11540908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123c1ff99aa2e4c28883087d67368fb0?s=128&d=identicon&r=PG&f=1", "display_name": "Natalia", "link": "https://stackoverflow.com/users/11540908/natalia"}, "edited": false, "score": 0, "creation_date": 1577715865, "post_id": 59531781, "comment_id": 105234250, "body": "Thank you! I have one more question, how can I make my for loop start counting from start to store the numbers in Array like this : 1, 2, 3, 4, 1, 2, 3, 4 \u2026 etc? I used while(i!=5) and then the for loop, but the code was then stuck in my for loop. So what line can make the for loop start counting from start to fill the Array?"}, {"owner": {"reputation": 130, "user_id": 7432614, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--2ytgbMhDsI/AAAAAAAAAAI/AAAAAAAAAGE/GpuydtIRoHA/photo.jpg?sz=128", "display_name": "Alexander Ryker", "link": "https://stackoverflow.com/users/7432614/alexander-ryker"}, "reply_to_user": {"reputation": 25, "user_id": 11540908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123c1ff99aa2e4c28883087d67368fb0?s=128&d=identicon&r=PG&f=1", "display_name": "Natalia", "link": "https://stackoverflow.com/users/11540908/natalia"}, "edited": false, "score": 1, "creation_date": 1577716480, "post_id": 59531781, "comment_id": 105234516, "body": "You can use the <a href=\"https://www.cprogramming.com/tutorial/modulus.html\" rel=\"nofollow noreferrer\">modulus operator</a> to achieve this, like so (make sure this is inside your for loop):  <code>arr[i] = (i % 4) + 1;</code>"}], "tags": [], "owner": {"reputation": 130, "user_id": 7432614, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--2ytgbMhDsI/AAAAAAAAAAI/AAAAAAAAAGE/GpuydtIRoHA/photo.jpg?sz=128", "display_name": "Alexander Ryker", "link": "https://stackoverflow.com/users/7432614/alexander-ryker"}, "is_accepted": true, "score": 3, "last_activity_date": 1577713469, "last_edit_date": 1577713469, "creation_date": 1577712946, "answer_id": 59531781, "question_id": 59531731, "link": "https://stackoverflow.com/questions/59531731/adding-numbers-to-an-array-with-for-loop-in-c/59531781#59531781", "title": "Adding numbers to an array with for loop in C", "body": "<p>Your code never explicitly assigns values to the items in the array. In C, variables that are not explicitly declared contain random values. If you're expecting the array to contain zeroes by default, you'd want to declare your array like this:</p>\n\n<pre><code>int arr[5] = {0};\n</code></pre>\n\n<p>If you want to store the numbers 1 through 4 in your array, you need to add a line in your for loop to assign those values:</p>\n\n<pre><code>arr[i] = i + 1;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 513, "user_id": 10532629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/827650de0b201131dc41e1aa1317fb77?s=128&d=identicon&r=PG&f=1", "display_name": "kalpaj agrawalla", "link": "https://stackoverflow.com/users/10532629/kalpaj-agrawalla"}, "is_accepted": false, "score": 1, "last_activity_date": 1577713955, "last_edit_date": 1577713955, "creation_date": 1577712996, "answer_id": 59531792, "question_id": 59531731, "link": "https://stackoverflow.com/questions/59531731/adding-numbers-to-an-array-with-for-loop-in-c/59531792#59531792", "title": "Adding numbers to an array with for loop in C", "body": "<p>Without initializing <code>arr</code>, you end up with <a href=\"https://stackoverflow.com/a/41115230/10532629\">garbage values</a>.</p>\n\n<p>The code for initializing during declaration is given below:</p>\n\n<pre><code>int arr[5] = {1, 2, 3, 4, 5}; // This is declaration and initialisation of arr\nfor (int i = 0; i &lt; 5; i++) {\n  printf(\"%d \", arr[i]);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 130, "user_id": 7432614, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--2ytgbMhDsI/AAAAAAAAAAI/AAAAAAAAAGE/GpuydtIRoHA/photo.jpg?sz=128", "display_name": "Alexander Ryker", "link": "https://stackoverflow.com/users/7432614/alexander-ryker"}, "edited": false, "score": 2, "creation_date": 1577713156, "post_id": 59531798, "comment_id": 105233057, "body": "This is incorrect. The for loop will iterate 5 times (from 0 to 4 inclusive). The problem is not related to array indices; the problem is that the values inside the array are never set."}, {"owner": {"reputation": 11, "user_id": 12625545, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/904dde16092772838647b802a1f84bf2?s=128&d=identicon&r=PG", "display_name": "Salih", "link": "https://stackoverflow.com/users/12625545/salih"}, "reply_to_user": {"reputation": 130, "user_id": 7432614, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--2ytgbMhDsI/AAAAAAAAAAI/AAAAAAAAAGE/GpuydtIRoHA/photo.jpg?sz=128", "display_name": "Alexander Ryker", "link": "https://stackoverflow.com/users/7432614/alexander-ryker"}, "edited": false, "score": 0, "creation_date": 1577713346, "post_id": 59531798, "comment_id": 105233155, "body": "I&#39;ve noticed this error now and shared a new command line. I&#39;d appreciate it if you examined him. Thank you."}], "tags": [], "owner": {"reputation": 11, "user_id": 12625545, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/904dde16092772838647b802a1f84bf2?s=128&d=identicon&r=PG", "display_name": "Salih", "link": "https://stackoverflow.com/users/12625545/salih"}, "is_accepted": false, "score": 0, "last_activity_date": 1577716726, "last_edit_date": 1577716726, "creation_date": 1577713012, "answer_id": 59531798, "question_id": 59531731, "link": "https://stackoverflow.com/questions/59531731/adding-numbers-to-an-array-with-for-loop-in-c/59531798#59531798", "title": "Adding numbers to an array with for loop in C", "body": "<p>Need to initialize the array and the variable before using them.</p>\n\n<pre><code>int i = 0, arr[5] = {1,2,3,4,5};\n    for(i=0;i&lt;5;i++)\n        printf(\"%d \",arr[i]);\n</code></pre>\n\n<p>updated the proper answer.</p>\n"}, {"comments": [{"owner": {"reputation": 1021, "user_id": 566206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19ca91f7505dabcab8a805a316c2fded?s=128&d=identicon&r=PG", "display_name": "mail2subhajit", "link": "https://stackoverflow.com/users/566206/mail2subhajit"}, "edited": false, "score": 1, "creation_date": 1577714196, "post_id": 59531850, "comment_id": 105233557, "body": "Please delete this answer and edit your existing answer."}], "tags": [], "owner": {"reputation": 11, "user_id": 12625545, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/904dde16092772838647b802a1f84bf2?s=128&d=identicon&r=PG", "display_name": "Salih", "link": "https://stackoverflow.com/users/12625545/salih"}, "is_accepted": false, "score": 1, "last_activity_date": 1577713249, "creation_date": 1577713249, "answer_id": 59531850, "question_id": 59531731, "link": "https://stackoverflow.com/questions/59531731/adding-numbers-to-an-array-with-for-loop-in-c/59531850#59531850", "title": "Adding numbers to an array with for loop in C", "body": "<p>And insert after <code>int i, arr[5];</code></p>\n\n<pre><code>arr[5] = {1,2,3,4,5};\n</code></pre>\n\n<p>or try this code...</p>\n\n<pre><code>int i,arr[5];\n    for(i=0;i&lt;5;i++){\n        arr[i] = (i + 1);\n        printf(\"%d \",arr[i]);\n}\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 11540908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123c1ff99aa2e4c28883087d67368fb0?s=128&d=identicon&r=PG&f=1", "display_name": "Natalia", "link": "https://stackoverflow.com/users/11540908/natalia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3491, "favorite_count": 0, "accepted_answer_id": 59531781, "answer_count": 4, "score": 0, "last_activity_date": 1577716726, "creation_date": 1577712706, "question_id": 59531731, "link": "https://stackoverflow.com/questions/59531731/adding-numbers-to-an-array-with-for-loop-in-c", "title": "Adding numbers to an array with for loop in C", "body": "<p>So I don't really understand why when I use for loop to store numbers from 1 to 4 I get random numbers? When I use for loop without an Array Everything works just fine, but when i add Array, the numbers I get are random, can someone explain why the numbers are random? Here is the simple code:</p>\n\n<p><code>int i, arr[5];\n    for(i=1; i&lt;5; i++){\n    printf(\"%d \", arr[i]);</code> </p>\n"}, {"tags": ["c++", "c", "function", "switch-statement"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 2, "creation_date": 1577712442, "post_id": 59531589, "comment_id": 105232716, "body": "Where is the function defined?"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1577716388, "post_id": 59531589, "comment_id": 105234479, "body": "Possible duplicate: <a href=\"https://stackoverflow.com/q/12573816/5910058\">What is an undefined reference/unresolved external symbol error and how do I fix it?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 119, "user_id": 7842106, "user_type": "registered", "profile_image": "https://graph.facebook.com/1207993432657536/picture?type=large", "display_name": "Andr&#233; Cascais", "link": "https://stackoverflow.com/users/7842106/andr%c3%a9-cascais"}, "is_accepted": false, "score": 1, "last_activity_date": 1577713873, "last_edit_date": 1577713873, "creation_date": 1577712351, "answer_id": 59531640, "question_id": 59531589, "link": "https://stackoverflow.com/questions/59531589/im-creating-a-function-type-program-and-wont-stop-saying-text0xe0-undefi/59531640#59531640", "title": "I&#39;m creating a function type program and won&#39;t stop saying: (.text+0xe0): undefined reference to", "body": "<p>You have declared but not implemented the function</p>\n\n<pre><code>float circ(float pi, float radio);\n</code></pre>\n\n<p>e:\nWhat you want can be accomplished with: (i assume circle area)</p>\n\n<pre><code>float circ(float pi, float radius) {\n    return pi * (radius * radius);\n}\n</code></pre>\n\n<p>By the way you have a M_PI constant defined in the math header. You could have your function defined as follow:</p>\n\n<pre><code>#include &lt;math.h&gt;\n\nfloat circ(float radius) {\n    return M_PI * (radius * radius);\n}\n</code></pre>\n\n<p>If you can try to code in english so that everyone can understand your thought process better.</p>\n"}, {"tags": [], "owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "is_accepted": false, "score": 0, "last_activity_date": 1577713027, "last_edit_date": 1577713027, "creation_date": 1577712711, "answer_id": 59531732, "question_id": 59531589, "link": "https://stackoverflow.com/questions/59531589/im-creating-a-function-type-program-and-wont-stop-saying-text0xe0-undefi/59531732#59531732", "title": "I&#39;m creating a function type program and won&#39;t stop saying: (.text+0xe0): undefined reference to", "body": "<p><em>every of the functions I defined</em>, no! Every function you declared but not defined.</p>\n\n<p>A declaration is something that let the compiler verify you use the thing correctly.</p>\n\n<p>A definition is the <em>construction</em> of the thing; for a function associates the prototype of the function to the code of it. A definition is also a declaration.</p>\n\n<p><code>float rect(float l1, float l2);</code> is a declaration. The compiler then know that you can pass two <code>floats</code> and get in return a <code>float</code> from a call.</p>\n\n<p><code>float rect(float l1, float l2) { return l1*l2; }</code> is a definition. Thus the compiler knows what instruction are to be executed when the function is called.</p>\n\n<p>There is also some other errors. <code>scanf</code> must be used like:</p>\n\n<pre><code>scanf(\"%f\",&amp;radio);\n</code></pre>\n\n<p><code>\"%f\"</code> is the format specifier to mean that a string representing a floating point number must be readable from the input and that the value must be stored in <code>radio</code> (thus prefix <code>&amp;</code>  to mean at the address of).</p>\n\n<p>Also use <code>break</code> on every case of your <code>switch</code> like:</p>\n\n<pre><code>switch(...) {\ncase ...:\n    ...\n    break;\ncase ...:\n    ...\n    break;\n}\n</code></pre>\n\n<p>You can omit <code>break</code> but this is probably not what you want to do...</p>\n"}], "owner": {"reputation": 1, "user_id": 12625439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909dd9b3073c9cfd7cf10355ad740dc3?s=128&d=identicon&r=PG&f=1", "display_name": "&#193;lvaro Cabo", "link": "https://stackoverflow.com/users/12625439/%c3%81lvaro-cabo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1577714840, "creation_date": 1577712125, "last_edit_date": 1577714840, "question_id": 59531589, "link": "https://stackoverflow.com/questions/59531589/im-creating-a-function-type-program-and-wont-stop-saying-text0xe0-undefi", "title": "I&#39;m creating a function type program and won&#39;t stop saying: (.text+0xe0): undefined reference to", "body": "<p>An error pops up for every one of the functions I've defined:</p>\n\n<blockquote>\n  <p>C:\\Users\\ALVARO~1\\AppData\\Local\\Temp\\cc7yNnth.o    Ejercicio.cpp:(.text+0xe0): undefined reference to `circ(float, float)'</p>\n</blockquote>\n\n<p>Here is my code:</p>\n\n<pre><code>float circ(float pi, float radio);\nfloat cuad(float lado);\nfloat rect(float l1, float l2);\nfloat triang(float b, float h);\n\nint main () {\n    float pi=3.14;\n    char opc;\n    printf(\"Introuce 1 para ciculo\");\n    printf(\"2 para cuadrado\");\n    printf(\"3 para rectangulo\");\n    printf(\"4 para triangulo\");\n    scanf(\"%c\", &amp;opc);\n    while(opc != 4)\n\n    switch(opc) {\n        case 1:\n            float radio;\n            printf(\"Introduce el valor del radio: \");\n            scanf(\"&amp;f\", radio);\n            printf(\"El area del circulo es: %f\", circ(pi, radio));\n            system(\"pause\");\n\n        case 2:\n            float lado;\n            printf(\"Introduce el valor del radio: \");\n            scanf(\"&amp;f\", lado);\n            printf(\"El area del cuadrado es: %f\", cuad(lado));\n            system(\"pause\");\n\n        case 3:\n            float ancho, largo;\n            printf(\"Introduce el valor del ancho: \");\n            scanf(\"&amp;f\", ancho);\n            printf(\"Introduce el valor del largo: \");\n            scanf(\"&amp;f\", largo);\n            printf(\"El area del rectangulo es: %f\", rect(ancho, largo));\n            system(\"pause\");\n\n        case 4:\n            float base;\n            float altura;\n            printf(\"Introduce el valor de la base: \");\n            scanf(\"&amp;f\", base);\n            printf(\"Introduce el valor de la altura: \");\n            scanf(\"&amp;f\", altura);\n            printf(\"El area del triangulo es: %f\", triang(base, altura));\n            system(\"pause\");\n    }\n}\n</code></pre>\n\n<p>What's going wrong?</p>\n"}, {"tags": ["c", "string", "substring"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1577712357, "post_id": 59531546, "comment_id": 105232681, "body": "You just get the first substring, modify the string, then get the next and modify the (modified) string, then the next and the next...."}, {"owner": {"reputation": 1, "user_id": 12625379, "user_type": "registered", "profile_image": "https://graph.facebook.com/2508565619265322/picture?type=large", "display_name": "Saledin Mert Aykut", "link": "https://stackoverflow.com/users/12625379/saledin-mert-aykut"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1577712496, "post_id": 59531546, "comment_id": 105232745, "body": "Thank you for your quick answer, Paul Ogilvie! But the problem requires that all of the substrings need to be red first and afterwards they need to be modified. It&#39;s a model for an exam."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1577716537, "post_id": 59531546, "comment_id": 105234537, "body": "Then you read the substrings into an array or list and process them one-by-one (how difficult can it be to come up with this?)"}, {"owner": {"reputation": 1, "user_id": 12625379, "user_type": "registered", "profile_image": "https://graph.facebook.com/2508565619265322/picture?type=large", "display_name": "Saledin Mert Aykut", "link": "https://stackoverflow.com/users/12625379/saledin-mert-aykut"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1577717808, "post_id": 59531546, "comment_id": 105235099, "body": "The problem specifies that the substrings need to be inputed from keyboard one at a time with &quot; &quot; space between them, Paul Ogilvie! I don&#39;t understand what you are suggesting, I am sorry."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1577722829, "post_id": 59531546, "comment_id": 105237292, "body": "I say that the fact that the substrings need to be <i>input</i> one at a time does not imply they have to be <i>processed</i> directly after input. How are you doing now on your assignment? Still having problems?"}], "answers": [{"tags": [], "owner": {"reputation": 1132, "user_id": 10048703, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g4Etl.png?s=128&g=1", "display_name": "davidm", "link": "https://stackoverflow.com/users/10048703/davidm"}, "is_accepted": false, "score": 1, "last_activity_date": 1577725449, "creation_date": 1577725449, "answer_id": 59534337, "question_id": 59531546, "link": "https://stackoverflow.com/questions/59531546/substring-replacement-in-a-string-in-c/59534337#59534337", "title": "Substring replacement in a string in C", "body": "<p>So I edited my answer based on your and @PaulOgilvie suggestions. I hope that the program now works as you expected.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n#define MAX_SIZE 5129\n\nvoid replaceSubstring(char *p, int len){\n    for(int i = 0; i &lt; len; i++, p++){\n        *p = '*';\n        }\n    }\n\nint main() {   \n    int n = 0;\n    char str[MAX_SIZE];\n    char substr[n][100];\n\n    printf(\"Type the string:\\n\");\n    fgets(str, MAX_SIZE, stdin);\n\n    printf(\"How many substrings to modify?\");\n    scanf(\"%d\",&amp;n);\n\n\n    for( int i=0 ; i&lt; n ; i++) {\n        printf(\"\\nType the substring number %d:\", i+1);\n            scanf(\"%s\",substr[i]);\n    }\n\n    char *p;\n    for ( int i=0; i &lt; n; i++){\n         p = strstr(str, substr[i]);\n         while(p != NULL) {\n             replaceSubstring(p, strlen(substr[i]));\n             p = strstr(str, substr[i]);\n             }\n    }\n\n    printf(\"\\nThe modified string is:\\n\");\n    for ( int i=0 ; i&lt; strlen(str) ; i++)\n            {\n                printf(\"%c\",str[i]);\n            }\n    return 0;\n}\n\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12625379, "user_type": "registered", "profile_image": "https://graph.facebook.com/2508565619265322/picture?type=large", "display_name": "Saledin Mert Aykut", "link": "https://stackoverflow.com/users/12625379/saledin-mert-aykut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "closed_date": 1577785666, "answer_count": 1, "score": -3, "last_activity_date": 1577725449, "creation_date": 1577711935, "last_edit_date": 1577712241, "question_id": 59531546, "link": "https://stackoverflow.com/questions/59531546/substring-replacement-in-a-string-in-c", "closed_reason": "Needs details or clarity", "title": "Substring replacement in a string in C", "body": "<p>everyone! I decided to make an account on this site seeking for help because I could not find anything that can help me. I have a problem which requires multiple steps:\n1) Read a string from keyboard;\n2) Read an integer that represents the number of substrings that you want to modify ( By modifying it means to transform all of the characters of the string into \" * \" );\n3)Read all of the substrings that need to be modified;\n4) Print the initial string modified.\nI tried to make it with little steps by firstly managing to do it with one substring, but I don't know  how to do it when I read multiple substrings. So, here are the versions\nVERSION 1</p>\n\n<pre><code>#include&lt;stdlib.h&gt;\n#include&lt;string.h&gt;\nint main()\n{   \n    int n;\n    char str[5120];\n    char substr[100];\n    printf(\"Type the string:\\n\");\n    gets(str);\n    printf(\"\\nType the substring which you would like to modify:\");\n    gets(substr);\n    char *p;\n    p = strstr(str,substr);\n        if (*p != '\\0')\n            {\n                for( int j=0 ; j&lt; strlen(substr); j++)\n                        {\n                            *p = '*';\n                            p++;\n                        }\n                }\n    printf(\"\\nThe modified string is:\\n\");\n    for ( int i=0 ; i&lt; strlen(a) ; i++)\n            {\n                printf(\"%c\",a[i]);\n            }\n    return 0;\n}\n</code></pre>\n\n<p>AND THE VERSION IN WHICH I TRIED TO MODIFY MULTIPLE</p>\n\n<pre><code>#include&lt;stdlib.h&gt;\n#include&lt;string.h&gt;\nint main()\n{   \n    int n;\n    char str[5129];\n    char substr[n][100];\n    printf(\"Type the string:\\n\");\n    gets(str);\n    printf(\"How many substrings to modify?\");\n    scanf(\"%d\",&amp;n);\n    printf(\"\\nType the substrings:\");\n    for( int i=0 ; i&lt; n ; i++)\n        {\n            scanf(\"%s\",substr[i]);\n            printf(\" \");\n        }\n    for ( int i=0; i &lt; n; i++)\n        {\n            char *p;\n            p = strstr(str,substr[i]);\n            if (*p != '\\0')\n                {\n                    for( int j=0 ; j&lt; strlen(cuv[i]); j++)\n                        {\n                            *p = '*';\n                            p++;\n                        }\n                }\n        }\n    printf(\"\\nThe modified string is:\\n\");\n    for ( int i=0 ; i&lt; strlen(str) ; i++)\n            {\n                printf(\"%c\",str[i]);\n            }\n    return 0;\n}```\nI guess for the n times that I cycle to the string I have to allocate memory somewhere, or I don't know..\nPlease, I need some help! Thank you!\n\n</code></pre>\n"}, {"tags": ["c", "visual-studio", "compiler-errors"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1577712074, "post_id": 59531526, "comment_id": 105232576, "body": "Where exactly does this happen (file, line, please show here)? Note that the order of includes may be important."}, {"owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "edited": false, "score": 0, "creation_date": 1577712316, "post_id": 59531526, "comment_id": 105232663, "body": "Really just a &#39;guess&#39; - but this sort of thing can come about due to the project&#39;s &quot;strictness&quot; settings. Try: <code>Project -&gt; Properties -&gt; C&#47;C++ -&gt; Language</code> and changing &quot;Conformance Mode&quot; from <code>Yes (&#47;permissive-)</code> to <code>No</code>."}, {"owner": {"reputation": 23, "user_id": 12523465, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-L3zpqCFXAn8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3resZrlacOTbA8aJRCIQZ_RXN844BQ/photo.jpg?sz=128", "display_name": "Roger Feng", "link": "https://stackoverflow.com/users/12523465/roger-feng"}, "edited": false, "score": 0, "creation_date": 1577712433, "post_id": 59531526, "comment_id": 105232714, "body": "#include &quot;fu.h&quot; #include &lt;stdio.h&gt;  int main() {     printf(&quot;Hello World\\n&quot;); } The error happens on line 230 of fu.h Error\tC2440\t&#39;type cast&#39;: cannot convert from &#39;const BYTE [40]&#39; to &#39;AsmVmxCallType&#39;"}, {"owner": {"reputation": 23, "user_id": 12523465, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-L3zpqCFXAn8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3resZrlacOTbA8aJRCIQZ_RXN844BQ/photo.jpg?sz=128", "display_name": "Roger Feng", "link": "https://stackoverflow.com/users/12523465/roger-feng"}, "edited": false, "score": 0, "creation_date": 1577712539, "post_id": 59531526, "comment_id": 105232762, "body": "&quot;Conformance Mode&quot; from Yes (/permissive-) to No didnt solve the issue"}, {"owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "edited": false, "score": 2, "creation_date": 1577712869, "post_id": 59531526, "comment_id": 105232913, "body": "Hmmm \u2026 guesses only work <i>sometimes</i>. Second guess - Have you set the &#39;language&#39; to &quot;C++&quot; instead of &quot;C&quot; (or &quot;default&quot;)?"}, {"owner": {"reputation": 23, "user_id": 12523465, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-L3zpqCFXAn8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3resZrlacOTbA8aJRCIQZ_RXN844BQ/photo.jpg?sz=128", "display_name": "Roger Feng", "link": "https://stackoverflow.com/users/12523465/roger-feng"}, "edited": false, "score": 1, "creation_date": 1577713314, "post_id": 59531526, "comment_id": 105233133, "body": "by changing main file from cpp to c solved the problem! However, I need to use fu.h in cpp."}], "owner": {"reputation": 23, "user_id": 12523465, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-L3zpqCFXAn8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3resZrlacOTbA8aJRCIQZ_RXN844BQ/photo.jpg?sz=128", "display_name": "Roger Feng", "link": "https://stackoverflow.com/users/12523465/roger-feng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1577711802, "creation_date": 1577711802, "question_id": 59531526, "link": "https://stackoverflow.com/questions/59531526/c2440-compiler-error-only-with-new-project-but-not-from-existing-project", "title": "C2440 compiler error only with new project but not from existing project", "body": "<p>I am having weird issue of C2440 'type cast': cannot convert from 'const BYTE [40]' to 'AsmVmxCallType'</p>\n\n<p><a href=\"https://github.com/tandasat/FU_Hypervisor/blob/master/TestPrograms/SampleHook/SampleHook/fu.h\" rel=\"nofollow noreferrer\">https://github.com/tandasat/FU_Hypervisor/blob/master/TestPrograms/SampleHook/SampleHook/fu.h</a></p>\n\n<p>I am trying to reuse this header file but I get C2440 during compile.\nI am currently using VS2019 and I was able to compile <a href=\"https://github.com/tandasat/FU_Hypervisor/blob/master/TestPrograms/SampleHook\" rel=\"nofollow noreferrer\">https://github.com/tandasat/FU_Hypervisor/blob/master/TestPrograms/SampleHook</a></p>\n\n<p>However, whenever I import fu.h into other project, i get C2440 type cast error.\nI created clean project and imported fu.h and still get same C2440 error</p>\n\n<p>What I dont get is that how come it compiles fine when I use original project but not in my project?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1577711578, "post_id": 59531322, "comment_id": 105232341, "body": "<a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">Why is \u201cwhile ( !feof (file) )\u201d always wrong?</a>. It helps if you actually validate you read as many arguments as you think you did in your scanf calls, rather than assuming they always work. Assumption is the mother of all..."}, {"owner": {"reputation": 25, "user_id": 12524689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e20994a46597b1169383992e75d6bc80?s=128&d=identicon&r=PG&f=1", "display_name": "ThisIsHard", "link": "https://stackoverflow.com/users/12524689/thisishard"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1577712695, "post_id": 59531322, "comment_id": 105232827, "body": "@WhozCraig Ermmm.. so what should i use instead in my case? Sorry but im very new in programming."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1577712737, "post_id": 59531322, "comment_id": 105232846, "body": "Read the Q&amp;A in the link. it spells out ample alternatives."}, {"owner": {"reputation": 12144, "user_id": 72882, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9d17e71eae127205da470fffa2dba899?s=128&d=identicon&r=PG", "display_name": "dandan78", "link": "https://stackoverflow.com/users/72882/dandan78"}, "edited": false, "score": 0, "creation_date": 1577733477, "post_id": 59531322, "comment_id": 105241164, "body": "Read <a href=\"https://meta.stackoverflow.com/questions/284236/why-is-can-someone-help-me-not-an-actual-question\">this question and it&#39;s high-voted answer on Meta</a> to learn why &quot;can anybody help me is not a question&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 1132, "user_id": 10048703, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g4Etl.png?s=128&g=1", "display_name": "davidm", "link": "https://stackoverflow.com/users/10048703/davidm"}, "is_accepted": false, "score": 1, "last_activity_date": 1577742704, "last_edit_date": 1577742704, "creation_date": 1577732886, "answer_id": 59535736, "question_id": 59531322, "link": "https://stackoverflow.com/questions/59531322/im-trying-to-make-linked-list-by-reading-it-from-the-file/59535736#59535736", "title": "Im trying to make linked list by reading it from the file", "body": "<p>So the main error in your code is already well explained in few answers, take a look at the following links: </p>\n\n<ol>\n<li><a href=\"https://stackoverflow.com/a/26557243/10048703\">feof</a></li>\n<li><a href=\"https://stackoverflow.com/a/23185805/10048703\">fscanf</a></li>\n</ol>\n\n<p>The following code snippet should be the solution for your question, notice that I have only one function.</p>\n\n<p><strong>Input (input.txt)</strong></p>\n\n<pre><code>\nstudent01 1 95.000000\nstudent03 3 90.000000\nstudent05 5 86.000000\nstudent07 7 83.000000\nstudent09 9 98.000000\nstudent10 10 93.000000\nstudent08 8 92.000000\nstudent06 6 96.000000\nstudent04 4 93.000000\nstudent02 2 88.000000\n\n\n</code></pre>\n\n<p><strong>Solution</strong> </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct student {\n    int id;\n    char name[20];\n    float marks;\n    struct student *next;\n};\ntypedef struct student node;\n\nvoid read(node *list) {\n    FILE *fp;\n    char filename[30];\n    printf(\"input file name: \");\n    scanf(\"%s\",filename);\n    fp=fopen(filename,\"r\");\n\n    if(fp == NULL) return; // file doesn't exist\n\n    while(fscanf(fp, \"%s %d %f\", list-&gt;name, &amp;list-&gt;id, &amp;list-&gt;marks) == 3) {\n        printf(\"%s \\t%d \\t%f\\n\", list-&gt;name,list-&gt;id,list-&gt;marks);\n\n        list-&gt;next=(node*)malloc(sizeof(node));\n     }\n    fclose(fp);\n}\n\nint main() {\n    node *head; \n    head=(node *) malloc(sizeof(node));\n    read(head); \n    return 0;\n}\n\n</code></pre>\n\n<p><strong>Output</strong></p>\n\n<pre><code>input file name: input.txt\nstudent01   1   95.000000\nstudent03   3   90.000000\nstudent05   5   86.000000\nstudent07   7   83.000000\nstudent09   9   98.000000\nstudent10   10  93.000000\nstudent08   8   92.000000\nstudent06   6   96.000000\nstudent04   4   93.000000\nstudent02   2   88.000000\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 12524689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e20994a46597b1169383992e75d6bc80?s=128&d=identicon&r=PG&f=1", "display_name": "ThisIsHard", "link": "https://stackoverflow.com/users/12524689/thisishard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "closed_date": 1577743698, "answer_count": 1, "score": 0, "last_activity_date": 1577742704, "creation_date": 1577710930, "last_edit_date": 1577712323, "question_id": 59531322, "link": "https://stackoverflow.com/questions/59531322/im-trying-to-make-linked-list-by-reading-it-from-the-file", "closed_reason": "Duplicate", "title": "Im trying to make linked list by reading it from the file", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#define NULL 0\n\nstruct student\n{\n    int id;\n    char name[20];\n    float marks;\n    struct student *next\n};\ntypedef struct student node;\nvoid main()\n{\n    node *head;\n    void read(node *p);\n    void create(node *p);\n    int count(node *p);\n    void print(node *p);\n    head=(node *)malloc(sizeof(node));\n    read(head);\n\n}\nvoid read(node *list)\n{\n    FILE *fp;\n    char filename[30];\n    int i;\n    printf(\"input file name:\");\n    scanf(\"%s\",filename);\n    fp=fopen(filename,\"r\");\n\n    while(!feof(fp))\n    {\n        create_f(list,fp);\n    }\n\n}\nvoid create_f(node *list,FILE *fp )\n{\n    fscanf(fp,\"%s %d %f\",\n               list-&gt;name,&amp;list-&gt;id,&amp;list-&gt;marks);\n    printf(\"%s \\t%d \\t%f\\n\",\n                        list-&gt;name,list-&gt;id,list-&gt;marks);\n\n   list-&gt;next=(node*)malloc(sizeof(node));\n    return;\n}\n</code></pre>\n\n<p>The file that supposed to be read is this:\n<a href=\"https://i.stack.imgur.com/MJXzU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MJXzU.png\" alt=\"image\"></a>\n<br>but for some reasons it read the last line twice. Can anybody help me?</p>\n\n<p><a href=\"https://i.stack.imgur.com/OXAyj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OXAyj.png\" alt=\"image\"></a></p>\n\n<p>if you cannot open it here is the output:</p>\n\n<blockquote>\n  <p>input file name:input.txt.txt <br>student01       1       95.000000\n  <br>student03       3       90.000000 <br>student05       5       86.000000\n  <br>student07       7       83.000000 <br>student09       9       98.000000\n  <br>student10       10      93.000000 <br>student08       8       92.000000\n  <br>student06       6       96.000000 <br>student04       4       93.000000\n  <br>student02       2       88.000000 <br>student02       2       88.000000</p>\n  \n  <p>Process returned 16 (0x10)   execution time : 4.043 s Press any key to\n  continue.</p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/MJXzU.png\" rel=\"nofollow noreferrer\">1</a>: </p>\n"}, {"tags": ["c", "file"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1577710504, "post_id": 59531218, "comment_id": 105231885, "body": "Can you post some example lines from the input? What have you tried?"}, {"owner": {"reputation": 53, "user_id": 12609452, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDSI9HWFgEVCcYo_PVscN7RMI8gzoFPmDr0rq9Ftw=k-s128", "display_name": "Dongilica", "link": "https://stackoverflow.com/users/12609452/dongilica"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1577710543, "post_id": 59531218, "comment_id": 105231903, "body": "Peter#Schmit 16"}, {"owner": {"reputation": 53, "user_id": 12609452, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDSI9HWFgEVCcYo_PVscN7RMI8gzoFPmDr0rq9Ftw=k-s128", "display_name": "Dongilica", "link": "https://stackoverflow.com/users/12609452/dongilica"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1577710572, "post_id": 59531218, "comment_id": 105231921, "body": "Jhon#Simons 9 and so on"}, {"owner": {"reputation": 53, "user_id": 12609452, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDSI9HWFgEVCcYo_PVscN7RMI8gzoFPmDr0rq9Ftw=k-s128", "display_name": "Dongilica", "link": "https://stackoverflow.com/users/12609452/dongilica"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1577710650, "post_id": 59531218, "comment_id": 105231965, "body": "i havent tried anything i dont have any idea how can i separate those two cause u dont have fixed number of chars in name and surname so u cant hard code it and pc sees it like one string"}, {"owner": {"reputation": 53, "user_id": 12609452, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDSI9HWFgEVCcYo_PVscN7RMI8gzoFPmDr0rq9Ftw=k-s128", "display_name": "Dongilica", "link": "https://stackoverflow.com/users/12609452/dongilica"}, "edited": false, "score": 0, "creation_date": 1577710769, "post_id": 59531218, "comment_id": 105232018, "body": "can you please give me short example how to do it"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1577710770, "post_id": 59531218, "comment_id": 105232019, "body": "Ok. You read a whole line. Then you find the <code>#</code>. Them copy from the beginning of the line to the <code>#</code> character into <code>name</code>. Then you find the space in the line. You copy from after the <code>#</code> character to the space into <code>surname</code>. Then you find end of line. You convert from the next character after space to the end of line the character to a number (ex. with <code>atoi</code>). And you save the number into <code>age</code>. You can find <a href=\"https://www.google.com/search?q=fgets+example\" rel=\"nofollow noreferrer\">many examples of C online</a>."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1577711270, "post_id": 59531218, "comment_id": 105232216, "body": "&quot;<i>(file is binary)</i>&quot;: What do you see if you open the input file using a text editor?"}, {"owner": {"reputation": 53, "user_id": 12609452, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDSI9HWFgEVCcYo_PVscN7RMI8gzoFPmDr0rq9Ftw=k-s128", "display_name": "Dongilica", "link": "https://stackoverflow.com/users/12609452/dongilica"}, "edited": false, "score": 0, "creation_date": 1577711589, "post_id": 59531218, "comment_id": 105232348, "body": "well it looks crypted (wierd)... I opened it with notepad... and it is written in the task that input file is binary"}], "answers": [{"tags": [], "owner": {"reputation": 610, "user_id": 10797718, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GmD35.jpg?s=128&g=1", "display_name": "Ben Souchet", "link": "https://stackoverflow.com/users/10797718/ben-souchet"}, "is_accepted": true, "score": 0, "last_activity_date": 1577713192, "creation_date": 1577713192, "answer_id": 59531841, "question_id": 59531218, "link": "https://stackoverflow.com/questions/59531218/how-to-save-single-line-from-file-to-two-different-strings%c2%b8in-struct-line-for/59531841#59531841", "title": "How to save single line from file to two different strings&#184;in struct &gt;&gt; line format(NAME#SURNAME AGE)", "body": "<p><strong>If you want more help about the code please do a first version and edit you question, then add a comment and the community will help you.</strong></p>\n\n<p>But if you are looking for the methodology you can go with something like that :</p>\n\n<ol>\n<li>Open the file you want to extract data in read mode (e.g. <code>fopen(filename, \"r\")</code>)</li>\n<li>Check if the file was correctly open</li>\n<li>Use a while and take N characters with <code>fgets()</code> or use <code>getline()</code> (Note that <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1248.pdf\" rel=\"nofollow noreferrer\"><code>getline()</code></a> is in ISO/IEC TR 24731-2:2010 extension (see <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1248.pdf\" rel=\"nofollow noreferrer\">n1248</a>).).<br>There is lots of threads about how to read line by line in a file (e.g. <a href=\"https://stackoverflow.com/questions/9206091/going-through-a-text-file-line-by-line-in-c\">Going through a text file line by line in C</a>)</li>\n<li>Now you are looking for a way to split your line with delimiters, your can use <code>strtok()</code>, <code>strsep()</code>/<code>strpbrk()</code> or you can do your own implementation of a <a href=\"http://source-code-share.blogspot.com/2014/07/implementation-of-java-stringsplit.html\" rel=\"nofollow noreferrer\">simple string delimiter</a> (<a href=\"https://stackoverflow.com/questions/9210528/split-string-with-delimiters-in-c\">Maybe look this question</a>)</li>\n<li><p>Next the AGE part, you wan to only copy the line with an AGE superior to 15, so use <code>strtol()</code> to convert your string to <code>long int</code> then check the value.<br>Don't use <code>atoi()</code> this function is deprecated).</p>\n\n<blockquote>\n  <p>The atoi() function has been deprecated by strtol() and should not be used in new code.</p>\n</blockquote>\n\n<p>source <a href=\"https://developer.apple.com/library/archive/documentation/System/Conceptual/ManPages_iPhoneOS/man3/atoi.3.html\" rel=\"nofollow noreferrer\">Mac OS X Manual Page for atoi(3)</a></p></li>\n<li><p>Then you need to create and/or write to a file. You can use <code>fopen(newFilename, \"w\")</code>, check the file descriptor the function give you in return, if it's ok you can add line with <code>fprintf()</code> (e.g. <code>fprintf(fd, \"%s %s %s\\r\\n\", name, age, surname);</code>).</p></li>\n</ol>\n\n<p>If this is one of your first project/exercise in c take your time to properly understand the function you use and <strong><em>always check the returned values before using them</em></strong>.</p>\n"}], "owner": {"reputation": 53, "user_id": 12609452, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDSI9HWFgEVCcYo_PVscN7RMI8gzoFPmDr0rq9Ftw=k-s128", "display_name": "Dongilica", "link": "https://stackoverflow.com/users/12609452/dongilica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 59531841, "answer_count": 1, "score": 0, "last_activity_date": 1577713438, "creation_date": 1577710462, "question_id": 59531218, "link": "https://stackoverflow.com/questions/59531218/how-to-save-single-line-from-file-to-two-different-strings%c2%b8in-struct-line-for", "title": "How to save single line from file to two different strings&#184;in struct &gt;&gt; line format(NAME#SURNAME AGE)", "body": "<p>So i have task to output to one file certain things from another file... Lets say input file is in format \n(NAME#SURNAME AGE) with 100 lines and i have to output persons that are older then 15 in this format\n(NAME AGE SURNAME) and i have something like this in struct</p>\n\n<pre><code>struct person\n{\n    char name[10];\n    char surname[10];\n    int age;\n};\n</code></pre>\n\n<p>Can I, and if I can how can I fread my input file to that struct (file is binary)</p>\n"}, {"tags": ["c", "binary"], "comments": [{"owner": {"reputation": 354, "user_id": 11389043, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-I_o3Ep6MDig/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc0hwvbl7DiKIK7zqQbH5zk3uSsBw/mo/photo.jpg?sz=128", "display_name": "Alex B", "link": "https://stackoverflow.com/users/11389043/alex-b"}, "edited": false, "score": 0, "creation_date": 1577710655, "post_id": 59531192, "comment_id": 105231966, "body": "Did you consider using bit fields instead (<a href=\"https://users.cs.cf.ac.uk/Dave.Marshall/C/node13.html\" rel=\"nofollow noreferrer\">users.cs.cf.ac.uk/Dave.Marshall/C/node13.html</a> or <a href=\"https://en.wikipedia.org/wiki/Bit_field#C_programming_language\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Bit_field#C_programming_language</a>)?  status[1] creates an array of one element; if you want to make sure it is exactly 8 bits long (why?) you could write char status: 8"}, {"owner": {"reputation": 61700, "user_id": 5291015, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZFijZ.jpg?s=128&g=1", "display_name": "Inian", "link": "https://stackoverflow.com/users/5291015/inian"}, "edited": false, "score": 0, "creation_date": 1577710821, "post_id": 59531192, "comment_id": 105232045, "body": "Also bit shifting of negative count is undefined"}, {"owner": {"reputation": 35, "user_id": 12619491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a2adb9a93683f1f13e05692b3e58e75?s=128&d=identicon&r=PG&f=1", "display_name": "OscarTheMighty", "link": "https://stackoverflow.com/users/12619491/oscarthemighty"}, "edited": false, "score": 0, "creation_date": 1577710881, "post_id": 59531192, "comment_id": 105232071, "body": "I tried using bit fields like u said but it gives me Segfault, the &quot;char status[1]&quot; was the only option without segfault."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1577710957, "post_id": 59531192, "comment_id": 105232110, "body": "@OscarTheMighty Then you must have done something else wrong in the code you haven&#39;t shown us."}, {"owner": {"reputation": 35, "user_id": 12619491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a2adb9a93683f1f13e05692b3e58e75?s=128&d=identicon&r=PG&f=1", "display_name": "OscarTheMighty", "link": "https://stackoverflow.com/users/12619491/oscarthemighty"}, "edited": false, "score": 0, "creation_date": 1577711180, "post_id": 59531192, "comment_id": 105232188, "body": "I am reading from a binary file and all is good and well before this line of code &quot;fread(cook[i]-&gt;dish[j].status,sizeof(char),1,inputFile);&quot;"}, {"owner": {"reputation": 354, "user_id": 11389043, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-I_o3Ep6MDig/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc0hwvbl7DiKIK7zqQbH5zk3uSsBw/mo/photo.jpg?sz=128", "display_name": "Alex B", "link": "https://stackoverflow.com/users/11389043/alex-b"}, "edited": false, "score": 0, "creation_date": 1577712603, "post_id": 59531192, "comment_id": 105232789, "body": "You should write <code>fread(&amp;cook[i].dish, ...)</code> if <code>status</code> isn&#39;t an array, also the index variable  <code>j</code> does never make sense since the <code>status</code> array in your original example has always the length 1, so j must always be 0."}], "answers": [{"tags": [], "owner": {"reputation": 354, "user_id": 11389043, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-I_o3Ep6MDig/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc0hwvbl7DiKIK7zqQbH5zk3uSsBw/mo/photo.jpg?sz=128", "display_name": "Alex B", "link": "https://stackoverflow.com/users/11389043/alex-b"}, "is_accepted": true, "score": 2, "last_activity_date": 1577713081, "last_edit_date": 1577713081, "creation_date": 1577711296, "answer_id": 59531414, "question_id": 59531192, "link": "https://stackoverflow.com/questions/59531192/using-bitwise-operations-on-char/59531414#59531414", "title": "Using bitwise operations on char", "body": "<p>With some tweaks your code works:</p>\n\n<pre><code>int getBit(char data, size_t bitNumber) {\n return (data &amp; (1 &lt;&lt; (bitNumber - 1))) != 0;\n}\n\nint main(void) {\n\n  char status = 3 + (1 &lt;&lt; 5);\n\n  for (size_t i = 1; i &lt;= 8; ++i) {\n    printf(\"Bit %d: %d\\n\", (int) i, getBit(status, i));\n  }\n  return 0;\n}\n</code></pre>\n\n<p>I used size_t for the bit number (which is unsigned) and fixed the braces around the term. </p>\n\n<p>With bit fields, the code could look like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\ntypedef struct {\n  union {\n    struct {\n      unsigned stars:3;\n      char cancelled:1;\n      char ongoing:1;\n    };\n    unsigned char data;\n  };\n} Dish;\n\nvoid printDish(Dish dish) {\n  printf(\"Stars = %d, Cancelled = %d, Ongoing = %d\\nValue: %d\\n\", dish.stars, dish.cancelled, dish.ongoing, dish.data);\n}\n\nint main(void) {\n\n  Dish dish1;\n  dish1.stars = 3;\n  dish1.cancelled = 1;\n  dish1.ongoing = 1;\n  printDish(dish1);\n\n  Dish dish2;\n  dish2.stars = 5;\n  dish2.cancelled = 0;\n  dish2.ongoing = 0;\n\n  printDish(dish2);\n  return 0;\n}\n</code></pre>\n\n<p>This will output:</p>\n\n<pre><code>clang version 7.0.0-3~ubuntu0.18.04.1 (tags/RELEASE_700/final)\n clang-7 -pthread -lm -o main main.c\n ./main\nStars = 3, Cancelled = -1, Ongoing = -1\nValue: 27\nStars = 5, Cancelled = 0, Ongoing = 0\nValue: 37\n</code></pre>\n\n<p>You can access the 'char' value with .data and everything else with named fields. If you want to cast the file you read (via fread), you probably want to make sure alignment of the struct is correct.</p>\n\n<p>See <a href=\"https://repl.it/repls/SimultaneousIncredibleRoot\" rel=\"nofollow noreferrer\">https://repl.it/repls/SimultaneousIncredibleRoot</a></p>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 2, "last_activity_date": 1577711328, "creation_date": 1577711328, "answer_id": 59531420, "question_id": 59531192, "link": "https://stackoverflow.com/questions/59531192/using-bitwise-operations-on-char/59531420#59531420", "title": "Using bitwise operations on char", "body": "<p>There is no great sense to declare the data member status as an array with one element</p>\n\n<pre><code>char status[1];\n</code></pre>\n\n<p>You could declare it like</p>\n\n<pre><code>unsigned char status;\n</code></pre>\n\n<p>The function can look like it is shown in the demonstrative program below.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;limits.h&gt;\n\nunsigned int getBit( unsigned char data, unsigned int bitNumber ) \n{\n    bitNumber %= CHAR_BIT;\n\n    return ( data &amp; (1 &lt;&lt; bitNumber ) ) != 0;\n}\n\nint main(void) \n{\n    for ( int i = 0; i &lt;3; i++ )\n    {\n        printf( \"%d\\n\", getBit( 6, i ) );\n    }       \n\n    return 0;\n}\n</code></pre>\n\n<p>The program output is</p>\n\n<pre><code>0\n1\n1\n</code></pre>\n\n<p>On the other hand, as the data member <code>status</code> consists from bit fields then instead of extracting one bit you could use masks for each bit field to extract it.</p>\n\n<p>Another approach is to use bit fields instead of an object of the type unsigned char. Something like</p>\n\n<pre><code>typedef struct {\n    unsigned char stars: 3;\n    unsigned char cancelled: 1;\n    //... \n} Dish;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 1, "creation_date": 1577712160, "post_id": 59531514, "comment_id": 105232608, "body": "Your union declaration is incorrect: you need to put all the bit fields into a struct. By contrast, there\u2019s no need (and no use) to put <code>status</code> into an anonymous struct."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1577713149, "post_id": 59531514, "comment_id": 105233044, "body": "The ordering of bit fields is also completely platform-dependent and unspecified by standard.  There is no guarantee which bits in <code>status</code> any of the bit fields actually represent.  Even different compilers on the same system can place the bit fields in a different order and neither would be wrong."}, {"owner": {"reputation": 3002, "user_id": 4228131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RyKUe.jpg?s=128&g=1", "display_name": "WedaPashi", "link": "https://stackoverflow.com/users/4228131/wedapashi"}, "reply_to_user": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 0, "creation_date": 1577714831, "post_id": 59531514, "comment_id": 105233833, "body": "@KonradRudolph: Oh yes, actually it makes sense now. Thanks a lot."}, {"owner": {"reputation": 3002, "user_id": 4228131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RyKUe.jpg?s=128&g=1", "display_name": "WedaPashi", "link": "https://stackoverflow.com/users/4228131/wedapashi"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1577715026, "post_id": 59531514, "comment_id": 105233913, "body": "@AndrewHenle: Thanks, I didn&#39;t know that. I have used this mechanism to store a lot of status flags in the codes that I have been writing, and fortunately that has never been an issue so far. You are absolutely correct when you say that it platform-dependent (First thing I can think of is endienness). Can you suggest an alternate way which preferably wouldn&#39;t require mask operations?"}], "tags": [], "owner": {"reputation": 3002, "user_id": 4228131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RyKUe.jpg?s=128&g=1", "display_name": "WedaPashi", "link": "https://stackoverflow.com/users/4228131/wedapashi"}, "is_accepted": false, "score": 1, "last_activity_date": 1577716302, "last_edit_date": 1577716302, "creation_date": 1577711739, "answer_id": 59531514, "question_id": 59531192, "link": "https://stackoverflow.com/questions/59531192/using-bitwise-operations-on-char/59531514#59531514", "title": "Using bitwise operations on char", "body": "<p>As warned about in comments below, kindly note that the behavior of this code is not guaranteed to be consistent across all platforms.<br>\nThe suggested answers gets the work done. If you don't want to get into bit-shift operations try this:</p>\n\n<pre><code>typedef struct dist {\n    union {\n        struct {\n            uint8_t number_of_stars : 3 ;\n            uint8_t cancel_status : 1 ;\n            uint8_t ongoing_status :1 ;\n            uint8_t reserved : 3;\n        };\n\n        uint8_t status;\n\n    };\n\n} DishType;\n\nDishType Dish;\n</code></pre>\n\n<p>If you check the size of <code>Dish</code> you'll see that it still consumes one byte of memory. </p>\n\n<p>You can set the parameters in a single line such as:</p>\n\n<pre><code>Dish.status = 0x0C; // For example\n</code></pre>\n\n<p>Or you can set the particular parameter like:</p>\n\n<pre><code>Dish.cancel_status = 1;\nDish.ongoing_status = 0;\n</code></pre>\n\n<p>And yet, access or print or modify it individually:</p>\n\n<pre><code>printf(\"\\nNo. of starts = %u\", Dish.number_of_stars);\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 12619491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a2adb9a93683f1f13e05692b3e58e75?s=128&d=identicon&r=PG&f=1", "display_name": "OscarTheMighty", "link": "https://stackoverflow.com/users/12619491/oscarthemighty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 59531414, "answer_count": 3, "score": 0, "last_activity_date": 1577716302, "creation_date": 1577710391, "last_edit_date": 1577711937, "question_id": 59531192, "link": "https://stackoverflow.com/questions/59531192/using-bitwise-operations-on-char", "title": "Using bitwise operations on char", "body": "<p>So I need some help getting this right. I have an assignment like this:</p>\n\n<pre><code>typedef struct {\n    char status[1];\n} Dish;\n</code></pre>\n\n<p>The variable <code>status</code> must only have 1 byte: first 3 bits will contain the number of stars the dish has(0-5), 4th bit tells us if the dish is canceled or not and the 5th bit tells us if the dish is ongoing or not. I tried getting the number of stars like this but it doesn't work: </p>\n\n<pre><code>getBit(char data, int bitNumber) {\n return (data &amp; (1 &lt;&lt; bitNumber-1)) != 0;\n}\nint number = 0;\nnumber = getBit(dish.status,0);\nnumber = number &lt;&lt; 1 + getBit(dish.status,1);\nnumber = number &lt;&lt; 1 + getBit(dish.status,2);\n</code></pre>\n\n<p>Since <code>status</code> must only have 1 byte I declared it as above <code>char status[1]</code> is it correct?\nI also tried using binary operations directly on <code>status</code> but it gives me an error saying that I can't use binary operations between a <code>char</code> and an <code>int</code>. My final objective is getting every information in that byte into a separate variable: <code>stars</code>, <code>canceled</code>, <code>ongoing</code>.</p>\n"}, {"tags": ["c", "memory-management", "compiler-construction", "garbage-collection", "malloc"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1577709671, "post_id": 59530853, "comment_id": 105231527, "body": "Improve the algorithms and the need for memory allocation/freeing/etc."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1577709738, "post_id": 59530853, "comment_id": 105231547, "body": "I don&#39;t understand your questions. You are designing something and asking if using a particular library makes sense. It makes sense, if it suits you and your needs and your design goals. Using a garbage collector is not tied to writing an interpreter. An interpreter can be written without a garbage collector. So you discovered that using different implementations of something improve the &quot;performance&quot; of your application. That&#39;s great, use them, take the libraries and optimize the application for your specific use case."}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1577710353, "post_id": 59530853, "comment_id": 105231821, "body": "I&#39;m a bit confused that you could just switch between GC and malloc+free like that. Is your language garbage collected or not? If it is, how exactly did your GCless version of the interpreter work? I&#39;m assuming it didn&#39;t just leak memory since you mentioned freeing memory. If the language isn&#39;t GCed, then what were you using the GC for? I wouldn&#39;t imagine that a VM-based interpreter would create much garbage that doesn&#39;t belong to the interpreted language."}, {"owner": {"reputation": 6958, "user_id": 857727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3772f7ef99bd17c1e77d77edbf76c13d?s=128&d=identicon&r=PG&f=1", "display_name": "arnt", "link": "https://stackoverflow.com/users/857727/arnt"}, "edited": false, "score": 1, "creation_date": 1577715382, "post_id": 59530853, "comment_id": 105234076, "body": "GC makes sense in an interpreter. Ruby uses that, for example, and most lisps are interpreterish. You may find that malloc works well, or an arena/slab allocator. YMMV, basically. There&#39;s no single truth here."}], "answers": [{"comments": [{"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1577742663, "post_id": 59537161, "comment_id": 105244254, "body": "I suppose I found it: <a href=\"https://github.com/arturo-lang/arturo\" rel=\"nofollow noreferrer\">github.com/arturo-lang/arturo</a>"}, {"owner": {"reputation": 21415, "user_id": 1270812, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/LmoZ6.jpg?s=128&g=1", "display_name": "Dr.Kameleon", "link": "https://stackoverflow.com/users/1270812/dr-kameleon"}, "edited": false, "score": 0, "creation_date": 1577782758, "post_id": 59537161, "comment_id": 105252788, "body": "That&#39;s correct. Although the code in question is not yet public and - as you may guess - it&#39;s quite difficult to post any &quot;relevant&quot; source code from a 10k-line project. The programming language is expression-based (everything is an expression and returning a value) with lexical scoping, <i>not</i> object-oriented, and rather on the functional side of the spectrum (without insisting on Haskell&#39;s &quot;purity&quot;). Basically, think of it as a Rebol-influenced syntax, functional language with a touch of Ruby."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 1, "last_activity_date": 1577742287, "creation_date": 1577742287, "answer_id": 59537161, "question_id": 59530853, "link": "https://stackoverflow.com/questions/59530853/manual-vs-gc-memory-management-in-interpreter-using-malloc-free/59537161#59537161", "title": "Manual vs GC memory management in Interpreter &amp; using malloc/free", "body": "<p>Your question is very broad, probably on the verge of off topic on this site.</p>\n\n<p>There are different approaches to garbage collecting in an interpreted environment, but which technique fits your requirements best depends heavily on the semantics of your language. </p>\n\n<p>You insist on performance, but there is no absolute measure of performance: do you need very low latency, which would make classic mark and sweep gc inadequate, or do you want better average performance on long tasks? In this case, generating machine code and reducing memory allocation will improve performance much more than tweaking garbage collection methods.</p>\n\n<p>The most difficult task in garbage collection is to get it to work correctly in the first place. You could use reference counting for some simple objects such as strings and bignums and more advanced techniques for others that may have cycles.</p>\n\n<p>You can look at <a href=\"https://bellard.org/quickjs/\" rel=\"nofollow noreferrer\">QuickJS</a> which I co-authored with Fabrice Bellard for a hybrid approach with reference counting and cycle detection.</p>\n\n<p>Can you give a pointer to more details about your programming language?</p>\n"}], "owner": {"reputation": 21415, "user_id": 1270812, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/LmoZ6.jpg?s=128&g=1", "display_name": "Dr.Kameleon", "link": "https://stackoverflow.com/users/1270812/dr-kameleon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 1, "closed_date": 1577752278, "answer_count": 1, "score": 1, "last_activity_date": 1577742287, "creation_date": 1577708829, "last_edit_date": 1577709443, "question_id": 59530853, "link": "https://stackoverflow.com/questions/59530853/manual-vs-gc-memory-management-in-interpreter-using-malloc-free", "closed_reason": "Opinion-based", "title": "Manual vs GC memory management in Interpreter &amp; using malloc/free", "body": "<p>A newbie-sounding question from somebody with 25 years of coding experience.</p>\n\n<p>So, please, before you quickly answer, read on. :)</p>\n\n<hr>\n\n<p>I'm currently <strong>writing an interpreter</strong> (basically a Bytecode Stack VM one) for a programming language I have designed myself. The whole codebase is in C. (after 2-3 rewrites in different languages, ranging from D to Nim)</p>\n\n<ul>\n<li>why did I finally end up in C? because what matters to me the most is performance and having full control over everything</li>\n<li>why didn't I do it earlier? because I was afraid I would be lost in a sea of memory leaks</li>\n</ul>\n\n<hr>\n\n<p>Long story short, I'm trying to find out what the best approach would be, always having optimum performance as a goal.</p>\n\n<p>I have experimented with Boehm's GC. Basically, use <code>GC_malloc</code> (or <code>GC_malloc_atomic</code>) whenever I allocate memory and <code>GC_free</code> whenever I want to free it. </p>\n\n<p>This gave my interpreter a 10% speed boost in several benchmarks I'm running.</p>\n\n<p>And this confused me. </p>\n\n<p>Is it because Boehm's <code>GC_free</code> simply does nothing (until it actually does)? </p>\n\n<p>Now, I decided turning the GC off and doing it all manually. Every malloc with its free, and that's it. The memory consumption dropped (which I guess is explained by Boehm not previously free-ing anything). But the performance dropped as well.</p>\n\n<p>So, I decided to experiment with a... different malloc. In this case, <a href=\"https://github.com/mjansson/rpmalloc\" rel=\"nofollow noreferrer\">rpmalloc</a>. And the performance improved again.</p>\n\n<p>Am I missing sth?</p>\n\n<p><strong>And since you are probably confused about what the question is:</strong></p>\n\n<ul>\n<li>Does using a GC (like Boehm's) make any sense in an interpreter?</li>\n<li>Does experimenting with different <code>malloc</code>s make sense - in terms of improving a Bytecode intepreter's performance</li>\n<li>What are other things that you would recommend in my case? (memory-management optimization-wise and memory allocations)</li>\n</ul>\n"}, {"tags": ["c", "pointers", "malloc"], "comments": [{"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 5, "creation_date": 1577708220, "post_id": 59530628, "comment_id": 105230912, "body": "<code>tabPositives[i] = tabData[i];</code> There is a problem with the indices. You do not want to write to position <code>i</code> of <code>tabPositives</code>, that even may be out of bound."}], "answers": [{"tags": [], "owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "is_accepted": false, "score": 3, "last_activity_date": 1577708457, "creation_date": 1577708457, "answer_id": 59530764, "question_id": 59530628, "link": "https://stackoverflow.com/questions/59530628/problem-with-distributing-numbers-between-two-tables/59530764#59530764", "title": "Problem with distributing numbers between two tables", "body": "<p>The problem is that your <code>tabPositives</code> and <code>tabNegatives</code> arrays are not as large as your <code>tabData</code> array - so, when you assign values to the [i] elements of those arrays, you will (at some point) go out of bounds.</p>\n\n<p>You should keep separate indexes for each of those two arrays, like this:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>    int iPos = 0, iNeg = 0; // Current indexes for each pos/neg array\n    for (int i = 0; i &lt; numberData; i++){\n        if (tabData[i] &gt;= 0){\n            tabPositives[iPos++] = tabData[i]; // Use current \"pos\" index then increment\n        }else {\n            tabNegatives[iNeg++] = tabData[i]; // Use current \"neg\" index then increment\n        }\n    }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1132, "user_id": 10048703, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g4Etl.png?s=128&g=1", "display_name": "davidm", "link": "https://stackoverflow.com/users/10048703/davidm"}, "is_accepted": false, "score": 2, "last_activity_date": 1577743477, "last_edit_date": 1577743477, "creation_date": 1577708466, "answer_id": 59530766, "question_id": 59530628, "link": "https://stackoverflow.com/questions/59530628/problem-with-distributing-numbers-between-two-tables/59530766#59530766", "title": "Problem with distributing numbers between two tables", "body": "<p>This should do the work. You were so close, just correct the way you are inserting in the <code>tabPositives</code> and <code>tabNegatives</code>.</p>\n\n<pre><code>   #include &lt;stdlib.h&gt;\n   #include &lt;stdio.h&gt;\n\n   int main (int argc, char **argv) {\n\n       int numberData = 0;\n       int numberPositives = 0;\n       int numberNegatives = 0;\n       int number = 0;\n       int *tabData = NULL;\n       int *tabPositives = NULL;\n       int *tabNegatives = NULL;\n\n\n       printf(\"Enter size : \");\n       scanf(\"%d\", &amp;numberData);\n\n       tabData = malloc(numberData * sizeof(int));\n       for (int i = 0; i &lt; numberData; i++){\n           printf(\"Enter number: \");\n           scanf(\"%d\", &amp;number);\n           tabData[i] = number;\n           if (number &gt;= 0){\n               numberPositives++;\n           }else {\n               numberNegatives++;\n           }\n       }\n\n       //allocation\n       tabPositives = malloc(numberPositives * sizeof(int));\n       tabNegatives = malloc(numberNegatives * sizeof(int));\n\n       int iPos = 0;\n       int iNeg = 0;\n       for (int i = 0; i &lt; numberData; i++){\n           if (tabData[i] &gt;= 0){\n               tabPositives[iPos++] = tabData[i];\n           }else {\n               tabNegatives[iNeg++] = tabData[i];\n           }\n       }\n\n       printf(\"INPUT\\n\");\n       for (int i = 0; i &lt; numberData; i++){\n           printf(\"%d\\t\", tabData[i]);\n       }\n       printf(\"\\n\");\n       printf(\"OUTPUT\\n\");\n       for (int i = 0; i &lt; numberPositives; i++){\n           printf(\"%d\\t\", tabPositives[i]);\n       }\n       printf(\"\\n\");\n       for (int i = 0; i &lt; numberNegatives; i++){\n           printf(\"%d\\t\", tabNegatives[i]);\n       }\n       printf(\"\\n\");\n\n       free(tabData);\n       free(tabNegatives);\n       free(tabPositives);\n\n   }\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11913526"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1577743477, "creation_date": 1577707873, "last_edit_date": 1577741780, "question_id": 59530628, "link": "https://stackoverflow.com/questions/59530628/problem-with-distributing-numbers-between-two-tables", "title": "Problem with distributing numbers between two tables", "body": "<p>I want to separate my negative numbers from the positive numbers in two separate arrays. Problem, when I do it and print the results, the negative numbers transform into 0.</p>\n\n<p>Example of output:</p>\n\n<pre><code>INPUT\n423-5\nOUTPUT\n423\n0\n</code></pre>\n\n<p>The numbers are correct in my <code>tabData</code> array but not in my <code>tabNegatives</code> array.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nint main (int argc, char **argv) {\n    int numberData = 0;\n    int numberPositives = 0;\n    int numberNegatives = 0;\n    int number = 0;\n    int *tabData = NULL;\n    int *tabPositives = NULL;\n    int *tabNegatives = NULL;\n\n    printf(\"Enter size : \");\n    scanf(\"%d\", &amp;numberData);\n\n    tabData = malloc(numberData * sizeof(int));\n    for (int i = 0; i &lt; numberData; i++) {\n        printf(\"Enter number: \");\n        scanf(\"%d\", &amp;number);\n        tabData[i] = number;\n        if (number &gt;= 0) {\n            numberPositives++;\n        } else {\n            numberNegatives++;\n        }\n    }\n\n    //allocation\n    tabPositives = malloc(numberPositives * sizeof(int));\n    tabNegatives = malloc(numberNegatives * sizeof(int));\n\n    for (int i = 0; i &lt; numberData; i++) {\n        if (tabData[i] &gt;= 0) {\n            tabPositives[i] = tabData[i];\n        } else {\n            tabNegatives[i] = tabData[i];\n        }\n    }\n\n    printf(\"INPUT\\n\");\n    for (int i = 0; i &lt; numberData; i++) {\n        printf(\"%d\", tabData[i]);\n    }\n    printf(\"\\n\");\n    printf(\"OUTPUT\\n\");\n    for (int i = 0; i &lt; numberPositives; i++) {\n        printf(\"%d\", tabPositives[i]);\n    }\n    printf(\"\\n\");\n    for (int i = 0; i &lt; numberNegatives; i++) {\n        printf(\"%d\", tabNegatives[i]);\n    }\n    printf(\"\\n\");\n\n    free(tabData);\n    free(tabNegatives);\n    free(tabPositives);\n}\n</code></pre>\n"}, {"tags": ["c", "linked-list"], "comments": [{"owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "edited": false, "score": 5, "creation_date": 1577707637, "post_id": 59530529, "comment_id": 105230693, "body": "You are assigning a value to <code>current</code> with <code>current = current-&gt;next;</code> and then trying to dereference <code>current</code> two lines later with <code>if(current-&gt;next == NULL) {...</code> - but you don&#39;t check if the value you have assigned to <code>current</code> (i.e. the <i>previous</i> <code>current-&gt;next</code>) is <code>NULL</code>. If it is, you&#39;ll get <b><i>undefined behaviour</i></b>."}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 1, "creation_date": 1577707999, "post_id": 59530529, "comment_id": 105230826, "body": "Yeah, you need to check both whether current is NULL <i>and</i> whether next is NULL. Check <i>every</i> pointer before dereferencing unless you somehow know it can&#39;t possibly be NULL."}], "owner": {"reputation": 11, "user_id": 12624973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae89a372c7837835bbdd218f3fead481?s=128&d=identicon&r=PG&f=1", "display_name": "dennisdeluxe", "link": "https://stackoverflow.com/users/12624973/dennisdeluxe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1577707400, "creation_date": 1577707400, "question_id": 59530529, "link": "https://stackoverflow.com/questions/59530529/linked-list-in-c-accessing-current-next-is-neither-null-or-null-problem-with", "title": "Linked List in C: Accessing current-&gt;next is neither NULL or !NULL; problem with adding new nodes", "body": "<p>So I encounter this problem where when I add nodes to an empty head in a specific sequence it doesn't work.\nIf I insert 2,1,3,4 so the second number is smaller than the first number, then it works. But if I add 2,3,4,5, then it doesn't work. I get a Segmentation fault (core dumped).\nCan somebody tell me whats wrong here?</p>\n\n<p>This is my struct and adding-method:</p>\n\n<pre><code>struct list_node{\n    int value;\n    struct list_node* next;\n};\n\ntypedef struct list_node node_t;\n\nnode_t* add_element_sorted(node_t* head, int v){\n    node_t* current = head;\n    node_t* new = NULL;\n    new = (node_t *) malloc (sizeof(node_t));\n    if (new == NULL) {\n        printf(\"error\");\n        exit(1);\n    }\n    new-&gt;value = v;\n    printf(\"%d\\n\", new-&gt;value);\n\n    if (current != NULL){  //check if first node is empty\n        while(current-&gt;value &lt; v){\n            current = current-&gt;next;\n            printf(\"broke \\n\");\n            if(current-&gt;next == NULL){ // check if current node is the last then its next shoud be null\n                break;      \n            }\n        }\n    }\n\n    if (current == head) {\n        new-&gt;next = head;\n        return new;\n    } else {\n        new-&gt;next = current-&gt;next;\n        current-&gt;next = new;\n        return head;\n    }\n}\n</code></pre>\n\n<p>At this part it returns me current->next is neither NULL or !NULL. What is current->next now?</p>\n\n<pre><code>if(current-&gt;next == NULL){ // check if current node is the last then its next shoud be null\n    break;\n}\n</code></pre>\n\n<p>My main looks like this:</p>\n\n<pre><code>int main(){\n    node_t* head = NULL;\n    head = add_element_sorted(head, 2);\n    head = add_element_sorted(head, 3);\n    head = add_element_sorted(head, 4);\n    head = add_element_sorted(head, 5); \n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "ffmpeg", "libav"], "comments": [{"owner": {"reputation": 567, "user_id": 8620128, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c3Qyy.jpg?s=128&g=1", "display_name": "itzFlubby", "link": "https://stackoverflow.com/users/8620128/itzflubby"}, "edited": false, "score": 0, "creation_date": 1577706792, "post_id": 59530180, "comment_id": 105230340, "body": "Whats the length of the <code>streams</code> array? Is it probably <code>no_of_audio_streams</code>? Because if so <code>streams[i+1]</code> causes your segmentation fault, because in the last run of your loop, you are trying to access memory that isn&#39;t there!"}, {"owner": {"reputation": 1253, "user_id": 3596376, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aeldq.jpg?s=128&g=1", "display_name": "tom", "link": "https://stackoverflow.com/users/3596376/tom"}, "edited": false, "score": 0, "creation_date": 1577706813, "post_id": 59530180, "comment_id": 105230349, "body": "I don&#39;t think this is the answer you want, but Audacity is good for being able to record the audio when you play a video, but that may not be what you are looking for. If Audacity sorts you out it would be simpler than writing a new program...."}, {"owner": {"reputation": 136, "user_id": 9044006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0df6156070096ea25c13ea77351d3a20?s=128&d=identicon&r=PG&f=1", "display_name": "geo-freak", "link": "https://stackoverflow.com/users/9044006/geo-freak"}, "reply_to_user": {"reputation": 567, "user_id": 8620128, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c3Qyy.jpg?s=128&g=1", "display_name": "itzFlubby", "link": "https://stackoverflow.com/users/8620128/itzflubby"}, "edited": false, "score": 0, "creation_date": 1577707862, "post_id": 59530180, "comment_id": 105230773, "body": "@itzFlubby I already calculated the no.of audio streams available and moved the value to no_of_audio_streams."}, {"owner": {"reputation": 567, "user_id": 8620128, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c3Qyy.jpg?s=128&g=1", "display_name": "itzFlubby", "link": "https://stackoverflow.com/users/8620128/itzflubby"}, "edited": false, "score": 0, "creation_date": 1577708034, "post_id": 59530180, "comment_id": 105230837, "body": "@geo-freak Yes, that is clear, but what is the size of <code>streams</code> ? You must have defined its length somewhere by declaring it (<code>&lt;datatype&gt; streams[&lt;size&gt;]</code>)"}, {"owner": {"reputation": 136, "user_id": 9044006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0df6156070096ea25c13ea77351d3a20?s=128&d=identicon&r=PG&f=1", "display_name": "geo-freak", "link": "https://stackoverflow.com/users/9044006/geo-freak"}, "reply_to_user": {"reputation": 567, "user_id": 8620128, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c3Qyy.jpg?s=128&g=1", "display_name": "itzFlubby", "link": "https://stackoverflow.com/users/8620128/itzflubby"}, "edited": false, "score": 0, "creation_date": 1577780341, "post_id": 59530180, "comment_id": 105252043, "body": "@itzFlubby I didn&#39;t initialize the size and I never seen defining the size to a stream in libav."}, {"owner": {"reputation": 567, "user_id": 8620128, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c3Qyy.jpg?s=128&g=1", "display_name": "itzFlubby", "link": "https://stackoverflow.com/users/8620128/itzflubby"}, "edited": false, "score": 0, "creation_date": 1578081949, "post_id": 59530180, "comment_id": 105335780, "body": "Do you have debugging tools, which allow you to backtrace? With the help of those, you could find out. if the segfault occurs on calling<code>avformat_alloc_context()</code> or if it is just a buffer-overflow (this is what I suspect to be the case)! Coming back to my previous comments, you can find out the size of the array with the function <code>sizeof()</code>. Could you please look up the size as well?"}], "owner": {"reputation": 136, "user_id": 9044006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0df6156070096ea25c13ea77351d3a20?s=128&d=identicon&r=PG&f=1", "display_name": "geo-freak", "link": "https://stackoverflow.com/users/9044006/geo-freak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1577720940, "creation_date": 1577705722, "last_edit_date": 1577720940, "question_id": 59530180, "link": "https://stackoverflow.com/questions/59530180/how-to-extract-the-audio-streams-and-copy-to-another-context-in-c", "title": "How to extract the audio streams and copy to another context in c?", "body": "<p>I have a video file. It contains 1 video stream and 2 or more audio streams. I want to do some operation only on my audio streams. Is it possible to extract them and copy to another FormatContext structure?</p>\n\n<pre><code>AVFormatContext *afctx[no_of_audio_streams];\n    for(i=0; i&lt;no_of_audio_streams; i++){\n            afctx[i] = avformat_alloc_context();\n            afctx[i]-&gt;streams[0] = format_ctx-&gt;streams[i+1];\n    }\n</code></pre>\n\n<p>But I am getting segmentation fault.</p>\n\n<p>What is the proper way of copying, including the codec info and other relevant information?</p>\n\n<p>Any suggestions or advice would be helpful. Thanks.</p>\n"}, {"tags": ["c", "pointers", "types"], "answers": [{"tags": [], "owner": {"reputation": 1253, "user_id": 3596376, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aeldq.jpg?s=128&g=1", "display_name": "tom", "link": "https://stackoverflow.com/users/3596376/tom"}, "is_accepted": true, "score": 1, "last_activity_date": 1577706330, "last_edit_date": 1577706330, "creation_date": 1577706081, "answer_id": 59530263, "question_id": 59530102, "link": "https://stackoverflow.com/questions/59530102/warning-assignment-from-incompatible-pointer-type/59530263#59530263", "title": "Warning - assignment from incompatible pointer type", "body": "<p>The problem that you have is because the four arrays you define are <em>two dimensional</em>.</p>\n\n<p>That is why you have the error. </p>\n\n<pre><code>const char cards[][30] = {\"spades_one\", ...}\nchar is_it_used[][1] = {\"1\",...}\nchar player_1_deck[7][30], player_2_deck[7][30], player_1[1][20], player_2[1][20];\nchar *s1, *s2, *s3, *s4;\n\ns1 = &amp;cards[0][0]; \ns2 = &amp;is_it_used[0][0];\ns3 = &amp;player_1_deck[0][0];\ns4 = &amp;player_2_deck[0][0];\n</code></pre>\n\n<p>the above should work</p>\n\n<p>but it really depends what you want to achieve with <code>s1</code>, <code>s2</code> etc. </p>\n\n<p>it may be more appropriate to have </p>\n\n<pre><code>s1=player_1_deck[0];\n</code></pre>\n\n<p>for example or</p>\n\n<pre><code>s1=player_1_deck[2];\n</code></pre>\n\n<p>etc.</p>\n\n<p>so that <code>s1</code> points at an individual card</p>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 0, "last_activity_date": 1577706826, "creation_date": 1577706826, "answer_id": 59530408, "question_id": 59530102, "link": "https://stackoverflow.com/questions/59530102/warning-assignment-from-incompatible-pointer-type/59530408#59530408", "title": "Warning - assignment from incompatible pointer type", "body": "<p>In these assignment statements</p>\n\n<pre><code>s1 = &amp;cards[0];\ns2 = &amp;is_it_used[0];\ns3 = &amp;player_1_deck[0];\ns4 = &amp;player_2_deck[0];\n</code></pre>\n\n<p>the left operands have the type char * while the right operands have types correspondingly <code>char ( * )[30]</code>, <code>char ( * )[1]</code>, <code>char ( * )[30]</code>, <code>char ( * )[30]</code> and there is no implicit conversion from the type <code>char *</code> to the type of one of listed pointers.</p>\n\n<p>If you want that pointers s1, s4 point to the first characters of the first strings of the multi-dimensional arrays you can just write</p>\n\n<pre><code>s1 = cards[0];\ns2 = is_it_used[0];\ns3 = player_1_deck[0];\ns4 = player_2_deck[0];\n</code></pre>\n\n<p>Pay attention to that this array</p>\n\n<pre><code>char is_it_used[][1] = {\"1\",...};\n</code></pre>\n\n<p>does not contain strings. In fact this declaration is equivalent to</p>\n\n<pre><code>char is_it_used[][1] = { '1',...};\n                         ^^^\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 12624912, "user_type": "registered", "profile_image": "https://graph.facebook.com/576972536418335/picture?type=large", "display_name": "Su Ba\u015farslan", "link": "https://stackoverflow.com/users/12624912/su-ba%c5%9farslan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 59530263, "answer_count": 2, "score": 1, "last_activity_date": 1577707666, "creation_date": 1577705450, "last_edit_date": 1577707666, "question_id": 59530102, "link": "https://stackoverflow.com/questions/59530102/warning-assignment-from-incompatible-pointer-type", "title": "Warning - assignment from incompatible pointer type", "body": "<p>First of all im sorry if you're trying hard to understand me. My English is not that well.\nI'm studying Computer Engineering and this is my first year. I'm learning about C programming. \nI want to write a code for a card game but i can't fix this problem that im having with the pointers.</p>\n\n<pre><code>\n    const char cards[][30] = {\"spades_one\", ...};\n    char is_it_used[][1] = {\"1\",...};\n    char player_1_deck[7][30], player_2_deck[7][30], player_1[1][20], player_2[1][20];\n    char *s1, *s2, *s3, *s4;\n\ns1 = &amp;cards[0];\ns2 = &amp;is_it_used[0];\ns3 = &amp;player_1_deck[0];\ns4 = &amp;player_2_deck[0];\n\n</code></pre>\n\n<p>I'm getting the \"assignment from incompatible pointer type\" warning because of the s1, s2, s3 and s4. What should i do? How can i fix this problem? Please help me...</p>\n"}, {"tags": ["c", "memory", "struct"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1577703740, "post_id": 59529699, "comment_id": 105229085, "body": "I believe you don&#39;t understand, that <code>long int</code> is big endian in itself. So aliasing the struct with <code>long int</code> will print memory content in reverse order. Where does the text <code>Printing only a member</code> come from? Could you edit your question and clear the program output, put it inside code formatting?"}, {"owner": {"reputation": 111, "user_id": 1194195, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/761dfd16549110b6fc1ffb153bade918?s=128&d=identicon&r=PG", "display_name": "tss", "link": "https://stackoverflow.com/users/1194195/tss"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1577704697, "post_id": 59529699, "comment_id": 105229454, "body": "The machine is a big endian machine. Can you please elaborate on what &quot;long int is big endian in itself&quot; mean?"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1577705034, "post_id": 59529699, "comment_id": 105229565, "body": "Doing <code>*(long int*)memory</code> will access the memory in the way <code>long int</code> accesses memory - in big endian. To print bytes, alias the memory with <code>char</code> and iterate over bytes."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1577705273, "post_id": 59529699, "comment_id": 105229670, "body": "Note that <code>long int *tmp = (long int *)(&amp;mem.a);</code> and getting a <code>long int</code> value via <code>*tmp</code> is a <a href=\"https://stackoverflow.com/questions/98650/what-is-the-strict-aliasing-rule\">strict-aliasing violation</a> and can also result in undefined behavior and program failure should the resulting address not be properly aligned."}, {"owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "edited": false, "score": 0, "creation_date": 1577707408, "post_id": 59529699, "comment_id": 105230602, "body": "Why are you sure that your machine is big endian? I don&#39;t think so. I tried your code on a little endian machine and it gives the same output, as I expected."}, {"owner": {"reputation": 1419, "user_id": 488095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ro1E0.jpg?s=128&g=1", "display_name": "jamieguinan", "link": "https://stackoverflow.com/users/488095/jamieguinan"}, "reply_to_user": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "edited": false, "score": 0, "creation_date": 1577709560, "post_id": 59529699, "comment_id": 105231479, "body": "@thebusybee is right, it looks like you are running on a little-endian system."}], "owner": {"reputation": 111, "user_id": 1194195, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/761dfd16549110b6fc1ffb153bade918?s=128&d=identicon&r=PG", "display_name": "tss", "link": "https://stackoverflow.com/users/1194195/tss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1577710262, "creation_date": 1577703599, "last_edit_date": 1577710262, "question_id": 59529699, "link": "https://stackoverflow.com/questions/59529699/raw-output-of-a-struct", "title": "Raw output of a struct", "body": "<p>I have a simple C program of below type</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nstruct test{\nchar a;\nchar b;\nchar c;\nchar d;\nint e;\n};\n\nvoid main() {\n    struct test mem = {0xa, 0xb, 0xc, 0xd, 0xef12};\n    long int *tmp = (long int *)(&amp;mem.a);\n    printf(\"Struct in binary %p : 0x%lx\\n\", &amp;mem.a, *tmp);\n    printf(\"Printing only a member %p : 0x%x\\n\", &amp;(mem.e), *(int *)(&amp;(mem.e)));\n\n}\n</code></pre>\n\n<p>The output of above program is as below on a Big endian machine :</p>\n\n<p>Struct in binary 0x7ffc1206abc0 : 0xef120d0c0b0a</p>\n\n<p>Printing only a member 0x7ffc1206abc4 : 0xef12</p>\n\n<p>The question is that why is the raw output of the struct in the reverse order of its members' values?</p>\n\n<p>The address of 'member e' is still 4 bytes from the start of the struct base address..!</p>\n"}, {"tags": ["c", "string", "split", "char", "strtok"], "comments": [{"owner": {"reputation": 151, "user_id": 5895811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bed50a2eb82fc748c4b0062e517eec5?s=128&d=identicon&r=PG&f=1", "display_name": "TZof", "link": "https://stackoverflow.com/users/5895811/tzof"}, "edited": false, "score": 0, "creation_date": 1577703320, "post_id": 59529604, "comment_id": 105228911, "body": "why you don&#39;t split by &#39;/&#39;"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 2, "creation_date": 1577703345, "post_id": 59529604, "comment_id": 105228924, "body": "Locate the last <code>&#47;</code> in the string and insert a zero there, no need for strtok. You can use <code>strrchr</code> to search for the last <code>&#47;</code> character."}, {"owner": {"reputation": 29, "user_id": 12260088, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-R6_zYZzmnSw/AAAAAAAAAAI/AAAAAAAAE4Y/P3Su1AwwwPA/photo.jpg?sz=128", "display_name": "Ozan Mudul", "link": "https://stackoverflow.com/users/12260088/ozan-mudul"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1577704226, "post_id": 59529604, "comment_id": 105229272, "body": "@KamilCuk thanks you have been really helpful I remember you from the other post :D"}], "answers": [{"comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1577703903, "post_id": 59529737, "comment_id": 105229142, "body": "This is not C++ question, it&#39;s C. And <a href=\"https://stackoverflow.com/Questions/31816095/Why-Should-I-Not-Include-Bits-Stdc-H.\">you shouldn&#39;t include bits/stdc++.h</a>"}, {"owner": {"reputation": 1990, "user_id": 12326421, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JbJl27mnzzQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reae_Gn8hEX-jZUqSenBmr_v-zCaw/photo.jpg?sz=128", "display_name": "Himanshu Singh", "link": "https://stackoverflow.com/users/12326421/himanshu-singh"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1577704051, "post_id": 59529737, "comment_id": 105229205, "body": "@KamilCuk you are right but it doesn&#39;t effect the main context of the answer. But anyways i&#39;ll remove it. Thanks."}], "tags": [], "owner": {"reputation": 1990, "user_id": 12326421, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JbJl27mnzzQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reae_Gn8hEX-jZUqSenBmr_v-zCaw/photo.jpg?sz=128", "display_name": "Himanshu Singh", "link": "https://stackoverflow.com/users/12326421/himanshu-singh"}, "is_accepted": true, "score": -1, "last_activity_date": 1577704062, "last_edit_date": 1577704062, "creation_date": 1577703781, "answer_id": 59529737, "question_id": 59529604, "link": "https://stackoverflow.com/questions/59529604/how-to-delete-last-part-of-string-in-c/59529737#59529737", "title": "How to delete last part of string in C", "body": "<p>Find the last occurance of <code>/</code> using <code>strrchr()</code> and then replace it with <code>\\0</code>. </p>\n\n<pre><code>int main()\n{\n    char string[] = \"folder1/folder2/folder3/folder4\";\n    char character = '/'; \n    char* ptr = strrchr(string, character);\n    *ptr = '\\0';\n    cout&lt;&lt;string;\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 12260088, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-R6_zYZzmnSw/AAAAAAAAAAI/AAAAAAAAE4Y/P3Su1AwwwPA/photo.jpg?sz=128", "display_name": "Ozan Mudul", "link": "https://stackoverflow.com/users/12260088/ozan-mudul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 59529737, "answer_count": 1, "score": -4, "last_activity_date": 1577704062, "creation_date": 1577703170, "question_id": 59529604, "link": "https://stackoverflow.com/questions/59529604/how-to-delete-last-part-of-string-in-c", "title": "How to delete last part of string in C", "body": "<p>I need a certain part of the string for example I have</p>\n\n<p><code>folder1/folder2/folder3/folder4</code></p>\n\n<p>and I don't want <code>folder4</code> in my new string so it should be like\n<code>folder1/folder2/folder3</code> </p>\n\n<p>any help would be appreciated I searched for strtok and strchar but I couldn't figure out how to achieve this </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 655, "user_id": 3616601, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d9dbe1da7416f8fa9b0cf1d0974269e7?s=128&d=identicon&r=PG&f=1", "display_name": "Phantom", "link": "https://stackoverflow.com/users/3616601/phantom"}, "edited": false, "score": 0, "creation_date": 1577701248, "post_id": 59529125, "comment_id": 105228087, "body": "Did you tried to debug your code with a debuger, or at least with <code>printf</code>? For the size of your array, you should <code>floor</code> the result of you division"}, {"owner": {"reputation": 284, "user_id": 12571460, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCfdmLEtpNndCH3GzEC7Pps5wv1KvzZiwCtjEHs=k-s128", "display_name": "Lxer Lx", "link": "https://stackoverflow.com/users/12571460/lxer-lx"}, "edited": false, "score": 4, "creation_date": 1577701388, "post_id": 59529125, "comment_id": 105228135, "body": "The expression <code>*sizeRange++</code> increments the pointer, not the object it points to. Change it to <code>(*sizeRange)++</code>"}], "answers": [{"tags": [], "owner": {"reputation": 30745, "user_id": 182675, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IO04V.jpg?s=128&g=1", "display_name": "ndim", "link": "https://stackoverflow.com/users/182675/ndim"}, "is_accepted": true, "score": 2, "last_activity_date": 1577701638, "creation_date": 1577701638, "answer_id": 59529279, "question_id": 59529125, "link": "https://stackoverflow.com/questions/59529125/return-array-of-numbers-in-range/59529279#59529279", "title": "return array of numbers in range", "body": "<p>Operator precedence is biting you here with the <code>*</code> and <code>++</code> operators. <code>*sizeRange++</code> means \"get value pointed to, then increase the pointer\". You want <code>(*sizeRange)++</code> instead. Or use a local variable for counting, and store its value at the end of the function.</p>\n"}, {"tags": [], "owner": {"reputation": 61700, "user_id": 5291015, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZFijZ.jpg?s=128&g=1", "display_name": "Inian", "link": "https://stackoverflow.com/users/5291015/inian"}, "is_accepted": false, "score": 1, "last_activity_date": 1577703734, "last_edit_date": 1577703734, "creation_date": 1577701654, "answer_id": 59529284, "question_id": 59529125, "link": "https://stackoverflow.com/questions/59529125/return-array-of-numbers-in-range/59529284#59529284", "title": "return array of numbers in range", "body": "<p>Operator precedence between <code>*</code> and <code>++</code> plays a key role in your case. When you actually intended to do a increment of a value at the address, your OP has just incremented the address itself. Leading to multiple address increments than the one originally contained in <code>sizeRange</code>. At this point your code went into territory of undefined behavior for accessing a violated address and eventually throwing a fault.</p>\n\n<p>Change your increment to <code>(*sizeRange)++</code> to make the size variable increment happening as expected. Or perhaps you can make things simpler, by allocating the array in the <code>main()</code> and use the function to just fill the elements of the array</p>\n\n<pre><code>int CreateRange(int start, int end, int jump, int* range) {\n    int sizeRange = 0;\n    int iter = start;\n    while (iter &lt;= end) {\n        range[sizeRange++] = iter;\n        iter += jump;\n    }\n    return sizeRange;\n}\n</code></pre>\n\n<p>and back in the main, iterate the <code>range</code> for the count of <code>sizeRange</code> to access the elements.</p>\n"}, {"tags": [], "owner": {"reputation": 5024, "user_id": 4439794, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/ogyE1.png?s=128&g=1", "display_name": "Trevor", "link": "https://stackoverflow.com/users/4439794/trevor"}, "is_accepted": false, "score": 1, "last_activity_date": 1577701706, "creation_date": 1577701706, "answer_id": 59529293, "question_id": 59529125, "link": "https://stackoverflow.com/questions/59529125/return-array-of-numbers-in-range/59529293#59529293", "title": "return array of numbers in range", "body": "<p>Precedence of postfix ++ is higher than  *, so you increase the pointer first before dereference and you got undefined predictable value of <code>*sizeRange++</code> when you pass to the array. </p>\n"}], "owner": {"reputation": 791, "user_id": 9105207, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BiyPF.png?s=128&g=1", "display_name": "Tal Rofe", "link": "https://stackoverflow.com/users/9105207/tal-rofe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 59529279, "answer_count": 3, "score": 1, "last_activity_date": 1577703734, "creation_date": 1577700884, "question_id": 59529125, "link": "https://stackoverflow.com/questions/59529125/return-array-of-numbers-in-range", "title": "return array of numbers in range", "body": "<p>Given <code>int start</code>, <code>int end</code>, <code>int jump</code> I need to return an array containing numbers in the range <code>start--&gt;end</code> with <code>jump</code>. For example, for <code>start=3, end=9, jump=2</code> I would return <code>{3,5,7,9}</code>. With <code>jump=3</code> I would return <code>{3,6,9}</code>. With <code>jump=4</code> I would return <code>{3,7}</code>.</p>\n\n<p>This is my code: (<code>sizeRange</code> holds the length of the returned array)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint* CreateRange(int start, int end, int jump, int* sizeRange) {\n    *sizeRange = 0;\n    int* array = malloc(((end-start)/jump + 1) * sizeof(int));\n    int iter = start;\n    while (iter &lt;= end) {\n        array[*sizeRange++] = iter;\n        iter += jump;\n    }\n    return array;\n}\n</code></pre>\n\n<p>But I get an ERROR : <code>Segmentation fault (core dumped)</code></p>\n"}, {"tags": ["c++", "c", "bit-manipulation"], "comments": [{"owner": {"reputation": 4718, "user_id": 750458, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/kdm9t.png?s=128&g=1", "display_name": "vikky", "link": "https://stackoverflow.com/users/750458/vikky"}, "reply_to_user": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 0, "creation_date": 1577698898, "post_id": 59528621, "comment_id": 105227134, "body": "here tag is just name of variable"}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1577699107, "post_id": 59528621, "comment_id": 105227212, "body": "Can you explain the premise for your claim that the &quot;length of tag is 4&quot; in your first piece of code?"}, {"owner": {"reputation": 1073, "user_id": 10794806, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GKvpJsipy5o/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hXsT0KoMOXyLso6Ie2mfwllaD7zQ/mo/photo.jpg?sz=128", "display_name": "Gaurav Dhiman", "link": "https://stackoverflow.com/users/10794806/gaurav-dhiman"}, "edited": false, "score": 1, "creation_date": 1577700003, "post_id": 59528621, "comment_id": 105227576, "body": "@vikky its not clear what code is supposed to do. do you want to interpret string as hex and convert to integer? then your question is already answered or do you want to pack Hex string such that each <code>unsigned char</code> holds 2 hex digits?"}, {"owner": {"reputation": 4718, "user_id": 750458, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/kdm9t.png?s=128&g=1", "display_name": "vikky", "link": "https://stackoverflow.com/users/750458/vikky"}, "reply_to_user": {"reputation": 1073, "user_id": 10794806, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GKvpJsipy5o/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hXsT0KoMOXyLso6Ie2mfwllaD7zQ/mo/photo.jpg?sz=128", "display_name": "Gaurav Dhiman", "link": "https://stackoverflow.com/users/10794806/gaurav-dhiman"}, "edited": false, "score": 1, "creation_date": 1577700163, "post_id": 59528621, "comment_id": 105227642, "body": "@GauravDhiman yes I want to pack Hex string such that each unsigned char holds 2 hex digits. That is why apply bitwise operator"}, {"owner": {"reputation": 1073, "user_id": 10794806, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GKvpJsipy5o/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hXsT0KoMOXyLso6Ie2mfwllaD7zQ/mo/photo.jpg?sz=128", "display_name": "Gaurav Dhiman", "link": "https://stackoverflow.com/users/10794806/gaurav-dhiman"}, "edited": false, "score": 0, "creation_date": 1577700700, "post_id": 59528621, "comment_id": 105227855, "body": "@vikky Well each <code>char</code> has ASCII value and for numbers and lower case letters (hex) its between 48-57 and 97-102, so unless you check it and subtract it from <code>char</code> you can&#39;t pack 2 raw ASCII values in 1 char"}, {"owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 0, "creation_date": 1577700804, "post_id": 59528621, "comment_id": 105227890, "body": "So, you have as input a string with eight characters and as output a 32-bit unsigned integer? This thing is called parsing and you&#39;ll find lots of info on that topic easily. If you want to roll your own and have problems, you need to extract and provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, as usual."}, {"owner": {"reputation": 284, "user_id": 12571460, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCfdmLEtpNndCH3GzEC7Pps5wv1KvzZiwCtjEHs=k-s128", "display_name": "Lxer Lx", "link": "https://stackoverflow.com/users/12571460/lxer-lx"}, "edited": false, "score": 2, "creation_date": 1577701047, "post_id": 59528621, "comment_id": 105227990, "body": "The expression <code>(tag[index] &amp; 0x0F) | (tag[++index]&gt;&gt;4 &amp; 0xF0)</code> results in undefined behaviour in C."}, {"owner": {"reputation": 31255, "user_id": 28494, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/c14ME.gif?s=128&g=1", "display_name": "qrdl", "link": "https://stackoverflow.com/users/28494/qrdl"}, "edited": false, "score": 0, "creation_date": 1577702874, "post_id": 59528621, "comment_id": 105228726, "body": "Take a look at <code>strtol()</code>"}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1577714126, "post_id": 59528621, "comment_id": 105233526, "body": "Please don&#39;t edit questions in ways that invalidate existing answers."}], "answers": [{"comments": [{"owner": {"reputation": 1726, "user_id": 1414496, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c75b36035fb412c9f2629a888bfb977e?s=128&d=identicon&r=PG", "display_name": "Joel Bodenmann", "link": "https://stackoverflow.com/users/1414496/joel-bodenmann"}, "reply_to_user": {"reputation": 20722, "user_id": 1625187, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6vWOZ.jpg?s=128&g=1", "display_name": "Evg", "link": "https://stackoverflow.com/users/1625187/evg"}, "edited": false, "score": 1, "creation_date": 1577699697, "post_id": 59528757, "comment_id": 105227448, "body": "You&#39;re right, I&#39;ve updated the post."}], "tags": [], "owner": {"reputation": 1726, "user_id": 1414496, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c75b36035fb412c9f2629a888bfb977e?s=128&d=identicon&r=PG", "display_name": "Joel Bodenmann", "link": "https://stackoverflow.com/users/1414496/joel-bodenmann"}, "is_accepted": false, "score": 0, "last_activity_date": 1577699639, "last_edit_date": 1577699639, "creation_date": 1577699345, "answer_id": 59528757, "question_id": 59528621, "link": "https://stackoverflow.com/questions/59528621/make-in-hex-from-unsigned-char/59528757#59528757", "title": "make in hex from unsigned char", "body": "<p>From your question I am not exactly sure whether you try to convert to or from a string. However, if you have C++11 available, you can use <a href=\"https://en.cppreference.com/w/cpp/string/basic_string/stol\" rel=\"nofollow noreferrer\"><code>std::stoi()</code></a> and <a href=\"https://en.cppreference.com/w/cpp/string/basic_string/to_string\" rel=\"nofollow noreferrer\"><code>std::to_string()</code></a> for easy conversion:</p>\n\n<pre><code>int hex_value = std::stoi(tag, nullptr, 16)\n</code></pre>\n\n<p>Note how the third argument of <code>std::stoi()</code> denominates the base (in this case 16 for hexadecimal).</p>\n"}, {"comments": [{"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1577701372, "post_id": 59529076, "comment_id": 105228131, "body": "@vikky Answer updated as first version had a number of bugs...."}], "tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": true, "score": 3, "last_activity_date": 1577701289, "last_edit_date": 1577701289, "creation_date": 1577700652, "answer_id": 59529076, "question_id": 59528621, "link": "https://stackoverflow.com/questions/59528621/make-in-hex-from-unsigned-char/59529076#59529076", "title": "make in hex from unsigned char", "body": "<p>You can't just copy ascii characters as hex values. You need to convert them.</p>\n\n<p>Something like:</p>\n\n<pre><code>unsigned char convert(unsigned char ch)\n{\n    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9')\n    {\n        return ch -'0';\n    }\n\n    if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'f')\n    {\n        return ch -'a' + 10;\n    }\n\n    if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'F')\n    {\n        return ch -'A' + 10;\n    }\n\n    return 0; // or some error handling\n}\n</code></pre>\n\n<p>and use it like:</p>\n\n<pre><code>for(index = 0 ; index &lt; 8; index = index + 2)\n{   \n    buffer[j] = convert(tag[index]) &lt;&lt; 4;\n    buffer[j] += convert(tag[index+1]);\n\n    printf(\"%02X\", buffer[j]);\n    j++;\n}\n</code></pre>\n\n<p>See it online here: <a href=\"https://ideone.com/e2FPCT\" rel=\"nofollow noreferrer\">https://ideone.com/e2FPCT</a></p>\n"}], "owner": {"reputation": 4718, "user_id": 750458, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/kdm9t.png?s=128&g=1", "display_name": "vikky", "link": "https://stackoverflow.com/users/750458/vikky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 1, "closed_date": 1577706019, "accepted_answer_id": 59529076, "answer_count": 2, "score": -2, "last_activity_date": 1577714108, "creation_date": 1577698733, "last_edit_date": 1577714108, "question_id": 59528621, "link": "https://stackoverflow.com/questions/59528621/make-in-hex-from-unsigned-char", "closed_reason": "Not suitable for this site", "title": "make in hex from unsigned char", "body": "<p>Suppose I have a piece of code like</p>\n\n<pre><code>unsigned char *tag = NULL;\ntag = (unsigned char *)malloc(8);\nmemset(tag, 0, 8);\nmemcpy(tag, (const char *)\"50C59390\",8);\n</code></pre>\n\n<p>I have to send it as length 4. So I am trying to convert it in 4 byte hex like 0x50C59390.</p>\n\n<pre><code>unsigned char * buffer = (unsigned char *)calloc(4, sizeof(char));\nint index,j = 0;\nfor(index = 0 ; index &lt; 8; index++)\n{        \n    buffer[j] = (tag[index] &amp; 0x0F) | (tag[++index]&gt;&gt;4 &amp; 0xF0);\n    printf(\"%02X\", buffer[j]);\n    j++;\n}\n</code></pre>\n\n<p>I am trying above code. but its not working as required.</p>\n"}, {"tags": ["c", "algorithm", "sorting", "mergesort", "array-merge"], "comments": [{"owner": {"reputation": 12915, "user_id": 11717458, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-n7Wjy36oQKw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reELdECHaKA7ESrLE7eYyYbMnpDxQ/photo.jpg?sz=128", "display_name": "SuleymanSah", "link": "https://stackoverflow.com/users/11717458/suleymansah"}, "edited": false, "score": 3, "creation_date": 1577698977, "post_id": 59528554, "comment_id": 105227157, "body": "You need to explicitly describe the problem. Is it not sorting correctly? Is it giving an error?"}, {"owner": {"reputation": 37, "user_id": 12612306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b575c4c176f0814c729fe40fdb7d212?s=128&d=identicon&r=PG&f=1", "display_name": "Mikel", "link": "https://stackoverflow.com/users/12612306/mikel"}, "reply_to_user": {"reputation": 12915, "user_id": 11717458, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-n7Wjy36oQKw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reELdECHaKA7ESrLE7eYyYbMnpDxQ/photo.jpg?sz=128", "display_name": "SuleymanSah", "link": "https://stackoverflow.com/users/11717458/suleymansah"}, "edited": false, "score": 0, "creation_date": 1577700823, "post_id": 59528554, "comment_id": 105227899, "body": "The bubble sort isn&#39;t working."}, {"owner": {"reputation": 284, "user_id": 12571460, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCfdmLEtpNndCH3GzEC7Pps5wv1KvzZiwCtjEHs=k-s128", "display_name": "Lxer Lx", "link": "https://stackoverflow.com/users/12571460/lxer-lx"}, "edited": false, "score": 1, "creation_date": 1577703456, "post_id": 59528554, "comment_id": 105228977, "body": "The indentation and level of nesting makes your code illegible. The function definition of <code>bubblesort</code> looks correct to me, though inefficient. But the calls <code>bubblesort(arr_sort[i],m);</code> and <code>bubblesort(arr_sort[j],m);</code> are blatantly wrong. And <code>void main()</code> is not portable."}, {"owner": {"reputation": 37, "user_id": 12612306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b575c4c176f0814c729fe40fdb7d212?s=128&d=identicon&r=PG&f=1", "display_name": "Mikel", "link": "https://stackoverflow.com/users/12612306/mikel"}, "reply_to_user": {"reputation": 284, "user_id": 12571460, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCfdmLEtpNndCH3GzEC7Pps5wv1KvzZiwCtjEHs=k-s128", "display_name": "Lxer Lx", "link": "https://stackoverflow.com/users/12571460/lxer-lx"}, "edited": false, "score": 0, "creation_date": 1577704146, "post_id": 59528554, "comment_id": 105229240, "body": "@lxer would be nice if you could help me fixing it"}, {"owner": {"reputation": 284, "user_id": 12571460, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCfdmLEtpNndCH3GzEC7Pps5wv1KvzZiwCtjEHs=k-s128", "display_name": "Lxer Lx", "link": "https://stackoverflow.com/users/12571460/lxer-lx"}, "edited": false, "score": 0, "creation_date": 1577705631, "post_id": 59528554, "comment_id": 105229798, "body": "First, make sure that the <code>merge_sort</code> function runs correctly without falling back to bubble sort. Then check the number of elements to be sorted upon entry to the  <code>merge_sort</code> function. If that number is less than a cut off value, then call bubble sort function and return. Continue otherwise."}], "answers": [{"tags": [], "owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "is_accepted": true, "score": 1, "last_activity_date": 1577708906, "creation_date": 1577708906, "answer_id": 59530869, "question_id": 59528554, "link": "https://stackoverflow.com/questions/59528554/error-in-implementing-bubble-sorting-in-a-merge-sort-program-in-c/59530869#59530869", "title": "Error in implementing bubble sorting in a merge sort program in C", "body": "<p>Among the issues in your code:</p>\n\n<ol>\n<li><p>From <code>merge_sort</code>, you should be calling <code>bubble_sort</code> for a given <em>floor</em> magnitude, hard-fixed in your <code>merge_sort</code>, specified globally, or as an argument to your functions. The former of these is easiest to achieve.</p></li>\n<li><p>Your <code>bubble_sort</code> invocation from <code>merge_sort</code> is wrong from inception, as you're passing <code>int</code> values where <code>int*</code> should be present.</p></li>\n<li><p>Your functions should <em>all</em> take the array to sort as an argument, and <em>at least</em> the length as well. This makes the functions more robust, and thanks to pointer arithmetic, easier to implement than you may think.</p></li>\n</ol>\n\n<p>Fixing this requires major surgery. </p>\n\n<p><strong>Updated <code>merge_array</code></strong></p>\n\n<p>First some surgery for the <code>merge_array</code> function. This assumes you support variable length arrays (VLAs). Notice the function accepts the array base address, the mid point, and the overall length. </p>\n\n<pre><code>void merge_array(int a[], int mid, int len)\n{\n    // change to int tmp[arrsize], or use dynamic allocation, if your\n    // platform doesn't support VLAs\n    int tmp[len];\n\n    int i = 0, j = mid, k = 0;\n    while (i &lt; mid &amp;&amp; j &lt; len)\n        tmp[k++] = ((a[i] &lt; a[j]) ? a[i++] : a[j++]);\n\n    while (i &lt; mid)\n        tmp[k++] = a[i++];\n\n    for (i = 0; i &lt; k; ++i)\n        a[i] = tmp[i];\n}\n</code></pre>\n\n<p><strong>Updated <code>merge_sort</code></strong></p>\n\n<p>Now the <code>merge_sort</code> function as described in the problem analysis. Like the above, it should take an array base address and a length, but that's all it needs. Pointer arithmetic will let us partition on recursed calls.</p>\n\n<pre><code>void merge_sort(int a[], int len)\n{\n    if (len &lt; 5)\n    {\n        // bubblesort short partitions (less than length:5)\n        bubble_sort(a, len);\n    }\n    else\n    {\n        int mid = len / 2;\n        merge_sort(a, mid);\n        merge_sort(a + mid, len - mid); // note pointer arithmetic here\n        merge_array(a, mid, len);\n    }\n}\n</code></pre>\n\n<p><strong>Updated <code>bubble_sort</code></strong></p>\n\n<p>This simple bubble sort uses forward swap detection to leave early on already-sorted detection. Like the prior functions, we have the base address of some array and a specified length.</p>\n\n<pre><code>void bubble_sort(int a[], int size)\n{\n    int swapped = 1;\n    while (swapped &amp;&amp; size-- &gt; 0)\n    {\n        swapped = 0;\n        for (int i = 0; i &lt; size; ++i)\n        {\n            if (a[i + 1] &lt; a[i])\n            {\n                int tmp = a[i];\n                a[i] = a[i + 1];\n                a[i + 1] = tmp;\n                swapped = 1;\n            }\n        }\n    }\n}\n</code></pre>\n\n<hr>\n\n<p><strong>Putting It All Together</strong></p>\n\n<p>Below is the complete program, which includes a print helper to dump an array to the console, and a random-generator to avoid lengthy keyboard input. The provided <code>main()</code> creates a random-filled array, prints it, sorts it, then prints the result. Obviously the output will vary with each run, but you hopefully get the idea of how the above functions are called.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n\n#define arrsize 40\n\nvoid merge_sort(int a[], int len);\nvoid merge_array(int a[], int mid, int len);\nvoid bubble_sort(int a[], int size);\n\nvoid merge_array(int a[], int mid, int len)\n{\n    // change to int tmp[arrsize], or use dynamic allocation, if your\n    // platform doesn't support VLAs\n    int tmp[len];\n\n    int i = 0, j = mid, k = 0;\n    while (i &lt; mid &amp;&amp; j &lt; len)\n        tmp[k++] = ((a[i] &lt; a[j]) ? a[i++] : a[j++]);\n\n    while (i &lt; mid)\n        tmp[k++] = a[i++];\n\n    for (i = 0; i &lt; k; ++i)\n        a[i] = tmp[i];\n}\n\nvoid merge_sort(int a[], int len)\n{\n    if (len &lt; 5)\n    {\n        // bubblesort short partitions (less than length:5)\n        bubble_sort(a, len);\n    }\n    else\n    {\n        int mid = len / 2;\n        merge_sort(a, mid);\n        merge_sort(a + mid, len - mid); // note pointer arithmetic here\n        merge_array(a, mid, len);\n    }\n}\n\nvoid bubble_sort(int a[], int size)\n{\n    int swapped = 1;\n    while (swapped &amp;&amp; size-- &gt; 0)\n    {\n        swapped = 0;\n        for (int i = 0; i &lt; size; ++i)\n        {\n            if (a[i + 1] &lt; a[i])\n            {\n                int tmp = a[i];\n                a[i] = a[i + 1];\n                a[i + 1] = tmp;\n                swapped = 1;\n            }\n        }\n    }\n}\n\nvoid print_arr(int const arr[], int len)\n{\n    while (len-- &gt; 0)\n        printf(\"%d \", *arr++);\n    fputc('\\n', stdout);\n}\n\nint main()\n{\n    srand((unsigned)time(NULL));\n\n    int arr_sort[arrsize];\n\n    // generate random array\n    for (int i = 0; i &lt; arrsize; ++i)\n        arr_sort[i] = 1 + rand() % 99;\n    print_arr(arr_sort, arrsize);\n\n    // sort the array\n    merge_sort(arr_sort, arrsize);\n    print_arr(arr_sort, arrsize);\n}\n</code></pre>\n\n<p><strong>Sample Output</strong></p>\n\n<pre><code>16 81 73 86 87 66 14 93 19 13 62 32 70 56 29 88 20 21 7 27 70 46 72 42 95 83 24 2 5 43 67 79 8 18 82 39 81 56 56 45\n2 5 7 8 13 14 16 18 19 20 21 24 27 29 32 39 42 43 45 46 56 56 56 62 66 67 70 70 72 73 79 81 81 82 83 86 87 88 93 95\n</code></pre>\n\n<p>Hope it helps.</p>\n"}], "owner": {"reputation": 37, "user_id": 12612306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b575c4c176f0814c729fe40fdb7d212?s=128&d=identicon&r=PG&f=1", "display_name": "Mikel", "link": "https://stackoverflow.com/users/12612306/mikel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 59530869, "answer_count": 1, "score": 1, "last_activity_date": 1577708906, "creation_date": 1577698461, "question_id": 59528554, "link": "https://stackoverflow.com/questions/59528554/error-in-implementing-bubble-sorting-in-a-merge-sort-program-in-c", "title": "Error in implementing bubble sorting in a merge sort program in C", "body": "<p>I am learning data structure and algorithms. The program takes a set number of inputs in an array and sorts them out using merge sort. The condition is whenever the size of a sub-array is equal to or smaller than 10, it should sort the elements out using <strong>bubble sort</strong> and then merge them together. My problem is with getting the program to bubble sort. So far I have been unable to find out the mistake in my program. I am still learning everyday. I would really appreciate it if someone could help me find the error and fix it please. Thank you very much and have a g'day.</p>\n\n<p>Here's the code:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#define arrsize 10\nvoid merge_sort(int, int);\nvoid merge_array(int, int, int, int);\nint arr_sort[arrsize];\nvoid bubblesort(int a[],int size);\nvoid main()\n{\n  int a[50],n,i;\n   printf(\"\\nEnter %d Elements for Sorting\\n\", arrsize);\n  for (i = 0; i &lt; arrsize; i++)\n    scanf(\"%d\", &amp;arr_sort[i]);\n\n  printf(\"\\nYour Data   :\");\n  for (i = 0; i &lt; arrsize; i++) {\n    printf(\"\\t%d\", arr_sort[i]);\n  }\n\n  merge_sort(0, arrsize - 1);\n\n  printf(\"\\n\\nSorted Data :\");\n  for (i = 0; i &lt; arrsize; i++) {\n    printf(\"\\t%d\", arr_sort[i]);\n  }\n\n}\nvoid bubblesort(int arr_sort[],int size)\n{\n  int temp,i,j;\n  for(i=0;i&lt;size;i++)\n  {\n   for(j=0;j&lt;size-1;j++)\n   {\n    if(arr_sort[j]&gt;arr_sort[j+1])\n    {\n     temp=arr_sort[j];\n     arr_sort[j]=arr_sort[j+1];\n     arr_sort[j+1]=temp;\n    }\n  }\n }\n}\nvoid merge_sort(int i, int j) {\n  int m;\n  if (i &lt; j) {\n    m = (i + j) / 2;\n       if(m&lt;=5)\n    {\n        for(i=0;i&lt;=m;i++){\n            for(j=i+1;j&lt;=m;j++){\n        bubblesort(arr_sort[i],m);\n        bubblesort(arr_sort[j],m);}}\n        merge_array(i,m,m+1,j);\n    }\n    else\n         merge_sort(i, m);\n    merge_sort(m + 1, j);\n    merge_array(i, m, m + 1, j);\n  }\n}\n\nvoid merge_array(int a, int b, int c, int d) {\n  int t[50];\n  int i = a, j = c, k = 0;\n\n  while (i &lt;= b &amp;&amp; j &lt;= d) {\n    if (arr_sort[i] &lt; arr_sort[j])\n      t[k++] = arr_sort[i++];\n    else\n      t[k++] = arr_sort[j++];\n  }\n  while (i &lt;= b)\n    t[k++] = arr_sort[i++];\n\n  while (j &lt;= d)\n    t[k++] = arr_sort[j++];\n\n  for (i = a, j = 0; i &lt;= d; i++, j++)\n    arr_sort[i] = t[j];\n}\n</code></pre>\n"}, {"tags": ["c", "sockets", "memset"], "comments": [{"owner": {"reputation": 5360, "user_id": 9435815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xaQWU.jpg?s=128&g=1", "display_name": "r3mus n0x", "link": "https://stackoverflow.com/users/9435815/r3mus-n0x"}, "edited": false, "score": 0, "creation_date": 1577699764, "post_id": 59528466, "comment_id": 105227478, "body": "What about <code>msg_controllen</code>? Maybe it happened to contain an arbitrarily large garbage value."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1577699797, "post_id": 59528466, "comment_id": 105227494, "body": "Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal verifiable example</a>. It seems you are saying when you don&#39;t set the <code>Msgs</code> fields explicitly then you get an error. That would be unsurprising. But without a complete code example it is impossible to say exactly what the problem is."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1577700089, "post_id": 59528466, "comment_id": 105227612, "body": "I don&#39;t know the exact reason but in general it doesn&#39;t seem surprising that something fails if <b>input</b> arguments are left <b>uninitialized!</b> In this case it may be sufficient to set <code>msg_controllen</code> to zero but in general it seems better to initialize all input arguments."}, {"owner": {"reputation": 19, "user_id": 8147920, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-X-LtaNoh7qI/AAAAAAAAAAI/AAAAAAAAXI0/4t-OlCiOPRw/photo.jpg?sz=128", "display_name": "imoc", "link": "https://stackoverflow.com/users/8147920/imoc"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1577714077, "post_id": 59528466, "comment_id": 105233504, "body": "@kaylum I can&#39;t provide the code example as the similar code structure(this is why I wondered several hours this afternoon, same chunk code perfectly fine just different position in the source file) will produce different stack layout by the compiler, and I don&#39;t have the &quot;permission&quot; to put whole code out, so no. And the main reason I post it as a problem is very few people will ever use sendmmsg() syscall and maybe tell them initing mmsghdr IS NECESSARY, and my reputation can&#39;t let me just add this to a similar problem involving sendmsg(). The man pages sometimes explain things very badly."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1577734378, "post_id": 59528466, "comment_id": 105241460, "body": "You were not asked to put your whole code in. You were requested to give a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal verifiable example</a>. Please read the link to understand what that means. And if you want to continue on Stackoverflow please read some of the <a href=\"https://stackoverflow.com/help\">help</a> pages to understand what the post requirements are."}, {"owner": {"reputation": 19, "user_id": 8147920, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-X-LtaNoh7qI/AAAAAAAAAAI/AAAAAAAAXI0/4t-OlCiOPRw/photo.jpg?sz=128", "display_name": "imoc", "link": "https://stackoverflow.com/users/8147920/imoc"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1577756345, "post_id": 59528466, "comment_id": 105247339, "body": "@kaylum I don&#39;t have time to CONSTRUCT another buggy code just for my sakes, thanks."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 8147920, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-X-LtaNoh7qI/AAAAAAAAAAI/AAAAAAAAXI0/4t-OlCiOPRw/photo.jpg?sz=128", "display_name": "imoc", "link": "https://stackoverflow.com/users/8147920/imoc"}, "edited": false, "score": 0, "creation_date": 1577714127, "post_id": 59528991, "comment_id": 105233527, "body": "This is true, reasons above. But bad advice, just init it you&#39;ll be fine."}], "tags": [], "owner": {"reputation": 29, "user_id": 9702810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ec6237c6ce6f624f5fe455644a38066?s=128&d=identicon&r=PG&f=1", "display_name": "UpendraG", "link": "https://stackoverflow.com/users/9702810/upendrag"}, "is_accepted": false, "score": 0, "last_activity_date": 1577700333, "creation_date": 1577700333, "answer_id": 59528991, "question_id": 59528466, "link": "https://stackoverflow.com/questions/59528466/sendmmsg-return-1-no-buffer-space-available-why-does-memset-solve-this/59528991#59528991", "title": "sendmmsg() return -1, no buffer space available, why does memset solve this?", "body": "<p>Probably you have taken local variable of this structure.\nBy default local variables are initialized with garbage causing this issue.\nYou can even try this by having global variable of the same.</p>\n"}], "owner": {"reputation": 19, "user_id": 8147920, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-X-LtaNoh7qI/AAAAAAAAAAI/AAAAAAAAXI0/4t-OlCiOPRw/photo.jpg?sz=128", "display_name": "imoc", "link": "https://stackoverflow.com/users/8147920/imoc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1577700333, "creation_date": 1577698148, "last_edit_date": 1577698650, "question_id": 59528466, "link": "https://stackoverflow.com/questions/59528466/sendmmsg-return-1-no-buffer-space-available-why-does-memset-solve-this", "title": "sendmmsg() return -1, no buffer space available, why does memset solve this?", "body": "<p>One of these three members in <code>struct mmsghdr</code>:</p>\n\n<pre><code>void         *msg_control;    /* ancillary data, see below */\nsize_t        msg_controllen; /* ancillary data buffer len */\nint           msg_flags;      /* flags on received message */\n</code></pre>\n\n<p>causing the problem: <code>sendmmsg()</code> returns -1, \"no buffer space available\".</p>\n\n<p>After <code>memset(&amp;(Msgs),0,sizeof(struct mmsghdr));</code> problem goes away.<br>\nOne of man pages said <code>msg_flags</code> is ignored, so is <code>msg_control</code> messing things up?</p>\n"}, {"tags": ["c", "structure"], "comments": [{"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 1, "creation_date": 1577698184, "post_id": 59528423, "comment_id": 105226863, "body": "Always initialise your variables. It&#39;s the simplest, cheapest, fastest way to avoid many bugs."}, {"owner": {"reputation": 655, "user_id": 3616601, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d9dbe1da7416f8fa9b0cf1d0974269e7?s=128&d=identicon&r=PG&f=1", "display_name": "Phantom", "link": "https://stackoverflow.com/users/3616601/phantom"}, "reply_to_user": {"reputation": 358, "user_id": 9345287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19659e54eaab9777cd74ca352f612da2?s=128&d=identicon&r=PG&f=1", "display_name": "Breakpoint", "link": "https://stackoverflow.com/users/9345287/breakpoint"}, "edited": false, "score": 1, "creation_date": 1577698610, "post_id": 59528423, "comment_id": 105227019, "body": "<code>st[i].sub==&quot;cse&quot;</code> O.O @Breakpoint: &quot;teaches code&quot; -&gt; are you sure?"}, {"owner": {"reputation": 358, "user_id": 9345287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19659e54eaab9777cd74ca352f612da2?s=128&d=identicon&r=PG&f=1", "display_name": "Breakpoint", "link": "https://stackoverflow.com/users/9345287/breakpoint"}, "reply_to_user": {"reputation": 655, "user_id": 3616601, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d9dbe1da7416f8fa9b0cf1d0974269e7?s=128&d=identicon&r=PG&f=1", "display_name": "Phantom", "link": "https://stackoverflow.com/users/3616601/phantom"}, "edited": false, "score": 1, "creation_date": 1577698869, "post_id": 59528423, "comment_id": 105227121, "body": "float *p=&amp;st[i].mrk; &#39;i&#39; is uninitialized here, p doesn&#39;t know where to point at. @Phantom sorry, I meant profs coming to classroom with mugged up codes and writing it down on a blackboard"}], "owner": {"reputation": 11, "user_id": 12102161, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAWS8J6BPwQTwstV6K-KBZxz7vn8FqxSZpNshqxdQ=k-s128", "display_name": "Manvi Vrati", "link": "https://stackoverflow.com/users/12102161/manvi-vrati"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1577698219, "creation_date": 1577697947, "last_edit_date": 1577698219, "question_id": 59528423, "link": "https://stackoverflow.com/questions/59528423/how-to-allot-sections-in-a-structure-member-by-taking-subject-from-user-in-as-an", "title": "How to allot sections in a structure member by taking subject from user in as another Structure member in c language", "body": "<pre><code>/*Take value and store in structure member, compare with constant\n  do batch allotment in it.*/\n\n#include &lt;stdio.h&gt;\n#include &lt;conio.h&gt;\n\nvoid main()\n{\n    struct student{\n        float mrk;\n        char sub[10];\n        char sec[10];\n    } st[2];\n    int i;\n    float *p=&amp;st[i].mrk;\n    clrscr();\n    for (i=0; i&lt;2; i++)\n    {\n        printf(\"Enter 12th mrks: \");\n        scanf(\"%f\", &amp;st[i].mrk);\n        fflush(stdin);\n        printf(\"Enter subject: \");\n        gets(st[i].sub);\n    }\n    for (i=0; i&lt;2; i++)\n    {\n        if (st[i].sub==\"cse\")\n            strcpy(st[i].sec,\"A\");   //st[i].sec=\"A\";\n        else if (st[i].sub==\"me\")\n            strcpy(st[i].sec,\"B\");   //st[i].sec=\"B\";\n        else\n            strcpy(st[i].sec,NULL);  //st[i].sec=NULL;\n    }\n    printf(\"\\n numbers \\t sub \\tsec \\n\");\n    printf(\"-------------------------------------\\n\");\n    for (i=0; i&lt;2; i++)\n    {\n        printf(\"%f\\t%s\\t%s\\n\",st[i].mrk,st[i].sub,st[i].sec);\n    }\n    getch();\n}\n</code></pre>\n\n<p>Hello. This is the code. Please help. I'm unable to get the output for alloting sections according to the subject taken from user. It prints nothing over there and there is no error in turbo c7 compiler that I'm working on.</p>\n"}, {"tags": ["c++", "c", "memory-alignment", "memory-layout"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1577697258, "post_id": 59528237, "comment_id": 105226547, "body": "<i>Indeterminate</i>. Could be any seemingly random or &quot;garbage&quot; values."}], "answers": [{"comments": [{"owner": {"reputation": 5024, "user_id": 4439794, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/ogyE1.png?s=128&g=1", "display_name": "Trevor", "link": "https://stackoverflow.com/users/4439794/trevor"}, "edited": false, "score": 0, "creation_date": 1577697664, "post_id": 59528305, "comment_id": 105226694, "body": "Even when I create an object with static storage duration ?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 5024, "user_id": 4439794, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/ogyE1.png?s=128&g=1", "display_name": "Trevor", "link": "https://stackoverflow.com/users/4439794/trevor"}, "edited": false, "score": 1, "creation_date": 1577697886, "post_id": 59528305, "comment_id": 105226751, "body": "@Trevor Still indeterminate. But since it&#39;s it likely that such data (and global uninitialized data as well) is  &quot;cleared&quot; by <code>memset</code> (or similar) then it probably will be zero as well. But that&#39;s an implementation details that couldn&#39;t be counted on. Just don&#39;t assume there&#39;s anything other than random garbage in the padding space and you&#39;ll be fine."}, {"owner": {"reputation": 5024, "user_id": 4439794, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/ogyE1.png?s=128&g=1", "display_name": "Trevor", "link": "https://stackoverflow.com/users/4439794/trevor"}, "edited": false, "score": 0, "creation_date": 1577698420, "post_id": 59528305, "comment_id": 105226941, "body": "@paxdiablo: so for uninitialized array that has static storage duration, the default value shall be <code>0</code> but not the padding of a struct that has static storage duration ?"}, {"owner": {"reputation": 69, "user_id": 9634862, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VstP.jpg?s=128&g=1", "display_name": "realxie", "link": "https://stackoverflow.com/users/9634862/realxie"}, "edited": false, "score": 0, "creation_date": 1577842037, "post_id": 59528305, "comment_id": 105268091, "body": "Thanks a lot, I just want to hash a struct object, I have use <code>#pragma pack(1)</code> to fix this problem."}], "tags": [], "owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "is_accepted": false, "score": 2, "last_activity_date": 1577722953, "last_edit_date": 1577722953, "creation_date": 1577697431, "answer_id": 59528305, "question_id": 59528237, "link": "https://stackoverflow.com/questions/59528237/what-values-are-stored-in-the-padding-bytes-of-an-aligned-struct-class-object/59528305#59528305", "title": "What values are stored in the padding bytes of an aligned struct/class object", "body": "<p>It actually depends on a few things, all detailed in the C++ standard <code>[dcl.init]</code>.</p>\n\n<p>The various sections of that end up either default-initialising, zero-initialising or value-initialising depending on the storage duration, presence of various types of constructors, and so on.</p>\n\n<p>Default initialising means the entire variable will be some arbitrary value while zero initialising zero-initialises all members <em>and sets padding bytes to zero.</em></p>\n\n<p>So <code>Data d1;</code> and <code>static Data d2;</code> will not necessarily have the same padding bytes.</p>\n\n<p>Value initialising is a little more complex since it effectively first chooses default or zero initialisation before calling the constructor (if one exists).</p>\n\n<hr>\n\n<p>But the bottom line is that it probably shouldn't matter. If the content of padding was important, you should be \"registering\" that space as real member variables so that you can use them (and have them properly initialised). Padding is very much unimportant in the \"value\" of a variable unless you do something crazy like <code>memcmp</code> it, or run a checksum over the entire memory block it occupies :-)</p>\n"}, {"comments": [{"owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "edited": false, "score": 0, "creation_date": 1577723009, "post_id": 59528984, "comment_id": 105237360, "body": "It&#39;s all in <code>[dcl.init]</code> which covers the various scenarios for variable initialisation. See my answer."}, {"owner": {"reputation": 5024, "user_id": 4439794, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/ogyE1.png?s=128&g=1", "display_name": "Trevor", "link": "https://stackoverflow.com/users/4439794/trevor"}, "reply_to_user": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "edited": false, "score": 0, "creation_date": 1577723127, "post_id": 59528984, "comment_id": 105237417, "body": "@paxdiablo ok, I have seen it. Great information. So it&#39;s not really indeterminate like your first answer. Your edit makes my comment below so weird though :)"}, {"owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "edited": false, "score": 0, "creation_date": 1577723305, "post_id": 59528984, "comment_id": 105237491, "body": "No, when you said you couldn&#39;t find it, I went on a deep dive into the standard. Now I have a headache and need to go get some sleep :-)"}], "tags": [], "owner": {"reputation": 5024, "user_id": 4439794, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/ogyE1.png?s=128&g=1", "display_name": "Trevor", "link": "https://stackoverflow.com/users/4439794/trevor"}, "is_accepted": false, "score": 1, "last_activity_date": 1577700283, "last_edit_date": 1592644375, "creation_date": 1577700283, "answer_id": 59528984, "question_id": 59528237, "link": "https://stackoverflow.com/questions/59528237/what-values-are-stored-in-the-padding-bytes-of-an-aligned-struct-class-object/59528984#59528984", "title": "What values are stored in the padding bytes of an aligned struct/class object", "body": "<p>I always believe it's unpredictable but still unsure in case of the object of the struct has static storage duration.</p>\n<p>So I have made a search to see whether there is a clear mention about this in C standards and C++ standards or not (since you are asking in C and C++).</p>\n<p>It <strong>is</strong> mentioned in C standards (C99, C11 and C18):</p>\n<blockquote>\n<p>J.1    Unspecified behavior</p>\n<ul>\n<li>The value of padding bytes when storing values in structures or unions (6.2.6.1).</li>\n</ul>\n</blockquote>\n<p>For C++, I could not find out it's mentioned anywhere in C++ standards.</p>\n"}], "owner": {"reputation": 69, "user_id": 9634862, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VstP.jpg?s=128&g=1", "display_name": "realxie", "link": "https://stackoverflow.com/users/9634862/realxie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 188, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1577728618, "creation_date": 1577697134, "last_edit_date": 1577728618, "question_id": 59528237, "link": "https://stackoverflow.com/questions/59528237/what-values-are-stored-in-the-padding-bytes-of-an-aligned-struct-class-object", "title": "What values are stored in the padding bytes of an aligned struct/class object", "body": "<hr>\n\n<pre><code>struct Data\n{\n    std::uint32_t b;\n    char a;\n};\n</code></pre>\n\n<p>The Data type is aligned by 4 bytes, so sizeof(Data) == 8. </p>\n\n<p>But what the values are in 5th-7th bytes? Is it default zero?</p>\n"}, {"tags": ["c++", "c", "pointers", "linked-list", "segmentation-fault"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1577696697, "post_id": 59527999, "comment_id": 105226375, "body": "Internal logic aside, stop lying to the compiler. You promised to <code>return</code> a <code>Node*</code>; live up to that promise."}, {"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1577697926, "post_id": 59527999, "comment_id": 105226766, "body": "Which language are you really using, C or C++? They are different languages, you know."}, {"owner": {"reputation": 119, "user_id": 8739203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/927ad8019eafd1fe795ea9370f36130f?s=128&d=identicon&r=PG", "display_name": "Prav", "link": "https://stackoverflow.com/users/8739203/prav"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1577699828, "post_id": 59527999, "comment_id": 105227505, "body": "@WhozCraig Snap, missed that haha."}], "answers": [{"tags": [], "owner": {"reputation": 2937, "user_id": 12488509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vr6bR.png?s=128&g=1", "display_name": "bhristov", "link": "https://stackoverflow.com/users/12488509/bhristov"}, "is_accepted": false, "score": 1, "last_activity_date": 1577696472, "last_edit_date": 1577696472, "creation_date": 1577696093, "answer_id": 59528042, "question_id": 59527999, "link": "https://stackoverflow.com/questions/59527999/deleting-node-in-linked-list-segmentation-fault/59528042#59528042", "title": "Deleting node in linked list - segmentation fault", "body": "<p>You should check to see if <code>head == nullptr</code> in the very beginning and also before you execute the last 3 lines of code if \n<code>temp == nullptr</code>\nbecause you can exit the for loop because the node the user is trying to remove is beyond the size.</p>\n\n<p>You should also consider returning <code>void</code> from your function.</p>\n\n<p>You can do something like this:</p>\n\n<pre><code>void deleteNode(Node *head,int x)\n{\n    // this way you avoid dereferencing nullptr with temp-&gt;next later on\n    if(head == nullptr) return;\n    //Your code here\n    struct Node* temp = head;\n\n    if(x==0){\n        //change head\n        head = temp-&gt;next;\n        free(temp);\n    }\n    //find previous node of node to be deleted\n    for(int i=0; temp!=NULL &amp;&amp; i&lt;x-1; ++i){\n        //traverse\n        temp = temp-&gt;next;\n    }\n    //now temp should be pointing to previous node\n    //store pointer to next of node to be deleted\n\n    // you need to check to see if temp is nullptr here or if the node\n    // after temp is nullptr because either of those can cause you to \n    // get a segmentation fault because of dereferencing a nullptr\n    if(temp == nullptr || temp-&gt;next == nullptr) return;\n    struct Node* next = temp-&gt;next-&gt;next;\n    free(temp-&gt;next);\n    temp-&gt;next= next;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 119, "user_id": 8739203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/927ad8019eafd1fe795ea9370f36130f?s=128&d=identicon&r=PG", "display_name": "Prav", "link": "https://stackoverflow.com/users/8739203/prav"}, "edited": false, "score": 0, "creation_date": 1577699543, "post_id": 59528055, "comment_id": 105227377, "body": "Thanks for the response. Why would I have to pass a double-pointer to change the head variable in the caller? (is it because head is being passed as a double-pointer itself?)"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 119, "user_id": 8739203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/927ad8019eafd1fe795ea9370f36130f?s=128&d=identicon&r=PG", "display_name": "Prav", "link": "https://stackoverflow.com/users/8739203/prav"}, "edited": false, "score": 0, "creation_date": 1577700018, "post_id": 59528055, "comment_id": 105227587, "body": "@Prav If you only change a passed pointer, then the assignment is only to the local parameter in the function. If you pass a pointer to the pointer, you can dereference it to assign it. (i.e. <code>*head = temp-&gt;next</code>). Another option is to leave this as it is, but to return the new <code>head</code> and assign it to the head in the calling function (i.e. <code>head = deleteNode(head, x);</code> in the caller). This requires that you always return the new valid <code>head</code>, which you currently don&#39;t."}], "tags": [], "owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "is_accepted": true, "score": 1, "last_activity_date": 1577696170, "creation_date": 1577696170, "answer_id": 59528055, "question_id": 59527999, "link": "https://stackoverflow.com/questions/59527999/deleting-node-in-linked-list-segmentation-fault/59528055#59528055", "title": "Deleting node in linked list - segmentation fault", "body": "<p>Your code contains many places where a null pointer could be dereferenced. For example here:</p>\n\n<pre><code>struct Node* temp = head;\n\nif(x==0){\n    //change head\n    head = temp-&gt;next;\n    free(temp);\n}\n</code></pre>\n\n<p>if <code>head</code> was already a null pointer. Furthermore, you seem to be assuming that this changes the <code>head</code> variable in the <em>caller</em>, which is not the case. You would have to pass a double-pointer to achieve this. Lastly, it looks like your function should return after the <code>free(temp);</code>.</p>\n\n<p>Then, looking at this part:</p>\n\n<pre><code>for(int i=0; temp!=NULL &amp;&amp; i&lt;x-1; ++i){\n    //traverse\n    temp = temp-&gt;next;\n}\n//now temp should be pointing to previous node\n//store pointer to next of node to be deleted\n</code></pre>\n\n<p>No, it not necessarily points to a node, <code>temp</code> could also contain a null pointer, which is the second break condition of your for-loop. You have to check for that and bail out if this is the case.</p>\n"}], "owner": {"reputation": 119, "user_id": 8739203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/927ad8019eafd1fe795ea9370f36130f?s=128&d=identicon&r=PG", "display_name": "Prav", "link": "https://stackoverflow.com/users/8739203/prav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 346, "favorite_count": 0, "accepted_answer_id": 59528055, "answer_count": 2, "score": 1, "last_activity_date": 1577696472, "creation_date": 1577695819, "question_id": 59527999, "link": "https://stackoverflow.com/questions/59527999/deleting-node-in-linked-list-segmentation-fault", "title": "Deleting node in linked list - segmentation fault", "body": "<p>Problem requires to delete node from linked list given head pointer of list and the position of node in list to be deleted. More details of question can be found at: <a href=\"https://practice.geeksforgeeks.org/problems/delete-a-node-in-single-linked-list/1\" rel=\"nofollow noreferrer\">https://practice.geeksforgeeks.org/problems/delete-a-node-in-single-linked-list/1</a></p>\n\n<p>Code returns segmentation fault but not exactly sure where I went wrong. My code is as follows:</p>\n\n<pre><code>Node* deleteNode(Node *head,int x)\n{\n    //Your code here\n    struct Node* temp = head;\n\n    if(x==0){\n        //change head\n        head = temp-&gt;next;\n        free(temp);\n    }\n    //find previous node of node to be deleted\n    for(int i=0; temp!=NULL &amp;&amp; i&lt;x-1; ++i){\n        //traverse\n        temp = temp-&gt;next;\n    }\n    //now temp should be pointing to previous node\n    //store pointer to next of node to be deleted\n    struct Node* next = temp-&gt;next-&gt;next;\n    free(temp-&gt;next);\n    temp-&gt;next= next;\n}\n</code></pre>\n"}, {"tags": ["c", "arduino", "arduino-uno", "gsm", "arduino-ultra-sonic"], "comments": [{"owner": {"reputation": 425, "user_id": 12602747, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r3evl.png?s=128&g=1", "display_name": "naszy", "link": "https://stackoverflow.com/users/12602747/naszy"}, "edited": false, "score": 1, "creation_date": 1577743512, "post_id": 59526706, "comment_id": 105244530, "body": "It&#39;s just a guess, but it might be the <code>SoftwareSerial</code> library that causes the issues. <a href=\"https://github.com/SlashDevin/NeoGPS/blob/master/extras/doc/Installing.md#2-choose-a-serial-port\" rel=\"nofollow noreferrer\">Check this for alternatives.</a>"}, {"owner": {"reputation": 1741, "user_id": 6716559, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/3490f96006cf5fb2f8122f42b4949588?s=128&d=identicon&r=PG", "display_name": "Shubham Sahu", "link": "https://stackoverflow.com/users/6716559/shubham-sahu"}, "reply_to_user": {"reputation": 425, "user_id": 12602747, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r3evl.png?s=128&g=1", "display_name": "naszy", "link": "https://stackoverflow.com/users/12602747/naszy"}, "edited": false, "score": 0, "creation_date": 1577866071, "post_id": 59526706, "comment_id": 105270572, "body": "@naszy okay! but SoftwareSerial library is only used in gps and gsm, but let me check.. thanks for suggestion"}], "owner": {"reputation": 1741, "user_id": 6716559, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/3490f96006cf5fb2f8122f42b4949588?s=128&d=identicon&r=PG", "display_name": "Shubham Sahu", "link": "https://stackoverflow.com/users/6716559/shubham-sahu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 209, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1577687858, "creation_date": 1577687858, "question_id": 59526706, "link": "https://stackoverflow.com/questions/59526706/buzzer-continuously-beep-high-then-low", "title": "Buzzer Continuously beep HIGH then LOW", "body": "<p>In my project i am using GSM900A mini, GPS Neo 6m, Ultrasonic Sensor and Buzzer.</p>\n\n<p>Problem is I have two sketch, <strong>1)**For GSM and GPS and **2)</strong> for Ultrasonic and Buzzer,\nwhen i use both sketch separately working fine but when i combine buzzer start beeping <em>like a blinking led</em>  HIGH_LOW_HIGH_LOW continuously.</p>\n\n<p>Sketch 1) GPS and GSM</p>\n\n<pre><code>#include &lt;SoftwareSerial.h&gt;\n#include &lt;TinyGPS.h&gt;\n\nint state = 0;\nconst int pin = 9;    //Push Button\nfloat gpslat, gpslon;\n\nTinyGPS gps;\nSoftwareSerial sgps (7, 6);\nSoftwareSerial sgsm (2, 3);\n\nvoid setup()\n{        \n    sgsm.begin (9600);    // Setting the baud rate of GSM Module\n    sgps.begin (9600);    // Setting the baud rate of GPS Module\n}\n\nvoid loop()\n{       \n    while (sgps.available ())\n    {\n        int c = sgps.read ();\n        if (gps.encode (c))\n        {\n            gps.f_get_position (&amp;gpslat, &amp;gpslon);\n        }\n    }\n    if (digitalRead (pin) == HIGH &amp;&amp; state == 0)\n    {\n        sgsm.print (\"\\r\");\n        delay (1000);\n        sgsm.print (\"AT+CMGF=1\\r\");\n        delay (1000);\n       //Replace XXXXXXXXXX to 10 digit mobile number &amp;\n\n       sgsm.print (\"AT+CMGS=\\\"+91XXXXXXXXXX\\\"\\r\");\n       delay (1000);\n       //The text of the message to be sent.\n       sgsm.print (\"I am at : \");\n       sgsm.print (\"http://maps.google.com/maps?q=loc:\");\n       sgsm.print (gpslat == TinyGPS::GPS_INVALID_F_ANGLE ? 0.0 : gpslat, 6);    \n       sgsm.print (\",\");\n       sgsm.print (gpslon == TinyGPS::GPS_INVALID_F_ANGLE ? 0.0 : gpslon, 6);\n       delay (200);\n       sgsm.println ((char) 26); // End AT command with a ^Z, ASCII code 26\n       delay (200);\n       sgsm.println ();\n       delay (1000);\n       sgsm.write (0x1A);\n       delay (1000);\n       state = 1;\n   }\n   if(digitalRead (pin) == LOW)\n   {\n       state = 0;\n   }\n}\n</code></pre>\n\n<p>Sketch 2) Ultrasonic and buzzer</p>\n\n<pre><code> // Define pins for ultrasonic and buzzer\nint const trigPin = 11;\nint const echoPin = 10;\nint const buzzPin = 8;\n\nvoid setup()\n{\n  pinMode(trigPin, OUTPUT); // trig pin will have pulses output\n  pinMode(echoPin, INPUT); // echo pin should be input to get pulse width\n  pinMode(buzzPin, OUTPUT); // buzz pin is output to control buzzering\n}\n\nvoid loop()\n{\n  // Duration will be the input pulse width and distance will be the distance to the obstacle in centimeters\n  int duration, distance;\n  // Output pulse with 1ms width on trigPin\n  digitalWrite(trigPin, HIGH); \n  delay(1);\n  digitalWrite(trigPin, LOW);\n  // Measure the pulse input in echo pin\n  duration = pulseIn(echoPin, HIGH);\n  // Distance is half the duration devided by 29.1 (from datasheet)\n  distance = (duration/2) / 29.1;\n  // if distance less than 0.5 meter and more than 0 (0 or less means over range) \n    if (distance &lt;= 60 &amp;&amp; distance &gt;= 0) {\n      // Buzz\n      digitalWrite(buzzPin, HIGH);\n    } else {\n      // Don't buzz\n      digitalWrite(buzzPin, LOW);\n    }\n    // Waiting 60 ms won't hurt any one\n    delay(60);\n}\n</code></pre>\n\n<p>and combined Code</p>\n\n<pre><code>#include &lt;SoftwareSerial.h&gt;\n#include &lt;TinyGPS.h&gt;\n\nint const trigPin = 11;    //Ultrasonic\nint const echoPin = 10;   //Ultrasonic\nint const buzzPin = 8;    //Ultrasonic\nint state = 0;\nconst int pin = 9;    //Push Button\nfloat gpslat, gpslon;\n\nTinyGPS gps;\nSoftwareSerial sgps (7, 6);\nSoftwareSerial sgsm (2, 3); //2,3\n\nvoid setup()\n{\n  pinMode (trigPin, OUTPUT);  // trig pin will have pulses output\n  pinMode (echoPin, INPUT); // echo pin should be input to get pulse width\n  pinMode (buzzPin, OUTPUT);  // buzz pin is output to control buzzering\n\n  sgsm.begin (9600);    // Setting the baud rate of GSM Module\n  sgps.begin (9600);    // Setting the baud rate of GPS Module\n}\n\nvoid loop()\n{\n  // Duration will be the input pulse width and distance will be the distance to the obstacle in centimeters\n  int duration, distance;\n  // Output pulse with 1ms width on trigPin\n  digitalWrite (trigPin, HIGH);\n  delay (1);\n  digitalWrite (trigPin, LOW);\n  // Measure the pulse input in echo pin\n  duration = pulseIn (echoPin, HIGH);\n  // Distance is half the duration devided by 29.1 (from datasheet)\n  distance = (duration / 2) / 29.1;\n  // if distance less than 0.5 meter and more than 0 (0 or less means over range) \n  if (distance &lt;= 70 &amp;&amp; distance &gt;= 0)\n  {\n    // Buzz\n    digitalWrite (buzzPin, HIGH);\n  }\n  else\n  {\n    // Don't buzz\n    digitalWrite (buzzPin, LOW);\n  }\n  // Waiting 60 ms won't hurt any one\n  delay (60);\n\n  //gsm gps................................................\n  while (sgps.available ())\n  {\n    int c = sgps.read ();\n    if (gps.encode (c))\n    {\n      gps.f_get_position (&amp;gpslat, &amp;gpslon);\n    }\n  }\n  if (digitalRead (pin) == HIGH &amp;&amp; state == 0)\n  {\n    sgsm.print (\"\\r\");\n    delay (1000);\n    sgsm.print (\"AT+CMGF=1\\r\");\n    delay (1000);\n    /*Replace XXXXXXXXXX to 10 digit mobile number &amp;\n      ZZ to 2 digit country code */\n    sgsm.print (\"AT+CMGS=\\\"+919179413150\\\"\\r\");\n    delay (1000);\n    //The text of the message to be sent.\n    sgsm.print (\"I am at : \");\n    sgsm.print (\"http://maps.google.com/maps?q=loc:\");\n    sgsm.print (gpslat == TinyGPS::GPS_INVALID_F_ANGLE ? 0.0 : gpslat, 6);\n    //Gsm.print(\" Longitude = \");\n    sgsm.print (\",\");\n    sgsm.print (gpslon == TinyGPS::GPS_INVALID_F_ANGLE ? 0.0 : gpslon, 6);\n    delay (200);\n    sgsm.println ((char) 26); // End AT command with a ^Z, ASCII code 26\n    delay (200);\n    sgsm.println ();\n    //sgsm.print(\"Latitude :\");\n    //sgsm.println(gpslat, 6);\n    //sgsm.print(\",\");\n    //sgsm.print(\"Longitude:\");\n    //sgsm.println(gpslon, 6);\n    delay (1000);\n    sgsm.write (0x1A);\n    delay (1000);\n    state = 1;\n  }\n  if(digitalRead (pin) == LOW)\n  {\n    state = 0;\n  }\n}\n</code></pre>\n\n<p>My GSM and GPS diagram <a href=\"https://i.stack.imgur.com/YExUD.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YExUD.jpg\" alt=\"Diagram\"></a></p>\n\n<p>What is i am doing wrong ? any kind of hint appreciated.</p>\n"}]