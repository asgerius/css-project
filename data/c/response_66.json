[{"tags": ["c", "c++11", "io"], "comments": [{"owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "edited": false, "score": 0, "creation_date": 1460591631, "post_id": 36611484, "comment_id": 60819886, "body": "because of endianness?"}, {"owner": {"reputation": 69, "user_id": 2214296, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/eb0df583785a2d64a8a10a26e9b0b904?s=128&d=identicon&r=PG", "display_name": "Leon", "link": "https://stackoverflow.com/users/2214296/leon"}, "reply_to_user": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "edited": false, "score": 0, "creation_date": 1460591987, "post_id": 36611484, "comment_id": 60819989, "body": "no, it&#39;s in Big Endian."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1460592370, "post_id": 36611484, "comment_id": 60820084, "body": "What do you mean by &quot;it doesn&#39;t work&quot;?  Provide code and output."}], "answers": [{"tags": [], "owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "is_accepted": true, "score": 2, "last_activity_date": 1460592197, "creation_date": 1460592197, "answer_id": 36611584, "question_id": 36611484, "link": "https://stackoverflow.com/questions/36611484/reading-binary-files-with-different-byte-length-value-inside/36611584#36611584", "title": "Reading Binary Files with different byte length value inside", "body": "<p>First you seek to the position you want to read:</p>\n\n<pre><code>fseek(file, 3200, SEEK_SET);\n</code></pre>\n\n<p>Then read the 4 bytes out of the file to the integer you want:</p>\n\n<pre><code>int n;\nfread(&amp;n, 4, 1, file);\n</code></pre>\n\n<p>This works if the endian of the file and your system are the same. Otherwise you convert the number to the endian of you system. E.g.</p>\n\n<pre><code>// if the file is big endian:\nm = be32toh(n);\n// if the file is little endian:\nm = le32toh(n);\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 2214296, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/eb0df583785a2d64a8a10a26e9b0b904?s=128&d=identicon&r=PG", "display_name": "Leon", "link": "https://stackoverflow.com/users/2214296/leon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 36611584, "answer_count": 1, "score": 0, "last_activity_date": 1460592197, "creation_date": 1460591415, "question_id": 36611484, "link": "https://stackoverflow.com/questions/36611484/reading-binary-files-with-different-byte-length-value-inside", "title": "Reading Binary Files with different byte length value inside", "body": "<p>How to read a binary file with different format of length?</p>\n\n<p>for example there are  a specific value after 3200 bytes of binary file which formated in 4 bytes, 2 bytes, 2 bytes, and 1 bytes.</p>\n\n<p>I tried to read using </p>\n\n<pre><code>fread(&amp;buffer, 1, 1, file);\n</code></pre>\n\n<p>then contenate the 4 bytes char in buffer variable - into one char - then convert it to integer but it doesn't work. Only show like if it was one byte length.</p>\n"}, {"tags": ["c", "arrays", "algorithm", "sorting"], "comments": [{"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 2, "creation_date": 1460591545, "post_id": 36611474, "comment_id": 60819856, "body": "This is not a bubble sort but a selection sort."}, {"owner": {"reputation": 56328, "user_id": 4265352, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lzAUc5pYb24/AAAAAAAAAAI/AAAAAAAAAGQ/q3h7bZUnqrs/photo.jpg?sz=128", "display_name": "axiac", "link": "https://stackoverflow.com/users/4265352/axiac"}, "edited": false, "score": 1, "creation_date": 1460591861, "post_id": 36611474, "comment_id": 60819958, "body": "<i>&quot;if you can walk through the sort algorithm&quot;</i> - use pencil and paper to simulate the execution of the code with a short array (5-6 elements should be enough). This is the best way to understand how it works."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1460592312, "post_id": 36611474, "comment_id": 60820074, "body": "A note about O(N) and bubble sorts. In order for a bubble sort to finish in O(N) time, it needs to have <b>early termination code</b>. In other words, if the bubble sort detects that no swaps were needed on a particular pass through the array, then it immediately exits both loops. Since the code in your question has no way to exit the loops early, it will always run in O(N^2) time. And of course, as @ MikeCAT said, the code shown is not actually a bubble sort."}, {"owner": {"reputation": 23, "user_id": 6164065, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/4837867771411b1aaeb64ad8bf62235b?s=128&d=identicon&r=PG&f=1", "display_name": "rtayl0a", "link": "https://stackoverflow.com/users/6164065/rtayl0a"}, "reply_to_user": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1460592567, "post_id": 36611474, "comment_id": 60820144, "body": "@MikeCAT    How do you know it&#39;s selection sort, because to me it looks like bubble sort. I also have wrote it down on paper, but I confuse myself going through the temp. Besides that&#39;s only half of my question, how can you calculate the comparisons and exchanges from the information given? From the algorithm given, how can you find the best, worst and average cases?"}, {"owner": {"reputation": 23, "user_id": 6164065, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/4837867771411b1aaeb64ad8bf62235b?s=128&d=identicon&r=PG&f=1", "display_name": "rtayl0a", "link": "https://stackoverflow.com/users/6164065/rtayl0a"}, "reply_to_user": {"reputation": 2127, "user_id": 923194, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/d48e182893f9d17460dd2404c4072828?s=128&d=identicon&r=PG", "display_name": "Imran Ali", "link": "https://stackoverflow.com/users/923194/imran-ali"}, "edited": false, "score": 0, "creation_date": 1460592629, "post_id": 36611474, "comment_id": 60820158, "body": "@ImranAli  ^^read comment I posted up."}, {"owner": {"reputation": 23, "user_id": 6164065, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/4837867771411b1aaeb64ad8bf62235b?s=128&d=identicon&r=PG&f=1", "display_name": "rtayl0a", "link": "https://stackoverflow.com/users/6164065/rtayl0a"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1460592673, "post_id": 36611474, "comment_id": 60820170, "body": "@user3386109 ^^ read comment up. I also understand that as well for bubblesort. So what sort is this exactly?"}, {"owner": {"reputation": 23, "user_id": 6164065, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/4837867771411b1aaeb64ad8bf62235b?s=128&d=identicon&r=PG&f=1", "display_name": "rtayl0a", "link": "https://stackoverflow.com/users/6164065/rtayl0a"}, "reply_to_user": {"reputation": 56328, "user_id": 4265352, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lzAUc5pYb24/AAAAAAAAAAI/AAAAAAAAAGQ/q3h7bZUnqrs/photo.jpg?sz=128", "display_name": "axiac", "link": "https://stackoverflow.com/users/4265352/axiac"}, "edited": false, "score": 0, "creation_date": 1460592698, "post_id": 36611474, "comment_id": 60820174, "body": "@axiac  ^^read the comment I posted above."}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 2, "creation_date": 1460592793, "post_id": 36611474, "comment_id": 60820200, "body": "This is <a href=\"https://en.wikipedia.org/wiki/Selection_sort\" rel=\"nofollow noreferrer\">selection sort</a> because each elements are compared with the first element in the range dealed with and the minimum element in the range is extracted. Only adjacent elements will be compared in <a href=\"https://en.wikipedia.org/wiki/Bubble_sort\" rel=\"nofollow noreferrer\">bubble sort</a>."}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1460592987, "post_id": 36611474, "comment_id": 60820241, "body": "What is what <i>you</i> call &quot;a bubble sort&quot;?"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1460593485, "post_id": 36611474, "comment_id": 60820362, "body": "I would say it&#39;s a poorly implemented selection sort. One of the primary benefits of a selection sort is that it minimizes the number of swaps. The code in the question makes lots of unnecessary swaps, so it&#39;s a non-standard algorithm. I suspect that you were given a non-standard algorithm was so that you would have to do the analysis yourself."}, {"owner": {"reputation": 23, "user_id": 6164065, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/4837867771411b1aaeb64ad8bf62235b?s=128&d=identicon&r=PG&f=1", "display_name": "rtayl0a", "link": "https://stackoverflow.com/users/6164065/rtayl0a"}, "reply_to_user": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1460593854, "post_id": 36611474, "comment_id": 60820451, "body": "@MikeCAT so how can I calculate the number of comparisons and exchanges from what is given?"}, {"owner": {"reputation": 23, "user_id": 6164065, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/4837867771411b1aaeb64ad8bf62235b?s=128&d=identicon&r=PG&f=1", "display_name": "rtayl0a", "link": "https://stackoverflow.com/users/6164065/rtayl0a"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1460593935, "post_id": 36611474, "comment_id": 60820473, "body": "@user3386109 How can I calculate the number of comparisons and exchanges from what is given? How would I be able to find the complexity? I know Time = comparisons + exchanges"}], "answers": [{"comments": [{"owner": {"reputation": 1762, "user_id": 4809143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f33979f2bebd6f01e560573520b13c?s=128&d=identicon&r=PG&f=1", "display_name": "moreON", "link": "https://stackoverflow.com/users/4809143/moreon"}, "edited": false, "score": 1, "creation_date": 1460597871, "post_id": 36611837, "comment_id": 60821526, "body": "Your definition for selection sort is a little confusing (and wrong). In selection sort you divide the array into two sections - sorted and unsorted, initially all unsorted. You repeatedly select the smallest element (hence the name) from the unsorted section and place it at the end of the sorted section. Comparing everything with the first element is not, in general, how you find the smallest element."}], "tags": [], "owner": {"reputation": 16, "user_id": 6201405, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zr334.jpg?s=128&g=1", "display_name": "Swastika  Srivastava ", "link": "https://stackoverflow.com/users/6201405/swastika-srivastava"}, "is_accepted": true, "score": 0, "last_activity_date": 1460597493, "last_edit_date": 1460597493, "creation_date": 1460594028, "answer_id": 36611837, "question_id": 36611474, "link": "https://stackoverflow.com/questions/36611474/understanding-sorting-algorithm-for-c/36611837#36611837", "title": "Understanding Sorting algorithm for C", "body": "<p>First, you need to know difference between bubble sort and selection sort.</p>\n\n<ul>\n<li><p><strong><a href=\"http://www.algolist.net/Algorithms/Sorting/Selection_sort\" rel=\"nofollow\">Selection Sort</a></strong>: Sorting is done by comparing all the elements with the first element. Then further repeat it with second element and so on.</p></li>\n<li><p><strong><a href=\"http://www.algolist.net/Algorithms/Sorting/Bubble_sort\" rel=\"nofollow\">Bubble Sort</a></strong>: Sorting is done by comparing two adjacent indexes of an array. </p></li>\n</ul>\n\n<p>For calculating complexity consider <code>numInt = 5</code></p>\n\n<p>Now, start considering from the innermost loop here: </p>\n\n<pre><code>k = 0+1=1; k&lt;5\n</code></pre>\n\n<p>This loop will go on until <code>k</code> evaluates to <code>4</code> and when <code>k=5</code> the loop ends and no comparison is made. Thus the loop executes from <code>k=1</code> to <code>k=5</code>, i.e 5 times which = intNum times.</p>\n\n<p>Now consider the outer loop here: </p>\n\n<pre><code>j = 0; j&lt;4 \n</code></pre>\n\n<p>This loop will go on until <code>j</code> evaluates to <code>3</code> and when <code>j=4</code> the loop ends and no comparison is made. Thus the loop executes from <code>j=0</code> to <code>j=4</code>, i.e 5 times which = intNum times.</p>\n\n<p>For the nested loop we multiply the complexity of loops. hence it evaluates to </p>\n\n<pre><code>intNum*intNum = intNum^2\n</code></pre>\n\n<p>and <code>O(intNum^2)</code>.</p>\n\n<p>Refer to <a href=\"http://www.geeksforgeeks.org/analysis-of-algorithms-set-4-analysis-of-loops/\" rel=\"nofollow\">these further details of complexity evaluation</a>.</p>\n"}], "owner": {"reputation": 23, "user_id": 6164065, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/4837867771411b1aaeb64ad8bf62235b?s=128&d=identicon&r=PG&f=1", "display_name": "rtayl0a", "link": "https://stackoverflow.com/users/6164065/rtayl0a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 36611837, "answer_count": 1, "score": 0, "last_activity_date": 1460598727, "creation_date": 1460591343, "last_edit_date": 1460598727, "question_id": 36611474, "link": "https://stackoverflow.com/questions/36611474/understanding-sorting-algorithm-for-c", "title": "Understanding Sorting algorithm for C", "body": "<p>I'm studying for my GNU C test that I have on Friday. On the review there's a question that I cannot understand. \"The following algorithm sorts an array into ascending order in place.  The algorithm is sensitive to the order of the contents being sorted (random, sorted order, reverse sorted order).  Evaluate the algorithms performance numerically in terms of the exact number of compares and exchanges required for minimum and maximum run time performance.  What will its overall performance be in Big \u201cO\u201d notation for the performance as N approaches \u221e.  You must support your answer analytically to receive credit.  How do keys with the same value on algorithm entry appear when the sort is complete?\" </p>\n\n<pre><code>//Sort Grades in ascending order by locating grade[0], then grade[1], etc.\n   void AscendingSort( int intArray[ ], int numInt){\n    for(int j = 0; j &lt; numInt - 1; j++ ){\n      for(int k = j + 1; k &lt; numInt; k++ ){ \n          if( grades[ j ] &gt; grades[ k ] ){ \n             int temp = grades[ j ]; \n             grades[ j ] = grades[ k ];\n            grades[ k ] = temp;\n            }\n          }\n        }\n      }\n</code></pre>\n\n<p>So I believe this is a bubble sort and the complexity would be O(N) for best case which is sorted order. For worse case which is reverse order and for random order it'll be O(N^2). So how do I exactly calculate that? How do I actually calculate the number of comparisons and exchanges from the information given? Also if you can walk through the sort algorithm that would be greatly appreciated, I'm having a hard time understanding this. :( thanks in advance!!</p>\n"}, {"tags": ["c", "bash", "terminal"], "comments": [{"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 1, "creation_date": 1460591219, "post_id": 36611441, "comment_id": 60819749, "body": "How about using <code>.bash_profile</code> instead of <code>.bashrc</code>?"}, {"owner": {"reputation": 586, "user_id": 4285386, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/100000002501518/picture?type=large", "display_name": "Daniel Soutar", "link": "https://stackoverflow.com/users/4285386/daniel-soutar"}, "reply_to_user": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1460591261, "post_id": 36611441, "comment_id": 60819762, "body": "Noticed that - bash_profile also doesn&#39;t seem to be present in my home directory. Only bash_history."}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 2, "creation_date": 1460591294, "post_id": 36611441, "comment_id": 60819771, "body": "Why not create the files? Don&#39;t you have permission to write into your home directory?"}, {"owner": {"reputation": 586, "user_id": 4285386, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/100000002501518/picture?type=large", "display_name": "Daniel Soutar", "link": "https://stackoverflow.com/users/4285386/daniel-soutar"}, "reply_to_user": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 1, "creation_date": 1460591362, "post_id": 36611441, "comment_id": 60819788, "body": "As in create bash_profile or bashrc myself? Is that a good idea?"}], "answers": [{"tags": [], "owner": {"reputation": 1565, "user_id": 4000365, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/516c708ceed23546db38b6ed9ab87580?s=128&d=identicon&r=PG&f=1", "display_name": "Cybersupernova", "link": "https://stackoverflow.com/users/4000365/cybersupernova"}, "is_accepted": true, "score": 1, "last_activity_date": 1481623901, "last_edit_date": 1481623901, "creation_date": 1460591788, "answer_id": 36611538, "question_id": 36611441, "link": "https://stackoverflow.com/questions/36611441/how-to-make-an-executable-script-file-without-bashrc/36611538#36611538", "title": "How to make an executable script file without .bashrc", "body": "<p><code>mv path/to/your/executable_file /usr/local/bin/your_desied_command</code></p>\n\n<p>Example mv composer.phar /usr/local/bin/composer</p>\n"}, {"comments": [{"owner": {"reputation": 4639, "user_id": 3986708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/g0JCF.jpg?s=128&g=1", "display_name": "hgiesel", "link": "https://stackoverflow.com/users/3986708/hgiesel"}, "edited": false, "score": 0, "creation_date": 1460592617, "post_id": 36611560, "comment_id": 60820156, "body": "This is not an answer. If you want to add comments like that, consider editing your answer, or (better) add a comment to your answer."}, {"owner": {"reputation": 586, "user_id": 4285386, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/100000002501518/picture?type=large", "display_name": "Daniel Soutar", "link": "https://stackoverflow.com/users/4285386/daniel-soutar"}, "reply_to_user": {"reputation": 4639, "user_id": 3986708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/g0JCF.jpg?s=128&g=1", "display_name": "hgiesel", "link": "https://stackoverflow.com/users/3986708/hgiesel"}, "edited": false, "score": 0, "creation_date": 1460593112, "post_id": 36611560, "comment_id": 60820267, "body": "How is this not an answer to the problem exactly?"}, {"owner": {"reputation": 4639, "user_id": 3986708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/g0JCF.jpg?s=128&g=1", "display_name": "hgiesel", "link": "https://stackoverflow.com/users/3986708/hgiesel"}, "edited": false, "score": 0, "creation_date": 1460593362, "post_id": 36611560, "comment_id": 60820337, "body": "Actually you&#39;re right, I thought this would be a comment on @Cybersupernova s answer. I&#39;ll retrack my -1. However you should consider accepting his answer, as he suggested exactly what you did."}, {"owner": {"reputation": 21782, "user_id": 176646, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/HsQyV.png?s=128&g=1", "display_name": "ThisSuitIsBlackNot", "link": "https://stackoverflow.com/users/176646/thissuitisblacknot"}, "edited": false, "score": 4, "creation_date": 1460598303, "post_id": 36611560, "comment_id": 60821669, "body": "The correct approach is to create <code>~&#47;.bash_profile</code> and set the PATH variable appropriately, not to put your executable in one of the system directories. There&#39;s no problem with creating the file if it doesn&#39;t already exist."}], "tags": [], "owner": {"reputation": 586, "user_id": 4285386, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/100000002501518/picture?type=large", "display_name": "Daniel Soutar", "link": "https://stackoverflow.com/users/4285386/daniel-soutar"}, "is_accepted": false, "score": -2, "last_activity_date": 1460591959, "creation_date": 1460591959, "answer_id": 36611560, "question_id": 36611441, "link": "https://stackoverflow.com/questions/36611441/how-to-make-an-executable-script-file-without-bashrc/36611560#36611560", "title": "How to make an executable script file without .bashrc", "body": "<p>To any and all that come here:</p>\n\n<p>I just moved the script file (doesn't need a .sh extension either with this route) to the bin directory (which is a directory in root). That does the trick.</p>\n"}, {"tags": [], "owner": {"reputation": 4639, "user_id": 3986708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/g0JCF.jpg?s=128&g=1", "display_name": "hgiesel", "link": "https://stackoverflow.com/users/3986708/hgiesel"}, "is_accepted": false, "score": 1, "last_activity_date": 1460592533, "creation_date": 1460592533, "answer_id": 36611638, "question_id": 36611441, "link": "https://stackoverflow.com/questions/36611441/how-to-make-an-executable-script-file-without-bashrc/36611638#36611638", "title": "How to make an executable script file without .bashrc", "body": "<p>Best non-invasive way:</p>\n\n<pre><code>echo 'hash -p /path/to/executable executable' &gt;&gt; ~/.bashrc\n</code></pre>\n\n<p>This will add the command to your hashtable. However this means your not allowed to move the executable. (requires restarting of bash as the bashrc needs to be resourced).</p>\n"}], "owner": {"reputation": 586, "user_id": 4285386, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/100000002501518/picture?type=large", "display_name": "Daniel Soutar", "link": "https://stackoverflow.com/users/4285386/daniel-soutar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 36611538, "answer_count": 3, "score": 0, "last_activity_date": 1481623901, "creation_date": 1460591161, "last_edit_date": 1492086165, "question_id": 36611441, "link": "https://stackoverflow.com/questions/36611441/how-to-make-an-executable-script-file-without-bashrc", "title": "How to make an executable script file without .bashrc", "body": "<p>I want to be able to activate a C program anywhere in the terminal without having to type the path to it. So instead of:</p>\n\n<pre><code>[some_text]:~ [username]$ ./[insert_c_executable]\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>[some_text]:~ [username]$ Documents/Folder1/Folder2/.../[insert_c_executable]\n</code></pre>\n\n<p>That I can do something like this, like the programs <code>ls</code> or <code>pwd</code>:</p>\n\n<pre><code>[some_text]:~ [username]$ [some_cool_app_name]\n</code></pre>\n\n<p>I've seen a useful answer at the following link: <a href=\"https://askubuntu.com/questions/229589/how-to-make-a-file-e-g-a-sh-script-executable-so-it-can-be-ran-from-termina/229592#229592?newreg=549425fc915d44d19a1e9be81f0172b7\">https://askubuntu.com/questions/229589/how-to-make-a-file-e-g-a-sh-script-executable-so-it-can-be-ran-from-termina/229592#229592?newreg=549425fc915d44d19a1e9be81f0172b7</a></p>\n\n<p>However, neither .bashrc nor bash_profile are available on my home directory (on a Mac with OS X). I can't comment on that question since I don't have enough reputation. Any help would be greatly appreciated!</p>\n"}, {"tags": ["c", "multithreading", "posix", "semaphore"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 2, "creation_date": 1460589528, "post_id": 36611180, "comment_id": 60819209, "body": "What is the return value of <code>sem_open(&quot;semaphore&quot;, O_CREAT, 0644, 1);</code>?"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1460589778, "post_id": 36611180, "comment_id": 60819292, "body": "Have you looked at the manpage for <code>sem_open()</code>, especially what the meaning of the return value is?"}, {"owner": {"reputation": 154, "user_id": 1634317, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8e6df1fdd2be3326c0acc834a2fb63da?s=128&d=identicon&r=PG", "display_name": "Semantics", "link": "https://stackoverflow.com/users/1634317/semantics"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1460590006, "post_id": 36611180, "comment_id": 60819362, "body": "It is not equal to SEM_FAILED"}, {"owner": {"reputation": 154, "user_id": 1634317, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8e6df1fdd2be3326c0acc834a2fb63da?s=128&d=identicon&r=PG", "display_name": "Semantics", "link": "https://stackoverflow.com/users/1634317/semantics"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1460590466, "post_id": 36611180, "comment_id": 60819517, "body": "@EOF thanks for pointing out the problem. Yes, I didnt initialize sem_t* to sem_open. However, after initializing I do get right results, but when I increase the count to 3 or 4, i still get right results. I was expecting otherwise, because now each thread is capable of using sem_wait"}, {"owner": {"reputation": 154, "user_id": 1634317, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8e6df1fdd2be3326c0acc834a2fb63da?s=128&d=identicon&r=PG", "display_name": "Semantics", "link": "https://stackoverflow.com/users/1634317/semantics"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1460590562, "post_id": 36611180, "comment_id": 60819545, "body": "Modified the question with the new query, as the old one was syntactically wrong."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1460590771, "post_id": 36611180, "comment_id": 60819597, "body": "Please don&#39;t just edit the code. Post the new code <i>in addition</i> to the old code. The bug also was <i>not</i> a syntax-error. Finally, if your semaphore is not initialized with a count of one, the behavior is undefined due to unsynchronized, non-readonly, non-atomic access to shared objects. The program may <i>appear</i> to work correctly, but it is not. One thing to remember is that <code>printf()</code> actually needs a lock, so this call may sometimes hide your error."}, {"owner": {"reputation": 154, "user_id": 1634317, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8e6df1fdd2be3326c0acc834a2fb63da?s=128&d=identicon&r=PG", "display_name": "Semantics", "link": "https://stackoverflow.com/users/1634317/semantics"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1460590834, "post_id": 36611180, "comment_id": 60819615, "body": "printf() is under the semaphore lock."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1460590893, "post_id": 36611180, "comment_id": 60819629, "body": "<code>printf()</code> <i>takes</i> a lock internally, since it is specified as thread-safe, but certainly will not be atomic in itself."}, {"owner": {"reputation": 154, "user_id": 1634317, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8e6df1fdd2be3326c0acc834a2fb63da?s=128&d=identicon&r=PG", "display_name": "Semantics", "link": "https://stackoverflow.com/users/1634317/semantics"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1460590972, "post_id": 36611180, "comment_id": 60819660, "body": "but I am flushing out the stdout in the lock itself.."}, {"owner": {"reputation": 154, "user_id": 1634317, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8e6df1fdd2be3326c0acc834a2fb63da?s=128&d=identicon&r=PG", "display_name": "Semantics", "link": "https://stackoverflow.com/users/1634317/semantics"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1460590998, "post_id": 36611180, "comment_id": 60819673, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/109094/discussion-between-semantics-and-eof\">continue this discussion in chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 154, "user_id": 1634317, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8e6df1fdd2be3326c0acc834a2fb63da?s=128&d=identicon&r=PG", "display_name": "Semantics", "link": "https://stackoverflow.com/users/1634317/semantics"}, "edited": false, "score": 0, "creation_date": 1460592479, "post_id": 36611618, "comment_id": 60820118, "body": "what is this code suppose to do? I mean I can read and try to understand, but what exactly is the point. Also, in sem_open, you didnt specify the count. Does it compile without warning?"}, {"owner": {"reputation": 10563, "user_id": 1104328, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/df0790774838286ad0d93567ae1fcf56?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/1104328/harry"}, "reply_to_user": {"reputation": 154, "user_id": 1634317, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8e6df1fdd2be3326c0acc834a2fb63da?s=128&d=identicon&r=PG", "display_name": "Semantics", "link": "https://stackoverflow.com/users/1634317/semantics"}, "edited": false, "score": 0, "creation_date": 1460610449, "post_id": 36611618, "comment_id": 60825148, "body": "@Semantics I&#39;ve updated the code to make it a bit more explanatory. I hope this helps clear up everything. Ping me if you need to know anything more."}], "tags": [], "owner": {"reputation": 10563, "user_id": 1104328, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/df0790774838286ad0d93567ae1fcf56?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/1104328/harry"}, "is_accepted": false, "score": 0, "last_activity_date": 1460610382, "last_edit_date": 1460610382, "creation_date": 1460592383, "answer_id": 36611618, "question_id": 36611180, "link": "https://stackoverflow.com/questions/36611180/binary-semaphore-to-maintain-concurrency/36611618#36611618", "title": "Binary semaphore to maintain concurrency", "body": "<p>I'll get to the code in a bit that proves you had a race condition. I'll add a couple of different ways to trigger it so you can see how this works. I'm doing this on Linux and passing -std=gnu99 as a param to gcc ie</p>\n\n<pre><code>gcc -Wall -pedantic -lpthread -std=gnu99 semaphore.c -o semtex\n</code></pre>\n\n<p>Note. In your original example (assuming Linux) one fatal mistake you had was not removing the semaphore. If you run the following command you might see some of these sitting around on your machine</p>\n\n<pre><code>ls -la /dev/shm/sem.*\n</code></pre>\n\n<p>You need to make sure that there are no old semaphore sitting on the filesystem before running your program or you end up picking up the last settings from the old semaphore. You need to use <code>sem_unlink</code> to clean up.</p>\n\n<p>To run it please use the following.</p>\n\n<pre><code>rm /dev/shm/sem.semtex;./semtex\n</code></pre>\n\n<p>I'm deliberately making sure that the semaphore is not there before running because if you have a DEADLOCK it can be left around and that causes all sorts of problems when testing. </p>\n\n<blockquote>\n  <p>Now, when I opened the sempahore, I made the count 3. I was expecting\n  that this wouldn't work, and I would get race condition, because each\n  thread is now capable of decrementing the count.</p>\n</blockquote>\n\n<p>You had a race condition but sometimes C is so damned fast things can <b>appear</b> to work because your program can get everything it needs done in the time the OS has allocated to the thread ie the OS didn't preempt it at an important point. </p>\n\n<p>This is one of those cases, the race condition is there you just need to squint a little bit to see it. In the following code you can tweak some parameters to see the a deadlock, correct usage and Undefined Behavior. </p>\n\n<pre><code>#define INITIAL_SEMAPHORE_VALUE CORRECT\n</code></pre>\n\n<p>The value <code>INITIAL_SEMAPHORE_VALUE</code> can take three values...</p>\n\n<pre><code>#define DEADLOCK  0\n#define CORRECT   1\n#define INCORRECT 2\n</code></pre>\n\n<p>I hope they're self explanatory. You can also use two methods to cause the race condition to blow up the program.</p>\n\n<pre><code>#define METHOD sleep\n</code></pre>\n\n<p>Set the <code>METHOD</code> to <code>spin</code> and you can play with the <code>SPIN_COUNT</code> and find out how many times the loop can run before you actually see a problem, this is C, it can get a lot done before it gets preempted. The code has most of the rest of the information you need in it.     </p>\n\n<pre><code>#include &lt;assert.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;semaphore.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/stat.h&gt; \n#include &lt;unistd.h&gt;\n#define DEADLOCK  0 // DEADLOCK\n#define CORRECT   1 // CORRECT\n#define INCORRECT 2 // INCORRECT\n/*\n * Change the following values to observe what happen.\n */\n#define INITIAL_SEMAPHORE_VALUE CORRECT\n//The next value provides to two different ways to trigger the problem, one\n//using a tight loop and the other using a system call.\n#define METHOD sleep\n\n#if (METHOD == spin)\n/* You need to increase the SPIN_COUNT to a value that's big enough that the\n * kernel preempts the thread to see it fail. The value set here worked for me \n * in a VM but might not work for you, tweak it. */\n#define SPIN_COUNT 1000000\n#else \n/* The reason we can use such a small time for USLEEP is because we're making\n * the kernel preempt the thread by using a system call.*/\n#define USLEEP_TIME 1\n#endif\n#define TOT_THREADS 10\n\nstatic int g = 0;\nstatic int ret = 1729;\nsem_t *semaphore;\n\nvoid *myThreadFun(void *vargp) {\n  int myid = (int)vargp;\n  int w = 0;\n  static int s = 0;\n  if((w = sem_wait(semaphore)) != 0) {\n    fprintf(stderr, \"Error: %s\\n\", strerror(errno));\n    abort();\n  };\n/* This is the interesting part... Between updating `s` and `g` we add\n * a delay using one of two methods. */\n  s++;\n#if ( METHOD == spin )\n  int spin = 0;\n  while(spin &lt; SPIN_COUNT) {\n    spin++;\n  }\n#else\n  usleep(USLEEP_TIME);\n#endif\ng++;\n  if(s != g) {\n    fprintf(stderr, \"Fatal Error: s != g in thread: %d, s: %d, g: %d\\n\", myid, s, g);\n    abort();\n  } \n  printf(\"Thread ID: %d, Static: %d, Global: %d\\n\", myid, s, g);\n  // It's a false sense of security if you think the assert will fail on a race\n  // condition when you get the params to sem_open wrong It might not be\n  // detected.\n  assert(s == g);\n  if((w = sem_post(semaphore)) != 0) {\n    fprintf(stderr, \"Error: %s\\n\", strerror(errno));\n    abort();\n  };\n  return &amp;ret;\n} \n\nint main(void){\n  int i;\n  void *status;\n  const char *semaphore_name = \"semtex\";\n  pthread_t tids[TOT_THREADS];\n  if((semaphore = sem_open(semaphore_name, O_CREAT, 0644, INITIAL_SEMAPHORE_VALUE)) == SEM_FAILED) {\n    fprintf(stderr, \"Fatal Error: %s\\n\", strerror(errno));\n    abort();\n  }\n  for (i = 0; i &lt; TOT_THREADS; i++) {\n    pthread_create(&amp;tids[i], NULL, myThreadFun, (void *) (intptr_t) i);\n  }\n  for (i = 0; i &lt; TOT_THREADS; i++) {\n    pthread_join(tids[i], &amp;status);\n    assert(*(int*)status == 1729);\n  }\n  /*The following line was missing from your original code*/\n  sem_unlink(semaphore_name);\n  pthread_exit(0);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 154, "user_id": 1634317, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8e6df1fdd2be3326c0acc834a2fb63da?s=128&d=identicon&r=PG", "display_name": "Semantics", "link": "https://stackoverflow.com/users/1634317/semantics"}, "edited": false, "score": 0, "creation_date": 1460593339, "post_id": 36611702, "comment_id": 60820328, "body": "First of all this statement, &quot;you seem to be suggesting that there would be a data race inherent in more than one thread concurrently performing a sem_wait() on a semaphore whose value is initially greater than 1 (otherwise which counter are you talking about?). But that&#39;s utter nonsense.&quot;  You are calling it utter nonsense, and later contradicting it by saying that modification of global variables is a concern. That is what I initially presumed in the statement which you called nonsense."}, {"owner": {"reputation": 154, "user_id": 1634317, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8e6df1fdd2be3326c0acc834a2fb63da?s=128&d=identicon&r=PG", "display_name": "Semantics", "link": "https://stackoverflow.com/users/1634317/semantics"}, "edited": false, "score": 0, "creation_date": 1460593372, "post_id": 36611702, "comment_id": 60820341, "body": "Secondly, making the count 0 during sem_open doesnt cause the deadlock, i still get the output."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 154, "user_id": 1634317, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8e6df1fdd2be3326c0acc834a2fb63da?s=128&d=identicon&r=PG", "display_name": "Semantics", "link": "https://stackoverflow.com/users/1634317/semantics"}, "edited": false, "score": 1, "creation_date": 1460593518, "post_id": 36611702, "comment_id": 60820371, "body": "What you seem to be suggesting, and what is nonsensical, is that concurrent calls to <code>sem_post()</code> involve a data race, &quot;because each thread is now capable of decrementing the count&quot;.  No count is decremented anywhere in your code, except for the semaphore&#39;s count of available leases."}, {"owner": {"reputation": 154, "user_id": 1634317, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8e6df1fdd2be3326c0acc834a2fb63da?s=128&d=identicon&r=PG", "display_name": "Semantics", "link": "https://stackoverflow.com/users/1634317/semantics"}, "edited": false, "score": 0, "creation_date": 1460593583, "post_id": 36611702, "comment_id": 60820381, "body": "By saying decrementing the count, I meant semaphore&#39;s count of available leases only. What else you think I would mean by decrementing the count? And since each thread is capable of decrementing the available leases, they all hold the capability of modifying the global variables"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 154, "user_id": 1634317, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8e6df1fdd2be3326c0acc834a2fb63da?s=128&d=identicon&r=PG", "display_name": "Semantics", "link": "https://stackoverflow.com/users/1634317/semantics"}, "edited": false, "score": 0, "creation_date": 1460593740, "post_id": 36611702, "comment_id": 60820426, "body": "@Semantics, as I supposed, then.  That multiple threads can decrement the semaphore&#39;s count does not create any data race.  The semaphore implementation is thread safe."}, {"owner": {"reputation": 154, "user_id": 1634317, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8e6df1fdd2be3326c0acc834a2fb63da?s=128&d=identicon&r=PG", "display_name": "Semantics", "link": "https://stackoverflow.com/users/1634317/semantics"}, "edited": false, "score": 0, "creation_date": 1460593839, "post_id": 36611702, "comment_id": 60820447, "body": "What?? You yourself stated that they might run concurrently and modification of shared variables might be a concern."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 154, "user_id": 1634317, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8e6df1fdd2be3326c0acc834a2fb63da?s=128&d=identicon&r=PG", "display_name": "Semantics", "link": "https://stackoverflow.com/users/1634317/semantics"}, "edited": false, "score": 2, "creation_date": 1460593855, "post_id": 36611702, "comment_id": 60820452, "body": "@Semantics, as for your threads not blocking, you are using a <i>named</i> semaphore which you never remove.  Such a semaphore is persistent, so you keep reopening the same one.  Its value is set only when you create it.  I will clarify this point in my answer."}, {"owner": {"reputation": 154, "user_id": 1634317, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8e6df1fdd2be3326c0acc834a2fb63da?s=128&d=identicon&r=PG", "display_name": "Semantics", "link": "https://stackoverflow.com/users/1634317/semantics"}, "edited": false, "score": 0, "creation_date": 1460594207, "post_id": 36611702, "comment_id": 60820527, "body": "I agree with your explanation about count 0. if i use sem_init, which is unnamed sempahore, sem_wait gives me -1 and fails."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 154, "user_id": 1634317, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8e6df1fdd2be3326c0acc834a2fb63da?s=128&d=identicon&r=PG", "display_name": "Semantics", "link": "https://stackoverflow.com/users/1634317/semantics"}, "edited": false, "score": 0, "creation_date": 1460594256, "post_id": 36611702, "comment_id": 60820535, "body": "@Semantics, modifying the semaphore&#39;s count via the functions provided for that purpose is always thread safe.  This is a requirement on those functions and on the semaphore implementation.  It is completely different from incrementing shared variables <code>s</code> and <code>g</code>."}, {"owner": {"reputation": 154, "user_id": 1634317, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8e6df1fdd2be3326c0acc834a2fb63da?s=128&d=identicon&r=PG", "display_name": "Semantics", "link": "https://stackoverflow.com/users/1634317/semantics"}, "edited": false, "score": 0, "creation_date": 1460594508, "post_id": 36611702, "comment_id": 60820599, "body": "My concern here is not the inherent implementation, but the effect it would have on the global variables. And that is what I am trying to point out in the question. I am not doubting the semaphore implementation, No. I am just trying to understand as to why I didnt see race condition. But you have addressed it as well. Thank you."}, {"owner": {"reputation": 82430, "user_id": 17833, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ExIEf.png?s=128&g=1", "display_name": "Petesh", "link": "https://stackoverflow.com/users/17833/petesh"}, "edited": false, "score": 1, "creation_date": 1460594848, "post_id": 36611702, "comment_id": 60820692, "body": "Bear in mind, named semaphores persist beyond the life of the process - and if you happen to be using OSX the behaviour is inconsistent - you have to sem_unlink or else the count doesn&#39;t get reset even with a fresh call to sem_open O_CREAT."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 5, "last_activity_date": 1460595137, "last_edit_date": 1460595137, "creation_date": 1460593071, "answer_id": 36611702, "question_id": 36611180, "link": "https://stackoverflow.com/questions/36611180/binary-semaphore-to-maintain-concurrency/36611702#36611702", "title": "Binary semaphore to maintain concurrency", "body": "<blockquote>\n  <p>Now, when I opened the sempahore, I made the count 3. I was expecting that this wouldnt work, and I would get race condition, because each thread is now capable of decrementing the count.</p>\n</blockquote>\n\n<p>And how do you judge that there isn't any race?  Observing output consistent with what you could rely upon in the absence of a data race in no way proves that there isn't a data race.  It merely fails provide any evidence of one.</p>\n\n<p>However, you seem to be suggesting that there would be a data race <em>inherent</em> in more than one thread concurrently performing a <code>sem_wait()</code> on a semaphore whose value is initially greater than 1 (otherwise which counter are you talking about?).  But that's utter nonsense.  You're talking about a <em>semaphore</em>.  It's a synchronization object.  Such objects and the functions that manipulate them are the basis for thread synchronization.  They themselves are either completely thread safe or terminally buggy.</p>\n\n<p>Now, you are correct that you open the semaphore with an initial count sufficient to avoid any of your threads blocking in <code>sem_wait()</code>, and that therefore they can all run concurrently in the whole body of <code>myThreadFun()</code>.  You have not established, however, that they in fact <em>do</em> run concurrently.  There are several reasons why they might not do.  If they do run concurrently, then the incrementing of shared variables <code>s</code> and <code>g</code> is indeed of concern, but again, even if you see no signs of a data race, that doesn't mean there isn't one.</p>\n\n<p>Everything else aside, the fact that your threads all call <code>sem_wait()</code>, <code>sem_post()</code>, and <code>printf()</code> induces some synchronization in the form of memory barriers, which would reduce the likelihood of observing anomalous effects on <code>s</code> and <code>g</code>.  <code>sem_wait()</code> and <code>sem_post()</code> must contain memory barriers in order to function correctly, regardless of the semaphore's current count.  <code>printf()</code> calls are required to use locking to protect the state of the stream from corruption in multi-threaded programs, and it is reasonable to suppose that this will require a memory barrier.</p>\n\n<blockquote>\n  <p>Is there something wrong with the implementation?</p>\n</blockquote>\n\n<p>Yes.  It is not properly synchronized.  Initialize the semaphore with count 1 so that the modifications of <code>s</code> and <code>g</code> occur only while exactly one thread has the semaphore locked.</p>\n\n<blockquote>\n  <p>Also, if I make the count 0 during sem_open, wouldnt that initiate a deadlock condition, because all the threads should be blocked on sem_wait.</p>\n</blockquote>\n\n<p>If the semaphore has count 0 before any of the additional threads are started, then yes.  It is therefore inappropriate to open the semaphore with count 0, unless you also subsequently post to it before starting the threads.  But you are using a <em>named</em> semaphore.  These persist until removed, and you never remove it.  The count you specify to <code>sem_open()</code> has no effect unless a new semaphore needs to be created; when an existing semaphore is opened, its count is unchanged.</p>\n\n<p>Also, do have the main thread join all the others before it terminates.  It's not inherently wrong not to do so, but in most cases it's required for the semantics you want.</p>\n"}], "owner": {"reputation": 154, "user_id": 1634317, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8e6df1fdd2be3326c0acc834a2fb63da?s=128&d=identicon&r=PG", "display_name": "Semantics", "link": "https://stackoverflow.com/users/1634317/semantics"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 787, "favorite_count": 0, "accepted_answer_id": 36611702, "answer_count": 2, "score": 0, "last_activity_date": 1460610382, "creation_date": 1460589408, "last_edit_date": 1460590540, "question_id": 36611180, "link": "https://stackoverflow.com/questions/36611180/binary-semaphore-to-maintain-concurrency", "title": "Binary semaphore to maintain concurrency", "body": "<p>I was trying to implement a multi-threaded program using binary semaphore. Here is the code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;semaphore.h&gt;\n\nint g = 0;\n\nsem_t *semaphore;\n\nvoid *myThreadFun(void *vargp)\n{\n    int myid = (int)vargp;\n    static int s = 0;\n    sem_wait(semaphore);\n    ++s; ++g;\n    printf(\"Thread ID: %d, Static: %d, Global: %d\\n\", myid, s, g);\n    fflush(stdout);\n    sem_post(semaphore);\n    pthread_exit(0);\n}\n\nint main()\n{   \n\n    int i;\n    pthread_t tid;\n    if ((semaphore = sem_open(\"/semaphore\", O_CREAT, 0644, 3))==SEM_FAILED) {\n    printf(\"semaphore initialization failed\\n\");\n    }\n\n\n    for (i = 0; i &lt; 3; i++) {\n        pthread_create(&amp;tid, NULL, myThreadFun, (void *)i);\n    }\n\n    pthread_exit(NULL);\n    return 0; \n}\n</code></pre>\n\n<p>Now, when I opened the sempahore, I made the count 3. I was expecting that this wouldnt work, and I would get race condition, because each thread is now capable of decrementing the count. </p>\n\n<p>Is there something wrong with the implementation? Also, if I make the count 0 during sem_open, wouldnt that initiate a deadlock condition, because all the threads should be blocked on sem_wait.</p>\n"}, {"tags": ["c", "for-loop", "malloc", "dynamic-programming"], "comments": [{"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 1, "creation_date": 1460589388, "post_id": 36611036, "comment_id": 60819148, "body": "Why not use an array instead of <code>n1</code> to <code>n8</code>?"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1460589409, "post_id": 36611036, "comment_id": 60819157, "body": "Trying to understand.. so I&#39;ll give you 8 letters, that means there are 8! == 40320 different permutations of those letters, and you want to find which permutation creates the longest word?"}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1460589535, "post_id": 36611036, "comment_id": 60819212, "body": "The buffer seems too small. If there are 8 characters in each lines, an newline character after the first line will be in the next read and it may cause some trouble."}, {"owner": {"reputation": 17, "user_id": 5976826, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2ca454a285711eb723a502ca430189fb?s=128&d=identicon&r=PG&f=1", "display_name": "Ulysses", "link": "https://stackoverflow.com/users/5976826/ulysses"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1460589660, "post_id": 36611036, "comment_id": 60819258, "body": "@yano Yeah. I have a previous part of the program that generates eight random vowels and/or consonants. This is what the exampleLetters are for and I want to compare these letters through a dictionary file to find the longest words possible."}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 1, "creation_date": 1460589662, "post_id": 36611036, "comment_id": 60819259, "body": "<a href=\"http://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\"><code>!feof(fp)</code> is a bad loop condition</a>. You should check if <code>fgets()</code> was successful before using &quot;the data read&quot;."}, {"owner": {"reputation": 17, "user_id": 5976826, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2ca454a285711eb723a502ca430189fb?s=128&d=identicon&r=PG&f=1", "display_name": "Ulysses", "link": "https://stackoverflow.com/users/5976826/ulysses"}, "reply_to_user": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1460589808, "post_id": 36611036, "comment_id": 60819301, "body": "@MikeCAT An array would be more efficient. My main focus is comparing the letters with the words in the file and a larger buffer would be better. Thanks!"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1460590068, "post_id": 36611036, "comment_id": 60819386, "body": "Will all 8 letters have to be used or can there be some unused extras? Hardest part to me would be coming up with an algorithm that iterates through all possible permutations of the letters, although I&#39;m sure there are some folks here that could get that going no sweat."}, {"owner": {"reputation": 17, "user_id": 5976826, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2ca454a285711eb723a502ca430189fb?s=128&d=identicon&r=PG&f=1", "display_name": "Ulysses", "link": "https://stackoverflow.com/users/5976826/ulysses"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1460590268, "post_id": 36611036, "comment_id": 60819458, "body": "@yano Unfortunately i have to use all eight letters. The file only contains eight letter words at most too"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1460590555, "post_id": 36611036, "comment_id": 60819544, "body": "I&#39;d say that&#39;s fortunate. You don&#39;t have to compare partial strings then, that part will be straightforward. You need a function that spits out the next permutation of your characters, then just <code>strcmp</code> that with each line in the dictionary. Getting the next permutation is the question mark for me."}], "answers": [{"comments": [{"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1460643011, "post_id": 36612527, "comment_id": 60847282, "body": "figured there was probably a better way than brute force permutations ... nice!"}], "tags": [], "owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "is_accepted": false, "score": 1, "last_activity_date": 1460599101, "creation_date": 1460599101, "answer_id": 36612527, "question_id": 36611036, "link": "https://stackoverflow.com/questions/36611036/c-programming-finding-the-longest-word-from-a-dictionary-with-given-characters/36612527#36612527", "title": "C Programming: Finding the Longest Word from A Dictionary with Given Characters", "body": "<p>You don't need to consider permutations of the letters.  All you do is stick them in an array and sort them (all lower-case).</p>\n\n<p>When you read your dictionary, you do the same thing: Keep the original word, and make a \"key\" by sorting the letters (again, all lower-case).</p>\n\n<p>If a letter can be used more than once then you would reduce these \"keys\" (as well as your input \"key\") by removing duplicate characters.</p>\n\n<p>Now you can use a simple search through your dictionary looking for the longest word whose \"key\" matches (or is a subset of) yours.  Because everything is sorted, you can use <code>strstr</code> to look for a full or partial match:</p>\n\n<pre><code>if( NULL != strstr( word_key, available_chars_key ) ) ...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 17, "user_id": 5976826, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2ca454a285711eb723a502ca430189fb?s=128&d=identicon&r=PG&f=1", "display_name": "Ulysses", "link": "https://stackoverflow.com/users/5976826/ulysses"}, "is_accepted": true, "score": 1, "last_activity_date": 1460840726, "creation_date": 1460840726, "answer_id": 36669736, "question_id": 36611036, "link": "https://stackoverflow.com/questions/36611036/c-programming-finding-the-longest-word-from-a-dictionary-with-given-characters/36669736#36669736", "title": "C Programming: Finding the Longest Word from A Dictionary with Given Characters", "body": "<pre><code>int amount;\nchar **longestWords;    //Used a double pointer to allocate memory based on how many strings there where and the size of each string\nchar exampleLetters[] = \"nailshob\";     //These are a group of example letters that will be randomly generated in a previous part of the program\nchar *fileName = \"D:\\\\webster.txt\"; \n\nint initialiseWords(int num);\nint copyWords(int val);\n\nint main()\n{\n    int i, j, k, len;\n    long int n[8] = { 0 };     //Used an array as it was suggested to be more efficient than 8 integers\n    char line[12];\n    char temp[9];\n\n    FILE *fp = fopen(fileName, \"r\");\n\n    if (fp == NULL) {\n        printf(\"Error opening file!\\n\");\n    }\n    else\n    {\n        while (fgets(line, sizeof(line), fp)) {\n            k = 0;\n            len = strlen(line) - 1    //-1 because of '\\n'\n\n            strcpy(temp, exampleLetters);    //Copied the letters to a temporary string\n\n            for (i = 0; i &lt; len; i++)\n            {\n                for (j = 0; j &lt; 8; j++)\n                {\n                    if (line[i] == temp[j])\n                    {\n                        temp[j] = NULL;    //If the character is found I eliminate it from the temporary string to prevent duplicated letters from affecting the results\n                        k++;    //k is incremented every time a letter in the temporary string is the same as the letter in line\n                        break;\n                    }\n                }\n\n            for (i = 8; i &gt; 0; i--)\n            {\n                if (k == i &amp;&amp; len == i) {    //If k is equal to i and the same length as i an n value is incremented e.g. n[4]++ if a 5 letter word is found. The reason I also use strlen in the if condition is because sometimes it may find a word has the same mutual amount of letters but it is a longer length e.g. the longest word for \"nailhobq\" is hobnail but it may also increment with hobnails\n                    n[i - 1]++;\n                    break;\n                }  \n            }\n        }\n\n        for (i = 7; i &gt;= 0; i--)\n        {\n            if (n[i] != 0)\n            {\n                initialiseWords(n[i]);    //Allocates memory to **longestWords based on the size of n[i]\n                copyWords(i);    //This function is then used to copy the longest words to **longestWords\n                break;\n            }\n        }\n    }\n\n    fclose(fp);\n\n    return 1;\n}\n\nint initialiseWords(int num)\n{\n    int i;\n\n    longestWords = (char**)malloc(num * sizeof(char*));\n\n    for (i = 0; i &lt; num; i++)\n    {\n        longestWords[i] = (char*)malloc((9)* sizeof(char));\n    }\n\n    return 1;\n}\n\nint copyWords(int val)\n{\n    int i, j, k, l;\n    char line[12];\n    char temp[9];\n\n    FILE *fp = fopen(fileName, \"r\");\n\n    if (fp == NULL) {\n        printf(\"Error opening file!\\n\");\n    }\n    else\n    {\n        l = 0;\n\n        while (fgets(line, 12, fp)) {\n            k = 0;\n            strcpy(temp, exampleLetters);\n\n            for (i = 0; i &lt; strlen(line)-1; i++)\n            {\n                for (j = 0; j &lt; 8; j++)\n                {\n                    if (line[i] == temp[j])\n                    {\n                        temp[j] = NULL;\n                        k++;\n                        break;\n                    }\n                }\n            }\n\n            if (k == val + 1 &amp;&amp; (strlen(line) - 1) == val + 1)\n            {\n                strcpy(longestWords[l], line);    //Same process as the original function until here. I copy the words that represented the highest values of i in n[i] to **longestWords \n                l++;\n            }\n        }\n    }\n\n    fclose(fp);\n\n    return 1;\n}\n</code></pre>\n\n<p>I know it isn't the most efficient method but it works to my understanding. I decided to create a temporary string in the while loop that copied over exampleLetters[]. Every time line found a common character with the temporary string, I incremented k and changed the character in the temporary string to NULL to prevent duplicate characters from affecting the results. Next I compared with k and the length of line with the highest value of i and worked down. If it found a match it would increment the appropriate n[]. Now that I knew what was the highest value of n[], therefore the highest lettered word, I allocated memory based on how many of n lettered words there were and used the copyWords(int val) function to copy over the words to **longestWords. Thanks for those who helped me.</p>\n"}], "owner": {"reputation": 17, "user_id": 5976826, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2ca454a285711eb723a502ca430189fb?s=128&d=identicon&r=PG&f=1", "display_name": "Ulysses", "link": "https://stackoverflow.com/users/5976826/ulysses"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 854, "favorite_count": 0, "accepted_answer_id": 36669736, "answer_count": 2, "score": 0, "last_activity_date": 1460840726, "creation_date": 1460588477, "question_id": 36611036, "link": "https://stackoverflow.com/questions/36611036/c-programming-finding-the-longest-word-from-a-dictionary-with-given-characters", "title": "C Programming: Finding the Longest Word from A Dictionary with Given Characters", "body": "<p>This is a minimised repost of a question i asked earlier. I am a beginner in C programming. I am attempting to create a Countdown program but in which the user selects eight consonants and/or vowels and has to devise the longest word from these letters. The computer will then read a dictionary file and find the longest possible words. This function is a part of the program in which I compare the countdown letters with a dictionary file.</p>\n\n<pre><code>#include \"stdafx.h\"\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n\nint main()\n{\n    int i, j, n;\n    long int n1 = 0, n2 = 0, n3 = 0, n4 = 0, n5 = 0, n6 = 0, n7 = 0, n8 = 0;\n    char line[9];\n    char exampleLetters[] = \"feacnehp\";\n    char *fileName = \"D:\\\\webster.txt\";     //Dictionary file\n\n   FILE *fp = fopen(fileName, \"r\");\n\n   if (fp == NULL) {\n       printf(\"Error opening file!\\n\");\n    }\n    else\n    {\n       while (!feof(fp)) {\n            fgets(line, 9, fp);\n\n            n = 0;\n\n            for (i = 0; i &lt;  8; i++) {\n\n                for (j = 0; j &lt; 8; j++) {\n                    if (line[i] == exampleLetters[j]) n++;\n                }\n            }\n\n            if (n == 1) n1++;   //These values are incremented everytime a word of that amount of letters is found i.e. n1++ when a one letter word is found\n            if (n == 2) n2++;\n            if (n == 3) n3++;\n            if (n == 4) n4++;\n            if (n == 5) n5++;\n            if (n == 6) n6++;\n            if (n == 7) n7++;\n            if (n == 8) n8++;\n        }\n\n        printf(\"%li %li %li %li %li %li %li %li\\n\", n1, n2, n3, n4, n5, n6, n7, n8);    //This is irrelevant but just to display the amount of each number of words\n    }\n\n    fclose(fp);\n\n    return 1;\n}\n</code></pre>\n\n<p>My problem is in the readFile function. I'm not sure how to compare the countdown letters with the dictionary file. I am able to count the amount of words that match with the letters. Should I read the words in and use malloc to continually allocate memory or is there a better alternative? </p>\n"}, {"tags": ["c", "reserved-words"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 2, "creation_date": 1460588657, "post_id": 36611021, "comment_id": 60818897, "body": "You could always Google it, same as for any variable (including ones that don&#39;t have double underscores)"}], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 6201259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00c43bca3eb5619e97f9aff3ce081ba0?s=128&d=identicon&r=PG&f=1", "display_name": "DDC", "link": "https://stackoverflow.com/users/6201259/ddc"}, "edited": false, "score": 1, "creation_date": 1460591460, "post_id": 36611077, "comment_id": 60819827, "body": "Thanks Seprum - I&#39;m assuming this is gcc-specific, i.e. if I tried compiling this on a Microsoft compiler, it wouldn&#39;t work, right?"}], "tags": [], "owner": {"reputation": 715, "user_id": 4147225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e58b3fa5297e23a66505477b49de967?s=128&d=identicon&r=PG", "display_name": "Vladyslav", "link": "https://stackoverflow.com/users/4147225/vladyslav"}, "is_accepted": false, "score": 2, "last_activity_date": 1460588703, "creation_date": 1460588703, "answer_id": 36611077, "question_id": 36611021, "link": "https://stackoverflow.com/questions/36611021/where-to-finding-the-precise-meaning-of-a-double-underscore-variable/36611077#36611077", "title": "Where to finding the precise meaning of a double underscore variable", "body": "<p>It's a <a href=\"https://gcc.gnu.org/onlinedocs/cpp/Variadic-Macros.html\" rel=\"nofollow\">variadic macros</a>. It allows the function to take variable ammout of arguments. You can read more about functions with variable arguments <a href=\"http://www.tutorialspoint.com/cprogramming/c_variable_arguments.htm\" rel=\"nofollow\">here</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 107, "user_id": 6201259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00c43bca3eb5619e97f9aff3ce081ba0?s=128&d=identicon&r=PG&f=1", "display_name": "DDC", "link": "https://stackoverflow.com/users/6201259/ddc"}, "edited": false, "score": 0, "creation_date": 1460593088, "post_id": 36611348, "comment_id": 60820261, "body": "Thanks, Keith, for the thorough explanation. Even though the gcc manual is specifically on gcc, a large part applies to other popular compilers, too, right? I&#39;m reading the part on the preprocessor and it seems the behavior is similar for the Microsoft Visual Studio compiler."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 107, "user_id": 6201259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00c43bca3eb5619e97f9aff3ce081ba0?s=128&d=identicon&r=PG&f=1", "display_name": "DDC", "link": "https://stackoverflow.com/users/6201259/ddc"}, "edited": false, "score": 1, "creation_date": 1460593256, "post_id": 36611348, "comment_id": 60820301, "body": "@DDC: The section of the gcc manual that discusses <code>__VA_ARGS__</code> clearly says that it&#39;s an ISO C standard feature. gcc has another mechanism for variadic macros with a different syntax; it predates C99. Some compilers (clang, for example) are deliberately compatible with gcc; MSVS is not."}], "tags": [], "owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "is_accepted": true, "score": 1, "last_activity_date": 1460590521, "creation_date": 1460590521, "answer_id": 36611348, "question_id": 36611021, "link": "https://stackoverflow.com/questions/36611021/where-to-finding-the-precise-meaning-of-a-double-underscore-variable/36611348#36611348", "title": "Where to finding the precise meaning of a double underscore variable", "body": "<p>There is no general rule for determining the meaning of an identifier (not necessarily a variable name) whose name starts with two underscores (or with an underscore and an uppercase letter; those are also reserved to the implementation).</p>\n\n<p>Some such identifiers are defined by the C standard.  Examples are <code>__FILE__</code>, <code>__LINE__</code>, <code>__STDC__</code>, <code>__STDC_VERSION__</code> (all predefined macros) and <code>__func__</code> (not a macro but an implicitly declared identifier in each function).</p>\n\n<p>You can find a draft of the C standard at <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow\">http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf</a>.  Note that the PDF encodes double underscores in an odd way so they're displayed properly, so a search for <code>__STDC__</code> will likely fail.  You can search for <code>_STDC_</code> instead.</p>\n\n<p>Any such identifiers not mentioned in the standard may be defined by the implementation (either the compiler or the runtime library).  Consult your implementation's documentation.  Be aware that some such identifiers might not be documented if the implementation uses them only for its own internal purposes.</p>\n\n<p>As for <code>__VA_ARGS__</code>, that's defined by the C standard, in section 6.10.3.1.  It's used in variadic macros (macros that can accept a variable number of arguments). It's also documented in the gcc manual.</p>\n"}], "owner": {"reputation": 107, "user_id": 6201259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00c43bca3eb5619e97f9aff3ce081ba0?s=128&d=identicon&r=PG&f=1", "display_name": "DDC", "link": "https://stackoverflow.com/users/6201259/ddc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "accepted_answer_id": 36611348, "answer_count": 2, "score": 2, "last_activity_date": 1460590521, "creation_date": 1460588390, "last_edit_date": 1495535642, "question_id": 36611021, "link": "https://stackoverflow.com/questions/36611021/where-to-finding-the-precise-meaning-of-a-double-underscore-variable", "title": "Where to finding the precise meaning of a double underscore variable", "body": "<p>This question pertains to C. There have been many questions already on the topic of double underscore variables, e.g.,<br>\n<a href=\"https://stackoverflow.com/questions/228783/what-are-the-rules-about-using-an-underscore-in-a-c-identifier\">What are the rules about using an underscore in a C++ identifier?</a><br>\n<a href=\"https://stackoverflow.com/questions/224397/why-do-people-use-double-underscore-so-much-in-c\">Why do people use __(double underscore) so much in C++</a><br>\n<a href=\"https://stackoverflow.com/questions/10687053/meaning-of-double-underscore-in-the-beginning\">Meaning of double underscore in the beginning</a>  </p>\n\n<p>As I understand thus far, <code>__myvar</code> is reserved for use by the compiler. However, I am unsure where to find the precise meaning for such variables, and how to use them.</p>\n\n<p>For example, I am studying this block of code:</p>\n\n<pre><code>#define fatalError(...) { char str[1000]; sprintf(str, __VA_ARGS__); printf( \"%s (%s in %s, line %d)\\n\", str, __func__, __FILE__, __LINE__); exit(EXIT_FAILURE); }\n</code></pre>\n\n<p>For instance, it's not clear what <code>__VA_ARGS__</code> refers to. Since it's reserved by the compiler, and I'm using gcc, should I be searching for <code>__VA_ARGS__</code> in gcc documentation?</p>\n"}, {"tags": ["c", "casting", "constants"], "comments": [{"owner": {"reputation": 10461, "user_id": 2043536, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/65bebfc03affca934d168c23b535b463?s=128&d=identicon&r=PG", "display_name": "sircodesalot", "link": "https://stackoverflow.com/users/2043536/sircodesalot"}, "edited": false, "score": 0, "creation_date": 1460587749, "post_id": 36610899, "comment_id": 60818568, "body": "You don&#39;t need to modify anything (?)"}, {"owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "reply_to_user": {"reputation": 10461, "user_id": 2043536, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/65bebfc03affca934d168c23b535b463?s=128&d=identicon&r=PG", "display_name": "sircodesalot", "link": "https://stackoverflow.com/users/2043536/sircodesalot"}, "edited": false, "score": 2, "creation_date": 1460587812, "post_id": 36610899, "comment_id": 60818590, "body": "@sircodesalot How do you actually <i>write</i> the function without casting away the <code>const</code> in order to return a pointer?"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1460588073, "post_id": 36610899, "comment_id": 60818682, "body": "I agree with you. The return type should be <code>const char *</code>."}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1460588230, "post_id": 36610899, "comment_id": 60818747, "body": "But that change would break a huge number of existing codebases."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "reply_to_user": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1460588529, "post_id": 36610899, "comment_id": 60818850, "body": "@paddy Yes, but at the same time, this conundrum points out the flaw in the design of the <code>const</code> keyword. If the <code>haystack</code> is actually <code>const</code>, e.g. a string literal, then returning a non-const pointer from the function is just plain wrong. OTOH, if <code>haystack</code> is not <code>const</code>, then implicitly converting it to <code>const</code>, only to cast the returned pointer back to non-const, is rather pointless."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1460588974, "post_id": 36610899, "comment_id": 60818997, "body": "Declaring an a pointer argument <code>const</code> (i.e., its target) does <i>not</i> mean the target is truly constant.  All it means is that the function will not modify it.  Non-const arguments are passed to functions as const all the time.  But there are a <i>lot</i> of problems with <code>const</code>.  This is just one of many such examples."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1460589844, "post_id": 36610899, "comment_id": 60819308, "body": "@user3386109: It&#39;s not a flaw in the design of <code>const</code>. It&#39;s a flaw in the design of <code>strstr</code>. For consistency, there should be two different functions, one that works on <code>const</code> objects and one that works on non-<code>const</code> objects. (C++ does this by requiring two overloaded version of <code>strstr()</code>.)"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1460590424, "post_id": 36610899, "comment_id": 60819503, "body": "@KeithThompson The flaw in the design of <code>const</code> is that the code can freely cast it away. Hence, it has no semantic meaning. Furthermore, it&#39;s used as in-line documentation in function prototypes. It&#39;s also used to indicate that variables, e.g. string literals, may be placed in read-only memory. It&#39;s also used to mark variables as compile time constants, e.g. <code>const int N=42;</code>. That&#39;s a mishmash of incompatible uses for a single keyword, and is seriously flawed."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1460590679, "post_id": 36610899, "comment_id": 60819573, "body": "<code>const</code> means read-only, not to be confused with &quot;constant&quot;, which means evaluable at compile time. <code>const int N = 42;</code> does <i>not</i> make <code>N</code> a constant expression in C (it does in C++). It certainly does have semantic meaning; casts merely let you explicitlyi override that meaning if you need to. String literals, for historical reasons, are not <code>const</code> in C; attempting to modify them has undefined behavior but is not necessarily diagnosed."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1460591711, "post_id": 36610899, "comment_id": 60819909, "body": "@user3386109: <code>const</code> creates compile-time constants in C++, but not in C."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1460602151, "post_id": 36610899, "comment_id": 60822743, "body": "The flaw is in the design of C -- there&#39;s no way to say &quot;the result type has the same const-ness as the actual argument&quot;. C++ does this with overloading."}], "answers": [{"comments": [{"owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "edited": false, "score": 0, "creation_date": 1460590459, "post_id": 36611013, "comment_id": 60819515, "body": "The basic problem is that <code>strstr</code> predates the concept of <code>const</code> in the C language..."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "edited": false, "score": 0, "creation_date": 1460592535, "post_id": 36611013, "comment_id": 60820137, "body": "@Chris Dodd: Even if it didn&#39;t, I&#39;d say that the current interface would still be more appropriate in C than the above with two functions."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1460592615, "post_id": 36611013, "comment_id": 60820155, "body": "@AnT: How is an interface that lets you quietly violate <code>const</code> correctness more appropriate?"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 1, "creation_date": 1460594004, "post_id": 36611013, "comment_id": 60820493, "body": "@Keith Thompson: Simply because it is better to be able to use one function instead of having to choose the appropriate one out of the two. By design, C language lets you quietly violate a lot of things, like violating strict aliasing through implicit conversions to and from <code>void *</code>. That&#39;s just the way things are in C. Watching over such things and avoiding such violations is often caller&#39;s responsibility. <code>strstr</code> simply does not <i>enforce</i> it, which does not means that the responsibility isn&#39;t there."}, {"owner": {"reputation": 4411, "user_id": 751579, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/iux9g.png?s=128&g=1", "display_name": "davidbak", "link": "https://stackoverflow.com/users/751579/davidbak"}, "reply_to_user": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1460605875, "post_id": 36611013, "comment_id": 60823774, "body": "@AnT - &quot;By design, C language lets you quietly violate a lot of things&quot; - no kidding, like, silently throwing away return values from functions.  If they had originally required a cast to void at the call site to throw away a return value, otherwise issue a compiler error, millions of bugs where return values (= error codes) (of standard functions!) were not checked would have been ... well, if not eliminated, at least subjected to a programmer&#39;s informed look.  But I&#39;m afraid that&#39;s just a bugbear of mine ..."}], "tags": [], "owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "is_accepted": true, "score": 9, "last_activity_date": 1460591415, "last_edit_date": 1460591415, "creation_date": 1460588360, "answer_id": 36611013, "question_id": 36610899, "link": "https://stackoverflow.com/questions/36610899/how-to-implement-strstr-without-casting-away-const/36611013#36611013", "title": "How to implement strstr() without casting away const?", "body": "<p>You can't implement <code>strstr()</code> without violating <code>const</code> correctness somehow.  A cast is the most straightforward way to do that. You can probably hide the violation somehow (for example you could use <code>memcpy()</code> to copy the pointer value), but there's no point in doing so.</p>\n\n<p>The problem is that <code>strstr()</code> takes a <code>const char*</code> that points to a string, and returns a non-<code>const</code> <code>char*</code> that points into the same string.</p>\n\n<p>For example, this program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\nint main(void) {\n    const char s[] = \"hello\";\n    char *result = strstr(s, \"hello\");\n    *result = 'H';\n    puts(result);\n}\n</code></pre>\n\n<p>modifies (or at least attempts to modify) a <code>const</code>-qualified object, without using a pointer cast or any other obviously unsafe construct.</p>\n\n<p>Back in 1989, the ANSI C committee <em>could</em> have avoided this problem by defining two different functions, say:</p>\n\n<pre><code>const char *strcstr(const char *haystack, const char *needle);\n      char *strstr (      char *haystack, const char *needle);\n</code></pre>\n\n<p>one that returns a pointer to a <code>const char</code> given a <code>const</code> arguments, and another that returns  pointer to a modifiable <code>char</code> given a modifiable argument. (C++, which inherits the C standard library, does this by overloading.)</p>\n\n<p><code>strstr()</code> is one of several standard string functions that have this problem.</p>\n"}, {"comments": [{"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1460596127, "post_id": 36611608, "comment_id": 60821006, "body": "C++ does in fact require const overloads for strstr and friends, see sect. 21.8. What issues do you see with this?"}], "tags": [], "owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "is_accepted": false, "score": 0, "last_activity_date": 1460594150, "last_edit_date": 1460594150, "creation_date": 1460592317, "answer_id": 36611608, "question_id": 36610899, "link": "https://stackoverflow.com/questions/36610899/how-to-implement-strstr-without-casting-away-const/36611608#36611608", "title": "How to implement strstr() without casting away const?", "body": "<p>What you are seeing in case of <code>strstr</code> (and some other standard functions) is an idiomatic solution, whose intent is to support non-modifying operations on both const and non-const strings with a <em>single</em> function.</p>\n\n<p>Yes, in order to implement such a function it necessary to explicitly cast away constness from the input pointer. Note that the cast by itself does not yet physically violate anything (meaning: it does not attempt to modify constant data and does not cause undefined behavior). Yet, it does open the door to such violations by returning a non-const pointer to const data to the caller, i.e. violates the conceptual rules of const-correctness.</p>\n\n<p>An alternative solution would be to provide two versions of the same standard function - a const one and a non-const one - but without C++-style function overloading this would require two distinctive function names, which does not necessarily look like a very good idea (and even with C++-style function overloading it has its issues too).</p>\n\n<p>In this case it is effectively the responsibility of the caller to receive the result into a pointer of the same type as the one that was passed in as an argument. If the argument pointer was const-qualified, it is a very good programming practice to receive the result into a pointer that is const-qualified as well. As long as this guideline is observed, this idiom actually feels right at home in the realm of C language.</p>\n"}], "owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 866, "favorite_count": 0, "accepted_answer_id": 36611013, "answer_count": 2, "score": 10, "last_activity_date": 1460594150, "creation_date": 1460587684, "last_edit_date": 1460588117, "question_id": 36610899, "link": "https://stackoverflow.com/questions/36610899/how-to-implement-strstr-without-casting-away-const", "title": "How to implement strstr() without casting away const?", "body": "<p><a href=\"http://linux.die.net/man/3/strstr\"><code>strstr</code></a> is a C99-conforming function, the type signature of which is the following:</p>\n\n<pre><code>char *strstr(const char *haystack, const char *needle);\n</code></pre>\n\n<p>Is it possible to <strong>implement this function</strong> without casting away a <code>const</code> somewhere?</p>\n\n<p>For reference, here is <a href=\"https://opensource.apple.com/source/xnu/xnu-792.13.8/libsa/strstr.c\">Apple's implementation</a>, and here is <a href=\"http://tsunanet.net/~tsuna/strstr.c.html\">GNU's implementation</a>. Both cast away the <code>const</code> at the end.</p>\n"}, {"tags": ["c", "glibc"], "answers": [{"comments": [{"owner": {"reputation": 199, "user_id": 4052566, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/cRNUL.jpg?s=128&g=1", "display_name": "Tobin", "link": "https://stackoverflow.com/users/4052566/tobin"}, "edited": false, "score": 0, "creation_date": 1460600260, "post_id": 36613664, "comment_id": 60823947, "body": "If I may please clarify the question. The question is why has the pointer been rolled into the typedef? I believe you have answered the question, why use a typedef to create an opaque data type.  Thank you."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "reply_to_user": {"reputation": 199, "user_id": 4052566, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/cRNUL.jpg?s=128&g=1", "display_name": "Tobin", "link": "https://stackoverflow.com/users/4052566/tobin"}, "edited": false, "score": 0, "creation_date": 1460606642, "post_id": 36613664, "comment_id": 60823991, "body": "@Tobin Because then you don&#39;t need to care that it&#39;s a pointer. (And maybe in a later version it won&#39;t be a pointer, but probably not)"}, {"owner": {"reputation": 199, "user_id": 4052566, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/cRNUL.jpg?s=128&g=1", "display_name": "Tobin", "link": "https://stackoverflow.com/users/4052566/tobin"}, "edited": false, "score": 0, "creation_date": 1460670972, "post_id": 36613664, "comment_id": 60864546, "body": "Thomas Dickey, you are exactly correct, thank you. It seems the confusion was my own. Well done stackoverflow, 4 upvotes on the answer convinced me that the answer was correct and coerced me to understand the problem more thoroughly until I understood the answer. Thanks again."}], "tags": [], "owner": {"reputation": 42737, "user_id": 4518274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UPurS.png?s=128&g=1", "display_name": "Thomas Dickey", "link": "https://stackoverflow.com/users/4518274/thomas-dickey"}, "is_accepted": true, "score": 4, "last_activity_date": 1460588366, "last_edit_date": 1495535452, "creation_date": 1460587660, "answer_id": 36613664, "question_id": 36613663, "link": "https://stackoverflow.com/questions/36613663/why-does-libcap-use-obfuscated-pointer-for-cap-t/36613664#36613664", "title": "Why does libcap use obfuscated pointer for cap_t", "body": "<p>Obfuscated pointers (actually <em>\"opaque\"</em>) are used to force applications to use the documented functions for a library rather than bypass those functions and manipulate its data directly.</p>\n\n<p>Doing that lets the developers (of the library) concentrate on making the functions work rather than being distracted by handling data inconsistencies.</p>\n\n<p>Further reading:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/3854113/what-is-an-opaque-value\">What is an opaque value?</a></li>\n<li><a href=\"https://stackoverflow.com/questions/3965279/opaque-c-structs-how-should-they-be-declared\">Opaque C structs: how should they be declared?</a></li>\n<li><a href=\"https://softwareengineering.stackexchange.com/questions/294761/why-use-an-opaque-handle-that-requires-casting-in-a-public-api-rather-than-a-t\">Why use an opaque \u201chandle\u201d that requires casting in a public API rather than a typesafe struct pointer?</a></li>\n</ul>\n"}], "migrated_from": {"other_site": {"aliases": ["http://linux.stackexchange.com"], "markdown_extensions": ["Prettify"], "launch_date": 1294871917, "open_beta_date": 1282071600, "closed_beta_date": 1281466800, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/unix/Img/apple-touch-icon@2.png", "favicon_url": "https://cdn.sstatic.net/Sites/unix/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/unix/Img/apple-touch-icon.png", "audience": "users of Linux, FreeBSD and other Un*x-like operating systems", "site_url": "https://unix.stackexchange.com", "api_site_parameter": "unix", "logo_url": "https://cdn.sstatic.net/Sites/unix/Img/logo.png", "name": "Unix &amp; Linux", "site_type": "main_site"}, "on_date": 1460606476, "question_id": 276321}, "owner": {"reputation": 199, "user_id": 4052566, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/cRNUL.jpg?s=128&g=1", "display_name": "Tobin", "link": "https://stackoverflow.com/users/4052566/tobin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 36613664, "answer_count": 1, "score": 1, "last_activity_date": 1460606476, "creation_date": 1460587400, "question_id": 36613663, "link": "https://stackoverflow.com/questions/36613663/why-does-libcap-use-obfuscated-pointer-for-cap-t", "title": "Why does libcap use obfuscated pointer for cap_t", "body": "<p>Why is <code>cap_t</code> defined as <code>_cap_struct *</code>? What was the reasoning for obfuscating the pointer type and having libcap functions take/return <code>cap_t</code> when normal libc usage suggests they would take/return a explicit pointer type?</p>\n"}, {"tags": ["python", "c", "docker", "gdb", "gunicorn"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1460587084, "post_id": 36610765, "comment_id": 60818321, "body": "&quot;warning: exec file is newer than core file.&quot; should make you suspicious already."}, {"owner": {"reputation": 1498, "user_id": 2020593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c38293d3ead695bd858be7f9879d278?s=128&d=identicon&r=PG", "display_name": "Kron", "link": "https://stackoverflow.com/users/2020593/kron"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1460587907, "post_id": 36610765, "comment_id": 60818621, "body": "No, this is because core dump was built earlier than python."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1460588226, "post_id": 36610765, "comment_id": 60818745, "body": "Exactly. Just think what that can imply."}], "answers": [{"comments": [{"owner": {"reputation": 1498, "user_id": 2020593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c38293d3ead695bd858be7f9879d278?s=128&d=identicon&r=PG", "display_name": "Kron", "link": "https://stackoverflow.com/users/2020593/kron"}, "edited": false, "score": 0, "creation_date": 1460638099, "post_id": 36614006, "comment_id": 60843030, "body": "Even though I was building python in different containers the same way, they are really differs. Thank you a lot for your help!"}, {"owner": {"reputation": 1498, "user_id": 2020593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c38293d3ead695bd858be7f9879d278?s=128&d=identicon&r=PG", "display_name": "Kron", "link": "https://stackoverflow.com/users/2020593/kron"}, "edited": false, "score": 0, "creation_date": 1460648363, "post_id": 36614006, "comment_id": 60851659, "body": "I finally found the reason why python binaries was different. Original container was on ubuntu, but my debug container was on debian, so python was compiled in different environments."}], "tags": [], "owner": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "is_accepted": true, "score": 0, "last_activity_date": 1460608702, "creation_date": 1460608702, "answer_id": 36614006, "question_id": 36610765, "link": "https://stackoverflow.com/questions/36610765/gdb-empty-backtrace-when-using-gunicorn-core-dump/36614006#36614006", "title": "GDB empty backtrace when using gunicorn core dump", "body": "<blockquote>\n  <p>in the another container I have built for debugging purpose, I've got this:</p>\n</blockquote>\n\n<p>It's not clear what you mean by \"I have built for debugging\".</p>\n\n<p>In general, the binary you use to analyze the core dump <em>must</em> match the binary which produced this core dump <em>exactly</em>.</p>\n\n<p>That means you can't do this:</p>\n\n<pre><code>gcc -O2 -o foo t.c\n./foo  # crashes, produces core dump\n\ngcc -g -o foo-g t.c  # note lack of -O2\ngdb ./foo-g core     # will not work!\n</code></pre>\n\n<p>Instead, what you should do is this:</p>\n\n<pre><code>gcc -g -O2 -o foo-g t.c  # optimize with debug info\ncp foo-g foo\nstrip -g foo   # make a production binary by removing debug info\n\n./foo             # crashes, produces a core dump\ngdb ./foo-g core  # this works!\n</code></pre>\n\n<p>To test whether the two binaries are sufficiently \"same\", you can compare their symbols, e.g.</p>\n\n<pre><code>diff &lt;(readelf -Ws foo-g) &lt;(readelf -Ws foo)\n</code></pre>\n\n<p>The debug binary <em>can</em> have symbols not present in the stripped binary (such as <code>LOCAL</code> functions), but symbols that are present in both binaries must have the same value.</p>\n\n<p>I am guessing that your \"built for debugging\" <code>python3.5</code> is not the same as your \"production\" <code>python3.5</code>.</p>\n"}], "owner": {"reputation": 1498, "user_id": 2020593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c38293d3ead695bd858be7f9879d278?s=128&d=identicon&r=PG", "display_name": "Kron", "link": "https://stackoverflow.com/users/2020593/kron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1037, "favorite_count": 1, "accepted_answer_id": 36614006, "answer_count": 1, "score": 1, "last_activity_date": 1460608702, "creation_date": 1460586972, "question_id": 36610765, "link": "https://stackoverflow.com/questions/36610765/gdb-empty-backtrace-when-using-gunicorn-core-dump", "title": "GDB empty backtrace when using gunicorn core dump", "body": "<p>I'm trying to make a core dump of gunicorn in one docker container and debug it in another one.\nGunicorn is running with python3.5.\nWhen I'm opening core file in the container where it was dumped, everything looks fine:</p>\n\n<pre><code>Reading symbols from /opt/pyenv/versions/3.5.0/bin/python3.5...done.\n[New LWP 786]\n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/lib/x86_64-linux-gnu/libthread_db.so.1\".\nCore was generated by `/opt/pyenv/versions/3.5.0/bin/python3.5'.\n#0  0x00007f7caec93af3 in __epoll_wait_nocancel () at ../sysdeps/unix/syscall-template.S:81\n81      ../sysdeps/unix/syscall-template.S: No such file or directory.\n(gdb) bt\n#0  0x00007f7caec93af3 in __epoll_wait_nocancel () at ../sysdeps/unix/syscall-template.S:81\n#1  0x00007f7cacdaf213 in pyepoll_poll (self=0x7f7ca5aa9a80, args=&lt;optimized out&gt;, kwds=&lt;optimized out&gt;) at /tmp/python-build.20160412233915.330/Python-3.5.0/Modules/selectmodule.c:1549\n#2  0x00000000005a7579 in PyCFunction_Call (func=func@entry=0x7f7c98706090, args=args@entry=0x7f7c9feb5550, kwds=kwds@entry=0x0) at Objects/methodobject.c:98\n...\n</code></pre>\n\n<p>But when I'm trying to open this file in the another container I have built for debugging purpose, I've got this:</p>\n\n<pre><code>Reading symbols from /opt/pyenv/versions/3.5.0/bin/python3.5...done.\n\nwarning: exec file is newer than core file.\n[New LWP 356]\n\nwarning: Unexpected size of section `.reg-xstate/356' in core file.\nCore was generated by `/opt/pyenv/versions/3.5.0/bin/python3.5'.\n\nwarning: Unexpected size of section `.reg-xstate/356' in core file.\n#0  0x00007fb1e8695af3 in ?? ()\n(gdb) bt\n#0  0x00007fb1e8695af3 in ?? ()\n#1  0x00007fb1e67b1213 in ?? ()\n#2  0x000000000225b588 in ?? ()\n#3  0x0034e2b269edb810 in ?? ()\n#4  0x00000000000003ff in ?? ()\n#5  0x0000000400000001 in ?? ()\n</code></pre>\n\n<p>I can't understand why I'm getting the empty backtrace. Maybe someone can help me with this?\nThanks!</p>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 32760, "user_id": 206367, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/121b360a4d7d20be6e220dcdb555649f?s=128&d=identicon&r=PG", "display_name": "t0mm13b", "link": "https://stackoverflow.com/users/206367/t0mm13b"}, "edited": false, "score": 0, "creation_date": 1460587106, "post_id": 36610746, "comment_id": 60818331, "body": "Your function is returning a pointer... why are you not using the <code>array[i]</code> subscripting, to make it easier to understand first, and drop the <code>*</code> from teh function declaration&#39;s return type."}, {"owner": {"reputation": 45, "user_id": 5207569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11576f39f3fadb55a0b6d725ebe5b09a?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Tucker", "link": "https://stackoverflow.com/users/5207569/mike-tucker"}, "reply_to_user": {"reputation": 32760, "user_id": 206367, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/121b360a4d7d20be6e220dcdb555649f?s=128&d=identicon&r=PG", "display_name": "t0mm13b", "link": "https://stackoverflow.com/users/206367/t0mm13b"}, "edited": false, "score": 0, "creation_date": 1460587250, "post_id": 36610746, "comment_id": 60818390, "body": "the problem requires me to use pointer arithmetic and * in the function declaration"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1460587337, "post_id": 36610746, "comment_id": 60818426, "body": "Your type specifier <code>%d</code> invokes undefined behaviour. Use the correct one to print a pointer!"}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1460587342, "post_id": 36610746, "comment_id": 60818427, "body": "You never change the value of <code>array</code> in your function. How do you expect it to change?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1460587393, "post_id": 36610746, "comment_id": 60818443, "body": "Your code is far from doing what your text describes."}], "answers": [{"tags": [], "owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "is_accepted": true, "score": 2, "last_activity_date": 1460587499, "last_edit_date": 1460587499, "creation_date": 1460587140, "answer_id": 36610798, "question_id": 36610746, "link": "https://stackoverflow.com/questions/36610746/pointers-and-function-calls/36610798#36610798", "title": "Pointers and Function Calls", "body": "<p>Two problems here:</p>\n\n<ol>\n<li>You are modifying values in the array itself (not keeping track of a pointer) and then just returning the original pointer.</li>\n<li>Your loop is backwards and never executes (because the termination condition <code>i++</code> with initial value of 0 will evaluate to false).</li>\n</ol>\n\n<p>Instead, keep track of a another pointer and do it like this:</p>\n\n<pre><code>int i;\nint *largest = array;\nfor( i = 1; i &lt; size; ++i )\n{\n    if( array[i] &gt; *largest ) largest = &amp;array[i];\n}\nreturn largest;\n</code></pre>\n\n<p>If you insist on a purely pointer arithmetic solution, try this:</p>\n\n<pre><code>int *end = array + size;\nint *largest = array;\nfor( ; array != end; ++array )\n{\n    if( *array &gt; *largest ) largest = array;\n}\nreturn largest;\n</code></pre>\n\n<p><strong>Edit:</strong> As pointed out in the comments, you also have the wrong <code>printf</code> specifier for displaying an address.  Use <code>%p</code> instead:</p>\n\n<pre><code>printf(\"The largest Value is: %d\",  *Z);\nprintf(\"The address of the largest Value is: %p\",  Z);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 164, "user_id": 6193510, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dRTC5khvm-g/AAAAAAAAAAI/AAAAAAAAFK0/nKLXuPE-F5Y/photo.jpg?sz=128", "display_name": "Nevado", "link": "https://stackoverflow.com/users/6193510/nevado"}, "is_accepted": false, "score": -1, "last_activity_date": 1460587198, "creation_date": 1460587198, "answer_id": 36610814, "question_id": 36610746, "link": "https://stackoverflow.com/questions/36610746/pointers-and-function-calls/36610814#36610814", "title": "Pointers and Function Calls", "body": "<p>Of course, what you are doing in the Largest function is modifying the first element of the array and then returning it. You are modifying <code>*array</code>, but not <code>array</code> which is what your return.</p>\n"}, {"tags": [], "owner": {"reputation": 715, "user_id": 4147225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e58b3fa5297e23a66505477b49de967?s=128&d=identicon&r=PG", "display_name": "Vladyslav", "link": "https://stackoverflow.com/users/4147225/vladyslav"}, "is_accepted": false, "score": -1, "last_activity_date": 1460588313, "last_edit_date": 1460588313, "creation_date": 1460587234, "answer_id": 36610820, "question_id": 36610746, "link": "https://stackoverflow.com/questions/36610746/pointers-and-function-calls/36610820#36610820", "title": "Pointers and Function Calls", "body": "<p>The first problem is in your <strong>for</strong> loop definition. It should be like that:</p>\n\n<blockquote>\n  <p>for (i = 0; i &lt; size; i++)</p>\n</blockquote>\n\n<p>The second problem is that you are modifying your array. Use this code snippet instead:</p>\n\n<pre><code>int* Largest(int *array, int size)\n{\n    int* largest_ptr = array;\n    int i;\n    for (i = 1; i &lt; size; i++)\n    {\n        if (array[i] &gt; array[i - 1])\n        {\n            largest_ptr = array + i;\n        }\n    }\n    return largest_ptr;\n}\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 5207569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11576f39f3fadb55a0b6d725ebe5b09a?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Tucker", "link": "https://stackoverflow.com/users/5207569/mike-tucker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 36610798, "answer_count": 3, "score": -3, "last_activity_date": 1460588313, "creation_date": 1460586847, "question_id": 36610746, "link": "https://stackoverflow.com/questions/36610746/pointers-and-function-calls", "title": "Pointers and Function Calls", "body": "<p>I can't figure out what i'm doing wrong with this program. Im trying to print out the address of the largest value in an array but i keep getting the address of the first value in the array. I'm pretty sure the problem's in the for loop but i can't figure out where exactly. Heres the code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint *Largest(int *array, int size);\n\n\nint main (void)\n{\n    int* Z;\n    int A[10] = {3,53,52,6,2,8,3,6454,232,88};\n    Z = Largest(A, 10);\n\n\n    printf(\"The address of the largest Value is: %d\",  Z);\n\n}\n\nint* Largest(int *array, int size)\n{\n    int i;\n    for (i=0; i++; i&lt;size)\n    {\n        if (*(array+i) &gt; *array)\n        *array = *(array+i);\n    }\n    return array;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "linux", "audio"], "comments": [{"owner": {"reputation": 12072, "user_id": 1630963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97c2d181ef6bbb9eee0c4033561c3891?s=128&d=identicon&r=PG", "display_name": "enhzflep", "link": "https://stackoverflow.com/users/1630963/enhzflep"}, "edited": false, "score": 0, "creation_date": 1460587206, "post_id": 36610716, "comment_id": 60818373, "body": "You find and download one that does, <i>or</i> you read-up more about that particular sound generation chip and how it works, before implementing code that will perform the same way, producing the same output as the chip would have, as a wav. In either case, you&#39;ll need a library to play the sound and perhaps another one to decode it. Your first aim of converting the GameBoy rom into C to run natively on the host simply wont happen. It&#39;s far, far easier to pretend to be a cpu than it is to convert from one cpu/os to another - why do you think all emulators work the way they do already?"}, {"owner": {"reputation": 702, "user_id": 3777314, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/600103728/picture?type=large", "display_name": "ocket8888", "link": "https://stackoverflow.com/users/3777314/ocket8888"}, "reply_to_user": {"reputation": 12072, "user_id": 1630963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97c2d181ef6bbb9eee0c4033561c3891?s=128&d=identicon&r=PG", "display_name": "enhzflep", "link": "https://stackoverflow.com/users/1630963/enhzflep"}, "edited": false, "score": 0, "creation_date": 1460588381, "post_id": 36610716, "comment_id": 60818789, "body": "I don&#39;t care what&#39;s easy, I&#39;m not trying to recreate something that&#39;s already been done, I want to do something new. I don&#39;t want to store the music separately, and any libraries that play sounds have been written once, so they can be written again."}, {"owner": {"reputation": 12072, "user_id": 1630963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97c2d181ef6bbb9eee0c4033561c3891?s=128&d=identicon&r=PG", "display_name": "enhzflep", "link": "https://stackoverflow.com/users/1630963/enhzflep"}, "edited": false, "score": 0, "creation_date": 1460588786, "post_id": 36610716, "comment_id": 60818947, "body": "Sure, just dont bank on doing anything else productive with your life then. The GameBoy SuperAdvance 10,000 will be released before code implementing your gba-&gt;pc native code is... The most obvious thing to do would be to generate the same audio that the chips do. You can read up about their registers, the functions of these regs and the chip&#39;s response to said input. This has already been done several times - there&#39;s no way around that, you re-do it or get code that already exists. Just like eveyone did with the OPL chips of the SoundBlaster or the Yamaha stuff inside SegaMS and Nintendos. :)"}, {"owner": {"reputation": 702, "user_id": 3777314, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/600103728/picture?type=large", "display_name": "ocket8888", "link": "https://stackoverflow.com/users/3777314/ocket8888"}, "reply_to_user": {"reputation": 12072, "user_id": 1630963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97c2d181ef6bbb9eee0c4033561c3891?s=128&d=identicon&r=PG", "display_name": "enhzflep", "link": "https://stackoverflow.com/users/1630963/enhzflep"}, "edited": false, "score": 0, "creation_date": 1460589005, "post_id": 36610716, "comment_id": 60819011, "body": "I&#39;m not trying to do anything with a gba, I&#39;m just using a generic GameBoy from 1989, 8-bit Z-80 processor and all that. I can figure out what waveforms are being represented in the ROM pretty easily, what I want to know is how to output them once I do. Even using a library to do it is fine."}, {"owner": {"reputation": 100758, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 2, "creation_date": 1460589899, "post_id": 36610716, "comment_id": 60819324, "body": "The best choice is <code>libsdl</code>, which is basically Linux&#39;s DirectX. If you have a raw waveform, you can easily output it by looking up <a href=\"https://wiki.libsdl.org/SDL_OpenAudioDevice\" rel=\"nofollow noreferrer\">how to output audio</a>. If you have multiple basis waveforms you want to mix together, you can <a href=\"https://wiki.libsdl.org/SDL_MixAudioFormat\" rel=\"nofollow noreferrer\">look that up</a> as well. If you don&#39;t have the basis waveforms, you have to figure out how the sound chip works and emulate it to produce them."}], "owner": {"reputation": 702, "user_id": 3777314, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/600103728/picture?type=large", "display_name": "ocket8888", "link": "https://stackoverflow.com/users/3777314/ocket8888"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 204, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1460586652, "creation_date": 1460586652, "question_id": 36610716, "link": "https://stackoverflow.com/questions/36610716/linux-play-raw-sound-from-waveform", "title": "Linux Play Raw Sound from Waveform", "body": "<p>I'm in the process of building my own GameBoy emulator, the idea behind which is to convert a GameBoy flash ROM entirely into C code that can be run natively on the host computer. It's in the very early stages of development, and one of my roadblocks is that the GameBoy stores sound as a series of commands that edit one of four continuous wave forms. Basically, these sounds are always playing a flat tone unless you turn them off or modulate them by editing some register values. What this means is that I can't just <code>execvp(\"SomeMusicPlayer /path/to/sound.ext\", NULL);</code>, because the sound isn't stored in a portable format. Furthermore, the idea is to rebuild the game as a single executable, so I'd like to be able to play sounds without forking to an external program.</p>\n\n<p>In short, my question is: \"How do I play sounds as raw waveforms with envelope and sweep functions on Linux?\"</p>\n"}, {"tags": ["c", "binary-search-tree"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1460586638, "post_id": 36610673, "comment_id": 60818116, "body": "If you don&#39;t start accepting people&#39;s answers, sooner or later they&#39;re just going to stop answering. For example, you wouldn&#39;t be where you are now with <i>this</i> code without the answers from <a href=\"https://stackoverflow.com/questions/36592293/having-trouble-with-a-binary-search-tree-remove-function\"><b>this question</b></a>."}, {"owner": {"reputation": 37, "user_id": 5996270, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4d277f55a1c5813c2421db2e251fd0f4?s=128&d=identicon&r=PG", "display_name": "N. Ali.", "link": "https://stackoverflow.com/users/5996270/n-ali"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1460587542, "post_id": 36610673, "comment_id": 60818498, "body": "Accept answers in what way? Sorry, I&#39;m fairly new to stackoverflow and don&#39;t know the protocols. I implemented your suggestion and upvoted it, as it was correct. I made a new post for this as I assume the problem is unrelated to my other post, which you already answered."}, {"owner": {"reputation": 37, "user_id": 5996270, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4d277f55a1c5813c2421db2e251fd0f4?s=128&d=identicon&r=PG", "display_name": "N. Ali.", "link": "https://stackoverflow.com/users/5996270/n-ali"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1460587618, "post_id": 36610673, "comment_id": 60818527, "body": "Ah, just realized what the check mark is for..,.. Sorry about that."}], "owner": {"reputation": 37, "user_id": 5996270, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4d277f55a1c5813c2421db2e251fd0f4?s=128&d=identicon&r=PG", "display_name": "N. Ali.", "link": "https://stackoverflow.com/users/5996270/n-ali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1501017210, "creation_date": 1460586394, "last_edit_date": 1501017210, "question_id": 36610673, "link": "https://stackoverflow.com/questions/36610673/reordering-binary-search-tree-after-removing-an-item", "title": "Reordering binary search tree after removing an item", "body": "<p>I'm working on a binary search tree in C. I believe my removeBST function is deleting properly, but I don't think the tree is being reordered correctly.</p>\n\n<p><strong>This is my remove function:</strong></p>\n\n<pre><code>int removeBST(struct TreeNode** rootRef, int data)\n{  \n  struct TreeNode* heir;\n  struct TreeNode* prev;\n\n  if(*rootRef == NULL)\n  {\n    return 0;\n  }\n\n  if(data &lt; (*rootRef)-&gt;data)\n  {\n    return removeBST(&amp;(*rootRef)-&gt;left, data);\n  }\n  else if(data &gt; (*rootRef)-&gt;data)\n  {\n    return removeBST(&amp;(*rootRef)-&gt;right, data);\n  }\n  else\n  {\n    struct TreeNode* temp;\n\n    if((*rootRef)-&gt;right == NULL)\n    {\n      temp = *rootRef;\n      *rootRef = (*rootRef)-&gt;left;\n      free(temp);\n      return 1;\n    }\n    else if((*rootRef)-&gt;left == NULL)\n    {\n      temp = *rootRef;\n      *rootRef = (*rootRef)-&gt;right; \n      free(temp);\n      return 1;\n    }\n    else\n    {\n      heir = (*rootRef)-&gt;left;\n      prev = *rootRef;\n\n      while(heir-&gt;right != NULL)\n      {\n         prev = heir;\n         heir = heir-&gt;right;\n      } \n\n      (*rootRef)-&gt;data = heir-&gt;data;\n\n      if(prev != *rootRef)\n      {\n        prev-&gt;right = heir-&gt;left;\n      }\n      else\n      {\n        prev-&gt;left = heir-&gt;left;\n      }\n      free(heir);\n      return 1;\n    }\n  }\n  return 0;\n}\n</code></pre>\n\n<p><strong>This is where the function is called:</strong></p>\n\n<pre><code>for(i = -4; i &lt; 25; i+=4)\n {\n   n = removeBST(&amp;bst, i);\n   if(!n) printf(\"remove did not find %d\\n\", i);  \n }\n</code></pre>\n\n<p><strong>This is my expected output:</strong></p>\n\n<blockquote>\n  <p>test tree: 1 2 3 1 4 1 2 5 1 2 3 1 <br/> tree leaves: 1 1 1 1 1 <br/> tree depth\n  = 5 <br/>tree balanced = 1<br/> tree isBST = 0 <br/>another test tree: 1 2 3 4 1 5 1 2 6 1 2 3  <br/>tree leaves: 1 1 1 1  <br/>tree depth = 6 <br/>tree balanced = 0 <br/>tree\n  isBST = 0 <br/>notBST: 1 3 8 5 6 7 10  <br/>notBST leaves: 1 8 6 10  <br/>notBST\n  depth = 3 <br/>notBST balanced = 1 <br/>notBST isBST = 0 <br/>empty tree:  <br/>filled\n  BST: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22  <br/>BST\n  leaves: 0 6 12 17  <br/>BST depth = 8 <br/>BST minimum value = 0 <br/>BST balanced =\n  0 <br/>BST isBST = 1 <br/>remove did not find -4 <br/>remove did not find 24 <br/>BST\n  after removes: 1 2 3 5 6 7 9 10 11 13 14 15 17 18 19 21 22  <br/>BST\n  leaves: 1 6 13 18 (PROBLEM HERE) <br/>BST depth = 6 (PROBLEM HERE) <br/>BST minimum value = 1 <br/>BST balanced =\n  0 <br/>BST isBST = 1</p>\n</blockquote>\n\n<p><strong>This is my actual output:</strong></p>\n\n<blockquote>\n  <p>test tree: 1 2 3 1 4 1 2 5 1 2 3 1 <br/>tree leaves: 1 1 1 1 1 <br/>tree depth =\n  5 <br/>tree balanced = 1 <br/>tree isBST = 0 <br/>another test tree: 1 2 3 4 1 5 1 2\n  6 1 2 3 <br/>tree leaves: 1 1 1 1 <br/>tree depth = 6 <br/>tree balanced = 0 <br/>tree\n  isBST = 0 <br/>notBST: 1 3 8 5 6 7 10 <br/>notBST leaves: 1 8 6 10 <br/>notBST depth\n  = 3 <br/>notBST balanced = 1 <br/>notBST isBST = 0 <br/>empty tree: <br/>filled BST: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 <br/>BST leaves: 0 6\n  12 17 <br/>BST depth = 8 <br/>BST minimum value = 0 <br/>BST balanced = 0 <br/>BST isBST =\n  1 <br/>remove did not find -4 <br/>remove did not find 24 <br/>BST after removes: 1 2\n  3 5 6 7 9 10 11 13 14 15 17 18 19 21 22 <br/>BST leaves: 1 6 13 17 (PROBLEM HERE)<br/>BST\n  depth = 7 (PROBLEM HERE)<br/>BST minimum value = 1 <br/>BST balanced = 0 <br/>BST isBST = 1</p>\n</blockquote>\n\n<p>As you can see, my BST leaves after removal are not correct, and the depth is wrong, so I assume it's not reordering properly.</p>\n\n<p>I don't think this is the problem, but just in case, here's my printLeaves function (as a side note, if I wanted to print a newline after the last leaf is printed, how would I do that):</p>\n\n<pre><code>void printLeaves(struct TreeNode* root)\n{\n  if(root-&gt;left == NULL &amp;&amp; root-&gt;right == NULL)\n  {\n    printf(\"%d \", root-&gt;data);\n  }\n  else\n  {\n    if(root-&gt;left != NULL)\n    {\n      printLeaves(root-&gt;left);\n    }\n    if(root-&gt;right != NULL)\n    {\n      printLeaves(root-&gt;right);\n    }\n  }\n}\n</code></pre>\n\n<p>And my maxDepth function:</p>\n\n<pre><code>int maxDepth(struct TreeNode* root)\n{ \n  struct TreeNode* current = root;\n\n  if(current == NULL)\n  {\n    return 0;\n  }\n  else\n  {\n    int leftDepth = maxDepth(current-&gt;left);\n    int rightDepth = maxDepth(current-&gt;right);\n\n    if(leftDepth &gt; rightDepth)\n    {\n      return (leftDepth+1);\n    }\n    else\n    {\n      return (rightDepth+1);\n    }\n  }\n}\n</code></pre>\n\n<p>Any help would be appreciated. Thanks.</p>\n"}, {"tags": ["c", "assembly", "x86", "x86-64"], "comments": [{"owner": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "edited": false, "score": 0, "creation_date": 1460585875, "post_id": 36610530, "comment_id": 60817825, "body": "Have you tried stepping through with a debugger to verify that you are, in fact, capturing the arguments properly?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 3, "creation_date": 1460586001, "post_id": 36610530, "comment_id": 60817875, "body": "Did you read, understood and follow the ABI? I don&#39;t think the arguments are passed on the stack. In general, better use inline-assembler."}, {"owner": {"reputation": 495, "user_id": 2678074, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/694a7322a7bdcd93005e538faf623d50?s=128&d=identicon&r=PG&f=1", "display_name": "user2678074", "link": "https://stackoverflow.com/users/2678074/user2678074"}, "edited": false, "score": 0, "creation_date": 1460586371, "post_id": 36610530, "comment_id": 60818013, "body": "Well, i didn&#39;t. There is barely any information in my language about it, and articses in english are, well, heavly technic. I assume that passing int from C to registry is smth i am doing wrong, but i don&#39;t know what it should be proper. I&#39;ve found none example, so i am asking here."}, {"owner": {"reputation": 495, "user_id": 2678074, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/694a7322a7bdcd93005e538faf623d50?s=128&d=identicon&r=PG&f=1", "display_name": "user2678074", "link": "https://stackoverflow.com/users/2678074/user2678074"}, "edited": false, "score": 0, "creation_date": 1460586507, "post_id": 36610530, "comment_id": 60818060, "body": "in 32bit ass, int is just passed to registry 1:1, i don&#39;t know how to pass 64bit int :/ Unless it&#39;s not the issue here."}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 2, "creation_date": 1460586579, "post_id": 36610530, "comment_id": 60818089, "body": "We can only explain it to you in english too. See also <a href=\"https://en.wikipedia.org/wiki/X86_calling_conventions#System_V_AMD64_ABI\" rel=\"nofollow noreferrer\">wikipedia</a>. TL;DR: you get the first argument in <code>rdi</code> the second in <code>rsi</code>. So all you need is <code>lea (%rdi, %rsi), %rax; ret</code>. Actually <code>int</code> is still 32 bit so you can use the 32 bit registers."}, {"owner": {"reputation": 495, "user_id": 2678074, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/694a7322a7bdcd93005e538faf623d50?s=128&d=identicon&r=PG&f=1", "display_name": "user2678074", "link": "https://stackoverflow.com/users/2678074/user2678074"}, "edited": false, "score": 0, "creation_date": 1460587056, "post_id": 36610530, "comment_id": 60818309, "body": "This I missed! I dodn&#39;t know, that arguments are passed to those registers! But what if I need to pass more arguments? List/string?"}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1460587326, "post_id": 36610530, "comment_id": 60818420, "body": "See the linked wikipedia and the ABI docs for all the registers used. Sorry, you will have to learn english. A string is a pointer, and is passed as usual."}, {"owner": {"reputation": 495, "user_id": 2678074, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/694a7322a7bdcd93005e538faf623d50?s=128&d=identicon&r=PG&f=1", "display_name": "user2678074", "link": "https://stackoverflow.com/users/2678074/user2678074"}, "edited": false, "score": 0, "creation_date": 1460588143, "post_id": 36610530, "comment_id": 60818708, "body": "Well, I see, that next parameter goes to rdx and so on. But if i try to add third parameter, it goes nuts. I don&#39;t understand this.Can you also show me, on example how to pass string? I know it&#39;s not very fair, but i really want to know, and example would be really helpfull."}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1460588173, "post_id": 36610530, "comment_id": 60818717, "body": "Depends on what you want to do with the string. You will get the pointer in <code>rdx</code> as you say."}, {"owner": {"reputation": 495, "user_id": 2678074, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/694a7322a7bdcd93005e538faf623d50?s=128&d=identicon&r=PG&f=1", "display_name": "user2678074", "link": "https://stackoverflow.com/users/2678074/user2678074"}, "edited": false, "score": 0, "creation_date": 1460588642, "post_id": 36610530, "comment_id": 60818888, "body": "But in case i added third int and switched your line to &quot;movq %rdx, %rax&quot; - result is wrong!  In 2nd case i want to pass string, and just print it to console. I promise, that is all I will be bothering you. I just cannot understand. If i knew how, to make this two, that&#39;d be awesome!"}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "reply_to_user": {"reputation": 495, "user_id": 2678074, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/694a7322a7bdcd93005e538faf623d50?s=128&d=identicon&r=PG&f=1", "display_name": "user2678074", "link": "https://stackoverflow.com/users/2678074/user2678074"}, "edited": false, "score": 0, "creation_date": 1460588854, "post_id": 36610530, "comment_id": 60818962, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/109093/discussion-between-jester-and-user2678074\">continue this discussion in chat</a>."}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 1, "creation_date": 1460596830, "post_id": 36610530, "comment_id": 60821194, "body": "Look under &quot;Calling Conventions&quot; in this article, <a href=\"https://software.intel.com/en-us/articles/introduction-to-x64-assembly\" rel=\"nofollow noreferrer\">Introduction to x64 Assembly</a>."}, {"owner": {"reputation": 1050, "user_id": 4720292, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ab9634db96cbb4bc54c10cbe276ae411?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/4720292/pierre"}, "edited": false, "score": 0, "creation_date": 1460626486, "post_id": 36610530, "comment_id": 60834355, "body": "<a href=\"http://stackoverflow.com/questions/2535989/what-are-the-calling-conventions-for-unix-linux-system-calls-on-x86-64\" title=\"what are the calling conventions for unix linux system calls on x86 64\">stackoverflow.com/questions/2535989/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 495, "user_id": 2678074, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/694a7322a7bdcd93005e538faf623d50?s=128&d=identicon&r=PG&f=1", "display_name": "user2678074", "link": "https://stackoverflow.com/users/2678074/user2678074"}, "is_accepted": false, "score": 1, "last_activity_date": 1460711984, "creation_date": 1460711984, "answer_id": 36643140, "question_id": 36610530, "link": "https://stackoverflow.com/questions/36610530/passing-parameters-from-c-to-gnu-assembly-function-in-64bit/36643140#36643140", "title": "Passing parameters from C to GNU Assembly function in 64bit", "body": "<p>Thanks 'Jester' for so much effort and time to get me this explained!</p>\n\n<p>To sum up. Passing parameters from C to As ( and as well from As to C) has its own <a href=\"https://en.wikipedia.org/wiki/X86_calling_conventions#System_V_AMD64_ABI\" rel=\"nofollow\">ABI convention</a>.\nAs you can see there, params are send on order:\n1) rdi\n2) rsi\n3) rdx\n... and so on...</p>\n\n<p>In case you have more parameters than in convention, it will be pushed to stack.</p>\n\n<p>So in my case:</p>\n\n<pre><code>.globl addByAssembly\naddByAssembly:\npushq %rbp\nmovq %rsp, %rbp\n--movq 16(%rsp), %rax    #this was wrong as my params are\n--addq 24(%rsp), %rax    # first in %rdi, second in %rsi\n++lea (%rdi, %rsi), %rax # in my case this line will do \n                         # %rdi+%rsi -&gt; %rax (learn lea, usefull command)\n                         # REMEMBER return value is always in %rax!\nmovq %rbp, %rsp\npopq %rbp\n</code></pre>\n"}], "owner": {"reputation": 495, "user_id": 2678074, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/694a7322a7bdcd93005e538faf623d50?s=128&d=identicon&r=PG&f=1", "display_name": "user2678074", "link": "https://stackoverflow.com/users/2678074/user2678074"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 898, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1460711984, "creation_date": 1460585736, "last_edit_date": 1460586169, "question_id": 36610530, "link": "https://stackoverflow.com/questions/36610530/passing-parameters-from-c-to-gnu-assembly-function-in-64bit", "title": "Passing parameters from C to GNU Assembly function in 64bit", "body": "<p>I have main function in C that runs code in assembly. I just want to make simple sum:</p>\n\n<p>main.c</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nextern int addByAssembly(int first_number, int second_number);\n\nint main (int argc, char **argv)\n{\n    int sum=0;\n    sum = addByAssembly(5,4);\n    printf (\"%d\\n\",sum);\n    return 0;\n}\n</code></pre>\n\n<p>addByAssembly.s</p>\n\n<pre><code>.data\nSYSREAD = 0\nSYSWRITE = 1\nSYSEXIT = 60\nSTDOUT = 1\nSTDIN = 0\nEXIT_SUCCESS = 0\n\n.text\n#.global main\n#main:\n#call write\n#movq $SYSEXIT, %rax\n#movq $EXIT_SUCCESS, %rdi\n#syscall\n\n#********\n.globl addByAssembly\naddByAssembly:\npushq %rbp\nmovq %rsp, %rbp\nmovq 16(%rsp), %rax\naddq 24(%rsp), %rax\n\nmovq %rbp, %rsp\npopq %rbp\n</code></pre>\n\n<p>But i got mess in my sum. It looks like i badly pass arguments, beause if I do this:</p>\n\n<pre><code>movq $123, %rax\n</code></pre>\n\n<p>return value is 123. I 've tried many ways, but cannot find how to make this properly to sum.</p>\n"}, {"tags": ["c", "pointers", "sqlite", "mutable"], "answers": [{"comments": [{"owner": {"reputation": 23627, "user_id": 5175709, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/LGmTA.png?s=128&g=1", "display_name": "Honey", "link": "https://stackoverflow.com/users/5175709/honey"}, "edited": false, "score": 0, "creation_date": 1460588589, "post_id": 36610786, "comment_id": 60818865, "body": "Excellent answer C32, thanks. So you are saying the only reason we are doing this is for protection? So if there is an error the sqlite3* would be pointing to <code>nil</code>?What about the expansion of memory? I am still confused on that. Can you please elaborate on that as well?"}, {"owner": {"reputation": 18146, "user_id": 646619, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bd61a0f309ebc135d2661710c2faf379?s=128&d=identicon&r=PG", "display_name": "Colonel Thirty Two", "link": "https://stackoverflow.com/users/646619/colonel-thirty-two"}, "reply_to_user": {"reputation": 23627, "user_id": 5175709, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/LGmTA.png?s=128&g=1", "display_name": "Honey", "link": "https://stackoverflow.com/users/5175709/honey"}, "edited": false, "score": 0, "creation_date": 1460589229, "post_id": 36610786, "comment_id": 60819087, "body": "@asma22 The only way to detect if an error occurs is by looking at the return value; <a href=\"http://sqlite.org/c3ref/open.html\" rel=\"nofollow noreferrer\">SQLite will still write a database pointer even if it could not be opened</a> (likely so that you can get an error message from it). Because the exact structure of the <code>sqlite3</code> structure is hidden from the program using SQLite, SQLite is free to add or remove fields from it (which may change the amount of memory it uses) without breaking the API or ABI."}], "tags": [], "owner": {"reputation": 18146, "user_id": 646619, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bd61a0f309ebc135d2661710c2faf379?s=128&d=identicon&r=PG", "display_name": "Colonel Thirty Two", "link": "https://stackoverflow.com/users/646619/colonel-thirty-two"}, "is_accepted": true, "score": 2, "last_activity_date": 1460587077, "creation_date": 1460587077, "answer_id": 36610786, "question_id": 36610518, "link": "https://stackoverflow.com/questions/36610518/why-is-that-for-sqlite3-open-we-use-double-pointer-and-for-sqlite3-prepare-we/36610786#36610786", "title": "Why is that for sqlite3_open we use double pointer ** and for sqlite3_prepare we use pointer *", "body": "<p><code>sqlite3_open</code> needs to somehow give you a database connection object; i.e. a <code>sqlite3</code> object.</p>\n\n<p>To prevent people from accessing the internals, <code>sqlite3.h</code> declares <code>sqlite3</code> as an opaque struct. This means that you cannot allocate space for a <code>sqlite3</code> since you don't know what it holds; the SQLite library must allocate it for you and give you a pointer to it (<code>sqlite3*</code>).</p>\n\n<p>So now we have a hypothetical function <code>sqlite3* sqlite3_open(...);</code>, which opens a DB and returns a pointer to the connection object. But hold on; what if an error occurs? We could return <code>NULL</code>, but how is the developer supposed to distinguish a \"database doesn't exist\" error from a \"database is read only\", \"database is corrupted\", or other errors?</p>\n\n<p>So instead, <code>sqlite3_open</code> returns an integer return code, and writes the connection pointer to the memory that the <code>ppDB</code> parameter points to if opening succeeded.</p>\n\n<p><code>sqlite3_open</code> is usually used like this:</p>\n\n<pre><code>sqlite3* myDB;\nint status = sqlite3_open(\"/path/to/db\", &amp;myDB);\nif(status != SQLITE_OK) {\n    // error occured\n    return;\n}\n// sqlite3_open wrote a database pointer to myDB, use it here\nstatus = sqlite3_prepare_v2(myDB, \"SELECT * FROM whatever\", -1, NULL, NULL);\n// ...\n</code></pre>\n"}], "owner": {"reputation": 23627, "user_id": 5175709, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/LGmTA.png?s=128&g=1", "display_name": "Honey", "link": "https://stackoverflow.com/users/5175709/honey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 501, "favorite_count": 0, "accepted_answer_id": 36610786, "answer_count": 1, "score": 2, "last_activity_date": 1460656860, "creation_date": 1460585670, "last_edit_date": 1495540789, "question_id": 36610518, "link": "https://stackoverflow.com/questions/36610518/why-is-that-for-sqlite3-open-we-use-double-pointer-and-for-sqlite3-prepare-we", "title": "Why is that for sqlite3_open we use double pointer ** and for sqlite3_prepare we use pointer *", "body": "<p>Please correct me where I understood wrong.</p>\n\n<p>I read this answer <a href=\"https://stackoverflow.com/a/833124/5175709\">https://stackoverflow.com/a/833124/5175709</a> and what I understood was that since the object could expand and run out of space then the memory location my also change.But here two sqlite3 syntaxes are referencing to the object differently. WHY?</p>\n\n<p>sqlite3_open we have: <code>sqlite3 **ppDb</code></p>\n\n<pre><code>SQLITE_API int SQLITE_STDCALL sqlite3_open(\n  const char *filename,   /* Database filename (UTF-8) */\n  sqlite3 **ppDb          /* OUT: SQLite db handle */\n</code></pre>\n\n<p>And for sqlite3_prepare we have: <code>sqlite3 *db</code></p>\n\n<pre><code>SQLITE_API int SQLITE_STDCALL sqlite3_prepare_v2(\n  sqlite3 *db,            /* Database handle */\n  const char *zSql,       /* SQL statement, UTF-8 encoded */\n  int nByte,              /* Maximum length of zSql in bytes. */\n  sqlite3_stmt **ppStmt,  /* OUT: Statement handle */\n  const char **pzTail     /* OUT: Pointer to unused portion of zSql */\n</code></pre>\n"}, {"tags": ["c", "sizeof", "fread"], "comments": [{"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1460585687, "post_id": 36610127, "comment_id": 60817737, "body": "Be warned not to substantially change your question after you got answers. Anyway, you are printing 8 characters into <code>title</code>, which can only hold 7."}], "answers": [{"comments": [{"owner": {"reputation": 165, "user_id": 6201018, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/cb8c5d01ff858cc52f66656462c238b1?s=128&d=identicon&r=PG&f=1", "display_name": "edd91", "link": "https://stackoverflow.com/users/6201018/edd91"}, "edited": false, "score": 0, "creation_date": 1460585015, "post_id": 36610162, "comment_id": 60817441, "body": "Hi AnT, thanks for pointing this error out. I have changed it to the fread(buffer, sizeof buffer, 1, file) but am still getting a segmentation fault unfortunately."}, {"owner": {"reputation": 165, "user_id": 6201018, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/cb8c5d01ff858cc52f66656462c238b1?s=128&d=identicon&r=PG&f=1", "display_name": "edd91", "link": "https://stackoverflow.com/users/6201018/edd91"}, "edited": false, "score": 0, "creation_date": 1460585162, "post_id": 36610162, "comment_id": 60817516, "body": "Hi AnT, I&#39;ve included the new valgrind errors in my original post. Thanks"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 165, "user_id": 6201018, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/cb8c5d01ff858cc52f66656462c238b1?s=128&d=identicon&r=PG&f=1", "display_name": "edd91", "link": "https://stackoverflow.com/users/6201018/edd91"}, "edited": false, "score": 0, "creation_date": 1460585747, "post_id": 36610162, "comment_id": 60817767, "body": "@edd91: Your code is incomplete, which makes it impossible to analyze it fully. However, as I added above, your <code>title</code> needs to be larger."}, {"owner": {"reputation": 165, "user_id": 6201018, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/cb8c5d01ff858cc52f66656462c238b1?s=128&d=identicon&r=PG&f=1", "display_name": "edd91", "link": "https://stackoverflow.com/users/6201018/edd91"}, "edited": false, "score": 0, "creation_date": 1460586547, "post_id": 36610162, "comment_id": 60818074, "body": "Hi @ant thanks for your help! It&#39;s fixed now, the title thing was throwing it after fixing the first issue.  How come I needed space for a \\0 in title but not buffer? i.e. why shouldn&#39;t buffer be 513?"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 165, "user_id": 6201018, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/cb8c5d01ff858cc52f66656462c238b1?s=128&d=identicon&r=PG&f=1", "display_name": "edd91", "link": "https://stackoverflow.com/users/6201018/edd91"}, "edited": false, "score": 0, "creation_date": 1460586750, "post_id": 36610162, "comment_id": 60818173, "body": "@edd91: Function <code>sprintf</code> builds a <i>string</i> in the target buffer. Which means that it writes the characters to the buffer and then caps them with a terminating <code>\\0</code> character. That&#39;s how <i>strings</i> are built in C. A string of 7 characters long requires 8 characters to store it. Meanwhile, <code>fread</code> function does not work with strings and knows nothing about strings. It simply reads bytes from a file, as many as you ask it to read. It does not attempt to cap these bytes with any extra characters. You asked it to read 512 bytes - it read exactly 512 bytes. It does not do anything else."}, {"owner": {"reputation": 165, "user_id": 6201018, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/cb8c5d01ff858cc52f66656462c238b1?s=128&d=identicon&r=PG&f=1", "display_name": "edd91", "link": "https://stackoverflow.com/users/6201018/edd91"}, "edited": false, "score": 0, "creation_date": 1460587067, "post_id": 36610162, "comment_id": 60818312, "body": "Thanks @ant much appreciated"}], "tags": [], "owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "is_accepted": true, "score": 7, "last_activity_date": 1460585620, "last_edit_date": 1460585620, "creation_date": 1460584011, "answer_id": 36610162, "question_id": 36610127, "link": "https://stackoverflow.com/questions/36610127/why-does-this-buffer-point-to-unaddressable-bytes/36610162#36610162", "title": "Why does this buffer point to unaddressable bytes?", "body": "<p>By doing this</p>\n\n<pre><code>fread(buffer, sizeof(buffer), 512, file)\n</code></pre>\n\n<p>you are asking <code>fread</code> to read 512 blocks, each block being <code>sizeof(buffer)</code> bytes long. I.e. you are trying to read 512*512 = 262144 bytes into an array declared as <code>uint8_t buffer[512]</code>. That certainly won't fit.</p>\n\n<p>If you simply want to read data into the <code>buffer</code> array, that would be either</p>\n\n<pre><code>fread(buffer, sizeof buffer, 1, file)\n</code></pre>\n\n<p>or </p>\n\n<pre><code>fread(buffer, 1, sizeof buffer, file)\n</code></pre>\n\n<p>or, if you prefer,</p>\n\n<pre><code>fread(buffer, sizeof *buffer, sizeof buffer / sizeof *buffer, file)\n</code></pre>\n\n<p>depending on what you consider an \"atomic\" data block in your read operation.</p>\n\n<hr>\n\n<p>Also</p>\n\n<pre><code>sprintf(title, \"%03d.jpg\", currentImage);\n</code></pre>\n\n<p>will generate a string at least 7 characters long (e.g. <code>001.jpg</code>), which means that <code>title</code> has to be at least 8 characters long to accommodate zero terminator. However, your <code>title</code> is declared as</p>\n\n<pre><code>char title[7];\n</code></pre>\n\n<p>This is too small.</p>\n"}, {"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 1, "last_activity_date": 1460584417, "last_edit_date": 1460584417, "creation_date": 1460584102, "answer_id": 36610182, "question_id": 36610127, "link": "https://stackoverflow.com/questions/36610127/why-does-this-buffer-point-to-unaddressable-bytes/36610182#36610182", "title": "Why does this buffer point to unaddressable bytes?", "body": "<p>As per the <a href=\"http://linux.die.net/man/3/fread\" rel=\"nofollow\">man page</a> of <code>fread()</code>, the signature is</p>\n\n<blockquote>\n  <p><code>size_t fread(void *ptr, size_t size, size_t nmemb, FILE * stream );</code></p>\n</blockquote>\n\n<p>where the description is</p>\n\n<blockquote>\n  <p>The function <code>fread()</code> reads <code>nmemb</code> elements of data, each <code>size</code> bytes long, from the stream pointed to by <code>stream</code>, storing them at the location given by <code>ptr</code>.</p>\n</blockquote>\n\n<p>So, your code should be</p>\n\n<pre><code> while (fread(buffer, sizeof(buffer[0]), 512, file) == 1)\n</code></pre>\n\n<p>Otherwise, you're ending up asking to read and store 512 number of blocks of size 512 bytes <strong>each</strong>, which is wrong and will cause buffer overflow, as reported by valgrind.</p>\n"}], "owner": {"reputation": 165, "user_id": 6201018, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/cb8c5d01ff858cc52f66656462c238b1?s=128&d=identicon&r=PG&f=1", "display_name": "edd91", "link": "https://stackoverflow.com/users/6201018/edd91"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1551, "favorite_count": 0, "accepted_answer_id": 36610162, "answer_count": 2, "score": 3, "last_activity_date": 1460585641, "creation_date": 1460583840, "last_edit_date": 1460585641, "question_id": 36610127, "link": "https://stackoverflow.com/questions/36610127/why-does-this-buffer-point-to-unaddressable-bytes", "title": "Why does this buffer point to unaddressable bytes?", "body": "<p>EDIT: Thanks to repliers I have changed fread to (...sizeof buffer, 1,...), but now I get this error in valgrind:</p>\n\n<pre><code>==2409== Invalid read of size 4\n==2409==    at 0x51AB8D0: fread (iofread.c:41)\n==2409==    by 0x4007B6: main (recover2.c:31)\n==2409==  Address 0x5502000 is not stack'd, malloc'd or (recently) free'd\n==2409== \n==2409== Use of uninitialised value of size 8\n==2409==    at 0x51B8787: _IO_sgetn (genops.c:495)\n==2409==    by 0x51AB93E: fread (iofread.c:42)\n==2409==    by 0x4007B6: main (recover2.c:31)\n==2409== \n==2409== Invalid read of size 8\n==2409==    at 0x51B8787: _IO_sgetn (genops.c:495)\n==2409==    by 0x51AB93E: fread (iofread.c:42)\n==2409==    by 0x4007B6: main (recover2.c:31)\n==2409==  Address 0x40 is not stack'd, malloc'd or (recently) free'd\n==2409== \n==2409== \n==2409== Process terminating with default action of signal 11 (SIGSEGV)\n==2409==  Access not within mapped region at address 0x40\n==2409==    at 0x51B8787: _IO_sgetn (genops.c:495)\n==2409==    by 0x51AB93E: fread (iofread.c:42)\n==2409==    by 0x4007B6: main (recover2.c:31)\n==2409==  If you believe this happened as a result of a stack\n==2409==  overflow in your program's main thread (unlikely but\n==2409==  possible), you can try to increase the size of the\n==2409==  main thread stack using the --main-stacksize= flag.\n==2409==  The main thread stack size used in this run was 8388608.\n</code></pre>\n\n<hr>\n\n<p>I'm new here so I hope this makes sense. I'm writing this code to retrieve data from a file and copy it out to jpeg files. The code is meant to find a jpg file by its header then write it to files. The code is:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;string.h&gt;\n\nint main(int argc, char* argv[])\n{\n\nFILE* file = fopen(\"card.raw\", \"r\");\nif (file == NULL)\n{ \n    printf(\"Could not open file!\\n\");\n    return 1;\n}\n\nchar title[7];\nint currentImage = 0;\nuint8_t buffer[512];\nFILE* img;\nwhile (fread(buffer, sizeof(buffer), 512, file) == 1)\n{\nprintf(\"found data!\\n\");\nif (buffer[0] == 0xff &amp;&amp; buffer[1] == 0xd8 &amp;&amp; buffer[2] == 0xff)\n{\n    if (buffer[3] == 0xe0 || buffer[3] == 0xe1 || buffer[3] == 0xe2 || buffer[3] == 0xe3 || buffer[3] == 0xe4 || buffer[3] == 0xe5 || buffer[3] == 0xe6 || buffer[3] == 0xe7 || buffer[3] == 0xe8 || buffer[3] == 0xe9 || buffer[3] == 0xea || buffer[3] == 0xeb || buffer[3] == 0xec || buffer[3] == 0xed || buffer[3] == 0xee || buffer[3] == 0xef)\n    {\n        printf(\"Found new jpg!\\n\");\n        sprintf(title, \"%03d.jpg\", currentImage);\n        img = fopen(title, \"a\");\n        currentImage++;\n        printf(\"size of buffer to print is %lu\\n\", sizeof(buffer));\n        fwrite(buffer, sizeof(buffer), 1, img);\n        }\n}\nelse if (currentImage &gt; 0)\n{ \n        fwrite(buffer, sizeof(buffer), 1, img);\n\n\n}\n\n}\n}\n</code></pre>\n\n<p>I am getting a segmentation fault once it finds a jpeg, and does the fwrite, and then returns to the while loop.</p>\n\n<p>The valgrind error is:</p>\n\n<pre><code>==1866== Syscall param read(buf) points to unaddressable byte(s)\n==1866==    at 0x5228810: __read_nocancel (syscall-template.S:81)\n==1866==    by 0x51B63B8: _IO_file_xsgetn (fileops.c:1438)\n==1866==    by 0x51AB93E: fread (iofread.c:42)\n==1866==    by 0x4007C3: main (recover2.c:31)\n==1866==  Address 0xfff001000 is not stack'd, malloc'd or (recently) free'd\n==1866== \n==1866== Jump to the invalid address stated on the next line\n==1866==    at 0x0: ???\n==1866==  Address 0x0 is not stack'd, malloc'd or (recently) free'd\n==1866== \n==1866== \n==1866== Process terminating with default action of signal 11 (SIGSEGV)\n==1866==  Bad permissions for mapped region at address 0x0\n==1866==    at 0x0: ???\n</code></pre>\n\n<p>I'm new to this so still learning about memory and etc, so any help in understanding why it's gone wrong would be appreciated.</p>\n"}, {"tags": ["c", "matrix", "int", "unsigned-char"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1460583383, "post_id": 36609936, "comment_id": 60816703, "body": "Multiply col by 16 and add row.  There&#39;s your index."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1460584124, "post_id": 36609936, "comment_id": 60817068, "body": "<code>yValue * 16 + xValue</code>. Of course, it all depends on whether you filled the buffer correctly."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1460584503, "post_id": 36609936, "comment_id": 60817229, "body": "Why not use a 2D array?"}, {"owner": {"reputation": 29, "user_id": 6088363, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dacb5df4ce42f69481dad8c380e7ad6b?s=128&d=identicon&r=PG&f=1", "display_name": "TyrantUT", "link": "https://stackoverflow.com/users/6088363/tyrantut"}, "edited": false, "score": 0, "creation_date": 1460584575, "post_id": 36609936, "comment_id": 60817262, "body": "With some tweaking for indexes, this is exactly what I was looking for. Thank you much. Sometimes the basics just get passed over..."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 6088363, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dacb5df4ce42f69481dad8c380e7ad6b?s=128&d=identicon&r=PG&f=1", "display_name": "TyrantUT", "link": "https://stackoverflow.com/users/6088363/tyrantut"}, "edited": false, "score": 0, "creation_date": 1460591397, "post_id": 36611055, "comment_id": 60819796, "body": "That&#39;s really awesome of you, thank you. I was able to adopt a few of these things. What would be a higher performance hit, reading from buffer, or moving to an array. A call will be made to check values 256 times (to get each value) for specific input."}, {"owner": {"reputation": 192, "user_id": 5947477, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NkNmP.jpg?s=128&g=1", "display_name": "anita2R", "link": "https://stackoverflow.com/users/5947477/anita2r"}, "reply_to_user": {"reputation": 29, "user_id": 6088363, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dacb5df4ce42f69481dad8c380e7ad6b?s=128&d=identicon&r=PG&f=1", "display_name": "TyrantUT", "link": "https://stackoverflow.com/users/6088363/tyrantut"}, "edited": false, "score": 0, "creation_date": 1460593543, "post_id": 36611055, "comment_id": 60820377, "body": "I don&#39;t know enough to say if one or other is the best.  However there is a lot of information available about conventional arrays, including how they are passed to functions and how arrays can be accessed - not just by &#39;[ ]&#39; subscripts but also by manipulating pointers to arrays, so I would certainly go for conventional arrays - but it&#39;s all good learning.  If you thought my answer was useful please give it a +1 or an accept - or not - your call."}], "tags": [], "owner": {"reputation": 192, "user_id": 5947477, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NkNmP.jpg?s=128&g=1", "display_name": "anita2R", "link": "https://stackoverflow.com/users/5947477/anita2r"}, "is_accepted": false, "score": 2, "last_activity_date": 1460588577, "creation_date": 1460588577, "answer_id": 36611055, "question_id": 36609936, "link": "https://stackoverflow.com/questions/36609936/read-buffer-as-matrix-using-x-and-y-values-in-c/36611055#36611055", "title": "Read buffer as matrix using X and Y values in C", "body": "<p>This demonstrates using a buffer as an array and copying the buffer 'array' into a real array.   </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n    int n;\n    int x, y;\n    int arr[16][16];\n    int xtest =2, ytest =12; //'random values to test that it works\n\n    /* allocate space for a buffer of 256 values in the range 0 to 255) */\n    unsigned char *buffer = malloc(256 * sizeof (unsigned char));\n\n    /* fill the buffer with sequential values from 0 to 255 */\n    for (n = 0; n &lt; 256; n++) {\n        buffer[n] = n;\n    }\n\n    /* just to check the fill was OK - print out the buffer contents */\n    for (n = 0; n &lt; 256; n++) {\n        printf(\"%d .. \", buffer[n]);\n    }\n    printf(\"\\n\\n\");\n\n   /* fill a 16 * 16 array with values from the buffer\n       that the buffer data is arranged in 16 groups of 16 values in a \n       single sequential buffer */\n    for (x = 0; x &lt; 16; x++) {\n        for (y = 0; y &lt; 16; y++) {\n            arr[x][y] = buffer[(x * 16) + y];\n        }\n    }\n\n    /* print out the array */\n    for (x = 0; x &lt; 16; x++) {\n        for (y = 0; y &lt; 16; y++) {\n            printf(\"%d\\t\", arr[x][y]);\n        }\n        printf(\"\\n\");\n    }\n    printf(\"\\n\\n\");\n\n    /* just print a 'random' xy value from the matrix and from the buffer\n       they will be the same (we hope) */\n    printf(\"X=%d,Y=%d, Matrix[%d][%d] is: %d ... and Buffer %d,%d is %d\\n\",\n            xtest, ytest, xtest, ytest, arr[xtest][ytest],\n            xtest, ytest, buffer[(xtest * 16) + ytest]);\n    if (arr[xtest][ytest] == buffer[(xtest * 16) + ytest]) {\n        printf(\"Wow - they ARE the same\\n\");\n        } else {\n        printf(\"Oh No - they are different\\n\");\n    }\n}    \n</code></pre>\n\n<p>Sample output<br>\n<code>X=2,Y=12, Matrix[2][12] is: 44 ... and Buffer 2,12 is 44\nWow - they ARE the same</code></p>\n"}], "owner": {"reputation": 29, "user_id": 6088363, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dacb5df4ce42f69481dad8c380e7ad6b?s=128&d=identicon&r=PG&f=1", "display_name": "TyrantUT", "link": "https://stackoverflow.com/users/6088363/tyrantut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 286, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1460588577, "creation_date": 1460583053, "question_id": 36609936, "link": "https://stackoverflow.com/questions/36609936/read-buffer-as-matrix-using-x-and-y-values-in-c", "title": "Read buffer as matrix using X and Y values in C", "body": "<p>I have a buffer that contains 256 integers, so creating a 16x16 matrix. What I'm trying to accomplish is reading a value stored in the buffer as if it were a matrix.\nSo if I give coordinates of 5 and 3, I should get the value where Y is 5, and Y is X.</p>\n\n<p>For example, here is a small portion of the buffer, but in a 16x3 matrix for easy reading, and consider this a starting index of 0 rather than 1)</p>\n\n<pre><code>0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5\n7 8 9 1 2 3 4 5 6 7 8 9 1 2 3 4\n4 5 6 7 8 9 1 0 2 3 4 5 6 7 8 9\n</code></pre>\n\n<p>So if I were to try to get the values at say, Y = 2, and X = 5, I should return the value 9.</p>\n\n<p>Here is some of the code I have already, but my math is off.</p>\n\n<pre><code>unsigned char getTablevalue(int tableIndex, unsigned char *buffer) {\n    return buffer[tableIndex];\n}\n\nvoid getInput(....) {\n    int yValue = 2;\n    int xValue = 5;\n    int returnValue = 0;\n    unsigned char *buffer = malloc(256 * sizeof (unsigned char));\n    memset(buffer, 0, 256);\n\n    ... Some code to fill buffer...\n    returnValue = getTablevalue({what can I put here}, buffer); \n\n}\n</code></pre>\n\n<p>Any help with this would be greatly appreciated! Thank you in advance.</p>\n"}, {"tags": ["c++", "c", "linux", "installation"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6199234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b4c5a32169179382acf0ff7ab5f0a2d?s=128&d=identicon&r=PG&f=1", "display_name": "Bill Gray", "link": "https://stackoverflow.com/users/6199234/bill-gray"}, "edited": false, "score": 0, "creation_date": 1460652400, "post_id": 36609872, "comment_id": 60854192, "body": "Thank you.  Hadn&#39;t heard of &#39;install&#39;,  but &#39;man install&#39; brings me up to speed.  Renaming to &#39;libexample.a&#39; didn&#39;t help;  I&#39;ll continue to investigate.  Your suggestion for a per-user setup seems reasonable, though I do find it odd that there isn&#39;t a more &quot;standard&quot; way of doing this... surely I&#39;m not the first to run into this situation?"}, {"owner": {"reputation": 11, "user_id": 6199234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b4c5a32169179382acf0ff7ab5f0a2d?s=128&d=identicon&r=PG&f=1", "display_name": "Bill Gray", "link": "https://stackoverflow.com/users/6199234/bill-gray"}, "edited": false, "score": 1, "creation_date": 1460660988, "post_id": 36609872, "comment_id": 60859127, "body": "Ah,  I see where I goofed (and &#39;man ld&#39; and looking at the -l option confirms this):  the file must be named &#39;libfoo.a&#39;.  One can then use either &#39;-lfoo&#39;,  and ld will tack the lib in front and .a after it.  <i>Or</i> you can use &#39;-l:libfoo.a&#39;,  and it&#39;ll treat it literally.  Thanks again;  this was quite baffling..."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 11, "user_id": 6199234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b4c5a32169179382acf0ff7ab5f0a2d?s=128&d=identicon&r=PG&f=1", "display_name": "Bill Gray", "link": "https://stackoverflow.com/users/6199234/bill-gray"}, "edited": false, "score": 0, "creation_date": 1460662722, "post_id": 36609872, "comment_id": 60860156, "body": "Nice. I didn&#39;t know about <code>:</code>. Too bad I can&#39;t seem to be able to get it to work for shared libraries where I could really use it (only for static ones)."}], "tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": true, "score": 1, "last_activity_date": 1460654681, "last_edit_date": 1460654681, "creation_date": 1460582843, "answer_id": 36609872, "question_id": 36609720, "link": "https://stackoverflow.com/questions/36609720/simple-installation-from-source-on-linux/36609872#36609872", "title": "Simple installation from source on Linux", "body": "<p>You should probably use <code>install</code> to copy with explicit permissions. <code>example.a</code> probably isn't being found because it doesn't start with lib (a stupid requirement, I know).</p>\n\n<p>Putting your <code>lib</code>, <code>include</code>, and <code>bin</code> under <code>$HOME/</code>.local is probably the closest thing to a per-user standard setup.</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>I just tested it and it <code>/usr/local/lib</code> works fine for me:</p>\n\n<p><strong>foo.c</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\nvoid foo() { puts(\"foo\"); }\n</code></pre>\n\n<p>Compile and install:</p>\n\n<pre><code>gcc -c foo.c\nar crs libfoo.a foo.o\ninstall -m 0755 /usr/local/lib #0644 should do too\n</code></pre>\n\n<p>In a different directory:</p>\n\n<p><strong>main.c</strong></p>\n\n<pre><code>void foo(void);\nint main() { foo(); return 0; }\n</code></pre>\n\n<p>Compile, link, and run:</p>\n\n<pre><code>gcc main.c -lfoo \n./a.out\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6199234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b4c5a32169179382acf0ff7ab5f0a2d?s=128&d=identicon&r=PG&f=1", "display_name": "Bill Gray", "link": "https://stackoverflow.com/users/6199234/bill-gray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 36609872, "answer_count": 1, "score": 0, "last_activity_date": 1460654681, "creation_date": 1460582197, "question_id": 36609720, "link": "https://stackoverflow.com/questions/36609720/simple-installation-from-source-on-linux", "title": "Simple installation from source on Linux", "body": "<p>I'm trying to figure out a simplified way for installing C and C++ code\nand libraries built from them,  primarily for Linux.  I <em>think</em> GNU Autotools,  CMake,  etc. would be overkill for what I'm trying to do.</p>\n\n<p>An example:  I've written some code which,  when 'make' is run,  builds to\ncreate a library 'example.a'.  (I'm going with static linking thus far.\nShared libraries will introduce still more issues;  I'll crawl before I walk.)  Use of the functions requires including 'example1.h', 'example2.h',  etc.</p>\n\n<p>With Autotools,  one would run 'make install' or 'sudo make install' to\ncopy example.a to /usr/local/lib and the include files to /usr/local/include.\nIf executables had been built,  those would get copied to /usr/local/bin.</p>\n\n<p>I've tried adding the following lines to my makefile:</p>\n\n<p>install:<br>\n    cp example.a /usr/local/lib<br>\n    cp example1.h /usr/local/include<br>\n    cp example2.h /usr/local/include<br>\n    cp example /usr/local/bin</p>\n\n<p>This seems to work,  mostly.  Other projects are then able to \"see\"\nthe .h files and build correctly.  But the .a file is not found;  the only\nway to get it to be linked is to explicitly give the path as\n/usr/local/lib/example.a.   (Though gcc insists it's looking for libraries\nin that path.)  So:</p>\n\n<p>Question 1:  Should my user-built libraries be put in /usr/local/lib?  Or am\nI using the wrong directory?</p>\n\n<p>Now,  my next problem:  this has to be done with 'sudo make install'.\nI'm thinking that for some projects of this ilk,  where only one user will\nbe making use of the code in question,  the libraries should go someplace\nsuch as $HOME/lib,  include files to $HOME/include,  executables to\n$HOME/bin.</p>\n\n<p>Question 2:  Is there a \"standard\" way to install includes/libraries for\njust the current user,  rather than doing so for all users?  (Thus avoiding\nthe need for root use,  and I'd think it would be a \"cleaner\" system if only\nthe user using the program had to deal with these files.)</p>\n"}, {"tags": ["c", "pthreads"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1460581788, "post_id": 36609561, "comment_id": 60815878, "body": "Count your brackets and learn how to specify arguments in a function call."}, {"owner": {"reputation": 1136, "user_id": 2999921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0564f700a2fe14bc0aa8152a5b97925?s=128&d=identicon&r=PG", "display_name": "cwschmidt", "link": "https://stackoverflow.com/users/2999921/cwschmidt"}, "edited": false, "score": 0, "creation_date": 1460582003, "post_id": 36609561, "comment_id": 60815992, "body": "<code>void main()</code> is illegal, use <code>int main()</code> instead."}], "answers": [{"comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1460581845, "post_id": 36609592, "comment_id": 60815907, "body": "Note that the brackets are unbalanced as well:("}, {"owner": {"reputation": 349, "user_id": 6057497, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/27cd93684cd2360361f8eff4ab8385ba?s=128&d=identicon&r=PG&f=1", "display_name": "Trever Wagenhals", "link": "https://stackoverflow.com/users/6057497/trever-wagenhals"}, "edited": false, "score": 0, "creation_date": 1460585377, "post_id": 36609592, "comment_id": 60817612, "body": "@cwshmidt, and Martin, I tried the recommend changes and get different, or at least the same errors. And i numbered the brackets, can someone explain to me how they aren&#39;t set up right?"}], "tags": [], "owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "is_accepted": false, "score": 0, "last_activity_date": 1460581683, "creation_date": 1460581683, "answer_id": 36609592, "question_id": 36609561, "link": "https://stackoverflow.com/questions/36609561/pthread-in-c-unexpected-declaration-speifiers-or-before/36609592#36609592", "title": "pthread in c unexpected declaration speifiers or &#39;...&#39; before &#39;(&#39;", "body": "<p>Remove the (parenthesis) around void * on those lines. </p>\n"}, {"comments": [{"owner": {"reputation": 349, "user_id": 6057497, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/27cd93684cd2360361f8eff4ab8385ba?s=128&d=identicon&r=PG&f=1", "display_name": "Trever Wagenhals", "link": "https://stackoverflow.com/users/6057497/trever-wagenhals"}, "edited": false, "score": 0, "creation_date": 1460588021, "post_id": 36610535, "comment_id": 60818662, "body": "I did what you said and it did not knock down a number of the issues. I tried to do the same thing with the other variable that had a similar issue, but I still have one error. Any ideas? Thanks in advance, and sorry I&#39;m not too knowledgeable in this field."}], "tags": [], "owner": {"reputation": 34711, "user_id": 5974433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ojtxg.jpg?s=128&g=1", "display_name": "Marcin Mo\u017cejko", "link": "https://stackoverflow.com/users/5974433/marcin-mo%c5%bcejko"}, "is_accepted": false, "score": 0, "last_activity_date": 1460585753, "creation_date": 1460585753, "answer_id": 36610535, "question_id": 36609561, "link": "https://stackoverflow.com/questions/36609561/pthread-in-c-unexpected-declaration-speifiers-or-before/36610535#36610535", "title": "pthread in c unexpected declaration speifiers or &#39;...&#39; before &#39;(&#39;", "body": "<p>Try <code>void *userchoice</code> and </p>\n\n<pre><code>int user = *((int*)userchoice);\n</code></pre>\n\n<p>You cannot do anything with <code>void *</code> before you cast it.</p>\n"}, {"comments": [{"owner": {"reputation": 349, "user_id": 6057497, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/27cd93684cd2360361f8eff4ab8385ba?s=128&d=identicon&r=PG&f=1", "display_name": "Trever Wagenhals", "link": "https://stackoverflow.com/users/6057497/trever-wagenhals"}, "edited": false, "score": 0, "creation_date": 1460590925, "post_id": 36611259, "comment_id": 60819638, "body": "that got rid of all of the issues, thank you everyone for pointing at the issues."}], "tags": [], "owner": {"reputation": 67, "user_id": 4293156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba25cf52f73d949801368ad3e4515d8e?s=128&d=identicon&r=PG&f=1", "display_name": "mausik", "link": "https://stackoverflow.com/users/4293156/mausik"}, "is_accepted": true, "score": 1, "last_activity_date": 1460589917, "creation_date": 1460589917, "answer_id": 36611259, "question_id": 36609561, "link": "https://stackoverflow.com/questions/36609561/pthread-in-c-unexpected-declaration-speifiers-or-before/36611259#36611259", "title": "pthread in c unexpected declaration speifiers or &#39;...&#39; before &#39;(&#39;", "body": "<p>For the last warning, you want to cast <code>void*</code> to <code>char*</code>, but with <code>*((char*)server_buffer</code> you are dereferencing pointer to <code>server_buffer</code> and casting <code>void*</code> to <code>char</code> and not to <code>char*</code>.</p>\n\n<p>The proper way is:</p>\n\n<pre><code>const char* send_to_server = (char*)server_buffer;\n</code></pre>\n"}], "owner": {"reputation": 349, "user_id": 6057497, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/27cd93684cd2360361f8eff4ab8385ba?s=128&d=identicon&r=PG&f=1", "display_name": "Trever Wagenhals", "link": "https://stackoverflow.com/users/6057497/trever-wagenhals"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 261, "favorite_count": 0, "accepted_answer_id": 36611259, "answer_count": 3, "score": 0, "last_activity_date": 1460589917, "creation_date": 1460581557, "last_edit_date": 1460587957, "question_id": 36609561, "link": "https://stackoverflow.com/questions/36609561/pthread-in-c-unexpected-declaration-speifiers-or-before", "title": "pthread in c unexpected declaration speifiers or &#39;...&#39; before &#39;(&#39;", "body": "<p>here is a snippet of a program I've been working on. Basically, I am getting the same error message twice as described by the title. This is my first time working with pthreads so if someone can tell me what I'm doing wrong I'd appreciate it.</p>\n\n<pre><code>#include &lt;pthread.h&gt;\n#include &lt;stdio.h&gt;\n\nvoid *User_choices();\nvoid *Switch_statement(void *);\nvoid *Server_function(void *);\n\npthread_t SEND_TO_SERVER_THREAD;\npthread_t PIC_COMMUNICATION_THREAD;\npthread_t USER_INTERFACE_THREAD;\n\nchar buf[1024];\n\nvoid main()\n{ // 1\n    snprintf(buf, 1024, \"string\");  \n    while(1)\n        { // 2\n        pthread_create(&amp;USER_INTERFACE_THREAD, NULL, User_choices, NULL);  \n        } // 3\n} // 4\n\nvoid *User_choices()\n{ // 5\n    int userinput;\n    printf(\"Type 0 to reset sensor, 1 to ping, 2 to receive ADC value, 3 to quit the program: \");\n    scanf(\"%i\", &amp;userinput);\n    pthread_create(&amp;PIC_COMMUNICATION_THREAD, NULL, Switch_statement, &amp;userinput);\n} // 6\n\nvoid *Switch_statement((void *)userchoice))\n{ // 7\n    int user = (int)*userchoice;\n    switch(user) \n    { // 8\n        case 1:         \n                printf(\"OTHER FUNCTIONS USUALLY GO HERE \\n\");\n                break;\n        case 2:                                     //RETRIEVE ADC CASE\n\n                pthread_create(&amp;SEND_TO_SERVER_THREAD, NULL, Server_function, (void *)&amp;buffer); \n                break;\n        case 3:\n                exit(0);    \n        case 0:                                     //RESET CASE\n                printf(\"ONCE AGAIN, OTHER FUNCTIONS USUALLY GO HERE\");\n                break;                          //EXIT THE PROGRAM\n        default:\n                printf(\"Your entry is not a valid option! Try again \\n\");                               \n    } // 9\n} // 10\n\nvoid *Server_function((void *)server_buffer))\n{ // 11\n    const char* send_to_server = (char)*server_buffer;\n    HTTP_GET(send_to_server);\n} // 12\n</code></pre>\n\n<p>Here are the error codes:</p>\n\n<pre><code>justpthread.c:31:24: error: expected declaration specifiers or \u2018...\u2019 before \u2018(\u2019 token\n void *Switch_statement((void *)userchoice))\n                        ^\njustpthread.c:53:23: error: expected declaration specifiers or \u2018...\u2019 before \u2018(\u2019 token\n void *Server_function((void *)server_buffer))\n</code></pre>\n\n<p>If I change just void main to int main, I get the same two error codes. If i take out the parentheses surround (void *), no matter when it's int main or void main, i get the following:</p>\n\n<pre><code>justpthread.c: In function \u2018Switch_statement\u2019:\njustpthread.c:33:18: warning: dereferencing \u2018void *\u2019 pointer [enabled by default]\n  int user = (int)*userchoice;\n                  ^\njustpthread.c:33:2: error: invalid use of void expression\n  int user = (int)*userchoice;\n  ^\njustpthread.c:41:76: error: \u2018buffer\u2019 undeclared (first use in this function)\n     pthread_create(&amp;SEND_TO_SERVER_THREAD, NULL, Server_function, (void *)&amp;buffer); \n                                                                            ^\njustpthread.c:41:76: note: each undeclared identifier is reported only once for each function it appears in\njustpthread.c:44:5: warning: incompatible implicit declaration of built-in function \u2018exit\u2019 [enabled by default]\n     exit(0); \n     ^\njustpthread.c: In function \u2018Server_function\u2019:\njustpthread.c:55:37: warning: dereferencing \u2018void *\u2019 pointer [enabled by default]\n  const char* send_to_server = (char)*server_buffer;\n                                     ^\njustpthread.c:55:2: error: invalid use of void expression\n  const char* send_to_server = (char)*server_buffer;\n  ^\n</code></pre>\n\n<p>And you guys have me incredibly confused as far as the brackets go, so I numbered all of them. I'm seeing an even number, and they look like they alter directions properly.</p>\n\n<p>Going off of additional recommendations, I changed my code like so:</p>\n\n<pre><code>void main()\n{\n    snprintf(buf, 1024, \"string\");  \n    while(1)\n        {\n        pthread_create(&amp;USER_INTERFACE_THREAD, NULL, User_choices, NULL);  \n        }\n}\n\nvoid *User_choices()\n{\n    int userinput;\n    printf(\"Type 0 to reset sensor, 1 to ping, 2 to receive ADC value, 3 to quit the program: \");\n    scanf(\"%i\", &amp;userinput);\n    pthread_create(&amp;PIC_COMMUNICATION_THREAD, NULL, Switch_statement, &amp;userinput);\n}\n\nvoid *Switch_statement(void *userchoice)\n{\n    int user = *((int*)userchoice);\n    switch(user) \n    {\n        case 1:         \n                printf(\"OTHER FUNCTIONS USUALLY GO HERE \\n\");\n                break;\n        case 2:                                     //RETRIEVE ADC CASE\n\n                pthread_create(&amp;SEND_TO_SERVER_THREAD, NULL, Server_function, (void *)&amp;buf);    \n                break;\n        case 0:                                     //RESET CASE\n                printf(\"ONCE AGAIN, OTHER FUNCTIONS USUALLY GO HERE\");\n                break;                          //EXIT THE PROGRAM\n        default:\n                printf(\"Your entry is not a valid option! Try again \\n\");                               \n    }\n}\n</code></pre>\n\n<p>I changed int user... to     </p>\n\n<pre><code>int user = *((int*)userchoice); \n</code></pre>\n\n<p>as recommended, and so I got the following error messages:</p>\n\n<pre><code>justpthread.c: In function \u2018Server_function\u2019:\njustpthread.c:53:37: warning: dereferencing \u2018void *\u2019 pointer [enabled by default]\n  const char* send_to_server = (char)*server_buffer;\n                                     ^\njustpthread.c:53:2: error: invalid use of void expression\n  const char* send_to_server = (char)*server_buffer;\n</code></pre>\n\n<p>So it looks like it got rid of some of the previous errors. So I noticed now that server_buffer is having issues as well so I tried to change that to:</p>\n\n<pre><code>void *Server_function(void *server_buffer)\n{\n    const char* send_to_server = *((char*)server_buffer);\n    //HTTP_GET(send_to_server);\n}\n</code></pre>\n\n<p>And now I just have one error:</p>\n\n<pre><code>justpthread.c: In function \u2018Server_function\u2019:\njustpthread.c:53:31: warning: initialization makes pointer from integer without a cast [enabled by default]\n  const char* send_to_server = *((char*)server_buffer);\n</code></pre>\n"}, {"tags": ["c", "debugging"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 2, "creation_date": 1460581173, "post_id": 36609384, "comment_id": 60815528, "body": "How and what is <code>input</code> set to? Please show a <a href=\"http://stackoverflow.com/help/mcve\">minimal complete and verifiable example</a>"}, {"owner": {"reputation": 2211, "user_id": 1667840, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3a0eb2aabd323d1e50b4f8fe0caf59b1?s=128&d=identicon&r=PG&f=1", "display_name": "gidim", "link": "https://stackoverflow.com/users/1667840/gidim"}, "edited": false, "score": 0, "creation_date": 1460581230, "post_id": 36609384, "comment_id": 60815561, "body": "int digit_array[digit_count]; would not work.. read up on dynamically allocated arrays (malloc)"}, {"owner": {"reputation": 411, "user_id": 176464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcd15f3d36bf2200b7211555679b4f3d?s=128&d=identicon&r=PG", "display_name": "tobiasvl", "link": "https://stackoverflow.com/users/176464/tobiasvl"}, "edited": false, "score": 0, "creation_date": 1460581420, "post_id": 36609384, "comment_id": 60815675, "body": "Please include your <code>main()</code> method. For example, do you correctly convert <code>argv[1]</code> (ie. the number) from a <code>char*</code> to an <code>int</code>?"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "reply_to_user": {"reputation": 2211, "user_id": 1667840, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3a0eb2aabd323d1e50b4f8fe0caf59b1?s=128&d=identicon&r=PG&f=1", "display_name": "gidim", "link": "https://stackoverflow.com/users/1667840/gidim"}, "edited": false, "score": 2, "creation_date": 1460581680, "post_id": 36609384, "comment_id": 60815820, "body": "@gidim In what way would it not work? It&#39;s called a VLA (variable length array). Supported since c99 if I recall correctly."}, {"owner": {"reputation": 2211, "user_id": 1667840, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3a0eb2aabd323d1e50b4f8fe0caf59b1?s=128&d=identicon&r=PG&f=1", "display_name": "gidim", "link": "https://stackoverflow.com/users/1667840/gidim"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1460581865, "post_id": 36609384, "comment_id": 60815915, "body": "@kaylum - true. Although not sure if I should delete my comment since it is compiler/c version dependent."}, {"owner": {"reputation": 1, "user_id": 6200868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22683819bce79a5dc63719bc35fdb6fa?s=128&d=identicon&r=PG&f=1", "display_name": "JizzerWizard", "link": "https://stackoverflow.com/users/6200868/jizzerwizard"}, "edited": false, "score": 0, "creation_date": 1460581924, "post_id": 36609384, "comment_id": 60815947, "body": "thanks for the answers, i added the left out rest."}], "answers": [{"tags": [], "owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "is_accepted": false, "score": 0, "last_activity_date": 1460583326, "creation_date": 1460583326, "answer_id": 36610008, "question_id": 36609384, "link": "https://stackoverflow.com/questions/36609384/fixing-a-bug-in-my-simple-digit-program-c/36610008#36610008", "title": "Fixing a bug in my simple digit program (C)", "body": "<p>You unnecessarily complicated this task by introducing a second array. I tried to follow your thinking but gave up, and wrote this instead:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main (int argc, char *argv[])\n{   \n    if (argc != 2)\n    {\n        printf (\"no input?\\n\");\n        return -1;\n    }\n    int digit_amount[10] = {0};\n    int input = atoi(argv[1]);\n\n    while (input)\n    {\n        digit_amount[input % 10]++;\n        input /= 10;\n    }\n\n    printf(\"Repeated digits:\\n\");\n    int k;\n    for (k=0; k&lt;10; k++)\n    {\n        if(digit_amount[k] &gt;= 2)\n        {\n            printf(\"\\\"%i\\\" occurs %i times.\\n\",k,digit_amount[k]);\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>A few random notes:</p>\n\n<ol>\n<li><p>You don't need to explicitly set each member of <code>digit_amount</code> to 0. Just the first is enough to indicate to the compiler the entire array must be initialized to zero.</p></li>\n<li><p>Since you are using <code>int</code> and <code>atoi</code>, you must remember to limit your input to positive integers only.</p></li>\n<li><p>Counting digits can simply be done with increasing the array element <code>value % 10</code>.</p></li>\n<li><p>While you seem to use <code>while</code> correctly, the correct type of loop to use when printing out is <code>for</code>. That's what it's for.</p></li>\n<li><p>You will be receiving a warning from your compiler that you did not use <code>argc</code>. For safety, best add a test at the top so your input gets checked.</p></li>\n<li><p>Similar to <code>int main</code> not returning anything.</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 2165, "user_id": 6194193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NtIRr.jpg?s=128&g=1", "display_name": "L Bahr", "link": "https://stackoverflow.com/users/6194193/l-bahr"}, "is_accepted": false, "score": 0, "last_activity_date": 1460584419, "last_edit_date": 1460584419, "creation_date": 1460583501, "answer_id": 36610050, "question_id": 36609384, "link": "https://stackoverflow.com/questions/36609384/fixing-a-bug-in-my-simple-digit-program-c/36610050#36610050", "title": "Fixing a bug in my simple digit program (C)", "body": "<h1>The Fix</h1>\n\n<p>You are incrementing the wrong index.</p>\n\n<pre><code>digit_amount[j]++;\n</code></pre>\n\n<p>should be </p>\n\n<pre><code>digit_amount[digit]++;\n</code></pre>\n\n<p>You can see the code working at <a href=\"https://ideone.com/ajbJnd\" rel=\"nofollow\">https://ideone.com/ajbJnd</a></p>\n\n<p>NOTE: that in the working code <code>int input = atoi(argv[1]);</code> was replaced with <code>int input = atoi(\"31344842\");</code>. If you change it back it should work as is in your program!</p>\n\n<h1>Different Way</h1>\n\n<p>A cleaner way to do this would be to use the input as a string instead of converting it to an int.</p>\n\n<p>Code Example <a href=\"https://ideone.com/F0PTFz\" rel=\"nofollow\">https://ideone.com/F0PTFz</a></p>\n\n<p>Code Source:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(int argc, char * argv[]) {\n    char* input = \"31344842\";\n    int digit_count = 0;\n\n    digit_count = strlen(input); //count amount of digits in input\n\n\n    //count number of times a digit has appeared\n    int digit_amount[10] = {0,0,0,0,0,0,0,0,0,0};\n    int digit = 0;\n    while(digit&lt;10)\n    {\n        int count = 0;\n        char* singleDigit[1];\n        while(count &lt;= digit_count)\n        {\n            // Subtracting the character 0 from a character will give you its real int value\n            if((input[count] - '0') == digit)\n            {\n                digit_amount[digit]++;\n            }\n            count++;\n        }\n        digit++;\n    }\n    //final output\n    printf(\"Repeated digits:\\n\");\n    int k = 0;\n    while(k&lt;10)\n    {\n        if(digit_amount[k] &gt;= 2)\n        {\n            printf(\"\\\"%i\\\" occurs %i times.\\n\",k,digit_amount[k]);\n        }\n        k++;\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13033, "user_id": 4029014, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ndZhu.jpg?s=128&g=1", "display_name": "aghast", "link": "https://stackoverflow.com/users/4029014/aghast"}, "is_accepted": false, "score": 0, "last_activity_date": 1460583667, "creation_date": 1460583667, "answer_id": 36610085, "question_id": 36609384, "link": "https://stackoverflow.com/questions/36609384/fixing-a-bug-in-my-simple-digit-program-c/36610085#36610085", "title": "Fixing a bug in my simple digit program (C)", "body": "<p>I assume that you're just learning C. I don't know if you are familiar with strings and characters yet, or not. So let's look at two ways to get digits. </p>\n\n<p><strong>The string approach</strong></p>\n\n<p>First, you can take advantage of the fact that you know you are receiving a string command line argument that should consist of a series of ASCII digit characters. The ASCII digits are represented by the integer values 48..57 (base 10), or 0x30..0x39 (base 16). The digits run consecutively from 0, 1, ... 9, so you can do string comparisons easily and you can do simple math. Specifically, <code>d - '0'</code> will convert a digit <code>d</code> into the numeric value of that digit.</p>\n\n<pre><code>const char * Usage = \"Usage: myprog INT\\n\";\n\nvoid\nusage(void)\n{\n    print(Usage);\n    exit(1);\n}\n\nint\nmain(int argc, const char *argv[])\n{\n    if (argc &lt; 2) \n        usage();\n\n    const char * digitp = argv[1];\n    int digit_val;\n\n    while (*digitp) {\n        if (!isdigit(*digitp))\n            usage();\n\n        digit_val = *digitp++ - '0';\n        /* At this point digit_val contains a numeric value from 0..9 */\n    }\n\n    exit(0);\n}\n</code></pre>\n\n<p><strong>The integer approach</strong></p>\n\n<p>The string approach is the right way to go, unless you don't know about characters and strings or are somehow required to do it the other way by your class. In this case, we'll take some of your existing code:</p>\n\n<pre><code>int\nmain(int argc, const char *argv[])\n{\n    if (argc &lt; 2) \n        usage();\n\n    int number = atoi(argv[1]);\n\n    do {\n        digit_val = number % 10;\n        number /= 10;\n\n        /* At this point digit_val contains a numeric value from 0..9 */\n\n    }\n    while (number != 0);\n\n    exit(0);\n}\n</code></pre>\n\n<p>Note that these two skeletons are <em>different</em>. You might not care right now, but treating the value as a string allows for processing long sequences of digits that might cause an overflow when you call <code>atoi</code>. For example, a '1' followed by 2,000 zeros can be handled fine as a string, but cannot be represented as an integer on PC hardware.</p>\n\n<p>Similarly, a parameter like \"100x\" might be parsed by <code>atoi</code> but will be flagged as an error by the string approach.</p>\n\n<p><strong>Dealing with the digits</strong></p>\n\n<p>Once you have a loop with each digit in it, what do you do? Your code was on the right track:</p>\n\n<pre><code>digit_amount[digit_val] += 1;  /* increase frequency count */\n</code></pre>\n\n<p>That's ALL! You're counting how often the digits appear, you don't need to do any more.</p>\n\n<p>After the loop is finished, you can process all 10 frequency counts and see if any of them were repeated:</p>\n\n<pre><code>for (int digit = 0; digit &lt; 10; ++digit)\n    if (digit_amount[digit] &gt; 1)\n        printf(\"Digit %d is repeated %d times\\n\", digit, digit_amount[digit]);\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6200868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22683819bce79a5dc63719bc35fdb6fa?s=128&d=identicon&r=PG&f=1", "display_name": "JizzerWizard", "link": "https://stackoverflow.com/users/6200868/jizzerwizard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1460584419, "creation_date": 1460580854, "last_edit_date": 1460581866, "question_id": 36609384, "link": "https://stackoverflow.com/questions/36609384/fixing-a-bug-in-my-simple-digit-program-c", "title": "Fixing a bug in my simple digit program (C)", "body": "<p>Welp, I have been tasked with writing a program which, if executed with a number in the commandline, counts the different digits and puts out the recurring ones, like this:</p>\n\n<pre><code>./digitcount 31344842\n\"3\" occurs 2 times.\n\"4\" occurs 3 times.\n</code></pre>\n\n<p>However, I just cant get it to work:</p>\n\n<pre><code>int n = input;\nint digit_count = 0;\nwhile(n!=0)                     //count amount of digits in input\n{\n    digit_count++;\n    n /= 10;\n}\nint digit_array[digit_count];   //create array for digits\n\nint i = digit_count;\nwhile(i!=0)                     //assign digits to array elements\n{\n    digit_array[i-1] = input % 10;\n    input /= 10;\n    i--;\n}\n\n//count number of times a digit has appeared\nint digit_amount[10] = {0,0,0,0,0,0,0,0,0,0};\nint digit = 0;\nwhile(digit&lt;10)\n{\n    int j = 0;\n    while(j &lt;= digit_count)\n    {\n        if(digit_array[j] == digit)\n        {\n            digit_amount[j]++;\n        }\n        j++;\n    }\n    digit++;\n}\n//final output\nprintf(\"Repeated digits:\\n\");\nint k = 0;\nwhile(k&lt;10)\n{\n    if(digit_amount[k] &gt;= 2)\n    {\n        printf(\"\\\"%i\\\" occurs %i times.\\n\",k,digit_amount[k]);\n    }\n    k++;\n}\n</code></pre>\n\n<p>When I compile the program, no errors/warnings show up, yet upon execution I only get:</p>\n\n<pre><code>Repeated digits:\n</code></pre>\n\n<p>I tried around quite a bit with it and deduced that everything works up until the program starts counting the occurance of digits, then every number is counted to be included once, and just once.</p>\n\n<p>Does anyone know what happened here?\nPS: I'm quite a scrub at programming, so please take kindly to me if I made some really dumb error :P</p>\n\n<p>EDIT:</p>\n\n<p>The part missing at the top is:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(int argc, char * argv[])\n{   \n   int input = atoi(argv[1]);\n</code></pre>\n"}, {"tags": ["c", "windows"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1460581798, "post_id": 36609367, "comment_id": 60815887, "body": "Stackoverflow.com handles two kinds of questions: 1) help me, my program does not compile.  and 2) my code is not working as expected, here is the actual input, actual output, expected output, and the code.  We are not here to perform your research nor to write your code."}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1460585249, "post_id": 36609367, "comment_id": 60817552, "body": "A process can only have one standard output handle, so your parent process will need to read the output and (if necessary) print it to the console."}], "answers": [{"tags": [], "owner": {"reputation": 2165, "user_id": 6194193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NtIRr.jpg?s=128&g=1", "display_name": "L Bahr", "link": "https://stackoverflow.com/users/6194193/l-bahr"}, "is_accepted": false, "score": 0, "last_activity_date": 1460581705, "creation_date": 1460581705, "answer_id": 36609599, "question_id": 36609367, "link": "https://stackoverflow.com/questions/36609367/how-to-redirect-stdout-of-one-process-into-stdin-of-another-one/36609599#36609599", "title": "How to redirect stdout of one process into stdin of another one?", "body": "<p>Have you tried to create a pipe in your program?</p>\n\n<p>Microsoft has an example to do this:\n<a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms682499%28v=vs.85%29.aspx\" rel=\"nofollow\">Creating a Child Process with Redirected Input and Output</a></p>\n"}], "owner": {"reputation": 111, "user_id": 6200919, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/7862e2b2e4922aeb0e594f9c1b44d7eb?s=128&d=identicon&r=PG&f=1", "display_name": "Natan ZB", "link": "https://stackoverflow.com/users/6200919/natan-zb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1460581705, "creation_date": 1460580799, "last_edit_date": 1460580919, "question_id": 36609367, "link": "https://stackoverflow.com/questions/36609367/how-to-redirect-stdout-of-one-process-into-stdin-of-another-one", "title": "How to redirect stdout of one process into stdin of another one?", "body": "<p>I've searched and couldn't find an answer.\nI have created a sub-process (prog.exe) that prints (printf) out a message.</p>\n\n<pre><code>CreateProcessA(\"prog.exe\", NULL, NULL, NULL, NULL, NULL, NULL, NULL, (LPSTARTUPINFOA)&amp;si, (LPPROCESS_INFORMATION)&amp;pi)\n</code></pre>\n\n<p>I want my main process to get what prog.exe has printed.\nBut, I still want the message to be printed from prog.exe</p>\n\n<p>How can I do that? thanks!</p>\n"}, {"tags": ["c++", "c", "unix", "posix", "atomic"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2404501"}, "edited": false, "score": 3, "creation_date": 1460580446, "post_id": 36609252, "comment_id": 60815164, "body": "Can&#39;t you just do the rename part on the top level destination directory?"}, {"owner": {"reputation": 6166, "user_id": 2990144, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c65c7991822f827780a2cae38c5c31a2?s=128&d=identicon&r=PG", "display_name": "Seth Holladay", "link": "https://stackoverflow.com/users/2990144/seth-holladay"}, "edited": false, "score": 0, "creation_date": 1460582164, "post_id": 36609252, "comment_id": 60816077, "body": "Well I can&#39;t scan the filesystem to see which directories exist, as that breaks the atomicity. I also can&#39;t overwrite siblings which may exist from previous builds. I have updated the question to clarify the constraints of the problem."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1460583762, "post_id": 36609252, "comment_id": 60816890, "body": "You will need to do a mutex of some kind around the multiple filesystem operations."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2404501"}, "edited": false, "score": 0, "creation_date": 1460594640, "post_id": 36609252, "comment_id": 60820636, "body": "If <code>&#47;myproject&#47;build&#47;dev</code> doesn&#39;t exist, you should be able to <code>mkdir &#47;myproject&#47;build_tmp&#47;$random</code>, then put everything under there (not worrying about atomicity for this part since your other processes don&#39;t read anything from there), then, after <code>&#47;myproject&#47;build_tmp&#47;$random&#47;0.2.2&#47;...</code> is ready, <code>mv &#47;myproject&#47;build_tmp&#47;$random &#47;myproject&#47;build&#47;dev</code> and the whole thing appears atomically - any process looking in <code>build</code> will not see <code>dev</code> until the whole thing is moved into place. (Assuming <code>build</code> and <code>build_tmp</code> are on the same filesystem. If <code>build</code> is a mount point it&#39;ll be harder.)"}, {"owner": {"reputation": 6166, "user_id": 2990144, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c65c7991822f827780a2cae38c5c31a2?s=128&d=identicon&r=PG", "display_name": "Seth Holladay", "link": "https://stackoverflow.com/users/2990144/seth-holladay"}, "edited": false, "score": 0, "creation_date": 1460597906, "post_id": 36609252, "comment_id": 60821543, "body": "I was thinking along similar lines. But I can&#39;t know <code>dev</code> doesn&#39;t exist until I try to put something in there. In between the time I&#39;ve realized that (either by trying or checking with <code>stat</code>, etc) and then corrected for it, anything can happen. Creating the missing structure in the temporary space (or deciding which level of it to use) is only really possible as a second action after having read the state of the disk, thus opening the usual <a href=\"http://www.linuxsecurity.com/content/view/115462/151/\" rel=\"nofollow noreferrer\">can of worms</a>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2404501"}, "edited": false, "score": 0, "creation_date": 1460636145, "post_id": 36609252, "comment_id": 60841402, "body": "OK, so first you pessimistically assume that it doesn&#39;t exist. Don&#39;t check. Just go ahead and build the tmp tree. Then do the rename. If <code>dev</code> does exist (either it always did or it was created while you were populating the tmp tree), the attempt to rename over an existing directory will fail with <code>EEXISTS</code>. If you get that error, you move down one level and try renaming <i>that</i> into place, leaving behind an empty <code>dev</code> in the tmp space. Repeat until you succeed or run out of directories, in which case you&#39;re trying to atomically replace a populated directory with another populated directory..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2404501"}, "edited": false, "score": 0, "creation_date": 1460636175, "post_id": 36609252, "comment_id": 60841430, "body": "...which isn&#39;t possible."}], "owner": {"reputation": 6166, "user_id": 2990144, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c65c7991822f827780a2cae38c5c31a2?s=128&d=identicon&r=PG", "display_name": "Seth Holladay", "link": "https://stackoverflow.com/users/2990144/seth-holladay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 235, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1460596875, "creation_date": 1460580343, "last_edit_date": 1460596875, "question_id": 36609252, "link": "https://stackoverflow.com/questions/36609252/can-we-mkdir-rename-and-remain-atomic", "title": "Can we mkdir + rename and remain atomic?", "body": "<p>I am designing a build system that needs to be careful about manipulating the filesystem in an atomic manner.</p>\n\n<p>I have run into a situation where I have a temporary directory that contains files and now I want to move it to a more permanent home. I know how to <a href=\"https://rcrowley.org/2010/01/06/things-unix-can-do-atomically.html\" rel=\"nofollow\">rename atomically</a>, but this does not work if the full destination path does not exist. If I didn't care about being atomic, the answer would be a simple <code>mkdir -p ... &amp;&amp; mv ...</code>. Is it possible to rename the temporary directory atomically in a way that will create the parent directories? I cannot do so ahead of time, because the parent directory names are computed.</p>\n\n<p>This will be run inside of a <a href=\"https://nodejs.org/en/\" rel=\"nofollow\">Node.js</a> program, so something from the <a href=\"https://www.npmjs.com/\" rel=\"nofollow\">npm</a> ecosystem would be desirable, but it is trivial to call a command line program or C / C++ library to do the work.</p>\n\n<p><strong>Example:</strong></p>\n\n<pre><code>/tmp/mytempbuild - a directory containing files\n/myproject/build/dev/0.2.2 - the desired destination, whose parent may not exist\n/myproject/build/master - an older, existing directory that must not be changed\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1460579518, "post_id": 36608962, "comment_id": 60814652, "body": "First thing: <code>numberPeople</code> is uninitialized or is zero, but used in <code>malloc</code>"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1460579557, "post_id": 36608962, "comment_id": 60814669, "body": "Second thing: your first example is an array of arrays of arrays. A pointer to the underlying element type of the most dominant dimension should be your goal when moving that to dynamic storage: i.e. <code>char (*people)[3][100];</code>, assuming it is the <code>15</code> that you&#39;re targeting as variadic."}, {"owner": {"reputation": 115, "user_id": 4126220, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2eb4a7cc02ffe8b9a5f986051649307b?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4126220/david"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1460579833, "post_id": 36608962, "comment_id": 60814825, "body": "Oh wow, rookie mistake. I just EDITED and moved the numberPeople further down so that now it has a value, thanks! @EugeneSh."}, {"owner": {"reputation": 115, "user_id": 4126220, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2eb4a7cc02ffe8b9a5f986051649307b?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4126220/david"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1460579977, "post_id": 36608962, "comment_id": 60814915, "body": "I&#39;ll take note of that. thanks! @WhozCraig Is it possible to make this program with nothing but pointers (no arrays whatsoever)? This is what I&#39;m trying to accomplish. Once again, thanks!"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1460580324, "post_id": 36608962, "comment_id": 60815094, "body": "Honestly, I wouldn&#39;t. If you can manage this with a single pointer to a dynamic array of arrays of arrays, I&#39;d seriously think about why to do it any other way. Most of the time, software engineering is about doing what you <i>should</i>; not what you <i>can</i>.  Dynamic arrays of pointers to dynamic arrays of pointers to dynamic arrays leans heavily to the latter, and not the former. That said, you can do it, sure, but you had better be <i>more</i> comfortable with dynamic management that this seems to indicate."}, {"owner": {"reputation": 115, "user_id": 4126220, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2eb4a7cc02ffe8b9a5f986051649307b?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4126220/david"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1460580504, "post_id": 36608962, "comment_id": 60815197, "body": "@WhozCraig alright, cool. This is some good advice and I&#39;ll take note of it. As I said in my original post, I&#39;m new to pointers and I&#39;m still learning my limitations. Thanks for your input!"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1460580574, "post_id": 36608962, "comment_id": 60815230, "body": "Don&#39;t move to multi dimensions until you see single-dimension management in your sleep. You&#39;re just asking for a festival of seg-faults in a debugger if you move too fast. Best of luck."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1460582360, "post_id": 36608962, "comment_id": 60816182, "body": "In C, when calling any of the memory allocation functions: (malloc, calloc, realloc) 1) no not cast the returned value.  The returned value has type <code>void*</code> so can be assigned to any pointer.  Casting just clutters the code, making it more difficult to understand, debug, maintain.  2) the expression: <code>sizeof(char)</code> is defined by the standard as 1.  Multiplying anything by 1 has absolutely no effect.  Therefore that expression in the parameter to <code>malloc()</code> just clutters the code, making it more difficult.... 3) Always check (!=NULL) the returned value to assure the operation was successful"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1460582561, "post_id": 36608962, "comment_id": 60816282, "body": "the posted code contains &#39;magic&#39; numbers.  (5, 15, 100)  &#39;magic&#39; numbers make the code much more difficult to understand, debug, maintain.  Suggest giving those &#39;magic&#39; numbers meaningful names, via an enum or #define statements.  Then use those meaningful names throughout the code."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1460582690, "post_id": 36608962, "comment_id": 60816350, "body": "for ease of readability and understanding by us humans: 1) use meaningful variable names.  The names should indicate usage or content (or better, both).  2) follow the axiom: <i>only one statement per line and (at most) one variable declaration per statement.</i>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1460582828, "post_id": 36608962, "comment_id": 60816416, "body": "suggest moving the call to <code>malloc()</code> after getting a final value for <code>numberPeople</code> contains a final value."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1460583012, "post_id": 36608962, "comment_id": 60816495, "body": "when calling any of the <code>scanf()</code> family of functions, always check the returned value (not the parameter value) to assure the operation was successful."}], "answers": [{"tags": [], "owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "is_accepted": false, "score": 0, "last_activity_date": 1460581379, "creation_date": 1460581379, "answer_id": 36609530, "question_id": 36608962, "link": "https://stackoverflow.com/questions/36608962/convert-2d-array-to-pointer/36609530#36609530", "title": "convert 2d array to pointer?", "body": "<p>Yes, you can convert to all pointers but I wouldn't recommend it. Here's an example:</p>\n\n<pre><code>char ***people = malloc(sizeof(*people) * 15);\nfor (int i = 0; i &lt; 15; i++) {\n    people[i] = malloc(sizeof(*people[i]) * 3);\n    for (int j = 0; j &lt; 3; j++) {\n        people[i][j] = malloc(sizeof(*people[i][j]) * 100);\n    }\n}\n</code></pre>\n\n<p>This would re-create the array <code>char people[15][3][100];</code>. As you can see, it's messy. Plus, you have to free all that mem when you are done.</p>\n\n<p>I cleaner way would be to use a struct:</p>\n\n<pre><code>struct Student {\n    char firstName[100];\n    char lastName[100];\n    char grade[100];\n};\nstruct Student people[15];\n</code></pre>\n\n<p>This will set aside as much memory as the array. You could also dynamically allocate as many students as needed:</p>\n\n<pre><code>struct Student *people = malloc(sizeof(*people) * 20);\n</code></pre>\n\n<p>That will get 20 students. You can access them using array notation:</p>\n\n<pre><code>printf(\"%s %s %s\", people[0].firstName, people[0].lastName, people[0].grade);\n</code></pre>\n\n<p>And you only need to call <code>free</code> once.</p>\n"}, {"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1460583455, "creation_date": 1460583455, "answer_id": 36610034, "question_id": 36608962, "link": "https://stackoverflow.com/questions/36608962/convert-2d-array-to-pointer/36610034#36610034", "title": "convert 2d array to pointer?", "body": "<p>this pair of lines is not correct: </p>\n\n<pre><code>char* tempArr; \nfgets(tempArr, 100, stdin); \n</code></pre>\n\n<p>the declaration of the pointer: <code>tempArr</code> is not allocating any actual memory to contain the line read by the the call to <code>fgets()</code> Suggest: </p>\n\n<pre><code>#define MAX_INPUT_LEN (100)\n ... \nchar tempArr[MAX_INPUT_LEN]; \nfgets( tempArr, MAX_INPUT_LEN, stdin );\n</code></pre>\n\n<p>Also, the returned value from the call to <code>fgets()</code> should be checked (!=NULL) to assure the operation was successful.</p>\n"}], "owner": {"reputation": 115, "user_id": 4126220, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2eb4a7cc02ffe8b9a5f986051649307b?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4126220/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 494, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1460583455, "creation_date": 1460579346, "last_edit_date": 1460580217, "question_id": 36608962, "link": "https://stackoverflow.com/questions/36608962/convert-2d-array-to-pointer", "title": "convert 2d array to pointer?", "body": "<p>I'm trying to teach myself C, so I wrote a program to keep records for a gradebook! In my effort to learn pointers, I'm trying to convert one of my beginning projects of arrays to pointers. I want to convert my 2d array to pointers. Below is my original program to with the 2d array, and below that is my attempt to convert it to 2d pointer array.</p>\n\n<p><strong>ORIGINAL PROGRAM</strong></p>\n\n<pre><code>int numberPeople, choice, i, j;\nchar people[15][3][100];\n\nprintf(\"Please indicate number of records you want to enter (min %d, max %d): \", 5, 15);\n\nscanf(\"%d\", &amp;numberPeople);\n\nwhile ((numberPeople &lt; 5) || (numberPeople &gt; 15)) {\n    printf(\"\\nNumber not in specified range, try again.\\n\");\n    printf(\"Please indicate number of records you want to enter (min %d, max %d): \", 5, 15);\n    scanf(\"%d\", &amp;numberPeople);\n}\n\nprintf(\"\\n\");\n\nwhile ((getchar()) != '\\n'); // flush the return (and anything else) after the number input above\n\nprintf(\"Enter the first name, last name, and grade (put a space in between each): \\n\");\n\nfor (i = 0; i &lt; numberPeople; i++) {\n    char tempArr[MAXIMUM_LINE_LENGTH];\n\n    fgets(tempArr, MAXIMUM_LINE_LENGTH, stdin);\n\n    char *token = strtok(tempArr, \" \");\n\n    for (j = 0; j &lt; DATA_FIELDS &amp;&amp; token != NULL; j++) {\n        strncpy(people[i][j], token, MAXIMUM_DATA_LENGTH);\n        token = strtok(NULL, \" \\r\\n\");\n    }\n\n}\n</code></pre>\n\n<p><strong>ATTEMPT AT 2D ARRAY -> POINTER</strong></p>\n\n<pre><code>int numberPeople, choice, i, j;\nchar* people;\n\n\nprintf(\"Please indicate number of records you want to enter (min %d, max %d): \", 5, 15);\n\nscanf(\"%d\", &amp;numberPeople);\n\npeople = (char*)(malloc(numberPeople*DATA_FIELDS*sizeof(char)));\n\nwhile ((numberPeople &lt; 5) || (numberPeople &gt; 15)) {\n    printf(\"\\nNumber not in specified range, try again.\\n\");\n    printf(\"Please indicate number of records you want to enter (min %d, max %d): \", 5, 15);\n    scanf(\"%d\", &amp;numberPeople);\n}\n\nprintf(\"\\n\");\n\nwhile ((getchar()) != '\\n'); // flush the return (and anything else) after the number input above\n\nprintf(\"Enter the first name, last name, and grade (put a space in between each): \\n\");\n\nfor (i = 0; i &lt; numberPeople; i++) {\n    char* tempArr;\n\n    fgets(tempArr, 100, stdin); // Thread 1: EXC_BAD_ACCESS code=1 address=0x0\n\n    char *token = strtok(tempArr, \" \");\n\n    for (j = 0; j &lt; 3 &amp;&amp; token != NULL; j++) {\n        strncpy(people, token, 50);\n        token = strtok(NULL, \" \\r\\n\");\n    }\n\n}\n</code></pre>\n\n<p>During the person input step is when it breaks. It works for the first entry, but then it hits a breakpoint (I'm using Xcode), and it reads \"EXC_BAD_ACCESS\", and I'm not too sure what this means, any tips would help, thanks!</p>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 2, "creation_date": 1460579187, "post_id": 36608789, "comment_id": 60814484, "body": "<code>int **array</code> is not a 2D array. At best it will be a 1D array of pointers."}], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 2, "last_activity_date": 1460579742, "last_edit_date": 1460579742, "creation_date": 1460579404, "answer_id": 36608983, "question_id": 36608789, "link": "https://stackoverflow.com/questions/36608789/how-to-access-the-elements-of-a-2d-array-represented-by-a-double-pointer-as-a-1d/36608983#36608983", "title": "How to access the elements of a 2D array represented by a Double pointer as a 1D array in C", "body": "<p>Yes, a C 2D array is an array of arrays.  C arrays consist of elements laid out contiguously in memory, so the (array) members of a 2D array are contiguous in memory, and their own elements are contiguous within them, so that the overall layout is congruent with the layout of a 1D array.</p>\n\n<p>But what you present is not a 2D array, nor a pointer to one, nor in any way compatible with one.  Yours is a pointer to pointer to <code>int</code>.  Such a pointer might point to the first element of an array of <code>int *</code>, but it only points anywhere into a 2D array if the programmer has somewhere performed a conversion between incompatible pointer types, directly or indirectly.  A direct conversion ought to raise a warning, but an indirect one, say through a <code>void *</code> intermediate, might compile cleanly even with warnings turned up to 11.</p>\n\n<p>The declaration of a C 2D array has this form:</p>\n\n<pre><code>int array_2d[4][2];\n</code></pre>\n\n<p>Such an array decays to a pointer of this type under most circumstances:</p>\n\n<pre><code>int (*array_2d_pointer)[2];\n</code></pre>\n\n<p>In direct answer to your question, then,</p>\n\n<blockquote>\n  <p>How can I print all of the elements without using a nested for loop?</p>\n</blockquote>\n\n<p>You can't.  Your data are not structured for that.</p>\n"}], "owner": {"reputation": 133, "user_id": 6200661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0841cd07e00b89b0c8367c77216a1efd?s=128&d=identicon&r=PG&f=1", "display_name": "Minato10", "link": "https://stackoverflow.com/users/6200661/minato10"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1460579742, "creation_date": 1460578730, "question_id": 36608789, "link": "https://stackoverflow.com/questions/36608789/how-to-access-the-elements-of-a-2d-array-represented-by-a-double-pointer-as-a-1d", "title": "How to access the elements of a 2D array represented by a Double pointer as a 1D array in C", "body": "<p>Lets say I have a populated integer 2D array represented by a double pointer. I try to access the elements like this (this is just a piece of the code):</p>\n\n<pre><code>int **array;\n\nwhile (i&lt;arraysize) {\n    printf(\"array[%d] = %d\", i, array+i);\n}\n</code></pre>\n\n<p>I know in memory 2D arrays are bascially stored as 1D arrays. How can I print all of the elements without using a nested for loop?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1460578243, "post_id": 36608580, "comment_id": 60813940, "body": "Undefined behavior using the value of an object with automatic storage duration while it is indeterminate."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1460578579, "post_id": 36608580, "comment_id": 60814157, "body": "Actually, what does your compiler tell you about the syntax errors in the code?"}, {"owner": {"reputation": 49, "user_id": 6200763, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/175215c0add2aaff795974b98ecc06ea?s=128&d=identicon&r=PG&f=1", "display_name": "user6200763", "link": "https://stackoverflow.com/users/6200763/user6200763"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1460578881, "post_id": 36608580, "comment_id": 60814297, "body": "No error, I just want to write the function shorter"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1460578954, "post_id": 36608580, "comment_id": 60814348, "body": "Make an array of dice <code>int d[6]</code> and use <code>for</code> loops <code>for (i=0;i&lt;6;i++) d[i]=roll_a_dice();</code>"}, {"owner": {"reputation": 49, "user_id": 6200763, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/175215c0add2aaff795974b98ecc06ea?s=128&d=identicon&r=PG&f=1", "display_name": "user6200763", "link": "https://stackoverflow.com/users/6200763/user6200763"}, "edited": false, "score": 0, "creation_date": 1460579122, "post_id": 36608580, "comment_id": 60814450, "body": "using array is not allowed by teacher #user3386109"}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 6200763, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/175215c0add2aaff795974b98ecc06ea?s=128&d=identicon&r=PG&f=1", "display_name": "user6200763", "link": "https://stackoverflow.com/users/6200763/user6200763"}, "edited": false, "score": 0, "creation_date": 1460582927, "post_id": 36609376, "comment_id": 60816459, "body": "What about for second rule?"}, {"owner": {"reputation": 1125, "user_id": 5672740, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c16baffcdc08015ed0b3f9dcfd424751?s=128&d=identicon&r=PG&f=1", "display_name": "SenselessCoder", "link": "https://stackoverflow.com/users/5672740/senselesscoder"}, "reply_to_user": {"reputation": 49, "user_id": 6200763, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/175215c0add2aaff795974b98ecc06ea?s=128&d=identicon&r=PG&f=1", "display_name": "user6200763", "link": "https://stackoverflow.com/users/6200763/user6200763"}, "edited": false, "score": 0, "creation_date": 1460583265, "post_id": 36609376, "comment_id": 60816637, "body": "Think about what it is that you want to achieve. You want three 1&#39;s. But this might very well be all 1&#39;s. (six 1&#39;s). So you want a bit of a generalized formula.  Such as this:  result = 100 * ((d1 == 1) + (d2 == 1) + (d3 == 1) + (d4 == 1) + (d5 == 1) + (d6 == 1)) / 3  This will get you the count of 1&#39;s and divide it by 3, then award you 100 for each triplet."}], "tags": [], "owner": {"reputation": 1125, "user_id": 5672740, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c16baffcdc08015ed0b3f9dcfd424751?s=128&d=identicon&r=PG&f=1", "display_name": "SenselessCoder", "link": "https://stackoverflow.com/users/5672740/senselesscoder"}, "is_accepted": true, "score": 0, "last_activity_date": 1460580834, "creation_date": 1460580834, "answer_id": 36609376, "question_id": 36608580, "link": "https://stackoverflow.com/questions/36608580/computing-points-for-farkle-game-in-c/36609376#36609376", "title": "Computing points for farkle game in C", "body": "<p>You can use some C tricks to get a more elegant solution.</p>\n\n<p>Try this:</p>\n\n<pre><code>result += 50 * ((d1 == 5) + (d2 == 5) + (d3 == 5) + (d4 == 5) + (d5 == 5) + (d6 == 5));\n</code></pre>\n\n<p>Do you see what this does?</p>\n\n<p>First, the d1 == 5 is a boolean expression resulting in a true or false, so if it's 5 it will yield a 1. If not, a 0. So what you do is you collect the count of fives and multiply by 50. This would cut a huge chunk of your code to just one line.</p>\n"}], "owner": {"reputation": 49, "user_id": 6200763, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/175215c0add2aaff795974b98ecc06ea?s=128&d=identicon&r=PG&f=1", "display_name": "user6200763", "link": "https://stackoverflow.com/users/6200763/user6200763"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 226, "favorite_count": 0, "accepted_answer_id": 36609376, "answer_count": 1, "score": -1, "last_activity_date": 1460580834, "creation_date": 1460578122, "last_edit_date": 1460578396, "question_id": 36608580, "link": "https://stackoverflow.com/questions/36608580/computing-points-for-farkle-game-in-c", "title": "Computing points for farkle game in C", "body": "<p>this a part of program(I didnt add all codes of functions written).\n\"roll_a_dice()\" creats a number for each dice. and \naccording to rule1, user will gain 50 points for each dice 5.\naccording to rule2, user will gain 100 points for combination of dice (1,1,1)\nI wrote somehow but it looks inefficient. How can I write it with more efficient way?</p>\n\n<p>note: I m not allowed to use array, pointers etc.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;time.h&gt;\n\nint compute_points(int ruleno)\n{\n    int k=0,i;\n    switch(ruleno)\n    {\n        case 1:\n            if(d1==5) k+=50;\n            if(d2==5) k+=50;\n            if(d3==5) k+=50;\n            if(d4==5) k+=50;\n            if(d5==5) k+=50;\n            if(d6==5) k+=50; break;\n\n        case 2:\n            if(d1==1) i+=1;\n            if(d2==1) i+=1;\n            if(d3==1) i+=1;\n            if(d4==1) i+=1;\n            if(d5==1) i+=1;\n            if(d6==1) i+=1;\n            if(i=&gt;3)  k=100 break;\n    }\n\n    return k;   \n}\n\nint main()\n{\n    int m,p1,p2,turn, t1,t2,ruleno,d1,d2,d3,d4,d5,d6,point;\n    srand(time(NULL));\n    printf(\"FARKLE GAME!\");\n    m=menu(m);\n\n        ruleno=select_rule_number(ruleno);\n\n        d1=roll_a_dice();\n        d2=roll_a_dice();\n        d3=roll_a_dice();\n        d4=roll_a_dice();\n        d5=roll_a_dice();\n        d6=roll_a_dice();\n        numberofdice(d1,d2,d3,d4,d5,d6);\n\n        point=compute_points(ruleno,d1,d2,d3,d4,d5,d6);\n\n    printf(\"Goodby!\");\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "for-loop", "constants", "compiler-optimization"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1460578132, "post_id": 36608509, "comment_id": 60813871, "body": "One would hope that the compiler optimizes this in both cases.  There is really one one way to find out though.  Compile it and check the assembly."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1460578138, "post_id": 36608509, "comment_id": 60813876, "body": "Depends. Do you pass the address of <code>v</code> to a function in the loop? If so, is the function in a different translation unit? If so, are link-time optimizations enabled?"}, {"owner": {"reputation": 2383, "user_id": 313273, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/62baf28829b3c606ce4682924b8f427b?s=128&d=identicon&r=PG", "display_name": "eje211", "link": "https://stackoverflow.com/users/313273/eje211"}, "edited": false, "score": 0, "creation_date": 1460578230, "post_id": 36608509, "comment_id": 60813932, "body": "In my real program, v is one of several variables set by reference by one function. It is never used inside of the loop. I don&#39;t know how to check compiled code."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1460578340, "post_id": 36608509, "comment_id": 60814009, "body": "Assuming the comment &quot;don&#39;t use v&quot; isn&#39;t lying, any remotely-half-baked optimizer will examine <code>v</code> usage in the first example, see the expression <code>v-5</code> never changes because <code>v</code> never changes, nor is put in a position where it <i>may</i> change, and perform the computation <i>once</i>. If it didn&#39;t your optimizer sucks. Compile to asm and check the instructions if you&#39;re really worried about it."}, {"owner": {"reputation": 2383, "user_id": 313273, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/62baf28829b3c606ce4682924b8f427b?s=128&d=identicon&r=PG", "display_name": "eje211", "link": "https://stackoverflow.com/users/313273/eje211"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1460578462, "post_id": 36608509, "comment_id": 60814085, "body": "@WhozCraig I&#39;ll see if I can figure out how to compile to asm. (And understand the result.) I&#39;m mostly curious, more than worried. I was asked to write highly-efficient code and I&#39;m not sure which is the most efficient. Setting the value outside of the loop or doing it like this. In any case, I want to be able to back up my decision. For now, I&#39;m using GCC, but in the end, it will be run on VC++. I don&#39;t know if VC++ is half-baked."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1460578735, "post_id": 36608509, "comment_id": 60814217, "body": "@eje211I hate that kind of mandate.  Code should be written to be clear and maintainable.  After that if you profile it and find the performance is not acceptable then you look at where the bottle necks our and see if you can fix them.  I am not a big fan of pre-optimizations."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1460579036, "post_id": 36608509, "comment_id": 60814404, "body": "What is this &quot;C/C++&quot; of which you speak?"}, {"owner": {"reputation": 2383, "user_id": 313273, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/62baf28829b3c606ce4682924b8f427b?s=128&d=identicon&r=PG", "display_name": "eje211", "link": "https://stackoverflow.com/users/313273/eje211"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1460580869, "post_id": 36608509, "comment_id": 60815382, "body": "@LightnessRacesinOrbit It&#39;s a low-level operation that could work in either. In C++, I actually define setV as <code>void setV(int &amp; v)</code>, which is not possible in pure C, but the loop syntax is common to both."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1460626356, "post_id": 36608509, "comment_id": 60834258, "body": "@eje211: The answer may be completely different between the two (and passing a reference rather than a pointer in particular could make a huge difference to optimisation opportunities!). Please ask about one language at a time."}], "answers": [{"comments": [{"owner": {"reputation": 91523, "user_id": 251738, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b01b33120fefaad052b4a6864cbc7517?s=128&d=identicon&r=PG", "display_name": "Mark B", "link": "https://stackoverflow.com/users/251738/mark-b"}, "edited": false, "score": 0, "creation_date": 1460579456, "post_id": 36608790, "comment_id": 60814622, "body": "Keep in mind if the compiler isn&#39;t using whole program optimization, it <i>can&#39;t</i> optimize away the evaluation in the first case because it doesn&#39;t know that <code>v</code> isn&#39;t aliased away in <code>setV</code> and mutated in <code>do_something</code>."}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "reply_to_user": {"reputation": 91523, "user_id": 251738, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b01b33120fefaad052b4a6864cbc7517?s=128&d=identicon&r=PG", "display_name": "Mark B", "link": "https://stackoverflow.com/users/251738/mark-b"}, "edited": false, "score": 0, "creation_date": 1460579656, "post_id": 36608790, "comment_id": 60814728, "body": "@MarkB v is local to the function. There is no legitimate access to v from do_something (which takes its argument by value) so the compiler is free to assume no aliasing, as it does in test2()."}, {"owner": {"reputation": 91523, "user_id": 251738, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b01b33120fefaad052b4a6864cbc7517?s=128&d=identicon&r=PG", "display_name": "Mark B", "link": "https://stackoverflow.com/users/251738/mark-b"}, "edited": false, "score": 0, "creation_date": 1460579759, "post_id": 36608790, "comment_id": 60814786, "body": "<code>setV</code> gets the address of the local <code>v</code> and sticks it in <code>global_v_ptr</code>. Then <code>do_something</code> accesses <code>v</code> through <code>*global_v_ptr</code> and updates the local variable legally."}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "reply_to_user": {"reputation": 91523, "user_id": 251738, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b01b33120fefaad052b4a6864cbc7517?s=128&d=identicon&r=PG", "display_name": "Mark B", "link": "https://stackoverflow.com/users/251738/mark-b"}, "edited": false, "score": 0, "creation_date": 1460579962, "post_id": 36608790, "comment_id": 60814902, "body": "@MarkB ah right, so in test2 were proving to the compiler that there is no causal relationship between the call and the end of loop condition. That in itself is probably a winning argument for using the extra variable in the second form."}, {"owner": {"reputation": 4046, "user_id": 4971422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4abf51a937ddda51cc6813445605c50?s=128&d=identicon&r=PG&f=1", "display_name": "FredK", "link": "https://stackoverflow.com/users/4971422/fredk"}, "edited": false, "score": 0, "creation_date": 1460580595, "post_id": 36608790, "comment_id": 60815242, "body": "If you are going to go to the trouble of adding <code>const int cv = v;</code> and iterating while <code>i &lt; cv-5</code>, why not set cv=v-5 and interate while <code>i &lt; cv</code> ? As a code maintainer, if I see math inside the for-construct it would imply to me that there is a possibility that one (or more) of the variable(s) in that expression MIGHT change somewhere in the loop, either directly of as a side effect of a function call."}, {"owner": {"reputation": 2383, "user_id": 313273, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/62baf28829b3c606ce4682924b8f427b?s=128&d=identicon&r=PG", "display_name": "eje211", "link": "https://stackoverflow.com/users/313273/eje211"}, "reply_to_user": {"reputation": 4046, "user_id": 4971422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4abf51a937ddda51cc6813445605c50?s=128&d=identicon&r=PG&f=1", "display_name": "FredK", "link": "https://stackoverflow.com/users/4971422/fredk"}, "edited": false, "score": 0, "creation_date": 1460580731, "post_id": 36608790, "comment_id": 60815305, "body": "@FredK Well, the question is less about what&#39;s the best solution and more about how it works. In my real code, I did <code>v -= 5</code>, because <code>v</code> was never used after the  <code>while</code> loop. But I don&#39;t want to adopt the attitude of &quot;it works; I don&#39;t care how.&quot; If I just do <code>v -= 5</code>, then I don&#39;t understand the language any better."}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "reply_to_user": {"reputation": 2383, "user_id": 313273, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/62baf28829b3c606ce4682924b8f427b?s=128&d=identicon&r=PG", "display_name": "eje211", "link": "https://stackoverflow.com/users/313273/eje211"}, "edited": false, "score": 0, "creation_date": 1460581992, "post_id": 36608790, "comment_id": 60815984, "body": "@eje211 this was an interesting question for an unexpected reason. It&#39;s more a question of the compiler avoiding the obtuse case of an unintended aliasing of v. If the compiler can prove that this won&#39;t happen (version 2) then we get better code. The lesson here is to be more concerned with eliminating aliasing than doing the compilers job for it. Making the copy cv actually presented the biggest optimisation (elision of redundant memory fetches). Interesting eh?"}], "tags": [], "owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "is_accepted": true, "score": 4, "last_activity_date": 1460645439, "last_edit_date": 1592644375, "creation_date": 1460578741, "answer_id": 36608790, "question_id": 36608509, "link": "https://stackoverflow.com/questions/36608509/in-c-c-arithmetic-operation-inside-of-for-statement-arguments/36608790#36608790", "title": "In C/C++ arithmetic operation inside of for statement arguments", "body": "<h2>Edit:</h2>\n<p>This was an interesting question for an unexpected reason. It's more a question of the compiler avoiding the obtuse case of an unintended aliasing of <code>v</code>. If the compiler can prove that this won't happen (version 2) then we get better code.</p>\n<p>The lesson here is to be more concerned with eliminating aliasing than trying to do the optimiser's job for it.</p>\n<p>Making the copy cv actually presented the biggest optimisation (elision of redundant memory fetches), even though at a first glance it would appear to be (slightly) less efficient.</p>\n<h2>original answer and demo:</h2>\n<p>Let's see:</p>\n<p>given:</p>\n<pre><code>extern void setV(int*);\nextern void do_something(int i);\n\nvoid test1()\n{\n    int v;\n    setV(&amp;v);\n    for (int i = 0; i &lt; v - 5; i++) {\n    // Do stuff here, but don't use v.\n      do_something(i);\n    }\n}\n\n\nvoid test2()\n{\n    int v;\n    setV(&amp;v);\n    const int cv = v;\n    for (int i = 0; i &lt; cv - 5; i++) {\n      // Do stuff here. Changing cv is actually impossible.\n      do_something(i);\n    }  \n}\n</code></pre>\n<p>compile on gcc5.3 with <code>-x c++ -std=c++14 -O2 -Wall</code></p>\n<p>gives:</p>\n<pre><code>test1():\n        pushq   %rbx\n        subq    $16, %rsp\n        leaq    12(%rsp), %rdi\n        call    setV(int*)\n        cmpl    $5, 12(%rsp)\n        jle     .L1\n        xorl    %ebx, %ebx\n.L5:\n        movl    %ebx, %edi\n        addl    $1, %ebx\n        call    do_something(int)\n        movl    12(%rsp), %eax\n        subl    $5, %eax\n        cmpl    %ebx, %eax\n        jg      .L5\n.L1:\n        addq    $16, %rsp\n        popq    %rbx\n        ret\ntest2():\n        pushq   %rbp\n        pushq   %rbx\n        subq    $24, %rsp\n        leaq    12(%rsp), %rdi\n        call    setV(int*)\n        movl    12(%rsp), %eax\n        cmpl    $5, %eax\n        jle     .L8\n        leal    -5(%rax), %ebp\n        xorl    %ebx, %ebx\n.L12:\n        movl    %ebx, %edi\n        addl    $1, %ebx\n        call    do_something(int)\n        cmpl    %ebp, %ebx\n        jne     .L12\n.L8:\n        addq    $24, %rsp\n        popq    %rbx\n        popq    %rbp\n        ret\n</code></pre>\n<p>The second form is better on this compiler.</p>\n"}], "owner": {"reputation": 2383, "user_id": 313273, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/62baf28829b3c606ce4682924b8f427b?s=128&d=identicon&r=PG", "display_name": "eje211", "link": "https://stackoverflow.com/users/313273/eje211"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 290, "favorite_count": 0, "accepted_answer_id": 36608790, "answer_count": 1, "score": 2, "last_activity_date": 1460645439, "creation_date": 1460577936, "last_edit_date": 1460578179, "question_id": 36608509, "link": "https://stackoverflow.com/questions/36608509/in-c-c-arithmetic-operation-inside-of-for-statement-arguments", "title": "In C/C++ arithmetic operation inside of for statement arguments", "body": "<p>Let's say I have this code:</p>\n\n<pre><code>int v;\nsetV(&amp;v);\nfor (int i = 0; i &lt; v - 5; i++) {\n  // Do stuff here, but don't use v.\n}\n</code></pre>\n\n<p>Will the operation <code>v - 5</code> be run every time or will a modern compiler be smart enough to store it once and never run it again?</p>\n\n<p>What if I did this:</p>\n\n<pre><code>int v;\nsetV(&amp;v);\nconst int cv = v;\nfor (int i = 0; i &lt; cv - 5; i++) {\n  // Do stuff here. Changing cv is actually impossible.\n}\n</code></pre>\n\n<p>Would the second style make a difference?</p>\n"}, {"tags": ["c", "string", "dynamic", "input"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 2, "creation_date": 1460577103, "post_id": 36608221, "comment_id": 60813289, "body": "<code>;</code> and <code>=</code> are not whitespace."}, {"owner": {"reputation": 81, "user_id": 3677168, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/jmFSd.jpg?s=128&g=1", "display_name": "ricknaght", "link": "https://stackoverflow.com/users/3677168/ricknaght"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1460577755, "post_id": 36608221, "comment_id": 60813647, "body": "True, my bad. I fixed it. Used <code>scanf(&quot;%[^;]%[^=]%[^\\n]&quot;, id, banner, cp); </code> instead. Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 3, "last_activity_date": 1460577584, "creation_date": 1460577584, "answer_id": 36608393, "question_id": 36608221, "link": "https://stackoverflow.com/questions/36608221/input-in-c-special-case/36608393#36608393", "title": "Input in C, special case?", "body": "<p><code>scanf</code> doesn't try to do a full pattern match of the format string. <code>%s</code> input format simply reads everything up to the next whitespace (or EOF). After that, it looks for a <code>;</code>, and since it doesn't find that it doesn't parse any of the other inputs.</p>\n\n<p>If you want to stop at some other character, use <code>[^char]</code></p>\n\n<pre><code>scanf(\"[^;];%[^=]=%s\", id, banner, cp);\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 3677168, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/jmFSd.jpg?s=128&g=1", "display_name": "ricknaght", "link": "https://stackoverflow.com/users/3677168/ricknaght"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 36608393, "answer_count": 1, "score": 0, "last_activity_date": 1460577584, "creation_date": 1460576974, "question_id": 36608221, "link": "https://stackoverflow.com/questions/36608221/input-in-c-special-case", "title": "Input in C, special case?", "body": "<p>Good day,</p>\n\n<p>I've got the following code:</p>\n\n<pre><code> 43     while (TRUE)\n 44     {\n 45         printf(\"Swipe Card: \");\n 46         scanf(\"%s;%s=%s\", id, banner, cp);\n 47         printf(\"%s\\n%s\\n%s\\n\", id, banner, cp);\n 48         ProcessStudent(banner, file);\n 49\n 50     }\n</code></pre>\n\n<p>I've dynamically allocated <code>id</code>, <code>banner</code>, and <code>cp</code>, however when I try to print them (which I did just to check their contents) everything is taken into 'id' only. The string I'm trying to read looks like this <code>%GRE068?;01540594=000331!</code></p>\n"}, {"tags": ["c", "arrays", "struct"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1460577102, "post_id": 36608167, "comment_id": 60813288, "body": "&quot;not sure if fwrite(); actually writes the whole array with all the info that is filled in for the ITEM&quot;. No it does not - it just writes the exact pointer value. You need to write the array contents out seperately yourself."}, {"owner": {"reputation": 205, "user_id": 2947605, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5090e45a6a464e2da7fb81cc0b727ae8?s=128&d=identicon&r=PG&f=1", "display_name": "AleksXPO", "link": "https://stackoverflow.com/users/2947605/aleksxpo"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1460577239, "post_id": 36608167, "comment_id": 60813369, "body": "So a correct approach would be to write 1 SHOP + ITEM array at a time?"}], "answers": [{"tags": [], "owner": {"reputation": 175, "user_id": 6158383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/894a52419735dbf898e7551359ca7b2a?s=128&d=identicon&r=PG&f=1", "display_name": "G. Emadi", "link": "https://stackoverflow.com/users/6158383/g-emadi"}, "is_accepted": false, "score": 0, "last_activity_date": 1460578010, "last_edit_date": 1460578010, "creation_date": 1460577245, "answer_id": 36608296, "question_id": 36608167, "link": "https://stackoverflow.com/questions/36608167/writing-and-reading-structs-from-binary-file-that-contain-other-structs-c/36608296#36608296", "title": "Writing and reading structs from binary file that contain other structs (C)", "body": "<p>If you want to write structure, it should not have the pointer feilds. In this cases you should not write by structure. Because it write an address only for a pointer field </p>\n"}, {"tags": [], "owner": {"reputation": 105, "user_id": 6200254, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ORk7w.png?s=128&g=1", "display_name": "Rezniaq", "link": "https://stackoverflow.com/users/6200254/rezniaq"}, "is_accepted": true, "score": 0, "last_activity_date": 1460578576, "creation_date": 1460578576, "answer_id": 36608720, "question_id": 36608167, "link": "https://stackoverflow.com/questions/36608167/writing-and-reading-structs-from-binary-file-that-contain-other-structs-c/36608720#36608720", "title": "Writing and reading structs from binary file that contain other structs (C)", "body": "<p>The problem is that you're writing the pointer to the file, that should end in something like this</p>\n\n<p>21 chars -> coming from the char array \"name\" from struct shop</p>\n\n<p>4 bytes -> coming from int numOfItems</p>\n\n<p>4 bytes -> coming from the pointer to arr</p>\n\n<p>so, your struct should become something like this</p>\n\n<pre><code>typedef struct shop\n{\n    char name[21];\n    int numOfItems;\n    ITEMS arr;\n} SHOP;\n</code></pre>\n\n<p>that would end having something similar to this in the file</p>\n\n<p>21 chars -> coming from the char array \"name\" from struct shop</p>\n\n<p>4 bytes -> coming from int numOfItems</p>\n\n<p>21 chars -> coming from the char array \"name\" from struct items</p>\n\n<p>21 chars -> coming from the char array \"power\" from struct items</p>\n\n<p>4 bytes -> coming from int stock</p>\n\n<p>8 bytes -> coming from double price</p>\n\n<p>The bytes may vary depending on the PC that you're running your app (in some PCs int has 2 bytes, in others 4, etc.)</p>\n"}], "owner": {"reputation": 205, "user_id": 2947605, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5090e45a6a464e2da7fb81cc0b727ae8?s=128&d=identicon&r=PG&f=1", "display_name": "AleksXPO", "link": "https://stackoverflow.com/users/2947605/aleksxpo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 36608720, "answer_count": 2, "score": 0, "last_activity_date": 1460578576, "creation_date": 1460576783, "question_id": 36608167, "link": "https://stackoverflow.com/questions/36608167/writing-and-reading-structs-from-binary-file-that-contain-other-structs-c", "title": "Writing and reading structs from binary file that contain other structs (C)", "body": "<p>I have to write/read from a binary file some structs that I created, but when reading them back in, I get some nasty errors.</p>\n\n<p>Take for example this construction:</p>\n\n<pre><code>typedef struct items\n{\n    char name[21], power[21];\n    int stock;\n    double price;\n} ITEMS;\n\ntypedef struct shop\n{\n    char name[21];\n    int numOfItems;\n    ITEMS *arr;\n} SHOP;\n</code></pre>\n\n<p>And now, I can create an array of SHOP and fill everything as is (creating  an dynamic array for ITEM, for each SHOP[i]), but I'm not sure if:</p>\n\n<p>fwrite(); actually writes the whole array, with all the info that is filled in for the ITEM's\nand when i use fread() it gives some access violation error.</p>\n\n<p>What would be the correct approach, aside from using .txt files for I/O.</p>\n\n<p>Here is a code sample:<a href=\"http://pastebin.com/79TtvQ9t\" rel=\"nofollow\">http://pastebin.com/79TtvQ9t</a></p>\n"}, {"tags": ["c", "binary-search-tree"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 6, "creation_date": 1460576859, "post_id": 36608114, "comment_id": 60813142, "body": "Please remove the image and paste the code as text."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1460576913, "post_id": 36608114, "comment_id": 60813172, "body": "I suspect the problem is in <code>get_node</code>. It looks like all the nodes use the same address for <code>data.name</code>."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1460576976, "post_id": 36608114, "comment_id": 60813213, "body": "So every time you do <code>scanf(&quot;%s&quot;, new_node-&gt;data.name);</code> it&#39;s overwriting the string used in all the nodes, and at the end they all have the last name that was entered."}, {"owner": {"reputation": 8388, "user_id": 5890227, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/M6Of5.png?s=128&g=1", "display_name": "Khalil Khalaf", "link": "https://stackoverflow.com/users/5890227/khalil-khalaf"}, "edited": false, "score": 0, "creation_date": 1460577135, "post_id": 36608114, "comment_id": 60813309, "body": "why &#39;new_node-&gt;data.name&#39; has no &amp; &quot;ampersand operator&quot; ?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 8388, "user_id": 5890227, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/M6Of5.png?s=128&g=1", "display_name": "Khalil Khalaf", "link": "https://stackoverflow.com/users/5890227/khalil-khalaf"}, "edited": false, "score": 0, "creation_date": 1460577973, "post_id": 36608114, "comment_id": 60813786, "body": "@FirstStep Presumably because <code>data.name</code> is a pointer or array. An array automatically decays to a pointer when used as a function argument."}, {"owner": {"reputation": 11, "user_id": 6077979, "user_type": "registered", "profile_image": "https://graph.facebook.com/933272073455347/picture?type=large", "display_name": "ozi", "link": "https://stackoverflow.com/users/6077979/ozi"}, "edited": false, "score": 0, "creation_date": 1460583236, "post_id": 36608114, "comment_id": 60816627, "body": "all codes are below pls control it what are the missing ? i dont use &quot;&amp;&quot; for new_noda-&gt;data.name because it is not used for string isnt it ?"}], "answers": [{"tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 1, "last_activity_date": 1460766332, "last_edit_date": 1460766332, "creation_date": 1460765938, "answer_id": 36658765, "question_id": 36608114, "link": "https://stackoverflow.com/questions/36608114/ordering-number-and-string-in-c/36658765#36658765", "title": "Ordering number and string in c", "body": "<p>You cannot guess your way to a solution in C. The code you posted <em>segfaults</em> immediately because you have failed to provide any storage for the name you read from <code>stdin</code>. You apparently intend to reference the name through <code>struct Customer name</code>. <code>name</code> is an uninitialized pointer to nowhere.</p>\n\n<p>Further, following your call to <code>new_node = get_node ();</code> you provide no reference to any <code>struct Customer</code> through the <code>struct CustomerBSTNode, Customer data</code> member, which you incorrectly have as a static member of type <code>struct Customer</code> instead of a pointer to <code>struct Customer*</code>. e.g. you should have:</p>\n\n<pre><code>struct CustomerBSTNode {\n    struct Customer *data;\n    struct CustomerBSTNode *left;\n    struct CustomerBSTNode *right;\n};\n</code></pre>\n\n<p>(which will require changes to how you reference members of <code>Customer</code> throughout the remainder of your code)</p>\n\n<p>You do not validate any of your memory allocations with <code>malloc</code> or check the return from <code>scanf</code>. How will you know if you even have any memory within which you can store the input you take and how do you know that you have any input to store in the first place? Always, always validate all allocations and all input. e.g.</p>\n\n<pre><code>struct CustomerBSTNode *get_node ()\n{\n    struct CustomerBSTNode *temp;\n    if (!(temp = malloc (sizeof *temp))) {\n        fprintf (stderr, \"error: virtual memory exhausted.\\n\");\n        exit (EXIT_FAILURE);\n    }\n\n    temp-&gt;left = NULL;\n    temp-&gt;right = NULL;\n    return temp;\n}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>    while (printf (\"Enter Elements (age, name): \") &amp;&amp;\n           scanf (\" %d %24[^\\n]%*c\", &amp;key, name) == 2) {\n</code></pre>\n\n<p>Your <code>main</code> function is so cluttered with unused variables, it is almost impossible to tell what your approach to the problem was. Correcting the immediate problems and reworking <code>main</code>, you could arrive at a solution similar to:</p>\n\n<pre><code>int main (void) {\n\n    int key;\n    char name[MAXNM] = \"\";\n    struct CustomerBSTNode *new_node, *root = NULL;\n\n    while (printf (\"Enter Elements (age, name): \") &amp;&amp;\n           scanf (\" %d %24[^\\n]%*c\", &amp;key, name) == 2) {\n\n        new_node = get_node ();\n\n        struct Customer *cust;\n        if (!(cust = malloc (sizeof *cust))) {\n            fprintf (stderr, \"error: virtual memory exhausted.\\n\");\n            exit (EXIT_FAILURE);\n        }\n\n        cust-&gt;ID = key;\n        cust-&gt;name = strdup (name);\n        new_node-&gt;data = cust;\n\n        if (root == NULL) root = new_node;\n        else insert (root, new_node);\n    }\n\n    printf (\"\\n\\nElements OrderedById\\n\\n\");\n    OrderedById (root);\n\n    return 0;\n}\n</code></pre>\n\n<p>Putting all the pieces together, you could do the following:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define MAXNM 25\n\nstruct Customer {\n    char *name;\n    int ID;\n    struct BasketLLNode *baskets;\n};\n\nstruct Product {\n    int ID;\n    char *name;\n    int price;\n};\n\nstruct CustomerLLNode {\n    struct Customer *data;\n    struct CustomerLLNode *next;\n} *HeadCustomer, *TempCustomer;\n\nstruct CustomerBSTNode {\n    struct Customer *data;\n    struct CustomerBSTNode *left;\n    struct CustomerBSTNode *right;\n};\n\nstruct CustomerBSTNode *get_node ()\n{\n    struct CustomerBSTNode *temp;\n    if (!(temp = malloc (sizeof *temp))) {\n        fprintf (stderr, \"error: virtual memory exhausted.\\n\");\n        exit (EXIT_FAILURE);\n    }\n\n    temp-&gt;left = NULL;\n    temp-&gt;right = NULL;\n    return temp;\n}\n\nvoid insert (struct CustomerBSTNode *root, struct CustomerBSTNode *newNode)\n{\n    if (newNode-&gt;data-&gt;ID &lt; root-&gt;data-&gt;ID) {\n        if (root-&gt;left == NULL)\n            root-&gt;left = newNode;\n        else\n            insert (root-&gt;left, newNode);\n    }\n\n    if (newNode-&gt;data-&gt;ID &gt; root-&gt;data-&gt;ID) {\n        if (root-&gt;right == NULL)\n            root-&gt;right = newNode;\n        else\n            insert (root-&gt;right, newNode);\n    }\n}\n\nvoid OrderedById (struct CustomerBSTNode *temp)\n{\n    if (temp != NULL) {\n        OrderedById (temp-&gt;left);\n        printf (\" %2d  %s\\n\", temp-&gt;data-&gt;ID, temp-&gt;data-&gt;name);\n        OrderedById (temp-&gt;right);\n    }\n}\n\nint main (void) {\n\n    int key;\n    char name[MAXNM] = \"\";\n    struct CustomerBSTNode *new_node, *root = NULL;\n\n    while (printf (\"Enter Elements (age, name): \") &amp;&amp;\n           scanf (\" %d %24[^\\n]%*c\", &amp;key, name) == 2) {\n\n        new_node = get_node ();\n\n        struct Customer *cust;\n        if (!(cust = malloc (sizeof *cust))) {\n            fprintf (stderr, \"error: virtual memory exhausted.\\n\");\n            exit (EXIT_FAILURE);\n        }\n\n        cust-&gt;ID = key;\n        cust-&gt;name = strdup (name);\n        new_node-&gt;data = cust;\n\n        if (root == NULL) root = new_node;\n        else insert (root, new_node);\n    }\n\n    printf (\"\\n\\nElements OrderedById\\n\\n\");\n    OrderedById (root);\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/bstordered\nEnter Elements (age, name): 48 Jenifer\nEnter Elements (age, name): 35 David\nEnter Elements (age, name): 25 Messi\nEnter Elements (age, name): 3 Gomez\nEnter Elements (age, name): 85 Helena\nEnter Elements (age, name):\n\nElements OrderedById\n\n  3  Gomez\n 25  Messi\n 35  David\n 48  Jenifer\n 85  Helena\n</code></pre>\n\n<p>Take time to go though the code and understand why the changes that were made -- were made. You have to think through your data handling very carefully and insure each step, each level of building your data structure, takes only fully allocated members, types, etc.. Let me know if you have further questions.</p>\n\n<p>(<strong>note:</strong> you are responsible for <code>free</code>ing the memory you allocate.)</p>\n"}], "owner": {"reputation": 11, "user_id": 6077979, "user_type": "registered", "profile_image": "https://graph.facebook.com/933272073455347/picture?type=large", "display_name": "ozi", "link": "https://stackoverflow.com/users/6077979/ozi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1501017216, "creation_date": 1460576623, "last_edit_date": 1501017216, "question_id": 36608114, "link": "https://stackoverflow.com/questions/36608114/ordering-number-and-string-in-c", "title": "Ordering number and string in c", "body": "<p>I want to create a binary search tree and it includes numbers and string such that:</p>\n\n<ul>\n<li>48 jennifer</li>\n<li>35 david</li>\n<li>27 messi</li>\n<li>3 gomez</li>\n<li>85 helena etc.</li>\n</ul>\n\n<p>Now, I need to list them as in order. A part of code is here:</p>\n\n<pre><code>void OrderedById(struct CustomerBSTNode *temp){\n    if(temp != NULL){\n        OrderedById(temp-&gt;left);\n        printf(\"%d  \", temp-&gt;data.ID);\n        printf(\"%s\\n\",temp-&gt;data.name);\n        OrderedById(temp-&gt;right);\n    }\n}\n</code></pre>\n\n<p>All code is here:</p>\n\n<pre><code>struct Customer{\nchar *name; \nint ID; \nstruct BasketLLNode* baskets; };\n\nstruct Product{ \nint ID; \nchar *name; \nint price; };\nstruct CustomerLLNode{\nstruct Customer data;\nstruct CustomerLLNode *next;}*HeadCustomer,*TempCustomer;}\n\nstruct CustomerBSTNode{\nstruct Customer data;\nstruct CustomerBSTNode *left;\nstruct CustomerBSTNode *right;};\nstruct CustomerBSTNode *get_node(){\nstruct CustomerBSTNode *temp;\ntemp = (struct CustomerBSTNode *)malloc(sizeof(struct CustomerBSTNode));\ntemp-&gt;left = NULL;\ntemp-&gt;right = NULL;\nreturn temp; }\n\nvoid insert(struct CustomerBSTNode *root, struct CustomerBSTNode *newNode){\nif(newNode-&gt;data.ID &lt; root-&gt;data.ID)    {\n    if(root-&gt;left == NULL)\n    root-&gt;left = newNode;\n    else\n    insert(root-&gt;left,newNode); }\n\nif(newNode-&gt;data.ID &gt; root-&gt;data.ID){\n    if(root-&gt;right == NULL)\n    root-&gt;right = newNode;\n    else\n    insert(root-&gt;right,newNode);    }}\nvoid OrderedById(struct CustomerBSTNode *temp){\nif(temp != NULL)    {\n    OrderedById(temp-&gt;left);\n    printf(\"%d  \", temp-&gt;data.ID);\n    printf(\"%s\\n\",temp-&gt;data.name);\n    OrderedById(temp-&gt;right);   }}\nint main(){\nchar ans = 'N';\nint key;\nstruct CustomerBSTNode *new_node, *root, *tmp, *parent,*get_node();\nroot = NULL;\nchar CustomerName[25];\nwhile(ans != 'a'){\n    printf(\"Enter Elements: \");\n    new_node = get_node();\n    scanf(\"%d\",&amp;new_node-&gt;data.ID);\n    scanf(\"%s\",new_node-&gt;data.name);\n\n    if(root == NULL)\n    root = new_node;\n    else\n    insert(root,new_node);\n    ans = getch();  }\n\nOrderedById(root);\n\nreturn 0;}\n</code></pre>\n\n<p>I want the output of this code to be:</p>\n\n<ul>\n<li>3 gomez</li>\n<li>27 messi</li>\n<li>35 david</li>\n<li>48 jennifer</li>\n<li>85 helena </li>\n</ul>\n\n<p>But the code gives: </p>\n\n<ul>\n<li>3 helena</li>\n<li>27 helena</li>\n<li>35 helena</li>\n<li>48 helena</li>\n<li>85 helena </li>\n</ul>\n\n<p>What is my error? It orders by id but the name is the same in all lines.</p>\n"}, {"tags": ["c", "gcc", "header-files"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1460576389, "post_id": 36607886, "comment_id": 60812834, "body": "Please don&#39;t name your variables the same as their type."}, {"owner": {"reputation": 3573, "user_id": 3142971, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GvXzQ.png?s=128&g=1", "display_name": "Steampunkery", "link": "https://stackoverflow.com/users/3142971/steampunkery"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1460576761, "post_id": 36607886, "comment_id": 60813086, "body": "Sorry, personal habit.....I&#39;m trying to kill it, but with programmer-created types, its really hard not to."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1460576898, "post_id": 36607886, "comment_id": 60813163, "body": "Actually it is really easy not to, by using a naming convention such as <code>map_t</code> and <code>player_t</code>."}, {"owner": {"reputation": 3573, "user_id": 3142971, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GvXzQ.png?s=128&g=1", "display_name": "Steampunkery", "link": "https://stackoverflow.com/users/3142971/steampunkery"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1460576939, "post_id": 36607886, "comment_id": 60813192, "body": "what does the extra &quot;_t&quot; mean?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1460576986, "post_id": 36607886, "comment_id": 60813218, "body": "It would tell me <code>map_t</code> is a type and distinguish that from the instances of it such as <code>map</code>. For example, suppose you have <code>map *map</code> and then you want <code>sizeof(map)</code>, what do you expect to happen?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1460593049, "post_id": 36607886, "comment_id": 60820255, "body": "Note that names beginning with an underscore and either another underscore or a capital letter are reserved for &#39;the implementation&#39; (the compiler and libraries).  You should not use such names in your own code.  If you copied it from the style used in system headers, then note that the system headers are part of the implementation and are obliged to use such names so that they don&#39;t interfere with you.  Similarly, you should not risk interfering with them.  (It&#39;s only marginally over-simplifying to say that all names beginning with an underscore are best treated as reserved.)"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1460595387, "post_id": 36607886, "comment_id": 60820840, "body": "The extension <code>_t</code> is widely used to indicate &#39;type&#39;; think <code>size_t</code> and <code>wchar_t</code> and <code>uint8_t</code> and <code>pid_t</code> and so on.  However, be aware that POSIX reserves the extension <code>_t</code> for use in type names \u2014 so if you use it, you run the risk of porting to a new system and your type name might conflict with the system&#39;s type name, and it is a pain when that happens.  If you use a systematic prefix, you may be OK; otherwise, you&#39;re on thin ice.  It often isn&#39;t a problem, but you can run into it.  I&#39;ve seen it happen 3 or 4 times for real; a new version of the o/s conflicts with old working code."}], "answers": [{"comments": [{"owner": {"reputation": 3573, "user_id": 3142971, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GvXzQ.png?s=128&g=1", "display_name": "Steampunkery", "link": "https://stackoverflow.com/users/3142971/steampunkery"}, "edited": false, "score": 0, "creation_date": 1460576281, "post_id": 36607943, "comment_id": 60812770, "body": "Thank you! I don&#39;t completely understand why this works, shouldn&#39;t it just ignore it if it isn&#39;t used?"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 3573, "user_id": 3142971, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GvXzQ.png?s=128&g=1", "display_name": "Steampunkery", "link": "https://stackoverflow.com/users/3142971/steampunkery"}, "edited": false, "score": 1, "creation_date": 1460576474, "post_id": 36607943, "comment_id": 60812893, "body": "@Steampunkery, processing of <code>#include</code> statements and compiling the code are done in two different steps that are completely independent. The answer to your question is: &quot;No, the processor cannot ignore an <code>#include</code> statement.&quot;"}, {"owner": {"reputation": 3573, "user_id": 3142971, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GvXzQ.png?s=128&g=1", "display_name": "Steampunkery", "link": "https://stackoverflow.com/users/3142971/steampunkery"}, "edited": false, "score": 0, "creation_date": 1460588534, "post_id": 36607943, "comment_id": 60818853, "body": "see edit, I just had a need to use player.h in map.h"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 3573, "user_id": 3142971, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GvXzQ.png?s=128&g=1", "display_name": "Steampunkery", "link": "https://stackoverflow.com/users/3142971/steampunkery"}, "edited": false, "score": 0, "creation_date": 1460604636, "post_id": 36607943, "comment_id": 60823404, "body": "You can&#39;t use <code>map</code> in player.h and <code>player</code> in map.h. You&#39;ll have to use a pointer in one them -- either use <code>map*</code> in player.h or <code>player*</code> in map.h."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 3, "last_activity_date": 1460576373, "last_edit_date": 1460576373, "creation_date": 1460576095, "answer_id": 36607943, "question_id": 36607886, "link": "https://stackoverflow.com/questions/36607886/header-files-not-including-correctly/36607943#36607943", "title": "Header Files not including correctly", "body": "<p><code>#include</code>ing A.h in B.h and B.h in A.h (circular <code>#include</code>s) is always a problem. If you need something from B.h in A.h and something from A.h in B.h, you'll have to find a way get by with forward declarations.</p>\n\n<p>In your case, you are not using anything from player.h in map.h. Simply remove the following line from map.h.</p>\n\n<pre><code>#include \"player.h\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 0, "last_activity_date": 1460595956, "creation_date": 1460595956, "answer_id": 36612109, "question_id": 36607886, "link": "https://stackoverflow.com/questions/36607886/header-files-not-including-correctly/36612109#36612109", "title": "Header Files not including correctly", "body": "<p>If you can't avoid the mutual references to the types in the functions for the two types, consider whether they really belong in two headers.  Maybe you should put them into one header?  After all, the compiler is always going to end up including both anywy.</p>\n\n<p>Alternatively, consider using opaque types:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/252780/why-should-we-typedef-a-struct-so-often-in-c\">Why should we typedef a struct so often in C?</a></li>\n<li><a href=\"https://stackoverflow.com/questions/7553750/what-is-an-opaque-pointer-in-c\">What is an Opaque pointer in C?</a></li>\n<li><a href=\"https://stackoverflow.com/questions/3965279/opaque-c-structs-how-should-they-be-declared\">Opaque C structs: how should they be declared?</a></li>\n<li><a href=\"https://stackoverflow.com/questions/35295826/c-programming-decoupling-interface-from-implementation-with-struct-forward-decla\">C programming decoupling interface from implementation with struct forward declaration</a></li>\n<li><a href=\"https://stackoverflow.com/questions/11697705/does-the-c-standard-consider-that-there-are-one-or-two-struct-uperms-entry-typ\">Does the C standard consider that there are one or two &#39;struct uperms_entry&#39; types in this header?</a></li>\n<li><a href=\"https://stackoverflow.com/questions/9269691/hide-type-definition-in-c\">Hide type definition in C</a></li>\n<li><a href=\"https://stackoverflow.com/questions/750178/is-it-a-good-idea-to-typedef-pointers\">Is it a good idea to typedef pointers?</a></li>\n</ul>\n\n<p>When using opaque types, you use pointers to those types in the interfaces to functions.  Adapting your code:</p>\n\n<h3><code>map.h</code></h3>\n\n<pre><code>#ifndef MAP_H_INCLUDED\n#define MAP_H_INCLUDED\n\nstruct Map;\nstruct Player;\n\n#include \"player.h\"\n\ntypedef struct Map {\n    char** levelData;\n    int width;\n    int height;\n} Map;\n\nvoid init(struct Map* map,int height, int width);\nvoid print_map(struct Map *map, struct Player *player);\nvoid resume(const char *resFrom, struct Map *map);\nvoid save(const char *saveTo, struct Map *map);\n\n#endif\n</code></pre>\n\n<h3><code>player.h</code></h3>\n\n<pre><code>#ifndef PLAYER_H_INCLUDED\n#define PLAYER_H_INCLUDED\n\nstruct Map;\nstruct Player;\n\n#include \"map.h\"\n\ntypedef struct Player{\n    char* name;\n    int x;\n    int y;\n    int keyMapping;\n    char symbol;\n} Player;\n\nvoid move(struct Map map, char* move, struct Player *player);\nvoid setKeyMapping(int keyMap, struct Player *player);\nvoid initPlr(char* name, int x, int y, struct Player *player);\n\n#endif\n</code></pre>\n\n<p>The arguments are now pointers to maps or pointers to players, not direct copies of the structures.</p>\n\n<p>Either file (or both files) can be specified in a source file using these, and the code will compile with both.  Note, too, that I've separated the typedef names from the variable names.  Using the same name for both is risky.  Using the same name for the tag and the typedef is not a problem; the typedef names are in the ordinary namespace but the tag names are in the separate tag namespace.  (C++ achieves essentially the same effect without an explicit <code>typedef</code> operation: after declaring <code>struct SomeTag</code>, you can use <code>SomeTag</code> to refer to the type.)</p>\n"}], "owner": {"reputation": 3573, "user_id": 3142971, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GvXzQ.png?s=128&g=1", "display_name": "Steampunkery", "link": "https://stackoverflow.com/users/3142971/steampunkery"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 864, "favorite_count": 0, "accepted_answer_id": 36607943, "answer_count": 2, "score": 2, "last_activity_date": 1460595956, "creation_date": 1460575851, "last_edit_date": 1460594731, "question_id": 36607886, "link": "https://stackoverflow.com/questions/36607886/header-files-not-including-correctly", "title": "Header Files not including correctly", "body": "<p>I have the following two header files:</p>\n\n<p><strong>player.h</strong></p>\n\n<pre><code>#ifndef _PLAYER_H_\n#define _PLAYER_H_\n#include \"map.h\"\n\ntypedef struct{\n    char* name;\n    int x;\n    int y;\n    int keyMapping;\n    char symbol;\n}player;\nvoid move(map map, char* move, player player);\nvoid setKeyMapping(int keyMap, player player);\nvoid initPlr(char* name, int x, int y, player player);\n#endif\n</code></pre>\n\n<p>and <strong>map.h</strong></p>\n\n<pre><code>#ifndef _MAP_H_\n#define _MAP_H_\n#include \"player.h\"\n\ntypedef struct{\n    char** levelData;\n    int width;\n    int height;\n}map;\nvoid init(map* map,int height, int width);\nvoid print_map(map map, player player);\nvoid resume(const char *resFrom, map map);\nvoid save(const char *saveTo, map map);\n\n#endif\n</code></pre>\n\n<p>When I run the make file, I get the following error:</p>\n\n<pre><code>player.h:10:11: error: unknown type name \u2018map\u2019\n void move(map map, int move, player player);\n</code></pre>\n\n<p>I am relatively new programmer (in C that is) and I came here is hopes that you guys could help me figure out why the header files aren't seeing each other even though I included them. The compiler I am using is gcc, and I checked to make sure that both of the header files are included in their partner C files. </p>\n\n<p>I also checked out these three posts:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/5343916/include-a-header-in-another-header-file\">Include a header in another header file</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/2679373/include-headers-in-header-file\">Include headers in header file?</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/1804486/should-i-use-include-in-headers\">Should I use #include in headers?</a></p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>If I edit the map.h file as I have above (I added a player parameter to print_map and an include statement) the compiler throws this error:</p>\n\n<pre><code>player.h:12:11: error: unknown type name \u2018map\u2019\n void move(map map, char* move, player player);\n</code></pre>\n"}, {"tags": ["c", "multidimensional-array"], "comments": [{"owner": {"reputation": 5563, "user_id": 5808727, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a8de86a7bb2dbb67425971abc1e1cef8?s=128&d=identicon&r=PG&f=1", "display_name": "Pooya", "link": "https://stackoverflow.com/users/5808727/pooya"}, "edited": false, "score": 2, "creation_date": 1460575891, "post_id": 36607857, "comment_id": 60812516, "body": "n is not initialized before the array definition that&#39;s why"}], "answers": [{"tags": [], "owner": {"reputation": 2775, "user_id": 212514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4ea69157590ddaa2363dd9ad4d7c7d3?s=128&d=identicon&r=PG", "display_name": "user212514", "link": "https://stackoverflow.com/users/212514/user212514"}, "is_accepted": false, "score": 0, "last_activity_date": 1460576106, "creation_date": 1460576106, "answer_id": 36607949, "question_id": 36607857, "link": "https://stackoverflow.com/questions/36607857/passing-arrays-into-functions-file-exe-stopped-working/36607949#36607949", "title": "Passing arrays into functions, file.exe stopped working", "body": "<p>In <code>main()</code> you are using <code>i</code> to index the first dimension of the array.  In <code>summation()</code> you are using <code>i</code> to index the second dimension of the array.  I think that you are going beyond the end of the first dimension inside <code>summation()</code> when <code>main()</code> does not fill up that much of the array (e.g., when you enter 2 for the number of rows). </p>\n\n<p>I think you want</p>\n\n<pre><code>summation (arr,5);\n</code></pre>\n\n<p>And, inside <code>summation()</code>:</p>\n\n<pre><code>for (i=0;i&lt;size;i++)\n{\n   s=s+arr[i][j];\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 91, "user_id": 4076057, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/991a00c4075af75997d11ab2a3ba9dc8?s=128&d=identicon&r=PG&f=1", "display_name": "Enigma", "link": "https://stackoverflow.com/users/4076057/enigma"}, "is_accepted": false, "score": 0, "last_activity_date": 1460576858, "last_edit_date": 1460576858, "creation_date": 1460576513, "answer_id": 36608071, "question_id": 36607857, "link": "https://stackoverflow.com/questions/36607857/passing-arrays-into-functions-file-exe-stopped-working/36608071#36608071", "title": "Passing arrays into functions, file.exe stopped working", "body": "<pre><code>#include&lt;stdio.h&gt;\nvoid summation (int arr[][5], int size, int rows);\nint main()\n{\n    int n, sum, i, j;\n    printf(\"enter the number of rows\");\n    scanf(\"%d\",&amp;n);\n    int arr[n][5];\n    for (i=0;i&lt;n;i++)\n    {\n        for (j=0;j&lt;5;j++)\n    {\n        printf(\"%d,%d th element is\",i,j);\n        scanf(\"%d\",&amp;arr[i][j]);\n    }\n    }\n    summation (arr, 5, n);\n    return 0;\n}\nvoid summation (int arr[][5], int size, int rows)\n{\n    int i,j,s=0;\n    for(i=0;i&lt;rows;j++)\n    {\n\n        for (j=0;i&lt;size;i++)\n        {\n            s=s+arr[i][j];\n        }\n    }\n    printf(\"%d\",s);    \n}\n</code></pre>\n\n<p>So first off I moved your array declaration to after you have initialized n and made it equal to something.</p>\n\n<p>Then your next problem was you were probably going out of bounds in your summation function. You always have 5 columns in your 2darray, but you can have a different amount of rows. Pass the amount of rows, n, into the function summation to make sure you don't go out of bounds.</p>\n"}], "owner": {"reputation": 64, "user_id": 6052688, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/1002233706531651/picture?type=large", "display_name": "Vamshi ", "link": "https://stackoverflow.com/users/6052688/vamshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1460577451, "creation_date": 1460575758, "question_id": 36607857, "link": "https://stackoverflow.com/questions/36607857/passing-arrays-into-functions-file-exe-stopped-working", "title": "Passing arrays into functions, file.exe stopped working", "body": "<p>I am a complete beginner in C and I am practicing passing arrays into functions. I wrote a program to take a two dimensional array as input and find sum of the individual columns. \nAnd when I compiled the program I got no errors, but once I run it, I get a dialogue box saying \"untitled5.exe stopped working\" where untitled5 is the file name. \nI got this error quite a few times. I have used both dev c++ and codeblocks to compile my program, so what is the reason for this? Is this a problem with my code or with my compiler or with my laptop?</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nvoid summation (int arr[][5], int size);\nint main()\n{\n    int n,arr[n][5],sum,i,j;\n    printf(\"enter the number of rows\");\n    scanf(\"%d\",&amp;n);\n    for (i=0;i&lt;n;i++)\n    {\n        for (j=0;j&lt;5;j++)\n    {\n        printf(\"%d,%d th element is\",i,j);\n        scanf(\"%d\",&amp;arr[i][j]);\n    }\n    }\n    summation (arr,5);\n    return 0;\n}\nvoid summation (int arr[][5], int size)\n{\n    int i,j,s=0;\n    for(j=0;j&lt;5;j++)\n    {\n\n        for (i=0;i&lt;5;i++)\n        {\n            s=s+arr[i][j];\n        }\n        printf(\"%d\",s);\n    }\n\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 3, "creation_date": 1460575510, "post_id": 36607751, "comment_id": 60812283, "body": "Obviously, it is not."}, {"owner": {"reputation": 155, "user_id": 5561475, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9c25def2e4bccff5531074fe79f0cefc?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmad Shah", "link": "https://stackoverflow.com/users/5561475/ahmad-shah"}, "edited": false, "score": 0, "creation_date": 1460575655, "post_id": 36607751, "comment_id": 60812374, "body": "Yeah. I thought so too. But If I do that, the program halts. :/"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1460575890, "post_id": 36607751, "comment_id": 60812515, "body": "Then there is another problem which you don&#39;t show. Perhaps this needs the <a href=\"http://stackoverflow.com/help/mcve\">MCVE</a>."}, {"owner": {"reputation": 155, "user_id": 5561475, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9c25def2e4bccff5531074fe79f0cefc?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmad Shah", "link": "https://stackoverflow.com/users/5561475/ahmad-shah"}, "edited": false, "score": 0, "creation_date": 1460576179, "post_id": 36607751, "comment_id": 60812687, "body": "You&#39;re right. Maybe there is another problem. On a side note, and pardon me for my lack of knowledge, but what is the point of returning &#39;a&#39; ?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1460576183, "post_id": 36607751, "comment_id": 60812692, "body": "Another detail: <code>if(a-&gt;array){</code> is an incomplete test given that <code>initialSize</code> could be 0, in which case a <code>NULL</code> return is <i>valid</i>.  Suggest <code>if(a-&gt;array &amp;&amp; initialSize &gt; 0) {</code>.  Other approaches exists."}], "answers": [{"tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": true, "score": 3, "last_activity_date": 1460575656, "creation_date": 1460575656, "answer_id": 36607827, "question_id": 36607751, "link": "https://stackoverflow.com/questions/36607751/is-this-the-right-way-to-free-memory-in-c/36607827#36607827", "title": "Is this the right way to free memory in C?", "body": "<p>No, this is not the right way of doing the <code>free</code>, because you set the pointer to be freed to <code>NULL</code> <em>before</em> actually freeing it. You should do it the other way around:</p>\n\n<pre><code>free(a-&gt;array);  // Free the memory\na-&gt;array = NULL; // Clear out a dangling pointer\n</code></pre>\n\n<p>The pattern with an empty conditional branch is questionable, too. Rather than doing</p>\n\n<pre><code>if(a-&gt;array){\n}\nelse{\n    printf(\"OUT OF MEMORY !!!\\n\\r\");\n}\n</code></pre>\n\n<p>you should do</p>\n\n<pre><code>if(!a-&gt;array){\n    printf(\"OUT OF MEMORY !!!\\n\\r\");\n}\n</code></pre>\n\n<p>You should also set <code>a-&gt;size</code> to zero when the allocation fails (currently your code falls through to the case that sets size to <code>initialSize</code> even on a failed allocation):</p>\n\n<pre><code>if(!a-&gt;array){\n    printf(\"OUT OF MEMORY !!!\\n\\r\");\n    a-&gt;used = 0;\n    a-&gt;size = 0;\n    return;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8006, "user_id": 60335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09c717c1c9e445d2162dfde418d68135?s=128&d=identicon&r=PG", "display_name": "bluebrother", "link": "https://stackoverflow.com/users/60335/bluebrother"}, "is_accepted": false, "score": 2, "last_activity_date": 1460575729, "creation_date": 1460575729, "answer_id": 36607848, "question_id": 36607751, "link": "https://stackoverflow.com/questions/36607751/is-this-the-right-way-to-free-memory-in-c/36607848#36607848", "title": "Is this the right way to free memory in C?", "body": "<p>That <code>freeArray</code> uses the wrong order. It first sets <code>a-&gt;array</code> to <code>NULL</code>, then tries to <code>free</code> a <code>NULL</code> pointer. This doesn't work. You need to swap the first two lines in the function: first <code>free</code>, then set the pointer to <code>NULL</code>.</p>\n\n<pre><code>void freeArray(Array *a) {\n   free(a-&gt;array);\n   a-&gt;array = NULL;   \n   a-&gt;used = 0;\n   a-&gt;size = 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4316, "user_id": 1742659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/BpSsV.jpg?s=128&g=1", "display_name": "dfranca", "link": "https://stackoverflow.com/users/1742659/dfranca"}, "is_accepted": false, "score": 2, "last_activity_date": 1460575778, "creation_date": 1460575778, "answer_id": 36607864, "question_id": 36607751, "link": "https://stackoverflow.com/questions/36607751/is-this-the-right-way-to-free-memory-in-c/36607864#36607864", "title": "Is this the right way to free memory in C?", "body": "<p>When you do this:</p>\n\n<pre><code>void freeArray(Array *a) {\n   a-&gt;array = NULL;    \n   free(a-&gt;array);\n   a-&gt;used = 0;\n   a-&gt;size = 0;\n}\n</code></pre>\n\n<p>You are first assigning NULL to the pointer, let's see what happens when you call free with a NULL pointer looking some <a href=\"http://en.cppreference.com/w/c/memory/free\" rel=\"nofollow\">documentation</a>:</p>\n\n<blockquote>\n  <p>void free( void* ptr ); Deallocates the space previously allocated by\n  malloc(), calloc(), aligned_alloc, (since C11) or realloc(). If ptr is\n  a null pointer, the function does nothing.</p>\n</blockquote>\n\n<p>So nothing happens, you're not deallocating anything, you are creating a memory leak as you don't have the reference to the memory anymore.</p>\n\n<p>To make it works you just need to change the order and set NULL after</p>\n\n<pre><code>void freeArray(Array *a) {\n   free(a-&gt;array);\n   a-&gt;array = NULL;    \n   a-&gt;used = 0;\n   a-&gt;size = 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 5561475, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9c25def2e4bccff5531074fe79f0cefc?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmad Shah", "link": "https://stackoverflow.com/users/5561475/ahmad-shah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 36607827, "answer_count": 3, "score": 0, "last_activity_date": 1460575778, "creation_date": 1460575413, "question_id": 36607751, "link": "https://stackoverflow.com/questions/36607751/is-this-the-right-way-to-free-memory-in-c", "title": "Is this the right way to free memory in C?", "body": "<p>I have a struct in C as follows:</p>\n\n<pre><code>typedef struct ArrayStruct{\nfloat * array;\nsize_t used;\nsize_t size;\n}Array;\n</code></pre>\n\n<p>I initialize it as follows:</p>\n\n<pre><code>void initArray(Array *a, size_t initialSize) {\n    a-&gt;array = (float *)malloc(initialSize * sizeof(float));\n\n    if(a-&gt;array){\n    }\n    else{\n        printf(\"OUT OF MEMORY 1!!\\n\\r\");\n    }\n\n    a-&gt;used = 0;\n    a-&gt;size = initialSize;\n}\n</code></pre>\n\n<p>My question is: Is the following code the right way to free up any memory being utilized by the struct :</p>\n\n<pre><code>void freeArray(Array *a) {\n   a-&gt;array = NULL;    \n   free(a-&gt;array);\n   a-&gt;used = 0;\n   a-&gt;size = 0;\n}\n</code></pre>\n\n<p>Please help. Thank you. :)</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1460574549, "post_id": 36607386, "comment_id": 60811711, "body": "What about successive reads in small chunks until all is read?"}, {"owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 0, "creation_date": 1460575316, "post_id": 36607386, "comment_id": 60812169, "body": "K&amp;R C is not something you should learn nowadays, except if you are curious for historic reasons. Lots of stuff there is frowned upon, outdated or plain wrong nowadays. For example, if you had just RTFM for the <code>read()</code> function, you would have found the declaration that Leandros gave you and probably solved your problem yourself."}, {"owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1460575400, "post_id": 36607386, "comment_id": 60812219, "body": "That would at best be an ugly workaround, @WeatherVane. It is still something to keep in mind if the Fortran side can&#39;t interface with C code."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1460575577, "post_id": 36607386, "comment_id": 60812329, "body": "For up-to-date information on library functions, open a terminal window, and  use the <code>man</code> command. For example, <code>man 2 read</code> tells you all about the <code>read</code> function. The number 2 indicates the section in the manual. Section 1 is mostly shell commands. Sections 2 and 3 have the C library functions."}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1460575359, "post_id": 36607513, "comment_id": 60812195, "body": "How do you know that <code>size_t</code> is big enough to handle 64-bit numbers?  It is allowed to have a maximum representable value as small as 65534."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1460575640, "post_id": 36607513, "comment_id": 60812361, "body": "@JohnBollinger He&#39;s using the POSIX API, not stdio. Doesn&#39;t POSIX require <code>size_t</code> to be large enough for the maximum file size?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1460575791, "post_id": 36607513, "comment_id": 60812452, "body": "@Barmar, POSIX and C both allow <code>SIZE_MAX</code> to be as small as 65534.  See <a href=\"http://pubs.opengroup.org/onlinepubs/009695399/basedefs/stdint.h.html\" rel=\"nofollow noreferrer\">pubs.opengroup.org/onlinepubs/009695399/basedefs/stdint.h.ht&zwnj;&#8203;ml</a>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1460575841, "post_id": 36607513, "comment_id": 60812481, "body": "Ahh, I see. POSIX has <code>off_t</code> for file offsets, but a single <code>read()</code> may still be limited to <code>size_t</code>."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1460575942, "post_id": 36607513, "comment_id": 60812547, "body": "@JohnBollinger If you can&#39;t assume that <code>size_t</code> is 64 bits on a 64-bit system, then <code>size_t</code> is rather useless, isn&#39;t it? (Perhaps that was your point.) In any case, the OP could check the <code>sizeof(size_t)</code> at runtime, and abort if it&#39;s not 8."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1460576126, "post_id": 36607513, "comment_id": 60812646, "body": "@user3386109, why would that make it useless?  It perhaps should make you think more carefully about what types you use for what purpose, but <code>size_t</code>, by definition, serves those purposes for which it is designated.  Instead of assuming it is a wide type, you should consider using a specified-width type such as <code>uint64_t</code>, or  a maximum-width type such as <code>uintmax_t</code>, where you want a wide type."}, {"owner": {"reputation": 16415, "user_id": 1070117, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/075d11243bc7564b736ad01169e12bd7?s=128&d=identicon&r=PG", "display_name": "Leandros", "link": "https://stackoverflow.com/users/1070117/leandros"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1460576134, "post_id": 36607513, "comment_id": 60812651, "body": "@user3386109 Checking if <code>SSIZE_MAX</code> is big enough is the better solution. On 64-bit linux <code>SSIZE_MAX</code> is normally defined to be <code>LONG_MAX</code>. <code>read</code> doesn&#39;t have to support the whole range of <code>size_t</code> (and generally doesn&#39;t, since <code>size_t</code> is unsigned)"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1460576821, "post_id": 36607513, "comment_id": 60813121, "body": "@Leandros, no, checking the width of <code>size_t</code> is still insufficient.  Even if <code>size_t</code> is 64 bits wide, that doesn&#39;t mean that <code>read()</code> or <code>write()</code> will <i>ever</i> transfer any given number of bytes in one call.  In fact, some widely-used implementations are limited to no more than can be represented by an <code>int</code>, despite <code>ssize_t</code> having a greater range."}, {"owner": {"reputation": 16415, "user_id": 1070117, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/075d11243bc7564b736ad01169e12bd7?s=128&d=identicon&r=PG", "display_name": "Leandros", "link": "https://stackoverflow.com/users/1070117/leandros"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1460576900, "post_id": 36607513, "comment_id": 60813164, "body": "@JohnBollinger I said checking <code>size_t</code> is not enough ... you have to check <code>SSIZE_MAX</code>, and the return value of <code>read()</code>. Also, see my edit."}], "tags": [], "owner": {"reputation": 16415, "user_id": 1070117, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/075d11243bc7564b736ad01169e12bd7?s=128&d=identicon&r=PG", "display_name": "Leandros", "link": "https://stackoverflow.com/users/1070117/leandros"}, "is_accepted": false, "score": 5, "last_activity_date": 1460580550, "last_edit_date": 1495541260, "creation_date": 1460574681, "answer_id": 36607513, "question_id": 36607386, "link": "https://stackoverflow.com/questions/36607386/c-low-level-read-write-functions-64-bit-equivalent/36607513#36607513", "title": "C low level read write functions 64-bit equivalent?", "body": "<p><strong>Edit:</strong> You can't, at least not on Linux. <code>read</code> will never transfer more than what a 32-bit integer can hold.</p>\n\n<p>From the manpages of Linux on <code>read</code>:</p>\n\n<blockquote>\n  <p>On Linux, read() (and similar system calls) will transfer at most\n         0x7ffff000 (2,147,479,552) bytes, returning the number of bytes\n         actually transferred.  (This is true on both 32-bit and 64-bit\n         systems.)</p>\n</blockquote>\n\n<p>This is not a contraint of POSIX, it's allowed by POSIX, but in the end it's implementation defined how <code>read</code> behaves. As <a href=\"https://stackoverflow.com/users/4756299/andrew-henle\">Andrew Hanle</a> reports, reading a 32GB file works just fine on Solaris. In this case, my old answer is still valid.</p>\n\n<p><strong>Old Answer:</strong></p>\n\n<p><code>read</code> can work with 64-bit files just fine. It's defined in <code>&lt;unistd.h&gt;</code> as the following:-</p>\n\n<pre><code>ssize_t read(int fd, void *buf, size_t count);\n</code></pre>\n\n<p>You would have to adjust your routines to work with <code>size_t</code> instead of <code>int</code>, to properly support big files.</p>\n\n<p>You should check <code>SSIZE_MAX</code> (the maximum value supported for <code>count</code>), before using <code>read</code> with a big file, and abort if it's to small (or split into smaller chunks). <code>SSIZE_MAX</code> is an implementation defined value.</p>\n"}, {"comments": [{"owner": {"reputation": 16415, "user_id": 1070117, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/075d11243bc7564b736ad01169e12bd7?s=128&d=identicon&r=PG", "display_name": "Leandros", "link": "https://stackoverflow.com/users/1070117/leandros"}, "edited": false, "score": 0, "creation_date": 1460576636, "post_id": 36608041, "comment_id": 60812991, "body": "You have to. <code>read</code> does not support reading more than 0x7ffff000  bytes."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 16415, "user_id": 1070117, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/075d11243bc7564b736ad01169e12bd7?s=128&d=identicon&r=PG", "display_name": "Leandros", "link": "https://stackoverflow.com/users/1070117/leandros"}, "edited": false, "score": 0, "creation_date": 1460577035, "post_id": 36608041, "comment_id": 60813247, "body": "@Leandros, whereas that is true of some implementations, which is already covered in my answer, POSIX does not require it to be true of all implementations.  But yes, that makes it a very good idea to loop."}, {"owner": {"reputation": 16415, "user_id": 1070117, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/075d11243bc7564b736ad01169e12bd7?s=128&d=identicon&r=PG", "display_name": "Leandros", "link": "https://stackoverflow.com/users/1070117/leandros"}, "edited": false, "score": 0, "creation_date": 1460577318, "post_id": 36608041, "comment_id": 60813414, "body": "Correct. You can&#39;t generally answer it, in a non implementation defined manner. While it&#39;s not possible on Linux, some other POSIX compliant platforms might support it. (thinking about Darwin here)"}, {"owner": {"reputation": 16415, "user_id": 1070117, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/075d11243bc7564b736ad01169e12bd7?s=128&d=identicon&r=PG", "display_name": "Leandros", "link": "https://stackoverflow.com/users/1070117/leandros"}, "edited": false, "score": 0, "creation_date": 1460577565, "post_id": 36608041, "comment_id": 60813556, "body": "Neither Darwin nor any BSD man page mention any limitation, except the size of <code>size_t</code>."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 16415, "user_id": 1070117, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/075d11243bc7564b736ad01169e12bd7?s=128&d=identicon&r=PG", "display_name": "Leandros", "link": "https://stackoverflow.com/users/1070117/leandros"}, "edited": false, "score": 1, "creation_date": 1460578411, "post_id": 36608041, "comment_id": 60814056, "body": "@Leandros <i>You have to. read does not support reading more than 0x7ffff000 bytes.</i>  <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/pread.html\" rel=\"nofollow noreferrer\">Not technically true</a>:  <i>If the value of <code>nbyte</code> is greater than <code>{SSIZE_MAX}</code>, the result is implementation-defined.</i> <code>SSIZE_MAX</code> on a 64-bit system is quite a bit larger than <code>0x7ffff000</code>.    I just ran a quick test on Solaris 11 and successfully read 32GB in one read operation and only couldn&#39;t read larger because a 64GB allocation failed. Good code will handle short reads, though, no matter how large the requested number of bytes may be."}, {"owner": {"reputation": 16415, "user_id": 1070117, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/075d11243bc7564b736ad01169e12bd7?s=128&d=identicon&r=PG", "display_name": "Leandros", "link": "https://stackoverflow.com/users/1070117/leandros"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1460578539, "post_id": 36608041, "comment_id": 60814132, "body": "@AndrewHenle Technically very true, on Linux. As stated in my answer. As John stated, it&#39;s not true for every POSIX implementation."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 16415, "user_id": 1070117, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/075d11243bc7564b736ad01169e12bd7?s=128&d=identicon&r=PG", "display_name": "Leandros", "link": "https://stackoverflow.com/users/1070117/leandros"}, "edited": false, "score": 2, "creation_date": 1460579173, "post_id": 36608041, "comment_id": 60814475, "body": "@Leandros Well, your comment that I was responding to didn&#39;t qualify your original <i>&quot;<code>read</code> does not support reading more than 0x7ffff000 bytes&quot;</i>.  It&#39;s irrelevant, though, because code <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/pread.html\" rel=\"nofollow noreferrer\"><b>must</b> handle short reads anyway</a>: <i>If a <code>read()</code> is interrupted by a signal after it has successfully read some data, it shall return the number of bytes read.</i>"}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 0, "last_activity_date": 1460576418, "creation_date": 1460576418, "answer_id": 36608041, "question_id": 36607386, "link": "https://stackoverflow.com/questions/36607386/c-low-level-read-write-functions-64-bit-equivalent/36608041#36608041", "title": "C low level read write functions 64-bit equivalent?", "body": "<p>As @Leandros observed, POSIX-conforming implementations of <code>read()</code> and <code>write()</code> accept byte counts of type <code>size_t</code>, and return byte counts of type <code>ssize_t</code>.  These are probably the definitions that actually apply to you, as the <code>read()</code> and <code>write()</code> functions are not specified by the C standard.  That's a distinction without much difference, however, because <code>size_t</code> is not required to be wider than <code>int</code> -- in fact, it can be narrower.</p>\n\n<p>You anyway have a bigger problem.  The Fortran code seems to assume that the C functions it is calling will read / write the full specified number of bytes or else fail, but POSIX <code>read()</code> and <code>write()</code> are not guaranteed to do that when they succeed.  Indeed, there was a question around here the other day that hinged on the fact that these functions did not transfer more bytes at a time than can be represented by a signed, 32-bit integer, even on a 64-bit system with 64-bit <code>[s]size_t</code>.</p>\n\n<p>You can kill both of these birds with one stone by implementing the <code>read_()</code> and <code>write_()</code> functions to <em>loop</em>, performing successive calls to the underlying <code>read()</code> or <code>write()</code> function, until the full number of specified bytes is transferred or an error occurs.</p>\n"}], "owner": {"reputation": 879, "user_id": 5693785, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/mfKhd.jpg?s=128&g=1", "display_name": "ron", "link": "https://stackoverflow.com/users/5693785/ron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1308, "favorite_count": 1, "answer_count": 2, "score": 5, "last_activity_date": 1460580550, "creation_date": 1460574342, "question_id": 36607386, "link": "https://stackoverflow.com/questions/36607386/c-low-level-read-write-functions-64-bit-equivalent", "title": "C low level read write functions 64-bit equivalent?", "body": "<p>I have some code that uses the low level i/o <code>read</code> and <code>write</code> system calls, as described on page 170  of the C programming language book Kernighan and Ritchie.\nThe function prototypes are this</p>\n\n<pre><code>int n_read = read  ( int fd, char *buf, int n )\nint n_read = write ( int fd, char *buf, int n )\n</code></pre>\n\n<p>now the two .c file that uses these <code>read</code> and <code>write</code> are called by a larger fortran based program to read and write lots of data.</p>\n\n<p>the C code is simply this, with no <code>#include</code> of any kind, having the underscore after the function name and passing by reference:</p>\n\n<pre><code>int read_ ( int *descriptor, char *buffer, int *nbyte )\n{\n   return ( read( *descriptor, buffer, *nbyte ) );\n}\n\nint write_ ( int *descriptor, char *buffer, int *nbyte )\n{\n   return ( write( *descriptor, buffer, *nbyte ) );\n}\n</code></pre>\n\n<p>and the larger fortran based program will do something like this</p>\n\n<pre><code>INTEGER nbyte\nCOMPLEX*16 matrix(*)\nINTEGER READ, WRITE\nEXTERNAL READ, WRITE\n\nstatus = READ( fd, matrix, nbyte )\nif ( status .eq. -1 ) then\n   CALL ERROR('C call read failure')\n   stop\nendif\n</code></pre>\n\n<p>As you may have already guessed, this works fine for <strong>nbyte</strong> values less than 2^31.  I have a need to read more than 2 GB of data, so i need <strong>nbyte</strong> to be a <strong>long integer</strong> and <strong>INTEGER*8</strong> in fortran.</p>\n\n<p>Is there an equivalent read64 and write64,  like there is an lseek64 provided by unistd.h and features.h ?</p>\n\n<p>what is the best way to recode this?\nshould i use fread and fwrite ?\nis the <code>int fd</code> from the low level <code>write</code> the same as <code>FILE *stream</code> from <code>fread()</code> ?</p>\n\n<p>my requirement is being able to pass a long integer of 8 bytes to allow for values up to 100 to 500 gigabytes or an integer having 12 digits, which is all for the value of <strong>nbyte</strong></p>\n\n<p>Am i gaining anything or losing out by currently using <code>read</code> and <code>write</code> which is identified as a <strong>\"system call\"</strong> ?  What does this mean?</p>\n"}, {"tags": ["c", "linux", "sockets", "client-server"], "comments": [{"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1460574551, "post_id": 36607363, "comment_id": 60811715, "body": "It&#39;s not at all clear what you&#39;re asking. What stops either side from just sending multiple messages before it attempts to receive?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1460575018, "post_id": 36607363, "comment_id": 60811985, "body": "A common way to structure this is to use multiple threads. One thread reads from the terminal and sends what the user types to the connection, the other thread reads from the connection and displays the output."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1460575059, "post_id": 36607363, "comment_id": 60812004, "body": "Another way to do it is using <code>select()</code> or <code>poll()</code> to wait for input from both the terminal and network simultaneously in one thread."}], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 6158383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/894a52419735dbf898e7551359ca7b2a?s=128&d=identicon&r=PG&f=1", "display_name": "G. Emadi", "link": "https://stackoverflow.com/users/6158383/g-emadi"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1460575869, "post_id": 36607628, "comment_id": 60812500, "body": "Suppose that you blocked for 1 minute on select, the received messages on socket would be showed 1 minute later. I mean that."}, {"owner": {"reputation": 175, "user_id": 6158383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/894a52419735dbf898e7551359ca7b2a?s=128&d=identicon&r=PG&f=1", "display_name": "G. Emadi", "link": "https://stackoverflow.com/users/6158383/g-emadi"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1460576940, "post_id": 36607628, "comment_id": 60813194, "body": "Thank you for your help. I was mistaken, it is timeout."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1460577226, "post_id": 36607628, "comment_id": 60813364, "body": "If you&#39;re going to use thread, why not just have one thread that blocks on <code>read</code> or <code>recv</code>? Why use <code>select</code> for a thread that has nothing else to do?"}, {"owner": {"reputation": 175, "user_id": 6158383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/894a52419735dbf898e7551359ca7b2a?s=128&d=identicon&r=PG&f=1", "display_name": "G. Emadi", "link": "https://stackoverflow.com/users/6158383/g-emadi"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1460577770, "post_id": 36607628, "comment_id": 60813655, "body": "Because i think that this thread receives the user local chats to send to another peer too."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1460578147, "post_id": 36607628, "comment_id": 60813884, "body": "If you&#39;re going to do both sending and receiving with one thread, why use threads at all? Sure, you can use <code>select</code> to have one thread do both sides, but then you don&#39;t need threads."}], "tags": [], "owner": {"reputation": 175, "user_id": 6158383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/894a52419735dbf898e7551359ca7b2a?s=128&d=identicon&r=PG&f=1", "display_name": "G. Emadi", "link": "https://stackoverflow.com/users/6158383/g-emadi"}, "is_accepted": false, "score": 1, "last_activity_date": 1460578667, "last_edit_date": 1460578667, "creation_date": 1460575036, "answer_id": 36607628, "question_id": 36607363, "link": "https://stackoverflow.com/questions/36607363/socket-server-with-unknown-number-of-receives-in-loop/36607628#36607628", "title": "Socket Server with unknown number of receives in loop", "body": "<p>Yes it could be possible. \nThe main body of your code, does not wait on socket for data. It reads the socket if data is already on it. It is possinle by using select function. After the select call, it reads the socket to display the received messages and sends user messages to other peer if there are ready on input.</p>\n"}, {"tags": [], "owner": {"reputation": 768, "user_id": 3398917, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QLQue.jpg?s=128&g=1", "display_name": "Stormwind", "link": "https://stackoverflow.com/users/3398917/stormwind"}, "is_accepted": false, "score": 0, "last_activity_date": 1460577817, "creation_date": 1460577817, "answer_id": 36608470, "question_id": 36607363, "link": "https://stackoverflow.com/questions/36607363/socket-server-with-unknown-number-of-receives-in-loop/36608470#36608470", "title": "Socket Server with unknown number of receives in loop", "body": "<p>A generic solution: You must use threading, and i'd propose to run the receiving part in a separate thread. </p>\n\n<p>Hence, you first code the main thread to <strong>only</strong> manage sending, just as if the application couldn't receive at all. Apparently you have an edit field somewhere (and a messgae loop somehow). Each time the user presses Enter, you Send from within the Edit field's callback function.</p>\n\n<p>Then you code a <strong>separate thread</strong>, that calls (and hangs on, blocks on) Receive(). Each time Receive \"slips on\" (ie. data came in), you do something with the data and then jump back to the Receive entry point. This goes on until you terminate the socket, or by other means decide to in fact not jump back to the Receive entry point.</p>\n\n<p>The <strong>only</strong> situation where the two threads \"touch\" each other is when they both want to write text content to the same chat window. Both shall do it immediately as the transmission happens, but potentially both may try to access the chat window at exactly the same moment, causing a crash. Hence you muct apply a locking mechanism here; the one that first tries to access the chat window \"gets it\", while the locking mechanism keeps the other one on hold until the first releases the lock. Then the second one can do it's job. The locking is after all only a matter of microseconds.</p>\n\n<p>These are immediate actions, free from each other. You don't need to que multiple messages; each one gets processed \"as it happens\".</p>\n"}], "owner": {"reputation": 51, "user_id": 3160152, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/54631ea6a1cfece6769568976ef08178?s=128&d=identicon&r=PG&f=1", "display_name": "user3160152", "link": "https://stackoverflow.com/users/3160152/user3160152"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1460578667, "creation_date": 1460574277, "question_id": 36607363, "link": "https://stackoverflow.com/questions/36607363/socket-server-with-unknown-number-of-receives-in-loop", "title": "Socket Server with unknown number of receives in loop", "body": "<p>thank you for reading. I'm currently implementing both the server and client for a socket server in C using linux. Currently i have a working \"chat\" system where both the server and the socket can send unique messages and the other end would receive that message with the correct length. </p>\n\n<p>example output:</p>\n\n<pre><code> Server side\n\n You:Hello!\n client:hi, how are you?\n You: fine thanks.\n client: blabla\n</code></pre>\n\n<p>..And the client side would look be as follows:</p>\n\n<pre><code>server: Hello!\nyou:hi,how are you?\n</code></pre>\n\n<p>etc etc.</p>\n\n<p>My question is, is there any way for the client/server to be able to send multiple messages before the other replies?</p>\n\n<p>I currently have an endless while loop that waits for a receive and then proceeds to send, and this will repeat until the connection is lost. Using this method i can only send one message before i am forced to wait for a receive. I'm not sure of the correct implementation as I'm still quite new to both sockets and C! Thanks :)</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 797, "user_id": 5093005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EHlop.jpg?s=128&g=1", "display_name": "jboockmann", "link": "https://stackoverflow.com/users/5093005/jboockmann"}, "edited": false, "score": 2, "creation_date": 1460574183, "post_id": 36607248, "comment_id": 60811486, "body": "looks like you misplaced the <code>{</code> bracket at the printRecords function definition .."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1460574245, "post_id": 36607248, "comment_id": 60811524, "body": "The opening <code>{</code> should follow the function parameter list."}, {"owner": {"reputation": 51, "user_id": 6189715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4f55e20cfbc6dc21bdd8007148d2fa9?s=128&d=identicon&r=PG&f=1", "display_name": "seanncurtis", "link": "https://stackoverflow.com/users/6189715/seanncurtis"}, "edited": false, "score": 0, "creation_date": 1460574949, "post_id": 36607248, "comment_id": 60811945, "body": "ah! thank you guys... now i&#39;m getting an error saying that in my function &#39;printRecords&#39; &#39;count&#39; is redeclared as a different kind of sybole with a note stating where my previous definition is. but i have <code>void printRecord (STUREC records[], int count)</code> followed by a local declaration of <code>int count;</code>... those are the two lines the error code is point at, but i have them both at int, so what could the error be referring to?"}], "answers": [{"comments": [{"owner": {"reputation": 2971, "user_id": 4975646, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XzXhmdjjKB0/AAAAAAAAAAI/AAAAAAAAAeg/9rsygRfbVyk/photo.jpg?sz=128", "display_name": "callyalater", "link": "https://stackoverflow.com/users/4975646/callyalater"}, "edited": false, "score": 0, "creation_date": 1460574740, "post_id": 36607372, "comment_id": 60811843, "body": "Also, <code>i</code> is not a parameter in <code>printRecords</code> and the old style function parameters mean that you do not put the type in the function parameter declarations."}, {"owner": {"reputation": 51, "user_id": 6189715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4f55e20cfbc6dc21bdd8007148d2fa9?s=128&d=identicon&r=PG&f=1", "display_name": "seanncurtis", "link": "https://stackoverflow.com/users/6189715/seanncurtis"}, "edited": false, "score": 0, "creation_date": 1460574965, "post_id": 36607372, "comment_id": 60811950, "body": "ah! thank you guys... now i&#39;m getting an error saying that in my function &#39;printRecords&#39; &#39;count&#39; is redeclared as a different kind of sybole with a note stating where my previous definition is. but i have <code>void printRecord (STUREC records[], int count)</code> followed by a local declaration of <code>int count;</code>... those are the two lines the error code is point at, but i have them both at int, so what could the error be referring to?"}, {"owner": {"reputation": 2971, "user_id": 4975646, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XzXhmdjjKB0/AAAAAAAAAAI/AAAAAAAAAeg/9rsygRfbVyk/photo.jpg?sz=128", "display_name": "callyalater", "link": "https://stackoverflow.com/users/4975646/callyalater"}, "edited": false, "score": 0, "creation_date": 1460575860, "post_id": 36607372, "comment_id": 60812495, "body": "@mame98 Your example doesn&#39;t do what you think it does. You re-declare the parameters as local variables which <i>hides</i> the parameters and makes them inaccessible for the rest of the function."}], "tags": [], "owner": {"reputation": 912, "user_id": 3700391, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e333f3e468da8013cd17b908d4d675f0?s=128&d=identicon&r=PG&f=1", "display_name": "mame98", "link": "https://stackoverflow.com/users/3700391/mame98"}, "is_accepted": false, "score": 1, "last_activity_date": 1460576027, "last_edit_date": 1460576027, "creation_date": 1460574296, "answer_id": 36607372, "question_id": 36607248, "link": "https://stackoverflow.com/questions/36607248/old-style-parameter-declarations-error/36607372#36607372", "title": "&quot;Old-style parameter declarations&quot; error", "body": "<p>You have</p>\n\n<pre><code>void printRecords (STUREC records[], int count)\n\nSTUREC records[ARRAY_MAX];\nint count;\nint i;\n{\n</code></pre>\n\n<p>But I guess you want:</p>\n\n<pre><code>void printRecords (STUREC records[], int count)\n{\n    int i;\n</code></pre>\n\n<p><strong>EDIT:</strong>\nThanks to callyalater for noting the redeclaration of the parameters in the function...</p>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 6189715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4f55e20cfbc6dc21bdd8007148d2fa9?s=128&d=identicon&r=PG&f=1", "display_name": "seanncurtis", "link": "https://stackoverflow.com/users/6189715/seanncurtis"}, "edited": false, "score": 0, "creation_date": 1460575490, "post_id": 36607576, "comment_id": 60812271, "body": "yeah, i just moved my { up haha and it took care of it. im now having an error saying my count in printRecords is being redeclared as a different symbol... the error points to lines 98 and 94. any clue?"}, {"owner": {"reputation": 2971, "user_id": 4975646, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XzXhmdjjKB0/AAAAAAAAAAI/AAAAAAAAAeg/9rsygRfbVyk/photo.jpg?sz=128", "display_name": "callyalater", "link": "https://stackoverflow.com/users/4975646/callyalater"}, "reply_to_user": {"reputation": 51, "user_id": 6189715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4f55e20cfbc6dc21bdd8007148d2fa9?s=128&d=identicon&r=PG&f=1", "display_name": "seanncurtis", "link": "https://stackoverflow.com/users/6189715/seanncurtis"}, "edited": false, "score": 0, "creation_date": 1460575576, "post_id": 36607576, "comment_id": 60812328, "body": "@seanncurtis Get rid of the lines immediately after the <code>{</code> but before <code>int i;</code>. See the last example in my answer."}, {"owner": {"reputation": 51, "user_id": 6189715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4f55e20cfbc6dc21bdd8007148d2fa9?s=128&d=identicon&r=PG&f=1", "display_name": "seanncurtis", "link": "https://stackoverflow.com/users/6189715/seanncurtis"}, "edited": false, "score": 0, "creation_date": 1460575872, "post_id": 36607576, "comment_id": 60812504, "body": "oh i see, if you declare count is an int in the () starting the function, you don&#39;t need to declare that in local declarations?"}, {"owner": {"reputation": 2971, "user_id": 4975646, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XzXhmdjjKB0/AAAAAAAAAAI/AAAAAAAAAeg/9rsygRfbVyk/photo.jpg?sz=128", "display_name": "callyalater", "link": "https://stackoverflow.com/users/4975646/callyalater"}, "reply_to_user": {"reputation": 51, "user_id": 6189715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4f55e20cfbc6dc21bdd8007148d2fa9?s=128&d=identicon&r=PG&f=1", "display_name": "seanncurtis", "link": "https://stackoverflow.com/users/6189715/seanncurtis"}, "edited": false, "score": 0, "creation_date": 1460575906, "post_id": 36607576, "comment_id": 60812528, "body": "Bingo! Otherwise, the function doesn&#39;t know which one you are talking about."}, {"owner": {"reputation": 51, "user_id": 6189715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4f55e20cfbc6dc21bdd8007148d2fa9?s=128&d=identicon&r=PG&f=1", "display_name": "seanncurtis", "link": "https://stackoverflow.com/users/6189715/seanncurtis"}, "edited": false, "score": 0, "creation_date": 1460576003, "post_id": 36607576, "comment_id": 60812581, "body": "makes perfect sense, thank you. i am now receiving an error i&#39;ve never seen in the 4 months i&#39;ve been learning c. it says &#39;error: 1d returned exit status&#39;... it doesnt refer to a line or anything though."}, {"owner": {"reputation": 2971, "user_id": 4975646, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XzXhmdjjKB0/AAAAAAAAAAI/AAAAAAAAAeg/9rsygRfbVyk/photo.jpg?sz=128", "display_name": "callyalater", "link": "https://stackoverflow.com/users/4975646/callyalater"}, "reply_to_user": {"reputation": 51, "user_id": 6189715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4f55e20cfbc6dc21bdd8007148d2fa9?s=128&d=identicon&r=PG&f=1", "display_name": "seanncurtis", "link": "https://stackoverflow.com/users/6189715/seanncurtis"}, "edited": false, "score": 0, "creation_date": 1460576108, "post_id": 36607576, "comment_id": 60812637, "body": "That is a linker error and is completely different than your question here. There are a lot of answers about <code>ld returned exit status 1</code> on SO and online."}, {"owner": {"reputation": 2971, "user_id": 4975646, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XzXhmdjjKB0/AAAAAAAAAAI/AAAAAAAAAeg/9rsygRfbVyk/photo.jpg?sz=128", "display_name": "callyalater", "link": "https://stackoverflow.com/users/4975646/callyalater"}, "reply_to_user": {"reputation": 51, "user_id": 6189715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4f55e20cfbc6dc21bdd8007148d2fa9?s=128&d=identicon&r=PG&f=1", "display_name": "seanncurtis", "link": "https://stackoverflow.com/users/6189715/seanncurtis"}, "edited": false, "score": 0, "creation_date": 1460576259, "post_id": 36607576, "comment_id": 60812751, "body": "@seanncurtis If you think my answer helped, please upvote so that future users can apply this if they are encountering the same problem."}, {"owner": {"reputation": 2971, "user_id": 4975646, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XzXhmdjjKB0/AAAAAAAAAAI/AAAAAAAAAeg/9rsygRfbVyk/photo.jpg?sz=128", "display_name": "callyalater", "link": "https://stackoverflow.com/users/4975646/callyalater"}, "reply_to_user": {"reputation": 51, "user_id": 6189715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4f55e20cfbc6dc21bdd8007148d2fa9?s=128&d=identicon&r=PG&f=1", "display_name": "seanncurtis", "link": "https://stackoverflow.com/users/6189715/seanncurtis"}, "edited": false, "score": 0, "creation_date": 1460576400, "post_id": 36607576, "comment_id": 60812841, "body": "@seanncurtis <a href=\"http://stackoverflow.com/questions/27593029/c-compile-collect2-error-ld-returned-1-exit-status\">This question</a> explains more about linker errors."}, {"owner": {"reputation": 6240, "user_id": 3223157, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/s6g80.jpg?s=128&g=1", "display_name": "Xatenev", "link": "https://stackoverflow.com/users/3223157/xatenev"}, "edited": false, "score": 0, "creation_date": 1543274409, "post_id": 36607576, "comment_id": 93851229, "body": "@callyalater What compilers have stopped supporting this syntax?"}], "tags": [], "owner": {"reputation": 2971, "user_id": 4975646, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XzXhmdjjKB0/AAAAAAAAAAI/AAAAAAAAAeg/9rsygRfbVyk/photo.jpg?sz=128", "display_name": "callyalater", "link": "https://stackoverflow.com/users/4975646/callyalater"}, "is_accepted": false, "score": 1, "last_activity_date": 1460575229, "last_edit_date": 1495541761, "creation_date": 1460574888, "answer_id": 36607576, "question_id": 36607248, "link": "https://stackoverflow.com/questions/36607248/old-style-parameter-declarations-error/36607576#36607576", "title": "&quot;Old-style parameter declarations&quot; error", "body": "<p>If you want to use <a href=\"https://stackoverflow.com/questions/1585390/c-function-syntax-parameter-types-declared-after-parameter-list\">old style C parameter declarations</a>, you need to do this:</p>\n\n<pre><code>void printRecords(records, count)\n    STUREC records[ARRAY_MAX];\n    int count;\n{\n    int i;\n    // ... rest of the code ...\n}\n</code></pre>\n\n<p>But this is not considered a good practice and can make your code harder to read. Some compilers have even stopped supporting this syntax.</p>\n\n<p>The other comments/answers are saying that you <em>re-declare</em> (and therefore hide) your function parameters in the body of the function, but this is not what you want to do (otherwise you effectively lose the parameters being passed in).</p>\n\n<p>If you define a function like this:</p>\n\n<pre><code>void fxn(int num) {\n    int num;\n    num = num;\n}\n</code></pre>\n\n<p>What does <code>num</code> refer to: the parameter or the local variable?</p>\n\n<p>Either do this:</p>\n\n<pre><code>void printRecords(records, count)\n    STUREC records[ARRAY_MAX];\n    int count;\n{\n    int i;\n    // ... rest of the code ...\n}\n</code></pre>\n\n<p>or do this:</p>\n\n<pre><code>void printRecords(STUREC records[], int count)\n{\n    int i;\n    // ... rest of the code ...\n}\n</code></pre>\n\n<p>But don't try to do both or a mixture of the two.</p>\n"}], "owner": {"reputation": 51, "user_id": 6189715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4f55e20cfbc6dc21bdd8007148d2fa9?s=128&d=identicon&r=PG&f=1", "display_name": "seanncurtis", "link": "https://stackoverflow.com/users/6189715/seanncurtis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18021, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1544331690, "creation_date": 1460573948, "last_edit_date": 1460574256, "question_id": 36607248, "link": "https://stackoverflow.com/questions/36607248/old-style-parameter-declarations-error", "title": "&quot;Old-style parameter declarations&quot; error", "body": "<p>I'm having two compile errors when trying to compile my code, and I can't find what the issue really is. Could anybody help shed some light?</p>\n\n<pre><code>error: old-style parameter declarations in prototyped function definition\nerror: 'i' undeclared (first use in this function)\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>void printRecords (STUREC records[], int count)\n\nSTUREC records[ARRAY_MAX];\nint count;\nint i;\n{\n    printf(\"+---------------------------+--------+--------+--------+--------+--------+--------+---------+-------+\\n\");\n    printf(\"| Student Name | ID | Test 1 | Test 2 | Proj 1 | Proj 2 | Proj 3 | Average | Grade |\\n\");\n    printf(\"+---------------------------+--------+--------+--------+--------+--------+--------+---------+-------+\\n\");\n\n    for (i = 0; i &lt; count; i++)\n    {\n        size_t j;\n        printf (\"|%s|%d|%d|%d|%d|%d|%d|%f|%c|\", records[i].name, records[i].id, records[i].score1,\n                 records[i].score2, records[i].score3, records[i].score4, records[i].score5,\n                  records[i].ave, records[i].grade);\n    }\n\n    return;\n}\n</code></pre>\n"}, {"tags": ["c", "windows", "winapi"], "comments": [{"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 2, "creation_date": 1460574087, "post_id": 36607063, "comment_id": 60811421, "body": "The device context returned from <a href=\"https://msdn.microsoft.com/en-us/library/dd183362.aspx\" rel=\"nofollow noreferrer\">BeginPaint</a> has a properly set clipping region. I don&#39;t know, which device context you render to in your <code>WM_TIMER</code> handler. You should really put all your painting in <code>WM_PAINT</code>, and trigger a repaint from the timer by calling <a href=\"https://msdn.microsoft.com/en-us/library/dd145002.aspx\" rel=\"nofollow noreferrer\">InvalidateRect</a>. And please do show your <b>complete</b> code. We do not know, where your <code>hdc</code> is coming from, for example."}, {"owner": {"reputation": 535, "user_id": 2031025, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/27d8c08d8f77a259a7763d052d1a3831?s=128&d=identicon&r=PG", "display_name": "solusipse", "link": "https://stackoverflow.com/users/2031025/solusipse"}, "edited": false, "score": 0, "creation_date": 1460574126, "post_id": 36607063, "comment_id": 60811443, "body": "Yup, removed old one since it needed to be completely rebuilt."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 1, "creation_date": 1460574230, "post_id": 36607063, "comment_id": 60811515, "body": "You have to do better than this. You&#39;ve already been told to put the painting in WM_PAINT and to do it properly. Don&#39;t try to learn like this. Read a good book. Petzold was how I learnt."}, {"owner": {"reputation": 535, "user_id": 2031025, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/27d8c08d8f77a259a7763d052d1a3831?s=128&d=identicon&r=PG", "display_name": "solusipse", "link": "https://stackoverflow.com/users/2031025/solusipse"}, "edited": false, "score": 0, "creation_date": 1460574686, "post_id": 36607063, "comment_id": 60811803, "body": "Well, thanks. It seems that I need to do some research on my own, but, for the love of god, last thing im going to do is to read a book about winapi in 2016!"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 1, "creation_date": 1460575167, "post_id": 36607063, "comment_id": 60812080, "body": "The Windows API isn&#39;t going away any time soon, and knowing about it is certainly of lasting value. It doesn&#39;t matter whether you write a pure Windows API application, or are involved in an MFC/ATL project, or have to debug a managed Windows Forms application, or subscribe to the Windows Runtime: Knowing the Windows API will be of great value, or is even a mandatory prerequisite. I&#39;d strongly recommend reading <a href=\"https://rads.stackoverflow.com/amzn/click/com/157231995X\" rel=\"nofollow noreferrer\" rel=\"nofollow noreferrer\">Programming Windows&#174;, Fifth Edition</a>. You&#39;ll be glad you did."}, {"owner": {"reputation": 535, "user_id": 2031025, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/27d8c08d8f77a259a7763d052d1a3831?s=128&d=identicon&r=PG", "display_name": "solusipse", "link": "https://stackoverflow.com/users/2031025/solusipse"}, "edited": false, "score": 0, "creation_date": 1460577222, "post_id": 36607063, "comment_id": 60813360, "body": "Maybe you&#39;re right guys, I&#39;ll give it a try in some spare time, thanks! Btw I found a solution - I needed to remove StretchBlt from WM_TIMER and use RedrawWindow everytime new bitmap was selected."}, {"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1460593349, "post_id": 36607063, "comment_id": 60820332, "body": "@MartinJames the previous question used a busy loop to do this; the person was told to use <code>WM_TIMER</code> (I think in an answer), hence this question"}, {"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 0, "creation_date": 1460593671, "post_id": 36607063, "comment_id": 60820406, "body": "@solusipse the Internet has not eliminated the need for books; even though we read many books digitally now, they&#39;re still books. It may be outdated, but the Petzold book is still the way most people learned Windows API, and those who didn&#39;t have it around anyway just in case and have used it from time to time. (The sad reality is that there isn&#39;t a more recent book, let alone a good one; .net swept both Petzold and the market away...) You will find, though, that you&#39;ll still turn to books even in the Internet age for other APIs; even many languages&#39;s/libraries&#39;s docs are written like books!"}, {"owner": {"reputation": 535, "user_id": 2031025, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/27d8c08d8f77a259a7763d052d1a3831?s=128&d=identicon&r=PG", "display_name": "solusipse", "link": "https://stackoverflow.com/users/2031025/solusipse"}, "reply_to_user": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 0, "creation_date": 1460605251, "post_id": 36607063, "comment_id": 60823606, "body": "@andlabs I&#39;m aware of that, I just wanted to avoid reading that particular one as a person who uses Windows maybe once per week."}], "owner": {"reputation": 535, "user_id": 2031025, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/27d8c08d8f77a259a7763d052d1a3831?s=128&d=identicon&r=PG", "display_name": "solusipse", "link": "https://stackoverflow.com/users/2031025/solusipse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1460573433, "creation_date": 1460573433, "question_id": 36607063, "link": "https://stackoverflow.com/questions/36607063/keeping-elements-on-top-using-winapi", "title": "Keeping elements on top using winapi", "body": "<p>I've written a little app in winapi which draws animated background like so:</p>\n\n<pre><code>case WM_PAINT:\n    SelectObject(canvas, images[frame]);\n    StretchBlt(hdc, 0, 0, 640, 320, canvas, 0, 0, 64, 32,  SRCCOPY);\n\n    break;\n\ncase WM_TIMER:\n    SelectObject(canvas, images[frame]);\n    StretchBlt(hdc, 0, 0, 640, 320, canvas, 0, 0, 64, 32,  SRCCOPY);\n\n    frame += 1;\n\n    if (frame == sizeof(images)/sizeof(images[0]))\n        frame = 0;\n\n    break;\n</code></pre>\n\n<p>It works flawlessly but generates some problems when it comes to drawing other elements. I got some labels in the same window.</p>\n\n<p>Right after first frame is drawn in <code>WM_PAINT</code> labels are still visible. When I replace canvas' (<code>HDC canvas = CreateCompatibleDC(hdc)</code>) image with second frame (in <code>WM_TIMER</code>), labels suddenly disappear - I guess they stay under that new layer that is drawn.</p>\n\n<p>Is there any way to keep some elements always on top or bring them to top right after I redraw the bitmap?</p>\n"}, {"tags": ["c", "pthreads"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1460575087, "post_id": 36607057, "comment_id": 60812029, "body": "What do you mean by &quot;using shared global variables doesn&#39;t work quite well because of the cache system.&quot;, and how is this different for pointers to shared objects?"}, {"owner": {"reputation": 877, "user_id": 4830221, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10204799712886824/picture?type=large", "display_name": "Nicolas Scotto Di Perto", "link": "https://stackoverflow.com/users/4830221/nicolas-scotto-di-perto"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1460575675, "post_id": 36607057, "comment_id": 60812384, "body": "I was talking about when you don&#39;t use the <code>volatile</code> keyword (<a href=\"http://stackoverflow.com/questions/78172/using-c-pthreads-do-shared-variables-need-to-be-volatile\" title=\"using c pthreads do shared variables need to be volatile\">stackoverflow.com/questions/78172/&hellip;</a>), but I was confused when I said that because the variables are declared <code>volatile</code>. The problem appears on a staticly allocated array <code>volatile short ring_check[10]</code> which is modified by a thread but another thread reads it and doesn&#39;t see the changes made."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1460575813, "post_id": 36607057, "comment_id": 60812465, "body": "*sigh*. <code>volatile</code> is a red herring. The relevant thing is C11 draft standard n1570, <i>5.1.2.4 Multi-threaded executions and data races, 4 Two expression evaluations conflict if one of them modifies a memory location and the other one reads or modifies the same memory location.[...] 25 The execution of a program contains a data race if it contains two conflicting actions in different threads, at least one of which is not atomic, and neither happens before the other. Any such data race results in undefined behavior.</i> This affects <i>all</i> shared object, whether they be global or not."}, {"owner": {"reputation": 877, "user_id": 4830221, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10204799712886824/picture?type=large", "display_name": "Nicolas Scotto Di Perto", "link": "https://stackoverflow.com/users/4830221/nicolas-scotto-di-perto"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1460576046, "post_id": 36607057, "comment_id": 60812604, "body": "There&#39;s a 30sec delay between the writing and the reading so there&#39;s no race in that case. I edit the post tom make it clearer..."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1460576955, "post_id": 36607057, "comment_id": 60813201, "body": "@NicolasScottoDiPerto If that 30 seconds occurs in a way that is guaranteed to order the operations, then you are fine. But if it just &quot;happens to happen&quot;, then you are not fine. Because this is such a hard thing to understand, why not just use a mutex and not worry about it?"}, {"owner": {"reputation": 877, "user_id": 4830221, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10204799712886824/picture?type=large", "display_name": "Nicolas Scotto Di Perto", "link": "https://stackoverflow.com/users/4830221/nicolas-scotto-di-perto"}, "edited": false, "score": 0, "creation_date": 1460577334, "post_id": 36607057, "comment_id": 60813424, "body": "Other threads needs to modify the variable during the timeout, I tried to explain the program in the edited post."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1460577715, "post_id": 36607057, "comment_id": 60813623, "body": "That&#39;s a lot of text containing about none of the pertinent information needed to decide how to prevent race-conditions in your program."}, {"owner": {"reputation": 877, "user_id": 4830221, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10204799712886824/picture?type=large", "display_name": "Nicolas Scotto Di Perto", "link": "https://stackoverflow.com/users/4830221/nicolas-scotto-di-perto"}, "edited": false, "score": 0, "creation_date": 1460578224, "post_id": 36607057, "comment_id": 60813929, "body": "Sorry but the program is big and I didn&#39;t know what to put. I have extracted the essential now."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1460581787, "post_id": 36607057, "comment_id": 60815877, "body": "Still not quite sure what you&#39;re asking. <code>pthread_create</code> only takes one parameter as the thread&#39;s function parameter, so if you need more than one in each thread&#39;s function you will need to pass them in a struct. If you&#39;re asking about UB, <code>ring_check</code> is clearly operated on in both thread functions without protection. If you&#39;re &quot;sure&quot; that your mandated 30 sec sleep synchronizes the threads (you shouldn&#39;t lie to yourself), don&#39;t spawn the thread that writes 0 to it and see what reads back. It could be there is a buffer overflow somewhere else that&#39;s corrupting the data."}, {"owner": {"reputation": 877, "user_id": 4830221, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10204799712886824/picture?type=large", "display_name": "Nicolas Scotto Di Perto", "link": "https://stackoverflow.com/users/4830221/nicolas-scotto-di-perto"}, "edited": false, "score": 0, "creation_date": 1460626952, "post_id": 36607057, "comment_id": 60834671, "body": "Ok so I have just tested to declare the global <code>short volatile *rc = ring_check</code>, I use it in the threads instead of <code>ring_check</code> and it just works! That is so strange... So what happens?  It can only be a problem due to a cache system, I don&#39;t know which, but I don&#39;t see any other explanation. So why would everyone pass a struct of pointers if having a global pointer works?"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1460630299, "post_id": 36607057, "comment_id": 60836993, "body": "@NicolasScottoDiPerto: I don&#39;t know who &quot;everyone&quot; is, but I suspect they don&#39;t use globals because globals are a mess, and they don&#39;t use shared, modifiable globals because they don&#39;t like data-races resulting in undefined behavior."}], "answers": [{"comments": [{"owner": {"reputation": 877, "user_id": 4830221, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10204799712886824/picture?type=large", "display_name": "Nicolas Scotto Di Perto", "link": "https://stackoverflow.com/users/4830221/nicolas-scotto-di-perto"}, "edited": false, "score": 0, "creation_date": 1460574436, "post_id": 36607277, "comment_id": 60811651, "body": "Yes it&#39;s the first idea I think of, but it would cause a lot of refactoring in my code because there&#39;s a long chain of function after the threads creations and the variables are only access at the end of the chain, so it wouldn&#39;t be elegant to add a parameter to each functions of the chain, they have nothing to do with the variables. Thread can access global variables, but they have a cache copy for each variables and it leads to concurrency inconsistency. So I wonder if having a global pointer instead would trick that mechanism."}, {"owner": {"reputation": 175, "user_id": 6158383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/894a52419735dbf898e7551359ca7b2a?s=128&d=identicon&r=PG&f=1", "display_name": "G. Emadi", "link": "https://stackoverflow.com/users/6158383/g-emadi"}, "reply_to_user": {"reputation": 877, "user_id": 4830221, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10204799712886824/picture?type=large", "display_name": "Nicolas Scotto Di Perto", "link": "https://stackoverflow.com/users/4830221/nicolas-scotto-di-perto"}, "edited": false, "score": 0, "creation_date": 1460575401, "post_id": 36607277, "comment_id": 60812222, "body": "I do not understand the cache copy clearly.could  you clarify this?"}, {"owner": {"reputation": 877, "user_id": 4830221, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10204799712886824/picture?type=large", "display_name": "Nicolas Scotto Di Perto", "link": "https://stackoverflow.com/users/4830221/nicolas-scotto-di-perto"}, "edited": false, "score": 0, "creation_date": 1460575757, "post_id": 36607277, "comment_id": 60812435, "body": "Sorry I was confused, I thought about the problems that may occur on non-<code>volatile</code> variables, but mine are so don&#39;t take it into consideration."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 877, "user_id": 4830221, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10204799712886824/picture?type=large", "display_name": "Nicolas Scotto Di Perto", "link": "https://stackoverflow.com/users/4830221/nicolas-scotto-di-perto"}, "edited": false, "score": 0, "creation_date": 1460578314, "post_id": 36607277, "comment_id": 60813990, "body": "@NicolasScottoDiPerto The same problems can occur on <code>volatile</code> variables. The <code>volatile</code> keyword just inhibits compiler optimizations but the compiler is not the only thing that can optimize memory accesses."}], "tags": [], "owner": {"reputation": 175, "user_id": 6158383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/894a52419735dbf898e7551359ca7b2a?s=128&d=identicon&r=PG&f=1", "display_name": "G. Emadi", "link": "https://stackoverflow.com/users/6158383/g-emadi"}, "is_accepted": false, "score": 0, "last_activity_date": 1460574325, "last_edit_date": 1460574325, "creation_date": 1460574005, "answer_id": 36607277, "question_id": 36607057, "link": "https://stackoverflow.com/questions/36607057/pthread-sharing-variables-with-pointers-in-c/36607277#36607277", "title": "Pthread sharing variables with pointers in C", "body": "<p>You could define a global structure such as thread_inputparam. Put all the global variables' addresses in it and send to all threads, the adress of this structure variable.</p>\n\n<pre><code>int global1;\nstruct thread_input {\n    int *g1;\n   // add other globals'addresses\n}thread_inputparam;\nthread_inputparam.g1=&amp;global1;\n</code></pre>\n"}], "owner": {"reputation": 877, "user_id": 4830221, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10204799712886824/picture?type=large", "display_name": "Nicolas Scotto Di Perto", "link": "https://stackoverflow.com/users/4830221/nicolas-scotto-di-perto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 351, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1460578146, "creation_date": 1460573426, "last_edit_date": 1460578146, "question_id": 36607057, "link": "https://stackoverflow.com/questions/36607057/pthread-sharing-variables-with-pointers-in-c", "title": "Pthread sharing variables with pointers in C", "body": "<p>I'm working on a C project using Pthread that needs to share some variables. There are several lines of code written yet and I just realized that using shared global variables doesn't work quite well because of the cache system.</p>\n\n<p>I find on stackoverflow that a solution is to pass the adress of the variable (in my case it's more than one) to the thread function, what does it change?</p>\n\n<p>Since my thread functions call other functions who will modify the globals, it's a bit painful to add a parameter to the chain of called functions where one function modify the globals.</p>\n\n<p>So I was wondering, would it work to declare global pointers for each globals and use them to acess the global instead of the real globals?</p>\n\n<p>I think it's a superficial inderiction but why wouldn't it work after all?</p>\n\n<p>My program is an UDP network protocol whre networks look like rings or circled simple linked list. Instances of the program on the network are called entities.</p>\n\n<p>An entity entity can insert on a ring or ask an entity to create another ring (dupplication), so the other entity would be on two ring.</p>\n\n<p>The interface is sort of a shell where commands can leads to sending messages on the ring. Messages circle all over the rings after being stopped when they have ever been seen.</p>\n\n<p>The shell is in the main thread, there is a thread for message treatment, another to manage insertion, and there is also a thread to detect broken rings. The problems is located in the ring tester thread. The thread initialize a global array (<code>volatile short ring_check[NRING]</code>) of size of the maximum ring numbers for an entity, initialize the first element with 0 according to the actual number of rings and the rest with -1, after that it send a test message in each ring and sleeps during a timeout of 30sec. When the timeout has finished, it checks for the values in the array.</p>\n\n<p>The values are changed by the thread for message treatment, when a test message went went back, it detects it by its content and write <code>-1</code> to the appropriate <code>ring_check</code> element.</p>\n\n<p>The problem is that after a dupplication, the two rings are tested but the checking for the second failed (<code>ring_check[1] == 0</code>) and I really don't know why... The test message is received, immediately after the sending, after the message treatment modifies <code>ring_check[1]</code> to <code>0</code> I print it to see if the change is really made and it prints 1. But about 20 to 30sec later, the <code>ring_tester</code> wake up from his sleeping time and it reads <code>0</code> in <code>ring_check[1]</code>.</p>\n\n<pre><code>short volatile ring_check[NRING+1];\n\n// The function in the ring tester thread\nstatic void test_ring() {\n    // initialize ring_check array\n    debug(\"ring_tester\", GREEN \"setting ring_check to -1...\");\n    char port_diff[5];\n    // send test messages in each rings\n    int fixed_nring = getnring();\n    for (int i = fixed_nring+1; i &lt; NRING; ++i) {\n        ring_check[i] = -1;\n    }\n    for (int i = 0; i &lt; fixed_nring + 1; i++) {\n        debug(\"ring_tester\", GREEN \"setting ring_check %d to 0...\", i);\n        ring_check[i] = 0;\n        itoa4(port_diff, ent.mdiff_port[i]);\n        debug(\"ring_tester\", GREEN \"sending test to ring %d...\", i);\n        sendmessage(i, \"TEST\", \"%s %s\", ent.mdiff_ip[i], port_diff);\n    }\n    debug(\"test_ring\", GREEN \"timeout beginning...\");\n    sleep(timeout);\n    debug(\"test_ring\", GREEN \"end of timeout.\");\n\n    for (int i = 0; i &lt; fixed_nring + 1 &amp;&amp; ring_check[i] != -1; i++) {\n        debug(\"test_ring\", GREEN \"ring_check[%d]:%d\", i, ring_check[i]);\n        if (ring_check[i]) {\n            debug(\"test_ring\", GREEN \"ring %d: checked.\", i);\n            continue;\n        }\n        else {\n            debug(\"test_ring\", GREEN \"ring %d: checking failed. Ring broken...\", i);\n            continue;\n        }\n    }\n\n\n // The function called by the message treatment thread\n\nstatic int action_test(char *message, char *content, int lookup_flag) {\n    debug(\"action_test\", RED \"entering function...\");\n    if (content[15] != ' ' || content[20] != 0) {\n        debug(\"action_test\", RED \"content not following the protocol.\"\\\n                \"content: \\\"%s\\\"\", content);\n        return 1;\n    }\n    if (lookup_flag) {\n        char mdiff_port[5];\n        int fixed_nring = getnring();\n        for (int i = 0; i &lt; fixed_nring + 1 &amp;&amp; ring_check[i] != -1; ++i) {\n            itoa4(mdiff_port, ent.mdiff_port[i]);\n            // find ring associated with message and actualize the checking\n            if (strncmp(content, ent.mdiff_ip[i], 15) == 0 &amp;&amp;\n                    strncmp(&amp;content[16], mdiff_port, 4) == 0 &amp;&amp;\n                    ring_check[i] != -1) {\n                ring_check[i] = 1;\n                debug(\"action_test\", \n                        RED \"correspondance found, ring_check[%d]:%d\", i, ring_check[i]);\n                return 0;\n            }\n        }\n    }\n    else {\n        sendpacket_all(message);\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "fork"], "comments": [{"owner": {"reputation": 2971, "user_id": 4975646, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XzXhmdjjKB0/AAAAAAAAAAI/AAAAAAAAAeg/9rsygRfbVyk/photo.jpg?sz=128", "display_name": "callyalater", "link": "https://stackoverflow.com/users/4975646/callyalater"}, "edited": false, "score": 1, "creation_date": 1460573378, "post_id": 36607009, "comment_id": 60810964, "body": "<code>exit)0(</code>? Make sure to check your typing before you post."}, {"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1460573578, "post_id": 36607009, "comment_id": 60811109, "body": "What is the value of <code>&#47;proc&#47;sys&#47;kernel&#47;sched_child_runs_first</code> ?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1460573665, "post_id": 36607009, "comment_id": 60811151, "body": "@MarkPlotnick, I don&#39;t think that&#39;s the point.  The question seems to be whether the parent&#39;s and child&#39;s outputs from one <code>printf()</code> call each can be intermingled."}, {"owner": {"reputation": 51, "user_id": 4828978, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/817204221691814/picture?type=large", "display_name": "Eli", "link": "https://stackoverflow.com/users/4828978/eli"}, "edited": false, "score": 0, "creation_date": 1460573771, "post_id": 36607009, "comment_id": 60811218, "body": "the question is what will be the output on screen if the execv failed"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1460574158, "post_id": 36607009, "comment_id": 60811469, "body": "So what purpose does it serve to include the <code>execv()</code> call in your example code?  What difference are you supposing it might make for <code>execv()</code> to fail vs. not being called at all?"}, {"owner": {"reputation": 51, "user_id": 4828978, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/817204221691814/picture?type=large", "display_name": "Eli", "link": "https://stackoverflow.com/users/4828978/eli"}, "edited": false, "score": 0, "creation_date": 1460574371, "post_id": 36607009, "comment_id": 60811597, "body": "i suppose to know what all the outputs of the code ... so there 3 ways first if the fork did not work ... second if fork work and execv worked... third if fork worked and execv did not worked, so my question is if the fork worked(did not failed) and execv failed is it possible to print 190 to my screen ?"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1460574643, "post_id": 36607009, "comment_id": 60811776, "body": "What happened when you tried it and forced the execv() to fail?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1460574871, "post_id": 36607009, "comment_id": 60811911, "body": "Since this is apparently homework, it seems reasonable to presume that you are expected to rely on information presented in class and in out-of-class course resources such as a textbook.  What do these have to say about it?"}, {"owner": {"reputation": 51, "user_id": 4828978, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/817204221691814/picture?type=large", "display_name": "Eli", "link": "https://stackoverflow.com/users/4828978/eli"}, "edited": false, "score": 0, "creation_date": 1460574912, "post_id": 36607009, "comment_id": 60811926, "body": "mom is that you !!!? and no it&#39;s not homework ..."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1460580696, "post_id": 36607009, "comment_id": 60815288, "body": "coursework?   The thing is, your question does not track as anything else but a homework question.  If it was a real issue, with a real app, you could have used an explicit lock, or flock/funlock, or whatever mutex was available, to enforce line-by-line output.  As it stands, it&#39;s very difficult to see your question as anything but an academic exercise of next-to-no use to future SO users."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1460580783, "post_id": 36607009, "comment_id": 60815340, "body": "..and I&#39;m guessing that you did not try it yourself, preferring to leave teh actual work of testing to SO users.  &#39;what the output of this code&#39; gave me my first clue."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1460591158, "post_id": 36607009, "comment_id": 60819725, "body": "the call to <code>execv()</code> will not return unless the call fails.  Then the code should be calling <code>perror()</code> and <code>exit()</code> not trying to print the PID value"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1460591568, "post_id": 36607009, "comment_id": 60819865, "body": "the parent process, is creating a child process.  The parent process should not exit until the child process exits.  This can be accomplished by calling <code>int status;, waitpid( pid, &amp;status, 0 )&#39;</code> in the parent"}], "answers": [{"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1460591823, "creation_date": 1460591823, "answer_id": 36611543, "question_id": 36607009, "link": "https://stackoverflow.com/questions/36607009/what-the-output-of-this-code-and-why/36611543#36611543", "title": "what the output of this code and why?", "body": "<p>it is very unlikely that the child pid would be such a low number as 190, although it is possible.  </p>\n\n<p>It is virtually impossible that the parent pid would be 9 and the child pid would be 10 because the boot of the system would be generating larger pid values than that.</p>\n"}, {"tags": [], "owner": {"reputation": 2048, "user_id": 6192747, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-agy-meieasc/AAAAAAAAAAI/AAAAAAAAAC8/ipYF1p3tygQ/photo.jpg?sz=128", "display_name": "Stian Skjelstad", "link": "https://stackoverflow.com/users/6192747/stian-skjelstad"}, "is_accepted": false, "score": 0, "last_activity_date": 1461140048, "creation_date": 1461140048, "answer_id": 36737720, "question_id": 36607009, "link": "https://stackoverflow.com/questions/36607009/what-the-output-of-this-code-and-why/36737720#36737720", "title": "what the output of this code and why?", "body": "<p>In the child, if execv succeeds, it will never return. This causes the printf() to not be executed. \"190\" you see is only from the parent printing its own pid.</p>\n"}], "owner": {"reputation": 51, "user_id": 4828978, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/817204221691814/picture?type=large", "display_name": "Eli", "link": "https://stackoverflow.com/users/4828978/eli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 2, "score": -6, "last_activity_date": 1461140048, "creation_date": 1460573274, "last_edit_date": 1460573588, "question_id": 36607009, "link": "https://stackoverflow.com/questions/36607009/what-the-output-of-this-code-and-why", "title": "what the output of this code and why?", "body": "<p>I want to ask if is it possible that this code will print 190?</p>\n\n<p>the father pid =9 \nthe child pid = 10\n.\n.\n.</p>\n\n<pre><code>pid_t pid = fork();\n\nif (pid&lt;0)\n{ \n    exit(1);\n}\nelse if (pid&gt;0)\n{\n    printf(\"%d\",getpid());\n    exit(0);\n}\nelse\n{\n    char *const argv[] = {\"sleep\",\"1\",NULL};\n    execv(\"/bin/sleep\", argv);\n    printf(\"%d\",getpid());\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "windows", "ntdll", "nt-native-api"], "comments": [{"owner": {"reputation": 88126, "user_id": 1329652, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/fa4ef026ee4be15d3dbacc95f1773d03?s=128&d=identicon&r=PG&f=1", "display_name": "Kuba hasn&#39;t forgotten Monica", "link": "https://stackoverflow.com/users/1329652/kuba-hasnt-forgotten-monica"}, "edited": false, "score": 0, "creation_date": 1460573939, "post_id": 36606892, "comment_id": 60811329, "body": "If I may ask, why are you writing a native application? If the resources are mapped into the memory, and I presume they&#39;d be or you can easily map the rest of the executable in, you can access them just by knowing their address, so no special APIs are needed. What kinds of embedded resources do you use?"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "reply_to_user": {"reputation": 88126, "user_id": 1329652, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/fa4ef026ee4be15d3dbacc95f1773d03?s=128&d=identicon&r=PG&f=1", "display_name": "Kuba hasn&#39;t forgotten Monica", "link": "https://stackoverflow.com/users/1329652/kuba-hasnt-forgotten-monica"}, "edited": false, "score": 1, "creation_date": 1460577353, "post_id": 36606892, "comment_id": 60813436, "body": "@KubaOber: You need a native application, if you want to execute before the Win32 subsystem is loaded. <i>&quot;You can access them just by knowing their address&quot;</i> - <code>FindResource</code> would be the API to get to know the address."}, {"owner": {"reputation": 685, "user_id": 637815, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Pudqu.jpg?s=128&g=1", "display_name": "Thiago Cardoso", "link": "https://stackoverflow.com/users/637815/thiago-cardoso"}, "edited": false, "score": 0, "creation_date": 1460577697, "post_id": 36606892, "comment_id": 60813617, "body": "Exactly, it is an application that needs to be executed before Win32 is loaded. If the rest of the executable containing the resources aren&#39;t mapped to memory, how can I do it? And how can I programmatically find the resource address once I don&#39;t define it beforehand (it is the linker job to put the resource inside the executable)."}, {"owner": {"reputation": 88126, "user_id": 1329652, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/fa4ef026ee4be15d3dbacc95f1773d03?s=128&d=identicon&r=PG&f=1", "display_name": "Kuba hasn&#39;t forgotten Monica", "link": "https://stackoverflow.com/users/1329652/kuba-hasnt-forgotten-monica"}, "edited": false, "score": 1, "creation_date": 1460585124, "post_id": 36606892, "comment_id": 60817495, "body": "I imagine you&#39;d use <code>cvtres</code> to get an object file from your <code>.res</code> file, then dump it to know the symbol names of each resource, then declare these as extern data for the compiler, and take their address from C code as needed. The linker will patch it all up, just as it does for all other addresses unknown at compile time. You can also tweak linking so that the .rsrc section is mapped (if it isn&#39;t)."}, {"owner": {"reputation": 685, "user_id": 637815, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Pudqu.jpg?s=128&g=1", "display_name": "Thiago Cardoso", "link": "https://stackoverflow.com/users/637815/thiago-cardoso"}, "edited": false, "score": 0, "creation_date": 1460637509, "post_id": 36606892, "comment_id": 60842545, "body": "That&#39;s a good suggestion. Let me see if anyone else has a less hackish way to solve it :)"}], "answers": [{"tags": [], "owner": {"reputation": 685, "user_id": 637815, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Pudqu.jpg?s=128&g=1", "display_name": "Thiago Cardoso", "link": "https://stackoverflow.com/users/637815/thiago-cardoso"}, "is_accepted": true, "score": 3, "last_activity_date": 1465407403, "creation_date": 1465407403, "answer_id": 37709260, "question_id": 36606892, "link": "https://stackoverflow.com/questions/36606892/how-to-access-pe-resources-using-windows-native-api/37709260#37709260", "title": "How to access PE resources using Windows Native API?", "body": "<p>Ntdll exports <code>LdrFindResource_U</code> and <code>LdrAccessResource</code> that are almost counterparts of <a href=\"https://msdn.microsoft.com/en-us/library/ms648042(v=vs.85).aspx\" rel=\"nofollow\">FindResource</a> and <a href=\"https://msdn.microsoft.com/en-us/library/ms648046(v=vs.85).aspx\" rel=\"nofollow\">LoadResource</a>, respectively. You'll need in addition a counterpart of <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms683199(v=vs.85).aspx\" rel=\"nofollow\">GetModuleHandle</a> to use them. <a href=\"https://www.winehq.org\" rel=\"nofollow\">Wine</a> source (specially <a href=\"http://source.winehq.org/git/wine.git/blob/HEAD:/dlls/kernel32/resource.c\" rel=\"nofollow\">resource.c</a> and <a href=\"http://source.winehq.org/git/wine.git/blob_plain/HEAD:/dlls/kernel32/module.c\" rel=\"nofollow\">module.c</a>) can be used as documentation of these functions.</p>\n"}], "owner": {"reputation": 685, "user_id": 637815, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Pudqu.jpg?s=128&g=1", "display_name": "Thiago Cardoso", "link": "https://stackoverflow.com/users/637815/thiago-cardoso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 676, "favorite_count": 2, "accepted_answer_id": 37709260, "answer_count": 1, "score": 4, "last_activity_date": 1465407403, "creation_date": 1460572864, "question_id": 36606892, "link": "https://stackoverflow.com/questions/36606892/how-to-access-pe-resources-using-windows-native-api", "title": "How to access PE resources using Windows Native API?", "body": "<p>I have a <a href=\"https://technet.microsoft.com/en-us/sysinternals/bb897447.aspx\" rel=\"nofollow\">Windows native application</a> that contain <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ff468907(v=vs.85).aspx\" rel=\"nofollow\">embedded resources</a> and I'd like to access them using the <a href=\"https://en.wikipedia.org/wiki/Native_API\" rel=\"nofollow\">native API</a>. Are there native functions that handle resources (something similar to <a href=\"https://msdn.microsoft.com/en-us/library/ms648042(v=vs.85).aspx\" rel=\"nofollow\">FindResource</a>/<a href=\"https://msdn.microsoft.com/en-us/library/ms648046(v=vs.85).aspx\" rel=\"nofollow\">LoadResource</a>) or I will have to create my own PE reader to extract them?</p>\n"}, {"tags": ["c", "string"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1460572736, "post_id": 36606821, "comment_id": 60810546, "body": "Does CodeBlocks not have an integrated debugger?"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1460572825, "post_id": 36606821, "comment_id": 60810604, "body": "Use your debugger to breakpoint/step thorugh the code execution.  Simples."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1460572915, "post_id": 36606821, "comment_id": 60810669, "body": "It can then be useful if you use a simple entry such as <code>&quot;012 45&quot;</code> because the character will also tell you the index it came from."}, {"owner": {"reputation": 345, "user_id": 6200378, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OUFjiCdaoNE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfam0cDhcJAqKaoUxIGZm5ItEG9DQ/photo.jpg?sz=128", "display_name": "nik_97", "link": "https://stackoverflow.com/users/6200378/nik-97"}, "edited": false, "score": 0, "creation_date": 1460580729, "post_id": 36606821, "comment_id": 60815302, "body": "It&#39;s been only 3-4 weeks since I started C programming. So I am yet to understand how to use the debugger. I will try it in the future thanks :)"}], "answers": [{"tags": [], "owner": {"reputation": 11494, "user_id": 1795279, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4TEag.jpg?s=128&g=1", "display_name": "Haris", "link": "https://stackoverflow.com/users/1795279/haris"}, "is_accepted": false, "score": 0, "last_activity_date": 1460572954, "creation_date": 1460572954, "answer_id": 36606922, "question_id": 36606821, "link": "https://stackoverflow.com/questions/36606821/bug-in-reversing-word-order/36606922#36606922", "title": "Bug in reversing word order", "body": "<p>Your <code>for</code> loop looks wrong, it should be</p>\n\n<pre><code>for(i=0;i&lt;100;i++)\n{\n    while(str[i]!=' ' || str[i]!='\\0')\n    {\n        word[j][k]=str[i];\n        i++;\n        k++;\n    }\n    if(str[i]==' ')\n    {\n        j++;\n    }\n}\n</code></pre>\n\n<p>Notice the <code>k</code> and <code>j</code> increment swap.</p>\n"}, {"tags": [], "owner": {"reputation": 175, "user_id": 6158383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/894a52419735dbf898e7551359ca7b2a?s=128&d=identicon&r=PG&f=1", "display_name": "G. Emadi", "link": "https://stackoverflow.com/users/6158383/g-emadi"}, "is_accepted": false, "score": 0, "last_activity_date": 1460573354, "creation_date": 1460573354, "answer_id": 36607039, "question_id": 36606821, "link": "https://stackoverflow.com/questions/36606821/bug-in-reversing-word-order/36607039#36607039", "title": "Bug in reversing word order", "body": "<p>In the first while increase k instead of j.\nIn if(str[i]==' ')  set the null termination for word[j][k] and then increase j instead of k.</p>\n"}, {"comments": [{"owner": {"reputation": 345, "user_id": 6200378, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OUFjiCdaoNE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfam0cDhcJAqKaoUxIGZm5ItEG9DQ/photo.jpg?sz=128", "display_name": "nik_97", "link": "https://stackoverflow.com/users/6200378/nik-97"}, "edited": false, "score": 0, "creation_date": 1460608562, "post_id": 36607731, "comment_id": 60824586, "body": "I tried this code with ideone and it works well ( [link] <a href=\"http://ideone.com/lmbe8f\" rel=\"nofollow noreferrer\">ideone.com/lmbe8f</a> ) . However when I try it with CodeBlocks, I get the output with heavy amount of padding(Screenshot here : [link] <a href=\"http://i.imgur.com/AvbqnrT.jpg\" rel=\"nofollow noreferrer\">i.imgur.com/AvbqnrT.jpg</a> ). How do I go about this thing ?"}, {"owner": {"reputation": 551, "user_id": 4567147, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/20733e11bbf5d2ad7ae1007573afa560?s=128&d=identicon&r=PG&f=1", "display_name": "Tanmay Patil", "link": "https://stackoverflow.com/users/4567147/tanmay-patil"}, "reply_to_user": {"reputation": 345, "user_id": 6200378, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OUFjiCdaoNE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfam0cDhcJAqKaoUxIGZm5ItEG9DQ/photo.jpg?sz=128", "display_name": "nik_97", "link": "https://stackoverflow.com/users/6200378/nik-97"}, "edited": false, "score": 0, "creation_date": 1460645343, "post_id": 36607731, "comment_id": 60849276, "body": "There is new line which is showing up in the output. Change the line 7 to                                     if(  str[i]!=&#39; &#39; &amp;&amp;  str[i]!=&#39;\\0&#39; &amp;&amp; str[i] != &#39;\\n&#39; )"}], "tags": [], "owner": {"reputation": 551, "user_id": 4567147, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/20733e11bbf5d2ad7ae1007573afa560?s=128&d=identicon&r=PG&f=1", "display_name": "Tanmay Patil", "link": "https://stackoverflow.com/users/4567147/tanmay-patil"}, "is_accepted": true, "score": 0, "last_activity_date": 1460575703, "last_edit_date": 1460575703, "creation_date": 1460575367, "answer_id": 36607731, "question_id": 36606821, "link": "https://stackoverflow.com/questions/36606821/bug-in-reversing-word-order/36607731#36607731", "title": "Bug in reversing word order", "body": "<p>Please try this code.<br>\n1) Eliminated extra looping.<br>\n2) Swapped j and k variables . Each row would constitute a new word.<br>\n3) word[0][1..100] would the first word and word[1][1..100] would be second word.  </p>\n\n<pre><code>int main(){\n    fgets(str,100,stdin);\n    printf(\"str is [%s]\\n\",str);\n    int i=0,j=0,k=0;\n    for(i=0;i&lt;100;i++){\n        printf(\"char is [%c]\\n\",str[i]);\n        if(  str[i]!=' ' &amp;&amp;  str[i]!='\\0' )\n        {\n            word[j][k]=str[i];\n            k++;\n        }else if(isspace(str[i]) || str[i] == ' '){\n           printf(\"space found\\n\");\n            j++;\n        }\n    }\n    printf(\"value of j [%d]\\n\",j);\n    while(j&gt;=0){\n        for(k=0;k&lt;100;k++){\n            printf(\"%c\",word[j][k]);\n        }\n        printf(\" \");\n        j--;\n    }\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1460583688, "post_id": 36609483, "comment_id": 60816858, "body": "&quot;I guess this problem occurs due to..&quot; \u2013 no, it occurs due to <code>fgets</code> which also stores the terminating newline code."}, {"owner": {"reputation": 209, "user_id": 3541439, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/9b7fc596fe4e690581262d0a891dd3ce?s=128&d=identicon&r=PG&f=1", "display_name": "user4925", "link": "https://stackoverflow.com/users/3541439/user4925"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1460587180, "post_id": 36609483, "comment_id": 60818363, "body": "@Rad lexus Thanks for reminding me that I forgot about fgets storing  newline code."}], "tags": [], "owner": {"reputation": 209, "user_id": 3541439, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/9b7fc596fe4e690581262d0a891dd3ce?s=128&d=identicon&r=PG&f=1", "display_name": "user4925", "link": "https://stackoverflow.com/users/3541439/user4925"}, "is_accepted": false, "score": 0, "last_activity_date": 1460588667, "last_edit_date": 1460588667, "creation_date": 1460581192, "answer_id": 36609483, "question_id": 36606821, "link": "https://stackoverflow.com/questions/36606821/bug-in-reversing-word-order/36609483#36609483", "title": "Bug in reversing word order", "body": "<p>Below is a Corrected Code. Note the Output doesn't come exactly in one single line. For example the output will always come like this,</p>\n\n<p><strong>EDIT: Thanks to a point reminded by Rad Lexus in the comments. I was able to mitigate the problem a bit</strong></p>\n\n<p><strong>Changes made in Code:</strong></p>\n\n<p>Changed the following code line to</p>\n\n<pre><code>for(i=0;i&lt;strlen(str);i++)\n</code></pre>\n\n<p>This,</p>\n\n<pre><code>for(i=0;i&lt;strlen(str)-1;i++)\n</code></pre>\n\n<p>Although, the problem of outputting all the words in the same line is solved,\nbut there is another problem. Now there is no space between the first and the Second word.</p>\n\n<p>So, the new problem is,</p>\n\n<p>Example 1:</p>\n\n<pre><code>Input: Welcome to Bravo\nOutput: Bravoto Welcome\n</code></pre>\n\n<p>Example 2:</p>\n\n<pre><code> Input: Hello World it's FUBAR\n Output: FUBARit's World Hello\n</code></pre>\n\n<p>A temporary solution to the above problem is to change this code </p>\n\n<pre><code> for(m=j;m&gt;=0;m--){\n        printf(\"%s\",word[m]);\n    }\n</code></pre>\n\n<p>To this code,</p>\n\n<pre><code>   for(m=j;m&gt;=0;m--){\n    if(m == j){\n        printf(\"%s \",word[m]);\n    }\n    else{\n        printf(\"%s\",word[m]);\n    }\n}\n</code></pre>\n\n<p>(I guess this problem occurs due to mapping from a 1D Array to a 2D Array and there is probably some padding involved.) ->  <strong>Edit:This is not due to padding but,</strong> <strong><em>\"I guess this problem occurs due to..\" \u2013 no, it occurs due to fgets which also stores the terminating newline code-Rad Lexus.</em></strong></p>\n\n<p>Anyways, here is the code,</p>\n\n<pre><code> #include&lt;stdio.h&gt;\n #include&lt;string.h&gt;\n\n char str[100];\n char word[100][100];\n\n int main(){\n\n    int i=0,j=0,k=0;\n    int m=0;\n\n    fgets(str,100,stdin);\n\n    for(i=0;i&lt;strlen(str)-1;i++){\n        if(str[i]!=' '){\n            word[j][k]=str[i];\n            //printf(\"%c\",word[j][k]);\n            k++;\n        }\n        if(str[i] == ' ' || str[i] == '\\0'){\n            word[j][k]=' ';\n            k=0;\n            j++;\n        }\n    }\n    for(m=j;m&gt;=0;m--){\n        printf(\"%s\",word[m]);/*-----&gt;TEMPORARY SOLUTION\n                                      for(m=j;m&gt;=0;m--){\n                                         if(m == j){\n                                            printf(\"%s \",word[m]);\n                                         }\n                                          else{\n                                            printf(\"%s\",word[m]);\n                                          }\n                                        }*/\n}\n\nreturn 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 345, "user_id": 6200378, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OUFjiCdaoNE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfam0cDhcJAqKaoUxIGZm5ItEG9DQ/photo.jpg?sz=128", "display_name": "nik_97", "link": "https://stackoverflow.com/users/6200378/nik-97"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 36607731, "answer_count": 4, "score": -1, "last_activity_date": 1460588667, "creation_date": 1460572660, "last_edit_date": 1460574949, "question_id": 36606821, "link": "https://stackoverflow.com/questions/36606821/bug-in-reversing-word-order", "title": "Bug in reversing word order", "body": "<p>I am a beginner to C programming and am trying to \"Split a string into separate words and write the string in reverse\".</p>\n\n<p>Sample Input : <code>Hello World it's FUBAR</code></p>\n\n<p>Sample Output: <code>FUBAR it's World Hello</code></p>\n\n<p>I have tried it with this code so far on CodeBlocks 13.12(Windows 8.1/AMD A8) :</p>\n\n<pre><code>   #include&lt;stdio.h&gt;\n   #include&lt;string.h&gt;\n\n   char str[100];\n   char word[100][100];\n\n\n\n    int main(){\n        fgets(str,100,stdin);\n        int i=0,j=0,k=0;\n        for(i=0;i&lt;100;i++){\n            while(str[i]!=' ' || str[i]!='\\0')\n            {\n            word[j][k]=str[i];\n            i++;\n            j++;\n        }\n        if(str[i]==' '){\n            k++;\n            }\n        }\n    while(k&gt;0){\n        for(j=0;j&lt;100;j++){\n            printf(\"%s\",word[j]);\n            }\n        printf(\" \");\n        k--;\n    }\n    return 0;\n    }\n</code></pre>\n\n<p>The code compiles with 0 errors, 0 warnings.</p>\n\n<p>But when I build and run the code, it crashes with error message -1073741510.\nI have been trying for many hours now but have not been able to figure out where exactly the code is breaking.Please help me with this one.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 6, "creation_date": 1460572366, "post_id": 36606697, "comment_id": 60810316, "body": "<code>Set_MAX_TEMP</code> != <code>SET_MAX_TEMP</code> because C is case-sensitive."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1460572408, "post_id": 36606697, "comment_id": 60810336, "body": "Which line are you getting an error for? Why do you have <code>printf()</code> lines at top-level like this?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 5, "creation_date": 1460572442, "post_id": 36606697, "comment_id": 60810357, "body": "If you want to cause compile-time errors when a macro isn&#39;t defined use <code>#error</code>."}, {"owner": {"reputation": 99, "user_id": 4640571, "user_type": "registered", "accept_rate": 12, "profile_image": "https://graph.facebook.com/10206276643418737/picture?type=large", "display_name": "Wouter", "link": "https://stackoverflow.com/users/4640571/wouter"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1460572475, "post_id": 36606697, "comment_id": 60810377, "body": "damnit how did i miss that one -.-, thank you bro"}, {"owner": {"reputation": 99, "user_id": 4640571, "user_type": "registered", "accept_rate": 12, "profile_image": "https://graph.facebook.com/10206276643418737/picture?type=large", "display_name": "Wouter", "link": "https://stackoverflow.com/users/4640571/wouter"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1460572528, "post_id": 36606697, "comment_id": 60810422, "body": "well i was using #warning before, but changed it because i kept getting an error, now i know why as well..."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1460572591, "post_id": 36606697, "comment_id": 60810462, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/19371206/error-expected-declaration-specifiers-or-before-string-constant\">error: expected declaration specifiers or &#39;...&#39; before string constant</a>"}], "answers": [{"comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1460572699, "post_id": 36606775, "comment_id": 60810526, "body": "The <code>#ifndef</code> is supposed to hide those calls and prevent the error."}, {"owner": {"reputation": 912, "user_id": 3700391, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e333f3e468da8013cd17b908d4d675f0?s=128&d=identicon&r=PG&f=1", "display_name": "mame98", "link": "https://stackoverflow.com/users/3700391/mame98"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1460572830, "post_id": 36606775, "comment_id": 60810608, "body": "Yes, but it seems like that the OP passed the wrong arguments (case), so the wrong <code>printf</code> statements will remain..."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1460573121, "post_id": 36606775, "comment_id": 60810802, "body": "I think that&#39;s the point -- he was really wondering why the <code>#ifndef</code> wasn&#39;t working. And it turned out to be a simple typo."}, {"owner": {"reputation": 912, "user_id": 3700391, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e333f3e468da8013cd17b908d4d675f0?s=128&d=identicon&r=PG&f=1", "display_name": "mame98", "link": "https://stackoverflow.com/users/3700391/mame98"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1460573235, "post_id": 36606775, "comment_id": 60810859, "body": "I also think that, but nevertheless the <code>printf</code> is wrong and should be replaced..."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1460573405, "post_id": 36606775, "comment_id": 60810996, "body": "I agree with that, which is why I wrote it in a comment 15 minutes ago."}], "tags": [], "owner": {"reputation": 912, "user_id": 3700391, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e333f3e468da8013cd17b908d4d675f0?s=128&d=identicon&r=PG&f=1", "display_name": "mame98", "link": "https://stackoverflow.com/users/3700391/mame98"}, "is_accepted": false, "score": 7, "last_activity_date": 1535858647, "last_edit_date": 1535858647, "creation_date": 1460572514, "answer_id": 36606775, "question_id": 36606697, "link": "https://stackoverflow.com/questions/36606697/error-expected-declaration-specifiers-or-before-string-constant/36606775#36606775", "title": "error: expected declaration specifiers or &#39;\u2026&#39; before string constant", "body": "<p>You can not use a function call (<code>printf</code>) outside a function.  You should take a look at <code>#error</code> if you want to report errors at compilation...</p>\n\n<p>See <a href=\"https://gcc.gnu.org/onlinedocs/cpp/Diagnostics.html\" rel=\"nofollow noreferrer\">here</a></p>\n"}], "owner": {"reputation": 99, "user_id": 4640571, "user_type": "registered", "accept_rate": 12, "profile_image": "https://graph.facebook.com/10206276643418737/picture?type=large", "display_name": "Wouter", "link": "https://stackoverflow.com/users/4640571/wouter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34055, "favorite_count": 2, "answer_count": 1, "score": 1, "last_activity_date": 1535858647, "creation_date": 1460572244, "last_edit_date": 1460572479, "question_id": 36606697, "link": "https://stackoverflow.com/questions/36606697/error-expected-declaration-specifiers-or-before-string-constant", "title": "error: expected declaration specifiers or &#39;\u2026&#39; before string constant", "body": "<p>Does anybody know what is wrong with this piece of code? i can't see to find the issue among the comparable questions.</p>\n\n<p>The code is written in C, and i keep getting this error. I do add <code>-D SET_MIN_TEMP=5 -D Set_MAX_TEMP=30</code> to the gcc compile line to make sure the ifndefs should be false... </p>\n\n<pre><code>#ifndef CONFIG_H\n#define CONFIG_H\n\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n#include &lt;stdint.h&gt;\n\n#ifndef RUN_AVG_LENGTH\n    #define RUN_AVG_LENGTH 5\n#endif\n\n#ifndef SET_MIN_TEMP\n    printf(\"please set SET_MIN_TEMP \\n\");\n#endif\n\n#ifndef SET_MAX_TEMP\n    printf(\"please set SET_MAX_TEMP \\n\");\n#endif\n\ntypedef uint16_t sensor_id_t;\ntypedef uint16_t room_id_t;\ntypedef double sensor_value_t;\ntypedef time_t sensor_ts_t;     // UTC timestamp as returned by time() - notice that the size of time_t is different on 32/64 bit machine\n\ntypedef struct {\n  sensor_id_t id;\n  sensor_value_t value;\n  sensor_ts_t ts;\n} sensor_data_t;\n\ntypedef struct {\n    sensor_id_t sensor_id;\n    room_id_t room_id;\n    double running_avg[5];\n    sensor_ts_t timestamp;\n} sensor_node_t;\n\n\n#endif // CONFIG_H\n</code></pre>\n"}, {"tags": ["c", "assembly", "x86-64", "gnu-assembler"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1460572637, "post_id": 36606646, "comment_id": 60810498, "body": "OK, well, if you put a breakpoint on the &#39;pushq %rbp&#39;, does it get hit?"}, {"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 1, "creation_date": 1460573506, "post_id": 36606646, "comment_id": 60811074, "body": "As I mentioned in your previous submission, <code>write</code> is a reserved word in &#39;C&#39;.  Rename your function and try again."}, {"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 3, "creation_date": 1460573609, "post_id": 36606646, "comment_id": 60811133, "body": "Correction: it&#39;s not a reserved word but it is a function that&#39;s commonly used by &#39;C&#39; programs and may be linking with your program before your local function gets called.  My advice stands."}, {"owner": {"reputation": 495, "user_id": 2678074, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/694a7322a7bdcd93005e538faf623d50?s=128&d=identicon&r=PG&f=1", "display_name": "user2678074", "link": "https://stackoverflow.com/users/2678074/user2678074"}, "edited": false, "score": 0, "creation_date": 1460573741, "post_id": 36606646, "comment_id": 60811192, "body": "Ooooh. I&#39;ll try this, as as function works from as... give me sec."}, {"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 1, "creation_date": 1460573795, "post_id": 36606646, "comment_id": 60811236, "body": "Just avoid the collision - name it _writeStr instead of _write"}, {"owner": {"reputation": 495, "user_id": 2678074, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/694a7322a7bdcd93005e538faf623d50?s=128&d=identicon&r=PG&f=1", "display_name": "user2678074", "link": "https://stackoverflow.com/users/2678074/user2678074"}, "edited": false, "score": 1, "creation_date": 1460574049, "post_id": 36606646, "comment_id": 60811395, "body": "Renamed to &#39;writehello&#39;. I now have: undefined reference to `writehello&#39;. It looks, like from C it cant see assembly function :/"}, {"owner": {"reputation": 495, "user_id": 2678074, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/694a7322a7bdcd93005e538faf623d50?s=128&d=identicon&r=PG&f=1", "display_name": "user2678074", "link": "https://stackoverflow.com/users/2678074/user2678074"}, "edited": false, "score": 1, "creation_date": 1460574583, "post_id": 36606646, "comment_id": 60811735, "body": "Okay, i got it! It cannot have underscores in function name in my case... You were right about naming! I will &#39;+&#39; your comments and add an answer! Thank you!"}], "answers": [{"tags": [], "owner": {"reputation": 495, "user_id": 2678074, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/694a7322a7bdcd93005e538faf623d50?s=128&d=identicon&r=PG&f=1", "display_name": "user2678074", "link": "https://stackoverflow.com/users/2678074/user2678074"}, "is_accepted": false, "score": 2, "last_activity_date": 1460574839, "creation_date": 1460574839, "answer_id": 36607557, "question_id": 36606646, "link": "https://stackoverflow.com/questions/36606646/mixing-c-and-assembly-hello-world-on-64-bit-linux/36607557#36607557", "title": "Mixing C and Assembly. `Hello World` on 64-bit Linux", "body": "<p>Okay, so my code had two mistakes:</p>\n\n<p>1) I named my as function 'write' that is common c name and i needed to rename it.</p>\n\n<p>2) in function name, i shouldn't put underscores.</p>\n\n<p>Proper code:</p>\n\n<p>writehello.s</p>\n\n<pre><code>.data\nSYSREAD = 0\nSYSWRITE = 1\nSYSEXIT = 60\nSTDOUT = 1\nSTDIN = 0\nEXIT_SUCCESS = 0\n\nmessage: .ascii \"Hello, world!\\n\"\nmessage_len =  .-message\n\n.text\n#.global main\n#main:\n#call write\n#movq $SYSEXIT, %rax\n#movq $EXIT_SUCCESS, %rdi\n#syscall\n\n#********\n.global writehello\nwritehello:\npushq %rbp\nmovq %rsp, %rbp\nmovq $SYSWRITE, %rax\nmovq $STDOUT, %rdi\nmovq $message, %rsi\nmovq $message_len, %rdx\nsyscall\npopq %rbp\nret\n</code></pre>\n\n<p>main.c</p>\n\n<pre><code>extern void writehello(void);\nint main (int argc, char **argv)\n{\n    writehello();\n    return 0;\n}\n</code></pre>\n\n<p>Compilation stays as is :) Thanks to everyone that helped!</p>\n"}, {"tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": false, "score": 2, "last_activity_date": 1462021342, "last_edit_date": 1462021342, "creation_date": 1461999584, "answer_id": 36951838, "question_id": 36606646, "link": "https://stackoverflow.com/questions/36606646/mixing-c-and-assembly-hello-world-on-64-bit-linux/36951838#36951838", "title": "Mixing C and Assembly. `Hello World` on 64-bit Linux", "body": "<p>The tutorial you're reading is not quite right. There has been two differing conventions for global symbols in the ELF (Executable and Linkable Format) executables. One convention says that all global C symbols should be prefixed with <code>_</code>, the other convention does not prefix the C symbols. <strong>In GNU/Linux, especially in x86-64 ABI, the global symbols <em>are not prefixed with <code>_</code></em></strong>. However the tutorial that you linked might be right for some <em>other</em> compiler for Linux/ELF that didn't use the GNU libc.</p>\n\n<hr>\n\n<p>Now, what happens in your original code is that your assembler function would be visible as <code>_write</code> in C code, not <code>write</code>. Instead, the <code>write</code> symbol is found in the <code>libc</code> (the wrapper for <code>write(2)</code> system call):</p>\n\n<pre><code>ssize_t write(int fd, const void *buf, size_t count);\n</code></pre>\n\n<p>Now you declared <em>this</em> <code>write</code> as a function <code>void write(void);</code>, which leads to <strong>undefined behaviour</strong> as such when you call it. You can use <code>strace ./program</code> to find out what system calls it makes:</p>\n\n<pre><code>% strace ./program\n...\nwrite(1, \"\\246^P\\313\\374\\177\\0\\0\\0\\0\\0\\0\\0\\0\"..., 140723719521144) = -1 EFAULT (Bad address)\n...\n</code></pre>\n\n<p>So it called the <code>write</code> system call not with your intended arguments, but with whatever garbage there was in the registers provided to glibc <code>write</code> wrapper. (actually the \"garbage\" is known here - first argument is the <code>argc</code>, and the second argument is the value of <code>argv</code> and the 3rd argument is the value of <code>char **environ</code>). And as the kernel noticed that a buffer starting at <code>(void*)argv</code> and 140723719521144 bytes long wasn't completely contained within the mapped address space, it returned <code>EFAULT</code> from that system call. Result: no crash, no message.</p>\n\n<hr>\n\n<p><code>write</code> is not a reserved word as such in C. It is a function and possibly a macro in POSIX. You <em>could</em> overwrite it, the linking order matters - if you program defines <code>write</code>, other code would be linked against this definition instead of the one found in glibc. However this would mean that other code calling <code>write</code> would end up calling your incompatible function instead.</p>\n\n<p>Thus the solution is to not use a name that is a function in the GNU libc or in any other libraries that you've linked against. Thus in assembler you can use:</p>\n\n<pre><code>.global writehello\nwritehello:\n</code></pre>\n\n<p>and then </p>\n\n<pre><code>extern void writehello(void);\n</code></pre>\n\n<p>as you yourself have found out.</p>\n"}], "owner": {"reputation": 495, "user_id": 2678074, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/694a7322a7bdcd93005e538faf623d50?s=128&d=identicon&r=PG&f=1", "display_name": "user2678074", "link": "https://stackoverflow.com/users/2678074/user2678074"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 346, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1462021342, "creation_date": 1460572121, "last_edit_date": 1462000255, "question_id": 36606646, "link": "https://stackoverflow.com/questions/36606646/mixing-c-and-assembly-hello-world-on-64-bit-linux", "title": "Mixing C and Assembly. `Hello World` on 64-bit Linux", "body": "<p>Based on this <a href=\"https://pl.wikibooks.org/wiki/C/%C5%81%C4%85czenie_z_innymi_j%C4%99zykami\" rel=\"nofollow\">tutorial</a>, I am trying to write <code>Hello World</code> to the console on 64 bit Linux. Compilation raises no errors, but I get no text on console either. I don't know what is wrong.</p>\n\n<p><strong>write.s</strong>:</p>\n\n<pre><code>.data\n    SYSREAD = 0\n    SYSWRITE = 1\n    SYSEXIT = 60\n    STDOUT = 1\n    STDIN = 0\n    EXIT_SUCCESS = 0\n\nmessage: .ascii \"Hello, world!\\n\"\nmessage_len =  .-message\n\n.text\n.globl _write\n_write:\n    pushq %rbp\n    movq %rsp, %rbp\n    movq $SYSWRITE, %rax\n    movq $STDOUT, %rdi\n    movq $message, %rsi\n    movq $message_len, %rdx\n    syscall\n    popq %rbp\n    ret\n</code></pre>\n\n<p><strong>main.c:</strong></p>\n\n<pre><code>extern void write(void);\nint main (int argc, char **argv)\n{\n    write();\n    return 0;\n}\n</code></pre>\n\n<p>Compiling:</p>\n\n<pre><code>as write.s -o write.o\ngcc main.c -c -o main.o\ngcc main.o write.o -o program\n./program \n</code></pre>\n"}, {"tags": ["c", "ruby", "macos", "openmp", "ruby-c-extension"], "answers": [{"tags": [], "owner": {"reputation": 476, "user_id": 2600779, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002398587067/picture?type=large", "display_name": "Raphael Ottoni", "link": "https://stackoverflow.com/users/2600779/raphael-ottoni"}, "is_accepted": false, "score": 1, "last_activity_date": 1460574075, "last_edit_date": 1460574075, "creation_date": 1460572799, "answer_id": 36606867, "question_id": 36606629, "link": "https://stackoverflow.com/questions/36606629/requiring-lib-openmp-in-ruby-c-extension-gem-osx/36606867#36606867", "title": "Requiring lib (openmp) in ruby C extension gem [OSX]", "body": "<p>To solve this issue, I end up creating a link on /usr/local/bin/gcc to gcc-5:</p>\n\n<pre><code> ln -s /usr/local/bin/gcc-5 /usr/local/bin/gcc\n</code></pre>\n\n<p>and removing the following line from extconf.rb:</p>\n\n<p>CONFIG[\"CC\"] = \"gcc-5\"</p>\n"}], "owner": {"reputation": 476, "user_id": 2600779, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002398587067/picture?type=large", "display_name": "Raphael Ottoni", "link": "https://stackoverflow.com/users/2600779/raphael-ottoni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1460574094, "creation_date": 1460572059, "last_edit_date": 1592644375, "question_id": 36606629, "link": "https://stackoverflow.com/questions/36606629/requiring-lib-openmp-in-ruby-c-extension-gem-osx", "title": "Requiring lib (openmp) in ruby C extension gem [OSX]", "body": "<p>I am starting to develop ruby gem extensions in C and I am stuck with a problem that appears to be simple.</p>\n<p>What I am trying to do is to create a simple gem extension that will execute some code in C that uses openmp.</p>\n<p>Here are my  extconf.rb and my c code:</p>\n<p><strong>extconf.rb</strong></p>\n<pre><code>require &quot;mkmf&quot;\nextension_name = &quot;visualize_helper&quot;\ndir_config(&quot;visualize_helper&quot;)\nCONFIG[&quot;CC&quot;] = &quot;gcc-5&quot;\n$CXXFLAGS += ' -fopenmp '\n$CFLAGS += ' -fopenmp '\nhave_library('gomp', &quot;main&quot;)\ncreate_makefile &quot;visualize_helper/visualize_helper&quot;\n</code></pre>\n<p>I needed to change the compiler <em>CONFIG[&quot;CC&quot;]</em> because OSX default gcc compiler is a CLANG one, so a installed gcc-5 through brew.</p>\n<p><strong>visualize_helper.c</strong></p>\n<pre><code>#include &lt;ruby.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;omp.h&gt;\n\nstatic VALUE openmp_test(VALUE self, VALUE string) {\n\n  int nthreads, tid;\n  FILE *f = fopen(&quot;/tmp/open_mp&quot;, &quot;w&quot;);\n\n  /* Fork a team of threads giving them their own copies of variables */\n  #pragma omp parallel private(nthreads, tid)\n  {\n\n     /* Obtain thread number */\n     tid = omp_get_thread_num();\n     fprintf(f,&quot;Hello World from thread = %d\\n&quot;, tid);\n\n     /* Only master thread does this */\n     if (tid == 0)\n     {\n       nthreads = omp_get_num_threads();\n       fprintf(f,&quot;Number of threads = %d\\n&quot;, nthreads);\n     }\n\n  }  /* All threads join master thread and disband */\n\n  fclose(f);\n  return string;\n}\n\n// Main function called when the gem is loaded\nvoid Init_visualize_helper(void) {\n\n  // Register the method openmp_test as a singleton for the class\n  rb_define_singleton_method(mVisualizeHelper, &quot;openmp_test&quot;,openmp_test, 1 );\n}\n</code></pre>\n<p>When a try to compile, at the first step which is to create the Makefile:</p>\n<pre><code>ruby extconf.rb\n</code></pre>\n<p>I get the following error:</p>\n<pre><code>checking for Init_visualize_helper() in -lgomp... *** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of necessary\nlibraries and/or headers.  Check the mkmf.log file for more details.        \nYou may need configuration options.\n\nProvided configuration options:\n    --with-opt-dir\n    --without-opt-dir\n    --with-opt-include\n    --without-opt-include=${opt-dir}/include\n    --with-opt-lib\n    --without-opt-lib=${opt-dir}/lib\n    --with-make-prog\n    --without-make-prog\n    --srcdir=.\n    --curdir\n    --ruby=/Users/rapha/.rvm/rubies/ruby-2.1.5/bin/ruby\n    --with-visualize_helper-dir\n    --without-visualize_helper-dir\n    --with-visualize_helper-include\n    --without-visualize_helper-include=${visualize_helper-dir}/include\n    --with-visualize_helper-lib\n    --without-visualize_helper-lib=${visualize_helper-dir}/lib\n    --with-gomplib\n    --without-gomplib\n/Users/rapha/.rvm/rubies/ruby-2.1.5/lib/ruby/2.1.0/mkmf.rb:456:in  `try_do': The compiler failed to generate an executable file.   (RuntimeError)\nYou have to install development tools first.\n    from /Users/rapha/.rvm/rubies/ruby-2.1.5/lib/ruby/2.1.0/mkmf.rb:541:in `try_link0'\n    from /Users/rapha/.rvm/rubies/ruby-2.1.5/lib/ruby/2.1.0/mkmf.rb:556:in `try_link'\n    from /Users/rapha/.rvm/rubies/ruby-2.1.5/lib/ruby/2.1.0/mkmf.rb:742:in `try_func'\n    from /Users/rapha/.rvm/rubies/ruby-2.1.5/lib/ruby/2.1.0/mkmf.rb:973:in `block in have_library'\n    from /Users/rapha/.rvm/rubies/ruby-2.1.5/lib/ruby/2.1.0/mkmf.rb:918:in `block in checking_for'\n    from /Users/rapha/.rvm/rubies/ruby-2.1.5/lib/ruby/2.1.0/mkmf.rb:351:in `block (2 levels) in postpone'\n    from /Users/rapha/.rvm/rubies/ruby-2.1.5/lib/ruby/2.1.0/mkmf.rb:321:in `open'\n    from /Users/rapha/.rvm/rubies/ruby-2.1.5/lib/ruby/2.1.0/mkmf.rb:351:in `block in postpone'\n    from /Users/rapha/.rvm/rubies/ruby-2.1.5/lib/ruby/2.1.0/mkmf.rb:321:in `open'\n    from /Users/rapha/.rvm/rubies/ruby-2.1.5/lib/ruby/2.1.0/mkmf.rb:347:in `postpone'\n    from /Users/rapha/.rvm/rubies/ruby-2.1.5/lib/ruby/2.1.0/mkmf.rb:917:in `checking_for'\n    from /Users/rapha/.rvm/rubies/ruby-2.1.5/lib/ruby/2.1.0/mkmf.rb:968:in `have_library'\n    from extconf.rb:7:in `&lt;main&gt;'\n</code></pre>\n<p><strong>mkmf.log</strong></p>\n<pre><code>&quot;gcc -o conftest -I/Users/rapha/.rvm/rubies/ruby-2.1.5/include/ruby-2.1.0/x86_64-darwin14.0 -I/Users/rapha/.rvm/rubies/ruby-2.1.5/include/ruby-2.1.0/ruby/backward -I/Users/rapha/.rvm/rubies/ruby- 2.1.5/include/ruby-2.1.0 -I. -D_XOPEN_SOURCE -D_DARWIN_C_SOURCE - D_DARWIN_UNLIMITED_SELECT -D_REENTRANT   -O3 - I/Users/mpapis/.sm/pkg/active/include -fPIC -mmacosx-version-min=10.7 - pipe -fopenmp  conftest.c  -L. -L/Users/rapha/.rvm/rubies/ruby-2.1.5/lib  -L. -L/Users/mpapis/.sm/pkg/active/lib -fPIC -Bstatic -fstack-protector    -arch x86_64   -lruby-static -framework CoreFoundation  -lpthread -ldl - lobjc &quot;\nld: warning: directory not found for option '- L/Users/mpapis/.sm/pkg/active/lib'\nld: library not found for -lgomp\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\nchecked program was:\n/* begin */\n1: #include &quot;ruby.h&quot;\n2:\n3: int main(int argc, char **argv)\n4: {\n5:   return 0;\n6: }\n/* end */\n</code></pre>\n<p><strong>Things I have tried</strong></p>\n<p>The very first three things that comes to my eyes are:</p>\n<ul>\n<li>&quot;--with-gomplib&quot;</li>\n<li>&quot;You have to install development tools first.&quot;</li>\n<li>the fact the mkmf.log shows gcc (which is CLANG) instead of gcc-5 that I specified in extconf.rb</li>\n</ul>\n<p>I updated my Xcode version to 7.2.1, my RVM to 1.27.0, I even tried to compile ruby 2.1.5 and 2.3.0 through rvm  instead of using the binaries.</p>\n<p><strong>A little more info</strong></p>\n<p>If I remove both lines  of <em>have_lib('gomp',X)</em> the I compile and generate the makefile, and if a check the makefile I see the:</p>\n<pre><code>CC = gcc-5 \n</code></pre>\n"}, {"tags": ["c", "recursion", "readdir", "dirent.h"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1460572140, "post_id": 36606578, "comment_id": 60810196, "body": "When do you do the error checking?  You should use <code>while ((direntry = readdir(directory)) != NULL)</code> for the loop control to save writing the call to <code>readdir()</code> twice. Don&#39;t forget that you need to pass the path to the directory \u2014 and create it \u2014 which mean you should pass that to this function.  Otherwise, you won&#39;t be able to open directories reliably."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1460572195, "post_id": 36606578, "comment_id": 60810230, "body": "Presumably you&#39;re missing a <code>.</code> in <code>if(strcmp(direntry-&gt;d_name,&quot;.&quot;) != 0 &amp;&amp; strcmp(direntry-&gt;d_name,&quot;.&quot;))</code>."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1460572519, "post_id": 36606578, "comment_id": 60810415, "body": "you must check <code>if (subdirectory = opendir(direntry-&gt;d_name))</code> so it is not NULL."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1460578672, "post_id": 36606578, "comment_id": 60814196, "body": "GDB prints the whole 255 or 1024 byte buffer, or thereabouts.  The relevant part is <code>.gtkrc-2.0\\000</code>; the file name in there is currently <code>.gtkrc-2.0</code>.  The rest is debris \u2014 irrelevant."}], "owner": {"reputation": 145, "user_id": 6005566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d61ab614455a652a3880d1d6d5c14ed?s=128&d=identicon&r=PG&f=1", "display_name": "Zeno of Elea", "link": "https://stackoverflow.com/users/6005566/zeno-of-elea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 632, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1460571931, "creation_date": 1460571931, "question_id": 36606578, "link": "https://stackoverflow.com/questions/36606578/dirent-d-name-string-showing-unexpected-values-in-gdb", "title": "dirent d_name string showing unexpected values in gdb", "body": "<p>I am working on a unit test for a program that walks through a file system on a POSIX based OS and I can not figure out a way to use NFTW to walk it without a bunch of global variables so I am using dirent.h readdir() for a solution. To test the logic of the recursion I made this function and it recurses down one directory but ends in a segfault recursing down to a second one.</p>\n\n<pre><code>int recurse_dir(DIR *directory)\n{\n    struct dirent *direntry = readdir(directory);\n    while(direntry != NULL)\n    {\n        struct stat file;\n        lstat(direntry-&gt;d_name,&amp;file);\n        if(S_ISDIR(file.st_mode) &amp;&amp; strcmp(direntry-&gt;d_name,\".\") != 0 &amp;&amp; strcmp(direntry-&gt;d_name,\"..\") != 0)\n        {\n            printf(\"%s:\\n\",direntry-&gt;d_name);\n            DIR *subdirectory;\n            subdirectory = opendir(direntry-&gt;d_name);\n            recurse_dir(subdirectory);\n            closedir(subdirectory);\n            printf(\"\\n\\n\");\n        }\n        else\n        {\n            if(strcmp(direntry-&gt;d_name,\".\") != 0 &amp;&amp; strcmp(direntry-&gt;d_name,\".\"))\n            {\n                printf(\"%s\\n\",direntry-&gt;d_name);\n            }\n        }\n        direntry = readdir(directory);\n    }\n}\n</code></pre>\n\n<p>I tested it with gdb and found that the d_name variable which the man page described as a null terminated string of the current file's name was filled with what looked like the entire directory stream of file names intermixed with a bunch of null's and other escapes. I am posting an example below. Have I just misunderstood what the d_name variable meant?</p>\n\n<p><code>.gtkrc-2.0\\000\\000\\bL\\f@\\000\\000\\000\\000\\000\\303e0x\\261\\233-\\a \\000\\b.kshrc\\000\\000\\000\\000\\000\\000\\b)\\000@\\000\\000\\000\\000\\000Wa\\340\\315\\366\\310y\\a\\030\\000\\004src\\000\\004\\037\\000@\\000\\000\\000\\000\\000\\030\\313\\060\\232\\256\\024\\245\\a \\000\\004Downloads\\000\\000\\000\\004\\237\\n@\\000\\000\\000\\000\\000&gt;5\\321{\\266-\\004\\t \\000\\004.\"...}</code></p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1460571736, "post_id": 36606459, "comment_id": 60809937, "body": "This call: &#39;display_dice_value(d1,d2,d3,d4,d5,d6);&#39; cannot possibly change the values of its arguments as they are all passed by value, leaving d1 uninitialized.  Pass by address."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1460571778, "post_id": 36606459, "comment_id": 60809960, "body": "It does <i>not</i> use the value of <code>d1</code> etc in <code>main</code>. It uses the arguments as local variables, which do not find their way back to main."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1460571864, "post_id": 36606459, "comment_id": 60810031, "body": "&#39;void display_dice_value(int *d1, int *d2, int *d3, int *d4, int *d5, int *d6)&#39;"}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1460571916, "post_id": 36606459, "comment_id": 60810056, "body": "Alternatively, consider making the dice rolls an array, which you can fill."}], "answers": [{"comments": [{"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1460572270, "post_id": 36606550, "comment_id": 60810274, "body": "You sure about those declarations in <code>main</code>?  What do <code>d1</code> through <code>d6</code> point to?"}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "reply_to_user": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1460572432, "post_id": 36606550, "comment_id": 60810352, "body": "@JohnBode; Oops! My bad."}], "tags": [], "owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "is_accepted": false, "score": 0, "last_activity_date": 1460572373, "last_edit_date": 1460572373, "creation_date": 1460571859, "answer_id": 36606550, "question_id": 36606459, "link": "https://stackoverflow.com/questions/36606459/displaying-dice-number-in-c/36606550#36606550", "title": "Displaying dice number in C", "body": "<p>In C arguments to the function are passed by value. <code>d1</code> in function <code>display_dice_value</code> is a copy of <code>d1</code> in <code>main</code>. Updating <code>d1</code> in that function will not affect the <code>d1</code> in <code>main</code>.  You can use pointers instead. </p>\n\n<pre><code>void display_dice_value(int *d1, int *d2, int *d3, int *d4, int *d5, int *d6)\n{\n    *d1=1+rand()%6;\n    *d2=1+rand()%6;\n    *d3=1+rand()%6;\n    *d4=1+rand()%6;\n    *d5=1+rand()%6;\n    *d6=1+rand()%6;\n    printf(\"%d %d %d %d %d %d\",*d1, *d2, *d3, *d4, *d5, *d6);\n}\n\nint main()\n{\n    srand(time(NULL));\n    int d1, d2, d3, d4, d5, d6;\n    display_dice_value(&amp;d1, &amp;d2, &amp;d3, &amp;d4, &amp;d5, &amp;d6);\n    printf(\"\\n%d\", d1);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": false, "score": 1, "last_activity_date": 1460572204, "creation_date": 1460572204, "answer_id": 36606681, "question_id": 36606459, "link": "https://stackoverflow.com/questions/36606459/displaying-dice-number-in-c/36606681#36606681", "title": "Displaying dice number in C", "body": "<p>Like this. If the values are to find their way back to variables defined in <code>main</code>, the function arguments must be pointers, and <code>main</code> should pass their addresses.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n\nvoid display_dice_value(int *d1, int *d2, int *d3, int *d4, int *d5, int *d6)\n{\n    *d1 = 1 + rand() % 6;\n    *d2 = 1 + rand() % 6;\n    *d3 = 1 + rand() % 6;\n    *d4 = 1 + rand() % 6;\n    *d5 = 1 + rand() % 6;\n    *d6 = 1 + rand() % 6;\n    printf(\"%d %d %d %d %d %d\\n\", *d1, *d2, *d3, *d4, *d5, *d6);\n}\n\nint main(void)\n{\n    int d1, d2, d3, d4, d5, d6;\n    srand((unsigned)time(NULL));\n    display_dice_value(&amp;d1, &amp;d2, &amp;d3, &amp;d4, &amp;d5, &amp;d6);\n    printf(\"%d\\n\", d1);\n    return 0;\n}\n</code></pre>\n\n<p>Program output:</p>\n\n<pre><code>4 4 1 6 3 5\n4\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": true, "score": 1, "last_activity_date": 1460572732, "last_edit_date": 1460572732, "creation_date": 1460572225, "answer_id": 36606688, "question_id": 36606459, "link": "https://stackoverflow.com/questions/36606459/displaying-dice-number-in-c/36606688#36606688", "title": "Displaying dice number in C", "body": "<p>To start, you would need to pass <em>pointers</em> to each <code>d<em>i</em></code> to the <code>display_dice_value</code> function:</p>\n\n<pre><code>void display_dice_value(int *d1, int *d2, int *d3, int *d4, int *d5, int *d6)\n{\n    *d1=1+rand()%6;\n    *d2=1+rand()%6;\n    ...\n    printf(\"%d %d %d %d %d %d\",*d1,*d2,*d3,*d4,*d5,*d6);\n}\n\n\nint main()\n{\n    ...\n    int d1,d2,d3,d4,d5,d6;\n    display_dice_value(&amp;d1,&amp;d2,&amp;d3,&amp;d4,&amp;d5,&amp;d6);\n    ...\n}\n</code></pre>\n\n<p>However...</p>\n\n<p>When you find yourself creating a bunch of variables with the same name and a trailing ordinal number, that's a good hint that you really want to be using an <em>array</em>:</p>\n\n<pre><code>void display_dice_value( int *d, size_t numdice )\n{\n  for ( size_t i = 0; i &lt; numdice; i++ )\n    d[i] = 1 + rand() % 6;\n\n  for ( size_t i = 0; i &lt; numdice; i++ )\n    printf( \"%d \", d[i]);\n  putchar( '\\n' );\n}\n\nint main( void )\n{\n   int dice[6];\n   ...\n   display_dice_value( dice, sizeof dice / sizeof *dice );\n   printf( \"dice[0] = %d\\n\", dice[0] );\n   ...\n}\n</code></pre>\n\n<p><strong>ETA</strong></p>\n\n<p>As a final note, your <code>display_dice_value</code> function doesn't just <em>display</em> values; it <em>generates</em> the values as well, which can be confusing.  It would be better to have a separate function to actually generate your dice values:</p>\n\n<pre><code>void generate_dice_values( int *d, size_t numdice )\n{\n  for ( size_t i = 0; i &lt; numdice; i++ )\n    d[i] = 1 = rand() % 6;\n}\n\n/**\n * For flexibility, write to any output stream\n */\nvoid display_dice_values( FILE * stream, int *d, size_t numdice )\n{\n  char *sep = \"\";\n  fputc( '[', stream );\n  for ( size_t i = 0; i &lt; numdice; i++ )\n    fprintf( stream, \"%s%d\", sep, d[i] );\n  fputc( ']', stream );\n}\n\nint main( void )\n{\n  int dice[6];\n  generate_dice_values( dice, sizeof dice / sizeof *dice );\n  printf( \"6 dice rolls: \" );\n  display_dice_values( stdout, dice, sizeof dice / sizeof *dice );\n  putchar( '\\n' );\n  printf( \"d[0] = %d\\n\", d[0] );\n  return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 164, "user_id": 6193510, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dRTC5khvm-g/AAAAAAAAAAI/AAAAAAAAFK0/nKLXuPE-F5Y/photo.jpg?sz=128", "display_name": "Nevado", "link": "https://stackoverflow.com/users/6193510/nevado"}, "is_accepted": false, "score": 1, "last_activity_date": 1460572405, "creation_date": 1460572405, "answer_id": 36606747, "question_id": 36606459, "link": "https://stackoverflow.com/questions/36606459/displaying-dice-number-in-c/36606747#36606747", "title": "Displaying dice number in C", "body": "<p>I would suggest the same thing as @haccks but declaring the variables the variables as <code>int d1</code> instead of <code>int *d1</code> and then passing the pointer: <code>display_dice_value(&amp;d1,&amp;d2,&amp;d3,&amp;d4, &amp;d5, &amp;d6)</code>. I think the other way will give you segmentation fault.</p>\n\n<p>I know this belong in a comment of the answer but I cannot comment yet, sorry.</p>\n"}], "owner": {"reputation": 37, "user_id": 6089985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb32749154505449d530075d58cc9aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nbr", "link": "https://stackoverflow.com/users/6089985/nbr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 1, "accepted_answer_id": 36606688, "answer_count": 4, "score": 0, "last_activity_date": 1460572732, "creation_date": 1460571570, "last_edit_date": 1460571746, "question_id": 36606459, "link": "https://stackoverflow.com/questions/36606459/displaying-dice-number-in-c", "title": "Displaying dice number in C", "body": "<p>I want to display all dice numbers at first and than only number of first dice, but i think it use the value d1 in main(). How can  I do that without using globel variable?</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;time.h&gt;\n\nvoid display_dice_value(int d1, int d2, int d3, int d4, int d5, int d6)\n{\n    d1=1+rand()%6;\n    d2=1+rand()%6;\n    d3=1+rand()%6;\n    d4=1+rand()%6;\n    d5=1+rand()%6;\n    d6=1+rand()%6;\n    printf(\"%d %d %d %d %d %d\",d1,d2,d3,d4,d5,d6);\n}\n\n\nint main()\n{\n    srand(time(NULL));\n    int d1,d2,d3,d4,d5,d6;\n    display_dice_value(d1,d2,d3,d4,d5,d6);\n    printf(\"\\n%d\",d1);\n}\n</code></pre>\n"}, {"tags": ["c", "function-pointers"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1460571625, "post_id": 36606409, "comment_id": 60809875, "body": "How about presenting the declaration of <code>curr_proc</code>&#39;s type?  It&#39;s pretty difficult to sort out type problems without knowing what the types involved actually are."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1460571759, "post_id": 36606409, "comment_id": 60809950, "body": "Also the declaration of the type of the elements of <code>curr_proc-&gt;fds</code>."}, {"owner": {"reputation": 1337, "user_id": 2676875, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e431572659944f579494a0c39356a9ac?s=128&d=identicon&r=PG", "display_name": "Tanishq dubey", "link": "https://stackoverflow.com/users/2676875/tanishq-dubey"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1460572033, "post_id": 36606409, "comment_id": 60810128, "body": "@JohnBollinger Updated"}, {"owner": {"reputation": 932, "user_id": 1721186, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/191bbec6bbd670cff4888c4f9d8e7ca6?s=128&d=identicon&r=PG", "display_name": "Steve Valliere", "link": "https://stackoverflow.com/users/1721186/steve-valliere"}, "edited": false, "score": 2, "creation_date": 1460572131, "post_id": 36606409, "comment_id": 60810188, "body": "operations_pointer is just a pointer to a uint32_t rather than a pointer to a function.  I think that&#39;s where the error lies.  operations_pointer should have the same type as func_ptr.  Those ops_table arrays should probably also have a function pointer type -- you needed the casts you have to force them into an array of uint32_t pointer arrays."}], "answers": [{"tags": [], "owner": {"reputation": 932, "user_id": 1721186, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/191bbec6bbd670cff4888c4f9d8e7ca6?s=128&d=identicon&r=PG", "display_name": "Steve Valliere", "link": "https://stackoverflow.com/users/1721186/steve-valliere"}, "is_accepted": true, "score": 1, "last_activity_date": 1460573712, "last_edit_date": 1460573712, "creation_date": 1460572526, "answer_id": 36606778, "question_id": 36606409, "link": "https://stackoverflow.com/questions/36606409/c-function-pointer-assignment-warning/36606778#36606778", "title": "C function pointer assignment warning", "body": "<p>Try something like this instead (with the lines placed where they belong in your code, of course):</p>\n\n<pre><code>typedef int32_t (*my_func_ptr)(int32_t fd, void * buf, int32_t nbytes);\n\ntypedef struct file_array{\n    my_func_ptr operations_pointer[4];\n    inode_t * inode;\n    uint32_t file_position;\n    uint32_t flags;\n} file_array;\n\nmy_func_ptr rtc_ops_table[4] = {rtc_open, rtc_read, rtc_write, rtc_close};\nmy_func_ptr dir_ops_table[4] = {dir_open, dir_read, dir_write, dir_close};\n\nmy_func_ptr func_ptr = (curr_proc-&gt;fds[fd].operations_pointer[READ]);\n</code></pre>\n\n<p>In this example, my_func_ptr is a type that describes your function pointers and is used for all variables containing them.</p>\n\n<p>Alternately, you might want operations_pointer to be declared as a pointer:</p>\n\n<pre><code> my_func_ptr *operations_pointer;\n</code></pre>\n\n<p>so that you could just have it point to one of your two ops tables:</p>\n\n<pre><code>curr_proc-&gt;fds[fd].operations_pointer = rtc_ops_table;\n</code></pre>\n\n<p>then you could use the operations_pointer as if it were one of the ops_table arrays.</p>\n"}, {"tags": [], "owner": {"reputation": 175, "user_id": 6158383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/894a52419735dbf898e7551359ca7b2a?s=128&d=identicon&r=PG&f=1", "display_name": "G. Emadi", "link": "https://stackoverflow.com/users/6158383/g-emadi"}, "is_accepted": false, "score": 0, "last_activity_date": 1460572656, "creation_date": 1460572656, "answer_id": 36606819, "question_id": 36606409, "link": "https://stackoverflow.com/questions/36606409/c-function-pointer-assignment-warning/36606819#36606819", "title": "C function pointer assignment warning", "body": "<p>operations_pointer in the file_array should be a functoin pointer type(func_ptr), it is uint32_t pointer!</p>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 0, "last_activity_date": 1460573054, "creation_date": 1460573054, "answer_id": 36606944, "question_id": 36606409, "link": "https://stackoverflow.com/questions/36606409/c-function-pointer-assignment-warning/36606944#36606944", "title": "C function pointer assignment warning", "body": "<p>Function pointers and object pointers are distinct to C.  You cannot convert directly between them, except that you can convert function pointers to type <code>void *</code>, which is an object pointer type.</p>\n\n<p>Additionally, if it is the intention that <code>file_array.operations_pointer</code> should point to a dynamic array of function pointers, then you need an additional level of indirection.</p>\n\n<p>Perhaps you want something like this, instead:</p>\n\n<pre><code>typedef struct file_array{\n    int (**operations_pointer)();\n    inode_t * inode;\n    uint32_t file_position;\n    uint32_t flags;\n} file_array;\n</code></pre>\n\n<p>That declares <code>operations_pointer</code> as a pointer to a pointer to a function accepting unspecified arguments and returning an <code>int</code>.  That would be suitable for a dynamically allocated block of function pointers.  It is possible that your C compiler would complain there about missing function prototypes, and rightfully so: that form does not express the parameter types of the pointed-to functions, but that's appropriate if those functions don't all have compatible signatures.</p>\n\n<p>If all the function pointers you intend to store will point to functions with the same signature, then it would be better to express that signature in the type declaration:</p>\n\n<pre><code>typedef struct file_array{\n    int (**operations_pointer)(int32_t, void *, int32_t);\n    inode_t * inode;\n    uint32_t file_position;\n    uint32_t flags;\n} file_array;\n</code></pre>\n\n<p>If they do not all have the same signature, then they must at least have the same return type, for you cannot express a function pointer without designating the return type.</p>\n"}], "owner": {"reputation": 1337, "user_id": 2676875, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e431572659944f579494a0c39356a9ac?s=128&d=identicon&r=PG", "display_name": "Tanishq dubey", "link": "https://stackoverflow.com/users/2676875/tanishq-dubey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 340, "favorite_count": 0, "accepted_answer_id": 36606778, "answer_count": 3, "score": 0, "last_activity_date": 1460573712, "creation_date": 1460571416, "last_edit_date": 1460572022, "question_id": 36606409, "link": "https://stackoverflow.com/questions/36606409/c-function-pointer-assignment-warning", "title": "C function pointer assignment warning", "body": "<p>I have a function (specifically a system call) that returns the result of the function that needed to be called.</p>\n\n<p>The code looks like such</p>\n\n<pre><code>    int32_t (*func_ptr)(int32_t fd, void * buf, int32_t nbytes);\n    func_ptr = (curr_proc-&gt;fds[fd].operations_pointer[READ]);\n</code></pre>\n\n<p>Where our <code>curr_proc</code> is just a struct. This struct is holder a array of file descriptors (<code>fds</code>) which holds a pointer to corresponding function to run (<code>operations_pointer</code>). There is a array that holds the functions for each type of device in our system, and this array looks like such:</p>\n\n<pre><code>uint32_t * rtc_ops_table[4] = {(uint32_t *) rtc_open, (uint32_t *) rtc_read, (uint32_t *) rtc_write, (uint32_t *) rtc_close};\nuint32_t * dir_ops_table[4] = {(uint32_t *) dir_open, (uint32_t *) dir_read, (uint32_t *) dir_write, (uint32_t *) dir_close};\n</code></pre>\n\n<p>Thus, when a program calls read, the corresponding function pointer is loaded into <code>func_ptr</code> and then returned with its corresponding arguments. </p>\n\n<p>The problem I am having is that in the line I assign <code>func_ptr</code>, I get this warning from gcc: </p>\n\n<pre><code>warning: assignment makes pointer from integer without a cast\n</code></pre>\n\n<p>I have tried various casts such as <code>(uint32_t *)</code>, <code>(uint32_t)</code>, <code>(int32_t)</code>, etc. I have also tried to assign function pointer as such: </p>\n\n<pre><code>func_ptr = &amp;(curr_proc-&gt;fds[fd].operations_pointer[READ]);\n</code></pre>\n\n<p>But to no avail.</p>\n\n<p>How would I fix this warning?</p>\n\n<p>EDIT:</p>\n\n<p>This is the struct for curr_prc</p>\n\n<pre><code>typedef struct {\n    file_array fds[8];\n    uint8_t file_names[8][32];\n    uint8_t proc_num;\n    ...\n} pcb_t;\n</code></pre>\n\n<p>And the struct for fas:</p>\n\n<pre><code>typedef struct file_array{\n    uint32_t * operations_pointer;\n    inode_t * inode;\n    uint32_t file_position;\n    uint32_t flags;\n} file_array;\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 2, "creation_date": 1460571207, "post_id": 36606298, "comment_id": 60809620, "body": "Welcome to the site. Please paste your code into your question, select it, and click <code>[{}]</code> button above it to format as code."}], "answers": [{"tags": [], "owner": {"reputation": 2380, "user_id": 6189717, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a09efa4823c3c2adc1fed245dda6aeba?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Sch&#252;pbach", "link": "https://stackoverflow.com/users/6189717/simon-sch%c3%bcpbach"}, "is_accepted": false, "score": -1, "last_activity_date": 1460571227, "creation_date": 1460571227, "answer_id": 36606350, "question_id": 36606298, "link": "https://stackoverflow.com/questions/36606298/copying-an-entered-string-into-ith-element-of-a-string-array-using-strcpy/36606350#36606350", "title": "Copying an entered string into &quot;ith&quot; element of a string array using strcpy", "body": "<p>You can use something like that     </p>\n\n<pre><code>strcpy(&amp;name[i][0],n);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": false, "score": 0, "last_activity_date": 1460580308, "last_edit_date": 1460580308, "creation_date": 1460571781, "answer_id": 36606527, "question_id": 36606298, "link": "https://stackoverflow.com/questions/36606298/copying-an-entered-string-into-ith-element-of-a-string-array-using-strcpy/36606527#36606527", "title": "Copying an entered string into &quot;ith&quot; element of a string array using strcpy", "body": "<p>Given that your string array is created as indicated:</p>\n\n<pre><code>char name[11][41];\n</code></pre>\n\n<p>you can use this to copy up to 40 characters into the <em>ith</em> 41 char array, reserving the last space for null termination:</p>\n\n<pre><code>//for i from 0 to 10 this will work\nstrncpy(name[i], \"some string\", 40);\nname[i][40] = 0;//guarantee null termination in case source string is longer than array \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 175, "user_id": 6158383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/894a52419735dbf898e7551359ca7b2a?s=128&d=identicon&r=PG&f=1", "display_name": "G. Emadi", "link": "https://stackoverflow.com/users/6158383/g-emadi"}, "is_accepted": false, "score": 0, "last_activity_date": 1460571909, "creation_date": 1460571909, "answer_id": 36606569, "question_id": 36606298, "link": "https://stackoverflow.com/questions/36606298/copying-an-entered-string-into-ith-element-of-a-string-array-using-strcpy/36606569#36606569", "title": "Copying an entered string into &quot;ith&quot; element of a string array using strcpy", "body": "<pre><code>It would be better that there shouldn't be hard code in the code, so you can use defines. It could be helpful to control string length and avoid from segmentation fault problem.\n\n#define MAX_LENGTH 41\n#define MAX_INPUT 11\n</code></pre>\n\n<p>In the main:</p>\n\n<pre><code>char name[MAX_INPUT][MAX_LENGTH];\nchar input_name[MAX_LENGTH];\n//after filling the input_name\nstrncpy (name [i],input_name,MAX_LENGTH);\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6200313, "user_type": "registered", "profile_image": "https://graph.facebook.com/1106651532689525/picture?type=large", "display_name": "Trey Brown", "link": "https://stackoverflow.com/users/6200313/trey-brown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1460580308, "creation_date": 1460571073, "question_id": 36606298, "link": "https://stackoverflow.com/questions/36606298/copying-an-entered-string-into-ith-element-of-a-string-array-using-strcpy", "title": "Copying an entered string into &quot;ith&quot; element of a string array using strcpy", "body": "<p>I am working on a program that a users enters a full name, i am using gets to retrieve the string entered and i need to copy that string into the i-th element in an two-dimension array called name[11][41]. i need to use strcpy to store it. i'm stuck and assistance with this would be great!</p>\n\n<p><a href=\"http://i.stack.imgur.com/SFPWe.png\" rel=\"nofollow\">My Code</a></p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 0, "creation_date": 1460570901, "post_id": 36606190, "comment_id": 60809428, "body": "Wait, why are you casting a pointer to <code>int</code> to an <code>int</code> to calculate <code>size</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 15569, "user_id": 2302862, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e264db339bb96e343770fa38018e00f1?s=128&d=identicon&r=PG", "display_name": "Siguza", "link": "https://stackoverflow.com/users/2302862/siguza"}, "edited": false, "score": 0, "creation_date": 1460570944, "post_id": 36606248, "comment_id": 60809456, "body": "...and when <code>arr</code> is dereferenced there, it points to the location <i>after</i> the array, thanks to the for loop."}], "tags": [], "owner": {"reputation": 11494, "user_id": 1795279, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4TEag.jpg?s=128&g=1", "display_name": "Haris", "link": "https://stackoverflow.com/users/1795279/haris"}, "is_accepted": false, "score": 2, "last_activity_date": 1460570982, "last_edit_date": 1460570982, "creation_date": 1460570897, "answer_id": 36606248, "question_id": 36606190, "link": "https://stackoverflow.com/questions/36606190/the-function-corrupted-my-array-in-c/36606248#36606248", "title": "the function corrupted my array in C", "body": "<p>This line</p>\n\n<pre><code>*arr = firstAdress;  //for not destroy the array\n</code></pre>\n\n<p>destroys the array. You are writing into the memory when you dereference <code>arr</code>.</p>\n\n<hr>\n\n<p>Since in C, everything is passed by value, you do not have to worry about corruption when you change <code>arr</code> in the function. So, you do not need <code>firstAdress</code>.</p>\n\n<pre><code>void arrprint(int* arr, int size)//printing numbers:\n{\n\n    int* lastAddress = arr + size;\n    int* firstAdress = arr;\n    for (arr=firstAdress; arr &lt; size; arr++)\n    {\n        printf(\"%2d\", *arr); //printing\n    }\n    printf(\"\\n\");\n}\n</code></pre>\n\n<p>After Updating, the code should look like this. You should notice that <code>arr</code> which is being changed here, is only being changed in this function, and the actual array pointer (in the caller function) is intact and safe.</p>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 0, "last_activity_date": 1460570960, "creation_date": 1460570960, "answer_id": 36606264, "question_id": 36606190, "link": "https://stackoverflow.com/questions/36606190/the-function-corrupted-my-array-in-c/36606264#36606264", "title": "the function corrupted my array in C", "body": "<p>You're trying to use <code>size</code> as an <code>int *</code>.  Use an actual <code>int *</code> instead.</p>\n\n<p>Also, by setting <code>*arr = firstAddress</code>, what you're really doing is writing the address of the array into the first <em>element</em> in the array.  Also, since <code>arr</code> is a local variable, changes to it don't affect the variable in the calling function.</p>\n\n<pre><code>void arrprint(int* arr, int size)//printing numbers:\n{\n\n    int *lastAddress = arr + size;\n    int *firstAdress = arr;\n    for (arr=firstAdress; arr &lt; lastAddress; arr++)\n    {\n        printf(\"%2d\", *arr); //printing\n    }\n    printf(\"\\n\");\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 184, "user_id": 713450, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XKtcX.png?s=128&g=1", "display_name": "EmbedWise", "link": "https://stackoverflow.com/users/713450/embedwise"}, "is_accepted": false, "score": 0, "last_activity_date": 1460572572, "last_edit_date": 1460572572, "creation_date": 1460572175, "answer_id": 36606668, "question_id": 36606190, "link": "https://stackoverflow.com/questions/36606190/the-function-corrupted-my-array-in-c/36606668#36606668", "title": "the function corrupted my array in C", "body": "<p>Personally think the best solution is:</p>\n\n<pre><code>void arrprint(int* arr, int size)//printing numbers:\n{\n    int *lastAddress = arr + size    \n    int *firstAddress = arr;\n    for (firstAddress = arr; firstaddress &lt; lastAddress; firstaddress++)\n    {\n        printf(\"%2d\", *firstAddress); //printing\n    }\n    printf(\"\\n\");\n}\n</code></pre>\n\n<p>Reason you do not alter the original pointer. You can also use const int* arr in the function declaration, then you will get a compiler error if you dereference the pointer.  </p>\n"}], "owner": {"reputation": 19, "user_id": 5596908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bc0f38dcb776d6ca7777ebe3502c681?s=128&d=identicon&r=PG&f=1", "display_name": "Or Shemesh", "link": "https://stackoverflow.com/users/5596908/or-shemesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1460572572, "creation_date": 1460570742, "last_edit_date": 1460570825, "question_id": 36606190, "link": "https://stackoverflow.com/questions/36606190/the-function-corrupted-my-array-in-c", "title": "the function corrupted my array in C", "body": "<p>Hello I'm build a function are printing array with pointers\n on c with Visual Studio 2015.\nwhile i run the function this send me this massage:\nRun-Time Check Failure #2 - Stack around the variable 'arr' was corrupted.</p>\n\n<p>this the function:</p>\n\n<pre><code>void arrprint(int* arr, int size)//printing numbers:\n{\n\n    size = (int)arr + size*sizeof(int);// the last adress of the array\n    int* firstAdress = arr;\n    for (arr=firstAdress; arr &lt; size; arr++)\n    {\n        printf(\"%2d\", *arr); //printing\n    }\n    *arr = firstAdress;  //for not destroy the array\n    printf(\"\\n\");\n}\n</code></pre>\n\n<p>thanks for helpers</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1460570318, "post_id": 36606057, "comment_id": 60809098, "body": "what language is this?"}, {"owner": {"reputation": 367, "user_id": 6091069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6438d90b6a57c9f345cf9da730603576?s=128&d=identicon&r=PG&f=1", "display_name": "Hang", "link": "https://stackoverflow.com/users/6091069/hang"}, "edited": false, "score": 0, "creation_date": 1460570352, "post_id": 36606057, "comment_id": 60809118, "body": "Seems like C (or C++)"}, {"owner": {"reputation": 367, "user_id": 6091069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6438d90b6a57c9f345cf9da730603576?s=128&d=identicon&r=PG&f=1", "display_name": "Hang", "link": "https://stackoverflow.com/users/6091069/hang"}, "edited": false, "score": 3, "creation_date": 1460570394, "post_id": 36606057, "comment_id": 60809146, "body": "It asks for <code>unsigned int *</code>, you gave it <code>int *</code>, for the 3rd parameter."}, {"owner": {"reputation": 177, "user_id": 3489985, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/9a5aa0db9fd86c13966ccbc9d8df3007?s=128&d=identicon&r=PG&f=1", "display_name": "user3489985", "link": "https://stackoverflow.com/users/3489985/user3489985"}, "edited": false, "score": 0, "creation_date": 1460571325, "post_id": 36606057, "comment_id": 60809711, "body": "Thanks! I thought those two types can convert to each other."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1460599883, "post_id": 36606057, "comment_id": 60822125, "body": "actually the third parameter to <code>accept()</code>, per the man page, is expecting something similar to the following: <code>socklen_t *addrlen</code>  Suggest correcting the declaration for <code>clilen</code> to be: <code>socklen_t clilen;</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1460600008, "post_id": 36606057, "comment_id": 60822163, "body": "strongly suggest reading/understanding the man pages for those system functions that are called in your code"}], "owner": {"reputation": 177, "user_id": 3489985, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/9a5aa0db9fd86c13966ccbc9d8df3007?s=128&d=identicon&r=PG&f=1", "display_name": "user3489985", "link": "https://stackoverflow.com/users/3489985/user3489985"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1460573013, "creation_date": 1460570209, "last_edit_date": 1460573013, "question_id": 36606057, "link": "https://stackoverflow.com/questions/36606057/what-is-the-proper-way-to-do-conversion-on-pointer", "title": "What is the proper way to do conversion on pointer?", "body": "<p>I got this code:</p>\n\n<pre><code>int sockfd, clilen;\nchar buffer[256];\nstruct sockaddr_in cli_addr;\n\n// ...\nnewsockfd = accept(sockfd, (struct sockaddr *) &amp;cli_addr, &amp;clilen);\n</code></pre>\n\n<p>When compiling, the error is:</p>\n\n<blockquote>\n  <p>Invalid arguments. Candidates are: int accept(int, sockaddr *,\n  unsigned int *)</p>\n</blockquote>\n\n<p>So, what's wrong with my code? </p>\n"}, {"tags": ["c", "signals"], "comments": [{"owner": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "edited": false, "score": 0, "creation_date": 1460570419, "post_id": 36605980, "comment_id": 60809163, "body": "Kid and father? You mean child and parent?"}, {"owner": {"reputation": 23, "user_id": 6068809, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/48eaaeebb703b17a4d7c4ea1c9246177?s=128&d=identicon&r=PG&f=1", "display_name": "fingerlabs team", "link": "https://stackoverflow.com/users/6068809/fingerlabs-team"}, "reply_to_user": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "edited": false, "score": 0, "creation_date": 1460570500, "post_id": 36605980, "comment_id": 60809206, "body": "Yes, sorry I&#39;m spanish and I have try to traduce it fastly, I will edit it"}, {"owner": {"reputation": 87, "user_id": 6196101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5bdfdecfbaa79d0c66fdfd564f81e48?s=128&d=identicon&r=PG&f=1", "display_name": "Ivan", "link": "https://stackoverflow.com/users/6196101/ivan"}, "edited": false, "score": 0, "creation_date": 1460570718, "post_id": 36605980, "comment_id": 60809325, "body": "I`m not sure, if process is able to handle user-signals after SIGSTOP. Are you sure, this start/stop works?"}, {"owner": {"reputation": 23, "user_id": 6068809, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/48eaaeebb703b17a4d7c4ea1c9246177?s=128&d=identicon&r=PG&f=1", "display_name": "fingerlabs team", "link": "https://stackoverflow.com/users/6068809/fingerlabs-team"}, "edited": false, "score": 0, "creation_date": 1460570879, "post_id": 36605980, "comment_id": 60809414, "body": "The reset function works perfectly but when I try tu use the start/stop function it doesnt work the third time, I mean when it&#39;s suppose to restart after stop. I dont know any other way to pause it till SIGCONT"}, {"owner": {"reputation": 87, "user_id": 6196101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5bdfdecfbaa79d0c66fdfd564f81e48?s=128&d=identicon&r=PG&f=1", "display_name": "Ivan", "link": "https://stackoverflow.com/users/6196101/ivan"}, "edited": false, "score": 0, "creation_date": 1460571010, "post_id": 36605980, "comment_id": 60809493, "body": "@fingerlabs may be it is better to add <code>if (state) time++;</code> instead of starting/stopping process by signal SIGSTOP. I suspect, process hangs forever."}, {"owner": {"reputation": 23, "user_id": 6068809, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/48eaaeebb703b17a4d7c4ea1c9246177?s=128&d=identicon&r=PG&f=1", "display_name": "fingerlabs team", "link": "https://stackoverflow.com/users/6068809/fingerlabs-team"}, "edited": false, "score": 0, "creation_date": 1460571083, "post_id": 36605980, "comment_id": 60809537, "body": "I have found a tricky solution: use a conditional expresion (state == 1) in order to do timer++ and sleep(1) so the start/stop function only will have to change state var. But I dont think that will be the profesor ask for..."}, {"owner": {"reputation": 23, "user_id": 6068809, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/48eaaeebb703b17a4d7c4ea1c9246177?s=128&d=identicon&r=PG&f=1", "display_name": "fingerlabs team", "link": "https://stackoverflow.com/users/6068809/fingerlabs-team"}, "edited": false, "score": 0, "creation_date": 1460571122, "post_id": 36605980, "comment_id": 60809565, "body": "Just wath you said jajaja"}], "answers": [{"tags": [], "owner": {"reputation": 2048, "user_id": 6192747, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-agy-meieasc/AAAAAAAAAAI/AAAAAAAAAC8/ipYF1p3tygQ/photo.jpg?sz=128", "display_name": "Stian Skjelstad", "link": "https://stackoverflow.com/users/6192747/stian-skjelstad"}, "is_accepted": false, "score": 0, "last_activity_date": 1461316710, "creation_date": 1461316710, "answer_id": 36789790, "question_id": 36605980, "link": "https://stackoverflow.com/questions/36605980/chronometer-using-c-signals/36789790#36789790", "title": "Chronometer using C signals", "body": "<p>Do not send SIGSTOP and SIGCONT to yourself. SIGSTOP will HALT your-self, until you receive a SIGCONT from somewhere else. Instead, inside your while look, add to check for state:</p>\n\n<pre><code>while(1){\n    sleep(1);   //Wait 1 second to make it \"real\"\n    if (state) {  \n        time++;\n    }\n}\n</code></pre>\n\n<p>.</p>\n\n<pre><code>void stop_and_continue(int x){\n    state = !state;\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6068809, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/48eaaeebb703b17a4d7c4ea1c9246177?s=128&d=identicon&r=PG&f=1", "display_name": "fingerlabs team", "link": "https://stackoverflow.com/users/6068809/fingerlabs-team"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 478, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1461316710, "creation_date": 1460569980, "last_edit_date": 1460570617, "question_id": 36605980, "link": "https://stackoverflow.com/questions/36605980/chronometer-using-c-signals", "title": "Chronometer using C signals", "body": "<p>I have to do a Chronometer by using C signals. The idea is the following:</p>\n\n<ul>\n<li>Use SIGUSR1: when the child gets SIGUSR1 signal it will pause his chronometre and show the current state. (for example time: 5s)</li>\n<li>Use SIGUSR2: when the child gets SIGUSR2 signal it will reset his chronometre (by putting it's time to 0)</li>\n</ul>\n\n<p>So on the parent will be a kind of interface with 2 options (that I have just told). The child will be runing attending to parent's signals.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt; \n#include &lt;sys/wait.h&gt;\n#include &lt;signal.h&gt; \n\nvoid stop_and_continue(int x);\nvoid reset(int x);\n\n\nint state;   //If chrometre is stop (0) or runing (1)\nint pid_child;\nint time;\n\nint main(void){\n\nint pid;\nint option;\nsystem(\"clear\");\npid = fork();\n\nif( pid == 0){  //child (chronometre)\n    signal(SIGUSR1, stop_and_continue);\n    signal(SIGUSR2, reset);\n    time = 0;\n    state = 0;   //Originally the chronometre is stop\n    pid_child = getpid();   //store child's pid on global to use it on signal functions\n    pause();   //Wait till parent say to start for the first time\n    while(1){\n        sleep(1);   //Wait 1 second to make it \"real\"\n        time++;\n    }       \n}else{   //Parent\n    printf(\"1 - Stop - Continue\\n\");\n    printf(\"2 - Reset\\n\");\n    printf(\"0 - Exit\\n\");\n    printf(\"Select one option:\\n\");\n    do{\n        scanf(\"%d\",&amp;option);\n        if(option == 1){\n            kill(pid,SIGUSR1);\n        }else if(option == 2){\n            kill(pid,SIGUSR2);\n        }\n    }while(option!=0);\n    kill(pid,SIGKILL);\n    wait(NULL);  //Wait till child finish to avoid zombis\n}\nreturn 0;\n}\n\nvoid reset(int x){\ntime = 0;\n}\n\nvoid stop_and_continue(int x){\nif(state == 1){\n    state = 0;\n    kill(pid_child,SIGSTOP);\n}else{\n    state = 1;\n    kill(pid_child,SIGCONT);\n}\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["c", "gcc", "optimization", "compiler-optimization", "c99"], "comments": [{"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 4, "creation_date": 1460569526, "post_id": 36605576, "comment_id": 60808604, "body": "<code>-ansi</code> specifies the C89/C90 standard; <code>-std=c99</code> specifies the 1999 standard (and <code>-std=c11</code> specifies the current 2011 standard). It doesn&#39;t make sense to use them together."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 3, "creation_date": 1460569555, "post_id": 36605576, "comment_id": 60808618, "body": "Optimization is compiler-specific.  You appear to be using GCC-style compiler options, but other compilers accept similar flags.  Tag this question with the C compiler you are using if you want meaningful answers about flags influencing optimization for your C implementation."}, {"owner": {"reputation": 340, "user_id": 6166067, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yvwo4.jpg?s=128&g=1", "display_name": "aprelev", "link": "https://stackoverflow.com/users/6166067/aprelev"}, "edited": false, "score": 1, "creation_date": 1460572983, "post_id": 36605576, "comment_id": 60810713, "body": "In case you use GCC compiler, <a href=\"http://stackoverflow.com/a/1778700/6166067\">this answer</a> might be useful."}], "answers": [{"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 4, "last_activity_date": 1460569273, "creation_date": 1460569273, "answer_id": 36605772, "question_id": 36605576, "link": "https://stackoverflow.com/questions/36605576/which-gcc-optimization-flags-should-i-use/36605772#36605772", "title": "Which gcc optimization flags should I use?", "body": "<p>The flag <code>-std=c99</code> does not change the optimization levels. It only changes what target language standard you want the compiler to confirm to.</p>\n\n<p>You use <code>-std=c99</code> when you want your program to be treated as a C99 program by the compiler.</p>\n"}, {"comments": [{"owner": {"reputation": 340, "user_id": 6166067, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yvwo4.jpg?s=128&g=1", "display_name": "aprelev", "link": "https://stackoverflow.com/users/6166067/aprelev"}, "edited": false, "score": 1, "creation_date": 1460572853, "post_id": 36605819, "comment_id": 60810618, "body": "Just a note, neither <code>-O3</code> nor any other optimisation level option do not unroll loops as <code>-funroll-loops</code> does. It is only enabled with <code>-fprofile-use</code>, because then it has enough information to decide which loops to unroll. Partial loop unrolling depends on the compiler though."}], "tags": [], "owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "is_accepted": false, "score": 2, "last_activity_date": 1460569415, "creation_date": 1460569415, "answer_id": 36605819, "question_id": 36605576, "link": "https://stackoverflow.com/questions/36605576/which-gcc-optimization-flags-should-i-use/36605819#36605819", "title": "Which gcc optimization flags should I use?", "body": "<p>The only flag that has to do with optimization among those you specified is <code>-O3</code>. Others serve for other purposes. </p>\n\n<p>You may want to add <code>-funroll-loops</code> and <code>-fomit-frame-pointer</code>, but they should be already included in <code>-O3</code>. </p>\n"}, {"comments": [{"owner": {"reputation": 443, "user_id": 4621761, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/OeIZl.jpg?s=128&g=1", "display_name": "sharp_c-tudent", "link": "https://stackoverflow.com/users/4621761/sharp-c-tudent"}, "edited": false, "score": 0, "creation_date": 1460592207, "post_id": 36610637, "comment_id": 60820045, "body": "Thank you, your answer is very helpfull and just what I needed, can you please just explain or direct me to what you mean by &quot;FP rounding&quot; or &quot;FP code&quot;?"}], "tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": true, "score": 2, "last_activity_date": 1460586648, "last_edit_date": 1460586648, "creation_date": 1460586220, "answer_id": 36610637, "question_id": 36605576, "link": "https://stackoverflow.com/questions/36605576/which-gcc-optimization-flags-should-i-use/36610637#36610637", "title": "Which gcc optimization flags should I use?", "body": "<p>I'd recommend compiling new code with <code>-std=gnu11</code>, or <code>-std=c11</code> if needed.  Silencing all <code>-Wall</code> warnings is usually a good idea, IIRC.  <code>-Wextra</code> warns for some things you might not want to change.</p>\n\n<hr>\n\n<p>A good way to check how something compiles is to look at the compiler asm output.  <a href=\"http://gcc.godbolt.org/\" rel=\"nofollow\">http://gcc.godbolt.org/</a> formats the asm output nicely (stripping out the noise).  Putting some key functions up there and looking at what different compiler versions do is useful if you understand asm at all.</p>\n\n<hr>\n\n<p>Use a new compiler version.  gcc and clang have both improved significantly in newer versions.  gcc 5.3 and clang 3.8 are the current releases.  gcc5 makes noticeably better code than gcc 4.9.3 in some cases.</p>\n\n<hr>\n\n<p><strong>If you only need the binary to run on your own machine</strong>, you should use <code>-O3 -march=native</code>.</p>\n\n<p><strong>If you need the binary to run on other machines</strong>, choose the baseline for instruction-set extensions with stuff like <code>-mssse3 -mpopcnt</code>.  You can use <code>-mtune=haswell</code> to optimize for Haswell even while making code that still runs on older CPUs (as determined by <code>-march</code>).</p>\n\n<hr>\n\n<p>If your program doesn't depend on strict FP rounding behaviour, use <code>-ffast-math</code>.  If it does, you can usually still use <code>-fno-math-errno</code> and stuff like that, without enabling <code>-funsafe-math-optimizations</code>.  Some FP code can get <em>big</em> speedups from fast-math, like auto-vectorization.</p>\n\n<hr>\n\n<p>If you can usefully do a test-run of your program that exercises most of the code paths that need to be optimized for a real run, then use profile-directed optimization:</p>\n\n<pre><code>gcc  -fprofile-generate -Wall -Wextra -std=gnu11 -O3 -ffast-math -march=native -fwhole-program *.c -o my_program\n./my_program -option1 &lt; test_input1\n./my_program -option2 &lt; test_input2\ngcc  -fprofile-use      -Wall -Wextra -std=gnu11 -O3 -ffast-math -march=native -fwhole-program *.c -o my_program\n</code></pre>\n\n<p><code>-fprofile-use</code> enables <code>-funroll-loops</code>, since it has enough information to decide when to actually unroll.  Unrolling loops all over the place can make things worse.  However, it's worth trying <code>-funroll-loops</code> to see if it helps.</p>\n\n<p>If your test runs don't cover all the code paths, then some important ones will be marked as \"cold\" and optimized less.</p>\n\n<hr>\n\n<p><code>-O3</code> enables auto-vectorization, which <code>-O2</code> doesn't.  This can give big speedups </p>\n\n<p><strong><code>-fwhole-program</code></strong> allows cross-file inlining, but only works when you put all the source files on one gcc command-line.  <code>-flto</code> is another way to get the same effect.  (Link-Time Optimization).  clang supports <code>-flto</code> but not <code>-fwhole-program</code>.</p>\n\n<p><strong><code>-fomit-frame-pointer</code></strong> has been the default for a while now for x86-64, and more recently for x86 (32bit).</p>\n\n<hr>\n\n<p>As well as gcc, <strong>try compiling your program with clang</strong>.  Clang sometimes makes better code than gcc, sometimes worse.  Try both and benchmark.</p>\n"}], "owner": {"reputation": 443, "user_id": 4621761, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/OeIZl.jpg?s=128&g=1", "display_name": "sharp_c-tudent", "link": "https://stackoverflow.com/users/4621761/sharp-c-tudent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2541, "favorite_count": 2, "accepted_answer_id": 36610637, "answer_count": 3, "score": 2, "last_activity_date": 1460785726, "creation_date": 1460568644, "last_edit_date": 1460785726, "question_id": 36605576, "link": "https://stackoverflow.com/questions/36605576/which-gcc-optimization-flags-should-i-use", "title": "Which gcc optimization flags should I use?", "body": "<p>If I want to minimize the time my c programs run, what optimization flags should I use (I want to keep it standard too)</p>\n\n<p>Currently I'm using:</p>\n\n<pre><code> -Wall -Wextra -pedantic -ansi -O3\n</code></pre>\n\n<p>Should I also use </p>\n\n<pre><code>-std=c99\n</code></pre>\n\n<p>for example? </p>\n\n<p>And is there I specific order I should put those flags on my makefile? Does it make any difference?</p>\n\n<p>And also, is there any reason not to use all the optimization flags I can find? do they ever counter eachother or something like that?</p>\n"}, {"tags": ["c", "shell", "signals", "dry", "signal-handling"], "comments": [{"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 1, "creation_date": 1460568632, "post_id": 36605429, "comment_id": 60808071, "body": "What signal is causing your program to terminate? SIGPIPE? Your real shell should tell you."}], "answers": [{"comments": [{"owner": {"reputation": 22041, "user_id": 108207, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/dd8608b8b423bdcbda3fe5c0cf8b6230?s=128&d=identicon&r=PG&f=1", "display_name": "Niklas R.", "link": "https://stackoverflow.com/users/108207/niklas-r"}, "edited": false, "score": 0, "creation_date": 1460568507, "post_id": 36605509, "comment_id": 60808008, "body": "Thank you for the answer. Please can you elaborate a little? I have not done this before and I am not a C expert."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 22041, "user_id": 108207, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/dd8608b8b423bdcbda3fe5c0cf8b6230?s=128&d=identicon&r=PG&f=1", "display_name": "Niklas R.", "link": "https://stackoverflow.com/users/108207/niklas-r"}, "edited": false, "score": 1, "creation_date": 1460569708, "post_id": 36605509, "comment_id": 60808719, "body": "@Programmer400 There is  a link to the tutorial. I don&#39;t think there is any point of copying any more of it here..."}, {"owner": {"reputation": 22041, "user_id": 108207, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/dd8608b8b423bdcbda3fe5c0cf8b6230?s=128&d=identicon&r=PG&f=1", "display_name": "Niklas R.", "link": "https://stackoverflow.com/users/108207/niklas-r"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1461325494, "post_id": 36605509, "comment_id": 61160147, "body": "@EugeneSh. I don&#39;t understand <i>where</i> in the code I should <code>wait()</code> so I&#39;m awarding abounty for details."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 1, "creation_date": 1461325886, "post_id": 36605509, "comment_id": 61160428, "body": "The signal handler <code>handle_sigchld</code> is calling <code>waitpid</code>, which is one of the <code>wait</code> functions."}, {"owner": {"reputation": 22041, "user_id": 108207, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/dd8608b8b423bdcbda3fe5c0cf8b6230?s=128&d=identicon&r=PG&f=1", "display_name": "Niklas R.", "link": "https://stackoverflow.com/users/108207/niklas-r"}, "edited": false, "score": 0, "creation_date": 1461333497, "post_id": 36605509, "comment_id": 61166004, "body": "Where should the signal handling code go? I have signal handler that works to keep the program running at a <code>ctrl+c</code> but it is impossible to catch the <code>less</code> program from exiting the whole shell. The documentation is really terrible - I see no example of what I&#39;m trying to do."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 1, "creation_date": 1461334403, "post_id": 36605509, "comment_id": 61166622, "body": "Signal handlers are typically installed near the top of <code>main</code>. You may need to handle more than one signal. Ctrl-C generates <code>SIGINT</code>. Signals may interrupt your system call, and <code>errno</code> is set to <code>EINTR</code>. If that happens, redo the call again. This is all information that can be found in a UNIX programming text book, which perhaps you should find and browse for more background."}, {"owner": {"reputation": 22041, "user_id": 108207, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/dd8608b8b423bdcbda3fe5c0cf8b6230?s=128&d=identicon&r=PG&f=1", "display_name": "Niklas R.", "link": "https://stackoverflow.com/users/108207/niklas-r"}, "edited": false, "score": 0, "creation_date": 1461334905, "post_id": 36605509, "comment_id": 61166934, "body": "Should the 2 variables named <code>sa</code> be same or different for two different signal handlers? I posted my code from main that works for sigint but not for keeping the shell running after a builtin command executes."}, {"owner": {"reputation": 22041, "user_id": 108207, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/dd8608b8b423bdcbda3fe5c0cf8b6230?s=128&d=identicon&r=PG&f=1", "display_name": "Niklas R.", "link": "https://stackoverflow.com/users/108207/niklas-r"}, "edited": false, "score": 0, "creation_date": 1461335531, "post_id": 36605509, "comment_id": 61167398, "body": "@jxh Ok so I&#39;m working the <code>main</code> trying to enable the <code>SIGPIPE</code> because I remember that used to work before I did a large refactoring. I&#39;m starting a builtin command that starts a pipeline of command from <code>&#47;bin</code> and I can&#39;t keep the shell running when the last program (&#39;less`) in the pipeline finishes."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 1, "creation_date": 1461335863, "post_id": 36605509, "comment_id": 61167617, "body": "You seem to have misunderstood my answer. I provided a technique to reap spawned children. I provided advice on dealing with writing to a closed connection. You did not ask a <i>why doesn&#39;t my program work</i> question. If you intended to, consider posting a new question."}, {"owner": {"reputation": 22041, "user_id": 108207, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/dd8608b8b423bdcbda3fe5c0cf8b6230?s=128&d=identicon&r=PG&f=1", "display_name": "Niklas R.", "link": "https://stackoverflow.com/users/108207/niklas-r"}, "edited": false, "score": 0, "creation_date": 1461336162, "post_id": 36605509, "comment_id": 61167829, "body": "@jxh All I wanted was to keep the shell running. I will again how to achieve that in a new question. Thank you for the help."}], "tags": [], "owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "is_accepted": false, "score": 1, "last_activity_date": 1460568714, "last_edit_date": 1460568714, "creation_date": 1460568468, "answer_id": 36605509, "question_id": 36605429, "link": "https://stackoverflow.com/questions/36605429/which-signal-should-i-handle-and-how/36605509#36605509", "title": "Which signal should I handle and how?", "body": "<p>You want to catch <code>SIGCHLD</code>, and reap the child status with one of the <code>wait()</code> functions.</p>\n\n<p>The following info is from an <a href=\"http://www.microhowto.info/howto/reap_zombie_processes_using_a_sigchld_handler.html\" rel=\"nofollow\">online tutorial</a>.</p>\n\n<blockquote>\n<pre><code>void handle_sigchld(int sig) {\n    int saved_errno = errno;\n    while (waitpid((pid_t)(-1), 0, WNOHANG) &gt; 0) {}\n    errno = saved_errno;\n}\n\nstruct sigaction sa;\nsa.sa_handler = &amp;handle_sigchld;\nsigemptyset(&amp;sa.sa_mask);\nsa.sa_flags = SA_RESTART | SA_NOCLDSTOP;\nif (sigaction(SIGCHLD, &amp;sa, 0) == -1) {\n    perror(0);\n    exit(1);\n}\n</code></pre>\n</blockquote>\n\n<p>Also, you will likely want to ignore <code>SIGPIPE</code>.</p>\n\n<blockquote>\n<pre><code>struct sigaction sa;\nsa.sa_handler = SIG_IGN;\nsigemptyset(&amp;sa.sa_mask);\nsa.sa_flags = 0;\nif (sigaction(SIGPIPE, &amp;sa, 0) == -1) {\n  perror(0);\n  exit(1);\n}\n</code></pre>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 22041, "user_id": 108207, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/dd8608b8b423bdcbda3fe5c0cf8b6230?s=128&d=identicon&r=PG&f=1", "display_name": "Niklas R.", "link": "https://stackoverflow.com/users/108207/niklas-r"}, "edited": false, "score": 0, "creation_date": 1461346371, "post_id": 36789903, "comment_id": 61174084, "body": "Thanks. I just had to <code>fork</code> and wait now that I know what I&#39;m doing."}], "tags": [], "owner": {"reputation": 2048, "user_id": 6192747, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-agy-meieasc/AAAAAAAAAAI/AAAAAAAAAC8/ipYF1p3tygQ/photo.jpg?sz=128", "display_name": "Stian Skjelstad", "link": "https://stackoverflow.com/users/6192747/stian-skjelstad"}, "is_accepted": true, "score": 1, "last_activity_date": 1461332610, "last_edit_date": 1461332610, "creation_date": 1461316953, "answer_id": 36789903, "question_id": 36605429, "link": "https://stackoverflow.com/questions/36605429/which-signal-should-i-handle-and-how/36789903#36789903", "title": "Which signal should I handle and how?", "body": "<p>In the parent, you should not need to receive any signal, just call wait() until it returns that your child has died and is now reaped. Your shell is now ready to perform a new task.</p>\n\n<p>your code in the original request if very incomplete, so here comes one example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;wait.h&gt;\n\nvoid foobar()\n{\n  int pipe_fd[2];\n  pid_t pid1, pid2;\n\n  pipe(pipe_fd);\n\n  pid1=fork();\n  if (pid1 == 0)\n  {\n    /* child1 - let us pretend that we wanted to replace stdin and this child */\n    close (0);\n    dup(pipe_fd[0]);\n    close(pipe_fd[0]);\n    close(pipe_fd[1]);\n    execlp(\"wc\", \"wc\", NULL);\n    perror (\"execlp(wc)\");\n    _exit(0);\n  }\n\n  pid2=fork();\n  if (pid2 == 0)\n  {\n    /* child - let us pretent that we wanted to replace stdout */\n    close (1);\n    dup(pipe_fd[1]);\n    close(pipe_fd[0]);\n    close(pipe_fd[1]);\n    execlp(\"ls\", \"ls\", \"-l\", NULL);\n    perror (\"execlp(ls)\");\n    _exit(0);\n  }\n\n  close(pipe_fd[0]);\n  close(pipe_fd[1]);\n\n  /* wait until children are finished */\n  while ((pid1 &gt;= 0) || (pid2 &gt;= 0))\n  {\n    pid_t pid;\n    int status;\n    pid = wait(&amp;status);\n    if (pid &lt; 0)\n    {\n      continue;\n    }\n    if (pid == pid1)\n    {\n      pid1 = -1;\n    }\n    if (pid == pid2)\n    {\n      pid2 = -1;\n    }\n  }\n}\n\nint main(int argc, char *argv[])\n{\n        foobar();\n        return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 22041, "user_id": 108207, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/dd8608b8b423bdcbda3fe5c0cf8b6230?s=128&d=identicon&r=PG&f=1", "display_name": "Niklas R.", "link": "https://stackoverflow.com/users/108207/niklas-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 36789903, "answer_count": 2, "score": 0, "last_activity_date": 1461335966, "creation_date": 1460568212, "last_edit_date": 1461335966, "question_id": 36605429, "link": "https://stackoverflow.com/questions/36605429/which-signal-should-i-handle-and-how", "title": "Which signal should I handle and how?", "body": "<p>Where in my code should I \"wait until children are finished \"? I have a C program that is similar to a custom shell. Now I have a builtin function <code>checkEnv</code> that can print the sorted environment variables. So I can start my shell and list my environment variables:</p>\n\n<pre><code>$ ./a.out \nminiShell&gt;&gt; checkEnv\n\"'&gt;&lt;;|&amp;(:\n_=./a.out\nCLUTTER_IM_MODULE=xim\nCOMPIZ_CONFIG_PROFILE=ubuntu\nCOMP_WORDBREAKS=        \nDBUS_SESSION_BUS_ADDRESS=unix:abstract=/tmp/dbus-mh5oMhyCI6\nDEFAULTS_PATH=/usr/share/gconf/ubuntu.default.path\nDESKTOP_SESSION=ubuntu\n</code></pre>\n\n<p>The code behind that does this is the following:</p>\n\n<pre><code> if(StartsWith(line, \"checkEnv\")) {\n     built_in_command=1;\n     pagerValue = getenv (\"PAGER\");\n     if (! pagerValue) {\n       if (ret == 0) {\n         pager_cmd[0]=\"less\";\n       } else {\n         pager_cmd[0]=\"more\";\n       }\n     }\n    else {\n     pager_cmd[0]=pagerValue;\n    }\n\n\n    if(i==1) {\n       cmd[0].argv= printenv;\n       cmd[1].argv= sort;\n       cmd[2].argv= pager_cmd;\n       fork_pipes(3, cmd);\n\n\n    }\n    else {\n\n     for (k = 1; k &lt; i; k++)\n    {\n         len += strlen(argv2[k]) + 2;\n    }\n    tmp = (char *) malloc(len);\n    tmp[0] = '\\0';\n    for (k = 1; k &lt; i; k++)\n    {\n       pos += sprintf(tmp + pos, \"%s%s\", (k == 1 ? \"\" : \"|\"), argv2[k]);\n    }\n    grep[0]=\"grep\";\n    grep[1]=\"-E\";\n    grep[2]= tmp;\n    grep[3]= NULL;\n    cmd2[0].argv= printenv;\n    cmd2[1].argv= grep;\n    cmd2[2].argv= sort;\n    cmd2[3].argv= pager_cmd;\n    fork_pipes(4, cmd2);\n    free(tmp);\n\n            }\n</code></pre>\n\n<p>Now I want to catch the output termination signal when listing the environment variables using the pager so that the program returns to the custom shell instead of terminating the whole program. So I suppose that I should use some signal handling but how and which signal?</p>\n\n<p>The actual fork is from this function. </p>\n\n<pre><code>/* Helper function that forks pipes */\nvoid fork_pipes(int n, struct command *cmd) {\n    int i;\n    int in = 0;\n    int fd[2];\n    /** loop and fork() */\n    for (i = 0; i &lt; n - 1; ++i) {\n\n        if (pipe(fd) == -1) {\n            err_syserr(\"Failed creating pipe\");\n        }\n\n        spawn_proc(in, fd[1], cmd + i);\n        close(fd[1]);\n        in = fd[0];\n    }\n    if (dup2(in, 0) &lt; 0) {\n        err_syserr(\"dup2() failed on stdin for %s: \", cmd[i].argv[0]);\n    }\n    fprintf(stderr, \"%d: executing %s\\n\", (int) getpid(), cmd[i].argv[0]);\n    execvp(cmd[i].argv[0], cmd[i].argv);\n    err_syserr(\"failed to execute %s: \", cmd[i].argv[0]);\n}\n</code></pre>\n\n<p>Where should the signal handling go? Where is a minimal working example of what I'm trying to do? I see no example that does this and I think the documentation is terrible, only snippets and no complete example. </p>\n\n<p>My helper function is</p>\n\n<pre><code>/* Helper function that spawns processes */\nint spawn_proc(int in, int out, struct command *cmd) {\n    pid_t pid;\n    pid = fork();\n    if (pid == 0) {\n        if (in != 0) {\n            if (dup2(in, 0) &lt; 0)\n                err_syserr(\"dup2() failed on stdin for %s: \", cmd-&gt;argv[0]);\n            close(in);\n        }\n        if (out != 1) {\n            if (dup2(out, 1) &lt; 0)\n                err_syserr(\"dup2() failed on stdout for %s: \", cmd-&gt;argv[0]);\n            close(out);\n        }\n        printf(\"** we are executing parent ***\");\n        fprintf(stderr, \"%d: executing %s\\n\", (int) getpid(), cmd-&gt;argv[0]);\n        execvp(cmd-&gt;argv[0], cmd-&gt;argv);\n        err_syserr(\"failed to execute %s: \", cmd-&gt;argv[0]);\n    }\n    else if (pid &lt; 0) {\n        err_syserr(\"fork failed: \");\n    } else {\n        /* */\n         printf(\"** we are the parent ***\");\n    }\n    return pid;\n}\n</code></pre>\n\n<p>My <code>main()</code> now looks like this:</p>\n\n<pre><code>int main(int argc, char *argv[]) {\n\n    sourceCount = 0;\n    const char *commandFile;\n\n    commandFile = NULL;\n    char *pathValue;\n/*    struct sigaction sa, osa;\n    struct sigaction sa2;*/\n    int errflag;\n    int cOption;\n    struct sigaction action;\n    /* use getopt_long()  */\n    char *argv1[] = {\"version\", \"par2\", 0};\n/*    char *argv2[] = {\"help\", \"-m\", \"arg1\", 0};*/\n\n    /* use sigaction */\n\n    sigemptyset(&amp;action.sa_mask);\n    action.sa_handler = handle_sigchld;\n    action.sa_flags = 0;\n\n    sigaction(SIGPIPE, &amp;action, NULL);   //Not work with kill -13 process_id\n    //works well\n    sigaction(SIGINT, &amp;action, NULL);    //work with kill -2 process_id\n\n    errflag = 0;\n\n    /* use getopt_long()  */\n    while ((cOption = getopt(2, argv1, \"m:t:n:fs?\")) != -1) {\n\n        switch (cOption) {\n            case 'a':\n                printf(\"apples\\n\");\n                break;\n            case 'b':\n                printf(\"bananas\\n\");\n                break;\n            case 't':\n                printf(\"tree = %s\\n\", optarg);\n                break;\n            case '?':\n                ++errflag;\n                break;\n        }\n    }\n/*\n    while (( cOption = getopt (3, argv2, \"m:t:n:fs?\")) != -1) {\n        switch (cOption) {\n            case 'm':\n                printf(\"\\n Help msg : %s \\n\", optarg);\n                exit(0);\n            case '?':\n                printf(\"\\n -? Arg : %s \\n\", optarg);\n                break;\n            case 'n':\n                printf(\"\\n -n Arg : %s \\n\", optarg);\n                break;\n        }\n    }\n*/\n\n\n    /* get the PATH environment to find if less is installed */\n    pathValue = getenv(\"PATH\");\n    if (!pathValue || getenv(\"PATH\") == NULL) {\n        printf(\"'%s' is not set.\\n\", \"PATH\");\n\n        /* Default our path if it is not set. */\n\n        putenv(\"PATH=/bin:/usr/bin:/sbin:/usr/sbin:/etc\");\n    }\n    else {\n        printf(\"'%s' is set to %s.\\n\", \"PATH\", pathValue);\n    }\n    exec_program(commandFile);\n    return (0);\n}\n</code></pre>\n\n<p>If I run my shell in <code>gdb</code> I get a normal exit. </p>\n\n<pre><code>(gdb) run\nStarting program: /home/dac/ClionProjects/shell2/openshell/shell \n'PATH' is set to /home/dac/proj/google-cloud-sdk/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin.\ndac:/home/dac/ClionProjects/shell2/openshell $ checkenv\n7429: executing printenv\n7430: executing grep\n7417: executing less\n7431: executing sort\nprocess 7417 is executing new program: /bin/less\n[Inferior 1 (process 7417) exited normally]\n(gdb) \n</code></pre>\n"}, {"tags": ["c", "lua", "lua-api"], "comments": [{"owner": {"reputation": 2863, "user_id": 415823, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2c57689ce574b5988334b777e774bb3?s=128&d=identicon&r=PG", "display_name": "Adam", "link": "https://stackoverflow.com/users/415823/adam"}, "edited": false, "score": 0, "creation_date": 1460568542, "post_id": 36605362, "comment_id": 60808032, "body": "There are <a href=\"https://www.lua.org/manual/5.3/manual.html#luaL_setfuncs\" rel=\"nofollow noreferrer\">API functions</a> that can help with registering functions into tables, which version of Lua are you using?"}, {"owner": {"reputation": 113, "user_id": 4091001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f93de42c90764d8f06879c92ef1e3c4c?s=128&d=identicon&r=PG&f=1", "display_name": "Vasiliy Pupkin", "link": "https://stackoverflow.com/users/4091001/vasiliy-pupkin"}, "reply_to_user": {"reputation": 2863, "user_id": 415823, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2c57689ce574b5988334b777e774bb3?s=128&d=identicon&r=PG", "display_name": "Adam", "link": "https://stackoverflow.com/users/415823/adam"}, "edited": false, "score": 0, "creation_date": 1460570544, "post_id": 36605362, "comment_id": 60809232, "body": "Thanks for respond. I am using Lua 5.1, and it looks like there is no such API function there."}, {"owner": {"reputation": 2863, "user_id": 415823, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2c57689ce574b5988334b777e774bb3?s=128&d=identicon&r=PG", "display_name": "Adam", "link": "https://stackoverflow.com/users/415823/adam"}, "edited": false, "score": 0, "creation_date": 1460570723, "post_id": 36605362, "comment_id": 60809329, "body": "True, this function was added in Lua 5.2, but you might be able to use <a href=\"https://www.lua.org/manual/5.1/manual.html#luaL_register\" rel=\"nofollow noreferrer\">luaL_register</a> instead."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1460570726, "post_id": 36605362, "comment_id": 60809334, "body": "@VasiliyPupkin Of course there are"}, {"owner": {"reputation": 113, "user_id": 4091001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f93de42c90764d8f06879c92ef1e3c4c?s=128&d=identicon&r=PG&f=1", "display_name": "Vasiliy Pupkin", "link": "https://stackoverflow.com/users/4091001/vasiliy-pupkin"}, "edited": false, "score": 0, "creation_date": 1460571255, "post_id": 36605362, "comment_id": 60809658, "body": "Could you kindly write some example code? As I said, I know how to work with global tables, but not sub-ones."}, {"owner": {"reputation": 19681, "user_id": 936986, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/075f0ea7418371ace9bba5b901409ab1?s=128&d=identicon&r=PG", "display_name": "Oleg V. Volkov", "link": "https://stackoverflow.com/users/936986/oleg-v-volkov"}, "edited": false, "score": 0, "creation_date": 1460573080, "post_id": 36605362, "comment_id": 60810781, "body": "<code>rawget</code> a subtable,  instead of first <code>getglobal</code>. Rest is exactly the same."}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 4091001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f93de42c90764d8f06879c92ef1e3c4c?s=128&d=identicon&r=PG&f=1", "display_name": "Vasiliy Pupkin", "link": "https://stackoverflow.com/users/4091001/vasiliy-pupkin"}, "edited": false, "score": 0, "creation_date": 1460576627, "post_id": 36606964, "comment_id": 60812982, "body": "Thank you very much. After I asked the question, I found the solution myself, but yours is much more complex."}, {"owner": {"reputation": 2863, "user_id": 415823, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2c57689ce574b5988334b777e774bb3?s=128&d=identicon&r=PG", "display_name": "Adam", "link": "https://stackoverflow.com/users/415823/adam"}, "reply_to_user": {"reputation": 113, "user_id": 4091001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f93de42c90764d8f06879c92ef1e3c4c?s=128&d=identicon&r=PG&f=1", "display_name": "Vasiliy Pupkin", "link": "https://stackoverflow.com/users/4091001/vasiliy-pupkin"}, "edited": false, "score": 1, "creation_date": 1460576926, "post_id": 36606964, "comment_id": 60813183, "body": "You&#39;re welcome. This pattern is typically used for Lua modules written in C, as shown in the excellent <a href=\"http://www.lua.org/pil/28.1.html\" rel=\"nofollow noreferrer\">Programming in Lua</a> book. The first edition is available online for free."}], "tags": [], "owner": {"reputation": 2863, "user_id": 415823, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2c57689ce574b5988334b777e774bb3?s=128&d=identicon&r=PG", "display_name": "Adam", "link": "https://stackoverflow.com/users/415823/adam"}, "is_accepted": true, "score": 2, "last_activity_date": 1460573116, "creation_date": 1460573116, "answer_id": 36606964, "question_id": 36605362, "link": "https://stackoverflow.com/questions/36605362/insert-function-inside-subtable-using-lua-c-api/36606964#36606964", "title": "Insert function inside subtable using Lua C API", "body": "<p>A simple way to register multiple Lua C function into a table (using Lua 5.1) is to use <a href=\"https://www.lua.org/manual/5.1/manual.html#luaL_register\" rel=\"nofollow\">luaL_register</a>.</p>\n\n<p>First, implement your Lua functions, they should take the form of a <a href=\"http://www.lua.org/manual/5.1/manual.html#lua_CFunction\" rel=\"nofollow\">lua_CFunction</a>.</p>\n\n<pre><code>static int graphics_draw(lua_State *L) {\n    return luaL_error(L, \"graphics.draw unimplemented\");\n}\n\nstatic int system_wait(lua_State *L) {\n    return luaL_error(L, \"system.wait unimplemented\");\n}\n</code></pre>\n\n<p>Next, create a <a href=\"http://www.lua.org/manual/5.1/manual.html#luaL_Reg\" rel=\"nofollow\">luaL_Reg</a> structure for each sub-table with your Lua functions and their names (keys).</p>\n\n<pre><code>static const struct luaL_Reg module_graphics[] = {\n    {\"draw\", graphics_draw},        \n    // add more graphic functions here.. \n    {NULL, NULL}  // terminate the list with sentinel value\n};\n\nstatic const struct luaL_Reg module_system[] = {\n    {\"wait\", system_wait},        \n    {NULL, NULL}\n};\n</code></pre>\n\n<p>Then, in the function where you return your module table create each sub-table and <a href=\"http://www.lua.org/manual/5.1/manual.html#luaL_register\" rel=\"nofollow\">register</a> its functions.</p>\n\n<pre><code>int luaopen_game(lua_State *L) {    \n    lua_newtable(L);  // create the module table\n\n    lua_newtable(L);                          // create the graphics table\n    luaL_register(L, NULL, module_graphics);  // register functions into graphics table\n    lua_setfield(L, -2, \"graphics\");          // add graphics table to module\n\n    lua_newtable(L);                          // create the system table\n    luaL_register(L, NULL, module_system);    // register functions into system table\n    lua_setfield(L, -2, \"system\");            // add system table to module\n\n    // repeat the same process for other sub-tables\n\n    return 1;  // return module table\n}\n</code></pre>\n\n<p>This should result in a module table with the following structure:</p>\n\n<pre><code>game = {\n    graphics = {\n        draw -- C function graphics_draw\n    },\n    system = {\n        wait -- C function system_wait\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 4091001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f93de42c90764d8f06879c92ef1e3c4c?s=128&d=identicon&r=PG&f=1", "display_name": "Vasiliy Pupkin", "link": "https://stackoverflow.com/users/4091001/vasiliy-pupkin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 522, "favorite_count": 0, "accepted_answer_id": 36606964, "answer_count": 1, "score": 2, "last_activity_date": 1460573116, "creation_date": 1460567998, "last_edit_date": 1460573004, "question_id": 36605362, "link": "https://stackoverflow.com/questions/36605362/insert-function-inside-subtable-using-lua-c-api", "title": "Insert function inside subtable using Lua C API", "body": "<p>I am making my own game engine, using Lua C API. I got such Lua table hierarchy:</p>\n\n<pre><code>my_lib = {\n  system = { ... },\n  keyboard = { ... },\n  graphics = { ... },\n  ...\n}\n</code></pre>\n\n<p>Also I got some C function, I want to register, something like that:</p>\n\n<pre><code>inline static int lua_mylib_do_cool_things(lua_State *L) {\n    mylib_do_cool_things(luaL_checknumber(L, 1));\n    return 0;\n}\n</code></pre>\n\n<p>So, how can I register it like member of my_lib sub-table, just like that?</p>\n\n<pre><code>my_lib = {\n  system = { do_cool_things, ... },\n  keyboard = { ... }\n  graphics = { ...}\n}\n</code></pre>\n\n<p>Now I only know the way to register members of global tables, it works like that:</p>\n\n<pre><code>inline void mylib_registerFuncAsTMem(const char *table, lua_CFunction func, const char *index) {\n    lua_getglobal(mylib_luaState, table);\n    lua_pushstring(mylib_luaState, index);\n    lua_pushcfunction(mylib_luaState, func);\n    lua_rawset(mylib_luaState, -3);\n}\n</code></pre>\n\n<p>But what about sub-tables?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2742, "user_id": 2771245, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/vhsVn.jpg?s=128&g=1", "display_name": "mtijanic", "link": "https://stackoverflow.com/users/2771245/mtijanic"}, "edited": false, "score": 0, "creation_date": 1460567548, "post_id": 36605156, "comment_id": 60807442, "body": "This will be a good read for you: <a href=\"https://littleosbook.github.io/#the-framebuffer\" rel=\"nofollow noreferrer\">littleosbook.github.io/#the-framebuffer</a> (the whole book is worthwhile)"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1460567669, "post_id": 36605156, "comment_id": 60807522, "body": "Your textbook is outdated garbage."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1460567761, "post_id": 36605156, "comment_id": 60807574, "body": "Very old example. Very old <code>main</code>."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1460568969, "post_id": 36605156, "comment_id": 60808264, "body": "What are the odds of someone finding that old textbook <i>and</i> having an old enough computer that the old-school framebuffer-writing code actually works? (Or is -- horrors! -- Windows still doggedly implementing a pseudo-framebuffer at 0xb8000000 for the benefit of old code that&#39;s still using it?)"}], "owner": {"reputation": 109, "user_id": 5398352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ed0c76f08650d652f99481c23503e55?s=128&d=identicon&r=PG&f=1", "display_name": "TIWARI", "link": "https://stackoverflow.com/users/5398352/tiwari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "closed_date": 1460567546, "answer_count": 0, "score": 0, "last_activity_date": 1460567309, "creation_date": 1460567309, "question_id": 36605156, "link": "https://stackoverflow.com/questions/36605156/printing-on-console-screen-witout-printf-in-c", "closed_reason": "Duplicate", "title": "Printing on console screen witout printf() in c", "body": "<p>The code given in my textbook of c programming as  </p>\n\n<pre><code>#define DATATYPE char far*   \nmain()\n{\n  DATATYPE s;\n   s = 0xb8000000;\n  *s = 'A'; \n   getch(); \n}\n</code></pre>\n\n<p>by executing this code I'm getting A printed on top left corner of screen. In order to justify it is written in book that 0xb8000000 is the address that refer to top-left position of screen and is 32-bit address which is called far pointer.\nBut the idea is not clear about it so can anybody justify it me more clearly. Thank you.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2742, "user_id": 2771245, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/vhsVn.jpg?s=128&g=1", "display_name": "mtijanic", "link": "https://stackoverflow.com/users/2771245/mtijanic"}, "edited": false, "score": 1, "creation_date": 1460567415, "post_id": 36605106, "comment_id": 60807345, "body": "Take a look at these questions: <a href=\"http://stackoverflow.com/questions/1023261/is-there-a-way-to-do-currying-in-c\" title=\"is there a way to do currying in c\">stackoverflow.com/questions/1023261/&hellip;</a>   <a href=\"http://stackoverflow.com/questions/12991014/functional-programming-currying-in-c-issue-with-types\" title=\"functional programming currying in c issue with types\">stackoverflow.com/questions/12991014/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 6199000, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2ZhGZwhB2Lo/AAAAAAAAAAI/AAAAAAAAADk/WOkMtkRAyks/photo.jpg?sz=128", "display_name": "Daniel Vanzella", "link": "https://stackoverflow.com/users/6199000/daniel-vanzella"}, "reply_to_user": {"reputation": 2742, "user_id": 2771245, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/vhsVn.jpg?s=128&g=1", "display_name": "mtijanic", "link": "https://stackoverflow.com/users/2771245/mtijanic"}, "edited": false, "score": 0, "creation_date": 1460568479, "post_id": 36605106, "comment_id": 60807995, "body": "Thanks! I&#39;m reading Dami&#39;s paper. Seems exactly what I was looking for. Cheers!"}], "owner": {"reputation": 1, "user_id": 6199000, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2ZhGZwhB2Lo/AAAAAAAAAAI/AAAAAAAAADk/WOkMtkRAyks/photo.jpg?sz=128", "display_name": "Daniel Vanzella", "link": "https://stackoverflow.com/users/6199000/daniel-vanzella"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1460567138, "creation_date": 1460567138, "question_id": 36605106, "link": "https://stackoverflow.com/questions/36605106/defining-function-using-another-function-with-different-number-of-arguments-in-c", "title": "Defining function using another function with different number of arguments in C", "body": "<p>Is it possible, in C, to define a function, which takes integer values as<br>\nargument, through the values it assumes at the each one of the value<br>\nof its arguments? Something like the below (which does NOT work):</p>\n\n<pre><code>double f(int i);\n\nfor (i = 0; i &lt; N; i++)\n    f(i) = table_of_values[i]; //some predefined array of values\n</code></pre>\n\n<p>I know arrays are best in this simple case but I wanted to use this<br>\nto define a function, like the f(i) above, in terms of another function<br>\nof more arguments but holding all the other arguments fixed, like in<br>\nf(i) = g(i,a) for a given function g and parameter a.</p>\n"}, {"tags": ["c", "loops", "for-loop", "segmentation-fault", "stack"], "comments": [{"owner": {"reputation": 1964, "user_id": 1320881, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b69670b7cc6bce132f443eee557c9448?s=128&d=identicon&r=PG", "display_name": "Unimportant", "link": "https://stackoverflow.com/users/1320881/unimportant"}, "edited": false, "score": 3, "creation_date": 1460566475, "post_id": 36604711, "comment_id": 60806732, "body": "You are opening files in a loop and never closing them, and any hope of ever closing them as you lose the handle in the next iteration, Why are you fscanf&#39;ing a trough e 10000 times in a loop and not doing anything with the values you read?"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1460566504, "post_id": 36604711, "comment_id": 60806749, "body": "I don&#39;t see any file closes??"}, {"owner": {"reputation": 17121, "user_id": 202919, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c98b750637d6114f5fd1893dbdfe1f39?s=128&d=identicon&r=PG", "display_name": "Venemo", "link": "https://stackoverflow.com/users/202919/venemo"}, "edited": false, "score": 0, "creation_date": 1460566601, "post_id": 36604711, "comment_id": 60806803, "body": "What OS / platform are you running this on?"}, {"owner": {"reputation": 263, "user_id": 619670, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5b4507b5c0291e4dbcc00ab2f547bfe5?s=128&d=identicon&r=PG", "display_name": "none", "link": "https://stackoverflow.com/users/619670/none"}, "edited": false, "score": 0, "creation_date": 1460566643, "post_id": 36604711, "comment_id": 60806830, "body": "I am using the values. They are used in calculations, the calculations aren&#39;t in the code I uploaded because here because the problem is persistent with or without them. When I run the above I get the same exact number of iterations through the loop."}, {"owner": {"reputation": 263, "user_id": 619670, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5b4507b5c0291e4dbcc00ab2f547bfe5?s=128&d=identicon&r=PG", "display_name": "none", "link": "https://stackoverflow.com/users/619670/none"}, "edited": false, "score": 0, "creation_date": 1460566696, "post_id": 36604711, "comment_id": 60806866, "body": "Sorry I should have said about the OS... I&#39;m running it on a cygwin64 platform inside Windows 8"}, {"owner": {"reputation": 263, "user_id": 619670, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5b4507b5c0291e4dbcc00ab2f547bfe5?s=128&d=identicon&r=PG", "display_name": "none", "link": "https://stackoverflow.com/users/619670/none"}, "edited": false, "score": 0, "creation_date": 1460570380, "post_id": 36604711, "comment_id": 60809136, "body": "It was the lack of file closes... It works perfectly now. Thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 263, "user_id": 619670, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5b4507b5c0291e4dbcc00ab2f547bfe5?s=128&d=identicon&r=PG", "display_name": "none", "link": "https://stackoverflow.com/users/619670/none"}, "edited": false, "score": 0, "creation_date": 1460570323, "post_id": 36604972, "comment_id": 60809102, "body": "That fixed it! Thank you so so much!"}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 2, "last_activity_date": 1460566712, "creation_date": 1460566712, "answer_id": 36604972, "question_id": 36604711, "link": "https://stackoverflow.com/questions/36604711/segmention-fault-while-in-the-middle-of-nested-for-loop/36604972#36604972", "title": "Segmention Fault while in the middle of nested for loop", "body": "<p>You need to check the return value from <code>fopen()</code>. Since you're never closing the input files, you're probably hitting the limit on open files. Then <code>fopen()</code> returns <code>NULL</code>, and when you try to use that with <code>fscanf()</code> you get a segfault.</p>\n\n<pre><code>       //Open the files\n        FILE *input1 = fopen(input_1, \"r\");\n        if (!input1) {\n            printf(\"open input_1 failed\\n\");\n            exit(1);\n        }\n        FILE *input2 = fopen(input_2, \"r\");\n        if (!input2) {\n            printf(\"open input_2 failed\\n\");\n            exit(1);\n        }\n        FILE *input3 = fopen(input_3, \"r\");\n        if (!input3) {\n            printf(\"open input_3 failed\\n\");\n            exit(1);\n        }\n        FILE *input4 = fopen(input_4, \"r\");\n        if (!input4) {\n            printf(\"open input_4 failed\\n\");\n            exit(1);\n        }\n        FILE *input5 = fopen(input_5, \"r\");\n        if (!input5) {\n            printf(\"open input_5 failed\\n\");\n            exit(1);\n        }\n\n        for (i=1; i &lt; 10000; i++)\n            {\n                //For a given Z value, read in the corresponding values. Usually these input files have ~20000 values in each so the loop would be set to run until the end of the file\n                fscanf(input1, \"%lf\", &amp;a);\n                fscanf(input2, \"%lf\", &amp;b);\n                fscanf(input3, \"%lf\", &amp;c);\n                fscanf(input4, \"%lf\", &amp;d);\n                fscanf(input5, \"%lf\", &amp;e);\n\n            }\n        //Test to see how far it gets in loop before giving up due to segmentation fault    \n        printf(\"The iteration number is: %d\\n\", j); \n\n        fclose(input1);\n        fclose(input2);\n        fclose(input3);\n        fclose(input4);\n        fclose(input5);\n</code></pre>\n"}], "owner": {"reputation": 263, "user_id": 619670, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5b4507b5c0291e4dbcc00ab2f547bfe5?s=128&d=identicon&r=PG", "display_name": "none", "link": "https://stackoverflow.com/users/619670/none"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 36604972, "answer_count": 1, "score": 1, "last_activity_date": 1460566712, "creation_date": 1460565853, "last_edit_date": 1460566451, "question_id": 36604711, "link": "https://stackoverflow.com/questions/36604711/segmention-fault-while-in-the-middle-of-nested-for-loop", "title": "Segmention Fault while in the middle of nested for loop", "body": "<p>I've written a code that needs to read in a series of values from a user specified data file (This could be up to 10,000 rows of data) which is done in the first for loop. In each row of values one of the variables is converted to a string which defines another set of input files(each containing ~20,000 rows of data) to load which are needed in the second for loop for calculations. This works well for the first few hundred iterations... it reads in everything correctly, and the resulting calculations (Calculations are omitted in the code below because the code produces the same problme with or without them) are as expected. </p>\n\n<p>The problem is that when the first for loop reaches around 600 iterations it stops and produces the error: segmentation fault(core dumped) </p>\n\n<p>I'm pretty sure this is a memory problem of some sort because if I've tested the code by omitting 4 of the input files in the second loop and it's capable of reaching a higher number of iterations.... </p>\n\n<p>This is the code:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;math.h&gt;\n#include&lt;stdlib.h&gt;\n\nint main()\n\n{\n    int num, i, j;\n    double X, Y;// \n    float Z;\n    char the_data[25], Z_name[10], input_1[50], input_2[50], input_3[50], input_4[50], input_5[50];\n    double a, b, c, d, e;\n\n    printf(\"Enter the name of the data file you are using:\\n\");\n    scanf(\"%24s\", &amp;the_data);\n    FILE *DATA = fopen(the_data,\"r\");\n\n    for (j=1; j&lt;800; j++)\n        {\n\n            //***************Read data from a file, the variable Z is a floating point number which, when rounded to the nearest decimal place,  \n            //********************determines which directory to load model data from for each value of X and Y\n            fscanf(DATA, \"%lf %lf %f\\n\", &amp;X, &amp;Y, &amp;Z);\n\n            //round Z to the nearest 1 decimal place\n            Z = Z * 10;\n            Z = roundf(Z);\n            Z = Z / 10;\n\n            //assign the full directory name to Z_name\n            sprintf(Z_name, \"%.01fdirectory\", Z);\n\n            //assign Z_name to input name string for path to the appropriate data file locations\n            sprintf(input_1, \"./%s/a.txt\", Z_name);\n            sprintf(input_2, \"./%s/b.txt\", Z_name);\n            sprintf(input_3, \"./%s/c.txt\", Z_name);\n            sprintf(input_4, \"./%s/d.txt\", Z_name);\n            sprintf(input_5, \"./%s/e.txt\", Z_name);\n\n            //Open the files\n            FILE *input1 = fopen(input_1, \"r\");\n            FILE *input2 = fopen(input_2, \"r\");\n            FILE *input3 = fopen(input_3, \"r\");\n            FILE *input4 = fopen(input_4, \"r\");\n            FILE *input5 = fopen(input_5, \"r\");\n\n\n            for (i=1; i &lt; 10000; i++)\n                {\n                    //For a given Z value, read in the corresponding values. Usually these input files have ~20000 values in each so the loop would be set to run until the end of the file\n                    fscanf(input1, \"%lf\", &amp;a);\n                    fscanf(input2, \"%lf\", &amp;b);\n                    fscanf(input3, \"%lf\", &amp;c);\n                    fscanf(input4, \"%lf\", &amp;d);\n                    fscanf(input5, \"%lf\", &amp;e);\n\n                }\n            //Test to see how far it gets in loop before giving up due to segmentation fault    \n            printf(\"The iteration number is: %d\\n\", j); \n\n        }\n    printf(\"This will print if the program reaches the end of the first loop\\n\");\n\n}\n</code></pre>\n\n<p>I'd appreciate any tips or pointers in dealing with this problem. Thanks!</p>\n"}, {"tags": ["c", "if-statement", "while-loop", "char", "scanf"], "comments": [{"owner": {"reputation": 74843, "user_id": 2988730, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZOX7t.jpg?s=128&g=1", "display_name": "Mad Physicist", "link": "https://stackoverflow.com/users/2988730/mad-physicist"}, "edited": false, "score": 0, "creation_date": 1460566043, "post_id": 36604684, "comment_id": 60806455, "body": "Fix your code indentation."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 3, "creation_date": 1460566324, "post_id": 36604684, "comment_id": 60806633, "body": "C isn&#39;t Python, you can&#39;t return tuples. (<code>count, letter</code> will return only <code>letter</code>.)"}, {"owner": {"reputation": 8218, "user_id": 2615940, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/9a6Qc.jpg?s=128&g=1", "display_name": "skrrgwasme", "link": "https://stackoverflow.com/users/2615940/skrrgwasme"}, "edited": false, "score": 1, "creation_date": 1460566462, "post_id": 36604684, "comment_id": 60806717, "body": "Don&#39;t include anything that you&#39;re going to tell us to disregard. If it&#39;s irrelevant, cut it out of your question."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 2, "creation_date": 1460566473, "post_id": 36604684, "comment_id": 60806731, "body": "When you use <a href=\"https://msdn.microsoft.com/de-de/library/w40768et.aspx\" rel=\"nofollow noreferrer\"><code>scanf_s</code></a>, make sure that you specify a maximum buffer count for all <code>%s</code>, <code>%c</code> and <code>%[</code> formats:  <code>scanf_s(&quot;%c&quot;, &amp;letter, 1);</code>."}], "answers": [{"tags": [], "owner": {"reputation": 2686, "user_id": 239318, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/77279cc4288a0f5186be1e7e23f37202?s=128&d=identicon&r=PG", "display_name": "diatrevolo", "link": "https://stackoverflow.com/users/239318/diatrevolo"}, "is_accepted": true, "score": 1, "last_activity_date": 1460568451, "last_edit_date": 1460568451, "creation_date": 1460566426, "answer_id": 36604877, "question_id": 36604684, "link": "https://stackoverflow.com/questions/36604684/c-programming-a-simple-countdown-program/36604877#36604877", "title": "C Programming: A Simple Countdown Program", "body": "<p>It would seem to me that you are not accounting for the new line character on your input, and it is getting sent through your subroutine as well. Add an else if clause to test for <code>\\n</code>, and deal with it accordingly.</p>\n\n<p>There are multiple other issues with your C above, but that is the one related to the question, as far as I can tell.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6203673, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/c94b69f25fc40b39fc9d0e531cbff962?s=128&d=identicon&r=PG", "display_name": "Dane", "link": "https://stackoverflow.com/users/6203673/dane"}, "is_accepted": false, "score": 0, "last_activity_date": 1460633144, "last_edit_date": 1592644375, "creation_date": 1460633144, "answer_id": 36621655, "question_id": 36604684, "link": "https://stackoverflow.com/questions/36604684/c-programming-a-simple-countdown-program/36621655#36621655", "title": "C Programming: A Simple Countdown Program", "body": "<h1>NUIGProbz</h1>\n<p>You need to basically create an array of 9 letters, initialize to NULL,\ncreate arr of v and c, have the user pick their letters until the 9 letter array is full, print out the letters, have the user enter a word, cross ref the dictionary, and if the word exists, print out their score.</p>\n"}], "owner": {"reputation": 17, "user_id": 5976826, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2ca454a285711eb723a502ca430189fb?s=128&d=identicon&r=PG&f=1", "display_name": "Ulysses", "link": "https://stackoverflow.com/users/5976826/ulysses"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 841, "favorite_count": 0, "accepted_answer_id": 36604877, "answer_count": 2, "score": 0, "last_activity_date": 1460633144, "creation_date": 1460565774, "last_edit_date": 1460566683, "question_id": 36604684, "link": "https://stackoverflow.com/questions/36604684/c-programming-a-simple-countdown-program", "title": "C Programming: A Simple Countdown Program", "body": "<p>I'm attempting to create a simple program related to the Countdown TV show. I've only started it so my problem is from the beginning. When i ask the user to enter c or v for a consonant or a vowel, I'm just checking if it returns yes, no or please try again. This works but it directly repeats itself, with the return of the please try again. I feel like it's a simple issue but I don't know what it is.</p>\n\n<pre><code>#include \"stdafx.h\"\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\nint test(int count, char lett);\n\nint main()\n{\n    int i, counter;\n    char letter;\n    //char *fileName = \"webster.txt\";\n\n    printf(\"Welcome to Countdown!\\n\\n\");\n    printf(\"The objective of the game is to produce the largest word from the nine letter(consonants and/or vowels) that are chosen at random by you. \");\n    printf(\"The computer will then find the longest word available from these letters to compare with your word.\\n\");\n    printf(\"Let's begin!\\n\");\n\n    counter = 0;\n\n    while (counter &lt; 9) {\n        printf(\"\\nWould you like a consonant or a vowel(Enter either c or v)? \");\n        scanf_s(\"%c\", &amp;letter);\n\n        test(counter, letter);\n\n    }\n\n    return 0;\n}\n\nint test(int count, char letter)\n{\n    if (letter == 'c') {\n    printf(\"yes\\n\");\n    count++;\n    }\n    else if (letter == 'v') {\n        printf(\"no\\n\");\n        count++;\n    }\n    else {\n        printf(\"Please try again\\n\");\n    }\n\n    return count, letter;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "sockets"], "comments": [{"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 4, "creation_date": 1460566454, "post_id": 36604680, "comment_id": 60806715, "body": "Asking about the &quot;other end&quot; of a UDP socket is like asking about the &quot;other end&quot; of a mailbox... the packets flowing through a UDP socket can come from (or go to) many different destinations."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1460567857, "post_id": 36604680, "comment_id": 60807633, "body": "If you want &quot;connections&quot; then you want TCP or possibly SCTP."}], "answers": [{"comments": [{"owner": {"reputation": 3954, "user_id": 3137388, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/98f780bca09821cbd63d84b8d6e028df?s=128&d=identicon&r=PG&f=1", "display_name": "kadina", "link": "https://stackoverflow.com/users/3137388/kadina"}, "edited": false, "score": 0, "creation_date": 1460573765, "post_id": 36604764, "comment_id": 60811211, "body": "Thanks Antti. In our project, we are using UDP and on client I am using recv() call to with a timeout. In some corner case, the server died and there is a monitoring agent in our systems, which will monitor the process and if any process dies, it will restarts the process. As I am checking only if return value os recv() is less than 0, I am listening on the old socket and even though server starts newly, I am not able to get the messages. Can you please suggest any idea how to fix."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "reply_to_user": {"reputation": 3954, "user_id": 3137388, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/98f780bca09821cbd63d84b8d6e028df?s=128&d=identicon&r=PG&f=1", "display_name": "kadina", "link": "https://stackoverflow.com/users/3137388/kadina"}, "edited": false, "score": 0, "creation_date": 1460586701, "post_id": 36604764, "comment_id": 60818147, "body": "@kadina: That sounds very weird. Since UDP is not a connection, a listening UDP socket should pick up anything sent to its IP and port. Are you sure that the other side didn&#39;t just forget to send to you?"}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "reply_to_user": {"reputation": 3954, "user_id": 3137388, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/98f780bca09821cbd63d84b8d6e028df?s=128&d=identicon&r=PG&f=1", "display_name": "kadina", "link": "https://stackoverflow.com/users/3137388/kadina"}, "edited": false, "score": 0, "creation_date": 1460586744, "post_id": 36604764, "comment_id": 60818171, "body": "@kadina: for example, a syslog daemon listening for UDP syslog messages does not need to reopen its socket. It just keeps getting messages."}], "tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": true, "score": 8, "last_activity_date": 1460574885, "last_edit_date": 1460574885, "creation_date": 1460566014, "answer_id": 36604764, "question_id": 36604680, "link": "https://stackoverflow.com/questions/36604680/why-recv-doesnt-set-errno-if-other-end-of-socket-communication-is-closed/36604764#36604764", "title": "why recv() doesn&#39;t set errno if other end of socket communication is closed?", "body": "<p>UDP does not have <strong>connections</strong>, and thus you cannot easily deduce whether or not the other end had closed the socket. If you need connections, you must use TCP.</p>\n\n<p>However, <em>often</em> a receiver sends an ICMP reply when contacted to an UDP port that is not open; this can be signalled as a return value from <code>recv</code> or <code>send</code>; on Linux this can happen for any UDP sockets, and on BSD it seems it only applies to \"connected\" UDP sockets.</p>\n\n<p>In any case, you cannot deduce between any of</p>\n\n<ul>\n<li>ICMP towards sender being filtered by firewall</li>\n<li>UDP towards receiver being filtered by firewall </li>\n<li>UDP being delivered successfully to the receiver</li>\n</ul>\n\n<p>So I'd consider the possible signalling of UDP errors a \"nice addition\", but not something to rely on.</p>\n\n<hr>\n\n<p>TCP is very much analogous to a phone call, whereas UDP is more like mailboxes. If you send a letter to a non-existent address that does not have a mail box, you <em>could</em> get your letter back 2 weeks later with a sticker saying that mail couldn't be delivered. </p>\n\n<p>If you do not get your letter back then either the receiver received it, the post man stole it, it was shredded in a sorting machine, or perhaps a dog ate the letter; the only way to know it was actually successfully received would be that the receiver sent another letter back acknowledging the receipt.</p>\n"}], "owner": {"reputation": 3954, "user_id": 3137388, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/98f780bca09821cbd63d84b8d6e028df?s=128&d=identicon&r=PG&f=1", "display_name": "kadina", "link": "https://stackoverflow.com/users/3137388/kadina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 383, "favorite_count": 0, "accepted_answer_id": 36604764, "answer_count": 1, "score": 2, "last_activity_date": 1460574885, "creation_date": 1460565770, "question_id": 36604680, "link": "https://stackoverflow.com/questions/36604680/why-recv-doesnt-set-errno-if-other-end-of-socket-communication-is-closed", "title": "why recv() doesn&#39;t set errno if other end of socket communication is closed?", "body": "<p>I was trying to use UDP sockets. On client I set specific time out and when I call recv(), I am checking the return value and if it it is less than 0, I am checking if errno is EAGAIN or EWOULDBLOCK. If the errno is not one of these 2, I am trying to reconnect the server. Now I need to determine whether the other end of the connection is closed or not. Besides checking for the return value of recv() equals to '0', do I need to check for errno? Does recv() set errno, if other end of socket is closed? If not why errno is not set?</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 8, "creation_date": 1460565685, "post_id": 36604627, "comment_id": 60806245, "body": "Don&#39;t tell me you really wrote that code....."}, {"owner": {"reputation": 5207, "user_id": 3277393, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/a2967a01798ad7d675a6b39f41232a5b?s=128&d=identicon&r=PG&f=1", "display_name": "user12341234", "link": "https://stackoverflow.com/users/3277393/user12341234"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1460565723, "post_id": 36604627, "comment_id": 60806266, "body": "This is a minimal viable example from someone else&#39;s buggy code... They claim it works fine in Visual Studio..."}, {"owner": {"reputation": 2971, "user_id": 4975646, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XzXhmdjjKB0/AAAAAAAAAAI/AAAAAAAAAeg/9rsygRfbVyk/photo.jpg?sz=128", "display_name": "callyalater", "link": "https://stackoverflow.com/users/4975646/callyalater"}, "edited": false, "score": 3, "creation_date": 1460565812, "post_id": 36604627, "comment_id": 60806319, "body": "<code>==</code> comparisons on strings in C don&#39;t mean what you think it means."}, {"owner": {"reputation": 74843, "user_id": 2988730, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZOX7t.jpg?s=128&g=1", "display_name": "Mad Physicist", "link": "https://stackoverflow.com/users/2988730/mad-physicist"}, "edited": false, "score": 0, "creation_date": 1460565849, "post_id": 36604627, "comment_id": 60806346, "body": "And neither does <code>V1 - A1</code>."}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 1, "creation_date": 1460565905, "post_id": 36604627, "comment_id": 60806381, "body": "It <a href=\"http://ideone.com//3htZye\" rel=\"nofollow noreferrer\">works for me</a> (after you fix all the obvious bugs)."}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 1, "creation_date": 1460566034, "post_id": 36604627, "comment_id": 60806447, "body": "Your last edit just increased the number of bugs in the code, which is quite an achievement!"}, {"owner": {"reputation": 5207, "user_id": 3277393, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/a2967a01798ad7d675a6b39f41232a5b?s=128&d=identicon&r=PG&f=1", "display_name": "user12341234", "link": "https://stackoverflow.com/users/3277393/user12341234"}, "edited": false, "score": 0, "creation_date": 1460566039, "post_id": 36604627, "comment_id": 60806451, "body": "Changed to &#39;%u&#39;, but that doesn&#39;t change the output"}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1460566077, "post_id": 36604627, "comment_id": 60806483, "body": "@user12341234: see the <a href=\"http://ideone.com/3htZye\" rel=\"nofollow noreferrer\">link in my comment above</a> for bug-fixed code."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1460567596, "post_id": 36604627, "comment_id": 60807482, "body": "@user12341234 &#39;They claim it works fine in Visual Studio&#39; - what about when you tried it?"}, {"owner": {"reputation": 5207, "user_id": 3277393, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/a2967a01798ad7d675a6b39f41232a5b?s=128&d=identicon&r=PG&f=1", "display_name": "user12341234", "link": "https://stackoverflow.com/users/3277393/user12341234"}, "edited": false, "score": 0, "creation_date": 1460567662, "post_id": 36604627, "comment_id": 60807517, "body": "It outputs <code>0 0</code> on my system. Presumably on theirs this would output <code>0 1</code>, though their original code was quite different from this version."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1460571365, "post_id": 36604627, "comment_id": 60809729, "body": "Use <code>printf(&quot;%d\\n&quot;, V1 == A1); printf(&quot;%td\\n&quot;, V1 - A1);</code> to print valid results.  It <code>&quot;%td&quot;</code> not available, use <code>printf(&quot;%d\\n&quot;, (int) (V1 - A1));</code>  Still  other UB exists."}, {"owner": {"reputation": 5207, "user_id": 3277393, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/a2967a01798ad7d675a6b39f41232a5b?s=128&d=identicon&r=PG&f=1", "display_name": "user12341234", "link": "https://stackoverflow.com/users/3277393/user12341234"}, "edited": false, "score": 0, "creation_date": 1460572409, "post_id": 36604627, "comment_id": 60810337, "body": "On my machine <code>A1</code> is an int not a pointer, so the type of <code>V1 - A1</code> is actually <code>char *</code> not <code>ptrdiff_t</code>"}], "answers": [{"comments": [{"owner": {"reputation": 5207, "user_id": 3277393, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/a2967a01798ad7d675a6b39f41232a5b?s=128&d=identicon&r=PG&f=1", "display_name": "user12341234", "link": "https://stackoverflow.com/users/3277393/user12341234"}, "edited": false, "score": 0, "creation_date": 1460566172, "post_id": 36604748, "comment_id": 60806541, "body": "Ok, so the reason the two values don&#39;t equal each other is because it&#39;s undefined behavior?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 5207, "user_id": 3277393, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/a2967a01798ad7d675a6b39f41232a5b?s=128&d=identicon&r=PG&f=1", "display_name": "user12341234", "link": "https://stackoverflow.com/users/3277393/user12341234"}, "edited": false, "score": 1, "creation_date": 1460566236, "post_id": 36604748, "comment_id": 60806581, "body": "@user12341234 Primarily, it&#39;s bad code (no offense), secondly, <code>==</code> is not the same as <code>strcmp()</code>, thirdly, you&#39;re right."}, {"owner": {"reputation": 5207, "user_id": 3277393, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/a2967a01798ad7d675a6b39f41232a5b?s=128&d=identicon&r=PG&f=1", "display_name": "user12341234", "link": "https://stackoverflow.com/users/3277393/user12341234"}, "edited": false, "score": 0, "creation_date": 1460566347, "post_id": 36604748, "comment_id": 60806648, "body": "Re firstly: No offense taken, I didn&#39;t write this, just simplified it. Re secondly: I don&#39;t think the original intent was to compare string content, but the pointers. Re thirdly: thanks."}, {"owner": {"reputation": 5207, "user_id": 3277393, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/a2967a01798ad7d675a6b39f41232a5b?s=128&d=identicon&r=PG&f=1", "display_name": "user12341234", "link": "https://stackoverflow.com/users/3277393/user12341234"}, "edited": false, "score": 1, "creation_date": 1460566903, "post_id": 36604748, "comment_id": 60806998, "body": "Don&#39;t those &quot;pointers&quot; both point to the same array object though? I&#39;m not sure that that specifically is the source of the undefined behavior"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 2, "last_activity_date": 1460566178, "last_edit_date": 1460566178, "creation_date": 1460565961, "answer_id": 36604748, "question_id": 36604627, "link": "https://stackoverflow.com/questions/36604627/values-the-same-but-not-equal/36604748#36604748", "title": "Values the same but not equal", "body": "<p>As per the <code>C11</code> standard, chapter \u00a76.5.6, two pointers can only any only be subtracted if they are from same array object.</p>\n\n<blockquote>\n  <p>When two pointers are subtracted, both shall point to elements of the same array object,\n  or one past the last element of the array object; the result is the difference of the\n  subscripts of the two array elements. The size of the result is implementation-defined,\n  and its type (a signed integer type) is <code>ptrdiff_t</code> defined in the <code>&lt;stddef.h&gt;</code> header.\n  If the result is not representable in an object of that type, the behavior is undefined. [...]</p>\n</blockquote>\n\n<p>That said, you should be using <code>%td</code> for printing a result of type <code>ptrdiff_t</code>, generated from pointer subtraction.</p>\n\n<p>Next, coming to the usage of <code>==</code> operator, it cannot be used to compare the contents of the string (array), it basically compares the pointers themselves (not the content they point to).</p>\n"}, {"comments": [{"owner": {"reputation": 5207, "user_id": 3277393, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/a2967a01798ad7d675a6b39f41232a5b?s=128&d=identicon&r=PG&f=1", "display_name": "user12341234", "link": "https://stackoverflow.com/users/3277393/user12341234"}, "edited": false, "score": 0, "creation_date": 1460566971, "post_id": 36604970, "comment_id": 60807036, "body": "But if the values were the same, and there were a narrowing then wouldn&#39;t both operands of the <code>==</code> get downcast and still be equal?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 5207, "user_id": 3277393, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/a2967a01798ad7d675a6b39f41232a5b?s=128&d=identicon&r=PG&f=1", "display_name": "user12341234", "link": "https://stackoverflow.com/users/3277393/user12341234"}, "edited": false, "score": 0, "creation_date": 1460567574, "post_id": 36604970, "comment_id": 60807461, "body": "Good question. Comparing an integer to a pointer is undefined behavior, hence the comparison is undefined. In any event, <code>V1 == V1</code> *is true and <code>A1 == V1</code> sometimes evaluates to false, and the implicit cast from <code>pointer</code> to <code>int</code> is the only place where a discrepancy between the two sides of the comparison could have been introduced. Maybe the problem isn&#39;t narrowing per se but the conversion to a signed number."}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 2, "last_activity_date": 1460567746, "last_edit_date": 1460567746, "creation_date": 1460566707, "answer_id": 36604970, "question_id": 36604627, "link": "https://stackoverflow.com/questions/36604627/values-the-same-but-not-equal/36604970#36604970", "title": "Values the same but not equal", "body": "<p>As @SouravGhosh pointed out, there is undefined behavior here. Still, it is interesting to understand why the second printed value is sometimes 0 and sometimes 1 (depending on the machine it runs on). </p>\n\n<p>The absence of an explicit type for the input of <code>F</code> means that <code>A1</code> is implicitly an <code>int</code>. The function call <code>F(V1)</code> thus casts the pointer <code>V1</code> to an <code>int</code>. On some machines this might be a narrowing conversion, which is why on some machines the comparison <code>V1 == A1</code> is true while on other machines it is false. Perhaps on some machines both arguments in <code>V1 - A1</code> are cast to ints (hence the value 0) but in the comparison <code>V1 == A1</code> (which is ub) tries to cast <code>A1</code> to a valid address and either fails or casts it to a different address.</p>\n"}], "owner": {"reputation": 5207, "user_id": 3277393, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/a2967a01798ad7d675a6b39f41232a5b?s=128&d=identicon&r=PG&f=1", "display_name": "user12341234", "link": "https://stackoverflow.com/users/3277393/user12341234"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 1, "closed_date": 1461737313, "answer_count": 2, "score": -2, "last_activity_date": 1460569499, "creation_date": 1460565627, "last_edit_date": 1460569499, "question_id": 36604627, "link": "https://stackoverflow.com/questions/36604627/values-the-same-but-not-equal", "closed_reason": "Not suitable for this site", "title": "Values the same but not equal", "body": "<p>Can somebody explain to me why the following code outputs <code>0 0</code>. I was under the impression that mathematically <code>a-b == 0</code> \u21d2 <code>a == b</code></p>\n\n<pre><code>char* V1 = \"hello, world!\\n\";\n\nmain(){\n  F1(V1);\n}\n\nF1(A1){\n  printf(\"%u %u\\n\", V1 - A1, V1 == A1);\n}\n</code></pre>\n"}, {"tags": ["c", "openssl", "rsa", "public-key", "libcrypto"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1460743168, "post_id": 36604601, "comment_id": 60900913, "body": "Your code wouldn&#39;t compile on C++ compiler, then why&#39;d you tag C++?"}, {"owner": {"reputation": 99, "user_id": 6198771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f20fb8e8b284d2dd8ef9d869eb2425e1?s=128&d=identicon&r=PG&f=1", "display_name": "michal", "link": "https://stackoverflow.com/users/6198771/michal"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1460971099, "post_id": 36604601, "comment_id": 60968260, "body": "I am sorry, &quot;mea culpa&quot;, never again. But, against all odds  any advice?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6200252, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ngz0g.jpg?s=128&g=1", "display_name": "Amar", "link": "https://stackoverflow.com/users/6200252/amar"}, "is_accepted": false, "score": -2, "last_activity_date": 1460824470, "last_edit_date": 1460824470, "creation_date": 1460742789, "answer_id": 36653819, "question_id": 36604601, "link": "https://stackoverflow.com/questions/36604601/openssl-d2i-rsa-pubkey-resulting-in-segmentation-fault/36653819#36653819", "title": "OpenSSL d2i_RSA_PUBKEY resulting in Segmentation fault", "body": "<p>If you look closely the signature for d2i_RSA_PUBKEY()</p>\n\n<pre><code>RSA *d2i_RSA_PUBKEY(RSA **a, const unsigned char **pp, long length)\n</code></pre>\n\n<p>So why are you filling the first argument as 0 instead of NULL?</p>\n\n<p>Shouldn't it be something like this?</p>\n\n<pre><code>pub = d2i_RSA_PUBKEY(NULL, &amp;public_key_buf, size);\n</code></pre>\n\n<p>Let me know if this works?</p>\n"}], "owner": {"reputation": 99, "user_id": 6198771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f20fb8e8b284d2dd8ef9d869eb2425e1?s=128&d=identicon&r=PG&f=1", "display_name": "michal", "link": "https://stackoverflow.com/users/6198771/michal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 386, "favorite_count": 2, "answer_count": 1, "score": 0, "last_activity_date": 1460971184, "creation_date": 1460565567, "last_edit_date": 1460971184, "question_id": 36604601, "link": "https://stackoverflow.com/questions/36604601/openssl-d2i-rsa-pubkey-resulting-in-segmentation-fault", "title": "OpenSSL d2i_RSA_PUBKEY resulting in Segmentation fault", "body": "<p>My C program using <code>RSA_genarate_key()</code> function creates RSA public and private key. Then public key is saved in file after converted into DER format using <code>i2d_RSA_PUBKEY()</code>.</p>\n\n<p>File with public key seems to be ok </p>\n\n<pre><code>openssl rsa -in public.der -inform DER -pubin -text    //shows up as below\n\nPublic-Key: (2048 bit)\nModulus:\n   00:b5:99:9a:d3:7e:....\n    .......39:86:6b:ae:29\nExponent: 3 (0x3)\nwriting RSA key\n-----BEGIN PUBLIC KEY-----\nMIIBIDANBgkqhkiG9.............\n....................+1Y5lSk5hmuu\nKQIBAw==\n-----END PUBLIC KEY-----\n</code></pre>\n\n<p>Problem appears when I try to read it back and use it for encryption. Here is the code:</p>\n\n<pre><code>File* fp;\nRSA *pub=NULL;\nconst unsigned char* public_key_buf;\nint size;\nfp = fopen(\"public.der\",\"r\");\nfseek (fp , 0 , SEEK_END);\nsize = ftell (fp); \nsize = sizeof(char)*size;\nrewind (fp);\npublic_key_buf = malloc(size*sizeof(char));\nfread(&amp;public_key_buf,sizeof(char),size,fp);\n\npub = d2i_RSA_PUBKEY(0, &amp;public_key_buf, size);\n\nfclose(fp);\n</code></pre>\n\n<p>Running program results in <code>Segmentation fault</code></p>\n\n<p>Here is what gdb says:</p>\n\n<pre><code>Program received signal SIGSEGV, Segmentation fault.\n0x00007ffff7b0fe85 in ASN1_get_object ()\nfrom /lib/x86_64-linux-gnu/libcrypto.so.1.0.0\n(gdb) bt\n#0  0x00007ffff7b0fe85 in ASN1_get_object () from /lib/x86_64-linux-gnu/libcrypto.so.1.0.0\n#1  0x00007ffff7b05f30 in ?? () from /lib/x86_64-linux- gnu/libcrypto.so.1.0.0\n#2  0x00007ffff7b071ad in ASN1_item_ex_d2i () from /lib/x86_64-linux-gnu/libcrypto.so.1.0.0\n#3  0x00007ffff7b07914 in ASN1_item_d2i () from /lib/x86_64-linux-gnu/libcrypto.so.1.0.0\n#4  0x00007ffff7affa3e in d2i_PUBKEY () from /lib/x86_64-linux-gnu/libcrypto.so.1.0.0\n#5  0x00007ffff7affb14 in d2i_RSA_PUBKEY () from /lib/x86_64-linux-gnu/libcrypto.so.1.0.0\n#6  0x0000000000400daa in main () at rsa_1.c:99\n\n(gdb) p pub\n$1 = (RSA *) 0x0\n(gdb) p public_key_buf\n$2 = (const unsigned char **) 0x603250\n(gdb) p *public_key_buf\n$3 = (const unsigned char *) 0x9060d3020018230 &lt;error: Cannot access memory at address 0x9060d3020018230&gt;\n(gdb) p size\n$4 = 293\n</code></pre>\n\n<p>Any help, please. </p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1460565613, "post_id": 36604550, "comment_id": 60806198, "body": "How / why do you think they should be same?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1460571786, "post_id": 36604550, "comment_id": 60809967, "body": "Hmmm,  Try <code>char buf[10] = &quot;123&quot;; stringcat(buf, &amp;buf[1]); puts(buf);</code>"}], "answers": [{"tags": [], "owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "is_accepted": false, "score": 0, "last_activity_date": 1460565625, "creation_date": 1460565625, "answer_id": 36604623, "question_id": 36604550, "link": "https://stackoverflow.com/questions/36604550/string-concatenation-in-c-with-pointers/36604623#36604623", "title": "String Concatenation in C with Pointers", "body": "<pre><code>while(*save++) \n</code></pre>\n\n<p>First dereference save and compare that value to 0, then increment save.</p>\n\n<pre><code>while(*save !='\\0'){\n    save++;\n}\n</code></pre>\n\n<p>First dereference save, compare to 0 and only increment if non-zero.\nSee the difference?</p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 6199907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9893ad0e0b1ef356d7b7c5aca2aa115a?s=128&d=identicon&r=PG", "display_name": "Justin Stevens", "link": "https://stackoverflow.com/users/6199907/justin-stevens"}, "edited": false, "score": 0, "creation_date": 1460610996, "post_id": 36604624, "comment_id": 60825345, "body": "Yeah I think I had the idea of the two of them switched.  When I run     <code>char a[10]=&quot;hello&quot;; char b[10]=&quot;goodbye&quot;; stringcat(a,b); puts(a);</code> Then, a will contain: <code>&quot;hello\\0goodbye&quot;</code>, which will print out &quot;hello&quot; through puts, right?  On the other hand, through using ++save I gurantee that save will point to the null terminator at the end, to overwrite it?"}, {"owner": {"reputation": 19025, "user_id": 599792, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7ce404c8d35df762a599cb5173f18456?s=128&d=identicon&r=PG", "display_name": "Gareth McCaughan", "link": "https://stackoverflow.com/users/599792/gareth-mccaughan"}, "reply_to_user": {"reputation": 31, "user_id": 6199907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9893ad0e0b1ef356d7b7c5aca2aa115a?s=128&d=identicon&r=PG", "display_name": "Justin Stevens", "link": "https://stackoverflow.com/users/6199907/justin-stevens"}, "edited": false, "score": 0, "creation_date": 1460621010, "post_id": 36604624, "comment_id": 60830665, "body": "Right. I want to point out one other thing, though. <code>&quot;hello\\0goodbye\\0&quot;</code> (don&#39;t forget the final null character!) is 14 characters, so now you&#39;ve written past the end of array <code>a</code> and all sorts of bad things could happen. This is called a &quot;buffer overflow&quot;, it&#39;s a <i>really common</i> kind of error, and any time you&#39;re working with arrays and pointers in C you should be keeping it in mind and making sure it doesn&#39;t happen. It&#39;s a real pain and easy to get wrong."}], "tags": [], "owner": {"reputation": 19025, "user_id": 599792, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7ce404c8d35df762a599cb5173f18456?s=128&d=identicon&r=PG", "display_name": "Gareth McCaughan", "link": "https://stackoverflow.com/users/599792/gareth-mccaughan"}, "is_accepted": true, "score": 0, "last_activity_date": 1460565626, "creation_date": 1460565626, "answer_id": 36604624, "question_id": 36604550, "link": "https://stackoverflow.com/questions/36604550/string-concatenation-in-c-with-pointers/36604624#36604624", "title": "String Concatenation in C with Pointers", "body": "<p>If you make it <code>while (*save++) {}</code>, the operation you are repeating is: load byte, increment pointer, check whether byte was zero. Therefore, what will happen at the end of the string is: load null byte, increment pointer, check whether byte was zero, see it was, exit loop. So <code>save</code> will be pointing just after the null byte. But you want to start copying the second string <em>on top</em> of that null byte, not after it.</p>\n\n<p>(Is it possible that you have the meanings of <code>++save</code> and <code>save++</code> interchanged in your head? If so, here's a useful mnemonic: <code>++save</code> means increment, then load the value; <code>save++</code> means load the value, then increment. So the order in which the variable name and the <code>++</code> appear corresponds to the order of operations.)</p>\n"}], "owner": {"reputation": 31, "user_id": 6199907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9893ad0e0b1ef356d7b7c5aca2aa115a?s=128&d=identicon&r=PG", "display_name": "Justin Stevens", "link": "https://stackoverflow.com/users/6199907/justin-stevens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 36604624, "answer_count": 2, "score": 0, "last_activity_date": 1460565626, "creation_date": 1460565396, "question_id": 36604550, "link": "https://stackoverflow.com/questions/36604550/string-concatenation-in-c-with-pointers", "title": "String Concatenation in C with Pointers", "body": "<p>So this is the standard string concatenation code in C:</p>\n\n<pre><code>char *stringcat(char *dest, const char *src){\n    char *save=dest;\n    while(*save !='\\0'){\n        save++;\n    }\n    while(*src!='\\0'){\n        *save=*src;\n        save++;\n        src++;\n    }\n    *save='\\0';\n    return dest;\n}\n</code></pre>\n\n<p>My question is why when we replace the first while loop with the following:</p>\n\n<pre><code>while(*save++){};\n</code></pre>\n\n<p>It does not work, but, when replaced with:</p>\n\n<pre><code>while(*++save){};\n</code></pre>\n\n<p>It does work.  In the first two instances, save points to the null terminator at the end of dest at the end, which is then overwritten by the first character in src.  However, in the third instance, it seems like save will be pointing to the character <strong>after</strong> the null terminator, which is weird.  </p>\n"}, {"tags": ["c", "struct", "logic", "trie"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1460567124, "post_id": 36604498, "comment_id": 60807151, "body": "It is not clear what the logic/coding issues are. What are they??"}, {"owner": {"reputation": 105, "user_id": 5780315, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh6.googleusercontent.com/-Ild3Y-dstL4/AAAAAAAAAAI/AAAAAAAAANg/7LRrNEMzXuk/photo.jpg?sz=128", "display_name": "Sentience", "link": "https://stackoverflow.com/users/5780315/sentience"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1460567205, "post_id": 36604498, "comment_id": 60807204, "body": "I&#39;m having trouble with the logic/coding the remove and destroy functions in the trie.c."}], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 5780315, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh6.googleusercontent.com/-Ild3Y-dstL4/AAAAAAAAAAI/AAAAAAAAANg/7LRrNEMzXuk/photo.jpg?sz=128", "display_name": "Sentience", "link": "https://stackoverflow.com/users/5780315/sentience"}, "edited": false, "score": 0, "creation_date": 1460919259, "post_id": 36625200, "comment_id": 60951327, "body": "Thanks for this, it helped me a lot!"}], "tags": [], "owner": {"reputation": 9309, "user_id": 2963099, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/TtYW1.gif?s=128&g=1", "display_name": "Glenn Teitelbaum", "link": "https://stackoverflow.com/users/2963099/glenn-teitelbaum"}, "is_accepted": true, "score": 2, "last_activity_date": 1460641844, "creation_date": 1460641844, "answer_id": 36625200, "question_id": 36604498, "link": "https://stackoverflow.com/questions/36604498/remove-destroy-function-logic-struct-tries/36625200#36625200", "title": "Remove/Destroy Function logic (Struct/Tries)", "body": "<p>for Remove, you need to remove free'd pointers from the trie:</p>\n\n<pre><code>for (i = 0; i &lt; length; i++){\n    index = charToInt(tolower(word[i])); //not sure if this is necessary.\n    if (temp-&gt;child[i]-&gt;end == '/0'){\n        free(temp-&gt;child[i]);\n        temp-&gt;child[i]=0;  // lets not point to free'd elements\n    }\n}\n</code></pre>\n\n<p>For destroy - try recursion, roughly:</p>\n\n<pre><code>for (int i=ALPHA_MIN; i &lt; ALPHA_MAX; ++i)\n{\n    if (rootRef-&gt;child[i])\n    {\n         trie_destroy(rootRef-&gt;child[i]);\n    }\n}\n\nfree (rootRef);\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 5780315, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh6.googleusercontent.com/-Ild3Y-dstL4/AAAAAAAAAAI/AAAAAAAAANg/7LRrNEMzXuk/photo.jpg?sz=128", "display_name": "Sentience", "link": "https://stackoverflow.com/users/5780315/sentience"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 978, "favorite_count": 0, "accepted_answer_id": 36625200, "answer_count": 1, "score": 0, "last_activity_date": 1460641844, "creation_date": 1460565276, "question_id": 36604498, "link": "https://stackoverflow.com/questions/36604498/remove-destroy-function-logic-struct-tries", "title": "Remove/Destroy Function logic (Struct/Tries)", "body": "<p>I've been working on a Trie program for practice and i'm running into some logic/coding issues when it comes to trying to create a method that removes or destroys words that are currently in the trie:</p>\n\n<pre><code>#include \"trie.h\"\n/**************************************************************************/\n/* Helper Functions\n * trie_node_t * trie_new(  void );\n *         Allocates memory for a new trie node\n *         Returns NULL if memory allocation was not possible or\n *         a memory address to a trie_node in the heap\n/**************************************************************************/\ntrie_node_t * trie_new(  void ){\n    trie_node_t * tmp = NULL;\n    int i;\n    if ( ( tmp = ( trie_node_t * ) malloc ( sizeof( trie_node_t ) ) ) == NULL )\n    return NULL;\n    for( i = 0; i &lt; ALPHA_SIZE; i++ ) { \n        tmp-&gt;child[ i ] = NULL;\n        tmp-&gt;end = 1;\n    }\nreturn tmp;\n}\n/**************************************************************************/\n/* Functions functions       \n * int trie_size     ( trie_node_t *  root );\n *         Returns the number of words in the trie\n * int trie_contains ( trie_node_t *  root,    char word[ ] );\n *         Returns 1 if a the word is in the trie\n *                 0 otherwise\n * int trie_insert   ( trie_node_t ** rootRef, char word[ ] );\n *         Returns 1 if the word is inserted in the trie\n *                 0 otherwise\n * int trie_remove  ( trie_node_t ** rootRef, char word[ ] );\n *         Returns 1 if the word is removed from the trie\n *                 0 otherwise\n * int trie_destroy  ( trie_node_t ** Tref );\n *         Returns 1 if the trie and all its node are destroyed\n **************************************************************************/\nint trie_size     ( trie_node_t *  root ) {\n    int i = 0;\n    int count = 0;\n    trie_node_t *temp = root; //Creates a temp variable (Because its being modified)\n    //if the reference does not exist(no more children)\n    if (temp == NULL){\n    return EXIT_FAILURE;\n}\n//loops through the child array\nfor (i = 0; i &lt; ALPHA_SIZE; i++){\n    //if the reference to next child is not null\n    if(temp-&gt;child[i] != NULL){\n        //and the end character is '/0' (or not)\n        if(temp-&gt;child[i]-&gt;end == '/0'){\n            count += 1;\n        }\n        //add the return of trie_size to count, then run through the method again at the lower level.\n        count += trie_size(temp-&gt;child[i]);\n    }\n}\nreturn count;\n}\n/**************************************************************************/\nint trie_contains ( trie_node_t *  root,    char word[ ] ){\ntrie_node_t *temp = root; //Create a temp variable, can't use the default root. (just a location).\nint i = 0;\nint length = strlen(word); //finds the length of array\nint index = 0;\nif (temp ==  NULL){\n    return EXIT_FAILURE;\n}\nif(!valid_word(word)){\n    return 0;\n}\nfor (i = 0; i &lt; length; i++){\n    index = charToInt(tlower(word[i]));\n    if (!temp-&gt;child[index]){\n        return 0;\n    }\n    temp = temp-&gt;child[index];\n}\nif (temp-&gt;end != '/0'){ //Checks if the end character at the last index is '/0' if it is not, it is not a word. Return 0 (not found)\n    return 0;\n}\nreturn 1;\n}\n/**************************************************************************/\nint trie_insert   ( trie_node_t ** rootRef, char word[ ] ){\ntrie_node_t *temp = *rootRef; //Create a temp variable, can't use the default rootRef. (just a location).\nint i = 0;\nint length = strlen(word); //finds the length of array\nint index = 0;\nif (temp == NULL){ //checks that the reference is not null\n    return EXIT_FAILURE;\n}\nif (!valid_word(word)){//checks if word is valid.\n    return 0;\n}\nfor (i = 0; i &lt; length; i++){\n    if (word[i] == '/0'){\n        index = 26;\n    } else if (word[i] &gt;= 'A' || word[i] &lt;= 'Z'){\n        index = charToInt(tolower(word[i])); //turns the word[i] into a usable integer.\n    }\n    else {\n        return EXIT_FAILURE;\n    }\n    if (!temp-&gt;child[index]){ //if there is not a child reference.\n        temp-&gt;child[index] = trie_new(); //create one.\n    }\n    temp = temp-&gt;child[index]; //move down to next level (next child)\n}\ntemp-&gt;end = '\\0';\nreturn 1;\n}\n/**************************************************************************\n* I'm pretty sure the majority of this method is incorrect, this was just an attempt I had. From what I understand I have to do is this:\n* (1) Find the last character in the word (Found with the '/0' end char) and as long as there are no nodes connected at a lower level free the memory.\n* (2) Move up (recursion is probably the easiest way to do this, but I haven't been able to figure out how) and check again. \n* (3) Continue until the first letter of the word is reached, then exit.\n* My question is how do I check to see if another node is connected? Also what would be the format of the recursive call?\n**************************************************************************/\nvoid trie_remove  ( trie_node_t ** rootRef, char word[ ] ){\ntrie_node_t *temp = *rootRef;\nint i = 0;\nint index = 0;\nint length = strlen(word);\nif (temp == NULL){\n    return;\n}\nif (!valid_word(word)){\n    return;\n}\n//Code is incomplete, just an attempt.\nfor (i = 0; i &lt; length; i++){\n    index = charToInt(tolower(word[i])); //not sure if this is necessary.\n    if (temp-&gt;child[i]-&gt;end == '/0'){\n        free(temp-&gt;child[i]);\n    } \n\n}\nreturn;\n}\n/**************************************************************************/\nint trie_destroy  ( trie_node_t ** rootRef ){\n\n//issues with logic here, not exactly sure how to do this.\n\nreturn 1;\n}\n/**************************************************************************/\nint trie_init(trie_node_t **rootRef){\nif ( *rootRef ==  NULL) {\n    *rootRef = trie_new();\n}\nreturn 1;\n}\n/**************************************************************************/\nint valid_word (char word[]){\nint length = 0;\nint i = 0;\nfor (i = 0; i &lt; length; i++){\n    if(charToInt(word[i]) &gt; 26 || charToInt(word[i]) &lt; 0){\n        return 0;\n    }\n}\nreturn 1;\n}\n/**************************************************************************/\nint charToInt(char c){\nreturn (int)c-(int)'a';\n}\n</code></pre>\n\n<p>Trie.h: (Important stuff anyways) ALPHA_SIZE is 27.</p>\n\n<pre><code>typedef struct trie_node {\n    char end;\n    struct trie_node *child[ ALPHA_SIZE ]; //reference to trie node.\n}trie_node_t;\n</code></pre>\n\n<p>I hope I formatted this question correctly, and I have looked on the site for possible solutions already but have yet to find any. If anyone can help me check my logic/ assist me in the coding of these methods that would be amazing. I don't just want the code I want to learn why it works!</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c", "list", "linked-list", "crash"], "comments": [{"owner": {"reputation": 337, "user_id": 6156951, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/JAW7u.jpg?s=128&g=1", "display_name": "Mr.Toxy", "link": "https://stackoverflow.com/users/6156951/mr-toxy"}, "edited": false, "score": 0, "creation_date": 1460565564, "post_id": 36604477, "comment_id": 60810841, "body": "In debug mode have you guaranteed that the head doesnt loose its reference? Does it give you any errors? if yes post it/them. or it just crahshes on you instantly?"}, {"owner": {"reputation": 57, "user_id": 4384866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81ffcf4a0486c1ab2b82f42a630d31a0?s=128&d=identicon&r=PG&f=1", "display_name": "alonpeer12345", "link": "https://stackoverflow.com/users/4384866/alonpeer12345"}, "reply_to_user": {"reputation": 337, "user_id": 6156951, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/JAW7u.jpg?s=128&g=1", "display_name": "Mr.Toxy", "link": "https://stackoverflow.com/users/6156951/mr-toxy"}, "edited": false, "score": 0, "creation_date": 1460565951, "post_id": 36604477, "comment_id": 60810842, "body": "crashes instantly- no errors"}, {"owner": {"reputation": 337, "user_id": 6156951, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/JAW7u.jpg?s=128&g=1", "display_name": "Mr.Toxy", "link": "https://stackoverflow.com/users/6156951/mr-toxy"}, "edited": false, "score": 0, "creation_date": 1460566168, "post_id": 36604477, "comment_id": 60810843, "body": "Never happened that to me while programming. I dont know of any error that would instantly crash VS Did you try to check the logs for troubleshooting?"}, {"owner": {"reputation": 57, "user_id": 4384866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81ffcf4a0486c1ab2b82f42a630d31a0?s=128&d=identicon&r=PG&f=1", "display_name": "alonpeer12345", "link": "https://stackoverflow.com/users/4384866/alonpeer12345"}, "reply_to_user": {"reputation": 337, "user_id": 6156951, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/JAW7u.jpg?s=128&g=1", "display_name": "Mr.Toxy", "link": "https://stackoverflow.com/users/6156951/mr-toxy"}, "edited": false, "score": 0, "creation_date": 1460566676, "post_id": 36604477, "comment_id": 60810844, "body": "no... it doesn&#39;t crash the actual VS, it crashes the c program"}], "answers": [{"tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1460565768, "creation_date": 1460565768, "answer_id": 36604678, "question_id": 36604477, "link": "https://stackoverflow.com/questions/36604477/deleting-linked-list-in-c-crash/36604678#36604678", "title": "Deleting linked list in c- crash", "body": "<p>The problem is that you are using more indirection than you need. The <code>temp</code> variable should be a pointer, not a pointer to pointer. Here is what happens when you do this:</p>\n\n<pre><code>// Temp points to the same pointer as ptr, so\ntemp = ptr;\n// when the value pointed to by ptr changes, so does the value pointed to by temp\n*ptr = (*ptr)-&gt;next;\n// When you free *temp, you also free *ptr\nfree(*temp);\n</code></pre>\n\n<p>Fixing this problem is simple: declare <code>temp</code> as <code>PItem</code>, and use it to make copies of <code>ptr</code>:</p>\n\n<pre><code>PItem temp;\nwhile (*ptr) { // Loop should proceed till *ptr is NULL, not (*ptr)-&gt;next\n    temp = *ptr; // Copy the pointer's value\n    *ptr = temp-&gt;next; // Advance *ptr\n    free(temp); // Delete temp, which points to the old *ptr\n}\n// tail is a pointer to a pointer, so you should add * to the assignment\n*tail = NULL;\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 4384866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81ffcf4a0486c1ab2b82f42a630d31a0?s=128&d=identicon&r=PG&f=1", "display_name": "alonpeer12345", "link": "https://stackoverflow.com/users/4384866/alonpeer12345"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1460573192, "creation_date": 1460565208, "question_id": 36604477, "link": "https://stackoverflow.com/questions/36604477/deleting-linked-list-in-c-crash", "title": "Deleting linked list in c- crash", "body": "<p>I'm trying to delete a list of PItem. This is the declaration of PItem</p>\n\n<pre><code>typedef struct Item{\n    int num;\n    float price;\n    struct Item* next;\n}*PItem;\n</code></pre>\n\n<p>This is the function where I try to delete the list</p>\n\n<pre><code>void deleteList(PItem* ptr, PItem *tail){\n    PItem *temp;\n    while ((*ptr)-&gt;next){\n        temp = ptr;\n        *ptr = (*ptr)-&gt;next;\n        free(*temp);\n    }\n    tail = NULL;\n}\n</code></pre>\n\n<p>The weird part is that it crashes only on the second run of the loop, before the </p>\n\n<pre><code>free(*temp);\n</code></pre>\n\n<p>Does anyone know what the problem is?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1964, "user_id": 1320881, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b69670b7cc6bce132f443eee557c9448?s=128&d=identicon&r=PG", "display_name": "Unimportant", "link": "https://stackoverflow.com/users/1320881/unimportant"}, "edited": false, "score": 1, "creation_date": 1460565320, "post_id": 36604462, "comment_id": 60806043, "body": "Just do a mini bubble sort: Compare x to y, move the biggest value to y, compare y to z, move the biggest value to z. Then compare x to y again and move the biggest to y."}], "answers": [{"tags": [], "owner": {"reputation": 20558, "user_id": 2864275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p2xKk.png?s=128&g=1", "display_name": "I\u0142ya Bursov", "link": "https://stackoverflow.com/users/2864275/i%c5%82ya-bursov"}, "is_accepted": true, "score": 1, "last_activity_date": 1460565731, "creation_date": 1460565731, "answer_id": 36604667, "question_id": 36604462, "link": "https://stackoverflow.com/questions/36604462/pointers-and-interchange-with-c/36604667#36604667", "title": "Pointers and interchange with C", "body": "<p>the simplest way is:</p>\n\n<pre><code>if (*x &gt; *y) {\n    temp = *x; // store value of x\n    *x = *y; // overwrite x with y\n    *y = temp; // overwrite y with x (which is in temp)\n}\n// now we sure that x &lt;= y\nif (*y &gt; *z) {\n    temp = *z;\n    *z = *y;\n    *y = temp;\n}\n// now we sure that x &lt;= z and y &lt;= z, but we don't know x/y relationships\nif (*x &gt; *y) {\n    temp = *x;\n    *x = *y;\n    *y = temp;\n}\n// now x &lt;= y &lt;= z\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "is_accepted": false, "score": 2, "last_activity_date": 1460565752, "creation_date": 1460565752, "answer_id": 36604673, "question_id": 36604462, "link": "https://stackoverflow.com/questions/36604462/pointers-and-interchange-with-c/36604673#36604673", "title": "Pointers and interchange with C", "body": "<p>Something like:</p>\n\n<pre><code>void swap(double* first, double* last){\n  double temp = *first;\n  *first = *last;\n  *last = temp;\n}\n\nvoid interchange(double * x, double * y, double * z){\n  if(*x &gt; *y) swap(x, y);\n  if(*y &gt; *z) swap(y, z);\n  if(*x &gt; *y) swap(x, y);\n}\n</code></pre>\n"}], "owner": {"reputation": 191, "user_id": 3247128, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/3dcd67c89befad90bb978d38f4bfdb65?s=128&d=identicon&r=PG&f=1", "display_name": "user3247128", "link": "https://stackoverflow.com/users/3247128/user3247128"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 36604667, "answer_count": 2, "score": 0, "last_activity_date": 1462612089, "creation_date": 1460565172, "last_edit_date": 1462612089, "question_id": 36604462, "link": "https://stackoverflow.com/questions/36604462/pointers-and-interchange-with-c", "title": "Pointers and interchange with C", "body": "<p>I have a general idea of how to do this, as you can see by the code I did below. The only problem I am having is finishing the interchange part. Basically, what I am trying to do is move the value of the lowest variable into the 1st variable, the second middle value to the 2nd variable, and the biggest to the 3rd variable.</p>\n\n<p>I know I do this with the interchange and using temp somehow, but how would I complete that, because with three values temp would get overridden somehow. What am I missing? So basically <code>a = 4.0, b = 7.0, c = 1.0</code>, <code>c (1.0)</code> needs to go into <code>a</code>, <code>a (4.0)</code> needs to go into <code>b</code>, and <code>b (7.0)</code> needs to go into <code>c</code>.\nThanks!</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nvoid interchange(double * x, double * y, double * z);\n\nint main(void)\n{\n  double a = 4.0, b = 7.0, c = 1.0;\n\n  printf_s(\"Originally a = %d, b = %d, and c = %d.\\n\", a, b, c);\n  interchange(&amp;a, &amp;b, &amp;c);\n  printf_s(\"Now, a =  %d, b = %d, and c = %d.\\n\", a, b, c);\n\n  return 0;\n\n}\n\nvoid interchange(double * x, double * y, double * z)\n{\n  double temp;\n\n  temp = *z;\n  *y = *z;\n  * = temp \n\n    // what am I missing here? I cant get my head around this above ^^^\n\n}\n</code></pre>\n\n<p>Thanks for the guidance!</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 9846, "user_id": 1745544, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/92a0f69d86d214e0cffceb76c6e3f09f?s=128&d=identicon&r=PG", "display_name": "OldProgrammer", "link": "https://stackoverflow.com/users/1745544/oldprogrammer"}, "edited": false, "score": 3, "creation_date": 1460564728, "post_id": 36604297, "comment_id": 60805626, "body": "Welcome to SO.  Please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>, and show your code."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1460565062, "post_id": 36604297, "comment_id": 60805866, "body": "<code>int dialnum[128] = { 0, 0, ... 2, 2, 2, 3, 3, 3, ... };</code> The first <code>2</code> is at <code>dialnum[&#39;A&#39;]</code> and the array can handle numeral values, lowercase, and special chars too."}, {"owner": {"reputation": 11, "user_id": 4010061, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c90b27398caba3ac7528a5af6638a6f8?s=128&d=identicon&r=PG&f=1", "display_name": "andy lie", "link": "https://stackoverflow.com/users/4010061/andy-lie"}, "edited": false, "score": 0, "creation_date": 1460565901, "post_id": 36604297, "comment_id": 60806377, "body": "thank you. lemme try this method."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1460568437, "post_id": 36604297, "comment_id": 60807973, "body": "Please note that this is a question and answer site, not a code writing service. If you <a href=\"https://stackoverflow.com/posts/36604297/edit\">edit</a> your question to describe what you have tried so far and where you are stuck, then we can try to help with specific problems. You should also read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>."}, {"owner": {"reputation": 11, "user_id": 4010061, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c90b27398caba3ac7528a5af6638a6f8?s=128&d=identicon&r=PG&f=1", "display_name": "andy lie", "link": "https://stackoverflow.com/users/4010061/andy-lie"}, "edited": false, "score": 0, "creation_date": 1460615767, "post_id": 36604297, "comment_id": 60827353, "body": "Im sorry, so here is what i am trying to do. instead of following weather vane method, i use switch statement. there is no compiling error, but my output result is weird."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4010061, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c90b27398caba3ac7528a5af6638a6f8?s=128&d=identicon&r=PG&f=1", "display_name": "andy lie", "link": "https://stackoverflow.com/users/4010061/andy-lie"}, "edited": false, "score": 0, "creation_date": 1460639356, "post_id": 36622547, "comment_id": 60844090, "body": "I assume that people will not press other key when they dial a number, that is why I did not make default case for othey key. It is bugging me that why is that the output is not right."}, {"owner": {"reputation": 11, "user_id": 4010061, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c90b27398caba3ac7528a5af6638a6f8?s=128&d=identicon&r=PG&f=1", "display_name": "andy lie", "link": "https://stackoverflow.com/users/4010061/andy-lie"}, "edited": false, "score": 0, "creation_date": 1460639932, "post_id": 36622547, "comment_id": 60844596, "body": "ah, i see what i did wrong here. thank you. let me edit my code"}, {"owner": {"reputation": 144, "user_id": 6019461, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ae370463f3a20799276da301afaa48f6?s=128&d=identicon&r=PG&f=1", "display_name": "Industrialactivity", "link": "https://stackoverflow.com/users/6019461/industrialactivity"}, "reply_to_user": {"reputation": 11, "user_id": 4010061, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c90b27398caba3ac7528a5af6638a6f8?s=128&d=identicon&r=PG&f=1", "display_name": "andy lie", "link": "https://stackoverflow.com/users/4010061/andy-lie"}, "edited": false, "score": 0, "creation_date": 1460656631, "post_id": 36622547, "comment_id": 60856525, "body": "I also changed <code>scanf_s</code> to <code>scanf</code>. I thought that was a typo as it would not compile for me with <code>scanf_s</code>. I just edited my answer to show the full program."}, {"owner": {"reputation": 144, "user_id": 6019461, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ae370463f3a20799276da301afaa48f6?s=128&d=identicon&r=PG&f=1", "display_name": "Industrialactivity", "link": "https://stackoverflow.com/users/6019461/industrialactivity"}, "reply_to_user": {"reputation": 11, "user_id": 4010061, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c90b27398caba3ac7528a5af6638a6f8?s=128&d=identicon&r=PG&f=1", "display_name": "andy lie", "link": "https://stackoverflow.com/users/4010061/andy-lie"}, "edited": false, "score": 0, "creation_date": 1460657133, "post_id": 36622547, "comment_id": 60856829, "body": "Ok i just found out that scanf_s is a windows function, <a href=\"https://msdn.microsoft.com/en-us/library/w40768et.aspx\" rel=\"nofollow noreferrer\">link</a> , which i why it would not compile for me, however with <code>scanf</code> it still works fine for me"}, {"owner": {"reputation": 11, "user_id": 4010061, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c90b27398caba3ac7528a5af6638a6f8?s=128&d=identicon&r=PG&f=1", "display_name": "andy lie", "link": "https://stackoverflow.com/users/4010061/andy-lie"}, "edited": false, "score": 0, "creation_date": 1460664509, "post_id": 36622547, "comment_id": 60861266, "body": "im using visual studio as my compiler, so when i use scanf, it will complle but it gives me warning, then when i run the code and get user input, once i enter the value, my program just quit and show error message"}], "tags": [], "owner": {"reputation": 144, "user_id": 6019461, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ae370463f3a20799276da301afaa48f6?s=128&d=identicon&r=PG&f=1", "display_name": "Industrialactivity", "link": "https://stackoverflow.com/users/6019461/industrialactivity"}, "is_accepted": false, "score": 0, "last_activity_date": 1460656768, "last_edit_date": 1460656768, "creation_date": 1460635495, "answer_id": 36622547, "question_id": 36604297, "link": "https://stackoverflow.com/questions/36604297/display-char-that-store-in-char-array-as-int-value/36622547#36622547", "title": "display char that store in char array as int value", "body": "<p>you forgot to tell it what to do with number inputs. You need to add more case statements, one for each number, like so:</p>\n\n<pre><code> #include&lt;stdio.h&gt;\n #include&lt;string.h&gt;\n #define num 11\n\n int main(void)\n{\n    char ch;\n    char number[11];\n    int i = 0;\n    int j = 0;\n\n    printf(\"please enter your phone number: \\n\");\n\n\n    for(i = 0; i &lt; num; i++)\n    {\n        scanf(\"%c\", &amp;ch); // changed from scanf_s() to scanf()\n\n        switch(ch)\n       {\n        case '0':\n            number[i] = 0;\n            break;\n\n        case '1':\n            number[i] = 1;\n            break;\n\n        case 'a': case 'b': case 'c':case '2':\n            number[i] = 2;\n            break;\n\n        case 'd': case 'e': case 'f': case '3':\n            number[i] = 3;\n            break;\n\n        case 'g': case 'h': case 'i': case '4':\n            number[i] = 4;\n            break;\n\n        case 'j': case 'k': case 'l': case '5':\n            number[i] = 5;\n            break;\n\n        case 'm': case 'n': case 'o': case '6':\n            number[i] = 6;\n            break;\n\n        case 'p': case 'q': case 'r': case 's': case '7':\n            number[i] = 7;\n            break;\n\n        case 't': case 'u': case 'v': case '8':\n            number[i] = 8;\n            break;\n\n        case 'w': case 'x': case 'y': case 'z': case '9':\n            number[i] = 9;\n            break;\n       }\n    }\n\n    printf(\"the phone number you enter is: \");\n\n    for(j = 0; j &lt; num; j++)\n    {\n        printf(\"%d\", number[j]);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>This compiled and ran correctly once the extra cases were entered. However you will also want to deal with inputs that are none of these, the best way would be to add</p>\n\n<pre><code>default: printf(\"Number/letter not entered\\n\"); break;\n</code></pre>\n\n<p>This will deal with things such as <code>.,#</code> etc</p>\n\n<p>Edited to show full program.</p>\n"}], "owner": {"reputation": 11, "user_id": 4010061, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c90b27398caba3ac7528a5af6638a6f8?s=128&d=identicon&r=PG&f=1", "display_name": "andy lie", "link": "https://stackoverflow.com/users/4010061/andy-lie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1460656768, "creation_date": 1460564623, "last_edit_date": 1460621805, "question_id": 36604297, "link": "https://stackoverflow.com/questions/36604297/display-char-that-store-in-char-array-as-int-value", "title": "display char that store in char array as int value", "body": "<p>I have problem with this problem.\nI have this assignment that I need to display character as numerical value.\nJust like hotline phone number, e.g call <code>1-800-the-best</code>. it will show all the letter as number.</p>\n\n<pre><code>abc = 2, def = 3, ghi = 4, jkl = 5, mno = 6, pqrs = 7, tuv = 8, wxyz = 9.\n</code></pre>\n\n<p>I try using <code>atoi</code>, but that will ignore the numerical character and only convert alphabetical character.</p>\n\n<p>Im using switch statement. there is no compiling error but somehow my output result is weird. here is my code </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n#define num 11\n\nint main(void)\n{\n    char ch;\n    char number[11];\n    int i = 0;\n    int j = 0;\n\n    printf(\"please enter your phone number: \\n\");\n\n\n    for(i = 0; i &lt; num; i++)\n    {\n        scanf_s(\"%c\", &amp;ch);\n\n        switch(ch)\n        {\n            case '0':\n                number[i] = 0;\n                break;\n\n            case '1':\n                number[i] = 1;\n                break;\n\n            case 'a': case 'b': case 'c':\n                number[i] = 2;\n                break;\n\n            case 'd': case 'e': case 'f':\n                number[i] = 3;\n                break;\n\n            case 'g': case 'h': case 'i':\n                number[i] = 4;\n                break;\n\n            case 'j': case 'k': case 'l':\n                number[i] = 5;\n                break;\n\n            case 'm': case 'n': case 'o':\n                number[i] = 6;\n                break;\n\n            case 'p': case 'q': case 'r': case 's':\n                number[i] = 7;\n                break;\n\n            case 't': case 'u': case 'v':\n                number[i] = 8;\n                break;\n\n            case 'w': case 'x': case 'y': case 'z':\n                number[i] = 9;\n                break;\n        }\n    }\n\n    printf(\"the phone number you enter is: \");\n\n    for(j = 0; j &lt; num; j++)\n    {\n        printf(\"%d\", number[j]);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>When i enter each char as numbers e.g: <code>1 2 3 4 5 6</code> the output result is </p>\n\n<blockquote>\n  <p>1-52-52-52-52-52-52-52-52-52-52-52.</p>\n</blockquote>\n\n<p>If I enter each char as alphabet e.g: <code>a b c d e f</code> the output result is</p>\n\n<blockquote>\n  <p>2-522-522-523-523-523.</p>\n</blockquote>\n\n<p>I wonder what I did wrong.</p>\n"}, {"tags": ["c", "parsing", "compiler-construction", "bison", "flex-lexer"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1460567700, "post_id": 36604267, "comment_id": 60807537, "body": "Your language is too complexfor us to quickly see where you made an error."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1460567987, "post_id": 36604267, "comment_id": 60807711, "body": "It seems your language does not allow an empty parameter list."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6199803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c5f9134825cca28b7a5c1e1ef08a495?s=128&d=identicon&r=PG&f=1", "display_name": "omar farooq", "link": "https://stackoverflow.com/users/6199803/omar-farooq"}, "edited": false, "score": 0, "creation_date": 1460657282, "post_id": 36605457, "comment_id": 60856922, "body": "Thank you so much for answering I have been dwelling over this for 3 days now the main reg expression was incorrect I removed it and ur right about debugging I dont really know anything other than printf ur answer was very helpful."}, {"owner": {"reputation": 11, "user_id": 6199803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c5f9134825cca28b7a5c1e1ef08a495?s=128&d=identicon&r=PG&f=1", "display_name": "omar farooq", "link": "https://stackoverflow.com/users/6199803/omar-farooq"}, "edited": false, "score": 0, "creation_date": 1460658581, "post_id": 36605457, "comment_id": 60857710, "body": "You mentioned many things not directly related to the question and I find them very helpful although I did not understand the things u said about the int type do u mean there&#39;s a problem in the flex file? also what should I do instead of yylval = *yytext? I plan on making a symbol table and also generating intermediate code for the machine."}], "tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": false, "score": 1, "last_activity_date": 1510945089, "last_edit_date": 1510945089, "creation_date": 1460568298, "answer_id": 36605457, "question_id": 36604267, "link": "https://stackoverflow.com/questions/36604267/syntax-error-in-language-parser-bison/36605457#36605457", "title": "Syntax Error in language parser Bison", "body": "<p>Your scanner ignores the \"keyword\" <code>main</code> (since it doesn't return anything).</p>\n\n<pre><code>\"main\"                  {printf(\"&lt;keyword, %s, %d&gt;\\n\", yytext,yylineno ); }\n</code></pre>\n\n<p>It's not clear to me why you would want <code>main</code> to be a keyword, since your grammar doesn't seem to allow functions whose names are not identifiers.</p>\n\n<hr>\n\n<p>Really, that scanner definition is full of problems, most of which are not relevant to this question. But you really should take a look at some example scanner definitions and (re-)read the flex manual. For a start, you would be well advised to use single-character tokens (<code>{</code> instead of <code>OPENINGBRACE</code>) which make both your scanner and your parser much more readable. But you need to take a careful look at a number of your scanner patterns, particularly the comment pattern and the string/character literal patterns. Your <code>ID</code> macro is <em>not</em> a single character, so the use of <code>{ID}+</code> in other patterns is certainly wrong (and results in a flex warning).</p>\n\n<p>Both <code>flex</code> and <code>bison</code> provide debugging trace features, which are much easier than filling your source code with <code>printf</code> statements. If you'd just used those traces, you would have immediately seen that the \"keyword\" <code>main</code> is not being sent to the parser. See the debugging sections of the <a href=\"http://westes.github.io/flex/manual//Debugging-Options.html\" rel=\"nofollow noreferrer\">flex manual</a> and the <a href=\"https://www.gnu.org/software/bison/manual/bison.html#Tracing\" rel=\"nofollow noreferrer\">bison manual</a>.</p>\n\n<p>And your grammar file looks like you're trying to write a grammar suitable for an LL(1) (recursive-descent) parser. That is totally unnecessary -- bison/yacc is an LALR(1) parser generator, which handles left-recursion just fine -- and makes your grammar much less readable. Consider the difference between the simple:</p>\n\n<pre><code>Prototype:     '(' ')'\n         |     '(' ParameterList ')'\nParameterList\n         :     ParameterDeclaration\n         |     ParameterList ',' ParameterDeclaration;\nParameterDeclaration\n         :     TypeSpecifier\n         |     TypeSpecifier Declarator\n</code></pre>\n\n<p>Finally, you'll need to fix your semantic value type; <code>yylval = *yytext</code> is very rarely useful. (It is not necessary to set <code>yylval</code> for a token which has no semantic value.) The default <code>int</code> type does not allow you to pass strings (identifiers or string literals) to your scanner, where they would probably be useful.</p>\n"}], "owner": {"reputation": 11, "user_id": 6199803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c5f9134825cca28b7a5c1e1ef08a495?s=128&d=identicon&r=PG&f=1", "display_name": "omar farooq", "link": "https://stackoverflow.com/users/6199803/omar-farooq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 322, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1510945089, "creation_date": 1460564541, "question_id": 36604267, "link": "https://stackoverflow.com/questions/36604267/syntax-error-in-language-parser-bison", "title": "Syntax Error in language parser Bison", "body": "<p>I have a lexer and parser for the c language but I dont understand why<br>\nthere is a syntax error for the given input </p>\n\n<p>this is the lexer file  </p>\n\n<pre><code>   %option yylineno\n%{\n#include \"y.tab.h\"\n#include &lt;stdio.h&gt;\n\n%}\n\nDIGIT   [0-9]+\nID  [a-zA-Z][a-zA-Z0-9_]*\n\n%%\n\"/*\"([^\\*\\n\\r]*) {printf(\"Non-terminated comments, Line Number: %d\\n\",yylineno);}\n[/*]+[/*][a-zA-Z0-9]*[*/]+[*/]  {printf(\"&lt;Comment, %s, %d&gt;\\n\", yytext,yylineno);}\n\"if\"                    {printf(\"&lt;keyword, %s, %d&gt;\\n\", yytext,yylineno); yylval = *yytext; return IF ;}\n\"else\"                  {printf(\"&lt;keyword, %s, %d&gt;\\n\", yytext,yylineno );yylval = *yytext; return ELSE;}\n\"for\"                   {printf(\"&lt;keyword, %s, %d&gt;\\n\", yytext,yylineno );yylval = *yytext; return FOR;}\n\"begin\"                 {printf(\"&lt;keyword, %s, %d&gt;\\n\", yytext,yylineno ); }\n\"end\"                   {printf(\"&lt;keyword, %s, %d&gt;\\n\", yytext,yylineno ); }\n\"procedure\"             {printf(\"&lt;keyword, %s, %d&gt;\\n\", yytext,yylineno ); }\n\"function\"              {printf(\"&lt;keyword, %s, %d&gt;\\n\", yytext,yylineno ); }\n\"void\"                  {printf(\"&lt;keyword, %s, %d&gt;\\n\", yytext,yylineno );yylval = *yytext; return VOID;}\n\"main\"                  {printf(\"&lt;keyword, %s, %d&gt;\\n\", yytext,yylineno ); }\n\"int\"                   {printf(\"&lt;keyword, %s, %d&gt;\\n\", yytext,yylineno );yylval = *yytext; return INT;}\n\"float\"                 {printf(\"&lt;keyword, %s, %d&gt;\\n\", yytext,yylineno );yylval = *yytext; return FLOAT;}\n\"printf\"                {printf(\"&lt;keyword, %s, %d&gt;\\n\", yytext,yylineno ); }\n\"while\"                 {printf(\"&lt;keyword, %s, %d&gt;\\n\", yytext,yylineno );yylval = *yytext; return WHILE;}\n\"char\"                  {printf(\"&lt;keyword, %s, %d&gt;\\n\", yytext,yylineno );yylval = *yytext; return CHAR;}\n\"switch\"                {printf(\"&lt;keyword, %s, %d&gt;\\n\", yytext,yylineno );yylval = *yytext; return SWITCH;}\n\"case\"                  {printf(\"&lt;keyword, %s, %d&gt;\\n\", yytext,yylineno );yylval = *yytext; return CASE;}\n\"default\"               {printf(\"&lt;keyword, %s, %d&gt;\\n\", yytext,yylineno );yylval = *yytext; return DEFAULT;}\n\"break\"                 {printf(\"&lt;keyword, %s, %d&gt;\\n\", yytext,yylineno );yylval = *yytext; return BREAK;}\n\"do\"                    {printf(\"&lt;keyword, %s, %d&gt;\\n\", yytext,yylineno );yylval = *yytext; return DO;}\n\"continue\"              {printf(\"&lt;keyword, %s, %d&gt;\\n\", yytext,yylineno ); yylval = *yytext;return CONTINUE;}\n\"return\"                {printf(\"&lt;keyword, %s, %d&gt;\\n\", yytext,yylineno ); yylval = *yytext;return RETURN;}\n\"+\"                 {printf(\"&lt;operator, %s, %d&gt;\\n\", yytext,yylineno );yylval = *yytext;return ADD;}\n\"-\"                 {printf(\"&lt;operator, %s, %d&gt;\\n\", yytext,yylineno );yylval = *yytext;return SUBTRACT;}\n\"*\"                 {printf(\"&lt;operator, %s, %d&gt;\\n\", yytext,yylineno );yylval = *yytext;return MULTIPLY;}\n\"/\"                 {printf(\"&lt;operator, %s, %d&gt;\\n\", yytext,yylineno );yylval = *yytext;return DIVIDE;}\n\"&lt;\"                 {printf(\"&lt;operator, %s, %d&gt;\\n\", yytext,yylineno );yylval = *yytext;return LESSTHAN;}\n\"&gt;\"                 {printf(\"&lt;operator, %s, %d&gt;\\n\", yytext,yylineno );yylval = *yytext;return GREATERTHAN;}\n\"++\"                    {printf(\"&lt;operator, %s, %d&gt;\\n\", yytext,yylineno );yylval = *yytext;return INCREMENT;}\n\"--\"                    {printf(\"&lt;operator, %s, %d&gt;\\n\", yytext,yylineno );yylval = *yytext;return DECREMENT;}\n\"=\"                 {printf(\"&lt;operator, %s, %d&gt;\\n\", yytext,yylineno );yylval = *yytext;return ASSIGN;}\n\"==\"                    {printf(\"&lt;operator, %s, %d&gt;\\n\", yytext,yylineno );yylval = *yytext;return ISEQUALTO;}\n\"&gt;=\"                    {printf(\"&lt;operator, %s, %d&gt;\\n\", yytext,yylineno );yylval = *yytext;return GREATERTHANEQUALTO;}\n\"&lt;=\"                    {printf(\"&lt;operator, %s, %d&gt;\\n\", yytext,yylineno );yylval = *yytext;return LESSTHANEQUALTO;}\n\"%\"                 {printf(\"&lt;operator, %s, %d&gt;\\n\", yytext,yylineno );yylval = *yytext;return MODULUS;}\n\"!=\"                    {printf(\"&lt;operator, %s, %d&gt;\\n\", yytext,yylineno );yylval = *yytext;return ISNOTEQUALTO;}\n\"+=\"                    {printf(\"&lt;operator, %s, %d&gt;\\n\", yytext,yylineno );yylval = *yytext;return ADDANDASSIGN;}\n\"-=\"                    {printf(\"&lt;operator, %s, %d&gt;\\n\", yytext,yylineno );yylval = *yytext;return SUBTRACTANDASSIGN;}\n\"*=\"                    {printf(\"&lt;operator, %s, %d&gt;\\n\", yytext,yylineno );yylval = *yytext;return MULTIPLYANDASSIGN;}\n\"/=\"                    {printf(\"&lt;operator, %s, %d&gt;\\n\", yytext,yylineno );yylval = *yytext;return DIVIDEANDASSIGN;}\n\"%=\"                    {printf(\"&lt;operator, %s, %d&gt;\\n\", yytext,yylineno );yylval = *yytext;return MODULUSANDASSIGN;}\n\"?:\"                    {printf(\"&lt;operator, %s, %d&gt;\\n\", yytext,yylineno );yylval = *yytext;return CONDITIONALOPERATOR;}\n\",\"                 {printf(\"&lt;Comma, %s, %d&gt;\\n\", yytext,yylineno );yylval = *yytext;return COMMA;}\n\";\"                 {printf(\"&lt;Terminator, %s, %d&gt;\\n\", yytext,yylineno );yylval = *yytext;return ENDOFSTATEMENT;}\n\":\"                 {printf(\"&lt;Colon, %s, %d&gt;\\n\", yytext,yylineno );yylval = *yytext;return COLON;}\n\"(\"                 {printf(\"&lt;OpeningRoundBracket, %s, %d&gt;\\n\", yytext,yylineno );return OPENINGROUND;}\n\")\"                 {printf(\"&lt;ClosingRoundBracket, %s, %d&gt;\\n\", yytext,yylineno );return CLOSINGROUND;}\n\"{\"                 {printf(\"&lt;OpeningCurlyBracket, %s, %d&gt;\\n\", yytext,yylineno );yylval = *yytext;return OPENINGBRACE;}\n\"}\"                 {printf(\"&lt;ClosingCurlyBracket, %s, %d&gt;\\n\", yytext,yylineno );yylval = *yytext;return CLOSINGBRACE;}\n\"[\"                 {printf(\"&lt;OpeningSquareBracket, %s, %d&gt;\\n\", yytext,yylineno );yylval = *yytext;return OPENINGSQUARE;}\n\"]\"                     {printf(\"&lt;ClosingSquareBracket, %s, %d&gt;\\n\", yytext,yylineno );yylval = *yytext;return CLOSINGSQUARE;}\n[*]+{ID}+               {printf(\"&lt;Pointer, %s, %d&gt;\\n\", yytext,yylineno);}\n{DIGIT}+                    {printf(\"&lt;INTEGER, %s, %d&gt;\\n\", yytext,yylineno);yylval = atoi(yytext);return INTEGER;}\n{DIGIT}+\".\"{DIGIT}*             {printf(\"&lt;FLOAT, %s, %d&gt;\\n\", yytext,yylineno);yylval = atoi(yytext);return INTEGER ;}\n[\"]+{ID}*[ ]*[:]*[;]*[(]*[)]*{ID}*[\"]+  {printf(\"&lt;STRING, %s, %d&gt;\\n\", yytext,yylineno);yylval = atoi(yytext);return REAL ;}\n[']{ID}[']              {printf(\"&lt;CHAR, %s, %d&gt;\\n\", yytext,yylineno);yylval = *yytext;return CHARACTER ;}\n[']{ID}{ID}+[']             {printf(\"CHAR constant too long: %s, Line Number: %d\\n\", yytext,yylineno);}\n{ID}+                       {printf(\"&lt;Identifier, %s, %d&gt;\\n\", yytext,yylineno ); yylval = *yytext; return IDENTIFIER ;}\n\" \"                 ;{printf(\"Space\");}/* eat up whitespace */\n\"\\t\"                    ;/* eat up whitespace */\n\"\\n\"                ;/* eat up whitespace */\n\"#\"                 {printf(\"Undefined Symbol: %s, Line Number: %d&gt;\\n\", yytext,yylineno );}\n\"~\"                 {printf(\"Undefined Symbol: %s, Line Number: %d&gt;\\n\", yytext,yylineno );}\n.                       printf( \"Undefined Symbol: %s, %d\\n\",yytext,yylineno );\n%%\n\n\nint yywrap(){\n    return 1;\n}\n</code></pre>\n\n<p>The parser .y file </p>\n\n<pre><code>%{\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\nvoid yyerror();\n\nFILE *f;\n%} \n\n%token IF \n%token ELSE \n%token FOR \n%token VOID \n%token INT \n%token FLOAT \n%token WHILE \n%token CHAR \n%token SWITCH \n%token CASE \n%token DEFAULT \n%token BREAK\n%token DO\n%token CONTINUE\n%token RETURN\n%token ADD\n%token SUBTRACT\n%token MULTIPLY\n%token DIVIDE\n%token MODULUS\n%token LESSTHAN\n%token GREATERTHAN\n%token INCREMENT\n%token DECREMENT\n%token ASSIGN\n%token ISEQUALTO\n%token GREATERTHANEQUALTO\n%token LESSTHANEQUALTO\n%token ISNOTEQUALTO\n%token ADDANDASSIGN\n%token SUBTRACTANDASSIGN\n%token MULTIPLYANDASSIGN\n%token DIVIDEANDASSIGN\n%token MODULUSANDASSIGN\n%token CONDITIONALOPERATOR\n%token ENDOFSTATEMENT\n%token COMMA\n%token COLON\n%token OPENINGROUND\n%token CLOSINGROUND\n%token OPENINGSQUARE\n%token CLOSINGSQUARE\n%token OPENINGBRACE\n%token CLOSINGBRACE\n%token INTEGER\n%token REAL\n%token CHARACTER\n%token IDENTIFIER\n%start TransitionUnit\n%%\n\nTransitionUnit : ExternalDeclaration TransitionUnit_a;\n\nTransitionUnit_a : ExternalDeclaration TransitionUnit_a  \n| /* NULL */\n;\n\nExternalDeclaration : FunctionDefinition\n|Declaration ENDOFSTATEMENT\n;\n\nFunctionDefinition : TypeSpecifier Declarator FunctionDefinition_a\n|Declarator FunctionDefinition_b\n;\n\nFunctionDefinition_a : DeclarationList CompoundStatement\n                        |CompoundStatement;\n\nFunctionDefinition_b : DeclarationList CompoundStatement\n                    |CompoundStatement\n;\n\nTypeSpecifier : VOID  \n|CHAR \n|INT \n|FLOAT\n;\n\nDeclarator : DirectDeclarator \n            |    Pointer DirectDeclarator;\n\nDirectDeclarator : IDENTIFIER DirectDeclarator_a;\n\nDirectDeclarator_a : OPENINGROUND DirectDeclarator_b \n                    |OPENINGSQUARE DirectDeclarator_c\n                    |/* NULL */\n                    ;\n\nDirectDeclarator_b : Declarator CLOSINGROUND DirectDeclarator_a\n                    |ParameterList CLOSINGROUND DirectDeclarator_a \n                    |CLOSINGROUND DirectDeclarator_a\n                    ;\n\nDirectDeclarator_c : CLOSINGSQUARE DirectDeclarator_a\n|INT CLOSINGSQUARE DirectDeclarator_a\n;\n\nPointer : MULTIPLY Pointer_a\n;\n\nPointer_a : Pointer \n|/* NULL */\n;\n\nDeclarationList : Declaration ENDOFSTATEMENT DeclarationList_a\n;\n\nDeclarationList_a : Declaration ENDOFSTATEMENT DeclarationList_a \n|/* NULL */\n;\n\nDeclaration : TypeSpecifier Declaration_a;\n\nDeclaration_a : InitDeclaratorList \n|/* NULL */\n;\n\nInitDeclaratorList : InitDeclarator InitDeclaratorList_a\n;\n\nInitDeclaratorList_a : COMMA InitDeclarator InitDeclaratorList_a \n|/* NULL */\n;\n\nInitDeclarator : Declarator InitDeclarator_a\n;\n\nInitDeclarator_a : ASSIGN Initializer \n|/* NULL */\n;\n\nInitializer : Constant\n| OPENINGBRACE InitializerList Initializer_a\n;\n\nInitializer_a : CLOSINGBRACE\n|COMMA CLOSINGBRACE\n;\n\nInitializerList : Initializer InitializerList_a\n;\n\nInitializerList_a : COMMA Initializer InitializerList_a \n|/* NULL */\n;\n\nParameterList : ParameterDeclaration ParameterList_a;\n\nParameterList_a : COMMA ParameterDeclaration ParameterList_a \n|/* NULL */\n;\n\nParameterDeclaration : TypeSpecifier ParameterDeclaration_a;\n\nParameterDeclaration_a : Declarator \n|/* NULL */;\n\nCompoundStatement : OPENINGBRACE CompoundStatement_a;\n\nCompoundStatement_a : CLOSINGBRACE\n|StatementList CLOSINGBRACE\n|DeclarationList CompoundStatement_b\n;\n\nCompoundStatement_b : StatementList CLOSINGBRACE\n|CLOSINGBRACE\n;\n\nStatementList : Statement StatementList_a;\n\nStatementList_a : Statement StatementList_a \n|/* NULL */\n;\n\nStatement : LabeledStatement\n|CompoundStatement\n|ExpressionStatement\n|SelectionStatement\n|IterationStatement\n|JumpStatement;\n\nLabeledStatement : CASE Constant COLON Statement\n|DEFAULT COLON Statement;\n\n\nExpressionStatement : ENDOFSTATEMENT\n|Expression ENDOFSTATEMENT\n;\n\nSelectionStatement : IF OPENINGROUND Expression CLOSINGROUND Statement SelectionStatement_a\n|SWITCH OPENINGROUND Expression CLOSINGROUND Statement;\n\nSelectionStatement_a : ELSE Statement \n|/* NULL */\n;\n\nJumpStatement : CONTINUE ENDOFSTATEMENT\n|BREAK ENDOFSTATEMENT\n|RETURN JumpStatement_a\n;\n\nJumpStatement_a : Expression ENDOFSTATEMENT;\n\nIterationStatement : WHILE OPENINGROUND Expression CLOSINGROUND Statement\n|DO Statement WHILE OPENINGROUND Expression CLOSINGROUND ENDOFSTATEMENT\n|FOR OPENINGROUND Expression ENDOFSTATEMENT Expression ENDOFSTATEMENT Expression CLOSINGROUND Statement\n;\n\nConditionalExpression : EqualityExpression ConditionalExpression_a;\n\nConditionalExpression_a : CONDITIONALOPERATOR Expression COLON ConditionalExpression \n| \n;\n\nExpression : AssignmentExpression Expression_a;\n\nExpression_a : COMMA AssignmentExpression Expression_a \n| \n;\n\nAssignmentExpression : ConditionalExpression\n|UnaryExpression AssignmentOperator AssignmentExpression;\n\nEqualityExpression : RelationalExpression EqualityExpression_a;\n\nEqualityExpression_a : ISEQUALTO RelationalExpression EqualityExpression_a '\\n'\n|ISNOTEQUALTO RelationalExpression EqualityExpression_a\n| \n;\n\nRelationalExpression : AdditiveExpression RelationalExpression_a;\n\nRelationalExpression_a : LESSTHAN AdditiveExpression RelationalExpression_a '\\n'\n|GREATERTHAN AdditiveExpression RelationalExpression_a\n|LESSTHANEQUALTO AdditiveExpression RelationalExpression_a\n|GREATERTHANEQUALTO AdditiveExpression RelationalExpression_a\n| \n;\n\nAdditiveExpression : MultiplicativeExpression AdditiveExpression_a;\n\nAdditiveExpression_a : ADD MultiplicativeExpression AdditiveExpression_a '\\n'\n|SUBTRACT MultiplicativeExpression AdditiveExpression_a\n|\n;\n\nMultiplicativeExpression : UnaryExpression MultiplicativeExpression_a;\n\nMultiplicativeExpression_a : MULTIPLY UnaryExpression MultiplicativeExpression_a '\\n'\n| DIVIDE UnaryExpression MultiplicativeExpression_a\n| MODULUS UnaryExpression MultiplicativeExpression_a\n| \n;\n\nAssignmentOperator : ASSIGN\n| ADDANDASSIGN\n| SUBTRACTANDASSIGN\n| MULTIPLYANDASSIGN\n| DIVIDEANDASSIGN\n| MODULUSANDASSIGN\n;\n\nConstant : INTEGER\n| CHARACTER\n| REAL\n;\n\nUnaryExpression : PostFixExpression\n| INCREMENT UnaryExpression\n| DECREMENT UnaryExpression\n;\n\nPostFixExpression : PrimaryExpression PostFixExpression_a;\n\nPostFixExpression_a : OPENINGSQUARE Expression CLOSINGSQUARE PostFixExpression_a '\\n'\n| OPENINGROUND PostFixExpression_b\n| INCREMENT PostFixExpression_a\n| DECREMENT PostFixExpression_a\n|\n;\n\nPostFixExpression_b : ArgumentExpressionList CLOSINGROUND PostFixExpression_a\n| CLOSINGROUND PostFixExpression_a\n;\n\nArgumentExpressionList : AdditiveExpression ArgumentExpressionList_a;\n\nArgumentExpressionList_a : COMMA AdditiveExpression ArgumentExpressionList_a '\\n'\n| \n;\n\nPrimaryExpression : IDENTIFIER { fprintf(f, \"Got an %s\",yylval);}\n| Constant\n;\n%%\n\nvoid yyerror(char *s){\n    extern int yylineno;\n    printf(\"%s at line no. %d\",s,yylineno);\n}\n\nint main(){\n    extern FILE *yyin;\n    yyin = fopen(\"input.txt\",\"r\");\n\n    f = fopen(\"output.txt\",\"w\");\n    fprintf(f,\"Adha Hogaya\");\n    yyparse();\n\n    return 1;\n}\n</code></pre>\n\n<p>The input file which is to be parsed   </p>\n\n<pre><code>int i;\nint a;\nvoid main(){\n}\n</code></pre>\n\n<p>The code parses fine until the '(' after which it displays a<br>\nsyntax error. I do not understand what is the problem some help would<br>\nbe appreciated  </p>\n\n<p>the code is compiled through the following commands  </p>\n\n<pre><code>flex 'filename'.l  \nbison -dy 'filename'.y  \ngcc lex.yy.c y.tab.c -o 'filename'.exe\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 2, "creation_date": 1460564227, "post_id": 36603991, "comment_id": 60805227, "body": "Please post a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1460564427, "post_id": 36603991, "comment_id": 60805381, "body": "If the record is found at the first node, &#39;prev&#39; is uninitialized?"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1460564564, "post_id": 36603991, "comment_id": 60805491, "body": "Also............debugger."}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 4415109, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8795bccef722126fe96ab9bdd219b3c5?s=128&d=identicon&r=PG&f=1", "display_name": "G&#225;bor Micsk&#243;", "link": "https://stackoverflow.com/users/4415109/g%c3%a1bor-micsk%c3%b3"}, "edited": false, "score": 0, "creation_date": 1460566826, "post_id": 36604634, "comment_id": 60806953, "body": "I see. But how can I fix the linkage?"}, {"owner": {"reputation": 19, "user_id": 6198780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0bc4f1ab8751ed5d1ca666af5643383?s=128&d=identicon&r=PG&f=1", "display_name": "thebworld", "link": "https://stackoverflow.com/users/6198780/thebworld"}, "reply_to_user": {"reputation": 79, "user_id": 4415109, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8795bccef722126fe96ab9bdd219b3c5?s=128&d=identicon&r=PG&f=1", "display_name": "G&#225;bor Micsk&#243;", "link": "https://stackoverflow.com/users/4415109/g%c3%a1bor-micsk%c3%b3"}, "edited": false, "score": 0, "creation_date": 1460566971, "post_id": 36604634, "comment_id": 60807037, "body": "If you want to append the new node in the end, before append traverse the entire list so that prev will always point to last node."}, {"owner": {"reputation": 79, "user_id": 4415109, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8795bccef722126fe96ab9bdd219b3c5?s=128&d=identicon&r=PG&f=1", "display_name": "G&#225;bor Micsk&#243;", "link": "https://stackoverflow.com/users/4415109/g%c3%a1bor-micsk%c3%b3"}, "edited": false, "score": 0, "creation_date": 1460567256, "post_id": 36604634, "comment_id": 60807237, "body": "Traverse with for ( ; llist-&gt;next != NULL; llist = llist-&gt;next) ; right after this llist -&gt; next= NULL; code?"}, {"owner": {"reputation": 19, "user_id": 6198780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0bc4f1ab8751ed5d1ca666af5643383?s=128&d=identicon&r=PG&f=1", "display_name": "thebworld", "link": "https://stackoverflow.com/users/6198780/thebworld"}, "reply_to_user": {"reputation": 79, "user_id": 4415109, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8795bccef722126fe96ab9bdd219b3c5?s=128&d=identicon&r=PG&f=1", "display_name": "G&#225;bor Micsk&#243;", "link": "https://stackoverflow.com/users/4415109/g%c3%a1bor-micsk%c3%b3"}, "edited": false, "score": 0, "creation_date": 1460567626, "post_id": 36604634, "comment_id": 60807492, "body": "llist = prev ; for ( ; llist-&gt;next != NULL; llist = llist-&gt;next)    {       prev = llist;    }"}, {"owner": {"reputation": 79, "user_id": 4415109, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8795bccef722126fe96ab9bdd219b3c5?s=128&d=identicon&r=PG&f=1", "display_name": "G&#225;bor Micsk&#243;", "link": "https://stackoverflow.com/users/4415109/g%c3%a1bor-micsk%c3%b3"}, "edited": false, "score": 0, "creation_date": 1460567867, "post_id": 36604634, "comment_id": 60807646, "body": "Unfortunately, that did the same thing. :("}, {"owner": {"reputation": 19, "user_id": 6198780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0bc4f1ab8751ed5d1ca666af5643383?s=128&d=identicon&r=PG&f=1", "display_name": "thebworld", "link": "https://stackoverflow.com/users/6198780/thebworld"}, "reply_to_user": {"reputation": 79, "user_id": 4415109, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8795bccef722126fe96ab9bdd219b3c5?s=128&d=identicon&r=PG&f=1", "display_name": "G&#225;bor Micsk&#243;", "link": "https://stackoverflow.com/users/4415109/g%c3%a1bor-micsk%c3%b3"}, "edited": false, "score": 0, "creation_date": 1460596367, "post_id": 36604634, "comment_id": 60821077, "body": "edited the previous code for last statement: llist = prev ; for ( ; llist-&gt;next != NULL; llist = llist-&gt;next) { prev = llist; }prev=llist;"}], "tags": [], "owner": {"reputation": 19, "user_id": 6198780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0bc4f1ab8751ed5d1ca666af5643383?s=128&d=identicon&r=PG&f=1", "display_name": "thebworld", "link": "https://stackoverflow.com/users/6198780/thebworld"}, "is_accepted": false, "score": 1, "last_activity_date": 1460568194, "last_edit_date": 1460568194, "creation_date": 1460565656, "answer_id": 36604634, "question_id": 36603991, "link": "https://stackoverflow.com/questions/36603991/append-problems-after-a-linked-list-node-delete/36604634#36604634", "title": "Append problems after a linked list node delete", "body": "<p>Lets take your example of <code>A-B-C</code>. From the first loop, prev will be <code>A</code> once it deletes the node <code>B</code>:</p>\n\n<pre><code>for ( ; llist-&gt;next != NULL; llist = llist-&gt;next) \n\n{\n\nif(strcmp(text, llist-&gt;book)==0){\n    break;\n}\nprev = llist;\n\n}\n</code></pre>\n\n<p>After that when it comes to append it is updating  with:</p>\n\n<pre><code>if(head){\n    prev-&gt;next= llist;\n} \n</code></pre>\n\n<p>which means <code>A</code>'s next will point to <code>D</code> instead of <code>C</code>. Hence <code>C</code>'s reference is lost and final list will look like <code>A-D</code>.</p>\n"}], "owner": {"reputation": 79, "user_id": 4415109, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8795bccef722126fe96ab9bdd219b3c5?s=128&d=identicon&r=PG&f=1", "display_name": "G&#225;bor Micsk&#243;", "link": "https://stackoverflow.com/users/4415109/g%c3%a1bor-micsk%c3%b3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1460568194, "creation_date": 1460563753, "last_edit_date": 1460564616, "question_id": 36603991, "link": "https://stackoverflow.com/questions/36603991/append-problems-after-a-linked-list-node-delete", "title": "Append problems after a linked list node delete", "body": "<p>I can append, display, modify, delete and search in my linked list nodes. Deleting works well, but when I want to append after that, it seems to overwrite (or delete a node).</p>\n\n<p>Lets say I have:</p>\n\n<p>A - B - C nodes</p>\n\n<p>I delete the B node. After that it looks like: A - C.\nI want to append a D node to look like this: A - C - D.</p>\n\n<p>But, instead it looks like this: A - D</p>\n\n<p>What could be the problem here?</p>\n\n<p>The whole project is pretty big, but the delete look like this: </p>\n\n<pre><code>    for ( ; llist-&gt;next != NULL; llist = llist-&gt;next)\n   {\n      if(strcmp(text, llist-&gt;book)==0)\n      {\n         break;\n      }\n      prev = llist;\n   }\n\n    if ( llist != NULL )\n     {\n      if ( llist == head)\n      {\n         head = llist-&gt;next;\n      }\n      else\n      {\n         prev-&gt;next= llist-&gt;next;\n      }\n\n      free(llist);\n      printf(\"The %s string has been deleted!\\n\", text);\n    }   \n</code></pre>\n\n<p>The append code looks like this:</p>\n\n<pre><code> while(getline(text,MAX)) \n\n    {\n\n    if(!(llist = (struct lib*)malloc(sizeof(struct lib)))) { /*mem allocation*/\n            break;\n        }\n\n        if(head) {\n            prev-&gt;next= llist;\n        } else {\n            head= llist;\n        }\n        prev = llist;\n\n    llist -&gt; next= NULL;\n\n\n    while(!textcheck(text))\n    {\n    printf(\"Please retype the name in the correct format: \");\n    getline(text, MAX);\n    }\n\n    strcpy(llist-&gt;author, text); //hozz\u00e1\u00edrunk a l\u00e1ncolt list\u00e1hoz\n\n    printf(\"Please type the title of the book: \");\n    getline(text, MAX);\n    strcpy(llist-&gt;book,text);\n\n\n    printf(\"Please type the release date: \");\n\n\n    getline(szoveg, MAX);\n\n    while(!yearcheck(text)) {\n    printf(\"Please type a year between 1500 and 2016: \");\n    getline(text, MAX);\n\n    }\n    num = atoi(text);\n\n    llist-&gt;year = num;\n\n\n    printf(\"Please type a topic: \\n\");\n    printf(\"Topics: SciFi, Haboru, Fantasy,\\nEletrajz, Ismeretterjeszto, Thriller, Akcio\\n\");\n\n\n    strcpy(llist-&gt;tema, text);\n    }\n</code></pre>\n"}, {"tags": ["c", "fork", "pipeline", "wc"], "comments": [{"owner": {"reputation": 15221, "user_id": 1023911, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Wln26.jpg?s=128&g=1", "display_name": "Werner Henze", "link": "https://stackoverflow.com/users/1023911/werner-henze"}, "edited": false, "score": 2, "creation_date": 1460563903, "post_id": 36603877, "comment_id": 60804999, "body": "Why are you calling pipe() twice on the same fd array? Why are you first forking and then creating the pipe? Creating the pipe in one thread and using it in the other thread is open to race conditions."}, {"owner": {"reputation": 107, "user_id": 4615871, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/937452189628154/picture?type=large", "display_name": "Jos&#233; Cunha", "link": "https://stackoverflow.com/users/4615871/jos%c3%a9-cunha"}, "reply_to_user": {"reputation": 15221, "user_id": 1023911, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Wln26.jpg?s=128&g=1", "display_name": "Werner Henze", "link": "https://stackoverflow.com/users/1023911/werner-henze"}, "edited": false, "score": 0, "creation_date": 1460564121, "post_id": 36603877, "comment_id": 60805156, "body": "@WernerHenze You&#39;re right , the pipe was meant to be created by the father process . My mistake."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 15221, "user_id": 1023911, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Wln26.jpg?s=128&g=1", "display_name": "Werner Henze", "link": "https://stackoverflow.com/users/1023911/werner-henze"}, "edited": false, "score": 1, "creation_date": 1460564202, "post_id": 36603877, "comment_id": 60805207, "body": "@WernerHenze, it is worse than you say, because there are no threads here, and therefore no shared data.  The child process will <i>never</i> see the effect of the second <code>pipe()</code> call in its copy of the array, and by making that call, the parent loses the FDs of the pipe to the child."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1460564389, "post_id": 36603877, "comment_id": 60805347, "body": "Do you want wc&#39;s output to just show up on the screen, or are you hoping to read it in the parent program?  If so, you may need a second pipe (and the logic gets even tricker)."}, {"owner": {"reputation": 107, "user_id": 4615871, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/937452189628154/picture?type=large", "display_name": "Jos&#233; Cunha", "link": "https://stackoverflow.com/users/4615871/jos%c3%a9-cunha"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1460564426, "post_id": 36603877, "comment_id": 60805379, "body": "@JohnBollinger I already fixed the issue with the pipe and I made only the parent making the pipe. However the wc command only gives me 0."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1460564462, "post_id": 36603877, "comment_id": 60805410, "body": "Why do you call <code>_exit()</code> instead of <code>exit()</code>?  Or indeed, instead of just letting the program reach the end of <code>main()</code>?  Nothing useful is gained by using <code>_exit()</code> in this case, and although it is specified by POSIX, it is not part of standard C (which has <code>_Exit()</code> instead)."}, {"owner": {"reputation": 107, "user_id": 4615871, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/937452189628154/picture?type=large", "display_name": "Jos&#233; Cunha", "link": "https://stackoverflow.com/users/4615871/jos%c3%a9-cunha"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1460564468, "post_id": 36603877, "comment_id": 60805418, "body": "@SteveSummit I want wc&#39;s output to just show up on the screen."}, {"owner": {"reputation": 15221, "user_id": 1023911, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Wln26.jpg?s=128&g=1", "display_name": "Werner Henze", "link": "https://stackoverflow.com/users/1023911/werner-henze"}, "edited": false, "score": 1, "creation_date": 1460564481, "post_id": 36603877, "comment_id": 60805425, "body": "@Jos&#233;Cunha If you changed the code, then please update your question."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1460564678, "post_id": 36603877, "comment_id": 60805585, "body": "@Jos&#233;Cunha, your corrected code is still wrong.  The pipe needs to be created <i>before</i> the fork if both parent and child are to see the same contents.  C.f. my previous comments about <i>no shared data</i>."}, {"owner": {"reputation": 107, "user_id": 4615871, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/937452189628154/picture?type=large", "display_name": "Jos&#233; Cunha", "link": "https://stackoverflow.com/users/4615871/jos%c3%a9-cunha"}, "reply_to_user": {"reputation": 15221, "user_id": 1023911, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Wln26.jpg?s=128&g=1", "display_name": "Werner Henze", "link": "https://stackoverflow.com/users/1023911/werner-henze"}, "edited": false, "score": 0, "creation_date": 1460564818, "post_id": 36603877, "comment_id": 60805697, "body": "@WernerHenze You&#39;re right is now updated. @JohnBollinger Yes you&#39;re right , I should let the program reach the main , but I still did the <code>_exit(-1)</code> after the <code>execlp</code> to check for errors"}, {"owner": {"reputation": 107, "user_id": 4615871, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/937452189628154/picture?type=large", "display_name": "Jos&#233; Cunha", "link": "https://stackoverflow.com/users/4615871/jos%c3%a9-cunha"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1460565271, "post_id": 36603877, "comment_id": 60806015, "body": "@JohnBollinger I updated and followed your suggestion but now I get nothing in the output"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1460565387, "post_id": 36603877, "comment_id": 60806078, "body": "@Jos&#233;Cunha, in the latest version of your code, you <i>still</i> create the pipe after forking.  Now parent and child each do it."}, {"owner": {"reputation": 107, "user_id": 4615871, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/937452189628154/picture?type=large", "display_name": "Jos&#233; Cunha", "link": "https://stackoverflow.com/users/4615871/jos%c3%a9-cunha"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1460565501, "post_id": 36603877, "comment_id": 60806141, "body": "@JohnBollinger I&#39;ve now updated and I get an infinite loop (thank you for the patience)"}, {"owner": {"reputation": 15221, "user_id": 1023911, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Wln26.jpg?s=128&g=1", "display_name": "Werner Henze", "link": "https://stackoverflow.com/users/1023911/werner-henze"}, "edited": false, "score": 1, "creation_date": 1460566768, "post_id": 36603877, "comment_id": 60806909, "body": "Your file descriptor handling is broken. Please think about which process shall read from where (console, pipe) and write to where (console, pipe). Drawing a diagram might help. Then try to match that with your code and think about where to read/write from/to files 0, 1, fd[0] and fd[1]."}, {"owner": {"reputation": 107, "user_id": 4615871, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/937452189628154/picture?type=large", "display_name": "Jos&#233; Cunha", "link": "https://stackoverflow.com/users/4615871/jos%c3%a9-cunha"}, "reply_to_user": {"reputation": 15221, "user_id": 1023911, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Wln26.jpg?s=128&g=1", "display_name": "Werner Henze", "link": "https://stackoverflow.com/users/1023911/werner-henze"}, "edited": false, "score": 0, "creation_date": 1460567588, "post_id": 36603877, "comment_id": 60807470, "body": "@WernerHenze Ok , so the parent process must read from the console so must change <code>read(f[0]..)</code> to <code>read(0..)</code> and write on the <code>fd[1]</code> , and the child process must read from <code>fd[1]</code>  and write on the console right ?"}], "answers": [{"tags": [], "owner": {"reputation": 2048, "user_id": 6192747, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-agy-meieasc/AAAAAAAAAAI/AAAAAAAAAC8/ipYF1p3tygQ/photo.jpg?sz=128", "display_name": "Stian Skjelstad", "link": "https://stackoverflow.com/users/6192747/stian-skjelstad"}, "is_accepted": false, "score": 0, "last_activity_date": 1461140438, "creation_date": 1461140438, "answer_id": 36737844, "question_id": 36603877, "link": "https://stackoverflow.com/questions/36603877/executing-wc-command-on-child-process-using-pipeline/36737844#36737844", "title": "Executing wc command on child process using pipeline", "body": "<pre><code>#include &lt;unistd.h&gt;\n\nint main ()\n{\n    int fd[2];\n    char buff;\n    int pid;\n    int pip;\n    int status;\n\n    pip = pipe(fd);\n\n    if (pip == 0)\n    {\n        pid = fork();\n        if (pid != 0)\n        {\n            close(fd[0]);\n            while (read(0, &amp;buff,1) &gt; 0 )\n            {\n                write (fd[1],&amp;buff,1); /* your old loop forwarded internally in the pipe only*/\n            }\n            close(fd[1]);\n         } else {\n             dup2(fd[0],0);  /* you had dup2(fd[1], 1), replacing stdout of wc with the write end from wc */\n             close(fd[0]);\n             close(fd[1]);\n             execlp (\"wc\",\"wc\",NULL);\n             _exit(-1);\n          }\n    }\n    wait(&amp;status); /* reap the child process */\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 4615871, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/937452189628154/picture?type=large", "display_name": "Jos&#233; Cunha", "link": "https://stackoverflow.com/users/4615871/jos%c3%a9-cunha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 932, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1461140438, "creation_date": 1460563451, "last_edit_date": 1460565966, "question_id": 36603877, "link": "https://stackoverflow.com/questions/36603877/executing-wc-command-on-child-process-using-pipeline", "title": "Executing wc command on child process using pipeline", "body": "<p>I'm writing a program that executes the word count command on the child process. The father process should send a sequence of lines entered by the user trough a pipeline to the child process.\nI tried to do this but I ended up with an error.\nThis is my code:</p>\n\n<pre><code>int main ()\n{\n    int fd[2];\n    char buff;\n    int pid;\n    int pip;\n    pid = fork();\n    pip = pipe(fd);\n\n    if (pid != 0)\n    {\n        pip = pipe(fd);\n        if (pipe == 0)\n        {\n            while (read(fd[0], &amp;buff,1) &gt; 0 )\n            {\n                write (fd[1],&amp;buff,1);      \n            }\n            close(fd[0]);\n            _exit(0);\n        }\n    }\n    else\n    {\n        dup2(fd[1],1);\n        close(fd[1]);\n        execlp (\"wc\",\"wc\",NULL);\n        _exit(-1);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>I've also tried to use <code>dup2</code> to associate the standard input from the child to the read descriptor of the pipe created by the father process.\nBut I get this error : <code>wc: standard input: Input/output error</code>. \n<strong><em>How can I solve this?</em></strong></p>\n\n<p><strong>UPDATED</strong> (the error is solved but I get an infinite loop)</p>\n\n<pre><code>int main ()\n{\n    int fd[2];\n    char buff;\n    int pid;\n    int pip;\n\n    pip = pipe(fd);\n\n    if (pip == 0)\n    {\n             pid = fork();\n         if (pid != 0)\n          {     \n\n            while (read(fd[0], &amp;buff,1) &gt; 0 )\n            {\n                write (fd[1],&amp;buff,1);      \n            }\n            close(fd[0]);\n\n          }\n          else {\n\n        dup2(fd[1],1);\n        close(fd[1]);\n        execlp (\"wc\",\"wc\",NULL);\n        _exit(-1);\n          }\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "pointers", "struct", "nodes", "insertion"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1460563446, "post_id": 36603870, "comment_id": 60804700, "body": "<a href=\"http://stackoverflow.com/q/605845/2173917\">Please see this discussion on why not to cast the return value of <code>malloc()</code> and family in <code>C</code>.</a>."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1460563515, "post_id": 36603870, "comment_id": 60804745, "body": "I&#39;m almost sure the error message you posted (pasted) is erroneous"}, {"owner": {"reputation": 912, "user_id": 5983169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0962b675506fcf2aaa4c9f498d1fbad?s=128&d=identicon&r=PG&f=1", "display_name": "MikeC", "link": "https://stackoverflow.com/users/5983169/mikec"}, "edited": false, "score": 0, "creation_date": 1460563849, "post_id": 36603870, "comment_id": 60804960, "body": "What line are you getting error on? What is the definition of type Record?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1460563997, "post_id": 36603870, "comment_id": 60805055, "body": "The error is (MSVC) <code>error C2088: &#39;&lt;&#39;: illegal for struct</code>"}], "answers": [{"tags": [], "owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "is_accepted": true, "score": 2, "last_activity_date": 1460563811, "creation_date": 1460563811, "answer_id": 36604013, "question_id": 36603870, "link": "https://stackoverflow.com/questions/36603870/c-error-expression-must-have-arithmetic-or-pointer-type/36604013#36604013", "title": "C Error: expression must have arithmetic or pointer type", "body": "<p>Operator overload is not supported in C, so you cannot compare <code>Record</code> using <code>&gt;</code> operator unless it is <code>typedef</code>ed to <code>int</code> or other aritimetic or pointer type.</p>\n\n<p>To compare something like structures, define comparation function and use it.</p>\n\n<p>Example:</p>\n\n<pre><code>typedef struct {\n    int a, b;\n} Record;\n\n/*\nreturn positive value if *x &gt; *y\nreturn negative value if *x &lt; *y\nreturn 0 if *x == *y\n*/\nint cmpRecord(const Record* x, const Record* y) {\n    if (x-&gt;a + x-&gt;b &gt; y-&gt;a + y-&gt;b) return 1;\n    if (x-&gt;a + x-&gt;b &lt; y-&gt;a + y-&gt;b) return -1;\n    return 0;\n}\n\n/* ... */\n    while (n-&gt;next != NULL)\n    {\n       if (cmpRecord(&amp;n-&gt;data, &amp;newNode-&gt;data) &lt; 0 &amp;&amp; cmpRecord(&amp;n-&gt;next-&gt;data, &amp;newNode-&gt;data) &gt; 0) // Insertion Sort\n        {\n/* ... */\n</code></pre>\n"}], "owner": {"reputation": 193, "user_id": 5595149, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/01284f1a2f1ef96da03074bf299b2c58?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Sultana", "link": "https://stackoverflow.com/users/5595149/simon-sultana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13393, "favorite_count": 0, "accepted_answer_id": 36604013, "answer_count": 1, "score": 1, "last_activity_date": 1460563811, "creation_date": 1460563422, "question_id": 36603870, "link": "https://stackoverflow.com/questions/36603870/c-error-expression-must-have-arithmetic-or-pointer-type", "title": "C Error: expression must have arithmetic or pointer type", "body": "<pre><code>typedef struct node\n{\n    Record data;\n    struct node *next;\n}Node;\n\nNode *head = NULL;\n\nvoid addRecord(Record x)\n{\n    Node *previousNode = NULL;\n    Node *newNode;\n    Node *n;\n\nnewNode = (Node*)malloc(sizeof(Node));\nnewNode-&gt;data = x;\nnewNode-&gt;next = NULL;\n\nif (head == NULL)  // The list is empty\n{\n    head = newNode;\n}\nelse       // The list is not empty\n{\n    n = head;\n    while (n-&gt;next != NULL)\n    {\n        ***if (n-&gt;data &lt; newNode-&gt;data &amp;&amp; n-&gt;next-&gt;data &gt; newNode-&gt;data)*** // Insertion Sort\n        {\n            // We have to put it between these 2 nodes\n            newNode-&gt;next = n-&gt;next;\n            n-&gt;next = newNode;\n            return;\n        }\n        else\n        {\n            previousNode = n;\n            n = n-&gt;next;\n        }\n    }\n    n-&gt;next = newNode;\n}\n</code></pre>\n\n<p>}</p>\n\n<p>I have this error in the code within the if function of the insertion sort. The program says that 'n' must have arithmetic or pointer type. What seems to be the problem?</p>\n"}, {"tags": ["c", "string", "integer", "type-conversion"], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1460563254, "post_id": 36603015, "comment_id": 60804564, "body": "There is no uppercase <code>S</code> type specifier. This might be a non-standard extension."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1460573263, "post_id": 36603015, "comment_id": 60810874, "body": "@Olaf it is on <a href=\"http://linux.die.net/man/3/wscanf\" rel=\"nofollow noreferrer\">POSIX Programmer&#39;s manual</a> and <a href=\"https://msdn.microsoft.com/it-it/library/9y6s16x1.aspx\" rel=\"nofollow noreferrer\">.NET MSDN</a> support it."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1460584143, "post_id": 36603015, "comment_id": 60817079, "body": "Maybe, but that is likely a legacy from pre-C11 or C99. Better use the most common standard, which is C."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1460594602, "post_id": 36603015, "comment_id": 60820620, "body": "@Olaf, LPs, for what it&#39;s worth, the <a href=\"http://pubs.opengroup.org/onlinepubs/009695399/functions/fwscanf.html\" rel=\"nofollow noreferrer\">POSIX specifications</a> indeed do document <code>%S</code> as a synonym for <code>%ls</code>.  They also explicitly mark it as an extension to standard C."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1460661066, "post_id": 36603015, "comment_id": 60859178, "body": "@JohnBollinger, LPs: The question is not tagged POSIX. Please remember this read by other beginners who might wounder <code>%S</code> does not work. It would be a really good idea to at least have a note in the answer (or remove it as obsolete legacy). That&#39;s all I wanted."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1460661688, "post_id": 36603015, "comment_id": 60859548, "body": "@Olaf, of course.  You are right call out the fact that the <code>S</code> field code is not in standard ISO C.  I am simply attempting to clarify for the same inexperienced programmers you mention that that is the sense in which it is &quot;non-standard&quot;, since POSIX is a standard, too.  And also, perhaps, to point out that not every C feature in the POSIX standard (or in any vendor&#39;s documentation) is a feature of ISO C."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1460669857, "post_id": 36603015, "comment_id": 60864025, "body": "@JohnBollinger: I just see the next question pop up: &quot;Why does <code>%S</code> not work&quot;. Of course not with such a clear description. There are a lot of non-POSIX systems (and non-Windows or OS-X)in the wild. Problem is comments are not that often read (are they indexed by google?). Anyway, let&#39;s settle this, LPs seems not to be in the mood of clarifying and the accepted answer is clear..."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1460701213, "post_id": 36603015, "comment_id": 60873605, "body": "@Olaf I was abroad and edititing this answer with my smartphone it was not a good idea. I edited to clarify...I hope ;)"}], "tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": false, "score": 4, "last_activity_date": 1460728658, "last_edit_date": 1592644375, "creation_date": 1460561140, "answer_id": 36603015, "question_id": 36602890, "link": "https://stackoverflow.com/questions/36602890/convert-wide-character-string-read-with-wscanf-to-an-integer-in-c/36603015#36603015", "title": "convert wide-character string read with wscanf to an integer in C", "body": "<p>Your problem is the <code>wscanf</code> format.</p>\n<p>As described on <a href=\"http://man7.org/linux/man-pages/man3/fwscanf.3p.html\" rel=\"nofollow noreferrer\">MAN</a>:</p>\n<blockquote>\n<p><strong>s</strong></p>\n<p>Matches a sequence of non white-space wide characters. [...] The application shall ensure that the corresponding argument is a pointer to a character array large enough to accept the sequence and the terminating null character, which shall be added automatically.</p>\n</blockquote>\n<p>Simply &quot;%s&quot; must be used for non-wide-chars string, as usual in <code>printf</code>, <code>scanf</code> and so on</p>\n<p><a href=\"http://man7.org/linux/man-pages/man3/fwscanf.3p.html\" rel=\"nofollow noreferrer\">MAN</a> also says:</p>\n<blockquote>\n<p><strong>l (ell)</strong></p>\n<p>Specifies that a following d, i, o, u, x, X, or n conversion specifier applies to an argument with type pointer to long or unsigned long; [...] that a following c, s, or [ conversion specifier applies to an argument with type pointer to wchar_t.</p>\n</blockquote>\n<p>That means you must use <code>&quot;%ls&quot;</code> as format string to read a wide-char string.</p>\n<p>There is another <strong>non-standard ISO C</strong> solution if you are on <a href=\"http://linux.die.net/man/3/wscanf\" rel=\"nofollow noreferrer\">POSIX</a> or on <a href=\"https://msdn.microsoft.com/en-us/library/aa272895(v=vs.60).aspx\" rel=\"nofollow noreferrer\">.NET MSDN</a>: format <code>&quot;%S&quot;</code> can be used.</p>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 6, "last_activity_date": 1460561423, "creation_date": 1460561423, "answer_id": 36603097, "question_id": 36602890, "link": "https://stackoverflow.com/questions/36602890/convert-wide-character-string-read-with-wscanf-to-an-integer-in-c/36603097#36603097", "title": "convert wide-character string read with wscanf to an integer in C", "body": "<p>Your problem is with the <code>wscanf()</code> format.  A <code>%s</code> field descriptor designates a pointer to <code>char</code>, just like for <code>scanf()</code>.  These two functions differ a bit in how they convert the input, but they agree on the meaning of the field descriptors.</p>\n\n<p>For reading into an array of <code>wchar_t</code>, you want <code>%ls</code>.  Moreover, whether you should use <code>wscanf()</code> of <code>scanf()</code> is primarily a function of how the input is encoded, <em>not</em> of the data type into which you want to scan its contents.</p>\n"}], "owner": {"reputation": 657, "user_id": 878462, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/b3646799a509c210896146ae54c60f18?s=128&d=identicon&r=PG", "display_name": "Antonio Bonifati &#39;Farmboy&#39;", "link": "https://stackoverflow.com/users/878462/antonio-bonifati-farmboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 314, "favorite_count": 1, "accepted_answer_id": 36603097, "answer_count": 2, "score": 2, "last_activity_date": 1460728658, "creation_date": 1460560803, "question_id": 36602890, "link": "https://stackoverflow.com/questions/36602890/convert-wide-character-string-read-with-wscanf-to-an-integer-in-c", "title": "convert wide-character string read with wscanf to an integer in C", "body": "<p>I am trying to convert a string read using wscanf to an integer using wcstol, both from header file wchar.h on Linux. While wcstol works on constant wide-char strings (e.g. L\"23\") it does not work on wscanf input, which puzzles me. I always get 0, even if the input is actually numeric (e.g. 23). Why?</p>\n\n<pre><code>$ ./test \n23\ns=23\n0\n</code></pre>\n\n<p>Here is my test program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;wchar.h&gt;\nint main() {\n  wchar_t s[100];\n  if (wscanf(L\"%s\", s) == 1) {\n    wprintf(L\"s=%s\\n\", s);\n    wprintf(L\"%ld\\n\", wcstol(s, NULL, 10));\n  }\n}\n</code></pre>\n\n<p>If instead of wcstol I use strtol, it works but I get this warning:</p>\n\n<p>/usr/include/stdlib.h:183:17: note: expected \u2018const char * restrict\u2019 but argument is of type \u2018wchar_t * {aka int *}\u2019</p>\n\n<p>which I could silent using a type cast. I thought wcstol was the right way to parse a wide-char string to an integer. Since on my machine chars are actually ints, strtol happens to work, but that leaves me still unsure whether this is the right solution. What's going on here? Why wcstol does not do its job?</p>\n"}, {"tags": ["c", "arrays", "string", "random"], "comments": [{"owner": {"reputation": 2308, "user_id": 5883832, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Emekr.jpg?s=128&g=1", "display_name": "PhotometricStereo", "link": "https://stackoverflow.com/users/5883832/photometricstereo"}, "edited": false, "score": 0, "creation_date": 1460561259, "post_id": 36602856, "comment_id": 60803067, "body": "Why is your <code>main</code> returning a non integer value? By convention, <code>main</code> should always return an <code>int</code>, the value of which depends on whether your program was executed correctly."}, {"owner": {"reputation": 2383, "user_id": 4598520, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/30979c4f0df470bdf05219686dfaadf2?s=128&d=identicon&r=PG&f=1", "display_name": "jaimedash", "link": "https://stackoverflow.com/users/4598520/jaimedash"}, "edited": false, "score": 0, "creation_date": 1460561288, "post_id": 36602856, "comment_id": 60803088, "body": "is this a homework problem? if so, mention that explicitly"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1460561334, "post_id": 36602856, "comment_id": 60803120, "body": "That looks more like a C++ program, and is using Microsoft&#39;s &quot;secure&quot; string functions. Ignoring that, the main problem is that <code>strcat_s</code> works with null-terminated strings, but you are passing a pointer to a single character in an array of characters (<code>vowel</code> or <code>consonent</code>), most of which are definitely not followed by a null-terminator. The <code>vowel</code> and <code>consonent</code> arrays as a whole do not contain null-terminated strings, leading to undefined behavior."}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1460561365, "post_id": 36602856, "comment_id": 60803152, "body": "Your title and tag are C, but the file extension is cpp. Which language do you use?"}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1460561465, "post_id": 36602856, "comment_id": 60803220, "body": "@IanAbbott Actually <code>vowels</code> contains terminating null-character as the not explicitly initialized last element, while <code>consonants</code> doesn&#39;t."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1460561622, "post_id": 36602856, "comment_id": 60803356, "body": "@MikeCAT: So it does. I missed that!"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1460561749, "post_id": 36602856, "comment_id": 60803456, "body": "In <code>strcat_s</code> you have omitted the length argument. Please <a href=\"https://msdn.microsoft.com/en-us/library/d45bbxx4.aspx\" rel=\"nofollow noreferrer\">read the man page</a> and enable compiler warnings. Similarly for <code>scanf_s</code> there must be a length argument for each format specifier of type <code>%c</code> or <code>%s</code>."}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1460562113, "post_id": 36602856, "comment_id": 60803713, "body": "the <code>else</code> is only for the last <code>if</code>, so if you enter <code>&#39;V&#39;</code>, it will also print <code>&quot;Invalid!&quot;</code>. Why do you have a <code>for</code> loop if you <code>break;</code> it at the first iteration?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6116618, "user_type": "registered", "profile_image": "https://graph.facebook.com/955185357884456/picture?type=large", "display_name": "Eamon Cullen", "link": "https://stackoverflow.com/users/6116618/eamon-cullen"}, "edited": false, "score": 0, "creation_date": 1460562273, "post_id": 36603011, "comment_id": 60803825, "body": "I removed the &quot;Invalid!&quot; option and added break; and that seems to have fixed the issue. Thanks for the help!"}], "tags": [], "owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "is_accepted": false, "score": 1, "last_activity_date": 1460561136, "creation_date": 1460561136, "answer_id": 36603011, "question_id": 36602856, "link": "https://stackoverflow.com/questions/36602856/how-do-i-add-randomly-generated-characters-to-a-string-in-c/36603011#36603011", "title": "How do I add randomly generated characters to a string in C?", "body": "<ul>\n<li>The <code>scanf_s</code> will read newline characters if you enter them. Add a space <em>before</em> <code>%c</code> to have the function skip them.</li>\n<li>Your usage of <code>strcat_s</code> seems strange. The function will take three arguments, but you are passing only two. In this case, you can just assign characters.</li>\n<li><code>#include &lt;string&gt;</code> and <code>using namespace std;</code> are for C++, not C, and they are not used here. remove them.</li>\n<li>Your type of <code>main()</code> looks weird.</li>\n</ul>\n\n<p>Try this (sorry, I hate VC++ specific functions):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) {\n\n    char type, letters[10] = { };\n    char vowels[6] = { 'A', 'E', 'I', 'O', 'U' };\n    char consonants[21] = { 'B', 'C', 'D', 'F', 'G', 'H', 'J', 'K', 'L', 'M', 'N', 'P', 'Q', 'R', 'S', 'T', 'V', 'W', 'X', 'Y', 'Z' };\n    int i, k, v, l, c;\n\n    for (i = 0; i &lt; 9; i++) {\n        printf(\"Vowel or consonant? (V/C)\\n\");\n        scanf(\" %c\", &amp;type);\n\n        if (type == 'V')\n            for (k = 0; k&lt;1; k++) {\n                v = (rand() % 5);\n                letters[i] = vowels[v];\n\n            }\n        if (type == 'C')\n            for (l = 0; l&lt;1; l++) {\n                c = (rand() % 21);\n                letters[i] = consonants[c];\n\n            }\n        else\n            printf(\"Invalid!\");\n        break;\n    }\n\n    printf(\"%s\", letters);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6116618, "user_type": "registered", "profile_image": "https://graph.facebook.com/955185357884456/picture?type=large", "display_name": "Eamon Cullen", "link": "https://stackoverflow.com/users/6116618/eamon-cullen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1460561136, "creation_date": 1460560711, "question_id": 36602856, "link": "https://stackoverflow.com/questions/36602856/how-do-i-add-randomly-generated-characters-to-a-string-in-c", "title": "How do I add randomly generated characters to a string in C?", "body": "<p>I'm trying to create a program that solves the Countdown words game which involves asking for a proportion of vowels and consonants. I want to add random characters to a string that will be passed to a permutation function. </p>\n\n<p>When I run the following program and select \"C\" I get the error \"l buffer is too small &amp;&amp; 0 c\" and the program crashes.</p>\n\n<p>Typing \"V\" will give the error \"Invalid!EIOU\" without crashing.</p>\n\n<p>How can I create this random string with vowel and consonant amounts dictated by the user's input? </p>\n\n<p>Should this be done as an array instead?</p>\n\n<pre><code>// April16Assignment.cpp : Defines the entry point for the console application.\n//\n\n#include \"stdafx.h\"\n#include &lt;stdlib.h&gt;\n#include &lt;string&gt;\nusing namespace std;\n\nconst char * main() {\n\n    char type, letters[10] = { };\n    char vowels[6] = { 'A', 'E', 'I', 'O', 'U' };\n    char consonants[21] = { 'B', 'C', 'D', 'F', 'G', 'H', 'J', 'K', 'L', 'M', 'N', 'P', 'Q', 'R', 'S', 'T', 'V', 'W', 'X', 'Y', 'Z' };\n    int i, k, v, l, c;\n\n    for (i = 0; i &lt; 9; i++) {\n        printf(\"Vowel or consonant? (V/C)\\n\");\n        scanf_s(\"%c\", &amp;type);\n\n        if (type == 'V')\n            for (k = 0; k&lt;1; k++) {\n                v = (rand() % 5);\n                strcat_s(letters, &amp;vowels[v]);\n\n            }\n        if (type == 'C')\n            for (l = 0; l&lt;1; l++) {\n                c = (rand() % 21);\n                strcat_s(letters, &amp;consonants[c]);\n\n            }\n        else\n            printf(\"Invalid!\");\n        break;\n    }\n\n    printf(\"%s\", letters);\n    return letters;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "process", "mmap", "virtual-address-space"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1460560799, "post_id": 36602767, "comment_id": 60802680, "body": "<i>Maybe P2&#39;s application&#39;s code has already mapped something at address A before calling <code>plat_get_shared_memory_address(H)</code>, and <code>mmap()</code> will fail.</i>  It&#39;s more likely that <code>mmap()</code> will succeed and cause what was originally at that address to be <code>munmap()</code>&#39;d and replaced with the new mapping."}, {"owner": {"reputation": 787, "user_id": 1159290, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/8413d7f973d5c9207cc9134db63314a6?s=128&d=identicon&r=PG", "display_name": "user1159290", "link": "https://stackoverflow.com/users/1159290/user1159290"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1460563333, "post_id": 36602767, "comment_id": 60804625, "body": "ho? would it do so? strange behavior. But anyway, that is not what I want either!"}, {"owner": {"reputation": 787, "user_id": 1159290, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/8413d7f973d5c9207cc9134db63314a6?s=128&d=identicon&r=PG", "display_name": "user1159290", "link": "https://stackoverflow.com/users/1159290/user1159290"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1461575929, "post_id": 36602767, "comment_id": 61243284, "body": "I am now using mmap(... PROT_NONE ...) hoping it just does what I wish. not sure..."}], "owner": {"reputation": 787, "user_id": 1159290, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/8413d7f973d5c9207cc9134db63314a6?s=128&d=identicon&r=PG", "display_name": "user1159290", "link": "https://stackoverflow.com/users/1159290/user1159290"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 718, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1460560498, "creation_date": 1460560498, "question_id": 36602767, "link": "https://stackoverflow.com/questions/36602767/is-there-a-system-call-in-linux-to-reserve-virtual-address-space-not-memory-ju", "title": "Is there a system call in linux to reserve virtual address space (not memory, just address space)", "body": "<p>I have a user space \"platform\" forking different processes. All these processes start executing a platform <code>plat_init()</code> function, and then run some other application code (which is not mine. i.e. I cannot change this code).\nAt some point in time some of these processes may do a <code>plat_shared_mem_alloc()</code> to allocate shared memory. This function returns a handle H (one handle per shared memory block allocated at each call). Another function, <code>plat_get_shared_memory_address(H)</code> can be called to retrieve the address (in the process virtual space) of H.\nH can be sent to other linux processes (using usual IPC).\nI would like any call to <code>plat_get_shared_memory_address(H)</code> made by any processes to return the same address (for the same handle H).</p>\n\n<p>In other words, I want to map the shared physical memory to the same virtual address in all processes using it, regardless on when the mapping is done.</p>\n\n<p>I thought the <code>plat_shared_mem_alloc()</code> could call <code>shm_open(</code>) to create a \"file\" in the file system, and I am aware <code>mmap()</code> has the <code>MAP_FIXED</code> flag to force the virtual address of the mapping.</p>\n\n<p>But nothing guarantee that if a process P1 maps a shared memory handle at address <em>A</em>, then the same address <em>A</em> is/will be available in another process P2 address space. Maybe P2's application's code has already mapped something at address <em>A</em> before calling <code>plat_get_shared_memory_address(H)</code>, and <code>mmap()</code> will fail.</p>\n\n<p>So I am thinking of blocking some address space in each process during plat_init() call (which I know comes first). and using some of that address space when needed for <code>mmap()</code>.</p>\n\n<p>In other words, is there a system call to block (reserve) some virtual address space of a process (without allocation any memory at this time), so I could, later on, if needed, map things at the same address in my different processes?</p>\n"}, {"tags": ["c", "gcc"], "comments": [{"owner": {"reputation": 5751, "user_id": 1101692, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0207bd98c9e3f6f855d82aff720437aa?s=128&d=identicon&r=PG", "display_name": "Shark", "link": "https://stackoverflow.com/users/1101692/shark"}, "edited": false, "score": 0, "creation_date": 1460560077, "post_id": 36602532, "comment_id": 60802104, "body": "The moment when we get to the point where the compiler can optimize <b>and</b> rewrite your code for you, we did our job. We managed to get ourselves out of the coding loop and just let computers code themselves. Unfortunately, we&#39;re not there yet, so human eyes and brains are still necessary to some degrees."}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 3, "creation_date": 1460560167, "post_id": 36602532, "comment_id": 60802171, "body": "You would be much better off using a profiler to identify the hot spots in your code, and then consider how to optimise these."}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1460560409, "post_id": 36602532, "comment_id": 60802381, "body": "You are trying to &quot;decompile&quot; the code, which is considered as a kind of difficult task for C."}, {"owner": {"reputation": 75, "user_id": 4124894, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000334723118/picture?type=large", "display_name": "Dragos Iancu", "link": "https://stackoverflow.com/users/4124894/dragos-iancu"}, "edited": false, "score": 0, "creation_date": 1460560733, "post_id": 36602532, "comment_id": 60802622, "body": "I know it&#39;s difficult but I&#39;m out of ideas and i know there are tools that can show you some code. Thanks for answering guys :D"}, {"owner": {"reputation": 7645, "user_id": 2692339, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4f8e4e5cba3b6606d8e395364c1742b8?s=128&d=identicon&r=PG&f=1", "display_name": "edmz", "link": "https://stackoverflow.com/users/2692339/edmz"}, "edited": false, "score": 0, "creation_date": 1460561493, "post_id": 36602532, "comment_id": 60803253, "body": "I don&#39;t know of any (at least free) tools capable of that. It&#39;s <i>terribly</i> tough to accomplish because the compiler leaves pretty much no trace of what used to be C (no variable names most notably). And from that, the code is extensively transformed."}, {"owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "edited": false, "score": 2, "creation_date": 1460561569, "post_id": 36602532, "comment_id": 60803313, "body": "The decompiler would have to generate variable names, which can&#39;t even be done by lots of programmers."}, {"owner": {"reputation": 75, "user_id": 4124894, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000334723118/picture?type=large", "display_name": "Dragos Iancu", "link": "https://stackoverflow.com/users/4124894/dragos-iancu"}, "edited": false, "score": 0, "creation_date": 1460562108, "post_id": 36602532, "comment_id": 60803708, "body": "Can&#39;t debug symbols be used to make a clearer decompilation? It should help, right?"}, {"owner": {"reputation": 6533, "user_id": 1918193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b70a14318e0f417ecac47809f38fafc?s=128&d=identicon&r=PG", "display_name": "Marc Glisse", "link": "https://stackoverflow.com/users/1918193/marc-glisse"}, "edited": false, "score": 2, "creation_date": 1460576497, "post_id": 36602532, "comment_id": 60812910, "body": "Try <code>-fdump-tree-optimized</code>. It produces a dump file after the high-level optimizations in something that looks vaguely like C."}, {"owner": {"reputation": 75, "user_id": 4124894, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000334723118/picture?type=large", "display_name": "Dragos Iancu", "link": "https://stackoverflow.com/users/4124894/dragos-iancu"}, "edited": false, "score": 0, "creation_date": 1460634236, "post_id": 36602532, "comment_id": 60839919, "body": "Thank you Marc, that actually helped. Unfortunately is too hard to read functions with big and many loops cause it generates too many labels... like 50 or so and it&#39;s easy to loose track of them."}], "owner": {"reputation": 75, "user_id": 4124894, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000334723118/picture?type=large", "display_name": "Dragos Iancu", "link": "https://stackoverflow.com/users/4124894/dragos-iancu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 122, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1460560199, "creation_date": 1460559951, "last_edit_date": 1460560199, "question_id": 36602532, "link": "https://stackoverflow.com/questions/36602532/how-to-convert-gcc-s-output-to-c-code", "title": "How to convert gcc -S output to C code?", "body": "<p>I have a program written in C which does a lot of processing on a 2d array and i would like to optimize it regarding function calls and cache line misses.</p>\n\n<p><strong>gcc -O3</strong> performs really good but I would like to see what it really does or at least get an idea of it to help me do the same in the C code.</p>\n\n<p>Now, the gcc -O3 -S outputs assembly and I was wondering if any of you guys know a way to get it back to C.</p>\n\n<p>Or is there a way to get the output of O3 back to C code and see how it looks after optimization? Or at least a glimpse of it?</p>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 109324, "user_id": 21926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6e61d47f9a6ec0a7a286835e51f3332?s=128&d=identicon&r=PG", "display_name": "Sean Bright", "link": "https://stackoverflow.com/users/21926/sean-bright"}, "edited": false, "score": 2, "creation_date": 1460560382, "post_id": 36602512, "comment_id": 60802352, "body": "Most of the places where you are calling <code>malloc</code> and passing in <code>sizeof(struct Whatever *)</code> you should instead be passing <code>sizeof(struct Whatever)</code>. You want the size of the structure, not the size of a pointer. The fact that it runs correctly on Linux is just luck."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1460560619, "post_id": 36602512, "comment_id": 60802523, "body": "You also need <code>free(apples[i]-&gt;Sort);</code> in the loop before <code>free(apples[i]);</code>"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 1515575, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0f2b3e970dfe7b2ee7c51f7f7012f17c?s=128&d=identicon&r=PG", "display_name": "Plamenk", "link": "https://stackoverflow.com/users/1515575/plamenk"}, "edited": false, "score": 0, "creation_date": 1460573252, "post_id": 36602787, "comment_id": 60810868, "body": "Thank you! The only thing I had to add is change the line allocating memory for apples along the same lines you suggested, namely: apples = malloc(numApples*sizeof(struct Apple)); I still like explicit casts, even though they are not necessary."}], "tags": [], "owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "is_accepted": true, "score": 1, "last_activity_date": 1460561203, "last_edit_date": 1460561203, "creation_date": 1460560543, "answer_id": 36602787, "question_id": 36602512, "link": "https://stackoverflow.com/questions/36602512/heap-corruption-on-windows-manipulating-array-of-pointers-to-structures-in-c/36602787#36602787", "title": "Heap corruption on windows manipulating array of pointers to structures in C", "body": "<blockquote>\n  <ol>\n  <li>Is there something wrong with the code?</li>\n  </ol>\n</blockquote>\n\n<p>Yes. </p>\n\n<ol>\n<li><p><code>struct Basket *mybasket = (struct Basket *) malloc(sizeof(structBasket*));</code> should be <code>struct Basket *mybasket = malloc(sizeof(structBasket));</code></p></li>\n<li><p><code>apples[i] = (struct Apple*)malloc(sizeof(struct Apple*));</code> should be <code>apples[i] = (struct Apple*)malloc(sizeof(struct Apple));</code></p></li>\n<li><p><code>apples[i]-&gt;Sort = (char *)malloc(18*sizeof(char *));</code> should be <code>apples[i]-&gt;Sort = malloc(18);</code></p></li>\n</ol>\n\n<p>Since <code>T *ptr</code> points to \"an array\" of <code>T</code>, the memory space called for should be <code>n * sizeof (T)</code>.</p>\n\n<p>Also, to avoid a memory leak, <code>free()</code> all fields of a struct before <code>free()</code>ing it:</p>\n\n<pre><code>while(numApples--)\n{\n    free(apples[numApples]-&gt;Sort);\n    free(apples[numApples]);\n}\n</code></pre>\n\n<blockquote>\n  <ol start=\"2\">\n  <li>Why are the results different on Windows and Linux?</li>\n  </ol>\n</blockquote>\n\n<p>Because accessing memory not allocated yet invokes <strong>undefined behaviour</strong>, in which case anything from working as expected to a heap corruption can happen. It works on Linux simply because you are (un)lucky.</p>\n"}], "owner": {"reputation": 13, "user_id": 1515575, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0f2b3e970dfe7b2ee7c51f7f7012f17c?s=128&d=identicon&r=PG", "display_name": "Plamenk", "link": "https://stackoverflow.com/users/1515575/plamenk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 36602787, "answer_count": 1, "score": 0, "last_activity_date": 1460561203, "creation_date": 1460559914, "last_edit_date": 1460560295, "question_id": 36602512, "link": "https://stackoverflow.com/questions/36602512/heap-corruption-on-windows-manipulating-array-of-pointers-to-structures-in-c", "title": "Heap corruption on windows manipulating array of pointers to structures in C", "body": "<p>This code compiles fine on both windows (using VS2010) and Linux (using gcc). It runs fine on Linux, but on Windows I am getting heap corruption. What is going on?</p>\n\n<p>The intent of the code is just to learn how to work with arrays of pointers to structures in C. It is just a toy example: you have a structure apple with a character array specifying the sort and a double, specifying the weight. Basket is a structure which holds an array of pointers to apples. The basket itself has some other parameters, e.g. showing how full is the basket and how many apples are in there.</p>\n\n<p>I tried playing with the flags in VS and set it for compiling as a C code (/TC) but this didn't make a difference. So my questions are: </p>\n\n<ol>\n<li><p>Is there something wrong with the code?</p></li>\n<li><p>Why are the results different on Windows and Linux?</p></li>\n</ol>\n\n<p>Here is my code:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nstruct Apple{\n    char *Sort;\n    double Weight;\n};\n\nstruct Basket{\n    struct Apple **apples;\n    double full;\n    int numApples;\n};\n\nint main()\n{\n    int i;\n    int numApples = 5;\n\n    struct Basket *mybasket = (struct Basket *) malloc(sizeof(structBasket*));\n    struct Apple **apples;\n    apples = malloc(numApples*sizeof(struct Apple*));\n\n    for(i=0;i&lt;numApples;i++)\n    {\n        apples[i] = (struct Apple*)malloc(sizeof(struct Apple*));\n        apples[i]-&gt;Sort = (char *)malloc(18*sizeof(char *));\n        apples[i]-&gt;Weight = ((double)i+1)*0.57;\n    }\n\n    mybasket-&gt;apples = apples;\n    mybasket-&gt;full = 0.8;\n    mybasket-&gt;numApples =numApples;\n\n    strcpy(apples[0]-&gt;Sort, \"Fuji\");\n    strcpy(apples[1]-&gt;Sort, \"Braburn\");\n    strcpy(apples[2]-&gt;Sort, \"Golden Delicious\");\n    strcpy(apples[3]-&gt;Sort, \"Red Delicious\");\n    strcpy(apples[4]-&gt;Sort, \"McIntosh\");\n\n    for(i=0;i &lt; numApples;i++)\n    {\n        printf(\"\\n apple #%d is %s and weights %f  pounds\",i,mybasket-&gt;apples[i]-&gt;Sort,mybasket-&gt;apples[i]-&gt;Weight);\n    }\n\n    printf(\"\\n\\n\");\n\n    for(i=numApples-1;i&gt;-1;i--)\n    {\n        free(apples[i]);\n    }\n\n    free(apples);\n    free(mybasket);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "protocols", "avr", "i2c"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1460562512, "post_id": 36602436, "comment_id": 60804019, "body": "Most of the variables where you shift 8 bits and OR the next byte are of type <code>uint8_t</code>. So that&#39;s not going to work."}, {"owner": {"reputation": 175, "user_id": 6030385, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/79e127dec21ccca5a078e74511083ece?s=128&d=identicon&r=PG&f=1", "display_name": "Womble", "link": "https://stackoverflow.com/users/6030385/womble"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1460562848, "post_id": 36602436, "comment_id": 60804286, "body": "Okay I will increase the buffer size! What am I doing wrong otherwise?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1460562898, "post_id": 36602436, "comment_id": 60804321, "body": "Ooops I misread when I typed the last comment. <code>char buffer[4];</code> will only be large enough for 3-digits decimal numbers."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1460563019, "post_id": 36602436, "comment_id": 60804402, "body": "Plainly you need <code>uint16_t pred</code> and such as <code>pred = ((uint16_t)i2c_read_ack())&lt;&lt;8; pred |= i2c_read_ack();</code>"}, {"owner": {"reputation": 175, "user_id": 6030385, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/79e127dec21ccca5a078e74511083ece?s=128&d=identicon&r=PG&f=1", "display_name": "Womble", "link": "https://stackoverflow.com/users/6030385/womble"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1460566347, "post_id": 36602436, "comment_id": 60806649, "body": "Now terminal outputs 23130 23130 23130 23130 23130"}], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 6030385, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/79e127dec21ccca5a078e74511083ece?s=128&d=identicon&r=PG&f=1", "display_name": "Womble", "link": "https://stackoverflow.com/users/6030385/womble"}, "edited": false, "score": 0, "creation_date": 1460566869, "post_id": 36604237, "comment_id": 60806975, "body": "I understand what you mean, but calling i2c_start(0xB4) throws my error"}, {"owner": {"reputation": 1964, "user_id": 1320881, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b69670b7cc6bce132f443eee557c9448?s=128&d=identicon&r=PG", "display_name": "Unimportant", "link": "https://stackoverflow.com/users/1320881/unimportant"}, "reply_to_user": {"reputation": 175, "user_id": 6030385, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/79e127dec21ccca5a078e74511083ece?s=128&d=identicon&r=PG&f=1", "display_name": "Womble", "link": "https://stackoverflow.com/users/6030385/womble"}, "edited": false, "score": 0, "creation_date": 1460567307, "post_id": 36604237, "comment_id": 60807268, "body": "You need 0xB5... Because you are reading data from the device."}, {"owner": {"reputation": 175, "user_id": 6030385, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/79e127dec21ccca5a078e74511083ece?s=128&d=identicon&r=PG&f=1", "display_name": "Womble", "link": "https://stackoverflow.com/users/6030385/womble"}, "edited": false, "score": 0, "creation_date": 1460567385, "post_id": 36604237, "comment_id": 60807318, "body": "Sorry, I meant that 0xB5 throws that error. I actually tested both, though."}, {"owner": {"reputation": 1964, "user_id": 1320881, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b69670b7cc6bce132f443eee557c9448?s=128&d=identicon&r=PG", "display_name": "Unimportant", "link": "https://stackoverflow.com/users/1320881/unimportant"}, "reply_to_user": {"reputation": 175, "user_id": 6030385, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/79e127dec21ccca5a078e74511083ece?s=128&d=identicon&r=PG&f=1", "display_name": "Womble", "link": "https://stackoverflow.com/users/6030385/womble"}, "edited": false, "score": 0, "creation_date": 1460567624, "post_id": 36604237, "comment_id": 60807490, "body": "There are other errors with your code, such as this <code>val = ((uint8_t)i2c_read_ack())&lt;&lt;8</code> - shifting uint8_t 8 bits left yields 0. Try printing the individual bytes first to check if they arrive correctly."}, {"owner": {"reputation": 175, "user_id": 6030385, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/79e127dec21ccca5a078e74511083ece?s=128&d=identicon&r=PG&f=1", "display_name": "Womble", "link": "https://stackoverflow.com/users/6030385/womble"}, "edited": false, "score": 0, "creation_date": 1460568322, "post_id": 36604237, "comment_id": 60807907, "body": "WeatherVane mentioned that one. As you suggested, I&#39;m now only checking <code>uint16_t val = 0;</code> which prints <code>23130</code>"}, {"owner": {"reputation": 175, "user_id": 6030385, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/79e127dec21ccca5a078e74511083ece?s=128&d=identicon&r=PG&f=1", "display_name": "Womble", "link": "https://stackoverflow.com/users/6030385/womble"}, "edited": false, "score": 0, "creation_date": 1460576318, "post_id": 36604237, "comment_id": 60812791, "body": "When do I implement this shift? Changing the address results in an error."}, {"owner": {"reputation": 5310, "user_id": 1790864, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/u8BJF.png?s=128&g=1", "display_name": "Rev", "link": "https://stackoverflow.com/users/1790864/rev"}, "edited": false, "score": 0, "creation_date": 1460613687, "post_id": 36604237, "comment_id": 60826338, "body": "@user1320881: Its pretty common (and essentially correct) that they refer to the right aligned 7-bit value (without the R/W bit) as the address in I2C devices data sheets. The byte-value may be the &quot;address byte&quot; with respect to the protocol, but not the address."}, {"owner": {"reputation": 1964, "user_id": 1320881, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b69670b7cc6bce132f443eee557c9448?s=128&d=identicon&r=PG", "display_name": "Unimportant", "link": "https://stackoverflow.com/users/1320881/unimportant"}, "edited": false, "score": 0, "creation_date": 1460621607, "post_id": 36604237, "comment_id": 60831009, "body": "But they mix both ways of stating the address when they talk about reading or writing which is just confusing."}], "tags": [], "owner": {"reputation": 1964, "user_id": 1320881, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b69670b7cc6bce132f443eee557c9448?s=128&d=identicon&r=PG", "display_name": "Unimportant", "link": "https://stackoverflow.com/users/1320881/unimportant"}, "is_accepted": false, "score": 1, "last_activity_date": 1460564470, "creation_date": 1460564470, "answer_id": 36604237, "question_id": 36602436, "link": "https://stackoverflow.com/questions/36602436/data-request-is-only-returning-address-value-i2c/36604237#36604237", "title": "Data request is only returning address value (I2C)", "body": "<p>The datasheet is very unclear and contains a fault as far as addressing is concerned. The address for WRITING is 0xB4 and the address for READING is 0xB5.</p>\n\n<p>The datasheet says the address is:</p>\n\n<pre><code>BIT    7    6    5    4    3    2    1    0\nDATA   1    0    1    1    0    1    0   R/W\n</code></pre>\n\n<p>which corresponds to 0xB4 or 0xB5 depending on the R/W bit beeing set or not. The error they make in the text is that (0)1011010 is 0x5A but the R/W bit is the least significant bit, not the most significant bit. </p>\n"}, {"tags": [], "owner": {"reputation": 16397, "user_id": 66349, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9c13b93d65bbb06c10fc349fa36b67dc?s=128&d=identicon&r=PG", "display_name": "Peter Gibson", "link": "https://stackoverflow.com/users/66349/peter-gibson"}, "is_accepted": false, "score": 0, "last_activity_date": 1460677863, "creation_date": 1460677863, "answer_id": 36635994, "question_id": 36602436, "link": "https://stackoverflow.com/questions/36602436/data-request-is-only-returning-address-value-i2c/36635994#36635994", "title": "Data request is only returning address value (I2C)", "body": "<p>The i2c_start function in the i2cmaster library returns 1 to indicate an error, not zero</p>\n\n<pre><code>uint8_t i2c_start(uint8_t address)\n{\n    // ... snip ...\n\n    // check if the device has acknowledged the READ / WRITE mode\n    uint8_t twst = TW_STATUS &amp; 0xF8;\n    if ( (twst != TW_MT_SLA_ACK) &amp;&amp; (twst != TW_MR_SLA_ACK) ) return 1;\n\n    return 0;\n}\n</code></pre>\n\n<p>So in your <code>getVal</code> function, you should have</p>\n\n<pre><code>void getVal()\n{\n  if(i2c_start(I2C_READ) == 0) // 0 indicates success\n    {\n</code></pre>\n\n<p>In addition, I can't see why you're reading two 16-bit values <code>val</code> and <code>pred</code> from the sensor. The datasheet indicates that <code>pred</code> is the first value returned. You should also read the 8-bit <code>status</code> value to check if the data read is valid.</p>\n"}], "owner": {"reputation": 175, "user_id": 6030385, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/79e127dec21ccca5a078e74511083ece?s=128&d=identicon&r=PG&f=1", "display_name": "Womble", "link": "https://stackoverflow.com/users/6030385/womble"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 205, "favorite_count": 0, "closed_date": 1460725573, "answer_count": 2, "score": 0, "last_activity_date": 1460677863, "creation_date": 1460559715, "last_edit_date": 1460571513, "question_id": 36602436, "link": "https://stackoverflow.com/questions/36602436/data-request-is-only-returning-address-value-i2c", "closed_reason": "Duplicate", "title": "Data request is only returning address value (I2C)", "body": "<p>I'm trying to read some values being returned by a sensor device. It is all hooked up fine, but I'm struggling to retrieve data from the sensor, properly.</p>\n\n<p>In the <a href=\"https://ams.com/eng/content/download/686523/1787697/file/iAQ-core_Datasheet_EN_v1.pdf\" rel=\"nofollow\">datasheet</a> it says that I should receive bytes in the order: prediction, status, resistance, tvoc.</p>\n\n<p>My terminal keeps spitting out the same value, 23130 (0x5a5a)</p>\n\n<p>This leads me to believe that I'm not properly calling my <code>i2c_start()</code>. <a href=\"https://github.com/g4lvanix/I2C-master-lib\" rel=\"nofollow\">In the protocol readme</a> it says to read with <code>I2C_start(SLAVE_READ_ADDRESS);'</code> I tried replacing the address with the so-called <em>read starting point</em> being 0xB5, but that returns my error.</p>\n\n<pre><code>/* Name: main.c\n * Author: &lt;insert your name here&gt;\n * Copyright: &lt;insert your copyright message here&gt;\n * License: &lt;insert your license reference here&gt;\n */\n\n#include &lt;avr/io.h&gt;\n#include &lt;util/delay.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;uart.h&gt;\n#include &lt;i2c_master.h&gt;\n\n#define LED PB5\n\n#define I2C_READ 0x5A\n\nchar buffer[10];\n\nuint16_t val = 0;\nuint16_t pred = 0;\nuint8_t status = 0;\nuint8_t resistance = 0;\nuint8_t tvoc = 0;\n\n\nvoid getVal()\n{\n  if(i2c_start(I2C_READ))\n    {\n        //uart_puts(\"Start \");\n\n        val = ((uint8_t)i2c_read_ack())&lt;&lt;8;\n        val |= i2c_read_ack();\n\n      pred = ((uint16_t)i2c_read_ack())&lt;&lt;8;\n      pred |= i2c_read_ack();\n\n      // status = ((uint8_t)i2c_read_ack())&lt;&lt;8;\n      // status |= i2c_read_ack();\n\n      // resistance = ((uint8_t)i2c_read_ack())&lt;&lt;8;\n      // resistance |= i2c_read_ack();\n\n      // tvoc = ((uint8_t)i2c_read_ack())&lt;&lt;8;\n      // tvoc |= i2c_read_nack();\n\n      i2c_stop();\n\n    } else\n  {\n        uart_puts(\"Error\");\n\n        i2c_stop();\n    }\n}\n\nint main(void)\n{\n  init_uart(57600);\n  i2c_init();\n\n  DDRB = _BV(5);\n\n    for(;;)\n    {\n\n      getVal();\n\n      itoa(val, buffer, 10); //convert decimal to string base 10\n      uart_puts(buffer);\n      uart_puts(\" \");\n\n            itoa(pred, buffer, 10); //convert decimal to string base 10\n      uart_puts(buffer);\n      uart_puts(\" \");\n\n      itoa(status, buffer, 10); //convert decimal to string base 10\n      uart_puts(buffer);\n      uart_puts(\" \");\n\n      itoa(resistance, buffer, 10); //convert decimal to string base 10\n      uart_puts(buffer);\n      uart_puts(\" \");\n\n      itoa(tvoc, buffer, 10); //convert decimal to string base 10\n      uart_puts(buffer);\n      uart_puts(\" \");\n\n      PORTB = 0xFF;\n      _delay_ms(500);\n      PORTB = 0x00;\n      _delay_ms(500);\n    }\n    return 0;   /* never reached */\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1460559703, "post_id": 36602401, "comment_id": 60801784, "body": "The statement <code>for(i=0; i&lt;=52; i++)</code> is wrong and you will access <code>deck[52]</code>, which must not be accessed."}, {"owner": {"reputation": 143, "user_id": 5822157, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-QsxNqOuW0bY/AAAAAAAAAAI/AAAAAAAAABs/Rgzv4x6RE2A/photo.jpg?sz=128", "display_name": "David House", "link": "https://stackoverflow.com/users/5822157/david-house"}, "reply_to_user": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1460559846, "post_id": 36602401, "comment_id": 60801926, "body": "so what should I be accessing?  I also know I think I need to sue an array to list the items."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1460559888, "post_id": 36602401, "comment_id": 60801961, "body": "<code>const char *str[] = {&quot;Clubs&quot;,&quot;Hearts&quot;,&quot;Diamonds&quot;,&quot;Spades&quot;};</code>"}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1460560166, "post_id": 36602401, "comment_id": 60802169, "body": "Only <code>deck[0]</code> to <code>deck[51]</code> are available because you declared as <code>CARDS deck[52];</code>"}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1460560282, "post_id": 36602401, "comment_id": 60802261, "body": "You might also consider nested <code>for</code> loops: <code>for (int suit = 0; suit &lt; 4; ++suit) { for (int num = 0; num &lt; 13; ++num) {...}}</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1460561365, "post_id": 36602401, "comment_id": 60803151, "body": "@DavidHouse you only need cards with 52 values <code>0..51</code>. You can obtain the suit with <code>card &#47; 13</code> and its rank with <code>card % 13</code>. Then convert for human consumption at the point of output. For example, having corrected <code>char str[] = {&quot;Clubs Hearts Diamonds Spades&quot;};</code> to <code>char *suitname[] = {&quot;Clubs&quot;, &quot;Hearts&quot;, &quot;Diamonds&quot;, &quot;Spades&quot;};</code> the suit name will be <code>printf(&quot;%s&quot;, suitname[card &#47; 13]);</code>."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1460563220, "post_id": 36602401, "comment_id": 60804539, "body": "<code>printf(&quot;%c&quot;...</code> only prints one character. You need <code>%s</code> for strings."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1460563353, "post_id": 36602401, "comment_id": 60804640, "body": "@DavidHouse, yes, integers are ideal for cards, but if you order them 2,2,2,2,3,3,3,3,...A,A,A,A, then you can get suit and rank without teh expensive divide-by-13, and you can even compare by rank without separating rank/suit at all. Much more efficient."}], "answers": [{"comments": [{"owner": {"reputation": 143, "user_id": 5822157, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-QsxNqOuW0bY/AAAAAAAAAAI/AAAAAAAAABs/Rgzv4x6RE2A/photo.jpg?sz=128", "display_name": "David House", "link": "https://stackoverflow.com/users/5822157/david-house"}, "edited": false, "score": 0, "creation_date": 1460560473, "post_id": 36602591, "comment_id": 60802426, "body": "Thank you all for you input!  I will take at look and see what happens.  Would this be possible to list with an array:  like ary[13][4]; ??"}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "reply_to_user": {"reputation": 143, "user_id": 5822157, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-QsxNqOuW0bY/AAAAAAAAAAI/AAAAAAAAABs/Rgzv4x6RE2A/photo.jpg?sz=128", "display_name": "David House", "link": "https://stackoverflow.com/users/5822157/david-house"}, "edited": false, "score": 0, "creation_date": 1460560642, "post_id": 36602591, "comment_id": 60802545, "body": "@DavidHouse I didn&#39;t understand what you are saying well, but it should be possible."}, {"owner": {"reputation": 143, "user_id": 5822157, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-QsxNqOuW0bY/AAAAAAAAAAI/AAAAAAAAABs/Rgzv4x6RE2A/photo.jpg?sz=128", "display_name": "David House", "link": "https://stackoverflow.com/users/5822157/david-house"}, "edited": false, "score": 0, "creation_date": 1460560767, "post_id": 36602591, "comment_id": 60802649, "body": "My output is not listed in nice columns and rows so I was wondering if there was a way to list it as a matrix?  Does that make sense?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1460560980, "post_id": 36602591, "comment_id": 60802837, "body": "You have missed out &quot;10&quot; in <code>rank_names[]</code>, so when you index by 12 (the King) you&#39;ll get undefined behaviour. Note too that the &quot;3&quot; card is indexed with <code>rank_names[2]</code>, a trap for the unwary."}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1460561275, "post_id": 36602591, "comment_id": 60803080, "body": "@WeatherVane Thank you, added <code>&quot;10&quot;</code>."}, {"owner": {"reputation": 143, "user_id": 5822157, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-QsxNqOuW0bY/AAAAAAAAAAI/AAAAAAAAABs/Rgzv4x6RE2A/photo.jpg?sz=128", "display_name": "David House", "link": "https://stackoverflow.com/users/5822157/david-house"}, "edited": false, "score": 0, "creation_date": 1460561945, "post_id": 36602591, "comment_id": 60803612, "body": "Any advice on how to make this look nice in Rows and Columns?  I have it in the right format with suit and rank, but it looks quite messy."}], "tags": [], "owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "is_accepted": false, "score": 2, "last_activity_date": 1460561258, "last_edit_date": 1460561258, "creation_date": 1460560119, "answer_id": 36602591, "question_id": 36602401, "link": "https://stackoverflow.com/questions/36602401/listing-and-shuffling-a-deck-of-cards-in-c/36602591#36602591", "title": "Listing and shuffling a deck of cards in C", "body": "<ul>\n<li>You stored only one character to the structure, so it is natural that the entire words for suits aren't printed.</li>\n<li>You shoudld use arrays of <code>const char*</code> for enumrating names of suits and ranks.</li>\n<li>Avoid off-by-one error: the loop condition <code>i&lt;=52</code> in the second <code>for</code> loop is wrong.</li>\n<li>You should initialize <code>count</code> before entering the second loop.</li>\n</ul>\n\n<p>Corrected code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdbool.h&gt;\n\ntypedef struct\n{\n    char suit[10];\n    char rank[10];\n\n}CARDS;\n\nint main(void)\n{\n  const char* suit_names[] = {\"Clubs\", \"Hearts\", \"Diamonds\", \"Spades\"};\n  const char* rank_names[] = {\"ACE\", \"Deuce\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\",\n      \"Jack\", \"Queen\", \"King\"};\n  CARDS deck[52];\n\n  int i;\n  int count = 0;\n  int num = 1;\n\n  for(i=0; i&lt;52; i++)\n  {\n    strcpy(deck[i].suit, suit_names[count]);\n\n    //Assigning the card number\n    strcpy(deck[i].rank, rank_names[num - 1]);\n\n    num++;\n\n    //If statement for assigning numbers\n    if((i+1)%13==0)\n    {\n      count++;\n      num = 1;\n    }//end if\n\n  }//end for\n\n  printf(\"Before Shuffling:\\n\\n\");\n\n  count = 0;\n  for(i=0; i&lt;52; i++)\n  {\n    printf(\"%s %s \", deck[i].rank, deck[i].suit);\n    if(count &lt; 3)\n      count++;\n    else\n    {\n      printf(\"\\n\");\n      count = 0;\n    }//end else\n  }//end for\n  return 0;\n}\n</code></pre>\n\n<p>Then, introduce enumerates in some means and implement shuffle.</p>\n"}], "owner": {"reputation": 143, "user_id": 5822157, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-QsxNqOuW0bY/AAAAAAAAAAI/AAAAAAAAABs/Rgzv4x6RE2A/photo.jpg?sz=128", "display_name": "David House", "link": "https://stackoverflow.com/users/5822157/david-house"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 992, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1460561258, "creation_date": 1460559651, "question_id": 36602401, "link": "https://stackoverflow.com/questions/36602401/listing-and-shuffling-a-deck-of-cards-in-c", "title": "Listing and shuffling a deck of cards in C", "body": "<p>My project is to develop a program using structures, enumerations, and strings to first list a deck of cards by suit and rank in 13 rows and 4 columns and then shuffle them and output the random deck in the same fashion.  This is what I have so far:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdbool.h&gt;\n\ntypedef struct\n{\n    char suit;\n    char rank[10];\n\n}CARDS;\n\nint main(void)\n{\n  char str[] = {\"Clubs Hearts Diamonds Spades\"};\n  CARDS deck[52];\n\n  int i;\n  int count = 0;\n  int num = 1;\n\n  for(i=0; i&lt;52; i++)\n  {\n   deck[i].suit=str[count];\n\n    //Assigning the card number with switch statement\n    switch(num)\n    {\n        case 1: strcpy(deck[i].rank, \"ACE\");\n            break;\n        case 2: strcpy(deck[i].rank, \"Deuce\");\n            break;\n        case 3: strcpy(deck[i].rank, \"3\");\n            break;\n        case 4: strcpy(deck[i].rank, \"4\");\n            break;\n        case 5: strcpy(deck[i].rank, \"5\");\n            break;\n        case 6: strcpy(deck[i].rank, \"6\");\n            break;\n        case 7: strcpy(deck[i].rank, \"7\");\n            break;\n        case 8: strcpy(deck[i].rank, \"8\");\n            break;\n        case 9: strcpy(deck[i].rank, \"9\");\n            break;\n        case 10: strcpy(deck[i].rank, \"10\");\n            break;\n        case 11: strcpy(deck[i].rank, \"Jack\");\n            break;\n        case 12: strcpy(deck[i].rank, \"Queen\");\n            break;\n        case 13: strcpy(deck[i].rank, \"King\");\n            break;\n    }//end switch\n\n    num++;\n\n    //If statement for assigning numbers\n    if((i+1)%13==0)\n    {\n        count++;\n        num = 1;\n    }//end if\n\n}//end for\n\n//Local Statements\nprintf(\"Before Shuffling:\\n\\n\");\n\nfor(i=0; i&lt;=52; i++)\n{\n    printf(\"%s %c\", deck[i].rank, deck[i].suit);\n   printf(\" \");\n    if(count &lt; 3)\n        count++;\n    else\n    {\n        printf(\"\\n\");\n        count = 0;\n    }//end else\n}//end for\nreturn 0;\n}\n</code></pre>\n\n<p>I have been unsuccessful so far with getting the right order of things and my suits won't print out the entire word.  This is just the beginning of me trying to get the cards listed in order.  I also know that I have not used any enumerations.  Not sure what to do there.  Please help!</p>\n"}, {"tags": ["c++", "c", "audio"], "comments": [{"owner": {"reputation": 87362, "user_id": 176769, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PckCW.png?s=128&g=1", "display_name": "karlphillip", "link": "https://stackoverflow.com/users/176769/karlphillip"}, "edited": false, "score": 0, "creation_date": 1460559642, "post_id": 36602295, "comment_id": 60801730, "body": "That&#39;s the only sound you will be able to play using <code>printf()</code>. To build melodies or play music files from your computer you will need to use a 3rd party library like FFmpeg or GStreamer."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1460559733, "post_id": 36602295, "comment_id": 60801808, "body": "Which standard language includes such functions?? Learn how to crouch before starting to run. There is much more to learn about C the &quot;Hello World&quot; before you should even start thinking about using advanced 3rd party libraries."}, {"owner": {"reputation": 87362, "user_id": 176769, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PckCW.png?s=128&g=1", "display_name": "karlphillip", "link": "https://stackoverflow.com/users/176769/karlphillip"}, "edited": false, "score": 1, "creation_date": 1460559841, "post_id": 36602295, "comment_id": 60801923, "body": "<a href=\"http://stackoverflow.com/a/8191506/176769\">Here&#39;s a C program that uses OpenCV to display video and FFmpeg to play audio from a file on the disk</a>."}, {"owner": {"reputation": 12072, "user_id": 1630963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97c2d181ef6bbb9eee0c4033561c3891?s=128&d=identicon&r=PG", "display_name": "enhzflep", "link": "https://stackoverflow.com/users/1630963/enhzflep"}, "edited": false, "score": 0, "creation_date": 1460559902, "post_id": 36602295, "comment_id": 60801974, "body": "Nope, no built-in functionality to connect to the speakers (or the hard-disk, for that matter).. You can generate the audio by studying the format of digital music formats like wav or voc or smp. Once done, you can output a single tone of a specified duration to a sound-file and then later, play it with an installed application. Talking to the hardware yourself will need to go through a library and depending on the OS you&#39;re under, some will not work. For what it&#39;s worth Windows has a built-in sound subsystem. I&#39;ve made wav files with arduino - no ability to playback there!!"}, {"owner": {"reputation": 230, "user_id": 6185537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfab2419a626a99fc1995ba5c14777f9?s=128&d=identicon&r=PG&f=1", "display_name": "antiHUMAN", "link": "https://stackoverflow.com/users/6185537/antihuman"}, "edited": false, "score": 0, "creation_date": 1460559943, "post_id": 36602295, "comment_id": 60802004, "body": "Audio is actually somewhat complicated. You need to continuously make sure that the audio buffer on the sound card has data available to play, and so on. This is why it&#39;s not part of the standard, because it&#39;s so very dependent on different implementations. Of course you can write it yourself, but you&#39;d better use a 3rd party library, I&#39;d say. Personally, I&#39;ve used openAL. If you know openGL, this one will make instant sense to you."}, {"owner": {"reputation": 230, "user_id": 6185537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfab2419a626a99fc1995ba5c14777f9?s=128&d=identicon&r=PG&f=1", "display_name": "antiHUMAN", "link": "https://stackoverflow.com/users/6185537/antihuman"}, "edited": false, "score": 0, "creation_date": 1460559992, "post_id": 36602295, "comment_id": 60802042, "body": "But if you&#39;re on windows, for example, you could use win32 to play sounds and music."}, {"owner": {"reputation": 12072, "user_id": 1630963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97c2d181ef6bbb9eee0c4033561c3891?s=128&d=identicon&r=PG", "display_name": "enhzflep", "link": "https://stackoverflow.com/users/1630963/enhzflep"}, "edited": false, "score": 0, "creation_date": 1460560513, "post_id": 36602295, "comment_id": 60802458, "body": "You <i>may</i> get some utility out of the following project: <a href=\"http://www.pouet.net/prod.php?which=20171\" rel=\"nofollow noreferrer\">pouet.net/prod.php?which=20171</a> - I&#39;ve implemented the synth in JS/C/ASM and also removed the DirectSound requirement. Not the best code out there, but I found it helpful to look through a couple of years back.It&#39;s also kinda neat having a 2.1kb exe that produces a 10MB wav file, though I&#39;ve seen things like Clinkster produce <b>mind-numbingly</b> good sound from under 3kb of compressed program and data."}, {"owner": {"reputation": 11, "user_id": 5079436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/237acab70aeebf8fe0f4ed2776f2bf1b?s=128&d=identicon&r=PG&f=1", "display_name": "HAL9000", "link": "https://stackoverflow.com/users/5079436/hal9000"}, "edited": false, "score": 2, "creation_date": 1460562086, "post_id": 36602295, "comment_id": 60803695, "body": "Thank you  karlphillip, enhzflep, antiHUMAN, user2079303. I don&#39;t know any one that has this kind of experience... that I might jusk ask them a simple question like this. So I have to come here when Im just Lost and missing something. Its Wonderful to get the benefit of multiple individuals worth of experience. I know this sounds sappy..  I&#39;m just..  thank you all for taking the time."}], "answers": [{"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 2, "last_activity_date": 1460560955, "last_edit_date": 1460560955, "creation_date": 1460560286, "answer_id": 36602659, "question_id": 36602295, "link": "https://stackoverflow.com/questions/36602295/audio-output-c-language-novice/36602659#36602659", "title": "Audio output C language (novice)", "body": "<blockquote>\n  <p>Dose C simply not have any built-in functionality for sending signals to the speakers?</p>\n</blockquote>\n\n<p>Indeed, C does not have any built-in functionality for sending signals to the speakers.</p>\n\n<blockquote>\n  <p>Do I need a Library?</p>\n</blockquote>\n\n<p>No, but I would highly recommend to use one.</p>\n\n<blockquote>\n  <p>Do need C++?</p>\n</blockquote>\n\n<p>No. You don't need C++ for doing anything in C. Besides, C++ also has no built-in audio functionality.</p>\n\n<blockquote>\n  <p>where is the \"send to speaker\"?? where do I put in the frequency? Heaven forbid the part were I tell the thing what device I would like to talk to.</p>\n</blockquote>\n\n<p>All these and other things related to audio are platform (operating system) specific. In order to interact with a sound card (which is the device that sends signals to the speakers), you must use platform specific API. Some operating systems may have multiple different APIs for audio. You can, as I already recommended, use a (cross-platform) library that abstracts the platform specific API.</p>\n"}, {"tags": [], "owner": {"reputation": 230, "user_id": 6185537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfab2419a626a99fc1995ba5c14777f9?s=128&d=identicon&r=PG&f=1", "display_name": "antiHUMAN", "link": "https://stackoverflow.com/users/6185537/antihuman"}, "is_accepted": true, "score": 0, "last_activity_date": 1460560737, "last_edit_date": 1460560737, "creation_date": 1460560293, "answer_id": 36602663, "question_id": 36602295, "link": "https://stackoverflow.com/questions/36602295/audio-output-c-language-novice/36602663#36602663", "title": "Audio output C language (novice)", "body": "<p>You say you want to \"make music with C\". This seems to imply that you want to be able to feed data into the sound buffer in real-time through something like an ASIO driver, with low-lantency, and that you want to write your own audio synthesis. This is all quite complicated stuff, but you should start by getting some library/API that gives you that kind of access. Sadly, most of them do not tend to be free, but there probably are <b>some</b> free options, if you look around. </p>\n\n<p>Since all of this depends so much on what library/API you use, I sadly cannot say anything more precise.</p>\n\n<p>Another option is to study up and learn how to program VST-instruments (plug-ins for DAWs), which will probabably be even more useful for what it sounds like you're trying to do.</p>\n\n<p>And no, you don't need C++, unless the library/API you want to use only supports C++, for some reason. That doesn't tend to be the case.</p>\n"}], "owner": {"reputation": 11, "user_id": 5079436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/237acab70aeebf8fe0f4ed2776f2bf1b?s=128&d=identicon&r=PG&f=1", "display_name": "HAL9000", "link": "https://stackoverflow.com/users/5079436/hal9000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1561, "favorite_count": 0, "closed_date": 1460562379, "accepted_answer_id": 36602663, "answer_count": 2, "score": 0, "last_activity_date": 1460560955, "creation_date": 1460559422, "question_id": 36602295, "link": "https://stackoverflow.com/questions/36602295/audio-output-c-language-novice", "closed_reason": "Needs more focus", "title": "Audio output C language (novice)", "body": "<p>I'm sorry if this is long. I feel I need to be very thorough as to where I am actually at.\nRight so first off I do have experience with JavaScript.\nWhich is not the same thing, But it sure looks familiar to me.</p>\n\n<p>I want to make music with C.\nI got his big book called \"The audio programming book\".\nIt was like $60.\nIt dose have an introduction to C in it.  It all makes good sense to me so far.\nnothing really new.</p>\n\n<p>So here's my problem...\nAnd its very simple.  So simple in-fact that it doesn't seem to be covered in the book.\nI don't understand the relationship between my program and the speakers.\nmy computer's audio device.\nI thought to myself \"Alright lets start with the very basics. Let's see if we can just make a noise.\"\nAnd so...\nI have something that will make a beep.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n    int main()\n    {\n        printf(\"Hello world!\\n\");\n\n        printf(\"\\a\\n\");\n        return 0;\n    }\n</code></pre>\n\n<p>So that's cute.\nBut that's seemingly all that function is capable of.\nAnd honestly That would be rather confusing if...  the thing that is meant for printing text to your screen...  was also the thing you use to talk to your speakers....</p>\n\n<p>I've been looking through the book. I've been looking online. I've been looking for hours.\nAnd clearly searching in all the wrong places...  because literally all I can find is more of how to make your computer beep...</p>\n\n<p>where is the \"send to speaker\"??\nwhere do I put in the frequency?\nHeaven forbid the part were I tell the thing what device I would like to talk to.</p>\n\n<p>Dose C simply not have any built-in functionality for sending signals to the speakers?</p>\n\n<p>Do I need a Library?  Do need C++?  What am I missing.\nI don't know anything about desktop applications.\nAll my experiences is with Internet technologies.</p>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 3483, "user_id": 3932569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bca364f93a9dfab17419b31a8a1a504?s=128&d=identicon&r=PG&f=1", "display_name": "Garf365", "link": "https://stackoverflow.com/users/3932569/garf365"}, "edited": false, "score": 1, "creation_date": 1460559469, "post_id": 36602085, "comment_id": 60801551, "body": "Just a remark: you copy something from user in <code>msg</code>, but <code>msg</code> has a size of 10 characters =&gt; in <code>write_proc</code> be sure to not allowed <code>count</code> more than 10, otherwise you will have a buffer overflow!"}, {"owner": {"reputation": 71, "user_id": 6199329, "user_type": "registered", "profile_image": "https://graph.facebook.com/197976413927569/picture?type=large", "display_name": "Master AN HA", "link": "https://stackoverflow.com/users/6199329/master-an-ha"}, "reply_to_user": {"reputation": 3483, "user_id": 3932569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bca364f93a9dfab17419b31a8a1a504?s=128&d=identicon&r=PG&f=1", "display_name": "Garf365", "link": "https://stackoverflow.com/users/3932569/garf365"}, "edited": false, "score": 0, "creation_date": 1460559636, "post_id": 36602085, "comment_id": 60801722, "body": "yup , you are right i appreciate this"}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 6199329, "user_type": "registered", "profile_image": "https://graph.facebook.com/197976413927569/picture?type=large", "display_name": "Master AN HA", "link": "https://stackoverflow.com/users/6199329/master-an-ha"}, "edited": false, "score": 0, "creation_date": 1460560251, "post_id": 36602346, "comment_id": 60802239, "body": "ya you are completely right , thanks a lot , and i&#39;m sorry for this bad implementation , i&#39;m just a beginner in kernel programming and trying to understand how things work"}], "tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": false, "score": 4, "last_activity_date": 1460560361, "last_edit_date": 1460560361, "creation_date": 1460559532, "answer_id": 36602346, "question_id": 36602085, "link": "https://stackoverflow.com/questions/36602085/kernel-module-programming/36602346#36602346", "title": "Kernel Module Programming", "body": "<p>Apart from other problems of your kernel module (like boundaries check)</p>\n\n<p>This</p>\n\n<pre><code>msg=kmalloc(GFP_KERNEL,10*sizeof(char));\n</code></pre>\n\n<p>have to be</p>\n\n<pre><code> msg=kmalloc(10*sizeof(char), GFP_KERNEL);\n</code></pre>\n\n<p>With your call to <code>kmalloc</code> you are trying, probably, to allocate too many or not enough bytes and it refuses your <code>kmalloc</code> request.</p>\n\n<p>You should always check the <code>kmalloc</code> return value to be consistent: <code>!= NULL</code></p>\n"}, {"tags": [], "owner": {"reputation": 71, "user_id": 6234133, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AQEbO-3-Rfs/AAAAAAAAAAI/AAAAAAAAABc/ehJe7h2O1m4/photo.jpg?sz=128", "display_name": "wack", "link": "https://stackoverflow.com/users/6234133/wack"}, "is_accepted": false, "score": 0, "last_activity_date": 1461226612, "creation_date": 1461226612, "answer_id": 36763724, "question_id": 36602085, "link": "https://stackoverflow.com/questions/36602085/kernel-module-programming/36763724#36763724", "title": "Kernel Module Programming", "body": "<p>You can find kmalloc in slab.h:</p>\n\n<pre><code>static __always_inline void *kmalloc(size_t size, gfp_t flags)\n{\n    if (__builtin_constant_p(size)) {\n        if (size &gt; KMALLOC_MAX_CACHE_SIZE)\n            return kmalloc_large(size, flags);\n    #ifndef CONFIG_SLOB\n        if (!(flags &amp; GFP_DMA)) {\n            int index = kmalloc_index(size);\n\n            if (!index)\n                return ZERO_SIZE_PTR;\n\n            return kmem_cache_alloc_trace(kmalloc_caches[index],\n                    flags, size);\n        }\n    #endif\n    }\n    return __kmalloc(size, flags);\n}\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 6199329, "user_type": "registered", "profile_image": "https://graph.facebook.com/197976413927569/picture?type=large", "display_name": "Master AN HA", "link": "https://stackoverflow.com/users/6199329/master-an-ha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 297, "favorite_count": 2, "answer_count": 2, "score": 7, "last_activity_date": 1461226612, "creation_date": 1460558956, "last_edit_date": 1460560760, "question_id": 36602085, "link": "https://stackoverflow.com/questions/36602085/kernel-module-programming", "title": "Kernel Module Programming", "body": "<p>I'm trying to read and write to a proc file through kernel module<br>\nBut when I run this command :   </p>\n\n<p><code>echo \"hello\" &gt;&gt; /proc/hello &amp;&amp; cat /proc/hello</code>  </p>\n\n<p>It doesn't print anything and when i open the file through text editor.\nI found mysterious symbols like this  </p>\n\n<pre><code> ^@^@^@^@^@^@^@^@^@^@ \n</code></pre>\n\n<p>Any help will be appreciated \nthanks in advance   </p>\n\n<pre><code>#include &lt;linux/module.h&gt;\n#include &lt;linux/kernel.h&gt;\n#include &lt;linux/proc_fs.h&gt;\n#include&lt;linux/sched.h&gt;\n#include &lt;asm/uaccess.h&gt;\n#include &lt;linux/slab.h&gt;\n\nint len,temp;\nchar *msg;\n\nint read_proc(struct file *filp,char *buf,size_t count,loff_t *offp ){\n    if(count&gt;temp){count=temp;}\n    temp=temp-count;\n    copy_to_user(buf,msg, count);\n    if(count==0)temp=len;\n    return count;\n}\n\nint write_proc(struct file *filp,const char *buf,size_t count,loff_t *offp){\n    copy_from_user(msg,buf,count);\n    len=count;\n    temp=len;\n    return count;\n}\n\nstruct file_operations proc_fops = {\n    read: read_proc,\n    write: write_proc\n};\n\nvoid create_new_proc_entry(void){\n    proc_create(\"hello\",0,NULL,&amp;proc_fops);\n    msg=kmalloc(GFP_KERNEL,10*sizeof(char));\n}\n\nint proc_init (void){\n    create_new_proc_entry();\n    return 0;\n}\n\nvoid proc_cleanup(void){\n    remove_proc_entry(\"hello\",NULL);\n}\n\nMODULE_LICENSE(\"GPL\"); \nmodule_init(proc_init);\nmodule_exit(proc_cleanup);\n</code></pre>\n"}, {"tags": ["c", "gcc", "linker", "gdb", "debug-symbols"], "comments": [{"owner": {"reputation": 7072, "user_id": 1816262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/IcKpN.png?s=128&g=1", "display_name": "OMGtechy", "link": "https://stackoverflow.com/users/1816262/omgtechy"}, "edited": false, "score": 1, "creation_date": 1460559084, "post_id": 36602012, "comment_id": 60801209, "body": "Could you break it down into smaller projects that are linked together? That way you could chop the problem into smaller chunks."}, {"owner": {"reputation": 2742, "user_id": 2771245, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/vhsVn.jpg?s=128&g=1", "display_name": "mtijanic", "link": "https://stackoverflow.com/users/2771245/mtijanic"}, "reply_to_user": {"reputation": 7072, "user_id": 1816262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/IcKpN.png?s=128&g=1", "display_name": "OMGtechy", "link": "https://stackoverflow.com/users/1816262/omgtechy"}, "edited": false, "score": 0, "creation_date": 1460559354, "post_id": 36602012, "comment_id": 60801444, "body": "@OMGtechy That would be a huuuge project on its own. Anything that requires more than just adding CFLAGS or running a small tool in a few places in the make process would end up being over a man month of work."}, {"owner": {"reputation": 7072, "user_id": 1816262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/IcKpN.png?s=128&g=1", "display_name": "OMGtechy", "link": "https://stackoverflow.com/users/1816262/omgtechy"}, "edited": false, "score": 0, "creation_date": 1460559484, "post_id": 36602012, "comment_id": 60801573, "body": "You could take a look at <a href=\"http://stackoverflow.com/questions/1413171/what-is-strip-gcc-application-used-for\" title=\"what is strip gcc application used for\">stackoverflow.com/questions/1413171/&hellip;</a> and see if you can either a) use that to strip the duplicate symbols or b) reduce the size of the problem by removing some you know you don&#39;t need"}, {"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1460559680, "post_id": 36602012, "comment_id": 60801766, "body": "What architectures are the build systems? All 32-bit x86? If on Unix or Linux, what is the limit on the size of the process data segment (ulimit -d)?"}, {"owner": {"reputation": 5751, "user_id": 1101692, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0207bd98c9e3f6f855d82aff720437aa?s=128&d=identicon&r=PG", "display_name": "Shark", "link": "https://stackoverflow.com/users/1101692/shark"}, "edited": false, "score": 0, "creation_date": 1460559878, "post_id": 36602012, "comment_id": 60801949, "body": "4G ram is too low for a build machine; try it on a mroe powerful build machine to learn whether it&#39;s just the linker needing more memory or the whole build process idea not really working. (similar to a smoke-test or a feasibility test)"}, {"owner": {"reputation": 2742, "user_id": 2771245, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/vhsVn.jpg?s=128&g=1", "display_name": "mtijanic", "link": "https://stackoverflow.com/users/2771245/mtijanic"}, "reply_to_user": {"reputation": 7072, "user_id": 1816262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/IcKpN.png?s=128&g=1", "display_name": "OMGtechy", "link": "https://stackoverflow.com/users/1816262/omgtechy"}, "edited": false, "score": 0, "creation_date": 1460559984, "post_id": 36602012, "comment_id": 60802033, "body": "@OMGtechy I guess I could write a script that reads the symbols on two using <code>dwarfdump</code> or something, does a diff and then removes duplicates from one of them using <code>strip</code>. That&#39;s <code>n^2</code> calls. Sounds nasty but may work."}, {"owner": {"reputation": 2742, "user_id": 2771245, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/vhsVn.jpg?s=128&g=1", "display_name": "mtijanic", "link": "https://stackoverflow.com/users/2771245/mtijanic"}, "reply_to_user": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1460560101, "post_id": 36602012, "comment_id": 60802122, "body": "@MarkPlotnick This is amd64 Linux."}, {"owner": {"reputation": 2742, "user_id": 2771245, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/vhsVn.jpg?s=128&g=1", "display_name": "mtijanic", "link": "https://stackoverflow.com/users/2771245/mtijanic"}, "reply_to_user": {"reputation": 5751, "user_id": 1101692, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0207bd98c9e3f6f855d82aff720437aa?s=128&d=identicon&r=PG", "display_name": "Shark", "link": "https://stackoverflow.com/users/1101692/shark"}, "edited": false, "score": 0, "creation_date": 1460560105, "post_id": 36602012, "comment_id": 60802124, "body": "@Shark I also tried it on our build farm, and it crapped out there. Not sure what HW configuration those machines are, but &quot;get more ram&quot; is not an option. I&#39;ll try on a beefy machine to see if any amount is enough."}, {"owner": {"reputation": 5751, "user_id": 1101692, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0207bd98c9e3f6f855d82aff720437aa?s=128&d=identicon&r=PG", "display_name": "Shark", "link": "https://stackoverflow.com/users/1101692/shark"}, "edited": false, "score": 0, "creation_date": 1460560322, "post_id": 36602012, "comment_id": 60802305, "body": "I said it for a reason, if having 8/16GB of RAM doesn&#39;t get the job done and the linker can&#39;t do it, perhaps it&#39;s not the linker&#39;s fault. Perhaps the build process idea just doesn&#39;t work. (that&#39;s the worser case in this situation, I&#39;m hoping that some more ram lets it finish it&#39;s work so you simply know your minimum specs required for a complete build/run scenario)"}, {"owner": {"reputation": 2742, "user_id": 2771245, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/vhsVn.jpg?s=128&g=1", "display_name": "mtijanic", "link": "https://stackoverflow.com/users/2771245/mtijanic"}, "reply_to_user": {"reputation": 5751, "user_id": 1101692, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0207bd98c9e3f6f855d82aff720437aa?s=128&d=identicon&r=PG", "display_name": "Shark", "link": "https://stackoverflow.com/users/1101692/shark"}, "edited": false, "score": 0, "creation_date": 1460706086, "post_id": 36602012, "comment_id": 60876302, "body": "@Shark just FYI, I tried it on a 16G machine and it ate around 7G and finished in some 30 seconds, so nothing wrong with the process, just eats a lot."}, {"owner": {"reputation": 5751, "user_id": 1101692, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0207bd98c9e3f6f855d82aff720437aa?s=128&d=identicon&r=PG", "display_name": "Shark", "link": "https://stackoverflow.com/users/1101692/shark"}, "edited": false, "score": 0, "creation_date": 1460706405, "post_id": 36602012, "comment_id": 60876508, "body": "That&#39;s still good news though."}], "answers": [{"comments": [{"owner": {"reputation": 2742, "user_id": 2771245, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/vhsVn.jpg?s=128&g=1", "display_name": "mtijanic", "link": "https://stackoverflow.com/users/2771245/mtijanic"}, "edited": false, "score": 0, "creation_date": 1460566765, "post_id": 36604883, "comment_id": 60806906, "body": "Thanks. I&#39;ve been running <code>dwz</code> for the past hour with no end in sight, so that&#39;s not a solution. Would love to see what it produces as an end result, so I know what to target. I&#39;ll try <code>-fdebug-types-section</code> next. Apparently, it is for DWARF-4, but maybe it&#39;ll work."}, {"owner": {"reputation": 8196, "user_id": 395851, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f7417d04460fbc27bc0ac99204cfce9c?s=128&d=identicon&r=PG", "display_name": "dbrank0", "link": "https://stackoverflow.com/users/395851/dbrank0"}, "edited": false, "score": 0, "creation_date": 1460625919, "post_id": 36604883, "comment_id": 60833965, "body": "There is also compressed debug sections support in binutils 2.26, if you can use that."}, {"owner": {"reputation": 2742, "user_id": 2771245, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/vhsVn.jpg?s=128&g=1", "display_name": "mtijanic", "link": "https://stackoverflow.com/users/2771245/mtijanic"}, "edited": false, "score": 0, "creation_date": 1460706399, "post_id": 36604883, "comment_id": 60876506, "body": "FYI: <code>dwz</code> and <code>-fdebug-types-section</code> both work nicely, when the build machine is strong enough. But on the variety of hardware I need to support, they take too long or just crash. I may add a check to see if your HW is good enough, and run them if so."}, {"owner": {"reputation": 2742, "user_id": 2771245, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/vhsVn.jpg?s=128&g=1", "display_name": "mtijanic", "link": "https://stackoverflow.com/users/2771245/mtijanic"}, "edited": false, "score": 0, "creation_date": 1461066077, "post_id": 36604883, "comment_id": 61019853, "body": "I&#39;m at least in certain cases using <code>dwz</code> and <code>-fdebug-types-section</code>, so accepting this answer. For future reference, also useful is <code>objcopy --compress-debug-sections</code> (removes some 300M). Thanks."}], "tags": [], "owner": {"reputation": 18871, "user_id": 1442050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e975c669f2ce0f2be4613f1e123864b3?s=128&d=identicon&r=PG", "display_name": "Tom Tromey", "link": "https://stackoverflow.com/users/1442050/tom-tromey"}, "is_accepted": true, "score": 3, "last_activity_date": 1460566448, "creation_date": 1460566448, "answer_id": 36604883, "question_id": 36602012, "link": "https://stackoverflow.com/questions/36602012/removing-dwarf-2-duplicate-symbols-exhausts-memory/36604883#36604883", "title": "Removing DWARF-2 duplicate symbols exhausts memory", "body": "<p>There are two ways that I know of to reduce DWARF size.  Which one you want depends on your intended purpose.</p>\n\n<p>Fedora (and maybe other distros, I don't know) uses the <code>dwz</code> tool to compress DWARF.  This works after the fact: you link your program or shared library, then run <code>dwz</code>.  It is a \"semantic\" compressor, meaning it understands the DWARF and rewrites it into a smaller form.  In DWARF terms it makes partial CUs and shares data that way.  <code>dwz</code> also has a mode where it can compress data across different executables for more sharing.</p>\n\n<p><code>dwz</code> yields best compression.  The major downside is that it doesn't fit very well into a developer workflow -- it is a bit slow, uses a a lot of memory, etc.  It's great for distros though, and I think would be appropriate for some other deployment situations.</p>\n\n<p>The other decent way to compress debuginfo is to use the <code>-fdebug-types-section</code> flag to gcc.  This changes the DWARF output to put large types into their own sections.  The types are hashed by their contents; then the linker merges these sections automatically.</p>\n\n<p>This approach yields decent compression, because types are a substantial part of the DWARF; with decent performance, because merging identical sections this way in the linker is cheap.  The major downside is that the compression isn't as good.</p>\n\n<p>gdb understands both of these kinds of compression.  Support in other tools is a bit more spotty.</p>\n"}, {"comments": [{"owner": {"reputation": 2742, "user_id": 2771245, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/vhsVn.jpg?s=128&g=1", "display_name": "mtijanic", "link": "https://stackoverflow.com/users/2771245/mtijanic"}, "edited": false, "score": 0, "creation_date": 1460706618, "post_id": 36614135, "comment_id": 60876624, "body": "We already do use crosscompilers. The problem is that not all <code>x86_64</code> systems we use for build machines are powerful enough to optimize this. Plus, developers may want to run the build on their primary system while also doing something else. If the whole build took 2G of RAM until now, and suddenly starts needing 8, I&#39;ll break everyone&#39;s workflow. Regarding <code>-fsplit-dwarf</code>, in cases where it is built remotely I&#39;d still need to download the symbols as well, so there is little to gain."}, {"owner": {"reputation": 2742, "user_id": 2771245, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/vhsVn.jpg?s=128&g=1", "display_name": "mtijanic", "link": "https://stackoverflow.com/users/2771245/mtijanic"}, "edited": false, "score": 0, "creation_date": 1461065789, "post_id": 36614135, "comment_id": 61019667, "body": "&quot;you don&#39;t have a hard 4GB requirement&quot; we have hundreds of machines that&#39;d need updating, which is pretty ambitious (and expensive). Not something I can just decide. &quot;If your developers have a primary system with less than 16GB, you are wasting their time.&quot; They are also running their browsers, editors, office tools and whatnot. &quot;The gain is that you can build your binary.&quot; I still can, it&#39;s just huge. I can&#39;t <i>optimize</i> it for size. Either way, the answer will be to use switches for every optimization (remove dups, compress, split) and let each machine&#39;s owner decide. Thanks!"}], "tags": [], "owner": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "is_accepted": false, "score": 2, "last_activity_date": 1460737081, "last_edit_date": 1460737081, "creation_date": 1460609564, "answer_id": 36614135, "question_id": 36602012, "link": "https://stackoverflow.com/questions/36602012/removing-dwarf-2-duplicate-symbols-exhausts-memory/36614135#36614135", "title": "Removing DWARF-2 duplicate symbols exhausts memory", "body": "<p>In addition to Tom Tromey's suggestions, another thing you could do is build crosscompiler for e.g. <code>x86_64</code> system, targeting all your wide variety of systems.</p>\n\n<p>This completely eliminates the 4GB limit on linker memory, and may be faster (your wide variety of small systems probably have wimpy CPUs, and so building natively on them may take hours when cross-compiling for them on a brawny development machine will only take minutes).</p>\n\n<p>Or you could use <code>-fsplit-dwarf</code> -- there is no need to link debug bits into your final shared library; you can keep them separate.</p>\n\n<p><strong>Update:</strong></p>\n\n<blockquote>\n  <p>We already do use crosscompilers. The problem is that not all x86_64 systems we use for build machines are powerful enough to optimize this.</p>\n</blockquote>\n\n<p>In that case, you don't have a <em>hard</em> 4GB requirement, and your claim that this is unacceptable is bogus. You could get 64GB of RAM for about USD500, and speed everything up.</p>\n\n<blockquote>\n  <p>developers may want to run the build on their primary system</p>\n</blockquote>\n\n<p>If your developers have a primary system with less than 16GB, you are wasting their time.</p>\n\n<blockquote>\n  <p>Regarding -fsplit-dwarf, in cases where it is built remotely I'd still need to download the symbols as well, so there is little to gain</p>\n</blockquote>\n\n<p>The gain is that you <em>can</em> build your binary.</p>\n"}, {"comments": [{"owner": {"reputation": 2742, "user_id": 2771245, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/vhsVn.jpg?s=128&g=1", "display_name": "mtijanic", "link": "https://stackoverflow.com/users/2771245/mtijanic"}, "edited": false, "score": 0, "creation_date": 1460706757, "post_id": 36637329, "comment_id": 60876701, "body": "I&#39;ll try <code>gold</code> next. It could be just what I need. We didn&#39;t use it earlier because the same code is also sometimes linked into a kernel module, and <code>gold</code> can&#39;t do that, but I see no problems with making an exception here. The kernel module infrastructure already has ways to deal with 700M symbols."}, {"owner": {"reputation": 15136, "user_id": 4044696, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/54xyv.jpg?s=128&g=1", "display_name": "Severin Pappadeux", "link": "https://stackoverflow.com/users/4044696/severin-pappadeux"}, "reply_to_user": {"reputation": 2742, "user_id": 2771245, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/vhsVn.jpg?s=128&g=1", "display_name": "mtijanic", "link": "https://stackoverflow.com/users/2771245/mtijanic"}, "edited": false, "score": 0, "creation_date": 1460730212, "post_id": 36637329, "comment_id": 60892835, "body": "@mtijanic And it was somewhat faster for me, apparently making data layout a bit more cache friendlier <a href=\"http://stackoverflow.com/questions/30010588/is-binary-linked-with-gold-linker-running-faster\" title=\"is binary linked with gold linker running faster\">stackoverflow.com/questions/30010588/&hellip;</a>"}, {"owner": {"reputation": 15136, "user_id": 4044696, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/54xyv.jpg?s=128&g=1", "display_name": "Severin Pappadeux", "link": "https://stackoverflow.com/users/4044696/severin-pappadeux"}, "reply_to_user": {"reputation": 2742, "user_id": 2771245, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/vhsVn.jpg?s=128&g=1", "display_name": "mtijanic", "link": "https://stackoverflow.com/users/2771245/mtijanic"}, "edited": false, "score": 0, "creation_date": 1460739234, "post_id": 36637329, "comment_id": 60898748, "body": "@mtijanic meaning not only linker is faster, but app made by gold linker is a bit faster as well, sorry for confusion"}, {"owner": {"reputation": 2742, "user_id": 2771245, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/vhsVn.jpg?s=128&g=1", "display_name": "mtijanic", "link": "https://stackoverflow.com/users/2771245/mtijanic"}, "edited": false, "score": 0, "creation_date": 1461065866, "post_id": 36637329, "comment_id": 61019718, "body": "FYI: <code>gold</code> also chokes on it on the lowest end systems (4+4G). The <code>--no-keep-memory</code> option on is ignored on <code>gold</code> so it may even be worse."}], "tags": [], "owner": {"reputation": 15136, "user_id": 4044696, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/54xyv.jpg?s=128&g=1", "display_name": "Severin Pappadeux", "link": "https://stackoverflow.com/users/4044696/severin-pappadeux"}, "is_accepted": false, "score": 1, "last_activity_date": 1460687713, "creation_date": 1460687713, "answer_id": 36637329, "question_id": 36602012, "link": "https://stackoverflow.com/questions/36602012/removing-dwarf-2-duplicate-symbols-exhausts-memory/36637329#36637329", "title": "Removing DWARF-2 duplicate symbols exhausts memory", "body": "<p>Well, another thing to try is to use \"gold\" linker, for building large apps it might be faster/better, link: <a href=\"https://en.wikipedia.org/wiki/Gold_(linker)\" rel=\"nofollow\">https://en.wikipedia.org/wiki/Gold_(linker)</a></p>\n\n<p>Also gold linker together with split debug info worked quite well for me.</p>\n\n<p>\"Fission is implemented in GCC 4.7, and requires support from recent versions of objcopy and the gold linker.</p>\n\n<p>Use the -gsplit-dwarf option to enable the generation of split DWARF at compile time. This option must be used in conjunction with -c; Fission cannot be used when compiling and linking in the same step.</p>\n\n<p>Use the gold linker's --gdb-index option (-Wl,--gdb-index when linking with gcc or g++) at link time to create the .gdb_index section that allows GDB to locate and read the .dwo files as it needs them.\"</p>\n"}], "owner": {"reputation": 2742, "user_id": 2771245, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/vhsVn.jpg?s=128&g=1", "display_name": "mtijanic", "link": "https://stackoverflow.com/users/2771245/mtijanic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 512, "favorite_count": 0, "accepted_answer_id": 36604883, "answer_count": 3, "score": 3, "last_activity_date": 1460737081, "creation_date": 1460558783, "question_id": 36602012, "link": "https://stackoverflow.com/questions/36602012/removing-dwarf-2-duplicate-symbols-exhausts-memory", "title": "Removing DWARF-2 duplicate symbols exhausts memory", "body": "<p>I'm dealing with a large project that gets compiled as a shared object. Compiling it with DWARF-2 symbols (<code>-g -feliminate-unused-debug-types</code>) results in the <code>.debug_info</code> being around 700M.</p>\n\n<p>If I add <code>-feliminate-dwarf2-dups</code>, the linker dies:</p>\n\n<pre><code>error adding symbols: Memory exhausted\nld returned 1 exit status\n</code></pre>\n\n<p>This is on a system with 4G RAM. Since this needs to be compiled on a wide range of systems, consuming over 4G RAM is not acceptable. I tried passing <code>--no-keep-memory</code> to <code>ld</code>, but it still fails.</p>\n\n<blockquote>\n  <p>ld normally optimizes for speed over memory usage by caching the symbol tables of input files in memory. This option tells ld to instead optimize for memory usage, by rereading the symbol tables as necessary. This may be required if ld runs out of memory space while linking a large executable.</p>\n</blockquote>\n\n<p>I'm guessing <code>ld</code> loads all the symbols in memory then goes about finding dupes, which takes 5+ times the memory it takes to store them on disk.</p>\n\n<p>Is there a simple way to incrementally do this? Like:</p>\n\n<ol>\n<li>Load the symbols from first .o file</li>\n<li>Load the symbols from next .o file</li>\n<li>Merge them, removing any duplicates</li>\n<li>goto 2.</li>\n</ol>\n\n<p>I could link files two by two into temporary archives, then link those two by two, etc, but I <em>really</em> don't want to change the build process for this project. Maybe I could use <code>objcopy</code> to remove those segments, perform the dupe elimination separately, then insert the debug sections into the final ELF?</p>\n\n<p>Is there any other tool that can perform these DWARF merges? <code>dwarfdump</code> only reads the files. Alternatively, can I invoke <code>gcc</code>/<code>ld</code> to just do this, instead of actually linking the files? </p>\n"}, {"tags": ["c", "adt"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 3, "creation_date": 1460558143, "post_id": 36601668, "comment_id": 60800326, "body": "Welcome to Stack Overflow! It sounds like you may need to learn how to use a debugger to step through your code. With a good debugger, you can execute your program line by line and see where it is deviating from what you expect. This is an essential tool if you are going to do any programming. Further reading: <a href=\"http://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a>."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 1, "creation_date": 1460558145, "post_id": 36601668, "comment_id": 60800329, "body": "Have you tried a debugger, or at least some log output, to track <i>where exactly</i> your program segfaults? Or have you just gone &quot;segfault, can&#39;t find it by staring at it, post to SO&quot;?"}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 2, "creation_date": 1460558249, "post_id": 36601668, "comment_id": 60800429, "body": "<code>de = (Data*)malloc(sizeof(Data)); de = it_Next(it,q);</code> -- That&#39;s a memory leak. You allocate memory, then overwrite the pointer to it."}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 2, "creation_date": 1460558419, "post_id": 36601668, "comment_id": 60800605, "body": "Note: They say <a href=\"http://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">you shouldn&#39;t cast the result of <code>malloc()</code> in C</a>."}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 1, "creation_date": 1460558473, "post_id": 36601668, "comment_id": 60800648, "body": "Passing <code>long</code> to <code>%d</code> in <code>printf()</code> invokes <i>undefined behavior</i>. Use <code>%ld</code> instead."}, {"owner": {"reputation": 463, "user_id": 1334774, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7d88edc75310ad969e13e15238191979?s=128&d=identicon&r=PG", "display_name": "Bocky", "link": "https://stackoverflow.com/users/1334774/bocky"}, "reply_to_user": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1460558816, "post_id": 36601668, "comment_id": 60800940, "body": "@DevSolar I wasn&#39;t taught to use a IDE so I would have no idea how to use it. I wrote this code by hand and tested it using gcc in linux, so here I am asking for help. I appreciate the need to knock a learning student down though."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 1, "creation_date": 1460559049, "post_id": 36601668, "comment_id": 60801171, "body": "@Bocky: No need to be defensive about it. I was talking about a debugger, not an IDE, which is two different things. GDB, for example, works just fine on the command line, although the ncurses-based UI you get with <code>-tui</code> really helps. If you were taught C, but not taught the use of a debugger, talk to your instructor and tell him to include debugger use in his course. Placing log <code>printf()</code>s into code to show what exactly happens, and at which point the program actually fails, is even simpler than using a debugger. (Although not as effective.)"}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 1, "creation_date": 1460559188, "post_id": 36601668, "comment_id": 60801305, "body": "You write, &quot;I used this code in main to display the information retrieved.&quot; If I put that code into your <code>main()</code>, I get <code>warning: passing argument 1 of \u2018Iter_Create\u2019 from incompatible pointer type</code>, <code>expected \u2018void **\u2019 but argument is of type \u2018struct Queue *\u2019</code>?"}, {"owner": {"reputation": 463, "user_id": 1334774, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7d88edc75310ad969e13e15238191979?s=128&d=identicon&r=PG", "display_name": "Bocky", "link": "https://stackoverflow.com/users/1334774/bocky"}, "reply_to_user": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1460559292, "post_id": 36601668, "comment_id": 60801400, "body": "@DevSolar I am not here to debate, so lets go back to the question. I did place printf code in it, I just can&#39;t figure out why it can print out the data properly for the first 2 rounds. I can confirm that count in Queue is 5, and the size of the Iterator started from 0, hangs at 1(before entering the third loop). *I fixed the statement you mentioned by casting q to be (void *)q. The error is not there anymore."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 1, "creation_date": 1460559586, "post_id": 36601668, "comment_id": 60801675, "body": "Well, unfortunately I am not able to reproduce your problem given the code you posted (after fixing the includes and the <code>%ld</code> mentioned above)."}, {"owner": {"reputation": 5751, "user_id": 1101692, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0207bd98c9e3f6f855d82aff720437aa?s=128&d=identicon&r=PG", "display_name": "Shark", "link": "https://stackoverflow.com/users/1101692/shark"}, "edited": false, "score": 1, "creation_date": 1460559591, "post_id": 36601668, "comment_id": 60801680, "body": "run the debugger by hand, like <code>gdb .&#47;program</code> and step thru it or just tell it <code>run</code> and it will run and crash. on the re-run, step iterativelly until you find out after which instruction it crashes, and perhaps you learn something new. also, there&#39;s rarely such a thing as &quot;too long of a question&quot; as long as the provided info is useful."}, {"owner": {"reputation": 463, "user_id": 1334774, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7d88edc75310ad969e13e15238191979?s=128&d=identicon&r=PG", "display_name": "Bocky", "link": "https://stackoverflow.com/users/1334774/bocky"}, "reply_to_user": {"reputation": 5751, "user_id": 1101692, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0207bd98c9e3f6f855d82aff720437aa?s=128&d=identicon&r=PG", "display_name": "Shark", "link": "https://stackoverflow.com/users/1101692/shark"}, "edited": false, "score": 0, "creation_date": 1460559849, "post_id": 36601668, "comment_id": 60801930, "body": "@Shark thanks i will try that!"}, {"owner": {"reputation": 463, "user_id": 1334774, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7d88edc75310ad969e13e15238191979?s=128&d=identicon&r=PG", "display_name": "Bocky", "link": "https://stackoverflow.com/users/1334774/bocky"}, "reply_to_user": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1460559879, "post_id": 36601668, "comment_id": 60801955, "body": "@DevSolar Does that mean you don&#39;t get the error? Thanks for the help anyway and sorry for earlier."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 1, "creation_date": 1460559965, "post_id": 36601668, "comment_id": 60802022, "body": "No, I don&#39;t get a segfault out of the source after the mentioned edits (which I did to get rid of compiler warnings on <code>-Wall -Wextra</code>, which is why I was asking about the <code>incompatible pointer type</code> warning earlier). And I really meant that. A C/C++ course without teaching debugger use is negligent."}, {"owner": {"reputation": 5751, "user_id": 1101692, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0207bd98c9e3f6f855d82aff720437aa?s=128&d=identicon&r=PG", "display_name": "Shark", "link": "https://stackoverflow.com/users/1101692/shark"}, "edited": false, "score": 0, "creation_date": 1460619302, "post_id": 36601668, "comment_id": 60829504, "body": "<a href=\"http://lldb.llvm.org/lldb-gdb.html\" rel=\"nofollow noreferrer\">Here&#39;s something you can find useful</a> It&#39;ll be useful for GDB and LLDB, the iOS debugger."}], "owner": {"reputation": 463, "user_id": 1334774, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7d88edc75310ad969e13e15238191979?s=128&d=identicon&r=PG", "display_name": "Bocky", "link": "https://stackoverflow.com/users/1334774/bocky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 785, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1460559032, "creation_date": 1460557996, "last_edit_date": 1460559032, "question_id": 36601668, "link": "https://stackoverflow.com/questions/36601668/iterator-in-c-for-linked-list", "title": "Iterator in C for linked list", "body": "<p>I am a new to C and currently trying to learn how to build a iterator for C. I set myself this question:</p>\n\n<blockquote>\n  <p>Create a queue program that stores a variable Data in it. Data contains char* name, int classroom, int labroom. Load the following data into the program:</p>\n</blockquote>\n\n<pre><code>Name:RP-SIT, Labs:4, Classrooms:20\nName:NP-SIT, Labs:6, Classrooms:30\nName:NYP-SIT, Labs:12, Classrooms:60\nName:SP-SIT, Labs:4, Classrooms:12\nName:NUS-Yale, Labs:50, Classrooms:60\n</code></pre>\n\n<p>This is the program that I built:</p>\n\n<pre><code>typedef struct data{\n        char* name;\n        int classroom;\n        int labroom;\n    }Data;\n\n    typedef struct queue_element{\n        Data d;\n        struct queue_element* next;\n    }Node;\n\n    typedef struct queue{\n        Node* first;\n        Node* last;\n        int count;\n    }Queue;\nQueue* Create(){\n    Queue* q = (Queue*)malloc(sizeof(Queue));\n\n    if(q){\n        q-&gt;first = NULL;\n        q-&gt;last = NULL;\n        q-&gt;count = 0L;\n    }\n\n    return q;\n}\n\nint Enqueue(Queue* q, Data d){\n    Node* n = (Node*)malloc(sizeof(Node));\n    if(!n)\n        return 0;\n    n-&gt;next = NULL;\n    n-&gt;d = d;\n\n    if(q-&gt;count++ == 0){\n        q-&gt;first = n;\n    }\n\n    else{\n        q-&gt;last-&gt;next = n;\n    }\n    q-&gt;last = n;\n    return 1;\n}\n\nData Dequeue(Queue* q){\n    Node* n;\n    Data d;\n\n    if(q-&gt;count == 0)\n        return d;\n\n    n = q-&gt;first;\n    d= n-&gt;d;\n\n    q-&gt;first = n-&gt;next;\n    free(n);\n    q-&gt;count--;\n    q-&gt;last = NULL;\n\n    return d;\n}\n\nint main(int argc, char* argv[]){\n    Queue* q;\n    Data d1 = {\"RP-SIT\", 20, 4},d2 = {\"NP-SIT\", 30, 6}, d3 = {\"NYP-SIT\",60,12}, d4={\"SP-SIT\", 12, 4}, d5 = {\"NUS-Yale\", 60, 50};\n\n\n    if((q=Create()) == NULL){\n        printf(\"Error creating Queue\");\n        exit(1);\n    }\n\n    if(!Enqueue(q,d1)){\n        printf(\"Error enqueuing data\");\n        exit(1);\n    }\n    if(!Enqueue(q,d2)){\n        printf(\"Error enqueuing data\");\n        exit(1);\n    }\n    if(!Enqueue(q,d3)){\n        printf(\"Error enqueuing data\");\n        exit(1);\n    }\n    if(!Enqueue(q,d4)){\n        printf(\"Error enqueuing data\");\n        exit(1);\n    }\n    if(!Enqueue(q,d5)){\n        printf(\"Error enqueuing data\");\n        exit(1);\n    }\n    Data d;\n    for(int i = 0; i&lt;5; i++){\n        d = Dequeue(q);\n        printf(\"Name:%s, Labs:%d, Classrooms:%d\\n\",d.name, d.labroom, d.classroom);\n    }\n    return 1;\n}\n</code></pre>\n\n<p>I am trying to add in a function that makes use of a Iterator to display the information without popping the information out of the Queue. This is my iterator code: </p>\n\n<pre><code>typedef struct iterator{\n    long next;\n    long size;\n    void* *elements;\n}Iterator;\n\nIterator* Iter_Create(void* *elements, long size){\n    Iterator* it = (Iterator*)malloc(sizeof(Iterator));\n\n    if(it){\n        it-&gt;next = 0L;\n        it-&gt;size = size;\n        it-&gt;elements = elements;\n    }\n    return it;\n}\n\nint it_hasNext(Iterator* it){\n    return((it-&gt;next&lt;it-&gt;size)? 1: 0);\n}\n\nvoid* it_Next(Iterator* it, void* elements){\n    if(it-&gt;next &lt; it-&gt;size){\n        elements = it-&gt;elements[it-&gt;next++];\n    }\n\n    return elements;\n}\n\nvoid it_Destroy(Iterator* it){\n    free(it-&gt;elements);\n    free(it);\n}\n</code></pre>\n\n<p>I used this code in main to display the information retrieved.</p>\n\n<pre><code>Data* de;\nIterator* it = Iter_Create(q, q-&gt;count);\n\nwhile(it_hasNext(it) == 1){\n    de = it_Next(it,q);\n    printf(\"Name:%s, Labs:%d, Classrooms:%d\\n\",de-&gt;name, de-&gt;labroom, de-&gt;classroom);\n}\n\nit_Destroy(it);\n</code></pre>\n\n<p>This is where I need all your help. I can't figure out why I am getting this segmentation fault when displaying the data. This is my output with the iterator code added:</p>\n\n<pre><code>Name:RP-SIT, Labs:4, Classrooms:20\nName:NUS-Yale, Labs:50, Classrooms:60\nSegmentation fault: 11\n</code></pre>\n\n<p>Sorry for the long question but I wanted to be as clear as I can be. Thanks for the help!</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 2, "creation_date": 1460556360, "post_id": 36600895, "comment_id": 60798768, "body": "You are an assembler developer and you ask about this?"}, {"owner": {"reputation": 35, "user_id": 5586651, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-G3xq2_NeE84/AAAAAAAAAAI/AAAAAAAAACE/OgxRDZ14Qlw/photo.jpg?sz=128", "display_name": "Rezan ", "link": "https://stackoverflow.com/users/5586651/rezan"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1460556482, "post_id": 36600895, "comment_id": 60798879, "body": "@MartinJames you are right.acually I got confused with that, I have tried many ways but it did not  worked for me."}, {"owner": {"reputation": 273, "user_id": 2583273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ce4fb79b249f7cd6e36f027d7cf654a?s=128&d=identicon&r=PG", "display_name": "Schullz", "link": "https://stackoverflow.com/users/2583273/schullz"}, "edited": false, "score": 1, "creation_date": 1460557178, "post_id": 36600895, "comment_id": 60799471, "body": "Do you want to split string &quot;E3A00001&quot; to &quot;E3 A0 00 01&quot;? I can&#39;t figure out what do you want"}, {"owner": {"reputation": 35, "user_id": 5586651, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-G3xq2_NeE84/AAAAAAAAAAI/AAAAAAAAACE/OgxRDZ14Qlw/photo.jpg?sz=128", "display_name": "Rezan ", "link": "https://stackoverflow.com/users/5586651/rezan"}, "reply_to_user": {"reputation": 273, "user_id": 2583273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ce4fb79b249f7cd6e36f027d7cf654a?s=128&d=identicon&r=PG", "display_name": "Schullz", "link": "https://stackoverflow.com/users/2583273/schullz"}, "edited": false, "score": 0, "creation_date": 1460557439, "post_id": 36600895, "comment_id": 60799692, "body": "@Schullz yes please that is exactly what l need, thank you."}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 1, "creation_date": 1460557549, "post_id": 36600895, "comment_id": 60799816, "body": "Where is your C code that outputs this?"}], "answers": [{"tags": [], "owner": {"reputation": 175, "user_id": 6158383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/894a52419735dbf898e7551359ca7b2a?s=128&d=identicon&r=PG&f=1", "display_name": "G. Emadi", "link": "https://stackoverflow.com/users/6158383/g-emadi"}, "is_accepted": true, "score": 1, "last_activity_date": 1460557638, "creation_date": 1460557638, "answer_id": 36601508, "question_id": 36600895, "link": "https://stackoverflow.com/questions/36600895/separate-output-data-in-c-language/36601508#36601508", "title": "separate output data in c language", "body": "<p>You can pass read line to sprintf to get the converted string:</p>\n\n<pre><code> sprintf (converted, \"%c%c %c%c %c%c %c%c%s\",line [0],line [1],line [2],line [3],line [4],line [5],line [6],line [7], &amp;line [8]);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 5586651, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-G3xq2_NeE84/AAAAAAAAAAI/AAAAAAAAACE/OgxRDZ14Qlw/photo.jpg?sz=128", "display_name": "Rezan ", "link": "https://stackoverflow.com/users/5586651/rezan"}, "edited": false, "score": 0, "creation_date": 1460583330, "post_id": 36602015, "comment_id": 60816667, "body": "thank you for your answer, but my data is in string."}, {"owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "reply_to_user": {"reputation": 35, "user_id": 5586651, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-G3xq2_NeE84/AAAAAAAAAAI/AAAAAAAAACE/OgxRDZ14Qlw/photo.jpg?sz=128", "display_name": "Rezan ", "link": "https://stackoverflow.com/users/5586651/rezan"}, "edited": false, "score": 0, "creation_date": 1460587419, "post_id": 36602015, "comment_id": 60818452, "body": "@Rezan Then you can simply change <code>fscanf()</code> and <code>fprintf() to </code>sscanf()` and <code>sprintf()</code>"}], "tags": [], "owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "is_accepted": false, "score": 0, "last_activity_date": 1460558804, "creation_date": 1460558804, "answer_id": 36602015, "question_id": 36600895, "link": "https://stackoverflow.com/questions/36600895/separate-output-data-in-c-language/36602015#36602015", "title": "separate output data in c language", "body": "<p>This code seems quite ugly, but it does work. Anyway, 8 characters per line isn't a great number, so I think it make sense to do this job \"manually\".</p>\n\n<pre><code>#include &lt;stdio.h&gt; \n\nint main(void)\n{\n    FILE *fin, *fout;\n    fin = fopen(\"in.asm\", \"r\");\n    fout = fopen(\"out.asm\", \"w\");\n    char word[8];\n    char str[80];\n    while(fscanf(fin, \" %c%c%c%c%c%c%c%c%[^\\n]\", &amp;word[0], &amp;word[1], &amp;word[2], &amp;word[3], &amp;word[4], &amp;word[5], &amp;word[6], &amp;word[7], str) == 9)\n    {\n        fprintf(fout, \"%c%c %c%c %c%c %c%c\\t%s\\n\", word[0], word[1], word[2], word[3], word[4], word[5], word[6], word[7], str);\n    }\n    fclose(fin);\n    fclose(fout);\n}\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 5586651, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-G3xq2_NeE84/AAAAAAAAAAI/AAAAAAAAACE/OgxRDZ14Qlw/photo.jpg?sz=128", "display_name": "Rezan ", "link": "https://stackoverflow.com/users/5586651/rezan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "closed_date": 1461737291, "accepted_answer_id": 36601508, "answer_count": 2, "score": -3, "last_activity_date": 1460582641, "creation_date": 1460556284, "last_edit_date": 1460582641, "question_id": 36600895, "link": "https://stackoverflow.com/questions/36600895/separate-output-data-in-c-language", "closed_reason": "Not suitable for this site", "title": "separate output data in c language", "body": "<p>I just want to ask about how to separate output data in c language, my data code is defined as machine code data , I have used WORD instruction for 4 byte.</p>\n\n<pre><code>      typedef uint32_t REGISTER;        // registers are 32 bits\n      typedef uint32_t WORD;            // words are 32 bits\n      typedef uint8_t BYTE;             // bytes are 8 bits\n</code></pre>\n\n<p>my out put is:</p>\n\n<pre><code>      E3A00001     MOV r0,#1\n      E3A01002     MOV r1,#2\n      E0802001     ADD r2,r0,r1\n      E2822005     ADD r2,r2,#5\n</code></pre>\n\n<p>And I want to separate them like this:</p>\n\n<pre><code>       E3 A0 00 01       MOV r0,#1\n       E3 A0 10 02       MOV r1,#2\n       E0 80 20 01       ADD r2,r0,r1\n       E2 82 20 05       ADD r2,r2,#5\n</code></pre>\n"}, {"tags": ["c", "linux", "pipe", "fork"], "answers": [{"tags": [], "owner": {"reputation": 1369, "user_id": 5771399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c801f6ed43d6b594cfe250a6bf05333?s=128&d=identicon&r=PG&f=1", "display_name": "v7d8dpo4", "link": "https://stackoverflow.com/users/5771399/v7d8dpo4"}, "is_accepted": true, "score": 0, "last_activity_date": 1460556299, "creation_date": 1460556299, "answer_id": 36600902, "question_id": 36600731, "link": "https://stackoverflow.com/questions/36600731/c-fork-pipe-and-read-fucntion-gives-random-bytes-from-file-descriptor/36600902#36600902", "title": "c fork pipe and read fucntion gives random bytes from file descriptor", "body": "<p>The second argument to <code>read</code> is a pointer to the buffer. The second argument to <code>write</code> is a pointer to the data to write. So you should use</p>\n\n<pre><code>read(pfd2[0], buffer, 512)\n</code></pre>\n\n<p>and</p>\n\n<pre><code>write(pfd2[1], str, BUFFSIZE)\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 2265733, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/IcQfA.jpg?s=128&g=1", "display_name": "travisspears", "link": "https://stackoverflow.com/users/2265733/travisspears"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "accepted_answer_id": 36600902, "answer_count": 1, "score": 0, "last_activity_date": 1460556299, "creation_date": 1460555917, "question_id": 36600731, "link": "https://stackoverflow.com/questions/36600731/c-fork-pipe-and-read-fucntion-gives-random-bytes-from-file-descriptor", "title": "c fork pipe and read fucntion gives random bytes from file descriptor", "body": "<p>hi I'm having some problems with my c program. The goal is to <code>fork</code> twice and then pass some data with <code>pipe</code> from child two to child one and then some different data from child one to parent and finally print it out in parent. Here is my code:</p>\n\n<pre><code>int main(void)\n{\n    int f,f2,nread;\n    int pfd[2], pfd2[2];\n    char buffer[512], *str;\n\n    if(pipe(pfd)==-1) {\n        errorHandler(\"pipe\");\n    }\n\n    if((f=fork())==-1) {\n        errorHandler(\"fork 1\");\n    } else if(f == 0) {\n        /*child 1*/\n        if(pipe(pfd2)==-1) {\n            errorHandler(\"pipe 2\");\n        }\n        if((f2=fork())==-1) {\n            errorHandler(\"fork 2\");\n        } else if(f2 == 0) {\n            /*child 2*/\n            close(pfd[0]);\n            close(pfd[1]);\n            close(pfd2[0]);\n            str = \"rollin\";\n            printf(\"-child 2 writing: %s\\n\", str);\n            if(write(pfd2[1], &amp;str, BUFFSIZE)==-1) {\n                errorHandler(\"write 2\");\n            }\n        } else {\n            /*child 1*/\n            close(pfd[0]);\n            close(pfd2[1]);\n            if((nread=read(pfd2[0], &amp;buffer, 512))==-1) {\n                errorHandler(\"read child 1\");\n            }\n\n            buffer[nread] = 0;\n            printf(\"child 1 read data %d [%s]\\n\", nread, buffer);\n\n            str = \"patrollin patrolling hehe\";\n            printf(\"-child 1 writing %s\\n\", str);\n            if(write(pfd[1], &amp;str, BUFFSIZE)==-1) {\n                errorHandler(\"write\");\n            }\n        }\n    } else {\n        /*parent*/\n        close(pfd[1]);\n        if((nread=read(pfd[0], buffer, sizeof(buffer)))==-1) {\n            errorHandler(\"read\");\n        } else {\n            buffer[nread] = 0;\n            printf(\"parent read data: %d [%s]\\n\", nread, buffer);\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>The output is that the data is read(512 bytes as I specified) but it is not what i sent. I take some random signs from the memory instead(file descriptors are passeed properly, right?).\nThe reason I came here is I cannot figure out what is wrong with this. I have a program with only one fork and similar action and it's based on the same techniques and it is working. Can anyone give me a hint what am I doing wrong?</p>\n"}, {"tags": ["c", "xcode"], "answers": [{"comments": [{"owner": {"reputation": 1700, "user_id": 4683166, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/e428451c1dfeb9f3ff4b391a11194ade?s=128&d=identicon&r=PG&f=1", "display_name": "Omar N", "link": "https://stackoverflow.com/users/4683166/omar-n"}, "edited": false, "score": 0, "creation_date": 1460554014, "post_id": 36599800, "comment_id": 60796729, "body": "I&#39;ve got debugging switched to &quot;Release&quot; for Run, Test, Profile, Analyze, and Archive.  I thought this would turn debugging off and hence solve the problem altogether.  Perhaps I am mistaken?"}, {"owner": {"reputation": 115642, "user_id": 299924, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/71fc84230717311db1410d7106273128?s=128&d=identicon&r=PG", "display_name": "trojanfoe", "link": "https://stackoverflow.com/users/299924/trojanfoe"}, "reply_to_user": {"reputation": 1700, "user_id": 4683166, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/e428451c1dfeb9f3ff4b391a11194ade?s=128&d=identicon&r=PG&f=1", "display_name": "Omar N", "link": "https://stackoverflow.com/users/4683166/omar-n"}, "edited": false, "score": 0, "creation_date": 1460554099, "post_id": 36599800, "comment_id": 60796799, "body": "@OmarN That&#39;s the issue then.  Put it back to <code>Debug</code>.  You want debugging turned on all the time you are developing and counter-intuitively &quot;Running&quot; actually means &quot;Debugging&quot; in Xcode."}, {"owner": {"reputation": 1700, "user_id": 4683166, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/e428451c1dfeb9f3ff4b391a11194ade?s=128&d=identicon&r=PG&f=1", "display_name": "Omar N", "link": "https://stackoverflow.com/users/4683166/omar-n"}, "edited": false, "score": 0, "creation_date": 1460554319, "post_id": 36599800, "comment_id": 60797004, "body": "The issue with that is then I just get a message saying <code>(lldb)</code> and I am not sure what that means :/"}, {"owner": {"reputation": 1700, "user_id": 4683166, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/e428451c1dfeb9f3ff4b391a11194ade?s=128&d=identicon&r=PG&f=1", "display_name": "Omar N", "link": "https://stackoverflow.com/users/4683166/omar-n"}, "edited": false, "score": 0, "creation_date": 1460554540, "post_id": 36599800, "comment_id": 60797206, "body": "Oh, interesting...once I get the <code>(lldb)</code> message, if I go up to the Debug menu and choose Continue, THEN the program gives the expected output.  Strange, is there a way to just run the program without having to do that?"}, {"owner": {"reputation": 115642, "user_id": 299924, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/71fc84230717311db1410d7106273128?s=128&d=identicon&r=PG", "display_name": "trojanfoe", "link": "https://stackoverflow.com/users/299924/trojanfoe"}, "reply_to_user": {"reputation": 1700, "user_id": 4683166, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/e428451c1dfeb9f3ff4b391a11194ade?s=128&d=identicon&r=PG&f=1", "display_name": "Omar N", "link": "https://stackoverflow.com/users/4683166/omar-n"}, "edited": false, "score": 0, "creation_date": 1460554681, "post_id": 36599800, "comment_id": 60797315, "body": "I don&#39;t understand why it&#39;s stopping, unless you have set a breakpoint?"}, {"owner": {"reputation": 1700, "user_id": 4683166, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/e428451c1dfeb9f3ff4b391a11194ade?s=128&d=identicon&r=PG&f=1", "display_name": "Omar N", "link": "https://stackoverflow.com/users/4683166/omar-n"}, "edited": false, "score": 0, "creation_date": 1460554793, "post_id": 36599800, "comment_id": 60797399, "body": "Ah, yes, that was it!  Now it works.  Thank you so much trojanfoe!  This is my second day using Xcode, so lots to learn I guess.  Thank you!"}], "tags": [], "owner": {"reputation": 115642, "user_id": 299924, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/71fc84230717311db1410d7106273128?s=128&d=identicon&r=PG", "display_name": "trojanfoe", "link": "https://stackoverflow.com/users/299924/trojanfoe"}, "is_accepted": true, "score": 2, "last_activity_date": 1460553759, "creation_date": 1460553759, "answer_id": 36599800, "question_id": 36599700, "link": "https://stackoverflow.com/questions/36599700/do-not-understand-message-received-after-running-temperature-convert-program/36599800#36599800", "title": "Do not understand message received after running temperature convert program", "body": "<p>Assuming <code>hw2</code> is the name of your program, then the debugger is complaining that it was compiled with optimisations turned on, which isn't normal during development, as the optimizer does all sorts of clever things to get the program running faster.</p>\n\n<p>You need to do the following in Xcode:</p>\n\n<ul>\n<li>Ensure you are debugging using the <code>Debug</code> build configuration (Check your Schemes).</li>\n<li>Ensure you haven't turned on Optimizations for the <code>Debug</code> build configuration (Check your Build Settings).</li>\n</ul>\n"}], "owner": {"reputation": 1700, "user_id": 4683166, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/e428451c1dfeb9f3ff4b391a11194ade?s=128&d=identicon&r=PG&f=1", "display_name": "Omar N", "link": "https://stackoverflow.com/users/4683166/omar-n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 36599800, "answer_count": 1, "score": 0, "last_activity_date": 1460553759, "creation_date": 1460553541, "question_id": 36599700, "link": "https://stackoverflow.com/questions/36599700/do-not-understand-message-received-after-running-temperature-convert-program", "title": "Do not understand message received after running temperature convert program", "body": "<p>I am new to C and trying to write a program using Xcode that takes the temperature in Fahrenheit and converts it to Celsius, and vise versa.  My code so far is below.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"hw2.h\"\n\nvoid convert_temp(int degree1, char scale1, int* degree2, char* scale2){\n\n    if (scale1 == 'F') {\n        *degree2 = ((degree1 - 32) * 5) / 9;\n        *scale2 = 'C';\n    }\n    else {\n\n        *degree2 = ((degree1 * 9) / 5) + 32;\n        *scale2 = 'F';\n    }\n}\n\nint main() {\n    int degree1, degree2;\n    char scale1, scale2;\n    printf(\"Enter a temperature and a scale\\n\");\n    scanf(\"%d %c\", &amp;degree1, &amp;scale1);\n    convert_temp(degree1, scale1, &amp;degree2, &amp;scale2);\n    printf(\"%d %c = %d %c\\n\", degree1, scale1, degree2, scale2);\n    return 0;\n}\n</code></pre>\n\n<p>Here is an example of correct i/o:</p>\n\n<pre><code>Enter a temperature and a scale\n32 F\n32 F = 0 C\n</code></pre>\n\n<p>However, when I run the code, this is what I get:</p>\n\n<pre><code>Enter a temperature and a scale\n32 F\nhw2 was compiled with optimization - stepping may behave oddly; variables may not be available.\n(lldb) \n</code></pre>\n\n<p>I cannot understand the output I am getting.  Can anybody tell me why I do not get <code>32 F = 0 C</code> on my output?  Everything in my code seems fine to me.</p>\n"}, {"tags": ["c", "struct", "malloc", "padding", "free"], "comments": [{"owner": {"reputation": 501, "user_id": 2045648, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dLIS2.jpg?s=128&g=1", "display_name": "Akash Chandwani", "link": "https://stackoverflow.com/users/2045648/akash-chandwani"}, "edited": false, "score": 0, "creation_date": 1460551891, "post_id": 36598832, "comment_id": 60794799, "body": "@user71815 I don&#39;t think it&#39;s necessary, better compile and check. (&amp; then let us know)"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 3, "creation_date": 1460552012, "post_id": 36598832, "comment_id": 60794914, "body": "Why would you ever write code like this?"}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1460552157, "post_id": 36598832, "comment_id": 60795048, "body": "It is definitely a strange thing to do.  I would never write code like this.  Why not just free the original pointer, instead of trying to infer it from the address of a structure member?"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "reply_to_user": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1460552346, "post_id": 36598832, "comment_id": 60795238, "body": "@TomKarzes yeah - what happens when someone shoves in another thing at the start?"}, {"owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "edited": false, "score": 0, "creation_date": 1460553077, "post_id": 36598832, "comment_id": 60795902, "body": "&quot;Delete this question if it has already been asked.&quot; No. Other people may found it useful some years later."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1460553803, "post_id": 36598832, "comment_id": 60796537, "body": "@user71815 In the edit, you seem to free the same pointer that you got from malloc? If so, it isn&#39;t the same case as your original question."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1460554822, "post_id": 36598832, "comment_id": 60797418, "body": "@user71815 Ok, I see what you&#39;re trying to do, i.e. use a common structure prefix for variable structures.  But you should still be able to use the top-level pointer, without referencing the first member to get the address."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1460578662, "post_id": 36598832, "comment_id": 60814191, "body": "@TomKarzes: Code which is supposed to receive one of several structure types that share a common prefix, act upon the passed object, and then free it, might only receive a pointer to the common-prefix structure rather than a pointer to the containing structure."}, {"owner": {"reputation": 251699, "user_id": 895245, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/jhDFt.png?s=128&g=1", "display_name": "Ciro Santilli\u65b0\u7586\u68c9\u82b1TRUMP BAN BAD", "link": "https://stackoverflow.com/users/895245/ciro-santilli%e6%96%b0%e7%96%86%e6%a3%89%e8%8a%b1trump-ban-bad"}, "edited": false, "score": 0, "creation_date": 1462700863, "post_id": 36598832, "comment_id": 61739647, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/7312555/in-c-does-a-pointer-to-a-structure-always-point-to-its-first-member\">In C, does a pointer to a structure always point to its first member?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 5, "last_activity_date": 1460553119, "last_edit_date": 1460553119, "creation_date": 1460551777, "answer_id": 36598937, "question_id": 36598832, "link": "https://stackoverflow.com/questions/36598832/is-it-vali-to-call-free-with-a-pointer-to-the-first-member/36598937#36598937", "title": "Is it vali to call free with a pointer to the first member?", "body": "<p>As per the C11 standard, chapter \u00a76.7.2.1</p>\n\n<blockquote>\n  <p>[...] There may be unnamed\n  padding within a structure object, but not at its beginning.</p>\n</blockquote>\n\n<p>which means there cannot be any padding at the beginning of a structure. So, the first member will have the same address as that of the structure variable.</p>\n\n<p><code>free()</code> needs a pointer which has been previously returned by <code>malloc()</code> or family.</p>\n\n<p>In your case, you're passing the same address that <code>malloc()</code> had returned. So, you're good to go.</p>\n"}, {"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 6, "creation_date": 1460553168, "post_id": 36598949, "comment_id": 60795986, "body": "Yes, it is OK in the sense that the behavior is defined by the standard and is what was probably intended.  But no, it is <b>not</b> OK in the sense that it is poor style, as it opens avenues for surprising failures later, in the event that the structure definition is modified."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1460555724, "post_id": 36598949, "comment_id": 60798218, "body": "The standard does not guarantee a pointer to one type is identical to a pointer to another type, except for <code>char *</code>. Thus, no, it is <b>not ok</b>. It just happens to work on (allmost) all recent implementations because they use a unified address space."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 1, "creation_date": 1460557024, "post_id": 36598949, "comment_id": 60799326, "body": "Even if those two pointers, <code>s</code> and <code>p</code>,  are of different size, different alignment, and have different representation, they still point to the same address and the same object, and thus using either to free the memory is strictly conforming."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1460557202, "post_id": 36598949, "comment_id": 60799490, "body": "They definitively don&#39;t point to the same object. Reason should be clear: the types differ. I&#39;m with you about the address. 7.22.3.3p2 is relevant, too. Considering the conversions to/from <code>void *</code> you seem to be right it is allowed, though. I still think it is bad practice and might confuse static code-checkers. Anyway, I withdraw my objection, but your answer should have more info."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1460578977, "post_id": 36598949, "comment_id": 60814370, "body": "@Olaf: Taking the address of the first item of a structure is equivalent to converting that structure&#39;s address to that type.  That operation may on some implementations involve changing the bit representation of the pointer, but if one starts with a non-null void* returned from malloc, conversion of the pointer through any sequence of pointer-to-data types and back to void* is guaranteed to yield the original pointer."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1460584243, "post_id": 36598949, "comment_id": 60817121, "body": "@supercat: Which is exactly the reason I changed my mind. But thanks for elaborating a bit more, beginners might appreciate it. I still would reject such code because it (unnecessarily) obfuscates the intention."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1460584819, "post_id": 36598949, "comment_id": 60817368, "body": "@Olaf: If one has a number of structures which share a common prefix and needs to have a function which can work with any of them, one may not have a way of finding out the original structure type from the pointer (especially if the common prefix includes pointers to functions that operate on the type in question--in which case the type might not even have existed when the code receiving the pointer was written)."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1460585590, "post_id": 36598949, "comment_id": 60817695, "body": "@supercat: What would be the difference passing the pointer to the <code>struct</code> itself? A function taking an e.g. <code>int *</code>, but <code>free</code>ing the <code>struct</code> <b>implicitly</b> is very bad coding style. This is not about finding the &quot;original&quot; structure, but using a different pointer type to free an object. I&#39;d kick anyone showing such code to me where it really hurts."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1460614884, "post_id": 36598949, "comment_id": 60826881, "body": "@Olaf: As I said, one wouldn&#39;t generally do this with primitives, but rather with nested structures used to achieve the same semantics as object-oriented languages offer with inheritance.  In languages like Java, C#, etc. if one defines a type <code>Animal</code> and has types <code>Cat</code> and <code>Dog</code> derive from animal, code which expects a reference to an <code>Animal</code> can accept a reference to a <code>Cat</code> or <code>Dog</code>.  To achieve that functionality in C, types <code>Cat</code> and <code>Dog</code> would both start with an <code>Animal</code> as their first field, and code which expects to receive a pointer to some kind of struct derived from <code>Animal</code>..."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1460615199, "post_id": 36598949, "comment_id": 60827034, "body": "...would accept an <code>*Animal</code>. An alternative approach use the fact that compilers used to interpret the &quot;common initial subsequence&quot; rule as applying to typecast pointers just as it applies to unions, but such treatment by compilers has become unfashionable.  Passing a pointer to a nested structure is icky but it&#39;s the only way hyper-modern compilers allow for code to receive a pointer to a structure whose exact type is unknown but whose initial sequence is known."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1460637365, "post_id": 36598949, "comment_id": 60842416, "body": "@supercat Have a look at gcc <code>-fplan9-extensions</code>. You might find it very interesting. No need to explicitly use the first member."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1460648565, "post_id": 36598949, "comment_id": 60851794, "body": "@Olaf: Such a thing isn&#39;t part of the Standard.  Passing a pointer to the first member is icky, but it is allowed in strictly-conforming code.  Personally what I&#39;d like to see would be directives to specify an aliasing model; one model every compiler should support is &quot;assume anything might alias anything&quot; (so programs including such directive would be specified to work regardless of a compiler&#39;s normal aliasing assumptions), and a model which is generally much stricter than the standard <i>but</i> would include intrinsics via which programmers could identify places where aliasing is required."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1460648878, "post_id": 36598949, "comment_id": 60852021, "body": "@Olaf: The exemption of &quot;character types&quot; from the aliasing rules is a nasty horrible hack which should have been recognized as obsolescent from the get-go, since it can significantly degrade the performance of code which needs to work with large quantities of &quot;real&quot; character-type data, so a directive to waive that exemption could greatly improve the performance of such code.  Further, code which uses character pointers or memcpy within a loop will block a compiler from caching global variables through the loop; allowing a programmer to specify, before the loop, that things of type X..."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1460649079, "post_id": 36598949, "comment_id": 60852158, "body": "...will be used <i>exclusively</i> as type Y within the loop would allow the compiler to ensure that any global variables of type X are synchronized with memory before the loop starts, and again after the loop ends, but would avoid requiring any synchronization within the loop."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1460662377, "post_id": 36598949, "comment_id": 60859958, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/109190/discussion-between-olaf-and-supercat\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "is_accepted": true, "score": 7, "last_activity_date": 1460551811, "last_edit_date": 1592644375, "creation_date": 1460551811, "answer_id": 36598949, "question_id": 36598832, "link": "https://stackoverflow.com/questions/36598832/is-it-vali-to-call-free-with-a-pointer-to-the-first-member/36598949#36598949", "title": "Is it vali to call free with a pointer to the first member?", "body": "<p>Yes this is ok.</p>\n<blockquote>\n<p>6.7.2.1</p>\n<ol start=\"15\">\n<li>Within a structure object, the non-bit-field members and the units in which bit-fields\nreside have addresses that increase in the order in which they are declared. <em>A pointer to a\nstructure object, suitably converted, points to its initial member (or if that member is a\nbit-field, then to the unit in which it resides), and vice versa.</em> There may be unnamed\npadding within a structure object, but not at its beginning.</li>\n</ol>\n</blockquote>\n<p>Which means that this is defined:</p>\n<pre><code>struct s {int x;};\nstruct s* test;\ntest = (struct s*) malloc(sizeof(*test));\nint* p = &amp;(test-&gt;x);\nfree(p);\n</code></pre>\n"}], "owner": {"reputation": 233, "user_id": 3614107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/500ce44ed6ff4b1ab0d499ab92b46423?s=128&d=identicon&r=PG", "display_name": "user71815", "link": "https://stackoverflow.com/users/3614107/user71815"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "accepted_answer_id": 36598949, "answer_count": 2, "score": 11, "last_activity_date": 1462700829, "creation_date": 1460551513, "last_edit_date": 1462700829, "question_id": 36598832, "link": "https://stackoverflow.com/questions/36598832/is-it-vali-to-call-free-with-a-pointer-to-the-first-member", "title": "Is it vali to call free with a pointer to the first member?", "body": "<p>Is it okay to call free on a pointer which is pointing at the first member of a struct (and the struct is the one involved with malloc)? I know in principle the pointer is pointing at the right thing anyway...</p>\n\n<pre><code>struct s {int x;};\n//in main\nstruct s* test;\ntest = (struct s*) malloc(sizeof(*test));\nint* test2;\ntest2 = &amp;(test-&gt;x);\nfree(test2); //is this okay??\n</code></pre>\n\n<p>Also, will the answer change if <code>int x</code> is replaced with a struct?</p>\n\n<p><strong>Update: Why would I want to write code like this?</strong></p>\n\n<pre><code>struct s {int x;};\nstruct sx1 {struct s test; int y;}; //extending struct s\nstruct sx2 {struct s test; int z;}; //another\n// ** some functions to keep track of the number of references to each variable of type struct s \nint release(struct s* ptr){\n  //if the number of references to *ptr is 0 call free on ptr\n}\nint main(){\n    struct sx1* test1;\n    struct sx2* test2;\n    test1 = (sx1*) malloc(sizeof(*sx1));\n    test2 = (sx2*) malloc(sizeof(*sx2));\n    //code that changes the number of references to test1 and test2, calling functions defined in **\n    release(test1);\n    release(test2);\n}\n</code></pre>\n"}, {"tags": ["c", "swift"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 6196123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/129e532da047fc3191e7b44bff556d26?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/6196123/chris"}, "edited": false, "score": 0, "creation_date": 1460685157, "post_id": 36635009, "comment_id": 60868815, "body": "I gave it a try and unfortunately it did not work.  The first attempt generated the following error: `swift build -Xlinker /usr/local/lib Linking swiftodbc ld: can&#39;t map file, errno=22 file &#39;/usr/local/lib&#39; for architecture x86_64 &lt;unknown&gt;:0: error: link command failed with exit code 1 (use -v to see invocation) &lt;unknown&gt;:0: error: build had 1 command failures error: exit(1): /Library/Developer/Toolchains/swift-DEVELOPMENT-SNAPSHOT-201&zwnj;&#8203;6-03-01-a.xctoolchai&zwnj;&#8203;n/usr/bin/swift-buil&zwnj;&#8203;d-tool -f /Users/cwhelan/development/swift/swiftodbc/.build/debug.yaml default&#39;"}, {"owner": {"reputation": 37, "user_id": 6196123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/129e532da047fc3191e7b44bff556d26?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/6196123/chris"}, "edited": false, "score": 0, "creation_date": 1460685707, "post_id": 36635009, "comment_id": 60868968, "body": "The message indicated that it wanted a full file path so I next tried the full path to the odbc library: swift build -Xlinker /usr/local/lib/libodbc.dylib.  This eliminated the &quot;can&#39;t map file&quot; error, but the error from the original post returned."}, {"owner": {"reputation": 24280, "user_id": 6444, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1510549f9353c9859b7b3c81872df09c?s=128&d=identicon&r=PG", "display_name": "mxcl", "link": "https://stackoverflow.com/users/6444/mxcl"}, "reply_to_user": {"reputation": 37, "user_id": 6196123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/129e532da047fc3191e7b44bff556d26?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/6196123/chris"}, "edited": false, "score": 1, "creation_date": 1460744000, "post_id": 36635009, "comment_id": 60901372, "body": "Sorry it should have been: <code>-Xlinker -L&#47;usr&#47;local&#47;lib</code>"}], "tags": [], "owner": {"reputation": 24280, "user_id": 6444, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1510549f9353c9859b7b3c81872df09c?s=128&d=identicon&r=PG", "display_name": "mxcl", "link": "https://stackoverflow.com/users/6444/mxcl"}, "is_accepted": true, "score": 3, "last_activity_date": 1460744013, "last_edit_date": 1460744013, "creation_date": 1460672395, "answer_id": 36635009, "question_id": 36598515, "link": "https://stackoverflow.com/questions/36598515/os-x-swift-build-package-manager-cannot-find-shared-library-from-unixodbc-c-depe/36635009#36635009", "title": "os x swift build package manager cannot find shared library from unixODBC C dependency", "body": "<p>Try adding: <code>-Xlinker -L/usr/local/lib</code> to your <code>swift build</code> instantiation.</p>\n"}], "owner": {"reputation": 37, "user_id": 6196123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/129e532da047fc3191e7b44bff556d26?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/6196123/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 639, "favorite_count": 0, "accepted_answer_id": 36635009, "answer_count": 1, "score": 0, "last_activity_date": 1548282119, "creation_date": 1460550799, "question_id": 36598515, "link": "https://stackoverflow.com/questions/36598515/os-x-swift-build-package-manager-cannot-find-shared-library-from-unixodbc-c-depe", "title": "os x swift build package manager cannot find shared library from unixODBC C dependency", "body": "<p>On OS X El Capitan, I am attempting to integrate a <strong>swift</strong> wrapper for <strong>unixODBC 2.3.4</strong>, but the build fails at the linker step with the following error: </p>\n\n<p><code>ld: library not found for -lodbc.2 for architecture x86_64</code></p>\n\n<p>I immediately confirmed that the installed library is in fact 64 bit:</p>\n\n<pre><code>file /usr/local/lib/libodbc.dylib \n/usr/local/lib/libodbc.dylib: Mach-O 64-bit dynamically linked shared library x86_64 \n</code></pre>\n\n<p>For my project, I am utilizing the <strong>swift package manager</strong>, so I have installed the latest developer bits for swift and prepended its bin folder to my <code>PATH</code> environment variable:</p>\n\n<p><code>export PATH=/Library/Developer/Toolchains/swift-latest.xctoolchain/usr/bin:$PATH</code>  </p>\n\n<p>I installed <strong>unixODBC 2.3.4</strong> successfully using homebrew and created the requisite odbcinst.ini and odbc.ini files to access a postegresql database.  I confirmed that the odbc installation and configuration are correct by connecting to a remote database with the isql utility included by unixODBC. </p>\n\n<p>In my <strong>CunixODBC</strong> swift project I created the following <strong>module.modulemap</strong> file referencing the newly installed unixODBC shared library</p>\n\n<pre><code>module CunixODBC [system] {\n   header \"/usr/local/Cellar/unixodbc/2.3.4/include/unixodbc_conf.h\"\n   header \"/usr/local/Cellar/unixodbc/2.3.4/include/sql.h\"\n   header \"/usr/local/Cellar/unixodbc/2.3.4/include/sqltypes.h\"\n   link \"odbc\" \n   export *\n}\n</code></pre>\n\n<p>In my <strong>swiftodbc</strong> project that establishes the dependency on CunixODBC, my Package.swift file is:</p>\n\n<pre><code>import PackageDescription\n\nlet package = Package(\n    dependencies: [\n        .Package(url: \"../CunixODBC\", versions: Version(0,0,4)..&lt;Version(1,0,0))\n    ]\n)\n</code></pre>\n\n<p>As additional confirmation that unixODBC is functioning correctly, I wrote a small test program in <strong>C</strong> and linked to the unixODBC shared library.  My compile string is:</p>\n\n<pre><code>cc  -L/usr/local/lib -I/usr/local/Cellar/unixodbc/2.3.4/include -lodbc odbctest.c -o odbctest \n</code></pre>\n\n<p>The compile and link succeed and resulting executable works as expected.</p>\n\n<p>What step or configuration am I missing?</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 14855, "user_id": 3159253, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/046000bcd9bbb664fc01891f558baa0d?s=128&d=identicon&r=PG&f=1", "display_name": "user3159253", "link": "https://stackoverflow.com/users/3159253/user3159253"}, "edited": false, "score": 0, "creation_date": 1460549602, "post_id": 36597943, "comment_id": 60792750, "body": "use a sequence of typedef&#39;s. This clarifies things a lot."}, {"owner": {"reputation": 6024, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 0, "creation_date": 1460549606, "post_id": 36597943, "comment_id": 60792753, "body": "Make <code>typedef</code> for pointer to function and then use it for function definition."}, {"owner": {"reputation": 25137, "user_id": 4498831, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/jDBV2.png?s=128&g=1", "display_name": "Boiethios", "link": "https://stackoverflow.com/users/4498831/boiethios"}, "edited": false, "score": 2, "creation_date": 1460549670, "post_id": 36597943, "comment_id": 60792800, "body": "This is a typical example of crap code."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1460551892, "post_id": 36597943, "comment_id": 60794801, "body": "<i>Sorry this is a sample quiz can&#39;t use typedef</i>   Is the point of this quiz to teach people how <b>not</b> to write code?"}, {"owner": {"reputation": 3984, "user_id": 4062451, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c62a4b86f88400a422c10d43567ac3bf?s=128&d=identicon&r=PG&f=1", "display_name": "spacegoing", "link": "https://stackoverflow.com/users/4062451/spacegoing"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1460558188, "post_id": 36597943, "comment_id": 60800368, "body": "@AndrewHenle I don&#39;t like it neither. Guess it&#39;s only to test how well students understand the syntax :D."}], "answers": [{"comments": [{"owner": {"reputation": 3984, "user_id": 4062451, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c62a4b86f88400a422c10d43567ac3bf?s=128&d=identicon&r=PG&f=1", "display_name": "spacegoing", "link": "https://stackoverflow.com/users/4062451/spacegoing"}, "edited": false, "score": 0, "creation_date": 1460549772, "post_id": 36598007, "comment_id": 60792897, "body": "Sorry it&#39;s a sample quiz from a course which can&#39;t use typedef :P. Would you please show me the full version?"}, {"owner": {"reputation": 3984, "user_id": 4062451, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c62a4b86f88400a422c10d43567ac3bf?s=128&d=identicon&r=PG&f=1", "display_name": "spacegoing", "link": "https://stackoverflow.com/users/4062451/spacegoing"}, "edited": false, "score": 0, "creation_date": 1460550225, "post_id": 36598007, "comment_id": 60793307, "body": "thank you for your answer. But please don&#39;t worry it&#39;s a sample for mid-term quiz."}, {"owner": {"reputation": 3984, "user_id": 4062451, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c62a4b86f88400a422c10d43567ac3bf?s=128&d=identicon&r=PG&f=1", "display_name": "spacegoing", "link": "https://stackoverflow.com/users/4062451/spacegoing"}, "edited": false, "score": 0, "creation_date": 1460550557, "post_id": 36598007, "comment_id": 60793636, "body": "Sorry but I tried your answer in several parsers and still got a syntax error. What&#39;s the difference between yours and mine? Many thanks!"}, {"owner": {"reputation": 3984, "user_id": 4062451, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c62a4b86f88400a422c10d43567ac3bf?s=128&d=identicon&r=PG&f=1", "display_name": "spacegoing", "link": "https://stackoverflow.com/users/4062451/spacegoing"}, "edited": false, "score": 0, "creation_date": 1460551222, "post_id": 36598007, "comment_id": 60794241, "body": "Sorry for the bother. Would you please see my update and make some explanations? Many thanks!"}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 3984, "user_id": 4062451, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c62a4b86f88400a422c10d43567ac3bf?s=128&d=identicon&r=PG&f=1", "display_name": "spacegoing", "link": "https://stackoverflow.com/users/4062451/spacegoing"}, "edited": false, "score": 0, "creation_date": 1460551313, "post_id": 36598007, "comment_id": 60794314, "body": "@spacegoing Don&#39;t rely on a single source of Truth."}], "tags": [], "owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "is_accepted": true, "score": 5, "last_activity_date": 1460550273, "last_edit_date": 1460550273, "creation_date": 1460549617, "answer_id": 36598007, "question_id": 36597943, "link": "https://stackoverflow.com/questions/36597943/declaration-of-function-returning-a-pointer-of-another-function/36598007#36598007", "title": "Declaration of function returning a pointer of another function", "body": "<p>The correct way to write that is to use a typedef:</p>\n\n<pre><code>typedef int*(*fp)(int*);\ntypedef int(*fi)(int);\n\nfi function(fp p);\n</code></pre>\n\n<p>The correct way to write this without typedef is:</p>\n\n<pre><code>int ( *( function( int*(*p)(int*) ) ) )(int);\n</code></pre>\n"}], "owner": {"reputation": 3984, "user_id": 4062451, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c62a4b86f88400a422c10d43567ac3bf?s=128&d=identicon&r=PG&f=1", "display_name": "spacegoing", "link": "https://stackoverflow.com/users/4062451/spacegoing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 36598007, "answer_count": 1, "score": 2, "last_activity_date": 1460552367, "creation_date": 1460549459, "last_edit_date": 1460551640, "question_id": 36597943, "link": "https://stackoverflow.com/questions/36597943/declaration-of-function-returning-a-pointer-of-another-function", "title": "Declaration of function returning a pointer of another function", "body": "<p>(Sorry this is a sample quiz can't use typedef:P) I'm trying to write a declaration for the following function:</p>\n\n<p>A function:</p>\n\n<p>Accepts a pointer points to a function accepts a pointer to int and returns a pointer to int.</p>\n\n<p>Returns a pointer to a function accepts int and returns int.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>int (* sigal(int *(*f)(int *)))(int);\n</code></pre>\n\n<p>However, this is a syntactical error. What's the right way to write it?</p>\n\n<hr>\n\n<p>Edited:</p>\n\n<p>The error seems to be there shouldn't be an <code>f</code>. I tried both my original code and </p>\n\n<p><code>int (* sigal(int *(*)(int *)))(int);</code> </p>\n\n<p>on <a href=\"http://www.cdecl.org/\" rel=\"nofollow\">http://www.cdecl.org/</a>. The later is passed.</p>\n\n<p>Any explanation on what's the problem?</p>\n\n<hr>\n\n<p>Update: </p>\n\n<p>As 2501 said, the error seems to be a flavor of parser. </p>\n"}, {"tags": ["c++", "c", "sip", "pjsip"], "answers": [{"tags": [], "owner": {"reputation": 869, "user_id": 887420, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/WHuOw.jpg?s=128&g=1", "display_name": "Ilian Zapryanov", "link": "https://stackoverflow.com/users/887420/ilian-zapryanov"}, "is_accepted": false, "score": 0, "last_activity_date": 1460554421, "creation_date": 1460554421, "answer_id": 36600071, "question_id": 36597830, "link": "https://stackoverflow.com/questions/36597830/why-pjmedia-snd-port-create-fails-initializing-the-sound-port/36600071#36600071", "title": "Why pjmedia_snd_port_create(...) fails initializing the sound port?", "body": "<p>I`ve fixed it with initialising loop, I guess it has nothing to do with the setup, what I need is actually to register all of my playback and rec devices from my hardware. </p>\n"}], "owner": {"reputation": 869, "user_id": 887420, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/WHuOw.jpg?s=128&g=1", "display_name": "Ilian Zapryanov", "link": "https://stackoverflow.com/users/887420/ilian-zapryanov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 125, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1460554421, "creation_date": 1460549167, "question_id": 36597830, "link": "https://stackoverflow.com/questions/36597830/why-pjmedia-snd-port-create-fails-initializing-the-sound-port", "title": "Why pjmedia_snd_port_create(...) fails initializing the sound port?", "body": "<p>I am trying to initialise a sound port from pjsip and pjsua with the standart pjmedia_snd_port_create but the result is always not successful.</p>\n\n<pre><code>pj_caching_pool_init(&amp;cp, &amp;pj_pool_factory_default_policy, 0);\n\n            pool = pj_pool_create(&amp;cp.factory,\n                                  \"pool1\",\n                                  4000,\n                                  4000,\n                                  NULL);\n\n            pjmedia_snd_port *snd_port1 = NULL;\n\n            status = pjmedia_snd_port_create(pool, id1, id1, clock_rate,\n                                                 channel_count, samples_per_frame,\n                                                 bits_per_sample,\n                                                 0, &amp;snd_port1);\n</code></pre>\n\n<p>My device id1 is 0, as i got it from the audio device manager. I`ve tried with the -1 for defaults but always fails me. I have endpoint created with the pjsua2 api from a C++ class, the lib is OK and running, I can create conference bridges also but the sound port fails me. A bit of a hint will be great. </p>\n"}, {"tags": ["c", "int", "arm", "fixed-point"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 3, "creation_date": 1460548781, "post_id": 36597566, "comment_id": 60792071, "body": "What do you mean with &quot;fixed point&quot;? Is it of the form 123.45? Or is it just an integer?"}, {"owner": {"reputation": 63, "user_id": 2362043, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/236199da7297f13aec63329410a77159?s=128&d=identicon&r=PG", "display_name": "Jirka", "link": "https://stackoverflow.com/users/2362043/jirka"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1460549189, "post_id": 36597566, "comment_id": 60792428, "body": "It is data from gyroscope: <a href=\"http://www.lp-research.com/site/wp-content/uploads/2012/05/LpmsAllUsersGuide1.3.4.pdf\" rel=\"nofollow noreferrer\">---LINK---</a>, page 45. And it is fixed point in form: <code>123.45</code> or <code>-123.45</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1460549485, "post_id": 36597566, "comment_id": 60792655, "body": "The linked data sheet shows factors of 100 or 1000, not 256. It&#39;s true that 0x100 would be 256 but there is no suggestion that it is hexadecimal."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1460558316, "post_id": 36597566, "comment_id": 60800492, "body": "Have you tried <code>return val&#47;100.0f;</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 63, "user_id": 2362043, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/236199da7297f13aec63329410a77159?s=128&d=identicon&r=PG", "display_name": "Jirka", "link": "https://stackoverflow.com/users/2362043/jirka"}, "is_accepted": false, "score": 1, "last_activity_date": 1460550369, "creation_date": 1460550369, "answer_id": 36598335, "question_id": 36597566, "link": "https://stackoverflow.com/questions/36597566/convert-signed-fixed-point-to-float/36598335#36598335", "title": "Convert signed fixed point to float", "body": "<p>Ok. I wrong understood.\nSo the gyroscope data return in int16 x 1000. When I used function:</p>\n\n<pre><code>float toFloat(int16_t val) {\n    return ((float)val)/1000.0f;\n}\n</code></pre>\n\n<p>Now is receiving data good.</p>\n"}], "owner": {"reputation": 63, "user_id": 2362043, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/236199da7297f13aec63329410a77159?s=128&d=identicon&r=PG", "display_name": "Jirka", "link": "https://stackoverflow.com/users/2362043/jirka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 227, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1460550369, "creation_date": 1460548434, "question_id": 36597566, "link": "https://stackoverflow.com/questions/36597566/convert-signed-fixed-point-to-float", "title": "Convert signed fixed point to float", "body": "<p><strong>I have got number in this mode:</strong>\nValue mode = 16-bit fixed point (signed)</p>\n\n<p>And how I can convert this number to floating point? Any idea?</p>\n\n<p>Can I use this function, when this number is signed?</p>\n\n<pre><code>float toFloat(int16_t val) {\n        return ((float)val)/256.0f;\n    }\n</code></pre>\n"}, {"tags": ["c++", "c", "bit-manipulation", "bitwise-operators", "consistent-hashing"], "comments": [{"owner": {"reputation": 19025, "user_id": 599792, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7ce404c8d35df762a599cb5173f18456?s=128&d=identicon&r=PG", "display_name": "Gareth McCaughan", "link": "https://stackoverflow.com/users/599792/gareth-mccaughan"}, "edited": false, "score": 0, "creation_date": 1460547697, "post_id": 36597195, "comment_id": 60791180, "body": "Is it actually modulo an arbitrary number, or is it always modulo something of the form 0...01...1?"}, {"owner": {"reputation": 63, "user_id": 2756736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/259d2f8c26fdc42f3e869493d3e96b5d?s=128&d=identicon&r=PG&f=1", "display_name": "tmh1999", "link": "https://stackoverflow.com/users/2756736/tmh1999"}, "reply_to_user": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1460548137, "post_id": 36597195, "comment_id": 60791522, "body": "@stark : pow(2,160) ~ 1e48. I don&#39;t think long int can cover that."}, {"owner": {"reputation": 19025, "user_id": 599792, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7ce404c8d35df762a599cb5173f18456?s=128&d=identicon&r=PG", "display_name": "Gareth McCaughan", "link": "https://stackoverflow.com/users/599792/gareth-mccaughan"}, "edited": false, "score": 0, "creation_date": 1460548150, "post_id": 36597195, "comment_id": 60791534, "body": "... And is the modulus a full 160 bits long, or will it always be shorter?"}, {"owner": {"reputation": 19025, "user_id": 599792, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7ce404c8d35df762a599cb5173f18456?s=128&d=identicon&r=PG", "display_name": "Gareth McCaughan", "link": "https://stackoverflow.com/users/599792/gareth-mccaughan"}, "edited": false, "score": 0, "creation_date": 1460548167, "post_id": 36597195, "comment_id": 60791557, "body": "I don&#39;t believe stark was suggesting that everything will fit in a long int."}, {"owner": {"reputation": 63, "user_id": 2756736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/259d2f8c26fdc42f3e869493d3e96b5d?s=128&d=identicon&r=PG&f=1", "display_name": "tmh1999", "link": "https://stackoverflow.com/users/2756736/tmh1999"}, "reply_to_user": {"reputation": 19025, "user_id": 599792, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7ce404c8d35df762a599cb5173f18456?s=128&d=identicon&r=PG", "display_name": "Gareth McCaughan", "link": "https://stackoverflow.com/users/599792/gareth-mccaughan"}, "edited": false, "score": 0, "creation_date": 1460548672, "post_id": 36597195, "comment_id": 60791988, "body": "@Gareth : it&#39;s an arbitrary number. And the dividend is 160 bits long, the divisor is smaller than 160 bits long. @ stark: Could you kindly explain for me about long division you are talking about ? I am kind of lost here. I just dont think that 160 bit binary hash can be represented by a long int number."}, {"owner": {"reputation": 19025, "user_id": 599792, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7ce404c8d35df762a599cb5173f18456?s=128&d=identicon&r=PG", "display_name": "Gareth McCaughan", "link": "https://stackoverflow.com/users/599792/gareth-mccaughan"}, "edited": false, "score": 0, "creation_date": 1460548817, "post_id": 36597195, "comment_id": 60792110, "body": "Long division is the procedure you probably learned in school for dividing arbitrary-length (decimal) numbers by one another. You can do it in other bases too; for this application you can do it on 160-digit binary numbers or on 5-digit base-2^32 numbers."}, {"owner": {"reputation": 19025, "user_id": 599792, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7ce404c8d35df762a599cb5173f18456?s=128&d=identicon&r=PG", "display_name": "Gareth McCaughan", "link": "https://stackoverflow.com/users/599792/gareth-mccaughan"}, "edited": false, "score": 0, "creation_date": 1460548867, "post_id": 36597195, "comment_id": 60792156, "body": "Will the divisor always fit in, say, a 32-bit unsigned integer? That would enable the code for the &quot;base 2^32&quot; version to be simpler and quicker."}], "answers": [{"tags": [], "owner": {"reputation": 19025, "user_id": 599792, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7ce404c8d35df762a599cb5173f18456?s=128&d=identicon&r=PG", "display_name": "Gareth McCaughan", "link": "https://stackoverflow.com/users/599792/gareth-mccaughan"}, "is_accepted": true, "score": 1, "last_activity_date": 1460548747, "creation_date": 1460548747, "answer_id": 36597679, "question_id": 36597195, "link": "https://stackoverflow.com/questions/36597195/consistent-hashing-sha1-modulo-operation/36597679#36597679", "title": "Consistent hashing SHA1 modulo operation", "body": "<p>As user <em>stark</em> points out (more rudely than necessary, I think) in comments, this is just long division in base 2^32. Or in base 2, with more digits. And you can use the algorithm for long division that you learned in school for base 10.</p>\n\n<p>There are fancier algorithms for doing division on much bigger numbers, but for your application I suspect you can afford to do it very simply and inefficiently, along the following lines (this is the base-2 version, which just amounts to subtracting off left-shifted versions of the denominator until you can no longer do so):</p>\n\n<pre><code>// Treat x,y as 160-bit numbers, where [0] is least significant and\n// [4] is most significant. Compute x mod y, and put the result in out.\nvoid mod160(unsigned int out[5], const unsigned int x[5], const unsigned y[5]) {\n  unsigned int temp[5];\n  copy160(out, x);\n  copy160(temp, y);\n  int n=0;\n  // Find first 1-bit in quotient.\n  while (lessthanhalf160(temp, x)) { lshift160(temp); ++n; }\n  while (n&gt;=0) {\n    if (!less160(out, temp)) sub160(out, temp); // quotient bit is 1\n    rshift160(temp); --n; // proceed to next bit of quotient\n  }\n}\n</code></pre>\n\n<p>For the avoidance of doubt, the above is only a crude sketch:</p>\n\n<ul>\n<li>It may be full of bugs.</li>\n<li>I haven't written the implementations of the building-block functions like <code>less160</code>.</li>\n<li>Actually you'd probably just put the code for those inline rather than having separate functions. E.g., <code>copy160</code> is just five assignments, or a short loop, or a <code>memcpy</code>.</li>\n</ul>\n\n<p>It could surely be made more efficient; e.g., that first step might do better to count leading 0-bits and then do a single shift, instead of shifting one place at a time. (The right-shifting probably doesn't want to do that, though, because half the time you will be doing only a single shift.)</p>\n\n<p>The \"base-2^32\" version may well be faster, but the implementation will be a bit more complicated.</p>\n"}], "owner": {"reputation": 63, "user_id": 2756736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/259d2f8c26fdc42f3e869493d3e96b5d?s=128&d=identicon&r=PG&f=1", "display_name": "tmh1999", "link": "https://stackoverflow.com/users/2756736/tmh1999"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 644, "favorite_count": 0, "accepted_answer_id": 36597679, "answer_count": 1, "score": 0, "last_activity_date": 1460548747, "creation_date": 1460547450, "last_edit_date": 1460548433, "question_id": 36597195, "link": "https://stackoverflow.com/questions/36597195/consistent-hashing-sha1-modulo-operation", "title": "Consistent hashing SHA1 modulo operation", "body": "<p>I hope some guru here could help me out </p>\n\n<p>I am writing a C/C++ code to implement Consistent Hashing using SHA1 as the hashing algorithm.</p>\n\n<p>I need to implement module operation as follow :</p>\n\n<p><code>0100 0011....0110 100 mod 0010 1001 = ?</code></p>\n\n<p>If the divisor (<code>0000 1111</code>) is a power of 2 <code>pow(2,n)</code> , then it would be easy as the last n bit of dividend is the result.</p>\n\n<p>SHA1 length is 160 bit ( or 40 hexa ). My question is how do I implement a modulo operation of a long bit string to another arbitrary bit string?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["c++", "c", "linux-kernel", "libpcap"], "comments": [{"owner": {"reputation": 1026, "user_id": 5583153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/116adeea4dcb2db23e70b696d4949184?s=128&d=identicon&r=PG&f=1", "display_name": "Nacho", "link": "https://stackoverflow.com/users/5583153/nacho"}, "edited": false, "score": 0, "creation_date": 1460552742, "post_id": 36597189, "comment_id": 60795598, "body": "&quot;<i>e.g. on wireshark on a third non-involved computer</i>&quot;. How exactly are you measuring the delay? Sending a packet from this non-involved computer to the one with libpcap and receiving the response back, hence measuring the round trip? If that&#39;s the case you also have the network delay to take into account. If you are comparing timestamps from different computers you could also be facing a time sync problem between them."}, {"owner": {"reputation": 69, "user_id": 6154383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9724507576a2722020a3374f624332aa?s=128&d=identicon&r=PG&f=1", "display_name": "Joojoo", "link": "https://stackoverflow.com/users/6154383/joojoo"}, "reply_to_user": {"reputation": 1026, "user_id": 5583153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/116adeea4dcb2db23e70b696d4949184?s=128&d=identicon&r=PG&f=1", "display_name": "Nacho", "link": "https://stackoverflow.com/users/5583153/nacho"}, "edited": false, "score": 0, "creation_date": 1460615668, "post_id": 36597189, "comment_id": 60827300, "body": "I was sniffing it with a NuDog device in TAP mode. And so i only compare the timestamps from one computer. But now with pcap_set_immediate_mode() function i can decrease the delay dramatically!"}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 6154383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9724507576a2722020a3374f624332aa?s=128&d=identicon&r=PG&f=1", "display_name": "Joojoo", "link": "https://stackoverflow.com/users/6154383/joojoo"}, "edited": false, "score": 0, "creation_date": 1460615411, "post_id": 36611521, "comment_id": 60827150, "body": "Thanks for your reply! So i can decrease the delay up to a average of 150 microseconds...  I don&#39;t know why i didn&#39;t found that solution on my own, but it is always seen in examples only with pcap_open_live() and thats it."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user862787"}, "is_accepted": true, "score": 3, "last_activity_date": 1460591650, "creation_date": 1460591650, "answer_id": 36611521, "question_id": 36597189, "link": "https://stackoverflow.com/questions/36597189/libpcap-delay-between-receiving-frames-and-call-of-callback-function/36611521#36611521", "title": "libpcap: Delay between receiving frames and call of callback-function", "body": "<blockquote>\n  <p>For my planned application it is necessary to react to incoming packets in a time under <strong><em>100 microseconds</em></strong>.</p>\n</blockquote>\n\n<p>Then the buffering that many of the capture mechanisms atop which libpcap runs (BPF except on AIX, TPACKET_V3 on Linux with newer libpcap and kernel, DLPI on Solaris 10 and earlier, etc.) provide in order to reduce per-packet overhead would get in your way.</p>\n\n<p>If the libpcap on your system has the <code>pcap_set_immediate_mode()</code> function, then:</p>\n\n<ul>\n<li>use <code>pcap_create()</code> and <code>pcap_activate()</code>, rather than <code>pcap_open_live()</code>, to open the capture device;</li>\n<li>call <code>pcap_set_immediate_mode()</code> between the <code>pcap_create()</code> and <code>pcap_activate()</code> calls.</li>\n</ul>\n\n<p>In \"immediate mode\", packets should be delivered to the application by the capture mechanism as soon as the capture mechanism receives them.</p>\n"}], "owner": {"reputation": 69, "user_id": 6154383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9724507576a2722020a3374f624332aa?s=128&d=identicon&r=PG&f=1", "display_name": "Joojoo", "link": "https://stackoverflow.com/users/6154383/joojoo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1281, "favorite_count": 3, "accepted_answer_id": 36611521, "answer_count": 1, "score": 3, "last_activity_date": 1460591650, "creation_date": 1460547440, "question_id": 36597189, "link": "https://stackoverflow.com/questions/36597189/libpcap-delay-between-receiving-frames-and-call-of-callback-function", "title": "libpcap: Delay between receiving frames and call of callback-function", "body": "<p>i am experiencing the following situation:\nI open with <code>pcap_open_live()</code> one of my network-interfaces. Then i am compiling a filter for pcap for only capturing a specified ethernet-type (<code>ether proto 0x1234</code>). Now i am starting the <code>pcap_loop()</code>. The only thing, that the callback-function executes, is to send a frame via <code>pcap_inject()</code>. (The frame is hard-coded as a global char array).</p>\n\n<p>When i compare now the timestamps of the received and the sent frame (e.g. on wireshark on a third non-involved computer) the delay is around 3 milliseconds (minumum 1 millisecond, but also up to 10 milliseconds). So pcap needs in average around 3 milliseconds to proceed with the received frame and calling the callback-function for sending the new frame.\nI want/have to decrease that delay.</p>\n\n<p>Following things i already tried:</p>\n\n<ul>\n<li>tried all different variants of <em>read-timout (in ms)</em> in <code>pcap_open_live()</code>: even a read-timout of -1, which should be to my knowledge a polling, generates a delay of around 3 milliseconds</li>\n<li>setting no filter</li>\n<li>setting a higher priority to process</li>\n<li>set <code>InterrupThrottleRate=0</code> and other parameters of the <code>e1000</code>/<code>e1000e</code>-kernel module to force the hardware sending an interrupt for every single frame</li>\n</ul>\n\n<p>But i never decreased the delay under the average of 3 milliseconds.</p>\n\n<p>For my planned application it is necessary to react to incoming packets in a time unter <strong><em>100 microseconds</em></strong>.\nIs this even generally doable with libpcap?! Or are there any other suggestions for realizing such a application?</p>\n\n<p>Thanks for all your replies,\ni hope anyone can help me!</p>\n\n<p><em>Notes</em>: I am deploying under Linux/Ubuntu in C/C++.</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 3, "creation_date": 1460547330, "post_id": 36597107, "comment_id": 60790872, "body": "Do not write in the memory after end of heap buffer."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 3, "creation_date": 1460547415, "post_id": 36597107, "comment_id": 60790952, "body": "<i>im making a pointer array to strings and this issue happened</i>  <code>char* arrs;</code> this is not a pointer array. It is a pointer."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 3, "creation_date": 1460547476, "post_id": 36597107, "comment_id": 60791000, "body": "Seriously, this <a href=\"http://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">error would be more obvious if you <b>didn&#39;t</b> cast the return value of `malloc&#39;</a>."}, {"owner": {"reputation": 119, "user_id": 5708094, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/cd5c4dd8aee4b857d50d4823bfe9a504?s=128&d=identicon&r=PG&f=1", "display_name": "uSEwrasd", "link": "https://stackoverflow.com/users/5708094/usewrasd"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1460547534, "post_id": 36597107, "comment_id": 60791052, "body": "@wildplasser I tried with ** also its not working too."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1460547570, "post_id": 36597107, "comment_id": 60791082, "body": "Sorry but your question is unanswerable unless you explain <b>what the code is supposed to do when it is working correctly</b>."}, {"owner": {"reputation": 119, "user_id": 5708094, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/cd5c4dd8aee4b857d50d4823bfe9a504?s=128&d=identicon&r=PG&f=1", "display_name": "uSEwrasd", "link": "https://stackoverflow.com/users/5708094/usewrasd"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1460547626, "post_id": 36597107, "comment_id": 60791128, "body": "@AnttiHaapala Still same error"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1460548084, "post_id": 36597107, "comment_id": 60791483, "body": "Your crt does bounds checking?  Nice:)"}], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 5708094, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/cd5c4dd8aee4b857d50d4823bfe9a504?s=128&d=identicon&r=PG&f=1", "display_name": "uSEwrasd", "link": "https://stackoverflow.com/users/5708094/usewrasd"}, "edited": false, "score": 0, "creation_date": 1460548381, "post_id": 36597248, "comment_id": 60791730, "body": "I have noticed the issue happens because the free and not because the code here but thanks too you helped me understand some stuff! What is the proper way to free it?"}, {"owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "reply_to_user": {"reputation": 119, "user_id": 5708094, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/cd5c4dd8aee4b857d50d4823bfe9a504?s=128&d=identicon&r=PG&f=1", "display_name": "uSEwrasd", "link": "https://stackoverflow.com/users/5708094/usewrasd"}, "edited": false, "score": 0, "creation_date": 1460548718, "post_id": 36597248, "comment_id": 60792025, "body": "@uSEwrasd Answer improved"}, {"owner": {"reputation": 697, "user_id": 1020559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78516734de5c440b49559e47ab06e9ff?s=128&d=identicon&r=PG", "display_name": "DaV", "link": "https://stackoverflow.com/users/1020559/dav"}, "edited": false, "score": 0, "creation_date": 1460548965, "post_id": 36597248, "comment_id": 60792241, "body": "<code>arrs[i] = malloc(strlen(x));</code> -&gt; <code>arrs[i] = malloc(strlen(x) + 1);</code>"}, {"owner": {"reputation": 119, "user_id": 5708094, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/cd5c4dd8aee4b857d50d4823bfe9a504?s=128&d=identicon&r=PG&f=1", "display_name": "uSEwrasd", "link": "https://stackoverflow.com/users/5708094/usewrasd"}, "edited": false, "score": 0, "creation_date": 1460549213, "post_id": 36597248, "comment_id": 60792446, "body": "@sunqingyao for some reason \t for (i = 0; i &lt; num; i++) \t{ \t\tfree(friends[i]); \t} this part causes it"}, {"owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "reply_to_user": {"reputation": 119, "user_id": 5708094, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/cd5c4dd8aee4b857d50d4823bfe9a504?s=128&d=identicon&r=PG&f=1", "display_name": "uSEwrasd", "link": "https://stackoverflow.com/users/5708094/usewrasd"}, "edited": false, "score": 0, "creation_date": 1460549617, "post_id": 36597248, "comment_id": 60792762, "body": "@uSEwrasd I cannot understand you: What&#39;s <code>friends[i]</code>? It&#39;ll be helpful if you can provide the relevant code."}, {"owner": {"reputation": 119, "user_id": 5708094, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/cd5c4dd8aee4b857d50d4823bfe9a504?s=128&d=identicon&r=PG&f=1", "display_name": "uSEwrasd", "link": "https://stackoverflow.com/users/5708094/usewrasd"}, "edited": false, "score": 0, "creation_date": 1460550375, "post_id": 36597248, "comment_id": 60793460, "body": "@sunqingyao its a string , (its the same code you wrote here)"}, {"owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "reply_to_user": {"reputation": 119, "user_id": 5708094, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/cd5c4dd8aee4b857d50d4823bfe9a504?s=128&d=identicon&r=PG&f=1", "display_name": "uSEwrasd", "link": "https://stackoverflow.com/users/5708094/usewrasd"}, "edited": false, "score": 0, "creation_date": 1460550644, "post_id": 36597248, "comment_id": 60793718, "body": "@uSEwrasd Can you show me the complete error message?"}], "tags": [], "owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "is_accepted": false, "score": 0, "last_activity_date": 1460549506, "last_edit_date": 1460549506, "creation_date": 1460547591, "answer_id": 36597248, "question_id": 36597107, "link": "https://stackoverflow.com/questions/36597107/how-to-fix-it-crt-detected-that-the-application-wrote-to-memory-after-end-of-he/36597248#36597248", "title": "How to fix it? CRT detected that the application wrote to memory after end of heap buffer", "body": "<p><code>arrs</code> should be a \"pointer to pointer to char\", rather than simply a \"pointer to char\":</p>\n\n<pre><code>char x[50];\nint num = 0;\nint i = 0;\nchar **arrs;                            // &lt;--- pointer to pointer\nprintf(\"Enter number:\");\nscanf(\"%d\", &amp;num);\narrs = malloc(sizeof (char *) * num);   // &lt;--- sizeof (char *)\ngetchar();\nfor (i = 0; i &lt; num; i++)\n{\n    printf(\"Entered str number %d\\n\", i);\n    fgets(x, 50, stdin);\n    arrs[i] = malloc(strlen(x) + 1);    // &lt;--- +1 for the terminating '\\0'\n    strcpy(arrs[i], x);                 // &lt;--- arrs[i] is a char *\n}\n\n// Do something\n\nfor (i = 0; i &lt; num; i++)\n{\n    free(arrs[i]);\n}\nfree(arrs);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 164, "user_id": 6193510, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dRTC5khvm-g/AAAAAAAAAAI/AAAAAAAAFK0/nKLXuPE-F5Y/photo.jpg?sz=128", "display_name": "Nevado", "link": "https://stackoverflow.com/users/6193510/nevado"}, "is_accepted": false, "score": 0, "last_activity_date": 1460547887, "creation_date": 1460547887, "answer_id": 36597355, "question_id": 36597107, "link": "https://stackoverflow.com/questions/36597107/how-to-fix-it-crt-detected-that-the-application-wrote-to-memory-after-end-of-he/36597355#36597355", "title": "How to fix it? CRT detected that the application wrote to memory after end of heap buffer", "body": "<p>The problem is your are allocating memory for an array of chars not an array of String, this is char pointers. Just change <code>sizeof(char)</code> by <code>sizeof(char *)</code></p>\n"}], "owner": {"reputation": 119, "user_id": 5708094, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/cd5c4dd8aee4b857d50d4823bfe9a504?s=128&d=identicon&r=PG&f=1", "display_name": "uSEwrasd", "link": "https://stackoverflow.com/users/5708094/usewrasd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1113, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1460549506, "creation_date": 1460547234, "question_id": 36597107, "link": "https://stackoverflow.com/questions/36597107/how-to-fix-it-crt-detected-that-the-application-wrote-to-memory-after-end-of-he", "title": "How to fix it? CRT detected that the application wrote to memory after end of heap buffer", "body": "<p>im making a pointer array to strings and this issue happened</p>\n\n<p>Is there anythings wrong with my code</p>\n\n<pre><code>char x[50];\nint num = 0;\nint i = 0;\nchar* arrs;\nprintf(\"Enter number\");\nscanf(\"%d\", &amp;num);\narrs = (char*)malloc(sizeof(char) * num);\ngetchar();\nfor (i = 0; i &lt; num; i++)\n{\n    printf(\"Enter str number %d\\n\" , i);\n    fgets(x, 50, stdin);\n    *(arrs+i) = (char)malloc(sizeof(char) * strlen(x));\n    strcpy((arrs+ i), x);\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "caching"], "comments": [{"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 6, "creation_date": 1460546433, "post_id": 36596773, "comment_id": 60790244, "body": "That is not a 2d array, but an array of pointers to arrays."}, {"owner": {"reputation": 25137, "user_id": 4498831, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/jDBV2.png?s=128&g=1", "display_name": "Boiethios", "link": "https://stackoverflow.com/users/4498831/boiethios"}, "edited": false, "score": 0, "creation_date": 1460547279, "post_id": 36596773, "comment_id": 60790838, "body": "differency between array of arrays and 2 dimentional array <a href=\"http://www.c-faq.com/aryptr/dynmuldimary.html\" rel=\"nofollow noreferrer\">c-faq.com/aryptr/dynmuldimary.html</a>"}], "answers": [{"comments": [{"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1460548782, "post_id": 36597137, "comment_id": 60792072, "body": "As long as DIM isn&#39;t too big, I think that should be mentioned."}, {"owner": {"reputation": 23, "user_id": 6198292, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209092012167623/picture?type=large", "display_name": "Alessandro Bertini", "link": "https://stackoverflow.com/users/6198292/alessandro-bertini"}, "edited": false, "score": 0, "creation_date": 1460553379, "post_id": 36597137, "comment_id": 60796162, "body": "Thank you! So in this way i emulare  a 2D array using 1D array?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 23, "user_id": 6198292, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209092012167623/picture?type=large", "display_name": "Alessandro Bertini", "link": "https://stackoverflow.com/users/6198292/alessandro-bertini"}, "edited": false, "score": 0, "creation_date": 1460553952, "post_id": 36597137, "comment_id": 60796679, "body": "@AlessandroBertini No, emulating a 2D array would have been <code>type* ptr = malloc (x*y*sizeof(*ptr))</code>, aka a &quot;mangled array&quot;. This is a true 2D array, I just simplified the syntax a bit to allow you to do <code>tab[x][y]</code> rather than the ugly <code>(*tab)[x][y]</code>. <a href=\"http://stackoverflow.com/a/32050859/584518\">Long-winded explanation of why the above works</a>."}, {"owner": {"reputation": 23, "user_id": 6198292, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209092012167623/picture?type=large", "display_name": "Alessandro Bertini", "link": "https://stackoverflow.com/users/6198292/alessandro-bertini"}, "edited": false, "score": 0, "creation_date": 1460558337, "post_id": 36597137, "comment_id": 60800512, "body": "Ok, so if i want to pass this 2D array to a function, let&#39;s say an Initialization function, in the main loop, what&#39;s the best way to do it?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 23, "user_id": 6198292, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209092012167623/picture?type=large", "display_name": "Alessandro Bertini", "link": "https://stackoverflow.com/users/6198292/alessandro-bertini"}, "edited": false, "score": 0, "creation_date": 1460620089, "post_id": 36597137, "comment_id": 60830072, "body": "@AlessandroBertini Probably <code>void func (size_t x, size_t y, int array[x][y])</code>. The array parameter will decay into a pointer to the first element, that is an array pointer <code>int(*)[y]</code>, the same type as you have in the caller."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 1, "last_activity_date": 1460547822, "last_edit_date": 1460547822, "creation_date": 1460547305, "answer_id": 36597137, "question_id": 36596773, "link": "https://stackoverflow.com/questions/36596773/cache-misses-on-a-two-dimensional-array/36597137#36597137", "title": "Cache Misses on a two dimensional array", "body": "<p>Cache misses is one of many reasons why you should avoid using pointer-based lookup tables to emulate dynamic arrays.</p>\n\n<p>Instead, use a 2D array: </p>\n\n<pre><code>internalNode (*tab)[DIM] = malloc( sizeof(internalNode[DIM][DIM]) );\n\nfree(tab);\n</code></pre>\n\n<p>Now the memory will be adjacent and performance should be much better.</p>\n"}], "owner": {"reputation": 23, "user_id": 6198292, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209092012167623/picture?type=large", "display_name": "Alessandro Bertini", "link": "https://stackoverflow.com/users/6198292/alessandro-bertini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 661, "favorite_count": 1, "accepted_answer_id": 36597137, "answer_count": 1, "score": 0, "last_activity_date": 1460548324, "creation_date": 1460546386, "last_edit_date": 1460548324, "question_id": 36596773, "link": "https://stackoverflow.com/questions/36596773/cache-misses-on-a-two-dimensional-array", "title": "Cache Misses on a two dimensional array", "body": "<p>I have a doubt on how the machines stores a two dimensional array in memory. I'll present you my code in order to be clearer.\nI'm defining a two dimensional array in this way, in my main loop:</p>\n\n<pre><code>int main()\n{\n    int i;\n    internalNode**tab =(internalNode **)malloc(sizeof(internalNode *)* DIM);\n    for (i=0; i&lt;DIM ; i++)\n        tab[i] = (internalNode *)malloc(sizeof(internalNode) * DIM);\n\n    //CODE\n\n    CalculusOnGrid(tab,DIM);\n}\n</code></pre>\n\n<p>Where DIM is a user defined variable and internalNode is a structure.\nIn the function CalculusOnGrid i'm going to do this calculus on the grid ( my two dimensional array):</p>\n\n<pre><code>for(i=1;i&lt;DIM-1;i++)\n    for(j=1;j&lt;DIM-j;i++)\n        tab[i][j].temperature_new = 0.25*tab[i+1][j].temperature+tab[i-1][j].temperature + tab[i][j+1].temperature + tab[i][j-1].temperature);\n</code></pre>\n\n<p>So i'm going to search for the 4 neighbors of my current point (i,j) of the grid.</p>\n\n<p>Here there is my question: I'm going to do a Cache Miss on the upper and below element ( that's to say tab[i+1][] and tab[i-1][]) or on the right and left elements? (that's to say tab[][j+1] and tab[][j-1])</p>\n\n<p>What's your suggestion for speeding up my code and reduce the number of Cache misses?</p>\n\n<p>I hope that the question is proposed in a clear way. If this is not the case, ask me whatever you want!</p>\n\n<p>Thank you!</p>\n\n<p>Alessandro</p>\n"}, {"tags": ["c", "static-analysis", "lint"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1460546175, "post_id": 36596671, "comment_id": 60790078, "body": "Which conversions do you mean? Is <code>unsigned int u = 0;</code> is also an integer-to-unsigned?"}], "answers": [{"comments": [{"owner": {"reputation": 6595, "user_id": 5218277, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZuEZa.jpg?s=128&g=1", "display_name": "Alex Lop.", "link": "https://stackoverflow.com/users/5218277/alex-lop"}, "reply_to_user": {"reputation": 25137, "user_id": 4498831, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/jDBV2.png?s=128&g=1", "display_name": "Boiethios", "link": "https://stackoverflow.com/users/4498831/boiethios"}, "edited": false, "score": 0, "creation_date": 1460546575, "post_id": 36596718, "comment_id": 60790349, "body": "@Morovaille Please post a code that you are trying to compile and that warning doesn&#39;t catch it."}, {"owner": {"reputation": 25137, "user_id": 4498831, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/jDBV2.png?s=128&g=1", "display_name": "Boiethios", "link": "https://stackoverflow.com/users/4498831/boiethios"}, "reply_to_user": {"reputation": 6595, "user_id": 5218277, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZuEZa.jpg?s=128&g=1", "display_name": "Alex Lop.", "link": "https://stackoverflow.com/users/5218277/alex-lop"}, "edited": false, "score": 0, "creation_date": 1460546771, "post_id": 36596718, "comment_id": 60790503, "body": "@AlexLop. It does not catch it in C++. In C it works : I upvoted the answer."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1460546779, "post_id": 36596718, "comment_id": 60790506, "body": "Indeed if one does not want complaints about double-&gt;integer and such, one should use <code>-Wsign-conversion</code>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1460547659, "post_id": 36596718, "comment_id": 60791152, "body": "@AnttiHaapala It seems that <code>-Wconversion</code> includes <code>-Wsign-conversion</code>"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1460547736, "post_id": 36596718, "comment_id": 60791208, "body": "@Lundin it does; my point is that <code>-Wconversion</code> complains much much more than just <code>-Wsign-conversion</code> which should catch all the <code>signed-&gt;unsigned</code>."}, {"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1460547804, "post_id": 36596718, "comment_id": 60791256, "body": "<a href=\"https://godbolt.org/g/aCl11P\" rel=\"nofollow noreferrer\">godbolt.org/g/aCl11P</a> for gcc it also needs <code>-Wsign-conversion</code>. For <code>clang</code> it is included in <code>Wconversion</code>"}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1460548725, "post_id": 36596718, "comment_id": 60792031, "body": "@bolov gcc: In C, this option is enabled also by -Wconversion."}, {"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1460549068, "post_id": 36596718, "comment_id": 60792324, "body": "@2501 oh, ok. Missed the <code>C</code> tag."}], "tags": [], "owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "is_accepted": false, "score": 6, "last_activity_date": 1460546857, "last_edit_date": 1460546857, "creation_date": 1460546257, "answer_id": 36596718, "question_id": 36596671, "link": "https://stackoverflow.com/questions/36596671/how-to-make-gcc-report-int-to-uint-conversion/36596718#36596718", "title": "How to make gcc report int to uint conversion", "body": "<p>Use the flag: <code>-Wconversion</code> which will warn about conversions between signed and unsigned integers that may change a value.</p>\n\n<p><a href=\"https://gcc.gnu.org/onlinedocs/gcc/Warning-Options.html\" rel=\"nofollow\">https://gcc.gnu.org/onlinedocs/gcc/Warning-Options.html</a></p>\n"}, {"tags": [], "owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "is_accepted": false, "score": 3, "last_activity_date": 1460547336, "last_edit_date": 1460547336, "creation_date": 1460546667, "answer_id": 36596882, "question_id": 36596671, "link": "https://stackoverflow.com/questions/36596671/how-to-make-gcc-report-int-to-uint-conversion/36596882#36596882", "title": "How to make gcc report int to uint conversion", "body": "<p>You can use <code>-Wconversion</code>:</p>\n\n<blockquote>\n  <p><code>-Wconversion</code> Warn for implicit conversions that may alter a value.\n  This includes......; conversions between signed and unsigned, like\n  unsigned ui = -1.</p>\n</blockquote>\n\n<p>Or, more specifically, <code>-Wsign-conversion</code>:</p>\n\n<blockquote>\n  <p><code>-Wsign-conversion</code> Warn for implicit conversions that may change the sign of an integer value, like assigning a signed integer expression\n  to an unsigned integer variable. An explicit cast silences the\n  warning. In C, this option is enabled also by <code>-Wconversion</code>.</p>\n</blockquote>\n\n<p>Reference: <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Warning-Options.html#Warning-Options\" rel=\"nofollow\">https://gcc.gnu.org/onlinedocs/gcc/Warning-Options.html#Warning-Options</a></p>\n"}], "owner": {"reputation": 631, "user_id": 3571516, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f9a3507b40e1de7f9d398d1cf06c483d?s=128&d=identicon&r=PG&f=1", "display_name": "vikas", "link": "https://stackoverflow.com/users/3571516/vikas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 270, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1460547336, "creation_date": 1460546122, "question_id": 36596671, "link": "https://stackoverflow.com/questions/36596671/how-to-make-gcc-report-int-to-uint-conversion", "title": "How to make gcc report int to uint conversion", "body": "<p>How can I make gcc compiler report conversions from integers to unsigned integers?\nIs there an option/arg which I can pass to gcc compiler to flag out such conversions?</p>\n"}, {"tags": ["c", "memory", "malloc"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1460546493, "post_id": 36596608, "comment_id": 60790291, "body": "Can be done in exactly the same way."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 2, "creation_date": 1460546968, "post_id": 36596608, "comment_id": 60790639, "body": "there is no <code>cout</code> in <b>C</b>."}], "answers": [{"comments": [{"owner": {"reputation": 192, "user_id": 5947477, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NkNmP.jpg?s=128&g=1", "display_name": "anita2R", "link": "https://stackoverflow.com/users/5947477/anita2r"}, "edited": false, "score": 1, "creation_date": 1460548418, "post_id": 36596933, "comment_id": 60791765, "body": "This answer on SO <a href=\"http://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc/605858#605858\">link</a> indicates quite strongly that malloc should not be cast. array=malloc(4 * sizeof(int));"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 192, "user_id": 5947477, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NkNmP.jpg?s=128&g=1", "display_name": "anita2R", "link": "https://stackoverflow.com/users/5947477/anita2r"}, "edited": false, "score": 0, "creation_date": 1460609628, "post_id": 36596933, "comment_id": 60824889, "body": "@anita2R OP apparently is using C++ but incorrectly tagged question, so malloc would need to be cast there. Also if you read that whole link then <code>malloc(4 * sizeof *array);</code> is the recommended form. Removing cast without also changing the <code>sizeof</code> makes the code worse by removing error-checking."}, {"owner": {"reputation": 192, "user_id": 5947477, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NkNmP.jpg?s=128&g=1", "display_name": "anita2R", "link": "https://stackoverflow.com/users/5947477/anita2r"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1460637772, "post_id": 36596933, "comment_id": 60842766, "body": "@M.M The line shown &#39;array=malloc(4*sizeof(int));` has been edited - it was originally (if I remember correctly)  <code>array=(int *) malloc(4*sizeof(int));</code>, and yes - the OP&#39;s code in the question must be C++ ... although the answer (accepted) appears to be C - which is what I commented on."}], "tags": [], "owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "is_accepted": true, "score": 0, "last_activity_date": 1460609578, "last_edit_date": 1460609578, "creation_date": 1460546795, "answer_id": 36596933, "question_id": 36596608, "link": "https://stackoverflow.com/questions/36596608/output-memory-adresses-of-malloc/36596933#36596933", "title": "output memory adresses of malloc", "body": "<p>Your code could be used exactly the same way to output the <code>malloc</code> allocated memory.</p>\n\n<p>Or you could do the the pointer way like below :</p>\n\n<pre><code>int *array;\narray=malloc(4*sizeof(int);\nfor(int i=0;i&lt;4;i++)\n  printf(\"Address %d : %p\\n\",i,(array+i));\n</code></pre>\n\n<p>What difference would you think it makes, if the memory is allocated automatically or manually(as in malloc)?</p>\n"}], "owner": {"reputation": 71, "user_id": 5595913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf4dbb901e62c7960cff29020ad77672?s=128&d=identicon&r=PG&f=1", "display_name": "sara", "link": "https://stackoverflow.com/users/5595913/sara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 36596933, "answer_count": 1, "score": -2, "last_activity_date": 1460609578, "creation_date": 1460545953, "last_edit_date": 1460609292, "question_id": 36596608, "link": "https://stackoverflow.com/questions/36596608/output-memory-adresses-of-malloc", "title": "output memory adresses of malloc", "body": "<p>The memory address of each element of an array are displayed as</p>\n\n<pre><code>int first[4], n=4;\nfor(int i=0;i&lt;n;i++){\n   cout&lt;&lt;\"first#\" &lt;&lt;i&lt;&lt;\" \"&lt;&lt;&amp;first[i]&lt;&lt;endl; \n}\n</code></pre>\n\n<p>I want to ask how to output the address of each element allocated using malloc?</p>\n\n<pre><code>int *first = (int *) calloc(n, sizeof(int));\n</code></pre>\n"}, {"tags": ["c", "gdbus", "wpa-supplicant"], "answers": [{"tags": [], "owner": {"reputation": 3679, "user_id": 2487336, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6eae2a9fe7257a46c91f0515087e2940?s=128&d=identicon&r=PG", "display_name": "xgord", "link": "https://stackoverflow.com/users/2487336/xgord"}, "is_accepted": true, "score": 0, "last_activity_date": 1460668457, "creation_date": 1460668457, "answer_id": 36634125, "question_id": 36596404, "link": "https://stackoverflow.com/questions/36596404/registering-a-signal-handler-with-wpa-supplicant-p2p-dbus-interface/36634125#36634125", "title": "Registering a signal handler with wpa_supplicant p2p DBus interface", "body": "<p>(Finally found the problem / a solution -- posting here for future gdbus users)</p>\n\n<p><br/></p>\n\n<p>From the <a href=\"https://developer.gnome.org/gio/stable/GDBusProxy.html\" rel=\"nofollow\">GIO documentation for GDBusProxy</a>:</p>\n\n<blockquote>\n  <p>The generic \u201cg-properties-changed\u201d and \u201cg-signal\u201d signals are not very\n  convenient to work with. Therefore, the recommended way of working\n  with proxies is to subclass GDBusProxy, and have more natural\n  properties and signals in your derived class.</p>\n</blockquote>\n\n<p><br/></p>\n\n<p>As this paragraph hints, it turns out that the base <code>GDBusProxy</code> class only supports the two generic signals that all interfaces are guaranteed to have: <code>g-properties-changed</code> and <code>g-signal</code>. Registering for the <code>g-signal</code> signal on a proxy invokes the callback whenever <em>any</em> signal is emitted by the object of the given proxy, including the one I happened to be looking for in this case.</p>\n\n<p>Instead of going the subclassing route suggested in the documentation, I ended up just using a quick-and-dirty catchall handler:</p>\n\n<pre><code>// the new snippet for connecting a signal handler:\ng_signal_connect(p2p_proxy,\n                 \"g-signal\",\n                 G_CALLBACK(on_signal), // stub func that does something simple\n                 NULL);\n</code></pre>\n\n<p>And then checking for which signal was actually called in the callback function:</p>\n\n<pre><code>/* callback function */\nstatic void on_signal (GDBusProxy *proxy,\n                       gchar *sender_name,\n                       gchar *signal_name,\n                       GVariant *params,\n                       gpointer user_data) {\n    if (g_strcmp0(signal_name, \"InvitationReceived\")) {\n        // ignore all irrelevant signals\n        return;\n    } \n\n    g_print(\"InvitationReceived signal received\\n\");\n\n    /* other handling code.... */\n}\n</code></pre>\n"}], "owner": {"reputation": 3679, "user_id": 2487336, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6eae2a9fe7257a46c91f0515087e2940?s=128&d=identicon&r=PG", "display_name": "xgord", "link": "https://stackoverflow.com/users/2487336/xgord"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 917, "favorite_count": 0, "accepted_answer_id": 36634125, "answer_count": 1, "score": 1, "last_activity_date": 1460668457, "creation_date": 1460545398, "last_edit_date": 1460546240, "question_id": 36596404, "link": "https://stackoverflow.com/questions/36596404/registering-a-signal-handler-with-wpa-supplicant-p2p-dbus-interface", "title": "Registering a signal handler with wpa_supplicant p2p DBus interface", "body": "<p>I'm running into issues trying to register to receive the \"InvitationReceived\" signal from wpa_supplicant's dbus interface for p2p using the <code>gdbus</code> library in C. </p>\n\n<p>I can create a proxy connection to the P2P dbus interface just fine and call methods on it, but when I try to connect a signal handler to the proxy, I just get the following error saying the signal is invalid (the relevant output from the code sample):</p>\n\n<blockquote>\n  <p>(process:6764): GLib-GObject-WARNING **:\n  /tmp/buildd/glib2.0-2.42.1/./gobject/gsignal.c:2461: signal\n  'InvitationReceived' is invalid for instance '0x909ae0' of type\n  'GDBusProxy'</p>\n</blockquote>\n\n<p>Which is weird, since \"InvitationReceived\" is the name of the signal as defined by the <a href=\"https://w1.fi/wpa_supplicant/devel/dbus.html\" rel=\"nofollow\">wpa_supplicant dbus api</a>. </p>\n\n<p><br/></p>\n\n<p>Code Sample:</p>\n\n<pre><code>static void on_wpa_ready (GObject *source_object,\n                          GAsyncResult *res,\n                          gpointer user_data) {\n    g_print(\"on_wpa_ready\\n\");\n\n    GError *error = NULL;\n    GVariant *output;  \n\n    GDBusProxy *p2p_proxy = g_dbus_proxy_new_for_bus_finish(res, &amp;error);\n    if (error) {\n        g_print(\"proxy finish error: %s\\n\", error-&gt;message);\n        g_error_free(error);\n        return;\n    }\n\n    /* call p2p_listen */   \n    g_clear_error(&amp;error);\n    output = NULL;\n    output = g_dbus_proxy_call_sync(p2p_proxy,\n                      \"Listen\",\n                      g_variant_new(\"(i)\", 0), //params\n                      G_DBUS_CALL_FLAGS_NONE,\n                      10, //timeout_msec\n                      NULL,\n                      &amp;error\n    );\n\n    if (error) {\n        g_print(\"Listen call error: %s\\n\", error-&gt;message);\n        g_error_free(error);\n        g_print(\"continuing...\\n\");\n    }\n    else {\n        /* it gets to this print stmt, so the method was able to be called */\n        g_print(\"Listen successful\\n\");\n    }\n\n    /* register for signal from p2p device */\n    /* THIS IS WHERE THE ERROR IS */\n    error = NULL;\n    g_signal_connect(p2p_proxy,\n                     \"InvitationReceived\",\n                     G_CALLBACK(on_signal), // stub func that does something simple\n                     NULL);\n\n}\n\nint main (int argc, char **argv) {\n    GMainLoop *loop;\n\n    /* connect to wpa_supplicant p2p dbus interface */\n    g_dbus_proxy_new_for_bus(G_BUS_TYPE_SYSTEM,\n                     G_DBUS_PROXY_FLAGS_NONE,\n                     NULL,\n                     \"fi.w1.wpa_supplicant1\", //name,\n                     \"/fi/w1/wpa_supplicant1/Interfaces/0\", //object_path,\n                     \"fi.w1.wpa_supplicant1.Interface.P2PDevice\", //interface_name,\n                     NULL,\n                     on_wpa_ready, //callback,\n                     NULL);\n    );\n\n    loop = g_main_loop_new(NULL, FALSE);\n    g_main_loop_run(loop);\n}\n</code></pre>\n\n<p>Is there some special path that needs to be appended to the signal name? Or am I supposed to use a different proxy for registering signal handlers from the one used to call methods?</p>\n"}, {"tags": ["linux", "c", "openssh"], "comments": [{"owner": {"reputation": 836, "user_id": 5770299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b0602969094f6fe81ece876ee43ca36?s=128&d=identicon&r=PG", "display_name": "Guido", "link": "https://stackoverflow.com/users/5770299/guido"}, "edited": false, "score": 1, "creation_date": 1460546283, "post_id": 36598877, "comment_id": 60794586, "body": "Have you checked with a debug log statement immediately before your call to <code>fopen</code> that your filename supplied to <code>fopen</code> call is correct, i.e. includes the expected directory path?"}], "answers": [{"tags": [], "owner": {"reputation": 20508, "user_id": 2196426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8e8759ad9a50739704dca2e84fa9b50?s=128&d=identicon&r=PG", "display_name": "Jakuje", "link": "https://stackoverflow.com/users/2196426/jakuje"}, "is_accepted": false, "score": 0, "last_activity_date": 1460562862, "creation_date": 1460562862, "answer_id": 36603658, "question_id": 36598877, "link": "https://stackoverflow.com/questions/36598877/openssh-reading-from-a-file/36603658#36603658", "title": "openssh - Reading from a file", "body": "<p>This function is called during in pre-authentication child (before authentication), which is <code>chroot</code>ed in <code>/var/empty/sshd/</code> (Fedora/RHEL). This is the reason why it can not find your file.</p>\n\n<p>If you want it to find that file, you might disable <code>UsePrivilegeSeparation</code> option in <code>sshd_config</code> <strong>NOT RECOMMENDED IN PRODUCTION!!!</strong>. Read a bit more about <a href=\"http://www.citi.umich.edu/u/provos/ssh/privsep.html\" rel=\"nofollow\">privilege separation in openssh</a>.</p>\n"}], "migrated_from": {"other_site": {"aliases": ["http://linux.stackexchange.com"], "markdown_extensions": ["Prettify"], "launch_date": 1294871917, "open_beta_date": 1282071600, "closed_beta_date": 1281466800, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/unix/Img/apple-touch-icon@2.png", "favicon_url": "https://cdn.sstatic.net/Sites/unix/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/unix/Img/apple-touch-icon.png", "audience": "users of Linux, FreeBSD and other Un*x-like operating systems", "site_url": "https://unix.stackexchange.com", "api_site_parameter": "unix", "logo_url": "https://cdn.sstatic.net/Sites/unix/Img/logo.png", "name": "Unix &amp; Linux", "site_type": "main_site"}, "on_date": 1460551622, "question_id": 276146}, "owner": {"reputation": 2149, "user_id": 649810, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/45b1f8c1496ad21fbb35e9dfb72ebb08?s=128&d=identicon&r=PG", "display_name": "m4n07", "link": "https://stackoverflow.com/users/649810/m4n07"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1460562862, "creation_date": 1460544971, "question_id": 36598877, "link": "https://stackoverflow.com/questions/36598877/openssh-reading-from-a-file", "title": "openssh - Reading from a file", "body": "<p>In the openssh code (openssh-5.9p1/auth2.c) in the function</p>\n\n<pre><code>input_userauth_request(int type, u_int32_t seq, void *ctxt)\n</code></pre>\n\n<p>I'm trying to read my own file (tried using <code>fopen</code>, <code>fread</code>) but <code>fopen</code> fails with an error saying <code>No such file or directory</code>. The file exists with full permissions. Thanks.</p>\n"}, {"tags": ["python", "c", "ubuntu", "signals"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1460544022, "post_id": 36595809, "comment_id": 60788533, "body": "It&#39;s not clear what your situation is. Presumably the C app and the python script are running as seperate processes. So why do you think a signal sent to one of them would in any way affect the other?"}, {"owner": {"reputation": 1, "user_id": 5755432, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kYOH9.jpg?s=128&g=1", "display_name": "Bhautik R.", "link": "https://stackoverflow.com/users/5755432/bhautik-r"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1460544151, "post_id": 36595809, "comment_id": 60788635, "body": "Thanks You kaylum for your reply.. Yes C application and python script are a separate applications. As i SIGUSR signals are used for IPC so i thought that might corrupt any of two application ..So i asked about that."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1460546871, "post_id": 36595809, "comment_id": 60790562, "body": "SIGUSR1 by default <i>terminates</i> the process. SIGUSR1 as such does not have any meaning to CPython."}], "owner": {"reputation": 1, "user_id": 5755432, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kYOH9.jpg?s=128&g=1", "display_name": "Bhautik R.", "link": "https://stackoverflow.com/users/5755432/bhautik-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1460544258, "creation_date": 1460543790, "last_edit_date": 1460544258, "question_id": 36595809, "link": "https://stackoverflow.com/questions/36595809/cpythonubuntu-sigusr1-signal-sharing", "title": "C+Python+Ubuntu SIGUSR1 Signal Sharing", "body": "<p>Finding a solution for below questions,\nI used SIGUSR1 signal in my c application.for timer purpose.\ni also used same signal in one of my python script.\nBoth are Separate application and running fine together\nRight Now There is no problem at all.\n <strong>Questions :-</strong> \na) is that is a proper way?..or i should have to use SIGUSR2 signal for one of them\nb) What will be the effect if i provide SIGUSR1 to python script via C application?</p>\n"}, {"tags": ["c", "macos", "process", "shared-memory"], "comments": [{"owner": {"reputation": 115642, "user_id": 299924, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/71fc84230717311db1410d7106273128?s=128&d=identicon&r=PG", "display_name": "trojanfoe", "link": "https://stackoverflow.com/users/299924/trojanfoe"}, "edited": false, "score": 0, "creation_date": 1460543816, "post_id": 36595754, "comment_id": 60788384, "body": "Did you do any research before coding and then asking here?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1460543885, "post_id": 36595754, "comment_id": 60788442, "body": "<i>What</i> error do you get? What does <code>perror</code> tell you? And <i>which</i> of the two system calls in <code>destroy</code> is it that fails?"}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1460545158, "post_id": 36595754, "comment_id": 60789319, "body": "It is optional to have filesystem access to IPC objects... IPC have their own namespace. Write your own command to remove a given IPC. For SYSV IPC you can use <code>ipcrm</code> command, I think that there is no POSIX equivalent command (am I right?)."}, {"owner": {"reputation": 61, "user_id": 4664951, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tGtDM.jpg?s=128&g=1", "display_name": "lmbcosta", "link": "https://stackoverflow.com/users/4664951/lmbcosta"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1460545607, "post_id": 36595754, "comment_id": 60789649, "body": "@JoachimPileborg I got shm: Invalid argument"}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1460546759, "post_id": 36595754, "comment_id": 60790491, "body": "Notice, you&#39;re using <code>&#47;shm</code> to create and <code>shm</code> (no backslash) to close... also, on Mac OS X &quot;<a href=\"https://developer.apple.com/library/mac/documentation/Darwin/Reference/ManPages/man2/shm_open.2.html#//apple_ref/doc/man/2/shm_open\" rel=\"nofollow noreferrer\">There is no visible entry in the file system for the created object in this implementation</a>&quot; (from the <code>man</code> page)."}, {"owner": {"reputation": 61, "user_id": 4664951, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tGtDM.jpg?s=128&g=1", "display_name": "lmbcosta", "link": "https://stackoverflow.com/users/4664951/lmbcosta"}, "reply_to_user": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1460547431, "post_id": 36595754, "comment_id": 60790965, "body": "@Myst Thanks: Didn&#39;t notice , but still get the same error!"}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1460548278, "post_id": 36595754, "comment_id": 60791643, "body": "Could <code>munmap</code> be the one returning an error? try writing a different <code>perror</code> identifier for each... P.S. please edit your question with the actual error message (I know it&#39;s in the comments, but providing the error code in the question is a better practice)."}, {"owner": {"reputation": 61, "user_id": 4664951, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tGtDM.jpg?s=128&g=1", "display_name": "lmbcosta", "link": "https://stackoverflow.com/users/4664951/lmbcosta"}, "reply_to_user": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1460549343, "post_id": 36595754, "comment_id": 60792541, "body": "@Myst the same. I fixed with other way. Give a new name to the memory &quot;/shm1&quot; and in the function destroy I used other variable to to the munmap and the shm_unlink but I gave as argument the name &quot;/shm&quot;. create and close &quot;/shm1&quot; and closed &quot;/shm&quot;. It&#39;s not the best idea but it works"}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 4664951, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tGtDM.jpg?s=128&g=1", "display_name": "lmbcosta", "link": "https://stackoverflow.com/users/4664951/lmbcosta"}, "edited": false, "score": 0, "creation_date": 1460546862, "post_id": 36596579, "comment_id": 60790558, "body": "Yes I already did that but its empty and when I execute again I get          shm: Invalid argument. And if I change the memory&#39;s name, for example, to &quot;/shm1&quot; runs perfectly. But I can&#39;t use &quot;shm&quot; as memory name. This means that shared memory still there am I right?"}, {"owner": {"reputation": 164, "user_id": 6193510, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dRTC5khvm-g/AAAAAAAAAAI/AAAAAAAAFK0/nKLXuPE-F5Y/photo.jpg?sz=128", "display_name": "Nevado", "link": "https://stackoverflow.com/users/6193510/nevado"}, "reply_to_user": {"reputation": 61, "user_id": 4664951, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tGtDM.jpg?s=128&g=1", "display_name": "lmbcosta", "link": "https://stackoverflow.com/users/4664951/lmbcosta"}, "edited": false, "score": 0, "creation_date": 1460756652, "post_id": 36596579, "comment_id": 60907576, "body": "Yes you are, but it&#39;s weird you dont&#39;t get any results. Try ipcs -m or ipcs -M ."}, {"owner": {"reputation": 61, "user_id": 4664951, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tGtDM.jpg?s=128&g=1", "display_name": "lmbcosta", "link": "https://stackoverflow.com/users/4664951/lmbcosta"}, "edited": false, "score": 0, "creation_date": 1460833261, "post_id": 36596579, "comment_id": 60928662, "body": "Yes the same. I just created a new shared memory with different name. When i destroy it I used the same pointer to delete the old one shared memory and it worked."}, {"owner": {"reputation": 1820, "user_id": 1027966, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1691450b8277170ba387ec4f9ae35e1d?s=128&d=identicon&r=PG", "display_name": "Nick Desaulniers", "link": "https://stackoverflow.com/users/1027966/nick-desaulniers"}, "edited": false, "score": 0, "creation_date": 1483336866, "post_id": 36596579, "comment_id": 70049482, "body": "<code>man ipcs</code> says that it&#39;s for System V ipc, but OP is asking about shm_open which is POSIX shared memory.  Should <code>ipcs</code> work for both?"}, {"owner": {"reputation": 4192, "user_id": 2446071, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/3f590d99e58f1370b9846fcd29e0d43f?s=128&d=identicon&r=PG", "display_name": "sherrellbc", "link": "https://stackoverflow.com/users/2446071/sherrellbc"}, "edited": false, "score": 0, "creation_date": 1540235296, "post_id": 36596579, "comment_id": 92781403, "body": "@Nevado This is quite old, but I was reading on the man page that you must call <code>shm_unlink</code> and close all open file descriptors (by ending your process or otherwise) to remove the shared memory. It&#39;s likely that <code>ipcrm</code> does this."}], "tags": [], "owner": {"reputation": 164, "user_id": 6193510, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dRTC5khvm-g/AAAAAAAAAAI/AAAAAAAAFK0/nKLXuPE-F5Y/photo.jpg?sz=128", "display_name": "Nevado", "link": "https://stackoverflow.com/users/6193510/nevado"}, "is_accepted": false, "score": 0, "last_activity_date": 1460757143, "last_edit_date": 1460757143, "creation_date": 1460545872, "answer_id": 36596579, "question_id": 36595754, "link": "https://stackoverflow.com/questions/36595754/shared-memory-folder-in-mac-error-shm-invalid-argument/36596579#36596579", "title": "shared memory folder in Mac error shm: Invalid argument", "body": "<p>Mac OS X , like linux is UNIX based so it handles the shared memory just like Linux. The shared memory segments you allocate are also files located in /dev/shm </p>\n\n<p>To destroy the shared memory you can use the command <code>ipcs -m</code> or <code>ipcs -M</code> to view all the shared memory, look for yours and then execute <code>ipcrm -m shmid</code> where shmid would be the id of your shared memory. You can also do <code>ipcrm -M shmkey</code> using the key you assigned to it </p>\n"}], "owner": {"reputation": 61, "user_id": 4664951, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tGtDM.jpg?s=128&g=1", "display_name": "lmbcosta", "link": "https://stackoverflow.com/users/4664951/lmbcosta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1871, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1460757143, "creation_date": 1460543650, "last_edit_date": 1460548488, "question_id": 36595754, "link": "https://stackoverflow.com/questions/36595754/shared-memory-folder-in-mac-error-shm-invalid-argument", "title": "shared memory folder in Mac error shm: Invalid argument", "body": "<p>I usually code C in linux. I am using now a Mac and I am new on this machine.</p>\n\n<p>In linux when I use shared memory between process, the memory is allocated as a file in /dev/shm/resource_name</p>\n\n<p>I was trying a simple code and suddenly I got an error.\nIt wasn't able to call a function destroy() to destroy the shared memory </p>\n\n<p>Usually when this happens I delete the file manually on the directory.</p>\n\n<p>My question is: Where is located the shared memory in osx. Because when I try recompile and execute, the compiler gcc tells me that the resource already exists and I don't know how to delete it.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/mman.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;semaphore.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n\nint increment (int n)\n{\n  n = n + 1;\n  printf (\"%d\\n\", n);\n  return n;\n}\n\nint *create ()\n{\n  int *ptr;\n  int ret;\n\n  int fd= shm_open (\"/shm\", O_RDWR | O_CREAT, S_IRUSR | S_IWUSR);\n  if (fd == -1) {\n    perror (\"shm\");\n    exit (1);\n  }\n\n  ret = ftruncate (fd, sizeof (int));\n  if (ret == -1) {\n    perror (\"shm\");\n    exit (2);\n  }\n\n  ptr = mmap (0, sizeof (int), PROT_READ | PROT_WRITE, MAP_SHARED, fd,   0);\n  if (ptr == MAP_FAILED) {\n    perror (\"shm-mmap\");\n    exit (3);\n  }\n  return ptr;\n}\n\nvoid destroy (int *ptr)\n{\n  int ret;\n  ret = munmap (ptr, sizeof (int));\n  if (ret == -1) {\n    perror (\"shm\");\n    exit (7);\n  }\n  ret = shm_unlink (\"shm\");\n  if (ret == -1) {\n    perror (\"shm\");\n    exit (8);\n  }\n}\n\nint main (int argc, char *argv[])\n{\n  sem_t *semaphore; \n  int *ptr = create ();\n  int numProcessesChilds, numIncrements;\n  int i;\n  if (argc == 3) {\n    numProcessesChilds = atoi (argv [1]);\n    numIncrements = atoi (argv [2]);\n  }\n  else {\n    numProcessesChilds = 10; \n    numIncrements = 1;\n  }\n  *ptr = 0;\n\n  semaphore = sem_open(\"/semaphore\", O_CREAT, 0xFFFFFFFF, 1);\n  if (semaphore == SEM_FAILED) {\n    perror(\"semaphore\");\n  }\n\n  for (i = 0; i &lt; numProcessesChilds; i++) {\n    switch (fork ()) {\n    case -1:\n      perror (\"fork\");\n      exit (1);\n    case 0:\n      sem_wait(semaphore);\n\n      for (i = 0 ; i &lt; numIncrements; i++) {\n        (*ptr) = increment (*ptr);\n      }\n      sem_post(semaphore);\n      exit (0);\n    }\n  }\n  for (i = 0; i &lt; numProcessesChilds; i++) {\n    wait (NULL);\n  }\n  sem_close(semaphore);\n  sem_unlink(\"/semaphore\");\n\n  printf (\"Fina value: %d\\n\", *ptr);\n  destroy (ptr);\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "unit-testing", "cpputest"], "comments": [{"owner": {"reputation": 4316, "user_id": 1742659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/BpSsV.jpg?s=128&g=1", "display_name": "dfranca", "link": "https://stackoverflow.com/users/1742659/dfranca"}, "edited": false, "score": 0, "creation_date": 1460543733, "post_id": 36595752, "comment_id": 60788319, "body": "I&#39;m not familiar with CppUTest, but it&#39;s not possible to just create an accessor and return the mock variable when needed?"}, {"owner": {"reputation": 1240, "user_id": 1407731, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/6y8p8.jpg?s=128&g=1", "display_name": "PaulWebbster", "link": "https://stackoverflow.com/users/1407731/paulwebbster"}, "reply_to_user": {"reputation": 4316, "user_id": 1742659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/BpSsV.jpg?s=128&g=1", "display_name": "dfranca", "link": "https://stackoverflow.com/users/1742659/dfranca"}, "edited": false, "score": 0, "creation_date": 1460544209, "post_id": 36595752, "comment_id": 60788664, "body": "Yes, I&#39;ve think about that. But in this way I produce not really usable code so I was wondering if there is possible to mock just the global variable."}], "answers": [{"tags": [], "owner": {"reputation": 38108, "user_id": 6610, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/635c3ea0c7b8c37ef45744b6e66dd263?s=128&d=identicon&r=PG", "display_name": "xtofl", "link": "https://stackoverflow.com/users/6610/xtofl"}, "is_accepted": true, "score": 2, "last_activity_date": 1543482667, "last_edit_date": 1543482667, "creation_date": 1460544624, "answer_id": 36596121, "question_id": 36595752, "link": "https://stackoverflow.com/questions/36595752/is-any-way-to-mock-global-variable-in-cpputest/36596121#36596121", "title": "Is any way to mock global variable in CppUTest?", "body": "<p>We often forget about the linker.  We can use a different object file to mock an interface.  This mock-obj would contain a different definition of your global.</p>\n\n<p>But current unit test frameworks only work on code level...  So some build-fu will be needed to add mock objects to the test build.</p>\n"}], "owner": {"reputation": 1240, "user_id": 1407731, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/6y8p8.jpg?s=128&g=1", "display_name": "PaulWebbster", "link": "https://stackoverflow.com/users/1407731/paulwebbster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 648, "favorite_count": 0, "accepted_answer_id": 36596121, "answer_count": 1, "score": -1, "last_activity_date": 1543482667, "creation_date": 1460543643, "last_edit_date": 1460543826, "question_id": 36595752, "link": "https://stackoverflow.com/questions/36595752/is-any-way-to-mock-global-variable-in-cpputest", "title": "Is any way to mock global variable in CppUTest?", "body": "<p>Is there any way to mock static global variable to use in test function? Or any workaround for that?</p>\n\n<p>Below example of such situation:</p>\n\n<pre><code>static zsock_t *publish_logs =  NULL;\n\nint btak_log_message_reactor(zloop_t *loop, zsock_t *reader, void *arg) {\n    struct btak_log_message *message;\n    size_t message_size;\n\n    if(zsock_recv(reader, \"b\", &amp;message, &amp;message_size) == 0) {\n        push_log_message(message);\n        if(publish_logs)\n            publish_log_message(message, publish_logs);\n        free(message);\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "gtk3"], "comments": [{"owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "edited": false, "score": 0, "creation_date": 1460545666, "post_id": 36595144, "comment_id": 60789701, "body": "I couldn&#39;t reproduce this issue.."}, {"owner": {"reputation": 3, "user_id": 6181854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8641c8a3abcb46129fa7f18f295561d?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/6181854/daniel"}, "reply_to_user": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "edited": false, "score": 0, "creation_date": 1460559990, "post_id": 36595144, "comment_id": 60802036, "body": "Looks like I undestand what I doing wrong. I should have change first string argument of function <code>gtk_application_new()</code>. I change my code. I get a random string and put it as first argument of <code>gtk_application_new()</code>."}], "answers": [{"comments": [{"owner": {"reputation": 715, "user_id": 3610102, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/999d4ac2d47c4de912caa36f13f9eb38?s=128&d=identicon&r=PG&f=1", "display_name": "Chirality", "link": "https://stackoverflow.com/users/3610102/chirality"}, "edited": false, "score": 0, "creation_date": 1460557725, "post_id": 36601021, "comment_id": 60799970, "body": "Welcome to StackOverflow! When updating your question to include more information, please use the Edit link below your original post as answer posts are only supposed to be for answers."}], "tags": [], "owner": {"reputation": 3, "user_id": 6181854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8641c8a3abcb46129fa7f18f295561d?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/6181854/daniel"}, "is_accepted": false, "score": -1, "last_activity_date": 1460556599, "creation_date": 1460556599, "answer_id": 36601021, "question_id": 36595144, "link": "https://stackoverflow.com/questions/36595144/gtk-3-new-app-use-old-command-line-arguments/36601021#36601021", "title": "gtk 3 new app use old command line arguments", "body": "<p>There is all my code. When I run the app in console it print the string two times. If I don't close current window, and run another app, then second app print just one string. And first app print string one more time. What is it? A bug?</p>\n\n<pre><code>#include \"MyMain.h\"\n\n\nvoid showWindow2( GtkApplication *app, gpointer gp_data )\n{\n    printf( \"%s\\n\", ( char* ) gp_data );\n    GtkWidget *window;\n    window = gtk_application_window_new( app );\n    gtk_widget_show_all( window );\n}\n\n\nvoid main( int argc, char **argv )\n{\n    printf( \"%s\\n\", argv[1] );\n\n    //\u0421\u043e\u0437\u0434\u0430\u0435\u043c \u043e\u043a\u043d\u043e\n    GtkApplication *app;\n    app = gtk_application_new( \"org.gtk.example\", G_APPLICATION_FLAGS_NONE );\n    g_signal_connect( app, \"activate\", G_CALLBACK( showWindow2 ), argv[1] );\n    g_application_run( G_APPLICATION( app ), 0, NULL );\n    g_object_unref( app );\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6181854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8641c8a3abcb46129fa7f18f295561d?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/6181854/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 578, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1460556599, "creation_date": 1460542043, "last_edit_date": 1460542992, "question_id": 36595144, "link": "https://stackoverflow.com/questions/36595144/gtk-3-new-app-use-old-command-line-arguments", "title": "gtk 3 new app use old command line arguments", "body": "<p>Here is my code:</p>\n\n<pre><code>void main( int argc, char **argv )\n{\n    //\u0421\u043e\u0437\u0434\u0430\u0435\u043c \u043e\u043a\u043d\u043e\n    GtkApplication *app;\n    app = gtk_application_new( \"org.gtk.example\", G_APPLICATION_FLAGS_NONE );\n    g_signal_connect( app, \"activate\", G_CALLBACK ( showWindow ), argv[1] );\n    g_application_run( G_APPLICATION( app ), 0, NULL );\n    g_object_unref( app );\n}\n</code></pre>\n\n<p>I want to send some char* argument (  argv[1] ) to window widget. And that code is works. If I start my program, like:</p>\n\n<pre><code>./myapp here_some_string\n</code></pre>\n\n<p>argv[1] sends to my window widget without a problem.</p>\n\n<p>But, if I don't close current window, and run my application again ( another copy ) with another command line argument, there is some strange. argv[1] doesn't contains correct value, it contains old value. Why?</p>\n\n<p>Example:</p>\n\n<pre><code>./myapp string_1 &amp; //app gets string_1\n./myapp string_2 //app gets string_1 again!\n</code></pre>\n"}, {"tags": ["c++", "c", "crash", "arduino", "reboot"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1460543696, "post_id": 36595115, "comment_id": 60788280, "body": "How is your watchdog configured? Is it disabled? If not, where is the code that service the watchdog?"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1460544811, "post_id": 36595115, "comment_id": 60789052, "body": "I don&#39;t know about the code, but just reading the question text fills me with a deep sense of unease and foreboding....   It feels like you are attending a patient with multiple trauma and are asking how to apply band-aid:(   I hope I&#39;m wrong, but I think your design is bleeding out."}, {"owner": {"reputation": 1, "user_id": 6197936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96d33fde1482c6d960af3a6a40ad72b6?s=128&d=identicon&r=PG&f=1", "display_name": "RedSkidy", "link": "https://stackoverflow.com/users/6197936/redskidy"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1460548377, "post_id": 36595115, "comment_id": 60791725, "body": "@Lundin it wasn&#39;t so I tried to disable it but nothing changed should I enable it and configure it instead ?"}, {"owner": {"reputation": 1, "user_id": 6197936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96d33fde1482c6d960af3a6a40ad72b6?s=128&d=identicon&r=PG&f=1", "display_name": "RedSkidy", "link": "https://stackoverflow.com/users/6197936/redskidy"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1460548388, "post_id": 36595115, "comment_id": 60791739, "body": "@MartinJames that&#39;s just because i&#39;m trying to explain a code of about 430 lines in 6, and I&#39;m not very skilled with english... if you want more details, there is this 1s delay because I have to get the data from the client and extract the infos from it. before, I had somthing like: pause -  ethernet function -  stuff causing a 1s delay -  ethernet function -  resume. now I want something like pause -  ethernet func -  resume -  stuff causing a 1s delay -  pause -  ethernet func -  resume -  So I don&#39;t have this freeze everytime I change the volume."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1460548822, "post_id": 36595115, "comment_id": 60792120, "body": "Code crashing when you run a well-tested library function, which in turn performs as slow data transmission very much sounds like the watchdog."}, {"owner": {"reputation": 1, "user_id": 6197936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96d33fde1482c6d960af3a6a40ad72b6?s=128&d=identicon&r=PG&f=1", "display_name": "RedSkidy", "link": "https://stackoverflow.com/users/6197936/redskidy"}, "edited": false, "score": 0, "creation_date": 1460548969, "post_id": 36595115, "comment_id": 60792245, "body": "but this line was not causing any problem before I started to use my custom functions"}, {"owner": {"reputation": 1, "user_id": 6197936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96d33fde1482c6d960af3a6a40ad72b6?s=128&d=identicon&r=PG&f=1", "display_name": "RedSkidy", "link": "https://stackoverflow.com/users/6197936/redskidy"}, "edited": false, "score": 0, "creation_date": 1460549167, "post_id": 36595115, "comment_id": 60792415, "body": "when I enable the watchdog timer, the working part of my code doesn&#39;t work anymore edit : i&#39;m stupid, I just forgot to reset it"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6197936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96d33fde1482c6d960af3a6a40ad72b6?s=128&d=identicon&r=PG&f=1", "display_name": "RedSkidy", "link": "https://stackoverflow.com/users/6197936/redskidy"}, "edited": false, "score": 0, "creation_date": 1460556373, "post_id": 36599795, "comment_id": 60798782, "body": "thanks for these advices, but unfortunatly, it didn&#39;t worked... there&#39;s still a little improvement tho, that&#39;s what I get :  <code>new client GET &#47; HTTP&#175;192.168.0.123</code>  it&#39;s only doing that since I added those functions but I don&#39;t see why.  here is the full code : <a href=\"http://pastebin.com/BWFqVGEv\" rel=\"nofollow noreferrer\">pastebin.com/BWFqVGEv</a>"}, {"owner": {"reputation": 1, "user_id": 6197936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96d33fde1482c6d960af3a6a40ad72b6?s=128&d=identicon&r=PG&f=1", "display_name": "RedSkidy", "link": "https://stackoverflow.com/users/6197936/redskidy"}, "edited": false, "score": 0, "creation_date": 1460556537, "post_id": 36599795, "comment_id": 60798921, "body": "I will also change the strings in my mp3 struct"}, {"owner": {"reputation": 1509, "user_id": 4100891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e45564c082ad1996cceea210b3c947ab?s=128&d=identicon&r=PG", "display_name": "slash-dev", "link": "https://stackoverflow.com/users/4100891/slash-dev"}, "reply_to_user": {"reputation": 1, "user_id": 6197936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96d33fde1482c6d960af3a6a40ad72b6?s=128&d=identicon&r=PG&f=1", "display_name": "RedSkidy", "link": "https://stackoverflow.com/users/6197936/redskidy"}, "edited": false, "score": 0, "creation_date": 1460589560, "post_id": 36599795, "comment_id": 60819223, "body": "@RedSkidy, I&#39;m glad it&#39;s better.  BTW, you can edit your original question and include your sketch.  Most people won&#39;t download something to answer a question... except for libraries.  If you use a library, post a <i>link</i> to the one you are using, don&#39;t <i>include</i> it in your post."}, {"owner": {"reputation": 1, "user_id": 6197936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96d33fde1482c6d960af3a6a40ad72b6?s=128&d=identicon&r=PG&f=1", "display_name": "RedSkidy", "link": "https://stackoverflow.com/users/6197936/redskidy"}, "edited": false, "score": 0, "creation_date": 1460591297, "post_id": 36599795, "comment_id": 60819772, "body": "I don&#39;t think the libraries are very important in this case. Even if there is a small improvement, it&#39;s still doing the same crash. As it got better using char arrays instead of strings I guess the problem comes from a lack of memory but it only does that since I added those functions, is there any reason they would consume memory ?"}, {"owner": {"reputation": 1509, "user_id": 4100891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e45564c082ad1996cceea210b3c947ab?s=128&d=identicon&r=PG", "display_name": "slash-dev", "link": "https://stackoverflow.com/users/4100891/slash-dev"}, "reply_to_user": {"reputation": 1, "user_id": 6197936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96d33fde1482c6d960af3a6a40ad72b6?s=128&d=identicon&r=PG&f=1", "display_name": "RedSkidy", "link": "https://stackoverflow.com/users/6197936/redskidy"}, "edited": false, "score": 0, "creation_date": 1460642967, "post_id": 36599795, "comment_id": 60847242, "body": "@RedSkidy, you don&#39;t think the libraries or the rest of your code are very important?  Sounds like you already know the answer."}, {"owner": {"reputation": 1, "user_id": 6197936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96d33fde1482c6d960af3a6a40ad72b6?s=128&d=identicon&r=PG&f=1", "display_name": "RedSkidy", "link": "https://stackoverflow.com/users/6197936/redskidy"}, "edited": false, "score": 0, "creation_date": 1460659133, "post_id": 36599795, "comment_id": 60858081, "body": "it&#39;s more because i&#39;m only using the basic functions of well tested libs made by people a lot more experienced than me and I already used these functions and they worked before, but you&#39;re probably right so these are the libraries used : SFEMP3Shield : <a href=\"https://mpflaga.github.io/Sparkfun-MP3-Player-Shield-Arduino-Library/class_s_f_e_m_p3_shield.html\" rel=\"nofollow noreferrer\">mpflaga.github.io/Sparkfun-MP3-Player-Shield-Arduino-Library&zwnj;&#8203;/&hellip;</a> Arduino Ethernet : <a href=\"https://www.arduino.cc/en/reference/ethernet\" rel=\"nofollow noreferrer\">arduino.cc/en/reference/ethernet</a>  also sdfatlib but it&#39;s not used in this part of the code : <a href=\"https://mosquino.googlecode.com/hg/libraries/sdfatlib-mosquino/html/index.html\" rel=\"nofollow noreferrer\">mosquino.googlecode.com/hg/libraries/sdfatlib-mosquino/html/&zwnj;&#8203;&hellip;</a>"}], "tags": [], "owner": {"reputation": 1509, "user_id": 4100891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e45564c082ad1996cceea210b3c947ab?s=128&d=identicon&r=PG", "display_name": "slash-dev", "link": "https://stackoverflow.com/users/4100891/slash-dev"}, "is_accepted": false, "score": 0, "last_activity_date": 1460553747, "creation_date": 1460553747, "answer_id": 36599795, "question_id": 36595115, "link": "https://stackoverflow.com/questions/36595115/arduino-crash-and-reboot-at-random-points/36599795#36599795", "title": "Arduino crash and reboot at &quot;random points&quot;", "body": "<p>You probably have a low RAM condition.</p>\n\n<p>Also, you shouldn't use the <code>String</code> class for <code>firstLine</code>.  It causes many problems, some of which can occur at random times.</p>\n\n<p>Just use a character array like you did for <code>received</code>.  Store each character in the array until the newline character arrives, and increment the length for each character:</p>\n\n<pre><code>void checkForClient(int loading){\n  char    firstLine[60];\n  uint8_t firstLineLen = 0;\n\n  MP3player.pauseDataStream ();\n  EthernetClient client = server.available();\n  MP3player.resumeDataStream();\n  if (client) {\n    if(!loading){\n      Serial.println(F(\"new client\")); // CRASH HERE\n      bool endLn(false);\n      char chr;\n      int i(0);\n      while (clientConnected(client)) {\n        char received[clientAvailable(client)+2];\n        while (clientAvailable(client)) {\n          MP3player.pauseDataStream ();\n          char c = client.read();\n          MP3player.resumeDataStream ();\n          received[i] = c;\n          Serial.print(c); // OR HERE\n          if (!endLn) {\n            if (firstLineLength &lt; sizeof(firstLine)-2)\n              firstLine[ firstLineLength++ ] = c;\n            if (c == '\\n') {\n              endLn = true;\n              firstLine[ firstLineLength ] = '\\0'; // NUL-terminate\n            }\n          }\n          ++i;\n        }\n        received[i+1] = '\\0';\n        i = 0;\n        if(endLn){\n          Serial.println();\n          endLn = false;\n          Serial.print(F(\"first line : \"));\n          Serial.println(firstLine);\n        }\n</code></pre>\n\n<p>This will also save about 1600 bytes of program space.  There are many reasons to avoid String, and many people have written about the pitfalls.  If you use <code>String</code> elsewhere in your program, you should use a similar approach to eliminate it.</p>\n\n<p>Another technique to reduce RAM is to avoid storing the data when it comes in, and then using it later.  Instead, use it immediately:</p>\n\n<pre><code>void checkForClient(int loading){\n\n  MP3player.pauseDataStream ();\n  EthernetClient client = server.available();\n  MP3player.resumeDataStream();\n  if (client) {\n    if(!loading){\n      Serial.println(F(\"new client\")); // CRASH HERE\n\n      Serial.print(F(\"first line : \"));\n      bool endLn(false);\n\n      char chr;\n      int i(0);\n      while (clientConnected(client)) {\n        char received[clientAvailable(client)+2];\n        while (clientAvailable(client)) {\n          MP3player.pauseDataStream ();\n          char c = client.read();\n          MP3player.resumeDataStream ();\n          received[i] = c;\n          if (!endLn) {\n            Serial.print(c); // printed now instead of saved for later\n            if (c == '\\n') {\n              endLn = true;\n            }\n          }\n          ++i;\n        }\n        received[i+1] = '\\0';\n        i = 0;\n        if (endLn) {\n          Serial.println();\n          endLn = false;\n          //Serial.println(firstLine); // NOT NEEDED, already printed!\n        }\n</code></pre>\n\n<p>That saves all the RAM you would have used for <code>firstLine</code>.</p>\n\n<p>You didn't post your entire program for our review, so you'll have to look for other variables that are too big, or that could be declared <em>inside</em> a routine (i.e., a local variable) instead of at file scope (i.e., a global variable, declared outside of any routines).</p>\n"}], "owner": {"reputation": 1, "user_id": 6197936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96d33fde1482c6d960af3a6a40ad72b6?s=128&d=identicon&r=PG&f=1", "display_name": "RedSkidy", "link": "https://stackoverflow.com/users/6197936/redskidy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 488, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1460553747, "creation_date": 1460541983, "last_edit_date": 1460542984, "question_id": 36595115, "link": "https://stackoverflow.com/questions/36595115/arduino-crash-and-reboot-at-random-points", "title": "Arduino crash and reboot at &quot;random points&quot;", "body": "<p>I'm working on a very important school project, which is an MP3 player with a web interface and a webserver using an arduino mega.\nwhen I want to use any function of the ethernet lib, I have to pause the music because the ethernet shield and the mp3 player shield are using the same spi bus. But when I change the volume, that causes a 1s freeze in the music. to avoid that I created new functions that pause the music, call a function of the ethernet lib and the resume.</p>\n\n<pre><code>bool clientAvailable(EthernetClient &amp;client){\n  MP3player.pauseDataStream ();\n  bool a = client.connected();\n  MP3player.resumeDataStream ();\n  return a;\n}\nint clientConnected(EthernetClient &amp;client){\n  MP3player.pauseDataStream ();\n  int a = client.available();\n  MP3player.resumeDataStream ();\n  return a;\n}\nvoid stopClient(EthernetClient &amp;client){\n  MP3player.pauseDataStream ();\n  client.stop();\n  MP3player.resumeDataStream ();\n}\n\nvoid checkForClient(int loading){\n  String firstLine;\n  MP3player.pauseDataStream ();\n  EthernetClient client = server.available();\n  MP3player.resumeDataStream();\n  if (client) {\n    if(!loading){\n      Serial.println(F(\"new client\")); // CRASH HERE\n      bool endLn(false);\n      char chr;\n      int i(0);\n      while (clientConnected(client)) {\n        char received[clientAvailable(client)+2];\n        while (clientAvailable(client)) {\n          MP3player.pauseDataStream ();\n          char c = client.read();\n          MP3player.resumeDataStream ();\n           received[i] = c;\n          Serial.print(c); // OR HERE\n          if(!endLn){\n            firstLine += c;\n            if (c == '\\n'){\n            endLn = true;\n            }\n          }\n          ++i;\n        }\n        received[i+1] = '\\0';\n        i = 0;\n        if(endLn){\n          Serial.println();\n          endLn = false;\n          Serial.print(F(\"first line : \"));\n          Serial.println(firstLine);\n        }\n</code></pre>\n\n<p>what I get in output :</p>\n\n<pre><code>new \u00fb192.168.0.123\n</code></pre>\n\n<p>there is an IP at the end because this is where the arduino reboot and that's the first thing I display.\nIf I delete the \"client.println(F(\"new client\")) line, the error will occur on the client.print(c) line (after displaying 3 or 4 chars). if I remove this one too, it will crash somewhere but I don't know where.</p>\n\n<p>I checked the memory, I have like 600 bytes left at this point of the program.</p>\n\n<p>Any ideas ?</p>\n\n<p>Thanks. </p>\n"}]