[{"tags": ["c", "ip", "checksum"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1443052455, "post_id": 32750903, "comment_id": 53343135, "body": "<a href=\"https://en.wikipedia.org/wiki/IPv4_header_checksum#Example:_calculating_an_IPv4_header_checksum\" rel=\"nofollow noreferrer\">Example from wikipedia</a>"}, {"owner": {"reputation": 313, "user_id": 2542813, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5a25c80d81d1dd0ca741577704d3aecc?s=128&d=identicon&r=PG", "display_name": "user2542813", "link": "https://stackoverflow.com/users/2542813/user2542813"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1443054573, "post_id": 32750903, "comment_id": 53343645, "body": "hmm, so i have to use an unsigned int to compute it, sum the two halfs until the first half is zero,  thats kind different from my references :s, thanks for helping, i&#39;ll update the code in the answer."}], "answers": [{"tags": [], "owner": {"reputation": 313, "user_id": 2542813, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5a25c80d81d1dd0ca741577704d3aecc?s=128&d=identicon&r=PG", "display_name": "user2542813", "link": "https://stackoverflow.com/users/2542813/user2542813"}, "is_accepted": true, "score": 1, "last_activity_date": 1443054985, "creation_date": 1443054985, "answer_id": 32751581, "question_id": 32750903, "link": "https://stackoverflow.com/questions/32750903/ip-checksum-calculating/32751581#32751581", "title": "IP checksum calculating", "body": "<p>So after reading this link: <a href=\"https://en.wikipedia.org/wiki/IPv4_header_checksum#Example:_calculating_an_IPv4_header_checksum\" rel=\"nofollow\">wikipedia</a> i could see that checksum is a little bit more tricky than expected, now this is the code that works for me:</p>\n\n<pre><code>void compute_ip_checksum(struct ip_hdr* ip, struct ip_options* opt){\nunsigned short* begin = (unsigned short*)ip;\nunsigned short* end = begin + IP_NOPT_HEADER_LENGTH / 2;\nunsigned int checksum = 0, first_half, second_half;\n\nip-&gt;checksum = 0;\nfor (; begin != end; begin++){\n    checksum += *begin;\n}\n\nfirst_half = (unsigned short)(checksum &gt;&gt; 16);\nwhile (first_half){\n    second_half = (unsigned short)((checksum &lt;&lt; 16) &gt;&gt; 16);\n    checksum = first_half + second_half;\n    first_half = (unsigned short)(checksum &gt;&gt; 16);\n}\n\nip-&gt;checksum = ~checksum;\n}\n</code></pre>\n\n<p>as you can see, there is no need for conversion after the NOT operation, i've put the carry calculation in a loop because i don't know how many time i have to do this step, i think that in my case it dont exceed one.</p>\n"}], "owner": {"reputation": 313, "user_id": 2542813, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5a25c80d81d1dd0ca741577704d3aecc?s=128&d=identicon&r=PG", "display_name": "user2542813", "link": "https://stackoverflow.com/users/2542813/user2542813"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2331, "favorite_count": 0, "accepted_answer_id": 32751581, "answer_count": 1, "score": 1, "last_activity_date": 1443054985, "creation_date": 1443049663, "question_id": 32750903, "link": "https://stackoverflow.com/questions/32750903/ip-checksum-calculating", "title": "IP checksum calculating", "body": "<p>i'm trying to calculate the checksum of an ip address header(without options), following the algorithm: divide the header in 16 bit words, sum all the words, apply NOT operator on the result to obtain the checksum, but i still got wrong results, sniffing the packets with wireshark i can see that they are wrong, for example, this is my method:</p>\n\n<pre><code>void compute_ip_checksum(struct ip_hdr* ip){\nunsigned short* begin = (unsigned short*)ip;\nunsigned short* end = begin + (IP_NOPT_HEADER_LENGTH / 2);\nunsigned short checksum = 0;\n\nip-&gt;checksum = 0;\nfor (; begin != end; begin++){\n    checksum += *begin;\n}\n\nip-&gt;checksum = htons(~checksum);\n}\n</code></pre>\n\n<p>the ip header i build is:</p>\n\n<pre><code>ip.version_and_length = (IPV4 &lt;&lt; 4) | (IP_NOPT_HEADER_LENGTH/4);\nip.type_of_service = 0;\nip.total_length = htons(IP_NOPT_HEADER_LENGTH + TCP_NOPT_HEADER_LENGTH);\nip.frag_id = 0;\nip.flags_and_frag_offset = htons(DONT_FRAGMENT &lt;&lt; 13);\nip.time_to_live = 128;\nip.protocol = TCP_PAYLOAD;\nip.src_ip = inet_addr(\"1.1.1.1\");\nip.dst_ip = inet_addr(\"1.1.1.2\");\n</code></pre>\n\n<p>Since i'm converting all the values to the network byte order, i'm not doing any conversions in the checksum sum, only after the NOT operation, cause i'm almost sure that my windows is LITTLEENDIAN, and if thats the case the result will be put in this byteorder. the result of my functions is: 0x7a17 and the wireshark result is 0x7917 for this header. Can someone explain what is wrong here? my references are: <a href=\"https://tools.ietf.org/html/rfc791#section-3.1\" rel=\"nofollow\">RFC 791</a> and <a href=\"http://www.thegeekstuff.com/2012/05/ip-header-checksum/\" rel=\"nofollow\">How to Calculate IpHeader Checksum</a></p>\n"}, {"tags": ["c", "arrays", "segmentation-fault"], "comments": [{"owner": {"reputation": 1081, "user_id": 2686112, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c5d6b435697b858fa64295a4bb7e6758?s=128&d=identicon&r=PG&f=1", "display_name": "Rahul Jha", "link": "https://stackoverflow.com/users/2686112/rahul-jha"}, "edited": false, "score": 0, "creation_date": 1443047340, "post_id": 32750444, "comment_id": 53341622, "body": "Think about it this way if you don&#39;t get it! you are trying to build a home for someone who doesn&#39;t have land for constructing it on! Your str hasn&#39;t been allocated any space where it could store the information that would flow in!"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1443050245, "post_id": 32750444, "comment_id": 53342528, "body": "In the <code>if(file == NULL)</code> case you actually need to abort instead of carrying on"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1443050338, "post_id": 32750444, "comment_id": 53342561, "body": "You should check <code>cr != NULL</code> before doing <code>*cr</code> or using <code>str</code>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1443051674, "post_id": 32750444, "comment_id": 53342936, "body": "How about first reading a C book or at least the man pages of the functions used?"}, {"owner": {"reputation": 1, "user_id": 5301638, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b1npl.jpg?s=128&g=1", "display_name": "Derek Harrison", "link": "https://stackoverflow.com/users/5301638/derek-harrison"}, "edited": false, "score": 0, "creation_date": 1443052254, "post_id": 32750444, "comment_id": 53343082, "body": "@ Olaf I&#39;m not an expert in C. And in my own defence I was naive enough to believe that fgets would initialize str. Forgive my ignorance please."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5301638, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b1npl.jpg?s=128&g=1", "display_name": "Derek Harrison", "link": "https://stackoverflow.com/users/5301638/derek-harrison"}, "edited": false, "score": 0, "creation_date": 1443047581, "post_id": 32750485, "comment_id": 53341704, "body": "Yeah allocating space for str worked, thanks. Although I don&#39;t understand why the code runs in the situation where no space is allocated and the name[10] array not commented. What does that have to do with anything?"}, {"owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "reply_to_user": {"reputation": 1, "user_id": 5301638, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b1npl.jpg?s=128&g=1", "display_name": "Derek Harrison", "link": "https://stackoverflow.com/users/5301638/derek-harrison"}, "edited": false, "score": 1, "creation_date": 1443048233, "post_id": 32750485, "comment_id": 53341936, "body": "It&#39;s undefined behavior, anything can happen."}], "tags": [], "owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "is_accepted": false, "score": 3, "last_activity_date": 1443046988, "last_edit_date": 1443046988, "creation_date": 1443046950, "answer_id": 32750485, "question_id": 32750444, "link": "https://stackoverflow.com/questions/32750444/why-is-a-simple-declaration-of-a-character-array-crashing-my-code/32750485#32750485", "title": "Why is a simple declaration of a character array crashing my code?", "body": "<pre><code> char *str, *cr;\n\n /* ... */\n\n cr = fgets(str, maxsize, file); \n</code></pre>\n\n<p>Your <code>str</code> pointer is not initialized, its value is indeterminate. You are writing to an invalid object. Either define an array with a sufficient size or use <code>malloc</code> to allocate one.</p>\n"}, {"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1443050185, "post_id": 32750737, "comment_id": 53342512, "body": "This is poor style; simpler is <code>char str[maxsize];</code>"}, {"owner": {"reputation": 1, "user_id": 5301638, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b1npl.jpg?s=128&g=1", "display_name": "Derek Harrison", "link": "https://stackoverflow.com/users/5301638/derek-harrison"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1443052470, "post_id": 32750737, "comment_id": 53343141, "body": "But I suppose your right in this case. No need for that."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1443052620, "post_id": 32750737, "comment_id": 53343189, "body": "Also, <code>char *str = malloc(maxsize);</code> would be simpler than all that guff  <a href=\"http://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">(further reading)</a>. And you need to <code>free(str)</code> at the end that way."}, {"owner": {"reputation": 1, "user_id": 5301638, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b1npl.jpg?s=128&g=1", "display_name": "Derek Harrison", "link": "https://stackoverflow.com/users/5301638/derek-harrison"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1443053446, "post_id": 32750737, "comment_id": 53343391, "body": "Thanks for the info. That will save some repetitive typing."}], "tags": [], "owner": {"reputation": 1, "user_id": 5301638, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b1npl.jpg?s=128&g=1", "display_name": "Derek Harrison", "link": "https://stackoverflow.com/users/5301638/derek-harrison"}, "is_accepted": false, "score": -1, "last_activity_date": 1443048602, "creation_date": 1443048602, "answer_id": 32750737, "question_id": 32750444, "link": "https://stackoverflow.com/questions/32750444/why-is-a-simple-declaration-of-a-character-array-crashing-my-code/32750737#32750737", "title": "Why is a simple declaration of a character array crashing my code?", "body": "<p>So ouah has provided a satisfactory answer. However I figured it may also be useful to translate what he said into code, for the people still getting acquainted with c (like myself). The problem was that the pointer *str was uninitialized (and pointing to nowhere). The fix was simply to allocate some memory and return an address to that memory so that the pointer is initialized, i.e.: pointing at something.</p>\n\n<p>In code:</p>\n\n<pre><code>char *str; \n</code></pre>\n\n<p>must be changed to </p>\n\n<pre><code>char *str = (char *)malloc(sizeof(char)*whateveryouexpect);\n</code></pre>\n\n<p>Doing this resolves the issues, and the character array char name[10] can be declared without any issues. </p>\n"}], "owner": {"reputation": 1, "user_id": 5301638, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b1npl.jpg?s=128&g=1", "display_name": "Derek Harrison", "link": "https://stackoverflow.com/users/5301638/derek-harrison"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1518072014, "creation_date": 1443046742, "last_edit_date": 1518072014, "question_id": 32750444, "link": "https://stackoverflow.com/questions/32750444/why-is-a-simple-declaration-of-a-character-array-crashing-my-code", "title": "Why is a simple declaration of a character array crashing my code?", "body": "<p>I have been playing around with file writing functions to study their properties in more detail, along with some other things as well (however what I was doing is ultimately irrelevant),  and while I was doing that I encountered a segmentation fault. But not just the everyday type of segfault (dereferencing to unallocated space or something), the segfault is somehow caused by the declaration of a character array. In the code char name[10]. The declaration of char name[10] results in segmentation fault, and I do not understand why. Commenting this declaration removes the issue. What is going on here? </p>\n\n<p>The code I wrote is given below:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;errno.h&gt;\n\nint main(int argc, char *argv[]){\n\n//char name[10];\n//strcpy(name, \"George\");\n//printf(\"%s\\n\", name);\n\n//if(argc == 2){\n\n//char *myname = \"George\";\n\n    FILE *file = fopen(\"Readmystuff\" , \"rt\");//fopen(argv[1],\"rt\");\n\n    if(file == NULL)\n        printf(\"Could not open file: %s\\n\", strerror(errno));\n\n    char *str, *cr;\n    int maxsize = 200;\n\n    cr = fgets(str, maxsize, file); \n\n    int fcl = fclose(file); \n\n    printf(\"\\n\");   \n\n    int strl = strlen(str);\n\n    if(fcl == 0)\n        printf(\"File closed succesfully\\ncr: %c\\nstr: %s\\nTotal string size - 1 (for null): %i\\n\", *cr, str, strl);\n    else\n        printf(\"File did not close\");\n//}\n//else\n    //printf(\"There must be one argument, argv[1] = the filename, for the code to work\\n\");\n\nreturn 0;\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 1, "creation_date": 1443045191, "post_id": 32750114, "comment_id": 53340851, "body": "Well, do you want a length-4 array or a length-6 one?"}, {"owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "edited": false, "score": 0, "creation_date": 1443045216, "post_id": 32750114, "comment_id": 53340861, "body": "Question is not clear to me."}, {"owner": {"reputation": 712, "user_id": 4979380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-s_LEy5WIb-s/AAAAAAAAAAI/AAAAAAAAAHc/IDwR0EhwHdc/photo.jpg?sz=128", "display_name": "Hemant Parihar", "link": "https://stackoverflow.com/users/4979380/hemant-parihar"}, "edited": false, "score": 0, "creation_date": 1443045350, "post_id": 32750114, "comment_id": 53340926, "body": "why array[] should not prefer?"}, {"owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "edited": false, "score": 0, "creation_date": 1443045661, "post_id": 32750114, "comment_id": 53341041, "body": "@HemantParihar they are not equivalent, the first array has 4 elements and the second 6, are you comparing apples and oranges?"}], "answers": [{"comments": [{"owner": {"reputation": 712, "user_id": 4979380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-s_LEy5WIb-s/AAAAAAAAAAI/AAAAAAAAAHc/IDwR0EhwHdc/photo.jpg?sz=128", "display_name": "Hemant Parihar", "link": "https://stackoverflow.com/users/4979380/hemant-parihar"}, "edited": false, "score": 0, "creation_date": 1443045805, "post_id": 32750180, "comment_id": 53341082, "body": "can i add elements to array array[] ? After i initialize it."}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 712, "user_id": 4979380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-s_LEy5WIb-s/AAAAAAAAAAI/AAAAAAAAAHc/IDwR0EhwHdc/photo.jpg?sz=128", "display_name": "Hemant Parihar", "link": "https://stackoverflow.com/users/4979380/hemant-parihar"}, "edited": false, "score": 0, "creation_date": 1443045969, "post_id": 32750180, "comment_id": 53341130, "body": "@HemantParihar if you don&#39;t do much work (which will be costly too), then no. If you want to add more elements, you may need to consider the dynamic memory allocation. Check my edit please! Btw, I understand your confusion, thus my upvote to your question."}, {"owner": {"reputation": 712, "user_id": 4979380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-s_LEy5WIb-s/AAAAAAAAAAI/AAAAAAAAAHc/IDwR0EhwHdc/photo.jpg?sz=128", "display_name": "Hemant Parihar", "link": "https://stackoverflow.com/users/4979380/hemant-parihar"}, "edited": false, "score": 0, "creation_date": 1443048235, "post_id": 32750180, "comment_id": 53341937, "body": "I made a program to insert element(5) to array[] = {3, 4, 6} and i insert it successfully. so when ever  i need to insert i can and its size is  increased as according to no. of elements. As you say I should prefer dynamic memory allocation to insert the element . so why I prefer dynamic memory allocation to insert as i can do the same thing with static memory allocation.?"}, {"owner": {"reputation": 17343, "user_id": 445976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c82b2b9bdcf1baaf4677238d59cf745f?s=128&d=identicon&r=PG", "display_name": "Blastfurnace", "link": "https://stackoverflow.com/users/445976/blastfurnace"}, "reply_to_user": {"reputation": 712, "user_id": 4979380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-s_LEy5WIb-s/AAAAAAAAAAI/AAAAAAAAAHc/IDwR0EhwHdc/photo.jpg?sz=128", "display_name": "Hemant Parihar", "link": "https://stackoverflow.com/users/4979380/hemant-parihar"}, "edited": false, "score": 2, "creation_date": 1443060133, "post_id": 32750180, "comment_id": 53344875, "body": "@HemantParihar: C arrays don&#39;t dynamically resize themselves. If you thought you added an element to that array you probably just wrote past the end of the array. Your code was badly broken and unfortunately didn&#39;t crash in an obvious way."}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 17343, "user_id": 445976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c82b2b9bdcf1baaf4677238d59cf745f?s=128&d=identicon&r=PG", "display_name": "Blastfurnace", "link": "https://stackoverflow.com/users/445976/blastfurnace"}, "edited": false, "score": 0, "creation_date": 1443060908, "post_id": 32750180, "comment_id": 53345044, "body": "I agree with @Blastfurnace. It&#39;s not like PHP for example."}], "tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": true, "score": 2, "last_activity_date": 1443045923, "last_edit_date": 1495542572, "creation_date": 1443045410, "answer_id": 32750180, "question_id": 32750114, "link": "https://stackoverflow.com/questions/32750114/is-it-better-to-initialize-the-array-without-the-max-elements/32750180#32750180", "title": "Is it better to initialize the array without the MAX_ELEMENTS?", "body": "<blockquote>\n  <p>Q: Is it better to initialize the array without the MAX_ELEMENTS?</p>\n</blockquote>\n\n<p>A: It depends on what you want to do!</p>\n\n<hr>\n\n<p>Use this:</p>\n\n<pre><code>int array[] = {2, 3, 4, 6};\n</code></pre>\n\n<p>when you want the array to have exactly as many cells as the elements in the initialization process. Note that <code>int array[4] = {2, 3, 4, 6};</code> is equivalent.</p>\n\n<p>Use this:</p>\n\n<pre><code>int array[6] = {2, 3, 4, 6};\n</code></pre>\n\n<p>when you know that you are going to need to more cells, that are going to get filled after the initialization process.</p>\n\n<p>This:</p>\n\n<pre><code>int array[MAX_SIZE] = {2, 3, 4, 6};\n</code></pre>\n\n<p>is equivalent to the above case, when <code>MAX_SIZE = 6</code>.</p>\n\n<hr>\n\n<p>You should check this:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/8385322/difference-between-static-memory-allocation-and-dynamic-memory-allocation\">Difference between static memory allocation and dynamic memory allocation</a></p>\n\n<p>and this one for the <code>sizeof()</code> operator:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/37538/how-do-i-determine-the-size-of-my-array-in-c\">How do I determine the size of my array in C?</a></p>\n\n<hr>\n\n<p>So, if you know exactly how many elements your array will have, use static memory allocation, where if you do not know, use dynamic memory allocation.</p>\n"}, {"tags": [], "owner": {"reputation": 8084, "user_id": 2896626, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4cd83959d7fe39c658d2e49cfecfe4b6?s=128&d=identicon&r=PG&f=1", "display_name": "Paul92", "link": "https://stackoverflow.com/users/2896626/paul92"}, "is_accepted": false, "score": 0, "last_activity_date": 1443045444, "creation_date": 1443045444, "answer_id": 32750185, "question_id": 32750114, "link": "https://stackoverflow.com/questions/32750114/is-it-better-to-initialize-the-array-without-the-max-elements/32750185#32750185", "title": "Is it better to initialize the array without the MAX_ELEMENTS?", "body": "<p>I think you are confused by the sizeof operator and assume that the number 16 you get is the number of elements of the array. This is not true. The sizeof operator gives you the size of the object (in a low level sense, not in a object oriented sense) you pass, in bytes. So, you get 16 bytes, which means 4 elements, since an int has 4 bytes.</p>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 0, "last_activity_date": 1443045518, "creation_date": 1443045518, "answer_id": 32750202, "question_id": 32750114, "link": "https://stackoverflow.com/questions/32750114/is-it-better-to-initialize-the-array-without-the-max-elements/32750202#32750202", "title": "Is it better to initialize the array without the MAX_ELEMENTS?", "body": "<p>The answer depends on how you intend on using the array.  </p>\n\n<p>If the array will contain a known set of elements at compile time and only those elements, don't specify the size.  Then if you need to loop through the array you can use this syntax:</p>\n\n<pre><code>for (i = 0; i &lt; sizeof(array)/sizeof(array[0]); i++)\n</code></pre>\n\n<p>If you ever want to add or remove elements from the list, the above statement doesn't need to change.</p>\n\n<p>If the size of the array isn't related to what its initial elements are, or if the array is uninitialized or partially initialized, then you would specify the size.</p>\n"}], "owner": {"reputation": 712, "user_id": 4979380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-s_LEy5WIb-s/AAAAAAAAAAI/AAAAAAAAAHc/IDwR0EhwHdc/photo.jpg?sz=128", "display_name": "Hemant Parihar", "link": "https://stackoverflow.com/users/4979380/hemant-parihar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 32750180, "answer_count": 3, "score": 0, "last_activity_date": 1443045923, "creation_date": 1443045063, "last_edit_date": 1443045520, "question_id": 32750114, "link": "https://stackoverflow.com/questions/32750114/is-it-better-to-initialize-the-array-without-the-max-elements", "title": "Is it better to initialize the array without the MAX_ELEMENTS?", "body": "<pre><code>int array[] = {2, 3, 4, 6};\nint array[6] = {2, 3, 4, 6};\nint array[MAX_SIZE] = {2, 3, 4, 6};\n</code></pre>\n\n<p>Here in the first statement I don't mention the no of elements an array can hold. The second array can hold 6 elements and third can also hold 6 elements. When I used <code>sizeof(array)</code> to determine the size. Size of first array is 16. Second and third have 24 respectively.</p>\n\n<p>Why should not i prefer the first one? As it used memory, as the no of elements it has. While in case of second and third, I first tell the no. of elements it can hold and the size become 24. Further i can't use that memory for other work.</p>\n\n<p>Another way to initialize with use of <code>malloc(6 * sizeof(int))</code> and call <code>free(array)</code>. This will allow me to use the unused memory. But why should i do this as <code>array[]</code> use memory as the no of elements it has. <code>malloc</code> also doing the same thing but it is easy to write and remember <code>array[]</code>.</p>\n"}, {"tags": ["c", "linux", "gtk"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1443049631, "post_id": 32750104, "comment_id": 53342359, "body": "What first iteration? What second iteration? Your code does not show any iterations. Please post the exact code that you are referring to as an <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a>."}, {"owner": {"reputation": 518, "user_id": 1218232, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d509b66be4756399ec2b91fbeff65248?s=128&d=identicon&r=PG", "display_name": "Adel Ahmed", "link": "https://stackoverflow.com/users/1218232/adel-ahmed"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1443109672, "post_id": 32750104, "comment_id": 53370348, "body": "I have modified the original post with my code"}], "answers": [{"comments": [{"owner": {"reputation": 518, "user_id": 1218232, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d509b66be4756399ec2b91fbeff65248?s=128&d=identicon&r=PG", "display_name": "Adel Ahmed", "link": "https://stackoverflow.com/users/1218232/adel-ahmed"}, "edited": false, "score": 0, "creation_date": 1443130941, "post_id": 32770436, "comment_id": 53381828, "body": "DUH, I feel so stupid thanks this has been driving me crazy"}], "tags": [], "owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "is_accepted": true, "score": 1, "last_activity_date": 1443126921, "creation_date": 1443126921, "answer_id": 32770436, "question_id": 32750104, "link": "https://stackoverflow.com/questions/32750104/comparing-gchar-to-a-string/32770436#32770436", "title": "comparing gchar to a string", "body": "<p>All string compare functions return <code>0</code> on match. So your <code>if</code> conditional should check for <code>0</code> not <code>1</code>.</p>\n\n<p><a href=\"https://developer.gnome.org/glib/stable/glib-String-Utility-Functions.html#g-ascii-strncasecmp\" rel=\"nofollow\">https://developer.gnome.org/glib/stable/glib-String-Utility-Functions.html#g-ascii-strncasecmp</a>:</p>\n\n<blockquote>\n  <p>Returns</p>\n  \n  <p>0 if the strings match, a negative value if s1 &lt; s2 , or a positive\n  value if s1 > s2 .</p>\n</blockquote>\n"}], "owner": {"reputation": 518, "user_id": 1218232, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d509b66be4756399ec2b91fbeff65248?s=128&d=identicon&r=PG", "display_name": "Adel Ahmed", "link": "https://stackoverflow.com/users/1218232/adel-ahmed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1218, "favorite_count": 0, "accepted_answer_id": 32770436, "answer_count": 1, "score": 0, "last_activity_date": 1443126921, "creation_date": 1443045003, "last_edit_date": 1443117158, "question_id": 32750104, "link": "https://stackoverflow.com/questions/32750104/comparing-gchar-to-a-string", "title": "comparing gchar to a string", "body": "<p>I'm using the following code to compare a string store in a <code>gchar</code> to a <code>char</code> array read from a file:</p>\n\n<pre><code>while (fgets(line, sizeof line, config) != NULL)\n  {\n    printf(\"line content is %s\",line+5);\n    printf(\"size of comparison: %i\\n\",g_utf8_strlen(active_selection,-1));\n    if (g_ascii_strncasecmp(line+5,active_selection,g_utf8_strlen(active_selection,-1)+1)==1)\n    {\n      printf(\"success \\n\\n\");\n    }\n    else\n      printf(\"failure\\n\");\n  }\n</code></pre>\n\n<p>the config file values are:</p>\n\n<pre><code>set \"hello\"\nbutton \"hello\" \"some text\"\nbutton \"phone\" \"more text\"\nset \"pmrs\"\nbutton \"test\" \"test even more text\"\n</code></pre>\n\n<p><code>printf()</code> shows the following values:</p>\n\n<blockquote>\n  <p><code>line+5</code> = hello\"<br>\n  <code>line+5</code> (second iteration) = on \"hello\"<br>\n  <code>active_selection</code> = hello<br>\n  <code>g_utf8_strlen(active_selection,-1)</code> = 5</p>\n</blockquote>\n\n<p>What I was expecting was that the first iteration (<code>hello\"</code>) would return <code>true</code>\nand the second would return <code>false</code> (on <code>\"hello\"</code>),\nthinking only the first 5 characters would be compared.</p>\n\n<p>Apparently that is not the case since I always get the <code>else</code> statement executed (I used <code>printf</code> to test).</p>\n"}, {"tags": ["c", "sockets", "http"], "comments": [{"owner": {"reputation": 41440, "user_id": 3887516, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/62e0310897139a10f3293022b6eb7054?s=128&d=identicon&r=PG&f=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/3887516/amit"}, "edited": false, "score": 0, "creation_date": 1443044315, "post_id": 32749925, "comment_id": 53340503, "body": "How do you know it isn&#39;t being sent?"}, {"owner": {"reputation": 1197, "user_id": 4025071, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/TZaTm.jpg?s=128&g=1", "display_name": "Jordan Davis", "link": "https://stackoverflow.com/users/4025071/jordan-davis"}, "reply_to_user": {"reputation": 41440, "user_id": 3887516, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/62e0310897139a10f3293022b6eb7054?s=128&d=identicon&r=PG&f=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/3887516/amit"}, "edited": false, "score": 0, "creation_date": 1443045412, "post_id": 32749925, "comment_id": 53340946, "body": "its not even sending a response in the browser..."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1443055517, "post_id": 32749925, "comment_id": 53343873, "body": "There are so many things wrong with this &quot;barebones&quot; server, it is not funny. You are not doing very good error handling. You are opening the file in text mode instead of binary mode. <code>sizeof(msg)</code> is wrong, use <code>fsize</code> instead (for that matter, I wouldn&#39;t advise reading the entire file into memory anyway, read and send it in chunks instead otherwise you won&#39;t be able to handle large files later on). You are calling <code>listen()</code> too many times, call it once, not in a loop. You are not checking if <code>recv()</code> failed..."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1443055624, "post_id": 32749925, "comment_id": 53343902, "body": "...  You are not trying to parse the client&#39;s request for correctness at all before sending your reply. You <i>must</i> use <code>\\r\\n</code> instead of <code>\\n</code> in your reply headers. Your <code>Content-length</code> header is not specifying the <i>actual</i> <code>fsize</code> value (the file is <i>not</i> 46 bytes). You are not making sure <code>send()</code> is successfully sending <i>all</i> requested bytes. And sending <code>fsize+1</code> bytes is wrong, since the file is only <code>fsize</code> number of bytes. And there is no <code>Connection: close</code> header being sent."}, {"owner": {"reputation": 1197, "user_id": 4025071, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/TZaTm.jpg?s=128&g=1", "display_name": "Jordan Davis", "link": "https://stackoverflow.com/users/4025071/jordan-davis"}, "edited": false, "score": 0, "creation_date": 1443055658, "post_id": 32749925, "comment_id": 53343908, "body": "who said it was funny... I just stated  I left errors out for clarity, I added them a minute ago...."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 1, "creation_date": 1443055743, "post_id": 32749925, "comment_id": 53343924, "body": "@JordanDavis No you didn&#39;t. You just added success reporting. There is practically no failure handling in this code whatsoever."}, {"owner": {"reputation": 1197, "user_id": 4025071, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/TZaTm.jpg?s=128&g=1", "display_name": "Jordan Davis", "link": "https://stackoverflow.com/users/4025071/jordan-davis"}, "edited": false, "score": 0, "creation_date": 1443055883, "post_id": 32749925, "comment_id": 53343954, "body": "so clearly this guy doesn&#39;t know what he is doing ---- <a href=\"http://blog.manula.org/2011/05/writing-simple-web-server-in-c.html\" rel=\"nofollow noreferrer\">blog.manula.org/2011/05/writing-simple-web-server-in-c.html</a>"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1443056036, "post_id": 32749925, "comment_id": 53343984, "body": "@JordanDavis: clearly, he doesn&#39;t.  The code is <i>completely</i> wrong for a dozen different reasons.."}, {"owner": {"reputation": 1197, "user_id": 4025071, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/TZaTm.jpg?s=128&g=1", "display_name": "Jordan Davis", "link": "https://stackoverflow.com/users/4025071/jordan-davis"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1443056099, "post_id": 32749925, "comment_id": 53344001, "body": "@RemyLebeau good to know..."}, {"owner": {"reputation": 1197, "user_id": 4025071, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/TZaTm.jpg?s=128&g=1", "display_name": "Jordan Davis", "link": "https://stackoverflow.com/users/4025071/jordan-davis"}, "edited": false, "score": 0, "creation_date": 1443057089, "post_id": 32749925, "comment_id": 53344181, "body": "can either of you guys show me a good example using <code>send()</code> you guys clearly no what your talking about lol"}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1443057225, "post_id": 32749925, "comment_id": 53344213, "body": "@JordanDavis Again, I had already done so."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1443057676, "post_id": 32749925, "comment_id": 53344312, "body": "@JordanDavis: I just posted an example."}, {"owner": {"reputation": 1197, "user_id": 4025071, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/TZaTm.jpg?s=128&g=1", "display_name": "Jordan Davis", "link": "https://stackoverflow.com/users/4025071/jordan-davis"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1443057831, "post_id": 32749925, "comment_id": 53344338, "body": "Perfect thank you @RemyLebeau"}], "answers": [{"comments": [{"owner": {"reputation": 1197, "user_id": 4025071, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/TZaTm.jpg?s=128&g=1", "display_name": "Jordan Davis", "link": "https://stackoverflow.com/users/4025071/jordan-davis"}, "edited": false, "score": 0, "creation_date": 1443046320, "post_id": 32750341, "comment_id": 53341281, "body": "Yea thats what I figured it was the headers.... will writing those on the socket first, before sending the file(index.html) work?"}, {"owner": {"reputation": 41440, "user_id": 3887516, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/62e0310897139a10f3293022b6eb7054?s=128&d=identicon&r=PG&f=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/3887516/amit"}, "reply_to_user": {"reputation": 1197, "user_id": 4025071, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/TZaTm.jpg?s=128&g=1", "display_name": "Jordan Davis", "link": "https://stackoverflow.com/users/4025071/jordan-davis"}, "edited": false, "score": 0, "creation_date": 1443046398, "post_id": 32750341, "comment_id": 53341316, "body": "@JordanDavis read about the protocol. It&#39;s too long to be expressed in this answer, but there&#39;s plenty information online."}, {"owner": {"reputation": 1197, "user_id": 4025071, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/TZaTm.jpg?s=128&g=1", "display_name": "Jordan Davis", "link": "https://stackoverflow.com/users/4025071/jordan-davis"}, "edited": false, "score": 0, "creation_date": 1443046870, "post_id": 32750341, "comment_id": 53341462, "body": "I know about the protocol I&#39;m not a complete idiot :), and had the server working sending the html as a &quot;string&quot;, but now when I try sending it as a file it&#39;s failing.. my guess is I need to send the headers to the socket before I send the buffer containing the html... or I need to write the headers to the buffer before I send the buffer?"}, {"owner": {"reputation": 41440, "user_id": 3887516, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/62e0310897139a10f3293022b6eb7054?s=128&d=identicon&r=PG&f=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/3887516/amit"}, "reply_to_user": {"reputation": 1197, "user_id": 4025071, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/TZaTm.jpg?s=128&g=1", "display_name": "Jordan Davis", "link": "https://stackoverflow.com/users/4025071/jordan-davis"}, "edited": false, "score": 0, "creation_date": 1443047247, "post_id": 32750341, "comment_id": 53341593, "body": "Big picture, yes, headers come before content. But really, if you have any plan to be serious about this, read extensively about the protocol"}, {"owner": {"reputation": 1197, "user_id": 4025071, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/TZaTm.jpg?s=128&g=1", "display_name": "Jordan Davis", "link": "https://stackoverflow.com/users/4025071/jordan-davis"}, "edited": false, "score": 0, "creation_date": 1443047493, "post_id": 32750341, "comment_id": 53341677, "body": "writing it to the buffer(html) then send()..... or two send() operations one for headers, one for html."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 1197, "user_id": 4025071, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/TZaTm.jpg?s=128&g=1", "display_name": "Jordan Davis", "link": "https://stackoverflow.com/users/4025071/jordan-davis"}, "edited": false, "score": 1, "creation_date": 1443055127, "post_id": 32750341, "comment_id": 53343777, "body": "@JordanDavis: TCP is a streaming transport. You can <code>send()</code> as many times as you need, the data will be buffered on the network layer as needed. What is important is <i>what</i> you send."}], "tags": [], "owner": {"reputation": 41440, "user_id": 3887516, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/62e0310897139a10f3293022b6eb7054?s=128&d=identicon&r=PG&f=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/3887516/amit"}, "is_accepted": false, "score": 0, "last_activity_date": 1443046228, "creation_date": 1443046228, "answer_id": 32750341, "question_id": 32749925, "link": "https://stackoverflow.com/questions/32749925/sending-a-file-over-a-tcp-ip-socket-web-server/32750341#32750341", "title": "Sending a file over a TCP/IP socket (web server)", "body": "<p>Other then the wrong size used in various places (as noted by mathematician1975), your \"real\" problem is that your trying to communicate with a browser that expects an HTTP server.</p>\n\n<p><strong>H</strong>yper<strong>T</strong>ext <strong>T</strong>ransfer <strong>P</strong>rotocol is, well, <a href=\"https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol\" rel=\"nofollow\">a protocol</a>. It is more complex then a simple connection and a dump of content.</p>\n\n<p>You have to parse the request according to it, and send headers and content in a certain way.</p>\n"}, {"comments": [{"owner": {"reputation": 1197, "user_id": 4025071, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/TZaTm.jpg?s=128&g=1", "display_name": "Jordan Davis", "link": "https://stackoverflow.com/users/4025071/jordan-davis"}, "edited": false, "score": 0, "creation_date": 1443046951, "post_id": 32750461, "comment_id": 53341497, "body": "I know its not this just because I had it working with a &quot;string&quot; of HTML before  hand, and the compiler isn&#39;t failing on the <code>bind()</code>"}], "tags": [], "owner": {"reputation": 4445, "user_id": 560903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d66cec4f7bd065097137c2001c96b866?s=128&d=identicon&r=PG", "display_name": "keithmo", "link": "https://stackoverflow.com/users/560903/keithmo"}, "is_accepted": false, "score": 0, "last_activity_date": 1443047616, "last_edit_date": 1443047616, "creation_date": 1443046835, "answer_id": 32750461, "question_id": 32749925, "link": "https://stackoverflow.com/questions/32749925/sending-a-file-over-a-tcp-ip-socket-web-server/32750461#32750461", "title": "Sending a file over a TCP/IP socket (web server)", "body": "<p>Check to see if <code>bind()</code> is failing and report if so. You're binding to port 80; under Unix-like operating systems only root can bind to reserved ports (less than 1024).</p>\n\n<p>Update 1:</p>\n\n<p>You must initialize <code>addrlen</code> to <code>sizeof(address)</code> before calling <code>accept()</code>. From <a href=\"http://linux.die.net/man/2/accept\" rel=\"nofollow\">http://linux.die.net/man/2/accept</a>:</p>\n\n<blockquote>\n  <p>The addrlen argument is a value-result argument: the caller must\n  initialize it to contain the size (in bytes) of the structure pointed\n  to by addr; on return it will contain the actual size of the peer\n  address.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 1197, "user_id": 4025071, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/TZaTm.jpg?s=128&g=1", "display_name": "Jordan Davis", "link": "https://stackoverflow.com/users/4025071/jordan-davis"}, "edited": false, "score": 0, "creation_date": 1443054956, "post_id": 32751547, "comment_id": 53343740, "body": "I just updated my code adding in the values... I left the checks out for clarity, I had that written at the top of this question..."}, {"owner": {"reputation": 1197, "user_id": 4025071, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/TZaTm.jpg?s=128&g=1", "display_name": "Jordan Davis", "link": "https://stackoverflow.com/users/4025071/jordan-davis"}, "edited": false, "score": 0, "creation_date": 1443057999, "post_id": 32751547, "comment_id": 53344372, "body": "Thanks for you input @EJP"}], "tags": [], "owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "is_accepted": false, "score": 1, "last_activity_date": 1443057307, "last_edit_date": 1443057307, "creation_date": 1443054678, "answer_id": 32751547, "question_id": 32749925, "link": "https://stackoverflow.com/questions/32749925/sending-a-file-over-a-tcp-ip-socket-web-server/32751547#32751547", "title": "Sending a file over a TCP/IP socket (web server)", "body": "<pre><code>fsize = ftell(fp);\nrewind(fp);\nchar *filebuff = malloc(fsize + 1);\n</code></pre>\n\n<p>Why <code>fsize+1</code>? You don't need the <code>+1</code>.</p>\n\n<pre><code>fread(filebuff, sizeof(filebuff), 1, fp);\n</code></pre>\n\n<p>Unchecked return value. The second argument should be <code>fsize</code>. At present you're only passing the <code>sizeof</code> the pointer.</p>\n\n<pre><code>//create/bind socket\nif ((create_socket = socket(AF_INET, SOCK_STREAM, 0)) &gt; 0)\n{    \n  printf(\"The socket was created\\n\");\n}\n</code></pre>\n\n<p>If the socket creation fails you must (a) print a proper error message as described below and (b) <strong><em>not</em></strong> just continue with execution as though the error hadn't occurred.</p>\n\n<pre><code>if (bind(create_socket, (struct sockaddr *) &amp;address, sizeof(address)) == 0)\n{    \n  printf(\"Binding Socket\\n\");\n</code></pre>\n\n<p>}</p>\n\n<p>Ditto.</p>\n\n<pre><code>//listen, create new_sock, write headers, send file \nwhile (1){   \n   if (listen(create_socket, 10) &lt; 0) {    \n       perror(\"server: listen\");    \n       exit(1);    \n    }\n</code></pre>\n\n<p>The <code>listen()</code> call should be ahead of the loop, not inside it. This is the first time you've actually handled a failure case.</p>\n\n<pre><code>    new_sock = accept(sock, (struct sockaddr *) &amp;address, &amp;addrlen);            \n    recv(new_socket, buffer, bufsize, 0);    \n    printf(\"%s\\n\", buffer);    \n</code></pre>\n\n<p>Invalid. Unchecked return code. The buffer is only valid at all if <code>recv()</code> returned a positive integer, and only that many bytes of it are valid. It should be:</p>\n\n<pre><code>    int count = recv(new_socket, buffer, bufsize, 0);    \n    printf(\"%.*s\\n\", count, buffer);    \n</code></pre>\n\n<p>Then we start on HTTP:</p>\n\n<pre><code>    write(new_sock, \"HTTP/1.1 200 OK\\n\", 16);\n    write(new_sock, \"Content-length: 46\\n\", 19);\n    write(new_sock, \"Content-Type: text/html\\n\\n\", 25);\n</code></pre>\n\n<p>The line terminator in HTTP is inherited from Telnet and it is specified as <code>\\r\\n</code>, not <code>\\n</code>.</p>\n\n<pre><code>    if(send(new_sock, filebuff, fsize+1, 0) &gt; 0){\n        printf(\"success\");\n    }     \n    else{\n        printf(\"failed\");\n    }\n</code></pre>\n\n<p>Inadequate. If you get an error from any system call, you must call <code>perror()</code>, or use <code>errno</code> or <code>strerror()</code> in an error message. \"Failed\" conveys no useful information, and debugging becomes a mere guessing game. Don't write code like this. You should use <code>perror()</code> or whatever you decide for all the other unchecked return values above.</p>\n\n<p>But there is a bigger problem. You're assuming that the file fits into memory. There is no need for that assumption. Just copy the file using an 8k buffer as follows:</p>\n\n<pre><code>int count;\nwhile ((count = read(in, buffer, sizeof buffer)) &gt; 0)\n{\n    send(out, buffer, count, 0);\n}\nif (count &lt; 0)\n{\n    perror(\"send failed\");\n}\n</code></pre>\n\n<p>I would avoid <code>stdio</code> for this, it has too many issues, such as the poorly designed <code>fread()</code> and <code>fwrite()</code> function APIs.</p>\n"}, {"comments": [{"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1443058230, "post_id": 32751916, "comment_id": 53344423, "body": "VG but you&#39;ve ignored the return value of <code>fread()</code>, and you&#39;re calling <code>perror()</code> if <code>read()</code> returns zero, which isn&#39;t valid."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1443062392, "post_id": 32751916, "comment_id": 53345380, "body": "I am not ignoring the return value of <code>fread()</code>, but you are right about the return value of <code>recv()</code> (I am not calling <code>read()</code>). I have fixed that."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1443471676, "post_id": 32751916, "comment_id": 53498096, "body": "I have made some tweaks to the code.  Try compiling it again."}, {"owner": {"reputation": 2911, "user_id": 4266765, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/KeB2V.jpg?s=128&g=1", "display_name": "Pilpel", "link": "https://stackoverflow.com/users/4266765/pilpel"}, "edited": false, "score": 0, "creation_date": 1497265135, "post_id": 32751916, "comment_id": 75988472, "body": "Where&#39;s <code>getaddrinfo()</code>?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 2911, "user_id": 4266765, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/KeB2V.jpg?s=128&g=1", "display_name": "Pilpel", "link": "https://stackoverflow.com/users/4266765/pilpel"}, "edited": false, "score": 1, "creation_date": 1497276658, "post_id": 32751916, "comment_id": 75996772, "body": "@Pilpel: not needed in this example since it is hard-coded to use only IPv4 and listen only on <code>INADDR_ANY</code>. Using <code>getaddrinfo()</code> would produce the same <code>sockaddr_in</code>, unless you enable IPv6, in which case you need to allocate multiple sockets with multiple bindings, then <code>getaddrinfo</code> makes sense. Or you could just create a dual-stack socket to handle both IPv4 and IPv6 together, in which case you wouldn&#39;t use <code>getaddrinfo</code> again."}, {"owner": {"reputation": 2911, "user_id": 4266765, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/KeB2V.jpg?s=128&g=1", "display_name": "Pilpel", "link": "https://stackoverflow.com/users/4266765/pilpel"}, "edited": false, "score": 0, "creation_date": 1497278104, "post_id": 32751916, "comment_id": 75997824, "body": "Thanks for the answer, I thought getaddrinfo was a must"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 2911, "user_id": 4266765, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/KeB2V.jpg?s=128&g=1", "display_name": "Pilpel", "link": "https://stackoverflow.com/users/4266765/pilpel"}, "edited": false, "score": 1, "creation_date": 1497284462, "post_id": 32751916, "comment_id": 76001960, "body": "@Pilpel: it <i>can</i> be used server side, but it is more useful on the client side"}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 6, "last_activity_date": 1443471661, "last_edit_date": 1443471661, "creation_date": 1443057637, "answer_id": 32751916, "question_id": 32749925, "link": "https://stackoverflow.com/questions/32749925/sending-a-file-over-a-tcp-ip-socket-web-server/32751916#32751916", "title": "Sending a file over a TCP/IP socket (web server)", "body": "<p>The code is <em>completely</em> broken, for a dozen different reasons.  Try something more like this instead:</p>\n\n<pre><code>#include &lt;netinet/in.h&gt;    \n#include &lt;stdio.h&gt;    \n#include &lt;stdlib.h&gt;    \n#include &lt;sys/socket.h&gt;    \n#include &lt;sys/stat.h&gt;    \n#include &lt;sys/types.h&gt;    \n#include &lt;unistd.h&gt;    \n\nbool writeDataToClient(int sckt, const void *data, int datalen)\n{\n    const char *pdata = (const char*) data;\n\n    while (datalen &gt; 0){\n        int numSent = send(sckt, pdata, datalen, 0);\n        if (numSent &lt;= 0){\n            if (numSent == 0){\n                printf(\"The client was not written to: disconnected\\n\");\n            } else {\n                perror(\"The client was not written to\");\n            }\n            return false;\n        }\n        pdata += numSent;\n        datalen -= numSent;\n    }\n\n    return true;\n}\n\nbool writeStrToClient(int sckt, const char *str)\n{\n    return writeDataToClient(sckt, str, strlen(str));\n}\n\nint main(void){\n    int create_socket, new_socket;    \n    char *buffer;\n    int bufsize = 1024;    \n    struct sockaddr_in address;    \n    socklen_t addrlen;    \n\n    buffer = (char*) malloc(bufsize);    \n    if (!buffer){\n        printf(\"The receive buffer was not allocated\\n\");\n        exit(1);    \n    }\n\n    create_socket = socket(AF_INET, SOCK_STREAM, 0);\n    if (create_socket == -1){    \n        perror(\"The socket was not created\");    \n        exit(1);    \n    }\n\n    printf(\"The socket was created\\n\");\n\n    memset(&amp;address, 0, sizeof(address));    \n    address.sin_family = AF_INET;    \n    address.sin_addr.s_addr = INADDR_ANY;    \n    address.sin_port = htons(80);    \n\n    if (bind(create_socket, (struct sockaddr *) &amp;address, sizeof(address)) == -1){    \n        perror(\"The socket was not bound\");    \n        exit(1);    \n    }\n\n    printf(\"The socket is bound\\n\");    \n\n    long fsize;\n    FILE *fp = fopen(\"index.html\", \"rb\");\n    if (!fp){\n        perror(\"The file was not opened\");    \n        exit(1);    \n    }\n\n    printf(\"The file was opened\\n\");\n\n    if (fseek(fp, 0, SEEK_END) == -1){\n        perror(\"The file was not seeked\");\n        exit(1);\n    }\n\n    fsize = ftell(fp);\n    if (fsize == -1) {\n        perror(\"The file size was not retrieved\");\n        exit(1);\n    }\n    rewind(fp);\n\n    char *msg = (char*) malloc(fsize);\n    if (!msg){\n        perror(\"The file buffer was not allocated\\n\");\n        exit(1);\n    }\n\n    if (fread(msg, fsize, 1, fp) != 1){\n        perror(\"The file was not read\\n\");\n        exit(1);\n    }\n    fclose(fp);\n\n    printf(\"The file size is %ld\\n\", fsize);\n\n    if (listen(create_socket, 10) == -1){\n        perror(\"The socket was not opened for listening\");    \n        exit(1);    \n    }    \n\n    printf(\"The socket is listening\\n\");\n\n    while (1) {    \n\n        addrlen = sizeof(address);\n        new_socket = accept(create_socket, (struct sockaddr *) &amp;address, &amp;addrlen);\n\n        if (new_socket == -1) {    \n            perror(\"A client was not accepted\");    \n            exit(1);    \n        }    \n\n        printf(\"A client is connected from %s:%hu...\\n\", inet_ntoa(address.sin_addr), ntohs(address.sin_port));    \n\n        // I will leave it as an exercise for you to implement\n        // a proper HTTP request parser here...\n        int numRead = recv(new_socket, buffer, bufsize, 0);\n        if (numRead &lt; 1){\n            if (numRead == 0){\n                printf(\"The client was not read from: disconnected\\n\");\n            } else {\n                perror(\"The client was not read from\");\n            }\n            close(new_socket);\n            continue;\n        }\n        printf(\"%.*s\\n\", numRead, buffer);    \n\n        if (!writeStrToClient(new_socket, \"HTTP/1.1 200 OK\\r\\n\")){\n            close(new_socket);\n            continue;\n        }\n\n        char clen[40];\n        sprintf(clen, \"Content-length: %ld\\r\\n\", fsize);\n        if (!writeStrToClient(new_socket, clen)){\n            close(new_socket);\n            continue;\n        }\n\n        if (!writeStrToClient(new_socket, \"Content-Type: text/html\\r\\n\")){\n            close(new_socket);\n            continue;\n        }\n\n        if (!writeStrToClient(new_socket, \"Connection: close\\r\\n\\r\\n\") == -1){\n            close(new_socket);\n            continue;\n        }\n\n        //if (!writeStrToClient(new_socket, \"&lt;html&gt;&lt;body&gt;&lt;H1&gt;Hello world&lt;/H1&gt;&lt;/body&gt;&lt;/html&gt;\")){\n        if (!writeDataToClient(new_socket, msg, fsize)){\n            close(new_socket);\n            continue;\n        }\n\n        printf(\"The file was sent successfully\\n\");\n        close(new_socket);    \n   }    \n\n   close(create_socket);    \n   return 0;    \n}\n</code></pre>\n"}], "owner": {"reputation": 1197, "user_id": 4025071, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/TZaTm.jpg?s=128&g=1", "display_name": "Jordan Davis", "link": "https://stackoverflow.com/users/4025071/jordan-davis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6451, "favorite_count": 1, "accepted_answer_id": 32751916, "answer_count": 4, "score": 0, "last_activity_date": 1443471661, "creation_date": 1443044156, "last_edit_date": 1443057342, "question_id": 32749925, "link": "https://stackoverflow.com/questions/32749925/sending-a-file-over-a-tcp-ip-socket-web-server", "title": "Sending a file over a TCP/IP socket (web server)", "body": "<p>I'm writing the barebones of a web server, but I can't figure out why my file isn't be sent over my socket, I'm connecting to it and everything it just not <code>send()</code>ing my file... What am I missing?</p>\n\n<p><strong>//CODE</strong> (server.c)</p>\n\n<pre><code>#include&lt;netinet/in.h&gt;    \n#include&lt;stdio.h&gt;    \n#include&lt;stdlib.h&gt;    \n#include&lt;sys/socket.h&gt;    \n#include&lt;sys/stat.h&gt;    \n#include&lt;sys/types.h&gt;    \n#include&lt;unistd.h&gt;    \n\nint main(void) {    \n   int create_socket, new_socket;    \n   socklen_t addrlen;    \n   int bufsize = 1024;    \n   char *buffer = malloc(bufsize);    \n   struct sockaddr_in address;    \n\n   if ((create_socket = socket(AF_INET, SOCK_STREAM, 0)) &gt; 0){    \n      printf(\"The socket was created\\n\");\n   }\n\n   address.sin_family = AF_INET;    \n   address.sin_addr.s_addr = INADDR_ANY;    \n   address.sin_port = htons(80);    \n\n   if (bind(create_socket, (struct sockaddr *) &amp;address, sizeof(address)) == 0){    \n      printf(\"Binding Socket\\n\");\n   }\n\n    long fsize;\n    FILE *fp = fopen(\"index.html\", \"r\");\n    fseek(fp, 0, SEEK_END);\n    fsize = ftell(fp);\n    rewind(fp);\n    char *msg = malloc(fsize + 1);\n    fread(msg, sizeof(msg), 1, fp);\n\n   while (1) {    \n      if (listen(create_socket, 10) &lt; 0) {    \n         perror(\"server: listen\");    \n         exit(1);    \n      }    \n\n      if ((new_socket = accept(create_socket, (struct sockaddr *) &amp;address, &amp;addrlen)) &lt; 0) {    \n         perror(\"server: accept\");    \n         exit(1);    \n      }    \n\n      if (new_socket &gt; 0){    \n         printf(\"The Client is connected...\\n\");\n      }\n\n        recv(new_socket, buffer, bufsize, 0);    \n        printf(\"%s\\n\", buffer);    \n        write(new_socket, \"HTTP/1.1 200 OK\\n\", 16);\n        write(new_socket, \"Content-length: 46\\n\", 19);\n        write(new_socket, \"Content-Type: text/html\\n\\n\", 25);\n/*      write(new_socket, \"&lt;html&gt;&lt;body&gt;&lt;H1&gt;Hello world&lt;/H1&gt;&lt;/body&gt;&lt;/html&gt;\",46); */\n        if((send(new_socket, msg, fsize+1, 0)) &gt; 0){\n            printf(\"success\");\n        }     \n        else{\n            printf(\"failed\");\n        }\n      close(new_socket);    \n   }    \n   close(create_socket);    \n   return 0;    \n}\n</code></pre>\n\n<p><strong>//FILE</strong> (index.html) *same directory</p>\n\n<pre><code>&lt;html&gt;\n&lt;body&gt;\n    &lt;h1&gt;Hello World&lt;/h1&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n"}, {"tags": ["c", "embedded-linux"], "comments": [{"owner": {"reputation": 8296, "user_id": 2932052, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/63b8d6f5ce8e33b6953812ce8f5b2d40?s=128&d=identicon&r=PG", "display_name": "Wolf", "link": "https://stackoverflow.com/users/2932052/wolf"}, "edited": false, "score": 1, "creation_date": 1443041789, "post_id": 32749232, "comment_id": 53339309, "body": "Are you sure that it&#39;s not only due to granularity?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1443041826, "post_id": 32749232, "comment_id": 53339327, "body": "&quot;Global variables initialized to zero are stored in BSS&quot; This is not true."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1443042233, "post_id": 32749232, "comment_id": 53339529, "body": "Look at the <code>map</code> file."}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 2, "creation_date": 1443045019, "post_id": 32749232, "comment_id": 53340785, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/21130729/integer-variable-size-in-bss-and-data-segment\">integer variable size in bss and data segment</a>"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1443045313, "post_id": 32749232, "comment_id": 53340908, "body": "@Olaf depends on the compiler, really."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 3, "creation_date": 1443045614, "post_id": 32749232, "comment_id": 53341017, "body": "It is at the compiler&#39;s and linker&#39;s discretion what size the BSS is and which variables are assigned to it.  Most importantly to the question, it is a mistake to assume that size of the BSS is exactly the sum of the sizes of all the variables assigned to it.  There could easily be unused space in that section before, between, and/or after the space assigned to variables, for alignment or for any other purpose that the compiler or linker may choose."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 1, "creation_date": 1443051512, "post_id": 32749232, "comment_id": 53342893, "body": "@FUZxxl: The assertion as given is false (aka &quot;not true&quot;), as it does not allow an alternative. IIRC, gcc has an option for this."}], "owner": {"reputation": 155, "user_id": 3287223, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/f61b763a828a928d8781d644dcff821c?s=128&d=identicon&r=PG&f=1", "display_name": "JIN007", "link": "https://stackoverflow.com/users/3287223/jin007"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1443041735, "creation_date": 1443041432, "last_edit_date": 1443041735, "question_id": 32749232, "link": "https://stackoverflow.com/questions/32749232/unequal-data-loss-in-data-and-bss-segment", "title": "Unequal data loss in data and bss segment", "body": "<p>Why does commenting out an initialized global variable loses 4 bytes of data from data segment whereas commenting out an uninitialized global variable loses 8 bytes of data from BSS segment?</p>\n\n<p>PROGRAM1:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint global1 = 20; /* initialized global variable stored in DS*/\nint global2;    /* Uninitialized global variables stored in BSS segment*/\nint global3=0;  /* Global variables initialized to zero are stored in BSS*/\nint main(void)\n{\nstatic int i = 100; /* Initialized static variable stored in DS*/\nstatic int j=0;    /* Static variables initialized to 0 are stored in bss*/\n //int l=100;  /* stack stores the auto variables*/      \n int k;      /* stack stores the auto variables*/   \n return 0;\n}\n</code></pre>\n\n<p>Data:504  BSS 32</p>\n\n<p>PROGRAM2:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n//int global1 = 20; /* initialized global variable stored in DS*/\nint global2;    /* Uninitialized global variables stored in BSS segment*/\nint global3=0;  /* Global variables initialized to zero are stored in BSS  segment*/\nint main(void)\n{\nstatic int i = 100; /* Initialized static variable stored in DS*/\nstatic int j=0;    /* Static variables initialized to 0 are stored in BSS  segment*/\n //int l=100;  /* stack stores the auto variables*/      \n int k;      /* stack stores the auto variables*/ \nreturn 0;\n}\n</code></pre>\n\n<p>Data :500, BSS 32</p>\n\n<p>PROGRAM3:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n//int global1 = 20; /* initialized global variable stored in DS*/\n//int global2;    /* Uninitialized global variables stored in BSS segment*/\nint global3=0;  /* Global variables initialized to zero are stored in BSS  segment*/\nint main(void)\n{\nstatic int i = 100; /* Initialized static variable stored in DS*/\nstatic int j=0;    /* Static variables initialized to 0 are stored in BSS segment*/\n //int l=100;  /* stack stores the auto variables*/      \n int k;      /* stack stores the auto variables*/ \n return 0;\n\n }\n</code></pre>\n\n<p>Data 500, BSS 24    (why 24 and why not 28?)</p>\n"}, {"tags": ["c", "arrays", "string", "function", "fgets"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1443041458, "post_id": 32749083, "comment_id": 53339155, "body": "Your loops in <code>rmstr</code> are not constructed correctly. Step through it to see why. The inner loop causes the <b>same</b> character from <code>string1</code> to be <b>repeatedly</b> copied for every <code>string2</code> character that is not the same as the current <code>string1</code> character. Which will obviously make <code>count</code> become too large and overflow the <code>word</code> buffer."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1443041589, "post_id": 32749083, "comment_id": 53339213, "body": "I think you need to keep track of whether the same character has been found and then only do the copy <b>after</b> the inner loop has completed if a same character has not been matched."}], "answers": [{"comments": [{"owner": {"reputation": 365, "user_id": 4052279, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/c8946b98c1692c0dbc68829b2dc5d105?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Ricci", "link": "https://stackoverflow.com/users/4052279/andrew-ricci"}, "edited": false, "score": 0, "creation_date": 1443043017, "post_id": 32749231, "comment_id": 53339920, "body": "Any suggestions on how to fix my loops?"}], "tags": [], "owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "is_accepted": false, "score": 0, "last_activity_date": 1443041427, "creation_date": 1443041427, "answer_id": 32749231, "question_id": 32749083, "link": "https://stackoverflow.com/questions/32749083/stack-smashing-detected-upon-input-fgets/32749231#32749231", "title": "Stack Smashing Detected upon input fgets", "body": "<p>In <code>rmstr</code>:</p>\n\n<pre><code>  for(i=0; i&lt;=(s-2); i++)    {\n    for(j=0; j&lt;=(s-2); j++)\n    {\n      if(string1[i] != string2[j] &amp;&amp; string1[i] != ' ')\n      {\n        word[count] = string1[i];\n        count++;\n      }\n\n    }\n</code></pre>\n\n<p>You <code>count</code> value is always incremented in this loop of loop and can be bigger than the maximum allowed value of <code>99</code> (the last element of <code>word</code> array). For example if <code>s</code> is 12, then <code>s - 2</code> * <code>s - 2</code> will give <code>count</code> to <code>100</code>.</p>\n\n<p>Moreover at first glance it seems you forgot to use <code>l</code> in the second loop using <code>s</code> instead.</p>\n"}], "owner": {"reputation": 365, "user_id": 4052279, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/c8946b98c1692c0dbc68829b2dc5d105?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Ricci", "link": "https://stackoverflow.com/users/4052279/andrew-ricci"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 539, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1443041427, "creation_date": 1443040856, "question_id": 32749083, "link": "https://stackoverflow.com/questions/32749083/stack-smashing-detected-upon-input-fgets", "title": "Stack Smashing Detected upon input fgets", "body": "<p>The purpose is to enter string1 and string2 and remove any occurrence of any of the letters in string2 from string1. I get a stack smashing detection error after I input my second string. The function rmchr works fine. It's once we get to rmstr.</p>\n\n<p>main.c:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"rmstr.h\"\n\nint main()\n{\n  int ch, l;\n  char x[3];\n  x[0]='y';\n\n  while(x[0]=='y'||x[0]=='Y')\n  {\n    char string[100]={0}, string1[100]={0}, string2[100]={0}, c[3];\n\n    printf(\"Enter a String: \");\n    fgets(string, 100, stdin);\n    if (string[98] == '\\n' &amp;&amp; string[99] == '\\0') { while ( (ch = fgetc(stdin)) != EOF &amp;&amp; ch != '\\n'); }\n\n    printf(\"Enter a Char: \");\n    fgets(c, 2, stdin);\n    while ( (ch = fgetc(stdin)) != EOF &amp;&amp; ch != '\\n');\n\n    rmchr(string, c[0]);\n\n    printf(\"Enter a String: \");\n    fgets(string1, 100, stdin);\n    if (string1[98] == '\\n' &amp;&amp; string1[99] == '\\0') { while ( (ch = fgetc(stdin)) != EOF &amp;&amp; ch != '\\n'); }\n\n\n    printf(\"Enter the second string: \");\n    fgets(string2, 100, stdin);\n    if (string2[98] == '\\n' &amp;&amp; string2[99] == '\\0') { while ( (ch = fgetc(stdin)) != EOF &amp;&amp; ch != '\\n'); }\n\n    rmstr(string1, string2);\n\n    printf(\"Run Again?(y/n):\");\n    fgets(x, 2, stdin);\n    while ( (ch = fgetc(stdin)) != EOF &amp;&amp; ch != '\\n');\n  }\n\n return 0;\n} \n</code></pre>\n\n<p>functions.h:</p>\n\n<pre><code>rmchr(char *string, char c)\n{ \n  int i=0, j=0, count=0;\n  char word[100]={0};\n\n  int s = strlen(string);\n\n  for(i=0; i&lt;=(s-2); i++)\n  {\n    if(string[i] != c &amp;&amp; string[i] != ' ')\n    {\n      word[count] = string[i];\n      count++;\n    }    \n  }\n\n  printf(\"Word: \");\n  for(i=0; i&lt;=count; i++)\n  {\n    printf(\"%c\", word[i]); \n  }\n  printf(\"\\n\"); \n}\n\nrmstr(char *string1, char *string2)\n{\n   int i=0, j=0, count=0;\n   char word[100]={0};\n\n   int s = strlen(string1);\n   int l = strlen(string2);\n\n   for(i=0; i&lt;=(s-2); i++)\n   {\n    for(j=0; j&lt;=(s-2); j++)\n    {\n      if(string1[i] != string2[j] &amp;&amp; string1[i] != ' ')\n      {\n        word[count] = string1[i];\n        count++;\n      }\n\n    }\n\n  }\n}\n</code></pre>\n\n<p>sample outpput:</p>\n\n<pre><code>Enter a String: Ahhaha\nEnter a Char: h\nWord: Aaa\nEnter a String: Annabcdcbcdbckje\nEnter the second string: n\n*** stack smashing detected ***: ./q4 terminated\nAborted (core dumped)\n</code></pre>\n"}, {"tags": ["c", "memory", "static", "allocation"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1443039928, "post_id": 32748784, "comment_id": 53338352, "body": "&quot;I have this implementation of alloc, which allocates memory as a dynamic array&quot;. There doesn&#39;t appear to be be any dynamic arrays in your code."}, {"owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1443040686, "post_id": 32748784, "comment_id": 53338751, "body": "@AlanAu define <i>dynamic</i>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1443041182, "post_id": 32748784, "comment_id": 53338996, "body": "You should not use <code>0</code> as null pointer constant. Instead use the <code>NULL</code> macro. Note that even C++ learned this lesson, favouring <code>nullptr</code>."}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 5015365, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5186064774408ce12fd6202b0dfaff77?s=128&d=identicon&r=PG&f=1", "display_name": "user 004325", "link": "https://stackoverflow.com/users/5015365/user-004325"}, "edited": false, "score": 0, "creation_date": 1443040746, "post_id": 32748885, "comment_id": 53338787, "body": "So adding the static specifier only limits the visibility of the objects to the source file?"}, {"owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "reply_to_user": {"reputation": 39, "user_id": 5015365, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5186064774408ce12fd6202b0dfaff77?s=128&d=identicon&r=PG&f=1", "display_name": "user 004325", "link": "https://stackoverflow.com/users/5015365/user-004325"}, "edited": false, "score": 0, "creation_date": 1443040845, "post_id": 32748885, "comment_id": 53338837, "body": "@user004325 yes, for objects defined at file-scope, adding <code>static</code> (versus no storage specifier) makes the objects private to the translation unit."}, {"owner": {"reputation": 39, "user_id": 5015365, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5186064774408ce12fd6202b0dfaff77?s=128&d=identicon&r=PG&f=1", "display_name": "user 004325", "link": "https://stackoverflow.com/users/5015365/user-004325"}, "edited": false, "score": 0, "creation_date": 1443041463, "post_id": 32748885, "comment_id": 53339159, "body": "What does this mean in practice?"}, {"owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "reply_to_user": {"reputation": 39, "user_id": 5015365, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5186064774408ce12fd6202b0dfaff77?s=128&d=identicon&r=PG&f=1", "display_name": "user 004325", "link": "https://stackoverflow.com/users/5015365/user-004325"}, "edited": false, "score": 0, "creation_date": 1443041828, "post_id": 32748885, "comment_id": 53339330, "body": "@user004325 that you cannot access <code>allocbuf</code> array directly from another source file, which is the purpose of adding <code>static</code> here. <code>allocbuf</code> presence is an implementation detail that is hidden for the <code>alloc</code> user."}, {"owner": {"reputation": 39, "user_id": 5015365, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5186064774408ce12fd6202b0dfaff77?s=128&d=identicon&r=PG&f=1", "display_name": "user 004325", "link": "https://stackoverflow.com/users/5015365/user-004325"}, "edited": false, "score": 0, "creation_date": 1443113892, "post_id": 32748885, "comment_id": 53373066, "body": "Does alloc do dynamic memory allocation?"}], "tags": [], "owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "is_accepted": true, "score": 1, "last_activity_date": 1443040534, "last_edit_date": 1443040534, "creation_date": 1443040129, "answer_id": 32748885, "question_id": 32748784, "link": "https://stackoverflow.com/questions/32748784/static-array-allocation/32748885#32748885", "title": "Static array allocation", "body": "<blockquote>\n  <p>My question is that what does it mean that the array and pointer are declared static?</p>\n</blockquote>\n\n<p>It means the lifetime of the arrays is the entire execution of the program. Any object defined at file-scope (with or without the <code>static</code> specifier) has static storage duration (exception: objects defined with C11 <code>_Thread_local</code> specifier). Adding the <code>static</code> specifier limits the visibility of the objects to the source file they are defined.</p>\n\n<p>The total size of your <code>alloc</code> allocations is limited by the size of your <code>allocbuf</code> array.</p>\n"}], "owner": {"reputation": 39, "user_id": 5015365, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5186064774408ce12fd6202b0dfaff77?s=128&d=identicon&r=PG&f=1", "display_name": "user 004325", "link": "https://stackoverflow.com/users/5015365/user-004325"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 890, "favorite_count": 0, "closed_date": 1443040125, "accepted_answer_id": 32748885, "answer_count": 1, "score": -2, "last_activity_date": 1443040534, "creation_date": 1443039731, "question_id": 32748784, "link": "https://stackoverflow.com/questions/32748784/static-array-allocation", "closed_reason": "Duplicate", "title": "Static array allocation", "body": "<p>I have this implementation of alloc, which allocates memory as a dynamic array.</p>\n\n<p>My question is that what does it mean that the array and pointer are declared static? How does it affect to a function that calls alloc?</p>\n\n<pre><code>#define ALLOCSIZE 10000 /* size of available space */\n\nstatic char allocbuf[ALLOCSIZE];   /* storage for alloc */\nstatic char *allocp = allocbuf;    /* next free position */\n\nchar *alloc(int n)   /* return pointer to n characters */\n{\n\n    if (allocbuf + ALLOCSIZE - allocp &gt;= n) {  /* it fits */\n        allocp += n;\n        return allocp - n; /* old p */\n    }  else               /* not enough room */\n        return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "char", "argv"], "comments": [{"owner": {"reputation": 26583, "user_id": 1441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb7f1cd450084fdb4bfc9376c7dba2a7?s=128&d=identicon&r=PG", "display_name": "crashmstr", "link": "https://stackoverflow.com/users/1441/crashmstr"}, "edited": false, "score": 2, "creation_date": 1443038066, "post_id": 32748320, "comment_id": 53337379, "body": "If you want to index characters, why not <code>argv[1][0]</code>, <code>argv[1][1]</code>, etc.?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1443038142, "post_id": 32748320, "comment_id": 53337421, "body": "You have a missing <code>)</code> in the second snippet. Perhaps if you fix it, it will work as expected. Update: And the third. And fourth."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 1, "creation_date": 1443038490, "post_id": 32748320, "comment_id": 53337603, "body": "show us real code with its surprising output,"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1443039234, "post_id": 32748320, "comment_id": 53337996, "body": "The output you claim to get would be from <code>*argv[1]+1, not </code>*(argv[1]+1)`."}], "answers": [{"comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1443039338, "post_id": 32748378, "comment_id": 53338042, "body": "I&#39;ll defer to your 6 years of experience here, but I didn&#39;t think that pointing out that the question was mistaken is usually an answer."}, {"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1443039465, "post_id": 32748378, "comment_id": 53338122, "body": "@Barmar it&#39;s not, but you can&#39;t do code formatting in a comment. I don&#39;t care if it gets deleted as long as OP reads it first :-P"}], "tags": [], "owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "is_accepted": false, "score": 3, "last_activity_date": 1443038141, "creation_date": 1443038141, "answer_id": 32748378, "question_id": 32748320, "link": "https://stackoverflow.com/questions/32748320/c-argv2-vs-charargv2/32748378#32748378", "title": "C argv[2]++ vs (char*)argv[2]++?", "body": "<p>The premise of your question is mistaken. This program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main (int argc, char *argv[]) {\n  printf(\"%c\\n\", *(argv[1] + 1));\n  return 0;\n}\n</code></pre>\n\n<p>run with the argument <code>test</code>, prints <code>e</code>, not <code>u</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 0, "last_activity_date": 1443040796, "last_edit_date": 1443040796, "creation_date": 1443040111, "answer_id": 32748876, "question_id": 32748320, "link": "https://stackoverflow.com/questions/32748320/c-argv2-vs-charargv2/32748876#32748876", "title": "C argv[2]++ vs (char*)argv[2]++?", "body": "<p>Make sure your parentheses and dereferences are really where you think they are.  If <code>argv[1]</code> contains <code>test</code>, then</p>\n\n<pre><code>* ( argv[1] + 1 ) == 'e'\n( * argv[1] + 1 ) == 'u'\n^ ^\n| |\n+-+- slight difference here\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5277786, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Wps-4aYVPqs/AAAAAAAAAAI/AAAAAAAAAdM/YzgcVa9Jhck/photo.jpg?sz=128", "display_name": "Mark Rowra", "link": "https://stackoverflow.com/users/5277786/mark-rowra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "answer_count": 2, "score": -6, "last_activity_date": 1443040796, "creation_date": 1443037847, "question_id": 32748320, "link": "https://stackoverflow.com/questions/32748320/c-argv2-vs-charargv2", "title": "C argv[2]++ vs (char*)argv[2]++?", "body": "<p>Why are argvs act odd?\nExample:</p>\n\n<p>This will work as expected, print the 1st character of the 1st argument.</p>\n\n<pre><code>printf(\"%c\", *argv[1]);\n</code></pre>\n\n<p>This however will print the character that's in the ascii table <em>(aka \"one bigger\" represented as a number)</em> instead of printing the 2nd character of the 1st argument:</p>\n\n<pre><code>printf(\"%c\", *(argv[1] + 1);\n</code></pre>\n\n<p>Slight modifications will do nothing, exact same result:</p>\n\n<pre><code>printf(\"%c\", *(argv[1] + sizeof(char));\n</code></pre>\n\n<p>The only thing that helps is actually casting argv[2] to char*:</p>\n\n<pre><code>printf(\"%c\", *( (char*)(argv[1] +1 ) );\n</code></pre>\n\n<p>Why is this happening? I kno that:</p>\n\n<pre><code>argv's type :=  char** argv\nand argv[1] == *(argv + 1)\nand argv[1]'s type should be char*\n</code></pre>\n\n<p>but apparently it is not, as I need to cast it? How is this possible? It is declared as char**, yet its members aren't char*s?</p>\n"}, {"tags": ["c", "assembly", "decompiler"], "comments": [{"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 2, "creation_date": 1443037752, "post_id": 32748243, "comment_id": 53337174, "body": "CC is <code>int3</code> (debug break)"}, {"owner": {"reputation": 603, "user_id": 792826, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/yhsnk.jpg?s=128&g=1", "display_name": "TomJeffries", "link": "https://stackoverflow.com/users/792826/tomjeffries"}, "reply_to_user": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1443037771, "post_id": 32748243, "comment_id": 53337191, "body": "By the way, I checked to make sure that CCh was not ret or any of it&#39;s variants.."}], "answers": [{"tags": [], "owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "is_accepted": false, "score": 3, "last_activity_date": 1443037835, "creation_date": 1443037835, "answer_id": 32748316, "question_id": 32748243, "link": "https://stackoverflow.com/questions/32748243/decompiled-assembly-code/32748316#32748316", "title": "Decompiled assembly code", "body": "<p>It is 'for' nothing. The compiler assumes that the called function will never return.</p>\n\n<p>Also, your disassembler is aware of this. The code <code>0CCh</code> decodes as <code>int 3</code>, which will usually halt your program and display an error. Since the code before it will never return (or so it is assumed), the opcode is not part of the listing and so it is written as <code>db 0CCh</code> rather than \"the instruction <code>int 3</code>\".</p>\n\n<p>The code itself has nothing to do with the routine above it. The compiler inserted this byte to ensure that (1) <em>if</em> a program runs out of bounds, it'll come across this command and then halt, and (2) to align the first byte of the next function to (most likely) a multiple of 4, so there is a small - but real - gain in execution speed.</p>\n"}, {"tags": [], "owner": {"reputation": 603, "user_id": 792826, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/yhsnk.jpg?s=128&g=1", "display_name": "TomJeffries", "link": "https://stackoverflow.com/users/792826/tomjeffries"}, "is_accepted": false, "score": 0, "last_activity_date": 1443037844, "creation_date": 1443037844, "answer_id": 32748319, "question_id": 32748243, "link": "https://stackoverflow.com/questions/32748243/decompiled-assembly-code/32748319#32748319", "title": "Decompiled assembly code", "body": "<p>Harold just answered- CC is int3 (debug break).</p>\n"}, {"tags": [], "owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "is_accepted": false, "score": 4, "last_activity_date": 1443038238, "last_edit_date": 1443038238, "creation_date": 1443037864, "answer_id": 32748322, "question_id": 32748243, "link": "https://stackoverflow.com/questions/32748243/decompiled-assembly-code/32748322#32748322", "title": "Decompiled assembly code", "body": "<p><code>db</code> is commonly used by assemblers to specify arbitrary bytes added in the middle of \"regular\" assembly, and disassemblers insert it as a \"tool of last resort\" when they start seeing sequences that make no sense at all; here I don't know why your disassembler inserted the <code>cc</code> byte in a <code>db</code>, as <code>cc</code> is the usual <code>int 3</code> opcode (which is commonly used to break into the debugger).</p>\n\n<p>Compilers often emit them around \"regular\" functions for padding/alignment/debugging purposes; <code>int 3</code> has the advantage of being easy to spot when looking at both disassembly and hex memory view, and breaking into the debugger if it's accidentally executed. The fact that you find it after a <code>call</code> means that that <code>call</code> is meant never to be returned from (think <code>exit(1)</code> or <code>abort()</code> or something like that); alternatively (but less probably), it may have been added purposely by the programmer (e.g. in form of the <code>__debugbreak</code> intrinsic in Visual C++).</p>\n"}], "owner": {"reputation": 603, "user_id": 792826, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/yhsnk.jpg?s=128&g=1", "display_name": "TomJeffries", "link": "https://stackoverflow.com/users/792826/tomjeffries"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 210, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1443038238, "creation_date": 1443037569, "question_id": 32748243, "link": "https://stackoverflow.com/questions/32748243/decompiled-assembly-code", "title": "Decompiled assembly code", "body": "<p>I'm trying to put together C code from some decompiled assembly code and have a question. I see the following:</p>\n\n<pre><code>SUB_L10195A01:\n    ...\n    call    SUB_L1019CB90\n    db  CCh;   '\u0152'\n\nSUB_L10026990:\n    push    FFFFFFFFh\n    push    L101EA0C5\n</code></pre>\n\n<p>What is the </p>\n\n<pre><code>db  CCh;   '\u0152'\n</code></pre>\n\n<p>for? Normally there is a </p>\n\n<p><code>retn</code></p>\n\n<p>before </p>\n\n<pre><code>SUB_L10026990:\n</code></pre>\n"}, {"tags": ["c", "gcc", "linker", "ld"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 2, "creation_date": 1443037944, "post_id": 32748229, "comment_id": 53337308, "body": "is this some exercise learning GNU ld? If not, just use <code>gcc</code> for linking, it will do all the &quot;dirty work&quot; for you."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1443042157, "post_id": 32748229, "comment_id": 53339490, "body": "Why do you need custom script? If the goal is to simply link two object into an executable, no linker script is required. Error with -lc means your libc.a  can not be found in the linker search path. Do you know where it is on your system?"}, {"owner": {"reputation": 13, "user_id": 5253040, "user_type": "registered", "profile_image": "https://graph.facebook.com/10202987172999194/picture?type=large", "display_name": "Arjun Jain", "link": "https://stackoverflow.com/users/5253040/arjun-jain"}, "edited": false, "score": 0, "creation_date": 1443059760, "post_id": 32748229, "comment_id": 53344777, "body": "I have edited the question. I purposely want to use a custom linker script for a larger problem statement. Also, i found the path of libc.a, tried adding it using -L / -l , but in vain, it still prompts the &quot;Undefined reference to printf()&quot; error."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1443062650, "post_id": 32748229, "comment_id": 53345439, "body": "Please remove the C++ tag. Also, you have found the wrong libc, use <code>gcc --print-file-name-libc.so</code> to to see the correct path. Also, when you fix the library path, you will be able to create an executable but it won&#39;t work. Use <code>gcc -v l1.o l2.o -o output</code> to see which parts you are missing."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5253040, "user_type": "registered", "profile_image": "https://graph.facebook.com/10202987172999194/picture?type=large", "display_name": "Arjun Jain", "link": "https://stackoverflow.com/users/5253040/arjun-jain"}, "edited": false, "score": 0, "creation_date": 1448818119, "post_id": 32766820, "comment_id": 55726832, "body": "Hello mike, got busy with other modules and back to this one now. It still prompts the same error. Any solution for the same? I did exactly what you proposed."}, {"owner": {"reputation": 13, "user_id": 5253040, "user_type": "registered", "profile_image": "https://graph.facebook.com/10202987172999194/picture?type=large", "display_name": "Arjun Jain", "link": "https://stackoverflow.com/users/5253040/arjun-jain"}, "edited": false, "score": 0, "creation_date": 1448821159, "post_id": 32766820, "comment_id": 55728014, "body": "it is the same. ld:cannot find lc"}, {"owner": {"reputation": 45838, "user_id": 1362568, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/EAFi0.jpg?s=128&g=1", "display_name": "Mike Kinghan", "link": "https://stackoverflow.com/users/1362568/mike-kinghan"}, "reply_to_user": {"reputation": 13, "user_id": 5253040, "user_type": "registered", "profile_image": "https://graph.facebook.com/10202987172999194/picture?type=large", "display_name": "Arjun Jain", "link": "https://stackoverflow.com/users/5253040/arjun-jain"}, "edited": false, "score": 0, "creation_date": 1448829291, "post_id": 32766820, "comment_id": 55731162, "body": "@ArjunJain That is the error message. What is the commandline that causes it?"}, {"owner": {"reputation": 13, "user_id": 5253040, "user_type": "registered", "profile_image": "https://graph.facebook.com/10202987172999194/picture?type=large", "display_name": "Arjun Jain", "link": "https://stackoverflow.com/users/5253040/arjun-jain"}, "edited": false, "score": 0, "creation_date": 1449129034, "post_id": 32766820, "comment_id": 55874409, "body": "I was having a typo in the command line. Your command line works just fine. Thank you. Also i wanted to know how to decipher a linker map file. What does each field mean? Any guidance would be helpful. Thanks much"}], "tags": [], "owner": {"reputation": 45838, "user_id": 1362568, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/EAFi0.jpg?s=128&g=1", "display_name": "Mike Kinghan", "link": "https://stackoverflow.com/users/1362568/mike-kinghan"}, "is_accepted": true, "score": 2, "last_activity_date": 1443113282, "creation_date": 1443113282, "answer_id": 32766820, "question_id": 32748229, "link": "https://stackoverflow.com/questions/32748229/ld-cannot-find-lc-error/32766820#32766820", "title": "ld: cannot find lc -ERROR", "body": "<p>Since you are invoking <code>ld</code> directly, no default libraries or default library search paths\nare supplied, as they would be if <code>ld</code> were invoked indirectly by the <code>gcc</code> tool-driver\nin the usual way.</p>\n\n<p>So as well as telling <code>ld</code> explicitly to link <code>libc</code> (<code>-lc</code>), you must explicitly\n<em>also</em> tell it where to find <code>libc</code>, using the <code>-L</code> option. (It seems that you\nthink <code>L&lt;path&gt;</code> is an <em>alternative</em> to <code>-l&lt;libname&gt;</code>. It's not.)</p>\n\n<p>Therefore find out where <code>libc.so</code> is located on your system. You can do this with:</p>\n\n<pre><code>realpath $(gcc --print-file-name libc.so)\n</code></pre>\n\n<p>(Note, not <code>--print-file-name-libc.so</code>. There is a typo in @n.m's comment)</p>\n\n<p>Suppose it is <code>/usr/lib/x86_64-linux-gnu/libc.so</code>, as on my system. Then run:</p>\n\n<pre><code>ld -o output -T link.lds l1.o l2.o -L/usr/lib/x86_64-linux-gnu -lc\n</code></pre>\n\n<p>That will solve the problem in your question (but not necessarily any others).</p>\n"}], "owner": {"reputation": 13, "user_id": 5253040, "user_type": "registered", "profile_image": "https://graph.facebook.com/10202987172999194/picture?type=large", "display_name": "Arjun Jain", "link": "https://stackoverflow.com/users/5253040/arjun-jain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1823, "favorite_count": 1, "accepted_answer_id": 32766820, "answer_count": 1, "score": 0, "last_activity_date": 1443113282, "creation_date": 1443037541, "last_edit_date": 1443069088, "question_id": 32748229, "link": "https://stackoverflow.com/questions/32748229/ld-cannot-find-lc-error", "title": "ld: cannot find lc -ERROR", "body": "<p>My purpose is to link two codes using my own linker script and for the same, i have created a simple linker script (All help from around the internet)\nThis is my linker script, \"link.lds\"</p>\n\n<pre><code>SECTIONS\n{\n   . = 0x10000;\n   .text : { *(.text) }\n   . = 0x8000000;\n   .data : { *(.data) }\n   .bss : { *(.bss) }\n}\n</code></pre>\n\n<p>and my two simple C codes are as follows.\n1) l1.c</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nextern int a;\nint main()\n{\nprintf(\"%d\",a);\nreturn 0;\n}\n</code></pre>\n\n<p>AND\n2) l2.c</p>\n\n<pre><code>int a=111;\n</code></pre>\n\n<p>The commands that i use are:</p>\n\n<pre><code>gcc -c l1.c l2.c\nld -o output -T link.lds l1.o l2.o -lc\n</code></pre>\n\n<p>After following the above steps, I encounter the following error:</p>\n\n<pre><code>ld:cannot find lc\n</code></pre>\n\n<p>on removing lc,</p>\n\n<pre><code>undefined reference to printf().\n</code></pre>\n\n<p>I also tried using -L/dirname which took me back to the undef reference to printf error.</p>\n\n<p>MAY I GET SOME HELP AND GUIDANCE ON THE SAME...\nPS- Im aware i could have gone conceptually wrong and/or might not be aware about the correct sequence of linker execution/working.\nAny help on the same would be highly appreciated.\nMany Thanks!</p>\n"}, {"tags": ["c", "syntax"], "comments": [{"owner": {"reputation": 26583, "user_id": 1441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb7f1cd450084fdb4bfc9376c7dba2a7?s=128&d=identicon&r=PG", "display_name": "crashmstr", "link": "https://stackoverflow.com/users/1441/crashmstr"}, "edited": false, "score": 0, "creation_date": 1443037534, "post_id": 32748196, "comment_id": 53337061, "body": "Did you try stepping through the code in your debugger to see what happens?"}, {"owner": {"reputation": 70793, "user_id": 28128, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4e974a514f0764fdfe99a8915f192002?s=128&d=identicon&r=PG", "display_name": "David Grayson", "link": "https://stackoverflow.com/users/28128/david-grayson"}, "edited": false, "score": 0, "creation_date": 1443037594, "post_id": 32748196, "comment_id": 53337092, "body": "some_function is void so you cannot use the return value.  Are you sure you copied the code correctly?  I expect a semicolon on the first line of the second code block."}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 2, "creation_date": 1443037666, "post_id": 32748196, "comment_id": 53337123, "body": "Are you sure it\u2019s not <code>some_function(\u2026); { \u2026 }</code>? In other words, a call to a function, followed by a block of code."}, {"owner": {"reputation": 573, "user_id": 4389807, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d07541cb20d34d05bbed11a0fbc27a98?s=128&d=identicon&r=PG", "display_name": "confused", "link": "https://stackoverflow.com/users/4389807/confused"}, "edited": false, "score": 0, "creation_date": 1443037761, "post_id": 32748196, "comment_id": 53337180, "body": "Yes sorry my slip I was writing an example not copying directly, that&#39;s probably against the rules here :)  ; added in the correct place now."}, {"owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "edited": false, "score": 2, "creation_date": 1443037828, "post_id": 32748196, "comment_id": 53337225, "body": "<code>{{{{}}}}</code> is a valid statement in C."}, {"owner": {"reputation": 2029, "user_id": 3554832, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8AvjO.jpg?s=128&g=1", "display_name": "Iman", "link": "https://stackoverflow.com/users/3554832/iman"}, "edited": false, "score": 0, "creation_date": 1443037936, "post_id": 32748196, "comment_id": 53337303, "body": "Guys, please flag this question to help it being closed."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 2029, "user_id": 3554832, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8AvjO.jpg?s=128&g=1", "display_name": "Iman", "link": "https://stackoverflow.com/users/3554832/iman"}, "edited": false, "score": 0, "creation_date": 1443038137, "post_id": 32748196, "comment_id": 53337416, "body": "@Iman: Why do you want it to be closed?"}, {"owner": {"reputation": 2029, "user_id": 3554832, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8AvjO.jpg?s=128&g=1", "display_name": "Iman", "link": "https://stackoverflow.com/users/3554832/iman"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1443038369, "post_id": 32748196, "comment_id": 53337543, "body": "@KeithThompson the question seems very unclear, if you understood the intention of the question owner, I wish to ask you to edit the question."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 2029, "user_id": 3554832, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8AvjO.jpg?s=128&g=1", "display_name": "Iman", "link": "https://stackoverflow.com/users/3554832/iman"}, "edited": false, "score": 0, "creation_date": 1443038484, "post_id": 32748196, "comment_id": 53337602, "body": "@Iman: The question seems clear enough to me. The function call followed by a compound statement looks confusingly similar to an <code>if</code> statement. The explanation is that the compound statement is not related to the function call, other than the fact that it happens to follow it."}, {"owner": {"reputation": 2029, "user_id": 3554832, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8AvjO.jpg?s=128&g=1", "display_name": "Iman", "link": "https://stackoverflow.com/users/3554832/iman"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1443038578, "post_id": 32748196, "comment_id": 53337648, "body": "@KeithThompson it is so much better now(edited couple of ten minutes ago)"}], "answers": [{"tags": [], "owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "is_accepted": true, "score": 7, "last_activity_date": 1443038410, "last_edit_date": 1443038410, "creation_date": 1443037864, "answer_id": 32748323, "question_id": 32748196, "link": "https://stackoverflow.com/questions/32748196/unfamiliar-c-shorthand/32748323#32748323", "title": "unfamiliar C shorthand { }", "body": "<p>A <em>compound statement</em> is a <code>{</code>, followed by zero or more declarations and statements, followed by a <code>}</code>. A compound statement is treated as a single statement.</p>\n\n<p>Typically a compound statement is used as the statement controlled by an <code>if</code>, <code>while</code>, <code>for</code>, etc.:</p>\n\n<pre><code>if (condition)\n{\n    blah;\n    blah;\n}\n</code></pre>\n\n<p>but it can be used anywhere you can use a single statement. (Compound statements are sometimes called <em>blocks</em>; strictly speaking a compound statement is one kind of block.)</p>\n\n<p>It can be useful as a way to define a local variable:</p>\n\n<pre><code> blah;\n {\n     int n = 42;\n     /* ... */\n }\n /* n is not visible here */\n</code></pre>\n\n<p>In your example:</p>\n\n<pre><code>some_function(2, 3, 4);\n{\n       x = 1200;\n       another_function(&amp;x);\n}\n</code></pre>\n\n<p>the extra <code>{</code> and <code>}</code> are legal, but useless; they could be omitted with no change to the meaning of the program. (The author might have intended to mark those statements as a <em>logical</em> grouping.)</p>\n\n<p>The compound statement is not logically related to the function call; it just happens to follow it.</p>\n\n<p>Using a compound statement here would make more sense if the code were something like:</p>\n\n<pre><code>some_function(2, 3, 4);\n{\n       int x = 1200;\n       another_function(&amp;x);\n}\n</code></pre>\n\n<p>since it would provide a local scope for the variable <code>x</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 21714, "user_id": 1392132, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/QF6FZ.jpg?s=128&g=1", "display_name": "5gon12eder", "link": "https://stackoverflow.com/users/1392132/5gon12eder"}, "is_accepted": false, "score": 0, "last_activity_date": 1443038221, "creation_date": 1443038221, "answer_id": 32748405, "question_id": 32748196, "link": "https://stackoverflow.com/questions/32748196/unfamiliar-c-shorthand/32748405#32748405", "title": "unfamiliar C shorthand { }", "body": "<p>It is valid syntax but serves no good purpose in this case.  Removing the extra braces would not change the meaning of the code.</p>\n\n<p>Putting additional braces is sometimes useful, however, if you want to restrict the scope of a local variable.  For example, if I want to exchange the values of <code>a</code> and <code>b</code>, I might write</p>\n\n<pre><code>int a;\nint b;\n\n// Lots of code that assigns values to `a` and `b`.\n\n{\n  int temp;\n  temp = a;\n  a = b;\n  b = temp;\n}\n</code></pre>\n\n<p>so not to litter the namespace with the <code>temp</code> variable.  This is even more useful in C++ where destructors for variables with automatic storage duration will be run automatically at scope exit.</p>\n"}], "owner": {"reputation": 573, "user_id": 4389807, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d07541cb20d34d05bbed11a0fbc27a98?s=128&d=identicon&r=PG", "display_name": "confused", "link": "https://stackoverflow.com/users/4389807/confused"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 32748323, "answer_count": 2, "score": 1, "last_activity_date": 1443038893, "creation_date": 1443037402, "last_edit_date": 1443037735, "question_id": 32748196, "link": "https://stackoverflow.com/questions/32748196/unfamiliar-c-shorthand", "title": "unfamiliar C shorthand { }", "body": "<p>I inherited some code and it has a format like this when it is called.  To be clear some function is defined somewhere like this:</p>\n\n<pre><code>void some_function(int a, int b, int c){\n     printf(\"hi there\\n\");\n}\n</code></pre>\n\n<p>then it is called like this in the main code:</p>\n\n<pre><code>some_function(2, 3, 4);\n{\n       x = 1200;\n       another_function(&amp;x);\n}\n</code></pre>\n\n<p>So is the above just short hand for:</p>\n\n<pre><code>if(some_function(2,3,4) == 1)\n{\n    //then execute code found here?\n}\n</code></pre>\n\n<p>I've never seen that one before, and I feel that since some_function is void and  never returns a value that it will never run the code in the brackets?</p>\n"}, {"tags": ["c", "memory", "random", "character", "scanf"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1443036735, "post_id": 32747949, "comment_id": 53336635, "body": "Your code happily overflows both of your arrays"}, {"owner": {"reputation": 417, "user_id": 3133300, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/3e5de383d6aa1b63a8c3eeaeef9bd4eb?s=128&d=identicon&r=PG&f=1", "display_name": "user3133300", "link": "https://stackoverflow.com/users/3133300/user3133300"}, "edited": false, "score": 0, "creation_date": 1443036856, "post_id": 32747949, "comment_id": 53336700, "body": "yes i know. But each line of the file will have a max length of 80, and the file will have a max length of 100 lines."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1443036901, "post_id": 32747949, "comment_id": 53336731, "body": "First things first. Is the <code>array</code> supposed to have lines from the file, or words from the file?"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1443036937, "post_id": 32747949, "comment_id": 53336747, "body": "If the lines have a maximum length of 80 characters, your buffer needs to fit 81 characters."}, {"owner": {"reputation": 417, "user_id": 3133300, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/3e5de383d6aa1b63a8c3eeaeef9bd4eb?s=128&d=identicon&r=PG&f=1", "display_name": "user3133300", "link": "https://stackoverflow.com/users/3133300/user3133300"}, "edited": false, "score": 0, "creation_date": 1443036997, "post_id": 32747949, "comment_id": 53336777, "body": "array is supposed to have lines from a text file."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 2, "creation_date": 1443037021, "post_id": 32747949, "comment_id": 53336792, "body": "Second, <code>k &lt; sizeof(array)</code> is the same as <code>k &lt; 400</code>, which is not what you want."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1443037478, "post_id": 32747949, "comment_id": 53337034, "body": "@user3133300 &quot;each line of the file will have a max length of 80 [...]&quot; <b>never</b> trust your input. buffer overflows are security holes."}], "answers": [{"tags": [], "owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "is_accepted": true, "score": 1, "last_activity_date": 1443039131, "last_edit_date": 1443039131, "creation_date": 1443037352, "answer_id": 32748182, "question_id": 32747949, "link": "https://stackoverflow.com/questions/32747949/random-characters-from-memory-when-reading-from-file-using-fscanf/32748182#32748182", "title": "Random characters from memory when reading from file using fscanf", "body": "<p>There are two problems in the code. </p>\n\n<p>The first is that you are using <code>fscanf</code> to read the file, instead of <code>fgets</code>. <code>fscanf</code> with a format of <code>\"%s\"</code> will read one word from the file. <code>fgets</code> reads a line.</p>\n\n<p>The second problem is the last <code>for</code> loop which uses <code>sizeof(array)</code>. On a 32-bit machine, <code>sizeof(array)</code> is 100*4 = 400. What you want is to count the number of lines that have been read from the file, and then use that count in the <code>for</code> loop.</p>\n\n<p>With that in mind, here's how I would write the code</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main( void )\n{\n    char *array[100];\n    char string[80];\n    FILE *fp;\n\n    if ( (fp = fopen( \"file.txt\" , \"r\")) == NULL )\n    {\n        printf( \"File not found\\n\" );\n        exit( 1 );\n    }\n\n    int count = 0;\n    while ( fgets( string, sizeof(string), fp ) != NULL )\n    {\n        string[strcspn(string,\"\\n\")] = '\\0';\n        if ( count &lt; 100 )\n        {\n            array[count] = strdup( string );\n            count++;\n        }\n    }\n\n    fclose( fp );\n\n    for ( int k = 0; k &lt; count; k++ )\n        printf( \"the element at %d is: %s\\n\", k, array[k] );\n}\n</code></pre>\n\n<p>The line</p>\n\n<pre><code>string[strcspn(string,\"\\n\")] = '\\0';\n</code></pre>\n\n<p>removes the newline, if any, from the string. This is necessary since <code>fgets</code> will retain the newline.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": false, "score": 0, "last_activity_date": 1443037373, "creation_date": 1443037373, "answer_id": 32748188, "question_id": 32747949, "link": "https://stackoverflow.com/questions/32747949/random-characters-from-memory-when-reading-from-file-using-fscanf/32748188#32748188", "title": "Random characters from memory when reading from file using fscanf", "body": "<p>There are several issues in this code ...</p>\n\n<pre><code>    char *array[100];\n    char string[80];\n</code></pre>\n\n<p>so far, so good, now let's look at this:</p>\n\n<pre><code>        int k = 0;\n        while (fscanf(file, \"%s\", string)!=EOF){\n            array[k] = strdup(string);\n            k++;\n        }                            \n</code></pre>\n\n<p>Issues here:</p>\n\n<ol>\n<li>you don't check <code>k</code>. This should stop if <code>k</code> reached <code>100</code></li>\n<li>checking for <code>EOF</code> is wrong. Other things could fail, too.</li>\n<li><code>%s</code> will only read up to the next whitespace, probably not what you want.</li>\n<li><code>%s</code> will read as long as there are non-whitespace characters, so it <em>will</em> overflow your <code>string</code>, given malicious input.</li>\n</ol>\n\n<p>A correct version would e.g. look like this:</p>\n\n<pre><code>        int k = 0;\n        while (k &lt; 100 &amp;&amp; fgets(string, 80, file)){\n            array[k] = strdup(string);\n            k++;\n        }                            \n</code></pre>\n\n<p>Then to the next problematic part:</p>\n\n<pre><code>    for(int k = 0; k&lt;sizeof(array); k++){\n        printf(\"the element at %d is: %s\\n\", k, array[k]);\n    }\n</code></pre>\n\n<p><code>sizeof()</code> gives you the <strong>size in bytes</strong> of its argument. The size of an array is <strong>fixed</strong>, it doesn't matter how many elements you actually stored. The elements are pointers, so taking more than 1 byte.</p>\n\n<p>Correct version:</p>\n\n<pre><code>    int lines = 0; // nothing read\n    if (file) {\n        int k = 0;\n        while (k &lt; 100 &amp;&amp; fgets(string, 80, file)){\n            array[k] = strdup(string);\n            k++;\n        }                            \n        fclose(file);\n        lines = k;\n    }\n\n    for(int k = 0; k&lt;lines; k++){\n        printf(\"the element at %d is: %s\\n\", k, array[k]);\n    }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1443048127, "post_id": 32748236, "comment_id": 53341895, "body": "Suspect when OP commented <a href=\"http://stackoverflow.com/questions/32747949/random-characters-from-memory-when-reading-from-file-using-fscanf#comment53336700_32747949\">But each line of the file will have a max length of 80</a>, that does not include the ending <code>&#39;\\n&#39;</code>.  Recommend <code>char line[80 + 1 + 1];</code>"}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 1, "last_activity_date": 1443037553, "creation_date": 1443037553, "answer_id": 32748236, "question_id": 32747949, "link": "https://stackoverflow.com/questions/32747949/random-characters-from-memory-when-reading-from-file-using-fscanf/32748236#32748236", "title": "Random characters from memory when reading from file using fscanf", "body": "<ol>\n<li><p>If you want to read lines of text, use:</p>\n\n<pre><code>fgets(line, sizeof(line), file);\n</code></pre></li>\n<li><p>If a line can contain <code>80</code> characters, you need to define <code>line</code> to be an array of at least <code>81</code> characters -- to allow an extra space for the terminating null character.</p>\n\n<pre><code>char line[81];\n</code></pre></li>\n<li><p>You need to store the number of lines read so that when writing the lines out, you don't try to write any more than you read. Make sure you don't read any more than the number of lines <code>array</code> is capable of holding.</p>\n\n<pre><code>int numLinesRead = 0;\nif (file) {\n    int k = 0;\n    while (fscanf(file, \"%s\", string)!=EOF &amp;&amp; k &lt; 100 ){\n        array[k] = strdup(string);\n        k++;     \n    }                            \n    fclose(file);\n    numLinesRead = k;\n}\n</code></pre></li>\n<li><p>Don't write any more than the number of lines read.</p>\n\n<pre><code>for(int k = 0; k&lt;numberOfLinesRead; k++){\n    printf(\"the element at %d is: %s\\n\", k, array[k]);\n} \n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 417, "user_id": 3133300, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/3e5de383d6aa1b63a8c3eeaeef9bd4eb?s=128&d=identicon&r=PG&f=1", "display_name": "user3133300", "link": "https://stackoverflow.com/users/3133300/user3133300"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1209, "favorite_count": 0, "accepted_answer_id": 32748182, "answer_count": 3, "score": 0, "last_activity_date": 1443039131, "creation_date": 1443036536, "last_edit_date": 1443037354, "question_id": 32747949, "link": "https://stackoverflow.com/questions/32747949/random-characters-from-memory-when-reading-from-file-using-fscanf", "title": "Random characters from memory when reading from file using fscanf", "body": "<pre><code>        //create the array from file\n        char *array[100];\n        char string[80];\n        FILE * file;\n        file = fopen( \"file.txt\" , \"r\");\n        if (file) {\n            int k = 0;\n            while (fscanf(file, \"%s\", string)!=EOF){\n                array[k] = strdup(string);\n                k++;\n            }                            \n            fclose(file);\n        }\n\n        //print the history array for debugging\n        for(int k = 0; k&lt;sizeof(array); k++){\n            printf(\"the element at %d is: %s\\n\", k, array[k]);\n        } \n</code></pre>\n\n<p>The resulting array has random characters from memory which are not present in the file. Is there any way to prevent this?</p>\n"}, {"tags": ["php", "c"], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 3078288, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002678444418/picture?type=large", "display_name": "Paulo S&#233;rgio Galdino Sacrament", "link": "https://stackoverflow.com/users/3078288/paulo-s%c3%a9rgio-galdino-sacrament"}, "is_accepted": true, "score": 0, "last_activity_date": 1443360193, "creation_date": 1443360193, "answer_id": 32808355, "question_id": 32747945, "link": "https://stackoverflow.com/questions/32747945/c-execl-execute-php-script-dont-show-result-in-stdout/32808355#32808355", "title": "C execl execute PHP script dont show result in STDOUT", "body": "<p>I discovered the reason you're giving error . It was the relative path to the PHP libs . Or I could change the path programmatically through the c or through PHP and everything would be fixed! Then a friend who works with me add fullpath tested on PHP and the script ran normally.</p>\n"}], "owner": {"reputation": 21, "user_id": 3078288, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002678444418/picture?type=large", "display_name": "Paulo S&#233;rgio Galdino Sacrament", "link": "https://stackoverflow.com/users/3078288/paulo-s%c3%a9rgio-galdino-sacrament"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 1, "accepted_answer_id": 32808355, "answer_count": 1, "score": 2, "last_activity_date": 1443360193, "creation_date": 1443036514, "last_edit_date": 1443037886, "question_id": 32747945, "link": "https://stackoverflow.com/questions/32747945/c-execl-execute-php-script-dont-show-result-in-stdout", "title": "C execl execute PHP script dont show result in STDOUT", "body": "<p>I'm having trouble with a daemon done in C , which reads the stdout php content and saves the contents to a file. The problem happens only for a PHP script file, while another does not.<br>\nIf I invoke the script manually, you write the contents on stdout normally.</p>\n\n<p>After giving fork , I am running the following code snippet:  </p>\n\n<pre><code>void startScriptCollector(char *php , char *collectorName , char *collectorRaw , char *collectorLog){\n    char str_script[80];\n    char str_raw[80];\n    char str_log[80];\n    int result = 0;\n    int fd_output , fd_error; //File Descriptor\n\n    setreuid(geteuid(), geteuid());\n\n    //stat_rtrim(collectorLog);\n    //removeChar(collectorLog,'\\n');\n    if(collectorLog != NULL) trim(collectorLog);\n\n    tmLogPrintf(Log, TMLOG_LEVEL_ERROR , \"On startScriptCollector collectorName : %s , collectorRaw : %s , collectorLog : %s...\\n\",\n            collectorName, collectorRaw , collectorLog);\n            //exit(-1);\n\n    sprintf(str_script  , \"%s/%s\" , SLAVIEW_CUSTOM_SCRIPTS , collectorName);\n    sprintf(str_raw     , \"%s/%s\" , SLAVIEW_CUSTOM_TMPCOL   , collectorRaw);\n    sprintf(str_log     , \"%s/%s\" , VARDIR                  , collectorLog);\n\n    fd_output = open(str_raw, O_CREAT | O_WRONLY , 0777);\n    fd_error  = open(str_log, O_CREAT | O_WRONLY , 0777);\n\n    if(fd_output &lt; 0){\n            tmLogPrintf(Log, TMLOG_LEVEL_ERROR , \"Script %s not could save data in %s...\\n\",\n            collectorName , str_raw);\n            exit(-1);\n    }\n\n    if(fd_error &lt; 0){\n            tmLogPrintf(Log, TMLOG_LEVEL_ERROR , \"Script %s not could save error log ...\\n\",\n            collectorName);\n            //exit(-1);\n    }\n\n    dup2(fd_output , 1); //write on data  file\n    dup2(fd_error  , 2); //write on error file\n\n    result = execl(PHPEXEC , \"php\" , str_script  , NULL);\n\n\n    if(result == -1){\n            tmLogPrintf(Log, TMLOG_LEVEL_ERROR , \"Error, on execute script  %s ...\", collectorName);\n            exit(-1);\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "2d", "overwrite"], "comments": [{"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 1, "creation_date": 1443036915, "post_id": 32747883, "comment_id": 53336739, "body": "<code>strtok()</code> doesn&#39;t make copies of the tokens for you, it just gives you a pointer to them in the original string (in which it also replaces the separators).  If you&#39;re reusing the same buffer for each row, your pointers from all rows will point into that same buffer, and show whatever is there now."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1443036978, "post_id": 32747883, "comment_id": 53336769, "body": "Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. As given, there is not even the definition of the array."}, {"owner": {"reputation": 13, "user_id": 4643164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be94f2ff1be3ae29182a5726e54348e7?s=128&d=identicon&r=PG&f=1", "display_name": "Luca", "link": "https://stackoverflow.com/users/4643164/luca"}, "edited": false, "score": 0, "creation_date": 1443037391, "post_id": 32747883, "comment_id": 53336995, "body": "So would it be possible to use strcpy and save strtok() to a different variable then set my 2d array equal to that variable?"}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1443038759, "post_id": 32747883, "comment_id": 53337745, "body": "You just need to allocate storage for a string and copy the token to it, assigning the pointer to the allocated storage instead of assigning the pointer returned by <code>strtok()</code> directly.  You could use <code>malloc()</code> + <code>strcpy()</code>, or if you have it <code>strdup()</code>."}], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 4643164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be94f2ff1be3ae29182a5726e54348e7?s=128&d=identicon&r=PG&f=1", "display_name": "Luca", "link": "https://stackoverflow.com/users/4643164/luca"}, "is_accepted": true, "score": 0, "last_activity_date": 1473537736, "last_edit_date": 1473537736, "creation_date": 1443042056, "answer_id": 32749391, "question_id": 32747883, "link": "https://stackoverflow.com/questions/32747883/2d-array-each-row-being-overwritten-by-next/32749391#32749391", "title": "2d Array - Each Row being Overwritten by Next", "body": "<p>The problem was with my incorrect usage of strtok(). I took Dmitri's advice and used strdup() which allocates memory for the new string and I'm getting the proper results.</p>\n\n<pre><code>nextWord = strtok(NULL, \"\\t\");\ntemp = strdup(nextWord);\ntransition[transCount][0] = temp;\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 4643164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be94f2ff1be3ae29182a5726e54348e7?s=128&d=identicon&r=PG&f=1", "display_name": "Luca", "link": "https://stackoverflow.com/users/4643164/luca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 32749391, "answer_count": 1, "score": 0, "last_activity_date": 1473537736, "creation_date": 1443036298, "last_edit_date": 1473537250, "question_id": 32747883, "link": "https://stackoverflow.com/questions/32747883/2d-array-each-row-being-overwritten-by-next", "title": "2d Array - Each Row being Overwritten by Next", "body": "<p>I'm reading in from a file. Whenever I read in the word 'transition' I'm trying to add the next 5 elements that appear to a 2d array. I have a bunch of printf's which I have commented out that show that I am adding the proper element. However, once I finish reading in from file, I loop through to check my 2d array values and they have all been overwritten by the last row's values.</p>\n\n<p>Here is my code</p>\n\n<pre><code>State* allStates[1002];\nState* currentState;\nchar* input = argv[1];\nchar* inputStr = argv[2];\nint maxTrans = atoi(argv[3]);\nint transCount = -1;\nFILE* inputFile;\nchar* transition[maxTrans][5];  \n\ninputFile = fopen(input, \"r\");\nif (inputFile == 0)\n{\n    perror(\"Can't open file\\n\");\n    exit(-1);   \n}\nelse\n{\n    char next[1000];\n    //int counter = 0;\n    while (fgets(next, 1000, inputFile) != NULL)\n    {\n        char *nextWord;\n        nextWord = strtok_r(next, \"\\t\");\n\n        if (strcmp(nextWord, \"state\") == 0)\n        {\n\n            //counter++;\n            nextWord = strtok_r(NULL, \"\\t\");\n            //puts(nextWord);\n            int q = atoi(nextWord);\n            nextWord = strtok_r(NULL, \"\\n\");\n            //puts(nextWord);\n            if (strcmp(nextWord, \"accept\") == 0)\n            {\n                State* newState = makeState(q, 1, 0, 0);    \n                allStates[q] = newState;\n            }\n            else if (strcmp(nextWord, \"reject\") == 0)\n            {\n                State* newState = makeState(q, 0, 1, 0);    \n                allStates[q] = newState;\n            }\n            else if (strcmp(nextWord, \"start\") == 0)\n            {\n                State* newState = makeState(q, 0, 0, 1);    \n                allStates[q] = newState;\n                currentState = newState;\n            } \n            else    \n            {\n                State* newState = makeState(q, 0, 0, 0);    \n                allStates[q] = newState;\n            }           \n        }\n        if (strcmp(nextWord, \"transition\") == 0)\n        {\n            //printf(\"\\n\");\n            //setup 2d array of transitions\n            transCount++;\n            nextWord = strtok_r(NULL, \"\\t\");\n            //puts(nextWord);\n            transition[transCount][0] = nextWord;\n            //printf(\"%c\", *transition[transCount][0]);\n            nextWord = strtok_r(NULL, \"\\t\");\n            //puts(nextWord);\n            transition[transCount][1] = nextWord;\n            //printf(\"%c\", *transition[transCount][1]);\n            nextWord = strtok_r(NULL, \"\\t\");\n            //puts(nextWord);\n            transition[transCount][2] = nextWord;\n            //printf(\"%c\", *transition[transCount][2]);\n            nextWord = strtok_r(NULL, \"\\t\");\n            //puts(nextWord);\n            transition[transCount][3] = nextWord;\n            //printf(\"%c\", *transition[transCount][3]);\n            nextWord = strtok_r(NULL, \"\\n\");\n            //puts(nextWord);\n            transition[transCount][4] = nextWord;   \n            //printf(\"%c\", *transition[transCount][4]); \n\n        }\n    }\n\n}   \nfclose(inputFile);\n\nint u = 0;\nint y = 0;\nchar m = 'm';\nfor (u; u &lt; 12; u++)\n{\n    printf(\"\\n\");\n    for (y = 0; y &lt; 5; y++)\n    {\n        //transition[u][y] = &amp;m;\n\n        printf(\"%c\", *transition[u][y]);\n\n\n    }\n}\n</code></pre>\n\n<p>If the file I'm reading in looks like this,</p>\n\n<p>transition  0   x   0   x   R</p>\n\n<p>transition  0   1   4   1   L</p>\n\n<p>transition  0   0   1   x   R</p>\n\n<p>I expect the array to look like this</p>\n\n<p>0x0xR</p>\n\n<p>0141L</p>\n\n<p>001xR</p>\n\n<p>Instead the values of the array will be</p>\n\n<p>001xR</p>\n\n<p>001xR</p>\n\n<p>001xR</p>\n\n<p>I know that the overwriting happens at each row. ie: when I'm writing to row 2 the values become:</p>\n\n<p>0141L</p>\n\n<p>0141L </p>\n\n<p>I'm really lost as to how to fix it though.</p>\n"}, {"tags": ["c", "macros", "c-preprocessor", "variadic", "variadic-macros"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1443055018, "post_id": 32747785, "comment_id": 53343756, "body": "Not directly related to your question, but this macro will process arguments twice. for example, <code>log(&quot;foo %d&quot;, func());</code> will call func twice.  To fix this you could make a function e.g. <code>my_log_pack(char const *, ...);</code> which processes its parameter list twice."}, {"owner": {"reputation": 5700, "user_id": 4934640, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2f69527ae459cbbda0ab5c2e08686a50?s=128&d=identicon&r=PG&f=1", "display_name": "user", "link": "https://stackoverflow.com/users/4934640/user"}, "edited": false, "score": 0, "creation_date": 1576368896, "post_id": 32747785, "comment_id": 104878094, "body": "I did not fully understand your problem. Your example is too minimal. How this <b><code>pack_args</code></b> macro is defined? How is defined <b><code>my_log</code></b> function? May be you can take a lock on: <a href=\"https://stackoverflow.com/questions/59331919/how-to-easily-create-fully-variadic-functions-with-c-98-standard/\">How to easily create fully \u201cvariadic\u201d functions with C++ 98 standard?</a>."}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1443037260, "post_id": 32748092, "comment_id": 53336926, "body": "gcc actually <b>can</b> remove a leading comma for <code>__VA_ARGS__</code>. IIRC just prefix with <code>##</code> (better verify in the documentation), as an extension."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1443039042, "post_id": 32748092, "comment_id": 53337888, "body": "@Olaf, you are correct that <i>as extensions</i>, GCC permits a variadic macro to be invoked with zero variable arguments, and handles a <code>##</code> operator appearing between a comma and <code>__VA_ARGS__</code> by suppressing the comma.  Perhaps that will serve the OP, but I am rarely inclined to recommend incorporating dependencies on behavior specific to a particular compiler."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1443040101, "post_id": 32748092, "comment_id": 53338444, "body": "Well, I am a bit split here. In general, I do not like relying on compiler features. OTOH, I see gcc as being OSS and (one of) the most used compilers some kind of exception (I might include clang/llvm if I knew them better). This because you do not depend on a specific vendor, but can port it yourself - if required. It is also verrrrry unlikely to suddenly disappear. Anyway, I think we should leave the decission to OP, just providing the information. Isn&#39;t that what freedom is about?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1443040691, "post_id": 32748092, "comment_id": 53338756, "body": "@Olaf, I love <code>gcc</code> and get a lot of use out of it, but my concern is not usually whether one can find a suitable compiler with which to build my code.  I&#39;m more often concerned with whether one can build it with whatever compiler one wants (or needs) to use."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1443040777, "post_id": 32748092, "comment_id": 53338806, "body": "@Olaf, nevertheless, I updated the answer to qualify the &quot;you cannot do this at all&quot; assertion."}, {"owner": {"reputation": 707, "user_id": 2794730, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/06e868d463cf663e8bfad6852831a1be?s=128&d=identicon&r=PG", "display_name": "Anton Kochkov", "link": "https://stackoverflow.com/users/2794730/anton-kochkov"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1443043595, "post_id": 32748092, "comment_id": 53340187, "body": "@Olaf I know about <code>##__VA_ARGS__</code> extension, but it would would only in case of <code>#define log(fmt, ...) my_log(fmt, ##__VA_ARGS__)</code>. But question is more how to deal with that <code>pack_args(__VA_ARGS__)</code> macro in case of the missing arguments and comma before."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 707, "user_id": 2794730, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/06e868d463cf663e8bfad6852831a1be?s=128&d=identicon&r=PG", "display_name": "Anton Kochkov", "link": "https://stackoverflow.com/users/2794730/anton-kochkov"}, "edited": false, "score": 0, "creation_date": 1443051205, "post_id": 32748092, "comment_id": 53342822, "body": "@AntonKochkov: As you do not show the macro and what you actually intend, there is no way to answer other than John did. Without further information, it is not possible to provide a possible alternative (if any) to your approach."}, {"owner": {"reputation": 707, "user_id": 2794730, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/06e868d463cf663e8bfad6852831a1be?s=128&d=identicon&r=PG", "display_name": "Anton Kochkov", "link": "https://stackoverflow.com/users/2794730/anton-kochkov"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1443051737, "post_id": 32748092, "comment_id": 53342959, "body": "@Olaf well, this one is quite complex, but basically it looks like <code>#define pack_args(...) APPLY_ALL(another_macro, __VA_ARGS__)</code> from this article <a href=\"http://ptspts.blogspot.ru/2013/11/how-to-apply-macro-to-all-arguments-of.html\" rel=\"nofollow noreferrer\">ptspts.blogspot.ru/2013/11/&hellip;</a>"}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 0, "creation_date": 1443051828, "post_id": 32748092, "comment_id": 53342974, "body": "&quot;Not all&quot; is just exagerated. You can do a lot with variable argument macros, and if you are willing to accept that your <code>log</code> macro will not have more that, say, 158 arguments, this can be done."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 0, "creation_date": 1443060361, "post_id": 32748092, "comment_id": 53344928, "body": "@JensGustedt, I&#39;d say &quot;strict&quot; rather than &quot;exaggerated&quot;.  I think my answer is correct for the question as posed, without additional provisions or constraints.  With that said, a constraint such as you propose is unlikely to present any problem in practice: +1."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 1, "last_activity_date": 1443040738, "last_edit_date": 1443040738, "creation_date": 1443037031, "answer_id": 32748092, "question_id": 32747785, "link": "https://stackoverflow.com/questions/32747785/how-to-expand-macro-and-delete-comma/32748092#32748092", "title": "How to expand macro and delete comma", "body": "<blockquote>\n  <p>How should I change this code to [handle] the only fmt_string presence scenario?</p>\n</blockquote>\n\n<p>You cannot do this at all with a variadic macro in standard C.  The standard explicitly specifies that in the invocation of a variadic macro \"there shall be more arguments in the invocation than there are parameters in the macro definition (excluding the ...)\" (C2011, 6.10.3/4).  You could allow the macro to be used with just one argument by changing it to ...</p>\n\n<pre><code>#define log(...) /* ... */\n</code></pre>\n\n<p>... but then you could not separate the format string from the other arguments -- at least not without re-introducing the same problem you have now.</p>\n\n<p>You'll need to use a bona fide function if you need to support a zero-length variable argument list.</p>\n"}, {"tags": [], "owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "is_accepted": true, "score": 4, "last_activity_date": 1443051696, "creation_date": 1443051696, "answer_id": 32751188, "question_id": 32747785, "link": "https://stackoverflow.com/questions/32747785/how-to-expand-macro-and-delete-comma/32751188#32751188", "title": "How to expand macro and delete comma", "body": "<p>In <a href=\"http://p99.gforge.inria.fr\" rel=\"nofollow\">P99</a> I have two macros</p>\n\n<pre><code>#define P00_ARG(                                               \\\n _1, _2, _3, _4, _5, _6, _7, _8,                               \\\n _9, _10, _11, _12, _13, _14, _15, _16,                        \\\n  ... etc ...                                                  \\\n _153, _154, _155, _156, _157, _158, _159,                     \\\n ...) _159\n#define P99_HAS_COMMA(...) P00_ARG(__VA_ARGS__,                \\\n 1, 1, 1, 1, 1, 1, 1,                                          \\\n 1, 1, 1, 1, 1, 1, 1, 1,                                       \\\n  ... etc ....                                                 \\\n 1, 1, 1, 1, 1, 1, 0, 0)\n</code></pre>\n\n<p>You can use this to determine if your argument has a comma (so there are more arguments than your format) or not (only a format). You can then use that to construct a call to one of two macros:</p>\n\n<pre><code>#define log(...) log2(P99_HAS_COMMA(__VA_ARGS__), __VA_ARGS__)\n#define log2(N, ...) log3(N, __VA_ARGS__)\n#define log3(N, ...) log ## N(__VA_ARGS__)\n\n#define log0(FMT)              /* your version with format only goes here */\n#define log1(FMT, __VA_ARGS__) /* your version with more goes here */\n</code></pre>\n"}], "owner": {"reputation": 707, "user_id": 2794730, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/06e868d463cf663e8bfad6852831a1be?s=128&d=identicon&r=PG", "display_name": "Anton Kochkov", "link": "https://stackoverflow.com/users/2794730/anton-kochkov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1790, "favorite_count": 2, "accepted_answer_id": 32751188, "answer_count": 2, "score": 4, "last_activity_date": 1443051696, "creation_date": 1443035990, "last_edit_date": 1443043388, "question_id": 32747785, "link": "https://stackoverflow.com/questions/32747785/how-to-expand-macro-and-delete-comma", "title": "How to expand macro and delete comma", "body": "<p>For example I want to write my own printf() alternative, but I have to perform calculations on the variable arguments:</p>\n\n<pre><code>#define log(fmt_string, ...) my_log(fmt_string, pack_args(__VA_ARGS__), __VA_ARGS__)\n</code></pre>\n\n<p>where pack_args(...) - is a macro too.\nHow should I change this code to handle the only fmt_string presence scenario?</p>\n\n<pre><code>log(\"Some message here\");\n</code></pre>\n"}, {"tags": ["php", "c"], "comments": [{"owner": {"reputation": 203268, "user_id": 206403, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/vfBUe.jpg?s=128&g=1", "display_name": "Rocket Hazmat", "link": "https://stackoverflow.com/users/206403/rocket-hazmat"}, "edited": false, "score": 2, "creation_date": 1443036137, "post_id": 32747777, "comment_id": 53336291, "body": "What do you mean by &quot;gives a <code>WA</code>&quot;?"}, {"owner": {"reputation": 2255, "user_id": 3760899, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/6rmhM.jpg?s=128&g=1", "display_name": "Aditya Singh", "link": "https://stackoverflow.com/users/3760899/aditya-singh"}, "reply_to_user": {"reputation": 203268, "user_id": 206403, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/vfBUe.jpg?s=128&g=1", "display_name": "Rocket Hazmat", "link": "https://stackoverflow.com/users/206403/rocket-hazmat"}, "edited": false, "score": 0, "creation_date": 1443036211, "post_id": 32747777, "comment_id": 53336330, "body": "WA stands for Wrong Answer"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 203268, "user_id": 206403, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/vfBUe.jpg?s=128&g=1", "display_name": "Rocket Hazmat", "link": "https://stackoverflow.com/users/206403/rocket-hazmat"}, "edited": false, "score": 0, "creation_date": 1443036217, "post_id": 32747777, "comment_id": 53336335, "body": "@RocketHazmat: &quot;Weird Algorithm&quot;?"}, {"owner": {"reputation": 51399, "user_id": 1553888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ac05cf8db6f338aef3c2f65e348f5d?s=128&d=identicon&r=PG", "display_name": "u_mulder", "link": "https://stackoverflow.com/users/1553888/u-mulder"}, "reply_to_user": {"reputation": 203268, "user_id": 206403, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/vfBUe.jpg?s=128&g=1", "display_name": "Rocket Hazmat", "link": "https://stackoverflow.com/users/206403/rocket-hazmat"}, "edited": false, "score": 0, "creation_date": 1443036237, "post_id": 32747777, "comment_id": 53336345, "body": "@RocketHazmat <code>What A?</code>"}, {"owner": {"reputation": 203268, "user_id": 206403, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/vfBUe.jpg?s=128&g=1", "display_name": "Rocket Hazmat", "link": "https://stackoverflow.com/users/206403/rocket-hazmat"}, "edited": false, "score": 0, "creation_date": 1443036240, "post_id": 32747777, "comment_id": 53336348, "body": "Seems to work here: <a href=\"https://eval.in/438507\" rel=\"nofollow noreferrer\">eval.in/438507</a>"}, {"owner": {"reputation": 2255, "user_id": 3760899, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/6rmhM.jpg?s=128&g=1", "display_name": "Aditya Singh", "link": "https://stackoverflow.com/users/3760899/aditya-singh"}, "edited": false, "score": 0, "creation_date": 1443036500, "post_id": 32747777, "comment_id": 53336484, "body": "Yeah. It even works on my mac. But is not submitted on codechef. I even tried the same code in Python. So it gave me a runtime error while taking input and using <code>input().split(&quot; &quot;)</code> function. Whats under the scenes?"}, {"owner": {"reputation": 203268, "user_id": 206403, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/vfBUe.jpg?s=128&g=1", "display_name": "Rocket Hazmat", "link": "https://stackoverflow.com/users/206403/rocket-hazmat"}, "edited": false, "score": 0, "creation_date": 1443036512, "post_id": 32747777, "comment_id": 53336493, "body": "Maybe you have an extra newline or something that it doesn&#39;t like?  Maybe it&#39;s expecting the exit code of <code>0</code> (<code>exit(0)</code>)?"}, {"owner": {"reputation": 2255, "user_id": 3760899, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/6rmhM.jpg?s=128&g=1", "display_name": "Aditya Singh", "link": "https://stackoverflow.com/users/3760899/aditya-singh"}, "edited": false, "score": 0, "creation_date": 1443036635, "post_id": 32747777, "comment_id": 53336568, "body": "Many find the same problem with PHP and python. What should be done? They say they are successful with C and C++. But theres some problem with the input in PHP or python"}, {"owner": {"reputation": 203268, "user_id": 206403, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/vfBUe.jpg?s=128&g=1", "display_name": "Rocket Hazmat", "link": "https://stackoverflow.com/users/206403/rocket-hazmat"}, "edited": false, "score": 0, "creation_date": 1443036682, "post_id": 32747777, "comment_id": 53336603, "body": "Maybe you could ask them?  Could be a bug in their submission code."}, {"owner": {"reputation": 2255, "user_id": 3760899, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/6rmhM.jpg?s=128&g=1", "display_name": "Aditya Singh", "link": "https://stackoverflow.com/users/3760899/aditya-singh"}, "edited": false, "score": 0, "creation_date": 1443036778, "post_id": 32747777, "comment_id": 53336659, "body": "No satisfactory response from their side. What am I doing wrong with PHP? I am just not able to figure out"}, {"owner": {"reputation": 1672, "user_id": 5218921, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Iy0g.jpg?s=128&g=1", "display_name": "al&#39;ein", "link": "https://stackoverflow.com/users/5218921/alein"}, "edited": false, "score": 0, "creation_date": 1443036868, "post_id": 32747777, "comment_id": 53336711, "body": "Have you looked inside other submitter&#39;s codes? The ones who made it in PHP, to see if there is something different."}, {"owner": {"reputation": 73199, "user_id": 2844319, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WYfls.png?s=128&g=1", "display_name": "AbraCadaver", "link": "https://stackoverflow.com/users/2844319/abracadaver"}, "edited": false, "score": 1, "creation_date": 1443036880, "post_id": 32747777, "comment_id": 53336719, "body": "You have some space or newline after the <code>?&gt;</code>.  You don&#39;t need the <code>?&gt;</code> I would delete it."}, {"owner": {"reputation": 2255, "user_id": 3760899, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/6rmhM.jpg?s=128&g=1", "display_name": "Aditya Singh", "link": "https://stackoverflow.com/users/3760899/aditya-singh"}, "edited": false, "score": 0, "creation_date": 1443036972, "post_id": 32747777, "comment_id": 53336766, "body": "No body did it in PHP. And No. I am pretty sure there no white space before or after the PHP tags."}], "answers": [{"comments": [{"owner": {"reputation": 203268, "user_id": 206403, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/vfBUe.jpg?s=128&g=1", "display_name": "Rocket Hazmat", "link": "https://stackoverflow.com/users/206403/rocket-hazmat"}, "edited": false, "score": 1, "creation_date": 1443037840, "post_id": 32748053, "comment_id": 53337239, "body": "This can be fixed in PHP by using <a href=\"http://php.net/sscanf\" rel=\"nofollow noreferrer\"><code>sscanf</code></a>.  <code>sscanf(fgets(STDIN), &#39;%d&#39;, $t);</code> and then <code>sscanf(fgets(STDIN), &#39;%d %d&#39;, $num1, $num2);</code>.  See: <a href=\"https://eval.in/438547\" rel=\"nofollow noreferrer\">eval.in/438547</a>"}], "tags": [], "owner": {"reputation": 1081, "user_id": 2686112, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c5d6b435697b858fa64295a4bb7e6758?s=128&d=identicon&r=PG&f=1", "display_name": "Rahul Jha", "link": "https://stackoverflow.com/users/2686112/rahul-jha"}, "is_accepted": true, "score": 3, "last_activity_date": 1443037580, "last_edit_date": 1443037580, "creation_date": 1443036913, "answer_id": 32748053, "question_id": 32747777, "link": "https://stackoverflow.com/questions/32747777/same-algorithm-runs-differently-in-c-and-php/32748053#32748053", "title": "Same algorithm runs differently in C and PHP", "body": "<p>Often i hear that some testcases are erroneous.I have a corner case for you which would give perfect result for your C code but not for your PHP</p>\n\n<p>Do this :</p>\n\n<pre><code>1\n10  10 \n</code></pre>\n\n<p>Notice there is more than one space between the two digits. </p>\n\n<p>I tested it <a href=\"https://eval.in/438522\" rel=\"nofollow\">here</a>.\nInstead of the expected output which is:</p>\n\n<pre><code>=\n</code></pre>\n\n<p>your Output is:</p>\n\n<pre><code>&gt;\n</code></pre>\n\n<p>Though C would pass this test case as scanf searches for the next integer number you type, PHP would fail since there is more than one space.\nTo make it work in PHP i did suggest you to code in such a way that the spaces between the two numbers dont affect your expected output.</p>\n\n<p>That's the only way i believe your PHP Code won't work.If this indeed was the issue it's not your fault! </p>\n"}], "owner": {"reputation": 2255, "user_id": 3760899, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/6rmhM.jpg?s=128&g=1", "display_name": "Aditya Singh", "link": "https://stackoverflow.com/users/3760899/aditya-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 32748053, "answer_count": 1, "score": 2, "last_activity_date": 1443037580, "creation_date": 1443035965, "last_edit_date": 1443036179, "question_id": 32747777, "link": "https://stackoverflow.com/questions/32747777/same-algorithm-runs-differently-in-c-and-php", "title": "Same algorithm runs differently in C and PHP", "body": "<p>I was practicing a problem on CodeChef.com.  </p>\n\n<p><a href=\"https://www.codechef.com/problems/CHOPRT\" rel=\"nofollow\">https://www.codechef.com/problems/CHOPRT</a> --> Link to the question I was solving.  </p>\n\n<p>I successfully solved the question using C.  </p>\n\n<p>My C code:  </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n\n    int t;\n    int num1;\n    int num2;\n\n\n    scanf(\"%d\", &amp;t);\n\n    while(t--) {\n\n        scanf(\"%d %d\", &amp;num1, &amp;num2);\n        if(num1 &gt; num2)\n            printf(\"&gt;\");\n        else if(num1 &lt; num2)\n            printf(\"&lt;\");\n        else\n            printf(\"=\");\n        printf(\"\\n\");           \n    }\n\n    return 0;\n}  \n</code></pre>\n\n<p>But I am not able to solve it using PHP:  </p>\n\n<p>My PHP code:  </p>\n\n<pre><code>&lt;?php\n\n    $t = intval(fgets(STDIN));\n\n    while($t--) {\n\n        $line = split(\" \", trim(fgets(STDIN)));\n        $num1 = intval($line[0]);\n        $num2 = intval($line[1]);\n\n        if($num1 &lt; $num2)\n            print(\"&lt;\");\n        else if($num1 &gt; $num2)\n            print(\"&gt;\");\n        else\n            print(\"=\"); \n        print(\"\\n\");        \n    }\n?&gt;  \n</code></pre>\n\n<p>Though both the programs run perfectly on my MacBook Pro, the PHP code is not run on codechef.com and gives a <code>WA</code>(Wrong Answer). C code is run perfectly though and that to within 0.00 seconds.   </p>\n\n<p>Please, enlighten me with the difference between the two respective codes, which I personally believe, should be working the same, and also produce the same output.</p>\n"}, {"tags": ["c", "signals", "stdin"], "comments": [{"owner": {"reputation": 84240, "user_id": 283863, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vItjB.png?s=128&g=1", "display_name": "Derek \u6715\u6703\u529f\u592b", "link": "https://stackoverflow.com/users/283863/derek-%e6%9c%95%e6%9c%83%e5%8a%9f%e5%a4%ab"}, "edited": false, "score": 0, "creation_date": 1443036433, "post_id": 32747675, "comment_id": 53336447, "body": "Downvoter, can you explain why this is an unclear question?"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1443037460, "post_id": 32747675, "comment_id": 53337030, "body": "If you don&#39;t want <code>SIGINT</code> to terminate your program, you can either block it (<code>sigprocmask()</code>), or install an appropriate signal-handler (<code>sigaction()</code>)."}, {"owner": {"reputation": 84240, "user_id": 283863, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vItjB.png?s=128&g=1", "display_name": "Derek \u6715\u6703\u529f\u592b", "link": "https://stackoverflow.com/users/283863/derek-%e6%9c%95%e6%9c%83%e5%8a%9f%e5%a4%ab"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1443037575, "post_id": 32747675, "comment_id": 53337082, "body": "@EOF That is not what I&#39;m asking. I&#39;m able to catch the signal, and I need a way to somehow tell getline to stop reading stdin."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1443037763, "post_id": 32747675, "comment_id": 53337182, "body": "<i>Well, it sounds like you want to install a signal-handler.</i> So go forth and read <code>man sigaction</code>."}, {"owner": {"reputation": 84240, "user_id": 283863, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vItjB.png?s=128&g=1", "display_name": "Derek \u6715\u6703\u529f\u592b", "link": "https://stackoverflow.com/users/283863/derek-%e6%9c%95%e6%9c%83%e5%8a%9f%e5%a4%ab"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1443038054, "post_id": 32747675, "comment_id": 53337374, "body": "@PCLuddite - In stdio.h? <a href=\"http://linux.die.net/man/3/getline\" rel=\"nofollow noreferrer\">getline</a>"}, {"owner": {"reputation": 5541, "user_id": 4367864, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/mIepQ.png?s=128&g=1", "display_name": "PC Luddite", "link": "https://stackoverflow.com/users/4367864/pc-luddite"}, "edited": false, "score": 0, "creation_date": 1443038177, "post_id": 32747675, "comment_id": 53337445, "body": "@Derek\u6715\u6703\u529f\u592b Yeah, I realized its a POSIX thing."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1443039933, "post_id": 32747675, "comment_id": 53338357, "body": "@Derek\u6715\u6703\u529f\u592b, supposing that you are writing for a POSIX environment, you can prevent a <code>SIGINT</code> from interrupting your program by installing a custom signal handler for it, or by setting its disposition to <code>SIG_IGN</code>.  Whether either of these approaches will cause <code>getline()</code> to return prematurely is unclear, however.  Some I/O functions resume after a signal.  GNU <code>getline()</code>&#39;s behavior in this regard does not appear to be documented.  You might be out of luck."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1443087836, "post_id": 32747675, "comment_id": 53355637, "body": "@JohnBollinger: As far as the manpage is concerned, <code>getline()</code> can&#39;t return  <code>EINTR</code>. As best as I can tell, the only ways to break out of <code>getline()</code> asynchronously would be a) manipulating the return address in the <code>ucontext_t*</code> in the signal-handler for <code>SIGINT</code>, or b) call <code>getline()</code> in a separate thread, and <code>pthread_cancel()</code> it. Obviously, this requires <code>getline()</code> to be a cancellation-point, which is permitted but not required."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1443104662, "post_id": 32747675, "comment_id": 53366808, "body": "@EOF, yes, <code>getline()</code> cannot return <code>EINTR</code>.  That does not necessarily mean that it must resume after being interrupted by a signal (it could instead return its documented error code, <code>-1</code>) but it does <i>suggest</i> that <code>getline()</code> will resume.  Note also that <code>getline()</code> being a cancellation point is irrelevant for the case where a thread is already blocked in that function.  A deferred cancellation request is acted upon at the time that a cancellation-point function is <i>called</i>.  The <code>pthread_cancel()</code> approach could work if the thread is made asynchronously cancellable, though."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1443114512, "post_id": 32747675, "comment_id": 53373439, "body": "@JohnBollinger:  <a href=\"http://pubs.opengroup.org/onlinepubs/009695399/functions/xsh_chap02_09.html\" rel=\"nofollow noreferrer\">pubs.opengroup.org/onlinepubs/009695399/functions/&hellip;</a> <code>If a thread has cancelability enabled and a cancellation request is made with the thread as a target while the thread is suspended at a cancellation point, the thread shall be awakened and the cancellation request shall be acted upon.</code>"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1443117754, "post_id": 32747675, "comment_id": 53375166, "body": "@EOF, ok, you&#39;re probably right, but it&#39;s not entirely clear to me whether &quot;suspended&quot; is the the state of a thread that is blocked on I/O.  The term is not explicitly defined for threads (as opposed to processes), and only a few functions are documented as causing a thread to be &quot;suspended&quot; (but those few <i>are</i> explicitly documented to do so).  Those include <code>pause()</code> and <code>wait()</code>, among others, but not, say, <code>read()</code>."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1443118087, "post_id": 32747675, "comment_id": 53375335, "body": "@JohnBollinger: My understanding is that <code>pthread_cancel()</code> is usually implemented via signals (and explicitly designed to make this conforming), and <code>getline()</code> presumably at some point (directly or indirectly) calls <code>read()</code>, which returns with <code>EINTR</code> on being signaled and causes cancellation. If you&#39;re unconvinced, feel free to ask a question about it. I hear that&#39;s popular on this site."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1443122206, "post_id": 32747675, "comment_id": 53377493, "body": "@EOF, good idea.  <a href=\"http://stackoverflow.com/questions/32769098/what-does-it-mean-to-posix-that-a-thread-is-suspended\">Done</a>."}], "answers": [{"tags": [], "owner": {"reputation": 547, "user_id": 2620202, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1549766482/picture?type=large", "display_name": "Adam Suskin", "link": "https://stackoverflow.com/users/2620202/adam-suskin"}, "is_accepted": false, "score": 0, "last_activity_date": 1443552877, "creation_date": 1443552877, "answer_id": 32851703, "question_id": 32747675, "link": "https://stackoverflow.com/questions/32747675/stopping-getline-in-c/32851703#32851703", "title": "Stopping getline in C", "body": "<p>Assuming your code resembles this:</p>\n\n<pre><code>int main(int argc, char **argv) {\n    //Code here (point A)\n    getline(lineptr, size, fpt);\n    //More code here (point B)\n}\n</code></pre>\n\n<p>Include <code>&lt;signal.h&gt;</code> and bind <code>SIGINT</code> to a handler function <code>f</code>.</p>\n\n<pre><code>#include &lt;signal.h&gt;\n\n//Declare handler for signals\nvoid signal_handler(int signum);\n\nint main(int argc, char **argv) {\n    //Set SIGINT (ctrl-c) to call signal handler\n    signal(SIGINT, signal_handler);\n\n    //Code here (point A)\n    getline(lineptr, size, fpt);\n    //More code here (point B)\n}\n\nvoid signal_handler(int signum) {\n    if(signum == SIGINT) {\n        //Received SIGINT\n\n    }\n}\n</code></pre>\n\n<p>What I would do at this point is restructure the code so that any code after point B is in its own function, call it <code>code_in_b()</code>, and in the handler call <code>code_in_b()</code>.</p>\n\n<p>More information: <a href=\"http://www.gnu.org/software/libc/manual/html_node/Signal-Handling.html\" rel=\"nofollow\">Signals</a></p>\n"}], "owner": {"reputation": 84240, "user_id": 283863, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vItjB.png?s=128&g=1", "display_name": "Derek \u6715\u6703\u529f\u592b", "link": "https://stackoverflow.com/users/283863/derek-%e6%9c%95%e6%9c%83%e5%8a%9f%e5%a4%ab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1001, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1443552877, "creation_date": 1443035579, "last_edit_date": 1443036928, "question_id": 32747675, "link": "https://stackoverflow.com/questions/32747675/stopping-getline-in-c", "title": "Stopping getline in C", "body": "<p>Here I'm trying to get an user input with <code>getline</code>. Upon receiving an interrupt <code>^C</code> I want it to signal getline to stop and resume with my program instead of terminating it.</p>\n\n<p>I tried to write a newline to stdin but apparently that doesn't work.</p>\n\n<pre><code>fwrite(\"\\n\", 1, 1, stdin);\n</code></pre>\n\n<p>So what would be a way to achieve this?</p>\n"}, {"tags": ["c", "memory", "out-of-memory", "size-t"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 3, "creation_date": 1443035758, "post_id": 32747645, "comment_id": 53336077, "body": "I&#39;d strongly recommend to get a new calculator. Check <code>SIZE_MAX</code>."}, {"owner": {"reputation": 59721, "user_id": 72631, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/42a1d7b456fc3d77050f124927ad70ab?s=128&d=identicon&r=PG", "display_name": "rlbond", "link": "https://stackoverflow.com/users/72631/rlbond"}, "edited": false, "score": 2, "creation_date": 1443035828, "post_id": 32747645, "comment_id": 53336116, "body": "(2^64 addresses)/(10^9 addresses/GB) = 1.8e10 GB... You have a maximum of 18 trillion <b>gigabytes</b> of storage, not 18 trillion bytes. That equals 18 exabytes. Always check your units!"}, {"owner": {"reputation": 7792, "user_id": 249237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QjPtI.png?s=128&g=1", "display_name": "Kninnug", "link": "https://stackoverflow.com/users/249237/kninnug"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1443035869, "post_id": 32747645, "comment_id": 53336140, "body": "<a href=\"https://www.google.com/search?q=2%5E64+bytes+in+gibibytes\" rel=\"nofollow noreferrer\">According to Google</a> 2^64 bytes = 17179869184 gibibytes. As @Olaf said, <code>SIZE_MAX</code> determines the maximum value of a <code>size_t</code>. Also, in C a <code>char</code> is always a byte. The name is just a historical misfortune."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 7792, "user_id": 249237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QjPtI.png?s=128&g=1", "display_name": "Kninnug", "link": "https://stackoverflow.com/users/249237/kninnug"}, "edited": false, "score": 1, "creation_date": 1443036026, "post_id": 32747645, "comment_id": 53336227, "body": "@Kninnug: Just to add that a bytes might have more than 8 bits."}, {"owner": {"reputation": 7792, "user_id": 249237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QjPtI.png?s=128&g=1", "display_name": "Kninnug", "link": "https://stackoverflow.com/users/249237/kninnug"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1443036246, "post_id": 32747645, "comment_id": 53336352, "body": "@Olaf good point, though that&#39;s (for now) uncommon in laptops."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 7792, "user_id": 249237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QjPtI.png?s=128&g=1", "display_name": "Kninnug", "link": "https://stackoverflow.com/users/249237/kninnug"}, "edited": false, "score": 0, "creation_date": 1443036391, "post_id": 32747645, "comment_id": 53336413, "body": "@Kninnug: If they had widenth a byte, we could have longer worked wit 32 bit machines and Win XP. No one needs 64 bits! ;-)"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1443036437, "post_id": 32747645, "comment_id": 53336450, "body": "&quot;<i>I&#39;ve seen several answers that come close to this but not a specific answer.</i>&quot; -- How is <a href=\"http://stackoverflow.com/a/32747833/827263\">my answer</a> not specific enough?"}, {"owner": {"reputation": 7792, "user_id": 249237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QjPtI.png?s=128&g=1", "display_name": "Kninnug", "link": "https://stackoverflow.com/users/249237/kninnug"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1443036960, "post_id": 32747645, "comment_id": 53336757, "body": "@Olaf I&#39;m completely in favor of 256-bit bytes: let&#39;s skip the intermediaries and be future-proof till the end of the universe and the next! (and to mess with anything that assumes the value of <code>CHAR_BIT</code> can fit in 8 bits :P)."}, {"owner": {"reputation": 3691, "user_id": 2827300, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/1kYfq.jpg?s=128&g=1", "display_name": "lindsaymacvean", "link": "https://stackoverflow.com/users/2827300/lindsaymacvean"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1443037094, "post_id": 32747645, "comment_id": 53336831, "body": "Im sorry @KeithThompson your answer is excellent it was just that Eriks answer was the one that actually helped me to click on where I was going wrong."}], "answers": [{"tags": [], "owner": {"reputation": 2923, "user_id": 3434508, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/gFffm.png?s=128&g=1", "display_name": "Stavr00", "link": "https://stackoverflow.com/users/3434508/stavr00"}, "is_accepted": false, "score": 1, "last_activity_date": 1443036081, "creation_date": 1443036081, "answer_id": 32747818, "question_id": 32747645, "link": "https://stackoverflow.com/questions/32747645/if-size-t-is-64-bits-what-is-the-maximum-size-of-a-char-array/32747818#32747818", "title": "if size_t is 64 bits what is the maximum size of a char array?", "body": "<p>1 GB = 2^30 or about 10^9</p>\n\n<p>So 2^64 in GB is 2^(64-30) = 2^34 = 17,179,869,184GB ... 18 GGB \"eighteen giga-gigabytes\" ;)</p>\n"}, {"comments": [{"owner": {"reputation": 3691, "user_id": 2827300, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/1kYfq.jpg?s=128&g=1", "display_name": "lindsaymacvean", "link": "https://stackoverflow.com/users/2827300/lindsaymacvean"}, "edited": false, "score": 0, "creation_date": 1443036572, "post_id": 32747821, "comment_id": 53336531, "body": "ah it was just poor mathematics on my part."}], "tags": [], "owner": {"reputation": 1096, "user_id": 541437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9813c60c9048854d3588fa0a65268da0?s=128&d=identicon&r=PG", "display_name": "Erik Johnson", "link": "https://stackoverflow.com/users/541437/erik-johnson"}, "is_accepted": true, "score": 1, "last_activity_date": 1443036089, "creation_date": 1443036089, "answer_id": 32747821, "question_id": 32747645, "link": "https://stackoverflow.com/questions/32747645/if-size-t-is-64-bits-what-is-the-maximum-size-of-a-char-array/32747821#32747821", "title": "if size_t is 64 bits what is the maximum size of a char array?", "body": "<p>Your math is wrong.  Yes, 2^64 is about 18 quintillion addresses... but you went wrong dividing by 10^9.  You don't have 18 gigabytes of addresses, you have 18 billion gigaBytes - 18 quintillion addresses, as you noted at the start.  </p>\n\n<p>16 bits is 64K; 32 bits is 4 GB; 64 bits is 16 exabytes.</p>\n"}, {"tags": [], "owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "is_accepted": false, "score": 2, "last_activity_date": 1443036131, "creation_date": 1443036131, "answer_id": 32747833, "question_id": 32747645, "link": "https://stackoverflow.com/questions/32747645/if-size-t-is-64-bits-what-is-the-maximum-size-of-a-char-array/32747833#32747833", "title": "if size_t is 64 bits what is the maximum size of a char array?", "body": "<p>If <code>size_t</code> is 64 bits, then (assuming no padding bits) <code>SIZE_MAX</code> is 2<sup>64</sup>-1, or 18446744073709551615. That's a bit over 18 <em>exabytes</em>, or about 17 billion gigabytes.</p>\n\n<p>(It's 17 rather than 18 because, in this context, the prefixes \"kilo\", \"mega\", \"giga\", et al represent powers of 1024, not of 1000. In recent years, <a href=\"https://en.wikipedia.org/wiki/Binary_prefix\" rel=\"nofollow\">binary prefixes</a> have been introduced that unambigously represent powers of 1024, but they haven't seen widespread use.)</p>\n\n<p>Yes, that means that 2<sup>64</sup>-1 is <em>an</em> upper bound for the size of any object your program can create. (There's some ambiguity in the standard, but the intent is that <code>size_t</code> can represent the size of any object.)</p>\n\n<p>That doesn't mean you can actually create an object that big. 2<sup>64</sup>-1 is <em>an</em> upper bound on the size of an object, but not (necessarily) the <em>least</em> upper bound. In practice, other considerations, such as the amount of available memory (physical and/or virtual) and machine addressing limitations, will usually impose much smaller limits.</p>\n\n<p>On a system with a 32-bit <code>size_t</code>, the maximum theoretical object size is about 4 gigabytes, and on modern systems that could be an actual limit. With a 64-bit <code>size_t</code>, given modern computer technology, the actual limit is almost certainly going to be imposed by something else.</p>\n"}], "owner": {"reputation": 3691, "user_id": 2827300, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/1kYfq.jpg?s=128&g=1", "display_name": "lindsaymacvean", "link": "https://stackoverflow.com/users/2827300/lindsaymacvean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 300, "favorite_count": 0, "accepted_answer_id": 32747821, "answer_count": 3, "score": -2, "last_activity_date": 1443036700, "creation_date": 1443035456, "last_edit_date": 1443036700, "question_id": 32747645, "link": "https://stackoverflow.com/questions/32747645/if-size-t-is-64-bits-what-is-the-maximum-size-of-a-char-array", "title": "if size_t is 64 bits what is the maximum size of a char array?", "body": "<p>I've seen several answers that come close to this but not a specific answer.</p>\n\n<p>If size_t is set to 64 bits then 2^64 is approximately 18 quintillion standard chars (usually bytes) as the maximum size for a char* array. If divide by 10^9 (GB) we end up with <strong>18GB</strong> as the maximum theoretical (and if its possible to buy a laptop with 32GB - then also real) limit to the size of an array in memory.</p>\n\n<p>Is 18GB really a limit for char arrays/strings on 64 bit machines or have I missed something in my reasoning? </p>\n\n<p>I'm doing my first true CS course so please excuse me if I have got anything seriously wrong with my understanding.</p>\n\n<p>EDIT\nFor anyone reading this it would appear my maths is wrong so make sure to read the answers below. Specifically when I divided by 10^9 this converted the answer into GB units but there was still 18 * 10^9 of those GB. Which is equivalent to 18 Exabytes.</p>\n"}, {"tags": ["c", "random"], "comments": [{"owner": {"reputation": 59721, "user_id": 72631, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/42a1d7b456fc3d77050f124927ad70ab?s=128&d=identicon&r=PG", "display_name": "rlbond", "link": "https://stackoverflow.com/users/72631/rlbond"}, "edited": false, "score": 2, "creation_date": 1443035618, "post_id": 32747622, "comment_id": 53336005, "body": "It depends. A PRNG can form one or multiple cycles. If 0 and 1 are in the same cycle, then yes, you will eventually see the sequence you get using <code>srand(0)</code> with <code>srand(1)</code>; in fact, both sequences will be the same, but shifted some amount. On the other hand, if they&#39;re in different cycles, you won&#39;t ever see any of the numbers in common."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1443035896, "post_id": 32747622, "comment_id": 53336156, "body": "This is not defined by the standard."}], "answers": [{"comments": [{"owner": {"reputation": 19034, "user_id": 780717, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eead3a6ab011b880ca6ec354ca00f0b3?s=128&d=identicon&r=PG", "display_name": "njuffa", "link": "https://stackoverflow.com/users/780717/njuffa"}, "edited": false, "score": 0, "creation_date": 1443051559, "post_id": 32747941, "comment_id": 53342909, "body": "Unless I misunderstand the second paragraph, I don&#39;t think this it is correct. Non-overlapping sequences can be produced by PRNGs independent of any other qualities. All that is needed is a function that advances the internal state N times, without actually requiring O(N) computation. In many cases this is possible in O(log(n)) time using matrix exponentiation, or even O(1) time in the case of PRNGs based on encryption of a counter value, e.g. Philox. Knowing the period of the generator and the advancing function then allows production of multiple non-overlapping sequences of specified length."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "reply_to_user": {"reputation": 19034, "user_id": 780717, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eead3a6ab011b880ca6ec354ca00f0b3?s=128&d=identicon&r=PG", "display_name": "njuffa", "link": "https://stackoverflow.com/users/780717/njuffa"}, "edited": false, "score": 0, "creation_date": 1443056089, "post_id": 32747941, "comment_id": 53343998, "body": "What I&#39;m saying is that if you never want the subsequence <code>{ 42, 12345, 98 }</code> to appear in your sequence for more than one seed, this (1) means your PRNG has bad statistical properties, and (2) is hard to achieve unless your PRNG has properties that make it bad (like low period relative to the number of possible outputs)."}], "tags": [], "owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "is_accepted": false, "score": 3, "last_activity_date": 1443036486, "creation_date": 1443036486, "answer_id": 32747941, "question_id": 32747622, "link": "https://stackoverflow.com/questions/32747622/will-prng-sequence-with-different-seeds-overlaps-in-c/32747941#32747941", "title": "Will PRNG sequence with different seeds overlaps in C", "body": "<p>For <code>rand</code>, it's not specified by the standard, but the example implementation suggested in the C standard certainly does produce overlapping sequences (actually there's only one sequence and the seed is just the starting point).</p>\n\n<p>If you need stronger properties you need to choose an appropriate PRNG rather than just using <code>rand</code>. A guarantee of no overlapping length-N subsequences would be very hard to prove for a decent PRNG, and an easy proof or even truth of that statement for reasonable-size N would indicate a very <strong>bad</strong> PRNG. But it's easy to guarantee, for a good PRNG with sufficiently large state, that different seeds do not produce completely identical sequences, just starting at different points.</p>\n"}, {"tags": [], "owner": {"reputation": 2758, "user_id": 446006, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/zV0uM.jpg?s=128&g=1", "display_name": "Abhi", "link": "https://stackoverflow.com/users/446006/abhi"}, "is_accepted": true, "score": 3, "last_activity_date": 1443036974, "last_edit_date": 1495539866, "creation_date": 1443036974, "answer_id": 32748075, "question_id": 32747622, "link": "https://stackoverflow.com/questions/32747622/will-prng-sequence-with-different-seeds-overlaps-in-c/32748075#32748075", "title": "Will PRNG sequence with different seeds overlaps in C", "body": "<p>Though it is not defined by standard - The answer to your question is yes, it depends upon the algorithm being used, which is usually Linear Congruential Generators (LCG). LCG is considered to be high on cross-autocorrelation. Looking at how <code>rand</code> is implemented in your platform will let you characterize it better.  Here is an example <a href=\"https://stackoverflow.com/questions/4768180/rand-implementation\">Rand Implementation</a></p>\n"}, {"tags": [], "owner": {"reputation": 16237, "user_id": 2166798, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/417356917295f5176d2a3e7c21d8f9e8?s=128&d=identicon&r=PG", "display_name": "pjs", "link": "https://stackoverflow.com/users/2166798/pjs"}, "is_accepted": false, "score": 2, "last_activity_date": 1443039698, "creation_date": 1443039698, "answer_id": 32748770, "question_id": 32747622, "link": "https://stackoverflow.com/questions/32747622/will-prng-sequence-with-different-seeds-overlaps-in-c/32748770#32748770", "title": "Will PRNG sequence with different seeds overlaps in C", "body": "<p>The actual answer is that it depends on the implementation of the generator, which is not defined in the standard.  This is true even for Linear Congruential Generators (LCGs), which are often used as a default implementation for <code>rand</code>.</p>\n\n<p>An LCG is a recurrence relationship of the form</p>\n\n<pre><code>state = (A * state + B) % M\n</code></pre>\n\n<p>for suitable integer-valued constants <code>A</code>, <code>B</code>, and <code>M</code>.  Setting the seed initializes the <code>state</code>.</p>\n\n<p>Some choices of <code>A</code>, <code>B</code>, and <code>M</code> will not achieve full cycle (relative to the modulus <code>M</code>), in which case the LCG can produce two or more non-overlapping subsequences.  For example, for <code>A = 3</code>, <code>B = 0</code>, and <code>M = 11</code> you'll find yourself on one of two non-overlapping subcycles depending on your seed value.\nSeeding with 1 will produce the following sequence:</p>\n\n<pre><code>3,9,5,4,1,3,9,5,4,1,3,9...\n</code></pre>\n\n<p>and seeding with 2 will produce:</p>\n\n<pre><code>6,7,10,8,2,6,7,10,8,2,6,7...\n</code></pre>\n\n<p>Other choices of the coefficients can attain full cycle. in either case the seed value corresponds to picking an entry point to a cycle or subcycle.</p>\n\n<p>For other classes of generators which maintain a larger state space and collapse the state to produce each reported value, you can get repeats of individual values without repeating the identical sequence until you have enumerated the entire (not visible) state space.  That's how a generator such as Mersenne Twister achieves cycle lengths such as 2<sup>19937</sup>-1.  Different (very large) states can collapse down to the same 32 or 64 bit quantity for an individual observation, but will lead to entirely different states being calculated (and collapsed) for the next value, so you will see repeats of individual values without seeing a repeat of the sequence of values.</p>\n"}], "owner": {"reputation": 2058, "user_id": 1720085, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/31607e975427d648b2342b74cb888417?s=128&d=identicon&r=PG", "display_name": "Daniel Bonetti", "link": "https://stackoverflow.com/users/1720085/daniel-bonetti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "accepted_answer_id": 32748075, "answer_count": 3, "score": 3, "last_activity_date": 1443039698, "creation_date": 1443035361, "question_id": 32747622, "link": "https://stackoverflow.com/questions/32747622/will-prng-sequence-with-different-seeds-overlaps-in-c", "title": "Will PRNG sequence with different seeds overlaps in C", "body": "<p>If I set the seed to 0 in C, I will get this sequence after calling <code>rand()</code> three times:</p>\n\n<pre><code>38, 7719, 21238, ...,\n</code></pre>\n\n<p>If I set seed to 1 (<code>srand(1)</code>) I will get this other sequence:</p>\n\n<pre><code>41, 18467, 6334, ...,\n</code></pre>\n\n<p>I know that is's very improbable, but will the sequence of <code>srand(1)</code> be present in the sequence of <code>srand(0)</code> at some point? I mean, using <code>srand(0)</code> will I get:</p>\n\n<pre><code>38, 7719, 21238, ..., ..., ..., 41, 18467, 6334, ...,?\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["c++", "c", "bit-manipulation", "xor"], "comments": [{"owner": {"reputation": 59721, "user_id": 72631, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/42a1d7b456fc3d77050f124927ad70ab?s=128&d=identicon&r=PG", "display_name": "rlbond", "link": "https://stackoverflow.com/users/72631/rlbond"}, "edited": false, "score": 0, "creation_date": 1443035235, "post_id": 32747229, "comment_id": 53335795, "body": "What exactly are you trying to do? Can you write an equation that is more clear?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1443035246, "post_id": 32747229, "comment_id": 53335800, "body": "You want <code>(VALUE ^ XOR) &amp; MASK</code>? Please be more specific. As given now, it is unclear what you want to accomplish."}], "answers": [{"comments": [{"owner": {"reputation": 7789, "user_id": 2357837, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/035467770d62d867f62487dc025f043d?s=128&d=identicon&r=PG", "display_name": "ChronoTrigger", "link": "https://stackoverflow.com/users/2357837/chronotrigger"}, "edited": false, "score": 0, "creation_date": 1443034485, "post_id": 32747308, "comment_id": 53335326, "body": "Maybe I misunderstood you, but XOR 0 is not a no-op."}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "reply_to_user": {"reputation": 7789, "user_id": 2357837, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/035467770d62d867f62487dc025f043d?s=128&d=identicon&r=PG", "display_name": "ChronoTrigger", "link": "https://stackoverflow.com/users/2357837/chronotrigger"}, "edited": false, "score": 2, "creation_date": 1443034595, "post_id": 32747308, "comment_id": 53335401, "body": "@ChronoTrigger why not?"}, {"owner": {"reputation": 7789, "user_id": 2357837, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/035467770d62d867f62487dc025f043d?s=128&d=identicon&r=PG", "display_name": "ChronoTrigger", "link": "https://stackoverflow.com/users/2357837/chronotrigger"}, "edited": false, "score": 0, "creation_date": 1443034641, "post_id": 32747308, "comment_id": 53335429, "body": "1 xor 0 = 1; 0 xor 0 = 0."}], "tags": [], "owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "is_accepted": false, "score": 1, "last_activity_date": 1443034376, "creation_date": 1443034376, "answer_id": 32747308, "question_id": 32747229, "link": "https://stackoverflow.com/questions/32747229/fastest-way-to-xor-all-bits-from-value-based-on-bitmask/32747308#32747308", "title": "Fastest Way to XOR all bits from value based on bitmask?", "body": "<p>Using that the XOR with 0 doesn't change anything, it's OK to apply the mask and then unconditionally XOR all bits together, which can be done in a parallel-prefix way. So something like this (not tested):</p>\n\n<pre><code>x = m &amp; v;\nx ^= x &gt;&gt; 16;\nx ^= x &gt;&gt; 8;\nx ^= x &gt;&gt; 4;\nx ^= x &gt;&gt; 2;\nx ^= x &gt;&gt; 1;\nresult = x &amp; 1\n</code></pre>\n\n<p>You can use more (or fewer) steps as needed, this is for 32 bits.</p>\n"}, {"comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 1, "creation_date": 1443037806, "post_id": 32747500, "comment_id": 53337214, "body": "Actually you can save another operation by changing the loop to <code>for (c = 0; v; c^=1)</code> then you do not need to do <code>&amp;1</code> at the end :)"}], "tags": [], "owner": {"reputation": 305833, "user_id": 68587, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7d9fd158e03cbde94f7e0b33b78222af?s=128&d=identicon&r=PG", "display_name": "John Kugelman", "link": "https://stackoverflow.com/users/68587/john-kugelman"}, "is_accepted": false, "score": 5, "last_activity_date": 1443038760, "last_edit_date": 1495539865, "creation_date": 1443034937, "answer_id": 32747500, "question_id": 32747229, "link": "https://stackoverflow.com/questions/32747229/fastest-way-to-xor-all-bits-from-value-based-on-bitmask/32747500#32747500", "title": "Fastest Way to XOR all bits from value based on bitmask?", "body": "<p>If I'm understanding you right, you have</p>\n\n<pre><code>result = value &amp; mask\n</code></pre>\n\n<p>and you want to XOR the 1 bits of <code>mask &amp; result</code> together. The XOR of a series of bits is the same as counting the number of bits and checking if that count is even or odd. If it's odd, the XOR would be 1; if even, XOR would give 0.</p>\n\n<pre><code>count_bits(mask &amp; result) % 2 != 0\n</code></pre>\n\n<p><code>mask &amp; result</code> can be simplified to simply <code>result</code>. You don't need to AND it with <code>mask</code> again. The <code>% 2 != 0</code> can be alternately written as <code>&amp; 1</code>.</p>\n\n<pre><code>count_bits(result) &amp; 1\n</code></pre>\n\n<p>As far as how to count bits, the <a href=\"https://graphics.stanford.edu/~seander/bithacks.html\" rel=\"nofollow noreferrer\">Bit Twiddling Hacks</a> web page gives a number of <a href=\"https://graphics.stanford.edu/~seander/bithacks.html#CountBitsSetNaive\" rel=\"nofollow noreferrer\">bit counting algorithms</a>.</p>\n\n<blockquote>\n  <h3>Counting bits set, Brian Kernighan's way</h3>\n\n<pre><code>unsigned int v; // count the number of bits set in v\nunsigned int c; // c accumulates the total bits set in v\nfor (c = 0; v; c++)\n{\n  v &amp;= v - 1; // clear the least significant bit set\n}\n</code></pre>\n  \n  <p>Brian Kernighan's method goes through as many iterations as there are\n  set bits. So if we have a 32-bit word with only the high bit set, then\n  it will only go once through the loop.</p>\n</blockquote>\n\n<p>If you were to use that implementation, you could optimize it a bit further. If you think about it, you don't need the full count of bits. You only need to track their parity. Instead of counting bits you could just flip <code>c</code> each iteration.</p>\n\n<pre><code>unsigned bit_parity(unsigned v) {\n  unsigned c;\n  for (c = 0; v; c ^= 1) {\n    v &amp;= v - 1;\n  }\n}\n</code></pre>\n\n<p><sup>(Thanks to <a href=\"https://stackoverflow.com/users/432358/slava\">Slava</a> for the suggestion.)</sup></p>\n"}, {"tags": [], "owner": {"reputation": 23451, "user_id": 32775, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/853ea0ee58ffef56c0b32e34d0a935c2?s=128&d=identicon&r=PG", "display_name": "luiscubal", "link": "https://stackoverflow.com/users/32775/luiscubal"}, "is_accepted": true, "score": 5, "last_activity_date": 1443036858, "last_edit_date": 1495540702, "creation_date": 1443034941, "answer_id": 32747502, "question_id": 32747229, "link": "https://stackoverflow.com/questions/32747229/fastest-way-to-xor-all-bits-from-value-based-on-bitmask/32747502#32747502", "title": "Fastest Way to XOR all bits from value based on bitmask?", "body": "<p>If I understood this question correctly, what you want is to get every bit from VALUE that is set in the MASK, and compute the XOR of those bits.</p>\n\n<p>First of all, note that XOR'ing a value with 0 will not change the result. So, to ignore some bits, we can treat them as zeros.</p>\n\n<p>So, XORing the bits set in VALUE that are in MASK is equivalent to XORing the bits in VALUE&amp;MASK.</p>\n\n<p>Now note that the result is 0 if the number of set bits is even, 1 if it is odd.</p>\n\n<p>That means we want to count the number of set bits. Some architectures/compilers have ways to quickly compute this value. For instance, on GCC this can be obtained with <code>__builtin_popcount</code>.</p>\n\n<p>So on GCC, this can be computed with:</p>\n\n<pre><code>int set_bits = __builtin_popcount(value &amp; mask);\n\nreturn set_bits % 2;\n</code></pre>\n\n<p>If you want the code to be portable, then this won't do. However, a comment in <a href=\"https://stackoverflow.com/a/109069/32775\">this answer</a> suggests that some compilers can inline <code>std::bitset::count</code> to efficiently obtain the same result.</p>\n"}, {"comments": [{"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1443039697, "post_id": 32748221, "comment_id": 53338243, "body": "That&#39;s great (it is, really, nice method to count 1&#39;s) but why do that extra stuff to get the bit count when the full count isn&#39;t necessary?"}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 0, "last_activity_date": 1443037490, "creation_date": 1443037490, "answer_id": 32748221, "question_id": 32747229, "link": "https://stackoverflow.com/questions/32747229/fastest-way-to-xor-all-bits-from-value-based-on-bitmask/32748221#32748221", "title": "Fastest Way to XOR all bits from value based on bitmask?", "body": "<p>One significant issue to be aware of if using <code>v &amp;= v - 1</code> in the main body of your code is it will change the value of <code>v</code> to <code>0</code> in conducting the count. With other methods, the value is changed to the number of <code>1</code>'s. While count logic is generally wrapped as a function, where that is no longer a concern, if you are required to present your counting logic in the main body of your code, you must preserve a copy of <code>v</code> if that value is needed again.</p>\n\n<p>In addition to the other two methods presented, the following is another favorite from bit-twiddling hacks that generally has a bit better performance than the loop method for larger numbers:</p>\n\n<pre><code>/* get the population 1's in the binary representation of a number */\nunsigned getn1s (unsigned int v)\n{\n    v = v - ((v &gt;&gt; 1) &amp; 0x55555555);\n    v = (v &amp; 0x33333333) + ((v &gt;&gt; 2) &amp; 0x33333333);\n    v = (v + (v &gt;&gt; 4)) &amp; 0x0F0F0F0F;\n    v = v + (v &lt;&lt; 8);\n    v = v + (v &lt;&lt; 16);\n    return v &gt;&gt; 24;\n}\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 1088363, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/7bceaf8bad7c44a0fcb338ee92343245?s=128&d=identicon&r=PG", "display_name": "pantaryl", "link": "https://stackoverflow.com/users/1088363/pantaryl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1963, "favorite_count": 1, "accepted_answer_id": 32747502, "answer_count": 4, "score": 0, "last_activity_date": 1443038760, "creation_date": 1443034107, "question_id": 32747229, "link": "https://stackoverflow.com/questions/32747229/fastest-way-to-xor-all-bits-from-value-based-on-bitmask", "title": "Fastest Way to XOR all bits from value based on bitmask?", "body": "<p>I've got an interesting problem that has me looking for a more efficient way of doing things.</p>\n\n<p>Let's say we have a value (in binary)</p>\n\n<pre><code>(VALUE) 10110001\n(MASK)  00110010\n----------------\n(AND)   00110000\n</code></pre>\n\n<p>Now, I need to be able to XOR any bits from the <code>(AND)</code> value that are set in the <code>(MASK)</code> value (always lowest to highest bit):</p>\n\n<pre><code>(RESULT) AND<sub>1</sub>(0) xor AND<sub>4</sub>(1) xor AND<sub>5</sub>(1) = 0</code></pre>\n\n<p>Now, on paper, this is certainly quick since I can see which bits are set in the mask. It seems to me that programmatically I would need to keep right shifting the MASK until I found a set bit, XOR it with a separate value, and loop until the entire byte is complete.</p>\n\n<p>Can anyone think of a faster way? I'm looking for the way to do this with the least number of operations and stored values.</p>\n"}, {"tags": ["c", "performance", "parallel-processing", "openmp"], "comments": [{"owner": {"reputation": 2640, "user_id": 5195699, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f85291bb71f55981b1d412f1efcb7603?s=128&d=identicon&r=PG&f=1", "display_name": "R_Kapp", "link": "https://stackoverflow.com/users/5195699/r-kapp"}, "edited": false, "score": 4, "creation_date": 1443037381, "post_id": 32747096, "comment_id": 53336992, "body": "Do not use <code>clock</code> to measure time spent. See the accepted answer <a href=\"http://stackoverflow.com/questions/10727849/no-performance-gain-after-using-openmp-on-a-program-optimize-for-sequential-runn?rq=1\">here</a>."}, {"owner": {"reputation": 4037, "user_id": 4056099, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xF37X.jpg?s=128&g=1", "display_name": "NoseKnowsAll", "link": "https://stackoverflow.com/users/4056099/noseknowsall"}, "edited": false, "score": 0, "creation_date": 1443047118, "post_id": 32747096, "comment_id": 53341552, "body": "Furthermore, OP, you need to declare your loop iterators as private as well: it should be <code>#pragma omp parallel for private(j, temp, i)</code>. I&#39;d be surprised if you were getting the correct output as-is."}, {"owner": {"reputation": 185, "user_id": 3784688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120785cdb10fe6639b0e149d93f4ca01?s=128&d=identicon&r=PG", "display_name": "MtCS", "link": "https://stackoverflow.com/users/3784688/mtcs"}, "edited": false, "score": 0, "creation_date": 1443051489, "post_id": 32747096, "comment_id": 53342889, "body": "I cantora belive I misses the loop iterators!"}, {"owner": {"reputation": 31, "user_id": 5368843, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/39bd8045b7a7f773cf0a427524aa1e72?s=128&d=identicon&r=PG&f=1", "display_name": "kernalnt", "link": "https://stackoverflow.com/users/5368843/kernalnt"}, "reply_to_user": {"reputation": 4037, "user_id": 4056099, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xF37X.jpg?s=128&g=1", "display_name": "NoseKnowsAll", "link": "https://stackoverflow.com/users/4056099/noseknowsall"}, "edited": false, "score": 0, "creation_date": 1443065040, "post_id": 32747096, "comment_id": 53345932, "body": "@NoseKnowsAll thanks for pointing out the error. Without using j and i as private i was getting correct output(dont know why) however using j and i as private I am getting speedup and the openmp runtime is less than the serial. I think j is by default private and there is no need to do it explicitly."}, {"owner": {"reputation": 31, "user_id": 5368843, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/39bd8045b7a7f773cf0a427524aa1e72?s=128&d=identicon&r=PG&f=1", "display_name": "kernalnt", "link": "https://stackoverflow.com/users/5368843/kernalnt"}, "reply_to_user": {"reputation": 2640, "user_id": 5195699, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f85291bb71f55981b1d412f1efcb7603?s=128&d=identicon&r=PG&f=1", "display_name": "R_Kapp", "link": "https://stackoverflow.com/users/5195699/r-kapp"}, "edited": false, "score": 1, "creation_date": 1443065800, "post_id": 32747096, "comment_id": 53346083, "body": "@R_Kapp using omp_get_wget along with private iterators is doing the trick. Thank You."}], "answers": [{"comments": [{"owner": {"reputation": 4037, "user_id": 4056099, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xF37X.jpg?s=128&g=1", "display_name": "NoseKnowsAll", "link": "https://stackoverflow.com/users/4056099/noseknowsall"}, "edited": false, "score": 3, "creation_date": 1443046907, "post_id": 32749727, "comment_id": 53341476, "body": "By default, the OpenMP schedule is implementation dependent. That being said, I&#39;m also fairly certain that most implementations will implement <code>schedule(static, numIterations&#47;numThreads)</code> as the default. I believe @R_Kapp has found the correct answer to this problem."}, {"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 1, "creation_date": 1443432820, "post_id": 32749727, "comment_id": 53475294, "body": "I have never seen a OpenMP implementation default to dynamic scheduling."}], "tags": [], "owner": {"reputation": 185, "user_id": 3784688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120785cdb10fe6639b0e149d93f4ca01?s=128&d=identicon&r=PG", "display_name": "MtCS", "link": "https://stackoverflow.com/users/3784688/mtcs"}, "is_accepted": false, "score": 0, "last_activity_date": 1443451683, "last_edit_date": 1443451683, "creation_date": 1443043348, "answer_id": 32749727, "question_id": 32747096, "link": "https://stackoverflow.com/questions/32747096/performance-improvement-in-openmp/32749727#32749727", "title": "Performance improvement in openMP", "body": "<p>Try using:</p>\n\n<pre><code>#pragma omp parallel for private(temp) schedule(static,XX) \n</code></pre>\n\n<p>with a several values of XX like 10, 50 100, 1000 etc...</p>\n\n<p>By default, OpenMP uses dynamic scheduling that is better for parallelize code that would have balance issues between iterations/cores.</p>\n\n<p>Edit: you need to put the loop iterators as private variables. Otherwise it will repeat work. You can experiment with different schedulers and vary parameters to tune thread performance still...</p>\n"}], "owner": {"reputation": 31, "user_id": 5368843, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/39bd8045b7a7f773cf0a427524aa1e72?s=128&d=identicon&r=PG&f=1", "display_name": "kernalnt", "link": "https://stackoverflow.com/users/5368843/kernalnt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 359, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1443451683, "creation_date": 1443033693, "question_id": 32747096, "link": "https://stackoverflow.com/questions/32747096/performance-improvement-in-openmp", "title": "Performance improvement in openMP", "body": "<p>The following is the program to find Factorial of some given random number. Parallel when compared with serial, the performance of serial is far better even for large input. What should be apt logic to improve performance using openmp and how to further optimize the openmp parallelized code.</p>\n\n<p>CODE -</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;omp.h&gt;\n#include &lt;time.h&gt;\n\nint main( )\n{\n    int i,j,k,num,thread;\n    int *arr,*result,temp;\n    time_t t;\n    srand((unsigned)time(&amp;t));\n    scanf(\"%d\",&amp;num);\n    arr = (int*)malloc(sizeof(int)*num);\n    result = (int*)malloc(sizeof(int)*num);\n\n    for(i=0;i&lt;num;i++){\n        arr[i]=rand()%10;\n    }\n\n    for(i=0;i&lt;num;i++){\n        result[i]=1;\n    }   \n\n    clock_t begin, end;\n    double time_spent_omp;\n    double time_spent;\n\n    begin = clock();\n    /* here, do your time-consuming job */\n\n        #pragma omp parallel for private(temp)\n        for(j=0;j&lt;num;j++){\n            temp = arr[j];\n            for(i=0;i&lt;temp;temp--)\n            result[j]=result[j]*temp;\n        }   \n\n\n    end = clock();\n    time_spent_omp = (double)(end - begin) / CLOCKS_PER_SEC;\n\n    /*\n    for(i=0;i&lt;num;i++){\n        printf(\"%d\\t%d\\n\",arr[i],result[i]);\n    }*/\n\n    for(i=0;i&lt;num;i++){\n        result[i]=1;\n    }   \n\n    begin = clock();\n\n    for(j=0;j&lt;num;j++){\n        temp = arr[j];\n        for(i=0;i&lt;temp;temp--)\n        result[j]=result[j]*temp;\n    }\n\n    end = clock();\n    time_spent = (double)(end - begin)/ CLOCKS_PER_SEC;\n\n    /*\n    for(i=0;i&lt;num;i++){\n        printf(\"%d\\t%d\\n\",arr[i],result[i]);\n    }*/\n\n    printf(\"Time for serial is %f\\nTime for openMP is %f\\n\",time_spent, time_spent_omp);\n\n    return 0;\n}\n</code></pre>\n\n<p>OUTPUT - </p>\n\n<pre><code>rnt@rnt-laptop:~/Desktop/C$ gcc -fopenmp -o fact fact.c\nrnt@rnt-laptop:~/Desktop/C$ ./fact \n5\nTime for serial is 0.000004\nTime for openMP is 0.006214\nrnt@rnt-laptop:~/Desktop/C$ ./fact \n11\nTime for serial is 0.000013\nTime for openMP is 0.000391\nrnt@rnt-laptop:~/Desktop/C$ ./fact \n111\nTime for serial is 0.000078\nTime for openMP is 0.000507\nrnt@rnt-laptop:~/Desktop/C$ ./fact \n1111\nTime for serial is 0.000454\nTime for openMP is 0.000860\nrnt@rnt-laptop:~/Desktop/C$ ./fact \n11111\nTime for serial is 0.002947\nTime for openMP is 0.004829\nrnt@rnt-laptop:~/Desktop/C$ ./fact \n111111\nTime for serial is 0.022903\nTime for openMP is 0.044273\nrnt@rnt-laptop:~/Desktop/C$ ./fact \n1111111\nTime for serial is 0.030446\nTime for openMP is 0.160402\nrnt@rnt-laptop:~/Desktop/C$ ./fact \n11111111\nTime for serial is 0.298610\nTime for openMP is 1.580710\nrnt@rnt-laptop:~/Desktop/C$ ./fact \n111111111\nTime for serial is 2.993646\nTime for openMP is 13.202524\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1443032617, "post_id": 32746773, "comment_id": 53334317, "body": "<code>ii[i]</code> for <code>i=5</code> is UB."}, {"owner": {"reputation": 10774, "user_id": 4419802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d0f1bd19b8b8481b6b3e812691c1ccb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/4419802/matt"}, "edited": false, "score": 3, "creation_date": 1443032625, "post_id": 32746773, "comment_id": 53334323, "body": "<code>for (i=1; i&lt;=5; i++)</code> -- must be 0..4 not 1..5"}, {"owner": {"reputation": 86959, "user_id": 1735406, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/IF9uS.png?s=128&g=1", "display_name": "Maroun", "link": "https://stackoverflow.com/users/1735406/maroun"}, "edited": false, "score": 0, "creation_date": 1443032722, "post_id": 32746773, "comment_id": 53334374, "body": "These random digits are actually undefined behavior, and you&#39;re lucky you&#39;re only getting them.  Note that arrays are zero based, the indexes run from 0 to N-1 and not from 1 to N."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1443032770, "post_id": 32746773, "comment_id": 53334401, "body": "If the input is literally <code>1, 2, 3, 4, 5</code>, the <code>scanf</code> is never going to get past the first comma. You should always check the value returned by <code>scanf</code>. (Read the man page or other documentation to find out what that value means.)"}, {"owner": {"reputation": 23, "user_id": 1576448, "user_type": "registered", "profile_image": "https://graph.facebook.com/882026891893898/picture?type=large", "display_name": "Ajas Bakran", "link": "https://stackoverflow.com/users/1576448/ajas-bakran"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1443032903, "post_id": 32746773, "comment_id": 53334483, "body": "@KeithThompson no its not &quot;,&quot; i have just described so that it can be more readable"}, {"owner": {"reputation": 23, "user_id": 1576448, "user_type": "registered", "profile_image": "https://graph.facebook.com/882026891893898/picture?type=large", "display_name": "Ajas Bakran", "link": "https://stackoverflow.com/users/1576448/ajas-bakran"}, "reply_to_user": {"reputation": 86959, "user_id": 1735406, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/IF9uS.png?s=128&g=1", "display_name": "Maroun", "link": "https://stackoverflow.com/users/1735406/maroun"}, "edited": false, "score": 0, "creation_date": 1443033276, "post_id": 32746773, "comment_id": 53334702, "body": "@MarounMaroun you are right Maroun . but i have also tried other programs by using indexes from 0 to N and they worked too, but dont know whats the problem with this code"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1443033401, "post_id": 32746773, "comment_id": 53334759, "body": "@user1576448 The problem was clearly explained to you."}], "answers": [{"tags": [], "owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "is_accepted": true, "score": 3, "last_activity_date": 1443032810, "creation_date": 1443032810, "answer_id": 32746859, "question_id": 32746773, "link": "https://stackoverflow.com/questions/32746773/program-using-scanf-in-a-loop-prints-incorrect-output/32746859#32746859", "title": "Program using scanf in a loop prints incorrect output", "body": "<p>c uses <code>0 indexing</code> that means that array indexes start at 0 not 1. A for loop over an array should look like this:</p>\n\n<pre><code>int array[ARRAY_LENGTH], i;\nfor (i = 0; i &lt; ARRAY_LENGTH; ++i) {\n</code></pre>\n\n<p>This will ensure that <code>i</code> will go from <code>0</code> to <code>ARRAY_LENGTH - 1</code> and will not go outside the bounds of your array. </p>\n\n<p>These lines:</p>\n\n<pre><code>for(i=1; i&lt;=5; i++)\nprintf(\"%d\\n\", ii[i]);\n</code></pre>\n\n<p>will Access element <code>5</code> of <code>ii</code> where the maximum index is 4. This will cause <em>Undefined Behavior</em> which is likely why you are seeing random numbers appear. </p>\n"}], "owner": {"reputation": 23, "user_id": 1576448, "user_type": "registered", "profile_image": "https://graph.facebook.com/882026891893898/picture?type=large", "display_name": "Ajas Bakran", "link": "https://stackoverflow.com/users/1576448/ajas-bakran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 32746859, "answer_count": 1, "score": -1, "last_activity_date": 1443033947, "creation_date": 1443032509, "last_edit_date": 1443033947, "question_id": 32746773, "link": "https://stackoverflow.com/questions/32746773/program-using-scanf-in-a-loop-prints-incorrect-output", "title": "Program using scanf in a loop prints incorrect output", "body": "<p>I don't know what's happening with this code.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint main()\n   {\n   int ii[5], i;\n   for (i=1; i&lt;=5; i++)\n   {\n      scanf(\"%d\", &amp;ii[i]);\n   }\n   printf(\"----------------------\\n\");  \n   for(i=1; i&lt;=5; i++)\n   printf(\"%d\\n\", ii[i]);\n   return 0;\n   }\n</code></pre>\n\n<p>After compiling when I provide input as</p>\n\n<pre><code>1 2 3 4 5\n</code></pre>\n\n<p>then it prints as it is,\nbut when I provide input in reverse order:</p>\n\n<pre><code>5 4 3 2 1\n</code></pre>\n\n<p>it keeps on asking up to some more digits and after that it prints out some random digits from given set of input.</p>\n\n<p>How can I fix this?</p>\n"}, {"tags": ["c", "binaryfiles", "fread"], "comments": [{"owner": {"reputation": 15898, "user_id": 1155000, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b8213d9cd920e864ce8ff1fdeefe4db5?s=128&d=identicon&r=PG", "display_name": "Daniel Kamil Kozar", "link": "https://stackoverflow.com/users/1155000/daniel-kamil-kozar"}, "edited": false, "score": 5, "creation_date": 1443031694, "post_id": 32746532, "comment_id": 53333747, "body": "Try reading into an <code>unsigned char</code> instead. Values greater than or equal to <code>0x80</code> are sign-extended with <code>char</code> here."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 1, "creation_date": 1443032739, "post_id": 32746532, "comment_id": 53334383, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/8060170/printing-hexadecimal-characters-in-c\">Printing hexadecimal characters in C</a>"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1443032750, "post_id": 32746532, "comment_id": 53334389, "body": "there were already so many duplicates here"}, {"owner": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 0, "creation_date": 1443032800, "post_id": 32746532, "comment_id": 53334414, "body": "Every integer argument smaller than 4 bytes which is passed to function <code>printf</code> is expanded to 4 bytes. When a <code>signed char</code> argument is expanded to 4 bytes, each one of the 3 added bytes is 0xFF if the value is negative, and 0x00 if the value is non-negative. You can use <code>%.2X</code> if you want <code>printf</code> to avoid printing those 3 bytes. Alternatively, you can declare the argument as <code>unsigned char</code>."}], "answers": [{"comments": [{"owner": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 0, "creation_date": 1443033042, "post_id": 32746665, "comment_id": 53334556, "body": "Have you tried this code? I doubt that it would make any difference."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 2, "creation_date": 1443034083, "post_id": 32746665, "comment_id": 53335100, "body": "@barakmanos I tried. It worked. Here the integer promotion is happening when performing <code>&amp;</code>, so <code>0xFF</code> is expanded to <code>0x00..0FF</code>."}], "tags": [], "owner": {"reputation": 185, "user_id": 3784688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120785cdb10fe6639b0e149d93f4ca01?s=128&d=identicon&r=PG", "display_name": "MtCS", "link": "https://stackoverflow.com/users/3784688/mtcs"}, "is_accepted": false, "score": 2, "last_activity_date": 1443032049, "creation_date": 1443032049, "answer_id": 32746665, "question_id": 32746532, "link": "https://stackoverflow.com/questions/32746532/printing-in-hex-program-adds-additional-0xffs/32746665#32746665", "title": "Printing in HEX: program adds additional 0xFFs", "body": "<p>The FFs come from the negative bit (I know it %X is supposed to be unsigned). Try:</p>\n\n<pre><code>printf(\" %02X%02X\\n\", 0xFF &amp; opcode[0], 0xFF &amp; opcode[1]);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 59348, "user_id": 522663, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/OKOEw.png?s=128&g=1", "display_name": "Jonathan Wood", "link": "https://stackoverflow.com/users/522663/jonathan-wood"}, "is_accepted": false, "score": 3, "last_activity_date": 1443035214, "last_edit_date": 1443035214, "creation_date": 1443032243, "answer_id": 32746710, "question_id": 32746532, "link": "https://stackoverflow.com/questions/32746532/printing-in-hex-program-adds-additional-0xffs/32746710#32746710", "title": "Printing in HEX: program adds additional 0xFFs", "body": "<p><code>char</code> is normally a signed integer by default. So the high order bits are sign extended when it's widened to an <code>int</code> before being passed to <code>printf()</code>. Use <code>unsigned char</code> instead.</p>\n\n<p>You can also AND (<code>&amp;</code>) with <code>0xff</code> to strip off other bits but you really should be using an unsigned value here.</p>\n"}], "owner": {"reputation": 9832, "user_id": 2018084, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/44a1fa8aae7cbaea8f09afe47b8819bf?s=128&d=identicon&r=PG", "display_name": "Juicy", "link": "https://stackoverflow.com/users/2018084/juicy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1443035214, "creation_date": 1443031533, "question_id": 32746532, "link": "https://stackoverflow.com/questions/32746532/printing-in-hex-program-adds-additional-0xffs", "title": "Printing in HEX: program adds additional 0xFFs", "body": "<p>I'm trying to read a binary file two bytes at a time and display the result. I came up with the following:</p>\n\n<pre><code>int main() {\n    char opcode[2];\n    FILE *fp;\n\n    fp = fopen(\"games/PONG\", \"rb\");\n\n    while( fread(opcode, 1, 2, fp) != 0 ) {\n        printf(\" %02X%02X\\n\", opcode[0], opcode[1]);\n    }\n}\n</code></pre>\n\n<p>It sort of works:</p>\n\n<pre><code>$ ./c8disas\n 6A02\n 6B0C\n 6C3F\n 6D0C\n FFFFFFA2FFFFFFEA\n FFFFFFDAFFFFFFB6\n FFFFFFDCFFFFFFD6\n 6E00\n ...\n</code></pre>\n\n<p>Some of the lines in the output contain additional <code>FF</code> bytes, and I don't understand where they come from.</p>\n\n<p>For reference, this is the binary I'm reading:</p>\n\n<pre><code>$ hexdump -C games/PONG\n00000000  6a 02 6b 0c 6c 3f 6d 0c  a2 ea da b6 dc d6 6e 00  |j.k.l?m.......n.|\n00000010  22 d4 66 03 68 02 60 60  f0 15 f0 07 30 00 12 1a  |\".f.h.``....0...|\n00000020  c7 17 77 08 69 ff a2 f0  d6 71 a2 ea da b6 dc d6  |..w.i....q......|\n00000030  60 01 e0 a1 7b fe 60 04  e0 a1 7b 02 60 1f 8b 02  |`...{.`...{.`...|\n00000040  da b6 60 0c e0 a1 7d fe  60 0d e0 a1 7d 02 60 1f  |..`...}.`...}.`.|\n...\n</code></pre>\n"}, {"tags": ["c++", "c", "floating-point", "ieee-754", "bankers-rounding"], "comments": [{"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1443032009, "post_id": 32746523, "comment_id": 53333936, "body": "They are compliant with the standard, but do not implement all of it.  &quot;Round to nearest, ties away from zero&quot; is one of the IEEE-754 rounding modes."}, {"owner": {"reputation": 455, "user_id": 5245300, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/39803ad677ce87e41eca8640c3eed809?s=128&d=identicon&r=PG&f=1", "display_name": "68ejxfcj5669", "link": "https://stackoverflow.com/users/5245300/68ejxfcj5669"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 2, "creation_date": 1443032252, "post_id": 32746523, "comment_id": 53334082, "body": "IEEE-754 notes that the schoolbook rounding mode exists, but is only intended for decimal floats. <code>An implementation of this standard shall provide roundTiesToEven and the three directed rounding attributes. A decimal format implementation of this standard shall provide roundTiesToAway as a userselectable rounding-direction attribute. The rounding attribute roundTiesToAway is not required for a binary format implementation.</code> Rounding of ties to even is the only portable (and sensible) mode."}, {"owner": {"reputation": 19034, "user_id": 780717, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eead3a6ab011b880ca6ec354ca00f0b3?s=128&d=identicon&r=PG", "display_name": "njuffa", "link": "https://stackoverflow.com/users/780717/njuffa"}, "edited": false, "score": 4, "creation_date": 1443033137, "post_id": 32746523, "comment_id": 53334619, "body": "Instead of at <code>round()</code> look at <code>rint()</code> used with a default rounding mode of &quot;round to nearest or even&quot;."}, {"owner": {"reputation": 24610, "user_id": 270986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c49652c88a43a35bbf0095abfdae3515?s=128&d=identicon&r=PG", "display_name": "Mark Dickinson", "link": "https://stackoverflow.com/users/270986/mark-dickinson"}, "edited": false, "score": 0, "creation_date": 1443033192, "post_id": 32746523, "comment_id": 53334659, "body": "You might be interested in CPython&#39;s solution to this, <a href=\"https://github.com/python/cpython/blob/3.5/Objects/floatobject.c#L955-L958\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 455, "user_id": 5245300, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/39803ad677ce87e41eca8640c3eed809?s=128&d=identicon&r=PG&f=1", "display_name": "68ejxfcj5669", "link": "https://stackoverflow.com/users/5245300/68ejxfcj5669"}, "reply_to_user": {"reputation": 19034, "user_id": 780717, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eead3a6ab011b880ca6ec354ca00f0b3?s=128&d=identicon&r=PG", "display_name": "njuffa", "link": "https://stackoverflow.com/users/780717/njuffa"}, "edited": false, "score": 0, "creation_date": 1443035352, "post_id": 32746523, "comment_id": 53335860, "body": "@njuffa Thanks a lot for the pointer to <code>rint</code> (extremely unintuitive name). I had to double check the C standard, but it appears to indeed do the right thing when <code>__STDC_IEC_559__</code> is set. The real mystery is why <code>round</code> does something different from <code>rint</code> and <code>FE_TONEAREST</code>."}], "answers": [{"comments": [{"owner": {"reputation": 455, "user_id": 5245300, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/39803ad677ce87e41eca8640c3eed809?s=128&d=identicon&r=PG&f=1", "display_name": "68ejxfcj5669", "link": "https://stackoverflow.com/users/5245300/68ejxfcj5669"}, "edited": false, "score": 0, "creation_date": 1443032380, "post_id": 32746649, "comment_id": 53334163, "body": "Is it guaranteed that <code>(round(x) - x)</code> will return 0.5/-0.5 if the fractional component of x is exactly half, i.e. is this an exact operation?"}, {"owner": {"reputation": 24610, "user_id": 270986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c49652c88a43a35bbf0095abfdae3515?s=128&d=identicon&r=PG", "display_name": "Mark Dickinson", "link": "https://stackoverflow.com/users/270986/mark-dickinson"}, "edited": false, "score": 2, "creation_date": 1443032484, "post_id": 32746649, "comment_id": 53334237, "body": "Yes.  The result of <code>round(x) - x</code> will be exactly representable (assuming  an IEEE 754 format)."}, {"owner": {"reputation": 24610, "user_id": 270986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c49652c88a43a35bbf0095abfdae3515?s=128&d=identicon&r=PG", "display_name": "Mark Dickinson", "link": "https://stackoverflow.com/users/270986/mark-dickinson"}, "edited": false, "score": 2, "creation_date": 1443032653, "post_id": 32746649, "comment_id": 53334339, "body": "An evil trick is to use <code>2.0 * round(0.5 * x)</code> in the case where <code>fabs(x - round(x)) == 0.5</code>, which saves the somewhat messy task of figuring out whether <code>round(x)</code> is even or odd."}], "tags": [], "owner": {"reputation": 47569, "user_id": 3255455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5993e7ece129141878cd6419d39cc26e?s=128&d=identicon&r=PG&f=1", "display_name": "gnasher729", "link": "https://stackoverflow.com/users/3255455/gnasher729"}, "is_accepted": false, "score": 5, "last_activity_date": 1443032007, "creation_date": 1443032007, "answer_id": 32746649, "question_id": 32746523, "link": "https://stackoverflow.com/questions/32746523/ieee-754-compliant-round-half-to-even/32746649#32746649", "title": "IEEE-754 compliant round-half-to-even", "body": "<p>Round the number x, and if the difference between x and round (x) is exactly +0.5 or -0.5, and round (x) is odd, then round (x) was rounded in the wrong direction, so you subtract the difference from x. </p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 4, "last_activity_date": 1443070029, "last_edit_date": 1443070029, "creation_date": 1443051133, "answer_id": 32751115, "question_id": 32746523, "link": "https://stackoverflow.com/questions/32746523/ieee-754-compliant-round-half-to-even/32751115#32751115", "title": "IEEE-754 compliant round-half-to-even", "body": "<p>Use <code>remainder(double x, 1.0)</code> from the C standard library.  This is independent of the current rounding mode.</p>\n\n<blockquote>\n  <p>The remainder functions compute the remainder x REM y required by <a href=\"https://en.wikipedia.org/wiki/IEEE_floating_point\" rel=\"nofollow\">IEC 60559</a></p>\n</blockquote>\n\n<p><code>remainder()</code> is useful here as is meets OP's ties to even requirement.</p>\n\n<hr>\n\n<pre><code>double round_to_nearest_ties_to_even(double x) {\n  x -= remainder(x, 1.0);\n  return x;\n}\n</code></pre>\n\n<p>Test code</p>\n\n<pre><code>void rtest(double x) {\n  double round_half_to_even = round_to_nearest_ties_to_even(x);\n  printf(\"x:%25.17le   z:%25.17le \\n\", x, round_half_to_even);\n}\n\nvoid rtest3(double x) {\n  rtest(nextafter(x, -1.0/0.0));\n  rtest(x);\n  rtest(nextafter(x, +1.0/0.0));\n}\n\nint main(void) {\n  rtest3(-DBL_MAX);\n  rtest3(-2.0);\n  rtest3(-1.5);\n  rtest3(-1.0);\n  rtest3(-0.5);\n  rtest(nextafter(-0.0, -DBL_MAX));\n  rtest(-0.0);\n  rtest(0.0);\n  rtest(nextafter(0.0, +DBL_MAX));\n  rtest3(0.5);\n  rtest3(1.0);\n  rtest3(1.5);\n  rtest3(2.0);\n  rtest3(DBL_MAX);\n  rtest3(0.0/0.0);\n  return 0;\n}\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>x:                     -inf   z:                     -inf \nx:-1.79769313486231571e+308   z:-1.79769313486231571e+308 \nx:-1.79769313486231551e+308   z:-1.79769313486231551e+308 \nx: -2.00000000000000044e+00   z: -2.00000000000000000e+00 \nx: -2.00000000000000000e+00   z: -2.00000000000000000e+00 \nx: -1.99999999999999978e+00   z: -2.00000000000000000e+00 \nx: -1.50000000000000022e+00   z: -2.00000000000000000e+00 \nx: -1.50000000000000000e+00   z: -2.00000000000000000e+00 tie to even\nx: -1.49999999999999978e+00   z: -1.00000000000000000e+00 \nx: -1.00000000000000022e+00   z: -1.00000000000000000e+00 \nx: -1.00000000000000000e+00   z: -1.00000000000000000e+00 \nx: -9.99999999999999889e-01   z: -1.00000000000000000e+00 \nx: -5.00000000000000111e-01   z: -1.00000000000000000e+00 \nx: -5.00000000000000000e-01   z:  0.00000000000000000e+00 tie to even \nx: -4.99999999999999944e-01   z:  0.00000000000000000e+00 \nx:-4.94065645841246544e-324   z:  0.00000000000000000e+00 \nx: -0.00000000000000000e+00   z:  0.00000000000000000e+00 \nx:  0.00000000000000000e+00   z:  0.00000000000000000e+00 \nx: 4.94065645841246544e-324   z:  0.00000000000000000e+00 \nx:  4.99999999999999944e-01   z:  0.00000000000000000e+00 \nx:  5.00000000000000000e-01   z:  0.00000000000000000e+00 tie to even \nx:  5.00000000000000111e-01   z:  1.00000000000000000e+00 \nx:  9.99999999999999889e-01   z:  1.00000000000000000e+00 \nx:  1.00000000000000000e+00   z:  1.00000000000000000e+00 \nx:  1.00000000000000022e+00   z:  1.00000000000000000e+00 \nx:  1.49999999999999978e+00   z:  1.00000000000000000e+00 \nx:  1.50000000000000000e+00   z:  2.00000000000000000e+00 tie to even \nx:  1.50000000000000022e+00   z:  2.00000000000000000e+00 \nx:  1.99999999999999978e+00   z:  2.00000000000000000e+00 \nx:  2.00000000000000000e+00   z:  2.00000000000000000e+00 \nx:  2.00000000000000044e+00   z:  2.00000000000000000e+00 \nx: 1.79769313486231551e+308   z: 1.79769313486231551e+308 \nx: 1.79769313486231571e+308   z: 1.79769313486231571e+308 \nx:                      inf   z:                      inf \nx:                      nan   z:                      nan \nx:                      nan   z:                      nan \nx:                      nan   z:                      nan \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 455, "user_id": 5245300, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/39803ad677ce87e41eca8640c3eed809?s=128&d=identicon&r=PG&f=1", "display_name": "68ejxfcj5669", "link": "https://stackoverflow.com/users/5245300/68ejxfcj5669"}, "edited": false, "score": 0, "creation_date": 1443116680, "post_id": 32759457, "comment_id": 53374640, "body": "I agree that (int)(x + 0.5f) is wrong for many reasons. However, MSVC in particular detects this idiom and replaces it with cvtss2si, which I would guess is why it is commonly used."}, {"owner": {"reputation": 97003, "user_id": 142434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGcat.jpg?s=128&g=1", "display_name": "Stephen Canon", "link": "https://stackoverflow.com/users/142434/stephen-canon"}, "reply_to_user": {"reputation": 455, "user_id": 5245300, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/39803ad677ce87e41eca8640c3eed809?s=128&d=identicon&r=PG&f=1", "display_name": "68ejxfcj5669", "link": "https://stackoverflow.com/users/5245300/68ejxfcj5669"}, "edited": false, "score": 0, "creation_date": 1443117985, "post_id": 32759457, "comment_id": 53375285, "body": "@68ejxfcj5669: I doubt that&#39;s the case, but I would love to be proved wrong.  I don&#39;t have a windows machine to test on, and searching the web doesn&#39;t turn up any accounts of this transformation.  Do you have an actual example of a program where MSVC did that?"}], "tags": [], "owner": {"reputation": 97003, "user_id": 142434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGcat.jpg?s=128&g=1", "display_name": "Stephen Canon", "link": "https://stackoverflow.com/users/142434/stephen-canon"}, "is_accepted": false, "score": 5, "last_activity_date": 1443092692, "last_edit_date": 1443092692, "creation_date": 1443091752, "answer_id": 32759457, "question_id": 32746523, "link": "https://stackoverflow.com/questions/32746523/ieee-754-compliant-round-half-to-even/32759457#32759457", "title": "IEEE-754 compliant round-half-to-even", "body": "<blockquote>\n  <p>The C standard library provides the <code>round</code>, <code>lround</code>, and <code>llround</code> family of functions in C99. However, these functions are not IEEE-754 compliant, because they do not implement the \"banker's rounding\" of half-to-even as mandated by IEEE...</p>\n</blockquote>\n\n<p>It doesn't make sense to talk about whether or not an individual function is \"IEEE-754 compliant\".  IEEE-754 compliance requires that a set of data types operations with defined semantics be available.  It does not require that those types or operations have specific names, nor does it require that <em>only</em> those operations be available.  An implementation can provide whatever additional functions it wants and still be compliant.  If an implementation wants to provide round-to-odd, round-random, round-away-from-zero, and trap-if-inexact, it can do so.</p>\n\n<p>What IEEE-754 actually requires for rounding is that the following six operations <em>are</em> provided:</p>\n\n<blockquote>\n  <p><strong>convertToIntegerTiesToEven</strong>(x)</p>\n  \n  <p><strong>convertToIntegerTowardZero</strong>(x)</p>\n  \n  <p><strong>convertToIntegerTowardPositive</strong>(x)</p>\n  \n  <p><strong>convertToIntegerTowardNegative</strong>(x)</p>\n  \n  <p><strong>convertToIntegerTiesToAway</strong>(x)</p>\n  \n  <p><strong>convertToIntegerExact</strong>(x)</p>\n</blockquote>\n\n<p>In C and C++, the last five of these operations are bound to the <code>trunc</code>, <code>ceil</code>, <code>floor</code>, <code>round</code>, and <code>rint</code> functions, respectively.  C11 and C++14 do not have a binding for the first, but future revisions will use <code>roundeven</code>.  As you can see, <code>round</code> actually is one of the required operations.</p>\n\n<p>However, <code>roundeven</code> is not available in current implementations, which brings us to the next part of your question:</p>\n\n<blockquote>\n  <p>The usual ad-hoc way to implement rounding in C is the expression <code>(int)(x + 0.5f)</code> which, despite being incorrect in strict IEEE-754 math, is usually translated by compilers into the correct <code>cvtss2si</code> instruction. However, this is certainly not a portable assumption.</p>\n</blockquote>\n\n<p>The problems with that expression extend well-beyond \"strict IEEE-754 math\".  It's totally incorrect for negative <code>x</code>, gives the wrong answer for <code>nextDown(0.5)</code>, and turns all odd integers in the 2**23 binade into even integers.  Any compiler that translates it into <code>cvtss2si</code> is horribly, horribly broken.  If you have an example of that happening, I would love to see it.</p>\n\n<blockquote>\n  <p>How can I implement a function that will round any floating point value with half-to-even semantics?</p>\n</blockquote>\n\n<p>As <strong>njuffa</strong> noted in a comment, you can ensure that the default rounding mode is set and use <code>rint</code> (or <code>lrint</code>, as it sounds like you actually want an integer result), or you can implement your own rounding function by calling <code>round</code> and then fixing up halfway cases like <strong>gnasher729</strong> suggests.  Once the n1778 bindings for C are adopted, you'll be able to use the <code>roundeven</code> or <code>fromfp</code> functions to do this operation without needing to control the rounding mode.</p>\n"}, {"tags": [], "owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "is_accepted": false, "score": 1, "last_activity_date": 1443221081, "creation_date": 1443221081, "answer_id": 32791681, "question_id": 32746523, "link": "https://stackoverflow.com/questions/32746523/ieee-754-compliant-round-half-to-even/32791681#32791681", "title": "IEEE-754 compliant round-half-to-even", "body": "<p>The <code>float</code> data type can represent all whole numbers, but no fractions, within the range 8388608.0f to 16777216.0f.  Any <code>float</code> numbers which are larger than 8388607.5f are whole numbers, and no rounding will be necessary.  Adding 8388608.0f to any non-negative <code>float</code> which is smaller than that will yield a whole number which will be rounded according to the current rounding mode (typically round-half-to-even).  Subtracting 8388608.0f will then yield a properly-rounded version of the original (assuming it was in a suitable range).</p>\n\n<p>Thus, it should be possible to do something like:</p>\n\n<pre><code>float round(float f)\n{\n  if (!(f &gt; -8388608.0f &amp;&amp; f &lt; 8388608.0f)) // Return true for NaN\n    return f;\n  else if (f &gt; 0)\n    return (float)(f+8388608.0f)-8388608.0f;\n  else\n    return (float)(f-8388608.0f)+8388608.0f;\n}\n</code></pre>\n\n<p>and take advantage of the natural rounding behavior of addition, without having to use any other \"round-to-integer\" facility.</p>\n"}, {"comments": [{"owner": {"reputation": 24610, "user_id": 270986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c49652c88a43a35bbf0095abfdae3515?s=128&d=identicon&r=PG", "display_name": "Mark Dickinson", "link": "https://stackoverflow.com/users/270986/mark-dickinson"}, "edited": false, "score": 1, "creation_date": 1514019038, "post_id": 47950887, "comment_id": 82871681, "body": "If 2.500001 rounds to 2 instead of 3, then this isn&#39;t a standards-conforming round."}, {"owner": {"reputation": 1101, "user_id": 7870957, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/jG6LK.jpg?s=128&g=1", "display_name": "Shivansh Jagga", "link": "https://stackoverflow.com/users/7870957/shivansh-jagga"}, "reply_to_user": {"reputation": 24610, "user_id": 270986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c49652c88a43a35bbf0095abfdae3515?s=128&d=identicon&r=PG", "display_name": "Mark Dickinson", "link": "https://stackoverflow.com/users/270986/mark-dickinson"}, "edited": false, "score": 0, "creation_date": 1514019317, "post_id": 47950887, "comment_id": 82871719, "body": "The program is written for someone who wants this implemented in their own code. The error can be changed to any precision point needed in the code,i.e, it can even be the smallest float value possible.  <code>error = sys.float_info.min</code> (for Python) , and a smiliar equivalent for C++"}, {"owner": {"reputation": 24610, "user_id": 270986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c49652c88a43a35bbf0095abfdae3515?s=128&d=identicon&r=PG", "display_name": "Mark Dickinson", "link": "https://stackoverflow.com/users/270986/mark-dickinson"}, "edited": false, "score": 0, "creation_date": 1514020479, "post_id": 47950887, "comment_id": 82871952, "body": "Okay, but it doesn&#39;t answer the question: the OP is looking for an IEEE 754-compliant rounding operation. The code in this answer doesn&#39;t give that. And using <code>error = sys.float_info.min</code> isn&#39;t a solution. If you test your code, you&#39;ll find that even the current code doesn&#39;t give <code>4</code> from an input of <code>3.5</code>; it gives <code>3</code>."}], "tags": [], "owner": {"reputation": 1101, "user_id": 7870957, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/jG6LK.jpg?s=128&g=1", "display_name": "Shivansh Jagga", "link": "https://stackoverflow.com/users/7870957/shivansh-jagga"}, "is_accepted": false, "score": 1, "last_activity_date": 1514019565, "last_edit_date": 1592644375, "creation_date": 1514016435, "answer_id": 47950887, "question_id": 32746523, "link": "https://stackoverflow.com/questions/32746523/ieee-754-compliant-round-half-to-even/47950887#47950887", "title": "IEEE-754 compliant round-half-to-even", "body": "<p>The following is a simple implementation of <strong>round-half to even</strong> program which follows the IEEE standard of rounding.</p>\n<blockquote>\n<p><strong>Logic :</strong>\nerror = 0.00001</p>\n<ol>\n<li>number=2.5</li>\n<li>temp = floor(2.5)%2 = 2%2 = 0</li>\n<li><strong>x</strong> = -1 + temp = -1</li>\n<li>x*error + number = 2.40009</li>\n<li>round(2.40009) = 2</li>\n</ol>\n<p><strong>Note:</strong> The error here is of  0.00001, i.e, if 2.500001 occurs, then it will round off to 2 instead of 3</p>\n</blockquote>\n<p><strong>Python 2.7 implementation:</strong></p>\n<pre><code>temp = (number)     \nrounded_number = int( round(-1+ temp%2)*0.00001 + temp )\n</code></pre>\n<p><strong>C++ implementation:</strong> (Use <em>math.h</em> for floor function)</p>\n<pre><code>float temp = (number)     \nint rounded_number = (int)( (-1+ temp%2)*0.00001 + temp + 0.5)\n</code></pre>\n<p>The output this would give would be as follows acc. to standards :</p>\n<blockquote>\n<p>(3.5) -&gt; 4</p>\n<p>(2.5) -&gt; 2</p>\n</blockquote>\n<hr />\n<p><strong>Edit 1 :</strong> As pointed out by @Mark Dickinson in the comments. The error can be modified as required in your code to standardize it. For python, to turn it into the smallest float value possible , you may do the following.</p>\n<pre><code>import sys\nerror = sys.float_info.min\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4108, "user_id": 1435420, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d13273e7c2c92c5d6e3bb6291854d3e7?s=128&d=identicon&r=PG", "display_name": "David G", "link": "https://stackoverflow.com/users/1435420/david-g"}, "is_accepted": false, "score": 2, "last_activity_date": 1563220100, "creation_date": 1563220100, "answer_id": 57046307, "question_id": 32746523, "link": "https://stackoverflow.com/questions/32746523/ieee-754-compliant-round-half-to-even/57046307#57046307", "title": "IEEE-754 compliant round-half-to-even", "body": "<p>Since C++11, there has a been a function in the STL that does half-even rounding. If the floating-point rounding mode is set to <code>FE_TONEAREST</code> (the default), then <code>std::nearbyint</code> will do the trick.</p>\n\n<p><a href=\"https://en.cppreference.com/w/cpp/numeric/math/nearbyint\" rel=\"nofollow noreferrer\">C++ Reference for std::nearbyint</a></p>\n"}], "owner": {"reputation": 455, "user_id": 5245300, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/39803ad677ce87e41eca8640c3eed809?s=128&d=identicon&r=PG&f=1", "display_name": "68ejxfcj5669", "link": "https://stackoverflow.com/users/5245300/68ejxfcj5669"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3605, "favorite_count": 2, "answer_count": 6, "score": 7, "last_activity_date": 1563220100, "creation_date": 1443031505, "last_edit_date": 1518664021, "question_id": 32746523, "link": "https://stackoverflow.com/questions/32746523/ieee-754-compliant-round-half-to-even", "title": "IEEE-754 compliant round-half-to-even", "body": "<p>The C standard library provides the <code>round</code>, <code>lround</code>, and <code>llround</code> family of functions in C99. However, these functions are not IEEE-754 compliant, because they do not implement the \"banker's rounding\" of half-to-even as mandated by IEEE. Half-to-even rounding requires the result to be rounded to the nearest even value if the fractional component is exactly 0.5. The C99 standard instead mandates half-away-from-zero as noted on <a href=\"http://en.cppreference.com/w/c/numeric/math/round\" rel=\"noreferrer\">cppreference.com</a></p>\n\n<blockquote>\n  <p>1-3) Computes the nearest integer value to arg (in floating-point format), rounding halfway cases away from zero, regardless of the current rounding mode.</p>\n</blockquote>\n\n<p>The usual ad-hoc way to implement rounding in C is the expression <code>(int)(x + 0.5f)</code> which, despite being <a href=\"http://blog.frama-c.com/index.php?post/2013/05/02/nearbyintf1\" rel=\"noreferrer\">incorrect</a> in strict IEEE-754 math, is usually translated by compilers into the correct <code>cvtss2si</code> instruction. However, this is certainly not a portable assumption.</p>\n\n<p>How can I implement a function that will round any floating point value with half-to-even semantics? If possible, the function should only rely upon language and standard library semantic, so that it can operate on non-IEEE floating point types. If this is not possible, an answer defined in terms of IEEE-754 bit representations is also acceptable. Please characterize any constants in terms of <code>&lt;limits.h&gt;</code> or <code>&lt;limits&gt;</code>.</p>\n"}, {"tags": ["c", "arrays", "comma"], "comments": [{"owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "edited": false, "score": 3, "creation_date": 1443030457, "post_id": 32746186, "comment_id": 53333017, "body": "What is your question?"}, {"owner": {"reputation": 4709, "user_id": 2001149, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SqsJM.png?s=128&g=1", "display_name": "Santosh A", "link": "https://stackoverflow.com/users/2001149/santosh-a"}, "edited": false, "score": 0, "creation_date": 1443030624, "post_id": 32746186, "comment_id": 53333124, "body": "Show us what you have tried?"}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 1934439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eba20a16b3c0838d428c2f704cd972fb?s=128&d=identicon&r=PG", "display_name": "user1934439", "link": "https://stackoverflow.com/users/1934439/user1934439"}, "edited": false, "score": 0, "creation_date": 1443031836, "post_id": 32746347, "comment_id": 53333815, "body": "thank you for the answer. But in my program i want to allow only comma in between the inputs.so its required to store the comma in array so that we can put some condition like a[1]=&#39;,&#39; and terminate the program if its not"}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "reply_to_user": {"reputation": 61, "user_id": 1934439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eba20a16b3c0838d428c2f704cd972fb?s=128&d=identicon&r=PG", "display_name": "user1934439", "link": "https://stackoverflow.com/users/1934439/user1934439"}, "edited": false, "score": 0, "creation_date": 1443032176, "post_id": 32746347, "comment_id": 53334044, "body": "@user1934439 - so your array will need to store strings, not numeric values, in that case (that, or a union of an <code>int</code> and a <code>char</code>, with a tag) - is that acceptable for your purposes?"}, {"owner": {"reputation": 5694, "user_id": 1552737, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YfC6P.jpg?s=128&g=1", "display_name": "IKavanagh", "link": "https://stackoverflow.com/users/1552737/ikavanagh"}, "reply_to_user": {"reputation": 61, "user_id": 1934439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eba20a16b3c0838d428c2f704cd972fb?s=128&d=identicon&r=PG", "display_name": "user1934439", "link": "https://stackoverflow.com/users/1934439/user1934439"}, "edited": false, "score": 0, "creation_date": 1443032990, "post_id": 32746347, "comment_id": 53334523, "body": "@user1934439 That&#39;s not specified in your question and presents a completely different problem."}, {"owner": {"reputation": 61, "user_id": 1934439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eba20a16b3c0838d428c2f704cd972fb?s=128&d=identicon&r=PG", "display_name": "user1934439", "link": "https://stackoverflow.com/users/1934439/user1934439"}, "edited": false, "score": 0, "creation_date": 1443032991, "post_id": 32746347, "comment_id": 53334525, "body": "yes no problem. my requirement is array must be only of length 7 in which a[0] a[2] a[4] a[6] must be only numbers and a[1] a[3] a[5] must be only comma."}, {"owner": {"reputation": 61, "user_id": 1934439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eba20a16b3c0838d428c2f704cd972fb?s=128&d=identicon&r=PG", "display_name": "user1934439", "link": "https://stackoverflow.com/users/1934439/user1934439"}, "edited": false, "score": 0, "creation_date": 1443033263, "post_id": 32746347, "comment_id": 53334696, "body": "@IKavanagh i dont have much knowledge in c programming. i studied long ago in my bachelors. can you put whole code of my requirement if possible"}], "tags": [], "owner": {"reputation": 5694, "user_id": 1552737, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YfC6P.jpg?s=128&g=1", "display_name": "IKavanagh", "link": "https://stackoverflow.com/users/1552737/ikavanagh"}, "is_accepted": false, "score": 2, "last_activity_date": 1531086153, "last_edit_date": 1531086153, "creation_date": 1443030916, "answer_id": 32746347, "question_id": 32746186, "link": "https://stackoverflow.com/questions/32746186/c-reading-multiple-numbers-from-single-input-line/32746347#32746347", "title": "C, reading multiple numbers from single input line", "body": "<p>There is no need to store the <code>,</code>. Use something similar to</p>\n\n<pre><code>int a[4];\nscanf(\"%d,%d,%d,%d\", &amp;a[0], &amp;a[1], &amp;a[2], &amp;a[3]);\n</code></pre>\n\n<p>If you need to put the commas back for printing later you can use</p>\n\n<pre><code>printf(\"%d,%d,%d,%d\", a[0], a[1], a[2], a[3]);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": true, "score": 1, "last_activity_date": 1443038837, "last_edit_date": 1443038837, "creation_date": 1443035694, "answer_id": 32747715, "question_id": 32746186, "link": "https://stackoverflow.com/questions/32746186/c-reading-multiple-numbers-from-single-input-line/32747715#32747715", "title": "C, reading multiple numbers from single input line", "body": "<p><strong><em>Edit</em></strong>:  There are actually <em>several</em> ways to do what you are asking: array of struct (may contain several data types), array of struct with union (allows run-time selection of data type), string array (requires converting numeric values)</p>\n\n<p><strike>The only way to <em>literally</em> construct an array to hold both numeric and string variable types is to use a <code>union</code>.</strike>  Clearly (and normally) there are much better ways to handle strings of alphanumeric data, but since unions were mentioned in the comments under your question, I will use that method to address your very specific request:  </p>\n\n<p>Results of following example:<br>\n<a href=\"https://i.stack.imgur.com/QAyE6.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QAyE6.jpg\" alt=\"enter image description here\"></a> </p>\n\n<p>Code example: </p>\n\n<pre><code>typedef union   {\n    int num;      //member to contain numerics\n    char str[4];  //member to contain string (\",,,\")\n}MIX;\ntypedef struct  {\n    BOOL type;//type tag:  1 for char , 0 for number\n    MIX c;\n}ELEMENT;\n\nELEMENT element[7], *pElement;//instance of array 7 of ELEMENT and pointer to same\n\nvoid assignValues(ELEMENT *e);\n\nint main(void)\n{\n    char buf[80];//buffer for printing out demonstration results\n    buf[0]=0;\n    int i;\n\n    pElement = &amp;element[0];//initialize pointer to beginning of struct element\n\n    //assign values to array:\n    assignValues(pElement);\n\n    for(i=0;i&lt;sizeof(element)/sizeof(element[0]);i++)\n    {\n        if(pElement[i].type == 1)\n        {   //if union member is a string, concatenate it to buffer\n            strcpy(element[i].c.str, pElement[i].c.str);\n            strcat(buf,pElement[i].c.str); \n        }\n        else\n        {   //if union member is numeric, convert and concatenate it to buffer\n            sprintf(buf, \"%s%d\",buf, pElement[i].c.num); \n        }\n    }\n    printf(buf);\n\n    getchar();\n\n    return 0;   \n}\n\n//hardcoded to illustrate your exact numbers\n// 5,,,60,,,700,,,8000\nvoid assignValues(ELEMENT *e)\n{\n    e[0].type = 0; //fill with 5\n    e[0].c.num = 5;\n\n    e[1].type = 1; //fill with \",,,\"\n    strcpy(e[1].c.str, \",,,\");\n\n    e[2].type = 0; //fill with 60\n    e[2].c.num = 60;\n\n    e[3].type = 1; //fill with \",,,\"\n    strcpy(e[3].c.str, \",,,\");\n\n    e[4].type = 0; //fill with 700\n    e[4].c.num = 700;\n\n    e[5].type = 1;  //fill with \",,,\"\n    strcpy(e[5].c.str, \",,,\");\n\n    e[6].type = 0; //fill with 8000\n    e[6].c.num = 8000;\n}\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 1934439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eba20a16b3c0838d428c2f704cd972fb?s=128&d=identicon&r=PG", "display_name": "user1934439", "link": "https://stackoverflow.com/users/1934439/user1934439"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 609, "favorite_count": 0, "accepted_answer_id": 32747715, "answer_count": 2, "score": -2, "last_activity_date": 1531086153, "creation_date": 1443030401, "last_edit_date": 1443030652, "question_id": 32746186, "link": "https://stackoverflow.com/questions/32746186/c-reading-multiple-numbers-from-single-input-line", "title": "C, reading multiple numbers from single input line", "body": "<p>I need to create a c program that handles many cases.</p>\n\n<p>In order to solve all the cases easily i need to take all the input elements in one line separated by a comma.</p>\n\n<p>for example user given input like this </p>\n\n<pre><code>5,60,700,8000\n</code></pre>\n\n<p>should create an array like this <code>{5,,,60,,,700,,,8000}</code>\nwhich means array is of size 7 and a[1],a[3],a[5] value is comma ,</p>\n\n<p>thank you</p>\n"}, {"tags": ["c", "binaryfiles", "fread"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1443029672, "post_id": 32745903, "comment_id": 53332567, "body": "What is your input? Who is guaranteeing the <code>instr</code> will be null-terminated?"}], "answers": [{"tags": [], "owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "is_accepted": true, "score": 4, "last_activity_date": 1443029666, "creation_date": 1443029666, "answer_id": 32745960, "question_id": 32745903, "link": "https://stackoverflow.com/questions/32745903/fread-unexpected-behaviour-when-reading-n-bytes/32745960#32745960", "title": "fread unexpected behaviour when reading N bytes", "body": "<p><code>strlen</code> requires a pointer to a string as parameter but <code>fread</code> does not null terminate its buffer. Use the accumulated <code>fread</code> return value to get the size read.</p>\n\n<p>Moreover use <code>%zu</code> conversion specification to print a <code>size_t</code> value (the type of the value returned by <code>strlen</code>). <code>%tu</code> is used for <code>ptrdiff_t</code> type.</p>\n"}, {"tags": [], "owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "is_accepted": false, "score": 1, "last_activity_date": 1443030369, "last_edit_date": 1443030369, "creation_date": 1443029917, "answer_id": 32746029, "question_id": 32745903, "link": "https://stackoverflow.com/questions/32745903/fread-unexpected-behaviour-when-reading-n-bytes/32746029#32746029", "title": "fread unexpected behaviour when reading N bytes", "body": "<p><code>fread</code> does not add the <code>NUL</code> character (<code>'\\0'</code>) at the end of your array. What you have is not a string .</p>\n\n<p>And <code>strlen</code> requires an argument as string, the length of a string is determined by the terminating <code>NUL</code> character. Therefore such behaviour.</p>\n\n<p>You can manually add a <code>NUL</code> character in your array to make it a string.</p>\n\n<p>Also <code>strlen</code> returns a length of type <code>size_t</code>, so use the <code>%zu</code> specifier to print it.</p>\n"}], "owner": {"reputation": 9832, "user_id": 2018084, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/44a1fa8aae7cbaea8f09afe47b8819bf?s=128&d=identicon&r=PG", "display_name": "Juicy", "link": "https://stackoverflow.com/users/2018084/juicy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 294, "favorite_count": 0, "accepted_answer_id": 32745960, "answer_count": 2, "score": 0, "last_activity_date": 1443030369, "creation_date": 1443029495, "question_id": 32745903, "link": "https://stackoverflow.com/questions/32745903/fread-unexpected-behaviour-when-reading-n-bytes", "title": "fread unexpected behaviour when reading N bytes", "body": "<p>I'm trying to read a binary file four bytes at a time. I came up with this code which produces the expected output:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main() {\n    char instr[4];\n    FILE *fp;\n\n    fp = fopen(\"tests\", \"rb\");\n\n    while( fread(instr, 1, 4, fp) != 0 ) {\n        printf(\"%td\", strlen(instr));\n    }\n\n    printf(\"\\n\");\n}\n</code></pre>\n\n<p><strong>Output</strong></p>\n\n<pre><code>$ ./bin_files\n44444\n</code></pre>\n\n<p>This modified version on the other hand produces an output I can't explain:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main() {\n    int i = 10;\n    char instr[4];\n    FILE *fp;\n\n    fp = fopen(\"tests\", \"rb\");\n\n    printf(\"%d\\n\", i);\n\n    while( fread(instr, 1, 4, fp) != 0 ) {\n        printf(\"%td\", strlen(instr));\n    }\n\n    printf(\"\\n\");\n}\n</code></pre>\n\n<p><strong>Output</strong></p>\n\n<pre><code>$ ./bin_files\n10\n55555\n</code></pre>\n\n<p>Why is it now reading 5 bytes at a time?</p>\n\n<p>NB: I'm on a Macbook which is why I'm using <code>%td</code> instead of <code>%d</code> like my tutorial for printing the string length.</p>\n"}, {"tags": ["c", "printf", "user-input", "scanf", "fopen"], "comments": [{"owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "edited": false, "score": 5, "creation_date": 1443029301, "post_id": 32745775, "comment_id": 53332364, "body": "<code>filename</code> mus be declared as an array not as a single character: <code>char filename[sometingLongEnough];</code> and then it must be <code>scanf( &quot;%s\\n&quot;, filename );</code>"}, {"owner": {"reputation": 7792, "user_id": 249237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QjPtI.png?s=128&g=1", "display_name": "Kninnug", "link": "https://stackoverflow.com/users/249237/kninnug"}, "edited": false, "score": 2, "creation_date": 1443029304, "post_id": 32745775, "comment_id": 53332368, "body": "What exactly is your question? Is it not working (state what you got and what you expected)? Is there an error (then specify the error message)."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1443029741, "post_id": 32745775, "comment_id": 53332604, "body": "regarding the line:  <code>scanf(&quot;%s\\n&quot;, &amp;filename);</code>   1) as stated elsewhere, filename must be an array of char, not a single char.  2) In C, an array name degrades to the address of the array.   3) the number of chars the user can input must be limited to 1 less than the length of the array. (if char filename[20] then limit user to 19 char (<code>scanf</code> appends a NUL char to string) )   4) always check the returned value (not the parameter value) to assure operation successful.  Suggest: <code>char filename[20]; if( 1 != scanf( &quot; %19s&quot;, filename ) ) { &#47;&#47;handle error }</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1443030708, "post_id": 32745775, "comment_id": 53333173, "body": "Matching my comment to ameyCU&#39;s answer: <code>printf(&quot;Unable to open the file.\\n&quot;);</code> should better be <code>puts(&quot;Unable to open the file.&quot;);</code> or <code>fputs(&quot;Unable to open the file.\\n&quot;, stdout);</code>. General rule of thumb: if there is no actual formatting/conversions to do, don&#39;t use <code>printf()</code>/<code>scanf()</code>"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1443030454, "post_id": 32745898, "comment_id": 53333014, "body": "Just a hint to the OP -- <code>scanf()</code> is for formatted input (and it&#39;s kind of a beast, but, nevermind this now) -- if all you want to do is to read a line of text from standard input, better use <code>if (fgets(filename, 19, stdin))</code>. (Not criticizing the answer here, it&#39;s good it is close to the original code)"}, {"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 0, "creation_date": 1443068774, "post_id": 32745898, "comment_id": 53346814, "body": "@FelixPalmen  Yes I agree on that part . And <code>fgets</code> should really be used here . Thanks for your response and always welcome to give your opinions :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1443073628, "post_id": 32745898, "comment_id": 53348353, "body": "and still I got it wrong, so if OP still cares to read: should be <code>if (fgets(filename, 20, stdin))</code>  because <code>fgets</code> wants the size of the buffer and already cares for the byte needed for termination."}], "tags": [], "owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "is_accepted": false, "score": 1, "last_activity_date": 1443068871, "last_edit_date": 1443068871, "creation_date": 1443029478, "answer_id": 32745898, "question_id": 32745775, "link": "https://stackoverflow.com/questions/32745775/user-input-to-read-file-and-test-that-its-worked-in-c/32745898#32745898", "title": "User input to read file and test that its worked? In C", "body": "<pre><code>char filename;\n...\nscanf(\"%s\\n\", &amp;filename);   // Not large enough to store file's name\n</code></pre>\n\n<p>File name will be a string so you need a <code>char array</code> or <code>char pointer</code> -</p>\n\n<pre><code>char filename[20];           // char pointer will also work with memory allocation\nif(scanf(\"%19s\\n\",filename)!=1){   \n //  error message\n }\n</code></pre>\n\n<p>Or prefer <code>fgets</code> instead of it as suggest by @Felix Palmen in comment -</p>\n\n<pre><code>if(fgets(filename,20,stdin)){\n  //your code\n  } \n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5368852, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153671335692372/picture?type=large", "display_name": "Jessica Rose Barnes", "link": "https://stackoverflow.com/users/5368852/jessica-rose-barnes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1443068871, "creation_date": 1443029090, "last_edit_date": 1443029238, "question_id": 32745775, "link": "https://stackoverflow.com/questions/32745775/user-input-to-read-file-and-test-that-its-worked-in-c", "title": "User input to read file and test that its worked? In C", "body": "<p>So I'm probably being really stupid and missing something super obvious but I'm new to coding so I'm not quite sure howto do this. I would like the user to input a file name and an error message to be displayed if unsuccessful. This is what I have so far:</p>\n\n<pre><code>char filename;\n//declares variable for input.\n\nprintf(\"Please input the file name.\\n\");\n//asks user to input the name of file.\n\nscanf(\"%s\\n\", &amp;filename);\n//allows user to input file name.\n\nFILE*b= fopen(filename, \"r\");\n//opens the file for reading.\n\nif(!b){\n\n    printf(\"Unable to open the file.\\n\");\n}\n//if unable to open the file an error message should be displayed.\n</code></pre>\n\n<p>any help would be greatly appreciated! Thanks!</p>\n"}, {"tags": ["c", "printf"], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 5368792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a43933a53e4f30e824d4f3752e9ccd4?s=128&d=identicon&r=PG&f=1", "display_name": "thmiller", "link": "https://stackoverflow.com/users/5368792/thmiller"}, "edited": false, "score": 0, "creation_date": 1443032454, "post_id": 32745608, "comment_id": 53334211, "body": "That was it. The inttypes reference I was looking at only had PRIx macros up to 32 bits for some reason."}, {"owner": {"reputation": 1775, "user_id": 3715151, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/8gMtb.png?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/3715151/daniel"}, "edited": false, "score": 1, "creation_date": 1557671042, "post_id": 32745608, "comment_id": 98835154, "body": "<code>printf(&quot;answer = %#018&quot;PRIx64&quot;\\n&quot;, val)</code> to print leading zeros"}], "tags": [], "owner": {"reputation": 19889, "user_id": 906839, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bce6d276ec5c9b7b97804d0add55084?s=128&d=identicon&r=PG", "display_name": "Brett Hale", "link": "https://stackoverflow.com/users/906839/brett-hale"}, "is_accepted": true, "score": 9, "last_activity_date": 1443028814, "last_edit_date": 1443028814, "creation_date": 1443028492, "answer_id": 32745608, "question_id": 32745557, "link": "https://stackoverflow.com/questions/32745557/portable-printf-format-specifier-for-64-bit-hexadecimal/32745608#32745608", "title": "Portable printf format specifier for 64 bit hexadecimal?", "body": "<p>The <code>PRIx64</code> macro in <a href=\"http://en.cppreference.com/w/c/types/integer\" rel=\"noreferrer\"><code>&lt;inttypes.h&gt;</code></a> is what you're looking for.</p>\n\n<p>It's a string token, so you can use it as:\n<code>fprintf(stdout, \"answer = %\"PRIx64\"\\n\", val);</code></p>\n\n<p>Since you specify <code>%llX</code>, you probably want uppercase; use: <code>PRIX64</code></p>\n"}, {"tags": [], "owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "is_accepted": false, "score": 1, "last_activity_date": 1443029078, "last_edit_date": 1443029078, "creation_date": 1443028541, "answer_id": 32745624, "question_id": 32745557, "link": "https://stackoverflow.com/questions/32745557/portable-printf-format-specifier-for-64-bit-hexadecimal/32745624#32745624", "title": "Portable printf format specifier for 64 bit hexadecimal?", "body": "<p>You can use macros <code>PRIx64</code> or <code>PRIX64 (for  unsigned uppercase hexadecimal integer )</code> defined in header <code>&lt;inttypes.h&gt;</code>.</p>\n"}], "owner": {"reputation": 101, "user_id": 5368792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a43933a53e4f30e824d4f3752e9ccd4?s=128&d=identicon&r=PG&f=1", "display_name": "thmiller", "link": "https://stackoverflow.com/users/5368792/thmiller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4790, "favorite_count": 0, "closed_date": 1443032380, "accepted_answer_id": 32745608, "answer_count": 2, "score": 9, "last_activity_date": 1443029078, "creation_date": 1443028291, "question_id": 32745557, "link": "https://stackoverflow.com/questions/32745557/portable-printf-format-specifier-for-64-bit-hexadecimal", "closed_reason": "Duplicate", "title": "Portable printf format specifier for 64 bit hexadecimal?", "body": "<p>What printf format specifier can I use to print a 64 bit unsigned integer in hexadecimal notation across 32/64 bit and Windows/POSIX? The closest I've seen is <code>%llX</code> but I'm not sure that is portable enough. Answers that ignore older compilers (e.g. Visual Studio 2010) are acceptable.</p>\n"}, {"tags": ["c", "while-loop", "infinite-loop"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1443027997, "post_id": 32745406, "comment_id": 53331730, "body": "clear input buffer when invalid input."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 1, "creation_date": 1443028255, "post_id": 32745406, "comment_id": 53331847, "body": "When you scan an integer with <code>scanf(&quot;%d&quot;, &amp;value)</code> and the input isn&#39;t a valid integer, <code>scanf</code> returns 0 and the input goes back to where it started, i.e. before the non-numeric input. Subsequent calls will then try to re-parse the same invalid input over and over. You should <code>scanf(&quot;%*s&quot;)</code> to skip it. Better yet, read whole lines with <code>fgets</code> and <code>sscanf</code> into them."}, {"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 0, "creation_date": 1443028335, "post_id": 32745406, "comment_id": 53331882, "body": "I don&#39;t understand why would use input <code>-9876</code> ?"}, {"owner": {"reputation": 3237, "user_id": 4626788, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-d5Ate3B4CBg/AAAAAAAAAAI/AAAAAAAACGo/9xaOH3aF-y8/photo.jpg?sz=128", "display_name": "Neeraj Kumar", "link": "https://stackoverflow.com/users/4626788/neeraj-kumar"}, "edited": false, "score": 0, "creation_date": 1443030033, "post_id": 32745406, "comment_id": 53332768, "body": "you are using space between %d %c %d in scanf function..that assign garbage value into among &amp;n1, &amp;op, &amp;n2 variables"}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "reply_to_user": {"reputation": 3237, "user_id": 4626788, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-d5Ate3B4CBg/AAAAAAAAAAI/AAAAAAAACGo/9xaOH3aF-y8/photo.jpg?sz=128", "display_name": "Neeraj Kumar", "link": "https://stackoverflow.com/users/4626788/neeraj-kumar"}, "edited": false, "score": 0, "creation_date": 1443037127, "post_id": 32745406, "comment_id": 53336853, "body": "@NeErAjKuMaR: No, it doesn&#39;t; blanks in the format string just tell <code>scanf</code> to skip over whitespace characters."}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1443029718, "post_id": 32745586, "comment_id": 53332593, "body": "Why <code>fgetc()</code> instead of <code>getc()</code>?"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1443031080, "post_id": 32745586, "comment_id": 53333381, "body": "@JonathanLeffler, I don&#39;t understand why one would be better than the other."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1443031743, "post_id": 32745586, "comment_id": 53333772, "body": "<code>getc()</code> can be a macro; <code>fgetc()</code> is guaranteed to be a function.  If <code>getc()</code> is a macro, it is because it can perform better.  To some extent, this dates back to the days before inline functions.  It&#39;s not a big issue, but it is often considered better to use <code>getchar()</code> and <code>getc()</code> than <code>fgetc()</code>."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1443032034, "post_id": 32745586, "comment_id": 53333953, "body": "@JonathanLeffler, thanks for the explanation. Learned something today."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 1, "last_activity_date": 1443028390, "creation_date": 1443028390, "answer_id": 32745586, "question_id": 32745406, "link": "https://stackoverflow.com/questions/32745406/while-loop-is-stuck-in-infinite-loop-and-i-dont-know-why/32745586#32745586", "title": "While loop is stuck in infinite loop and I don&#39;t know why", "body": "<p>When there is an error in reading the input, you should clear the error state and skip the rest of the line before attempting to read more user input.</p>\n\n<p>Replace the lines:</p>\n\n<pre><code>  else if (c != 1)\n  {\n     printf(\"Invalid input, it must be just a number\\n\\n\");\n     printf(\"What is %d %c %d ? \", n1, op, n2);\n  }\n</code></pre>\n\n<p>by</p>\n\n<pre><code>  else if (c != 1)\n  {\n     printf(\"Invalid input, it must be just a number\\n\\n\");\n\n     // Clear the error states.\n     clearerr(stdin);\n\n     // Skip the rest of the line\n     skipRestOfLine(stdin);\n\n     printf(\"What is %d %c %d ? \", n1, op, n2);\n  }\n</code></pre>\n\n<p>where <code>skipRestOfLine()</code> can be implemented as:</p>\n\n<pre><code>void skipRestOfLine(FILE* stream)\n{\n   int c;\n   while ( (c = fgetc(stream)) != '\\n' &amp;&amp; c != EOF );\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1443031594, "post_id": 32746106, "comment_id": 53333699, "body": "That doesn&#39;t solve the OP&#39;s problem, and introduces a new one.  There at least needs to be a blank between the first <code>%d</code> and the <code>%c</code> conversion specifiers, or <code>op</code> will pick up the first character immediately following the first input, whether it&#39;s an operator or whitespace."}], "tags": [], "owner": {"reputation": 3237, "user_id": 4626788, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-d5Ate3B4CBg/AAAAAAAAAAI/AAAAAAAACGo/9xaOH3aF-y8/photo.jpg?sz=128", "display_name": "Neeraj Kumar", "link": "https://stackoverflow.com/users/4626788/neeraj-kumar"}, "is_accepted": false, "score": -1, "last_activity_date": 1443030157, "creation_date": 1443030157, "answer_id": 32746106, "question_id": 32745406, "link": "https://stackoverflow.com/questions/32745406/while-loop-is-stuck-in-infinite-loop-and-i-dont-know-why/32746106#32746106", "title": "While loop is stuck in infinite loop and I don&#39;t know why", "body": "<pre><code>scanf(\"%d%c%d\",&amp;n1, &amp;op, &amp;n2) use this code \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": true, "score": 2, "last_activity_date": 1443031483, "creation_date": 1443031483, "answer_id": 32746510, "question_id": 32745406, "link": "https://stackoverflow.com/questions/32745406/while-loop-is-stuck-in-infinite-loop-and-i-dont-know-why/32746510#32746510", "title": "While loop is stuck in infinite loop and I don&#39;t know why", "body": "<p>In the call</p>\n\n<pre><code>c = scanf(\"%d\", &amp;user_answer);\n</code></pre>\n\n<p>the <code>%d</code> conversion specifier expects to see a sequence of decimal digit characters; it will tell <code>scanf</code> to skip over any leading whitespace, then read decimal digit characters up to the first non-decimal-digit character, then convert and save the result to <code>user_answer</code>.  If you type in <kbd>1</kbd><kbd>2</kbd><kbd>a</kbd><kbd>Enter</kbd>, <code>scanf</code> will read and consume the <code>'1'</code> and <code>'2'</code> characters, assign the value <code>12</code> to <code>user_answer</code> and return 1 (for one successful conversion and assignment) leaving the <code>'a'</code> and newline characters in the input stream.  </p>\n\n<p>When you type <code>\"hmmm\"</code>, the first non-whitespace character is not a decimal digit, so <code>scanf</code> leaves it in place, doesn't assign anything to <code>user_answer</code>, and returns <code>0</code>.  All the remaining calls to <code>scanf</code> with a <code>\"%d\"</code> conversion specifier will do the same thing.  </p>\n\n<p>So, you need to make sure your <code>scanf</code> was successful, and if not, clear all characters out of the input stream before doing another read, something like the following:</p>\n\n<pre><code>if ( (c = scanf( \"%d\", &amp;user_answer ) ) == 0 )\n{\n  /**\n   * input matching failure, clear stray characters from input stream\n   * up to the next newline character\n   */\n  while ( getchar() != '\\n' )\n    ; // empty loop \n}\nelse if ( c == EOF )\n{\n  // error occurred during input operation\n}\nelse\n{\n  // do something with user_answer\n}\n</code></pre>\n\n<p>You'll notice in my first example, the <code>%d</code> conversion specifier accepted the input <code>\"12a\"</code>; it converted and assigned <code>12</code> to <code>user_answer</code>, leaving the <code>'a'</code> character in the input stream to foul up the next read.  Ideally, you'd like to reject such badly formed inputs altogether. You could do something like the following:</p>\n\n<pre><code>/**\n * Repeatedly prompt and read input until we get a valid decimal string\n */\nfor( ;; ) \n{\n  int c, dummy;\n  printf(\"What is %d %c %d ? \", n1, op, n2);\n\n  if ( ( c = scanf(\"%d%c\", &amp;user_answer, &amp;dummy ) == 2 )\n  {\n    /**\n     * If the character immediately following our numeric input is\n     * whitespace, then we have a good input, break out of the read loop\n     */\n    if ( isspace( dummy ) )\n      break;\n    else\n    {\n      fprintf( stderr, \"Non-numeric character follows input, try again...\\n\" );\n      while ( getchar() != '\\n' )\n        ; // empty loop body\n    }\n  }\n  else if ( c == 1 )\n  {\n    /**\n     * No character following successful decimal input, meaning we\n     * hit an EOF condition before any trailing characters were seen.  \n     * We'll consider this a good input for our purposes and break\n     * out of the read loop.\n     */\n    break;\n  }\n  else if ( c == 0 )\n  {\n    /**\n     * User typed in one or more non-digit characters; reject the input\n     * and clear out the input stream\n     */\n    fprintf( stderr, \"Non-numeric input\\n\" );\n\n    /**\n     * Consume characters from the input stream until we see a newline.\n     */\n    while ( ( getchar() != '\\n' )\n      ; // empty loop body\n  }\n  else\n  {\n    /**\n     * Input error or EOF on read; we'll treat this as a fatal\n     * error and bail out completely.\n     */\n    fprintf( stderr, \"Error occurred during read, panicking...\\n\" );\n    exit( 0 );\n  }\n}\n</code></pre>\n\n<p>Another option would be to read your input as text, then use the <code>strtol</code> library function to convert it to the result type:</p>\n\n<pre><code>for ( ;; )\n{\n  char input[SIZE]; // for some reasonable SIZE value, at least 12 to handle\n                    // a 32-bit int (up to 10 digits plus sign plus\n                    // string terminator\n\n  printf(\"What is %d %c %d ? \", n1, op, n2);\n  if ( fgets( input, sizeof input, stdin ) )\n  {\n    char *check; // will point to first non-digit character in input buffer\n    int tmp = (int) strtol( input, &amp;check, 10 );\n    if ( isspace( *check ) || *check == 0 )\n    {\n      user_answer = tmp;\n      break;\n    }\n    else\n    {\n      fprintf( stderr, \"%s is not a valid input, try again\\n\", input );\n    }\n  }\n  else\n  {\n    /** \n     * error or EOF on input, treat this as a fatal error and bail\n     */\n    fprintf( stderr, \"EOF or error while reading input, exiting...\\n\" );\n    exit( 0 );\n  }\n}\n</code></pre>\n\n<p>That's my preferred method.</p>\n\n<p>Either one of those messes would replace the line</p>\n\n<pre><code>c = scanf(\"%d\", &amp;user_answer);\n</code></pre>\n\n<p>After reading all that you're probably thinking, \"interactive input in C sure is a pain in the ass\".  You'd be right.</p>\n"}], "owner": {"reputation": 183, "user_id": 4171692, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/cd14ae2d93103b2f9b69c9460d7c4978?s=128&d=identicon&r=PG&f=1", "display_name": "Lenny", "link": "https://stackoverflow.com/users/4171692/lenny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 908, "favorite_count": 0, "accepted_answer_id": 32746510, "answer_count": 3, "score": 2, "last_activity_date": 1443031483, "creation_date": 1443027772, "last_edit_date": 1443028016, "question_id": 32745406, "link": "https://stackoverflow.com/questions/32745406/while-loop-is-stuck-in-infinite-loop-and-i-dont-know-why", "title": "While loop is stuck in infinite loop and I don&#39;t know why", "body": "<pre><code>#include    &lt;stdio.h&gt;\n#include    &lt;stdlib.h&gt;\n#include    &lt;ctype.h&gt;\n#include    &lt;math.h&gt;\n\nint main(int argc, char * argv[])\n{\n   printf(\"This program tests your integer arithmetic skills.\\n\"\n          \"You should answer the questions following the same \\n\"\n          \"rules that computers do for integers arithmetic, not \\n\"\n          \"floating-point arithmetic. Hit the 'Enter' key after \\n\"\n          \"you have typed in your input. When you wish to finish \\n\"\n          \"the test, enter -9876 as the answer to a question.\\n\"\n          \"\\n\");\n\n   int n1, n2, answer, user_answer, a, b, int_per;\n   char op, c;\n   float per, count, count_r, count_w;\n\n   count = 0;\n   count_r = 0;\n   count_w = 0;\n\n   printf(\"What is your question? \");\n   scanf(\"%d %c %d\", &amp;n1, &amp;op, &amp;n2);\n\n\n   do\n   {\n      count++;\n\n      printf(\"What is %d %c %d ? \", n1, op, n2);\n\n      if (op == '+')\n      {\n         answer = n1 + n2;\n      }\n      else if (op == '-')\n      {\n         answer = n1 - n2;\n      }\n      else if (op == '%')\n      {\n         answer = n1 % n2;\n      }\n      else if (op == '/')\n      {\n         answer = n1 / n2;\n      }\n      else if (op == '*')\n      {\n         answer = n1 * n2;\n      }\n\n      c = scanf(\"%d\", &amp;user_answer);\n\n      if (user_answer == answer)\n      {\n         printf(\"Correct!\\n\\n\");\n         count_r++;\n\n      }\n      else if (user_answer == -9876)\n      {\n         count = count - 1;\n         break;  \n      }\n      else if (c != 1)\n      {\n         printf(\"Invalid input, it must be just a number\\n\\n\");\n         printf(\"What is %d %c %d ? \", n1, op, n2);\n      }\n      else if (user_answer != answer)\n      {\n         printf(\"Wrong!\\n\\n\");\n         count_w++;\n      }\n\n   } while(user_answer != -9876);\n\n   per = (count_r / count) * 100;\n\n   a = (int) count_r;\n   b = (int) count_w;\n   int_per = roundf(per);\n\n   printf(\"\\nYou got %d right and %d wrong, for a score of %d%c\\n\", a,\n          b, int_per, 37);\n\n   return EXIT_SUCCESS;\n\n}\n</code></pre>\n\n<p>The code above is supposed to loop through asking for questions and then the answer, until the user inputs -9876 as an answer then the program terminates and gives them their score.This all works EXCEPT!! for one thing. When the user enters a non number into the input. When this happens it is supposed to say \"invalid input, please try again\" then ask the same question again. For example</p>\n\n<p>What is your question? <strong>9+9</strong></p>\n\n<p>What is 9 + 9? <strong>hmmm, 8</strong></p>\n\n<p>invalid input, please try again</p>\n\n<p>What is 9 + 9?</p>\n\n<p>SO.. the user entered \"hmmm\" and instead of prompting the user with the same question again then scanning properly it just jumps into an infinite loop.I was wondering how to fix that.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c", "input"], "comments": [{"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1443027757, "post_id": 32745320, "comment_id": 53331587, "body": "<code>fscanf(file, &quot;%d %d&quot;, &amp;a, &amp;b);</code>"}, {"owner": {"reputation": 1170, "user_id": 4770399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06a1f389f38f1cb4c0313c6c90b562ee?s=128&d=identicon&r=PG", "display_name": "Jean Jung", "link": "https://stackoverflow.com/users/4770399/jean-jung"}, "edited": false, "score": 0, "creation_date": 1443027984, "post_id": 32745320, "comment_id": 53331719, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/13651535/reading-a-file-in-c\">Reading a file in C</a>"}], "answers": [{"tags": [], "owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "is_accepted": false, "score": 1, "last_activity_date": 1443028426, "last_edit_date": 1443028426, "creation_date": 1443027782, "answer_id": 32745409, "question_id": 32745320, "link": "https://stackoverflow.com/questions/32745320/can-i-read-in-an-int-from-a-textfile-in-c-if-i-know-there-will-be-spacesp/32745409#32745409", "title": "Can I read in an int from a textfile in C, if I know there will be (space)###(space)", "body": "<p>If you know how many numbers are there then you can use <a href=\"http://www.tutorialspoint.com/c_standard_library/c_function_fscanf.htm\" rel=\"nofollow\"><code>fscanf</code></a> -</p>\n\n<p>For example if 2 numbers are there- </p>\n\n<pre><code>fscanf(fp,\"%d %d\",&amp;num1,&amp;num2);  // fp - file pointer ,num1 and num2 are integer variables \n</code></pre>\n\n<p>Or if you don't know how many numbers are there \n you can use <a href=\"http://www.tutorialspoint.com/c_standard_library/c_function_fgets.htm\" rel=\"nofollow\"><code>fgets</code></a>-</p>\n\n<pre><code>fgets(buffer,1000,fp);       // buffer char array of size 1000 and fp file pointer \n</code></pre>\n\n<p>and use function <a href=\"http://www.tutorialspoint.com/c_standard_library/c_function_strtok.htm\" rel=\"nofollow\"><code>strtok</code></a> to tokenize <code>buffer</code> and convert it into number using <a href=\"http://www.tutorialspoint.com/c_standard_library/c_function_atoi.htm\" rel=\"nofollow\"><code>atoi</code></a> .</p>\n"}, {"tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": false, "score": 0, "last_activity_date": 1443027845, "creation_date": 1443027845, "answer_id": 32745432, "question_id": 32745320, "link": "https://stackoverflow.com/questions/32745320/can-i-read-in-an-int-from-a-textfile-in-c-if-i-know-there-will-be-spacesp/32745432#32745432", "title": "Can I read in an int from a textfile in C, if I know there will be (space)###(space)", "body": "<p>The <code>%d</code> format specifier will eat leading whitespace, this will work as well with <code>fscanf</code></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    char str[] = \" 363 865 \";\n    int a, b;\n    if (sscanf(str, \"%d%d\", &amp;a, &amp;b) == 2)\n        printf(\"%d,%d\\n\", a, b);\n    else\n        printf(\"Bad input\\n\");\n    return 0;\n}\n</code></pre>\n\n<p>Program output</p>\n\n<pre><code>363,865\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4212244, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/e8055198801efb3f9b471ed26d8a90fc?s=128&d=identicon&r=PG&f=1", "display_name": "Dragonchicken", "link": "https://stackoverflow.com/users/4212244/dragonchicken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1443032752, "creation_date": 1443027514, "last_edit_date": 1443032752, "question_id": 32745320, "link": "https://stackoverflow.com/questions/32745320/can-i-read-in-an-int-from-a-textfile-in-c-if-i-know-there-will-be-spacesp", "title": "Can I read in an int from a textfile in C, if I know there will be (space)###(space)", "body": "<p>Is it possible in C, when reading a text file, to take in an integer value of unknown size (assuming it will fit in an int) by the fact it will have a space before the number and after the number.\nEg. 363 865\nI would like to store 363 and 865 each as there own int variables.<br>\nWith that being said is it possible to do this if I add characters?\nEg. Take the numbers and store them as variables! 363 865 \nSo do the same thing but not touch the text.</p>\n"}, {"tags": ["c", "floating-point"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1443026227, "post_id": 32744883, "comment_id": 53330759, "body": "<code>number - floor(number)</code>"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1443026392, "post_id": 32744883, "comment_id": 53330834, "body": "What&#39;s the expected output when the number is negative?"}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1443026613, "post_id": 32744883, "comment_id": 53330937, "body": "@WeatherVane shouldn&#39;t that be <code>trunc(number)</code> in case <code>number</code> is negative?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1443026650, "post_id": 32744883, "comment_id": 53330954, "body": "@Dmitri <code>trunc</code> is non-standard. But I take the point, if negative <code>number - ceil(number)</code>"}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1443027178, "post_id": 32744883, "comment_id": 53331227, "body": "@WeatherVane Isn&#39;t <code>trunc()</code> standard as of c99?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1443027287, "post_id": 32744883, "comment_id": 53331291, "body": "@Dmitri you are right."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1443029426, "post_id": 32744883, "comment_id": 53332446, "body": "OP why accept the the answer with output of <code>&quot;0.55&quot;</code> when <code>&quot;.55&quot;</code> was the required output in the post?"}, {"owner": {"reputation": 24610, "user_id": 270986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c49652c88a43a35bbf0095abfdae3515?s=128&d=identicon&r=PG", "display_name": "Mark Dickinson", "link": "https://stackoverflow.com/users/270986/mark-dickinson"}, "edited": false, "score": 0, "creation_date": 1443033544, "post_id": 32744883, "comment_id": 53334823, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/23993898/how-to-separate-float-into-an-integer-and-a-fractional-part\">How to separate float into an integer and a fractional part?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 24610, "user_id": 270986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c49652c88a43a35bbf0095abfdae3515?s=128&d=identicon&r=PG", "display_name": "Mark Dickinson", "link": "https://stackoverflow.com/users/270986/mark-dickinson"}, "edited": false, "score": 2, "creation_date": 1443028661, "post_id": 32744969, "comment_id": 53332055, "body": "As with @Mureinik&#39;s answer, this gives undefined behaviour for large <code>double</code>s."}, {"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "reply_to_user": {"reputation": 24610, "user_id": 270986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c49652c88a43a35bbf0095abfdae3515?s=128&d=identicon&r=PG", "display_name": "Mark Dickinson", "link": "https://stackoverflow.com/users/270986/mark-dickinson"}, "edited": false, "score": 0, "creation_date": 1443028997, "post_id": 32744969, "comment_id": 53332207, "body": "@MarkDickinson  Sir ,i have updated my anser  .Thanks for response ."}], "tags": [], "owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "is_accepted": false, "score": 2, "last_activity_date": 1443028974, "last_edit_date": 1443028974, "creation_date": 1443026278, "answer_id": 32744969, "question_id": 32744883, "link": "https://stackoverflow.com/questions/32744883/how-do-i-write-only-the-decimal-places-in-c-language/32744969#32744969", "title": "How do I write only the decimal places in C language?", "body": "<p>Well you can do this to store it in another variable -</p>\n\n<pre><code> double a=2.55,b;\n b =a-(long)a;                   // subtracting  decimal part from a\n printf(\"%.2f\\n\",b);\n</code></pre>\n\n<p>As pointed out by Mark Dickinson Sir  in comment that this is not safe . So you can make use of function <a href=\"http://www.tutorialspoint.com/c_standard_library/c_function_modf.htm\" rel=\"nofollow\"><code>modf</code></a> from <code>&lt;math.h&gt;</code>-</p>\n\n<p>For example -</p>\n\n<pre><code>double a=-2.55,b,i;\nb =modf(a,&amp;i);                   // i will give integer part and b will give fraction part\nprintf(\"%.2f\\n\",b);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 24610, "user_id": 270986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c49652c88a43a35bbf0095abfdae3515?s=128&d=identicon&r=PG", "display_name": "Mark Dickinson", "link": "https://stackoverflow.com/users/270986/mark-dickinson"}, "edited": false, "score": 5, "creation_date": 1443028172, "post_id": 32744972, "comment_id": 53331817, "body": "This gives undefined behavour for large <code>d</code>, as a result of the cast to <code>int</code> overflowing.  (C99 6.3.1.4p1: &quot;If the value of the integral part cannot be represented by the integer type, the behavior is undefined.&quot;)  Why not use the <code>modf</code> function from the math library?"}], "tags": [], "owner": {"reputation": 249903, "user_id": 2422776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2353050223ebecb113741c29458de4b2?s=128&d=identicon&r=PG", "display_name": "Mureinik", "link": "https://stackoverflow.com/users/2422776/mureinik"}, "is_accepted": true, "score": 1, "last_activity_date": 1443026301, "creation_date": 1443026301, "answer_id": 32744972, "question_id": 32744883, "link": "https://stackoverflow.com/questions/32744883/how-do-i-write-only-the-decimal-places-in-c-language/32744972#32744972", "title": "How do I write only the decimal places in C language?", "body": "<p>One dirty trick is to cast your <code>double</code> to an <code>int</code> to get only the whole number. You can then subtract the two to get only the decimal part:</p>\n\n<pre><code>double d = 2.55;\ndouble remainder = d - (int)d;\nprintf (\"%.2f\\n\", remainder);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 1, "creation_date": 1443029303, "post_id": 32745740, "comment_id": 53332366, "body": "OP did not mention &quot;money&quot; (although he did not expand on any particular use as well). Nevertheless, your sugessted code fails for negative numbers and <code>num = 101</code> (although both can be trivially fixed)."}, {"owner": {"reputation": 9606, "user_id": 3677097, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b8c49e598194e53b9aba3a195da387a5?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas DM", "link": "https://stackoverflow.com/users/3677097/andreas-dm"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1443030354, "post_id": 32745740, "comment_id": 53332944, "body": "@Jongware <code>num = 101</code> will display <code>.1</code> as expected, or did you mean that it doesn&#39;t display <code>.01</code> ?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1443031196, "post_id": 32745740, "comment_id": 53333444, "body": "Detail: <code>double</code> <i>values</i> are precise.  It is <code>double</code> math that introduces the rounding errors."}], "tags": [], "owner": {"reputation": 9606, "user_id": 3677097, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b8c49e598194e53b9aba3a195da387a5?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas DM", "link": "https://stackoverflow.com/users/3677097/andreas-dm"}, "is_accepted": false, "score": 1, "last_activity_date": 1443030236, "last_edit_date": 1443030236, "creation_date": 1443028977, "answer_id": 32745740, "question_id": 32744883, "link": "https://stackoverflow.com/questions/32744883/how-do-i-write-only-the-decimal-places-in-c-language/32745740#32745740", "title": "How do I write only the decimal places in C language?", "body": "<p><code>double</code> values are not perfectly precise, so small rounding errors can get introduced. You can store the total number in an Integer. You can for example divide by 100 to get the value before the <code>.</code> and use % modulus to get the decimal values.</p>\n\n<p>Example:</p>\n\n<pre><code>int main()\n{   \n    int num = 255;\n\n    printf(\"%d.%d\\n\", num / 100, num % 100); // prints 2.55\n    printf(\".%d\", num % 100);                // prints .55\n\n    return 0;\n}\n</code></pre>\n\n<p>This fails with negative numbers, but you can easily add cases to handle that.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1443030851, "creation_date": 1443030851, "answer_id": 32746325, "question_id": 32744883, "link": "https://stackoverflow.com/questions/32744883/how-do-i-write-only-the-decimal-places-in-c-language/32746325#32746325", "title": "How do I write only the decimal places in C language?", "body": "<p>Use <code>double modf(double value, double *iptr)</code> to get the factional part.  Use <code>round()</code> to get the best value near the requested precision.</p>\n\n<pre><code>double GetDecimalPlaces(double x, unsigned places) {\n  double ipart;\n  double fraction = modf(x, &amp;ipart);\n  return fraction;\n  // or \n  double scale = pow(10.0, places);\n  return round(fraction * scale)/scale;\n}\n\nvoid GetDecimalPlaces_Test(double x, unsigned places) {\n  printf(\"x:%e places:%u --&gt;\", x, places);\n  printf(\"%#.*f\\n\", places, GetDecimalPlaces(x, places));\n  // Additional work needed if leading '0' is not desired.\n}\n\nint main(void) {\n  GetDecimalPlaces_Test(2.55, 2);\n  GetDecimalPlaces_Test(-2.55, 2);\n  GetDecimalPlaces_Test(2.05, 2);\n  GetDecimalPlaces_Test(0.0, 2);\n  GetDecimalPlaces_Test(0.0005, 2);\n}\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>x:2.550000e+00 places:2 --&gt;0.55\nx:-2.550000e+00 places:2 --&gt;-0.55\nx:2.050000e+00 places:2 --&gt;0.05\nx:0.000000e+00 places:2 --&gt;0.00\nx:5.000000e-04 places:2 --&gt;0.00\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 5368677, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4055358bf9fc2c6122b4d3d226040ad9?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Woods", "link": "https://stackoverflow.com/users/5368677/joe-woods"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 32744972, "answer_count": 4, "score": 1, "last_activity_date": 1443030851, "creation_date": 1443025935, "last_edit_date": 1443026391, "question_id": 32744883, "link": "https://stackoverflow.com/questions/32744883/how-do-i-write-only-the-decimal-places-in-c-language", "title": "How do I write only the decimal places in C language?", "body": "<p>If I have <code>2.55</code>, how do I write only <code>.55</code> and skip 2 in programming language?</p>\n"}, {"tags": ["c++", "c", "cuda"], "comments": [{"owner": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "edited": false, "score": 1, "creation_date": 1443030751, "post_id": 32744632, "comment_id": 53333190, "body": "Your use of the three <code>__constant__</code> pointers is totally broken in several ways."}, {"owner": {"reputation": 443, "user_id": 886133, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/82833a4d160cc2427d6bee7df1d8d3ef?s=128&d=identicon&r=PG", "display_name": "Castrona", "link": "https://stackoverflow.com/users/886133/castrona"}, "reply_to_user": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "edited": false, "score": 0, "creation_date": 1443032761, "post_id": 32744632, "comment_id": 53334396, "body": "@talonmies Can you please explain?  Is it because they are declared as <code>double*</code> rather than something like <code>double[N]</code> ?"}, {"owner": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "edited": false, "score": 1, "creation_date": 1443033191, "post_id": 32744632, "comment_id": 53334657, "body": "Nowhere do you allocate any memory for them. You just copy an (illegal) host address to the symbols"}, {"owner": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "edited": false, "score": 0, "creation_date": 1445071796, "post_id": 32744632, "comment_id": 54175516, "body": "I have added a community wiki answer to this question to get it off the unanswered list. If you are satisfied with it, perhaps you could accept it, just to get this question off the unanswered list. Otherwise, add you own answer if you found a better solution yourself, or perhaps delete the question"}], "answers": [{"tags": [], "owner": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "is_accepted": false, "score": 1, "last_activity_date": 1443340170, "creation_date": 1443340170, "answer_id": 32805726, "question_id": 32744632, "link": "https://stackoverflow.com/questions/32744632/cuda-simple-array-search-shared-memory/32805726#32805726", "title": "CUDA Simple Array Search - Shared Memory", "body": "<p>The core problem is this:</p>\n\n<pre><code>cudaMemcpyToSymbol(cx, &amp;circlex, sizeof(circlex), 0, cudaMemcpyHostToDevice);\n</code></pre>\n\n<p><code>cx</code> is a unintialised pointer to which you are copying <code>sizeof(double *)</code> bytes from a source array of double values, leaving it containing a nonsense address which results in an illegal memory operation in your kernel.</p>\n\n<p>Do something like this instead:</p>\n\n<pre><code> double * _cx; cudaMalloc((void **)&amp;_cx, sizeof(double) * count);\n cudaMemcpy(_cx, circlex, sizeof(double) * count, cudaMemcpyHostToDevice);\n cudaMemcpyToSymbol(cx, &amp;_cx, sizeof(_cx));\n</code></pre>\n\n<p>i.e. allocate a device memory buffer, copy the host source data to that buffer, then copy the address of that buffer to the constant memory pointer.</p>\n"}], "owner": {"reputation": 443, "user_id": 886133, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/82833a4d160cc2427d6bee7df1d8d3ef?s=128&d=identicon&r=PG", "display_name": "Castrona", "link": "https://stackoverflow.com/users/886133/castrona"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 272, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1443340170, "creation_date": 1443025028, "question_id": 32744632, "link": "https://stackoverflow.com/questions/32744632/cuda-simple-array-search-shared-memory", "title": "CUDA Simple Array Search - Shared Memory", "body": "<p>I am writing a function to search for the first occurrence that matches a specific criteria.  In my particular problem, I am interested in finding the array index corresponding to a circle that intersects with a given point.  I have three arrays that collectively describe the circles: x coordinates, y coordinates, and radii (<code>cx</code>, <code>cy</code>, <code>cz</code>).  Given an input point I calculate whether or not it will intersect each of the circles defined by the 3 arrays.  I chose to declare the x, y, radii arrays in global memory because my <code>search</code> function will be called often and these arrays will not change.  </p>\n\n<p>This function seems pretty straight forward, but I'm getting the following error:  </p>\n\n<p><code>cudaMemcpy(&amp;res, dev_idx, sizeof(int), cudaMemcpyDeviceToHost) returned the launch timed out and was terminated(6)</code></p>\n\n<pre><code>static void CheckCudaErrorAux (const char *, unsigned, const char *, cudaError_t);\n#define HANDLE_ERROR(value) CheckCudaErrorAux(__FILE__,__LINE__, #value, value)\n\n// global memory arrays on the device\n__device__ __constant__ double* cx;\n__device__ __constant__ double* cy;\n__device__ __constant__ double* cr;\n\n__global__ void _cuda_find_containing_circle(double px, double py, int* fidx, int count){\n    // px, py: x and y coordinates of the search point\n    // fidx:   a device variable to return the index of the matching circle\n    // count:  total number of circle elements in the device arrays\n\n    // get the current thread id\n    int tid = threadIdx.x + blockIdx.x * blockDim.x;\n\n    if(tid &lt; count){\n        // calculate the hypotenuse of the point and grab the radius\n        float hypot = (float)hypot(cx[tid] - px, cy[tid] - py);\n        float radius = (float)cr[tid];\n\n        // if the hypotenuse is within the radius, return the current index\n        // this looks like the problem, i.e. hardcoding to \"if(tid = 10){\" does not result in an error\n        if (hypot &lt;= radius){  \n            atomicMin(fidx, tid);\n\n            // I've also tried setting the idx directly\n            //*fidx = tid;\n        }\n\n        // increment thread id\n        tid += blockDim.x * gridDim.x;\n    }\n}\n\n\n\n\n\nvoid main(){\n    // define a search point for testing\n    int px = 100;\n    int py = 150;\n\n    // initialize cx, cy, cz device values using the following arrays\n    double *circlex;\n    double *circley;\n    double *circler;\n    int count = 100;\n\n    circlex = (double *) malloc(sizeof(double) * count);\n    circley = (double *) malloc(sizeof(double) * count);\n    circler = (double *) malloc(sizeof(double) * count);\n\n    // populate arrays with values that will not pass the search criteria\n    for (int i = 0; i &lt; count; i++) {\n        circlex[i] = 2.1;\n        circley[i] = 3.2;\n        circler[i] = 0.0;\n    }\n\n    // add a single value that will pass the search criteria (for testing)\n    circlex[count - 5] = 101.0;\n    circley[count - 5] = 160.0;\n    circler[count - 5] = 11.0;  //hypot should result in 10.0498 &lt; 11\n\n    // copy these data onto the device \n    HANDLE_ERROR(cudaMemcpyToSymbol(cx, &amp;circlex, sizeof(circlex), 0, cudaMemcpyHostToDevice));\n    HANDLE_ERROR(cudaMemcpyToSymbol(cy, &amp;circley, sizeof(circley), 0, cudaMemcpyHostToDevice));\n    HANDLE_ERROR(cudaMemcpyToSymbol(cr, &amp;circler, sizeof(circler), 0, cudaMemcpyHostToDevice));\n\n    // create an object on the device to store the search index result\n    int* dev_idx;\n    int idx = 999;  // initial condition.  If -999 is returned then I know that a match was not found\n    HANDLE_ERROR(cudaMalloc((void **) &amp;dev_idx, sizeof(int)));\n    HANDLE_ERROR(cudaMemcpy(dev_idx, &amp;idx, sizeof(int), cudaMemcpyHostToDevice));\n\n    // call the search function\n    _cuda_find_containing_circle &lt;&lt;&lt;128, 128&gt;&gt;&gt; (px, py, dev_idx, count);\n\n    // get the search result\n    // this line throws the following error: cudaMemcpy(&amp;res, dev_idx, sizeof(int), cudaMemcpyDeviceToHost) returned the launch timed out and was terminated(6) \n    int res;\n    HANDLE_ERROR(cudaMemcpy(&amp;res, dev_idx, sizeof(int), cudaMemcpyDeviceToHost));\n\n    cout &lt;&lt; \"IDX = \" &lt;&lt; res &lt;&lt; endl;\n\n\n\n\n\nstatic void CheckCudaErrorAux (const char *file, unsigned line, const char *statement, cudaError_t err)\n{\n    if (err == cudaSuccess)\n        return;\n    std::cerr &lt;&lt; statement&lt;&lt;\" returned \" &lt;&lt; cudaGetErrorString(err) &lt;&lt; \"(\"&lt;&lt;err&lt;&lt; \") at \"&lt;&lt;file&lt;&lt;\":\"&lt;&lt;line &lt;&lt; std::endl;\n    exit (1);\n}\n</code></pre>\n\n<p>Is there something fundamentally incorrect with my approach?  </p>\n"}, {"tags": ["c", "assembly", "arm", "cortex-m3"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1443024153, "post_id": 32744206, "comment_id": 53329478, "body": "The surrounding code and variables declarations would be much more helpful than this whole dump of screenshots."}], "answers": [{"comments": [{"owner": {"reputation": 2030, "user_id": 550235, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/934de7ad57af9a8f6a37e0c78017f942?s=128&d=identicon&r=PG", "display_name": "Russ Schultz", "link": "https://stackoverflow.com/users/550235/russ-schultz"}, "edited": false, "score": 0, "creation_date": 1443024159, "post_id": 32744338, "comment_id": 53329480, "body": "FWIW, the compiler shouldn&#39;t generate that instruction if your structure is marked as __packed"}, {"owner": {"reputation": 1728, "user_id": 788319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07838f76d3f83ef6fd6ff68a06bf7c14?s=128&d=identicon&r=PG", "display_name": "KlausCPH", "link": "https://stackoverflow.com/users/788319/klauscph"}, "edited": false, "score": 0, "creation_date": 1443024796, "post_id": 32744338, "comment_id": 53329892, "body": "Well spotted. Thanks. I added <b>attribute__((__packed</b>)) to the struct definition and now it runs fine."}, {"owner": {"reputation": 2030, "user_id": 550235, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/934de7ad57af9a8f6a37e0c78017f942?s=128&d=identicon&r=PG", "display_name": "Russ Schultz", "link": "https://stackoverflow.com/users/550235/russ-schultz"}, "reply_to_user": {"reputation": 1728, "user_id": 788319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07838f76d3f83ef6fd6ff68a06bf7c14?s=128&d=identicon&r=PG", "display_name": "KlausCPH", "link": "https://stackoverflow.com/users/788319/klauscph"}, "edited": false, "score": 0, "creation_date": 1443025113, "post_id": 32744338, "comment_id": 53330102, "body": "Just be aware that access to __packed structures will be slower (since it now assumes it&#39;s never aligned) and this could make a difference if you&#39;re accessing it in a tight loop."}], "tags": [], "owner": {"reputation": 2030, "user_id": 550235, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/934de7ad57af9a8f6a37e0c78017f942?s=128&d=identicon&r=PG", "display_name": "Russ Schultz", "link": "https://stackoverflow.com/users/550235/russ-schultz"}, "is_accepted": true, "score": 2, "last_activity_date": 1443024112, "creation_date": 1443024112, "answer_id": 32744338, "question_id": 32744206, "link": "https://stackoverflow.com/questions/32744206/simple-struct-dereference-trigger-arm-hard-fault-hardware-exception/32744338#32744338", "title": "simple struct dereference trigger ARM hard_fault hardware exception", "body": "<p>R0 isn't aligned to a 32 bit address, and LMDIA requires alignment.</p>\n\n<p>Use memcpy() instead.</p>\n"}], "owner": {"reputation": 1728, "user_id": 788319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07838f76d3f83ef6fd6ff68a06bf7c14?s=128&d=identicon&r=PG", "display_name": "KlausCPH", "link": "https://stackoverflow.com/users/788319/klauscph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 0, "accepted_answer_id": 32744338, "answer_count": 1, "score": 0, "last_activity_date": 1443024112, "creation_date": 1443023700, "question_id": 32744206, "link": "https://stackoverflow.com/questions/32744206/simple-struct-dereference-trigger-arm-hard-fault-hardware-exception", "title": "simple struct dereference trigger ARM hard_fault hardware exception", "body": "<p>I've been debugging this for many hours now. \nMy application is an embedded program running on the CC2650 ARM M3 processor using the TI RTOS.</p>\n\n<p>This line of c generates an ARM hard_fault exception (LD - link register set to 0xFFFFFFFD):</p>\n\n<pre><code>leaseStartMessageForReplay = *leaseStartMessage;\n</code></pre>\n\n<p>The code simply dereferences the <code>leaseStartMessage</code> struct pointer and copies the full struct content (2 words) to the <code>leaseStartMessageForReplay</code> struct. (Thats the intension at least).</p>\n\n<p>The actual assembly for that line looks like this:\n<a href=\"https://i.stack.imgur.com/OlvIa.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OlvIa.jpg\" alt=\"assembly\"></a></p>\n\n<p>The assembly seems correct: 1st line loads R0 with the address of <code>leaseStartMessage</code>. 2nd line loads R2 with the address of the <code>leaseStartMessageForReplay</code>. 3rd line load the two words located at address-R0 into R0 and R2. 4th line stores the two words in R0 and R2 at address-R1.</p>\n\n<p>The hard_fault exception happens on the 3rd line. The registers R0, R1, R2 have these values just before executing the 3rd instruction:\n<a href=\"https://i.stack.imgur.com/Yd4eb.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Yd4eb.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>As can be seen the two address pointers R0 and R1 are initialized and I have verified that they contain the correct addresses.</p>\n\n<p>Any help on how to debug this would be greatly appreciated.</p>\n"}, {"tags": ["c", "sockets", "websocket", "ip", "webserver"], "answers": [{"comments": [{"owner": {"reputation": 1197, "user_id": 4025071, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/TZaTm.jpg?s=128&g=1", "display_name": "Jordan Davis", "link": "https://stackoverflow.com/users/4025071/jordan-davis"}, "edited": false, "score": 0, "creation_date": 1443023526, "post_id": 32743880, "comment_id": 53329019, "body": "Why is it so &quot;strange&quot; to be using the standard <code>sys&#47;socket.h</code> libs structs? was the lib not design for this exact purpose? and if it&#39;s such bad programming why is it a standard (and approved by the ISO)? if the lib is for sockets sys/socket.h and defines it&#39;s own structure... why would it be bad programming to use it? to me including and initializing another library to patch over sounds like bad programming...."}, {"owner": {"reputation": 70070, "user_id": 9611, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/749b73007119baf94fc077c50bcc58e8?s=128&d=identicon&r=PG", "display_name": "shoosh", "link": "https://stackoverflow.com/users/9611/shoosh"}, "reply_to_user": {"reputation": 1197, "user_id": 4025071, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/TZaTm.jpg?s=128&g=1", "display_name": "Jordan Davis", "link": "https://stackoverflow.com/users/4025071/jordan-davis"}, "edited": false, "score": 1, "creation_date": 1443023989, "post_id": 32743880, "comment_id": 53329360, "body": "<code>socket.h</code> is designed to support any type of socket. You want an IP socket so you need to use the standard struct for an IP socket which is in <code>netinet&#47;in.h</code> (an integral part of the sockets library). <code>socket.h</code> doesn&#39;t include all structs for all types of sockets since there are lots of them and you can define your own as well. <code>sockaddr</code> is not meant to be instantiated on its own, its just a placeholder, it&#39;s the C equaivalent of C++ abstract base class."}, {"owner": {"reputation": 1197, "user_id": 4025071, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/TZaTm.jpg?s=128&g=1", "display_name": "Jordan Davis", "link": "https://stackoverflow.com/users/4025071/jordan-davis"}, "edited": false, "score": 0, "creation_date": 1443024795, "post_id": 32743880, "comment_id": 53329889, "body": "Yea exactly the generic socket struct <code>osockaddr</code> can support any type of struct, so I&#39;m simply looking for use with <code>AF_INET</code> family... your answer pretty much above defined it for me, using two bytes for port, 4 bytes addr in the <code>sa_data</code> knowing that I have an IPv4 address and knowing what port I&#39;m going to bind it to I can change the sa_data[14] length accordingly. Yes I know this isn&#39;t the &quot;portable&quot; solution because there could be an IPv6 address which would change the length... but I know its an IPv4."}, {"owner": {"reputation": 1197, "user_id": 4025071, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/TZaTm.jpg?s=128&g=1", "display_name": "Jordan Davis", "link": "https://stackoverflow.com/users/4025071/jordan-davis"}, "edited": false, "score": 0, "creation_date": 1443025118, "post_id": 32743880, "comment_id": 53330105, "body": "I understand the <code>netinet&#47;in.h</code> is a &quot;integral&quot; part of the sockets lib and I agree with you, but its not a &quot;required&quot; part of the sockets lib, and so my question was basically how would that look... defining the IPv4 address and a port in the sa_data[] without adding the netinet/in.h structs..."}, {"owner": {"reputation": 70070, "user_id": 9611, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/749b73007119baf94fc077c50bcc58e8?s=128&d=identicon&r=PG", "display_name": "shoosh", "link": "https://stackoverflow.com/users/9611/shoosh"}, "reply_to_user": {"reputation": 1197, "user_id": 4025071, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/TZaTm.jpg?s=128&g=1", "display_name": "Jordan Davis", "link": "https://stackoverflow.com/users/4025071/jordan-davis"}, "edited": false, "score": 0, "creation_date": 1443031859, "post_id": 32743880, "comment_id": 53333836, "body": "IPv6 would have a different <code>sin_family</code>. My reasoning is strictly in the realm of &quot;don&#39;t make other people who need to read your code want to hit you with a baseball bat&quot; which is what I would want to do, had I seen such code."}, {"owner": {"reputation": 1197, "user_id": 4025071, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/TZaTm.jpg?s=128&g=1", "display_name": "Jordan Davis", "link": "https://stackoverflow.com/users/4025071/jordan-davis"}, "edited": false, "score": 0, "creation_date": 1443032014, "post_id": 32743880, "comment_id": 53333938, "body": "Haha &quot;hit you with a baseball bat&quot; yea I know what you mean, but I&#39;ll be the only one using it for now... Take a look a Beej&#39;s guide <a href=\"http://beej.us/net2/html/structs.html\" rel=\"nofollow noreferrer\">beej.us/net2/html/structs.html</a>  and when he says, &quot;This is rather unwieldy since you don&#39;t want to tediously pack the address in the sa_data by hand&quot; this is what I mean... I want to tediously pack the address in the <code>sa_data</code> by hand."}], "tags": [], "owner": {"reputation": 70070, "user_id": 9611, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/749b73007119baf94fc077c50bcc58e8?s=128&d=identicon&r=PG", "display_name": "shoosh", "link": "https://stackoverflow.com/users/9611/shoosh"}, "is_accepted": false, "score": 0, "last_activity_date": 1443022745, "creation_date": 1443022745, "answer_id": 32743880, "question_id": 32743473, "link": "https://stackoverflow.com/questions/32743473/socket-programming-sys-socket-h/32743880#32743880", "title": "Socket Programming (sys/socket.h)", "body": "<p>Don't do that.<br>\nyou can think about <code>sockaddr</code> as a sort of union:</p>\n\n<pre><code>struct sockaddr\n{\n  short int sin_family;\n  union {\n    struct {\n      unsigned short int   sin_port;\n      struct in_addr       sin_addr;\n      unsigned char        sin_zero[8];\n    };\n    unsigned char sa_data[14]\n  };\n};\n</code></pre>\n\n<p>so yea, if you take <code>sin_port</code>'s two bytes, minding the correct endianness, you can put them in <code>sa_data[0]</code> and <code>sa_data[1]</code>, then you can take <code>sin_addr</code>'s 4 bytes and put them in <code>sa_data[2]</code> to <code>sa_data[6]</code>.<br>\nBut you really should not do that since it is extremely poor programming and it will make your code unreadable to anyone else, including yourself in 6 months.<br>\nIf for some strange reason you don't want to <code>#include \"netinet/in.h\"</code> you can just define just this struct in your own code file and use it.</p>\n"}, {"comments": [{"owner": {"reputation": 1197, "user_id": 4025071, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/TZaTm.jpg?s=128&g=1", "display_name": "Jordan Davis", "link": "https://stackoverflow.com/users/4025071/jordan-davis"}, "edited": false, "score": 0, "creation_date": 1443024455, "post_id": 32744248, "comment_id": 53329679, "body": "I&#39;m would be initializing and linking the entire <code>netinet&#47;in.h</code> file so it is extra... and I&#39;m not required to link against it,  <code>sys&#47;socket.h</code> defines socket(),bind(),listen(),rec(),send() and works completely fine without it..."}, {"owner": {"reputation": 976, "user_id": 1252194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/762692d3f4a23d9a52b315c95f1f64b9?s=128&d=identicon&r=PG", "display_name": "x539", "link": "https://stackoverflow.com/users/1252194/x539"}, "reply_to_user": {"reputation": 1197, "user_id": 4025071, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/TZaTm.jpg?s=128&g=1", "display_name": "Jordan Davis", "link": "https://stackoverflow.com/users/4025071/jordan-davis"}, "edited": false, "score": 0, "creation_date": 1443025251, "post_id": 32744248, "comment_id": 53330179, "body": "No, nothing is linked against header files. This is not Java or what ever language you come from. Both headers belong to the same standard library. <code>netinite&#47;in.h</code> just tells you some features this library has. Not including it does not mean those features are not included. You could even use those features without including it."}, {"owner": {"reputation": 1197, "user_id": 4025071, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/TZaTm.jpg?s=128&g=1", "display_name": "Jordan Davis", "link": "https://stackoverflow.com/users/4025071/jordan-davis"}, "edited": false, "score": 0, "creation_date": 1443025681, "post_id": 32744248, "comment_id": 53330426, "body": "Everything is linked.... If I don&#39;t <code>#include&lt;netinet&#47;in.h&gt;</code> header file, I simply won&#39;t be able to use anything defined in that file &quot;features&quot;... the #include is a preprocessor directive for the compiler... if I don&#39;t #include that file I wont initialize anything inside of it thus making my program that more efficient..."}, {"owner": {"reputation": 976, "user_id": 1252194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/762692d3f4a23d9a52b315c95f1f64b9?s=128&d=identicon&r=PG", "display_name": "x539", "link": "https://stackoverflow.com/users/1252194/x539"}, "reply_to_user": {"reputation": 1197, "user_id": 4025071, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/TZaTm.jpg?s=128&g=1", "display_name": "Jordan Davis", "link": "https://stackoverflow.com/users/4025071/jordan-davis"}, "edited": false, "score": 0, "creation_date": 1443025948, "post_id": 32744248, "comment_id": 53330595, "body": "No. The processor has nothing to do with linking. My observation is you have a totally wrong understanding of header files."}, {"owner": {"reputation": 1197, "user_id": 4025071, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/TZaTm.jpg?s=128&g=1", "display_name": "Jordan Davis", "link": "https://stackoverflow.com/users/4025071/jordan-davis"}, "edited": false, "score": 0, "creation_date": 1443026012, "post_id": 32744248, "comment_id": 53330627, "body": "PRE-processor!!! <a href=\"https://gcc.gnu.org/onlinedocs/cpp/Index-of-Directives.html#Index-of-Directives\" rel=\"nofollow noreferrer\">gcc.gnu.org/onlinedocs/cpp/&hellip;</a>"}, {"owner": {"reputation": 1197, "user_id": 4025071, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/TZaTm.jpg?s=128&g=1", "display_name": "Jordan Davis", "link": "https://stackoverflow.com/users/4025071/jordan-davis"}, "edited": false, "score": 0, "creation_date": 1443026238, "post_id": 32744248, "comment_id": 53330764, "body": "Read what a header file is, and what #include preprocessing directive does....<a href=\"https://gcc.gnu.org/onlinedocs/cpp/Header-Files.html#Header-Files\" rel=\"nofollow noreferrer\">gcc.gnu.org/onlinedocs/cpp/Header-Files.html#Header-&zwnj;&#8203;Files</a> and I quote &quot;Including a header file produces the same results as copying the header file into each source file that needs it&quot; I don&#39;t want to copy the entire <code>netinent&#47;in.h</code> header file into my program if I don&#39;t have to..."}, {"owner": {"reputation": 976, "user_id": 1252194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/762692d3f4a23d9a52b315c95f1f64b9?s=128&d=identicon&r=PG", "display_name": "x539", "link": "https://stackoverflow.com/users/1252194/x539"}, "reply_to_user": {"reputation": 1197, "user_id": 4025071, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/TZaTm.jpg?s=128&g=1", "display_name": "Jordan Davis", "link": "https://stackoverflow.com/users/4025071/jordan-davis"}, "edited": false, "score": 0, "creation_date": 1443026538, "post_id": 32744248, "comment_id": 53330899, "body": "I do know C and I do know what the pre-processor does. If your are considered about compile-time, let me tell you: You don&#39;t even have to include sys/socket.h if you wont to use socket(),bind(), etc. But it won&#39;t Influence the performance/size of your program because those headers do not contain code, just definitions."}, {"owner": {"reputation": 1197, "user_id": 4025071, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/TZaTm.jpg?s=128&g=1", "display_name": "Jordan Davis", "link": "https://stackoverflow.com/users/4025071/jordan-davis"}, "edited": false, "score": 0, "creation_date": 1443026663, "post_id": 32744248, "comment_id": 53330958, "body": "Please tell me how the hell my program will know what the socket(),bind(),etc function do if I don&#39;t include <code>sys&#47;socket.h</code>?"}, {"owner": {"reputation": 1197, "user_id": 4025071, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/TZaTm.jpg?s=128&g=1", "display_name": "Jordan Davis", "link": "https://stackoverflow.com/users/4025071/jordan-davis"}, "edited": false, "score": 0, "creation_date": 1443026904, "post_id": 32744248, "comment_id": 53331070, "body": "and yes it will influence size and performance because not only does it add 621 lines of code to my program it&#39;s also initializing constants..."}, {"owner": {"reputation": 976, "user_id": 1252194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/762692d3f4a23d9a52b315c95f1f64b9?s=128&d=identicon&r=PG", "display_name": "x539", "link": "https://stackoverflow.com/users/1252194/x539"}, "reply_to_user": {"reputation": 1197, "user_id": 4025071, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/TZaTm.jpg?s=128&g=1", "display_name": "Jordan Davis", "link": "https://stackoverflow.com/users/4025071/jordan-davis"}, "edited": false, "score": 0, "creation_date": 1443026904, "post_id": 32744248, "comment_id": 53331071, "body": "add <code>extern int socket (int, int,  int);</code> to your code and you can use socket. <code>extern int bind(int, void*, int);</code> for bind."}, {"owner": {"reputation": 976, "user_id": 1252194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/762692d3f4a23d9a52b315c95f1f64b9?s=128&d=identicon&r=PG", "display_name": "x539", "link": "https://stackoverflow.com/users/1252194/x539"}, "reply_to_user": {"reputation": 1197, "user_id": 4025071, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/TZaTm.jpg?s=128&g=1", "display_name": "Jordan Davis", "link": "https://stackoverflow.com/users/4025071/jordan-davis"}, "edited": false, "score": 0, "creation_date": 1443027199, "post_id": 32744248, "comment_id": 53331239, "body": "Write a <code>hello world</code> compile. check the binarys size. Add hundreds of constants. compile. compare size. No difference.  So lets end this here."}, {"owner": {"reputation": 1197, "user_id": 4025071, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/TZaTm.jpg?s=128&g=1", "display_name": "Jordan Davis", "link": "https://stackoverflow.com/users/4025071/jordan-davis"}, "edited": false, "score": 0, "creation_date": 1443027934, "post_id": 32744248, "comment_id": 53331687, "body": "I don&#39;t even need to write a <code>hello world</code> program, what you are telling me is the the amount of lines a program contains doesn&#39;t influence the size of memory.... Do you even know what a program&#39;s stack looks like <a href=\"https://gabrieletolomei.wordpress.com/miscellanea/operating-systems/in-memory-layout/\" rel=\"nofollow noreferrer\">gabrieletolomei.wordpress.com/miscellanea/operating-systems/&zwnj;&#8203;&hellip;</a>"}, {"owner": {"reputation": 1197, "user_id": 4025071, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/TZaTm.jpg?s=128&g=1", "display_name": "Jordan Davis", "link": "https://stackoverflow.com/users/4025071/jordan-davis"}, "reply_to_user": {"reputation": 976, "user_id": 1252194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/762692d3f4a23d9a52b315c95f1f64b9?s=128&d=identicon&r=PG", "display_name": "x539", "link": "https://stackoverflow.com/users/1252194/x539"}, "edited": false, "score": 0, "creation_date": 1443027936, "post_id": 32744248, "comment_id": 53331690, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/90456/discussion-between-jordan-davis-and-x539\">continue this discussion in chat</a>."}, {"owner": {"reputation": 1197, "user_id": 4025071, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/TZaTm.jpg?s=128&g=1", "display_name": "Jordan Davis", "link": "https://stackoverflow.com/users/4025071/jordan-davis"}, "edited": false, "score": 0, "creation_date": 1443028091, "post_id": 32744248, "comment_id": 53331767, "body": "getting back to my question at hand... the generic <code>osockaddr</code> structure is &quot;GENERIC&quot; meaning it can be used for any of the socket struct types including the <code>AF_INET</code> or IP address family socket... so I&#39;m simply looking for an example of using the <code>osockaddr</code> structure with the <code>AF_INET</code> or IP address family, do you know how?"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1443031939, "post_id": 32744248, "comment_id": 53333897, "body": "&quot;<i>how the hell my program will know what the socket(),bind(),etc function do</i> by calling the library code implementing what the headers prototype, with the latter being optional."}], "tags": [], "owner": {"reputation": 976, "user_id": 1252194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/762692d3f4a23d9a52b315c95f1f64b9?s=128&d=identicon&r=PG", "display_name": "x539", "link": "https://stackoverflow.com/users/1252194/x539"}, "is_accepted": true, "score": 0, "last_activity_date": 1443024236, "last_edit_date": 1443024236, "creation_date": 1443023832, "answer_id": 32744248, "question_id": 32743473, "link": "https://stackoverflow.com/questions/32743473/socket-programming-sys-socket-h/32744248#32744248", "title": "Socket Programming (sys/socket.h)", "body": "<p><code>netinet/in.h</code> is no <em>extra library</em>, it is just a sub-set of definitions part of the one library you are going to link against any way.</p>\n\n<p>This generic address is like an abstract-base-Class. You are not supposed to create it. You only use it if you do not care about what kind of address you have or if you want to accept any kind of address.</p>\n\n<p>Usage would look like this. </p>\n\n<pre><code>/* print any kind of socket address */\nvoid prettyPrintAddress(struct sockaddr *addr) {\n  switch (addr-&gt;sa_family) {\n     case AF_INET:\n       // Typocast to the actual type\n       struct sockaddr_in *in_addr = (struct sockaddr_in *)addr;\n       // print [ipv4]:protocl:ipv4:port\n       break;\n     case AF_INET6:\n       // Typocast to the actual type\n       struct sockaddr_in6 *in6_addr = (struct sockaddr_in6 *)addr;\n       // print [ipv6]:protocl:ipv6:port\n       break;\n     case AF_UNIX:\n       // Typocast to the actual type\n       struct sockaddr_un *un_addr = (struct sockaddr_un *)addr;\n       // print [unix]:socket-path\n       break;\n     ...\n  }\n}\n\nprettyPrintAddress(anyAddress);\nprettyPrintAddress((struct sockaddr *) in_addr);\nprettyPrintAddress((struct sockaddr *) in6_addr);\nprettyPrintAddress((struct sockaddr *) un_addr);\n</code></pre>\n"}], "owner": {"reputation": 1197, "user_id": 4025071, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/TZaTm.jpg?s=128&g=1", "display_name": "Jordan Davis", "link": "https://stackoverflow.com/users/4025071/jordan-davis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1902, "favorite_count": 0, "accepted_answer_id": 32744248, "answer_count": 2, "score": -1, "last_activity_date": 1443032080, "creation_date": 1443021575, "last_edit_date": 1443032080, "question_id": 32743473, "link": "https://stackoverflow.com/questions/32743473/socket-programming-sys-socket-h", "title": "Socket Programming (sys/socket.h)", "body": "<p>Looking at the generic socket struct defined <a href=\"http://pubs.opengroup.org/onlinepubs/7908799/xns/syssocket.h.html\" rel=\"nofollow\">sys/socket.h</a> spec it lists:</p>\n\n<pre><code>sa_family_t   sa_family       address family\nchar          sa_data[]       socket address (variable-length data)\n</code></pre>\n\n<p>Looking at my actual header file located at /usr/includes/sys/socket.h on my linux machine, it is defined as the following.</p>\n\n<pre><code> struct osockaddr\n      {\n        unsigned short int sa_family;\n        unsigned char sa_data[14];\n      };\n</code></pre>\n\n<p>Now I know if I include the  <a href=\"http://pubs.opengroup.org/onlinepubs/7908799/xns/netinetin.h.html\" rel=\"nofollow\">netinet/in.h</a> it will define a <code>sockaddr_in</code>  structure and since I'm using <code>AF_INET</code> it would make since to use this...</p>\n\n<pre><code>struct sockaddr_in {\n   short int            sin_family;\n   unsigned short int   sin_port;\n   struct in_addr       sin_addr;\n   unsigned char        sin_zero[8];\n};\n</code></pre>\n\n<p>However, I feel it is unnecessary to #include another lib (netinet/in.h) when I can simply use the generic <code>osockaddr</code> structure. </p>\n\n<hr>\n\n<p>Now I understand my <code>osockaddr</code> member <code>sa_family</code> will relate to <code>AF_INET</code> but I'm unclear what actually goes inside the <code>sa_data</code> member... I'm assuming <code>port,addr,zero</code> in relation to the <code>sockaddr_in</code> structure, but I am unclear.</p>\n\n<p><strong>Question:</strong> Can anyone give me an example of what using the generic <code>osockaddr</code> structure looks like?</p>\n\n<p>What I have so far....</p>\n\n<pre><code>#include&lt;sys/socket.h&gt;    \nint main(void){\n    struct osockaddr address;\n    address.sa_family = AF_INET;\n    address.sa_data = ? //What goes here (port, addr, zero)?\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["php", "c", "testing", "compilation", "development-environment"], "comments": [{"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1443022152, "post_id": 32743376, "comment_id": 53328143, "body": "That really depends on what you&#39;re doing. If you&#39;re working on a PHP extension, you can simply build the extension (which generally doesn&#39;t take longer than 1~2 minutes) by running <code>phpize &amp;&amp; .&#47;configure --enable-extname &amp;&amp; make &amp;&amp; make install</code>. Besides, <code>make</code> does keep track of what objects it should recompile, and which ones remained unchanged since last the code was compiled. Also: checking if <code>x == y</code> is something you don&#39;t do by adding code in C, you do that by using a debugger (like gdb)"}, {"owner": {"reputation": 6640, "user_id": 1692906, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1172ba118b72a3cb0c475516c91be2c1?s=128&d=identicon&r=PG", "display_name": "Flosculus", "link": "https://stackoverflow.com/users/1692906/flosculus"}, "reply_to_user": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1443022881, "post_id": 32743376, "comment_id": 53328588, "body": "@EliasVanOotegem I&#39;ve given it a try, its the core php-src I&#39;m looking into.  Following the instructions the build process was relatively straight forward.  Even after adding some arbitrary code to <code>zend.h</code>, although running <code>make</code> didn&#39;t do anything, running &#39;./configure; make&#39; does, and it was pretty quick.  Is this the correct procedure for compiling incremental changes?"}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1443024138, "post_id": 32743376, "comment_id": 53329464, "body": "running <code>.&#47;configure; make</code> seems a bit odd (sure it&#39;s not <code>.&#47;configure &amp;&amp; make</code>?), check <code>.&#47;configure --help</code>, and actually go through all the arguments you want/need to pass to <code>configure</code> (like which extensions to compile and which features you want enabled etc...). Then run <code>make</code> again"}], "answers": [{"comments": [{"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1443022443, "post_id": 32743735, "comment_id": 53328337, "body": "This doesn&#39;t answer the question <i>at all</i>. PHP already uses make as part of its build procedure, <a href=\"https://github.com/php/php-src\" rel=\"nofollow noreferrer\">check the src</a>. OP is wondering if there&#39;s an alternative to rebuilding the whole project whenever he changes something and wants to know it it works as expected. Besides: OP links to the build-setup page which <b><i>explicitly</i></b> states you need autotools (which includes automake + autoconf) to build PHP"}, {"owner": {"reputation": 6640, "user_id": 1692906, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1172ba118b72a3cb0c475516c91be2c1?s=128&d=identicon&r=PG", "display_name": "Flosculus", "link": "https://stackoverflow.com/users/1692906/flosculus"}, "edited": false, "score": 0, "creation_date": 1443023605, "post_id": 32743735, "comment_id": 53329091, "body": "Well it looks good, true I know php-src already has &quot;make&quot;, but it is good to know it does perform partial compilations.  I don&#39;t think it would be a too specific a question if I asked for a typical build process for php-src, since it is a pretty common domain.  If this answer could be modified to detail the steps in developing and testing that project, I would greatly appreciate it, it wouldn&#39;t need to be overly expansive, I can always fill in the gaps."}], "tags": [], "owner": {"reputation": 597, "user_id": 4304746, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100005754678803/picture?type=large", "display_name": "Baroudi Safwen", "link": "https://stackoverflow.com/users/4304746/baroudi-safwen"}, "is_accepted": false, "score": 1, "last_activity_date": 1443022344, "creation_date": 1443022344, "answer_id": 32743735, "question_id": 32743376, "link": "https://stackoverflow.com/questions/32743376/testing-as-you-code-on-large-c-projects/32743735#32743735", "title": "Testing as you code on large C projects", "body": "<p>i think make is what you need.<br>\n<a href=\"https://www.gnu.org/software/make/\" rel=\"nofollow\">https://www.gnu.org/software/make/</a><br>\nand the documentaion is at <br>\n<a href=\"http://www.gnu.org/software/make/manual/make.html\" rel=\"nofollow\">http://www.gnu.org/software/make/manual/make.html</a><br>\nso you have many large source files, and you made a small change in just one of them, make will only recompile that source file since the others are up to date.<br>\nback in the time i built a mini \"shell\", here is the makefile:</p>\n\n<pre><code>CFLAGS=-g -O2 -Werror -Wfatal-errors \nOBJECTS=parser.o analyser.o processing.o prompt.o\nLINK=-lfl\nshell: $(OBJECTS)\n        gcc $(CFLAGS) $(OBJECTS) $(LINK) -o shell\nparser.o: shell.y \n        bison -d shell.y\n        gcc $(CFLAGS) -c shell.tab.c -o parser.o\nanalyser.o: shell.l\n        flex shell.l\n        gcc $(CFLAGS) -c lex.yy.c -o analyser.o\nprocessing.o:processing.c processing.h\n        gcc $(CFLAGS) -c processing.c -o processing.o\nprompt.o: prompt.c prompt.h\n        gcc $(CFLAGS) -c prompt.c -o prompt.o\nclean: \n        rm -f $(OBJECTS) shell.tab.c lex.yy.c shell.tab.h\n</code></pre>\n\n<p>so if i made a change in processing.c, make will only rebuild processing.o and then re-link the project.<br>\nso a make file consists of rules :<br></p>\n\n<pre>\n> target : prerequisite<br>\n           recipe<br>\n</pre>\n\n<p>make needs prerequisite to build target using recipe.<br>\nfinally, if you want to remove the object files, you can add a \"clean\" rule and then run :<br></p>\n\n<pre><code>make clean\n</code></pre>\n"}], "owner": {"reputation": 6640, "user_id": 1692906, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1172ba118b72a3cb0c475516c91be2c1?s=128&d=identicon&r=PG", "display_name": "Flosculus", "link": "https://stackoverflow.com/users/1692906/flosculus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1443022344, "creation_date": 1443021290, "question_id": 32743376, "link": "https://stackoverflow.com/questions/32743376/testing-as-you-code-on-large-c-projects", "title": "Testing as you code on large C projects", "body": "<p>I've been having a look over the PHP-SRC project, and I've read over the brief development guide at: <a href=\"http://php.net/build-setup.php\" rel=\"nofollow\">http://php.net/build-setup.php</a></p>\n\n<p>However being relatively new to C (but not new to programming), I am a little taken aback by the thought that I need to recompile every time I need to test a change.</p>\n\n<p>When writing in PHP, I can bolt on a small snippet to see if <code>x == y</code> at a certain point of execution and test it almost immediately.  But before I start diving in a project as large as PHP, I want to know if I am mistaken in that I would need to build the entirety of the source to test small changes.</p>\n\n<p>Is there a stage in the build process where small changes can be compiled into an existing binary without waiting 10-20 minutes every time?</p>\n"}, {"tags": ["c", "arm", "microcontroller", "c-preprocessor", "gcc4.7"], "comments": [{"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 0, "creation_date": 1443022207, "post_id": 32743214, "comment_id": 53328173, "body": "What , with <code>#define</code> you wan to specify that ? its unclear ."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1443022221, "post_id": 32743214, "comment_id": 53328185, "body": "There&#39;s no <i>simple</i> way. You can use the <a href=\"http://www.boost.org/doc/libs/1_59_0/libs/preprocessor/doc/\" rel=\"nofollow noreferrer\">Boost preprocessing macro library</a> but I suppose that counts as &quot;extra libraries&quot;"}, {"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 0, "creation_date": 1443022433, "post_id": 32743214, "comment_id": 53328333, "body": "Dunno if this counts as an &quot;extra&quot; libary but m4 might do the job: <a href=\"http://www.gnu.org/software/m4/m4.html\" rel=\"nofollow noreferrer\">gnu.org/software/m4/m4.html</a>"}, {"owner": {"reputation": 487, "user_id": 2165027, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/9z8QN.jpg?s=128&g=1", "display_name": "Darko P.", "link": "https://stackoverflow.com/users/2165027/darko-p"}, "reply_to_user": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 0, "creation_date": 1443022773, "post_id": 32743214, "comment_id": 53328522, "body": "@ameyCU the #define for the number of repetition. Yes I&#39;d like to know first if it&#39;s possible without extra libraries."}], "answers": [{"comments": [{"owner": {"reputation": 487, "user_id": 2165027, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/9z8QN.jpg?s=128&g=1", "display_name": "Darko P.", "link": "https://stackoverflow.com/users/2165027/darko-p"}, "edited": false, "score": 1, "creation_date": 1443025332, "post_id": 32743844, "comment_id": 53330220, "body": "This is the simplest way. However I had to remove ## on each repeat otherwise I&#39;ve the error: does not give a valid preprocessing token. (don&#39;t know why) Furthermore, in order to use a #define instead of the numerical value, I defined the helper: #define REPEAT_HELPER(s, n) REPEAT##n(s) #define REPEAT(s, n) REPEAT_HELPER(s, n). I&#39;d have liked to not to write explicitly the nested repeat but its seems that without extra libraries we couldn&#39;t do otherwise."}], "tags": [], "owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "is_accepted": true, "score": 3, "last_activity_date": 1443025553, "last_edit_date": 1443025553, "creation_date": 1443022643, "answer_id": 32743844, "question_id": 32743214, "link": "https://stackoverflow.com/questions/32743214/c-preprocessor-dynamic-const-char/32743844#32743844", "title": "C Preprocessor: dynamic const char", "body": "<p>This can give you a clue:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define repeat1(s) s\"1\\0\"\n#define repeat2(s) repeat1(s)s\"2\\0\" \n#define repeat3(s) repeat2(s)s\"3\\0\" \n#define repeat4(s) repeat3(s)s\"4\\0\" \n#define repeat5(s) repeat4(s)s\"5\\0\"\n#define repeat6(s) repeat5(s)s\"6\\0\" \n#define repeat7(s) repeat6(s)s\"7\\0\" \n#define repeat8(s) repeat7(s)s\"8\\0\" \n#define repeat9(s) repeat8(s)s\"9\\0\" \n\n#define repeat(s, n) repeat##n(s)\n\nint main(void)\n{\n    printf(\"%s\\n\", repeat(\"repr\", 5));\n    return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>printf(\"%s\\n\", \"repr\"\"1\\0\"\"repr\"\"2\\0\"\"repr\"\"3\\0\"\"repr\"\"4\\0\"\"repr\"\"5\\0\");\n</code></pre>\n\n<p>Note that this version is limited to 9 strings.</p>\n"}, {"comments": [{"owner": {"reputation": 487, "user_id": 2165027, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/9z8QN.jpg?s=128&g=1", "display_name": "Darko P.", "link": "https://stackoverflow.com/users/2165027/darko-p"}, "edited": false, "score": 0, "creation_date": 1443025571, "post_id": 32744356, "comment_id": 53330365, "body": "Thanks for this more elaborated way. Its interesting I didn&#39;t know awk. But it requires more knowledge and its not what I&#39;m looking for ;)"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 487, "user_id": 2165027, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/9z8QN.jpg?s=128&g=1", "display_name": "Darko P.", "link": "https://stackoverflow.com/users/2165027/darko-p"}, "edited": false, "score": 0, "creation_date": 1443029993, "post_id": 32744356, "comment_id": 53332754, "body": "@dark0: It doesn&#39;t have to be awk, but awk is a tool almost always present, even on embedded systems. It helps to have <code>make</code> when you&#39;re using external preprocessing scripts; again, there is almost always some kind of make tool, and a preprocessing step is usually not complicated to add to a build configuration. The advantage of external preprocessors is that you don&#39;t have to fight with the peculiarities of the C preprocessor -- for example, you can do loops and perform arithmetic in a straightforward way -- and they don&#39;t have limitations like &quot;no more than 9&quot; (or 256 with boostpp)."}, {"owner": {"reputation": 487, "user_id": 2165027, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/9z8QN.jpg?s=128&g=1", "display_name": "Darko P.", "link": "https://stackoverflow.com/users/2165027/darko-p"}, "edited": false, "score": 0, "creation_date": 1443081993, "post_id": 32744356, "comment_id": 53352114, "body": "You&#39;re right. This seems the most efficient way to do that. I don&#39;t know actually how to implement that since the make files are generated automatically by the IDE. But I take note of your solution and guess that I&#39;m gonna use it one day if not immediately."}], "tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": false, "score": 1, "last_activity_date": 1443025335, "last_edit_date": 1443025335, "creation_date": 1443024154, "answer_id": 32744356, "question_id": 32743214, "link": "https://stackoverflow.com/questions/32743214/c-preprocessor-dynamic-const-char/32744356#32744356", "title": "C Preprocessor: dynamic const char", "body": "<p>The simplest way to do this would be to use a custom preprocessing script, which you could integrate into your build process. </p>\n\n<p>I don't know what tools you have available, but you could easily use <code>awk</code> as a preprocessor. If you're using <code>make</code>, you could build the <code>c</code> file automatically from a skeleton: (See below for the original awk script.)</p>\n\n<pre><code>file.c: file.c.in\n        awk '                                          \\\n        /^#define X / {                                \\\n           for (i = 1; i &lt;= $$3; ++i)                  \\\n             s = s \"\\\"repr\"i\"\\\\0\\\"\"                    \\\n           }                                           \\\n        match($$0, / *const char \\*reprx\\[\\] = /)  {   \\\n           $$0 = substr($$0, 1, RLENGTH) s \";\"         \\\n        }                                              \\\n        1' $^ &gt; $@\n</code></pre>\n\n<p>Example:</p>\n\n<pre><code>$ cat file.c.in\n/* The beginning of the program */\n#define X 7\n/* Some part of the program */\nconst char *reprx[] = \"Will be replaced\";\n/* The rest of the program */\n\n$ make -s file.c\n$ cat file.c\n/* The beginning of the program */\n#define X 7\n/* Some part of the program */\nconst char *reprx[] = \"repr1\\0\"\"repr2\\0\"\"repr3\\0\"\"repr4\\0\"\"repr5\\0\"\"repr6\\0\"\"repr7\\0\";\n/* The rest of the program */\n</code></pre>\n\n<hr>\n\n<p>Since it is a little obscured by the need to escape dollar signs and line endings, here's the original awk program:</p>\n\n<pre><code>awk '/^#define X / {\n        for (i = 1; i &lt;= $3; ++i)\n            s = s \"\\\"repr\"i\"\\\\0\\\"\"\n        }\n     match($0, / *const char \\*reprx\\[\\] = /)  {\n        $0 = substr($0, 1, RLENGTH) s \";\"\n     }\n     1'\n</code></pre>\n"}], "owner": {"reputation": 487, "user_id": 2165027, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/9z8QN.jpg?s=128&g=1", "display_name": "Darko P.", "link": "https://stackoverflow.com/users/2165027/darko-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 205, "favorite_count": 0, "accepted_answer_id": 32743844, "answer_count": 2, "score": 2, "last_activity_date": 1443025553, "creation_date": 1443020906, "question_id": 32743214, "link": "https://stackoverflow.com/questions/32743214/c-preprocessor-dynamic-const-char", "title": "C Preprocessor: dynamic const char", "body": "<p>I'd like to create dynamically a <code>const char</code> at compilation time as follow:</p>\n\n<pre><code>const char reprx[] = \"repr1\\0repr2\\0repr3\\0repr4\\0\";\n</code></pre>\n\n<p>and with a #define to specify the number of time the string <code>reprX\\0</code> is repeated within the string (by replacing X with a increment value). For example for 5:</p>\n\n<pre><code>const char reprx[] = \"repr1\\0repr2\\0repr3\\0repr4\\0repr5\\0\";\n</code></pre>\n\n<p>Is there a simple way to do that? (without extra libraries)</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 0, "creation_date": 1443021055, "post_id": 32743211, "comment_id": 53327357, "body": "<code>1&#47;mu</code> doesn&#39;t make sense to me if <code>mu</code> is a <code>float*</code>. Clarify your question, please."}, {"owner": {"reputation": 20231, "user_id": 1342730, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/36543a7316596ec6e930bc8c996bf14b?s=128&d=identicon&r=PG", "display_name": "mathematician1975", "link": "https://stackoverflow.com/users/1342730/mathematician1975"}, "edited": false, "score": 2, "creation_date": 1443021382, "post_id": 32743211, "comment_id": 53327573, "body": "Unrelated but you realise your function masks the input variable <code>bl</code> when you redeclare it inside the function scope?"}, {"owner": {"reputation": 91, "user_id": 5252300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ce020f3eec4a674d5b095a16f4fc628f?s=128&d=identicon&r=PG&f=1", "display_name": "physicist", "link": "https://stackoverflow.com/users/5252300/physicist"}, "edited": false, "score": 0, "creation_date": 1443021663, "post_id": 32743211, "comment_id": 53327768, "body": "I know, but if it had been a float i would have done it in that way. I ask if there is a way to do it providing it is a <code>float*</code>."}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 2, "creation_date": 1443022466, "post_id": 32743211, "comment_id": 53328353, "body": "If you&#39;re just trying to avoid division, don&#39;t -- you&#39;ll end up moving the division to where you find the inverse instead of the expression in the loop, but you&#39;ll still need it... so you&#39;re just adding in unnecessary multiplication without saving anything."}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1443022602, "post_id": 32743211, "comment_id": 53328420, "body": "Do you want the inverse only within the function, or do you want the array modified for the caller (and possibly beyond) as well?"}, {"owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "reply_to_user": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 1, "creation_date": 1443024258, "post_id": 32743211, "comment_id": 53329537, "body": "@Dmitri Agreed, unless the function <code>norm2</code> is being called in a loop with the same <code>mu</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1443026097, "post_id": 32743211, "comment_id": 53330679, "body": "Note: <code>int bl = i&#47;nav;</code> is suspicious.  1) hides function <code>bl</code>m 2) <code>nav</code> not declared. 3) Unless <code>nav == 1</code> all of <code>mu</code> not used."}, {"owner": {"reputation": 91, "user_id": 5252300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ce020f3eec4a674d5b095a16f4fc628f?s=128&d=identicon&r=PG&f=1", "display_name": "physicist", "link": "https://stackoverflow.com/users/5252300/physicist"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1443048095, "post_id": 32743211, "comment_id": 53341882, "body": "@chux, you&#39;re right, I&#39;ve made some mistakes."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1443048522, "post_id": 32743211, "comment_id": 53342029, "body": "Say <code>N=100, nav = 1,10 or 30</code>.  With <code>nav = 1</code>, <code>mu[0] to mu[99]</code> needed. With <code>nav = 10</code>, <code>mu[0] to mu[9]</code> needed.  With <code>nav = 30</code>, <code>mu[0] to mu[3]</code> needed.  So the pre-divide may not need to form all <code>mu[]</code>."}], "answers": [{"comments": [{"owner": {"reputation": 177, "user_id": 1456519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58be97c1b5e6f1ae4eb7b09c89d8bf9e?s=128&d=identicon&r=PG", "display_name": "Victor Burenkov", "link": "https://stackoverflow.com/users/1456519/victor-burenkov"}, "edited": false, "score": 0, "creation_date": 1443023149, "post_id": 32743526, "comment_id": 53328759, "body": "Will not work, trying to use &amp;mu_inv as an array in norm2 will cause memory violation."}, {"owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "edited": false, "score": 0, "creation_date": 1443024130, "post_id": 32743526, "comment_id": 53329456, "body": "This is what the OP wanted i guess, but in reality this wont save any time right? You still do the divide which will be the long part, plus now we allocate an array as well. I guess maybe if we call <code>norm2</code> in a loop or something with the same <code>mu_inv</code> ..."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "edited": false, "score": 1, "creation_date": 1443024695, "post_id": 32743526, "comment_id": 53329827, "body": "@Ben, this is one way to get the computation right. Whether the cost of allocating/deallocating memory and computing the inverse is an obstacle is not clear from the OP&#39;s question."}, {"owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "edited": false, "score": 0, "creation_date": 1443024782, "post_id": 32743526, "comment_id": 53329877, "body": "@RSahu I agree, just thought it would be worth mentioning that this wont actually save any time, but it will move the divide from inside to outside the function which answers the question."}, {"owner": {"reputation": 91, "user_id": 5252300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ce020f3eec4a674d5b095a16f4fc628f?s=128&d=identicon&r=PG&f=1", "display_name": "physicist", "link": "https://stackoverflow.com/users/5252300/physicist"}, "reply_to_user": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "edited": false, "score": 0, "creation_date": 1443047907, "post_id": 32743526, "comment_id": 53341818, "body": "Thank you for your response.  @Ben, I use Nvidia&#39;s CUDA, dividing on GPU is very inefficient so I&#39;m trying to accelerate it."}, {"owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "reply_to_user": {"reputation": 91, "user_id": 5252300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ce020f3eec4a674d5b095a16f4fc628f?s=128&d=identicon&r=PG&f=1", "display_name": "physicist", "link": "https://stackoverflow.com/users/5252300/physicist"}, "edited": false, "score": 0, "creation_date": 1443048416, "post_id": 32743526, "comment_id": 53341994, "body": "@physicist You will still be doing the divide? is only <code>norm2</code> run on the GPU?"}, {"owner": {"reputation": 91, "user_id": 5252300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ce020f3eec4a674d5b095a16f4fc628f?s=128&d=identicon&r=PG&f=1", "display_name": "physicist", "link": "https://stackoverflow.com/users/5252300/physicist"}, "reply_to_user": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "edited": false, "score": 0, "creation_date": 1443050675, "post_id": 32743526, "comment_id": 53342678, "body": "@Ben, yes, only <code>norm2</code> runs on GPU and somehow it&#39;s faster."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 3, "last_activity_date": 1443023617, "last_edit_date": 1443023617, "creation_date": 1443021700, "answer_id": 32743526, "question_id": 32743211, "link": "https://stackoverflow.com/questions/32743211/how-to-pass-a-pointer-of-the-inverse-array-to-a-funtion/32743526#32743526", "title": "How to pass a pointer of the inverse array to a funtion?", "body": "<p>Use:</p>\n\n<pre><code>// Allocate an array to hold the inverse of mu\nfloat* mu_inv = malloc(N*sizeof(*mu_inv));\n\n// Compute the inverse of mu and assign it to the newly allocated array.\nfor ( int i = 0; i &lt; N; ++i )\n{\n   mu_inv[i] = 1.0f/mu[i];\n}\n\n// Call norm2 with the inverse of mu\nnorm2(F, mu_inv, N, bl);\n\n// Deallocate memory\nfree(mu_inv);\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 5252300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ce020f3eec4a674d5b095a16f4fc628f?s=128&d=identicon&r=PG&f=1", "display_name": "physicist", "link": "https://stackoverflow.com/users/5252300/physicist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 32743526, "answer_count": 1, "score": 0, "last_activity_date": 1443048001, "creation_date": 1443020899, "last_edit_date": 1443048001, "question_id": 32743211, "link": "https://stackoverflow.com/questions/32743211/how-to-pass-a-pointer-of-the-inverse-array-to-a-funtion", "title": "How to pass a pointer of the inverse array to a funtion?", "body": "<p>Is it possible to make an inversion of <code>mu</code> while passing pointer to a function? There is an original function:</p>\n\n<pre><code>void norm1(float *F, float *mu, int N, int nav) {\n  for (int i=0; i&lt;N; i++) {\n    int bl = i/nav;\n    F[i] *= 2*nav / mu[bl];\n  }\n}\n</code></pre>\n\n<p>I want to have something like this:</p>\n\n<pre><code>void norm2(float *F, float *mu, int N, int nav) {\n  for (int i=0; i&lt;N; i++) {\n    int bl = i/nav;\n    F[i] *= 2*nav * mu[bl];\n  }\n}\n</code></pre>\n\n<p>Of course, when I call it in that way: <code>norm2(F, 1/mu, N, nav);</code> it doesn't work, but i hope you will know what i want to do</p>\n"}, {"tags": ["c++", "c", "windows", "hook", "reverse-engineering"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1443020642, "post_id": 32743059, "comment_id": 53327037, "body": "This does not look like C++ code. Do not add irrelevant tags."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1502256"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1443020827, "post_id": 32743059, "comment_id": 53327172, "body": "@Olaf It can be either C++ or C as you probably know. Do not add irrelevant comments."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1443034139, "post_id": 32743059, "comment_id": 53335134, "body": "An answer might depend on the actual language, as you probably know. If not, you apparently do not know C++. However, you are invoking undefined bahaviour, so there is no use in further investigation."}], "answers": [{"tags": [], "owner": {"reputation": 1434, "user_id": 4928207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/122e2222eb8cace8c9d2e67ea65d8c47?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Jansen", "link": "https://stackoverflow.com/users/4928207/mark-jansen"}, "is_accepted": true, "score": 1, "last_activity_date": 1444290824, "creation_date": 1444290824, "answer_id": 33009802, "question_id": 32743059, "link": "https://stackoverflow.com/questions/32743059/function-hook-address-copied-incorrect/33009802#33009802", "title": "Function hook address copied incorrect", "body": "<p>A <code>jmp dword</code> instruction has a 2-byte opcode, you only skip one byte of this. \n(See the <code>#define FUNC_ADDR   (FUNC_JMP+1)</code></p>\n\n<p>So you are overwriting a part of the instruction, and ignoring a part of the address.\nThis is also indicated by the second instruction you posted, because now it's an <code>jmp fword</code> instead of <code>jmp dword</code>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user1502256"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 33009802, "answer_count": 1, "score": 1, "last_activity_date": 1444290824, "creation_date": 1443020486, "question_id": 32743059, "link": "https://stackoverflow.com/questions/32743059/function-hook-address-copied-incorrect", "title": "Function hook address copied incorrect", "body": "<p>I am trying to hook an application with a dll I injected. At the moment the dll contains a hook, a function trampoline and an empty function. However the target application crashes when the hooked function is called. I looked what went wrong and it seems that the replaced jump instruction jumps to an unknown place I didn't specify. Upon closer inspection I realized that this unknown address look remarkably similar to the correct one. It seems like the unknown address is the correct address shifted to the right with 4 junk bits in front of it. So my question is how did this happen and can I correct this?</p>\n\n<pre><code>#define FUNC_JMP    0x00433504\n#define FUNC_ADDR   (FUNC_JMP+1)\n\n// Trampoline\n__declspec(naked) void setup (void) { ... }    \n\nvoid hook (void)\n{\n    DWORD protect, buf;\n    DWORD adr = (DWORD) ((BYTE*) &amp;setup - (FUNC_ADDR + 4));\n\n    VirtualProtect ((void*) FUNC_ADDR, 4, PAGE_EXECUTE_READWRITE, &amp;protect);\n    memcpy ((void*) FUNC_ADDR, &amp;adr, 4);\n    VirtualProtect ((void*) FUNC_ADDR, 4, protect, &amp;buf);\n}\n</code></pre>\n\n<p>Before 0x00433504: <code>jmp    dword ptr ds:[0x1F8BAC4]</code></p>\n\n<p>After  0x00433504: <code>jmp    fword ptr ds:[0x10B51DC]</code></p>\n\n<p>Actual value of adr: <code>0x0B51DC2D</code></p>\n\n<p>TLDR; Why is the value I memcpy'd incomplete and shifted 4 bits to the right.</p>\n"}, {"tags": ["c", "factorial"], "comments": [{"owner": {"reputation": 3870, "user_id": 2336725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20a0b96a26cf233d752469445595f872?s=128&d=identicon&r=PG", "display_name": "Teepeemm", "link": "https://stackoverflow.com/users/2336725/teepeemm"}, "edited": false, "score": 0, "creation_date": 1443019689, "post_id": 32742716, "comment_id": 53326329, "body": "Your question almost makes sense, but not quite.  &quot;limit the n to [0.999]&quot; and &quot;transform the n to [0,9999]&quot; are confusing."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1443019931, "post_id": 32742716, "comment_id": 53326506, "body": "1) Do not cast the result of <code>malloc</code> in C. 2) Do not write <code>type* ptr</code>, but <code>type *ptr</code>. This is no difference for the compiler, but it visually binds <code>*</code> to the type, not the name as it is fo rhte compiler (try <code>int* ip, i</code>: <code>i</code> is not a pointer as <code>int*</code> imlies to the reader). 3) Do not <code>typedef</code> a pointer! This hides the semantics and makes your code more complicated to read/understand. Only <code>typedef</code> normal types and use pointers explicitly. 4) you should use unsigned types. They have a well defined overflow behaviour."}, {"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 0, "creation_date": 1443021083, "post_id": 32742716, "comment_id": 53327375, "body": "What does happen when the program limiting <code>n</code> to <code>[0,999]</code> tries to calculate <code>2000!</code>? does it crash, or give a wrong answer? In what way is the answer wrong? Maybe post a complete (including whatever calls <code>factorial()</code>) program that shows the problem."}, {"owner": {"reputation": 733, "user_id": 4911018, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0a8ba726c789d8ae78654b961597d717?s=128&d=identicon&r=PG&f=1", "display_name": "tian tong", "link": "https://stackoverflow.com/users/4911018/tian-tong"}, "edited": false, "score": 0, "creation_date": 1443021357, "post_id": 32742716, "comment_id": 53327559, "body": "If n is [0,999] then it will give a wrong answer to 2000. Thanks very much for your suggestion for my code style for Olaf."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1443023580, "post_id": 32742716, "comment_id": 53329067, "body": "<a href=\"http://stackoverflow.com/q/605845/995714\">Don&#39;t cast the result of <code>malloc</code> in C</a>"}, {"owner": {"reputation": 3871, "user_id": 1376947, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/LzOQ0.jpg?s=128&g=1", "display_name": "icl7126", "link": "https://stackoverflow.com/users/1376947/icl7126"}, "edited": false, "score": 0, "creation_date": 1443031402, "post_id": 32742716, "comment_id": 53333575, "body": "This reminds me the time when I tried to compute factorial of one million (1 000 000!). I used different approach but I was able to get result in several hours using server at my work. Result is 5 565 709 digits long and ends with 249 998 zeros.Check it out <a href=\"https://www.dropbox.com/s/9uj86x7y9qrhsmx/factorial%201%20000%20000.txt?dl=0\" rel=\"nofollow noreferrer\">here</a>"}], "answers": [{"comments": [{"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 0, "creation_date": 1443020672, "post_id": 32742949, "comment_id": 53327056, "body": "The OP&#39;s question indicates that calculating <code>10000!</code> using 4 digit clusters in the node works, but that the code doesn&#39;t work when using 3 digit clusters in the node for  even <code>2000!</code>, which has something less than 6000 digits."}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "reply_to_user": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 0, "creation_date": 1443021420, "post_id": 32742949, "comment_id": 53327599, "body": "@MichaelBurr Ah, I read the thread of comments now, and I see what he&#39;s talking about. Will edit."}], "tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": true, "score": 10, "last_activity_date": 1443022439, "last_edit_date": 1443022439, "creation_date": 1443020186, "answer_id": 32742949, "question_id": 32742716, "link": "https://stackoverflow.com/questions/32742716/10000-factorial-in-c/32742949#32742949", "title": "10000 factorial in C", "body": "<p>The problem with limiting your digit cluster to three digits is that multiplying a three-digit number by a value above 1,000 may produces a carry into digit number four.</p>\n\n<p>Although this does not create an immediate problem, the error will accumulate as you carry the value up the computation chain. With more than 5,000 digits in the result of 2000! the carry overflow would certainly produce a visible error in the result. This happens around 1258-th step of the computation of 2000!.</p>\n\n<p>This does not happen with four-digit clusters and 10,000 because the only place where the carry could \"spill\" into the next digit is the computation of the very last cluster, and <code>long long</code> has plenty of space to accommodate this without an overflow.</p>\n"}], "owner": {"reputation": 733, "user_id": 4911018, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0a8ba726c789d8ae78654b961597d717?s=128&d=identicon&r=PG&f=1", "display_name": "tian tong", "link": "https://stackoverflow.com/users/4911018/tian-tong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1615, "favorite_count": 2, "accepted_answer_id": 32742949, "answer_count": 1, "score": 12, "last_activity_date": 1452676257, "creation_date": 1443019538, "last_edit_date": 1452676257, "question_id": 32742716, "link": "https://stackoverflow.com/questions/32742716/10000-factorial-in-c", "title": "10000 factorial in C", "body": "<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nstruct node;\ntypedef struct node* PtrToNode;\n\nstruct node {\n  long long n;\n  PtrToNode next;\n};\n\nPtrToNode factorial(int n, PtrToNode init);\nvoid multiply(long long n, PtrToNode init, long long carry);\n\nint main() {\n  int n;\n  while (1) {\n    scanf(\"%d\", &amp;n);\n    if (n &gt; 0) {\n      break;\n    } else if (n == 0){\n      printf(\"1\\n\");\n      return 0;\n    } else {\n      printf(\"Retry.\\n\");\n    }\n  }\n  PtrToNode init = malloc(sizeof(struct node));\n  init-&gt;n = 1;\n  init-&gt;next = NULL;\n  PtrToNode head = factorial(n, init);\n  PtrToNode tail = reverse(head);\n  PtrToNode backup = tail;\n  printf(\"%lld\", tail-&gt;n);\n  tail = tail-&gt;next;\n  while(tail != NULL) {\n    printf(\"%04lld\", tail-&gt;n);\n    tail = tail-&gt;next;\n  }\n  PtrToNode t;\n  while (backup != NULL) {\n    t = backup;\n    backup = backup-&gt;next;\n    free(t);\n  }\n}\n\n\nPtrToNode factorial(int n, PtrToNode init) {\n  for (int i = 1; i &lt;= n; i++)\n    multiply(i, init, 0);\n  return init;\n}\n\nvoid multiply(long long n, PtrToNode init, long long carry) {\n  long long temp = n * init-&gt;n + carry;\n  init-&gt;n = temp % 10000;\n  carry = temp / 10000;\n  if (init-&gt;next != NULL) {\n    multiply(n, init-&gt;next, carry);\n  } else if (carry &gt; 0) {\n    init-&gt;next = malloc(sizeof(struct node));\n    init-&gt;next-&gt;n = carry;\n    init-&gt;next-&gt;next = NULL;\n  } else {\n    return;\n  }\n}\n</code></pre>\n\n<p>This is my function to calculate 10000 factorial, and I have calculated the correct answer compared to online data. But, when I limit the n's range to [0.999], I can't even calculate 2000 factorial. Why when I transform the n' range to [0, 9999], then it can calculate 2000! even 10000!?</p>\n"}, {"tags": ["sql", "c", "oracle", "oracle-call-interface"], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 5351080, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/b9f3924696bfefdb69ccf0f5720fc707?s=128&d=identicon&r=PG&f=1", "display_name": "Imran", "link": "https://stackoverflow.com/users/5351080/imran"}, "edited": false, "score": 0, "creation_date": 1443019375, "post_id": 32742625, "comment_id": 53326047, "body": "so, If i want to fetch more than 25k records what should I do?"}, {"owner": {"reputation": 1176, "user_id": 983859, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/vPKbq.png?s=128&g=1", "display_name": "Amit Raj", "link": "https://stackoverflow.com/users/983859/amit-raj"}, "reply_to_user": {"reputation": 75, "user_id": 5351080, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/b9f3924696bfefdb69ccf0f5720fc707?s=128&d=identicon&r=PG&f=1", "display_name": "Imran", "link": "https://stackoverflow.com/users/5351080/imran"}, "edited": false, "score": 0, "creation_date": 1443019488, "post_id": 32742625, "comment_id": 53326140, "body": "@imran You need to add where condition in the second query(SELECT id FROM idmap_id_1) so that you will get less records"}, {"owner": {"reputation": 75, "user_id": 5351080, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/b9f3924696bfefdb69ccf0f5720fc707?s=128&d=identicon&r=PG&f=1", "display_name": "Imran", "link": "https://stackoverflow.com/users/5351080/imran"}, "edited": false, "score": 0, "creation_date": 1443019573, "post_id": 32742625, "comment_id": 53326222, "body": "ok, and if I want 100000 records what approach should I take?"}, {"owner": {"reputation": 75, "user_id": 5351080, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/b9f3924696bfefdb69ccf0f5720fc707?s=128&d=identicon&r=PG&f=1", "display_name": "Imran", "link": "https://stackoverflow.com/users/5351080/imran"}, "edited": false, "score": 0, "creation_date": 1443019801, "post_id": 32742625, "comment_id": 53326412, "body": "I think I am not clear with my question. If I cannot fetch more than 25k records then yes, I will add rownum &lt;= 25000. But if i want all 100000 then what should I do?"}, {"owner": {"reputation": 1176, "user_id": 983859, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/vPKbq.png?s=128&g=1", "display_name": "Amit Raj", "link": "https://stackoverflow.com/users/983859/amit-raj"}, "reply_to_user": {"reputation": 75, "user_id": 5351080, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/b9f3924696bfefdb69ccf0f5720fc707?s=128&d=identicon&r=PG&f=1", "display_name": "Imran", "link": "https://stackoverflow.com/users/5351080/imran"}, "edited": false, "score": 0, "creation_date": 1443019867, "post_id": 32742625, "comment_id": 53326458, "body": "It is Oracle limitation. If you satisfy with my answer then please accept my answer."}, {"owner": {"reputation": 75, "user_id": 5351080, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/b9f3924696bfefdb69ccf0f5720fc707?s=128&d=identicon&r=PG&f=1", "display_name": "Imran", "link": "https://stackoverflow.com/users/5351080/imran"}, "edited": false, "score": 0, "creation_date": 1443020198, "post_id": 32742625, "comment_id": 53326694, "body": "Just a bit more information. Is it a C specific limitation because I can get all rows in the SQL Developer"}, {"owner": {"reputation": 1176, "user_id": 983859, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/vPKbq.png?s=128&g=1", "display_name": "Amit Raj", "link": "https://stackoverflow.com/users/983859/amit-raj"}, "reply_to_user": {"reputation": 75, "user_id": 5351080, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/b9f3924696bfefdb69ccf0f5720fc707?s=128&d=identicon&r=PG&f=1", "display_name": "Imran", "link": "https://stackoverflow.com/users/5351080/imran"}, "edited": false, "score": 0, "creation_date": 1443020296, "post_id": 32742625, "comment_id": 53326769, "body": "I got the same problem in VB6.0"}, {"owner": {"reputation": 160176, "user_id": 266304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bdb6217d08dcea7d67ff75f5f255081?s=128&d=identicon&r=PG", "display_name": "Alex Poole", "link": "https://stackoverflow.com/users/266304/alex-poole"}, "edited": false, "score": 0, "creation_date": 1443021628, "post_id": 32742625, "comment_id": 53327741, "body": "You haven&#39;t explained why. Is that really an Oracle limitation - if so where is it documented? Isn&#39;t it more likely to be a problem with memory management and the size of the structures breaking some O/S limit? Do different platforms behave differently? E.g. Windows vs. Unix, 32-bit vs 64-bit, etc.?"}], "tags": [], "owner": {"reputation": 1176, "user_id": 983859, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/vPKbq.png?s=128&g=1", "display_name": "Amit Raj", "link": "https://stackoverflow.com/users/983859/amit-raj"}, "is_accepted": false, "score": 0, "last_activity_date": 1443019266, "creation_date": 1443019266, "answer_id": 32742625, "question_id": 32742589, "link": "https://stackoverflow.com/questions/32742589/oracle-oci-error-segmentation-fault-core-dumped-when-fetching-100000-rows/32742625#32742625", "title": "Oracle OCI Error: Segmentation fault (core dumped) when fetching 100000 rows", "body": "<p>You can not fetch more than 25000 records.</p>\n"}], "owner": {"reputation": 75, "user_id": 5351080, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/b9f3924696bfefdb69ccf0f5720fc707?s=128&d=identicon&r=PG&f=1", "display_name": "Imran", "link": "https://stackoverflow.com/users/5351080/imran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 431, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1443024695, "creation_date": 1443019146, "last_edit_date": 1443024695, "question_id": 32742589, "link": "https://stackoverflow.com/questions/32742589/oracle-oci-error-segmentation-fault-core-dumped-when-fetching-100000-rows", "title": "Oracle OCI Error: Segmentation fault (core dumped) when fetching 100000 rows", "body": "<p>Using Oracle's OCI library in C, I am trying to fetch 100000 rows with a simple fetch query</p>\n\n<pre><code>char *query_3 = \"SELECT id FROM idmap_id WHERE primary_id IN (SELECT id FROM idmap_id_1)\";\n</code></pre>\n\n<p>Table <code>idmap_id_1</code> has 100000 rows. I ran following code for fetching</p>\n\n<pre><code>unsigned int key=100000;\nchar output[key][120];\nsb2 output_ind[key];\nub2 output_len[key];\nub2 output_code[key];\nOCIDefine *defnpp;\n\nrc = OCIDefineByPos(stmt, &amp;defnpp, errhp, 1, (dvoid*)output, 120, SQLT_STR, (dvoid*)output_ind, output_len, output_code, OCI_DEFAULT);\n\nrc = OCIStmtExecute(svchp, stmt, errhp, key, 0, NULL, NULL, OCI_DEFAULT);\n</code></pre>\n\n<p>Function <code>OCIDefineByPos</code> works perfectly fine for 10000 rows but it gives <code>Segmentation fault (core dumped)</code> error when I try to fetch 100000 rows.</p>\n\n<p>Can anyone please help?</p>\n\n<p>I have noticed that the fetch returns 98800 rows. It gives this <code>Segmentation fault (core dumped)</code> error if i increase the fetched row count to 98801.</p>\n"}, {"tags": ["c", "linux", "unix", "macros"], "comments": [{"owner": {"reputation": 239259, "user_id": 464709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ab3363d257d780bd4c1f0c844b020a2?s=128&d=identicon&r=PG", "display_name": "Fr&#233;d&#233;ric Hamidi", "link": "https://stackoverflow.com/users/464709/fr%c3%a9d%c3%a9ric-hamidi"}, "edited": false, "score": 3, "creation_date": 1443018888, "post_id": 32742430, "comment_id": 53325696, "body": "That depends on your C library, really. <code>getc()</code> <i>may</i> be implemented as a macro... or it may not, and that is subject to change in the future."}, {"owner": {"reputation": 6463, "user_id": 5063789, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/57dfee355833ddc59127fc6a0584b908?s=128&d=identicon&r=PG&f=1", "display_name": "mohangraj", "link": "https://stackoverflow.com/users/5063789/mohangraj"}, "edited": false, "score": 0, "creation_date": 1443019181, "post_id": 32742430, "comment_id": 53325903, "body": "So, It is not a unique function like fgetc, fgets. Is it write?"}], "answers": [{"comments": [{"owner": {"reputation": 6463, "user_id": 5063789, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/57dfee355833ddc59127fc6a0584b908?s=128&d=identicon&r=PG&f=1", "display_name": "mohangraj", "link": "https://stackoverflow.com/users/5063789/mohangraj"}, "edited": false, "score": 0, "creation_date": 1443020992, "post_id": 32742764, "comment_id": 53327303, "body": "So, It depends up on the version of C"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 6463, "user_id": 5063789, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/57dfee355833ddc59127fc6a0584b908?s=128&d=identicon&r=PG&f=1", "display_name": "mohangraj", "link": "https://stackoverflow.com/users/5063789/mohangraj"}, "edited": false, "score": 1, "creation_date": 1443021097, "post_id": 32742764, "comment_id": 53327383, "body": "@mohan: No, it doesn&#39;t depend on the version of C. The standard&#39;s description of <code>fgetc</code> and <code>getc</code> is essentially the same in C90, C99, and C11."}, {"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "reply_to_user": {"reputation": 6463, "user_id": 5063789, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/57dfee355833ddc59127fc6a0584b908?s=128&d=identicon&r=PG&f=1", "display_name": "mohangraj", "link": "https://stackoverflow.com/users/5063789/mohangraj"}, "edited": false, "score": 0, "creation_date": 1443021133, "post_id": 32742764, "comment_id": 53327408, "body": "@mohan  No it wont be dependent on versions of C."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1443021135, "post_id": 32742764, "comment_id": 53327410, "body": "<code>fgetc</code>, <i>can</i> be implemented as a macro. There are just more restrictions on how that macro can be written. See my answer for details."}, {"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1443021212, "post_id": 32742764, "comment_id": 53327467, "body": "@KeithThompson <code>fgetc</code> can be implementated as macro ?"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1443021385, "post_id": 32742764, "comment_id": 53327577, "body": "@ameyCU: Any standard C library function can be implemented as a macro. There&#39;s probably not much reason to do so in the case of <code>fgetc</code>, but it&#39;s allowed. see my answer."}], "tags": [], "owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "is_accepted": false, "score": 1, "last_activity_date": 1566689769, "last_edit_date": 1566689769, "creation_date": 1443019716, "answer_id": 32742764, "question_id": 32742430, "link": "https://stackoverflow.com/questions/32742430/is-getc-a-macro-or-a-function/32742764#32742764", "title": "Is getc a macro or a function?", "body": "<p><code>getc</code> is a function as stated in C99 standard section 7.21.7.5 and may or may not be implemented as a macro:</p>\n\n<blockquote>\n  <p>The <code>getc</code> function is equivalent to <code>fgetc</code>, except that if it is implemented as a macro, it may evaluate <code>stream</code> more than once, so the argument should never be an expression with side effects. </p>\n</blockquote>\n\n<p>It does not work correctly with an argument that has side effects. For example --</p>\n\n<pre><code>int c = getc(*fpp++);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "is_accepted": true, "score": 8, "last_activity_date": 1443021333, "last_edit_date": 1443021333, "creation_date": 1443021003, "answer_id": 32743251, "question_id": 32742430, "link": "https://stackoverflow.com/questions/32742430/is-getc-a-macro-or-a-function/32743251#32743251", "title": "Is getc a macro or a function?", "body": "<blockquote>\n  <p>The difference between getc and fgetc is that getc can be implemented as a macro, whereas fgetc cannot be implemented as a macro.</p>\n</blockquote>\n\n<p>That's incorrect.</p>\n\n<p>With a few exceptions, <em>any</em> C standard library function may additionally be implemented as a macro, but there are some restrictions on how that macro can be written (so that the macro can still be used as if it were a function).</p>\n\n<p>Quoting <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\">N1570</a> section 7.1.4:</p>\n\n<blockquote>\n  <p>Any function declared in a header may be additionally implemented as a\n  function-like macro defined in the header, [...] Any invocation of a\n  library function that is implemented as a macro shall expand to code\n  that evaluates each of its arguments exactly once, fully protected by\n  parentheses where necessary, so it is generally safe to use arbitrary\n  expressions as arguments.</p>\n</blockquote>\n\n<p>What's special about <code>getc</code> is that one of those restrictions may be relaxed (7.21.7.5):</p>\n\n<blockquote>\n  <p>The <strong><code>getc</code></strong> function is equivalent to <strong><code>fgetc</code></strong>, except that if\n  it is implemented as a macro, it may evaluate <strong><code>stream</code></strong> more than\n  once, so the argument should never be an expression with side effects.</p>\n</blockquote>\n\n<p>The declarations of <code>fgetc</code> and <code>getc</code> are:</p>\n\n<pre><code>int fgetc(FILE *stream);\nint getc(FILE *stream);\n</code></pre>\n\n<p>The <code>stream</code> argument (for example, in a call like <code>fgetc(stdin)</code> or <code>getc(file)</code> is almost always an expression without side effects, but the rules still forbid defining <code>fgetc</code> as a macro that evaluates its argument more than once, just in case a programmer writes something like <code>fgetc(file_list[i++])</code>. The rule is relaxed for <code>getc</code> so that it can be defined as a macro (which can be significantly more efficient in some cases), while potentially breaking something like <code>getc(file_list[i++])</code>.</p>\n\n<p>In the case of <code>fgetc</code>, there probably wouldn't be much advantage in implementing it as a macro rather than just as a function. The point is that the standard explicitly permits it.</p>\n\n<blockquote>\n  <p>So, is <code>getc</code> implemented in C or not?</p>\n</blockquote>\n\n<p>Maybe.  There's no requirement for <em>any</em> C library function to be implemented in C. Some functions might be implemented in assembler, or in any other language -- or they might be compiler intrinsics. Usually most or all C standard library functions <em>are</em> implemented in C, but the standard only specifies how they work, not how they're written.</p>\n"}], "owner": {"reputation": 6463, "user_id": 5063789, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/57dfee355833ddc59127fc6a0584b908?s=128&d=identicon&r=PG&f=1", "display_name": "mohangraj", "link": "https://stackoverflow.com/users/5063789/mohangraj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1028, "favorite_count": 0, "accepted_answer_id": 32743251, "answer_count": 2, "score": 1, "last_activity_date": 1566689769, "creation_date": 1443018733, "last_edit_date": 1443021235, "question_id": 32742430, "link": "https://stackoverflow.com/questions/32742430/is-getc-a-macro-or-a-function", "title": "Is getc a macro or a function?", "body": "<p>I tried to find the difference between <code>getc</code> and <code>fgetc</code>. At that time I saw a statement like:</p>\n\n<blockquote>\n  <p>The difference between getc and fgetc is that getc can be implemented as a macro, whereas fgetc cannot be implemented as a macro.</p>\n</blockquote>\n\n<p>So, is <code>getc</code> really a function or it is a macro? If it is macro, it calls some other function. So, is <code>getc</code> implemented in C or not?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 126541, "user_id": 153285, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/1UiET.jpg?s=128&g=1", "display_name": "Potatoswatter", "link": "https://stackoverflow.com/users/153285/potatoswatter"}, "edited": false, "score": 1, "creation_date": 1443019123, "post_id": 32742399, "comment_id": 53325862, "body": "What if the price is less than $5? They have to supply exact change?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1443019194, "post_id": 32742399, "comment_id": 53325912, "body": "Show what you have done and where your <b>specific</b> problem is. There are very few clairvoyants on SO."}], "answers": [{"tags": [], "owner": {"reputation": 26, "user_id": 5368195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c88a6ab56846a88fdfeffac28ed1326?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Montenaro", "link": "https://stackoverflow.com/users/5368195/joe-montenaro"}, "is_accepted": true, "score": 1, "last_activity_date": 1443019049, "creation_date": 1443019049, "answer_id": 32742548, "question_id": 32742399, "link": "https://stackoverflow.com/questions/32742399/number-of-cents-needed-to-return-change-in-c-language/32742548#32742548", "title": "Number of cents needed to return change in C language", "body": "<p>Store the amount in terms of cents (ie, $5.03 would be 503) and use the modulus operator.</p>\n\n<p>As an example, to determine the number of cents in $5.03, you would do 503 modulus 100.</p>\n"}], "owner": {"reputation": 157, "user_id": 4701243, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40578f6873d3c2004d4d9fe0dad9cfae?s=128&d=identicon&r=PG&f=1", "display_name": "Scott Pearce", "link": "https://stackoverflow.com/users/4701243/scott-pearce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "closed_date": 1443405283, "accepted_answer_id": 32742548, "answer_count": 1, "score": -6, "last_activity_date": 1443019049, "creation_date": 1443018657, "question_id": 32742399, "link": "https://stackoverflow.com/questions/32742399/number-of-cents-needed-to-return-change-in-c-language", "closed_reason": "Needs details or clarity", "title": "Number of cents needed to return change in C language", "body": "<p>I am writing a program using C language where we ask user to enter number of items they want to buy, their unit price and we then calculate total price with and without tax. If total price with tax is equal to $5 or higher we then return them appropriate amounts of dollars back. We have to determine the total number of loonies they need to get and 1 cents. I have figured out everything, but I can't find out how to calculate 1 cents.</p>\n\n<p>This is what I have for loonies:</p>\n\n<pre><code>loonies = cash / 1;\n</code></pre>\n\n<p>This will find the total number of loonies I need to give back, but I am getting on pennies. </p>\n"}, {"tags": ["c++", "c", "code-generation", "bazel"], "answers": [{"tags": [], "owner": {"reputation": 21554, "user_id": 4243, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/501b2f1d20a7a8f9539d46776a640225?s=128&d=identicon&r=PG", "display_name": "kristina", "link": "https://stackoverflow.com/users/4243/kristina"}, "is_accepted": true, "score": 9, "last_activity_date": 1443031011, "creation_date": 1443031011, "answer_id": 32746379, "question_id": 32742382, "link": "https://stackoverflow.com/questions/32742382/bazel-header-file-code-generator/32746379#32746379", "title": "Bazel header file code generator", "body": "<p>Two possible solutions:</p>\n\n<p>1) Use the <code>output_to_genfiles</code> attribute:</p>\n\n<pre><code>code_generate = rule(\n  implementation = _impl,\n  output_to_genfiles = True,\n  attrs = {...}\n)\n</code></pre>\n\n<p>Basically it'll put your generated output in bazel-genfiles and cc_* does look there for headers.  It's not-very-thoroughly documented <a href=\"http://bazel.io/docs/skylark/lib/globals.html#rule\" rel=\"noreferrer\">here</a>.</p>\n\n<p>2) You could create a genrule that runs <code>python codegen.py</code> (instead of doing it in a Skylark rule).</p>\n"}], "owner": {"reputation": 1171, "user_id": 2576250, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ac46baf88aae36ef981fe3a8315ca54f?s=128&d=identicon&r=PG", "display_name": "Jan", "link": "https://stackoverflow.com/users/2576250/jan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2719, "favorite_count": 2, "accepted_answer_id": 32746379, "answer_count": 1, "score": 8, "last_activity_date": 1443031011, "creation_date": 1443018625, "question_id": 32742382, "link": "https://stackoverflow.com/questions/32742382/bazel-header-file-code-generator", "title": "Bazel header file code generator", "body": "<p>I am trying to add a code generator to my bazel build by writing a rule to execute the generator, but i am stuck at adding the generated header file as an include path dependency to the library i am trying to build.</p>\n\n<p>The rule looks like this: </p>\n\n<pre><code>def _impl(ctx):\n  output = ctx.outputs.out\n  input = ctx.attr.defs\n  md_dir = list(ctx.attr.md_dir.files)[0]\n  print(\"generating\", output.path)\n  ctx.action(\n      outputs=[output],\n      progress_message=\"Generating %s\" % md_dir,\n      command=\"python codegen.py -md_dir %s %s -o %s\" % (md_dir.path, input, output.path)\n  )\n\ncode_generate = rule(\n  implementation=_impl,\n  attrs={\n       \"defs\": attr.string(),\n       \"md_dir\": attr.label(allow_files=True, single_file=True),\n       \"out\": attr.output()\n       },\n)\n</code></pre>\n\n<p>and the BUILD file like this:</p>\n\n<pre><code>load(\"/common/code_generate\", \"code_generate\")\n\ncode_generate(\n  name=\"generate_header_defs\",\n  defs=\"common/header_definition_file\",\n  md_dir=\"header_defs\",\n  out=\"gen_header.h\",\n)\n\ncc_library(\n  name=\"lnt\",\n  hdrs=glob([\"*.h\"]),\n  srcs=[\"source.c\":gen_header.h\"],\n  visibility=[\"//visibility:public\"],\n  deps=[\"@dep1//:x\", \"@dep2//:y\", \"@dep3//:z\"],\n)\n</code></pre>\n\n<p>The code generation works and writes the code to <em>bazel-out/local-fastbuild/bin/common/gen_header.h</em> but the gcc command line does not add the include path to the generated header file what leads to <em>error: gen_header.h: No such file or directory</em></p>\n"}, {"tags": ["c", "linux", "opengl"], "comments": [{"owner": {"reputation": 49036, "user_id": 3530129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IYkz8.jpg?s=128&g=1", "display_name": "Reto Koradi", "link": "https://stackoverflow.com/users/3530129/reto-koradi"}, "edited": false, "score": 1, "creation_date": 1443021100, "post_id": 32742362, "comment_id": 53327386, "body": "Are you rendering isolated concave polygons, or a bunch of them that are for example part of a mesh?"}, {"owner": {"reputation": 8756, "user_id": 416274, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/fa38a4e372afb202e6ab7eb1619372a8?s=128&d=identicon&r=PG", "display_name": "Robinson", "link": "https://stackoverflow.com/users/416274/robinson"}, "edited": false, "score": 0, "creation_date": 1443021707, "post_id": 32742362, "comment_id": 53327796, "body": "OpenGL is a system for rendering triangles.  That&#39;s the only primitive there is.  If you want to render concave or convex polygons you have to provide the decomposition yourself.  You <i>could</i> do it with a geometry shader but you have to accept the input vertices (with restrictions), decompose into triangles and output the primitives.  Graphics Gems I (available online) had some algorithms in it for tessellating arbitrary polygons if I remember correctly."}, {"owner": {"reputation": 18146, "user_id": 646619, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bd61a0f309ebc135d2661710c2faf379?s=128&d=identicon&r=PG", "display_name": "Colonel Thirty Two", "link": "https://stackoverflow.com/users/646619/colonel-thirty-two"}, "edited": false, "score": 3, "creation_date": 1443021708, "post_id": 32742362, "comment_id": 53327797, "body": "While GLU is deprecated, the tessellation code isn&#39;t too bad, and isn&#39;t actually tied to OpenGL. <a href=\"https://github.com/memononen/libtess2\" rel=\"nofollow noreferrer\">libtess2</a> is effectively the tessellation functions ripped out of Mesa&#39;s GLU implementation."}, {"owner": {"reputation": 3281, "user_id": 76804, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b98ecf5f6b64f5e16a91979e3c171077?s=128&d=identicon&r=PG", "display_name": "Budric", "link": "https://stackoverflow.com/users/76804/budric"}, "edited": false, "score": 0, "creation_date": 1443023143, "post_id": 32742362, "comment_id": 53328754, "body": "Thanks, I&#39;ll give libtess2 a try."}], "answers": [{"tags": [], "owner": {"reputation": 97034, "user_id": 427332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11b58e11decc7b4c352d3ac3b2d0b90?s=128&d=identicon&r=PG", "display_name": "Tommy", "link": "https://stackoverflow.com/users/427332/tommy"}, "is_accepted": true, "score": 1, "last_activity_date": 1443021471, "creation_date": 1443021471, "answer_id": 32743446, "question_id": 32742362, "link": "https://stackoverflow.com/questions/32742362/opengl-3-rendering-concave-polygons-without-glu/32743446#32743446", "title": "OpenGL 3+ Rendering Concave Polygons (without GLU)", "body": "<p>The vast, overwhelming majority of OpenGL applications simply never draws concave polygons; it's not something the API or hardware attempts directly to support and hence there's no industry standard approach. Stencil will achieve it in the frame buffer, any sort of convex decomposition will achieve it at the geometry level.</p>\n\n<p>The stencil approach actually isn't that hard to understand. The metaphor is fence jumping: the edges of the polygon are a fence and the polygon itself is enclosed land. To determine whether a point is inside the land, start anywhere outside and walk to it in a straight line. Count how many times you had to jump a fence to get there. Every time you jump a fence you switch from inside to outside or vice versa. So if you jumped an even number of fences then the point must be inside (e.g. you went from outside to inside once, or -> inside -> outside -> inside, or -> inside -> outside -> inside -> outside -> inside, etc). If you jumped an odd number of fences then it must be outside.</p>\n\n<p>The stencil approach keeps a per-pixel count of fence jumps. </p>\n\n<p>It draws a triangle fan relative to a fixed point that is a vertex of the polygon. So it's one triangle per fence, with the third coordinate being a fixed position you know to be inside.</p>\n\n<p>The pixels inside the triangle are every point that, in order for you to have reached on your straight line towards the fixed point, would require you to have jumped that fence.</p>\n\n<p>Therefore the stencil total at any location is the number of fences you would need to jump to reach the polygon from there.</p>\n\n<p>So all odd stencil results are points that are inside. All even results are points that are outside.</p>\n"}], "owner": {"reputation": 3281, "user_id": 76804, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b98ecf5f6b64f5e16a91979e3c171077?s=128&d=identicon&r=PG", "display_name": "Budric", "link": "https://stackoverflow.com/users/76804/budric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 611, "favorite_count": 0, "accepted_answer_id": 32743446, "answer_count": 1, "score": 0, "last_activity_date": 1443021471, "creation_date": 1443018579, "last_edit_date": 1495540309, "question_id": 32742362, "link": "https://stackoverflow.com/questions/32742362/opengl-3-rendering-concave-polygons-without-glu", "title": "OpenGL 3+ Rendering Concave Polygons (without GLU)", "body": "<p>I'd like to render concave polygons using C, OpenGL on a Linux system.  Can anyone provide sample code how this would be done in the latest version of OpenGL (Let's say OpenGL 4.5 which according to glxinfo NVIDIA driver 352.41 supports, but whatever 3+ version you like that supports extensions implemented in hardware on Linux at least by NVIDIA).</p>\n\n<p>This <a href=\"https://stackoverflow.com/questions/7694037/drawing-a-concave-polygon-in-opengl\">question</a> on stackoverflow points to use GLU tesselation which is deprecated. Using stencil buffers approach which I don't fully understand, but if this is the \"industry accepted standard\" of doing this now, I'll put more effort into understanding.</p>\n\n<p>This <a href=\"https://github.com/opentk/opentk/issues/99\" rel=\"nofollow noreferrer\">post</a> refers to a .NET library which I don't want to use on Linux and C, tesselation shader which I would love an example how to use but all examples I can find start with convex patches, and the deprecated library moved for posterity into another repository which I'd like to move away from.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["python", "c", "macos", "gcc"], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 3053713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5189238052f3f098b968da3abffe52f3?s=128&d=identicon&r=PG&f=1", "display_name": "Nitlev", "link": "https://stackoverflow.com/users/3053713/nitlev"}, "is_accepted": true, "score": 0, "last_activity_date": 1443024597, "creation_date": 1443024597, "answer_id": 32744511, "question_id": 32742318, "link": "https://stackoverflow.com/questions/32742318/clang-linker-issues-when-installing-distance-python-library/32744511#32744511", "title": "Clang linker issues when installing Distance python library", "body": "<p>I solved the issue thanks to <a href=\"https://github.com/Homebrew/homebrew/issues/40653\" rel=\"nofollow\">this link</a> which showed that this is a very recent issue with Xcode6.</p>\n\n<p>You just need to upgrade Xcode to Xcode7 and set it up as your default toolkit chain. Easy.</p>\n"}], "owner": {"reputation": 81, "user_id": 3053713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5189238052f3f098b968da3abffe52f3?s=128&d=identicon&r=PG&f=1", "display_name": "Nitlev", "link": "https://stackoverflow.com/users/3053713/nitlev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 310, "favorite_count": 0, "accepted_answer_id": 32744511, "answer_count": 1, "score": -2, "last_activity_date": 1443024597, "creation_date": 1443018427, "last_edit_date": 1495540930, "question_id": 32742318, "link": "https://stackoverflow.com/questions/32742318/clang-linker-issues-when-installing-distance-python-library", "title": "Clang linker issues when installing Distance python library", "body": "<p>I'm trying to install <a href=\"https://pypi.python.org/pypi/Distance/\" rel=\"nofollow noreferrer\">Distance</a> for python on my mac (OS X Yosemite).</p>\n\n<p>After downloading the package and unpacking it, I run (as described on their page):</p>\n\n<pre><code>python setup.py install --with-c\n</code></pre>\n\n<p>From this I get the following error message:</p>\n\n<pre><code>running build_ext\nbuilding 'distance.cdistance' extension\ngcc -fno-strict-aliasing -I/Users/me/anaconda/envs/name/include -   arch x86_64 -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -I/Users/me/anaconda/envs/name/include/python2.7 -c cdistance/distance.c -o build/temp.macosx-10.5-x86_64-2.7/cdistance/distance.o\ngcc -bundle -undefined dynamic_lookup -L/Users/me/anaconda/envs/name/lib -arch x86_64 -arch x86_64 build/temp.macosx-10.5-x86_64-2.7/cdistance/distance.o -L/Users/me/anaconda/envs/name/lib -o build/lib.macosx-10.5-x86_64-2.7/distance/cdistance.so\nld: library not found for -lgcc_s.10.5\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\nerror: command 'gcc' failed with exit status 1\n</code></pre>\n\n<p>From what I understood from several posts like <a href=\"https://askubuntu.com/questions/346377/cannot-find-lgcc-s\">this one</a> or <a href=\"https://stackoverflow.com/questions/14118224/clang-linker-issues-from-source-to-gcc-snapshot\">this previously asked question</a>, it looks like <code>clang</code>, which is called through the command <code>gcc</code>, can't find the libgcc library.</p>\n\n<p>I ran <code>find /usr/ -name libgcc*</code>and this if what I get:</p>\n\n<pre><code>/usr//lib/libgcc_s.1.dylib\n/usr//lib/libgcc_s.10.4.tbd\n/usr//lib/libgcc_s.10.5.tbd\n/usr//local/Cellar/gcc/5.2.0/lib/gcc/5/gcc/x86_64-apple-darwin14.4.0/5.2.0/i386/libgcc.a\n/usr//local/Cellar/gcc/5.2.0/lib/gcc/5/gcc/x86_64-apple-darwin14.4.0/5.2.0/i386/libgcc_eh.a\n/usr//local/Cellar/gcc/5.2.0/lib/gcc/5/gcc/x86_64-apple-darwin14.4.0/5.2.0/libgcc.a\n/usr//local/Cellar/gcc/5.2.0/lib/gcc/5/gcc/x86_64-apple-darwin14.4.0/5.2.0/libgcc_eh.a\n/usr//local/Cellar/gcc/5.2.0/lib/gcc/5/libgcc_ext.10.4.dylib\n/usr//local/Cellar/gcc/5.2.0/lib/gcc/5/libgcc_ext.10.5.dylib\n/usr//local/Cellar/gcc/5.2.0/lib/gcc/5/libgcc_s.1.dylib\n/usr//local/Cellar/gcc/5.2.0/lib/gcc/5/libgcc_s_ppc64.1.dylib\n/usr//local/Cellar/gcc/5.2.0/lib/gcc/5/libgcc_s_x86_64.1.dylib\n/usr//local/gfortran/lib/gcc/x86_64-apple-darwin14/5.1.0/i386/libgcc.a\n/usr//local/gfortran/lib/gcc/x86_64-apple-darwin14/5.1.0/i386/libgcc_eh.a\n/usr//local/gfortran/lib/gcc/x86_64-apple-darwin14/5.1.0/libgcc.a\n/usr//local/gfortran/lib/gcc/x86_64-apple-darwin14/5.1.0/libgcc_eh.a\n/usr//local/gfortran/lib/libgcc_ext.10.4.dylib\n/usr//local/gfortran/lib/libgcc_ext.10.5.dylib\n/usr//local/gfortran/lib/libgcc_s.1.dylib\n/usr//local/gfortran/lib/libgcc_s_ppc64.1.dylib\n/usr//local/gfortran/lib/libgcc_s_x86_64.1.dylib\n</code></pre>\n\n<p>And now I'm stuck because I don't know what to do next. Basically the question is: how do I make clang to know where the library is ?</p>\n"}, {"tags": ["c", "sockets", "tcp"], "answers": [{"tags": [], "owner": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "is_accepted": true, "score": 2, "last_activity_date": 1443017725, "creation_date": 1443017725, "answer_id": 32742035, "question_id": 32741710, "link": "https://stackoverflow.com/questions/32741710/tcp-server-that-listen-on-two-different-ports/32742035#32742035", "title": "TCP server that listen on two different ports", "body": "<p>The first listener socket is created with:</p>\n\n<pre><code>s = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);\n</code></pre>\n\n<p>And then the data socket is accepted with:</p>\n\n<pre><code> conn_request_skt=s;\n s = accept(conn_request_skt, (struct sockaddr *) &amp;caddr, &amp;addrlen);\n</code></pre>\n\n<p>See? The next loop, when you are going to select over the listener socket, <code>s</code> no longer holds that socket, but the (closed) data socket.</p>\n\n<p>The solution is to use different variables for the listener socket and the data socket (<code>conn_request_skt</code> is just obfuscating the issue).</p>\n"}, {"tags": [], "owner": {"reputation": 2324, "user_id": 5334131, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JU6Bo.jpg?s=128&g=1", "display_name": "Hellmar Becker", "link": "https://stackoverflow.com/users/5334131/hellmar-becker"}, "is_accepted": false, "score": 1, "last_activity_date": 1443017847, "creation_date": 1443017847, "answer_id": 32742078, "question_id": 32741710, "link": "https://stackoverflow.com/questions/32741710/tcp-server-that-listen-on-two-different-ports/32742078#32742078", "title": "TCP server that listen on two different ports", "body": "<p>You are overwriting your socket variable s1 with the result of the accept() call. So s1 contains now the descriptor of the socket you are actually reading from. Then you close that socket. But in the next pass of the main loop, you check for readability on that (now closed) descriptor, which does not work. </p>\n\n<p>I believe it would be better not to reuse variables in this case. Use a new variable for the actual connection socket, so that you retain the original listening socket in s1.</p>\n"}], "owner": {"reputation": 53, "user_id": 4862802, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c8dcbb21cee4d011b361759b79c6dc07?s=128&d=identicon&r=PG&f=1", "display_name": "makmilan", "link": "https://stackoverflow.com/users/4862802/makmilan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3188, "favorite_count": 0, "accepted_answer_id": 32742035, "answer_count": 2, "score": 2, "last_activity_date": 1443017847, "creation_date": 1443016807, "question_id": 32741710, "link": "https://stackoverflow.com/questions/32741710/tcp-server-that-listen-on-two-different-ports", "title": "TCP server that listen on two different ports", "body": "<p>I have a TCP server that is listening on two different ports . I created two different sockets one on port 8888 and one on port 6634. I listen on those ports and then i add the two sockets in FD_SET and pass them to select() function ...\nWhen a socket is ready to read i check with FD_ISSET to see on which port i have message to read .</p>\n\n<p>any way when i connect to port 8888 the conception is successful and i can send towards the server and receive ... when i ctrl+c the client the select function is returning again 1 and now my accept() fails ...\nwhen i do the same thing on port 6634 everything is ok... the code stops at the select() and waits for a socket to be ready to read!  </p>\n\n<p>can anyone tell me WHY is this happening ?</p>\n\n<p>take a look at my code in attachment </p>\n\n<pre><code>    int main()\n    {\n        SOCKET          conn_request_skt;   /* socket where connections are accepted */\n        char            buf[RBUFLEN], buf1[RBUFLEN];        /* reception buffer */\n        uint16_t        lport_n, lport_h, lport_n1, lport_h1;   /* port where the server listens (net/host byte ord resp.) */\n        int         bklog = 2;      /* listen backlog */\n        SOCKET          s,s1;           \n        int         result, n;\n        socklen_t addrlen;\n        struct sockaddr_in  saddr, caddr;       /* server and client address structures */ \n        int optval,childpid,i; /* flag value for setsockopt */\n        int connectcnt; /* number of connection requests */\n        fd_set readfds;\n\n        /* Initialize socket API if needed */\n        SockStartup();\n\n        /* input server port number */\n        lport_h=6634;\n        lport_n = htons(lport_h);\n        lport_h1=8888;\n        lport_n1 = htons(lport_h1);\n\n        /* create the socket */\n        printf(\"Creating first socket\\n\");\n        s = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);\n        if (s == INVALID_SOCKET)\n            err_fatal(\"socket() failed\");\n        printf(\"done, socket number %u\\n\",s);\n\n        /* bind the socket to any local IP address */\n        saddr.sin_family      = AF_INET;\n        saddr.sin_port        = lport_n;\n        saddr.sin_addr.s_addr = INADDR_ANY;\n        showAddr(\"Binding to address first socket\", &amp;saddr);\n        result = bind(s, (struct sockaddr *) &amp;saddr, sizeof(saddr));\n        if (result == -1)\n            err_fatal(\"bind() failed\");\n        printf(\"done.\\n\");\n\n        printf(\"Creating second socket\\n\");\n        s1 = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);\n        if (s1 == INVALID_SOCKET)\n            err_fatal(\"socket() failed\");\n        printf(\"done, socket number %u\\n\",s1);\n\n        /* bind the socket to any local IP address */\n\n        saddr.sin_port=lport_n1;\n\n        showAddr(\"Binding to address second socket\", &amp;saddr);\n        result = bind(s1, (struct sockaddr *) &amp;saddr, sizeof(saddr));\n        if (result == -1)\n            err_fatal(\"bind() failed\");\n        printf(\"done.\\n\");\n\n\n        /* listen */\n        printf (\"Listening at socket %d with backlog = %d \\n\",s,bklog);\n        result = listen(s, bklog);\n        if (result == -1)\n            err_fatal(\"listen() failed\");\n        printf(\"done.\\n\");\n\n        printf (\"Listening at socket %d with backlog = %d \\n\",s1,bklog);\n        result = listen(s1, bklog);\n        if (result == -1)\n            err_fatal(\"listen() failed\");\n        printf(\"done.\\n\");\nfor (;;)\n    {\n\n\n        FD_ZERO(&amp;readfds);          /* initialize the fd set */\n        FD_SET(s, &amp;readfds);\n        FD_SET(s1, &amp;readfds); /* add socket fd */\n        printf(\"here \\n\");\n\n        printf(\"result bifore select is %d \\n\", result);\n        result=select(s1+1, &amp;readfds, 0, 0, 0);\n\n        printf(\"result after select is %d \\n\", result);\n\n        if(result&lt;0)\n            {\n                err_fatal(\"select() failed\");\n\n            }\n        if(result&gt;0)\n        {\n\n            if(FD_ISSET(s,&amp;readfds))\n            {\n\n                conn_request_skt=s;\n                /* accept next connection */\n                addrlen = sizeof(struct sockaddr_in);\n                s = accept(conn_request_skt, (struct sockaddr *) &amp;caddr, &amp;addrlen);\n                if (s == INVALID_SOCKET)\n                err_fatal(\"accept() failed\");\n                showAddr(\"Accepted connection from\", &amp;caddr);\n                printf(\"new socket: %u\\n\",s);\n                /* serve the client on socket s */\n                for (;;)\n                {\n                    n=recv(s, buf, RBUFLEN-1, 0);\n                    if (n &lt; 0)\n                    {\n                        printf(\"Read error\\n\");\n                        closesocket(s);\n                        printf(\"Socket %d closed\\n\", s);\n                        break;\n                    }\n                    else if (n==0)\n                    {\n                        printf(\"Connection closed by party on socket %d\\n\",s);\n                        //closesocket(s);\n                        break;\n                    }\n                    else\n                    {\n                        printf(\"Received line from socket %03d :\\n\", s);\n                        buf[n]=0;\n                        printf(\"[%s]\\n\",buf);\n                        if(writen(s, buf, n) != n)\n                        printf(\"Write error while replying\\n\");\n                        else\n                        printf(\"Reply sent\\n\");\n                    }   \n                }\n            }\n\n\n            if(FD_ISSET(s1,&amp;readfds))\n            {\n                conn_request_skt=s1;\n                /* accept next connection */\n                addrlen = sizeof(struct sockaddr_in);\n                printf(\"bifore accept! \\n\");\n                s1 = accept(conn_request_skt, (struct sockaddr *) &amp;caddr, &amp;addrlen);\n                if (s1 == INVALID_SOCKET)\n                err_fatal(\"accept() failed\");\n                showAddr(\"Accepted connection from\", &amp;caddr);\n                printf(\"new socket: %u\\n\",s1);\n                /* serve the client on socket s */\n                for (;;)\n                {\n                    n=recv(s1, buf, RBUFLEN-1, 0);\n                    if (n &lt; 0)\n                    {\n                        printf(\"Read error\\n\");\n                        closesocket(s1);\n                        printf(\"Socket %d closed\\n\", s1);\n                        break;\n                    }\n                    else if (n==0)\n                    {\n                        printf(\"Connection closed by party on socket %d\\n\",s1);\n                        //closesocket(s);\n                        break;\n                    }\n                    else\n                    {\n                        printf(\"Received line from socket %03d :\\n\", s1);\n                        buf[n]=0;\n                        printf(\"[%s]\\n\",buf);\n                        if(writen(s1, buf, n) != n)\n                        printf(\"Write error while replying\\n\");\n                        else\n                        printf(\"Reply sent\\n\");\n                    }   \n                }\n            }\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "algorithm"], "comments": [{"owner": {"reputation": 893, "user_id": 1183602, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3ZJHj.png?s=128&g=1", "display_name": "Transcendental", "link": "https://stackoverflow.com/users/1183602/transcendental"}, "edited": false, "score": 0, "creation_date": 1443017111, "post_id": 32741705, "comment_id": 53324329, "body": "Please post the definition of <code>Node</code> structure. Your code is currently incomplete and can&#39;t be clearly interpreted."}, {"owner": {"reputation": 165, "user_id": 5339317, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ef7d9ad172fb2e77f8be8c55417588d4?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/5339317/andre"}, "reply_to_user": {"reputation": 893, "user_id": 1183602, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3ZJHj.png?s=128&g=1", "display_name": "Transcendental", "link": "https://stackoverflow.com/users/1183602/transcendental"}, "edited": false, "score": 0, "creation_date": 1443017190, "post_id": 32741705, "comment_id": 53324393, "body": "@Transcendental I have added it"}, {"owner": {"reputation": 20507, "user_id": 1463922, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3878980c7836d9e36f3a9ac100ff36a8?s=128&d=identicon&r=PG", "display_name": "PiotrNycz", "link": "https://stackoverflow.com/users/1463922/piotrnycz"}, "edited": false, "score": 0, "creation_date": 1443017311, "post_id": 32741705, "comment_id": 53324481, "body": "test this code for much smaller number of nodes - like 1, 2, 3 - probably that will be enough to see the reason..."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1443017516, "post_id": 32741705, "comment_id": 53324636, "body": "Is this really a binary tree? It rather looks like a chained linked list or something home-brewed. Binary trees have a <code>right</code> and a <code>left</code> member."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1443017625, "post_id": 32741705, "comment_id": 53324714, "body": "Ok judging by the link, it is not a binary tree but a &quot;family tree&quot;. Okay..."}, {"owner": {"reputation": 23009, "user_id": 3613500, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lIfov.png?s=128&g=1", "display_name": "David Haim", "link": "https://stackoverflow.com/users/3613500/david-haim"}, "edited": false, "score": 0, "creation_date": 1443017684, "post_id": 32741705, "comment_id": 53324758, "body": "you usually free trees which recursion, not loops"}, {"owner": {"reputation": 165, "user_id": 5339317, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ef7d9ad172fb2e77f8be8c55417588d4?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/5339317/andre"}, "edited": false, "score": 0, "creation_date": 1443017720, "post_id": 32741705, "comment_id": 53324782, "body": "it doesn&#39;t free the parent nodes, it just goes deeply and removes the nodes, leaving the parents"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 23009, "user_id": 3613500, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lIfov.png?s=128&g=1", "display_name": "David Haim", "link": "https://stackoverflow.com/users/3613500/david-haim"}, "edited": false, "score": 1, "creation_date": 1443017750, "post_id": 32741705, "comment_id": 53324809, "body": "@DavidHaim The advantage of having a parent member is that you can get rid of the slow, dangerous, stack-slaughtering, unreadable recursion. At the expense of data memory consumption."}, {"owner": {"reputation": 165, "user_id": 5339317, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ef7d9ad172fb2e77f8be8c55417588d4?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/5339317/andre"}, "reply_to_user": {"reputation": 50933, "user_id": 360211, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/3baKW.png?s=128&g=1", "display_name": "weston", "link": "https://stackoverflow.com/users/360211/weston"}, "edited": false, "score": 0, "creation_date": 1443018040, "post_id": 32741705, "comment_id": 53325031, "body": "@weston yes it has a child and a next"}, {"owner": {"reputation": 50933, "user_id": 360211, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/3baKW.png?s=128&g=1", "display_name": "weston", "link": "https://stackoverflow.com/users/360211/weston"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1443018648, "post_id": 32741705, "comment_id": 53325512, "body": "@Lundin the names might be odd, but this is a binary tree. <code>next</code> and <code>child</code> are just odd names for <code>left</code> and <code>right</code>.."}, {"owner": {"reputation": 165, "user_id": 5339317, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ef7d9ad172fb2e77f8be8c55417588d4?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/5339317/andre"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1443018743, "post_id": 32741705, "comment_id": 53325575, "body": "@Lundin Can you provide an iterative solution ?"}, {"owner": {"reputation": 50933, "user_id": 360211, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/3baKW.png?s=128&g=1", "display_name": "weston", "link": "https://stackoverflow.com/users/360211/weston"}, "edited": false, "score": 0, "creation_date": 1443018744, "post_id": 32741705, "comment_id": 53325578, "body": "Your code doesn&#39;t look anything like the link you posted to. In particular this one: <a href=\"http://codegolf.stackexchange.com/a/489/15982\">codegolf.stackexchange.com/a/489/15982</a>"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1443019143, "post_id": 32741705, "comment_id": 53325876, "body": "Non-recursive traversal of a tree (for whatever purpose) is only possible through use of <code>parent</code> pointers. This is the very reason your data structure includes these pointers. Yet your code never uses <code>parent</code> pointers, which immediately means that it is incorrect."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1443019456, "post_id": 32741705, "comment_id": 53326114, "body": "Actually, the purpose of the data structure you have there (a tree with a list of child nodes) is to represent <i>any</i> tree, not necessarily a <i>binary</i> tree. Your tree is not actually &quot;binary&quot;. (It is true that <i>any</i> tree can be represented by an equivalent <i>binary</i> tree, meaning that if you want you can see it as &quot;binary&quot;, but this is completely besides the point.) The question you linked at the beginning does not work with binary trees either - a parent can have more than two children, as is the case in your example there. So, it is not clear why you insist on calling it &quot;binary&quot;."}, {"owner": {"reputation": 165, "user_id": 5339317, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ef7d9ad172fb2e77f8be8c55417588d4?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/5339317/andre"}, "edited": false, "score": 0, "creation_date": 1443020266, "post_id": 32741705, "comment_id": 53326749, "body": "I updated the code which uses the parent pointer, Is that code correct ?"}, {"owner": {"reputation": 50933, "user_id": 360211, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/3baKW.png?s=128&g=1", "display_name": "weston", "link": "https://stackoverflow.com/users/360211/weston"}, "reply_to_user": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1443021003, "post_id": 32741705, "comment_id": 53327313, "body": "@AnT &quot;Your tree is not actually &quot;binary&quot;&quot; Why?, it has two other identical nodes, a left and right, here called child and next."}, {"owner": {"reputation": 50933, "user_id": 360211, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/3baKW.png?s=128&g=1", "display_name": "weston", "link": "https://stackoverflow.com/users/360211/weston"}, "edited": false, "score": 1, "creation_date": 1443021075, "post_id": 32741705, "comment_id": 53327372, "body": "You don&#39;t need parent, did you look at the link: <a href=\"http://codegolf.stackexchange.com/questions/478/free-a-binary-tree/489#489\" title=\"free a binary tree\">codegolf.stackexchange.com/questions/478/free-a-binary-tree/&zwnj;&#8203;&hellip;</a>"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 50933, "user_id": 360211, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/3baKW.png?s=128&g=1", "display_name": "weston", "link": "https://stackoverflow.com/users/360211/weston"}, "edited": false, "score": 0, "creation_date": 1443027902, "post_id": 32741705, "comment_id": 53331669, "body": "@weston: As I said, <i>any</i> tree can be <i>interpreted</i> as a <i>binary</i> tree. There&#39;s 1:1 correspondence between arbitrary trees and binary trees. The &quot;child list&quot; representation used above illustrates that fact very clearly. The distinction between &quot;binary&quot; and &quot;non-binary&quot; trees is completely inconsequential and is a matter of pure convenience. And it has nothing to do the task at hand. That&#39;s the point I&#39;m trying to make."}, {"owner": {"reputation": 50933, "user_id": 360211, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/3baKW.png?s=128&g=1", "display_name": "weston", "link": "https://stackoverflow.com/users/360211/weston"}, "reply_to_user": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1443036246, "post_id": 32741705, "comment_id": 53336351, "body": "@AnT Have to agree to disagree maybe. They may call it child, but it&#39;s just another <i>tree node</i>, it is <b>not</b> a child list. There is no &quot;child list&quot; representation here, just a poor choice of field names."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 50933, "user_id": 360211, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/3baKW.png?s=128&g=1", "display_name": "weston", "link": "https://stackoverflow.com/users/360211/weston"}, "edited": false, "score": 0, "creation_date": 1443081289, "post_id": 32741705, "comment_id": 53351773, "body": "@weston: No, no, no. The above representation is a <i>canonical</i> and extremely widely used representation of an <i>arbitrary</i> (non-binary) tree. Each node stores a pointer to its first child and its next sibling. The field names are canonical as well. It is true that the representation is physically equivalent to a binary tree (with &quot;poorly chosen filed names&quot;), but the people who wrote that code did not want to see it in terms of binary trees. The found it more convenient (more readable) to see it in terms of arbitrary trees. This is their conscious choice. There&#39;s nothing &quot;poor&quot; here."}, {"owner": {"reputation": 50933, "user_id": 360211, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/3baKW.png?s=128&g=1", "display_name": "weston", "link": "https://stackoverflow.com/users/360211/weston"}, "reply_to_user": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1443085283, "post_id": 32741705, "comment_id": 53353965, "body": "@AnT I get it (finally!)"}], "answers": [{"comments": [{"owner": {"reputation": 165, "user_id": 5339317, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ef7d9ad172fb2e77f8be8c55417588d4?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/5339317/andre"}, "edited": false, "score": 0, "creation_date": 1443017910, "post_id": 32741971, "comment_id": 53324935, "body": "I don&#39;t want it recursively, I&#39;m running it on an embedded system."}, {"owner": {"reputation": 1875, "user_id": 5057191, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d3a861c87b46363f63080839bbc699f2?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. E", "link": "https://stackoverflow.com/users/5057191/mr-e"}, "reply_to_user": {"reputation": 165, "user_id": 5339317, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ef7d9ad172fb2e77f8be8c55417588d4?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/5339317/andre"}, "edited": false, "score": 0, "creation_date": 1443019068, "post_id": 32741971, "comment_id": 53325821, "body": "Added a non-recursive method, hope it works. But you definitely must edit your post to reflect you wanted a non-recursive way"}, {"owner": {"reputation": 165, "user_id": 5339317, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ef7d9ad172fb2e77f8be8c55417588d4?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/5339317/andre"}, "edited": false, "score": 0, "creation_date": 1443019561, "post_id": 32741971, "comment_id": 53326208, "body": "You don&#39;t remove the parent object in your code, and you are not using the parent pointer, is it necessary to use it ?"}, {"owner": {"reputation": 1875, "user_id": 5057191, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d3a861c87b46363f63080839bbc699f2?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. E", "link": "https://stackoverflow.com/users/5057191/mr-e"}, "reply_to_user": {"reputation": 165, "user_id": 5339317, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ef7d9ad172fb2e77f8be8c55417588d4?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/5339317/andre"}, "edited": false, "score": 0, "creation_date": 1443020702, "post_id": 32741971, "comment_id": 53327073, "body": "What? I&#39;m freeing the parent in free(temp).   You mustn&#39;t free every pointer you use, just the memory it&#39;s pointing to. So, if p-&gt;child = q and q-&gt;parent = p, you should never do free(q-&gt;parent) and free(p) cause you would be freeing two times the same memory direction (Same with free(q) and free(p-&gt;child))"}], "tags": [], "owner": {"reputation": 1875, "user_id": 5057191, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d3a861c87b46363f63080839bbc699f2?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. E", "link": "https://stackoverflow.com/users/5057191/mr-e"}, "is_accepted": false, "score": 0, "last_activity_date": 1443018962, "last_edit_date": 1443018962, "creation_date": 1443017506, "answer_id": 32741971, "question_id": 32741705, "link": "https://stackoverflow.com/questions/32741705/free-a-binary-tree-without-recursion/32741971#32741971", "title": "Free a binary tree without recursion", "body": "<p>I would do</p>\n\n<pre><code>void removeTree(Node *node){\n    Node *temp;\n    while (node !=NULL){\n        if (node-&gt;child != NULL) {\n            removeTree(node-&gt;child);\n        }\n        temp = node;\n        node = node-&gt;next;\n        free(temp);\n    }\n}\n</code></pre>\n\n<p>Non-recursive version:</p>\n\n<pre><code>void removeTree(Node *node){\n    Node *temp;\n    while (node !=NULL){\n        temp = node;\n        while(temp != node) {\n            for(;temp-&gt;child == NULL; temp = temp-&gt;child); //Go to the leaf\n            if (temp-&gt;next == NULL)\n                free(temp); //free the leaf\n            else { // If there is a next move it to the child an repeat\n                temp-&gt;child = temp-&gt;next;\n                temp-&gt;next = temp-&gt;next-&gt;next;\n            }\n        }\n        node = temp-&gt;next; // Move to the next\n        free(temp)\n    }\n}\n</code></pre>\n\n<p>I think this should work</p>\n"}, {"comments": [{"owner": {"reputation": 165, "user_id": 5339317, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ef7d9ad172fb2e77f8be8c55417588d4?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/5339317/andre"}, "edited": false, "score": 0, "creation_date": 1443017909, "post_id": 32742044, "comment_id": 53324933, "body": "I don&#39;t want it recursively, I&#39;m running it on an embedded system."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1443017923, "post_id": 32742044, "comment_id": 53324941, "body": "Because he has a parent member, so he doesn&#39;t have to. Recursion  should always be avoided if possible."}, {"owner": {"reputation": 50933, "user_id": 360211, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/3baKW.png?s=128&g=1", "display_name": "weston", "link": "https://stackoverflow.com/users/360211/weston"}, "edited": false, "score": 0, "creation_date": 1443017979, "post_id": 32742044, "comment_id": 53324979, "body": "We know they have 5520 elements, so it could be either very deep (childs) or long (nexts) and cause a stackoverflow."}, {"owner": {"reputation": 165, "user_id": 5339317, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ef7d9ad172fb2e77f8be8c55417588d4?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/5339317/andre"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1443018014, "post_id": 32742044, "comment_id": 53325007, "body": "@Lundin Do you have an iterative solution ?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 165, "user_id": 5339317, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ef7d9ad172fb2e77f8be8c55417588d4?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/5339317/andre"}, "edited": false, "score": 1, "creation_date": 1443018058, "post_id": 32742044, "comment_id": 53325051, "body": "@andre For binary trees, yes. For &quot;family trees&quot;, no."}, {"owner": {"reputation": 16785, "user_id": 3355476, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/YdMWy.jpg?s=128&g=1", "display_name": "Codor", "link": "https://stackoverflow.com/users/3355476/codor"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1443018197, "post_id": 32742044, "comment_id": 53325151, "body": "@Lundin In either case, the OP code seems to delete the nodes in a depth-first sequence. I don&#39;t see how the <code>parent</code> is related to this; it is not accessed in OP&#39;s code."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 16785, "user_id": 3355476, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/YdMWy.jpg?s=128&g=1", "display_name": "Codor", "link": "https://stackoverflow.com/users/3355476/codor"}, "edited": false, "score": 1, "creation_date": 1443018586, "post_id": 32742044, "comment_id": 53325459, "body": "@Codor In a binary tree with a parent member, you would do something like: in a loop: find left-most-node, set parent in temp variable, delete node, if there is a parent-&gt;right node, make that current node, otherwise make parent current node. I might have the source code for it somewhere... Anyway, that&#39;s off topic since this is no binary tree."}, {"owner": {"reputation": 165, "user_id": 5339317, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ef7d9ad172fb2e77f8be8c55417588d4?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/5339317/andre"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1443020297, "post_id": 32742044, "comment_id": 53326771, "body": "@Lundin I updated the code which uses the parent pointer, Is that code correct ?"}, {"owner": {"reputation": 16944, "user_id": 1401879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/261a5f5af181ba929a5b066b19ae124f?s=128&d=identicon&r=PG", "display_name": "Stefan Haustein", "link": "https://stackoverflow.com/users/1401879/stefan-haustein"}, "edited": false, "score": 0, "creation_date": 1443022823, "post_id": 32742044, "comment_id": 53328549, "body": "Well if there are additional constraints it would be nice to specify them in the question...."}], "tags": [], "owner": {"reputation": 16944, "user_id": 1401879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/261a5f5af181ba929a5b066b19ae124f?s=128&d=identicon&r=PG", "display_name": "Stefan Haustein", "link": "https://stackoverflow.com/users/1401879/stefan-haustein"}, "is_accepted": false, "score": 0, "last_activity_date": 1443017752, "creation_date": 1443017752, "answer_id": 32742044, "question_id": 32741705, "link": "https://stackoverflow.com/questions/32741705/free-a-binary-tree-without-recursion/32742044#32742044", "title": "Free a binary tree without recursion", "body": "<p>Why not just do this recurisively?</p>\n\n<pre><code>void removetree(Node *node) {\n  if (node == NULL) {\n    return;\n  }\n  number_of_iterations++;\n  removetree(node-&gt;next);\n  removetree(node-&gt;child);\n  free(node);\n  number_of_deletions++;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 165, "user_id": 5339317, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ef7d9ad172fb2e77f8be8c55417588d4?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/5339317/andre"}, "edited": false, "score": 0, "creation_date": 1443020270, "post_id": 32742398, "comment_id": 53326751, "body": "I updated the code which uses the parent pointer, Is that code correct ?"}], "tags": [], "owner": {"reputation": 16785, "user_id": 3355476, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/YdMWy.jpg?s=128&g=1", "display_name": "Codor", "link": "https://stackoverflow.com/users/3355476/codor"}, "is_accepted": false, "score": 0, "last_activity_date": 1443018657, "creation_date": 1443018657, "answer_id": 32742398, "question_id": 32741705, "link": "https://stackoverflow.com/questions/32741705/free-a-binary-tree-without-recursion/32742398#32742398", "title": "Free a binary tree without recursion", "body": "<p>The implementation does not work for a tree with root <code>1</code>, which has a single child <code>2</code>.</p>\n\n<pre><code>NodeOne.parent = null\nNodeOne.next = null\nNodeOne.child = NodeTwo\n\nNodeTwo.parent = null\nNodeTwo.next = null\nNodeTwo.child = null\n</code></pre>\n\n<p>Execution of <code>Removetree(NodeOne)</code> will not call <code>remove</code> on <code>NodeOne</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 165, "user_id": 5339317, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ef7d9ad172fb2e77f8be8c55417588d4?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/5339317/andre"}, "edited": false, "score": 0, "creation_date": 1443019196, "post_id": 32742494, "comment_id": 53325914, "body": "Please can you write a pseudo code for the iterative version. I don&#39;t get the BFS apporach here."}, {"owner": {"reputation": 165, "user_id": 5339317, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ef7d9ad172fb2e77f8be8c55417588d4?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/5339317/andre"}, "edited": false, "score": 0, "creation_date": 1443020276, "post_id": 32742494, "comment_id": 53326758, "body": "I updated the code which uses the parent pointer, Is that code correct ?"}, {"owner": {"reputation": 893, "user_id": 1183602, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3ZJHj.png?s=128&g=1", "display_name": "Transcendental", "link": "https://stackoverflow.com/users/1183602/transcendental"}, "reply_to_user": {"reputation": 165, "user_id": 5339317, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ef7d9ad172fb2e77f8be8c55417588d4?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/5339317/andre"}, "edited": false, "score": 0, "creation_date": 1443020805, "post_id": 32742494, "comment_id": 53327153, "body": "@andre Note that you are freeing the memory and then trying to access it again  i.e. <code>free(p)</code> and then <code>next(p)</code>"}], "tags": [], "owner": {"reputation": 893, "user_id": 1183602, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3ZJHj.png?s=128&g=1", "display_name": "Transcendental", "link": "https://stackoverflow.com/users/1183602/transcendental"}, "is_accepted": false, "score": 0, "last_activity_date": 1443019928, "last_edit_date": 1443019928, "creation_date": 1443018905, "answer_id": 32742494, "question_id": 32741705, "link": "https://stackoverflow.com/questions/32741705/free-a-binary-tree-without-recursion/32742494#32742494", "title": "Free a binary tree without recursion", "body": "<p>You are freeing only  subtrees, not parent nodes. Suppose <code>child</code> represents the <code>left</code> child of the node and <code>next</code> is the <code>right</code> child. Then, your code becomes:</p>\n\n<pre><code>struct Node{\n    Node *parent;\n    Node *right;\n    Node *left;\n}\n\nint number_of_iterations =0;\nint number_of_deletions =0;\n    void removetree(Node *node)\n    {\n        number_of_iterations++;\n        while(node != NULL)\n        {\n            Node *temp = node;\n\n            if(node-&gt;left != NULL)\n            {\n                node = node-&gt;left;\n                temp-&gt;left = node-&gt;right;\n                node-&gt;right = temp;\n            }\n            else\n            {\n                node = node-&gt;right;\n                remove(temp);\n                number_of_deletions++ \n            }\n        }\n    }\n</code></pre>\n\n<p>Each time your while loop finishes one iteration, a left sub-node will be left without a pointer to it. \nTake, for example the following tree:</p>\n\n<pre><code>             1\n     2                3\n4        5        6         7\n</code></pre>\n\n<p>When <code>node</code> is the root node, the following happens </p>\n\n<ul>\n<li><code>node</code> is pointing to '1'</li>\n<li><code>temp</code> is pointing to '1'</li>\n<li><code>node</code> now points to  '2'</li>\n<li><code>temp-&gt;left</code> now points to  '5'</li>\n<li><code>node-&gt;right</code> now points to '1' </li>\n</ul>\n\n<p>In the next iteration, you begin with \n<code>node</code> pointing to '2' and <code>temp</code> also. As you can see, you did not remove node '1'. This will repeat.</p>\n\n<p>In order to fix this, you might want to consider using <a href=\"https://en.wikipedia.org/wiki/Breadth-first_search\" rel=\"nofollow\">BFS</a> and a queue-like structure to remove all the nodes if you want to avoid recursion.</p>\n\n<p><strong>Edit</strong>\nBFS way:</p>\n\n<ol>\n<li>Create a Queue structure <code>Q</code> </li>\n<li>Add the root node <code>node</code>  to <code>Q</code></li>\n<li>Add left node of <code>node</code> to <code>Q</code></li>\n<li>Add right node of <code>node</code> to <code>Q</code></li>\n<li>Free <code>node</code> and remove it from  <code>Q</code></li>\n<li>Set <code>node</code> = first element of <code>Q</code></li>\n<li>Repeat steps 3-6 until <code>Q</code> becomes empty</li>\n</ol>\n\n<p>This uses the fact that queue is a <a href=\"https://en.wikipedia.org/wiki/FIFO_(computing_and_electronics)\" rel=\"nofollow\">FIFO</a> structure.</p>\n"}, {"comments": [{"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 1, "creation_date": 1443027765, "post_id": 32743347, "comment_id": 53331593, "body": "Yes, you do need <code>parent</code> pointer. In this case you simply hijack <code>left</code> pointer in order to use it as a <code>parent</code> pointer. The only reason you can do that is that the tree is being destructed, allowing us to easily hijack and re-purpose node fields. However, if the original data structure already has readily available <code>parent</code> pointers, the same thing can be done in much more compact and readable fashion."}, {"owner": {"reputation": 16785, "user_id": 3355476, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/YdMWy.jpg?s=128&g=1", "display_name": "Codor", "link": "https://stackoverflow.com/users/3355476/codor"}, "edited": false, "score": 0, "creation_date": 1443029354, "post_id": 32743347, "comment_id": 53332396, "body": "Upvote for the comment that arbitrary trees can be modelled as binary trees."}, {"owner": {"reputation": 50933, "user_id": 360211, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/3baKW.png?s=128&g=1", "display_name": "weston", "link": "https://stackoverflow.com/users/360211/weston"}, "reply_to_user": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1443035483, "post_id": 32743347, "comment_id": 53335920, "body": "@AnT instead of thinking of it as hijacked, think of it as restructuring the tree during it&#39;s destruction."}, {"owner": {"reputation": 50933, "user_id": 360211, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/3baKW.png?s=128&g=1", "display_name": "weston", "link": "https://stackoverflow.com/users/360211/weston"}, "reply_to_user": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1443036691, "post_id": 32743347, "comment_id": 53336609, "body": "@AnT I&#39;d like to reiterate that this is code from that question the OP linked to that they were having trouble implementing. I agree it&#39;s not easy to follow."}, {"owner": {"reputation": 16785, "user_id": 3355476, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/YdMWy.jpg?s=128&g=1", "display_name": "Codor", "link": "https://stackoverflow.com/users/3355476/codor"}, "edited": false, "score": 0, "creation_date": 1443037134, "post_id": 32743347, "comment_id": 53336855, "body": "@weston Yes indeed, but it is an often overlooked fact."}], "tags": [], "owner": {"reputation": 50933, "user_id": 360211, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/3baKW.png?s=128&g=1", "display_name": "weston", "link": "https://stackoverflow.com/users/360211/weston"}, "is_accepted": false, "score": 3, "last_activity_date": 1443021554, "last_edit_date": 1492087139, "creation_date": 1443021221, "answer_id": 32743347, "question_id": 32741705, "link": "https://stackoverflow.com/questions/32741705/free-a-binary-tree-without-recursion/32743347#32743347", "title": "Free a binary tree without recursion", "body": "<p>This <strong>is</strong> a binary tree! It's confusing people because of the names you have chosen, <code>next</code> is common in a linked list but the types are what matters and you have one node referencing exactly two identical nodes types and that's all that matters.</p>\n\n<p>Taken from here: <a href=\"https://codegolf.stackexchange.com/a/489/15982\">https://codegolf.stackexchange.com/a/489/15982</a> which you linked to. And I renamed <code>left</code> to <code>child</code> and <code>right</code> to <code>next</code> :)</p>\n\n<pre><code>void removetree(Node *root) {\n    struct Node * node = root;\n    struct Node * up = NULL;\n\n    while (node != NULL) {\n        if (node-&gt;child != NULL) {\n            struct Node * child = node-&gt;child;\n            node-&gt;child = up;\n            up = node;\n            node = child;\n        } else if (node-&gt;next != NULL) {\n            struct Node * next = node-&gt;next;\n            node-&gt;child = up;\n            node-&gt;next = NULL;\n            up = node;\n            node = next;\n        } else {\n            if (up == NULL) {\n                free(node);\n                node = NULL;\n            }\n            while (up != NULL) {\n                free(node);\n                if (up-&gt;next != NULL) {\n                    node = up-&gt;next;\n                    up-&gt;next = NULL;\n                    break;\n                } else {\n                    node = up;\n                    up = up-&gt;child;\n                }\n            }\n        }\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 165, "user_id": 5339317, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ef7d9ad172fb2e77f8be8c55417588d4?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/5339317/andre"}, "edited": false, "score": 0, "creation_date": 1443035602, "post_id": 32745695, "comment_id": 53335991, "body": "@andre: I&#39;m not sure what you want explained. The code implements the classic non-recursive traversal strategy: go to child, go to sibling, go to parent (choose the first one available). All that one needs to do is to add your <code>remove</code> (or <code>free</code>) call in the appropriate spot."}, {"owner": {"reputation": 165, "user_id": 5339317, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ef7d9ad172fb2e77f8be8c55417588d4?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/5339317/andre"}, "edited": false, "score": 0, "creation_date": 1443036262, "post_id": 32745695, "comment_id": 53336358, "body": "Suppose I have one root node and one child and 3 sibilings. Then I supply the root node for removeTree. First it goes to the one child, but next is not null at this case so it won&#39;t go to the next node and remove it. I&#39;m willing to learn and I want to understand how it works."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1443098845, "post_id": 32745695, "comment_id": 53362458, "body": "@AnT, I&#39;m afraid you are not correct.  To traverse a tree (a recursively, non linear defined) structure, you need some way to store the pointers you are breaking on freeing.  If you don&#39;t you&#39;ll get up to the same point as the op.  Iterative aproaches involve a linked list, some kind of buffering to store all the unlinked nodes that you get from traversing the tree...  but you have used nothing... How did you do it?  (And no explanation at all!!!!)"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1443104356, "post_id": 32745695, "comment_id": 53366574, "body": "@Luis Colorado: Yes, I&#39;m correct. A tree would indeed constitute &quot;a recursive structure&quot;, if it did not have <code>parent</code> pointers. Once you add <code>parent</code> pointers to a tree, it is no longer a recursive structure. It becomes a graph that can be easily traversed by a purely iterative algorithm. The algorithm is so basic that an explanation can be found rather easily on the net. This is essentially the &quot;follow the left wall&quot; algorithm for traversing a labyrinth. As you probably know, a non-cyclic labyrinth can be explored exhaustively by following its left wall."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1443104530, "post_id": 32745695, "comment_id": 53366712, "body": "The same thing is done by the non-recursive tree traversal algorithm I refer to. But in order to use that algorithm you need means to get from any tree node to any adjacent tree node. This is when <code>parent</code> pointers come into play. In order to use this algorithm for tree destruction (as above), all you need to to do is to make sure you don&#39;t deallocate anything prematurely. I.e. deallocated lower-level nodes before higher-level nodes. This is what I do above."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1443104626, "post_id": 32745695, "comment_id": 53366776, "body": "In any case, what you see above is basically 4 lines of code. Is that so difficult to figure out what they do? I thought them self-explanatory. If you believe it is incorrect, you surely should be able to come up with a counterexample."}, {"owner": {"reputation": 165, "user_id": 5339317, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ef7d9ad172fb2e77f8be8c55417588d4?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/5339317/andre"}, "edited": false, "score": 0, "creation_date": 1443117822, "post_id": 32745695, "comment_id": 53375198, "body": "@AnT it&#39;s correct and I have already used it in my code. but why you do this line  node-&gt;child = NULL;? what is the point of it ?"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 165, "user_id": 5339317, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ef7d9ad172fb2e77f8be8c55417588d4?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/5339317/andre"}, "edited": false, "score": 1, "creation_date": 1443119965, "post_id": 32745695, "comment_id": 53376285, "body": "@andre: The algorithm first attempts to go to the child, then (if no child) it attempts to go to the sibling and then (if no sibling) it goes to the parent. Now, once we returned to the parent (from child) we need to make sure that we don&#39;t try to go to the child again, i.e. we don&#39;t cycle forever. This is why we do: <code>-&gt;child = NULL</code>. We basically &quot;burn that bridge&quot; to make sure we never attempt to walk over it again. The fact that the <code>child</code> pointer is now null is what forces us to proceed to the sibling once we return to that node."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1443120183, "post_id": 32745695, "comment_id": 53376397, "body": "Moreover, by the time we return from child to parent, the child is already destroyed (deallocated). I.e. the <code>-&gt;child</code> pointer is no longer valid. It makes sense to set it to null to indicate the fact that the child subtree no longer exists."}, {"owner": {"reputation": 165, "user_id": 5339317, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ef7d9ad172fb2e77f8be8c55417588d4?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/5339317/andre"}, "edited": false, "score": 0, "creation_date": 1443120472, "post_id": 32745695, "comment_id": 53376539, "body": "you mean from a sibling to parent ? how do you return from a child to parent ?"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 165, "user_id": 5339317, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ef7d9ad172fb2e77f8be8c55417588d4?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/5339317/andre"}, "edited": false, "score": 0, "creation_date": 1443128271, "post_id": 32745695, "comment_id": 53380522, "body": "@andre: Well, one the one hand you are right - &quot;from sibling to parent&quot;. On the other hand, all siblings are conceptually &quot;children&quot; of the same parent. I.e. you do return from child to parent. All <code>parent</code> links lead &quot;from child to parent&quot;."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1443161295, "post_id": 32745695, "comment_id": 53390181, "body": "@AnT, I agree with you, but such a tree (with a parent link, something that uses more memory) can be traversed, but not deleting nodes as you traverse, because when you follow one path and deleting the traversed nodes you delete <i>the other path access</i> so you will end in the same situation as the OP.  You have to remember the open, unvisited paths so you can return there when you reach a dead end.  The only way to have such a graph and delete nodes without breaking the tree is to make a n-passes algorithm that only deletes leaf nodes and nodes with only one child (adjusting the links)"}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1443161460, "post_id": 32745695, "comment_id": 53390252, "body": "... or you can make a two pass traverse (first filling a list with the pointers to the already traversed nodes) and a second pass to delete the nodes.  This is equivalent <i>to add parent links to all the nodes</i> indeed, but you only need it to make the deletion."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1443190808, "post_id": 32745695, "comment_id": 53407329, "body": "@Luis Colorado: I don&#39;t know where you got the idea that I &quot;follow one path and delete the traversed nodes&quot;. I <i>don&#39;t</i> delete the nodes as I follow the path <i>down</i> from root to children. The nodes are deleted <i>only</i> on the way <i>up</i>, when the subtree is already gone (which is exactly what&#39;s ensured by the <code>if</code> in the above code). The tree above the current node is always kept intact, and this is exactly why I can always return through <code>parent</code> links &quot;when I reach dead end&quot;."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1443190903, "post_id": 32745695, "comment_id": 53407399, "body": "Your assertion that this is only possible by &quot;doing n passes and deleting only leaf nodes&quot; makes no sense whatsoever. Such assertion would make sense if we had no <code>parent</code> links in the tree, as I stated many times before. But we do have them. Anyway, the bottom line here is that the code above is perfectly correct and correctly deletes the tree. Your unsupported claims that &quot;it can&#39;t work because it can&#39;t work&quot;... well, sorry, they just make no sense to me. Surely, if you see a clear problem in this implementation, you should be able to build a counterexample. Do you have a counterexample?"}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1443295568, "post_id": 32745695, "comment_id": 53439449, "body": "@AnT, I have published an iterative solution that doesn&#39;t require the <code>parent</code> pointer.   Requiring a <code>parent</code> pointer is a costly option in case you are going to manage actually big trees."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1443300086, "post_id": 32745695, "comment_id": 53440819, "body": "@Luis Colorado: That&#39;s great, but firstly, we have a specific statement of a problem from the OP, which <i>does</i> include <code>parent</code> pointers. My answer is made in that context. Secondly, there&#39;s always a trade-off between pros and cons of <code>parent</code> pointers. For one example, the possibility to implement a tree iterator of <i>constant</i> size is a huge benefit provided by <code>parent</code> pointers. Whether the OP can (and wants to) afford the cost of <code>parent</code> pointers is for the OP to decide."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1461277624, "post_id": 32745695, "comment_id": 61139439, "body": "@Luis Colorado: Your solution is indeed iterative, but completely infeasible in practice: doing repretitive rescans of the entire remaining tree starting from the root each time is prohibitively expensive. That is why we add &quot;excessive&quot; <code>parent</code> pointers to tree nodes sometimes: to pay a small price in terms of memory to obtain a <i>massive</i> gain in performance (as compared to your implementation)."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1461329128, "post_id": 32745695, "comment_id": 61162757, "body": "@AnT, totally in agreement with you. I&#39;m not trying to give a good solution. I&#39;m trying to illustrate a solution with <b>no extra memory</b> and <b>pure iterative</b> (so no queues are used, and no dynamic memory used to buffer the pointers and orphan nodes we are collecting in the erasure process).  I&#39;m trying to illustrate the problems you get into when you try to solve a recursive problem in a non recursive way.  Did you read about the Physics exam of Neils Bohr and Sir Ernst Rutherford?"}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1461329332, "post_id": 32745695, "comment_id": 61162912, "body": "... and now, memory is cheap, you can use parent pointers as you like, queues or stacks to overcome recursive definitions."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1461329616, "post_id": 32745695, "comment_id": 61163111, "body": "The basic problem here is that you <b>actually</b> need some dynamic allocation structure to get rid of the undeleted nodes that you get.  For each fully populated node (not a leaf node) that you erase, you get <b>two</b> unreferenced nodes, so the number of nodes to be recorded grows exponentially (you need a dynamic memory structure to store them, or the algorithm I put in the solution)"}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1461330367, "post_id": 32745695, "comment_id": 61163670, "body": "By the way, your solution <b>is incorrect</b>, as it doesn&#39;t process both children in a complete node, so it leads forcefully to a memory leak.  You don&#39;t present a complete (testable) example and mine has been tested (you have only to execute it to see that it erases all nodes)"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1461332340, "post_id": 32745695, "comment_id": 61165170, "body": "@Luis Colorado: Again, you are confused about how my solution works. Your assertion about &quot;number of nodes to be recorded grows exponentially&quot; is only true is the nodes are erased in &quot;top-to-bottom&quot; order. Only in this case you will two child nodes to memorize each time you erase a parent node. My solution works in &quot;bottom-to-top&quot; order. By the time I erase a node, its left subtree (<code>child</code> pointer) is already guaranteed to be erased. For this reason, there&#39;s always no more than one node to &quot;memorize&quot;.  And this is exactly why it is possible to build a purely iterative solution."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1461332586, "post_id": 32745695, "comment_id": 61165375, "body": "Your assertion that my solution is &quot;incorrect&quot; is ridiculous. Yes, my solution does erase all nodes. And no, it does not lead to any memory leaks. Meanwhile, your complaint about &quot;testable examples&quot; is ridiculous as well. &quot;Examples&quot; cannot be used to prove the correctness of a solution, regardless of how many one provides. However, examples can be used to prove that a solution is wrong. Just one counterexample is enough for that. You claim that my solution is incorrect. If so, you should be able to build a counterexample. Can you do it?"}], "tags": [], "owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "is_accepted": true, "score": 4, "last_activity_date": 1461336423, "last_edit_date": 1461336423, "creation_date": 1443028797, "answer_id": 32745695, "question_id": 32741705, "link": "https://stackoverflow.com/questions/32741705/free-a-binary-tree-without-recursion/32745695#32745695", "title": "Free a binary tree without recursion", "body": "<p>If your nodes do indeed contain valid <code>parent</code> pointers, then the whole thing can be done in a much more compact and readable fashion</p>\n\n<pre><code>void removetree(Node *node)\n{\n  while (node != NULL)\n  {\n    Node *next = node-&gt;child;\n\n    /* If child subtree exists, we have to delete that child subtree \n       first. Once the child subtree is gone, we'll be able to delete \n       this node. At this moment, if child subtree exists, don't delete\n       anything yet - just descend into the child subtree */\n\n    node-&gt;child = NULL;\n    /* Setting child pointer to null at this early stage ensures that \n       when we emerge from child subtree back to this node again, we will \n       be aware of the fact that child subtree is gone */\n\n    if (next == NULL)\n    { /* Child subtree does not exist - delete the current node, \n         and proceed to sibling node. If no sibling, the current \n         subtree is fully deleted - ascend to parent */\n      next = node-&gt;next != NULL ? node-&gt;next : node-&gt;parent;\n      remove(node); // or `free(node)`\n    }\n\n    node = next;\n  }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1461277269, "post_id": 32780108, "comment_id": 61139310, "body": "So, you first stated that having <code>parent</code> references is too expensive in large trees, but then you came up with a solution that performs repetitive rescans of the entire tree again, again and again (!), deleting only &quot;degree 2&quot; nodes on each rescan. While it saves memory by omitting <code>parent</code> pointers, the price you pay for that in terms of execution time is enormous. It is catastrophically expensive. An implementation like that can only have illustrational value, but no practical value at all."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "reply_to_user": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1461328766, "post_id": 32780108, "comment_id": 61162462, "body": "Well, look at my first paragraph that says trying to solve a recursive problem in a non recursive way...   By the way, my solution tries to save memory, not allocating a buffer of already traversed nodes, to get more pointers for children.  What is true is that as long as you traverse the tree, you get more and more references to nodes to traverse and you have to store them in some way.  The no-store algorithm is something like this.  Of course, this algorithm is not recommendable, but also isn&#39;t to solve the problem in a non recursive way.  The OP does not say anything about that."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "reply_to_user": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1461330120, "post_id": 32780108, "comment_id": 61163483, "body": "As I tell you in another comment, for each complete node (two children) you have two nodes to store somewhere once you erase the one you are in.  Of course you can make one of the children the actual child of the erased parent, but you have to cope with the other.  Either case, you can avoid the descend from the root using the parent, but the algorithm doesn&#39;t change... you have to iterate through three pointers into a labirinth searching for leave nodes (or only one child) to erase.  You&#39;ll get a lot of navigations and unlink/link operations before you fully erase the tree."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1461335552, "post_id": 32780108, "comment_id": 61167415, "body": "Above you claim that &quot;you have two nodes to store somewhere once you erase the one you are in&quot;, which is only true if you insist on erasing parent before the children. At the same time in your own algorithm you are erasing children first. So, what is the importance of the &quot;two nodes to store&quot; if you already realize that other deletion orders are possible? There&#39;s no requirement to erase parents before children. My solution always erases left subtree before erasing the parent. So, by the time we get to erasing the parent, only one node has to be stored."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1461335817, "post_id": 32780108, "comment_id": 61167587, "body": "This is exactly what permits a purely iterative implementation without any rescanning of the full tree. All you need is a non-recursive traversal algorithm. And when the tree has <code>parent</code> links, non-recursive traversal is easy."}], "tags": [], "owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "is_accepted": false, "score": 1, "last_activity_date": 1443178603, "last_edit_date": 1443178603, "creation_date": 1443176607, "answer_id": 32780108, "question_id": 32741705, "link": "https://stackoverflow.com/questions/32741705/free-a-binary-tree-without-recursion/32780108#32780108", "title": "Free a binary tree without recursion", "body": "<p>First to say is that if you try to solve a recursive problem in a non-recursive way, you'll run into trouble.</p>\n\n<p>I have seen a wrong answer selected as the good one, so I'll try to show my approach:</p>\n\n<p>I'll begin using pointer references instead of plain pointers, as passing a root pointer reference makes it easier to detect (and update) the pointers to the root node.  So the interface to the routine will be:</p>\n\n<pre><code>void delete_tree(struct node * * const ref);\n</code></pre>\n\n<p>It represents a reference to the pointer that points to the root node.  I'll descend to the node and, if one of <code>child</code> or <code>next</code> is <code>NULL</code> then this node can be freely eliminated by just making the referenced pointer to point to the other link (so I'll not lose it).  If the node has two children (<code>child</code> and <code>next</code> are both <code>!= NULL</code>) then I cannot delete this node until one of the branches has collapsed, and then I select one of the branches and move the reference (I declared the <code>ref</code> parameter <code>const</code> to assure I don't modify it, so I use another <em>moving</em> reference for this)</p>\n\n<pre><code>struct node **moving_reference;\n</code></pre>\n\n<p>Then, the algorithm follows:</p>\n\n<pre><code>void tree_delete(struct node ** const static_ref)\n{\n    while (*static_ref) {\n        struct node **moving_ref = static_ref;\n\n        while (*moving_ref) {\n            struct node *to_be_deleted = NULL;\n\n            if ((*moving_ref)-&gt;child &amp;&amp; (*moving_ref)-&gt;next) {\n                /* we have both children, we cannot delete until\n                 * ulterior pass. Just move the reference. */\n                moving_ref = &amp;(*moving_ref)-&gt;child;\n            } else if ((*moving_ref)-&gt;child) {\n                /* not both != NULL and child != NULL, \n                 * so next == NULL */\n                to_be_deleted = *moving_ref;\n                *moving_ref = to_be_deleted-&gt;child;\n            } else {\n                /* not both != NULL and child == NULL,\n                 * so follow next */\n                to_be_deleted = *moving_ref;\n                *moving_ref = to_be_deleted-&gt;next;\n            } /* if, else if */\n            /* now, delete the unlinked node, if available */\n            if (to_be_deleted) node_delete(to_be_deleted);\n        } /* while (*moving_ref) */\n    } /* while (*static_ref) */\n} /* delete_tree */\n</code></pre>\n\n<p>I have included this algorithm in a complete example, showing you the partial trees and the position of <code>moving_ref</code> as it moves through the tree.  It also shows the passes needed to delete it.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define N 100\n\n#define D(x) __FILE__\":%d:%s: \" x, __LINE__, __func__\n\n#define ASSERT(x) do { \\\n        int res; \\\n        printf(D(\"ASSERT: (\" #x \") ==&gt; %s\\n\"), \\\n                        (res = (int)(x)) ? \"TRUE\" : \"FALSE\"); \\\n        if (!res) exit(EXIT_FAILURE); \\\n} while (0)\n\nstruct node {\n        int key;\n        struct node *child;\n        struct node *next;\n}; /* struct node */\n\nstruct node *node_alloc(void);\nvoid node_delete(struct node *n);\n\n/* This routine has been written recursively to show the simplicity\n * of traversing the tree when you can use recursive algorithms. */\nvoid tree_traverse(struct node *n, struct node *p, int lvl)\n{\n    while(n) {\n        printf(D(\"%*s[%d]\\n\"), lvl&lt;&lt;2, p &amp;&amp; p == n ? \"&gt;\" : \"\", n-&gt;key);\n        tree_traverse(n-&gt;child, p, lvl+1);\n        n = n-&gt;next;\n    } /* while */\n} /* tree_traverse */\n\nvoid tree_delete(struct node ** const static_ref)\n{\n    int pass;\n\n    printf(D(\"BEGIN\\n\"));\n\n    for (pass = 1; *static_ref; pass++) {\n        struct node **moving_ref = static_ref;\n\n        printf(D(\"Pass #%d: Considering node %d:\\n\"),\n                        pass, (*moving_ref)-&gt;key);\n\n        while (*moving_ref) {\n            struct node *to_be_deleted = NULL;\n\n            /* print the tree before deciding what to do. */\n            tree_traverse(*static_ref, *moving_ref, 0);\n\n            if ((*moving_ref)-&gt;child &amp;&amp; (*moving_ref)-&gt;next) {\n                printf(D(\"Cannot remove, Node [%d] has both children, \"\n                                        \"skip to 'child'\\n\"),\n                                (*moving_ref)-&gt;key);\n                /* we have both children, we cannot delete until\n                 * ulterior pass. Just move the reference. */\n                moving_ref = &amp;(*moving_ref)-&gt;child;\n            } else if ((*moving_ref)-&gt;child) {\n                /* not both != NULL and child != NULL, \n                 * so next == NULL */\n                to_be_deleted = *moving_ref;\n                printf(D(\"Deleting [%d], link through 'child' pointer\\n\"),\n                                to_be_deleted-&gt;key);\n                *moving_ref = to_be_deleted-&gt;child;\n            } else {\n                /* not both != NULL and child != NULL,\n                 * so follow next */\n                to_be_deleted = *moving_ref;\n                printf(D(\"Deleting [%d], link through 'next' pointer\\n\"),\n                                to_be_deleted-&gt;key);\n                *moving_ref = to_be_deleted-&gt;next;\n            } /* if, else if */\n\n            /* now, delete the unlinked node, if available */\n            if (to_be_deleted) node_delete(to_be_deleted);\n        } /* while (*moving_ref) */\n        printf(D(\"Pass #%d end.\\n\"), pass);\n    } /* for */\n\n    printf(D(\"END.\\n\"));\n} /* delete_tree */\n\nstruct node heap[N] = {0};\nsize_t allocated = 0;\nsize_t deleted = 0;\n\n/* simple allocation/free routines, normally use malloc(3). */\nstruct node *node_alloc()\n{\n        return heap + allocated++;\n} /* node_alloc */\n\nvoid node_delete(struct node *n)\n{\n        if (n-&gt;key == -1) {\n                fprintf(stderr,\n                                D(\"doubly freed node %ld\\n\"),\n                                (n - heap));\n        }\n        n-&gt;key = -1;\n        n-&gt;child = n-&gt;next = NULL;\n        deleted++;\n} /* node_delete */\n\n/* main simulation program. */\nint main()\n{\n        size_t i;\n\n        printf(D(\"Allocating %d nodes...\\n\"), N);\n        for (i = 0; i &lt; N; i++) {\n                struct node *n;\n\n                n = node_alloc(); /* the node */\n                n-&gt;key = i;\n                n-&gt;next = NULL;\n                n-&gt;child = NULL;\n\n                printf(D(\"Node %d\"), n-&gt;key);\n\n                if (i) { /* when we have more than one node */\n                        /* get a parent for it. */\n                        struct node *p = heap + (rand() % i);\n\n                        printf(\", parent %d\", p-&gt;key);\n                        /* insert as a child of the parent */\n                        n-&gt;next = p-&gt;child;\n                        p-&gt;child = n;\n                } /* if */\n                printf(\"\\n\");\n        } /* for */\n\n        struct node *root = heap;\n\n        ASSERT(allocated == N);\n        ASSERT(deleted == 0);\n\n        printf(D(\"Complete tree:\\n\"));\n        tree_traverse(root, NULL, 0);\n\n        tree_delete(&amp;root);\n\n        ASSERT(allocated == N);\n        ASSERT(deleted == N);\n} /* main */\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7725247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3Rk8X.png?s=128&g=1", "display_name": "Dmitry D. Chernov", "link": "https://stackoverflow.com/users/7725247/dmitry-d-chernov"}, "is_accepted": false, "score": 0, "last_activity_date": 1524762486, "creation_date": 1524762486, "answer_id": 50048545, "question_id": 32741705, "link": "https://stackoverflow.com/questions/32741705/free-a-binary-tree-without-recursion/50048545#50048545", "title": "Free a binary tree without recursion", "body": "<p>Code that was proposed by @AnT is incorrect, because it frees node right after traversing and freeing its left subtree but before doing the same with the right subtree. So, on ascending from the right subtree we'll step on the parent node that was already freed.</p>\n\n<p>This is a correct approach, in C89. It still requires the <code>parent</code> links, though.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>void igena_avl_subtree_free( igena_avl_node_p root ) {\n  igena_avl_node_p next_node;\n{\n  while (root != NULL) {\n    if (root-&gt;left != NULL) {\n      next_node = root-&gt;left;\n      root-&gt;left = NULL;\n    } else if (root-&gt;right != NULL) {\n      next_node = root-&gt;right;\n      root-&gt;right = NULL;\n    } else {\n      next_node = root-&gt;parent;\n      free( root );\n    }\n    root = next_node;\n  }\n}}\n</code></pre>\n\n<p>Taken directly from my own project <a href=\"https://github.com/cher-nov/Gena\" rel=\"nofollow noreferrer\">Gena</a>.</p>\n"}], "owner": {"reputation": 165, "user_id": 5339317, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ef7d9ad172fb2e77f8be8c55417588d4?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/5339317/andre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2944, "favorite_count": 1, "accepted_answer_id": 32745695, "answer_count": 8, "score": 3, "last_activity_date": 1524762486, "creation_date": 1443016791, "last_edit_date": 1495540452, "question_id": 32741705, "link": "https://stackoverflow.com/questions/32741705/free-a-binary-tree-without-recursion", "title": "Free a binary tree without recursion", "body": "<p>refering to the question <a href=\"https://stackoverflow.com/questions/32733353/deallocating-binary-tree-structure-in-c?noredirect=1#comment53322817_32733353\">Deallocating binary-tree structure in C</a></p>\n\n<pre><code>struct Node{\n    Node *parent;\n    Node *next;\n    Node *child;\n}\n</code></pre>\n\n<p>I tried to free a binary tree. The problem I have is the allocated objects are 5520 and the number of calls to the free functions is 2747. I don't know why, it should really free and iterate all over the nodes in the tree, here is the code that I use</p>\n\n<pre><code>int number_of_iterations =0;\nint number_of_deletions =0;\n    void removetree(Node *node)\n    {\n        number_of_iterations++;\n        while(node != NULL)\n        {\n            Node *temp = node;\n\n            if(node-&gt;child != NULL)\n            {\n                node = node-&gt;child;\n                temp-&gt;child = node-&gt;next;\n                node-&gt;next = temp;\n            }\n            else\n            {\n                node = node-&gt;next;\n                remove(temp);\n                number_of_deletions++ \n            }\n        }\n    }\n</code></pre>\n\n<p>Number of iteration is 5440 and the number of deletions is 2747.</p>\n\n<p>New Fixed code: is that code correct ?</p>\n\n<pre><code> const Node *next(const Node *node)\n    {\n        if (node == NULL) return NULL;\n        if (node-&gt;child) return node-&gt;child;\n\n        while (node &amp;&amp; node-&gt;next == NULL) {\n            node = node-&gt;parent;\n        }\n\n        if (node) return node-&gt;next;\n        return NULL;\n    }\n\n for ( p= ctx-&gt;obj_root; p; p = next(p)) {\n      free(p);\n     }\n</code></pre>\n"}, {"tags": ["c", "linux", "centos", "centos7", "pam"], "answers": [{"comments": [{"owner": {"reputation": 11768, "user_id": 2274686, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/z3EDW.jpg?s=128&g=1", "display_name": "vdenotaris", "link": "https://stackoverflow.com/users/2274686/vdenotaris"}, "edited": false, "score": 0, "creation_date": 1443022836, "post_id": 32741712, "comment_id": 53328555, "body": "Hi. I tried this solution but it still doesn&#39;t work. Take into account that the code above is the open provided by Apple, probably (surely) the version on CentOS has a different setup."}, {"owner": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "reply_to_user": {"reputation": 11768, "user_id": 2274686, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/z3EDW.jpg?s=128&g=1", "display_name": "vdenotaris", "link": "https://stackoverflow.com/users/2274686/vdenotaris"}, "edited": false, "score": 0, "creation_date": 1443023494, "post_id": 32741712, "comment_id": 53328997, "body": "@vdenotaris: You are right, it is slightly different. I&#39;ve just checked the Linux version and the file is <code>&#47;var&#47;run&#47;pam-debug.log</code>. Also, PAM must be compiled with macro <code>PAM_DEBUG</code>, not <code>DEBUG</code>, as the Apple one."}], "tags": [], "owner": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "is_accepted": true, "score": 2, "last_activity_date": 1443079512, "last_edit_date": 1443079512, "creation_date": 1443016820, "answer_id": 32741712, "question_id": 32741574, "link": "https://stackoverflow.com/questions/32741574/pam-standard-macros-and-logging-on-centos7/32741712#32741712", "title": "PAM standard macros and logging on CentOS7", "body": "<p>In the file you link, there are these lines at the top:</p>\n\n<pre><code>/*\n * This is for debugging purposes ONLY. DO NOT use on live systems !!!\n * You have been warned :-) - CG\n *\n * to get automated debugging to the log file, it must be created manually.\n * _PAM_LOGFILE must exist, mode 666\n */\n\n#ifndef _PAM_LOGFILE\n#define _PAM_LOGFILE \"/tmp/pam-debug.log\"\n#endif\n</code></pre>\n\n<p>So it looks like the output will be directed to <code>/tmp/pam-debug.log</code>, but you have to create it before, and give it full read-write permissions:</p>\n\n<pre><code>$ touch /tmp/pam-debug.log\n$ chmod 666 /tmp/pam-debug.log\n</code></pre>\n\n<p>Looking to the Linux version of this file, it looks like it is written to <code>/var/run/pam-debug.log</code>, but only if it is compiled with <code>PAM_DEBUG</code>.</p>\n\n<p>There a nice comment in <code>configure.ac</code>:</p>\n\n<pre><code>if test x\"$enable_debug\" = x\"yes\" ; then\n       AC_DEFINE([PAM_DEBUG],,\n                [lots of stuff gets written to /var/run/pam-debug.log])\n</code></pre>\n"}], "owner": {"reputation": 11768, "user_id": 2274686, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/z3EDW.jpg?s=128&g=1", "display_name": "vdenotaris", "link": "https://stackoverflow.com/users/2274686/vdenotaris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 477, "favorite_count": 0, "accepted_answer_id": 32741712, "answer_count": 1, "score": 0, "last_activity_date": 1443079512, "creation_date": 1443016446, "question_id": 32741574, "link": "https://stackoverflow.com/questions/32741574/pam-standard-macros-and-logging-on-centos7", "title": "PAM standard macros and logging on CentOS7", "body": "<p>According to the <code>D(x)</code> macro defined in <code>pam_macros.h</code> (<strong><a href=\"http://www.opensource.apple.com/source/pam/pam-9/pam/libpam/include/pam/_pam_macros.h\" rel=\"nofollow\">source code</a></strong>) and used as follows:</p>\n\n<pre><code>D((\"Hello PAM World\"));\n</code></pre>\n\n<p>Where is this log located on <code>CentOS7</code>?</p>\n\n<p>Note that I am using as flag <code>debug</code> in my <code>pam.d</code> conf file.</p>\n\n<p>I tried also the following command:</p>\n\n<pre><code>grep -rnw '/var/log/' -e \"Hello Pam World\"\n</code></pre>\n\n<p>But with no success.</p>\n"}, {"tags": ["c", "struct", "structure", "dynamic-allocation"], "comments": [{"owner": {"reputation": 5171, "user_id": 2718186, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/ca44ca18bf615e74f930d28a89d01508?s=128&d=identicon&r=PG", "display_name": "MicroVirus", "link": "https://stackoverflow.com/users/2718186/microvirus"}, "edited": false, "score": 4, "creation_date": 1443015713, "post_id": 32741154, "comment_id": 53323226, "body": "The pointer abuse group will be wanting a word with you. On a serious note, you are losing the original pointer already in the line <code>OBJ foo = *Construct(10,20)</code>."}, {"owner": {"reputation": 8296, "user_id": 2932052, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/63b8d6f5ce8e33b6953812ce8f5b2d40?s=128&d=identicon&r=PG", "display_name": "Wolf", "link": "https://stackoverflow.com/users/2932052/wolf"}, "edited": false, "score": 0, "creation_date": 1443015953, "post_id": 32741154, "comment_id": 53323410, "body": "Seems you have a Java or Delphi background? So there is something to learn about pointers."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1443016092, "post_id": 32741154, "comment_id": 53323522, "body": "It is not possible to call <code>free()</code> on memory allocated on the stack: <code>freeup(&amp;foo);</code>"}, {"owner": {"reputation": 8296, "user_id": 2932052, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/63b8d6f5ce8e33b6953812ce8f5b2d40?s=128&d=identicon&r=PG", "display_name": "Wolf", "link": "https://stackoverflow.com/users/2932052/wolf"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1443016551, "post_id": 32741154, "comment_id": 53323900, "body": "@alk but seems <i>possible</i>, It&#39;s clear: you should never do this. Can you describe what happens here? UB?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 8296, "user_id": 2932052, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/63b8d6f5ce8e33b6953812ce8f5b2d40?s=128&d=identicon&r=PG", "display_name": "Wolf", "link": "https://stackoverflow.com/users/2932052/wolf"}, "edited": false, "score": 1, "creation_date": 1443016641, "post_id": 32741154, "comment_id": 53323976, "body": "@Wolf: &quot;It <b>seems</b> possible.&quot; Is a <b>very</b> weak argument in C."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 8296, "user_id": 2932052, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/63b8d6f5ce8e33b6953812ce8f5b2d40?s=128&d=identicon&r=PG", "display_name": "Wolf", "link": "https://stackoverflow.com/users/2932052/wolf"}, "edited": false, "score": 0, "creation_date": 1443016738, "post_id": 32741154, "comment_id": 53324042, "body": "Sure, calling <code>free()</code> on anything not a null-pointer or allocated by <code>malloc&#47;calloc&#47;realloc</code> invokes the infamous Undefined Behaviour, after which  anything can happen. @Wolf"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1443017020, "post_id": 32741154, "comment_id": 53324260, "body": "Note: <code>OBJ* x</code> is somewhat missleading when read. move the space before the <code>*</code>: <code>OBJ *x</code>. See this construct <code>int* ip, i;</code> remember: <code>i</code> will <b>not</b> be a pointer as the visual binding of the <code>*</code> to <code>int</code> implies. Instead the <code>*</code> only belongs to <code>ip</code>."}, {"owner": {"reputation": 8296, "user_id": 2932052, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/63b8d6f5ce8e33b6953812ce8f5b2d40?s=128&d=identicon&r=PG", "display_name": "Wolf", "link": "https://stackoverflow.com/users/2932052/wolf"}, "edited": false, "score": 0, "creation_date": 1443017075, "post_id": 32741154, "comment_id": 53324304, "body": "I see (what I expected). But it also had been possible, that free had a built-in is-stack test (I&#39;m happy to have stopped using <code>free</code> when changing from C to C++). Thanks for the clarification!"}], "answers": [{"comments": [{"owner": {"reputation": 18805, "user_id": 34771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c1a3f9227c0cb408f8831d27d611ab2?s=128&d=identicon&r=PG", "display_name": "Vatine", "link": "https://stackoverflow.com/users/34771/vatine"}, "edited": false, "score": 0, "creation_date": 1443015841, "post_id": 32741296, "comment_id": 53323319, "body": "You are double-freeing the allocated memory, which is a problem. You are also passing the value of the pointer twice (you have set a pass-by-value copy of &amp;foo to 0, this does not change &amp;foo)."}, {"owner": {"reputation": 8296, "user_id": 2932052, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/63b8d6f5ce8e33b6953812ce8f5b2d40?s=128&d=identicon&r=PG", "display_name": "Wolf", "link": "https://stackoverflow.com/users/2932052/wolf"}, "edited": false, "score": 1, "creation_date": 1443015889, "post_id": 32741296, "comment_id": 53323351, "body": "Right. ...but it doesn&#39;t answer the original question. Maybe suggest a <code>OBJ **x</code> parameter as well. (or better not?)"}, {"owner": {"reputation": 18805, "user_id": 34771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c1a3f9227c0cb408f8831d27d611ab2?s=128&d=identicon&r=PG", "display_name": "Vatine", "link": "https://stackoverflow.com/users/34771/vatine"}, "reply_to_user": {"reputation": 8296, "user_id": 2932052, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/63b8d6f5ce8e33b6953812ce8f5b2d40?s=128&d=identicon&r=PG", "display_name": "Wolf", "link": "https://stackoverflow.com/users/2932052/wolf"}, "edited": false, "score": 0, "creation_date": 1443015984, "post_id": 32741296, "comment_id": 53323436, "body": "@Wolf Is my comment clearer now? I completely forgot that pressing the return key doesn&#39;t give me a new line and instead submitted the comment. :/"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1443015990, "post_id": 32741296, "comment_id": 53323442, "body": "... and call <code>freeup(OBJ **)</code> like this <code>freeup(&amp;foo);</code>."}, {"owner": {"reputation": 8296, "user_id": 2932052, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/63b8d6f5ce8e33b6953812ce8f5b2d40?s=128&d=identicon&r=PG", "display_name": "Wolf", "link": "https://stackoverflow.com/users/2932052/wolf"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1443016743, "post_id": 32741296, "comment_id": 53324043, "body": "@alk I added a line to complete this <i>option</i>"}], "tags": [], "owner": {"reputation": 7267, "user_id": 1051621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JAEvg.jpg?s=128&g=1", "display_name": "Mark Shevchenko", "link": "https://stackoverflow.com/users/1051621/mark-shevchenko"}, "is_accepted": true, "score": 4, "last_activity_date": 1443016692, "last_edit_date": 1443016692, "creation_date": 1443015717, "answer_id": 32741296, "question_id": 32741154, "link": "https://stackoverflow.com/questions/32741154/freed-pointer-reallocaing-itself/32741296#32741296", "title": "Freed pointer reallocaing itself?", "body": "<p>First, this line is allocates <code>foo</code> on the stack and then copies dynamically allocated struct to the place:</p>\n\n<pre><code>OBJ foo = *Construct(10, 20);\n</code></pre>\n\n<p>Of cause, you shouldn't free it. Correct case is:</p>\n\n<pre><code>OBJ* foo = Construct(10, 20);\n. . .\nfreeup(foo);\n</code></pre>\n\n<p>Second, if you want to clear pointer in <code>freeup</code>, then change the type of parameter to pointer-to-pointer:</p>\n\n<pre><code>void freeup(OBJ** x)\n{\n   free(*x);\n   *x=NULL;\n}\n</code></pre>\n\n<p>...In this case you should change the <code>freeup</code> call into <code>freeup(&amp;foo);</code>.</p>\n\n<p>Finally, it may seem that <code>foo</code> is reallocated in you code, but it just can't be freed or allocated, it's a stack variable. So pointer to <code>foo</code> is always the same inside the function.</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 5367841, "user_type": "registered", "profile_image": "https://graph.facebook.com/411619039024394/picture?type=large", "display_name": "Kyle Weddermann", "link": "https://stackoverflow.com/users/5367841/kyle-weddermann"}, "edited": false, "score": 0, "creation_date": 1443016468, "post_id": 32741412, "comment_id": 53323824, "body": "I see now that I should&#39;ve just not used pointers as I don&#39;t really <i>need</i> to. I thank you."}], "tags": [], "owner": {"reputation": 5171, "user_id": 2718186, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/ca44ca18bf615e74f930d28a89d01508?s=128&d=identicon&r=PG", "display_name": "MicroVirus", "link": "https://stackoverflow.com/users/2718186/microvirus"}, "is_accepted": false, "score": 2, "last_activity_date": 1443016019, "creation_date": 1443016019, "answer_id": 32741412, "question_id": 32741154, "link": "https://stackoverflow.com/questions/32741154/freed-pointer-reallocaing-itself/32741412#32741412", "title": "Freed pointer reallocaing itself?", "body": "<p>You are losing your pointer in the line</p>\n\n<pre><code>OBJ foo = *Construct(10, 20);\n</code></pre>\n\n<p>You take the struct <code>OBJ</code> that the pointer returned by <code>Construct</code> points to, copy its values to <code>foo</code> and then throw away the pointer.\nAfter that, because you have no pointer, you have no way to free the actual <code>struct OBJ</code> allocated by <code>Constructor</code>.</p>\n\n<p>Your <code>freeup</code> calls are wrong then, because you try to free <code>foo</code>, rather than the original.</p>\n\n<p>The correct way is to either keep working with the pointer, so</p>\n\n<pre><code>OBJ *foo = Construct(10, 20);\n...\nfreeup(foo);\n</code></pre>\n\n<p>or not use pointers at all and just return an <code>OBJ</code> in <code>Construct</code>, rather than an <code>OBJ*</code>. That way, there is no need to worry about freeing anything.</p>\n"}, {"tags": [], "owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "is_accepted": false, "score": 1, "last_activity_date": 1443016502, "last_edit_date": 1443016502, "creation_date": 1443016175, "answer_id": 32741463, "question_id": 32741154, "link": "https://stackoverflow.com/questions/32741154/freed-pointer-reallocaing-itself/32741463#32741463", "title": "Freed pointer reallocaing itself?", "body": "<pre><code> OBJ foo = *Construct(10, 20);\n</code></pre>\n\n<p>Due to this you looses your pointer which points to block allocated by <code>malloc</code> . So <code>free</code>ing memory not allocated by <code>malloc</code> or similar cause error in program.</p>\n\n<p>And this I really don't understand (taking in general - should not be done with pointer also )-</p>\n\n<pre><code>freeup(&amp;foo);              // just one call is enough \nfreeup(&amp;foo);              // Why twice ?  \n</code></pre>\n\n<p>And this -</p>\n\n<pre><code>  void freeup(OBJ *x)\n{\n    printf(\"x pointer -&gt; %d \", x);\n    free(x);\n    x=NULL;\n    printf(\"\\nx pointer -&gt; %d\\n\", x);          // should not be done in any case after assigning pointer to NULL\n}\n</code></pre>\n\n<p>You can do this instead-</p>\n\n<pre><code>  void freeup(OBJ **x)\n   {\n        printf(\"x pointer -&gt; %d \", *x);\n        free(*x);\n       *x = NULL;\n  }\n</code></pre>\n\n<p>Call it in a same manner as you do <code>freeup(&amp;foo);</code></p>\n"}, {"tags": [], "owner": {"reputation": 129197, "user_id": 464988, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/2b7216361772f42fefdb90cbc8bd7855?s=128&d=identicon&r=PG", "display_name": "MByD", "link": "https://stackoverflow.com/users/464988/mbyd"}, "is_accepted": false, "score": 1, "last_activity_date": 1443016277, "creation_date": 1443016277, "answer_id": 32741503, "question_id": 32741154, "link": "https://stackoverflow.com/questions/32741154/freed-pointer-reallocaing-itself/32741503#32741503", "title": "Freed pointer reallocaing itself?", "body": "<p>You have multiple problems in your code:</p>\n\n<ol>\n<li>Losing reference to the original malloc'd pointer</li>\n<li>Trying to free an object on the stack</li>\n<li>Assigning 0 to the copy of the pointer (passed to freeup)</li>\n</ol>\n\n<p>(1) The line <code>OBJ foo = *Construct(10, 20);</code> doen't assign the pointer to the allocated OBJ to foo, but copies the <code>OBJ</code>'s value to the stack, to a variable named foo, this causes you to lose the reference to the allocated object (and cause a memory leak).</p>\n\n<p>A better way to do it is to return the pointer itself, it's clearer, doesn't cause you to lose the reference, and more efficient:</p>\n\n<pre><code>OBJ *foo = Construct(10, 20);\n</code></pre>\n\n<p>Now foo is a pointer to the object, not the object itself.</p>\n\n<p>(2) derived from (1), now that we use foo as a pointer to the malloc'd object, we can use free on it.</p>\n\n<p>(3) Assigning to a parameter from the callee does not change the value in the caller site. This is known as <a href=\"http://c-faq.com/ptrs/passbyref.html\" rel=\"nofollow\">pass-by-value</a>, as only a copy of the value of the argument is passed to the callee. So let's change <code>freeup</code>:</p>\n\n<pre><code>void freeup(OBJ **x)\n{\n   printf(\"x pointer -&gt; %d \", *x);\n   free(*x);\n   *x=NULL;\n   printf(\"\\nx pointer -&gt; %d\\n\", *x);\n}\n</code></pre>\n\n<p>This way, the value of the pointer at the caller site will be changed.</p>\n\n<hr>\n\n<p>Note that I omitted NULL checks etc. to make the code clearer, but they should definitely be there.</p>\n"}], "owner": {"reputation": 23, "user_id": 5367841, "user_type": "registered", "profile_image": "https://graph.facebook.com/411619039024394/picture?type=large", "display_name": "Kyle Weddermann", "link": "https://stackoverflow.com/users/5367841/kyle-weddermann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 32741296, "answer_count": 4, "score": 2, "last_activity_date": 1443016692, "creation_date": 1443015367, "question_id": 32741154, "link": "https://stackoverflow.com/questions/32741154/freed-pointer-reallocaing-itself", "title": "Freed pointer reallocaing itself?", "body": "<p>When I dynamically allocate a structure, and then try to free it, it seems to reallocate it.</p>\n\n<pre><code>typedef struct OBJ_T\n{\n   int param1, param2;\n} OBJ;\n\nOJB* Construct(int par1, int par2)\n{\n   OBJ* x = malloc(sizeof(OBJ));\n   x-&gt;param1 = par1;\n   x-&gt;param2 = par2;\n   return x;\n}\n\nvoid freeup(OBJ *x)\n{\n   printf(\"x pointer -&gt; %d \", x);\n   free(x);\n   x=NULL;\n   printf(\"\\nx pointer -&gt; %d\\n\", x);\n}\n\nint main()\n{\n   OBJ foo = *Construct(10, 20);\n   freeup(&amp;foo);\n   freeup(&amp;foo);\n   return 0;\n}\n</code></pre>\n\n<p>The result is:</p>\n\n<pre><code>x pointer -&gt; 2752216\nx pointer -&gt; 0\nx pointer -&gt; 2752216\nx pointer -&gt; 0\n</code></pre>\n\n<p>So after freeing and nulling out the pointer, if I check it again, it goes back to what it was. Is that a problem? Or is it free and I don't have to worry about it anymore?</p>\n"}, {"tags": ["c", "x86", "clang", "freebsd", "inline-assembly"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1443015190, "post_id": 32741032, "comment_id": 53322819, "body": "Are you aware that the compiler might reorder the <code>__asm__</code> statements with respect to other statements? I&#39;m very confident this is not wanted, so use a <b>single</b> <code>__asm__</code> statement."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1443015272, "post_id": 32741032, "comment_id": 53322866, "body": "&quot;The data types uint32 is basically an unsigned long int&quot; No, it is not. It is basically an unsigned integer type guaranteed to be 32 bits wide."}, {"owner": {"reputation": 1163, "user_id": 1447013, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/28LZ2.jpg?s=128&g=1", "display_name": "Daniel Rudy", "link": "https://stackoverflow.com/users/1447013/daniel-rudy"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1443016749, "post_id": 32741032, "comment_id": 53324049, "body": "I tried to use a single <b>asm</b> statement and the compiler threw it back at me.  I&#39;ll try again."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1443017876, "post_id": 32741032, "comment_id": 53324908, "body": "Did you add newlines?"}, {"owner": {"reputation": 1163, "user_id": 1447013, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/28LZ2.jpg?s=128&g=1", "display_name": "Daniel Rudy", "link": "https://stackoverflow.com/users/1447013/daniel-rudy"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1443018427, "post_id": 32741032, "comment_id": 53325334, "body": "Yes, I did.  clang gave me all sorts of errors.  I&#39;ll update the question to reflect this."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1443019015, "post_id": 32741032, "comment_id": 53325783, "body": "Please read the documentation. I do not know clang, but for gcc, you have to specify the C arguments with additional parameters (and afaik clang is similar). Basically, the strings are passed to the assembler with some textual replacement (if you specify the C parameters) and the assembler obviously has no idea about C constructs."}, {"owner": {"reputation": 19889, "user_id": 906839, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bce6d276ec5c9b7b97804d0add55084?s=128&d=identicon&r=PG", "display_name": "Brett Hale", "link": "https://stackoverflow.com/users/906839/brett-hale"}, "edited": false, "score": 1, "creation_date": 1443029681, "post_id": 32741032, "comment_id": 53332573, "body": "<a href=\"https://gcc.gnu.org/onlinedocs/gcc-5.2.0/gcc/Using-Assembly-Language-with-C.html#Using-Assembly-Language-with-C\" rel=\"nofollow noreferrer\">gcc inline assembly</a> (also used by clang) doesn&#39;t check the assembly statement(s). There&#39;s a good tutorial <a href=\"http://locklessinc.com/articles/gcc_asm/\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1477562657, "post_id": 32741032, "comment_id": 67821800, "body": "I think nobody ever addressed the attempt at a &quot;multi-line&quot; asm statement.  A single <code>asm</code> statement still only takes one string, but the string can contain newlines.  So <code>asm(</code>  <code>&quot;foo\\n\\t&quot;</code> <code>&quot;bar\\n\\t&quot;</code> ... <code>: constraints);</code>.  What you&#39;ve done is write a comma-separated list of string-literals.  This is either a massive error itself, or the C comma operator will evaluate to only the last string.  What you want is for string literals separated only by whitespace (e.g. on separate lines) to be pasted together at compile time into one."}], "answers": [{"comments": [{"owner": {"reputation": 1163, "user_id": 1447013, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/28LZ2.jpg?s=128&g=1", "display_name": "Daniel Rudy", "link": "https://stackoverflow.com/users/1447013/daniel-rudy"}, "edited": false, "score": 0, "creation_date": 1443301774, "post_id": 32747262, "comment_id": 53441284, "body": "I have never messed with this before.  Never had the need to do so, until now.  This AT&amp;T syntax for asm is atrocious at best since all the asm work that I&#39;ve done was using things like MASM and TASM.  There are other issues besides this that need to be addressed, but that&#39;s a separate question."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 1163, "user_id": 1447013, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/28LZ2.jpg?s=128&g=1", "display_name": "Daniel Rudy", "link": "https://stackoverflow.com/users/1447013/daniel-rudy"}, "edited": false, "score": 1, "creation_date": 1443302772, "post_id": 32747262, "comment_id": 53441564, "body": "@DanielRudy: well if the other cases are like this one, just let the compiler do the right thing:  See the last paragraph of my answer.  gcc inline asm is really messy and hard to learn, with the input/output constraints, but at least it lets you write code that isn&#39;t stupid like spilling a variable to memory just so MSVC inline asm can load it with <code>mov</code>."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 1163, "user_id": 1447013, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/28LZ2.jpg?s=128&g=1", "display_name": "Daniel Rudy", "link": "https://stackoverflow.com/users/1447013/daniel-rudy"}, "edited": false, "score": 0, "creation_date": 1443303085, "post_id": 32747262, "comment_id": 53441644, "body": "@DanielRudy: In many cases, there are compiler intrinsics for bit-scan / rotate / other stuff which saves the trouble of writing them with inline asm.  The compiler already knows whether they can take memory operands, and all that stuff.  <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Other-Builtins.html#Other-Builtins\" rel=\"nofollow noreferrer\">gcc.gnu.org/onlinedocs/gcc/Other-Builtins.html#Other-Builtin&zwnj;&#8203;s</a> lists the non-vector builtins for things like popcount, which will use the <code>popcnt</code> instruction if available."}, {"owner": {"reputation": 1163, "user_id": 1447013, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/28LZ2.jpg?s=128&g=1", "display_name": "Daniel Rudy", "link": "https://stackoverflow.com/users/1447013/daniel-rudy"}, "edited": false, "score": 1, "creation_date": 1443305390, "post_id": 32747262, "comment_id": 53442237, "body": "I did not know that the compiler was smart enough to realize that using / and % in consecutive statements caused the compiler to use both results in one div operation.  That pretty much blows the need to use asm right out of the water in the first place."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 1163, "user_id": 1447013, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/28LZ2.jpg?s=128&g=1", "display_name": "Daniel Rudy", "link": "https://stackoverflow.com/users/1447013/daniel-rudy"}, "edited": false, "score": 0, "creation_date": 1443305642, "post_id": 32747262, "comment_id": 53442305, "body": "@DanielRudy: yeah, I should have emphasized that more in my first version of my answer.  I intended to say that in my first paragraph, but ended up only being obvious if you looked at the asm on godbolt, or at the last paragraph."}, {"owner": {"reputation": 63855, "user_id": 124486, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/605442f85418d858e2ce1e1aea2092bb?s=128&d=identicon&r=PG", "display_name": "Evan Carroll", "link": "https://stackoverflow.com/users/124486/evan-carroll"}, "edited": false, "score": 0, "creation_date": 1520225096, "post_id": 32747262, "comment_id": 85212331, "body": "I think GCC does generate divl. This works for me: <a href=\"https://stackoverflow.com/a/5608636/124486\">stackoverflow.com/a/5608636/124486</a>"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 63855, "user_id": 124486, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/605442f85418d858e2ce1e1aea2092bb?s=128&d=identicon&r=PG", "display_name": "Evan Carroll", "link": "https://stackoverflow.com/users/124486/evan-carroll"}, "edited": false, "score": 0, "creation_date": 1520225442, "post_id": 32747262, "comment_id": 85212442, "body": "@EvanCarroll: That&#39;s what the first section of this answer says, too, with a link to Godbolt to prove it.  Inline asm is only interesting for <code>uint64_t &#47; uint32_t</code> (or other double-width situations) when you know that the quotient won&#39;t ever overflow.  Trying to tell the compiler that the quotient won&#39;t overflow doesn&#39;t seem to get it to use a single <code>div</code> with the upper half non-zero.  (Or <code>idiv</code> with the upper half anything other than sign-extended)."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 63855, "user_id": 124486, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/605442f85418d858e2ce1e1aea2092bb?s=128&d=identicon&r=PG", "display_name": "Evan Carroll", "link": "https://stackoverflow.com/users/124486/evan-carroll"}, "edited": false, "score": 1, "creation_date": 1520225792, "post_id": 32747262, "comment_id": 85212523, "body": "@EvanCarroll: That&#39;s the second section; are you looking at an old revision of this answer or something?  The first section says &quot;<i>If you only need 32b / 32b =&gt; 32bit division, let the compiler use both outputs of div</i>&quot;"}, {"owner": {"reputation": 63855, "user_id": 124486, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/605442f85418d858e2ce1e1aea2092bb?s=128&d=identicon&r=PG", "display_name": "Evan Carroll", "link": "https://stackoverflow.com/users/124486/evan-carroll"}, "edited": false, "score": 0, "creation_date": 1520226579, "post_id": 32747262, "comment_id": 85212732, "body": "I fully see what you&#39;re talking about now, and I overlooked the gcc thing when I read it. that&#39;s a great example of when inline assembly is needed. I wonder if there is <i>any</i> way to do this without inline assembly.."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 63855, "user_id": 124486, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/605442f85418d858e2ce1e1aea2092bb?s=128&d=identicon&r=PG", "display_name": "Evan Carroll", "link": "https://stackoverflow.com/users/124486/evan-carroll"}, "edited": false, "score": 1, "creation_date": 1520227340, "post_id": 32747262, "comment_id": 85212943, "body": "@EvanCarroll: With current gcc, not that I know of.  In general, an intrinsic that exposes the possibly-faulting nature of div / idiv is one good way.  (MSVC has this.)  Another way is to teach the compiler how to optimize when it can prove that division can&#39;t overflow, e.g. <code>5 * (uint64_t)a &#47; 111</code> or something, on a 32-bit machine.  i.e. teach the compiler to look for this optimization.  (gcc on x86-64 would use a multiplicative inverse, but gcc chooses not to when it would require extended precision.)"}], "tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": true, "score": 6, "last_activity_date": 1463449279, "last_edit_date": 1495541960, "creation_date": 1443034199, "answer_id": 32747262, "question_id": 32741032, "link": "https://stackoverflow.com/questions/32741032/how-to-access-c-struct-variables-from-inline-asm/32747262#32747262", "title": "How to access C struct/variables from inline asm?", "body": "<p>If you only need 32b / 32b => 32bit division, <strong>let the compiler use both outputs of <code>div</code></strong>, which gcc, clang and icc all do just fine, as you can see on the <a href=\"https://gcc.godbolt.org/#compilers:!((compiler:g530,options:&#39;-Wall+-O3+-fno-fast-math+-march%3Dnative+-mtune%3Dnative++-fverbose-asm+-mno-avx&#39;,sourcez:PTAEEsDsBsoU1AQwM4FtQDc4CdngPaTJIBmALjqGQBYIAOArtnALQDCocAHoqndHGQAoIQGIoAY2gMAJggA8yMjKhkAdNQB8IpdgYSyoEvnygA3qAZFwAc0hwZESIeP4ARomwAaUDMRkAbQBGAAYAXQBuUABfUAAqN0ggnwTIACYIkRBQACEAQQARIQZVAGY0gH1DGXwKlQwKtgBlAFESRHBoAAoS53Kq%2BNQfKzw7BydDcB9VUAArAEpzIVAVwdAAXlBEoJZNP0DwMNAAUi303f2A2cjV29BsmnBiJXxmXzgSOH9iZpaALlA6FQtmohjc9HwqigNgmpm2F38ASOr1AyHwqDgj0gNmWoGYZCYkDOOz2iMO9zOaQRgWumWiWTAAHEAPLMoq9Mj9aq1eoVSD4FCoHplSqGOJDSzWMaOGZTCZzRZmXHZF5vMimRCgaD4CSIaBGcC4Mg%2BADu1HAEmooF1kAA5IY9eAUEhIABPLE4lYcrmgACOG2J1IC5LAiSppJpkVxd1W4oD8IjwaOpzDQdpMZWuPxhL9dIZoBZbOKIoGNTq4Aa/MFVT4GE8yGFfVFg2GUvsMucEGmnYWSxW2W1iEcJGw6NANm1HmgxFUpm1uv1FD4r084EEyrAZotVpoCAk6LonUoAGt%2BSaiTb7UhYM7EG6Pbjvc2yHx40kg4dMl6S4YX3Q0psqaJrSIgrHGAZUK%2Bpx/hkWaYjmf4UjBeZCMAcToRhmFYZhoAAJIAHIADIES0oB5E0ACy8TYTRtFYcAxZNqWPIVhUgqNpyzbivirajO28pyjMCxCEq35MYYvo%2BKgX5IGgoBdAARPU%2BrHAEYb7BU1wADqQAp0Z3ACCnrIgCnyb68w%2BEZMimV0qCLNkzDIAw0BkMQngIFAnCIFwPgOFweJwDYTwULg%2Bm3IZ1nySEFkZrc2QAF44KYflGCiDDID4/BfMgcBhXcCkmfJCaXIcMXZAVpkYnexAtHkAAaFIAEr1XltxqekGnXKACmoNgNlAZc1z2WAzBBUolAohiqCvK6Pj7nwR7YNa1AmDlxBbpaEDENNbwfCQFprs4rWgH8eXzDJ2RSHeMI1IISBbEOczuKAtDMD4d6OIOMjEANiLXF4G5ULQRLIIe0DThAv6mLuqJkIgEjHqlS31KALAACxdMcuB0PMuLcZiAbSXBBLYESvoobo%2BjVKxjnOYYFhPgMkl4lE0SZEIlMGL4NOCHTvgsQ0nNkNmpNdKoABsaMDIJziSwMwmifcwCMxJUkyUL3MNLTLkBWQMmCvJSkVip7VpJ1YQ6XpsWGcZNn4mo5mWeskVdPb2CLKsDm8y5blvJ5Xw%2BZwMj%2BaNwU4MI1vdS70U%2BLFcdxWAiWjkH/nGEt6WZQIKC5fHFVFe%2BialbH8flYVVVEKAtUNWAzV1cdKym%2Bb3XYKg/XnMBYTDQFY0haAk1wDts3Wgei22sQlqQhIOcZgC2T8t3YdLVI7jgrg72QI4JoIDUdqGMwQ7ACa2DgBQ3VTTNpn4LuS00Hefd0DgH0R6s50biLRIWMz6Bs4DNgSBIQM4BEjhseO6uo3j4BIKAOg8NjzQi8v5D6KdYR4m8kjXWhJAZmldFtSG0DYHjBhsgXgCATSICHnALARIzRAL9C6Rw6B3IBSwLgBwAB%2BYmOZ8QoVQmAAQhg/4AMQBgSEjg%2BJ9yWknZKXAKAb3geAehcwVhuBwelaEvDAGcB4FzNOqB/BA30cgBcDgWBQDkIgmQMhHJ4GxICfAchiDpVyirfm5YGjZVdBUGB2BeANhGLYfi2pbHil4gE8YQSYQyzIHLQwCtHw/joYBAuJUjihnboNKMYF0BJJJCkk4lI0yZIwaTXMQh6RAA%3D)),filterAsm:(commentOnly:!t,directives:!t,labels:!t),version:3\" rel=\"nofollow noreferrer\">Godbolt compiler explorer</a>:</p>\n\n<pre><code>uint32_t q = bn1-&gt;dat[i] / bn2-&gt;dat[j];\nuint32_t m = bn1-&gt;dat[i] % bn2-&gt;dat[j];\n</code></pre>\n\n<p>Compilers are quite good at <a href=\"https://en.wikipedia.org/wiki/Common_subexpression_elimination\" rel=\"nofollow noreferrer\">CSE</a>ing that into one <code>div</code>.  Just make sure you don't store the division result somewhere that gcc can't prove won't affect the input of the remainder.</p>\n\n<p>e.g. <code>*m = dat[i] / dat[j]</code> might overlap (alias) <code>dat[i]</code> or <code>dat[j]</code>, so gcc would have to reload the operands and redo the <code>div</code> for the <code>%</code> operation.  See the godbolt link for bad/good examples.</p>\n\n<hr>\n\n<p>Using inline asm for 32bit / 32bit = 32bit div doesn't gain you anything, and actually makes worse code with clang (see the godbolt link).</p>\n\n<p>If you need 64bit / 32bit = 32bit, you probably need asm, though, if there isn't a compiler built-in for it.  (GNU C doesn't have one, AFAICT).  The obvious way in C (casting operands to <code>uint64_t</code>) generates a call to a 64bit/64bit = 64bit libgcc function, which has branches and multiple <code>div</code> instructions.  gcc isn't good at proving the result will fit in 32bits, so a single <code>div</code> instruction don't cause a <code>#DE</code>.</p>\n\n<p>For a lot of other instructions, you can avoid writing inline asm a <em>lot</em> of the time with <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Other-Builtins.html#Other-Builtins\" rel=\"nofollow noreferrer\">builtin functions for things like popcount</a>.  With <code>-mpopcnt</code>, it compiles to the <code>popcnt</code> instruction (and accounts for the false-dependency on the output operand that Intel CPUs have.)  Without, it compiles to a libgcc function call.</p>\n\n<p><strong>Always prefer builtins, or pure C that compiles to good asm, so the compiler knows what the code does</strong>.  When inlining makes some of the arguments known at compile-time, pure C can be <a href=\"https://en.wikipedia.org/wiki/Constant_folding\" rel=\"nofollow noreferrer\">optimized away or simplified</a>, but code using inline asm will just load constants into registers and do a <code>div</code> at run-time.  Inline asm also defeats CSE between similar computations on the same data, and of course can't auto-vectorize.</p>\n\n<hr>\n\n<h3>Using GNU C syntax the right way</h3>\n\n<p><a href=\"https://gcc.gnu.org/onlinedocs/gcc/Extended-Asm.html\" rel=\"nofollow noreferrer\">https://gcc.gnu.org/onlinedocs/gcc/Extended-Asm.html</a> explains how to tell the assembler which variables you want in registers, and what the outputs are.</p>\n\n<p><a href=\"https://stackoverflow.com/a/5397771/224132\">You can use Intel/MASM-like syntax and mnemonics, and non-% register names if you like</a>, preferably by compiling with <code>-masm=intel</code>.  The AT&amp;T syntax bug (<a href=\"https://sourceware.org/binutils/docs/as/i386_002dBugs.html#i386_002dBugs\" rel=\"nofollow noreferrer\"><code>fsub</code> and <code>fsubr</code> mnemonics are reversed</a>) might still be present in intel-syntax mode; I forget.</p>\n\n<p>Most software projects that use GNU C inline asm use AT&amp;T syntax only.</p>\n\n<p>See also <a href=\"https://stackoverflow.com/questions/34520013/using-base-pointer-register-in-c-inline-asm/34522750#34522750\">the bottom of this answer</a> for more GNU C inline asm info, and the <a href=\"/questions/tagged/x86\" class=\"post-tag\" title=\"show questions tagged &#39;x86&#39;\" rel=\"tag\">x86</a> tag wiki.</p>\n\n<hr>\n\n<p>An <code>asm</code> statement takes <em>one</em> string arg, and 3 sets of constraints.  The easiest way to make it multi-line is by making each asm line a separate string ending with <code>\\n</code>, and let the compiler implicitly concatenate them.</p>\n\n<p>Also, you tell the compiler which registers you want stuff in.  Then if variables are already in registers, the compiler doesn't have to spill them and have you load and store them.  Doing that would really shoot yourself in the foot.  The <a href=\"http://locklessinc.com/articles/gcc_asm/\" rel=\"nofollow noreferrer\">tutorial</a> Brett Hale linked in comments hopefully covers all this.</p>\n\n<hr>\n\n<h3>Correct example of <code>div</code> with GNU C inline asm</h3>\n\n<p>You can see the compiler asm output for this on <a href=\"https://gcc.godbolt.org/#compilers:!((compiler:g530,options:&#39;-Wall+-O3+-fno-fast-math+-march%3Dnative+-mtune%3Dnative++-fverbose-asm+-mno-avx&#39;,sourcez:PTAEEsDsBsoU1AQwM4FtQDc4CdngPaTJIBmALjqGQBYIAOArtnALQDCocAHoqndHGQAoIQGIoAY2gMAJggA8yMjKhkAdNQB8IpdgYSyoEvnygA3qAZFwAc0hwZESIeP4ARomwAaUDMRkAbQBGAAYAXQBuUABfUAAqN0ggnwTIACYIkRBQACEAQQARIQZVAGY0gH1DGXwKlQwKtgBlAFESRHBoAAoS53Kq%2BNQfKzw7BydDcB9VUAArAEpzIVAVwdAAXlBEoJZNP0DwMNAAUi303f2A2cjV29BsmnBiJXxmXzgSOH9iZpaALlA6FQtmohjc9HwqigNgmpm2F38ASOr1AyHwqDgj0gNmWoGYZCYkDOOz2iMO9zOaQRgWumWiWTAAHEAPLMoq9Mj9aq1eoVSD4FCoHplSqGOJDSzWMaOGZTCZzRZmXHZF5vMimRCgaD4CSIaBGcC4Mg%2BADu1HAEmooF1kAA5IY9eAUEhIABPLE4lYcrmgACOG2J1IC5LAiSppJpkVxd1W4oD8IjwaOpzDQdpMZWuPxhL9dIZoBZbOKIoGNTq4Aa/MFVT4GE8yGFfVFg2GUvsMucEGmnYWSxW2W1iEcJGw6NANm1HmgxFUpm1uv1FD4r084EEyrAZotVpoCAk6LonUoAGt%2BSaiTb7UhYM7EG6Pbjvc2yHx40kg4dMl6S4YX3Q0psqaJrSIgrHGAZUK%2Bpx/hkWaYjmf4UjBeZCMAcToRhmFYZhoAAJIAHIADIES0oB5E0ACy8TYTRtFYcAxZNqWPIVhUgqNpyzbivirajO28pyjMCxCEq35MYYvo%2BKgX5IGgoBdAARPU%2BrHAEYb7BU1wADqQAp0Z3ACCnrIgCnyb68w%2BEZMimV0qCLNkzDIAw0BkMQngIFAnCIFwPgOFweJwDYTwULg%2Bm3IZ1nySEFkZrc2QAF44KYflGCiDDID4/BfMgcBhXcCkmfJCaXIcMXZAVpkYnexAtHkAAaFIAEr1XltxqekGnXKACmoNgNlAZc1z2WAzBBUolAohiqCvK6Pj7nwR7YNa1AmDlxBbpaEDENNbwfCQFprs4rWgH8eXzDJ2RSHeMI1IISBbEOczuKAtDMD4d6OIOMjEANiLXF4G5ULQRLIIe0DThAv6mLuqJkIgEjHqlS31KALAACxdMcuB0PMuLcZiAbSXBBLYESvoobo%2BjVKxjnOYYFhPgMkl4lE0SZEIlMGL4NOCHTvgsQ0nNkNmpNdKoABsaMDIJziSwMwmifcwCMxJUkyUL3MNLTLkBWQMmCvJSkVip7VpJ1YQ6XpsWGcZNn4mo5mWeskVdPb2CLKsDm8y5blvJ5Xw%2BZwMj%2BaNwU4MI1vdS70U%2BLFcdxWAiWjkH/nGEt6WZQIKC5fHFVFe%2BialbH8flYVVVEKAtUNWAzV1cdKym%2Bb3XYKg/XnMBYTDQFY0haAk1wDts3Wgei22sQlqQhIOcZgC2T8t3YdLVI7jgrg72QI4JoIDUdqGMwQ7ACa2DgBQ3VTTNpn4LuS00Hefd0DgH0R6s50biLRIWMz6Bs4DNgSBIQM4BEjhseO6uo3j4BIKAOg8NjzQi8v5D6KdYR4m8kjXWhJAZmldFtSG0DYHjBhsgXgCATSICHnALARIzRAL9C6Rw6B3IBSwLgBwAB%2BYmOZ8QoVQmAAQhg/4AMQBgSEjg%2BJ9yWknZKXAKAb3geAehcwVhuBwelaEvDAGcB4FzNOqB/BA30cgBcDgWBQDkIgmQMhHJ4GxICfAchiDpVyirfm5YGjZVdBUGB2BeANhGLYfi2pbHil4gE8YQSYQyzIHLQwCtHw/joYBAuJUjihnboNKMYF0BJJJCkk4lI0yZIwaTXMQh6RAA%3D)),filterAsm:(commentOnly:!t,directives:!t,labels:!t),version:3\" rel=\"nofollow noreferrer\">godbolt</a>.</p>\n\n<pre><code>uint32_t q, m;  // this is unsigned int on every compiler that supports x86 inline asm with this syntax, but not when writing portable code.\n\nasm (\"divl %[bn2dat_j]\\n\"\n      : \"=a\" (q), \"=d\" (m) // results are in eax, edx registers\n      : \"d\" (0),           // zero edx for us, please\n        \"a\" (bn1-&gt;dat[i]), // \"a\" means EAX / RAX\n        [bn2dat_j] \"mr\" (bn2-&gt;dat[j]) // register or memory, compiler chooses which is more efficient\n      : // no register clobbers, and we don't read/write \"memory\" other than operands\n    );\n</code></pre>\n\n<p><code>\"divl %4\"</code> would have worked too, but named inputs/outputs don't change name when you add more input/output constraints.</p>\n"}], "owner": {"reputation": 1163, "user_id": 1447013, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/28LZ2.jpg?s=128&g=1", "display_name": "Daniel Rudy", "link": "https://stackoverflow.com/users/1447013/daniel-rudy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3075, "favorite_count": 0, "accepted_answer_id": 32747262, "answer_count": 1, "score": 2, "last_activity_date": 1463449279, "creation_date": 1443015086, "last_edit_date": 1443018974, "question_id": 32741032, "link": "https://stackoverflow.com/questions/32741032/how-to-access-c-struct-variables-from-inline-asm", "title": "How to access C struct/variables from inline asm?", "body": "<p>Consider the following code:</p>\n\n<pre><code>    int bn_div(bn_t *bn1, bn_t *bn2, bn_t *bnr)\n  {\n    uint32 q, m;        /* Division Result */\n    uint32 i;           /* Loop Counter */\n    uint32 j;           /* Loop Counter */\n\n    /* Check Input */\n    if (bn1 == NULL) return(EFAULT);\n    if (bn1-&gt;dat == NULL) return(EFAULT);\n    if (bn2 == NULL) return(EFAULT);\n    if (bn2-&gt;dat == NULL) return(EFAULT);\n    if (bnr == NULL) return(EFAULT);\n    if (bnr-&gt;dat == NULL) return(EFAULT);\n\n\n    #if defined(__i386__) || defined(__amd64__)\n    __asm__ (\".intel_syntax noprefix\");\n    __asm__ (\"pushl %eax\");\n    __asm__ (\"pushl %edx\");\n    __asm__ (\"pushf\");\n    __asm__ (\"movl %eax, (bn1-&gt;dat[i])\");\n    __asm__ (\"xorl %edx, %edx\");\n    __asm__ (\"divl (bn2-&gt;dat[j])\");\n    __asm__ (\"movl (q), %eax\");\n    __asm__ (\"movl (m), %edx\");\n    __asm__ (\"popf\");\n    __asm__ (\"popl %edx\");\n    __asm__ (\"popl %eax\");\n    #else\n    q = bn-&gt;dat[i] / bn-&gt;dat[j];\n    m = bn-&gt;dat[i] % bn-&gt;dat[j];\n    #endif\n    /* Return */\n    return(0);\n  }\n</code></pre>\n\n<p>The data types uint32 is basically an unsigned long int or a uint32_t unsigned 32-bit integer.  The type bnint is either a unsigned short int (uint16_t) or a uint32_t depending on if 64-bit data types are available or not.  If 64-bit is available, then bnint is a uint32, otherwise it's a uint16.  This was done in order to capture carry/overflow in other parts of the code.  The structure bn_t is defined as follows:</p>\n\n<pre><code>typedef struct bn_data_t bn_t;\nstruct bn_data_t\n  {\n    uint32 sz1;         /* Bit Size */\n    uint32 sz8;         /* Byte Size */\n    uint32 szw;         /* Word Count */\n    bnint *dat;         /* Data Array */\n    uint32 flags;       /* Operational Flags */\n  };\n</code></pre>\n\n<p>The function starts on line 300 in my source code.  So when I try to compile/make it, I get the following errors:</p>\n\n<pre><code>system:/home/user/c/m3/bn 1036 $$$ -&gt;make\nclang -I. -I/home/user/c/m3/bn/.. -I/home/user/c/m3/bn/../include  -std=c99 -pedantic -Wall -Wextra -Wshadow -Wpointer-arith -Wcast-align -Wstrict-prototypes  -Wmissing-prototypes -Wnested-externs -Wwrite-strings -Wfloat-equal  -Winline -Wunknown-pragmas -Wundef -Wendif-labels  -c /home/user/c/m3/bn/bn.c\n/home/user/c/m3/bn/bn.c:302:12: warning: unused variable 'q' [-Wunused-variable]\n    uint32 q, m;        /* Division Result */\n           ^\n/home/user/c/m3/bn/bn.c:302:15: warning: unused variable 'm' [-Wunused-variable]\n    uint32 q, m;        /* Division Result */\n              ^\n/home/user/c/m3/bn/bn.c:303:12: warning: unused variable 'i' [-Wunused-variable]\n    uint32 i;           /* Loop Counter */\n           ^\n/home/user/c/m3/bn/bn.c:304:12: warning: unused variable 'j' [-Wunused-variable]\n    uint32 j;           /* Loop Counter */\n           ^\n/home/user/c/m3/bn/bn.c:320:14: error: unknown token in expression\n    __asm__ (\"movl %eax, (bn1-&gt;dat[i])\");\n             ^\n&lt;inline asm&gt;:1:18: note: instantiated into assembly here\n        movl %eax, (bn1-&gt;dat[i])\n                        ^\n/home/user/c/m3/bn/bn.c:322:14: error: unknown token in expression\n    __asm__ (\"divl (bn2-&gt;dat[j])\");\n             ^\n&lt;inline asm&gt;:1:12: note: instantiated into assembly here\n        divl (bn2-&gt;dat[j])\n                  ^\n4 warnings and 2 errors generated.\n*** [bn.o] Error code 1\n\nStop in /home/user/c/m3/bn.\nsystem:/home/user/c/m3/bn 1037 $$$ -&gt;\n</code></pre>\n\n<p><strong>What I know:</strong></p>\n\n<p>I consider myself to be fairly well versed in x86 assembler (as evidenced from the code that I wrote above).  However, the last time that I mixed a high level language and assembler was using Borland Pascal about 15-20 years ago when writing graphics drivers for games (pre-Windows 95 era).  My familiarity is with Intel syntax.</p>\n\n<p><strong>What I don't know:</strong></p>\n\n<p>How do I access members of bn_t (especially *dat) from asm?  Since *dat is a pointer to uint32, I am accessing the elements as an array (eg. bn1->dat[i]).</p>\n\n<p>How do I access local variables that are declared on the stack?</p>\n\n<p>I am using push/pop to restore clobbered registers to their previous values so as to not upset the compiler.  However, do I also need to include the volatile keyword on the local variables as well?</p>\n\n<p>Or, is there a better way that I am not aware of?  I don't want to put this in a separate function call because of the calling overhead as this function is performance critical.</p>\n\n<p><strong>Additional:</strong></p>\n\n<p>Right now, I'm just starting to write this function so it is no where complete.  There are missing loops and other such support/glue code.  But, the main gist is accessing local variables/structure elements.</p>\n\n<p>EDIT 1:</p>\n\n<p>The syntax that I am using seems to be the only one that clang supports.  I tried the following code and clang gave me all sorts of errors:</p>\n\n<pre><code>__asm__ (\"pushl %%eax\",\n    \"pushl %%edx\",\n    \"pushf\",\n    \"movl (bn1-&gt;dat[i]), %%eax\",\n    \"xorl %%edx, %%edx\",\n    \"divl ($0x0c + bn2 + j)\",\n    \"movl %%eax, (q)\",\n    \"movl %%edx, (m)\",\n    \"popf\",\n    \"popl %%edx\",\n    \"popl %%eax\"\n    );\n</code></pre>\n\n<p>It wants me to put a closing parenthesis on the first line, replacing the comma.  I switched to using %% instead of % because I read somewhere that inline assembly requires %% to denote CPU registers, and clang was telling me that I was using an invalid escape sequence.</p>\n"}, {"tags": ["c", "arrays", "multithreading", "loops", "openmp"], "comments": [{"owner": {"reputation": 4125, "user_id": 3426025, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yxLev.png?s=128&g=1", "display_name": "BeyelerStudios", "link": "https://stackoverflow.com/users/3426025/beyelerstudios"}, "edited": false, "score": 3, "creation_date": 1443015313, "post_id": 32741015, "comment_id": 53322898, "body": "the computation <code>i</code> inside the loop body depends on the previous result <code>i-1</code> - this cannot be parallelised"}, {"owner": {"reputation": 21, "user_id": 5367823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/042f9d2d0439468199c7c653af8ebd73?s=128&d=identicon&r=PG&f=1", "display_name": "Tahmerjay", "link": "https://stackoverflow.com/users/5367823/tahmerjay"}, "edited": false, "score": 0, "creation_date": 1443015432, "post_id": 32741015, "comment_id": 53322998, "body": "by does not work i mean that the arrays adiag and arite are incorrectly filled in after the loop completed"}, {"owner": {"reputation": 21, "user_id": 5367823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/042f9d2d0439468199c7c653af8ebd73?s=128&d=identicon&r=PG&f=1", "display_name": "Tahmerjay", "link": "https://stackoverflow.com/users/5367823/tahmerjay"}, "edited": false, "score": 0, "creation_date": 1443015594, "post_id": 32741015, "comment_id": 53323132, "body": "Ok yep I can see how i-1 is a problem. by this cannot be parallelised do you mean completely? or is their a way to rewrite it?"}, {"owner": {"reputation": 73919, "user_id": 44309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iL4TW.png?s=128&g=1", "display_name": "High Performance Mark", "link": "https://stackoverflow.com/users/44309/high-performance-mark"}, "edited": false, "score": 1, "creation_date": 1443017343, "post_id": 32741015, "comment_id": 53324505, "body": "Trade space for time -- make a copy of <code>arite</code> before entering the loop, read from <code>arite_old</code>, write to <code>arite_new</code>."}, {"owner": {"reputation": 73919, "user_id": 44309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iL4TW.png?s=128&g=1", "display_name": "High Performance Mark", "link": "https://stackoverflow.com/users/44309/high-performance-mark"}, "edited": false, "score": 1, "creation_date": 1443018600, "post_id": 32741015, "comment_id": 53325472, "body": "Why have you made your computation <code>ordered</code> ?"}, {"owner": {"reputation": 21, "user_id": 5367823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/042f9d2d0439468199c7c653af8ebd73?s=128&d=identicon&r=PG&f=1", "display_name": "Tahmerjay", "link": "https://stackoverflow.com/users/5367823/tahmerjay"}, "edited": false, "score": 0, "creation_date": 1443019012, "post_id": 32741015, "comment_id": 53325782, "body": "im not sure what you mean by read from arite_old and write to arite_new either as isn&#39;t the whole problem that i need to read a new state of arite potentially before its been updated. eg: say it loops 100 times, thread 2 will start with i = 25 but it will need i = 24 to have been completed first so that arite[i-1] or arite[24] is the correct updated figure.. sorta explains my thinking behind using ordered."}, {"owner": {"reputation": 4037, "user_id": 4056099, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xF37X.jpg?s=128&g=1", "display_name": "NoseKnowsAll", "link": "https://stackoverflow.com/users/4056099/noseknowsall"}, "reply_to_user": {"reputation": 4125, "user_id": 3426025, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yxLev.png?s=128&g=1", "display_name": "BeyelerStudios", "link": "https://stackoverflow.com/users/3426025/beyelerstudios"}, "edited": false, "score": 0, "creation_date": 1443020845, "post_id": 32741015, "comment_id": 53327188, "body": "As @BeyelerStudios has briefly said: there are some algorithms that cannot be parallelized. Any algorithm where each iteration depends on the previous iteration is an inherently serial algorithm. You must either stick with a serial algorithm or rewrite the algorithm in a way such that there is no inter-iteration dependence. Yes, ordered will work, but also yes as you&#39;ve mentioned it defeats the purpose of parallelizing."}, {"owner": {"reputation": 21, "user_id": 5367823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/042f9d2d0439468199c7c653af8ebd73?s=128&d=identicon&r=PG&f=1", "display_name": "Tahmerjay", "link": "https://stackoverflow.com/users/5367823/tahmerjay"}, "edited": false, "score": 0, "creation_date": 1443022484, "post_id": 32741015, "comment_id": 53328359, "body": "Ok ill leave that bit alone until i understand the code enough to possibly re-write it without the inter-iteration dependence. thanks for all your help"}, {"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "reply_to_user": {"reputation": 4037, "user_id": 4056099, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xF37X.jpg?s=128&g=1", "display_name": "NoseKnowsAll", "link": "https://stackoverflow.com/users/4056099/noseknowsall"}, "edited": false, "score": 0, "creation_date": 1443172181, "post_id": 32741015, "comment_id": 53395749, "body": "@NoseKnowsAll, the prefix sum/cumulative sum depends on the previous element but it can be parallelized in two passes."}], "answers": [{"tags": [], "owner": {"reputation": 185, "user_id": 3784688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120785cdb10fe6639b0e149d93f4ca01?s=128&d=identicon&r=PG", "display_name": "MtCS", "link": "https://stackoverflow.com/users/3784688/mtcs"}, "is_accepted": false, "score": 1, "last_activity_date": 1443043889, "creation_date": 1443043889, "answer_id": 32749858, "question_id": 32741015, "link": "https://stackoverflow.com/questions/32741015/openmp-re-writing-a-for-loop-so-it-can-be-parallelised/32749858#32749858", "title": "OpenMP: re-writing a for loop so it can be parallelised?", "body": "<p>I Don't think you can convert this loop. You have a cyclical data dependency. Usually when you have a loop that can be converted, you swap the commands order and you solve your loop problem like so:</p>\n\n<pre><code>for ( i = 1; i &lt; nu - 1; i++ )\n{\n   arite[i-1] = arite[i-1] / adiag[i-1];\n   adiag[i] = adiag[i] - aleft[i] * arite[i-1];\n}\n</code></pre>\n\n<p>Although, when you do that, you steel need to use a value computed by another thread. I could be wrong though...</p>\n"}], "owner": {"reputation": 21, "user_id": 5367823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/042f9d2d0439468199c7c653af8ebd73?s=128&d=identicon&r=PG&f=1", "display_name": "Tahmerjay", "link": "https://stackoverflow.com/users/5367823/tahmerjay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1443043889, "creation_date": 1443015049, "last_edit_date": 1443019148, "question_id": 32741015, "link": "https://stackoverflow.com/questions/32741015/openmp-re-writing-a-for-loop-so-it-can-be-parallelised", "title": "OpenMP: re-writing a for loop so it can be parallelised?", "body": "<p>I'm trying to parallelise the FEM1D code that can be found <a href=\"https://people.sc.fsu.edu/~jburkardt/c_src/fem1d/fem1d.c\" rel=\"nofollow\">here</a>. The part that's relevant is:</p>\n\n<pre><code>for ( i = 1; i &lt; nu - 1; i++ )\n{\n adiag[i] = adiag[i] - aleft[i] * arite[i-1];\n arite[i] = arite[i] / adiag[i];\n}\n</code></pre>\n\n<p>simply adding </p>\n\n<pre><code> #pragma omp parallel for\n</code></pre>\n\n<p>before the loop does not work and im not sure why. I assume that its because the other threads need to update the arrays but since i is private the threads shouldn't need to update anything required by another thread?. </p>\n\n<p>i've tried making new variables making them private but im pretty sure its to do with updating the adiag and arite arrays so i tried the flush directive which specifies that all threads have the same view of memory for all shared objects, but again no dice.</p>\n\n<pre><code>#pragma omp parallel for private(i,ad,al,ar)\n for ( i = 1; i &lt; nu - 1; i++ )\n {\n  #pragma omp flush(adiag, arite, aleft)\n  ad = adiag[i];\n  al = aleft[i];\n  ar = arite[i-1];\n  adiag[i] = ad - al * ar;\n  ar = arite[i];\n  ad = adiag[i];\n  arite[i] = ar / ad;\n}\n</code></pre>\n\n<p>so im pretty stuck here, any advice to help me along would be much appreciated.</p>\n\n<p>EDIT: by does not work i mean that the arrays adiag and arite are incorrectly filled in after the loop completed </p>\n\n<p>EDIT2: ive gotten the loop to work with</p>\n\n<pre><code>#pragma omp parallel for ordered\nfor ( i = 1; i &lt; nu - 1; i++ )\n{\n#pragma omp ordered\n adiag[i] = adiag[i] - aleft[i] * arite[i-1];\n arite[i] = arite[i] / adiag[i];\n}\n</code></pre>\n\n<p>but I believe it kinda defeats the purpose of parallelising the loop in the first place</p>\n"}, {"tags": ["c", "thrift", "glib"], "answers": [{"comments": [{"owner": {"reputation": 2387, "user_id": 2527207, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/G2peN.jpg?s=128&g=1", "display_name": "AkhlD", "link": "https://stackoverflow.com/users/2527207/akhld"}, "edited": false, "score": 0, "creation_date": 1443511533, "post_id": 32782165, "comment_id": 53511106, "body": "Thanks for the response Simon, Please see the inline questions::"}, {"owner": {"reputation": 2387, "user_id": 2527207, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/G2peN.jpg?s=128&g=1", "display_name": "AkhlD", "link": "https://stackoverflow.com/users/2527207/akhld"}, "edited": false, "score": 0, "creation_date": 1443512031, "post_id": 32782165, "comment_id": 53511387, "body": "If i simply printf(&quot;%u\\n&quot;, <i>_return); it prints out 0, which means i guess the function did not pre-allocated any structure for it.  Now, if i allocate a GByteArray myself (</i>_return = g_byte_array_new ();) for the return then it seems to be working (at least nothing crashes).  The only problem I&#39;m having now is the client isnt receiving proper data. You can find the modified version over here <a href=\"http://pastebin.com/HCwehPvR\" rel=\"nofollow noreferrer\">pastebin.com/HCwehPvR</a>  Also, thrift repository doesn&#39;t contain a test case or example for binary data. I think i can add it to the repo once i get it working."}, {"owner": {"user_type": "does_not_exist", "display_name": "user473305"}, "reply_to_user": {"reputation": 2387, "user_id": 2527207, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/G2peN.jpg?s=128&g=1", "display_name": "AkhlD", "link": "https://stackoverflow.com/users/2527207/akhld"}, "edited": false, "score": 0, "creation_date": 1443522818, "post_id": 32782165, "comment_id": 53517771, "body": "Good! You&#39;re right; <code>binary</code> is a base type, not a complex one (i.e. not a collection) so what I wrote above is incorrect."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user473305"}, "is_accepted": false, "score": 0, "last_activity_date": 1443183862, "creation_date": 1443183862, "answer_id": 32782165, "question_id": 32740773, "link": "https://stackoverflow.com/questions/32740773/why-does-my-thrift-c-glib-client-fail-with-an-invalid-pointer-error/32782165#32782165", "title": "Why does my Thrift (c_glib) client fail with an &quot;invalid pointer&quot; error?", "body": "<p>I see three issues with what you're doing here:</p>\n\n<ul>\n<li><p>If a service method returns a complex type, the <code>_return</code> parameter passed to its handler function will point to a <em>pre-allocated</em> structure that should not be destroyed or re-created. Your code should be appending values to the <code>GByteArray</code> to which <code>_return</code> already points, not creating a <code>GByteArray</code> of its own.</p></li>\n<li><p>Although you shouldn't be trying to modify the value of <code>_return</code> anyway, the way your code does this is incorrect and ends up clobbering the data structure to which <code>_return</code> points. This most likely explains the error message you're seeing.</p></li>\n<li><p>Your code declares <code>i</code> a thirty-two bit integer but appends to the byte array only <code>i</code>'s first byte. This will not have the effect you intend on every machine architecture.</p></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 2387, "user_id": 2527207, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/G2peN.jpg?s=128&g=1", "display_name": "AkhlD", "link": "https://stackoverflow.com/users/2527207/akhld"}, "is_accepted": true, "score": 0, "last_activity_date": 1443520660, "creation_date": 1443520660, "answer_id": 32841054, "question_id": 32740773, "link": "https://stackoverflow.com/questions/32740773/why-does-my-thrift-c-glib-client-fail-with-an-invalid-pointer-error/32841054#32841054", "title": "Why does my Thrift (c_glib) client fail with an &quot;invalid pointer&quot; error?", "body": "<p>I figured it out after spending some time on it, here's the working handler and the client side implementation code:</p>\n\n<pre><code>gboolean \ntutorial_calculator_handler_getdata (CalculatorIf *iface,\n                                 GByteArray ** _return,                                 \n                                 GError **error)\n{\n  THRIFT_UNUSED_VAR (iface);\n  THRIFT_UNUSED_VAR (error);\n\n  GByteArray *thing = g_byte_array_new();\n  *_return = g_byte_array_new();\n  guint8 i;\n  for (i = 0; i &lt; 10; i++){    \n    g_byte_array_append (thing, (guint8*) &amp;i, sizeof(guint8));\n  }\n\n  g_byte_array_append(*_return, (guint8*) thing-&gt;data, thing-&gt;len);\n\n\n  return TRUE;\n}\n</code></pre>\n\n<p>And the client side:</p>\n\n<pre><code>GByteArray *data = g_byte_array_new();\nif (!error &amp;&amp; calculator_if_getdata (client, &amp;data, &amp;error)) {\n    puts (\"getdata()\");\n    printf (\"Data : %d\\n\", data);\n    guint8 i;\n    guint8 size = sizeof(guint8);\n    for(i=0;i&lt;10;i++)\n      printf (\"Data : %d\\n\", data-&gt;data[size*i]);\n\n  }\n</code></pre>\n"}], "owner": {"reputation": 2387, "user_id": 2527207, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/G2peN.jpg?s=128&g=1", "display_name": "AkhlD", "link": "https://stackoverflow.com/users/2527207/akhld"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "accepted_answer_id": 32841054, "answer_count": 2, "score": 0, "last_activity_date": 1443520660, "creation_date": 1443014507, "last_edit_date": 1443187455, "question_id": 32740773, "link": "https://stackoverflow.com/questions/32740773/why-does-my-thrift-c-glib-client-fail-with-an-invalid-pointer-error", "title": "Why does my Thrift (c_glib) client fail with an &quot;invalid pointer&quot; error?", "body": "<p>I'm creating a simple thrift server/client program in C (g_lib).\nThis is how my thrift IDL file looks like:</p>\n\n<pre><code>namespace cpp tutorial\n\nservice Calculator {\n    void ping(),\n    binary getdata()    \n}\n</code></pre>\n\n<p>And the implementation for getdata on the thrift server looks like this:</p>\n\n<pre><code>    static gboolean\n    tutorial_calculator_handler_getdata (CalculatorIf  *iface,\n                                      GByteArray        *_return,\n                                      GError       **error)\n    {\n      THRIFT_UNUSED_VAR (iface);\n      THRIFT_UNUSED_VAR (error);\n\n      puts (\"getdata()\");\n\n      GByteArray *gbarray;\n      gint i;\n\n      gbarray = g_byte_array_new ();\n      for (i = 0; i &lt; 100; i++)\n          g_byte_array_append (gbarray, (guint8*) &amp;i, 1);\n\n      *_return = *gbarray;\n\n      return TRUE;\n    }\n</code></pre>\n\n<p>Now, on the client side, I'm calling the getdata as follows:</p>\n\n<pre><code>....\n....\nGByteArray *data;\n....\n....\n\nif (!error &amp;&amp; calculator_if_getdata (client, &amp;data, &amp;error)) {\n  puts (\"getdata()\");      \n\n}\n</code></pre>\n\n<p>Unfortunately, the client crashes with the following message in the calculator_if_getdata call:</p>\n\n<pre><code>*** Error in `./client': munmap_chunk(): invalid pointer: 0xb741742d ***\nAborted (core dumped)\n</code></pre>\n\n<p>Is this the correct way to send an array of integers from the server to client in thrift? What am i doing wrong here?</p>\n"}, {"tags": ["c", "binary", "comments"], "answers": [{"comments": [{"owner": {"reputation": 171, "user_id": 1658811, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/509ee683eb06b70f6629f8e99e69e737?s=128&d=identicon&r=PG", "display_name": "Westrock", "link": "https://stackoverflow.com/users/1658811/westrock"}, "edited": false, "score": 0, "creation_date": 1443018638, "post_id": 32740765, "comment_id": 53325500, "body": "Thank you this was a good idea. However the placement appears sketchy. I can place it in different areas of the source code, but it ends up in a seemingly unrelated area of the binary."}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "reply_to_user": {"reputation": 171, "user_id": 1658811, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/509ee683eb06b70f6629f8e99e69e737?s=128&d=identicon&r=PG", "display_name": "Westrock", "link": "https://stackoverflow.com/users/1658811/westrock"}, "edited": false, "score": 1, "creation_date": 1443023616, "post_id": 32740765, "comment_id": 53329098, "body": "@Westrock: string constants will be stored in the <code>.rodata</code> section of the binary, regardless of where they appear in the source code (at least for ELF)."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 4, "last_activity_date": 1443014494, "creation_date": 1443014494, "answer_id": 32740765, "question_id": 32740668, "link": "https://stackoverflow.com/questions/32740668/add-ascii-comments-to-a-c-binary/32740765#32740765", "title": "Add ASCII comments to a C binary?", "body": "<p>Comments are only present in the source code and will not be present in the binary. In case you find any readable text in the binary, it is because you came across string literals used by the program.</p>\n\n<p>Binaries should only be read by computers and not humans, so it doesn't make any sense to include comments in them anyhow. </p>\n\n<p>If you would for reasons unknown need something like a binary with comments, then generate a <em>disassembly</em> from the C source. It will contain the machine code together with the C code and C code comments.</p>\n\n<p>That being said, you <em>could</em> force the program to link a string to the binary even if that string isn't used by the program, by adding something like:</p>\n\n<pre><code>volatile const char foo [] = \"STOP LOOKING AT MY BINARY!\";\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "is_accepted": false, "score": 0, "last_activity_date": 1443014801, "creation_date": 1443014801, "answer_id": 32740894, "question_id": 32740668, "link": "https://stackoverflow.com/questions/32740668/add-ascii-comments-to-a-c-binary/32740894#32740894", "title": "Add ASCII comments to a C binary?", "body": "<p>In some formats, you can add text strings to an object file (program files are also object files, the term \"binary\" is missleading as this includes all non-text files) in a special <em>section</em>. However, this requires a deeper knowledege about C and the format of object files and is implementation/OS specific.</p>\n\n<p>You can - OTOH - print some explanatory text from your program. Just try <code>less -h</code> for an example.</p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 0, "last_activity_date": 1443023460, "last_edit_date": 1443023460, "creation_date": 1443017721, "answer_id": 32742033, "question_id": 32740668, "link": "https://stackoverflow.com/questions/32740668/add-ascii-comments-to-a-c-binary/32742033#32742033", "title": "Add ASCII comments to a C binary?", "body": "<p>Binaries should not be streamed with the <code>less</code> utility, and in less enlightened days you could seriously jack up your terminal settings by doing so.  It's safer to use the <code>strings</code> or <code>objdump</code> utilities to search for strings in binaries.  </p>\n\n<p>There's no <em>good</em> way to add comments to a binary file as such; binary formats are not meant to be human-readable, and don't generally allow free-form text.  As Lundin suggests, you can add some string objects to your source code that can be extracted from the compiled binary. Here's an example using the <code>objdump</code> facility:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main( void )\n{\n  const char *str = \"This is a test of the Emergency Broadcast System.\";\n  puts( str );\n  return 0;\n}\n</code></pre>\n\n<p>After compiling, we can extract the constant string data as follows:</p>\n\n<pre><code>[fbgo448@n9dvap997]~/prototypes/words: objdump -d -j.rodata -C foo\n\nfoo:     file format elf64-x86-64\n\nDisassembly of section .rodata:\n\n0000000000400610 &lt;_IO_stdin_used&gt;:\n  400610:       01 00 02 00 00 00 00 00 54 68 69 73 20 69 73 20     ........This is\n  400620:       61 20 74 65 73 74 20 6f 66 20 74 68 65 20 45 6d     a test of the Em\n  400630:       65 72 67 65 6e 63 79 20 42 72 6f 61 64 63 61 73     ergency Broadcas\n  400640:       74 20 53 79 73 74 65 6d 2e 00                       t System..\n</code></pre>\n\n<p>In the ELF format, string constants are stored in the <code>.rodata</code> section of the binary file.  </p>\n\n<p>This is about as pretty as it gets, though.  </p>\n"}], "owner": {"reputation": 171, "user_id": 1658811, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/509ee683eb06b70f6629f8e99e69e737?s=128&d=identicon&r=PG", "display_name": "Westrock", "link": "https://stackoverflow.com/users/1658811/westrock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 624, "favorite_count": 0, "protected_date": 1586304031, "accepted_answer_id": 32740765, "answer_count": 3, "score": 2, "last_activity_date": 1586302850, "creation_date": 1443014232, "last_edit_date": 1443014580, "question_id": 32740668, "link": "https://stackoverflow.com/questions/32740668/add-ascii-comments-to-a-c-binary", "title": "Add ASCII comments to a C binary?", "body": "<p>I have extrememly small amount of experience with C programming. </p>\n\n<p>The operating system is Linux. When you do <code>less</code> on a program file it shows a bunch of random characters, but it also shows some of the readable ASCII characters in the original C source code.</p>\n\n<p>Is there a way to force comments to show up in the binary, preferably near the beginning of the program file so that someone could get an idea of what this is used for? The formatting of the comments does not have to be pretty, a continuous line of text is fine.</p>\n"}, {"tags": ["c", "performance", "motorola", "68000"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1443014694, "post_id": 32740626, "comment_id": 53322407, "body": "The code obviously switches to a different addressing mode. (from SP-relative to absolute)"}, {"owner": {"reputation": 448, "user_id": 2700583, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/9c0c2c03a9e11ca4448b002a806102f2?s=128&d=identicon&r=PG", "display_name": "3D Coder", "link": "https://stackoverflow.com/users/2700583/3d-coder"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1443014947, "post_id": 32740626, "comment_id": 53322607, "body": "Yes, but the stack (on the platform) is put at the end of RAM, meaning every single access to the stack variables results in those expensive RAS cycles (unless your code happens to result at that last RAM page - which it doesn&#39;t, as it resides at the start of RAM). While I&#39;m not sure what is the difference in cycles between those 2 addressing modes, (I can look it up), I doubt it can amount for that kind of a performance drop."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1443015197, "post_id": 32740626, "comment_id": 53322824, "body": "[I don&#39;t know 68K instruction timing / addressing modes] at least the instruction sequence (+decoding) can be shorter for SP-relative addressing."}, {"owner": {"reputation": 448, "user_id": 2700583, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/9c0c2c03a9e11ca4448b002a806102f2?s=128&d=identicon&r=PG", "display_name": "3D Coder", "link": "https://stackoverflow.com/users/2700583/3d-coder"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1443015667, "post_id": 32740626, "comment_id": 53323189, "body": "I just looked it up at the cycle table, and move.w takes between 16(best)-24 (worst) cycles. Since that method is executed only 320*3 = 960 times, the difference should be, at worst, 960*(24-16) = 7,680 cycles. But it&#39;s ~3-4 orders of magnitude more than that !"}, {"owner": {"reputation": 448, "user_id": 2700583, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/9c0c2c03a9e11ca4448b002a806102f2?s=128&d=identicon&r=PG", "display_name": "3D Coder", "link": "https://stackoverflow.com/users/2700583/3d-coder"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1443016565, "post_id": 32740626, "comment_id": 53323913, "body": "This can&#39;t be explained by the RAS precharge cycles either. The compiler must be doing something brutal. I&#39;m pretty sure sure if I saw the resulting ASM code, it would be a monster-WTF moment. I&#39;m going to retry those compiler switches again, maybe try few different optimization options in the compiler."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1443016689, "post_id": 32740626, "comment_id": 53324001, "body": "BTW: the indexing could be different too for different addressing modes."}, {"owner": {"reputation": 448, "user_id": 2700583, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/9c0c2c03a9e11ca4448b002a806102f2?s=128&d=identicon&r=PG", "display_name": "3D Coder", "link": "https://stackoverflow.com/users/2700583/3d-coder"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1443016998, "post_id": 32740626, "comment_id": 53324241, "body": "true, but from cycles perspective, as I computed above, we&#39;re talking max. 8,000 cycles of a difference. And even if previously the arrays would be just stored in registers (e.g. compiler noticed they weren&#39;t touched by the code below, so it never bothered to write the result to the actual memory address - which is a huge if), that would just double the cycle count difference to 16-20,000 (as move.w with registers still takes at least 12 cycles)."}], "answers": [{"tags": [], "owner": {"reputation": 448, "user_id": 2700583, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/9c0c2c03a9e11ca4448b002a806102f2?s=128&d=identicon&r=PG", "display_name": "3D Coder", "link": "https://stackoverflow.com/users/2700583/3d-coder"}, "is_accepted": true, "score": 0, "last_activity_date": 1443089053, "last_edit_date": 1443089053, "creation_date": 1443023411, "answer_id": 32744104, "question_id": 32740626, "link": "https://stackoverflow.com/questions/32740626/how-can-globalizing-2-small-arrays-result-in-significant-performance-drop/32744104#32744104", "title": "How can globalizing 2 small arrays result in significant performance drop?", "body": "<p>As I suspected, there is a monster-WTF compiler-related moment. The reason, why there were just 6 lines of code in case of local variables, is that the compiler was able to figure out, that those 120 lines of C code are not really doing anything on a global level, so it completely ignored the code altogether ! Meaning the ASM code for the method was just those 6 lines (with rts). That however does not make much sense with the benchmark results I got (but that will be a different story)</p>\n\n<p>Moral of the story : By Making the variable global, the compiler actually bothered to create the code for the function (and not just empty 6-op stub). And since I inlined everything inside that function, there were no nested function calls.\nNow, this obviously sounds ridiculous, given I had about 25 debugging sessions with the variables and output on a target device. But the moment, I removed those external print/debugging calls, that must have been the moment the compiler didn't produce the function code at all. A-bloody-mazing....</p>\n"}], "owner": {"reputation": 448, "user_id": 2700583, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/9c0c2c03a9e11ca4448b002a806102f2?s=128&d=identicon&r=PG", "display_name": "3D Coder", "link": "https://stackoverflow.com/users/2700583/3d-coder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 1, "accepted_answer_id": 32744104, "answer_count": 1, "score": 2, "last_activity_date": 1443089137, "creation_date": 1443014130, "last_edit_date": 1443089137, "question_id": 32740626, "link": "https://stackoverflow.com/questions/32740626/how-can-globalizing-2-small-arrays-result-in-significant-performance-drop", "title": "How can globalizing 2 small arrays result in significant performance drop?", "body": "<p>I have 2 small local arrays:  </p>\n\n<pre><code>short int xpLeft [4], xpRight [4];\n</code></pre>\n\n<p>The moment I make them <strong>global</strong> (to access them in different method, but only within same C file (e.g. not accessible to other modules)), the performance (on Motorola 68000) drops. \nInstead of 224 vblanks (for local), the whole benchmark (renders 320 frames of a scene) suddenly takes 249 vblanks (global array) !</p>\n\n<p>What I tried:<br>\nSince the data in the arrays were not used in that function, I though that compiler caught that and did not bother with writing the resulting value (from register) to the memory (an extremely slow operation on 68000 - accessing the memory). So, I added some small code to use those array values at the end of the function, and it raised the performance cost accordingly (just 1 vblank).</p>\n\n<p>What would help:<br>\nI need to examine the final ASM code (and compare both versions), but am unusure how to do that using <strong>vbcc compiler</strong> (from Dr. Volker). I tried few switches from the documentation, and while they did produce some intermediate output, I could not get it to provide a full ASM listing of each module (with the function names from C).  </p>\n\n<p>I just got the switch \"-k\" to work. Apparently, the order of the switches matters, and I found a place in the command line where it's recognized and I finally got the *.ASM output (with over 300 thousands lines no less), but I finally have something (ASM with symbols) to dig through.</p>\n\n<p>What I think is happening:  </p>\n\n<ol>\n<li>making arrays global puts them into different address in RAM, and the memory controller has to access different bank, and the bank\nswitch is an extremely slow operation on the target platform -\nresulting in RAS charge cycles (to access different row of\naddresses).</li>\n<li>pointer aliasing - it's possible the compiler generates different code, and might actually access the actual memory for intermediate\n    results - but if I had the ASM output for each function, I could\n    figure that out easily</li>\n</ol>\n\n<p>Any tips on why this is happening or how to get the vbcc output full listing of each compiled module with corresponding ASM code ?  </p>\n\n<p>With the ASM output I created a small test repro case:  </p>\n\n<pre><code>short int tmpfn1 ()\n{\n    short int xpLeft [4], xpRight [4];\n    short int i, tmp;\n\n    for (i = 0; i &lt; 4; i++)\n    {\n        xpLeft [i] = 137 + i;\n        xpRight [i] = 215 + i;\n    }\n\n    tmp = xpLeft [0] + xpRight [0];\n    return tmp;\n}\n</code></pre>\n\n<p>Here is the resulting ASM. While the ASM is pretty self-explanatory, I added few comments anyway:  </p>\n\n<pre><code>    public  _tmpfn1\n    cnop    0,4\n_tmpfn1\n    sub.w   #16,a7\n    movem.l l4150,-(a7)\n    moveq   #0,d1\n    lea (0+l4152,a7),a1   ; a1 = &amp;xpLeft [0]\n    lea (8+l4152,a7),a2   ; a2 = &amp;xpRight [0]\n    move.w  #215,d3    ; d2/d3 = The Bulgarian constants \n    move.w  #137,d2\nl4148\n    move.w  d1,d0\n    ext.l   d0\n    lsl.l   #1,d0\n    move.w  d2,(0,a1,d0.l)    ; xpLeft [i] = 137 + i;\n    move.w  d3,(0,a2,d0.l)    ; xpRight [i] = 215 + i;\n    addq.w  #1,d1    ; d1 = Loop Counter (i++)\n    addq.w  #1,d2\n    addq.w  #1,d3\n    cmp.w   #4,d1\n    blt l4148    ; Repeat the loop\n    move.w  (8+l4152,a7),d0\n    add.w   (0+l4152,a7),d0    ; tmp = xpLeft [0] + xpRight [0];\nl4150   reg a2/d2/d3\n    movem.l (a7)+,a2/d2/d3\n    add.w   #16,a7\nl4152   equ 12\n    rts\n; stacksize=28\n    opt 0\n    opt NQLPSMRBT\n</code></pre>\n\n<p>Now, I will go place the arrays from local to global.  </p>\n\n<p>Here is the code with global variables.   </p>\n\n<pre><code>    public  _tmpfn1\n    cnop    0,4\n_tmpfn1\n    movem.l l4150,-(a7)\n    moveq   #0,d1\n    move.w  #215,d2\n    move.w  #137,d3\nl4148\n    move.w  d1,d0\n    ext.l   d0\n    lsl.l   #1,d0\n    lea _AxpLeft,a0\n    move.w  d3,(0,a0,d0.l)\n    lea _AxpRight,a0\n    move.w  d2,(0,a0,d0.l)\n    addq.w  #1,d1\n    addq.w  #1,d3\n    addq.w  #1,d2\n    cmp.w   #4,d1\n    blt l4148\n    move.w  _AxpRight,d0\n    add.w   _AxpLeft,d0\nl4150   reg d2/d3\n    movem.l (a7)+,d2/d3\nl4152   equ 8\n    rts\n; stacksize=8\n    opt 0\n    opt NQLPSMRBT\n</code></pre>\n\n<p>The only difference is the two lea instructions which, if memory serves right, is max 16 cycles.<br>\nThere must be something else happening with the actual function, but for some reason, its code is obfuscated in the ASM (there's just 6 lines in ASM, no jumps, no other labels, nothing). I'll keep searching the ASM, where exactly the code is.</p>\n"}, {"tags": ["c", "string"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 6, "creation_date": 1443013968, "post_id": 32740526, "comment_id": 53321793, "body": "Python does not accept unlimited size strings. No existing computer can."}, {"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 0, "creation_date": 1443014027, "post_id": 32740526, "comment_id": 53321838, "body": "You can have that much big array with automatic storage .Program will crash on first second ."}, {"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 2, "creation_date": 1443014063, "post_id": 32740526, "comment_id": 53321870, "body": "Ohhh one more question - <b>Why</b> do you need this much big space ?"}, {"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 0, "creation_date": 1443014129, "post_id": 32740526, "comment_id": 53321924, "body": "Have you got infinite amounts of memory? No. Therefore, an infinite string is impossible, even on the largest supercomputers."}, {"owner": {"reputation": 3056, "user_id": 586229, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/fWSco.png?s=128&g=1", "display_name": "hoijui", "link": "https://stackoverflow.com/users/586229/hoijui"}, "edited": false, "score": 2, "creation_date": 1443014133, "post_id": 32740526, "comment_id": 53321931, "body": "address space is limited (usually 32 or 64bit), memory is limited, ... you can not have a number or string of unlimited size. please tell us what exactly you want to do, and optimally show the code you already have, and we may be able to help you with your practical problem."}], "answers": [{"tags": [], "owner": {"reputation": 893, "user_id": 1183602, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3ZJHj.png?s=128&g=1", "display_name": "Transcendental", "link": "https://stackoverflow.com/users/1183602/transcendental"}, "is_accepted": true, "score": 4, "last_activity_date": 1443014477, "creation_date": 1443014477, "answer_id": 32740758, "question_id": 32740526, "link": "https://stackoverflow.com/questions/32740526/how-can-i-accept-string-inputs-of-undetermined-size/32740758#32740758", "title": "How can I accept string inputs of undetermined size?", "body": "<p>First of all, no existing computer will allow you to store \"unlimited\" values. In fact, taking in consideration that the current universe may be finite, there is no way to do that in our reality.</p>\n\n<p>However, if you want to store \"large\" numbers ( \"large\" meaning numbers that surpass any existing number data type in C ), you might want to consider storing them as char arrays. Again, you'd be limited with virtual address space your application has been given ( see <a href=\"https://en.wikipedia.org/wiki/Virtual_address_space\" rel=\"nofollow\">this</a> ). </p>\n\n<p>You might want to take a look at <a href=\"https://en.wikipedia.org/wiki/C_dynamic_memory_allocation\" rel=\"nofollow\">Dynamic Memory Allocation in C</a>, which might help you a bit.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1443024737, "last_edit_date": 1495535320, "creation_date": 1443024400, "answer_id": 32744438, "question_id": 32740526, "link": "https://stackoverflow.com/questions/32740526/how-can-i-accept-string-inputs-of-undetermined-size/32744438#32744438", "title": "How can I accept string inputs of undetermined size?", "body": "<p>To accept string inputs of \"unlimited\" size:</p>\n\n<p><a href=\"http://man7.org/linux/man-pages/man3/getline.3.html\" rel=\"nofollow noreferrer\"><code>getline(char **lineptr, size_t *n, FILE *stream)</code></a>, not standard, but often in *nix. It will re-allocate memory as needed.  Sample <a href=\"http://www.opensource.apple.com/source/cvs/cvs-19/cvs/lib/getline.c\" rel=\"nofollow noreferrer\">source code</a></p>\n\n<p>Or write a helper function about <code>fgets/fgetc</code> reallocating memory as needed.  Sample <a href=\"https://stackoverflow.com/a/23178265/2410359\">code</a></p>\n\n<hr>\n\n<p>Consider caution in using a function that <em>accept string inputs of \"unlimited\" size</em>.  Fundamentally that is a future security exploit as code is giving control to external data or user to overwhelm resources.</p>\n\n<p>Instead recommend limiting, but to a large value, string input.</p>\n\n<pre><code>#define N 1000000\nchar *ptr = malloc(N);\nassert(ptr);\nfgets(p, N, stdin);\n...\nfree(ptr); \n</code></pre>\n\n<p>Note: many implementations of C memory allocation functions only allocate, not \"use\" memory until required.  So a large allocation does not use up memory if not fully needed.  </p>\n"}], "owner": {"reputation": 160, "user_id": 4753391, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4b2d95f8441b03e405cccfbb730a61fd?s=128&d=identicon&r=PG&f=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/4753391/brad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "accepted_answer_id": 32740758, "answer_count": 2, "score": 0, "last_activity_date": 1470848981, "creation_date": 1443013881, "last_edit_date": 1470848981, "question_id": 32740526, "link": "https://stackoverflow.com/questions/32740526/how-can-i-accept-string-inputs-of-undetermined-size", "title": "How can I accept string inputs of undetermined size?", "body": "<p>So a bit of python vs C here.</p>\n\n<p>I just wrote a program in python to do calculations and the function accepts all numbers as string inputs so that that can handle incredibly huge numbers.</p>\n\n<p>Is there anyway to do this in C without specifying an exact limit to the string length?</p>\n\n<p>So I have a string limit of 100 characters atm in the following base converter function. (Currently only converts to base 10)</p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n    #include &lt;string.h&gt;\n    #include &lt;stdbool.h&gt;\n    #include &lt;math.h&gt;\n\nchar SYMBOLS[] = { '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z' };\n\n//just testing how to access the SYMBOLS[]\nint print_symbols() {\n\n\n    printf(\"Printing individual characters at a time:\\n\");\n    for (int i = 0; i &lt; strlen(SYMBOLS); i++)\n    {\n        printf(\"%c \",SYMBOLS[i]);\n    }\n    printf(\"\\nLength/num of symbols: %d\", strlen(SYMBOLS));\n\n    printf(\"\\n\\nPrinting the whole string at once:\\n\");\n    printf(\"%s\", SYMBOLS);\n    printf(\"\\n\\n\");\n\n    return 0;\n}\n\n//accepts a string to display a prompt to the user and returns input\nchar* input(char prompt[]) {\n    static char received[100];\n    printf(\"%s\", prompt);\n    fgets(received,100,stdin);\n    //Find the return charage and replace with string terminator\n    for (int i = 0; i &lt; strlen(received); i++)\n    {\n        if (received[i] == '\\n') {\n            received[i] = '\\0';\n        }\n    }\n\n    return received;\n}\n\nchar* reverse(char string[]) {\n    static char reversed[100];\n    int len = strlen(string);\n    for (int i = 0; i &lt; len; i++)\n    {\n        reversed[len - 1 - i] = string[i];\n    }\n    return reversed;\n}\n\nchar* from_base_10(char num[], int base) {\n    //NOTE: this function isnt finished and is not actually use yet....\n    static char new_num[100];\n    int numInt = atoi(num);\n    int div;\n    int rem;\n    int count=0;\n\n    if (base&gt;36)\n    {\n        strcpy(new_num,\"\\nERROR: Base can not be higher than 36\\n\");\n        return new_num;\n    }\n\n    while (numInt&gt;0)\n    {\n        div = numInt / base;\n        rem = numInt % base;\n        //printf(\"%d \\\\ %d = %d remainder %d symbol = %c\\n\",numInt, base, div, rem, SYMBOLS[rem]);\n\n        //can not use strcpy or strcat as a single char has no '\\0' terminator\n        new_num[count] = SYMBOLS[rem];\n\n        count++;\n        numInt = div;\n    }\n    new_num[count] = '\\0';//finish the new string off\n\n    //and now the new string has to be reversed\n    strcpy(new_num, reverse(new_num));\n\n    return new_num;\n}\n\nchar* to_base_10(char num[], int base) {\n    static char new_num[100];\n    int len = strlen(num);\n    int power;\n    int total=0;\n    char digit[2];//to use atoi() on a single char we still need a '\\0' so didgit needs to be a 2 char string\n\n    if (base &gt; 36)\n    {\n        strcpy(new_num, \"ERROR: Base can not be higher than 36.\");\n        return new_num;\n    }\n\n    for (int i = 0; i &lt; len; i++)\n    {\n        power = len - 1 - i;\n        digit[0] = num[i];\n        //add digit times base to the power of its position in the number\n        total += atoi(digit) * pow((double)base, (double)power);\n    }\n    printf(\"\\n New Number is : %d\\n\", total);\n\n    itoa(total, new_num, 10); //LOL and at this point I findout this function actually converts base at the same time.\n    return new_num;\n}\n\n\nint main() {\n    char* result;//accapts strings from input()\n    result = \"\";//needs a value for strcmp to use it\n\n    while (strcmp(result, \"exit\")!=0)\n    {\n        printf(\"\\n\\n\\n Brads Math Functions \\n\");\n        printf(\"======================\\n\");\n        printf(\"Enter [exit] to quit.\\n\");\n        printf(\"Enter [base] to convert numbers from one base to another.\\n\");\n        result = input(\"\\nEnter an option from the menu:\");\n\n        if (strcmp(result,\"base\")==0)\n        {\n            char num[100];\n            strcpy(num, result=input(\"Enter a number:\"));\n            int end = atoi( input(\"Enter base:\"));\n            printf(\"\\nResult: %s\\n\", to_base_10(num, end));\n        }\n    }\n\n    printf(\"\\n\");\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "visual-studio-2015", "crt"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1443013718, "post_id": 32740172, "comment_id": 53321585, "body": "Did you add <code>#define __STDC_WANT_LIB_EXT1__ 1</code>  before including the headers?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1443013958, "post_id": 32740172, "comment_id": 53321784, "body": "@Olaf Since when are compiler messages not an unreadable mess? No fault of the poster."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1443014045, "post_id": 32740172, "comment_id": 53321855, "body": "@Lundin: These seem to be multiple lines. And the partial bold face due to improper formating does not make it more readable either. User is here for &gt;1 year and should know."}, {"owner": {"reputation": 781, "user_id": 215779, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/d3bd6e8f48c598795c657ead05318a5d?s=128&d=identicon&r=PG&f=1", "display_name": "eddyq", "link": "https://stackoverflow.com/users/215779/eddyq"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1443197484, "post_id": 32740172, "comment_id": 53411572, "body": "@Lundin Yes but that didn&#39;t help."}, {"owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 0, "creation_date": 1444541086, "post_id": 32740172, "comment_id": 53943081, "body": "If you&#39;re trying to build an EFI executable you can&#39;t link with Visual C++ runtime at all. It only supports Windows executables."}, {"owner": {"reputation": 781, "user_id": 215779, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/d3bd6e8f48c598795c657ead05318a5d?s=128&d=identicon&r=PG&f=1", "display_name": "eddyq", "link": "https://stackoverflow.com/users/215779/eddyq"}, "edited": false, "score": 0, "creation_date": 1445280108, "post_id": 32740172, "comment_id": 54247561, "body": "The idea of this code is to simulate EFI by writing stubs for each EFI function. Maybe there is something in the includes that are causing this error. I&#39;ll do more checking."}, {"owner": {"reputation": 781, "user_id": 215779, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/d3bd6e8f48c598795c657ead05318a5d?s=128&d=identicon&r=PG&f=1", "display_name": "eddyq", "link": "https://stackoverflow.com/users/215779/eddyq"}, "edited": false, "score": 0, "creation_date": 1445526059, "post_id": 32740172, "comment_id": 54368600, "body": "Whoever down voted my question ... I researched this as much as possible before asking the question. It is a legitimate question. Please give us the reason you down voted it. If it was simply the formatting, I didn&#39;t know that Stackoverflow would squash my paste ... I have since fixed that. Will you please remove your down vote?"}], "answers": [{"comments": [{"owner": {"reputation": 781, "user_id": 215779, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/d3bd6e8f48c598795c657ead05318a5d?s=128&d=identicon&r=PG&f=1", "display_name": "eddyq", "link": "https://stackoverflow.com/users/215779/eddyq"}, "edited": false, "score": 0, "creation_date": 1443016864, "post_id": 32740638, "comment_id": 53324141, "body": "Adding &quot;<b>STDC_WANT_LIB_EXT1</b> 1&quot; does not help. I think there is a library that must contain _stdio_common_vsprintf_s."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 0, "last_activity_date": 1443014157, "creation_date": 1443014157, "answer_id": 32740638, "question_id": 32740172, "link": "https://stackoverflow.com/questions/32740172/unresolved-stdio-common-vsprintf-s-what-library-has-this/32740638#32740638", "title": "Unresolved ___stdio_common_vsprintf_s, what library has this?", "body": "<p>According to the C standard annex K</p>\n\n<blockquote>\n  <p>K.3.1.1 Standard headers</p>\n  \n  <p>The functions, macros, and types declared or defined in K.3 and its subclauses are not\n  declared or defined by their respective headers if _ _STDC_WANT_LIB_EXT1_ _ is\n  defined as a macro which expands to the integer constant 0 at the point in the source file\n  where the appropriate header is first included.</p>\n</blockquote>\n\n<p>Meaning that in order to use the \"_s\" functions such as <code>vsprintf_s</code>, which are all found in the mentioned annex, you must define that macro to a value other than 0 before including the header files.</p>\n\n<pre><code>#define __STDC_WANT_LIB_EXT1__ 1\n#include &lt;stdarg.h&gt;\n#include &lt;stdio.h&gt;\n</code></pre>\n\n<p>I suspect that you must have a C11 compiler. Whether or not Visual Studio follows that standard, I have no idea. It is notorious for its poor standard conformance.</p>\n"}, {"tags": [], "owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "is_accepted": false, "score": 4, "last_activity_date": 1443479051, "creation_date": 1443479051, "answer_id": 32832742, "question_id": 32740172, "link": "https://stackoverflow.com/questions/32740172/unresolved-stdio-common-vsprintf-s-what-library-has-this/32832742#32832742", "title": "Unresolved ___stdio_common_vsprintf_s, what library has this?", "body": "<p>You configuration appears to be incorrect. You don't seem to be linking with a couple of new libraries added in <a href=\"http://blogs.msdn.com/b/vcblog/archive/2015/03/03/introducing-the-universal-crt.aspx\" rel=\"nofollow\">Visual Studio 2015's reorganization of the C runtime library</a>. You also appear to linking with both the release static (/MT) and debug DLL (/MDd) version of the same library, specifically <code>LIBCMT.lib</code> and <code>MSVCRTD.lib</code>. </p>\n\n<p>The symbol <code>___stdio_common_vsprintf_s</code> can be found in the in Universal CRT which part of the Windows 10 SDK.  The release static version of the library is called <code>libucrt.lib</code>.  The other unresolved symbols are part of \"vcruntime\" library which is part of Visual Studio 2015. The name of it's release static version is <code>libvcruntime.lib.</code></p>\n\n<p>It not clear why you're not linking with the correct libraries. Normally this handled automatically for you. You'll need to check to your project's configuration settings to see where you've overridden the default behaviour. </p>\n"}, {"comments": [{"owner": {"reputation": 1625, "user_id": 1139436, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/a519e31546fe630d93d69728906be8e5?s=128&d=identicon&r=PG", "display_name": "Jon", "link": "https://stackoverflow.com/users/1139436/jon"}, "edited": false, "score": 1, "creation_date": 1462465960, "post_id": 35789803, "comment_id": 61658370, "body": "Dunno why this was downvoted.. it&#39;s valid: <a href=\"https://connect.microsoft.com/VisualStudio/feedback/details/1151324/memcpy-s-memmove-s-always-inline\" rel=\"nofollow noreferrer\">connect.microsoft.com/VisualStudio/feedback/details/1151324/&zwnj;&#8203;&hellip;</a>"}], "tags": [], "owner": {"reputation": 91, "user_id": 6016941, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/045f802b5d905392e78e1ffd6daa3bf7?s=128&d=identicon&r=PG", "display_name": "int0", "link": "https://stackoverflow.com/users/6016941/int0"}, "is_accepted": false, "score": 8, "last_activity_date": 1457133533, "last_edit_date": 1457133533, "creation_date": 1457074423, "answer_id": 35789803, "question_id": 32740172, "link": "https://stackoverflow.com/questions/32740172/unresolved-stdio-common-vsprintf-s-what-library-has-this/35789803#35789803", "title": "Unresolved ___stdio_common_vsprintf_s, what library has this?", "body": "<p>If you look how vsprintf is declared you can trace it corecrt_stdio ... where it says to inline it.</p>\n\n<p>I had some old DLL which were linking against old msvcrt and trying to import vsprintf from it but seems like VS2015 have new headers and trying to inline it.</p>\n\n<p>Setting _NO_CRT_STDIO_INLINE helped to resolve it, Enjoy.</p>\n\n<p>Edit: Also <a href=\"https://msdn.microsoft.com/en-us/library/bb531344.aspx\" rel=\"noreferrer\">https://msdn.microsoft.com/en-us/library/bb531344.aspx</a></p>\n"}], "owner": {"reputation": 781, "user_id": 215779, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/d3bd6e8f48c598795c657ead05318a5d?s=128&d=identicon&r=PG&f=1", "display_name": "eddyq", "link": "https://stackoverflow.com/users/215779/eddyq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18760, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1457133533, "creation_date": 1443012809, "last_edit_date": 1444531718, "question_id": 32740172, "link": "https://stackoverflow.com/questions/32740172/unresolved-stdio-common-vsprintf-s-what-library-has-this", "title": "Unresolved ___stdio_common_vsprintf_s, what library has this?", "body": "<p>I'm using VS2015 Community. I have obtained some C code that I'm trying to build. It is all in C and I have made a project as a Console Application.</p>\n\n<p>When  I build I get the below errors. The problem is that __stdio_common_vsprintf_s cannot be found during the link process. So I searched the internet for the symbols but don't get any useful information.</p>\n\n<p>I am using the Runtime Library setting called Multi-threaded (/MT).</p>\n\n<p>I have tried adding #define <strong>STDC_WANT_LIB_EXT1</strong> 1 before all includes but that did not help. I have searched for this problem and have not found any postings that help.</p>\n\n<p>So I searched all of the VS libraries and got lots of hits but I don't know which are definitions and which are references. Then I searched all of the .h files in the VS include folder but no hits.</p>\n\n<p>I suspect there may be another library that I need but don't know what it is. Does anyone have any ideas?</p>\n\n<pre><code>1&gt;LIBCMT.lib(_error_.obj) : error LNK2019: unresolved external symbol ___stdio_common_vsprintf_s referenced in function __vsprintf_s_l\n1&gt;LIBCMT.lib(_pdblkup_.obj) : error LNK2019: unresolved external symbol ___vcrt_GetModuleFileNameW referenced in function \"int __cdecl _RTC_GetSrcLine(unsigned char *,wchar_t *,unsigned long,int *,wchar_t *,unsigned long)\" (?_RTC_GetSrcLine@@YAHPAEPA_WKPAH1K@Z)\n1&gt;LIBCMT.lib(_pdblkup_.obj) : error LNK2019: unresolved external symbol ___vcrt_LoadLibraryExW referenced in function \"struct HINSTANCE__ * __cdecl GetPdbDllFromInstallPath(void)\" (?GetPdbDllFromInstallPath@@YAPAUHINSTANCE__@@XZ)\n1&gt;MSVCRTD.lib(_chandler4gs_.obj) : error LNK2019: unresolved external symbol __except_handler4_common referenced in function __except_handler4\n1&gt;W:\\efifs\\Debug\\testing.exe : fatal error LNK1120: 6 unresolved externals\n</code></pre>\n\n<p>Here are my options:</p>\n\n<pre><code>Compile\n----------\n/GS \n/analyze- \n/W3 \n/Zc:wchar_t \n/I\"W:\\efifs\\\\gnu-efi\\inc\" \n/I\"W:\\efifs\\\\gnu-efi\\inc\\ia32\" \n/I\"W:\\efifs\\\\grub\\include\" \n/I\"W:\\efifs\\\\grub-core\\lib\\minilzo\" \n/I\"W:\\efifs\\testing\\\" \n/I\"W:\\efifs\\\\gnu-efi\\inc\\protocol\" \n/I\"W:\\efifs\\\\gnu-efi\\lib\" \n/I\"W:\\efifs\\\\include\" \n/I\"W:\\efifs\\\\grub\\grub-core\\lib\\minilzo\" \n/I\"W:\\efifs\\.msvc\" \n/ZI \n/Gm \n/Od \n/Fd\"Debug\\vc140.pdb\" \n/Zc:inline \n/fp:precise \n/D \"__STDC_WANT_LIB_EXT1__=1\" \n/D \"_UNICODE\" \n/D \"UNICODE\" \n/D \"GRUB_FILE=__FILE__\" \n/D \"HAVE_USE_MS_ABI\" \n/D \"GNU_EFI_USE_EXTERNAL_STDARG\" \n/D \"DRIVERNAME=testing\" \n/D \"WIN32\" \n/D \"_DEBUG\" \n/D \"_CONSOLE\" \n/errorReport:prompt \n/WX- \n/Zc:forScope \n/RTC1 \n/Gd \n/Oy- \n/MT \n/Fa\"Debug\\\" \n/EHsc \n/nologo \n/Fo\"Debug\\\" \n/Fp\"Debug\\testing.pch\" \n\nLink\n-----\n/OUT:\"W:\\efifs\\Debug\\testing.exe\" \n/MANIFEST \n/NXCOMPAT \n/PDB:\"W:\\efifs\\Debug\\testing.pdb\" \n/DYNAMICBASE \"efifs.lib\" \"grub.lib\" \"gnu-efi.lib\" \"kernel32.lib\" \"user32.lib\" \"gdi32.lib\" \"winspool.lib\" \"comdlg32.lib\" \"advapi32.lib\" \"shell32.lib\" \"ole32.lib\" \"oleaut32.lib\" \"uuid.lib\" \"odbc32.lib\" \"odbccp32.lib\" \n/MACHINE:X86 \n/INCREMENTAL \n/PGD:\"W:\\efifs\\Debug\\testing.pgd\" \n/SUBSYSTEM:CONSOLE \n/MANIFESTUAC:\"level='asInvoker' uiAccess='false'\" \n/ManifestFile:\"Debug\\testing.exe.intermediate.manifest\" \n/ERRORREPORT:PROMPT \n/NOLOGO \n/LIBPATH:\"W:\\efifs\\testing\\\\grub\" \n/LIBPATH:\"W:\\efifs\\testing\\\\efifs\" \n/LIBPATH:\"W:\\efifs\\testing\\\\gnu-efi\" \n/TLBID:1 \n</code></pre>\n"}, {"tags": ["c++", "c", "segmentation-fault", "compiler-optimization", "rapidjson"], "comments": [{"owner": {"reputation": 29116, "user_id": 382471, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/804ee314e1022f48ddd7d9cebe329afc?s=128&d=identicon&r=PG", "display_name": "robert", "link": "https://stackoverflow.com/users/382471/robert"}, "edited": false, "score": 0, "creation_date": 1443012632, "post_id": 32740053, "comment_id": 53320735, "body": "Can you show us the generated assembly, both with and without optimization? (See <a href=\"https://stackoverflow.com/questions/137038/how-do-you-get-assembler-output-from-c-c-source-in-gcc\" title=\"how do you get assembler output from c c source in gcc\">stackoverflow.com/questions/137038/&hellip;</a>)"}, {"owner": {"reputation": 4462, "user_id": 1018640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7d63b0bd537a54f53eb85c1471418ad?s=128&d=identicon&r=PG", "display_name": "Milo Yip", "link": "https://stackoverflow.com/users/1018640/milo-yip"}, "edited": false, "score": 0, "creation_date": 1443063738, "post_id": 32740053, "comment_id": 53345674, "body": "Do the unit tests in the rapidjson bundle pass? It may be the application have corrupted memory somewhere."}], "answers": [{"comments": [{"owner": {"reputation": 4462, "user_id": 1018640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7d63b0bd537a54f53eb85c1471418ad?s=128&d=identicon&r=PG", "display_name": "Milo Yip", "link": "https://stackoverflow.com/users/1018640/milo-yip"}, "edited": false, "score": 0, "creation_date": 1443063938, "post_id": 32741356, "comment_id": 53345719, "body": "<code>&gt;=</code> is correct. When <code>size == capacity</code> it means the storage is just full and need to increase the capacity of storage. And also note that the line is <code>o.capacity += (oldCapacity + 1) &#47; 2</code>, which adds <code>ceil(oldCapacity * 0.5)</code> to make the 1.5 increment factor."}, {"owner": {"reputation": 3, "user_id": 5367743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6e292e346d79e92c2673fbe13f69477?s=128&d=identicon&r=PG&f=1", "display_name": "Will Platts", "link": "https://stackoverflow.com/users/5367743/will-platts"}, "edited": false, "score": 0, "creation_date": 1443094757, "post_id": 32741356, "comment_id": 53359789, "body": "Sorry, just edited post, I made a typo. o.capacity is originally 0 bytes, so it is going into &quot;if (o.capacity == 0) {&quot;. Then it skips the line to set o.capacity to kDefaultObjectCapacity and o.capacity is still 0 when the Malloc is called."}, {"owner": {"reputation": 5146, "user_id": 5089383, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d483ecc01086edbc775bd770c66b5e4?s=128&d=identicon&r=PG&f=1", "display_name": "JSF", "link": "https://stackoverflow.com/users/5089383/jsf"}, "edited": false, "score": 0, "creation_date": 1443107379, "post_id": 32741356, "comment_id": 53368822, "body": "Now that you removed the &quot;90&quot; that I read so much into, there may be no value left in my answer.  My alternate answer would be I still don&#39;t believe the optimizer went that badly wrong.  So we need to see a big enough chunk, preferably a whole module that could be compiled, but at least enough to include the definition of that constant you mentioned as well as the declaration of the data members of <code>Object</code>.  If this is all in code you downloaded, a link would be nice, since I don&#39;t know how to search it."}, {"owner": {"reputation": 3, "user_id": 5367743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6e292e346d79e92c2673fbe13f69477?s=128&d=identicon&r=PG&f=1", "display_name": "Will Platts", "link": "https://stackoverflow.com/users/5367743/will-platts"}, "edited": false, "score": 0, "creation_date": 1443132506, "post_id": 32741356, "comment_id": 53382493, "body": "Yes sorry about the 90! Good point, I should have posted a link. It&#39;s here: <a href=\"https://github.com/miloyip/rapidjson/blob/master/include/rapidjson/document.h\" rel=\"nofollow noreferrer\">github.com/miloyip/rapidjson/blob/master/include/rapidjson/&hellip;</a> The function that seems to be acting strange is AddMember, line 993"}], "tags": [], "owner": {"reputation": 5146, "user_id": 5089383, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d483ecc01086edbc775bd770c66b5e4?s=128&d=identicon&r=PG&f=1", "display_name": "JSF", "link": "https://stackoverflow.com/users/5089383/jsf"}, "is_accepted": false, "score": 1, "last_activity_date": 1443093955, "last_edit_date": 1443093955, "creation_date": 1443015851, "answer_id": 32741356, "question_id": 32740053, "link": "https://stackoverflow.com/questions/32740053/rapidjson-seg-fault-with-g-optimization/32741356#32741356", "title": "Rapidjson seg fault with g++ optimization", "body": "<p>Your code looks pretty badly wrong, and in a way that makes me suspect you are also misunderstanding what you see in the debugger.  Try fixing the bugs first, before worrying about what the optimizer might be doing:</p>\n\n<p>It appears that part of your intent is for o.capacity to end up <code>&gt;</code> (or maybe you intended <code>&gt;=</code>) o.size</p>\n\n<p>But did you consider the case <code>o.size &gt; kDefaultObjectCapacity</code> when o.capacity starts at zero?  More seriously, your comment about increasing by a factor of 1.5 is wrong for code that decreases capacity.  You probably intended <code>oldCapacity*3/2</code></p>\n\n<pre><code>if (o.size &gt;= o.capacity) {\n    if (o.capacity == 0) {\n        o.capacity = kDefaultObjectCapacity;\n        o.members = reinterpret_cast&lt;Member*&gt;(allocator.Malloc(o.capacity * sizeof(Member)));\n    }\n    else {\n        SizeType oldCapacity = o.capacity;\n        o.capacity += (oldCapacity + 1) / 2; // grow by factor 1.5\n        o.members = reinterpret_cast&lt;Member*&gt;(allocator.Realloc(o.members, oldCapacity * sizeof(Member), o.capacity * sizeof(Member)));\n    }\n}\n</code></pre>\n\n<p>Edit:  I was mistaken about a large part of the above.  But I still think a misunderstanding of what was seen in the debugger is a more likely explanation that the optimizer breaking that code.</p>\n\n<p>Was the \"90\" mentioned decimal, or might it have been hex?  The optimizer certainly could skip multiplying by <code>sizeof(Member)</code> and go directly to the result of that multiplication.</p>\n"}, {"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1455589746, "post_id": 35422239, "comment_id": 58545468, "body": "I&#39;d suggest posting this as a new question (&quot;why does the thread version crash?&quot;) . You can put a comment on this question linking to your new question if you want. So far there is no evidence that this is actually the answer to OP&#39;s question."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1455589839, "post_id": 35422239, "comment_id": 58545490, "body": "although I would suggest calling <code>pthread_join</code> before <code>return 0;</code> at least ... if you fall off the end of main then it may destroy any static objects that <code>rapidjson</code> used , and then your thread tries to use those objects and gets into trouble"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1455589932, "post_id": 35422239, "comment_id": 58545507, "body": "another thing is that <code>cout</code> may not have been thread safe prior to C++11"}, {"owner": {"reputation": 324, "user_id": 1599059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb3eed9eb18a44c878232b450986e61f?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/1599059/simon"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1455630332, "post_id": 35422239, "comment_id": 58566529, "body": "Thanks for your comment.  Using the last code from the repo fixed the issue.  I did try before posting the question, but I had a setup problem that caused the old version (1.0.2) to be used..."}], "tags": [], "owner": {"reputation": 324, "user_id": 1599059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb3eed9eb18a44c878232b450986e61f?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/1599059/simon"}, "is_accepted": false, "score": 1, "last_activity_date": 1455630197, "last_edit_date": 1455630197, "creation_date": 1455587134, "answer_id": 35422239, "question_id": 32740053, "link": "https://stackoverflow.com/questions/32740053/rapidjson-seg-fault-with-g-optimization/35422239#35422239", "title": "Rapidjson seg fault with g++ optimization", "body": "<p>I got a similar issue, compiling with GCC 4.9: I get a segmentation fault when an optimization flag is specified (-On).  It's very easy to duplicate, here's the code:</p>\n\n<pre><code>//...\n#include \"extern/rapidjson/document.h\"\n//...\nvoid* MyThread(void*)\n{\n   std::cout &lt;&lt; \"Start of MyThread\" &lt;&lt; std::endl;\n\n   rapidjson::Document doc;\n   doc.Parse(\"{ \\\"NAME\\\": \\\"Peter\\\", \\\"AGE\\\": 38, \\\"Male\\\": true}\");\n\n   std::cout &lt;&lt; \"End!\";\n\n   return NULL;\n}\n\nint main(int argc, char** argv) \n{\n   pthread_t thread;\n\n   pthread_create(&amp;thread, NULL, &amp;MyThread, NULL);\n\n   std::string str;\n   std::cout &lt;&lt; \"Press &lt;Return&gt;\"  &lt;&lt; std::endl;\n   std::getline(std::cin, str);\n\n   return 0;\n }\n</code></pre>\n\n<p>The key here is the document being created and parsed in a separate thread.  If we call \"MyThread(NULL)\" directly in the main(), we won't get any bug.</p>\n\n<p>A similar code with Visual Studio 2012, optimized, runs fine.  I ran a VS code analysis and no error was found.  The only difference is the threading:</p>\n\n<pre><code>std::thread th([] { MyThread(NULL); }); \nth.join();\n</code></pre>\n\n<p>===============================================</p>\n\n<p><strong>The issue has been fixed after version 1.0.2.  Using the latest code works fine.</strong></p>\n"}], "owner": {"reputation": 3, "user_id": 5367743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6e292e346d79e92c2673fbe13f69477?s=128&d=identicon&r=PG&f=1", "display_name": "Will Platts", "link": "https://stackoverflow.com/users/5367743/will-platts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1099, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1455630197, "creation_date": 1443012458, "last_edit_date": 1443107711, "question_id": 32740053, "link": "https://stackoverflow.com/questions/32740053/rapidjson-seg-fault-with-g-optimization", "title": "Rapidjson seg fault with g++ optimization", "body": "<p>I am using Rapidjson and have noticed that when I turn on optimization in g++ (-O1/-O2/-O3) I am getting a segmentation fault. I think I have tracked it down to the GenericValue&amp; AddMember() function within rapidjson.</p>\n\n<pre><code>GenericValue&amp; AddMember(GenericValue&amp; name, GenericValue&amp; value, Allocator&amp; allocator) {\n    RAPIDJSON_ASSERT(IsObject());\n    RAPIDJSON_ASSERT(name.IsString());\n\n    Object&amp; o = data_.o;\n    if (o.size &gt;= o.capacity) {\n        if (o.capacity == 0) {\n            o.capacity = kDefaultObjectCapacity;\n            o.members = reinterpret_cast&lt;Member*&gt;(allocator.Malloc(o.capacity * sizeof(Member)));\n        }\n        else {\n            SizeType oldCapacity = o.capacity;\n            o.capacity += (oldCapacity + 1) / 2; // grow by factor 1.5\n            o.members = reinterpret_cast&lt;Member*&gt;(allocator.Realloc(o.members, oldCapacity * sizeof(Member), o.capacity * sizeof(Member)));\n        }\n    }\n    o.members[o.size].name.RawAssign(name);\n    o.members[o.size].value.RawAssign(value);\n    o.size++;\n    return *this;\n}\n</code></pre>\n\n<p>When debugging, I can see that kDefaultObjectCapacity ( is being optimized out (this is a static const SizeType kDefaultObjectCapacity = 16)</p>\n\n<p>Therefore the line \"o.capacity = kDefaultObjectCapacity;\" is not being executed, and the malloc is mallocing 0 bytes then trying to cast it.</p>\n\n<p>Why is this static const being removed?</p>\n\n<p>I have tried making Object&amp; o both volatile and static, neither worked.\nAny ideas?</p>\n\n<p>Thanks\nWill</p>\n\n<p>EDIT:\nI can't easily run the tests as it's on an embedded platform, rapidjson is built using buildroot at the moment. I tried the unit tests but couldn't get them going on the target.</p>\n\n<p>I can have a look at providing the assembly, but it's part of a big application so it might be difficult finding the right bit.</p>\n\n<p>For info, this is the method that calls the rapidjson code and this is where the problem seems to be:</p>\n\n<pre><code>int16_t FrontEndJSONHandlers::get_run_cfg_packer(JSONEngine&amp; json_engine, char *message, int32_t *length)\n{\nDocument doc;\n\n// Need to pack an empty request to get the data\ndoc.SetObject();\ndoc.AddMember(JSONRPC_MEMBER, JSONRPC_VERSION, doc.GetAllocator());\ndoc.AddMember(METHOD_MEMBER, JSON_RPC_METH_GET_RUN_CFG, doc.GetAllocator());\ndoc.AddMember(ID_MEMBER, json_engine.GetNextMessageID(), doc.GetAllocator());\n\n// Format the message\njson_engine.FormatMessageAndRegisterResponseHandler(&amp;doc, &amp;message, &amp;length, get_run_cfg_handler);\n\nreturn 0;\n}\n</code></pre>\n\n<p>If I make Document doc static, it doesn't seg fault - not sure whether this is the best way around it though?</p>\n"}, {"tags": ["c", "arrays", "infinite-loop"], "comments": [{"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 3, "creation_date": 1443012322, "post_id": 32739958, "comment_id": 53320490, "body": "You need to include the code in your question, not a screenshot. From a quick glance this looks very similar to <a href=\"http://stackoverflow.com/q/32506643/1708801\">this question</a>, so it is probably aggressive optimization around undefined behavior since you are going out of bounds on the last array access."}, {"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 4, "creation_date": 1443012325, "post_id": 32739958, "comment_id": 53320493, "body": "You are going over the array and most likely writing on top of the <code>i</code> variable. Undefined behaviour, don&#39;t do that. Also don&#39;t post code as screenshots."}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1443013923, "post_id": 32739958, "comment_id": 53321759, "body": "Once you add the code to your question I am happy to vote reopen but it will probably be closed again as a duplicate though if I am correct about my comment above."}, {"owner": {"reputation": 13, "user_id": 5364632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d31b3083c92067964898b7c68dad576?s=128&d=identicon&r=PG&f=1", "display_name": "jksprt0", "link": "https://stackoverflow.com/users/5364632/jksprt0"}, "edited": false, "score": 0, "creation_date": 1443022875, "post_id": 32739958, "comment_id": 53328586, "body": "i apologise its my first time asking question here , i wanted to show the output too that&#39;s why posted screenshots . I am sorry"}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1443033837, "post_id": 32739958, "comment_id": 53334978, "body": "Voting to reopen, it look very similar to the question I link above but I can not reproduce. Can you explain which compiler and what flags you are using?"}], "answers": [{"tags": [], "owner": {"reputation": 2324, "user_id": 5334131, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JU6Bo.jpg?s=128&g=1", "display_name": "Hellmar Becker", "link": "https://stackoverflow.com/users/5334131/hellmar-becker"}, "is_accepted": true, "score": 3, "last_activity_date": 1443012807, "creation_date": 1443012807, "answer_id": 32740170, "question_id": 32739958, "link": "https://stackoverflow.com/questions/32739958/unexpected-infinite-loop-array-c/32740170#32740170", "title": "unexpected infinite loop array c", "body": "<p>You declared your array to be size 5. Thus valid indexes are 0 to 4 (inclusive). In the last pass of the loop, you write to location a[5], which clobbers whatever variable happens to live at that address right after the end of the array. That might your loop variable i, depending on how the compiler lays the variables out in memory. The result is generally unpredictable.</p>\n"}], "owner": {"reputation": 13, "user_id": 5364632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d31b3083c92067964898b7c68dad576?s=128&d=identicon&r=PG&f=1", "display_name": "jksprt0", "link": "https://stackoverflow.com/users/5364632/jksprt0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "accepted_answer_id": 32740170, "answer_count": 1, "score": -1, "last_activity_date": 1443458663, "creation_date": 1443012202, "last_edit_date": 1443458663, "question_id": 32739958, "link": "https://stackoverflow.com/questions/32739958/unexpected-infinite-loop-array-c", "title": "unexpected infinite loop array c", "body": "<p>I am learning programming on my own. I came across arrays and tried to alter the for loop's condition from i &lt; 5 to i &lt;=5 , the outcome was unexpected, infinite loop:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    int a[5] , i , j = 0;\n    for (i=0;i&lt;=5;i++)\n    {\n        a[i] = 2;\n        printf(\"%d \" , a[5]);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Again I tried the same but this time with a variable , but this time no infinite loop.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    int a[5] , i , j = 0;\n    for (i=0;i&lt;=5;i++)\n    {\n        a[i] = j;\n        printf(\"%d \" , a[5]);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Please explain to me why the loop was infinite in first and not in second case.</p>\n"}, {"tags": ["c", "printf"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 2, "creation_date": 1443011638, "post_id": 32739696, "comment_id": 53319974, "body": "<code>sizeof</code> tells you how many bytes of storage a variable uses. Remember that a pointer is a variable that points at other objects, it doesn&#39;t &quot;contain&quot; the things it points at."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 1, "creation_date": 1443011714, "post_id": 32739696, "comment_id": 53320042, "body": "<code>char * c; sizeof( c );</code> will give you the size of the <i>pointer</i> in bytes. (Most likely <code>4</code> or <code>8</code>, but in any case independent of whatever <code>c</code> points <i>to</i>.) <code>char * c; strlen( c );</code> will tell you how many consecutive non-<code>\\0</code> bytes are in the memory area pointed to by <code>c</code> (i.e., the string length not counting the terminating <code>\\0</code>)."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 1, "creation_date": 1443012081, "post_id": 32739696, "comment_id": 53320300, "body": "&quot;So the question is how can I tell <code>snprintf</code> to reach this value of <code>c[64]</code>&quot; -- that is neither what the title, nor the <i>whole rest</i> of your question is talking about. I suggest asking a different question."}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "reply_to_user": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1443012093, "post_id": 32739696, "comment_id": 53320308, "body": "@DevSolar: fair, but note the question-behind-the-title. It&#39;s about what value to provide for <code>snprintf</code>. (Ah, you noted that while I was typing.)"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1443012215, "post_id": 32739696, "comment_id": 53320403, "body": "If folk (i) read the C standard, (ii) the C++ standard, (iii) the JLS, and last, but not least (iv) a regular expression tutorial, there would be no need for this site at all."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1443012417, "post_id": 32739696, "comment_id": 53320565, "body": "@Jongware: Then the close vote should be &quot;unclear what you&#39;re asking&quot;. Either way, a poor question that is unlikely to be helpful to future visitors.."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1443012452, "post_id": 32739696, "comment_id": 53320591, "body": "Learning the difference between <code>sizeof</code> and <code>strlen</code> is obvious from the documentation for these two things. @Bathsheba"}], "answers": [{"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 1, "last_activity_date": 1443011846, "creation_date": 1443011846, "answer_id": 32739831, "question_id": 32739696, "link": "https://stackoverflow.com/questions/32739696/difference-between-sizeof-and-strlen/32739831#32739831", "title": "difference between sizeof() and strlen()", "body": "<p>With a couple of exceptions, <code>sizeof</code> is compile-time evaluable and gives you the size of a type. So therefore it can't know about run-time things like the length of a \"string\".</p>\n\n<p><code>strlen</code> operates on a <code>const char*</code> and tracks along the memory from the starting pointer until the first <code>\\0</code> is reached, and then returns the number of advances it makes. That's convenient since it can be used to compute the length of a \"string\", assuming it's modelled as a series of non-zero bytes <em>terminated</em> with a zero byte.</p>\n"}, {"comments": [{"owner": {"reputation": 157, "user_id": 4790814, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6a2d1340913e8fe33f67cc9684647364?s=128&d=identicon&r=PG&f=1", "display_name": "iBeyondPower", "link": "https://stackoverflow.com/users/4790814/ibeyondpower"}, "edited": false, "score": 0, "creation_date": 1443012232, "post_id": 32739836, "comment_id": 53320414, "body": "how do i provide this maximum number of chars in an array from the pointer, i do not have the means to find it out either (yet, i hope)."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "reply_to_user": {"reputation": 157, "user_id": 4790814, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6a2d1340913e8fe33f67cc9684647364?s=128&d=identicon&r=PG&f=1", "display_name": "iBeyondPower", "link": "https://stackoverflow.com/users/4790814/ibeyondpower"}, "edited": false, "score": 0, "creation_date": 1443012271, "post_id": 32739836, "comment_id": 53320452, "body": "If you have no means to find out how much space there is a c, there is no safe way to copy anything into it. If you allocated it somewhere, you know; if somebody else allocated it, they should tell."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1443013346, "post_id": 32739836, "comment_id": 53321270, "body": "&quot;<i>pass INT_MAX to snprintf</i>&quot; so what be the use of using <code>snprintf()</code> at all then? :-S"}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1443013572, "post_id": 32739836, "comment_id": 53321475, "body": "@alk: The use is that it is available (as opposed to sprintf, according to the OP). I thought that this solution (i.e. the semantics of <code>size</code>) may actually not be clear to the OP. So if he doesn&#39;t have a means to find out the available space at c but can be reasonably sure that it is sufficient, there is no need to be exact. After all, that&#39;s how people programmed the buggy first 25 years."}], "tags": [], "owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1443013547, "last_edit_date": 1443013547, "creation_date": 1443011864, "answer_id": 32739836, "question_id": 32739696, "link": "https://stackoverflow.com/questions/32739696/difference-between-sizeof-and-strlen/32739836#32739836", "title": "difference between sizeof() and strlen()", "body": "<p><a href=\"http://linux.die.net/man/3/snprintf\" rel=\"nofollow\">http://linux.die.net/man/3/snprintf</a> states that the size parameter in snprintf contains the <em>maximum</em> number of chars which will be written; this is a protection against writing beyond whatever storage starts at c. (Btw, <code>c</code>? Why not <code>s</code>?).</p>\n\n<p><code>snprintf</code> has no means to find that maximum out. The size of available memory at the destination should be known from when you allocated it (dynamically or by array definition) .</p>\n\n<p>Edit: In the general case the number of bytes available at <code>c</code> must be passed to <code>functionname</code> as a parameter (for the same reason it must be passed to <code>snprintf</code>). That may not be necessary if the function can share, for example through a header, a #define for the array size, or if a global variable is accessible which contains the memory size.--</p>\n\n<p>That said: If you are sure that the memory at c is sufficient, or if you are into unsafe programs you can, of course, pass some big number to <code>snprintf</code>. That will work as long as the memory indeed <em>is</em> sufficient for the text written at run time. The <code>size</code> parameter for <code>snprintf</code> just communicates an upper limit to <code>snprintf</code> which will at run time touch no memory beyond what it needs to touch.</p>\n"}, {"comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1443012134, "post_id": 32739894, "comment_id": 53320341, "body": "Be careful when asserting the size of a pointer: there&#39;s no reason in C why sizeof(int*) is the same as sizeof(double*), for example."}, {"owner": {"reputation": 157, "user_id": 4790814, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6a2d1340913e8fe33f67cc9684647364?s=128&d=identicon&r=PG&f=1", "display_name": "iBeyondPower", "link": "https://stackoverflow.com/users/4790814/ibeyondpower"}, "edited": false, "score": 0, "creation_date": 1443012136, "post_id": 32739894, "comment_id": 53320342, "body": "the variable &#39;a&#39;  is compleely unrelated"}, {"owner": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1443012258, "post_id": 32739894, "comment_id": 53320437, "body": "@Bathsheba hence why I used the &quot;eg.&quot; abbreviation that means that the examples that follow are by no means exhaustive."}], "tags": [], "owner": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "is_accepted": false, "score": 0, "last_activity_date": 1443135004, "last_edit_date": 1443135004, "creation_date": 1443012039, "answer_id": 32739894, "question_id": 32739696, "link": "https://stackoverflow.com/questions/32739696/difference-between-sizeof-and-strlen/32739894#32739894", "title": "difference between sizeof() and strlen()", "body": "<p>Since <code>c</code> is a pointer, <code>sizeof(c)</code> will return the size of a pointer, which depends on the architecture of your platform, e.g. 32 bits -> 4, 16 bits -> 2.</p>\n\n<p><code>strlen(c)</code> will not help you either, because it calculates the length of the string by stopping at the first null character.<br>\nIf your buffer is uninitialized, it is no better than undefined behaviour.</p>\n\n<p>You need to know the real size of the buffer that <code>c</code> refers to.</p>\n\n<p>The buffer can be allocated on the stack statically, like this:</p>\n\n<pre><code>char buffer[250];\nchar * c = buffer;\n</code></pre>\n\n<p>Or dynamically:</p>\n\n<pre><code>int sz = 250;\nchar * buffer = malloc(sz * sizeof(char));\nchar * c = buffer;\n</code></pre>\n\n<p>You need to know its real size (here 250), by passing it explicitely to the function that calls your sprintf variant:</p>\n\n<pre><code>void functionname(int a, char* c, int sz){\n    snprintf(c, sz, \" ... some text ...\");\n}\n</code></pre>\n\n<p>I am assuming here that <code>a</code> is a completely unrelated variable.</p>\n"}, {"tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 1, "last_activity_date": 1443012283, "creation_date": 1443012283, "answer_id": 32739993, "question_id": 32739696, "link": "https://stackoverflow.com/questions/32739696/difference-between-sizeof-and-strlen/32739993#32739993", "title": "difference between sizeof() and strlen()", "body": "<p>In this code:</p>\n\n<pre><code>void functionname(int a, char* c){\n    sprintf(c, \" ... some text ...\");\n}\n</code></pre>\n\n<p><code>c</code> is a mere pointer, not an array. So <code>sizeof(c)</code> will be <code>sizeof(char *)</code>, that is 2, 4 or 8 depending on architecture (resp. 16, 32 or 64 bits).</p>\n\n<p><code>strlen(c)</code> only gives the position on first null in memory starting at <code>c</code>. If the array was initialized to 0 by caller, it will just be... <code>0</code>!</p>\n\n<p>So here neither can be used. The best way would be to ask caller to pass the actual size of the array and just be confident in callee:</p>\n\n<pre><code>void functionname(int a, char* c, size_t size){\n    snprintf(c, size, \" ... some text ...\");\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 157, "user_id": 4790814, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6a2d1340913e8fe33f67cc9684647364?s=128&d=identicon&r=PG&f=1", "display_name": "iBeyondPower", "link": "https://stackoverflow.com/users/4790814/ibeyondpower"}, "edited": false, "score": 0, "creation_date": 1443012462, "post_id": 32739994, "comment_id": 53320595, "body": "there is no way to go from sprintf() to snprintf() with the same variables one would provide to sprintf()? in the case that print function targets a char pointer?"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 157, "user_id": 4790814, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6a2d1340913e8fe33f67cc9684647364?s=128&d=identicon&r=PG&f=1", "display_name": "iBeyondPower", "link": "https://stackoverflow.com/users/4790814/ibeyondpower"}, "edited": false, "score": 1, "creation_date": 1443012913, "post_id": 32739994, "comment_id": 53320944, "body": "@iBeyondPower: If you have no array variable to determine its size from (using the <code>sizeof</code>-operator), but only a pointer and no other reliable info on the size of valid memory the pointer points then yes, there is no way."}], "tags": [], "owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "is_accepted": false, "score": 1, "last_activity_date": 1443012665, "last_edit_date": 1443012665, "creation_date": 1443012285, "answer_id": 32739994, "question_id": 32739696, "link": "https://stackoverflow.com/questions/32739696/difference-between-sizeof-and-strlen/32739994#32739994", "title": "difference between sizeof() and strlen()", "body": "<blockquote>\n  <p>how can i get the size of the array the pointer c is pointing towards, </p>\n</blockquote>\n\n<p>You cannot. </p>\n\n<p>The code needs to keep track of how much valid memory a pointer points to.</p>\n\n<p>A pointer does not hold information of the size of valid memory it is pointing to but just only the address of a memory area, which might even be of size 0.</p>\n"}], "owner": {"reputation": 157, "user_id": 4790814, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6a2d1340913e8fe33f67cc9684647364?s=128&d=identicon&r=PG&f=1", "display_name": "iBeyondPower", "link": "https://stackoverflow.com/users/4790814/ibeyondpower"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1044, "favorite_count": 0, "closed_date": 1443013180, "answer_count": 5, "score": -2, "last_activity_date": 1443135004, "creation_date": 1443011451, "last_edit_date": 1443012910, "question_id": 32739696, "link": "https://stackoverflow.com/questions/32739696/difference-between-sizeof-and-strlen", "closed_reason": "Duplicate", "title": "difference between sizeof() and strlen()", "body": "<p>I have a function which looks like this:</p>\n\n<pre><code>void functionname(int a, char* c){\nsprintf(c, \" ... some text ...\");\n}\n</code></pre>\n\n<p>The above statement uses a sprintf to write into the array of 'c'. </p>\n\n<p>For my system i dont think i can use sprint since i am using a different (embedded) OS. </p>\n\n<p>The print function i have uses something which looks like snprintf, and i wonder how i can make this function work with snprintf. </p>\n\n<p>Do i use strlen(c)? what happens when c is empty?, do i use sizeof(c)? </p>\n\n<pre><code>snprintf(c, sizeof(c), \" ... text\"); \n</code></pre>\n\n<p>or</p>\n\n<pre><code>snprintf(c, strlen(c), \"... text\"); \n</code></pre>\n\n<p>the function calling 'functionname' has a an array which defines the length of c as c[64]. I am afraid calling sizeof(c) will result in the size of the pointer. Also afraid that strlen will cause to return 0 when the array does not contain a string.</p>\n\n<p>So the question is how can i tell snprintf to reach this value of c[64].</p>\n\n<p>How can i get the size of the array the pointer c is pointing towards, and put this answer in the snprintf function. If there is a way to go from sprintf() to snprintf() with the same variables one would provide to sprintf()? in the case that sprint() function targets a char pointer?</p>\n"}, {"tags": ["c", "hard-drive", "plc", "st"], "comments": [{"owner": {"reputation": 41440, "user_id": 3887516, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/62e0310897139a10f3293022b6eb7054?s=128&d=identicon&r=PG&f=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/3887516/amit"}, "edited": false, "score": 1, "creation_date": 1443010885, "post_id": 32739383, "comment_id": 53319451, "body": "Excel can, and any other calculator can as well. But first you need to explain (to yourself at least) what exactly are you writing, in which format, and for what duration."}, {"owner": {"reputation": 809, "user_id": 1342044, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/6d8075ca98978d351f4330ea0dbb9ec0?s=128&d=identicon&r=PG", "display_name": "soulemane moumie", "link": "https://stackoverflow.com/users/1342044/soulemane-moumie"}, "reply_to_user": {"reputation": 41440, "user_id": 3887516, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/62e0310897139a10f3293022b6eb7054?s=128&d=identicon&r=PG&f=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/3887516/amit"}, "edited": false, "score": 0, "creation_date": 1443011850, "post_id": 32739383, "comment_id": 53320143, "body": "As I am using structured text, values are of type DWORD (32 bit)"}], "answers": [{"tags": [], "owner": {"reputation": 11532, "user_id": 5129715, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/320498457784a3110f3e256745a9a927?s=128&d=identicon&r=PG&f=1", "display_name": "mksteve", "link": "https://stackoverflow.com/users/5129715/mksteve"}, "is_accepted": false, "score": 0, "last_activity_date": 1443011781, "creation_date": 1443011781, "answer_id": 32739810, "question_id": 32739383, "link": "https://stackoverflow.com/questions/32739383/estimation-of-the-data-logging-size/32739810#32739810", "title": "Estimation of the Data logging size", "body": "<p>Create a sample spreadsheet. Add 1000 rows and save it as a different name.</p>\n\n<p>That will give an estimate for per-row cost.</p>\n\n<p>Incremental writing is not a good scenario for complex formats such as spread sheet.  Text log file could be appended.</p>\n\n<p>A spread sheet would tend to re-write whole file for each flush.</p>\n"}, {"comments": [{"owner": {"reputation": 809, "user_id": 1342044, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/6d8075ca98978d351f4330ea0dbb9ec0?s=128&d=identicon&r=PG", "display_name": "soulemane moumie", "link": "https://stackoverflow.com/users/1342044/soulemane-moumie"}, "edited": false, "score": 0, "creation_date": 1443605954, "post_id": 32747256, "comment_id": 53558075, "body": "thank you for the ideas, it is a smart one."}, {"owner": {"reputation": 809, "user_id": 1342044, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/6d8075ca98978d351f4330ea0dbb9ec0?s=128&d=identicon&r=PG", "display_name": "soulemane moumie", "link": "https://stackoverflow.com/users/1342044/soulemane-moumie"}, "edited": false, "score": 1, "creation_date": 1443606110, "post_id": 32747256, "comment_id": 53558156, "body": "Just a correction: 13 characters x N columns x 6 times per second x 60 min X 24 hours = n bytes per day"}, {"owner": {"reputation": 2670, "user_id": 346104, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/31duc.jpg?s=128&g=1", "display_name": "franji1", "link": "https://stackoverflow.com/users/346104/franji1"}, "reply_to_user": {"reputation": 809, "user_id": 1342044, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/6d8075ca98978d351f4330ea0dbb9ec0?s=128&d=identicon&r=PG", "display_name": "soulemane moumie", "link": "https://stackoverflow.com/users/1342044/soulemane-moumie"}, "edited": false, "score": 0, "creation_date": 1443621711, "post_id": 32747256, "comment_id": 53568213, "body": "@soulemanemoumie corrected"}, {"owner": {"reputation": 809, "user_id": 1342044, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/6d8075ca98978d351f4330ea0dbb9ec0?s=128&d=identicon&r=PG", "display_name": "soulemane moumie", "link": "https://stackoverflow.com/users/1342044/soulemane-moumie"}, "edited": false, "score": 0, "creation_date": 1443685527, "post_id": 32747256, "comment_id": 53594637, "body": "Please just a rectification in my previous comment:"}, {"owner": {"reputation": 809, "user_id": 1342044, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/6d8075ca98978d351f4330ea0dbb9ec0?s=128&d=identicon&r=PG", "display_name": "soulemane moumie", "link": "https://stackoverflow.com/users/1342044/soulemane-moumie"}, "edited": false, "score": 0, "creation_date": 1443685613, "post_id": 32747256, "comment_id": 53594689, "body": "13 characters x N columns x 6 times per minutes x 60 min X 24 hours = n bytes per day"}, {"owner": {"reputation": 809, "user_id": 1342044, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/6d8075ca98978d351f4330ea0dbb9ec0?s=128&d=identicon&r=PG", "display_name": "soulemane moumie", "link": "https://stackoverflow.com/users/1342044/soulemane-moumie"}, "edited": false, "score": 0, "creation_date": 1443685664, "post_id": 32747256, "comment_id": 53594719, "body": "as every 10 seconds is equivalent to 6 times per minute"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1485305452, "post_id": 32747256, "comment_id": 70868298, "body": "I think you&#39;re off by a factor of 10 or so. There are 86400 seconds per day, so roughly 10k measurements per day. There are roughly 4k days in 10 years. And there are roughly 10 bytes per record (partly compensates for over-estimates on the other two numbers). 10k x 4k * 10 = 400M rather than just 40M. The third and fourth digits in the estimate are spurious; so probably is any second digit. One of the comments says &#39;4 bytes per record&#39;; that may be correct for the value, but there&#39;s probably coordinate information too. Measurements, as suggested by the other answer, would help calibrate this."}], "tags": [], "owner": {"reputation": 2670, "user_id": 346104, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/31duc.jpg?s=128&g=1", "display_name": "franji1", "link": "https://stackoverflow.com/users/346104/franji1"}, "is_accepted": false, "score": 1, "last_activity_date": 1443621679, "last_edit_date": 1443621679, "creation_date": 1443034182, "answer_id": 32747256, "question_id": 32739383, "link": "https://stackoverflow.com/questions/32739383/estimation-of-the-data-logging-size/32747256#32747256", "title": "Estimation of the Data logging size", "body": "<p>Assuming worst case 2's complement 32-bit ASCII...\n-2147483648 is 13 characters per value</p>\n\n<ul>\n<li>1 value / 10 seconds</li>\n</ul>\n\n<p>3600 seconds / hour</p>\n\n<p>24 hours /day</p>\n\n<p>that's 112,320 bytes per day, per number of values N,</p>\n\n<p>\"round\" that off to <strong>112,640 bytes</strong> (divisible by 1024) <strong>per day</strong></p>\n\n<p>365.25 days per year</p>\n\n<p>10 years</p>\n\n<p>that's <strong>N * 411,417,600</strong> or slightly more than <strong>N * 4Mbytes</strong></p>\n\n<p>So if <strong>N was 10</strong>, that would be slightly more than <strong>41MBytes.</strong></p>\n"}], "owner": {"reputation": 809, "user_id": 1342044, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/6d8075ca98978d351f4330ea0dbb9ec0?s=128&d=identicon&r=PG", "display_name": "soulemane moumie", "link": "https://stackoverflow.com/users/1342044/soulemane-moumie"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "closed_date": 1485332004, "answer_count": 2, "score": -1, "last_activity_date": 1443621679, "creation_date": 1443010634, "last_edit_date": 1443012082, "question_id": 32739383, "link": "https://stackoverflow.com/questions/32739383/estimation-of-the-data-logging-size", "closed_reason": "Needs more focus", "title": "Estimation of the Data logging size", "body": "<p>I have a device generating some values say N, each value having 32 bit.\nI am logging these values every 10 seconds by writing a new row in an excel file. I will be creating a new file every day.\nI have to estimate the hard disk storage capacity necessary to store these log files for a period of 10 years.\nCan someone give any hints regarding the calculation of the size of log file generated per day ?</p>\n"}, {"tags": ["c"], "answers": [{"tags": [], "owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "is_accepted": true, "score": 2, "last_activity_date": 1443025409, "last_edit_date": 1443025409, "creation_date": 1443025089, "answer_id": 32744656, "question_id": 32739380, "link": "https://stackoverflow.com/questions/32739380/wrong-value-while-calculating-power-in-a-loop/32744656#32744656", "title": "wrong value while calculating power in a loop", "body": "<p>You are mixing floating point and integer arithmetic and suffering from rounding problems as a result. There is no need to call <code>pow</code>, which is a floating point library function, and overkill for this assignment. A simpler implementation using just integer arithmetic would be:</p>\n\n<pre><code>int repsEqual(int a[], int len, int n)\n{\n    int temp = 0;\n\n    for (int i = 0; i &lt; len; i++)\n    {\n        temp = temp * 10 + a[i];\n    }\n\n    return (temp == n);\n}\n</code></pre>\n\n<p><kbd><a href=\"http://ideone.com/H8llzj\" rel=\"nofollow\">LIVE DEMO</a></kbd></p>\n"}], "owner": {"reputation": 371, "user_id": 2416552, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cSQvu.jpg?s=128&g=1", "display_name": "Bijesh Shrestha", "link": "https://stackoverflow.com/users/2416552/bijesh-shrestha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 32744656, "answer_count": 1, "score": 0, "last_activity_date": 1443025409, "creation_date": 1443010624, "last_edit_date": 1443015457, "question_id": 32739380, "link": "https://stackoverflow.com/questions/32739380/wrong-value-while-calculating-power-in-a-loop", "title": "wrong value while calculating power in a loop", "body": "<p>I have problem in calculating a power of an integer in a C language.</p>\n\n<p>I have to convert an array value to an equivalent integer i.e {5,3,0,5,3} to 53053</p>\n\n<p>I have the following code</p>\n\n<pre><code>int repsEqual(int a[], int len, int n)\n{\n    int temp = 0;\n    int i = 0;\n\n    for(i; i &lt; len;i++)\n    {\n        temp =   temp + a[i] * pow(10, (len - (i+1)));\n    }\n\n   if(temp == n) {\n       return 1;\n   }\n   else {\n       return 0;\n   }\n}\n</code></pre>\n\n<p>It always return 0. Since the power is wrongly outputted. {5,3,0,5,3} returns 53052.</p>\n\n<p>Please help me guys</p>\n"}, {"tags": ["c", "linker", "arduino", "avr-gcc", "atmega"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1443009851, "post_id": 32738987, "comment_id": 53318703, "body": "<code>.data</code> shall not go to Flash, but to RAM. And, no, you cannot just add external RAM without massive changes to your code. Did you forget making some variables <code>const</code>? <code>__clz_tab</code> sounds like that."}, {"owner": {"reputation": 1728, "user_id": 1215872, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/WNpG4.jpg?s=128&g=1", "display_name": "Gordon Williams", "link": "https://stackoverflow.com/users/1215872/gordon-williams"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1443010060, "post_id": 32738987, "comment_id": 53318836, "body": "Yes, I know <code>.data</code> goes to RAM (my last question). However the problem is why .data starts with 11758 bytes (00802fee - 00800200) that don&#39;t seem to have any symbols to go with them."}, {"owner": {"reputation": 1728, "user_id": 1215872, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/WNpG4.jpg?s=128&g=1", "display_name": "Gordon Williams", "link": "https://stackoverflow.com/users/1215872/gordon-williams"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1443010425, "post_id": 32738987, "comment_id": 53319087, "body": "It was a typo, which I just fixed. ATMEGA2560 has 256kB Flash, 8kB RAM. <code>.data</code> is too big for the RAM because it has 11758 unused bytes in it."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1443010534, "post_id": 32738987, "comment_id": 53319178, "body": "Check your map file."}, {"owner": {"reputation": 1728, "user_id": 1215872, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/WNpG4.jpg?s=128&g=1", "display_name": "Gordon Williams", "link": "https://stackoverflow.com/users/1215872/gordon-williams"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1443011328, "post_id": 32738987, "comment_id": 53319753, "body": "Thanks - just did, and it&#39;s showing that each object file is using a bit of RAM in that area... But what for? There don&#39;t seem to be any symbols defined (at least that I can see)"}, {"owner": {"reputation": 1728, "user_id": 1215872, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/WNpG4.jpg?s=128&g=1", "display_name": "Gordon Williams", "link": "https://stackoverflow.com/users/1215872/gordon-williams"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1443011559, "post_id": 32738987, "comment_id": 53319920, "body": "Ok, it looks like it could be strings that are using up the RAM. They are un-named and so presumably don&#39;t get shown as symbols. But how do I get those put in flash? Defining <i>every string</i> as a variable with PROGMEM just isn&#39;t going to cut it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1443012236, "post_id": 32738987, "comment_id": 53320417, "body": "@GordonWilliams depends on the code ... I did the following for debugging output (when simulating in <code>simavr</code>): <a href=\"https://github.com/Zirias/shuttercontrol/blob/master/shutterctl_attiny84/debug.h\" rel=\"nofollow noreferrer\">github.com/Zirias/shuttercontrol/blob/master/&hellip;</a> -- so in general, use <code>PSTR()</code> with literal constant strings"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1443012665, "post_id": 32738987, "comment_id": 53320754, "body": "normally, gcc packs string literals into <code>.rodata</code> section and for von-Neumann Architectures, this is placed into read-only memory (Program Flash, if available). (One of the) problems with AVR is that this is Harvard Architecture and needs special code to access data in program memory, so you likely have to tag specially as <code>PROGMEM</code> seems to imply (until now, I could avoid to use such MCUs)."}, {"owner": {"reputation": 1728, "user_id": 1215872, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/WNpG4.jpg?s=128&g=1", "display_name": "Gordon Williams", "link": "https://stackoverflow.com/users/1215872/gordon-williams"}, "edited": false, "score": 0, "creation_date": 1443013351, "post_id": 32738987, "comment_id": 53321283, "body": "Thanks for your help - it looks like surrounding strings with PSTR removes that file&#39;s footprint in <code>.data</code>, so that&#39;s it. Wow, that&#39;s horrible. Such a shame there isn&#39;t a <code>-fput-consts-in-flash-yes-i-know-its-not-a-good-idea</code> flag in gcc."}, {"owner": {"reputation": 1728, "user_id": 1215872, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/WNpG4.jpg?s=128&g=1", "display_name": "Gordon Williams", "link": "https://stackoverflow.com/users/1215872/gordon-williams"}, "edited": false, "score": 0, "creation_date": 1443014368, "post_id": 32738987, "comment_id": 53322147, "body": "Does someone want to post an answer to this, given it was anonymous strings/constants?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1443021276, "post_id": 32738987, "comment_id": 53327503, "body": "@GordonWilliams It must be done that way because you can&#39;t use &quot;normal&quot; string functions on data in program memory, they would try to access data memory. As @Olaf pointed out, on a Harvard architecture, there are different address spaces for program and data, and as C is designed with a von-Neumann architecture in mind with only one unified address space, a <code>char *</code> (or any pointer to data) in avr-gcc defaults to data address space."}, {"owner": {"reputation": 1728, "user_id": 1215872, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/WNpG4.jpg?s=128&g=1", "display_name": "Gordon Williams", "link": "https://stackoverflow.com/users/1215872/gordon-williams"}, "edited": false, "score": 0, "creation_date": 1443023833, "post_id": 32738987, "comment_id": 53329258, "body": "Thanks - just accepted the answer. I guess it&#39;d be possible to fake a flat address space by getting the compiler to convert all memory reads to <code>(p&amp;0x80000000)?flash[p]:ram[p]</code> and to then optimise out for all the addresses it knows. It&#39;s a bit of a big ask though, and very nonoptimal in many cases :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1443027712, "post_id": 32738987, "comment_id": 53331556, "body": "@GordonWilliams that&#39;s only possible if a) all accesses are in the same compilation unit and b) a function is always only called with <i>one</i> type of address. Otherwise you can&#39;t know which type of address is accessed at compile time."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1443034414, "post_id": 32738987, "comment_id": 53335278, "body": "@GordonWilliams: As I wrote, this is actually a matter of the linker control file, not gcc. gcc <i>*does</i> privide all information required by the linker. problem is the AVR needs different (and much slower) code to acces such data. How should gcc know which <code>const</code> variables and literals to pack where? So you have to tell it, which apparently <code>PSTR</code> is for. Use a von-Neumann Architecture (S08/11/12, MSP430, ARM, etc.) and it works without manual intervention - provided the linker control file is correct."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1443034518, "post_id": 32738987, "comment_id": 53335351, "body": "&quot;I guess it&#39;d be possible ...&quot; Yes, it would be possible. And render the code practially useless for any application on the architecture except for trivial stuff like tunring on an LED on a button press. Or it would make the linker become the actual compiler (perhaps with LTO), as much as @FelixPalmen wrote."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1443074782, "post_id": 32738987, "comment_id": 53348782, "body": "@Olaf just want to add the Harvard architecture is a good pick for the <code>avr</code> because with the two independent buses, the CPU can execute an instruction (that typically operates on data over one bus) while fetching the next one over the other bus, giving better performance here. The problem only arises with a language that&#39;s not aware of such an architecture :)"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1443090634, "post_id": 32738987, "comment_id": 53357237, "body": "@FelixPalmen: The AVR architecture is a legacy like PIC (except PIC32 which is MIPS). All modern 32/64 bit architectures are actually a mixture of both concepts. They are von-Neumann from the instruction set, but Harvard in the CPU and various external busses (e.g. ARM-Cortex-M0+/3/4/7). For small MCUs, there are also better ways, which do not cost much more Silicon. Even less, as the AVR/PIC require additional logic for cross-accesses from internal data bus to Flash for self-programming and read-only data. Only benefit is program can reside in a full 16 (i.e. 2 octets) bit address space."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1443093824, "post_id": 32738987, "comment_id": 53359182, "body": "@Olaf, talking about these things, somehow &quot;modified&quot; harvard architectures are predominant everywhere, the question is just at which level the modifications kick in. I&#39;m working with a very small and limited <code>avr</code> chip and for that, it feels quite natural, being a simple architecture giving the speed benefit of harvard in normal use. But continuing that, one might get into general hardware design discussions. The question just illustrates the backdraw in the programming model when using a language like C."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1443094239, "post_id": 32738987, "comment_id": 53359452, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/90516/discussion-between-olaf-and-felix-palmen\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": true, "score": 2, "last_activity_date": 1443023293, "last_edit_date": 1592644375, "creation_date": 1443023293, "answer_id": 32744054, "question_id": 32738987, "link": "https://stackoverflow.com/questions/32738987/avr-gcc-arduino-atmega2560-using-far-too-much-ram/32744054#32744054", "title": "avr-gcc Arduino atmega2560 using far too much RAM", "body": "<p>Well, OP already found out (with the help of Olaf's comments concerning where to start looking) what was actually taking up the space, but indeed, there should be an answer, so trying to summarize here:</p>\n<ol>\n<li><p>The space in the data segment is also occupied by anonymous data (<em>literals</em> in code), especially <em>string literals</em>.</p>\n</li>\n<li><p>The tricky thing here is: <code>avr</code> is a <em>Harvard architecture</em> which means there are different/independent address spaces for code and data, contrary to the widespread <em>von Neumann architecture</em> with only one unified address space. <a href=\"/questions/tagged/c\" class=\"post-tag\" title=\"show questions tagged &#39;c&#39;\" rel=\"tag\">c</a> was designed for the latter, so it's only possible to handle one address space. On <code>avr</code> chips, the data address space is backed by <em>RAM</em>, the code address space by <em>flash memory</em>.</p>\n<p>Now, if running low on RAM, it would be sensible to place <em>read only</em> data in flash, too, but there's a catch: Given a function taking a <code>char *</code>, the compiler will translate this function assuming the pointer is meant to point to data address space and emit assembly fetching from there. Therefore, another similar function is needed that looks in code address space instead.</p>\n</li>\n<li><p>The solution in <code>avr-gcc</code> and <code>avr-libc</code> to this problem is to provide the <code>PROGMEM</code> qualifier, so the compiler knows data qualified this way should live in program memory (code address space). There's also a convenience macro <code>PSTR()</code> to make string literals live in program memory without the need to introduce another <code>PROGMEM</code>-qualified identifier. To work with these, <code>avr-libc</code> has a few standard functions postfixed <code>_P</code> (like, e.g., <code>puts_P()</code>) that do exactly the same, but expect their arguments in program memory. It's a bit of a hassle to use it that way, but it's just impossible to handle this transparently without <a href=\"/questions/tagged/c\" class=\"post-tag\" title=\"show questions tagged &#39;c&#39;\" rel=\"tag\">c</a> knowing about different address spaces.</p>\n</li>\n</ol>\n<p>As RAM is often quite small on <code>avr</code> chips, there are a few other things you can do to conserve it, like e.g. not using a heap at all (in many embedded programs, you don't really need dynamic allocation, just think about it), using bitfields where appropriate, have the compiler &quot;pack&quot; all structs (<code>-fpack-struct</code> option), always use the smallest possible size for enums (<code>-fshort-enums</code> option), always use <code>uint8_t</code> for small integers, use bitfields (or encode state with bit masking/shifting) where appropriate, and so on.</p>\n"}], "owner": {"reputation": 1728, "user_id": 1215872, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/WNpG4.jpg?s=128&g=1", "display_name": "Gordon Williams", "link": "https://stackoverflow.com/users/1215872/gordon-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 538, "favorite_count": 0, "accepted_answer_id": 32744054, "answer_count": 1, "score": 1, "last_activity_date": 1443024018, "creation_date": 1443009486, "last_edit_date": 1443024018, "question_id": 32738987, "link": "https://stackoverflow.com/questions/32738987/avr-gcc-arduino-atmega2560-using-far-too-much-ram", "title": "avr-gcc Arduino atmega2560 using far too much RAM", "body": "<p>I'm currently trying to compile some code to work on AVR (ATMEGA2560) and it looks like I'm running out of RAM.</p>\n\n<p>I looked at the listing (generated with <code>avr-objdump -x -S project.elf</code>) and I'm finding that <code>.data</code> is way too big to go into the 8kb RAM (it's around 12k) - in fact the 'real' RAM contents start at 0x802FEE which is in the address space for 'external RAM'.</p>\n\n<p>I see:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Sections:\nIdx Name          Size      VMA       LMA       File off  Algn\n  0 .data         00003088  00800200  0002297a  00022a0e  2**0\n                  CONTENTS, ALLOC, LOAD, DATA\n  1 .text         0002297a  00000000  00000000  00000094  2**1\n                  CONTENTS, ALLOC, LOAD, READONLY, CODE\n  2 .bss          00000755  00803288  00803288  00025a98  2**2\n                  ALLOC\n  3 .stab         00001a7c  00000000  00000000  00025a98  2**2\n                  CONTENTS, READONLY, DEBUGGING\n  4 .stabstr      00000d4d  00000000  00000000  00027514  2**0\n                  CONTENTS, READONLY, DEBUGGING\n</code></pre>\n\n<p>I then grepped for <code>.data</code> symbols and sorted based on address:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>grep \"\\.data\" project.lst | sort\n00800200 g       .data  00000000 __data_start\n00800200 l    d  .data  00000000 .data\n00802fee g     O .data  00000008 __thenan_sf\n00802ff6 g     O .data  00000100 __clz_tab\n008030f6 l     O .data  00000004 next\n... lots of stuff in here ....\n00803267 l     O .data  00000010 CSWTCH.18\n00803277  w    O .data  00000010 _ZTV14HardwareSerial\n00803288 g       .data  00000000 __data_end\n00803288 g       .data  00000000 _edata\n</code></pre>\n\n<p>So <code>.data</code> is supposed to start at 0x800200, but for some reason the first symbol is at <code>00802fee</code> - which is well out of the address range.</p>\n\n<p>I tried <code>-Wl,--section-start,.data=0x800000,--defsym=__heap_end=0x8021FF</code> but this only moves things back by <code>0x200</code> as expected - there's still something at the start of <code>.data</code> that is pushing everything out.</p>\n\n<p>Does anyone know what this is, or why it's happening? It's annoying because everything should fit in if it weren't for that.</p>\n"}, {"tags": ["c", "networking", "struct"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1443009595, "post_id": 32738958, "comment_id": 53318548, "body": "The compiler tells you the answer."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1443011650, "post_id": 32738958, "comment_id": 53319985, "body": "Show the exact compilation command."}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 3989087, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hInI8.jpg?s=128&g=1", "display_name": "appleJuice", "link": "https://stackoverflow.com/users/3989087/applejuice"}, "edited": false, "score": 0, "creation_date": 1443010031, "post_id": 32738992, "comment_id": 53318814, "body": "According to your suggestion, i try to remove the struct lines. However, i met the compile error like this.. &quot;echoClient.c:(.text+0xe5): undefined reference to `clock_gettime&#39; &quot;"}], "tags": [], "owner": {"reputation": 21474, "user_id": 718379, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4810c6c963334e5dce573e6671d746ec?s=128&d=identicon&r=PG", "display_name": "timrau", "link": "https://stackoverflow.com/users/718379/timrau"}, "is_accepted": false, "score": 1, "last_activity_date": 1443009522, "creation_date": 1443009522, "answer_id": 32738992, "question_id": 32738958, "link": "https://stackoverflow.com/questions/32738958/error-redefinition-of-struct-timespec/32738992#32738992", "title": "error: redefinition of &#39;struct timespec&#39;", "body": "<p><code>struct timespec</code> is defined in <code>time.h</code>. Don't define your own again.</p>\n\n<p>You should remove the <code>typedef struct timespec { ... };</code> part in <code>echoClient.c</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 97, "user_id": 3989087, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hInI8.jpg?s=128&g=1", "display_name": "appleJuice", "link": "https://stackoverflow.com/users/3989087/applejuice"}, "edited": false, "score": 0, "creation_date": 1443010087, "post_id": 32739015, "comment_id": 53318849, "body": "First of all thank you for your reply. According to your suggestion, i try to remove the struct lines. However, i met the compile error like this.. &quot;echoClient.c:(.text+0xe5): undefined reference to `clock_gettime&#39; &quot;"}], "tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": true, "score": 2, "last_activity_date": 1443011442, "last_edit_date": 1443011442, "creation_date": 1443009595, "answer_id": 32739015, "question_id": 32738958, "link": "https://stackoverflow.com/questions/32738958/error-redefinition-of-struct-timespec/32739015#32739015", "title": "error: redefinition of &#39;struct timespec&#39;", "body": "<p><code>timespec</code> is defined in the following way into <code>time.h</code></p>\n\n<pre><code>struct timespec\n  {\n    __time_t tv_sec;        /* Seconds.  */\n    __syscall_slong_t tv_nsec;  /* Nanoseconds.  */\n  };\n</code></pre>\n\n<p>Remove the struct definition in your code.</p>\n\n<p>Prototype at the top of your code must be removed, also</p>\n\n<pre><code>int clock_gettime(clockid_t clock_id, struct timespec *tp);\nint nanosleep(const struct timespec *req, struct timespec *rem);\n</code></pre>\n\n<p>Are already defined in time.h</p>\n\n<p>Last thing, definition of \n<code>timespec t1,t2,t3;</code>\nMust be\n<code>struct timespec t1,t2,t3;</code></p>\n\n<p><strong>EDIT</strong></p>\n\n<p>If you add <code>-Wall</code> option compiler gives you warning about unused variable: <code>temp</code>, <code>maxlen</code>, <code>t1</code> and <code>t2</code></p>\n"}, {"tags": [], "owner": {"reputation": 1731, "user_id": 1901896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77b2651b08f4279ec5a29169d6c40c3d?s=128&d=identicon&r=PG", "display_name": "Akash5288", "link": "https://stackoverflow.com/users/1901896/akash5288"}, "is_accepted": false, "score": 0, "last_activity_date": 1498636501, "creation_date": 1498636501, "answer_id": 44796693, "question_id": 32738958, "link": "https://stackoverflow.com/questions/32738958/error-redefinition-of-struct-timespec/44796693#44796693", "title": "error: redefinition of &#39;struct timespec&#39;", "body": "<p>I got the same error in Ecliepse Neon IDE and i resolved it by adding '-DHAVE_STRUCT_TIMESPEC' in C/C++ Build -> Settings -> GCC C++ Compiler -> Miscellaneous -> Others flag</p>\n\n<p><a href=\"https://github.com/ghostlander/nsgminer/issues/1\" rel=\"nofollow noreferrer\">https://github.com/ghostlander/nsgminer/issues/1</a></p>\n"}], "owner": {"reputation": 97, "user_id": 3989087, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hInI8.jpg?s=128&g=1", "display_name": "appleJuice", "link": "https://stackoverflow.com/users/3989087/applejuice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6207, "favorite_count": 0, "accepted_answer_id": 32739015, "answer_count": 3, "score": 0, "last_activity_date": 1498636501, "creation_date": 1443009398, "last_edit_date": 1443011518, "question_id": 32738958, "link": "https://stackoverflow.com/questions/32738958/error-redefinition-of-struct-timespec", "title": "error: redefinition of &#39;struct timespec&#39;", "body": "<p><strong>myheader.h</strong></p>\n\n<pre><code>#ifndef _MYHEAD_\n#define _MYHEAD_\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;netdb.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n#include &lt;arpa/inet.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;time.h&gt;\n\n#endif\n</code></pre>\n\n<p><strong>echoClient.c</strong></p>\n\n<pre><code>#include \"myheader.h\"\n\nint clock_gettime(clockid_t clock_id, struct timespec *tp);\nint nanosleep(const struct timespec *req, struct timespec *rem);\n\ntypedef struct timespec // error message line\n{\n    time_t tv_sec;\n    long tv_nsec;\n};\n\nint main(int argc, char* argv[])\n{\n    int s;\n    char* servName;\n    int servPort;\n    char* string;\n    char buf[256 + 1];\n    int len = 0;\n    int maxLen = sizeof(buf);\n    struct sockaddr_in serverAddr;\n    timespec t1,t2,t3;\n    double practice;\n    int temp = 0;\n    int n;\n\n\n\n    if(argc != 4)\n    {\n            printf(\"Usage: client &lt;server&gt; &lt;port&gt; &lt;virtual packet size&gt; &lt;string&gt;\\n\");\n            exit(1);\n    }\n\n    servName = argv[1];\n    servPort = atoi(argv[2]);\n\n    string = argv[3];\n\n    memset(&amp;buf, 0, sizeof(buf));\n\n    /* Create remote (server) socket address */\n    memset(&amp;serverAddr, 0, sizeof(serverAddr));\n    serverAddr.sin_family = AF_INET;\n    inet_pton(AF_INET, servName, &amp;serverAddr.sin_addr);     // server IP addr\n    serverAddr.sin_port = htons(servPort);\n\n    practice = clock_gettime(CLOCK_REALTIME,&amp;t3);\n    printf(\"time %f\\n\",practice);\n\n    /* Creat socket */\n    if((s = socket(AF_INET, SOCK_DGRAM, 0)) &lt; 0)\n    {\n            perror(\"Error: socket creation failed\\n\");\n            exit(1);\n    }\n\n    // send the echo message\n    n = sendto(s, string, strlen(string), 0,\n            (struct sockaddr *)&amp;serverAddr, sizeof(serverAddr));\n    printf(\"-- actual tx frame size:  (%d bytes)\\n\",n);\n\n    /* here, the message has been sent, and the echo will come */\n\n    /* receive Echo */\n    memset(&amp;buf, 0, sizeof(buf));\n    len = recvfrom(s, buf, sizeof(buf), 0, NULL, NULL);\n    buf[len] = '\\0';\n\n    printf(\"Echoed string received: \");\n    printf(\"%s\\n\", buf);\n\n    close(s);\n    exit(0);\n}\n</code></pre>\n\n<p>As you can see the topic, </p>\n\n<blockquote>\n  <p>\"error:redefinition of 'struct timespec' </p>\n</blockquote>\n\n<p>have been happened when i try to compile. </p>\n\n<blockquote>\n  <p>/usr/include/time.h:122: error: previous definition of 'struct timespec' </p>\n</blockquote>\n\n<p>have been also happened. How can i modify this code. </p>\n\n<p>Please help me.</p>\n"}, {"tags": ["c", "matlab"], "answers": [{"comments": [{"owner": {"reputation": 901, "user_id": 1769024, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/ZzYmN.jpg?s=128&g=1", "display_name": "Wauzl", "link": "https://stackoverflow.com/users/1769024/wauzl"}, "reply_to_user": {"reputation": 63, "user_id": 5152862, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3d35f49ecc84e3d54290bfa1248120bf?s=128&d=identicon&r=PG&f=1", "display_name": "Sinem", "link": "https://stackoverflow.com/users/5152862/sinem"}, "edited": false, "score": 0, "creation_date": 1443015124, "post_id": 32738952, "comment_id": 53322764, "body": "I edited my answer. My bad for not seeing this immediately :)"}], "tags": [], "owner": {"reputation": 901, "user_id": 1769024, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/ZzYmN.jpg?s=128&g=1", "display_name": "Wauzl", "link": "https://stackoverflow.com/users/1769024/wauzl"}, "is_accepted": true, "score": 1, "last_activity_date": 1443015101, "last_edit_date": 1443015101, "creation_date": 1443009370, "answer_id": 32738952, "question_id": 32738836, "link": "https://stackoverflow.com/questions/32738836/cholesky-factorization-function-from-matlab-to-c/32738952#32738952", "title": "Cholesky factorization function from Matlab to C", "body": "<p>Check the lines</p>\n\n<pre><code>sum+=L[i*n+j]*L[j*n+i];\n</code></pre>\n\n<p>and</p>\n\n<pre><code>sum+=L[i*n+k]*L[k*n+j];\n</code></pre>\n\n<p>I think this should be</p>\n\n<pre><code>sum+=L[i*n+j]*L[i*n+j];\n</code></pre>\n\n<p>and</p>\n\n<pre><code>sum+=L[i*n+k]*L[j*n+k];\n</code></pre>\n\n<p>respectively. The transpose in the Matlab code just changes the direction of the vector, but does not switch around the arguments or something.</p>\n\n<p>I advise you to make a function that calculates the dot products, so you can reuse code.</p>\n"}, {"tags": [], "owner": {"reputation": 2025, "user_id": 1359137, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/1da62381332ae241f4a28acf7c2f5f52?s=128&d=identicon&r=PG", "display_name": "Animesh Kumar Paul", "link": "https://stackoverflow.com/users/1359137/animesh-kumar-paul"}, "is_accepted": false, "score": 1, "last_activity_date": 1443016065, "creation_date": 1443016065, "answer_id": 32741433, "question_id": 32738836, "link": "https://stackoverflow.com/questions/32738836/cholesky-factorization-function-from-matlab-to-c/32741433#32741433", "title": "Cholesky factorization function from Matlab to C", "body": "<p>See the Code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;    \n#include &lt;iostream&gt; \n#include &lt;math.h&gt;\nusing namespace std;\n\ndouble M[4][4]={5, 1.2, 0.3, -0.6, 1.2, 6, -0.4, 0.9, 0.3, -0.4, 8, 1.7, -0.6, 0.9, 1.7, 10};\nvector &lt;vector&lt;double&gt; &gt;L;\nint n=4;\ndouble calculateFunc1(int i){\ndouble temp =0;\nfor (int t = 0; t &lt; n; t ++)\n    temp += L[i][t]*L[i][t];\nreturn sqrt(M[i][i] - temp);\n}\n\ndouble calculateFunc2(int i,int j){\ndouble temp =0;\nfor (int t = 0; t &lt; n; t ++)\n    temp += L[i][t]*L[j][t];\nreturn (M[j][i] - temp) / L[i][i];\n}\n\nint  main()\n{ \n vector &lt;double&gt;temp;\nfor (int i =0; i &lt; n; i ++){\n    for(int j =0; j &lt; n; j ++){\n        temp.push_back(0.0);\n    }\n    L.push_back(temp);\n    temp.clear();\n}\n\nfor(int i =0; i &lt; n; i ++){\n    L[i][i] = calculateFunc1(i);\n\n    for(int j= i +1 ; j &lt; n; j++){\n        L[j][i] = calculateFunc2(i,j);\n    }\n}\n\n\nfor (int i=0;i&lt;n;i++){\n\n    for (int j=0;j&lt;n;j++){\n        cout&lt;&lt; L[i][j]&lt;&lt;\" \";\n        }\n    cout &lt;&lt; \"\\n\";\n}\n return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 5152862, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3d35f49ecc84e3d54290bfa1248120bf?s=128&d=identicon&r=PG&f=1", "display_name": "Sinem", "link": "https://stackoverflow.com/users/5152862/sinem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 32738952, "answer_count": 2, "score": -1, "last_activity_date": 1443016065, "creation_date": 1443009047, "last_edit_date": 1443014290, "question_id": 32738836, "link": "https://stackoverflow.com/questions/32738836/cholesky-factorization-function-from-matlab-to-c", "title": "Cholesky factorization function from Matlab to C", "body": "<p>I tried to convert a Matlab loop performing cholesky factorization to C. I got correct results just for the first column. </p>\n\n<p>The Matlab code:</p>\n\n<pre><code>M = [5 1.2 0.3 -0.6; 1.2 6 -0.4 0.9; 0.3 -0.4 8 1.7; -0.6 0.9 1.7 10];\nn = length( M );\nL = zeros( n, n );\nfor i=1:n\n    L(i, i) = sqrt( M(i, i) - L(i, :)*L(i, :)' );\n\n    for j=(i + 1):n\n        L(j, i) = ( M(j, i) - L(i, :)*L(j, :)' )/L(i, i);\n    end\nend\n</code></pre>\n\n<p>My C code:</p>\n\n<pre><code>int  main()\n{\n\n    double M[4*4]={5, 1.2, 0.3, -0.6, 1.2, 6, -0.4, 0.9, 0.3, -0.4, 8, 1.7, -0.6, 0.9, 1.7, 10};\n    int n=4;\n    double L[4*4]={0};\n    double sum;\n    for (int i=0;i&lt;n;i++){\n        sum=0;\n        for (int j=0;j&lt;n;j++){\n            sum+=L[i*n+j]*L[j*n+i];\n            }\n    L[i*n+i]=sqrt(M[i*n+i]-sum);\n\n    for (int j=i+1;j&lt;n;j++){\n        sum=0;\n        for(int k=0;k&lt;n;k++){\n            sum+=L[i*n+k]*L[k*n+j];\n           }\n        L[j*n+i]=(M[j*n+i]-sum)/L[i*n+i];\n\n      }\n\n}\n return 0;\n\n}\n</code></pre>\n\n<p>The result in Matlab is:</p>\n\n<pre><code>L =\n\n    2.2361         0         0         0\n    0.5367    2.3900         0         0\n    0.1342   -0.1975    2.8183         0\n   -0.2683    0.4368    0.6466    3.0527\n</code></pre>\n\n<p>But in C the result is:</p>\n\n<pre><code>L_c =\n\n    2.2361         0         0         0\n    0.5367    2.4495         0         0\n    0.1342   -0.1633    2.8284         0\n   -0.2683    0.3674    0.6010    3.1623\n</code></pre>\n\n<p>Where is the error?</p>\n"}, {"tags": ["java", "c++", "c", "java-native-interface"], "comments": [{"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1443013431, "post_id": 32738404, "comment_id": 53321361, "body": "There are no &#39;out&#39; parameters in Java, and therefore none in JNI native methods either."}], "answers": [{"comments": [{"owner": {"reputation": 1689, "user_id": 5029589, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/lVcu7.jpg?s=128&g=1", "display_name": "arpit joshi", "link": "https://stackoverflow.com/users/5029589/arpit-joshi"}, "edited": false, "score": 0, "creation_date": 1443041367, "post_id": 32744510, "comment_id": 53339099, "body": "But this will only return an Integer,I want to return a)error_indication b)out parameter is interger valuer(percentage complete)"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 1689, "user_id": 5029589, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/lVcu7.jpg?s=128&g=1", "display_name": "arpit joshi", "link": "https://stackoverflow.com/users/5029589/arpit-joshi"}, "edited": false, "score": 0, "creation_date": 1443041809, "post_id": 32744510, "comment_id": 53339320, "body": "If you return <code>null</code> instead of an <code>Integer</code> <b>object</b>, that will be your error indication."}, {"owner": {"reputation": 1689, "user_id": 5029589, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/lVcu7.jpg?s=128&g=1", "display_name": "arpit joshi", "link": "https://stackoverflow.com/users/5029589/arpit-joshi"}, "edited": false, "score": 0, "creation_date": 1443041948, "post_id": 32744510, "comment_id": 53339383, "body": "No ,my percentage complete can be 70% with error indication as 0 and it can also be 100% with error_indication as 80% and it can also be 50% with error_indication as 1"}, {"owner": {"reputation": 18759, "user_id": 2226988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6fbec3a71b2e95e4a6e41478deb379?s=128&d=identicon&r=PG", "display_name": "Tom Blodget", "link": "https://stackoverflow.com/users/2226988/tom-blodget"}, "edited": false, "score": 1, "creation_date": 1443139199, "post_id": 32744510, "comment_id": 53384597, "body": "It smells like <a href=\"https://sourcemaking.com/refactoring/primitive-obsession\" rel=\"nofollow noreferrer\">Primitive Obsession</a>."}], "tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": false, "score": 0, "last_activity_date": 1443024595, "creation_date": 1443024595, "answer_id": 32744510, "question_id": 32738404, "link": "https://stackoverflow.com/questions/32738404/how-to-pass-out-parameter-in-jni/32744510#32744510", "title": "How to pass out parameter in JNI", "body": "<p>You have to return two things:</p>\n\n<ol>\n<li>Error indication.</li>\n<li>An integer value.</li>\n</ol>\n\n<p>Return an <code>Integer</code> object on success, <code>null</code> on failure.  Change</p>\n\n<pre><code>public native int get_status(String cookies,int percentage_complete);\n</code></pre>\n\n<p>to</p>\n\n<pre><code>public native Integer get_status(String cookies);\n</code></pre>\n\n<p>This will change your generated header file, and you'll have to make the corresponding changes to your C code.</p>\n"}], "owner": {"reputation": 1689, "user_id": 5029589, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/lVcu7.jpg?s=128&g=1", "display_name": "arpit joshi", "link": "https://stackoverflow.com/users/5029589/arpit-joshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1213, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1443024595, "creation_date": 1443007804, "last_edit_date": 1443012274, "question_id": 32738404, "link": "https://stackoverflow.com/questions/32738404/how-to-pass-out-parameter-in-jni", "title": "How to pass out parameter in JNI", "body": "<p>I have my below java code</p>\n\n<pre><code>public class JNIWrapper {\n\nstatic{\n\n\n\n\n    System.loadLibrary(\"JNIDemo\");\n}\n\npublic native String get_error_string(int error_code);\npublic native int  start(Param_s params);\npublic native int cancel(String cookies);\npublic native int get_file_name(String cookies,String fileName);\n\npublic native int get_status(String cookies,int percentage_complete);\n</code></pre>\n\n<p>}\nBelow is my generated .H file </p>\n\n<pre><code> /* DO NOT EDIT THIS FILE - it is machine generated */\n#include &lt;jni.h&gt;\n/* Header for class demo_JNIWrapper */\n\n#ifndef _Included_demo_JNIWrapper\n#define _Included_demo_JNIWrapper\n#ifdef __cplusplus\nextern \"C\" {\n#endif\n\nJNIEXPORT jstring JNICALL Java_demo_JNIWrapper_get_1error_1string\n  (JNIEnv *, jobject, jint);\n\n\nJNIEXPORT jint JNICALL Java_demo_JNIWrapper_1start\n  (JNIEnv *, jobject, jobject);\n\n\nJNIEXPORT jint JNICALL Java_demo_JNIWrapper_cancel\n  (JNIEnv *, jobject, jstring);\n\n\nJNIEXPORT jint JNICALL Java_demo_JNIWrapper_getfile_1name\n  (JNIEnv *, jobject, jstring, jstring);\n\n\nJNIEXPORT jint JNICALL Java_demo_JNIWrapper_get_1status\n  (JNIEnv *, jobject, jstring, jint);\n\n#ifdef __cplusplus\n}\n#endif\n#endif\n</code></pre>\n\n<p>Incase of lets say get_status ,i want to have the percentage_complete as the out parameter and it returns say 0,with this I will have in return both percentage_complete(As it's in out parameter ) a return value .</p>\n\n<p>Any help would be highly appreciated and would be really helpful</p>\n\n<p>NOTE:I cannot use struct for this ie:I can'y encapsulate both percentage_complete and return output in a struct and return that struct)</p>\n"}, {"tags": ["c", "sockets", "connection", "limit"], "comments": [{"owner": {"reputation": 11355, "user_id": 162634, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/tpqof.jpg?s=128&g=1", "display_name": "Victor Sorokin", "link": "https://stackoverflow.com/users/162634/victor-sorokin"}, "edited": false, "score": 6, "creation_date": 1443008056, "post_id": 32738095, "comment_id": 53317488, "body": "Every client needs port on it&#39;s host, and nr of ports can not exceed 65536. You&#39;ll need more than one host to reach 1M of simultaneous clients."}], "owner": {"reputation": 203, "user_id": 5303011, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/804435759668988/picture?type=large", "display_name": "\u0218tefan Stan", "link": "https://stackoverflow.com/users/5303011/%c8%98tefan-stan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1443008183, "creation_date": 1443006937, "last_edit_date": 1443008183, "question_id": 32738095, "link": "https://stackoverflow.com/questions/32738095/c-simultaneously-connect-1m-clients", "title": "C simultaneously connect 1M clients", "body": "<p>I am on a Red Hat 7 server and i want to make a C server to connect 1Million clients simultaneously. </p>\n\n<p><code>ulimit -n</code> output is 1000000</p>\n\n<pre><code>sudo vi /etc/security/limits.conf\n</code></pre>\n\n<p>contains at the end </p>\n\n<pre><code>*         hard    nofile      1000000\n*         soft    nofile      1000000\nroot      hard    nofile      1000000\nroot      soft    nofile      1000000\n</code></pre>\n\n<p><br></p>\n\n<pre><code>sudo vi /etc/sysctl.conf\n</code></pre>\n\n<p>contains at some point</p>\n\n<pre><code>fs.file-max = 90000000000000\n</code></pre>\n\n<p>when i <strong>don't run</strong> my C server the output of my<br></p>\n\n<pre><code>cat /proc/sys/fs/file-nr\n</code></pre>\n\n<p>is </p>\n\n<pre><code>5184    0   90000000000000\n</code></pre>\n\n<p>when i <strong>run</strong> my C server the output of my<br></p>\n\n<pre><code>cat /proc/sys/fs/file-nr\n</code></pre>\n\n<p>is </p>\n\n<pre><code>116537  0   90000000000000\n</code></pre>\n\n<p><br>\nI can connect around 55000 clients and because i run the server and the clients on the same machine it means 2 file descriptors foreach client, so... i have that number 116537. But why not more, when i raised every system limit i found about that has something to do with my problem?\n<br>\n<br>\nthat's the server</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;netdb.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;string.h&gt;\n\nint main( int argc, char *argv[] )\n{\n   int sockfd, newsockfd, portno, clilen;\n   char buffer[256];\n   struct sockaddr_in serv_addr, cli_addr;\n   int  n, pid;\n   int son=0;   \n\n   /* First call to socket() function */\n   sockfd = socket(AF_INET, SOCK_STREAM, 0);\n\n   if (sockfd &lt; 0)\n      {\n      perror(\"ERROR opening socket\");\n      exit(1);\n      }\n\n   /* Initialize socket structure */\n   bzero((char *) &amp;serv_addr, sizeof(serv_addr));\n   portno = 5001;\n\n   serv_addr.sin_family = AF_INET;\n   serv_addr.sin_addr.s_addr = INADDR_ANY;\n   serv_addr.sin_port = htons(portno);\n\n   /* Now bind the host address using bind() call.*/\n   if (bind(sockfd, (struct sockaddr *) &amp;serv_addr, sizeof(serv_addr)) &lt; 0)\n      {\n      perror(\"ERROR on binding\");\n      exit(1);\n      }\n\n   /* Now start listening for the clients, here\n *    * process will go in sleep mode and will wait\n *       * for the incoming connection\n *          */\n\n   listen(sockfd, SOMAXCONN);\n   clilen = sizeof(cli_addr);\n\n   while (1)\n   {\n      newsockfd = accept(sockfd, (struct sockaddr *) &amp;cli_addr, &amp;clilen);\n      if (newsockfd &lt; 0)\n         {\n         perror(\"ERROR on accept\");\n         exit(1);\n         }\n\n      son++; \n      if(son % 1000 == 0)     \n        printf(\"client nr %d connected with fd %d\\n\", son, newsockfd);\n\n   } /* end of while */\n}\n</code></pre>\n\n<p>that's the client</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;netdb.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;string.h&gt;\n\nint main(int argc, char *argv[])\n{\n   int sockfd, portno, n;\n   struct sockaddr_in serv_addr;\n   struct hostent *server;\n\n   char buffer[256];\n\n   if (argc &lt;3) {\n      fprintf(stderr,\"usage %s hostname port\\n\", argv[0]);\n      exit(0);\n   }\n   portno = atoi(argv[2]);\n   server = gethostbyname(argv[1]);\n\n   if (server == NULL) {\n      fprintf(stderr,\"ERROR, no such host\\n\");\n      exit(0);\n   }\n\n   bzero((char *) &amp;serv_addr, sizeof(serv_addr));\n   serv_addr.sin_family = AF_INET;\n   bcopy((char *)server-&gt;h_addr, (char *)&amp;serv_addr.sin_addr.s_addr, server-&gt;h_length);\n   serv_addr.sin_port = htons(portno);\n\n    int ionut; \n   for(ionut=0; ionut&lt;90000; ionut++) { \n     /* Create a socket point */\n     sockfd = socket(AF_INET, SOCK_STREAM, 0);\n     if(ionut % 1000 == 0) { \n       printf(\"connected 1000 sockets\\n\");   \n      // sleep(1);\n     }\n     if (sockfd &lt; 0)\n     {\n        perror(\"ERROR opening socket\");\n        exit(1);\n     }\n\n    /* Now connect to the server */\n     if (connect(sockfd, (struct sockaddr*)&amp;serv_addr, sizeof(serv_addr)) &lt; 0)\n     {\n        perror(\"ERROR connecting\");\n        exit(1);\n     }\n\n   }\n   return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "sockets", "wireshark"], "answers": [{"comments": [{"owner": {"reputation": 856, "user_id": 4881854, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ad097f53a73b499090fdadaf695470c9?s=128&d=identicon&r=PG&f=1", "display_name": "Ojs", "link": "https://stackoverflow.com/users/4881854/ojs"}, "edited": false, "score": 1, "creation_date": 1443007198, "post_id": 32738109, "comment_id": 53316867, "body": "Now wireshark gives me &quot;GET / HTTP/1.1 Continuation or non-HTTP traffic&quot;"}, {"owner": {"reputation": 856, "user_id": 4881854, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ad097f53a73b499090fdadaf695470c9?s=128&d=identicon&r=PG&f=1", "display_name": "Ojs", "link": "https://stackoverflow.com/users/4881854/ojs"}, "edited": false, "score": 0, "creation_date": 1443007457, "post_id": 32738109, "comment_id": 53317049, "body": "Oh I was using double \\r\\n in Host. My bad. Thanks :) Can you please answer first question?"}, {"owner": {"reputation": 165655, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 856, "user_id": 4881854, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ad097f53a73b499090fdadaf695470c9?s=128&d=identicon&r=PG&f=1", "display_name": "Ojs", "link": "https://stackoverflow.com/users/4881854/ojs"}, "edited": false, "score": 0, "creation_date": 1443028208, "post_id": 32738109, "comment_id": 53331828, "body": "@Ojs It&#39;s hard to understand how that&#39;s a question. Basically, I&#39;d just say you should read the HTTP specification and understand what each of those headers do."}], "tags": [], "owner": {"reputation": 165655, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": true, "score": 0, "last_activity_date": 1443006979, "creation_date": 1443006979, "answer_id": 32738109, "question_id": 32738030, "link": "https://stackoverflow.com/questions/32738030/c-sending-http-get-request-in-linux/32738109#32738109", "title": "C: Sending http get request in linux", "body": "<p>You have literal newlines inside your string! You need to close and re-open the quotes on each line. For example:</p>\n\n<pre><code>if(send(sockfd, \n \"GET / HTTP/1.1\\r\\n\"\n \"Host: localhost\\r\\n\"\n \"Connection: Keep-alive\\r\\n\"\n \"Cache-Control: max-age=0\\r\\n\"\n ...\n</code></pre>\n"}], "owner": {"reputation": 856, "user_id": 4881854, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ad097f53a73b499090fdadaf695470c9?s=128&d=identicon&r=PG&f=1", "display_name": "Ojs", "link": "https://stackoverflow.com/users/4881854/ojs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5903, "favorite_count": 0, "accepted_answer_id": 32738109, "answer_count": 1, "score": 2, "last_activity_date": 1443006979, "creation_date": 1443006722, "question_id": 32738030, "link": "https://stackoverflow.com/questions/32738030/c-sending-http-get-request-in-linux", "title": "C: Sending http get request in linux", "body": "<p>I'm trying to make a connection localhost on port 80 and send a simple http get request and simultaneously I run wireshark and look at the headers. Here is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt; \n#include &lt;sys/socket.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;string.h&gt;\n\n\nint main(int argc, char *argv[])\n{\n\n  int yes = 1;\n char buffer[1024];\n int newsockfd, portno, recv_length, sockfd;\n socklen_t clilen;\n struct sockaddr_in serv_addr, cli_addr;\n ssize_t number;\n if (sockfd &lt; 0) \n    error(\"ERROR opening socket\");\n bzero((char *) &amp;serv_addr, sizeof(serv_addr));\n\n\n  sockfd = socket(AF_INET, SOCK_STREAM, 0);\n\n serv_addr.sin_family = AF_INET;\n serv_addr.sin_addr.s_addr = 0;\n serv_addr.sin_port = htons(80);\n\n\n\n\n connect(sockfd,(struct sockaddr *) &amp;serv_addr,sizeof(serv_addr));\n\n\n if(send(sockfd, \n\n\n \"GET / HTTP/1.1\\r\\n\n Host: localhost\\r\\n\n Connection: Keep-alive\\r\\n\n Cache-Control: max-age=0\\r\\n\n Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,;q=0.8\\r\\n\n User-Agent: Mozilla/5.0 (X11; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/40.0.2214.91 Safari/537.36\\r\\n\n Accept-Encoding: gzip, deflate, sdch\\r\\n\n Accept-Language: en-US,en;q=0.8\\r\\n\\r\\n\", \n\n strlen(\"GET / HTTP/1.1\\r\\n\n Host: localhost\\r\\n\n Connection: Keep-alive\\r\\n\n Cache-Control: max-age=0\\r\\n\n Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,;q=0.8\\r\\n\n User-Agent: Mozilla/5.0 (X11; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/40.0.2214.91 Safari/537.36\\r\\n\n Accept-Encoding: gzip, deflate, sdch\\r\\n\n Accept-Language: en-US,en;q=0.8\\r\\n\\r\\n\"),\n\n 0) &gt; 0)\n\n {\n    printf(\"GET send from %d\\n\", sockfd);\n }\n else\n {\n    printf(\"Problem in send %s\\n\", strerror(errno));\n }\n</code></pre>\n\n<p>But when I compile it and run it gives me a lot of erros. <a href=\"http://postimg.org/image/qk3bk8an5/\" rel=\"nofollow\">here is the image of errros</a>. After this error I changed the send function to this<br> <strong>send(sockfd, \"GET / HTTP/1.1\\r\\n Host: localhost\\r\\n\\r\\n\", strlen(\"GET / HTTP/1.1\\r\\n Host: localhost\\r\\n\\r\\n\")</strong> <br>Compilation went ok but the wireshark shows me <em>HTTP/1.0 400 BAD REQUEST (text/html)</em> So I have few questions.<br>\n1)What is the difference between send functions that I've used? I mean does it really matter if I send <br> <strong>GET / HTTP/1.1\\r\\n Host: localhost\\r\\n\\r\\n</strong> <br>or <br><strong>GET / HTTP/1.1\\r\\n\n     Host: localhost\\r\\n\n     Connection: Keep-alive\\r\\n\n     Cache-Control: max-age=0\\r\\n\n     Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,;q=0.8\\r\\n\n     User-Agent: Mozilla/5.0 (X11; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/40.0.2214.91 Safari/537.36\\r\\n\n     Accept-Encoding: gzip, deflate, sdch\\r\\n\n     Accept-Language: en-US,en;q=0.8\\r\\n\\r\\n</strong><br>\n2)How to configure send function to make correct HTTP GET request?\n<br>Hope you can help. Thanks.</p>\n"}, {"tags": ["c", "unit-testing", "googletest"], "comments": [{"owner": {"reputation": 45838, "user_id": 1362568, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/EAFi0.jpg?s=128&g=1", "display_name": "Mike Kinghan", "link": "https://stackoverflow.com/users/1362568/mike-kinghan"}, "edited": false, "score": 0, "creation_date": 1443035251, "post_id": 32737598, "comment_id": 53335804, "body": "There is no portable way to do it. You&#39;ll need to say what OS you are working on."}, {"owner": {"reputation": 20507, "user_id": 1463922, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3878980c7836d9e36f3a9ac100ff36a8?s=128&d=identicon&r=PG", "display_name": "PiotrNycz", "link": "https://stackoverflow.com/users/1463922/piotrnycz"}, "edited": false, "score": 0, "creation_date": 1443126018, "post_id": 32737598, "comment_id": 53379410, "body": "This might help: <a href=\"http://stackoverflow.com/questions/11110300/how-to-capture-output-of-printf\" title=\"how to capture output of printf\">stackoverflow.com/questions/11110300/&hellip;</a>"}], "owner": {"reputation": 49, "user_id": 5367316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8279b0fa3a83d7289606a76c0bededc3?s=128&d=identicon&r=PG&f=1", "display_name": "ashish kumar", "link": "https://stackoverflow.com/users/5367316/ashish-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 542, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1443418099, "creation_date": 1443005424, "last_edit_date": 1443418099, "question_id": 32737598, "link": "https://stackoverflow.com/questions/32737598/suppress-output-from-library-file-in-google-test-framework", "title": "Suppress output from library file in google test framework", "body": "<p>I am wring the unit testcases to validate one C library function by using google test framework. \nSample code:</p>\n\n<pre><code>TEST_P(xyzTestCase, xyzfunc)\n{\n    int a = xyz(2);\n    .....\n    ......\n    EXPECT_GT(a, 1);\n}\n</code></pre>\n\n<p>library function xyz has some print statement, which I cannot remove. Whenever, I am running this test, it is printing those statement as expected. </p>\n\n<p>I have added below piece of code after the function call xyz():</p>\n\n<pre><code>char buff[100000]; \nmemset( buff, '\\0', sizeof(buff));\nsetvbuf(stdout, buff, _IOFBF, sizeof(buff)-1);\nfflush(stdout);  \n</code></pre>\n\n<p>After adding these code, output are getting suppressed, except for first run. This is parametrized test and running multiple times. First time, output is displaying after that output are getting suppressed.</p>\n\n<p>Can anyone please suggest me what is the reason for that? Why output are not suppressed first time?  Please suggest.</p>\n"}, {"tags": ["c", "sockets", "solaris-10"], "comments": [{"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1443005709, "post_id": 32737535, "comment_id": 53315890, "body": "On my Ubuntu 15.04i get the same error. i don&#39;t see this macro <a href=\"http://pubs.opengroup.org/onlinepubs/009695399/basedefs/sys/socket.h.html\" rel=\"nofollow noreferrer\">pubs.opengroup.org/onlinepubs/009695399/basedefs/sys/&hellip;</a>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1443006005, "post_id": 32737535, "comment_id": 53316093, "body": "&quot;what is different in solaris 10?&quot; Apparently the non-existence of this option (among many other things too much to tell here). What was your question?"}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1443006012, "post_id": 32737535, "comment_id": 53316100, "body": "I see that SO_STATE is present in <b>socketvar.h</b>"}, {"owner": {"reputation": 349, "user_id": 2459643, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f2a19c9ae6514a7489f9223c932cfdb7?s=128&d=identicon&r=PG", "display_name": "pankaj kushwaha", "link": "https://stackoverflow.com/users/2459643/pankaj-kushwaha"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1443015591, "post_id": 32737535, "comment_id": 53323130, "body": "@olaf: I just want to know that why this option is not available in solaris 10?"}], "owner": {"reputation": 349, "user_id": 2459643, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f2a19c9ae6514a7489f9223c932cfdb7?s=128&d=identicon&r=PG", "display_name": "pankaj kushwaha", "link": "https://stackoverflow.com/users/2459643/pankaj-kushwaha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 207, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1444066922, "creation_date": 1443005225, "last_edit_date": 1443006894, "question_id": 32737535, "link": "https://stackoverflow.com/questions/32737535/error-so-state-undeclared", "title": "error: &#39;SO_STATE&#39; undeclared", "body": "<p>There is a macro \"SO_STATE\" in socket.h , which not seems to present in solaris 10.</p>\n\n<p>consider following program:</p>\n\n<pre><code> #include &lt;stdio.h&gt;  \n #include &lt;unistd.h&gt;  \n #include &lt;stdlib.h&gt;  \n #include &lt;errno.h&gt;  \n #include &lt;string.h&gt;  \n #include &lt;sys/types.h&gt;  \n #include &lt;sys/socket.h&gt;  \n #include &lt;assert.h&gt;  \n\n/* \n * This function reports the error and \n * exits back to the shell: \n */  \n static void  \n displayError(const char *on_what) {  \n  if ( errno != 0 ) {  \n      fputs(strerror(errno),stderr);  \n      fputs(\": \",stderr);  \n  }  \n  fputs(on_what,stderr);  \n  fputc('\\n',stderr);  \n  exit(1);  \n }  \n\n int main(int argc,char **argv) {  \n  int z;  \n  int s = -1;       /* Socket */  \n  int sndbuf=0;     /* Send buffer size */  \n  int rcvbuf=0;     /* Receive buffer size */  \n  socklen_t optlen; /* Option length */  \n\n    /* \n  * Create a TDP/IP socket to use: \n  */  \n  s = socket(PF_INET,SOCK_STREAM,0);  \n  if ( s == -1 ) {  \n    displayError(\"socket(2)\");  \n  }  \n\n /* \n  * Get socket option SO_SNDBUF: \n  */  \n  optlen = sizeof sndbuf;  \n  z = getsockopt(s,  \n                 SOL_SOCKET,  \n                 SO_STATE,  \n                 &amp;sndbuf,&amp;optlen);  \n  if ( z ) {  \n    displayError(\"getsockopt(s,SOL_SOCKET,\"   \n                     \"SO_SNDBUF)\");  \n  }  \n\n  assert(optlen == sizeof sndbuf);  \n\n /* \n  * Get socket option SO_SNDBUF: \n  */  \n  optlen = sizeof rcvbuf;  \n  z = getsockopt(s,  \n                 SOL_SOCKET,  \n                 SO_RCVBUF,  \n                 &amp;rcvbuf,&amp;optlen);  \n  if ( z ) {  \n    displayError(\"getsockopt(s,SOL_SOCKET,\"  \n                 \"SO_RCVBUF)\");  \n  }  \n\n  assert(optlen == sizeof rcvbuf);  \n\n /* \n  * Report the buffer sizes: \n  */  \n  printf( \"Socket s : %d\\n\",s);  \n  printf( \"Send buf: %d bytes\\n\", sndbuf);  \n  printf( \"Recv buf: %d bytes\\n\", rcvbuf);  \n\n  close(s);  \n  return 0;  \n } \n</code></pre>\n\n<p>when I compile it in solaris 10 , I get following error:</p>\n\n<blockquote>\n  <p>sock.c: In function 'main': sock.c:47: error: 'SO_STATE' undeclared\n  (first use in this function) sock.c:47: error: (Each undeclared\n  identifier is reported only once sock.c:47: error: for each function\n  it appears in.)</p>\n</blockquote>\n\n<p>when I compile it in solaris 8 , Its compiling successfully.</p>\n\n<p>what is different in solaris 10?</p>\n\n<p>SO_STATE is present in socket.h in solaris 8 then why it is removed in solaris 10? following is from solaris 8.</p>\n\n<pre><code>cat /usr/include/sys/socket.h |grep SO_STATE\n#define SO_STATE        0x2000          /* Internal: get so_state */\n</code></pre>\n\n<p>while SO_STATE is not present in socket.h in solaris 10.</p>\n"}, {"tags": ["c", "macos", "unix"], "comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1443006445, "post_id": 32737312, "comment_id": 53316385, "body": "What is <code>BUF_SIZE</code>, please?"}, {"owner": {"reputation": 1841, "user_id": 2441080, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/970d820e4798029e9c18d7bcc97eebf8?s=128&d=identicon&r=PG", "display_name": "realUser404", "link": "https://stackoverflow.com/users/2441080/realuser404"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1443006542, "post_id": 32737312, "comment_id": 53316440, "body": "@alk I use 4096. I will edit my post."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1443007110, "post_id": 32737312, "comment_id": 53316810, "body": "Which UNIX/C-implementation are you using?"}, {"owner": {"reputation": 1841, "user_id": 2441080, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/970d820e4798029e9c18d7bcc97eebf8?s=128&d=identicon&r=PG", "display_name": "realUser404", "link": "https://stackoverflow.com/users/2441080/realuser404"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1443007916, "post_id": 32737312, "comment_id": 53317386, "body": "I am working on OS X/??. How to know the C-Implementation?"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1443008865, "post_id": 32737312, "comment_id": 53318090, "body": "C-implementation refers to the compiler and the libc used."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1443234037, "post_id": 32737312, "comment_id": 53424540, "body": "the function: <code>read()</code> can return a negative value when an error occurs.  The code will continue to loop under such conditions.   Strongly suggest using <code>fgets()</code> rather than <code>read()</code>."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1443235135, "post_id": 32737312, "comment_id": 53424739, "body": "when there is a I/O error on the call to read(), the the returned value is -1.  then the next line: <code>buf[ret] = &#39;\\0&#39;;</code> will corrupt the stack because the NUL character will be written outside the bounds to &#39;buf[]&#39;.  This is undefined behaviour and can lead to a seg fault event"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1443235234, "post_id": 32737312, "comment_id": 53424752, "body": "the example, where you enter nothing but a &#39;\\n&#39; (which is not a ctrl-D) is not correct. please edit that part of the question to show the actual output"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1443236559, "post_id": 32737312, "comment_id": 53424970, "body": "on linux, I ran the posted code (after supplying a main() and the unistd.h header) and it worked correctly. I entered: &quot;this is some text\\n&lt;ctrl-D&gt;&quot; (without the quotes) and it worked correctly"}, {"owner": {"reputation": 1841, "user_id": 2441080, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/970d820e4798029e9c18d7bcc97eebf8?s=128&d=identicon&r=PG", "display_name": "realUser404", "link": "https://stackoverflow.com/users/2441080/realuser404"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1443337978, "post_id": 32737312, "comment_id": 53447877, "body": "@user3629249 Did you take the time to read the post and understand the problem before spamming?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1443463210, "post_id": 32737312, "comment_id": 53493900, "body": "@realUser404,  ?spamming?  Certainly I read/understand the post.  I fully realize the OP was using a different OS.  I did not try to answer the question, I simply stated what I found using the linux OS.  Oh, and I also mentioned a couple of logic problems with the posted code."}], "answers": [{"tags": [], "owner": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "is_accepted": false, "score": 5, "last_activity_date": 1443008259, "last_edit_date": 1443008259, "creation_date": 1443007703, "answer_id": 32738364, "question_id": 32737312, "link": "https://stackoverflow.com/questions/32737312/eof-from-standard-input-is-displayed-in-standard-output/32738364#32738364", "title": "EOF from standard input is displayed in standard output", "body": "<p>I'm getting the same behaviour in OS X/Darwin.</p>\n\n<p>It looks like <code>^D</code> is being echoed to the console when you hit <kbd>Ctrl</kbd><kbd>D</kbd>, but without advancing the text cursor. As a result, the first <code>j</code> is being placed on top of the <code>^</code> character. (You can verify this by changing the first <code>write(1, \"j\", 1);</code> to <code>write(1, \"\\33[2Cj\", 5);</code>, which moves the cursor two places to the right before printing <code>j</code>.)</p>\n\n<p>I don't think there is any simple way to prevent <code>^D</code> from appearing, so you could just ignore it. The <code>D</code> isn't added to your input, so it won't cause any problems with the operation of your software.</p>\n\n<p>Alternatively, if you pipe the input to your program, then the problem will go away:</p>\n\n<pre><code>./myprog &lt;&lt;&lt;\"some text\"\n</code></pre>\n"}], "owner": {"reputation": 1841, "user_id": 2441080, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/970d820e4798029e9c18d7bcc97eebf8?s=128&d=identicon&r=PG", "display_name": "realUser404", "link": "https://stackoverflow.com/users/2441080/realuser404"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1443234689, "creation_date": 1443004565, "last_edit_date": 1443007286, "question_id": 32737312, "link": "https://stackoverflow.com/questions/32737312/eof-from-standard-input-is-displayed-in-standard-output", "title": "EOF from standard input is displayed in standard output", "body": "<p>I am doing a few tests with reading from standard input and writing in standard output, and something is really bothering me.</p>\n\n<p>When I try to write a single character followed by a \\n, the \"D\" from the <strong>EOF</strong> (I presume) is printing after the character.</p>\n\n<p>Here is what happens in the terminal : </p>\n\n<pre><code> &gt;./myprog\n sometext I enter\n \"Ctrl + D\"\n jD\n j\n &gt;\n</code></pre>\n\n<p>and here is the code : </p>\n\n<pre><code>#define BUF_SIZE 4096\n\nvoid    read_std_in()\n{\n    int     ret;\n    char    buf[BUF_SIZE + 1];\n\n    while ((ret = read(0, buf, BUF_SIZE)))\n    {\n        buf[ret] = '\\0';\n        // Concatenating buffer with some other string, not important here.\n    }\n    write(1, \"j\", 1);\n    write(1, \"\\n\", 1);\n    write(1, \"j\", 1);\n    write(1, \"\\n\", 1);\n}\n</code></pre>\n\n<p>As you can see, the first \"j\" gets a \"D\" from nowhere.</p>\n\n<p>If I try displaying more than 1 character for the forst line, the problem doesn't appear :</p>\n\n<pre><code> &gt;./myprog\n sometext I enter\n \"Ctrl + D\"\n jj\n j\n &gt;\n</code></pre>\n\n<p>And if I put no char (just \\n) I get :</p>\n\n<pre><code> &gt;./myprog\n sometext I enter\n \"Ctrl + D\"\n ^D\n j\n &gt;\n</code></pre>\n\n<p><strong>How can I avoid this behaviour?</strong></p>\n"}, {"tags": ["c#", "c"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1443004338, "post_id": 32737118, "comment_id": 53314943, "body": "I would start with a debugger to debug."}, {"owner": {"reputation": 11, "user_id": 5353822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae11e04c372be38a53f42642fbd0c494?s=128&d=identicon&r=PG&f=1", "display_name": "Rizwan Hasan", "link": "https://stackoverflow.com/users/5353822/rizwan-hasan"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1443005933, "post_id": 32737118, "comment_id": 53316046, "body": "it works fine in the debugger."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1443007455, "post_id": 32737118, "comment_id": 53317048, "body": "If you get errors without, it does <b>not</b> &quot;work fine in the debugger&quot;! It is just that you do not notice the problem. Think about the implications of <b>undefined</b> <i>behaviour</i>."}, {"owner": {"reputation": 11, "user_id": 5353822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae11e04c372be38a53f42642fbd0c494?s=128&d=identicon&r=PG&f=1", "display_name": "Rizwan Hasan", "link": "https://stackoverflow.com/users/5353822/rizwan-hasan"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1443014805, "post_id": 32737118, "comment_id": 53322487, "body": "It does not indicate any undefined behaviour, it just says critical error detected c0000374, exe has triggered a breakpoint.  first Chance exception at .... : a heap has been corrupted and carry on normal. I don&#39;t have code to API to debug which is causing this error."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1443014959, "post_id": 32737118, "comment_id": 53322616, "body": "Huh? First you wrote &quot;it works fine&quot;, now you wrte you get a critical error. And how would you <i>define</i> <b>undefined behaviour</b>?"}, {"owner": {"reputation": 11, "user_id": 5353822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae11e04c372be38a53f42642fbd0c494?s=128&d=identicon&r=PG&f=1", "display_name": "Rizwan Hasan", "link": "https://stackoverflow.com/users/5353822/rizwan-hasan"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1443183635, "post_id": 32737118, "comment_id": 53402491, "body": "This  happens when we run the app without debugger in VS or application verifier or gflag etc. If we run in debugger in VS with enable managed code debugging checked or in app verifier then it works fine. so i am kinda stuck how to debug this."}], "owner": {"reputation": 11, "user_id": 5353822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae11e04c372be38a53f42642fbd0c494?s=128&d=identicon&r=PG&f=1", "display_name": "Rizwan Hasan", "link": "https://stackoverflow.com/users/5353822/rizwan-hasan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1443004319, "creation_date": 1443004054, "last_edit_date": 1443004319, "question_id": 32737118, "link": "https://stackoverflow.com/questions/32737118/memory-corruption-error-in-production", "title": "Memory Corruption error in production", "body": "<p>I am using a third party c lib wrapped in a c# .net 4. When I run the application it crashes with memory corruption error.</p>\n\n<p>I don't get this error in debug or release build if \"Enable managed coding debugging is enabled\" in visual studio 2013.</p>\n\n<p>Also when do live debugging with application verifier and gflag it does not give me any error however when I take application of out of Image File Execution Options it crashes again. </p>\n\n<p>Any idea how can I debug or fix this issue.</p>\n"}, {"tags": ["c", "windows", "eof", "getchar"], "comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 2, "creation_date": 1443003221, "post_id": 32736593, "comment_id": 53314252, "body": "You forgot <code>#include &lt;stdio.h&gt;</code> in your code. Your question is probably operating system specific. On my Linux system CtrlZ is not related to EOF."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1443003789, "post_id": 32736593, "comment_id": 53314597, "body": "Try piping a file. Terminals behave sometimes strange due to line-buffering."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1443004054, "post_id": 32736593, "comment_id": 53314775, "body": "&quot;does not work&quot; is no <b>specific</b> problem description. Also &quot; the input ^z is saved as 26&quot; is not clear. Where is it saved? Which input?"}, {"owner": {"reputation": 13, "user_id": 5367126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c42d5ded5f0e51dc53e5ea4f85a5cac?s=128&d=identicon&r=PG&f=1", "display_name": "sebastian", "link": "https://stackoverflow.com/users/5367126/sebastian"}, "edited": false, "score": 0, "creation_date": 1443004300, "post_id": 32736593, "comment_id": 53314920, "body": "it is saved in the variable c, and does not work means it doesnt terminate the while loop, only when the input ^z is put in a new line it tearminates the loop"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1443005617, "post_id": 32736593, "comment_id": 53315823, "body": "You should rephrase the text in your question next time and just leave a comment that you updated. If that were not a dup, it would have been a good first question after the clarification."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5367126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c42d5ded5f0e51dc53e5ea4f85a5cac?s=128&d=identicon&r=PG&f=1", "display_name": "sebastian", "link": "https://stackoverflow.com/users/5367126/sebastian"}, "edited": false, "score": 0, "creation_date": 1443004133, "post_id": 32737030, "comment_id": 53314814, "body": "Yea is see the output W (btw im using windows)"}, {"owner": {"reputation": 136, "user_id": 5271669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd7f4e88f45eb03e169eaf411c65c190?s=128&d=identicon&r=PG&f=1", "display_name": "cyrobin", "link": "https://stackoverflow.com/users/5271669/cyrobin"}, "edited": false, "score": 0, "creation_date": 1443004399, "post_id": 32737030, "comment_id": 53314992, "body": "Well, after trying on windows, I get the same behaviour as yours."}, {"owner": {"reputation": 136, "user_id": 5271669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd7f4e88f45eb03e169eaf411c65c190?s=128&d=identicon&r=PG&f=1", "display_name": "cyrobin", "link": "https://stackoverflow.com/users/5271669/cyrobin"}, "edited": false, "score": 0, "creation_date": 1443004760, "post_id": 32737030, "comment_id": 53315247, "body": "Ok, actually it has been answer here: <a href=\"http://stackoverflow.com/questions/7373386/eof-in-windows-command-prompt-doesnt-terminate-input-stream\" title=\"eof in windows command prompt doesnt terminate input stream\">stackoverflow.com/questions/7373386/&hellip;</a>"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1443005428, "post_id": 32737030, "comment_id": 53315702, "body": "In Windows shell, ^Z does not suspend the program"}], "tags": [], "owner": {"reputation": 136, "user_id": 5271669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd7f4e88f45eb03e169eaf411c65c190?s=128&d=identicon&r=PG&f=1", "display_name": "cyrobin", "link": "https://stackoverflow.com/users/5271669/cyrobin"}, "is_accepted": false, "score": 0, "last_activity_date": 1443004885, "last_edit_date": 1495542145, "creation_date": 1443003833, "answer_id": 32737030, "question_id": 32736593, "link": "https://stackoverflow.com/questions/32736593/getchar-and-eof-c-programming/32737030#32737030", "title": "getchar and EOF C programming", "body": "<p>Maybe you're using it wrong, and the CTRL+z symbol is not send to the getchar() function (which would give an EOF) but to the system that runs you program (e.g. it will \"Stopped\" the program).</p>\n\n<p>Try</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\nint c;\nwhile ((c = getchar()) != EOF) {\n// while ((c = getchar()) != '.') {\n    putchar(c);\n    }\n    putchar('W');\n}\n</code></pre>\n\n<p>Do you see the ouput 'W' in any case ? (especially when using a new line ?) in my case, I get \"Stopped\" (on UNix system, <a href=\"https://en.wikipedia.org/wiki/Control-Z\" rel=\"nofollow noreferrer\">CTRL+Z is used to suspend a process</a>).</p>\n\n<p><a href=\"https://stackoverflow.com/questions/7373386/eof-in-windows-command-prompt-doesnt-terminate-input-stream\">On Windows system, the answer has already been given on SO</a>:</p>\n\n<blockquote>\n  <p>At the end of a line, hitting ^z (or ^d on linux) does not cause the\n  terminal driver to send EOF. It only makes it flush the buffer to your\n  process (with no \\n). </p>\n  \n  <p>Hitting ^z (or ^d on linux) at the start of a line is interpreted by\n  the terminal as \"I want to signal EOF\".</p>\n</blockquote>\n"}], "owner": {"reputation": 13, "user_id": 5367126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c42d5ded5f0e51dc53e5ea4f85a5cac?s=128&d=identicon&r=PG&f=1", "display_name": "sebastian", "link": "https://stackoverflow.com/users/5367126/sebastian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 353, "favorite_count": 0, "closed_date": 1443005457, "answer_count": 1, "score": -3, "last_activity_date": 1443005478, "creation_date": 1443002682, "last_edit_date": 1443005478, "question_id": 32736593, "link": "https://stackoverflow.com/questions/32736593/getchar-and-eof-c-programming", "closed_reason": "Duplicate", "title": "getchar and EOF C programming", "body": "<pre><code>#include &lt;stdio.h&gt;\nint main() {\nint c;\nwhile ((c = getchar()) != EOF) {\n    putchar(c);\n    }\n}\n</code></pre>\n\n<p>This works fine, when EOF ( ctrl + z) is in a new line, but when the input\nis :<br>blabla^z    <br>it does not work.\nWhen i debug the program it tells me that the input \"^z\"(^z = EOF) is saved as 26,<br>\nbut when the input ^z is in a new line it is saved as -1.\nWhy? <br>\nin case something is unclear:<br>\nit is saved in the variable c, and does not work means it doesnt terminate the while loop, only when the input ^z is put in a new line it tearminates the loop <br>\nim using windows</p>\n"}, {"tags": ["c", "encryption", "caesar-cipher"], "answers": [{"tags": [], "owner": {"reputation": 6009, "user_id": 3313438, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/Ks9C6.jpg?s=128&g=1", "display_name": "Ziezi", "link": "https://stackoverflow.com/users/3313438/ziezi"}, "is_accepted": false, "score": 1, "last_activity_date": 1443003413, "last_edit_date": 1443003413, "creation_date": 1443002978, "answer_id": 32736712, "question_id": 32736540, "link": "https://stackoverflow.com/questions/32736540/working-in-simple-cesar-cipher-in-c/32736712#32736712", "title": "Working in Simple Cesar Cipher in C", "body": "<p>Use modulo operation <code>%</code> to define the upper bound of the wanted interval and\nthen use addition <code>+</code> to define the lower bound:</p>\n\n<pre><code>int cesar_encrypted(int x)\n{ \n   // to wrap around 90  \n   int encrypted = (x - 65 +3) % (90 - 65);\n   // to start from 65, translate it adding 65  \n   encrypted +=65;\n   return encrypted;\n}\n</code></pre>\n\n<p>or in a single line:</p>\n\n<pre><code>int cesar_encrypted(int x){  \n   return  (x - 65 + 3) % (90 - 65)  + 65; // x in range [65,90]\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 0, "creation_date": 1443003866, "post_id": 32736826, "comment_id": 53314661, "body": "<code>90 - 65 = 25</code>. But it should be modulus 26, because there are 26 characters in alphabet. Anyway, that&#39;s enough clue for him to do his homework."}, {"owner": {"reputation": 117929, "user_id": 669586, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/wxf3D.png?s=128&g=1", "display_name": "Sulthan", "link": "https://stackoverflow.com/users/669586/sulthan"}, "edited": false, "score": 0, "creation_date": 1443004362, "post_id": 32736826, "comment_id": 53314964, "body": "I would use <code>&#39;A&#39;</code> instead of 65 and <code>&#39;Z&#39;</code> instead of 90. Also defining a constant <code>const int numCharacters = &#39;Z&#39; - &#39;A&#39; + 1</code> could simplify it a bit. Result: <code>return (x - &#39;A&#39; + shift) % numCharacters + &#39;A&#39;</code>."}], "tags": [], "owner": {"reputation": 11458, "user_id": 3435400, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/61726fe80facc93d76754f0226b49eb9?s=128&d=identicon&r=PG&f=1", "display_name": "alain", "link": "https://stackoverflow.com/users/3435400/alain"}, "is_accepted": true, "score": 4, "last_activity_date": 1443004573, "last_edit_date": 1443004573, "creation_date": 1443003307, "answer_id": 32736826, "question_id": 32736540, "link": "https://stackoverflow.com/questions/32736540/working-in-simple-cesar-cipher-in-c/32736826#32736826", "title": "Working in Simple Cesar Cipher in C", "body": "<p>You can use the modulo operator, it gives the remainder of a division:</p>\n\n<pre><code>int cesar_encrypted(int x)\n{\n  return (x - 65 + 3)%(91 - 65) + 65;\n}\n</code></pre>\n\n<hr>\n\n<p>Implementing the suggestions of Sulthan (see comment), it would look like this:</p>\n\n<pre><code>int cesar_encrypted(int x)\n{\n  const int n_chars = 'Z' - 'A' + 1;\n  const int shift = 3;\n  return (x - 'A' + shift)%n_chars + 'A';\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2499, "user_id": 5208760, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/L6VNv.jpg?s=128&g=1", "display_name": "Mateusz", "link": "https://stackoverflow.com/users/5208760/mateusz"}, "is_accepted": false, "score": 0, "last_activity_date": 1443004701, "last_edit_date": 1443004701, "creation_date": 1443003311, "answer_id": 32736828, "question_id": 32736540, "link": "https://stackoverflow.com/questions/32736540/working-in-simple-cesar-cipher-in-c/32736828#32736828", "title": "Working in Simple Cesar Cipher in C", "body": "<p>Just wrap to 65 if <code>x+3 &gt; 90</code> , else do nothing:</p>\n\n<pre><code>int cesar_encrypted(int x)\n{\n    return (x+3 &gt; 90 ? ((x+3) % 90 + 64) : x+3);\n}\n</code></pre>\n\n<p>You can see how it works, here: <a href=\"http://ideone.com/sunxTb\" rel=\"nofollow\">http://ideone.com/sunxTb</a><br>\nOf course you can <strong>simplify this</strong> to have a code without if statement (as other ppl mentioned):</p>\n\n<pre><code>return (x - 65 + 3)%(91 - 65) + 65;\n</code></pre>\n\n<hr>\n\n<p>In addition to that, you've got some minor typos in your code. Here's a type mismatching:</p>\n\n<pre><code>int z = cesar_encrypted(x);\nprintf(\"%s\\n\", z); // you are trying to print a string instead of int\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2499, "user_id": 5208760, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/L6VNv.jpg?s=128&g=1", "display_name": "Mateusz", "link": "https://stackoverflow.com/users/5208760/mateusz"}, "edited": false, "score": 0, "creation_date": 1443004811, "post_id": 32737363, "comment_id": 53315303, "body": "I&#39;m afraid he wanted the program to be the &quot;most basic&quot;, sir."}, {"owner": {"reputation": 117929, "user_id": 669586, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/wxf3D.png?s=128&g=1", "display_name": "Sulthan", "link": "https://stackoverflow.com/users/669586/sulthan"}, "reply_to_user": {"reputation": 2499, "user_id": 5208760, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/L6VNv.jpg?s=128&g=1", "display_name": "Mateusz", "link": "https://stackoverflow.com/users/5208760/mateusz"}, "edited": false, "score": 0, "creation_date": 1443004917, "post_id": 32737363, "comment_id": 53315370, "body": "@MateuszKwasniak If you think &quot;shorter&quot; is &quot;more basic&quot; than you are wrong."}, {"owner": {"reputation": 2499, "user_id": 5208760, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/L6VNv.jpg?s=128&g=1", "display_name": "Mateusz", "link": "https://stackoverflow.com/users/5208760/mateusz"}, "edited": false, "score": 0, "creation_date": 1443005404, "post_id": 32737363, "comment_id": 53315687, "body": "I do not, however I think there is no need for making code super-clear by declaring const variables (of course, it looks much better and it is more customizable, but it is just a homework I believe)."}, {"owner": {"reputation": 117929, "user_id": 669586, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/wxf3D.png?s=128&g=1", "display_name": "Sulthan", "link": "https://stackoverflow.com/users/669586/sulthan"}, "reply_to_user": {"reputation": 2499, "user_id": 5208760, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/L6VNv.jpg?s=128&g=1", "display_name": "Mateusz", "link": "https://stackoverflow.com/users/5208760/mateusz"}, "edited": false, "score": 0, "creation_date": 1443007776, "post_id": 32737363, "comment_id": 53317270, "body": "@MateuszKwasniak I write every program like production code. For me there is nothing like &quot;it&#39;s just a homework&quot;, &quot;it&#39;s just a unit test&quot; etc. I think that we should always strive to make programs more readable. And students should especially learn how to do it."}, {"owner": {"reputation": 69, "user_id": 4063845, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/553299026/picture?type=large", "display_name": "Bruno Rodrigues", "link": "https://stackoverflow.com/users/4063845/bruno-rodrigues"}, "edited": false, "score": 0, "creation_date": 1443017482, "post_id": 32737363, "comment_id": 53324604, "body": "yes i prefer the basic because i didnt learn the other things yet! Im new in programming and new in C."}], "tags": [], "owner": {"reputation": 117929, "user_id": 669586, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/wxf3D.png?s=128&g=1", "display_name": "Sulthan", "link": "https://stackoverflow.com/users/669586/sulthan"}, "is_accepted": false, "score": 1, "last_activity_date": 1443005000, "last_edit_date": 1443005000, "creation_date": 1443004729, "answer_id": 32737363, "question_id": 32736540, "link": "https://stackoverflow.com/questions/32736540/working-in-simple-cesar-cipher-in-c/32737363#32737363", "title": "Working in Simple Cesar Cipher in C", "body": "<p>First, let's define some constants to make the code more readable:</p>\n\n<pre><code>const int MIN_CHAR = 'A'; //equivalent to 65\nconst int MAX_CHAR = 'Z'; //equivalent to 90\nconst int NUM_CHARS = MAX_CHAR - MIN_CHAR + 1; //how many chars we have\nconst int SHIFT = 3; //how many characters we shift when ecrypting\n</code></pre>\n\n<p>now</p>\n\n<pre><code>int cesar_encrypted(int x) {\n    if (x + SHIFT &gt; MAX_CHAR) {\n        return x + SHIFT - NUM_CHARS; //just subtract the number of chars.\n    }\n\n    return x + SHIFT;\n}\n</code></pre>\n\n<p>which can be also written using the module operator as</p>\n\n<pre><code>int cesar_encrypted(int x) {\n    return (x + SHIFT - MIN_CHAR) % NUM_CHARS + MIN_CHAR;\n}\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 4063845, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/553299026/picture?type=large", "display_name": "Bruno Rodrigues", "link": "https://stackoverflow.com/users/4063845/bruno-rodrigues"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "accepted_answer_id": 32736826, "answer_count": 4, "score": 2, "last_activity_date": 1443014331, "creation_date": 1443002555, "last_edit_date": 1443014331, "question_id": 32736540, "link": "https://stackoverflow.com/questions/32736540/working-in-simple-cesar-cipher-in-c", "title": "Working in Simple Cesar Cipher in C", "body": "<p>I'm working in a program for university and they use a problem like the typical Cesar Cipher. It's more like a functional program and needs to be the most basic possible.</p>\n\n<p>The program will receive a number from the user from <code>65</code> to <code>90</code> and for example when the user inserts <code>65</code> will show <code>68</code>. Will add <code>3</code> numbers but when the user gives <code>90</code> will give <code>67</code>. <code>90+3 ----&gt;90,65,66,67</code>. It's a cycle from <code>65</code> to <code>90</code>.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint cesar_encrypted(int x)\n{\n  return (x+3);\n}\n\n\nvoid test_cesar_encrypted(void)\n{\n    int x;\n    scanf(\"%d\", &amp;x);\n    int z = cesar_encrypted(x);\n    printf(\"%s\\n\", z);\n}\n\nint main(){\n    test_cesar_basic();\n\n}\n</code></pre>\n\n<p>I did this sample code, but we can only go further and if you give <code>90</code> he will give <code>93</code> and I want <code>67</code>.</p>\n\n<p>Can anyone help me to wrap it around 90?</p>\n"}, {"tags": ["c", "gcc", "memory", "segmentation-fault", "binary-tree"], "comments": [{"owner": {"reputation": 3703, "user_id": 1370847, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1fbf2d89991ff2e9b36e53236a90d502?s=128&d=identicon&r=PG", "display_name": "amdixon", "link": "https://stackoverflow.com/users/1370847/amdixon"}, "edited": false, "score": 0, "creation_date": 1443002460, "post_id": 32736392, "comment_id": 53313719, "body": "for once a post which includes the debug output"}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 4, "creation_date": 1443002573, "post_id": 32736392, "comment_id": 53313797, "body": "Maybe you show us what allocNode() is. Show us a minimal code which we can compile it too."}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1443002796, "post_id": 32736392, "comment_id": 53313986, "body": "A possible difference between &#39;debug&#39; and optimized compiled code may be that uninitialized variables are set to 0. Run your program under valgrind and check what it has to say."}, {"owner": {"reputation": 19, "user_id": 4371560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/037104a59e8798970919601fe5400548?s=128&d=identicon&r=PG&f=1", "display_name": "Jean Oudot", "link": "https://stackoverflow.com/users/4371560/jean-oudot"}, "edited": false, "score": 0, "creation_date": 1443004619, "post_id": 32736392, "comment_id": 53315151, "body": "Just after posting my code i checked allocNode ... And there were no return whereas the signature was strcut node* allocNode(){} . I forgot it ~~. I just add the return and it works now.   Thank you !"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1443005534, "post_id": 32736392, "comment_id": 53315769, "body": "Compile with <code>gcc -Wall -Wextra -g</code>"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1443005694, "post_id": 32736392, "comment_id": 53315881, "body": "<code>Cannot access memory at address 0x8</code> indicates that <code>noeud</code> is a null pointer. This could be because <code>arbre</code> was a null pointer, or <code>allocNode()</code> returns a null pointer, or UB elsewhere."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1443006257, "post_id": 32736392, "comment_id": 53316266, "body": "<code>noeud = arbre;</code> Is arbre guaranteed to be not NULL here? I.e where do you allocate the first node of the tree?"}], "answers": [{"tags": [], "owner": {"reputation": 3045, "user_id": 956880, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8wevB.png?s=128&g=1", "display_name": "Anonymous Coward", "link": "https://stackoverflow.com/users/956880/anonymous-coward"}, "is_accepted": false, "score": 0, "last_activity_date": 1443004748, "last_edit_date": 1490005771, "creation_date": 1443004748, "answer_id": 32737373, "question_id": 32736392, "link": "https://stackoverflow.com/questions/32736392/gcc-o-segmentation-fault/32737373#32737373", "title": "gcc -O segmentation fault", "body": "<p>It is not possible to know what is wrong for certain without a <a href=\"https://meta.stackexchange.com/questions/22754/sscce-how-to-provide-examples-for-programming-questions\">Short Self Contained Example</a></p>\n\n<p>But there are debugging thechniques which may help you in finding what the problem is.\nAdd several <a href=\"http://en.cppreference.com/w/cpp/error/assert\" rel=\"nofollow noreferrer\">asserts</a> to your code :</p>\n\n<pre><code>void insertMyAlgo(unsigned int addr, unsigned int netmask, unsigned int gw)\n{\n   struct node* noeud;\n   int i;\n   int maskBit = countMaskBit(netmask);\n\n   // Going down in the tree until next mask bit = 0.\n   assert( arbre!=NULL );\n   noeud = arbre;\n   for (i = 31; i &gt; 31 - maskBit; i--)\n   {\n      // Bit = 1, go down in the right child.\n      if ((addr &gt;&gt; i) &amp; 0x1)\n      {\n         if (noeud-&gt;fd == NULL)\n         {\n            noeud-&gt;fd = allocNode();\n            assert( noeud-&gt;fd!=NULL );\n            assert( noeud-&gt;fd-&gt;fd==NULL );\n            assert( noeud-&gt;fd-&gt;fg==NULL );\n         }\n         noeud = noeud-&gt;fd;\n      }\n\n      // Bit = 0, go down in the left child.\n      else\n      {\n         if (noeud-&gt;fg == NULL)\n         {\n            noeud-&gt;fg = allocNode();\n            assert( noeud-&gt;fg!=NULL );\n            assert( noeud-&gt;fg-&gt;fd==NULL );\n            assert( noeud-&gt;fg-&gt;fg==NULL );\n         }\n         noeud = noeud-&gt;fg;\n      }\n   }\n\n   // Insert the gateway in the node corresponding to our subnet address.\n   noeud-&gt;gateway = gw;\n}\n</code></pre>\n\n<p>If any of those asserts fail now you have a better idea of what is happening. If none fail you have reduced your search space, the problem is elsewhere.<br>\nYou may even leave the asserts there after you have finished debugging. Just define NDEBUG for release builds and all the code in asserts will be omited.</p>\n"}], "owner": {"reputation": 19, "user_id": 4371560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/037104a59e8798970919601fe5400548?s=128&d=identicon&r=PG&f=1", "display_name": "Jean Oudot", "link": "https://stackoverflow.com/users/4371560/jean-oudot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 179, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1443010446, "creation_date": 1443002170, "last_edit_date": 1443010446, "question_id": 32736392, "link": "https://stackoverflow.com/questions/32736392/gcc-o-segmentation-fault", "title": "gcc -O segmentation fault", "body": "<p>Here is a code to insert a data in a binary trie. This code works perfectly if I compile it with a basic gcc main.c -o main . </p>\n\n<pre><code>/**\n     * Insert a new gateway in the tree, at the position corresponding to the\n     * subnet address.\n     *\n     * addr    : Subnet address\n     * netmask : Subnet mask\n     * gw      : gateway identifier\n     * \n     * return  : void.\n     */\n    void insertMyAlgo(unsigned int addr, unsigned int netmask, unsigned int gw)\n    {\n       struct node* noeud;\n       int i;\n       int maskBit = countMaskBit(netmask);\n\n       // Going down in the tree until next mask bit = 0.\n       noeud = arbre;\n       for (i = 31; i &gt; 31 - maskBit; i--)\n       {\n          // Bit = 1, go down in the right child.\n          if ((addr &gt;&gt; i) &amp; 0x1)\n          {\n             if (noeud-&gt;fd == NULL)\n                noeud-&gt;fd = allocNode();\n             noeud = noeud-&gt;fd;\n          }\n\n          // Bit = 0, go down in the left child.\n          else\n          {\n             if (noeud-&gt;fg == NULL)\n                noeud-&gt;fg = allocNode();\n             noeud = noeud-&gt;fg;\n          }\n       }\n\n       // Insert the gateway in the node corresponding to our subnet address.\n       noeud-&gt;gateway = gw;\n    }\n</code></pre>\n\n<p>I would like to use the -O option to optimize time spent in looking up the tree, finding a specific key. I get a segfault when I execute my main with this -O options. \nGdb gave me the following informations : </p>\n\n<pre><code>Program received signal SIGSEGV, Segmentation fault. insertMyAlgo\n(addr=12288, netmask=&lt;optimized out&gt;, gw=3238068734)\n    at mainbinaireBench.c:125 125            if (noeud-&gt;fg == NULL)\n(gdb) print noeud-&gt;fg Cannot access memory at address 0x8\n</code></pre>\n\n<p>So the error seems to be here : </p>\n\n<pre><code> // Bit = 0, go down in the left child.\n else\n {\n    if (noeud-&gt;fg == NULL)\n       noeud-&gt;fg = allocNode();\n    noeud = noeud-&gt;fg;\n }\n</code></pre>\n\n<p>I really don't know why there is this error, and why the program works without this -O option. I would really like to make it works, if some of you guys could help me to understand, it would be very nice. </p>\n\n<p>Thank you !</p>\n"}, {"tags": ["c", "shared-memory"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1443001732, "post_id": 32736196, "comment_id": 53313184, "body": "Use a shared semaphore maybe?"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 2, "creation_date": 1443004656, "post_id": 32736196, "comment_id": 53315180, "body": "Perhaps shared memory is not the right option."}, {"owner": {"reputation": 1299, "user_id": 2261700, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/71b39349c1ac460048e54bdf41b3aa2c?s=128&d=identicon&r=PG", "display_name": "Irina Avram", "link": "https://stackoverflow.com/users/2261700/irina-avram"}, "edited": false, "score": 0, "creation_date": 1443007830, "post_id": 32736196, "comment_id": 53317309, "body": "Well, normally, this communication would be done by pipes, but I assumed  OP&#39;s assignment is to do it with shared memory"}, {"owner": {"reputation": 1299, "user_id": 2261700, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/71b39349c1ac460048e54bdf41b3aa2c?s=128&d=identicon&r=PG", "display_name": "Irina Avram", "link": "https://stackoverflow.com/users/2261700/irina-avram"}, "edited": false, "score": 0, "creation_date": 1443014359, "post_id": 32736196, "comment_id": 53322140, "body": "@ Don Corleone you should also accept an answer"}, {"owner": {"reputation": 301, "user_id": 2794711, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ae1d8689aabcf8d77717f1b3fafa1ccb?s=128&d=identicon&r=PG&f=1", "display_name": "Don Corleone", "link": "https://stackoverflow.com/users/2794711/don-corleone"}, "reply_to_user": {"reputation": 1299, "user_id": 2261700, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/71b39349c1ac460048e54bdf41b3aa2c?s=128&d=identicon&r=PG", "display_name": "Irina Avram", "link": "https://stackoverflow.com/users/2261700/irina-avram"}, "edited": false, "score": 0, "creation_date": 1443084815, "post_id": 32736196, "comment_id": 53353672, "body": "@IrinaAvram just did, thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1443004613, "post_id": 32736353, "comment_id": 53315146, "body": "Please don&#39;t link to linux.die.net."}], "tags": [], "owner": {"reputation": 1299, "user_id": 2261700, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/71b39349c1ac460048e54bdf41b3aa2c?s=128&d=identicon&r=PG", "display_name": "Irina Avram", "link": "https://stackoverflow.com/users/2261700/irina-avram"}, "is_accepted": false, "score": 5, "last_activity_date": 1443008620, "last_edit_date": 1443008620, "creation_date": 1443002094, "answer_id": 32736353, "question_id": 32736196, "link": "https://stackoverflow.com/questions/32736196/what-alternatives-i-have-against-sleep-to-synchronize-transfer-between-parent/32736353#32736353", "title": "What alternatives I have against sleep() to synchronize transfer between parent and child process?", "body": "<p>I would suggest using semaphores, this is not a case where you use 'sleep':\n<a href=\"http://man7.org/linux/man-pages/man7/sem_overview.7.html\" rel=\"nofollow\">http://man7.org/linux/man-pages/man7/sem_overview.7.html</a></p>\n\n<p>You can use them like in this example:\n<a href=\"http://www.csc.villanova.edu/~mdamian/threads/posixsem.html\" rel=\"nofollow\">http://www.csc.villanova.edu/~mdamian/threads/posixsem.html</a></p>\n\n<p>You cannot know for sure that it will not take more than 3 seconds, so sleep is a realy bad choice. So, it goes something like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#include &lt;semaphore.h&gt;\n\n\nint main(void)\n{\nsem_t *sem = mmap(0, sizeof(sem_t), PROT_READ|PROT_WRITE,\n              MAP_SHARED|MAP_ANONYMOUS, -1, 0);\n\nsem_init(sem, 1, 1);\n\nif(fork() == 0) {\n    printf(\"Child: Waiting to acquire semaphore\\n\");\n    sem_wait(sem);\n    printf(\"Child acquires lock\\n\");\n    /* do whatever you want then relese*/\n    sem_post(sem);\n} else {\n    printf(\"Parent: Waiting to acquire semaphore\\n\");\n    sem_wait(sem);\n    printf(\"Parent acquires lock\\n\");\n    /* do whatever you want then relese*/\n    sem_post(sem);\n}\n\nsem_destroy(sem);\nreturn 0;\n}\n</code></pre>\n\n<p>Oh and if you want it parent to be followed by child always (or the other way around), you can use two semaphores, and initialize them accordingly(with 1 and 0, or 0 and 1).</p>\n\n<pre><code>    sem_wait(sem1);\n    printf(\"Parent acquires lock\\n\");\n    /* do whatever you want then relese*/\n    sem_post(sem2);\n\n/* Other things will be happening here */\n\n    sem_wait(sem2);\n    printf(\"Child acquires lock\\n\");\n    /* do whatever you want then relese*/\n    sem_post(sem1);\n</code></pre>\n\n<p><strong>Edit</strong></p>\n\n<p>If you do not have to use shared memory, it would be better to do the communication with sockets.</p>\n"}, {"tags": [], "owner": {"reputation": 301, "user_id": 2794711, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ae1d8689aabcf8d77717f1b3fafa1ccb?s=128&d=identicon&r=PG&f=1", "display_name": "Don Corleone", "link": "https://stackoverflow.com/users/2794711/don-corleone"}, "is_accepted": true, "score": 1, "last_activity_date": 1443012400, "creation_date": 1443012400, "answer_id": 32740033, "question_id": 32736196, "link": "https://stackoverflow.com/questions/32736196/what-alternatives-i-have-against-sleep-to-synchronize-transfer-between-parent/32740033#32740033", "title": "What alternatives I have against sleep() to synchronize transfer between parent and child process?", "body": "<p>Thanks to amazing StackOverflow community for coming to my rescue! I have resolved solved the issue using semaphores! I'm sharing my final code so it can be of use for anyone who gets struck in a situation like mine! </p>\n\n<pre><code>#include &lt;sys/types.h&gt;\n#include &lt;sys/ipc.h&gt;\n#include &lt;sys/shm.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;sys/wait.h&gt;  /* Needed for the wait function */\n#include &lt;unistd.h&gt;    /* needed for the fork function */\n#include &lt;string.h&gt;    /* needed for the strcat function */\n#include &lt;semaphore.h&gt;\n#include &lt;sys/mman.h&gt;\n#include&lt;fcntl.h&gt;\n#include&lt;stdlib.h&gt;\n#define SHMSIZE 27\ntypedef struct {\n    sem_t one;\n    sem_t two;\n} SemPair;\nint main() {\n\n\n int shm = shm_open(\"/test\", O_CREAT | O_RDWR, S_IRUSR | S_IWUSR);\n    ftruncate(shm, sizeof(sem_t));\n    SemPair *sem = mmap(NULL, sizeof(sem_t), PROT_READ | PROT_WRITE, MAP_SHARED, shm, 0);\n\n sem_init(&amp;(sem-&gt;one), 1, 0);\n sem_init(&amp;(sem-&gt;two), 1, 0);\n\n   int shmid;\n   char *shmz;\n\n   if(fork() == 0) {\n      sem_wait(&amp;(sem-&gt;one));\n      shmid = shmget(29009, SHMSIZE, 0);\n      shmz = shmat(shmid, 0, 0);\n      printf (\"Child : Reading %s \\n\",shmz) ;\n      int len=strlen(shmz);\n      char rev[100],temp;\n int  i = 0;\n   int   j = strlen(shmz) - 2;\n   while (i &lt; j) {\n      temp = shmz[i];\n      shmz[i] = shmz[j];\n      shmz[j] = temp;\n      i++;\n      j--;\n   }\n\n\n    shmdt(shmz);\n    sem_post(&amp;(sem-&gt;two));\n   }\n   else {\n      shmid = shmget(29009, SHMSIZE, 0666 | IPC_CREAT);\n      shmz = shmat(shmid, 0, 0);\n\n      printf(\"Parent : Enter String \\n \");\n      char *s = (char *) shmz;\n      *s = '\\0';\n      char a[100];\n      fgets(a,100,stdin);\n      strcat(s,a);\n      printf (\"Parent: sending %s \\n\",shmz);\n      sem_post(&amp;(sem-&gt;one));\n      sem_wait(&amp;(sem-&gt;two));\n      printf(\"Parent: receiving %s\" ,shmz);\n      shmdt(shmz);\n\n}\n   return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 301, "user_id": 2794711, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ae1d8689aabcf8d77717f1b3fafa1ccb?s=128&d=identicon&r=PG&f=1", "display_name": "Don Corleone", "link": "https://stackoverflow.com/users/2794711/don-corleone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 1, "accepted_answer_id": 32740033, "answer_count": 2, "score": 3, "last_activity_date": 1443012400, "creation_date": 1443001624, "last_edit_date": 1443005607, "question_id": 32736196, "link": "https://stackoverflow.com/questions/32736196/what-alternatives-i-have-against-sleep-to-synchronize-transfer-between-parent", "title": "What alternatives I have against sleep() to synchronize transfer between parent and child process?", "body": "<p>I'm facing a synchronization problem, the problem I'm trying to solve involves sending string from parent to child, reversing it and sending it back to child ( using shared memory ). </p>\n\n<p>However to make sure child is waiting for parent I'm using <code>sleep(3)</code> to give <code>3</code> seconds to parent process to enter string, however this is limiting my programs efficiency, I don't want to force user to wait for 3 seconds.</p>\n\n<pre><code>#include &lt;sys/types.h&gt;\n#include &lt;sys/ipc.h&gt;\n#include &lt;sys/shm.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;sys/wait.h&gt;  /* Needed for the wait function */\n#include &lt;unistd.h&gt;    /* needed for the fork function */\n#include &lt;string.h&gt;    /* needed for the strcat function */\n#define SHMSIZE 27\n\nint main() {\n    int shmid;\n    char *shm;\n\n    if(fork() == 0) {\n        sleep(3);\n        shmid = shmget(29009, SHMSIZE, 0);\n        shm = shmat(shmid, 0, 0);\n        printf (\"Child : Reading %s \\n\",shm) ;\n        int len=strlen(shm);\n        char rev[100],temp;\n\n        int i = 0;\n        int j = strlen(shm) - 2;\n\n        while (i &lt; j) {\n            temp = shm[i];\n            shm[i] = shm[j];\n            shm[j] = temp;\n            i++;\n            j--;\n        }\n        shmdt(shm);\n\n    }else {\n        shmid = shmget(29009, SHMSIZE, 0666 | IPC_CREAT);\n        shm = shmat(shmid, 0, 0);\n\n        printf(\"Parent : Enter String \\n \");\n        char *s = (char *) shm;\n        *s = '\\0';\n        char a[100];\n        fgets(a,100,stdin);\n        strcat(s,a);\n        printf (\"Parent: sending %s \\n\",shm);\n        sleep(3);\n        printf(\"Parent: receiving %s\" ,shm);\n        shmdt(shm);\n\n   }\n   return 0;\n}\n</code></pre>\n\n<h2>Question:</h2>\n\n<ol>\n<li>How could this be implemented in a better way, so that the program is more efficient?           </li>\n</ol>\n"}, {"tags": ["c", "struct"], "comments": [{"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 1, "creation_date": 1443002059, "post_id": 32736181, "comment_id": 53313409, "body": "Did it even compile ? And you didn&#39;t even call your function ."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1443008951, "post_id": 32736181, "comment_id": 53318145, "body": "In your design, you allocate a small amount of memory to hold the resulting root. If you allocate memory with <code>malloc</code>, you must also <code>free</code> it, which is tedious. Unlike arrays, structs can be passed around as values, so you could rewrite this code without pointers and without extra memory management overhead."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "reply_to_user": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1443233591, "post_id": 32736181, "comment_id": 53424446, "body": "@MOehm, passing a struct, that is greater than some very minimal size results in a number of hidden calls to memcpy() and memory being set aside for the memcpy() calls to use.  That memory cannot be used for anything else.  I.E. it is a very bad practice to pass structs by passing the whole struct.  It is a much better practice to pass a pointer to the struct."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1443233772, "post_id": 32736181, "comment_id": 53424493, "body": "when calling the system function: <code>malloc()</code>, always check (!=NULL) the returned value to assure the operation was successful"}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1443247806, "post_id": 32736181, "comment_id": 53426789, "body": "@user3629249: The struct in question &quot;weighs&quot; two ints, which amounts to the size of a pointer in modern systems. I doubt that it is copied via <code>memcpy</code>. Also note that no struct is passed in, but a struct is returned.  Returning a pointer here has further consequences: The pointer must point to static memory or to newly allocated memory. Static memory means that the result is overwritten by subsequent calls; allocated memory means that the calling code must explicitly free it. In my opinion returning a struct here is the better option if you want to kepp the <code>x = sqrt(8)</code> semantics."}], "answers": [{"comments": [{"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 0, "creation_date": 1443002634, "post_id": 32736433, "comment_id": 53313844, "body": "Umm ..I don&#39;t think it will work.  I don&#39;t mean that you are wrong . But why declaraing <code>root</code> inside function and also in <code>main</code> ?"}, {"owner": {"reputation": 5694, "user_id": 1552737, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YfC6P.jpg?s=128&g=1", "display_name": "IKavanagh", "link": "https://stackoverflow.com/users/1552737/ikavanagh"}, "reply_to_user": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 1, "creation_date": 1443002670, "post_id": 32736433, "comment_id": 53313877, "body": "@ameyCU Which part? The code in <code>isqroot()</code> seems broken to me but I&#39;ve answered the question about garbage values due to <code>isqroot()</code> not being called."}, {"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 0, "creation_date": 1443002966, "post_id": 32736433, "comment_id": 53314096, "body": "Its his code that is not going to work even after the changes you told I think . Unnecessary casts and many things ."}, {"owner": {"reputation": 5694, "user_id": 1552737, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YfC6P.jpg?s=128&g=1", "display_name": "IKavanagh", "link": "https://stackoverflow.com/users/1552737/ikavanagh"}, "reply_to_user": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 0, "creation_date": 1443003259, "post_id": 32736433, "comment_id": 53314283, "body": "@ameyCU Yes I agree, his code doesn&#39;t work even after the changes I&#39;ve made. He has implemented the algorithm incorrectly. I&#39;ve answered his problem with not being able to return the <code>struct</code> and getting garbage values."}, {"owner": {"reputation": 5694, "user_id": 1552737, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YfC6P.jpg?s=128&g=1", "display_name": "IKavanagh", "link": "https://stackoverflow.com/users/1552737/ikavanagh"}, "reply_to_user": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 1, "creation_date": 1443003977, "post_id": 32736433, "comment_id": 53314732, "body": "@ameyCU The edit fixes his errors in coding the algorithm."}], "tags": [], "owner": {"reputation": 5694, "user_id": 1552737, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YfC6P.jpg?s=128&g=1", "display_name": "IKavanagh", "link": "https://stackoverflow.com/users/1552737/ikavanagh"}, "is_accepted": false, "score": 2, "last_activity_date": 1443003926, "last_edit_date": 1495541199, "creation_date": 1443002273, "answer_id": 32736433, "question_id": 32736181, "link": "https://stackoverflow.com/questions/32736181/square-root-using-babylonian-method-returns-wrong-value/32736433#32736433", "title": "square root using Babylonian method returns wrong value?", "body": "<p>You never call <code>isqroot()</code>... so <code>root-&gt;rootInt</code> and <code>root-&gt;rootFraction</code> are never set.</p>\n\n<p>You also have a typo in</p>\n\n<pre><code>RootStruct* roo+t=(RootStruct* )malloc(sizeof(RootStruct));\n</code></pre>\n\n<p>it should be</p>\n\n<pre><code>RootStruct* root=(RootStruct* )malloc(sizeof(RootStruct));\n</code></pre>\n\n<p>without the <code>+</code>. However, this is unnecessary as you allocate memory in <code>isqroot()</code> and should probably be replaced by</p>\n\n<pre><code>RootStruct* root = isqroot(9);\n</code></pre>\n\n<p>Then don't forget to <code>free()</code> the memory at the end of <code>main()</code>.</p>\n\n<hr>\n\n<p>Just to note, you also <a href=\"https://stackoverflow.com/a/605858/1552737\">shouldn't case the result of <code>malloc()</code> in C</a>.</p>\n\n<hr>\n\n<p>You have also implemented the algorithm incorrectly, it should be</p>\n\n<pre><code>RootStruct* isqroot (int n) {\n    RootStruct* root=(RootStruct* )malloc(sizeof(RootStruct));\n\n    float y = 1;\n    float e = 0.1; /* e decides the accuracy level*/\n\n    while(fabs(n - y*y) &gt; e) {\n        y = (y + (n / y)) / 2;\n    }\n\n    root-&gt;rootInt = (int) y;\n    root-&gt;rootFraction = (int) (y - root-&gt;rootInt) * 100;\n\n    return root;\n}\n</code></pre>\n\n<p>where the complete corrected program is then</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n\nstruct rootStruct {\n    int rootInt;\n    int rootFraction;\n};\n\ntypedef struct rootStruct RootStruct;\n\nRootStruct* isqroot (int n) {\n    RootStruct* root=(RootStruct* )malloc(sizeof(RootStruct));\n\n    float y = 1;\n    float e = 0.1; /* e decides the accuracy level*/\n\n    while(fabs(n - y*y) &gt; e) {\n        y = (y + (n / y)) / 2;\n    }\n\n    root-&gt;rootInt = (int) y;\n    root-&gt;rootFraction = (int) (y - root-&gt;rootInt) * 100;\n\n    return root;\n}\n\nint main() {\n    RootStruct* root = isqroot(9);\n    printf(\"The sqrt is %d.%d\\n\", root-&gt;rootInt, root-&gt;rootFraction);\n    return 0;\n}\n</code></pre>\n\n<p>The Wikipedia article on <a href=\"https://en.wikipedia.org/wiki/Methods_of_computing_square_roots#Babylonian_method\" rel=\"nofollow noreferrer\">Computing Square Roots</a> has a very easy to understand section on the <a href=\"https://en.wikipedia.org/wiki/Methods_of_computing_square_roots#Babylonian_method\" rel=\"nofollow noreferrer\">Babylonian method</a>.</p>\n"}], "owner": {"reputation": 31, "user_id": 5367025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c5d6c2a4f1ff5471149e149e7e205da?s=128&d=identicon&r=PG&f=1", "display_name": "k.91221", "link": "https://stackoverflow.com/users/5367025/k-91221"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1443005902, "creation_date": 1443001591, "last_edit_date": 1443005902, "question_id": 32736181, "link": "https://stackoverflow.com/questions/32736181/square-root-using-babylonian-method-returns-wrong-value", "title": "square root using Babylonian method returns wrong value?", "body": "<blockquote>\n  <p>For the function <code>isqroot()</code> to calculate the square root using Babylonian method with one degree of precision and return it in a struct.</p>\n</blockquote>\n\n<p>I'm unable to return the value to the struct and when I compile it is returning garbage value.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;math.h&gt;\n\nstruct rootStruct {\n    int rootInt;\n    int rootFraction;\n};\n\ntypedef struct rootStruct RootStruct;\nRootStruct* isqroot (int n) {\n    /*We are using n itself as initial approximation*/\n    RootStruct* root=(RootStruct* )malloc(sizeof(RootStruct));\n    float x = n;\n    float y = 1;\n    float e = 0.1; /* e decides the accuracy level*/\n\n    while(x - y &gt; e) {\n        x = (x + y)/2;\n        y = n/x;\n    }\n    root-&gt;rootInt = (int)x/2;\n    root-&gt;rootFraction = (int)(x-root-&gt;rootInt)*100;\n    return root;\n}\n\nint main(){\n    RootStruct* roo+t=(RootStruct* )malloc(sizeof(RootStruct));\n    printf(\"the sqrt is %d\\n%d\\n\",root-&gt;rootInt,root-&gt;rootFraction);\n    return 0;\n}\n</code></pre>\n\n<p>What is wrong with this code?</p>\n"}, {"tags": ["c", "struct", "dereference"], "comments": [{"owner": {"reputation": 3703, "user_id": 1370847, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1fbf2d89991ff2e9b36e53236a90d502?s=128&d=identicon&r=PG", "display_name": "amdixon", "link": "https://stackoverflow.com/users/1370847/amdixon"}, "edited": false, "score": 3, "creation_date": 1443001433, "post_id": 32736095, "comment_id": 53312997, "body": "left and right are <code>struct node *</code> so to access their member data, need to use -&gt; not . .."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1443001478, "post_id": 32736095, "comment_id": 53313030, "body": "also <code>typedef struct</code> --&gt; <code>typedef struct node</code>"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1443001584, "post_id": 32736095, "comment_id": 53313109, "body": "A pointer to a structure is a pointer to a structure, no matter nesting level. And getting a member when you have a pointer to a structure you use the arrow <code>-&gt;</code>. You already know this, as you use it in e.g. <code>root-&gt;left</code>."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 1, "creation_date": 1443001604, "post_id": 32736095, "comment_id": 53313119, "body": "Why <b>(node*)</b> malloc(sizeof(node)); ??"}, {"owner": {"reputation": 73, "user_id": 5367057, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10207046749143518/picture?type=large", "display_name": "Phoenix", "link": "https://stackoverflow.com/users/5367057/phoenix"}, "edited": false, "score": 0, "creation_date": 1443001624, "post_id": 32736095, "comment_id": 53313126, "body": "Still doesn&#39;t work. Do you mean somthing like root-&gt;left-&gt;data?"}, {"owner": {"reputation": 73, "user_id": 5367057, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10207046749143518/picture?type=large", "display_name": "Phoenix", "link": "https://stackoverflow.com/users/5367057/phoenix"}, "edited": false, "score": 0, "creation_date": 1443001794, "post_id": 32736095, "comment_id": 53313229, "body": "If i&#39;m doing      <code>root-&gt;left-&gt;data = 8;</code>     <code>root-&gt;left-&gt;left = NULL;</code>     <code>root-&gt;left-&gt;right = NULL;</code>  I&#39;m getting a new error for those lines:      |error: dereferencing pointer to incomplete type|"}], "answers": [{"comments": [{"owner": {"reputation": 1669, "user_id": 7508077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4193888717f50e77805498af1435b9?s=128&d=identicon&r=PG&f=1", "display_name": "EsmaeelE", "link": "https://stackoverflow.com/users/7508077/esmaeele"}, "edited": false, "score": 0, "creation_date": 1543520465, "post_id": 32736244, "comment_id": 93959380, "body": "@Michi  What is difference between <code>typedef struct</code> and <code>typedef struct node</code> ?"}], "tags": [], "owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "is_accepted": true, "score": 2, "last_activity_date": 1443001787, "creation_date": 1443001787, "answer_id": 32736244, "question_id": 32736095, "link": "https://stackoverflow.com/questions/32736095/error-request-for-member-data-in-something-not-a-structure-or-union/32736244#32736244", "title": "error: request for member &#39;data&#39; in something not a structure or union|", "body": "<p>You got error there because you try to access that pointer with <strong>.</strong> instead of <strong>-></strong>.\nAlso <strong>typedef struct</strong> should be <strong>typedef struct node</strong>.</p>\n\n<p>Try this:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\ntypedef struct node{\n    int data;\n    struct node* left;\n    struct node* right;\n}node;\n\n\nint main(void){\n    node* root = malloc(sizeof(node));//allocate space for root\n    root-&gt;data = 7;\n    root-&gt;left = malloc(sizeof(node));//allocate space for left son of root\n    root-&gt;right = NULL;\n\n    root-&gt;left-&gt;data = 8;//ERROR HERE!\n    root-&gt;left-&gt;left = NULL;//ERROR HERE!\n    root-&gt;left-&gt;right = NULL;//ERROR HERE!\n\n\n    printf(\"size of tree: %d\\n\", sizeOfTree(root));\n    return 0;\n}\n</code></pre>\n\n<p>Don't cast <strong>malloc</strong> because return of malloc is <strong>void*</strong>.</p>\n"}], "owner": {"reputation": 73, "user_id": 5367057, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10207046749143518/picture?type=large", "display_name": "Phoenix", "link": "https://stackoverflow.com/users/5367057/phoenix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4015, "favorite_count": 0, "accepted_answer_id": 32736244, "answer_count": 1, "score": 0, "last_activity_date": 1443001787, "creation_date": 1443001319, "question_id": 32736095, "link": "https://stackoverflow.com/questions/32736095/error-request-for-member-data-in-something-not-a-structure-or-union", "title": "error: request for member &#39;data&#39; in something not a structure or union|", "body": "<p>I'm trying to practice Binnary trees.\nI created a struct for node, allocated it for the root and also allocated space for the left son.\nI built a function that returnes the size of the tree but it seems there is an error while trying to initialize the left son's variables.</p>\n\n<p>the main function:</p>\n\n<pre><code>int main()\n{\nnode* root = (node*) malloc(sizeof(node));//allocate space for root\nroot-&gt;data = 7;\nroot-&gt;left = (node*) malloc(sizeof(node));//allocate space for left son of root\nroot-&gt;right = NULL;\n\nroot-&gt;left.data = 8;//ERROR HERE!\nroot-&gt;left.left = NULL;//ERROR HERE!\nroot-&gt;left.right = NULL;//ERROR HERE!\n\n\nprintf(\"size of tree: %d\\n\", sizeOfTree(root));\nreturn 0;\n}\n</code></pre>\n\n<p>the node struct:</p>\n\n<pre><code>typedef struct\n{\nint data;\nstruct node* left;\nstruct node* right;\n}node;\n</code></pre>\n\n<p>The Errors i get:</p>\n\n<pre><code>error: request for member 'data' in something not a structure or union|\nerror: request for member 'left' in something not a structure or union|\nerror: request for member 'right' in something not a structure or union|\n</code></pre>\n\n<p>What am i doing wrong?</p>\n"}, {"tags": ["c", "performance", "read-write", "throughput", "disk-io"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1443001752, "post_id": 32735850, "comment_id": 53313194, "body": "What&#39;s your block size?  There&#39;s a good chance you&#39;re seeing the effects of hardware caching and read-ahead on the disk(s) you&#39;re accessing.  The <code>pwrite()</code> fills the cache, and if the next <code>pread()</code> is for different data, none of it is cached.  Doing the <code>pread()</code> after the <code>pwrite()</code> allows data to be read directly from the disk&#39;s hardware cache."}, {"owner": {"reputation": 102, "user_id": 3304919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd204f78599cbc0dd10a55f611a4e00d?s=128&d=identicon&r=PG&f=1", "display_name": "Chia", "link": "https://stackoverflow.com/users/3304919/chia"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1443023212, "post_id": 32735850, "comment_id": 53328809, "body": "I don&#39;t know the physical block size, and I set to 256KB in the program. Thanks for your comment, now I think it&#39;s very likely caused by disk&#39;s buffer."}], "answers": [{"comments": [{"owner": {"reputation": 102, "user_id": 3304919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd204f78599cbc0dd10a55f611a4e00d?s=128&d=identicon&r=PG&f=1", "display_name": "Chia", "link": "https://stackoverflow.com/users/3304919/chia"}, "edited": false, "score": 0, "creation_date": 1443023251, "post_id": 32737820, "comment_id": 53328835, "body": "Thanks for your answer, now I think it&#39;s very likely caused by disk&#39;s buffer. But I still can&#39;t imagine just seek to the previous position will let read throughput drop from 125 MB/s to 21 MB/s..."}, {"owner": {"reputation": 47440, "user_id": 229410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3e0014fcc07d184018d3b8185a85a09?s=128&d=identicon&r=PG", "display_name": "Rohan", "link": "https://stackoverflow.com/users/229410/rohan"}, "reply_to_user": {"reputation": 102, "user_id": 3304919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd204f78599cbc0dd10a55f611a4e00d?s=128&d=identicon&r=PG&f=1", "display_name": "Chia", "link": "https://stackoverflow.com/users/3304919/chia"}, "edited": false, "score": 0, "creation_date": 1443025862, "post_id": 32737820, "comment_id": 53330541, "body": "@leo, Yes, seeks are expensive. Look at IO wait times which would increase when throughput decreases."}], "tags": [], "owner": {"reputation": 47440, "user_id": 229410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3e0014fcc07d184018d3b8185a85a09?s=128&d=identicon&r=PG", "display_name": "Rohan", "link": "https://stackoverflow.com/users/229410/rohan"}, "is_accepted": true, "score": 3, "last_activity_date": 1443006116, "creation_date": 1443006116, "answer_id": 32737820, "question_id": 32735850, "link": "https://stackoverflow.com/questions/32735850/c-disk-i-o-write-after-read-at-the-same-offset-of-a-file-will-make-read-throug/32737820#32737820", "title": "C Disk I/O - write after read at the same offset of a file will make read throughput very low", "body": "<blockquote>\n  <p>And I use direct I/O, so the I/O will bypass the caching mechanism of the file system and access directly the blocks on the disk.</p>\n</blockquote>\n\n<p>If you don't have file system on the device and directly using the device to read/write, then there is no file system cache comes into the picture.</p>\n\n<p>The behavior you observed is typical of disk access and IO behavior.</p>\n\n<blockquote>\n  <p>I found that if I don't do pwrite, read throughput is 125 MB/s</p>\n</blockquote>\n\n<p>Reason: The disk just reads data, it doesn't have to go back to the offset and write data, 1 less operation.</p>\n\n<blockquote>\n  <p>If I do pwrite, read throughput will be 21 MB/s, and write throughput is 169 MB/s.</p>\n</blockquote>\n\n<p>Reason: Your disk might have better write speed, probably disk buffer is caching write rather than directly hitting the media.</p>\n\n<blockquote>\n  <p>If I do pread after pwrite, write throughput is 115 MB/s, and read throughput is 208 MB/s.</p>\n</blockquote>\n\n<p>Reason: Most likely data written is being cached at disk level and so read gets data from cache instead of media.</p>\n\n<p>To get optimal performance, you should use asynchronous IOs and number of blocks at a time. However, you have to use reasonable number of blocks and can't use very large number. Should find out what is optimal by trial and error.</p>\n"}], "owner": {"reputation": 102, "user_id": 3304919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd204f78599cbc0dd10a55f611a4e00d?s=128&d=identicon&r=PG&f=1", "display_name": "Chia", "link": "https://stackoverflow.com/users/3304919/chia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 924, "favorite_count": 0, "accepted_answer_id": 32737820, "answer_count": 1, "score": 7, "last_activity_date": 1443006116, "creation_date": 1443000652, "question_id": 32735850, "link": "https://stackoverflow.com/questions/32735850/c-disk-i-o-write-after-read-at-the-same-offset-of-a-file-will-make-read-throug", "title": "C Disk I/O - write after read at the same offset of a file will make read throughput very low", "body": "<p><em>Background:</em></p>\n\n<p>I'm developing a database related program, and I need to flush dirty metadata from memory to disk sequentially.\n/dev/sda1 is volumn format, so data on /dev/sda1 will be accessed block by block and the blocks are adjacent physically if accessed sequentially.\nAnd I use direct I/O, so the I/O will bypass the caching mechanism of the file system and access directly the blocks on the disk.</p>\n\n<p><em>Problems:</em></p>\n\n<p>After opening /dev/sda1, I'll read one block, update the block and write the block back to the same offset from the beginning of /dev/sda1, iteratively.</p>\n\n<p>The code are like below - </p>\n\n<pre><code>//block_size = 256KB\nint file = open(\"/dev/sda1\", O_RDWR|O_LARGEFILE|O_DIRECT);\nfor(int i=0; i&lt;N; i++) {\n    pread(file, buffer, block_size, i*block_size);\n    // Update the buffer\n    pwrite(file, buffer, block_size, i*block_size);\n}\n</code></pre>\n\n<p>I found that if I don't do pwrite, read throughput is <strong>125 MB/s</strong>.</p>\n\n<p>If I do pwrite, read throughput will be <strong>21 MB/s</strong>, and write throughput is <strong>169 MB/s</strong>.</p>\n\n<p>If I do pread after pwrite, write throughput is <strong>115 MB/s</strong>, and read throughput is <strong>208 MB/s</strong>.</p>\n\n<p>I also tried read()/write() and aio_read()/aio_write(), but the problem remains. I don't know why write after read at the same position of a file will make the read throughput so low.</p>\n\n<p>If accessing more blocks at a time, like this</p>\n\n<pre><code>pread(file, buffer, num_blocks * block_size, i*block_size);\n</code></pre>\n\n<p>The problem will mitigate, please see the <a href=\"http://i.stack.imgur.com/be8Bu.png\">chart</a>.</p>\n"}, {"tags": ["c", "arrays", "pointers", "multidimensional-array", "dynamic-memory-allocation"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1443000339, "post_id": 32735689, "comment_id": 53312195, "body": "Please do not cast malloc"}, {"owner": {"reputation": 305, "user_id": 4118249, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/S5SNY.jpg?s=128&g=1", "display_name": "BlackBrain", "link": "https://stackoverflow.com/users/4118249/blackbrain"}, "edited": false, "score": 1, "creation_date": 1443000939, "post_id": 32735689, "comment_id": 53312627, "body": "In your code <code>pmat2</code> and <code>pmat3</code> are 2d integer arrays. Probably you want to declare them in this way: <code>int* pmat1[3][3], *pmat2[3][3], *pmat3[3][3]</code>."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1443001235, "post_id": 32735689, "comment_id": 53312849, "body": "Are you casting calloc because you get some warnings in which case you are using wrong compiler or you cast calloc because you don&#39;t know that return type of calloc (and its familly) is <b>void*</b> ?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1443001457, "post_id": 32735689, "comment_id": 53313011, "body": "Do you want a 2D array of pointers to arrays, a pointer to a 2D array, or an array of pointers to 2D arrays? These are all very different things and your code seems to want to combine all of them."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1443001522, "post_id": 32735689, "comment_id": 53313066, "body": "<code>int* x, y, z;</code> is equivalent to <code>int* x; int y; int z;</code>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1443001579, "post_id": 32735689, "comment_id": 53313108, "body": "Seriously people, there&#39;s not a single line of correct code here. Casting the result of malloc is the very least of his concerns. Take the malloc cast crusade somewhere else, it is not helpful."}, {"owner": {"reputation": 61, "user_id": 5188486, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/52cb6ac1c775c3ae568aa29cec168945?s=128&d=identicon&r=PG&f=1", "display_name": "Kiran C K", "link": "https://stackoverflow.com/users/5188486/kiran-c-k"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1443001645, "post_id": 32735689, "comment_id": 53313138, "body": "@lundin: I have declared a 2d array of pointers, not a pointer to 2d arrays"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1443002666, "post_id": 32735689, "comment_id": 53313875, "body": "@KiranCK The declaration is indeed a 2D array of pointers. The calloc allocates an array of data but incorrectly tries to store that in an array of pointers. And after that, you try to initialize the contents of one array item to an array of data, by using an initializer list in runtime... So the actual purpose of the code is not crystal clear"}], "answers": [{"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 1, "last_activity_date": 1443000410, "creation_date": 1443000410, "answer_id": 32735757, "question_id": 32735689, "link": "https://stackoverflow.com/questions/32735689/syntax-error-when-assigning-values-to-a-dynamically-allocated-2d-array-of-pointe/32735757#32735757", "title": "Syntax error when assigning values to a dynamically allocated 2d array of pointers", "body": "<p>You have many problems with that code. The first is that only <code>pmat1</code> is an array of arrays of pointers to <code>int</code>, the others (<code>pmat2</code> and <code>pmat3</code>) are only arrays of arrays of <code>int</code> (i.e. not pointers).</p>\n\n<p>The second problem is the initialization, you simply can't assign like that, you have to initialize each field separately.</p>\n\n<p>Thirdly, <code>*pmat1[3]</code> doesn't do what you probably expect it to do, besides it's <em>out of bounds</em>, as array indexes start from zero.</p>\n\n<hr>\n\n<p>If we are going down to a more basic level, if what you want is an array of three arrays of three integers, then you are doing it completely wrong, then it's just enough with</p>\n\n<pre><code>int pmat1[3][3];\n</code></pre>\n\n<p>The above will cause the compiler to allocate space for a total of nine (3 * 3) <code>int</code>. No need for any dynamic allocation.</p>\n\n<p>You could then initialize it like</p>\n\n<pre><code>pmat1[0][0] = pmat1[0][1] = pmat1[0][2] = 1;\npmat1[1][0] = pmat1[1][1] = pmat1[1][2] = 0;\npmat1[2][0] = pmat1[2][1] = pmat1[2][2] = 2;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27478, "user_id": 183120, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/fc147f814e1473bb6105db3d924fb590?s=128&d=identicon&r=PG", "display_name": "legends2k", "link": "https://stackoverflow.com/users/183120/legends2k"}, "is_accepted": false, "score": 1, "last_activity_date": 1443002752, "last_edit_date": 1495535223, "creation_date": 1443000492, "answer_id": 32735788, "question_id": 32735689, "link": "https://stackoverflow.com/questions/32735689/syntax-error-when-assigning-values-to-a-dynamically-allocated-2d-array-of-pointe/32735788#32735788", "title": "Syntax error when assigning values to a dynamically allocated 2d array of pointers", "body": "<blockquote>\n  <p>I want to directly assign values to a 2d array of pointers for which the memory is allocated dynamically.</p>\n</blockquote>\n\n<p>You can't do this. For example:</p>\n\n<pre><code>int *p = malloc(sizeof(*p) * 3);\n*p = {1, 2, 3};\n</code></pre>\n\n<p>is completely wrong. You're assigning <code>{1, 2, 3}</code>, an array of type <code>int[3]</code>, to <code>*p</code>, an <code>int</code>. If you've to, do it one by one:</p>\n\n<pre><code>int a[] = {1, 2, 3};\nfor (size_t i = 0u; i &lt; 3u; ++i)\n    p[i] = a[i];\n</code></pre>\n\n<p>The only time you can do a direct assignment is in an automatic array initialization, such as the <code>a</code> in the above snippet, where the unnamed array <code>{1, 2, 3}</code> is , conceptually, copied to the elements of <code>a</code>.</p>\n\n<p>As Joachim noted, make sure you stay within bounds. <code>[0, n \u2212 1]</code> is the range allowed to be dereferenced for an array of size <code>n</code>. Hence <code>a[3] = 4;</code> is illegal, as <code>a</code> is of size 3, although it'll happily compile, you're treading on <a href=\"https://stackoverflow.com/q/2397984/183120\">UB land</a>.</p>\n\n<p>In C's syntax for pointer declaration, the <code>*</code> operator is associated to the identifier and not the type. In <code>int* a, b;</code>, although <code>*</code> is written next to <code>int</code>, the type is still <code>int</code> and not <code>int*</code>. Only <code>a</code> is of type <code>int*</code> and <code>b</code> is still an <code>int</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 61, "user_id": 5188486, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/52cb6ac1c775c3ae568aa29cec168945?s=128&d=identicon&r=PG&f=1", "display_name": "Kiran C K", "link": "https://stackoverflow.com/users/5188486/kiran-c-k"}, "edited": false, "score": 0, "creation_date": 1443001973, "post_id": 32736256, "comment_id": 53313345, "body": "so, what you say is that I can only point to an array for values and cannot directly assign literals to the dynamic pointer"}, {"owner": {"reputation": 402, "user_id": 4579179, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vATBh02KKZs/AAAAAAAAAAI/AAAAAAAAAAA/Bu1Pc8UZSpg/photo.jpg?sz=128", "display_name": "Sanjay Bhardwaj", "link": "https://stackoverflow.com/users/4579179/sanjay-bhardwaj"}, "reply_to_user": {"reputation": 61, "user_id": 5188486, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/52cb6ac1c775c3ae568aa29cec168945?s=128&d=identicon&r=PG&f=1", "display_name": "Kiran C K", "link": "https://stackoverflow.com/users/5188486/kiran-c-k"}, "edited": false, "score": 0, "creation_date": 1443002266, "post_id": 32736256, "comment_id": 53313575, "body": "as per pointer definition : pointer can store address of another variable."}, {"owner": {"reputation": 402, "user_id": 4579179, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vATBh02KKZs/AAAAAAAAAAI/AAAAAAAAAAA/Bu1Pc8UZSpg/photo.jpg?sz=128", "display_name": "Sanjay Bhardwaj", "link": "https://stackoverflow.com/users/4579179/sanjay-bhardwaj"}, "reply_to_user": {"reputation": 61, "user_id": 5188486, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/52cb6ac1c775c3ae568aa29cec168945?s=128&d=identicon&r=PG&f=1", "display_name": "Kiran C K", "link": "https://stackoverflow.com/users/5188486/kiran-c-k"}, "edited": false, "score": 0, "creation_date": 1443003770, "post_id": 32736256, "comment_id": 53314584, "body": "Here, i&#39;m just trying to say is that if you want to take advantage of pointers then you should store only address of another variable. And if you want to store simple values then you should take simple array of int."}], "tags": [], "owner": {"reputation": 402, "user_id": 4579179, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vATBh02KKZs/AAAAAAAAAAI/AAAAAAAAAAA/Bu1Pc8UZSpg/photo.jpg?sz=128", "display_name": "Sanjay Bhardwaj", "link": "https://stackoverflow.com/users/4579179/sanjay-bhardwaj"}, "is_accepted": false, "score": 0, "last_activity_date": 1443001826, "creation_date": 1443001826, "answer_id": 32736256, "question_id": 32735689, "link": "https://stackoverflow.com/questions/32735689/syntax-error-when-assigning-values-to-a-dynamically-allocated-2d-array-of-pointe/32736256#32736256", "title": "Syntax error when assigning values to a dynamically allocated 2d array of pointers", "body": "<p>Can you please look below code, this code show how pointer array stores values of integer type,</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nconst int MAX = 3;\n\nint main ()\n{\n   int  var[] = {10, 100, 200};\n   int i, *ptr[MAX];\n\n   for ( i = 0; i &lt; MAX; i++)\n   {\n      ptr[i] = &amp;var[i]; /* assign the address of integer. */\n   }\n   for ( i = 0; i &lt; MAX; i++)\n   {\n      printf(\"Value of var[%d] = %d\\n\", i, *ptr[i] );\n   }\n   return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 402, "user_id": 4579179, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vATBh02KKZs/AAAAAAAAAAI/AAAAAAAAAAA/Bu1Pc8UZSpg/photo.jpg?sz=128", "display_name": "Sanjay Bhardwaj", "link": "https://stackoverflow.com/users/4579179/sanjay-bhardwaj"}, "is_accepted": false, "score": 0, "last_activity_date": 1443002014, "creation_date": 1443002014, "answer_id": 32736332, "question_id": 32735689, "link": "https://stackoverflow.com/questions/32735689/syntax-error-when-assigning-values-to-a-dynamically-allocated-2d-array-of-pointe/32736332#32736332", "title": "Syntax error when assigning values to a dynamically allocated 2d array of pointers", "body": "<p>And, below code shows how pointer array stores string type values,</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nconst int MAX = 4;\n\nint main ()\n{\n   char *names[] = {\n                   \"Zara Ali\",\n                   \"Hina Ali\",\n                   \"Nuha Ali\",\n                   \"Sara Ali\",\n   };\n   int i = 0;\n\n   for ( i = 0; i &lt; MAX; i++)\n   {\n      printf(\"Value of names[%d] = %s\\n\", i, names[i] );\n   }\n   return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 5188486, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/52cb6ac1c775c3ae568aa29cec168945?s=128&d=identicon&r=PG&f=1", "display_name": "Kiran C K", "link": "https://stackoverflow.com/users/5188486/kiran-c-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 652, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1443002752, "creation_date": 1443000191, "last_edit_date": 1443002245, "question_id": 32735689, "link": "https://stackoverflow.com/questions/32735689/syntax-error-when-assigning-values-to-a-dynamically-allocated-2d-array-of-pointe", "title": "Syntax error when assigning values to a dynamically allocated 2d array of pointers", "body": "<p>I want to directly assign values to a 2d array of pointers for which the memory is allocated dynamically. But the compiler shows 2 warning and 1 error.</p>\n\n<blockquote>\n  <p>2 Warnings on line 11 and 12: int differs in level of indirection from\n  int*.</p>\n  \n  <p>error on line 13: Syntax error : '{'</p>\n</blockquote>\n\n<p>Here is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n    int r , c, rc;\n    int* pmat1[3][3], pmat2[3][3], pmat3[3][3];\n\n    *pmat1[3] = (int*)calloc(3,sizeof(int));\n    *pmat2[3] = (int*)calloc(3,sizeof(int));\n    *pmat3[3] = (int*)calloc(3,sizeof(int));\n\n    *pmat1[3][3] = { {1,1,1}, {0,0,0}, {2,2,2} };\n    return 0;\n}\n</code></pre>\n\n<p>What error am I making here?</p>\n"}, {"tags": ["java", "android", "c", "android-ndk", "libjpeg-turbo"], "answers": [{"comments": [{"owner": {"reputation": 348, "user_id": 1602807, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/rUxbo.jpg?s=128&g=1", "display_name": "vxh.viet", "link": "https://stackoverflow.com/users/1602807/vxh-viet"}, "edited": false, "score": 0, "creation_date": 1489464567, "post_id": 32837356, "comment_id": 72669887, "body": "Hi Balamurugan, just a quick question. I&#39;m having a problem with Android&#39;s default jpeg compression which create artifact, see this SO question for more detail: <a href=\"http://stackoverflow.com/questions/36487971/how-to-compress-bitmap-as-jpeg-with-least-quality-loss-on-android\" title=\"how to compress bitmap as jpeg with least quality loss on android\">stackoverflow.com/questions/36487971/&hellip;</a>   I would like to ask if libjpeg-turbo is able to solve this problem?"}, {"owner": {"reputation": 21, "user_id": 1709507, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g5HC7.jpg?s=128&g=1", "display_name": "Balamurugan G", "link": "https://stackoverflow.com/users/1709507/balamurugan-g"}, "reply_to_user": {"reputation": 348, "user_id": 1602807, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/rUxbo.jpg?s=128&g=1", "display_name": "vxh.viet", "link": "https://stackoverflow.com/users/1602807/vxh-viet"}, "edited": false, "score": 0, "creation_date": 1489471320, "post_id": 32837356, "comment_id": 72671855, "body": "That SO question takes a deeper dig into Bitmap.compress, i don&#39;t have that much exposure in that, Better you can give it a try to libjpeg-turbo, remember libjpeg-turbo is not exact copy of libjpeg, it has its own customization."}], "tags": [], "owner": {"reputation": 21, "user_id": 1709507, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g5HC7.jpg?s=128&g=1", "display_name": "Balamurugan G", "link": "https://stackoverflow.com/users/1709507/balamurugan-g"}, "is_accepted": true, "score": 0, "last_activity_date": 1488865401, "last_edit_date": 1495540440, "creation_date": 1443509123, "answer_id": 32837356, "question_id": 32735374, "link": "https://stackoverflow.com/questions/32735374/libjpeg-turbo-android-jpeg-compression/32837356#32837356", "title": "libjpeg turbo android jpeg compression", "body": "<p>Finally i made it work, with the help of <a href=\"https://stackoverflow.com/questions/18377807/strange-results-while-compressing-batch-of-pictures-with-libjpegturbo?rq=1\">this question</a></p>\n\n<p>Thanks to the user who posted it.</p>\n\n<p>The code exactly meet my requirement and am able to compress images.</p>\n\n<p>Note: but problem for compressing big images (> 5-30 MB)</p>\n\n<p><strong>UPDATE:-</strong></p>\n\n<p>Problem for compressing big images (> 5-30 MB) can be solved by specifying the resizing dimensions as 1/8 of its original width and height (minimum).</p>\n"}], "owner": {"reputation": 21, "user_id": 1709507, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g5HC7.jpg?s=128&g=1", "display_name": "Balamurugan G", "link": "https://stackoverflow.com/users/1709507/balamurugan-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2243, "favorite_count": 3, "accepted_answer_id": 32837356, "answer_count": 1, "score": 1, "last_activity_date": 1488865401, "creation_date": 1442999327, "last_edit_date": 1495542723, "question_id": 32735374, "link": "https://stackoverflow.com/questions/32735374/libjpeg-turbo-android-jpeg-compression", "title": "libjpeg turbo android jpeg compression", "body": "<p>Am using libjpeg-turbo from <a href=\"https://github.com/openstf/android-libjpeg-turbo\" rel=\"nofollow noreferrer\">here</a> to compress images using JPEG compression, since </p>\n\n<p>Bitmap.compress(Bitmap.CompressFormat.JPEG, quality, ByteArrayOutputStream);</p>\n\n<p>causes OOM for big Images in my Android Project.</p>\n\n<p>Previously i was using libjpeg-turbo from <a href=\"https://wiki.linaro.org/BenjaminGaignard/libjpeg-turboAndSkia\" rel=\"nofollow noreferrer\">here</a> which caused me a lot of trouble so i shifted to the above Github by sorccu (I believe this was the latest or working fine library).</p>\n\n<p>Android Studio - 1.4 RC1\nAndroid Ndk - r10e\nAndroid SDK min = 14, compiled = 22</p>\n\n<p>Also with Benjamin code i was trying with old Gradle 1.3.0 which caused lot of errors, after few weeks of trying i changed to <b>gradle-experimental:0.2.0</b> and everything compiled Good.</p>\n\n<p>Since i feel sorccu Github easy to integrate and use, shifted to it. then used the turbojpeg-jni.c in the library along with the java code for integration in android (both available in the library).</p>\n\n<p>I was able to integrate and compile using ndk-build to build the .so file and copied to lib folder and was able to use it in the java code.</p>\n\n<p>module name in gradle = jpegturbo\nmodule name in android.mk = jpegturbo</p>\n\n<p><b>Built it as a shared library</b></p>\n\n<p>library loading code in java = System.loadLibrary(\"jpegturbo\"); (org.libjpegturbo.turbojpeg.TJLoader.java)</p>\n\n<p>There are few problems i face now, please help me to resolve it,</p>\n\n<p>1.The main issue i can't compress the image using it, the compressed image is corrupted may be am doing it wrong, below is the java code</p>\n\n<pre><code>static {\n    try {\n        tj = new TJCompressor();\n    } catch (Exception e) {\n        e.printStackTrace();\n    }\n }\n\nFile file = new File(pathName);\nint actualBytes = (int) file.length();\n\nbyte[] srcBuf = new byte[actualBytes];\nbyte[] dstBuf;\n\nFileInputStream fIn;\ntry {\n    fIn = new FileInputStream(file);\n    fIn.read(srcBuf);\n    fIn.close();\n    } catch (FileNotFoundException e) {\n        e.printStackTrace();\n    } catch (IOException e) {\n        e.printStackTrace();\n    }\n\ntj.setSourceImage(srcBuf, 0, 0, options.outWidth, 0, options.outHeight, TJ.PF_RGB);\ntj.setJPEGQuality(quality);\ntj.setSubsamp(TJ.SAMP_444);\ndstBuf =  tj.compress(TJ.FLAG_ACCURATEDCT, options.outWidth, options.outHeight);\n\nint size = tj.getCompressedSize();\n\ntj.close();\n\nFileOutputStream fos;\n   try {\n       fos = new FileOutputStream(file1);\n       fos.write(dstBuf);\n       fos.close();\n   } catch (FileNotFoundException e) {\n       e.printStackTrace();\n   } catch (IOException e) {\n       e.printStackTrace();\n   }catch (OutOfMemoryError e) {\n       e.printStackTrace();\n   }\n\nLog.e(\"SIZE \", String.valueOf(size));\n</code></pre>\n\n<p>May be the approach or logic in the above block can be wrong, help me !!!</p>\n\n<ol start=\"2\">\n<li>i didnt change the application.mk from the github, </li>\n</ol>\n\n<p><b>APP_ABI := armeabi armeabi-v7a armeabi-v7a-hard arm64-v8a x86 x86_64</b></p>\n\n<p>i use below command to build .so file</p>\n\n<p><b>ndk-build NDK_PROJECT_PATH=. APP_BUILD_SCRIPT=./Android.mk APP_ABI=armeabi-v7a LOCAL_ARM_NEON=true ARCH_ARM_HAVE_NEON=true</b></p>\n\n<p>it generates .so file for ABI armeabi-v7a alone, i manually copy the.so file for other ABI's. i even tried below commands but its not helping</p>\n\n<p><b>ndk-build NDK_PROJECT_PATH=. APP_BUILD_SCRIPT=./Android.mk APP_ABI=all</b></p>\n\n<p><b>ndk-build NDK_PROJECT_PATH=. APP_BUILD_SCRIPT=./Android.mk</b></p>\n\n<p>Also the final apk works in my mobile Sony Xperia U ST25i, but not in the emulator it says the .so file cannot be found, i didn't check in other devices</p>\n\n<p>Note: \n  - i may be wrong about the library author, but both the mentioned library creators have done a great job</p>\n\n<p>i also referred the following links,</p>\n\n<ol>\n<li><a href=\"https://stackoverflow.com/questions/14325639/android-how-to-use-libjpeg-turbo-library-through-jni-example?lq=1\">link 1</a></li>\n<li><a href=\"https://stackoverflow.com/questions/24548952/android-how-to-use-libjpeg-turbo-library?lq=1\">link 2</a></li>\n<li><a href=\"https://stackoverflow.com/questions/12260149/libjpeg-turbo-for-android\">link 3</a></li>\n</ol>\n\n<p><b>Update</b>\nsolved the issue 2, by changing Application.mk as\n        APP_ABI := armeabi-v7a armeabi-v7a-hard x86 x86_64 arm64-v8a APP_PLATFORM := android-14</p>\n\n<p>here's my ndk-build command\n        ndk-build NDK_PROJECT_PATH=. APP_BUILD_SCRIPT=./Android.mk NDK_APPLICATION_MK=./Application.mk</p>\n\n<p>After this app works ok in emulator too</p>\n"}, {"tags": ["c", "job-scheduling"], "comments": [{"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 1, "creation_date": 1442999282, "post_id": 32735248, "comment_id": 53311513, "body": "Why are you repeating yourself ?"}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1442999926, "post_id": 32735248, "comment_id": 53311922, "body": "I edited your post because there was no way to understand what you exactly tried to do."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1443000146, "post_id": 32735248, "comment_id": 53312077, "body": "Please clarify. What is the problem ? What is your actual an output ? What output do you expect ?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1443002390, "post_id": 32735248, "comment_id": 53313663, "body": "You have computed the wt for each process, then sum up an divide by n? What am I missing? It is too difficult to see farther than this, the code is long and very difficult to read."}, {"owner": {"reputation": 1, "user_id": 5365916, "user_type": "registered", "profile_image": "https://graph.facebook.com/613221935483286/picture?type=large", "display_name": "JBlanco", "link": "https://stackoverflow.com/users/5365916/jblanco"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1443002683, "post_id": 32735248, "comment_id": 53313888, "body": "@MichaelWalz I just need it to compute the Average waiting time."}], "owner": {"reputation": 1, "user_id": 5365916, "user_type": "registered", "profile_image": "https://graph.facebook.com/613221935483286/picture?type=large", "display_name": "JBlanco", "link": "https://stackoverflow.com/users/5365916/jblanco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1442999995, "creation_date": 1442998977, "last_edit_date": 1442999995, "question_id": 32735248, "link": "https://stackoverflow.com/questions/32735248/need-to-put-an-average-wait-time-for-my-shortest-job-first-in-c", "title": "Need to put an average wait time for my shortest job first in C", "body": "<p>Everything's working, I just need help with the average waiting time and total waiting time.</p>\n\n<pre><code>#include&lt;cstdio&gt;\n\ntypedef struct nonpresjf{\n    int at,bt,tat,wt;\n}nonpresjf;\n\nnonpresjf p[20],p1[20];\n\nint main(void){\n    int i,limit,nextval,m,min,n;\n    p[0].wt=p[0].tat=0;\n\n    printf(\"\\nEnter the no of process: \");\n    scanf(\"%d\",&amp;n);\n\n    for(i=1;i&lt;=n;i++){\n        printf(\"Enter the arrival time: \");\n        scanf(\"%d\",&amp;p[i].at);\n    }\n    limit=p[1].at;\n\n    for(i=1;i&lt;=n;i++){\n        printf(\"Enter the burst time: \");\n        scanf(\"%d\",&amp;p[i].bt);\n    }\n\n    for(i=1;i&lt;=n;i++){\n        limit+=p[i].bt;\n    }\n\nfor(i=1;i&lt;=n;i++)\np1[i]=p[i];\n\n\nprintf(\"\\n\\nGantt chart is as follows: \");\nprintf(\"%d\",p[1].at);\nnextval=p[1].at;\nm=1;\n\n    do{\n        min = 9999;\n        for(i=1;p[i].at&lt;=nextval &amp;&amp; i&lt;=n ;i++)\n            if(p[i].bt&lt;min &amp;&amp; p[i].bt&gt;0){\n                m=i;\n                min=p[i].bt;\n            }\n\n        nextval+=p[m].bt;\n        p[m].bt=0;\n\n        printf(\"-&gt;P%d-&gt;%d\",m,nextval);\n\n        if(p[m].bt==0){\n            p[m].tat=nextval-p[m].at;\n            p[m].wt=p[m].tat-p1[m].bt;\n            p[0].tat+=p[m].tat;\n            p[0].wt+=p[m].wt;\n            //SHOWS TABLE\n        }\n    }while(nextval&lt;limit);\n\n    p[0].tat=p[0].tat/n;\n    p[0].wt=p[0].wt/n;\n\n    printf(\"\\n\\n-------------------TABLE----------------------------------\\n\");\n\n    printf(\"\\nProcess\\tAT\\tBT\\tTAT\\tWT\\n\");\n\n    for(i=1;i&lt;=n;i++)\n    printf(\"\\nP%d\\t%d\\t%d\\t%d\\t%d\\n\",i,p[i].at,p1[i].bt,p[i].tat,p[i].wt);\n    printf(\"\\n\\n-----------------------------------------------------------\\n\");\n    return 0;\n}\n</code></pre>\n\n<p>I just need help in adding the average waiting time.</p>\n"}, {"tags": ["c", "linux", "serial-port"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1442997537, "post_id": 32734514, "comment_id": 53310481, "body": "You&#39;re only printing the first byte out of 255..."}], "answers": [{"comments": [{"owner": {"reputation": 3859, "user_id": 1336041, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/e7c011510a89bda2022c046a2b98fe15?s=128&d=identicon&r=PG", "display_name": "Sam", "link": "https://stackoverflow.com/users/1336041/sam"}, "edited": false, "score": 0, "creation_date": 1442997702, "post_id": 32734735, "comment_id": 53310581, "body": "Right, the print function in my code should work correctly. Can you let me know how to print out 255 bytes every time the data arrives ?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1442998928, "post_id": 32734735, "comment_id": 53311306, "body": "Note that usually, it wouldn&#39;t be pointless to terminate the string. It is just that this protocol format here is some obscure non-standard mix between ASCII and binary. Typically, AT commands are always followed by pure ASCII."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1442999152, "post_id": 32734735, "comment_id": 53311438, "body": "Sure, I didn&#39;t even think about the protocol in use, it&#39;s just <i>pointless</i> based on the OP writing he expects &quot;bytes&quot; (which I read: binary data). Of course it&#39;s the right thing to do for ascii strings."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": true, "score": 2, "last_activity_date": 1442997960, "last_edit_date": 1442997960, "creation_date": 1442997530, "answer_id": 32734735, "question_id": 32734514, "link": "https://stackoverflow.com/questions/32734514/linux-serial-port-programming-ascii-to-byte/32734735#32734735", "title": "linux - serial port programming ( ASCII to Byte )", "body": "<p>Ascii is a text encoding in bytes. There's no difference in reading them, it's just a matter of how you <em>interpret</em> what you read. This is not your problem.</p>\n\n<p>Your problem is you read up to 255 bytes at once and only ever print the first of them.</p>\n\n<p>It's pointless to set <code>buf[res]</code> to <code>0</code> when you expect binary data (that possibly contains <code>0</code> bytes). That's just useful for terminating <em>text strings</em>.</p>\n\n<p>Just use a loop over your buffer, e.g.</p>\n\n<pre><code>for (int i = 0; i &lt; res; ++i)\n{\n    printf(\"%x\", buf[i]);\n}\n</code></pre>\n"}], "owner": {"reputation": 3859, "user_id": 1336041, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/e7c011510a89bda2022c046a2b98fe15?s=128&d=identicon&r=PG", "display_name": "Sam", "link": "https://stackoverflow.com/users/1336041/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 1, "accepted_answer_id": 32734735, "answer_count": 1, "score": 0, "last_activity_date": 1442997960, "creation_date": 1442996801, "last_edit_date": 1592644375, "question_id": 32734514, "link": "https://stackoverflow.com/questions/32734514/linux-serial-port-programming-ascii-to-byte", "title": "linux - serial port programming ( ASCII to Byte )", "body": "<p>I tried to receive data from serial port. However, those data is unrecognized to me. The root cause is because those are in ASCII. To decode the data, it needs to be the byte formate.\n<a href=\"https://i.stack.imgur.com/V5pBS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/V5pBS.png\" alt=\"enter image description here\" /></a></p>\n<p>The buffer I've created is <code>unsigned char [255]</code> and I try to print out the data by using</p>\n<pre><code>while (STOP==FALSE) {  \n        res = read(fd,buf,255);\n        buf[res]=0; \n        printf(&quot;:%x\\n&quot;, buf[0]);\n        if (buf[0]=='z') STOP=TRUE;\n     }\n</code></pre>\n<p>Two questions here:</p>\n<ol>\n<li><p>The data might is shorter than 255 in the real case. It might takes 20 - 30 arrays from 255. In this case, how can I print 20 arrays ?</p>\n</li>\n<li><p>The correct output should be 41542b ( AT+ ) as the head of the entire command since this is the AT command. So I expect the buf[0] should be 41 in the beginning. It is, however, I dont know why the second one is e0 while I expect to have 54 (T).</p>\n</li>\n</ol>\n<p><a href=\"https://i.stack.imgur.com/xzUnK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xzUnK.png\" alt=\"enter image description here\" /></a></p>\n<p>Thanks</p>\n"}, {"tags": ["c", "scanf"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1442996786, "post_id": 32734471, "comment_id": 53310061, "body": "If you just search just a <i>little</i> on the use of <a href=\"http://en.cppreference.com/w/c/io/fscanf\" rel=\"nofollow noreferrer\"><code>scanf</code></a> (and related functions) you will see that you need to pass a <i>pointer</i> to the variable."}, {"owner": {"reputation": 47569, "user_id": 3255455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5993e7ece129141878cd6419d39cc26e?s=128&d=identicon&r=PG&f=1", "display_name": "gnasher729", "link": "https://stackoverflow.com/users/3255455/gnasher729"}, "edited": false, "score": 1, "creation_date": 1442996927, "post_id": 32734471, "comment_id": 53310143, "body": "Even if you just look at the error message which says &quot;expects type float*&quot;. Clearly &quot;guess&quot; doesn&#39;t have type &quot;float *&quot;?"}], "answers": [{"tags": [], "owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "is_accepted": false, "score": 1, "last_activity_date": 1442997582, "last_edit_date": 1442997582, "creation_date": 1442996783, "answer_id": 32734508, "question_id": 32734471, "link": "https://stackoverflow.com/questions/32734471/scanf-function-error-message-floats-and-doubles/32734508#32734508", "title": "scanf function error message; floats and doubles", "body": "<p>In <code>main</code>-</p>\n\n<pre><code>if(scanf (\"%f\", number) == 1)       // %f requires address of variable\n               ^ &amp; missing here  (add it)\n</code></pre>\n\n<p>in function <code>float approx_sqrt (float x)</code>-</p>\n\n<pre><code>if (scanf (\"%f\", guess) == 1)\n                ^ &amp; missing   (same here add &amp;)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 165, "user_id": 4824993, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/RBt6B.jpg?s=128&g=1", "display_name": "Ducol", "link": "https://stackoverflow.com/users/4824993/ducol"}, "edited": false, "score": 0, "creation_date": 1443004227, "post_id": 32734531, "comment_id": 53314880, "body": "Thank you everyone! Indeed, I have forgotten &amp;. I am new to programming, thus I guess these type of errors will pop up many times, until I get to grips with material. Thank you for explanations and help!"}], "tags": [], "owner": {"reputation": 3310, "user_id": 1853605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2ab8d886abc51e874c1ed067b912ddd?s=128&d=identicon&r=PG", "display_name": "Potato", "link": "https://stackoverflow.com/users/1853605/potato"}, "is_accepted": false, "score": 0, "last_activity_date": 1442996837, "creation_date": 1442996837, "answer_id": 32734531, "question_id": 32734471, "link": "https://stackoverflow.com/questions/32734471/scanf-function-error-message-floats-and-doubles/32734531#32734531", "title": "scanf function error message; floats and doubles", "body": "<p>you should pass reference or address of variable to scanf not just the variable</p>\n\n<pre><code>//if (scanf (\"%f\", guess) == 1) change\nif (scanf (\"%f\", &amp;guess) == 1)\n\n\n//if(scanf (\"%f\", number) == 1) change\nif(scanf (\"%f\", &amp;number) == 1)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 47569, "user_id": 3255455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5993e7ece129141878cd6419d39cc26e?s=128&d=identicon&r=PG&f=1", "display_name": "gnasher729", "link": "https://stackoverflow.com/users/3255455/gnasher729"}, "is_accepted": false, "score": 0, "last_activity_date": 1442997058, "creation_date": 1442997058, "answer_id": 32734590, "question_id": 32734471, "link": "https://stackoverflow.com/questions/32734471/scanf-function-error-message-floats-and-doubles/32734590#32734590", "title": "scanf function error message; floats and doubles", "body": "<p>The title of your question clearly shows that you didn't read the error message that the compiler gave you. It didn't say \"expected type float\", it said \"expected type float*\". Notice the * ? Compilers don't write random characters in an error message. Read your error messages properly!</p>\n\n<p>Now think about it: What would scanf do with a float argument? Or a double argument? It would be totally useless for scanf. scanf needs a <em>pointer</em> to a variable where it can store the values that it scans. </p>\n"}], "owner": {"reputation": 165, "user_id": 4824993, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/RBt6B.jpg?s=128&g=1", "display_name": "Ducol", "link": "https://stackoverflow.com/users/4824993/ducol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 294, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1442997582, "creation_date": 1442996654, "question_id": 32734471, "link": "https://stackoverflow.com/questions/32734471/scanf-function-error-message-floats-and-doubles", "title": "scanf function error message; floats and doubles", "body": "<p>This small program should prompt the user for \ntwo numbers (guess and number) and compute \nthe approximate square root for a number based \non Newton-Raphson Iteration algorithm.</p>\n\n<p>I have issues with scanf. \nHere is the warning message I get:</p>\n\n<pre><code>prog7-8.c: In function \u2018approx_sqrt\u2019:\nprog7-8.c:19: warning: format \u2018%f\u2019 expects type \u2018float *\u2019, but argument 2 has type \u2018double\u2019\nprog7-8.c:19: warning: format \u2018%f\u2019 expects type \u2018float *\u2019, but argument 2 has type \u2018double\u2019\nprog7-8.c: In function \u2018main\u2019:\nprog7-8.c:33: warning: format \u2018%f\u2019 expects type \u2018float *\u2019, but argument 2 has type \u2018double\u2019\nprog7-8.c:33: warning: format \u2018%f\u2019 expects type \u2018float *\u2019, but argument 2 has type \u2018double\u2019\n</code></pre>\n\n<p>I don't see why I get this problem. \nHere is the program:</p>\n\n<pre><code>// Program to compute an approximate square root of a number\n#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\nfloat abs_value (float x)\n{\n    if (x &lt; 0)\n        x = -x;\n    return x;\n}\n\nfloat approx_sqrt (float x)\n{\n    const float epsilon = 0.0001;\n    float guess;\n\n    printf(\"Please, enter your guess:  \\n\");\n\n    if (scanf (\"%f\", guess) == 1)\n    {\n        while (abs_value (pow(guess,2) - x) &gt;= epsilon)\n        guess = (x / guess + guess) / 2.0;\n    }\n    return guess;\n}\n\nint main (void)\n{\n    float number;\n\n    printf(\"Please, enter your number:  \\n\");\n\n    if(scanf (\"%f\", number) == 1)\n        printf(\"The square root of %f is %f\\n\", number, approx_sqrt(number));\n\n    return 0;\n}\n</code></pre>\n\n<p>Thank you! \nPS I am at the initial stage, and don't yet have \nenough knowledge for sophisticated usage of scanf;\nso, I am just trying to use only the basic features\nof this function.</p>\n"}, {"tags": ["c", "debugging", "gcc", "gdb", "clang"], "answers": [{"comments": [{"owner": {"reputation": 10431, "user_id": 880584, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/AQCJr.jpg?s=128&g=1", "display_name": "Patrick B.", "link": "https://stackoverflow.com/users/880584/patrick-b"}, "edited": false, "score": 0, "creation_date": 1443008637, "post_id": 32737897, "comment_id": 53317928, "body": "Thank you for your explanation. Your hint with the DWARF-version was the key for me: trying gcc-4.8 -ggdb3 didn&#39;t help. But gcc-4.8 -gdwarf-2 made gcc generate debugging information my gdb can use."}, {"owner": {"reputation": 10431, "user_id": 880584, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/AQCJr.jpg?s=128&g=1", "display_name": "Patrick B.", "link": "https://stackoverflow.com/users/880584/patrick-b"}, "edited": false, "score": 0, "creation_date": 1443009045, "post_id": 32737897, "comment_id": 53318207, "body": "And clang&#39;s tsan now shows me the source-locations as well."}], "tags": [], "owner": {"reputation": 2286, "user_id": 3228495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e0163d41bd310e00b055618846734b0?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/3228495/andrew"}, "is_accepted": true, "score": 2, "last_activity_date": 1443006330, "creation_date": 1443006330, "answer_id": 32737897, "question_id": 32734222, "link": "https://stackoverflow.com/questions/32734222/why-does-gdb-7-4-does-not-show-source-info-on-binaries-generated-with-recent-com/32737897#32737897", "title": "Why does gdb-7.4 does not show source-info on binaries generated with recent compilers?", "body": "<p>The <code>.debug_loc</code> section does not match addresses to program source lines, this is the job of the <code>.debug_line</code> section.</p>\n\n<p>The <code>.debug_loc</code> section contains location lists, that is the location at which a variable lives.  If a variable lives in many places during its lifetime then a location list is required, this location list is placed in the <code>.debug_loc</code> section.  If a variable lives in just one place then the location expression can be placed inline in to the <code>.debug_info</code> section.  Clearly if no location lists are required then the <code>.debug_loc</code> section can be removed completely.  On your simple program with no variables I'm a little surprised that there was ever a <code>.debug_loc</code> section, without seeing the full debug I don't know what it was being used for.  I'm not really surprised that a later (better) compiler has managed to remove the use of the <code>.debug_loc</code> section.</p>\n\n<p>As for why older versions of gdb are struggling while newer versions handle your binary, I would guess that this is some newer DWARF construct (DWARF being the debug format).  Or if not a newer construct maybe just a construct that was never seen before, and so not supported in older versions of gdb.  Without access to the specific binary it's hard to know.</p>\n\n<p>As a general rule, always use the most up to date version of gdb that you have access to in order to get support for the widest range of DWARF constructs.</p>\n"}], "owner": {"reputation": 10431, "user_id": 880584, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/AQCJr.jpg?s=128&g=1", "display_name": "Patrick B.", "link": "https://stackoverflow.com/users/880584/patrick-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 32737897, "answer_count": 1, "score": 1, "last_activity_date": 1443014812, "creation_date": 1442995783, "last_edit_date": 1443014812, "question_id": 32734222, "link": "https://stackoverflow.com/questions/32734222/why-does-gdb-7-4-does-not-show-source-info-on-binaries-generated-with-recent-com", "title": "Why does gdb-7.4 does not show source-info on binaries generated with recent compilers?", "body": "<p>I'm on Ubuntu 12.04 with gdb 7.4 and gcc-4.6 and gcc-4.8</p>\n\n<p>When building this simple program </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    printf(\"hello world\\n\");\n    return 0;\n}\n</code></pre>\n\n<p>with gcc-4.6 and then extracting debug-sections with <code>objdump -W</code> I see a section called <code>.debug_loc</code>. Not so with gcc-4.8 or later. Not luck either with clang-3.6 or later.</p>\n\n<p>The version of gdb on my system (7.4) seems to require this section to be able to associate source and execution.</p>\n\n<p>The same problem appears when using the thread-sanitizer with clang. It is not able to associate source-lines with callstacks.</p>\n\n<p>Why is there no more debug_loc-section and/or why is gdb 7.4 incapable of handling binaries missing this section? (GDB 7.7 works fine on the same binary) Is there a way to fix this with compiler flags?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1442995716, "post_id": 32734200, "comment_id": 53309514, "body": "ugh...please format your code first."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 5366716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf1801b7c3ae39c466936b7a4c1f9803?s=128&d=identicon&r=PG&f=1", "display_name": "Akhilesh Deep", "link": "https://stackoverflow.com/users/5366716/akhilesh-deep"}, "edited": false, "score": 0, "creation_date": 1442996917, "post_id": 32734260, "comment_id": 53310135, "body": "Thanks Gopi yes the scanf is failed in this case  int n=&#39;a&#39;; printf(&quot;%d&quot;,n);  This is running completely fine So does that means that we can intialize int variable with char costant but we cannot take  input of char constant into int variable using scanf?"}], "tags": [], "owner": {"reputation": 19499, "user_id": 3883560, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ndXdL.jpg?s=128&g=1", "display_name": "Gopi", "link": "https://stackoverflow.com/users/3883560/gopi"}, "is_accepted": false, "score": 3, "last_activity_date": 1442997115, "last_edit_date": 1442997115, "creation_date": 1442995894, "answer_id": 32734260, "question_id": 32734200, "link": "https://stackoverflow.com/questions/32734200/not-getting-whats-happening-in-the-c-code-below/32734260#32734260", "title": "Not getting what&#39;s happening in the C code below", "body": "<pre><code>scanf(\"%d\",&amp;arr[i]);\n</code></pre>\n\n<p>Please have a check to see whether <code>scanf()</code> passed or not</p>\n\n<pre><code>if(scanf(\"%d\",&amp;arr[i]) != 1)\n{\n  printf(\"scanf failed\\n\");\n}\n</code></pre>\n\n<p>While scanning, the format specifier type should match with the parameter that is passed for scanning if this is not the case then it will lead to undefined behavior</p>\n"}, {"tags": [], "owner": {"reputation": 179, "user_id": 4129045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ySxVm.jpg?s=128&g=1", "display_name": "Haselnussstrauch", "link": "https://stackoverflow.com/users/4129045/haselnussstrauch"}, "is_accepted": false, "score": 0, "last_activity_date": 1442996159, "creation_date": 1442996159, "answer_id": 32734334, "question_id": 32734200, "link": "https://stackoverflow.com/questions/32734200/not-getting-whats-happening-in-the-c-code-below/32734334#32734334", "title": "Not getting what&#39;s happening in the C code below", "body": "<pre><code>int main()\n{\n     //Define a int Array with size 20, and two int Variables i and n\n     int arr[20],i,n;\n     //Read integer from Keyboard and save that value in n\n     scanf(\"%d\",&amp;n);\n     //Run this loop from 0 until the value you entered by Keyboard\n     for(i=0;i&lt;n;i++)      \n     {\n          //Read integer from Keyboard to array at index i\n          scanf(\"%d\",&amp;arr[i]);      \n     }\n     //Run this loop from 0 until the value you entered by Keyboard (n)\n     for(i=0;i&lt;n;i++)      \n     {           \n          //Print integer at array index i to console\n          printf(\"%d\",arr[i]);\n     }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 5366716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf1801b7c3ae39c466936b7a4c1f9803?s=128&d=identicon&r=PG&f=1", "display_name": "Akhilesh Deep", "link": "https://stackoverflow.com/users/5366716/akhilesh-deep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1442997115, "creation_date": 1442995698, "last_edit_date": 1442995874, "question_id": 32734200, "link": "https://stackoverflow.com/questions/32734200/not-getting-whats-happening-in-the-c-code-below", "title": "Not getting what&#39;s happening in the C code below", "body": "<pre><code>int main()\n{\n  int arr[20],i,n;\n  scanf(\"%d\",&amp;n);\n  for(i=0;i&lt;n;i++)      \n  {           \n    scanf(\"%d\",&amp;arr[i]);      \n  }\n  for(i=0;i&lt;n;i++)      \n  {           \n    printf(\"%d\",arr[i]);      \n  }\n  return 0;\n}\n</code></pre>\n\n<p>In this block of code when I am inserting any character value the code breaks but normal integer can take character values as input  </p>\n"}, {"tags": ["c", "algorithm"], "comments": [{"owner": {"reputation": 81337, "user_id": 91757, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/afaf752cb41c3968dbd570c6f6fa0dc3?s=128&d=identicon&r=PG", "display_name": "Frerich Raabe", "link": "https://stackoverflow.com/users/91757/frerich-raabe"}, "edited": false, "score": 0, "creation_date": 1442995621, "post_id": 32734133, "comment_id": 53309468, "body": "How do you get the name of a Node, e.g. a string like <code>uncle</code> or <code>niece</code>?"}, {"owner": {"reputation": 1932, "user_id": 375666, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/d33159b0c328adefa8e7cd2d6d814337?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed Saleh", "link": "https://stackoverflow.com/users/375666/ahmed-saleh"}, "reply_to_user": {"reputation": 81337, "user_id": 91757, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/afaf752cb41c3968dbd570c6f6fa0dc3?s=128&d=identicon&r=PG", "display_name": "Frerich Raabe", "link": "https://stackoverflow.com/users/91757/frerich-raabe"}, "edited": false, "score": 0, "creation_date": 1442995704, "post_id": 32734133, "comment_id": 53309505, "body": "yes I get it as a string, consider I have the string of the node"}], "answers": [{"comments": [{"owner": {"reputation": 1932, "user_id": 375666, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/d33159b0c328adefa8e7cd2d6d814337?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed Saleh", "link": "https://stackoverflow.com/users/375666/ahmed-saleh"}, "edited": false, "score": 0, "creation_date": 1442996501, "post_id": 32734255, "comment_id": 53309904, "body": "can you provide an iterative solution please ? Thanks for your recursive solution"}, {"owner": {"reputation": 7267, "user_id": 1051621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JAEvg.jpg?s=128&g=1", "display_name": "Mark Shevchenko", "link": "https://stackoverflow.com/users/1051621/mark-shevchenko"}, "reply_to_user": {"reputation": 1932, "user_id": 375666, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/d33159b0c328adefa8e7cd2d6d814337?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed Saleh", "link": "https://stackoverflow.com/users/375666/ahmed-saleh"}, "edited": false, "score": 2, "creation_date": 1442996769, "post_id": 32734255, "comment_id": 53310052, "body": "@AhmedSaleh, As a joke yes, I can. Seriously I can&#39;t cause this function should collect nodes of the path in a data structure like a stack."}, {"owner": {"reputation": 1932, "user_id": 375666, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/d33159b0c328adefa8e7cd2d6d814337?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed Saleh", "link": "https://stackoverflow.com/users/375666/ahmed-saleh"}, "edited": false, "score": 0, "creation_date": 1442996813, "post_id": 32734255, "comment_id": 53310073, "body": "Can you write the pseudo code for the iterative function using a stack ? and I will reformat it using my code ?"}, {"owner": {"reputation": 7267, "user_id": 1051621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JAEvg.jpg?s=128&g=1", "display_name": "Mark Shevchenko", "link": "https://stackoverflow.com/users/1051621/mark-shevchenko"}, "reply_to_user": {"reputation": 1932, "user_id": 375666, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/d33159b0c328adefa8e7cd2d6d814337?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed Saleh", "link": "https://stackoverflow.com/users/375666/ahmed-saleh"}, "edited": false, "score": 0, "creation_date": 1442997301, "post_id": 32734255, "comment_id": 53310351, "body": "@AhmedSaleh Sure, I did it in C."}, {"owner": {"reputation": 1932, "user_id": 375666, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/d33159b0c328adefa8e7cd2d6d814337?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed Saleh", "link": "https://stackoverflow.com/users/375666/ahmed-saleh"}, "edited": false, "score": 0, "creation_date": 1442997594, "post_id": 32734255, "comment_id": 53310520, "body": "@what&#39;s wrong with the joke iterative method? why it won&#39;t work ? or does it have a problem ?"}, {"owner": {"reputation": 7267, "user_id": 1051621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JAEvg.jpg?s=128&g=1", "display_name": "Mark Shevchenko", "link": "https://stackoverflow.com/users/1051621/mark-shevchenko"}, "reply_to_user": {"reputation": 1932, "user_id": 375666, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/d33159b0c328adefa8e7cd2d6d814337?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed Saleh", "link": "https://stackoverflow.com/users/375666/ahmed-saleh"}, "edited": false, "score": 1, "creation_date": 1442997900, "post_id": 32734255, "comment_id": 53310685, "body": "@AhmedSaleh This method would work, but in this case the result is achieved in not very obvious way. The algorithm reverses each name at each iteration and collect them in reversed buffer. Finally, it reverses this buffer to achieve correct path."}, {"owner": {"reputation": 6288, "user_id": 1455631, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d9b8e88a8dbed8a574ed79d075c3f924?s=128&d=identicon&r=PG", "display_name": "Medinoc", "link": "https://stackoverflow.com/users/1455631/medinoc"}, "edited": false, "score": 0, "creation_date": 1442999209, "post_id": 32734255, "comment_id": 53311470, "body": "For the recursive version: Since you&#39;re concatenating during the &quot;unstacking&quot; phase, while you&#39;re at it, you should compute the actual needed buffer length on the &quot;stacking&quot; phase, so you can actually allocate a buffer of the right length and return it."}, {"owner": {"reputation": 6288, "user_id": 1455631, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d9b8e88a8dbed8a574ed79d075c3f924?s=128&d=identicon&r=PG", "display_name": "Medinoc", "link": "https://stackoverflow.com/users/1455631/medinoc"}, "edited": false, "score": 1, "creation_date": 1442999380, "post_id": 32734255, "comment_id": 53311562, "body": "For the iterative version, another possibility, given the buffer <i>and its length</i> as argument, would be filling the buffer from the end like a stack; and at the end, either returning a pointer to the actual string start within it, or re-aligning the contents with <code>memmove</code>. I&#39;ve used the former for some <code>itoa</code>-esque function."}, {"owner": {"reputation": 7267, "user_id": 1051621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JAEvg.jpg?s=128&g=1", "display_name": "Mark Shevchenko", "link": "https://stackoverflow.com/users/1051621/mark-shevchenko"}, "reply_to_user": {"reputation": 6288, "user_id": 1455631, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d9b8e88a8dbed8a574ed79d075c3f924?s=128&d=identicon&r=PG", "display_name": "Medinoc", "link": "https://stackoverflow.com/users/1455631/medinoc"}, "edited": false, "score": 1, "creation_date": 1442999630, "post_id": 32734255, "comment_id": 53311725, "body": "@Medinoc, thanks for the comment. I don&#39;t know what strategy Ahmed uses to manage a memory, so I just shows the method, and show nothing about a strategy. The function can allocate memory, or it can check for an overflow, or it can return a size of required memory \u2014 all these strategies are possible."}, {"owner": {"reputation": 1932, "user_id": 375666, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/d33159b0c328adefa8e7cd2d6d814337?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed Saleh", "link": "https://stackoverflow.com/users/375666/ahmed-saleh"}, "edited": false, "score": 0, "creation_date": 1443081137, "post_id": 32734255, "comment_id": 53351704, "body": "@MarkShevchenko what if the buffer is unknown size, If I don&#39;t know how large is the path is, what should I do then ?"}, {"owner": {"reputation": 7267, "user_id": 1051621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JAEvg.jpg?s=128&g=1", "display_name": "Mark Shevchenko", "link": "https://stackoverflow.com/users/1051621/mark-shevchenko"}, "reply_to_user": {"reputation": 1932, "user_id": 375666, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/d33159b0c328adefa8e7cd2d6d814337?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed Saleh", "link": "https://stackoverflow.com/users/375666/ahmed-saleh"}, "edited": false, "score": 0, "creation_date": 1443093131, "post_id": 32734255, "comment_id": 53358780, "body": "@AhmedSaleh, You can make two decisions: 1) allocate a memory inside your functions like <code>buildPath</code>; 2) delegate memory allocations to a customer of your functions. In first case allocate enough large buffer at function&#39;s start and check overflow before each <code>strcat</code>. In second case make pair function <code>calculatePathLength</code> and call <code>strlen</code> instead of <code>strcat</code>."}], "tags": [], "owner": {"reputation": 7267, "user_id": 1051621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JAEvg.jpg?s=128&g=1", "display_name": "Mark Shevchenko", "link": "https://stackoverflow.com/users/1051621/mark-shevchenko"}, "is_accepted": true, "score": 4, "last_activity_date": 1442997272, "last_edit_date": 1442997272, "creation_date": 1442995882, "answer_id": 32734255, "question_id": 32734133, "link": "https://stackoverflow.com/questions/32734133/getting-a-path-by-traversing-backward-a-linkedlist-tree-structure/32734255#32734255", "title": "Getting a path by traversing backward a linkedlist tree structure", "body": "<p>To make this action you can use recursive function that calls itself to find a root and then appends <em>names</em> of <em>nodes</em> to some buffer.</p>\n\n<p>Example:</p>\n\n<pre><code>void buildPath(Node* node, char* buffer)\n{\n    if (node-&gt;parent != NULL)\n        buildPath(node-&gt;parent, buffer);\n    else\n        strcpy(\"\", buffer);\n\n    strcat(buffer, node-&gt;name);\n}\n</code></pre>\n\n<p>Joke iterative example (don't do it!):</p>\n\n<pre><code>void buildPath(Node* node, char* buffer)\n{\n    strcpy(\"\", buffer);\n\n    do {\n        strrev(node-&gt;name);\n        strcat(node-&gt;name, buffer);\n        strrev(node-&gt;name);\n\n        node = node-&gt;parent;\n    } while (node != NULL);\n\n    strrev(buffer);\n}\n</code></pre>\n\n<p>Simple stack iterative example:</p>\n\n<pre><code>void buildPath(Node* node, char* buffer)\n{\n    const size_t MAX_STACK_SIZE = 1024;\n    char* stack[MAX_STACK_SIZE];\n    char** top = stack;\n\n    do {\n        *top++ = node-&gt;name; // Stack overflow can occurs here!!!\n        node = node-&gt;parent;\n    } while (node != NULL);\n\n    strcpy(\"\", buffer);\n\n    do {\n        strcat(buffer, *top--);\n    } while (top &gt; stack);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6288, "user_id": 1455631, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d9b8e88a8dbed8a574ed79d075c3f924?s=128&d=identicon&r=PG", "display_name": "Medinoc", "link": "https://stackoverflow.com/users/1455631/medinoc"}, "is_accepted": false, "score": 2, "last_activity_date": 1443002145, "creation_date": 1443002145, "answer_id": 32736379, "question_id": 32734133, "link": "https://stackoverflow.com/questions/32734133/getting-a-path-by-traversing-backward-a-linkedlist-tree-structure/32736379#32736379", "title": "Getting a path by traversing backward a linkedlist tree structure", "body": "<p>Due to demand from @Ahmed Saleh, I have made a full example for the iterative with buffer and length. It is, however, uncommented.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nstruct node { struct node *parent; char const * name; };\n\nchar* PushString(char* buffer, char* currentPosition, char const *toAdd)\n{\n    if(buffer == NULL || currentPosition == NULL)\n        return NULL;\n    if(toAdd == NULL)\n        return currentPosition;\n\n    {\n        size_t freeSpace = currentPosition - buffer;\n        size_t length = strlen(toAdd);\n        if(length &gt; freeSpace)\n            return NULL;\n        currentPosition -= length;\n        //Note: I'm using a sizeof here, to avoid bad surprises\n        //when this code is someday converted to use wchar_t instead of char\n        memcpy(currentPosition, toAdd, length * sizeof(*toAdd));\n        return currentPosition;\n    }\n}\n\nchar* BuildPath(struct node const* theNode, char *buffer, size_t bufferSize)\n{\n    char * currentPosition = buffer + bufferSize;\n    if(buffer==NULL || bufferSize==0)\n        return NULL;\n\n    *(--currentPosition) = '\\0';\n\n    while(theNode != NULL)\n    {\n        currentPosition = PushString(buffer, currentPosition, theNode-&gt;name);\n        if(currentPosition == NULL)\n            return NULL;\n        currentPosition = PushString(buffer, currentPosition, \"/\");\n        if(currentPosition == NULL)\n            return NULL;\n        theNode = theNode-&gt;parent;\n    }\n    return currentPosition;\n}\n\nint main(void)\n{\n    struct node node1 = { NULL, \"root\" };\n    struct node node2 = { &amp;node1, \"child\" };\n    struct node node3 = { &amp;node2, \"grandchild\" };\n    char buffer[80];\n    char* ret = BuildPath(&amp;node3, buffer, sizeof buffer / sizeof(*buffer));\n    if(ret == NULL)\n    {\n        puts(\"Failed.\");\n        return EXIT_FAILURE;\n    }\n    printf(\"Result: %s\\n\", ret);\n    return EXIT_SUCCESS;\n}\n</code></pre>\n"}], "owner": {"reputation": 1932, "user_id": 375666, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/d33159b0c328adefa8e7cd2d6d814337?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed Saleh", "link": "https://stackoverflow.com/users/375666/ahmed-saleh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 32734255, "answer_count": 2, "score": 1, "last_activity_date": 1443002145, "creation_date": 1442995463, "last_edit_date": 1442995767, "question_id": 32734133, "link": "https://stackoverflow.com/questions/32734133/getting-a-path-by-traversing-backward-a-linkedlist-tree-structure", "title": "Getting a path by traversing backward a linkedlist tree structure", "body": "<p>I have a tree structure like the following </p>\n\n<pre><code>-&gt; grandma\n    -&gt; dad\n        -&gt; me\n        -&gt; sister\n            -&gt; niece\n        -&gt; brother\n    -&gt; uncle\n        -&gt; cousin\n</code></pre>\n\n<p>and I have a struct as following</p>\n\n<pre><code>struct Node{\nNode *parent;\nNode *next;\nNode *child;\nNode *prev;\n}\n</code></pre>\n\n<p>If I have <strong>niece</strong> node, I would like to go back until the root, and save that path in a c string, I don't know how to save the traversed path in a string also. If I have <strong>niece</strong>, it should save the path as, <strong>grandma/data/me/sister/niece</strong></p>\n\n<p>What If I also have <strong>cousin</strong>, and I want to go back to the path, and it should be <strong>grandma/uncle/cousin</strong>, how would I know that uncle is parent is grandma and concatenate it in the full traversed path ?</p>\n"}, {"tags": ["c", "artificial-intelligence", "breadth-first-search"], "answers": [{"comments": [{"owner": {"reputation": 368, "user_id": 4046157, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/G79yX.jpg?s=128&g=1", "display_name": "gkhnavarro", "link": "https://stackoverflow.com/users/4046157/gkhnavarro"}, "edited": false, "score": 0, "creation_date": 1443000227, "post_id": 32734509, "comment_id": 53312118, "body": "Fixed the crash, thanks. But program ended up looping. Will check for more bugs. Thanks. :)"}], "tags": [], "owner": {"reputation": 2324, "user_id": 5334131, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JU6Bo.jpg?s=128&g=1", "display_name": "Hellmar Becker", "link": "https://stackoverflow.com/users/5334131/hellmar-becker"}, "is_accepted": false, "score": 2, "last_activity_date": 1442996789, "creation_date": 1442996789, "answer_id": 32734509, "question_id": 32734044, "link": "https://stackoverflow.com/questions/32734044/breadth-first-search-suddenly-crashes/32734509#32734509", "title": "Breadth first search suddenly crashes", "body": "<p>In the enqueue function, you should allocate the new nodes as (Qnode*)malloc(sizeof(<strong>Qnode</strong>)) (instead of (Qnode*)). The code you wrote allocates only the size of a pointer for each struct, so any write to such an object will stomp on some other object's memory.</p>\n"}], "owner": {"reputation": 368, "user_id": 4046157, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/G79yX.jpg?s=128&g=1", "display_name": "gkhnavarro", "link": "https://stackoverflow.com/users/4046157/gkhnavarro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1442996789, "creation_date": 1442995165, "question_id": 32734044, "link": "https://stackoverflow.com/questions/32734044/breadth-first-search-suddenly-crashes", "title": "Breadth first search suddenly crashes", "body": "<p>I'm trying to implement BFS on a 400x200 grid that inputs a text file with an ordered starting pair and an ordered ending pair. I used a queue to keep track of opened nodes and an array to keep tracked of closed nodes. My program keeps crashing at random on the same input while checking for opened nodes in the queue.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;conio.h&gt;\n#include &lt;stdlib.h&gt;\n\n\ntypedef struct Node Node;\ntypedef struct Qnode Qnode;\n\nstruct Node{\n    Node* up;\n    Node* down;\n    Node* left;\n    Node* right;\n    int xpos;\n    int ypos;\n    int marked;\n};\nstruct Qnode{\n    Qnode* next;\n    Node* Gnode; \n};\nQnode* front = NULL;\nQnode* rear = NULL;\nint queuesize = 0;\nint solutioncost = 0;\nNode* closednodes[80000];\nint nodesclosed = 0;\n\nvoid enqueue(Node* node){\n    if (queuesize == 0){\n        rear = (Qnode*)malloc(sizeof(Qnode*));\n        rear-&gt;Gnode = node;\n        rear-&gt;next = NULL;\n        front = rear;\n    }\n    else{\n        Qnode* temp = (Qnode*)malloc(sizeof(Qnode*));\n        rear-&gt;next = temp;\n        temp-&gt;Gnode = node;\n        temp-&gt;next = NULL;\n        rear = temp;\n    }\n        queuesize++;\n}\n\nNode* dequeue(){\n    Qnode* temp = front;\n    if (queuesize == 0){\n        printf(\"Error!\");\n    }\n    else{\n        Node* temp1 = front-&gt;Gnode;\n        temp = temp-&gt;next;\n        free(front);\n        front = temp;\n        queuesize--;\n        return temp1;\n    }\n\n}\n\nNode* generate(int x, int y){\n    printf(\"Generating node (%d,%d)...\\n\", x, y);\n    if ((x &gt;0 &amp;&amp; x &lt;=400) &amp;&amp; (y &gt;0 &amp;&amp; y &lt;=200)){\n    Node* temp = (Node*)malloc(sizeof(Node));\n    temp-&gt;xpos = x;\n    temp-&gt;ypos = y;\n    temp-&gt;marked = 0;\n    temp-&gt;up = NULL;\n    temp-&gt;down = NULL;\n    temp-&gt;left = NULL;\n    temp-&gt;right = NULL;\n    return temp;\n    }\n    else{\n        printf(\"Invalid starting point! \\n\");\n    }\n}\n\nvoid expand(Node* node, int xend, int yend){\n    int flag = 0;\n    closednodes[nodesclosed] = node;\n    nodesclosed++;\n    dequeue();\n    if(node-&gt;marked == 1){\n        printf(\"already expanded\");\n    }\n\n    else{\n        printf(\"Expanding node (%d, %d)...\\n\", node-&gt;xpos, node-&gt;ypos);\n        node-&gt;marked = 1;\n        if (node-&gt;xpos == xend &amp;&amp; node-&gt;ypos == yend){\n            printf(\"Node reached!\");\n            queuesize = 0; \n            return;\n        }\n        if (node-&gt;xpos-1 &gt;0 &amp;&amp; node-&gt;left == NULL){\n            int k = 0;\n            int j = 0;\n            Qnode* temp2 = front;\n            printf(\"%d\", queuesize);\n            for(k; k&lt;queuesize; k++){\n                int xx = temp2-&gt;Gnode-&gt;xpos;\n                int yy = temp2-&gt;Gnode-&gt;ypos;\n                printf(\"%d, %d,\\n\", xx, yy);\n                if (xx == node-&gt;xpos-1 &amp;&amp; yy == node-&gt;ypos)\n                    flag = 1;\n                temp2 = temp2-&gt;next;\n                }\n            for(j; j&lt;nodesclosed; j++){\n                int xx = closednodes[j]-&gt;xpos;\n                int yy = closednodes[j]-&gt;ypos;\n                if (xx == node-&gt;xpos-1 &amp;&amp; yy == node-&gt;ypos)\n                    flag = 1;\n            }\n            if (flag == 0){\n                node-&gt;left = generate(node-&gt;xpos-1, node-&gt;ypos);\n                node-&gt;left-&gt;right = node-&gt;left;\n                enqueue(node-&gt;left);\n            }\n            else{\n                printf(\"(%d, %d) not generated.\\n\", node-&gt;xpos-1, node-&gt;ypos);\n                flag = 0;\n            }\n        }\n        if (node-&gt;xpos+1 &lt;=400 &amp;&amp; node-&gt;right ==NULL){\n        int k = 0;\n        int j = 0;\n        Qnode* temp2 = front;\n            for(k; k&lt;queuesize; k++){\n                int xx = temp2-&gt;Gnode-&gt;xpos;\n                int yy = temp2-&gt;Gnode-&gt;ypos;\n                printf(\"%d, %d,\\n\", xx, yy);\n                if (xx == node-&gt;xpos+1 &amp;&amp; yy == node-&gt;ypos)\n                    flag = 1;\n                temp2 = temp2-&gt;next;\n                }\n\n            for(j; j&lt;nodesclosed; j++){\n                int xx = closednodes[j]-&gt;xpos;\n                int yy = closednodes[j]-&gt;ypos;\n                if (xx == node-&gt;xpos+1 &amp;&amp; yy == node-&gt;ypos)\n                    flag = 1;\n            }\n            if (flag == 0){\n                node-&gt;right = generate(node-&gt;xpos+1, node-&gt;ypos);\n                node-&gt;right-&gt;left = node-&gt;right;\n                enqueue(node-&gt;right);\n            }\n            else{\n                printf(\"(%d, %d) not generated.\\n\", node-&gt;xpos+1, node-&gt;ypos);\n                flag = 0;\n            }\n        }\n        if (node-&gt;ypos+1 &lt;=200 &amp;&amp; node-&gt;up ==NULL){\n        int k = 0;\n        int j = 0;\n        Qnode* temp2 = front;\n        printf(\"%d\", queuesize);\n            for(k; k&lt;queuesize; k++){\n                int xx = temp2-&gt;Gnode-&gt;xpos;\n                int yy = temp2-&gt;Gnode-&gt;ypos;\n                if (xx == node-&gt;xpos &amp;&amp; yy == node-&gt;ypos+1)\n                    flag = 1;\n                temp2 = temp2-&gt;next;\n                }\n\n\n            for(j; j&lt;nodesclosed; j++){\n                int xx = closednodes[j]-&gt;xpos;\n                int yy = closednodes[j]-&gt;ypos;\n                if (xx == node-&gt;xpos &amp;&amp; yy == node-&gt;ypos+1)\n                    flag = 1;\n            }\n\n            if (flag ==0){\n                node-&gt;up = generate(node-&gt;xpos, node-&gt;ypos+1);\n                node-&gt;up-&gt;down = node-&gt;up;\n                enqueue(node-&gt;up);\n            }\n            else{\n                printf(\"(%d, %d) not generated.\\n\", node-&gt;xpos, node-&gt;ypos+1);\n            flag = 0;\n            }\n        }\n        if (node-&gt;ypos-1 &gt;0 &amp;&amp; node-&gt;down ==NULL){\n        int k = 0;\n        int j = 0;\n        Qnode* temp2 = front;\n            for(k; k&lt;queuesize; k++){\n                int xx = temp2-&gt;Gnode-&gt;xpos;\n                int yy = temp2-&gt;Gnode-&gt;ypos;\n                printf(\"%d, %d,\\n\", xx, yy);\n                if (xx == node-&gt;xpos &amp;&amp; yy == node-&gt;ypos-1)\n                    flag = 1;\n                temp2 = temp2-&gt;next;\n                }\n\n            for(j; j&lt;nodesclosed; j++){\n                int xx = closednodes[j]-&gt;xpos;\n                int yy = closednodes[j]-&gt;ypos;\n                if (xx == node-&gt;xpos &amp;&amp; yy == node-&gt;ypos-1)\n                    flag = 1;\n            }\n            if (flag ==0){\n                node-&gt;down = generate(node-&gt;xpos, node-&gt;ypos-1);\n                node-&gt;down-&gt;up = node-&gt;down;\n                enqueue(node-&gt;down);\n            }\n            else{\n            printf(\"(%d, %d) not generated.\\n\", node-&gt;xpos, node-&gt;ypos-1);\n            flag = 0;\n            }\n        }\n        printf(\"EXPANSION ENDS\\n\");\n        return;\n    }\n\n}\n\nint main(){\n    int x_start, y_start, x_end, y_end;\n    FILE *fp;\n    fp = fopen(\"testfile.txt\", \"r\");\n    if (fp == NULL)\n        printf(\"Error printing output. \\n\");\n    else\n    fscanf(fp, \"(%d,%d)\\n\", &amp;x_start, &amp;y_start);\n    fscanf(fp, \"(%d,%d)\\n\", &amp;x_end, &amp;y_end);\n    printf(\"Starting point is (%d, %d)\\n\", x_start, y_start);\n    printf(\"Ending point is (%d, %d)\\n\", x_end, y_end);\n\n    Node* start = generate(x_start, y_start);\n    enqueue(start);\n    while(queuesize!=0){\n    expand(front-&gt;Gnode, x_end, y_end);\n    }\n\n    fclose(fp);\n}\n</code></pre>\n\n<p>using testfile.txt</p>\n\n<pre><code>(1,1)\n(50,50)\n</code></pre>\n\n<p>this input will cause the program to crash at random. I am suspecting I have a problem with my queue.</p>\n"}, {"tags": ["c", "hex", "fopen"], "comments": [{"owner": {"reputation": 11406, "user_id": 282614, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9cd35c711e222946f9503628827a32ce?s=128&d=identicon&r=PG", "display_name": "Dacav", "link": "https://stackoverflow.com/users/282614/dacav"}, "edited": false, "score": 0, "creation_date": 1442994359, "post_id": 32733751, "comment_id": 53308799, "body": "What is the question again?"}, {"owner": {"reputation": 23, "user_id": 3908204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35ed09c8df88458375347c34b221289e?s=128&d=identicon&r=PG&f=1", "display_name": "enesdisli", "link": "https://stackoverflow.com/users/3908204/enesdisli"}, "reply_to_user": {"reputation": 11406, "user_id": 282614, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9cd35c711e222946f9503628827a32ce?s=128&d=identicon&r=PG", "display_name": "Dacav", "link": "https://stackoverflow.com/users/282614/dacav"}, "edited": false, "score": 0, "creation_date": 1442994518, "post_id": 32733751, "comment_id": 53308873, "body": "ah sorry, here it is;&quot;what&#39;s wrong with bigger tiffs or this piece of code?&quot;"}, {"owner": {"reputation": 102099, "user_id": 1600898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/01377f8b31f24b0265854666b29d0c03?s=128&d=identicon&r=PG", "display_name": "user4815162342", "link": "https://stackoverflow.com/users/1600898/user4815162342"}, "edited": false, "score": 1, "creation_date": 1442994605, "post_id": 32733751, "comment_id": 53308931, "body": "When EOF is just reached, <code>fgetc(fsrc)</code> will return a special end-of-file marker, defined as the EOF preprocessor symbol (with the value of -1). You must not attempt to write that value into the destination file. Instead, use something like <code>int c; while ((c = fgetc(fsrc)) != EOF) fputc(c, fdst);</code>"}, {"owner": {"reputation": 23, "user_id": 3908204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35ed09c8df88458375347c34b221289e?s=128&d=identicon&r=PG&f=1", "display_name": "enesdisli", "link": "https://stackoverflow.com/users/3908204/enesdisli"}, "edited": false, "score": 0, "creation_date": 1442994765, "post_id": 32733751, "comment_id": 53309009, "body": "but again, im not having problem with small images altough there is this &quot;-1&quot;"}, {"owner": {"reputation": 11406, "user_id": 282614, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9cd35c711e222946f9503628827a32ce?s=128&d=identicon&r=PG", "display_name": "Dacav", "link": "https://stackoverflow.com/users/282614/dacav"}, "edited": false, "score": 2, "creation_date": 1442994786, "post_id": 32733751, "comment_id": 53309020, "body": "I don&#39;t see correlation with your code and the tiff format. Your code is simply implementing a binary copy. Have you tried with an arbitrary file (e.g. zeros from <code>&#47;dev&#47;zero</code>, assuming you are on Unix) and different sizes?"}, {"owner": {"reputation": 11406, "user_id": 282614, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9cd35c711e222946f9503628827a32ce?s=128&d=identicon&r=PG", "display_name": "Dacav", "link": "https://stackoverflow.com/users/282614/dacav"}, "reply_to_user": {"reputation": 102099, "user_id": 1600898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/01377f8b31f24b0265854666b29d0c03?s=128&d=identicon&r=PG", "display_name": "user4815162342", "link": "https://stackoverflow.com/users/1600898/user4815162342"}, "edited": false, "score": 0, "creation_date": 1442994859, "post_id": 32733751, "comment_id": 53309051, "body": "@user4815162342, I think the <code>!feof</code> handles the <code>EOF</code> return value"}, {"owner": {"reputation": 23, "user_id": 3908204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35ed09c8df88458375347c34b221289e?s=128&d=identicon&r=PG&f=1", "display_name": "enesdisli", "link": "https://stackoverflow.com/users/3908204/enesdisli"}, "reply_to_user": {"reputation": 11406, "user_id": 282614, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9cd35c711e222946f9503628827a32ce?s=128&d=identicon&r=PG", "display_name": "Dacav", "link": "https://stackoverflow.com/users/282614/dacav"}, "edited": false, "score": 0, "creation_date": 1442995142, "post_id": 32733751, "comment_id": 53309231, "body": "@Dacav checking 3th and 4th bytes to see if its tiff(tiff structure). assume im feeding it with tiffs. i tried different sizes, small size works, biggers dont."}, {"owner": {"reputation": 5767, "user_id": 27800, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f8d805c02bfa80a79df1381984ac5d3a?s=128&d=identicon&r=PG", "display_name": "Peter Miehle", "link": "https://stackoverflow.com/users/27800/peter-miehle"}, "edited": false, "score": 0, "creation_date": 1442996781, "post_id": 32733751, "comment_id": 53310058, "body": "open the read for binary, but open the write for non-binary?"}, {"owner": {"reputation": 102099, "user_id": 1600898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/01377f8b31f24b0265854666b29d0c03?s=128&d=identicon&r=PG", "display_name": "user4815162342", "link": "https://stackoverflow.com/users/1600898/user4815162342"}, "reply_to_user": {"reputation": 11406, "user_id": 282614, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9cd35c711e222946f9503628827a32ce?s=128&d=identicon&r=PG", "display_name": "Dacav", "link": "https://stackoverflow.com/users/282614/dacav"}, "edited": false, "score": 0, "creation_date": 1442996898, "post_id": 32733751, "comment_id": 53310120, "body": "@Dacav <code>feof()</code> will return true only <b>after</b> the EOF has been encountered by a read operation. By that time the <code>EOF</code> terminator will have been read from the file, and bogusly written to the destination."}, {"owner": {"reputation": 23, "user_id": 3908204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35ed09c8df88458375347c34b221289e?s=128&d=identicon&r=PG&f=1", "display_name": "enesdisli", "link": "https://stackoverflow.com/users/3908204/enesdisli"}, "reply_to_user": {"reputation": 5767, "user_id": 27800, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f8d805c02bfa80a79df1381984ac5d3a?s=128&d=identicon&r=PG", "display_name": "Peter Miehle", "link": "https://stackoverflow.com/users/27800/peter-miehle"}, "edited": false, "score": 0, "creation_date": 1442997285, "post_id": 32733751, "comment_id": 53310344, "body": "@PeterMiehle You made my day. Thank you  a lot!"}], "answers": [{"tags": [], "owner": {"reputation": 102099, "user_id": 1600898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/01377f8b31f24b0265854666b29d0c03?s=128&d=identicon&r=PG", "display_name": "user4815162342", "link": "https://stackoverflow.com/users/1600898/user4815162342"}, "is_accepted": true, "score": 1, "last_activity_date": 1442997055, "creation_date": 1442997055, "answer_id": 32734588, "question_id": 32733751, "link": "https://stackoverflow.com/questions/32733751/reading-writing-tiff-images-c/32734588#32734588", "title": "reading/writing tiff images C", "body": "<p>There are two problems with the presented code:</p>\n\n<ol>\n<li><p>It opens the destination file in text mode. Use <code>fopen(dstFileName, \"wb\")</code> instead.</p></li>\n<li><p>When EOF is reached, <code>fgetc(fsrc)</code> will return a special end-of-file marker, defined as the EOF preprocessor symbol (with the value of -1). This value must not be written into the destination file. A correct look would be something like: <code>int c; while ((c = fgetc(fsrc)) != EOF) fputc(c, fdst);</code></p></li>\n</ol>\n"}], "owner": {"reputation": 23, "user_id": 3908204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35ed09c8df88458375347c34b221289e?s=128&d=identicon&r=PG&f=1", "display_name": "enesdisli", "link": "https://stackoverflow.com/users/3908204/enesdisli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 295, "favorite_count": 0, "accepted_answer_id": 32734588, "answer_count": 1, "score": -4, "last_activity_date": 1443000860, "creation_date": 1442994092, "last_edit_date": 1443000860, "question_id": 32733751, "link": "https://stackoverflow.com/questions/32733751/reading-writing-tiff-images-c", "title": "reading/writing tiff images C", "body": "<p>im working on tiff images. I shouldnt use any libraries to do so. </p>\n\n<pre><code>void copy(char *srcFilename, char *dstFileName)\n{\n  FILE *fsrc, *fdst;\n  char c;\n\n  printf(\"Inside copy function\\n\");\n  fsrc=fopen(srcFilename, \"rb\");\n\n  if (fsrc==NULL) \n  {\n    printf(\"Couldn't open file %s for reading.\\n\", srcFilename);\n    exit(0);\n  }\n\n  /* Add usual error check */\n  fdst=fopen (dstFileName, \"w\");\n  /*Add usual error check */\n  for ( ; !feof(fsrc); )\n  fputc (fgetc (fsrc), fdst);\n\n  fclose (fsrc);\n  fclose (fdst);\n}\n</code></pre>\n\n<p>this function should copy a tiff image. It works for small tiff images but when its bigger, the output cannot be shown as tiff and i can see its format being changed(by comparing hexa values)</p>\n"}, {"tags": ["c", "algorithm", "tree", "binary-tree"], "comments": [{"owner": {"reputation": 165, "user_id": 5339317, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ef7d9ad172fb2e77f8be8c55417588d4?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/5339317/andre"}, "reply_to_user": {"reputation": 33821, "user_id": 45685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/y4RJr.jpg?s=128&g=1", "display_name": "AndersK", "link": "https://stackoverflow.com/users/45685/andersk"}, "edited": false, "score": 0, "creation_date": 1442993074, "post_id": 32733353, "comment_id": 53308051, "body": "I don&#39;t need additonal array with pointers"}, {"owner": {"reputation": 4671, "user_id": 434408, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/WQ1I9.jpg?s=128&g=1", "display_name": "a3.14_Infinity", "link": "https://stackoverflow.com/users/434408/a3-14-infinity"}, "edited": false, "score": 0, "creation_date": 1442994877, "post_id": 32733353, "comment_id": 53309064, "body": "@andre, btw, the illustration of family tree is nice. :)"}, {"owner": {"reputation": 33821, "user_id": 45685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/y4RJr.jpg?s=128&g=1", "display_name": "AndersK", "link": "https://stackoverflow.com/users/45685/andersk"}, "edited": false, "score": 0, "creation_date": 1443011691, "post_id": 32733353, "comment_id": 53320024, "body": "@andre well i haven&#39;t voted down but if I may guess it is because you haven&#39;t tried a solution yourself and are just asking for one."}, {"owner": {"reputation": 2499, "user_id": 5208760, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/L6VNv.jpg?s=128&g=1", "display_name": "Mateusz", "link": "https://stackoverflow.com/users/5208760/mateusz"}, "edited": false, "score": 0, "creation_date": 1443013016, "post_id": 32733353, "comment_id": 53321032, "body": "Usually you tick an answer when your problem is solved and the answer has provided a solution. I cannot understand why did you change your ticks 3 times already, @andre."}, {"owner": {"reputation": 165, "user_id": 5339317, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ef7d9ad172fb2e77f8be8c55417588d4?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/5339317/andre"}, "reply_to_user": {"reputation": 2499, "user_id": 5208760, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/L6VNv.jpg?s=128&g=1", "display_name": "Mateusz", "link": "https://stackoverflow.com/users/5208760/mateusz"}, "edited": false, "score": 0, "creation_date": 1443014930, "post_id": 32733353, "comment_id": 53322587, "body": "@MateuszKwasniak I have a problem with the iterative solution and the recursive one. when I give the root to the function, the number of deleted nodes are 2747, however the number of created nodes are 5520. Do those functions remove all the nodes and the childeren too?"}, {"owner": {"reputation": 2499, "user_id": 5208760, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/L6VNv.jpg?s=128&g=1", "display_name": "Mateusz", "link": "https://stackoverflow.com/users/5208760/mateusz"}, "edited": false, "score": 0, "creation_date": 1443015189, "post_id": 32733353, "comment_id": 53322817, "body": "I&#39;d ask another question, posting your implementation there and linking this question. I have to take a look at your code to say what&#39;s wrong, @andre."}, {"owner": {"reputation": 165, "user_id": 5339317, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ef7d9ad172fb2e77f8be8c55417588d4?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/5339317/andre"}, "reply_to_user": {"reputation": 2499, "user_id": 5208760, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/L6VNv.jpg?s=128&g=1", "display_name": "Mateusz", "link": "https://stackoverflow.com/users/5208760/mateusz"}, "edited": false, "score": 0, "creation_date": 1443016939, "post_id": 32733353, "comment_id": 53324197, "body": "@MateuszKwasniak I made another question here <a href=\"http://stackoverflow.com/questions/32741705/free-a-binary-tree\">stackoverflow.com/questions/32741705/free-a-binary-tree</a>"}], "answers": [{"comments": [{"owner": {"reputation": 165, "user_id": 5339317, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ef7d9ad172fb2e77f8be8c55417588d4?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/5339317/andre"}, "edited": false, "score": 1, "creation_date": 1442993083, "post_id": 32733437, "comment_id": 53308055, "body": "I don&#39;t want a recursive solution, can you provide an iterative one ?"}, {"owner": {"reputation": 40344, "user_id": 1796579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b14d3685f0765c738fd90c7ec71fa9ba?s=128&d=identicon&r=PG", "display_name": "Henry", "link": "https://stackoverflow.com/users/1796579/henry"}, "reply_to_user": {"reputation": 165, "user_id": 5339317, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ef7d9ad172fb2e77f8be8c55417588d4?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/5339317/andre"}, "edited": false, "score": 0, "creation_date": 1442993322, "post_id": 32733437, "comment_id": 53308200, "body": "@andre it will always be sort of a recursive solution (since it is a recursive data structure). Can be explicit or implicit by simulating a stack with an array."}, {"owner": {"reputation": 165, "user_id": 5339317, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ef7d9ad172fb2e77f8be8c55417588d4?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/5339317/andre"}, "reply_to_user": {"reputation": 40344, "user_id": 1796579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b14d3685f0765c738fd90c7ec71fa9ba?s=128&d=identicon&r=PG", "display_name": "Henry", "link": "https://stackoverflow.com/users/1796579/henry"}, "edited": false, "score": 2, "creation_date": 1442993351, "post_id": 32733437, "comment_id": 53308226, "body": "@Henry I need a pseudo code of the iterative solution please"}, {"owner": {"reputation": 165, "user_id": 5339317, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ef7d9ad172fb2e77f8be8c55417588d4?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/5339317/andre"}, "edited": false, "score": 0, "creation_date": 1442993426, "post_id": 32733437, "comment_id": 53308262, "body": "@MateuszKwasniak what is left and right in my structure is it child and next ? what about parent node ?"}, {"owner": {"reputation": 2499, "user_id": 5208760, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/L6VNv.jpg?s=128&g=1", "display_name": "Mateusz", "link": "https://stackoverflow.com/users/5208760/mateusz"}, "reply_to_user": {"reputation": 165, "user_id": 5339317, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ef7d9ad172fb2e77f8be8c55417588d4?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/5339317/andre"}, "edited": false, "score": 0, "creation_date": 1442993581, "post_id": 32733437, "comment_id": 53308358, "body": "We do not know now how you implementation works. In binary tree, each node has left and right child (and a parent). Look at some binary trees and answer yourself, @andre."}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "reply_to_user": {"reputation": 165, "user_id": 5339317, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ef7d9ad172fb2e77f8be8c55417588d4?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/5339317/andre"}, "edited": false, "score": 1, "creation_date": 1442993999, "post_id": 32733437, "comment_id": 53308610, "body": "@andre, you don&#39;t need the parent node to free the whole tree."}], "tags": [], "owner": {"reputation": 2499, "user_id": 5208760, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/L6VNv.jpg?s=128&g=1", "display_name": "Mateusz", "link": "https://stackoverflow.com/users/5208760/mateusz"}, "is_accepted": true, "score": 4, "last_activity_date": 1550152123, "last_edit_date": 1550152123, "creation_date": 1442993039, "answer_id": 32733437, "question_id": 32733353, "link": "https://stackoverflow.com/questions/32733353/deallocating-binary-tree-structure-in-c/32733437#32733437", "title": "Deallocating binary-tree structure in C", "body": "<p><strong>Recursive depth-search (DFS)</strong>: You're right, it's a good way to dealocate binary-tree memory:</p>\n\n<pre><code>remove(node):\n    if node is null: return\n\n    //else\n    remove(left node)\n    remove(right node)\n\n    free(node)\n</code></pre>\n\n<p><strong>Iterative solution</strong>:\n<a href=\"https://codegolf.stackexchange.com/questions/478/free-a-binary-tree\">https://codegolf.stackexchange.com/questions/478/free-a-binary-tree</a><br>\nSince you don't want to use any recursive solution, there you can find well-described <em>iterative</em> one.</p>\n"}, {"comments": [{"owner": {"reputation": 2499, "user_id": 5208760, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/L6VNv.jpg?s=128&g=1", "display_name": "Mateusz", "link": "https://stackoverflow.com/users/5208760/mateusz"}, "edited": false, "score": 2, "creation_date": 1442993895, "post_id": 32733654, "comment_id": 53308553, "body": "1. He doesn&#39;t want a recursive one. 2. Your code is completely bad atm."}], "tags": [], "owner": {"reputation": 1, "user_id": 5295672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18c6cabfa37faec10d129af3e1e6ca0e?s=128&d=identicon&r=PG&f=1", "display_name": "Hafiz Muhammad Danish", "link": "https://stackoverflow.com/users/5295672/hafiz-muhammad-danish"}, "is_accepted": false, "score": -3, "last_activity_date": 1442994122, "last_edit_date": 1442994122, "creation_date": 1442993766, "answer_id": 32733654, "question_id": 32733353, "link": "https://stackoverflow.com/questions/32733353/deallocating-binary-tree-structure-in-c/32733654#32733654", "title": "Deallocating binary-tree structure in C", "body": "<p>You may use recursive solution </p>\n\n<pre><code>free(root)\n{\n    if (root-&gt;next == null)\n    {\n        free(node)\n    }\n    free(root-&gt;left)\n    free(right-&gt;)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2499, "user_id": 5208760, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/L6VNv.jpg?s=128&g=1", "display_name": "Mateusz", "link": "https://stackoverflow.com/users/5208760/mateusz"}, "edited": false, "score": 0, "creation_date": 1442993946, "post_id": 32733686, "comment_id": 53308574, "body": "Binary trees in arrays are always handsome."}, {"owner": {"reputation": 7267, "user_id": 1051621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JAEvg.jpg?s=128&g=1", "display_name": "Mark Shevchenko", "link": "https://stackoverflow.com/users/1051621/mark-shevchenko"}, "reply_to_user": {"reputation": 2499, "user_id": 5208760, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/L6VNv.jpg?s=128&g=1", "display_name": "Mateusz", "link": "https://stackoverflow.com/users/5208760/mateusz"}, "edited": false, "score": 0, "creation_date": 1442994064, "post_id": 32733686, "comment_id": 53308642, "body": "@MateuszKwasniak And effective in this case. :)"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1442994153, "post_id": 32733686, "comment_id": 53308687, "body": "Not actually going to work, because <code>realloc</code> may move the entire array to a new location in memory, invalidating all of the <code>next</code>, <code>child</code>, and <code>parent</code> pointers."}], "tags": [], "owner": {"reputation": 7267, "user_id": 1051621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JAEvg.jpg?s=128&g=1", "display_name": "Mark Shevchenko", "link": "https://stackoverflow.com/users/1051621/mark-shevchenko"}, "is_accepted": false, "score": 2, "last_activity_date": 1442995437, "last_edit_date": 1442995437, "creation_date": 1442993882, "answer_id": 32733686, "question_id": 32733353, "link": "https://stackoverflow.com/questions/32733353/deallocating-binary-tree-structure-in-c/32733686#32733686", "title": "Deallocating binary-tree structure in C", "body": "<p>You can optimize allocation/deallocation of the tree.</p>\n\n<p>Imagine, you want to create tree with 20 or 30 persons. You can allocate an array of 30 <code>Node</code> structs:</p>\n\n<pre><code>size_t currentArraySize = 30;\nNode* nodes = (Node*)malloc(currentArraySize * sizeof(Node));\nsize_t nextFreeIndex = 0;\n</code></pre>\n\n<p>To add new element you can write simple function:</p>\n\n<pre><code>Node* allocateNode()\n{\n    // Oops! There's not more memory in the buffer.\n    // Lets increase its size.\n    if (nextFreeIndex &gt;= currentArraySize) {\n        currentArraySize *= 2;\n        Node* newNodes = (Node*)realloc(nodes, currentArraySize * sizeof(Node));\n\n        // Should correct pointers (thanks to user3386109)\n        if (newNodes != nodes) {\n            for (size_t i = 0; i &lt; nextFreeIndex; i++) {\n                if (newNodes[i]-&gt;parent != NULL)\n                    newNodes[i]-&gt;parent -= nodes += newNodes;\n                if (newNodes[i]-&gt;next != NULL)\n                    newNodes[i]-&gt;next -= nodes += newNodes;\n                if (newNodes[i]-&gt;child != NULL)\n                    newNodes[i]-&gt;child -= nodes += newNodes;\n            }\n        }\n    }\n\n    return nodes[nextFreeIndex++];\n}\n</code></pre>\n\n<p>To deallocate all nodes you can just <code>free</code> the single pointer <code>nodes</code>.</p>\n\n<p>Now the code looks a little scary as wrote user3386109, so we may simplify it a little:</p>\n\n<pre><code>Node* allocateNode()\n{\n    // Oops! There's not more memory in the buffer.\n    // Lets increase its size.\n    if (nextFreeIndex &gt;= currentArraySize) {\n        currentArraySize *= 2;\n        Node* newNodes = (Node*)realloc(nodes, currentArraySize * sizeof(Node));\n\n        // Should correct pointers (thanks to user3386109)\n        if (newNodes != nodes)\n            correctPointers(newNodes, nodes);\n    }\n\n    return nodes[nextFreeIndex++];\n}\n\n#define correctPointer(pointer, oldOffset, newOffset) if (pointer != NULL) { \\\\\n                                                          pointer -= oldOffset; \\\\\n                                                          pointer += newOffset; \\\\\n                                                      }\n\nvoid correctPointers(Node* newNodes, Node* nodes)\n{\n    for (size_t i = 0; i &lt; nextFreeIndex; i++) {\n        correntPointer(newNodes[i]-&gt;parent, nodes, newNodes);\n        correntPointer(newNodes[i]-&gt;child, nodes, newNodes);\n        correntPointer(newNodes[i]-&gt;next, nodes, newNodes);\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8087, "user_id": 733637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/444bbb295cc6185a5464e2250c1a35de?s=128&d=identicon&r=PG&f=1", "display_name": "CiaPan", "link": "https://stackoverflow.com/users/733637/ciapan"}, "is_accepted": false, "score": 1, "last_activity_date": 1443446388, "last_edit_date": 1443446388, "creation_date": 1442994701, "answer_id": 32733913, "question_id": 32733353, "link": "https://stackoverflow.com/questions/32733353/deallocating-binary-tree-structure-in-c/32733913#32733913", "title": "Deallocating binary-tree structure in C", "body": "<p>Iterative version, inspired by Day\u2013Stout\u2013Warren algorithm:</p>\n\n<pre><code>void removetree(Node *node)\n{\n    while(node != NULL)\n    {\n        Node *temp = node;\n\n        if(node-&gt;child != NULL)\n        {\n            node = node-&gt;child;\n            temp-&gt;child = node-&gt;next;\n            node-&gt;next = temp;\n        }\n        else\n        {\n            node = node-&gt;next;\n            remove(temp);\n        }\n    }\n}\n</code></pre>\n\n<p>This algorithm somewhat like tries to convert the tree into a list single-linked with <code>next</code> pointers, which is very simple to destroy just by iterative unlinking and destroying the first item. However it never completes the conversion, because it unlinks and removes the head node as soon as it can, despite the rest of tree not being converted yet. So to say, it interleaves a <em>relink</em> step with <em>unlink-and-destroy</em> step.</p>\n\n<p>We test with the <code>if</code> instruction whether the first (head) node has any children. If so, we make its child a new head and the current node becomes the new head's <code>next</code> node. This way we have one more <code>next</code> link in the first-level list. What was 'next' to the now-head node becomes a child to a previous-head node, which is now the head's first <code>next</code>.</p>\n\n<p><img src=\"https://i.imgur.com/4io7Wgn.png\" alt=\"transformation step\"></p>\n\n<p>On the other hand if the head node has no children, it may be removed and its <code>next</code> becomes a new head.</p>\n\n<p>These two steps are iterated by the <code>while</code> loop until all children are converted into siblings and removed afterwards.</p>\n"}], "owner": {"reputation": 165, "user_id": 5339317, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ef7d9ad172fb2e77f8be8c55417588d4?s=128&d=identicon&r=PG&f=1", "display_name": "andre", "link": "https://stackoverflow.com/users/5339317/andre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1585, "favorite_count": 0, "accepted_answer_id": 32733437, "answer_count": 4, "score": 0, "last_activity_date": 1550152123, "creation_date": 1442992769, "last_edit_date": 1472446198, "question_id": 32733353, "link": "https://stackoverflow.com/questions/32733353/deallocating-binary-tree-structure-in-c", "title": "Deallocating binary-tree structure in C", "body": "<p>I have a linked list, I guess a tree looks like this:\n <a href=\"https://i.stack.imgur.com/3P8uH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3P8uH.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>-&gt; grandma\n    -&gt; dad\n        -&gt; me\n        -&gt; sister\n            -&gt; niece\n        -&gt; brother\n    -&gt; uncle\n        -&gt; cousin\n</code></pre>\n\n<p>and I have a struct as following</p>\n\n<pre><code>struct Node{\n    Node *parent;\n    Node *next;\n    Node *child;\n}\n</code></pre>\n\n<p>How would I free that linked list?<br>\nMy idea is to do a depth first search and deallocate each node?</p>\n"}, {"tags": ["c", "arrays", "function", "while-loop", "words"], "comments": [{"owner": {"reputation": 69870, "user_id": 457352, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/71fae1115a09663bed6c685c523cb0f0?s=128&d=identicon&r=PG", "display_name": "Benoit", "link": "https://stackoverflow.com/users/457352/benoit"}, "edited": false, "score": 0, "creation_date": 1442992169, "post_id": 32733132, "comment_id": 53307510, "body": "Why not do <code>printf(&quot;%s &quot;, c);</code> with an additional space?"}, {"owner": {"reputation": 1, "user_id": 5361592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c865c3ca9cd6aa9f1c66b57f557b8506?s=128&d=identicon&r=PG&f=1", "display_name": "Mr A", "link": "https://stackoverflow.com/users/5361592/mr-a"}, "reply_to_user": {"reputation": 69870, "user_id": 457352, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/71fae1115a09663bed6c685c523cb0f0?s=128&d=identicon&r=PG", "display_name": "Benoit", "link": "https://stackoverflow.com/users/457352/benoit"}, "edited": false, "score": 0, "creation_date": 1442995746, "post_id": 32733132, "comment_id": 53309528, "body": "Thank you very much! I have no idea how I didn&#39;t think of this."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5361592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c865c3ca9cd6aa9f1c66b57f557b8506?s=128&d=identicon&r=PG&f=1", "display_name": "Mr A", "link": "https://stackoverflow.com/users/5361592/mr-a"}, "edited": false, "score": 0, "creation_date": 1442995778, "post_id": 32733199, "comment_id": 53309551, "body": "Thank you for your help!"}], "tags": [], "owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "is_accepted": false, "score": 0, "last_activity_date": 1442992259, "creation_date": 1442992259, "answer_id": 32733199, "question_id": 32733132, "link": "https://stackoverflow.com/questions/32733132/how-can-i-take-each-word-from-an-array-alone-and-test-if-it-fits-specific-condit/32733199#32733199", "title": "How can I take each word from an array alone and test if it fits specific conditions? (C)", "body": "<p>While printing leave a space in <code>printf</code> in function <code>int vowelwords()</code> -</p>\n\n<pre><code>printf(\"%s \", c);\n          ^ leave a space\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5361592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c865c3ca9cd6aa9f1c66b57f557b8506?s=128&d=identicon&r=PG&f=1", "display_name": "Mr A", "link": "https://stackoverflow.com/users/5361592/mr-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1442992259, "creation_date": 1442992019, "question_id": 32733132, "link": "https://stackoverflow.com/questions/32733132/how-can-i-take-each-word-from-an-array-alone-and-test-if-it-fits-specific-condit", "title": "How can I take each word from an array alone and test if it fits specific conditions? (C)", "body": "<p>I am trying to create a program that reads a sentence from a text file and then prints only the words that do NOT start with a vowel.</p>\n\n<p>So I wrote a program that reads the text file and copies the sentence into an array. Now, I'm struggling with actually testing each word in the array for whether it fits the condition (not starting with a vowel) or not.</p>\n\n<p>So far I can only do that by using the strtok function and using the spaces as delimeters, but that also eliminates the spaces from the sentence, which isn't the desired result.</p>\n\n<p>For example, if the text file contains the following sentence:\nAn apple a day keeps the doctor away.</p>\n\n<p>The output will be:\ndaykeepsthedoctor</p>\n\n<p>While the desired output is:\nday keeps the doctor</p>\n\n<p>Here's my program:</p>\n\n<hr>\n\n<pre><code>#include &lt;stdio.h&gt; \n#include &lt;string.h&gt;\n\nint vowelwords();\n\nint main() \n{\n\n    vowelwords();\n    return 0;\n}\n\nint vowelwords()\n{\n    FILE *fPtr;\n    char text[50];\n    fPtr = fopen(\"TEXT1.txt\",\"r\"); //to open file\n\n    if (fPtr == NULL) //Catch error in fopen function\n    {\n        printf(\"Error in opening file\\n\");\n        return 1;\n    } \n\n    fgets(text, 50, fPtr);\n    fclose(fPtr);\n\n    char *c;\n    c = strtok(text,\" \");\n\n    while(c!= NULL) \n    {\n        if(c[0]=='a'||c[0]=='A'||c[0]=='e'||c[0]=='E'||c[0]=='u'||\n           c[0]=='U'||c[0]=='i'||c[0]=='I'||c[0]=='o'||c[0]=='O')\n        {\n        }\n\n        else  \n        {\n            printf(\"%s\", c);\n        }  \n\n        c = strtok(NULL,\" \");       \n    }\n\n    printf(\"\\n\");\n}\n</code></pre>\n"}, {"tags": ["c", "function"], "comments": [{"owner": {"reputation": 110733, "user_id": 1009479, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/wlrC5.jpg?s=128&g=1", "display_name": "Yu Hao", "link": "https://stackoverflow.com/users/1009479/yu-hao"}, "edited": false, "score": 1, "creation_date": 1442990926, "post_id": 32732789, "comment_id": 53306842, "body": "What is the question?"}, {"owner": {"reputation": 3002, "user_id": 4228131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RyKUe.jpg?s=128&g=1", "display_name": "WedaPashi", "link": "https://stackoverflow.com/users/4228131/wedapashi"}, "edited": false, "score": 3, "creation_date": 1442990971, "post_id": 32732789, "comment_id": 53306862, "body": "We know about Variadic functions. This isn&#39;t a blog site, what is the question?"}, {"owner": {"reputation": 25, "user_id": 3840295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63b6d7f1e3d55a03adbcd81ddcdb690d?s=128&d=identicon&r=PG&f=1", "display_name": "Smita", "link": "https://stackoverflow.com/users/3840295/smita"}, "edited": false, "score": 0, "creation_date": 1442990996, "post_id": 32732789, "comment_id": 53306870, "body": "I had a question but now have answer also, So posting it with answer"}, {"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 0, "creation_date": 1442991113, "post_id": 32732789, "comment_id": 53306938, "body": "Lots of resources do already exist on that topic."}, {"owner": {"reputation": 4791, "user_id": 1609614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lvIBD.jpg?s=128&g=1", "display_name": "Ari0nhh", "link": "https://stackoverflow.com/users/1609614/ari0nhh"}, "edited": false, "score": 0, "creation_date": 1442991138, "post_id": 32732789, "comment_id": 53306954, "body": "This is clear plagiarism from the external site that could be googled in two seconds. What point in posting it here?"}, {"owner": {"reputation": 3002, "user_id": 4228131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RyKUe.jpg?s=128&g=1", "display_name": "WedaPashi", "link": "https://stackoverflow.com/users/4228131/wedapashi"}, "edited": false, "score": 0, "creation_date": 1442991228, "post_id": 32732789, "comment_id": 53307011, "body": "We are glad you found the answer, so there is no need to post a question (rather I don&#39;t see a question at all) for which you already have an answered. This is likely to be deleted."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 2, "creation_date": 1442991329, "post_id": 32732789, "comment_id": 53307064, "body": "Also, while it&#39;s nice to be able to write <code>average(1, 2.3, 4)</code>, this has little use in practice, where your data is usually availale as array, which you can&#39;t convert to an argument list. This is not a good example of when to use variadic functions."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1442991481, "post_id": 32732789, "comment_id": 53307141, "body": "Welcome to Stack Overflow. Please read the <a href=\"https://stackoverflow.com/tour\">About</a> page soon. You are explicitly allowed to <a href=\"https://stackoverflow.com/help/self-answer\">self-answer</a> a question. But it must meet the site requirements: there must be a question at the top (without the answer) and a separate answer below (usually without most of the question). So, you need to edit your question so it contains just the question, and you need to add an answer that contains the answer. Is there another question on SO about &quot;How to handle a counted but variable number of arguments?&quot;? When is it better to use a count and an array?"}, {"owner": {"reputation": 4791, "user_id": 1609614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lvIBD.jpg?s=128&g=1", "display_name": "Ari0nhh", "link": "https://stackoverflow.com/users/1609614/ari0nhh"}, "reply_to_user": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1442991490, "post_id": 32732789, "comment_id": 53307147, "body": "@MOehm Well technically you could push them to the stack in the loop. But it hardly could be perceived as a good method)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1442991838, "post_id": 32732789, "comment_id": 53307325, "body": "@Smita So, you have an answer you don&#39;t understand? Then post a question <i>about exactly that</i>. There&#39;s no need to give a whole lecture about variadic functions --- and then forgetting to put the actual question..."}, {"owner": {"reputation": 3002, "user_id": 4228131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RyKUe.jpg?s=128&g=1", "display_name": "WedaPashi", "link": "https://stackoverflow.com/users/4228131/wedapashi"}, "edited": false, "score": 0, "creation_date": 1442991839, "post_id": 32732789, "comment_id": 53307326, "body": "In <code>va_start(arguments, num);</code>, <code>arguments</code> is of the type <code>va_list</code>, more precisely uninitialized object of type <code>va_list</code>.  It carries the information needed to retrieve the additional arguments using <code>va_arg</code>"}, {"owner": {"reputation": 3002, "user_id": 4228131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RyKUe.jpg?s=128&g=1", "display_name": "WedaPashi", "link": "https://stackoverflow.com/users/4228131/wedapashi"}, "edited": false, "score": 0, "creation_date": 1442991882, "post_id": 32732789, "comment_id": 53307343, "body": "@FelixPalmen: Oh, she deleted the question right-away :D"}, {"owner": {"reputation": 3002, "user_id": 4228131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RyKUe.jpg?s=128&g=1", "display_name": "WedaPashi", "link": "https://stackoverflow.com/users/4228131/wedapashi"}, "edited": false, "score": 0, "creation_date": 1442992051, "post_id": 32732789, "comment_id": 53307437, "body": "I think it can be a duplicate after she has edited it, but definitely not Unclear now. Consider reopening it, and then may be close it off as a duplicate if it is. @Felix ?"}, {"owner": {"reputation": 1497, "user_id": 4843379, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a3681737b6e2ecc037c83474eed2309c?s=128&d=identicon&r=PG&f=1", "display_name": "incompetent", "link": "https://stackoverflow.com/users/4843379/incompetent"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1442992074, "post_id": 32732789, "comment_id": 53307450, "body": "I think being blunt with new users is not appropriate. guide them in kind way should be the solution like @Jonathan did."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 1497, "user_id": 4843379, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a3681737b6e2ecc037c83474eed2309c?s=128&d=identicon&r=PG&f=1", "display_name": "incompetent", "link": "https://stackoverflow.com/users/4843379/incompetent"}, "edited": false, "score": 0, "creation_date": 1442992721, "post_id": 32732789, "comment_id": 53307815, "body": "@shami closing it was the correct way and yes, now it&#39;s in a shape for reopening. I don&#39;t even think it&#39;s a duplicate, asking specifically about what va_list <i>is</i>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1442994629, "post_id": 32732789, "comment_id": 53308938, "body": "&quot;I am not getting the values that I passed as an argument.&quot;  --&gt; Post the incorrect values you did get."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 3840295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63b6d7f1e3d55a03adbcd81ddcdb690d?s=128&d=identicon&r=PG&f=1", "display_name": "Smita", "link": "https://stackoverflow.com/users/3840295/smita"}, "edited": false, "score": 0, "creation_date": 1443007474, "post_id": 32734056, "comment_id": 53317062, "body": "Thank you ! But I really don&#39;t want to rely on it. I want to know how they are handled internally."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 25, "user_id": 3840295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63b6d7f1e3d55a03adbcd81ddcdb690d?s=128&d=identicon&r=PG&f=1", "display_name": "Smita", "link": "https://stackoverflow.com/users/3840295/smita"}, "edited": false, "score": 0, "creation_date": 1443008138, "post_id": 32734056, "comment_id": 53317548, "body": "<a href=\"http://blog.aaronballman.com/2012/06/how-variable-argument-lists-work-in-c/\" rel=\"nofollow noreferrer\">Refer here</a> if this is just out of being curious. There&#39;s an example implementation for x86. It gets very &quot;hairy&quot; on amd64 because arguments there are passed in CPU registers. For any <b>serious</b> program, accept <code>va_list</code> as what it is: a blackbox that just does what you expect."}, {"owner": {"reputation": 25, "user_id": 3840295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63b6d7f1e3d55a03adbcd81ddcdb690d?s=128&d=identicon&r=PG&f=1", "display_name": "Smita", "link": "https://stackoverflow.com/users/3840295/smita"}, "edited": false, "score": 0, "creation_date": 1443029106, "post_id": 32734056, "comment_id": 53332266, "body": "What if I want to write my own printf function say myPrintf(). How could I write it ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 25, "user_id": 3840295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63b6d7f1e3d55a03adbcd81ddcdb690d?s=128&d=identicon&r=PG&f=1", "display_name": "Smita", "link": "https://stackoverflow.com/users/3840295/smita"}, "edited": false, "score": 0, "creation_date": 1443029300, "post_id": 32734056, "comment_id": 53332363, "body": "That&#39;s probably just a bad idea, because it&#39;s really complex. You basically have to parse the format string, looking for <code>%</code> sequences and when you find one, get an argument of matching type from <code>va_arg()</code>, convert it as specified to string and append it ..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 25, "user_id": 3840295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63b6d7f1e3d55a03adbcd81ddcdb690d?s=128&d=identicon&r=PG&f=1", "display_name": "Smita", "link": "https://stackoverflow.com/users/3840295/smita"}, "edited": false, "score": 0, "creation_date": 1443029545, "post_id": 32734056, "comment_id": 53332508, "body": "There&#39;s a <a href=\"https://github.com/torvalds/linux/blob/master/arch/x86/boot/printf.c\" rel=\"nofollow noreferrer\">very limited implementation in linux&#39; x86 boot code</a> which I looked at to create <a href=\"https://github.com/Zirias/clang-libdos/blob/master/src/stdio/stdio_printf.c\" rel=\"nofollow noreferrer\">my implementation for my MS-DOS .COM runtime</a> (also quite limited) -- If you&#39;re really in a situation where you NEED to implement your own <code>printf()</code> -- start cursing"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": true, "score": 0, "last_activity_date": 1442995208, "creation_date": 1442995208, "answer_id": 32734056, "question_id": 32732789, "link": "https://stackoverflow.com/questions/32732789/writing-a-function-that-can-accept-any-number-of-arguments-in-c/32734056#32734056", "title": "Writing a function that can accept any number of arguments in C", "body": "<p>Concerning your question: You should not care what <code>arguments</code> really contains, because that depends on your host architecture and the implementation of your compiler. Typically, it could be a pointer to the location on the stack where the next argument can be found, but it could be anything else, too.</p>\n\n<p>The idea behind <code>va_list</code> and the macros around it is to provide a consistent API that you can use <em>in the same way</em> on any architecture to get the arguments, without having to know how they are handled internally. <code>va_list</code> therefore is what you call a <em>black box</em> (use it through its API, don't look inside). Just rely on <code>va_init()</code> and <code>va_arg()</code> to fetch the arguments from it.</p>\n"}], "owner": {"reputation": 25, "user_id": 3840295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63b6d7f1e3d55a03adbcd81ddcdb690d?s=128&d=identicon&r=PG&f=1", "display_name": "Smita", "link": "https://stackoverflow.com/users/3840295/smita"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 32734056, "answer_count": 1, "score": -2, "last_activity_date": 1442995208, "creation_date": 1442990840, "last_edit_date": 1442994546, "question_id": 32732789, "link": "https://stackoverflow.com/questions/32732789/writing-a-function-that-can-accept-any-number-of-arguments-in-c", "title": "Writing a function that can accept any number of arguments in C", "body": "<pre><code>#include &lt;stdarg.h&gt;\n#include &lt;stdio.h&gt;\n\ndouble average ( int num, ... )\n{\n    va_list arguments;                     \n    double sum = 0;\n    int x;\n    /* Initializing arguments to store all values after num */\n    va_start ( arguments, num );        \n    //printf(\"arguments = %d...........num = %d\",arguments,num);\n    for(x = 0; x &lt; num; x++ )        \n    {\n        sum += va_arg ( arguments, double ); \n    }\n    va_end ( arguments );                  // Cleans up the list\n    return sum / num;                      \n}\n\nint main()\n{\n   printf( \"Average 2 = %f\\n\", average ( 3, 12.2, 22.3, 4.5 ) );\n   printf( \"Average 3 = %f\\n\", average ( 5, 3.3, 2.2, 1.1, 5.5, 3.3 ) );\n   printf( \"Average 4 = %f\\n\", average ( 9, 3.3, 2.2, 1.1, 5.5, 3.3, \n       3.10, 13.3, 143.312, 39.35 ) );\n}\n</code></pre>\n\n<p>Here we are using:- <code>va_start ( arguments, num );</code>   </p>\n\n<blockquote>\n  <p>What is arguments contain here ? I am confused with this.\n  When I tried to print it, I am not getting the values that I passed as an argument. Please explain</p>\n</blockquote>\n"}, {"tags": ["c", "docker", "lxc"], "answers": [{"tags": [], "owner": {"reputation": 1299, "user_id": 5241549, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/5d57ade41e2423b259898102429b21eb?s=128&d=identicon&r=PG&f=1", "display_name": "spectre007", "link": "https://stackoverflow.com/users/5241549/spectre007"}, "is_accepted": false, "score": 0, "last_activity_date": 1442991583, "creation_date": 1442991583, "answer_id": 32733003, "question_id": 32732782, "link": "https://stackoverflow.com/questions/32732782/a-c-program-to-find-the-container-name-insider-the-container-lxc/32733003#32733003", "title": "A C program to find the container name insider the container - LXC", "body": "<p>I don't think there any such program exist what you are looking for in \"C\" langauage.</p>\n\n<p>But you can write a simple C program on your own to check the existence of docker init file named \"/.dockerinit\".\nThis file is present inside every docker container (Docker creates it).</p>\n\n<p>If this file exist, you can print the host name.</p>\n"}], "owner": {"reputation": 3980, "user_id": 527813, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/mw3M2.jpg?s=128&g=1", "display_name": "Viswesn", "link": "https://stackoverflow.com/users/527813/viswesn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1442991583, "creation_date": 1442990808, "question_id": 32732782, "link": "https://stackoverflow.com/questions/32732782/a-c-program-to-find-the-container-name-insider-the-container-lxc", "title": "A C program to find the container name insider the container - LXC", "body": "<p>I am looking for C specific function to return the container name if it get executed inside the container; Do we have anything of such?</p>\n\n<p>Currently I am trying to get it by reading the file /proc/1/cgroup</p>\n\n<p>@ container:</p>\n\n<pre><code>      $&gt; cat /proc/1/cgroup \n      8:net_cls:/lxc/Container1\n      7:freezer:/lxc/Container1\n      6:devices:/lxc/Container1\n      5:memory:/lxc/Container1\n      4:cpuacct:/lxc/Container1\n      3:ns:/Container1\n      2:debug:/lxc/Container1\n      1:cpuset:/lxc/Container1\n</code></pre>\n\n<p>@ Host:</p>\n\n<pre><code>      $&gt; cat /proc/1/cgroup \n      8:net_cls:\n      7:freezer:\n      6:devices:\n      5:memory:\n      4:cpuacct:\n      3:ns:\n      2:debug:\n      1:cpuset:\n</code></pre>\n\n<p>With this we can get the container name; here it is \"container1\" on executing the programm insider the container1 otherwise the function returns \"NULL\" on executing the same at host.</p>\n"}, {"tags": ["c", "c99", "coverity"], "comments": [{"owner": {"reputation": 2420, "user_id": 383834, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/a9bb8cd9dabe7e17cdb916967e93d6cc?s=128&d=identicon&r=PG&f=1", "display_name": "Stasik", "link": "https://stackoverflow.com/users/383834/stasik"}, "reply_to_user": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1442990138, "post_id": 32732525, "comment_id": 53306373, "body": "I am sorry for the wrong tag, this is C99 code, tags modified."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1442990145, "post_id": 32732525, "comment_id": 53306379, "body": "@juanchopanza No, so maybe edit the post and remove the tag instead of stating the obvious?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1442990206, "post_id": 32732525, "comment_id": 53306406, "body": "@Stasik Please post the declaration of <code>arrayOfNodeIds</code>."}, {"owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1442990255, "post_id": 32732525, "comment_id": 53306428, "body": "I think it&#39;s a valid comment, @Lundin, because maybe the issue is that the OP tried to use this as C++? We don&#39;t know, hence we ask. Still, it would help the question even further if it contained a complete but minimal example."}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1442990275, "post_id": 32732525, "comment_id": 53306438, "body": "@Lundin I&#39;d rather let OP make that call. Sometimes compilers have C++ language extensions and so on."}, {"owner": {"reputation": 2420, "user_id": 383834, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/a9bb8cd9dabe7e17cdb916967e93d6cc?s=128&d=identicon&r=PG&f=1", "display_name": "Stasik", "link": "https://stackoverflow.com/users/383834/stasik"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1442990286, "post_id": 32732525, "comment_id": 53306452, "body": "@Lundin i have added the definition as p.s."}], "answers": [{"comments": [{"owner": {"reputation": 2420, "user_id": 383834, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/a9bb8cd9dabe7e17cdb916967e93d6cc?s=128&d=identicon&r=PG&f=1", "display_name": "Stasik", "link": "https://stackoverflow.com/users/383834/stasik"}, "edited": false, "score": 0, "creation_date": 1442990914, "post_id": 32732764, "comment_id": 53306835, "body": "by &quot;static initializer&quot; I do not mean &quot;static&quot; at all... So can I fix it by declaring the &quot;arrayOfNodeIds componentRefs&quot; as static? or is there only a way to alloc the whole thing on the heap?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 2420, "user_id": 383834, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/a9bb8cd9dabe7e17cdb916967e93d6cc?s=128&d=identicon&r=PG&f=1", "display_name": "Stasik", "link": "https://stackoverflow.com/users/383834/stasik"}, "edited": false, "score": 0, "creation_date": 1442998308, "post_id": 32732764, "comment_id": 53310906, "body": "@Stasik So what do you mean with &quot;static initializer&quot; then? You are inventing your own programming terms. If the arrayOfNodeIds has local scope and is not static, then this answer doesn&#39;t solve the problem, neither does the one you posted."}, {"owner": {"reputation": 2420, "user_id": 383834, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/a9bb8cd9dabe7e17cdb916967e93d6cc?s=128&d=identicon&r=PG&f=1", "display_name": "Stasik", "link": "https://stackoverflow.com/users/383834/stasik"}, "edited": false, "score": 0, "creation_date": 1442999289, "post_id": 32732764, "comment_id": 53311520, "body": "sorry, the variable has no static static class. The variables are defined in the same scope as the function call (see edit to my answer)."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 3, "last_activity_date": 1442990753, "creation_date": 1442990753, "answer_id": 32732764, "question_id": 32732525, "link": "https://stackoverflow.com/questions/32732525/pointer-to-local-outside-scope-by-static-analyzis-false-positive/32732764#32732764", "title": "&#39;Pointer to local outside scope&#39; by static analyzis -- false positive?", "body": "<p><code>isd</code> is a pointer and you have it point at a compound literal. All compound literals are to be regarded as local variables and they have local scope.</p>\n\n<p>So if your struct is of static storage duration (not really clear what you mean with \"static itializer\"), then the tool is right to complain. Because in that case, as soon as the program leaves the scope where you initialize <code>isd</code>, it will point at garbage. You'll have to point at another static storage duration variable or alternatively use dynamic allocation.</p>\n"}, {"tags": [], "owner": {"reputation": 2420, "user_id": 383834, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/a9bb8cd9dabe7e17cdb916967e93d6cc?s=128&d=identicon&r=PG&f=1", "display_name": "Stasik", "link": "https://stackoverflow.com/users/383834/stasik"}, "is_accepted": false, "score": 1, "last_activity_date": 1442999315, "last_edit_date": 1442999315, "creation_date": 1442991256, "answer_id": 32732909, "question_id": 32732525, "link": "https://stackoverflow.com/questions/32732525/pointer-to-local-outside-scope-by-static-analyzis-false-positive/32732909#32732909", "title": "&#39;Pointer to local outside scope&#39; by static analyzis -- false positive?", "body": "<p>So according to the answer of @Lundin this may help to remedy the problem</p>\n\n<pre><code>  UA_NodeId* tempArray = (UA_NodeId[]) { UA_NODEID_NUMERIC(0, UA_NS0ID_HASTYPEDEFINITION)};\n  arrayOfNodeIds typedefRefs = (arrayOfNodeIds) {\n    .size = 1,\n    .ids  = tempArray\n  };\n  UA_Server_addInstanceOf_instatiateChildNode(server, &amp;subtypeRefs, &amp;componentRefs, &amp;typedefRefs,\n                                                objectRoot, callback, (UA_ObjectTypeNode *) typeDefNode, \n                                                UA_TRUE, &amp;instantiatedTypes, handle);\n</code></pre>\n\n<p>In this case the scope for both the struct and the array is the same.</p>\n\n<p>Another way is to allocate the memory on the heap, instead of going for the stack.</p>\n"}], "owner": {"reputation": 2420, "user_id": 383834, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/a9bb8cd9dabe7e17cdb916967e93d6cc?s=128&d=identicon&r=PG&f=1", "display_name": "Stasik", "link": "https://stackoverflow.com/users/383834/stasik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 0, "accepted_answer_id": 32732764, "answer_count": 2, "score": -1, "last_activity_date": 1442999315, "creation_date": 1442989893, "last_edit_date": 1442990924, "question_id": 32732525, "link": "https://stackoverflow.com/questions/32732525/pointer-to-local-outside-scope-by-static-analyzis-false-positive", "title": "&#39;Pointer to local outside scope&#39; by static analyzis -- false positive?", "body": "<p>I have got an issue flagged by Coverity that I cannot understand.</p>\n\n<p>I have an itializer:</p>\n\n<pre><code>1686  arrayOfNodeIds componentRefs = (arrayOfNodeIds) {\n1687    .size = 2,\n1688    .ids  = (UA_NodeId[]) { UA_NODEID_NUMERIC(0, UA_NS0ID_HASCOMPONENT), UA_NODEID_NUMERIC(0, UA_NS0ID_HASPROPERTY)}\n1689  };\n</code></pre>\n\n<p>member ids holds an array. Then this struct is given to a function:</p>\n\n<pre><code>1707  UA_Server_addInstanceOf_instatiateChildNode(server, &amp;subtypeRefs, &amp;componentRefs, &amp;typedefRefs,\n1708                                              objectRoot, callback, (UA_ObjectTypeNode *) typeDefNode, \n1709                                              UA_TRUE, &amp;instantiatedTypes, handle);\n</code></pre>\n\n<p>the function dereferences conponentRefs->ids and Coverity flaggs this as access to a local variable outside of scope.</p>\n\n<p>By googling i found a similar <a href=\"http://git.greensocs.com/fkonrad/mttcg/commit/b0af844007841609cc11fab58f838bd105cbe144\" rel=\"nofollow\">issue in one linux driver</a> that was solved by using a memcpy to a stack variable. However, I do not understand the problem at all. Is the initializer of the internal array considered as a scope limiter? The problematic file can be found on <a href=\"https://github.com/acplt/open62541/blob/master/src/server/ua_server_addressspace.c#L1686\" rel=\"nofollow\">github</a>.</p>\n\n<p>P.S.: definition of arrayOfNodeIds:</p>\n\n<pre><code>typedef struct arrayOfNodeIds_s {\n  UA_Int32  size;\n  UA_NodeId *ids;\n} arrayOfNodeIds;\n</code></pre>\n"}, {"tags": ["c", "ide", "refactoring", "iar"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1442990011, "post_id": 32732519, "comment_id": 53306324, "body": "You can import it in Eclipse with the IAR plugin and you all functionality of Eclipse IDE."}, {"owner": {"reputation": 838, "user_id": 482800, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e9f30b429a613108e8fb4218650343ea?s=128&d=identicon&r=PG", "display_name": "Flying Swissman", "link": "https://stackoverflow.com/users/482800/flying-swissman"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1442990064, "post_id": 32732519, "comment_id": 53306346, "body": "What about library dependencies from the micro controller and the IAR compiler?"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1442990239, "post_id": 32732519, "comment_id": 53306421, "body": "You&#39;ll work with Eclipse as in IAR workbench."}, {"owner": {"reputation": 838, "user_id": 482800, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e9f30b429a613108e8fb4218650343ea?s=128&d=identicon&r=PG", "display_name": "Flying Swissman", "link": "https://stackoverflow.com/users/482800/flying-swissman"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1442990285, "post_id": 32732519, "comment_id": 53306450, "body": "I&#39;ll try this but I&#39;m a bit skeptical, what about debugging?"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1442990334, "post_id": 32732519, "comment_id": 53306480, "body": "BTW You can use Eclipse only to refactor your project and the return in IAR Workbench"}, {"owner": {"reputation": 838, "user_id": 482800, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e9f30b429a613108e8fb4218650343ea?s=128&d=identicon&r=PG", "display_name": "Flying Swissman", "link": "https://stackoverflow.com/users/482800/flying-swissman"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1442990377, "post_id": 32732519, "comment_id": 53306507, "body": "Ok, seems like a good workaround, but doing it in IAR is not possible then?"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1442991996, "post_id": 32732519, "comment_id": 53307400, "body": "AFAIK, it is not possible. I know that there are plugins tu customize IAR Workbench, but I have no experience on that."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1443002653, "post_id": 32732519, "comment_id": 53313868, "body": "While IAR compiler is good, the IDE is only average, as they for embedded systems often are. I only use IDEs for compiling and debugging, and leave other tasks to other tools (Notepad++ for text editing, TortoiseHg for version control, etc.). That way I don&#39;t have to relearn everything every time I need to work on new platform."}], "owner": {"reputation": 838, "user_id": 482800, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e9f30b429a613108e8fb4218650343ea?s=128&d=identicon&r=PG", "display_name": "Flying Swissman", "link": "https://stackoverflow.com/users/482800/flying-swissman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 443, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1442989876, "creation_date": 1442989876, "question_id": 32732519, "link": "https://stackoverflow.com/questions/32732519/searching-for-options-to-refactor-and-simplify-programming-in-iar-embedded-workb", "title": "Searching for options to refactor and simplify programming in IAR Embedded Workbench IDE", "body": "<p>I've been using eclipse until recently for java. I'm starting out with a embedded c project and there seems to be a lot of functionality missing in IAR Embedded Workbench IDE. I don't want to switch as projects I'm working on are made for this IDE and migrating would be quite a hassle. </p>\n\n<p>Is there a way to enable refactoring and clicking to find declarations of variables etc. ?</p>\n"}, {"tags": ["c", "memory", "idioms"], "comments": [{"owner": {"reputation": 46708, "user_id": 179715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e240f1a5bb197450dfb8934dd55d9e3a?s=128&d=identicon&r=PG", "display_name": "jamesdlin", "link": "https://stackoverflow.com/users/179715/jamesdlin"}, "edited": false, "score": 1, "creation_date": 1442990167, "post_id": 32732449, "comment_id": 53306388, "body": "IMO this is equivalent to asking about <code>calloc</code> vs. <code>malloc</code>. If you use <code>calloc</code> to allocate and zero memory, then it&#39;s consistent to also use <code>memset</code> if you need to grow the buffer with <code>realloc</code>."}, {"owner": {"reputation": 8941, "user_id": 445112, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c726499af0166ce20188ef12a7080cd4?s=128&d=identicon&r=PG&f=1", "display_name": "Roy T.", "link": "https://stackoverflow.com/users/445112/roy-t"}, "edited": false, "score": 0, "creation_date": 1442991755, "post_id": 32732449, "comment_id": 53307286, "body": "I find it strange that you&#39;ve read that you need to use a for loop, to set every value to NULL instead of just zeroing the memory. I think technically NULL does not have to be equal to 0x0. However, in practice you will be hard pressed to find a compiler/system that doesn&#39;t do this. (Can someone back this up?)"}, {"owner": {"reputation": 4446, "user_id": 696485, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4de94e14f977802057b0109d079d95a1?s=128&d=identicon&r=PG", "display_name": "Iskar Jarak", "link": "https://stackoverflow.com/users/696485/iskar-jarak"}, "edited": false, "score": 0, "creation_date": 1442992877, "post_id": 32732449, "comment_id": 53307925, "body": "Learn C the Hard Way is <a href=\"http://hentenaar.com/dont-learn-c-the-wrong-way\" rel=\"nofollow noreferrer\">not a great resource</a> according to some, and I am inclined to agree. Consider at least reading some other resources as well, e.g. from <a href=\"http://stackoverflow.com/a/562377/696485\">this answer</a> the the SO C book list. Note that if you ever decide to read K&amp;R, read with it in one hand and the errata sheets in the other."}, {"owner": {"reputation": 4446, "user_id": 696485, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4de94e14f977802057b0109d079d95a1?s=128&d=identicon&r=PG", "display_name": "Iskar Jarak", "link": "https://stackoverflow.com/users/696485/iskar-jarak"}, "reply_to_user": {"reputation": 8941, "user_id": 445112, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c726499af0166ce20188ef12a7080cd4?s=128&d=identicon&r=PG&f=1", "display_name": "Roy T.", "link": "https://stackoverflow.com/users/445112/roy-t"}, "edited": false, "score": 1, "creation_date": 1442993084, "post_id": 32732449, "comment_id": 53308056, "body": "@RoyT. <a href=\"http://stackoverflow.com/a/9894047/696485\">NULL has to compare equal to <code>0</code> but does not have to be all zero bits</a>, although in practice it usually is."}, {"owner": {"reputation": 33821, "user_id": 45685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/y4RJr.jpg?s=128&g=1", "display_name": "AndersK", "link": "https://stackoverflow.com/users/45685/andersk"}, "edited": false, "score": 0, "creation_date": 1442993390, "post_id": 32732449, "comment_id": 53308243, "body": "you should also check return value of realloc, sometimes it fails."}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "reply_to_user": {"reputation": 8941, "user_id": 445112, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c726499af0166ce20188ef12a7080cd4?s=128&d=identicon&r=PG&f=1", "display_name": "Roy T.", "link": "https://stackoverflow.com/users/445112/roy-t"}, "edited": false, "score": 1, "creation_date": 1442994530, "post_id": 32732449, "comment_id": 53308878, "body": "@RoyT. - It happened on some old systems without memory protection. Physical address 0 could contain operating system info, like interrupt handlers. Having a write to a null pointer overwrite this was a BAD(tm) idea. In that case it might be better to let NULL point to ROM rather than RAM."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1443021289, "post_id": 32732449, "comment_id": 53327514, "body": "The title question is &quot;is it common practice?&quot; and a final question is &quot;is it really needed?&quot;.  The accepted answer answers the 2nd question, but not the title."}], "answers": [{"comments": [{"owner": {"reputation": 14748, "user_id": 132728, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/3e932264fb24dfdfd63dc467bfb1e957?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/132728/max"}, "edited": false, "score": 0, "creation_date": 1442998425, "post_id": 32732502, "comment_id": 53310980, "body": "I think it makes actualy sense to initialize the memory, because the initial array was allocated with <code>calloc</code>."}, {"owner": {"reputation": 17910, "user_id": 3963067, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1e536542e9baa5c52499d61fb64f51d3?s=128&d=identicon&r=PG&f=1", "display_name": "gmoniava", "link": "https://stackoverflow.com/users/3963067/gmoniava"}, "reply_to_user": {"reputation": 14748, "user_id": 132728, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/3e932264fb24dfdfd63dc467bfb1e957?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/132728/max"}, "edited": false, "score": 0, "creation_date": 1442998514, "post_id": 32732502, "comment_id": 53311037, "body": "@Max: well, as noted the &quot;new part&quot; of the allocated memory will not be initialized, and if you try to read values from that memory you will trigger UB"}], "tags": [], "owner": {"reputation": 17910, "user_id": 3963067, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1e536542e9baa5c52499d61fb64f51d3?s=128&d=identicon&r=PG&f=1", "display_name": "gmoniava", "link": "https://stackoverflow.com/users/3963067/gmoniava"}, "is_accepted": true, "score": 4, "last_activity_date": 1442998225, "last_edit_date": 1442998225, "creation_date": 1442989817, "answer_id": 32732502, "question_id": 32732449, "link": "https://stackoverflow.com/questions/32732449/is-it-common-practice-to-memset-reallocated-memory-to-0/32732502#32732502", "title": "Is it common practice to memset reallocated memory to 0?", "body": "<blockquote>\n  <p>So my question is, as memset does not necessarily mean setting values\n  to NULL and the for loop solution seems a bit tedious \u2013 is it really\n  needed to set the newly allocated memory?</p>\n</blockquote>\n\n<p><code>realloc</code> doesn't initialize values of the newly allocated memory segment. </p>\n\n<p>So it is needed to initialize the memory if you are planning to read values of that (uninitialized) memory. Because reading values from that uninitialized memory will trigger undefined behaviour.</p>\n\n<p>By the way, safe way to use <code>realloc</code> (since it can fail) is:</p>\n\n<pre><code>  // Since using realloc with size of 0 is tricky and useless probably\n  // we use below check (from discussion with @chux)\n  if (new_size == 0) \n    dosmth();\n  else \n  {\n    new_p = realloc(p, new_size);\n    if (new_p == NULL)\n    {\n      // ...handle error\n    }else\n    {\n      p = new_p;\n    }\n  }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1442991266, "creation_date": 1442991266, "answer_id": 32732913, "question_id": 32732449, "link": "https://stackoverflow.com/questions/32732449/is-it-common-practice-to-memset-reallocated-memory-to-0/32732913#32732913", "title": "Is it common practice to memset reallocated memory to 0?", "body": "<p>Setting a <code>void *</code> to 0 is a value that will compare equal to <code>NULL</code>.  Likely <code>memset(ptr, 0, size)</code> is OK - but need to see more code for certainty.</p>\n\n<p>OTOH: is the code correct?  Maybe should be </p>\n\n<pre><code>// memset(array-&gt;contents + old_max, 0, array-&gt;expand_rate + 1);\nmemset(array-&gt;contents + old_max, 0, sizeof(void *) * (array-&gt;expand_rate + 1) );\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 46708, "user_id": 179715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e240f1a5bb197450dfb8934dd55d9e3a?s=128&d=identicon&r=PG", "display_name": "jamesdlin", "link": "https://stackoverflow.com/users/179715/jamesdlin"}, "edited": false, "score": 0, "creation_date": 1443117457, "post_id": 32737027, "comment_id": 53375037, "body": "This answer is backwards. The macro <code>NULL</code> is guaranteed to be 0 or <code>(void*) 0</code>: the null pointer constant.  Its <i>representation</i> (which is what the compiler translates <code>0</code> into in pointer contexts) is not necessarily all-bits-zero, so <code>memset</code> does not guarantee producing null pointers. When you give <code>0</code> as an argument to <code>memset</code>, it is <i>not</i> in a pointer context, and it thus will not be converted to a null pointer. Also see <a href=\"http://www.c-faq.com/null/index.html\" rel=\"nofollow noreferrer\">c-faq.com/null/index.html</a>"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 46708, "user_id": 179715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e240f1a5bb197450dfb8934dd55d9e3a?s=128&d=identicon&r=PG", "display_name": "jamesdlin", "link": "https://stackoverflow.com/users/179715/jamesdlin"}, "edited": false, "score": 0, "creation_date": 1443119123, "post_id": 32737027, "comment_id": 53375843, "body": "&quot;The macro NULL is guaranteed to be 0 or (void*) 0&quot;  <b>Authoritative</b> cite?"}, {"owner": {"reputation": 46708, "user_id": 179715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e240f1a5bb197450dfb8934dd55d9e3a?s=128&d=identicon&r=PG", "display_name": "jamesdlin", "link": "https://stackoverflow.com/users/179715/jamesdlin"}, "edited": false, "score": 0, "creation_date": 1443134326, "post_id": 32737027, "comment_id": 53383128, "body": "From the ISO C99 spec, section 6.3.2.3 (which you cited): &quot;An integer constant expression with the value 0, or such an expression cast to type <code>void *</code>, is called a <i>null pointer constant</i> [55].&quot; combined with footnote 55: &quot;The macro <code>NULL</code> is defined ... as a null pointer constant....&quot;"}, {"owner": {"reputation": 46708, "user_id": 179715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e240f1a5bb197450dfb8934dd55d9e3a?s=128&d=identicon&r=PG", "display_name": "jamesdlin", "link": "https://stackoverflow.com/users/179715/jamesdlin"}, "edited": false, "score": 0, "creation_date": 1443134775, "post_id": 32737027, "comment_id": 53383288, "body": "Furthermore, the section you cited states &quot;If a null pointer <b>constant</b> is <b>converted</b> to a pointer type, the resulting pointer, called a <b>null pointer</b>...&quot; (emphasis mine).  Your answer mixes up the null pointer <i>constant</i> (aka <code>NULL</code>, aka 0) with a null pointer (not necessarily all-bits-zero)."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 46708, "user_id": 179715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e240f1a5bb197450dfb8934dd55d9e3a?s=128&d=identicon&r=PG", "display_name": "jamesdlin", "link": "https://stackoverflow.com/users/179715/jamesdlin"}, "edited": false, "score": 0, "creation_date": 1443174217, "post_id": 32737027, "comment_id": 53396932, "body": "You simply do not understand the standard.  <b>A</b> <i>null pointer constant</i> is not <b>THE</b> <i>null pointer constant</i>.  Given that the standard states that <b>any two null pointers shall compare equal</b>, there obviously can be more than one <i>null pointer constant</i>.  Nothing in the standard requires that any given <i>null pointer constant</i> shall be &quot;[a]n integer constant expression with the value 0&quot;.  All it does is require that an integer value of 0 be treated <b>as</b> a <i>null pointer constant</i>.  There&#39;s no way to read any of that as &quot;NULL must be zero&quot;."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 46708, "user_id": 179715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e240f1a5bb197450dfb8934dd55d9e3a?s=128&d=identicon&r=PG", "display_name": "jamesdlin", "link": "https://stackoverflow.com/users/179715/jamesdlin"}, "edited": false, "score": 0, "creation_date": 1443174625, "post_id": 32737027, "comment_id": 53397212, "body": "From the c-faq website you linked to.  <a href=\"http://www.c-faq.com/null/confusion4.html\" rel=\"nofollow noreferrer\">c-faq.com/null/confusion4.html</a>  &quot;Some implementations naturally represent null pointers by special, nonzero bit patterns, particularly when it can be arranged that inadvertently using those values triggers automatic hardware traps. Requiring null pointers to be represented internally as 0, and therefore disallowing use of the special, nonzero values, would be an unfortunate step backwards...&quot;"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 46708, "user_id": 179715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e240f1a5bb197450dfb8934dd55d9e3a?s=128&d=identicon&r=PG", "display_name": "jamesdlin", "link": "https://stackoverflow.com/users/179715/jamesdlin"}, "edited": false, "score": 0, "creation_date": 1443175177, "post_id": 32737027, "comment_id": 53397540, "body": "Additionally <a href=\"http://www.c-faq.com/null/machexamp.html\" rel=\"nofollow noreferrer\">c-faq.com/null/machexamp.html</a>:  &quot;The Prime 50 series used segment 07777, offset 0 for the null pointer, at least for PL/I. Later models used segment 0, offset 0 for null pointers in C, necessitating new instructions such as TCNP (Test C Null Pointer), evidently as a sop to all the extant <b>poorly-written C code</b> which <b>made incorrect assumptions</b>.&quot;"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 46708, "user_id": 179715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e240f1a5bb197450dfb8934dd55d9e3a?s=128&d=identicon&r=PG", "display_name": "jamesdlin", "link": "https://stackoverflow.com/users/179715/jamesdlin"}, "edited": false, "score": 0, "creation_date": 1443175507, "post_id": 32737027, "comment_id": 53397725, "body": "But, since the standard does now require that a constant zero value be treated as a null pointer, we <i>de facto</i> have reached a situation where zeroing out memory sets pointers to <code>NULL</code>, and every implementation I&#39;ve seen for a long time does define <code>NULL</code> as zero."}, {"owner": {"reputation": 46708, "user_id": 179715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e240f1a5bb197450dfb8934dd55d9e3a?s=128&d=identicon&r=PG", "display_name": "jamesdlin", "link": "https://stackoverflow.com/users/179715/jamesdlin"}, "edited": false, "score": 0, "creation_date": 1443200600, "post_id": 32737027, "comment_id": 53413215, "body": "No, <i>you</i> do not understand the standard.  The <b>null pointer <i>constant</i></b> is an expression in C code (<code>0</code> or <code>(void*) 0)</code>).  The <b>null pointer</b> is the machine representation. Everything that you&#39;ve mentioned in your comments specifically refers to &quot;the null pointer&quot;, not &quot;the null pointer constant&quot;.  In particular &quot;Some implementations naturally represent null pointers by ... nonzero bit patterns&quot; (note <i>null pointer</i>, not <i>null pointer constant</i>).  &quot;Any two null pointers shall compare equal&quot;: There may be different null pointers for different types, not different <i>null pointer constants</i>."}, {"owner": {"reputation": 46708, "user_id": 179715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e240f1a5bb197450dfb8934dd55d9e3a?s=128&d=identicon&r=PG", "display_name": "jamesdlin", "link": "https://stackoverflow.com/users/179715/jamesdlin"}, "edited": false, "score": 0, "creation_date": 1443200712, "post_id": 32737027, "comment_id": 53413273, "body": "See <a href=\"http://www.c-faq.com/null/null2.html\" rel=\"nofollow noreferrer\">c-faq.com/null/null2.html</a> and <a href=\"http://www.c-faq.com/sx1/index.html#null%20pointer%20constant\" rel=\"nofollow noreferrer\">c-faq.com/sx1/index.html#null%20pointer%20constant</a>"}, {"owner": {"reputation": 46708, "user_id": 179715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e240f1a5bb197450dfb8934dd55d9e3a?s=128&d=identicon&r=PG", "display_name": "jamesdlin", "link": "https://stackoverflow.com/users/179715/jamesdlin"}, "edited": false, "score": 0, "creation_date": 1443201373, "post_id": 32737027, "comment_id": 53413598, "body": "Now, I will agree that the language of the standard does seem to <i>permit</i> the existence of other null pointer constants.  Perhaps some implementation could choose to convert <code>(void*) -1</code> to a null pointer too and still be compliant.  So you would be correct that <code>NULL</code> could be defined to something else.  However, that has no bearing on the use of <code>memset</code>, because the conversion between the null pointer constant to a null pointer would not happen."}], "tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": false, "score": 0, "last_activity_date": 1443003832, "creation_date": 1443003832, "answer_id": 32737027, "question_id": 32732449, "link": "https://stackoverflow.com/questions/32732449/is-it-common-practice-to-memset-reallocated-memory-to-0/32737027#32737027", "title": "Is it common practice to memset reallocated memory to 0?", "body": "<p>This is wrong:</p>\n\n<blockquote>\n  <p>But, even if you wanted to \"zero it out so everything is nice\", or\n  really need the new pointers to be NULL: the C standard doesn't\n  guarantee that all-bits-zero is the null pointer constant (i.e.,\n  NULL), so memset() isn't the right solution anyway.</p>\n</blockquote>\n\n<p>The C standard does in fact guarantee exactly that.</p>\n\n<p>Per section 6.3.2.3 of the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1256.pdf\" rel=\"nofollow\">C standard</a>:</p>\n\n<blockquote>\n  <p>An integer constant expression with the value 0, or such an expression\n  cast to type <code>void *</code>, is called a <em>null pointer constant</em>. If a null\n  pointer constant is converted to a pointer type, the resulting\n  pointer, called a <em>null pointer</em>, is guaranteed to compare unequal to\n  a pointer to any object or function.</p>\n  \n  <p>Conversion of a null pointer to another pointer type yields a null\n  pointer of that type. Any two null pointers shall compare equal.</p>\n</blockquote>\n\n<p>Note that a pointer with a value of zero is <strong>a</strong> <em>null pointer</em>.  That doesn't mean <code>NULL</code> itself has to be zero.  But also note that <strong>\"any two null pointers shall compare equal\"</strong>.  So any <em>null pointer</em> is equal to the <code>NULL</code> value.</p>\n\n<p>Since <code>memset()</code> takes as its second argument an integer value, passing a zero integer value to <code>memset()</code> will produce null pointers.  Because the value passed to <code>memset()</code> is \"[a]n integer constant expression with the value 0\", per 6.3.2.3.</p>\n"}], "owner": {"reputation": 14748, "user_id": 132728, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/3e932264fb24dfdfd63dc467bfb1e957?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/132728/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1436, "favorite_count": 0, "accepted_answer_id": 32732502, "answer_count": 3, "score": 2, "last_activity_date": 1443003832, "creation_date": 1442989648, "last_edit_date": 1495542685, "question_id": 32732449, "link": "https://stackoverflow.com/questions/32732449/is-it-common-practice-to-memset-reallocated-memory-to-0", "title": "Is it common practice to memset reallocated memory to 0?", "body": "<p>In a C book I found in an example for implementing a dynamically resizing array this code (simplified):</p>\n\n<pre><code>void *contents = realloc(array-&gt;contents, array-&gt;max * sizeof(void *));\narray-&gt;contents = contents;\n\nmemset(array-&gt;contents + old_max, 0, array-&gt;expand_rate + 1);\n</code></pre>\n\n<p>Source: <a href=\"http://c.learncodethehardway.org/book/ex34.html\" rel=\"nofollow noreferrer\">Learn C The Hard Way \u2013 Chapter 34</a></p>\n\n<p>I was a bit surprised what <code>memset</code> is supposed to achieve here, but then I understood it's used in order to \"zero out\" the reallocated memory. </p>\n\n<p>I googled in order to find out, if this is what I'm supposed to do after a <code>realloc</code> and found a stackoverflow answer regarding this:</p>\n\n<blockquote>\n  <p>There is probably no need to do the <code>memset</code> [\u2026]</p>\n  \n  <p>But, even if you wanted to \"zero it out so everything is nice\", or really need the new pointers to be <code>NULL</code>: the C standard doesn't guarantee that all-bits-zero is the null pointer constant (i.e., <code>NULL</code>), so <code>memset()</code> isn't the right solution anyway.</p>\n</blockquote>\n\n<p>Source: <a href=\"https://stackoverflow.com/a/2141373/132728\">How to zero out new memory after realloc</a></p>\n\n<p>The suggested solution instead of <code>memset</code> is then to use a <code>for</code> loop in order to set the memory to <code>NULL</code>.</p>\n\n<p>So my question is, as <code>memset</code> does not necessarily mean setting values to <code>NULL</code> and the <code>for</code> loop solution seems a bit tedious \u2013 is it really needed to set the newly allocated memory?</p>\n"}, {"tags": ["c", "struct", "nested"], "comments": [{"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1442989722, "post_id": 32732397, "comment_id": 53306185, "body": "You can only initialize something once. And arrays are not assignable."}, {"owner": {"reputation": 1108, "user_id": 4590317, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/53887d60ecc8a92d0d111b6fc1e79a9a?s=128&d=identicon&r=PG&f=1", "display_name": "zxgear", "link": "https://stackoverflow.com/users/4590317/zxgear"}, "reply_to_user": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1442990300, "post_id": 32732397, "comment_id": 53306456, "body": "Right, I edited the title to reflect your comment."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1442989723, "post_id": 32732447, "comment_id": 53306186, "body": "dropping my answer for this, but please add it&#39;s not <i>initialization</i>, because initialization happens (by definition) in the declaration."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1442989784, "post_id": 32732447, "comment_id": 53306222, "body": "Yes please point out that none of this is initialization, as the OP is confused about the term. Also in C89, nothing is stopping you from declaring a second struct variable, initialize it and copy it in runtime. Which is what this code is doing. <code>fooPerson = n;</code> would work perfectly fine in C89, no need for memcpy as there are no pointers here."}, {"owner": {"reputation": 117024, "user_id": 200291, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/399cacf55045372a29f1f844d12ee777?s=128&d=identicon&r=PG", "display_name": "icktoofay", "link": "https://stackoverflow.com/users/200291/icktoofay"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1442991005, "post_id": 32732447, "comment_id": 53306875, "body": "@Lundin: I\u2019m not sure what I was thinking with the <code>memcpy</code>. In any case, I edited it to be a normal assignment."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1442998579, "post_id": 32732447, "comment_id": 53311077, "body": "@icktoofay I mainly wanted to point out that there&#39;s no notable difference between C99 and C90 for this example. Either allow you to create a temporary object and do runtime assignment."}], "tags": [], "owner": {"reputation": 117024, "user_id": 200291, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/399cacf55045372a29f1f844d12ee777?s=128&d=identicon&r=PG", "display_name": "icktoofay", "link": "https://stackoverflow.com/users/200291/icktoofay"}, "is_accepted": true, "score": 5, "last_activity_date": 1442990973, "last_edit_date": 1442990973, "creation_date": 1442989642, "answer_id": 32732447, "question_id": 32732397, "link": "https://stackoverflow.com/questions/32732397/how-to-assign-value-to-a-struct-member-of-a-struct/32732447#32732447", "title": "How to assign value to a struct member of a struct?", "body": "<p>Starting in C99, you can use a compound literal for this:</p>\n\n<pre><code>fooPerson.fullname = (struct names){ \"Foo\", 'B', \"Baz\" };\n</code></pre>\n\n<p>If you\u2019re stuck with C89, though, you\u2019re mostly out of luck, unless you want to do something like this:</p>\n\n<pre><code>{\n    struct names n = { \"Foo\", 'B', \"Baz\" };\n    fooPerson.fullname = n;\n}\n</code></pre>\n\n<p>Felix points out in the comments that neither of these are truly <em>initialization</em>\u2014it\u2019s only initialization when it happens as part of the declaration, which isn\u2019t the case here. Rather, both are assignments. Still, this ought to do what you want.</p>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 0, "last_activity_date": 1442998607, "last_edit_date": 1442998607, "creation_date": 1442989724, "answer_id": 32732475, "question_id": 32732397, "link": "https://stackoverflow.com/questions/32732397/how-to-assign-value-to-a-struct-member-of-a-struct/32732475#32732475", "title": "How to assign value to a struct member of a struct?", "body": "<p><em>Initialization</em> is the term for giving a variable a value upon declaration. Everything else is <em>assignment</em>.</p>\n\n<p>Thus if you <em>initialize</em> your variable, and only then, you can use an <em>initializer list</em> (the <code>{ }</code>).</p>\n\n<pre><code>struct person fooPerson = { {\"Foo\", 'B', \"Baz\"} };\n</code></pre>\n\n<p>Alternatively you can use designated initializers:</p>\n\n<pre><code>struct person fooPerson =\n{\n  .fullname = \n  { \n    .first  = \"Foo\",\n    .middle = 'B',\n    .last   = \"Baz\"\n  }\n};\n</code></pre>\n"}], "owner": {"reputation": 1108, "user_id": 4590317, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/53887d60ecc8a92d0d111b6fc1e79a9a?s=128&d=identicon&r=PG&f=1", "display_name": "zxgear", "link": "https://stackoverflow.com/users/4590317/zxgear"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1339, "favorite_count": 0, "accepted_answer_id": 32732447, "answer_count": 2, "score": 1, "last_activity_date": 1442998607, "creation_date": 1442989400, "last_edit_date": 1442990101, "question_id": 32732397, "link": "https://stackoverflow.com/questions/32732397/how-to-assign-value-to-a-struct-member-of-a-struct", "title": "How to assign value to a struct member of a struct?", "body": "<p>I am learning about nested structs in C, and what I want to do is to be able to assign a value to my struct's member struct. I'm having trouble figuring this out, and I don't want to force myself to initialize the member struct in the initialization of the struct. Why do I keep getting an error when I try to compile this code?</p>\n\n<pre><code>main.c: In function 'main':\nmain.c:16:23: error: expected expression before '{' token\n  fooPerson.fullname = {\"Foo\", 'B', \"Baz\"};\n</code></pre>\n\n<p>\u00a0</p>\n\n<pre><code>#define LEN 20\n\nstruct names {\n    char first[LEN];\n    char middle;\n    char last[LEN];\n};\n\nstruct person {\n    struct names fullname;\n};\n\nint main() {\n    struct person fooPerson;\n    fooPerson.fullname = {\"Foo\", 'B', \"Baz\"};\n\n    // NOT this: it works, but not the solution I'm asking for\n    // struct person fooPerson = {{\"Foo\", 'B', \"Baz\"}};\n}\n</code></pre>\n"}, {"tags": ["c", "gcc", "null", "warnings", "gcc5.2"], "comments": [{"owner": {"reputation": 3310, "user_id": 1853605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2ab8d886abc51e874c1ed067b912ddd?s=128&d=identicon&r=PG", "display_name": "Potato", "link": "https://stackoverflow.com/users/1853605/potato"}, "edited": false, "score": 1, "creation_date": 1442989013, "post_id": 32732281, "comment_id": 53305826, "body": "possible duplicate <a href=\"http://stackoverflow.com/questions/1610030/why-can-you-return-from-a-non-void-function-without-returning-a-value-without-pr\" title=\"why can you return from a non void function without returning a value without pr\">stackoverflow.com/questions/1610030/&hellip;</a>"}, {"owner": {"reputation": 7873, "user_id": 2225104, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/195de66794c596e35bc145c80e9f5515?s=128&d=identicon&r=PG", "display_name": "BitTickler", "link": "https://stackoverflow.com/users/2225104/bittickler"}, "edited": false, "score": 0, "creation_date": 1442989087, "post_id": 32732281, "comment_id": 53305871, "body": "Lol you mean &quot;inverse duplicate&quot;? This question asks why you can return a value in a body of a void function. The &quot;duplicate&quot; asks why you can write a body of a non-void function without a return statement."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1442989343, "post_id": 32732281, "comment_id": 53306002, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/32656460/why-doesnt-returning-0x80000000-from-a-function-that-returns-int32-t-cause-a-wa\">Why doesn&#39;t returning 0x80000000 from a function that returns int32_t cause a warning?</a>"}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 1, "creation_date": 1442989348, "post_id": 32732281, "comment_id": 53306005, "body": "It would help if you posted the warning message."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1442989410, "post_id": 32732281, "comment_id": 53306042, "body": "@juanchopanza the question was why there <i>isn&#39;t any</i> ... and it was asked before. short answer, warning will be there with <code>-Wconversion</code>."}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1442989443, "post_id": 32732281, "comment_id": 53306058, "body": "@FelixPalmen I was referring to &quot;especially since clang 3.7.0 does generate a warning.&quot;."}, {"owner": {"reputation": 7873, "user_id": 2225104, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/195de66794c596e35bc145c80e9f5515?s=128&d=identicon&r=PG", "display_name": "BitTickler", "link": "https://stackoverflow.com/users/2225104/bittickler"}, "edited": false, "score": 0, "creation_date": 1442989810, "post_id": 32732281, "comment_id": 53306233, "body": "Just as a matter of interest... does anyone know what the compcert compiler will do with this?"}, {"owner": {"reputation": 71, "user_id": 5366270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a62e14e7c09ae1d14248fc6bd1cf7ae6?s=128&d=identicon&r=PG&f=1", "display_name": "damwdan", "link": "https://stackoverflow.com/users/5366270/damwdan"}, "reply_to_user": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1442990871, "post_id": 32732281, "comment_id": 53306803, "body": "@juanchopanza I added the warnings!  @FelixPalmen <code>-Wconversion</code> did not change anything."}, {"owner": {"reputation": 6533, "user_id": 1918193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b70a14318e0f417ecac47809f38fafc?s=128&d=identicon&r=PG", "display_name": "Marc Glisse", "link": "https://stackoverflow.com/users/1918193/marc-glisse"}, "edited": false, "score": 3, "creation_date": 1443039911, "post_id": 32732281, "comment_id": 53338339, "body": "<code>-Wsystem-headers</code> &quot;fixes&quot; it, the compiler uses the wrong location for the diagnostic (the one from the macro definition). Please file a bug report in gcc&#39;s bugzilla."}], "answers": [{"comments": [{"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1442989583, "post_id": 32732382, "comment_id": 53306122, "body": "OP claims to be using <code>-pedantic</code>."}, {"owner": {"reputation": 71, "user_id": 5366270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a62e14e7c09ae1d14248fc6bd1cf7ae6?s=128&d=identicon&r=PG&f=1", "display_name": "damwdan", "link": "https://stackoverflow.com/users/5366270/damwdan"}, "edited": false, "score": 0, "creation_date": 1442989764, "post_id": 32732382, "comment_id": 53306209, "body": "I am indeed using <code>-pedantic</code>."}], "tags": [], "owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "is_accepted": false, "score": 1, "last_activity_date": 1442989781, "last_edit_date": 1442989781, "creation_date": 1442989359, "answer_id": 32732382, "question_id": 32732281, "link": "https://stackoverflow.com/questions/32732281/no-warning-when-returning-null-with-gcc/32732382#32732382", "title": "No warning when returning NULL with gcc", "body": "<p>The validity of the first function is dependent on how <code>NULL</code> is defined. There's no problem with the first function if <code>NULL</code> is defined as <code>0</code>. But if it happens to be defined as <code>(void *) 0</code> (which is normally the case in C code) the first function becomes invalid. GCC is often very permissive about implicit pointer-to-integer conversions.</p>\n\n<p>The second function is flat out invalid. The language specification clearly states that \"A return statement with an expression shall not appear in a function whose return type is void.\" If it compiles, it must be another example of GCC being overly permissive about something.</p>\n\n<p>You need to run GCC in <code>-pedantic</code> mode if you want its diagnostic output to be related to standard C language. In default mode it is not a credible C compiler (at least in therms of its diagnostic output) and the fact that it \"does not issue a warning\" means absolutely nothing. </p>\n\n<p>Yet in my experiments I was not able to make GCC complain about the second function even with <code>-std=</code> and <code>-pedantic</code> switches. It looks like a bug in the compiler.</p>\n"}, {"comments": [{"owner": {"reputation": 561, "user_id": 1408435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71495525c34fc28434ddf7b4b4574eaf?s=128&d=identicon&r=PG", "display_name": "Antoine Pietri", "link": "https://stackoverflow.com/users/1408435/antoine-pietri"}, "edited": false, "score": 0, "creation_date": 1443038610, "post_id": 32748238, "comment_id": 53337674, "body": "You probably mean 5.2.0."}], "tags": [], "owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "is_accepted": false, "score": 3, "last_activity_date": 1443038840, "last_edit_date": 1443038840, "creation_date": 1443037558, "answer_id": 32748238, "question_id": 32732281, "link": "https://stackoverflow.com/questions/32732281/no-warning-when-returning-null-with-gcc/32748238#32748238", "title": "No warning when returning NULL with gcc", "body": "<p>This appears to be a regression in gcc 5.2.0 -- and, as far as I can tell, a weird one.</p>\n\n<p>With gcc 4.4.5 and 4.8.4, the program (after adding the required <code>#include &lt;stddef.h&gt;</code>) produces warnings on both <code>return NULL;</code> statements, even without any extra command-line options.</p>\n\n<p>With gcc 5.2.0, no warning is produced, even with <code>gcc -c -Wall -Wextra -std=c99 -pedantic</code>. For the second one, which returns a value from a <code>void</code> function, a diagnostic is mandatory.</p>\n\n<p>Now here's the weird part.</p>\n\n<pre><code>$ gcc --version | head -n 1\ngcc (GCC) 5.2.0\n$ cat c.c\n#include &lt;stddef.h&gt;\n\nint function(void) {\n#ifdef USE_NULL\n   return NULL;\n#else\n    return ((void*)0);\n#endif\n}\n\nvoid procedure(void) {\n#ifdef USE_NULL\n   return NULL;\n#else\n    return ((void*)0);\n#endif\n}\n$ gcc -c c.c\nc.c: In function \u2018function\u2019:\nc.c:7:12: warning: return makes integer from pointer without a cast [-Wint-conversion]\n     return ((void*)0);\n            ^\nc.c: In function \u2018procedure\u2019:\nc.c:15:12: warning: \u2018return\u2019 with a value, in function returning void\n     return ((void*)0);\n            ^\n$ gcc -c -DUSE_NULL c.c\n$ \n</code></pre>\n\n<p>When <code>USE_NULL</code> is defined, no warnings are produced. Compiling with <code>gcc -E -DUSE_NULL</code> (which prints the preprocessor's output to stdout) confirms that <code>NULL</code> is defined as <code>((void*)0)</code>. But when I replace <code>NULL</code> with <code>((void*)0)</code>, the warnings are produced (as they should be).</p>\n\n<p>I don't know what's going on. Once the macro <code>NULL</code> has been expanded, it should be indistinguishable from <code>((void*)0)</code>, and yet the compiler's behavior changes depending on which is used.</p>\n"}, {"tags": [], "owner": {"reputation": 71, "user_id": 5366270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a62e14e7c09ae1d14248fc6bd1cf7ae6?s=128&d=identicon&r=PG&f=1", "display_name": "damwdan", "link": "https://stackoverflow.com/users/5366270/damwdan"}, "is_accepted": true, "score": 1, "last_activity_date": 1450278121, "last_edit_date": 1450278121, "creation_date": 1443637301, "answer_id": 32873123, "question_id": 32732281, "link": "https://stackoverflow.com/questions/32732281/no-warning-when-returning-null-with-gcc/32873123#32873123", "title": "No warning when returning NULL with gcc", "body": "<p>I filled a bug report here: <a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=67730\" rel=\"nofollow\">https://gcc.gnu.org/bugzilla/show_bug.cgi?id=67730</a></p>\n\n<p>It was confirmed and is fixed for 5.3 it seems!</p>\n\n<p>Thanks for your help.</p>\n"}], "owner": {"reputation": 71, "user_id": 5366270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a62e14e7c09ae1d14248fc6bd1cf7ae6?s=128&d=identicon&r=PG&f=1", "display_name": "damwdan", "link": "https://stackoverflow.com/users/5366270/damwdan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 733, "favorite_count": 3, "accepted_answer_id": 32873123, "answer_count": 3, "score": 6, "last_activity_date": 1450278121, "creation_date": 1442988883, "last_edit_date": 1443351790, "question_id": 32732281, "link": "https://stackoverflow.com/questions/32732281/no-warning-when-returning-null-with-gcc", "title": "No warning when returning NULL with gcc", "body": "<p>Using <code>gcc</code> 5.2.0, I noticed that this code does not generate a warning:</p>\n\n<pre><code>#include &lt;stddef.h&gt;\n\nint function(void)\n{\n    return NULL;\n}\n\nvoid procedure(void)\n{\n    return NULL;\n}\n</code></pre>\n\n<p>I used the flags <code>-Wall -Wextra -std=c99 -pedantic</code> and I am running archlinux. I am not sure why this code works fine on <code>gcc</code>, especially since <code>clang</code> 3.7.0 does generate a warning.</p>\n\n<p>I also tried with older versions of <code>gcc</code> like 4.9 or 4.7 and they both generate warnings.</p>\n\n<p>The warnings are:</p>\n\n<pre><code>warning: return makes integer from pointer without a cast\n</code></pre>\n\n<p>and</p>\n\n<pre><code>warning: \u2018return\u2019 with a value, in function returning void\n</code></pre>\n\n<p>I should mention that I tried compiling gcc 5.2 on Debian and the result is the same. So archlinux does not seem to be the problem.</p>\n\n<p>What is the rationale? I cannot seem to find anything related to this anywhere else.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["c", "percentage"], "comments": [{"owner": {"reputation": 8617, "user_id": 3477950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mC5xL.jpg?s=128&g=1", "display_name": "The Paramagnetic Croissant", "link": "https://stackoverflow.com/users/3477950/the-paramagnetic-croissant"}, "edited": false, "score": 4, "creation_date": 1442988264, "post_id": 32732070, "comment_id": 53305495, "body": "Integer division truncates. <code>(100-percent)&#47;100</code> is always 0."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 1, "creation_date": 1442988388, "post_id": 32732070, "comment_id": 53305550, "body": "Please enable warnings when compiling. You are trying to print an address in your last <code>printf</code>; you just need <code>printf(&quot;%.2lf\\n&quot;, grand_total);</code>. The argument for <code>scanf</code> is okay, though: Here you need the <code>&amp;</code>);"}, {"owner": {"reputation": 15468, "user_id": 321772, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/c03247f45c9f291391b894375c2709ca?s=128&d=identicon&r=PG", "display_name": "Adam", "link": "https://stackoverflow.com/users/321772/adam"}, "edited": false, "score": 2, "creation_date": 1442988698, "post_id": 32732070, "comment_id": 53305683, "body": "Also, what you call the &quot;percentage operator&quot; is actually called &quot;modulus&quot; and its function has nothing to do with percentages."}], "answers": [{"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 1, "last_activity_date": 1442988312, "creation_date": 1442988312, "answer_id": 32732136, "question_id": 32732070, "link": "https://stackoverflow.com/questions/32732070/calculating-user-input-percentage-in-c/32732136#32732136", "title": "Calculating User Input Percentage in C", "body": "<p>The expression <code>(100-percent)/100</code> is an <em>integer</em> expression, all involved values are integers and so you get integer division which will result in the value <code>0</code>.</p>\n\n<p>Instead use floating-point values: <code>(100.0-percent)/100.0</code></p>\n"}, {"tags": [], "owner": {"reputation": 3002, "user_id": 4228131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RyKUe.jpg?s=128&g=1", "display_name": "WedaPashi", "link": "https://stackoverflow.com/users/4228131/wedapashi"}, "is_accepted": false, "score": 1, "last_activity_date": 1442988666, "last_edit_date": 1495542351, "creation_date": 1442988666, "answer_id": 32732233, "question_id": 32732070, "link": "https://stackoverflow.com/questions/32732070/calculating-user-input-percentage-in-c/32732233#32732233", "title": "Calculating User Input Percentage in C", "body": "<p>Along with what <a href=\"https://stackoverflow.com/a/32732136/4228131\">Joachim Pileborg said</a>  you need to fix this:</p>\n\n<pre><code>printf(\"\\nThe total after discount is %.2lf\\n\", &amp;grand_total); \n</code></pre>\n\n<p>change it to:</p>\n\n<pre><code>printf(\"\\nThe total after discount is %.2lf\\n\", grand_total); \n</code></pre>\n\n<p><code>&amp;</code> operator is used to take address. And you don't possibly need the address for <code>printf</code>, like you need for <code>scanf</code>. Roughly speaking, in <code>scanf()</code> you need the address to put the console input/user input into the variable.</p>\n"}, {"tags": [], "owner": {"reputation": 4671, "user_id": 434408, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/WQ1I9.jpg?s=128&g=1", "display_name": "a3.14_Infinity", "link": "https://stackoverflow.com/users/434408/a3-14-infinity"}, "is_accepted": false, "score": 0, "last_activity_date": 1442989084, "last_edit_date": 1442989084, "creation_date": 1442988878, "answer_id": 32732280, "question_id": 32732070, "link": "https://stackoverflow.com/questions/32732070/calculating-user-input-percentage-in-c/32732280#32732280", "title": "Calculating User Input Percentage in C", "body": "<p>I guess you could check the code below, this works and <code>price_book</code> is calculated along with <code>percent</code>, check below.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(){\n\n    double price_book;\n    int percent;\n    double grand_total;\n\n    printf(\"What is the price of the book?\\n\");\n    scanf(\"%lf\", &amp;price_book);\n\n    printf(\"The Price of the book before discount is %.2lf\\n\\n\",price_book);\n\n    printf(\"How much percent discount is to be applied?\\n\");\n    scanf(\"%d\", &amp;percent);\n\n    grand_total = price_book - ( (percent)/100.0 * price_book);\n\n    printf(\"\\nThe total after discount is %.2lf\\n\", grand_total);\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 5335627, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bb18848581c189e6be3896a7020bccc9?s=128&d=identicon&r=PG&f=1", "display_name": "Basil Afzal", "link": "https://stackoverflow.com/users/5335627/basil-afzal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1343, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1442989084, "creation_date": 1442988064, "last_edit_date": 1442988239, "question_id": 32732070, "link": "https://stackoverflow.com/questions/32732070/calculating-user-input-percentage-in-c", "title": "Calculating User Input Percentage in C", "body": "<p>For homework I have to calculate a percent discount from user input percentages in C, every time I run this program it returns the result as the original price and not with the discounted percentage(For Homework I was told to do this without the percentage operator.)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(){\n\n    double price_book;\n    int percent;\n    double grand_total;\n\n    printf(\"What is the price of the book?\\n\");\n            scanf(\"%lf\", &amp;price_book);\n\n    printf(\"The Price of the book before discount is %.2lf\\n\\n\",price_book);\n\n\n    printf(\"How much percent discount is to be applied?\\n\");\n            scanf(\"%d\", &amp;percent);\n\n    grand_total = (100-percent)/100 * price_book;\n\n    printf(\"\\nThe total after discount is %.2lf\\n\", &amp;grand_total);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "pebble-watch", "pebble-sdk", "cloudpebble", "pebble-js"], "answers": [{"tags": [], "owner": {"reputation": 514, "user_id": 275636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/040ec00435e0fa97764b552ba00378c7?s=128&d=identicon&r=PG", "display_name": "Dale", "link": "https://stackoverflow.com/users/275636/dale"}, "is_accepted": false, "score": 2, "last_activity_date": 1444891063, "creation_date": 1444891063, "answer_id": 33141510, "question_id": 32732001, "link": "https://stackoverflow.com/questions/32732001/how-to-parse-dictionary-of-dictionary-in-c-which-is-sent-by-js-to-c/33141510#33141510", "title": "How to parse Dictionary of dictionary in C which is sent by JS to C?", "body": "<p>I'm assuming you initialized your outer iterator correctly, so then the inner one would have to use something like this:</p>\n\n<pre><code>DictionaryIterator iterator1;\n\nTuple *tuple = dict_read_begin_from_buffer(&amp;iterator1, t-&gt;value-&gt;data, strlen(t-&gt;value-&gt;data));\n</code></pre>\n\n<p>dict_read_first simply resets back to the beginning of the buffer, but you need dict_read_begin_from_buffer to initialize it, if I am reading the docs correctly.</p>\n"}], "owner": {"reputation": 1652, "user_id": 742815, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/a2e69abbd1cdc4bef36aa0884d0a038f?s=128&d=identicon&r=PG", "display_name": "iLearner", "link": "https://stackoverflow.com/users/742815/ilearner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 338, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1444892084, "creation_date": 1442987750, "last_edit_date": 1444892084, "question_id": 32732001, "link": "https://stackoverflow.com/questions/32732001/how-to-parse-dictionary-of-dictionary-in-c-which-is-sent-by-js-to-c", "title": "How to parse Dictionary of dictionary in C which is sent by JS to C?", "body": "<p>How to parse Dictionary  of dictionary in C which is sent by JS to C?\nBelow is the sample data and format of nested dictionary which I am trying to parse.</p>\n\n<pre><code>var temp_DATA_CONTAINER =  {'KEY_1':\"abc\", 'KEY_2':\"bcd\", 'KEY_1':\"efg\"};\nvar outer_dictionary  =  {'OUTER_KEY' : temp_DATA_CONTAINER};      \nPebble.sendAppMessage(outer_dictionary);\n</code></pre>\n\n<p>I am using <strong>app message</strong> for communication, so when I receive data in C inside <strong>inbox_received_callback</strong>, I have tried below code to get data out of dictionary.</p>\n\n<p>This is what I tried but not working:</p>\n\n<pre><code>Tuple *t = dict_read_first(iterator);\nwhile (t != NULL)\n{\n    switch (t-&gt;key)\n    {\n    case OUTER_KEY:\n        {\n             DictionaryIterator *iterator1 = (DictionaryIterator *)t-&gt;value-&gt;data;\n                 Tuple *tuple1 = dict_read_first(iterator1);\n\n                    while(tuple1 != NULL)\n                    {\n                            switch(tuple1-&gt;key)\n                            {\n                              case KEY_1:\n                              {\n                                 printf(\"~~ In key 1  \");\n                                break;\n                              }\n                              case KEY_2:\n                              {\n                                 printf(\"~~In key  2\");\n                                break;\n                              }\n                              case KEY_3:\n                              {\n                                 printf(\"~~In key  3\");\n                                break;\n                             }\n                         }\n                       // Get next pair, if any\n                      tuple1 = dict_read_next(iterator1);\n                    }   \n        }\n}\n\n t = dict_read_next(iterator);\n}\n</code></pre>\n\n<p>This code is not working, I think I doing something wrong here:</p>\n\n<pre><code>DictionaryIterator *iterator1 = (DictionaryIterator *)t-&gt;value-&gt;data; \n</code></pre>\n\n<p>but I'm not able to figure out the right approach to do that.</p>\n"}]